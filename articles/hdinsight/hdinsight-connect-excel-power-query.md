---
title: aaaConnect Excel tooHadoop com o Power Query - HDInsight do Azure | Microsoft Docs
description: Saiba como tootake vantagem dos componentes do business intelligence e use o Power Query para dados do Excel tooaccess armazenados no Hadoop no HDInsight.
services: hdinsight
documentationcenter: 
tags: azure-portal
author: mumian
manager: jhubbard
editor: cgronlun
ms.assetid: 01ad2f90-7520-44d9-8c16-4d936faaff9b
ms.service: hdinsight
ms.custom: hdinsightactive
ms.workload: big-data
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/11/2017
ms.author: jgao
ms.openlocfilehash: 1213849f1bc04e0ed206750b80766ff2268664b4
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="connect-excel-toohadoop-by-using-power-query"></a><span data-ttu-id="77428-103">Conectar Excel tooHadoop usando o Power Query</span><span class="sxs-lookup"><span data-stu-id="77428-103">Connect Excel tooHadoop by using Power Query</span></span>
<span data-ttu-id="77428-104">Um recurso importante da solução de dados grandes do Microsoft hello é a integração de saudação de componentes do Microsoft business intelligence (BI) com clusters Hadoop em HDInsight do Azure.</span><span class="sxs-lookup"><span data-stu-id="77428-104">One key feature of hello Microsoft big-data solution is hello integration of Microsoft business intelligence (BI) components with Hadoop clusters in Azure HDInsight.</span></span> <span data-ttu-id="77428-105">Um exemplo principal é Olá capacidade tooconnect Excel toohello conta de armazenamento do Azure que contém dados de saudação associados ao cluster de Hadoop usando Olá Microsoft Power Query para Excel no.</span><span class="sxs-lookup"><span data-stu-id="77428-105">A primary example is hello ability tooconnect Excel toohello Azure Storage account that contains hello data associated with your Hadoop cluster by using hello Microsoft Power Query for Excel add-in.</span></span> <span data-ttu-id="77428-106">Este artigo o orienta como tooset backup e usar dados do Power Query tooquery associados a um cluster de Hadoop gerenciavam com HDInsight.</span><span class="sxs-lookup"><span data-stu-id="77428-106">This article walks you through how tooset up and use Power Query tooquery data associated with a Hadoop cluster managed with HDInsight.</span></span>

### <a name="prerequisites"></a><span data-ttu-id="77428-107">Pré-requisitos</span><span class="sxs-lookup"><span data-stu-id="77428-107">Prerequisites</span></span>
<span data-ttu-id="77428-108">Antes de começar este artigo, você deve ter Olá itens a seguir:</span><span class="sxs-lookup"><span data-stu-id="77428-108">Before you begin this article, you must have hello following items:</span></span>

* <span data-ttu-id="77428-109">**Um cluster HDInsight**.</span><span class="sxs-lookup"><span data-stu-id="77428-109">**An HDInsight cluster**.</span></span> <span data-ttu-id="77428-110">tooconfigure um, consulte [Introdução ao Azure HDInsight][hdinsight-get-started].</span><span class="sxs-lookup"><span data-stu-id="77428-110">tooconfigure one, see [Get started with Azure HDInsight][hdinsight-get-started].</span></span>
* <span data-ttu-id="77428-111">**estação de trabalho** que esteja executando Windows 7, Windows Server 2008 R2 ou um sistema operacional posterior.</span><span class="sxs-lookup"><span data-stu-id="77428-111">**A workstation** that is running Windows 7, Windows Server 2008 R2, or a later operating system.</span></span>
* <span data-ttu-id="77428-112">**Office 2016, Office 2013 Professional Plus, Office 365 ProPlus, Excel 2013 autônomo ou Office 2010 Professional Plus**.</span><span class="sxs-lookup"><span data-stu-id="77428-112">**Office 2016, Office 2013 Professional Plus, Office 365 ProPlus, Excel 2013 Standalone, or Office 2010 Professional Plus**.</span></span>

## <a name="install-power-query"></a><span data-ttu-id="77428-113">Instalar o Power Query</span><span class="sxs-lookup"><span data-stu-id="77428-113">Install Power Query</span></span>
<span data-ttu-id="77428-114">O Power Query pode importar dados que foram retornados ou que foram gerados por um trabalho Hadoop em execução em um cluster HDInsight.</span><span class="sxs-lookup"><span data-stu-id="77428-114">Power Query can import data that has been output or that has been generated by a Hadoop job running on an HDInsight cluster.</span></span>

<span data-ttu-id="77428-115">No Excel 2016, o Power Query foi integrado à faixa de opções de dados de saudação em Olá Get & Transform seção.</span><span class="sxs-lookup"><span data-stu-id="77428-115">In Excel 2016, Power Query has been integrated into hello Data ribbon under hello Get & Transform section.</span></span> <span data-ttu-id="77428-116">Para versões anteriores do Excel, baixe o Microsoft Power Query para Excel de Olá [Microsoft Download Center] [ powerquery-download] e instalá-lo.</span><span class="sxs-lookup"><span data-stu-id="77428-116">For older Excel versions, download Microsoft Power Query for Excel from hello [Microsoft Download Center][powerquery-download] and install it.</span></span>

## <a name="import-hdinsight-data-into-excel"></a><span data-ttu-id="77428-117">Importar dados do HDInsight para o Excel</span><span class="sxs-lookup"><span data-stu-id="77428-117">Import HDInsight data into Excel</span></span>
<span data-ttu-id="77428-118">Olá suplemento do Power Query para Excel torna fácil tooimport dados do seu cluster HDInsight no Excel, onde as ferramentas de BI como PowerPivot e Power mapa podem ser tooinspect usado, analisar e apresentar dados hello.</span><span class="sxs-lookup"><span data-stu-id="77428-118">hello Power Query add-in for Excel makes it easy tooimport data from your HDInsight cluster into Excel, where BI tools such as PowerPivot and Power Map can be used tooinspect, analyze, and present hello data.</span></span>

<span data-ttu-id="77428-119">**tooimport dados de um cluster do HDInsight**</span><span class="sxs-lookup"><span data-stu-id="77428-119">**tooimport data from an HDInsight cluster**</span></span>

1. <span data-ttu-id="77428-120">Abra o Excel.</span><span class="sxs-lookup"><span data-stu-id="77428-120">Open Excel.</span></span>
2. <span data-ttu-id="77428-121">Crie uma nova pasta de trabalho em branco.</span><span class="sxs-lookup"><span data-stu-id="77428-121">Create a new blank workbook.</span></span>
3. <span data-ttu-id="77428-122">Execute Olá etapas com base na versão do Excel Olá a seguir:</span><span class="sxs-lookup"><span data-stu-id="77428-122">Perform hello following steps based on hello Excel version:</span></span>

    - <span data-ttu-id="77428-123">Excel 2016</span><span class="sxs-lookup"><span data-stu-id="77428-123">Excel 2016</span></span>

        - <span data-ttu-id="77428-124">Clique em Olá **dados** menu, clique em **obter dados** de saudação **obter & transformar dados** de faixa de opções, clique em **do Azure**e, em seguida, clique em  **Do Azure HDInsight(HDFS)**.</span><span class="sxs-lookup"><span data-stu-id="77428-124">Click hello **Data** menu, click **Get Data** from hello **Get & Transform Data** ribbon, click **From Azure**, and then click **From Azure HDInsight(HDFS)**.</span></span>

        ![HDI.PowerQuery.SelectHdiSource](./media/hdinsight-connect-excel-power-query/hdi.powerquery.selecthdisource.excel2016.png)

    - <span data-ttu-id="77428-126">Excel 2013/2010</span><span class="sxs-lookup"><span data-stu-id="77428-126">Excel 2013/2010</span></span>

        - <span data-ttu-id="77428-127">Clique em Olá **Power Query** menu, clique em **do Azure**e, em seguida, clique em **do Microsoft Azure HDInsight**.</span><span class="sxs-lookup"><span data-stu-id="77428-127">Click hello **Power Query** menu, click **From Azure**, and then click **From Microsoft Azure HDInsight**.</span></span>
   
        ![HDI.PowerQuery.SelectHdiSource][image-hdi-powerquery-hdi-source]
       
        <span data-ttu-id="77428-129">**Observação:** se você não vir Olá **Power Query** menu Ir muito**arquivo** > **opções** > **suplementos**e selecione **suplementos COM** na lista suspensa Olá **gerenciar** caixa Olá inferior da página de saudação.</span><span class="sxs-lookup"><span data-stu-id="77428-129">**Note:** If you don't see hello **Power Query** menu, go too**File** > **Options** > **Add-Ins**, and select **COM Add-ins** from hello drop-down **Manage** box at hello bottom of hello page.</span></span> <span data-ttu-id="77428-130">Selecione Olá **ir...**  botão e verifique se essa caixa Olá para hello Power Query para Excel em foi verificada.</span><span class="sxs-lookup"><span data-stu-id="77428-130">Select hello **Go...** button and verify that hello box for hello Power Query for Excel add-in has been checked.</span></span>
       
        <span data-ttu-id="77428-131">**Observação:** Power Query também permite que você tooimport dados do HDFS clicando **de outras fontes**.</span><span class="sxs-lookup"><span data-stu-id="77428-131">**Note:** Power Query also allows you tooimport data from HDFS by clicking **From Other Sources**.</span></span>
4. <span data-ttu-id="77428-132">Para **nome da conta**, insira Olá nome da conta de armazenamento de BLOBs do Azure Olá associada ao cluster e, em seguida, clique em **Okey**.</span><span class="sxs-lookup"><span data-stu-id="77428-132">For **Account Name**, enter hello name of hello Azure Blob storage account associated with your cluster, and then click **OK**.</span></span> <span data-ttu-id="77428-133">Essa conta pode ser Olá [conta de armazenamento padrão](hdinsight-administer-use-management-portal.md#find-the-default-storage-account) ou uma conta de armazenamento vinculada.</span><span class="sxs-lookup"><span data-stu-id="77428-133">This account can be hello [default storage account](hdinsight-administer-use-management-portal.md#find-the-default-storage-account) or a linked storage account.</span></span>  <span data-ttu-id="77428-134">formato de saudação é *https://&lt;StorageAccountName >.blob.core.windows.net/*.</span><span class="sxs-lookup"><span data-stu-id="77428-134">hello format is *https://&lt;StorageAccountName>.blob.core.windows.net/*.</span></span>
5. <span data-ttu-id="77428-135">Para **chave de conta**, insira a chave Olá Olá conta de armazenamento de Blob e, em seguida, clique em **salvar**.</span><span class="sxs-lookup"><span data-stu-id="77428-135">For **Account Key**, enter hello key for hello Blob storage account, and then click **Save**.</span></span> <span data-ttu-id="77428-136">(Necessário tooenter Olá conta informações somente Olá primeira vez que você acessa esse repositório.)</span><span class="sxs-lookup"><span data-stu-id="77428-136">(You need tooenter hello account information only hello first time you access this store.)</span></span>
6. <span data-ttu-id="77428-137">Em Olá **navegador** painel Olá à esquerda do Editor de consultas de saudação, clique duas vezes no nome do contêiner de armazenamento de Blob de saudação.</span><span class="sxs-lookup"><span data-stu-id="77428-137">In hello **Navigator** pane on hello left of hello Query Editor, double-click hello Blob storage container name.</span></span> <span data-ttu-id="77428-138">Por padrão, o nome de contêiner Olá é Olá mesmo nome como o nome do cluster hello.</span><span class="sxs-lookup"><span data-stu-id="77428-138">By default, hello container name is hello same name as hello cluster name.</span></span>
7. <span data-ttu-id="77428-139">Localize **HiveSampleData.txt** em Olá **nome** coluna (Olá caminho da pasta é **... / hive/warehouse/hivesampletable/**) e, em seguida, clique em **binário** esquerda de saudação do HiveSampleData.txt.</span><span class="sxs-lookup"><span data-stu-id="77428-139">Locate **HiveSampleData.txt** in hello **Name** column (hello folder path is **../hive/warehouse/hivesampletable/**), and then click **Binary** on hello left of HiveSampleData.txt.</span></span> <span data-ttu-id="77428-140">HiveSampleData.txt vem com todos os cluster de saudação.</span><span class="sxs-lookup"><span data-stu-id="77428-140">HiveSampleData.txt comes with all hello cluster.</span></span> <span data-ttu-id="77428-141">Se desejar, você pode usar seu próprio arquivo.</span><span class="sxs-lookup"><span data-stu-id="77428-141">Optionally, you can use your own file.</span></span>
   
    ![HDI.PowerQuery.ImportData][image-hdi-powerquery-importdata]
8. <span data-ttu-id="77428-143">Se desejar, você pode renomear os nomes de coluna hello.</span><span class="sxs-lookup"><span data-stu-id="77428-143">If you want, you can rename hello column names.</span></span> <span data-ttu-id="77428-144">Quando estiver pronto, clique em **Fechar e Carregar**.</span><span class="sxs-lookup"><span data-stu-id="77428-144">When you are ready, click **Close & Load**.</span></span>  <span data-ttu-id="77428-145">dados de saudação foi carregado tooyour de pasta de trabalho:</span><span class="sxs-lookup"><span data-stu-id="77428-145">hello data has been loaded tooyour workbook:</span></span>
   
    ![HDI.PowerQuery.ImportedTable][image-hdi-powerquery-imported-table]

## <a name="next-steps"></a><span data-ttu-id="77428-147">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="77428-147">Next steps</span></span>
<span data-ttu-id="77428-148">Neste artigo, você aprendeu como toouse dados do Power Query tooretrieve do HDInsight para o Excel.</span><span class="sxs-lookup"><span data-stu-id="77428-148">In this article, you learned how toouse Power Query tooretrieve data from HDInsight into Excel.</span></span> <span data-ttu-id="77428-149">Da mesma forma, você pode recuperar dados do HDInsight no banco de dados SQL do Azure.</span><span class="sxs-lookup"><span data-stu-id="77428-149">Similarly, you can retrieve data from HDInsight into Azure SQL Database.</span></span> <span data-ttu-id="77428-150">Também é dados tooupload possíveis no HDInsight.</span><span class="sxs-lookup"><span data-stu-id="77428-150">It is also possible tooupload data into HDInsight.</span></span> <span data-ttu-id="77428-151">toolearn mais, consulte Olá artigos a seguir:</span><span class="sxs-lookup"><span data-stu-id="77428-151">toolearn more, see hello following articles:</span></span>

* <span data-ttu-id="77428-152">[Conectar Excel tooHDInsight com hello Microsoft ODBC Driver Hive][hdinsight-ODBC]</span><span class="sxs-lookup"><span data-stu-id="77428-152">[Connect Excel tooHDInsight with hello Microsoft Hive ODBC Driver][hdinsight-ODBC]</span></span>
* <span data-ttu-id="77428-153">[Carregar dados tooHDInsight][hdinsight-upload-data]</span><span class="sxs-lookup"><span data-stu-id="77428-153">[Upload Data tooHDInsight][hdinsight-upload-data]</span></span>

[hdinsight-ODBC]: hdinsight-connect-excel-hive-odbc-driver.md
[hdinsight-get-started]: hdinsight-hadoop-linux-tutorial-get-started.md
[hdinsight-upload-data]: hdinsight-upload-data.md

[image-hdi-powerquery-hdi-source]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.selecthdisource.png
[image-hdi-powerquery-importdata]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.importdata.png
[image-hdi-powerquery-imported-table]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.importedtable.PNG

[powerquery-download]: http://go.microsoft.com/fwlink/?LinkID=286689
