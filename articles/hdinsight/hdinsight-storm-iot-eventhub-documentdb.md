---
title: "Processar dados de sensor de veículo com o Apache Storm no HDInsight | Microsoft Docs"
description: "Saiba como processar dados de sensor de veículo nos Hubs de Eventos usando o Apache Storm no HDInsight. Adicione dados de modelo do Azure Cosmos DB e armazenar a saída no armazenamento."
services: hdinsight,documentdb,notification-hubs
documentationcenter: 
author: Blackmist
manager: jhubbard
editor: cgronlun
ms.assetid: 78980635-8bef-4c33-96c3-fae50e932e31
ms.service: hdinsight
ms.custom: hdinsightactive
ms.devlang: java
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 05/03/2017
ms.author: larryfr
ms.openlocfilehash: 8e8ebc724e1c70e8fcd56312adef5da2342373ea
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 07/11/2017
---
# <a name="process-vehicle-sensor-data-from-azure-event-hubs-using-apache-storm-on-hdinsight"></a><span data-ttu-id="d3161-104">Processar dados de sensor de veículo nos Hubs de Eventos do Azure usando o Apache Storm no HDInsight</span><span class="sxs-lookup"><span data-stu-id="d3161-104">Process vehicle sensor data from Azure Event Hubs using Apache Storm on HDInsight</span></span>

<span data-ttu-id="d3161-105">Saiba como processar dados dos sensores do veículo a partir dos Hubs de Evento do Azure usando o Apache Storm no HDInsight.</span><span class="sxs-lookup"><span data-stu-id="d3161-105">Learn how to process vehicle sensor data from Azure Event Hubs using Apache Storm on HDInsight.</span></span> <span data-ttu-id="d3161-106">Este exemplo lê os dados de sensor dos Hubs de Eventos do Azure e enriquece os dados referenciando os dados armazenados no Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="d3161-106">This example reads sensor data from Azure Event Hubs, enriches the data by referencing data stored in Azure Cosmos DB.</span></span> <span data-ttu-id="d3161-107">Os dados são armazenados no Armazenamento do Azure usando o HDFS (Sistema de Arquivos Hadoop).</span><span class="sxs-lookup"><span data-stu-id="d3161-107">The data is stored into Azure Storage using the Hadoop File System (HDFS).</span></span>

![Diagrama da arquitetura do HDInsight e da IoT (Internet das Coisas)](./media/hdinsight-storm-iot-eventhub-documentdb/iot.png)

## <a name="overview"></a><span data-ttu-id="d3161-109">Visão geral</span><span class="sxs-lookup"><span data-stu-id="d3161-109">Overview</span></span>

<span data-ttu-id="d3161-110">A adição de sensores a veículos permite prever problemas de equipamentos de acordo com as tendências de dados históricos.</span><span class="sxs-lookup"><span data-stu-id="d3161-110">Adding sensors to vehicles allows you to predict equipment problems based on historical data trends.</span></span> <span data-ttu-id="d3161-111">Ela também permite fazer melhorias em versões futuras, com base na análise de padrão de uso.</span><span class="sxs-lookup"><span data-stu-id="d3161-111">It also allows you to make improvements to future versions based on usage pattern analysis.</span></span> <span data-ttu-id="d3161-112">Você deve conseguir carregar os dados de forma rápida e eficiente de todos os veículos no Hadoop antes que ocorra o processamento do MapReduce.</span><span class="sxs-lookup"><span data-stu-id="d3161-112">You must be able to quickly and efficiently load the data from all vehicles into Hadoop before MapReduce processing can occur.</span></span> <span data-ttu-id="d3161-113">Além disso, você pode querer fazer uma análise dos caminhos de falha críticos (temperatura do mecanismo, freios, etc.) em tempo real.</span><span class="sxs-lookup"><span data-stu-id="d3161-113">Additionally, you may wish to do analysis for critical failure paths (engine temperature, brakes, etc.) in real time.</span></span>

<span data-ttu-id="d3161-114">Os Hubs de Eventos do Azure foram desenvolvidos para manipular o grande volume de dados gerados por sensores.</span><span class="sxs-lookup"><span data-stu-id="d3161-114">Azure Event Hubs is built to handle the massive volume of data generated by sensors.</span></span> <span data-ttu-id="d3161-115">O Apache Storm pode ser usado para carregar e processar os dados antes de armazená-los no HDFS.</span><span class="sxs-lookup"><span data-stu-id="d3161-115">Apache Storm can be used to load and process the data before storing it into HDFS.</span></span>

## <a name="solution"></a><span data-ttu-id="d3161-116">Solução</span><span class="sxs-lookup"><span data-stu-id="d3161-116">Solution</span></span>

<span data-ttu-id="d3161-117">Os dados telemétricos de temperatura do mecanismo, temperatura ambiente e velocidade do veículo são registrados pelos sensores.</span><span class="sxs-lookup"><span data-stu-id="d3161-117">Telemetry data for engine temperature, ambient temperature, and vehicle speed is recorded by sensors.</span></span> <span data-ttu-id="d3161-118">Depois, os dados são enviados para os Hubs de Eventos juntamente com o VIN (Número de Identificação do Veículo) do carro e um carimbo de data/hora.</span><span class="sxs-lookup"><span data-stu-id="d3161-118">Data is then sent to Event Hubs along with the car's Vehicle Identification Number (VIN) and a time stamp.</span></span> <span data-ttu-id="d3161-119">A partir daí, uma Storm Topology em execução em um cluster do Apache Storm no HDInsight lê os dados, processa-os e armazena-os no HDFS.</span><span class="sxs-lookup"><span data-stu-id="d3161-119">From there, a Storm Topology running on an Apache Storm on HDInsight cluster reads the data, processes it, and stores it into HDFS.</span></span>

<span data-ttu-id="d3161-120">Durante o processamento, o VIN é usado para recuperar informações sobre o modelo do Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="d3161-120">During processing, the VIN is used to retrieve model information from Cosmos DB.</span></span> <span data-ttu-id="d3161-121">Esses dados são adicionados ao fluxo de dados antes de serem armazenados.</span><span class="sxs-lookup"><span data-stu-id="d3161-121">This data is added to the data stream before it is stored.</span></span>

<span data-ttu-id="d3161-122">Os componentes usados na Storm Topology são:</span><span class="sxs-lookup"><span data-stu-id="d3161-122">The components used in the Storm Topology are:</span></span>

* <span data-ttu-id="d3161-123">**EventHubSpout** - lê dados de Hubs de Evento do Azure</span><span class="sxs-lookup"><span data-stu-id="d3161-123">**EventHubSpout** - reads data from Azure Event Hubs</span></span>
* <span data-ttu-id="d3161-124">**TypeConversionBolt** –converte a cadeia de caracteres JSON dos Hubs de Eventos em uma tupla que contém os seguintes dados de sensor:</span><span class="sxs-lookup"><span data-stu-id="d3161-124">**TypeConversionBolt** - converts the JSON string from Event Hubs into a tuple containing the following sensor data:</span></span>
    * <span data-ttu-id="d3161-125">Temperatura do motor</span><span class="sxs-lookup"><span data-stu-id="d3161-125">Engine temperature</span></span>
    * <span data-ttu-id="d3161-126">Temperatura ambiente</span><span class="sxs-lookup"><span data-stu-id="d3161-126">Ambient temperature</span></span>
    * <span data-ttu-id="d3161-127">Velocidade</span><span class="sxs-lookup"><span data-stu-id="d3161-127">Speed</span></span>
    * <span data-ttu-id="d3161-128">VIN</span><span class="sxs-lookup"><span data-stu-id="d3161-128">VIN</span></span>
    * <span data-ttu-id="d3161-129">Timestamp</span><span class="sxs-lookup"><span data-stu-id="d3161-129">Timestamp</span></span>
* <span data-ttu-id="d3161-130">**DataReferencBolt** – pesquisa o modelo do veículo no Cosmos DB usando o VIN</span><span class="sxs-lookup"><span data-stu-id="d3161-130">**DataReferencBolt** - looks up the vehicle model from Cosmos DB using the VIN</span></span>
* <span data-ttu-id="d3161-131">**WasbStoreBolt** - armazena os dados para o HDFS (Armazenamento do Azure)</span><span class="sxs-lookup"><span data-stu-id="d3161-131">**WasbStoreBolt** - stores the data to HDFS (Azure Storage)</span></span>

<span data-ttu-id="d3161-132">A seguinte imagem é um diagrama dessa solução:</span><span class="sxs-lookup"><span data-stu-id="d3161-132">The following image is a diagram of this solution:</span></span>

![topologia Storm](./media/hdinsight-storm-iot-eventhub-documentdb/iottopology.png)

## <a name="implementation"></a><span data-ttu-id="d3161-134">Implementação</span><span class="sxs-lookup"><span data-stu-id="d3161-134">Implementation</span></span>

<span data-ttu-id="d3161-135">Há uma solução completa e automatizada para esse cenário disponível como parte do repositório [HDInsight-Storm-Examples](https://github.com/hdinsight/hdinsight-storm-examples) no GitHub.</span><span class="sxs-lookup"><span data-stu-id="d3161-135">A complete, automated solution for this scenario is available as part of the [HDInsight-Storm-Examples](https://github.com/hdinsight/hdinsight-storm-examples) repository on GitHub.</span></span> <span data-ttu-id="d3161-136">Para usar esse exemplo, siga as etapas no [IoTExample README.MD](https://github.com/hdinsight/hdinsight-storm-examples/blob/master/IotExample/README.md).</span><span class="sxs-lookup"><span data-stu-id="d3161-136">To use this example, follow the steps in the [IoTExample README.MD](https://github.com/hdinsight/hdinsight-storm-examples/blob/master/IotExample/README.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="d3161-137">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="d3161-137">Next Steps</span></span>

<span data-ttu-id="d3161-138">Para obter mais topologias do Storm, consulte [Exemplo de topologias para Storm em HDInsight](hdinsight-storm-example-topology.md).</span><span class="sxs-lookup"><span data-stu-id="d3161-138">For more example Storm topologies, see [Example topologies for Storm on HDInsight](hdinsight-storm-example-topology.md).</span></span>

