---
title: "Como criar e usar um Balanceador de Carga Interna com um Ambiente do Serviço de Aplicativo | Microsoft Docs"
description: Criar e usar um ASE com um ILB
services: app-service
documentationcenter: 
author: ccompy
manager: stefsch
editor: 
ms.assetid: ad9a1e00-d5e5-413e-be47-e21e5b285dbf
ms.service: app-service
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/11/2017
ms.author: ccompy
ms.openlocfilehash: 9e5a40f18eb9eaf60579af21afc6f05c2d87f4c1
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/03/2017
---
# <a name="using-an-internal-load-balancer-with-an-app-service-environment"></a><span data-ttu-id="34fd6-103">Como usar um Balanceador de Carga Interno com um Ambiente do Serviço do Aplicativo</span><span class="sxs-lookup"><span data-stu-id="34fd6-103">Using an Internal Load Balancer with an App Service Environment</span></span>

> [!NOTE] 
> <span data-ttu-id="34fd6-104">Este artigo é sobre o Ambiente do Serviço de Aplicativo v1.</span><span class="sxs-lookup"><span data-stu-id="34fd6-104">This article is about the App Service Environment v1.</span></span> <span data-ttu-id="34fd6-105">Há uma versão mais recente do Ambiente de Serviço de Aplicativo que é mais fácil de usar e é executado na infraestrutura mais avançada.</span><span class="sxs-lookup"><span data-stu-id="34fd6-105">There is a newer version of the App Service Environment that is easier to use and runs on more powerful infrastructure.</span></span> <span data-ttu-id="34fd6-106">Para saber mais sobre a nova versão, comece com [Introdução ao Ambiente do Serviço de Aplicativo](../app-service/app-service-environment/intro.md).</span><span class="sxs-lookup"><span data-stu-id="34fd6-106">To learn more about the new version start with the [Introduction to the App Service Environment](../app-service/app-service-environment/intro.md).</span></span>
>

<span data-ttu-id="34fd6-107">O recurso ASE (Ambiente do Serviço de Aplicativo) é uma opção de serviço Premium do Serviço de Aplicativo do Azure que fornece uma capacidade configuração avançada não disponível em carimbos com vários locatários.</span><span class="sxs-lookup"><span data-stu-id="34fd6-107">The App Service Environment (ASE) feature is a Premium service option of Azure App Service that delivers an enhanced configuration capability that is not available in the multi-tenant stamps.</span></span> <span data-ttu-id="34fd6-108">Essencialmente, o recurso ASE implanta o Serviço de Aplicativo do Azure em sua VNet (Rede virtual do Azure).</span><span class="sxs-lookup"><span data-stu-id="34fd6-108">The ASE feature essentially deploys the Azure App Service in your Azure Virtual Network(VNet).</span></span> <span data-ttu-id="34fd6-109">Para obter uma maior compreensão dos recursos oferecidos pelos ambientes do serviço de aplicativo, leia a documentação [O que é um ambiente do serviço de aplicativo][WhatisASE].</span><span class="sxs-lookup"><span data-stu-id="34fd6-109">To gain a greater understanding of the capabilities offered by App Service Environments read the [What is an App Service Environment][WhatisASE] documentation.</span></span> <span data-ttu-id="34fd6-110">Se você não conhece os benefícios de operar em uma VNet, leia as [Perguntas frequentes de Rede Virtual do Azure][virtualnetwork].</span><span class="sxs-lookup"><span data-stu-id="34fd6-110">If you don't know the benefits of operating in a VNet read the [Azure Virtual Network FAQ][virtualnetwork].</span></span> 

## <a name="overview"></a><span data-ttu-id="34fd6-111">Visão geral</span><span class="sxs-lookup"><span data-stu-id="34fd6-111">Overview</span></span>
<span data-ttu-id="34fd6-112">Um ASE pode ser implantado com um ponto de extremidade acessível da internet ou com um endereço IP em sua VNet.</span><span class="sxs-lookup"><span data-stu-id="34fd6-112">An ASE can be deployed with an internet accessible endpoint or with an IP address in your VNet.</span></span> <span data-ttu-id="34fd6-113">Para definir o endereço IP como um endereço de VNet, você precisa implantar seu ASE com um ILB (Balanceador de Carga Interno).</span><span class="sxs-lookup"><span data-stu-id="34fd6-113">In order to set the IP address to a VNet address you need to deploy your ASE with an Internal Load Balancer(ILB).</span></span> <span data-ttu-id="34fd6-114">Quando seu ASE é configurado com um ILB, você fornece:</span><span class="sxs-lookup"><span data-stu-id="34fd6-114">When your ASE is configured with an ILB you provide:</span></span>

* <span data-ttu-id="34fd6-115">seu próprio domínio ou subdomínio.</span><span class="sxs-lookup"><span data-stu-id="34fd6-115">your own domain or subdomain.</span></span> <span data-ttu-id="34fd6-116">Para facilitar, este documento considera o subdomínio, mas você pode configurá-lo de qualquer maneira.</span><span class="sxs-lookup"><span data-stu-id="34fd6-116">To make it easy, this document assumes subdomain but you can configure it either way.</span></span> 
* <span data-ttu-id="34fd6-117">o certificado usado para HTTPS</span><span class="sxs-lookup"><span data-stu-id="34fd6-117">the certificate used for HTTPS</span></span>
* <span data-ttu-id="34fd6-118">Gerenciamento de DNS para o subdomínio.</span><span class="sxs-lookup"><span data-stu-id="34fd6-118">DNS management for your subdomain.</span></span> 

<span data-ttu-id="34fd6-119">Em troca, você pode fazer coisas como:</span><span class="sxs-lookup"><span data-stu-id="34fd6-119">In return, you can do things such as:</span></span>

* <span data-ttu-id="34fd6-120">hospedar aplicativos de intranet, por exemplo, aplicativos de linha de negócios, com segurança na nuvem, que você acessa por meio de uma VPN de ExpressRoute Site a Site</span><span class="sxs-lookup"><span data-stu-id="34fd6-120">host intranet applications, like line of business applications, securely in the cloud which you access through a Site to Site or ExpressRoute VPN</span></span>
* <span data-ttu-id="34fd6-121">hospedar aplicativos na nuvem que não estão listados em servidores de DNS públicos</span><span class="sxs-lookup"><span data-stu-id="34fd6-121">host apps in the cloud that are not listed in public DNS servers</span></span>
* <span data-ttu-id="34fd6-122">criar aplicativos back-end isolados da internet, aos quais seus aplicativos front-end podem ser integrados com segurança</span><span class="sxs-lookup"><span data-stu-id="34fd6-122">create internet isolated backend apps which your front end apps can securely integrate with</span></span>

#### <a name="disabled-functionality"></a><span data-ttu-id="34fd6-123">Funcionalidade desabilitada</span><span class="sxs-lookup"><span data-stu-id="34fd6-123">Disabled functionality</span></span>
<span data-ttu-id="34fd6-124">Há algumas coisas que você não pode fazer ao usar um ASE com ILB.</span><span class="sxs-lookup"><span data-stu-id="34fd6-124">There are some things that you cannot do when using an ILB ASE.</span></span> <span data-ttu-id="34fd6-125">Entre elas:</span><span class="sxs-lookup"><span data-stu-id="34fd6-125">Those things include:</span></span>

* <span data-ttu-id="34fd6-126">usar IPSSL</span><span class="sxs-lookup"><span data-stu-id="34fd6-126">using IPSSL</span></span>
* <span data-ttu-id="34fd6-127">atribuir IP endereços para aplicativos específicos</span><span class="sxs-lookup"><span data-stu-id="34fd6-127">assigning IP addresses to specific apps</span></span>
* <span data-ttu-id="34fd6-128">comprar e usar um certificado com um aplicativo por meio do portal.</span><span class="sxs-lookup"><span data-stu-id="34fd6-128">buying and using a certificate with an app through the portal.</span></span> <span data-ttu-id="34fd6-129">Obviamente, você ainda pode obter certificados diretamente com uma Autoridade de Certificação e usá-los com seus aplicativos, mas não por meio do Portal do Azure.</span><span class="sxs-lookup"><span data-stu-id="34fd6-129">You can of course still obtain certificates directly with a Certificate Authority and use it with your apps, just not through the Azure portal.</span></span>

## <a name="creating-an-ilb-ase"></a><span data-ttu-id="34fd6-130">Criar um ILB do ASE</span><span class="sxs-lookup"><span data-stu-id="34fd6-130">Creating an ILB ASE</span></span>
<span data-ttu-id="34fd6-131">A criação de um ILB do ASE não é muito diferente da criação normal de um ASE.</span><span class="sxs-lookup"><span data-stu-id="34fd6-131">Creating an ILB ASE is not much different from creating an ASE normally.</span></span> <span data-ttu-id="34fd6-132">Para conferir uma discussão mais profunda sobre como criar um ASE, leia [Como criar um Ambiente do Serviço de Aplicativo][HowtoCreateASE].</span><span class="sxs-lookup"><span data-stu-id="34fd6-132">For a deeper discussion on creating an ASE read [How to Create an App Service Environment][HowtoCreateASE].</span></span> <span data-ttu-id="34fd6-133">O processo de criação de um ILB do ASE é o mesmo tanto para a criação de uma VNet durante a criação do ASE quanto para a seleção de uma VNet pré-existente.</span><span class="sxs-lookup"><span data-stu-id="34fd6-133">The process to create an ILB ASE is the same between creating a VNet during ASE creation or selecting a pre-existing VNet.</span></span> <span data-ttu-id="34fd6-134">Para criar um ILB do ASE:</span><span class="sxs-lookup"><span data-stu-id="34fd6-134">To create an ILB ASE:</span></span> 

1. <span data-ttu-id="34fd6-135">No Portal do Azure, escolha **Novo -> Web + Móvel -> Ambiente do Serviço de Aplicativo**</span><span class="sxs-lookup"><span data-stu-id="34fd6-135">In the Azure portal select **New -> Web + Mobile -> App Service Environment**</span></span>
2. <span data-ttu-id="34fd6-136">Selecione sua assinatura</span><span class="sxs-lookup"><span data-stu-id="34fd6-136">Select your subscription</span></span>
3. <span data-ttu-id="34fd6-137">Selecione ou crie um grupo de recursos</span><span class="sxs-lookup"><span data-stu-id="34fd6-137">Select or create a resource group</span></span>
4. <span data-ttu-id="34fd6-138">Selecione ou crie uma VNet</span><span class="sxs-lookup"><span data-stu-id="34fd6-138">Select or create a VNet</span></span>
5. <span data-ttu-id="34fd6-139">Crie uma sub-rede, se você selecionar uma VNet</span><span class="sxs-lookup"><span data-stu-id="34fd6-139">Create a subnet if selecting a VNet</span></span>
6. <span data-ttu-id="34fd6-140">Selecione **Rede Virtual/Localização -> Configuração de VNet** e defina o Tipo de VIP como Interno</span><span class="sxs-lookup"><span data-stu-id="34fd6-140">Select **Virtual Network/Location -> VNet Configuration** and set the VIP Type to Internal</span></span>
7. <span data-ttu-id="34fd6-141">Forneça um nome de subdomínio (este será o subdomínio usado para aplicativos criados nesse ASE)</span><span class="sxs-lookup"><span data-stu-id="34fd6-141">Provide subdomain name (this will be the subdomain used for apps created in this ASE)</span></span>
8. <span data-ttu-id="34fd6-142">Selecione OK e Criar</span><span class="sxs-lookup"><span data-stu-id="34fd6-142">Select Ok and then Create</span></span>

![][1]

<span data-ttu-id="34fd6-143">Na folha Rede Virtual, há uma opção de Configuração de Rede Virtual.</span><span class="sxs-lookup"><span data-stu-id="34fd6-143">Within the Virtual Network blade there is a VNet Configuration option.</span></span> <span data-ttu-id="34fd6-144">Isso permite a escolha entre um VIP Externo ou um VIP Interno.</span><span class="sxs-lookup"><span data-stu-id="34fd6-144">This lets you select between an External VIP or Internal VIP.</span></span> <span data-ttu-id="34fd6-145">O padrão é Externo.</span><span class="sxs-lookup"><span data-stu-id="34fd6-145">The default is External.</span></span> <span data-ttu-id="34fd6-146">Se você tiver definido como Externo, seu ASE usará um VIP acessível pela internet.</span><span class="sxs-lookup"><span data-stu-id="34fd6-146">If you have it set to External then your ASE will use an internet accessible VIP.</span></span> <span data-ttu-id="34fd6-147">Se você selecionar Interno, seu ASE será configurado com um ILB em um endereço IP em sua VNet.</span><span class="sxs-lookup"><span data-stu-id="34fd6-147">If you select Internal, your ASE will be configured with an ILB on an IP address within your VNet.</span></span> 

<span data-ttu-id="34fd6-148">Depois de selecionar Interno, a capacidade de adicionar mais endereços IP ao seu ASE será removida e, em vez disso, você precisará fornecer o subdomínio do ASE.</span><span class="sxs-lookup"><span data-stu-id="34fd6-148">After selecting Internal, the ability to add more IP addresses to your ASE is removed and instead you need to provide the subdomain of the ASE.</span></span> <span data-ttu-id="34fd6-149">Em um ASE com um VIP Externo, o nome do ASE é usado no subdomínio para aplicativos criados nesse ASE.</span><span class="sxs-lookup"><span data-stu-id="34fd6-149">In an ASE with an External VIP the name of the ASE is used in the subdomain for apps created in that ASE.</span></span> <span data-ttu-id="34fd6-150">Se o seu ASE recebeu o nome de ***contosotest*** e seu aplicativo nesse ASE recebeu o nome de ***mytest***, o subdomínio estará no formato ***contosotest.p.azurewebsites.net*** e a URL desse aplicativo será ***mytest.contosotest.p.azurewebsites.net***.</span><span class="sxs-lookup"><span data-stu-id="34fd6-150">If your ASE was called ***contosotest*** and your app in that ASE was called ***mytest*** then the subdomain would be of the format ***contosotest.p.azurewebsites.net*** and the URL for that app would be ***mytest.contosotest.p.azurewebsites.net***.</span></span> <span data-ttu-id="34fd6-151">Se você definir o Tipo VIP como Interno, o nome de seu ASE não será usado no subdomínio do ASE.</span><span class="sxs-lookup"><span data-stu-id="34fd6-151">If you set the VIP Type to Internal, your ASE name is not used in the subdomain for the ASE.</span></span> <span data-ttu-id="34fd6-152">Especifique o subdomínio explicitamente.</span><span class="sxs-lookup"><span data-stu-id="34fd6-152">You specify the subdomain explicitly.</span></span> <span data-ttu-id="34fd6-153">Se o subdomínio era ***contoso.corp.net*** e você criou um aplicativo nesse ASE chamado ***timereporting***, a URL para esse aplicativo seria ***timereporting.contoso.corp.net***.</span><span class="sxs-lookup"><span data-stu-id="34fd6-153">If your subdomain was ***contoso.corp.net*** and you made an app in that ASE named ***timereporting*** then the URL for that app would be ***timereporting.contoso.corp.net***.</span></span>

## <a name="apps-in-an-ilb-ase"></a><span data-ttu-id="34fd6-154">Aplicativos em um ILB do ASE</span><span class="sxs-lookup"><span data-stu-id="34fd6-154">Apps in an ILB ASE</span></span>
<span data-ttu-id="34fd6-155">A criação de um aplicativo em um ILB do ASE é igual à criação normal de um aplicativo em um ASE.</span><span class="sxs-lookup"><span data-stu-id="34fd6-155">Creating an app in an ILB ASE is the same as creating an app in an ASE normally.</span></span> 

1. <span data-ttu-id="34fd6-156">No Portal do Azure, escolha **Novo -> Web + Móvel -> Web** ou **Móvel** ou **Aplicativo de API**</span><span class="sxs-lookup"><span data-stu-id="34fd6-156">In the Azure portal select **New -> Web + Mobile -> Web** or **Mobile** or **API App**</span></span>
2. <span data-ttu-id="34fd6-157">Insira o nome do aplicativo</span><span class="sxs-lookup"><span data-stu-id="34fd6-157">Enter name of app</span></span>
3. <span data-ttu-id="34fd6-158">Escolha a assinatura</span><span class="sxs-lookup"><span data-stu-id="34fd6-158">Select subscription</span></span>
4. <span data-ttu-id="34fd6-159">Escolha ou crie um grupo de recursos</span><span class="sxs-lookup"><span data-stu-id="34fd6-159">Select or create resource group</span></span>
5. <span data-ttu-id="34fd6-160">Selecione ou crie um ASP (Plano do Serviço de Aplicativo).</span><span class="sxs-lookup"><span data-stu-id="34fd6-160">Select or create App Service Plan(ASP).</span></span> <span data-ttu-id="34fd6-161">Se está criando um novo ASP, selecione seu ASE como o local e selecione o pool de trabalho no qual você deseja criar o ASP.</span><span class="sxs-lookup"><span data-stu-id="34fd6-161">If creating a new ASP then select your ASE as the location and select the worker pool you want your ASP to be created in.</span></span> <span data-ttu-id="34fd6-162">Ao criar o ASP, selecione seu ASE como o local e o pool de trabalho.</span><span class="sxs-lookup"><span data-stu-id="34fd6-162">When you create the ASP you select your ASE as the location and the worker pool.</span></span> <span data-ttu-id="34fd6-163">Ao especificar o nome do aplicativo, você verá que o subdomínio no nome do aplicativo é substituído pelo subdomínio do ASE.</span><span class="sxs-lookup"><span data-stu-id="34fd6-163">When you specify the name of the app you will see that the subdomain under your app name is replaced by the subdomain for your ASE.</span></span> 
6. <span data-ttu-id="34fd6-164">Selecione Criar.</span><span class="sxs-lookup"><span data-stu-id="34fd6-164">Select Create.</span></span> <span data-ttu-id="34fd6-165">Você deve marcar a caixa de seleção **Fixar ao painel** se quiser que o aplicativo apareça em seu painel.</span><span class="sxs-lookup"><span data-stu-id="34fd6-165">You should select the **Pin to dashboard** checkbox if you want the app to show up on your dashboard.</span></span> 

![][2]

<span data-ttu-id="34fd6-166">Sob o nome do aplicativo, o nome de subdomínio é atualizado para refletir o subdomínio de seu ASE.</span><span class="sxs-lookup"><span data-stu-id="34fd6-166">Under the app name the subdomain name gets updated to reflect the subdomain of your ASE.</span></span> 

## <a name="post-ilb-ase-creation-validation"></a><span data-ttu-id="34fd6-167">Validação posterior à criação do ILB do ASE</span><span class="sxs-lookup"><span data-stu-id="34fd6-167">Post ILB ASE creation validation</span></span>
<span data-ttu-id="34fd6-168">Um ASE com ILB é ligeiramente diferente do ASE que não tem um ILB.</span><span class="sxs-lookup"><span data-stu-id="34fd6-168">An ILB ASE is slightly different than the non-ILB ASE.</span></span> <span data-ttu-id="34fd6-169">Como já observamos, é necessário gerenciar seu próprio DNS e você também precisa fornecer seu próprio certificado para conexões HTTPS.</span><span class="sxs-lookup"><span data-stu-id="34fd6-169">As already noted you need to manage your own DNS and you also have to provide your own certificate for HTTPS connections.</span></span> 

<span data-ttu-id="34fd6-170">Após a criação de seu ASE, você observará que o subdomínio mostra o subdomínio especificado e há um novo item no menu **Configuração** chamado **Certificado ILB**.</span><span class="sxs-lookup"><span data-stu-id="34fd6-170">After you create your ASE you will notice that the subdomain shows the subdomain you specified and there is a new item in the **Setting** menu called **ILB Certificate**.</span></span> <span data-ttu-id="34fd6-171">O ASE é criado com um certificado autoassinado, o que torna mais fácil testar o HTTPS.</span><span class="sxs-lookup"><span data-stu-id="34fd6-171">The ASE is created with a self-signed certificate which makes it easier to test HTTPS.</span></span> <span data-ttu-id="34fd6-172">O portal informará que você precisa fornecer seu próprio certificado para HTTPS, mas isso é para direcionar a ter um certificado que acompanha seu subdomínio.</span><span class="sxs-lookup"><span data-stu-id="34fd6-172">The portal will tell you that you need to provide your own certificate for HTTPS but this is to drive you to have a certificate that goes with your subdomain.</span></span> 

![][3]

<span data-ttu-id="34fd6-173">Se você está simplesmente experimentando coisas e não souber como criar um certificado, use o aplicativo de console IIS MMC para criar um certificado autoassinado.</span><span class="sxs-lookup"><span data-stu-id="34fd6-173">If you are simply trying things out and don't know how to create a certificate, you can use the IIS MMC console application to create a self signed certificate.</span></span> <span data-ttu-id="34fd6-174">Após a criação, você poderá exportá-lo como um arquivo .pfx e carregá-lo na interface de usuário do Certificado do ILB.</span><span class="sxs-lookup"><span data-stu-id="34fd6-174">Once it is created you can export it as a .pfx file and then upload it in the ILB Certificate UI.</span></span> <span data-ttu-id="34fd6-175">Quando você acessa um site protegido por um certificado autoassinado, seu navegador avisa você de que o site que você está acessando não é seguro devido à incapacidade de validar o certificado.</span><span class="sxs-lookup"><span data-stu-id="34fd6-175">When you access a site secured with a self-signed certificate, your browser will give you a warning that the site you are accessing is not secure due to the inability to validate the certificate.</span></span> <span data-ttu-id="34fd6-176">Se você quiser evitar esse aviso, precisará de um certificado devidamente assinado que corresponda ao seu subdomínio e tenha uma cadeia de confiança reconhecida pelo seu navegador.</span><span class="sxs-lookup"><span data-stu-id="34fd6-176">If you want to avoid that warning you need a properly signed certificate that matches your subdomain and has a chain of trust that is recognized by your browser.</span></span>

![][6]

<span data-ttu-id="34fd6-177">Se você quiser experimentar o fluxo com seus próprios certificados e testar o acesso HTTP e HTTPS para o seu ASE:</span><span class="sxs-lookup"><span data-stu-id="34fd6-177">If you want to try the flow with your own certificates and test both HTTP and HTTPS access to your ASE:</span></span>

1. <span data-ttu-id="34fd6-178">Acesse a interface do usuário do ASE após a criação do ASE em **ASE -> Configurações -> Certificados ILB**</span><span class="sxs-lookup"><span data-stu-id="34fd6-178">Go to ASE UI after ASE is created **ASE -> Settings -> ILB Certificates**</span></span>
2. <span data-ttu-id="34fd6-179">Defina o certificado ILB selecionando o arquivo pfx do certificado e forneça a senha.</span><span class="sxs-lookup"><span data-stu-id="34fd6-179">Set ILB certificate by selecting certificate pfx file and provide password.</span></span> <span data-ttu-id="34fd6-180">Esta etapa demora um pouco mais para ser processada, e a mensagem de que uma operação de dimensionamento está em andamento será exibida.</span><span class="sxs-lookup"><span data-stu-id="34fd6-180">This step takes a little while to process and the message that a scaling operation is in progress will be shown.</span></span>
3. <span data-ttu-id="34fd6-181">Obtenha o endereço do ILB para seu ASE (**ASE -> Propriedades -> Endereço IP Virtual**)</span><span class="sxs-lookup"><span data-stu-id="34fd6-181">Get the ILB address for your ASE (**ASE -> Properties -> Virtual IP Address**)</span></span>
4. <span data-ttu-id="34fd6-182">Crie um aplicativo Web no ASE após a criação</span><span class="sxs-lookup"><span data-stu-id="34fd6-182">Create a web app in ASE after creation</span></span> 
5. <span data-ttu-id="34fd6-183">Crie uma VM se você não tem uma nessa VNET (não na mesma sub-rede que o ASE, ou tudo pode falhar)</span><span class="sxs-lookup"><span data-stu-id="34fd6-183">Create a VM if you don't have one in that VNET (Not in the same subnet as the ASE or things break)</span></span>
6. <span data-ttu-id="34fd6-184">Configure o DNS para seu subdomínio.</span><span class="sxs-lookup"><span data-stu-id="34fd6-184">Set DNS for your subdomain.</span></span> <span data-ttu-id="34fd6-185">Você pode usar caracteres curinga com o subdomínio em seu DNS ou, se quer realizar alguns testes simples, editar o arquivo host na VM para definir o nome do aplicativo Web como o endereço IP VIP.</span><span class="sxs-lookup"><span data-stu-id="34fd6-185">You can use a wildcard with your subdomain in your DNS or if you want to do some simple tests, edit the hosts file on your VM to set web app name to VIP IP address.</span></span> <span data-ttu-id="34fd6-186">Se o seu ASE tem o nome de subdomínio .ilbase.com e você colocou o aplicativo Web mytestapp para ter como endereço mytestapp.ilbase.com, defina isso em seu arquivo host.</span><span class="sxs-lookup"><span data-stu-id="34fd6-186">If your ASE had the subdomain name .ilbase.com and you made the web app mytestapp so that it would be addressed at mytestapp.ilbase.com then set that in your hosts file.</span></span> <span data-ttu-id="34fd6-187">(No Windows, o arquivo host está em C:\Windows\System32\drivers\etc\ )</span><span class="sxs-lookup"><span data-stu-id="34fd6-187">(On Windows the hosts file is at C:\Windows\System32\drivers\etc\ )</span></span>
7. <span data-ttu-id="34fd6-188">Use um navegador nessa VM e acesse http://mytestapp.ilbase.com (ou o nome do aplicativo Web com o subdomínio)</span><span class="sxs-lookup"><span data-stu-id="34fd6-188">Use a browser on that VM and go to http://mytestapp.ilbase.com (or whatever your web app name is with your subdomain)</span></span>
8. <span data-ttu-id="34fd6-189">Use um navegador nessa VM e acesse https://mytestapp.ilbase.com. Será necessário aceitar a falta de segurança se estiver usando um certificado autoassinado.</span><span class="sxs-lookup"><span data-stu-id="34fd6-189">Use a browser on that VM and go to https://mytestapp.ilbase.com You will have to accept the lack of security if using a self-signed certificate.</span></span> 

<span data-ttu-id="34fd6-190">O endereço IP de seu ILB está listado em suas Propriedades como o Endereço IP Virtual</span><span class="sxs-lookup"><span data-stu-id="34fd6-190">The IP address for your ILB is listed in your Properties as the Virtual IP Address</span></span>

![][4]

## <a name="using-an-ilb-ase"></a><span data-ttu-id="34fd6-191">Como usar um ASE com ILB</span><span class="sxs-lookup"><span data-stu-id="34fd6-191">Using an ILB ASE</span></span>
#### <a name="network-security-groups"></a><span data-ttu-id="34fd6-192">Grupos de segurança de rede</span><span class="sxs-lookup"><span data-stu-id="34fd6-192">Network Security Groups</span></span>
<span data-ttu-id="34fd6-193">Um ASE com ILB permite o isolamento da rede para seus aplicativos, como se os aplicativos não pudessem ser acessados ou não fossem até mesmo conhecidos pela internet.</span><span class="sxs-lookup"><span data-stu-id="34fd6-193">An ILB ASE enables network isolation for your apps as the apps are not accessible or even known by the internet.</span></span> <span data-ttu-id="34fd6-194">Isso é excelente para hospedar sites de intranet, como aplicativos de linha de negócios.</span><span class="sxs-lookup"><span data-stu-id="34fd6-194">This is excellent for hosting intranet sites such as line of business applications.</span></span> <span data-ttu-id="34fd6-195">Quando for necessário restringir o acesso ainda mais, você poderá usar os NSGs (Grupos de Segurança de Rede) para controlar o acesso no nível da rede.</span><span class="sxs-lookup"><span data-stu-id="34fd6-195">When you need to restrict access even further you can still use Network Security Groups(NSGs) to control access at the network level.</span></span> 

<span data-ttu-id="34fd6-196">Se você quiser usar os NSGs para restringir o acesso, precisará fazer com que a comunicação que o ASE precisa para operar não seja interrompida.</span><span class="sxs-lookup"><span data-stu-id="34fd6-196">If you wish to use NSGs to further restrict access then you need to make sure you do not break the communication that the ASE needs in order to operate.</span></span> <span data-ttu-id="34fd6-197">Embora o acesso HTTP/HTTPS ocorra apenas por meio do ILB usado pelo ASE, o ASE ainda depende do recurso fora da VNet.</span><span class="sxs-lookup"><span data-stu-id="34fd6-197">Even though the HTTP/HTTPS access is only through the ILB used by the ASE the ASE still depends on resource outside of the VNet.</span></span> <span data-ttu-id="34fd6-198">Para ver qual acesso de rede ainda é necessário, examine as informações no documento sobre [Como controlar o tráfego de entrada para um ambiente do Serviço de Aplicativo][ControlInbound] e o documento sobre [Detalhes da configuração de rede para ambientes do Serviço de Aplicativo com o ExpressRoute][ExpressRoute].</span><span class="sxs-lookup"><span data-stu-id="34fd6-198">To see what network access is still required look at the information in the document on [Controlling Inbound Traffic to an App Service Environment][ControlInbound] and the document on [Network Configuration Details for App Service Environments with ExpressRoute][ExpressRoute].</span></span> 

<span data-ttu-id="34fd6-199">Para configurar seus NSGs, você precisa saber o endereço IP usado pelo Azure para gerenciar seu ASE.</span><span class="sxs-lookup"><span data-stu-id="34fd6-199">To configure your NSGs you need to know the IP address that is used by Azure to manage your ASE.</span></span> <span data-ttu-id="34fd6-200">Esse endereço IP também será o endereço IP de saída de seu ASE se ele fizer solicitações da internet.</span><span class="sxs-lookup"><span data-stu-id="34fd6-200">That IP address is also the outbound IP address from your ASE if it makes internet requests.</span></span> <span data-ttu-id="34fd6-201">O endereço IP de saída para o ASE permanece estático durante a vida de seu ASE.</span><span class="sxs-lookup"><span data-stu-id="34fd6-201">The outbound IP address for your ASE will remain static for the life of your ASE.</span></span> <span data-ttu-id="34fd6-202">Se você excluir e recriar seu ASE, você obterá um novo endereço IP.</span><span class="sxs-lookup"><span data-stu-id="34fd6-202">If you delete and recreate your ASE, you will get a new IP address.</span></span> <span data-ttu-id="34fd6-203">Para localizar esse endereço IP, acesse **Configurações -> Propriedades** e localize o **Endereço IP de Saída**.</span><span class="sxs-lookup"><span data-stu-id="34fd6-203">To find this IP address go to **Settings -> Properties** and find the **Outbound IP Address**.</span></span> 

![][5]

#### <a name="general-ilb-ase-management"></a><span data-ttu-id="34fd6-204">Gerenciamento geral do ASE com ILB</span><span class="sxs-lookup"><span data-stu-id="34fd6-204">General ILB ASE management</span></span>
<span data-ttu-id="34fd6-205">O gerenciamento de um ASE com ILB é basicamente o mesmo que gerenciar um ASE normalmente.</span><span class="sxs-lookup"><span data-stu-id="34fd6-205">Managing an ILB ASE is largely the same as managing an ASE normally.</span></span> <span data-ttu-id="34fd6-206">Você precisa aumentar seus pools de trabalho para hospedar mais instâncias de ASP e dimensionar os servidores Front-End para lidar com o aumento do tráfego HTTP/HTTPS.</span><span class="sxs-lookup"><span data-stu-id="34fd6-206">You need to scale up your worker pools to host more ASP instances and scale up your Front End servers to handle increased amounts of HTTP/HTTPS traffic.</span></span> <span data-ttu-id="34fd6-207">Para obter informações gerais sobre como gerenciar a configuração de um ASE, leia o documento sobre [Configurar um ambiente do Serviço de Aplicativo][ASEConfig].</span><span class="sxs-lookup"><span data-stu-id="34fd6-207">For general information on managing the configuration of an ASE, read the document on [Configuring an App Service Environment][ASEConfig].</span></span> 

<span data-ttu-id="34fd6-208">Os itens adicionais de gerenciamento são gerenciamento de certificados e gerenciamento de DNS.</span><span class="sxs-lookup"><span data-stu-id="34fd6-208">The additional management items are certificate management and DNS management.</span></span> <span data-ttu-id="34fd6-209">Você precisa obter e carregar o certificado usado para HTTPS após a criação do ASE com ILB e substitui-lo antes que expire.</span><span class="sxs-lookup"><span data-stu-id="34fd6-209">You need to obtain and upload the certificate used for HTTPS after ILB ASE creation and replace it before it expires.</span></span> <span data-ttu-id="34fd6-210">Como Azure é proprietário do domínio de base, podemos fornecer certificados para ASEs com um VIP externo.</span><span class="sxs-lookup"><span data-stu-id="34fd6-210">Because Azure owns the base domain we can provide certificates for ASEs with an External VIP.</span></span> <span data-ttu-id="34fd6-211">Como o subdomínio usado por um ASE com ILB pode ser qualquer coisa, você precisa fornecer seu próprio certificado para HTTPS.</span><span class="sxs-lookup"><span data-stu-id="34fd6-211">Since the subdomain used by an ILB ASE can be anything, you need to provide your own certificate for HTTPS.</span></span> 

#### <a name="dns-configuration"></a><span data-ttu-id="34fd6-212">Configuração de DNS</span><span class="sxs-lookup"><span data-stu-id="34fd6-212">DNS Configuration</span></span>
<span data-ttu-id="34fd6-213">Ao usar um VIP Externo, o DNS é gerenciado pelo Azure.</span><span class="sxs-lookup"><span data-stu-id="34fd6-213">When using an External VIP the DNS is managed by Azure.</span></span> <span data-ttu-id="34fd6-214">Qualquer aplicativo criado em seu ASE é automaticamente adicionado ao DNS do Azure, que é um DNS público.</span><span class="sxs-lookup"><span data-stu-id="34fd6-214">Any app created in your ASE is automatically added to Azure DNS which is a public DNS.</span></span> <span data-ttu-id="34fd6-215">Em um ASE com ILB, você precisa gerenciar seu próprio DNS.</span><span class="sxs-lookup"><span data-stu-id="34fd6-215">In an ILB ASE you have to manage your own DNS.</span></span> <span data-ttu-id="34fd6-216">Para um subdomínio específico, como contoso.corp.net, você precisa criar registros de DNS A que apontem para o endereço ILB para:</span><span class="sxs-lookup"><span data-stu-id="34fd6-216">For a given subdomain such as contoso.corp.net you need to create DNS A records that point to your ILB address for:</span></span>

    * 
    <span data-ttu-id="34fd6-217">publicação de ftp *.scm</span><span class="sxs-lookup"><span data-stu-id="34fd6-217">*.scm ftp publish</span></span> 


## <a name="getting-started"></a><span data-ttu-id="34fd6-218">Introdução</span><span class="sxs-lookup"><span data-stu-id="34fd6-218">Getting started</span></span>
<span data-ttu-id="34fd6-219">Todos os artigos e os Como fazer para Ambientes de Serviço de Aplicativo estão disponíveis no [LEIAME para Ambientes de Serviço de Aplicativo](../app-service/app-service-app-service-environments-readme.md).</span><span class="sxs-lookup"><span data-stu-id="34fd6-219">All articles and How-To's for App Service Environments are available in the [README for Application Service Environments](../app-service/app-service-app-service-environments-readme.md).</span></span>

<span data-ttu-id="34fd6-220">Para se familiarizar com os ambientes de serviço de aplicativo, consulte [Introdução aos ambientes de Serviço de Aplicativo][WhatisASE]</span><span class="sxs-lookup"><span data-stu-id="34fd6-220">To get started with App Service Environments, see [Introduction to App Service Environments][WhatisASE]</span></span>

<span data-ttu-id="34fd6-221">Para obter mais informações sobre a plataforma de Serviço de Aplicativo do Azure, consulte [Serviço de Aplicativo do Azure][AzureAppService].</span><span class="sxs-lookup"><span data-stu-id="34fd6-221">For more information about the Azure App Service platform, see [Azure App Service][AzureAppService].</span></span>

[!INCLUDE [app-service-web-whats-changed](../../includes/app-service-web-whats-changed.md)]

[!INCLUDE [app-service-web-try-app-service](../../includes/app-service-web-try-app-service.md)]

<!--Image references-->
[1]: ./media/app-service-environment-with-internal-load-balancer/ilbase-createilbase.png
[2]: ./media/app-service-environment-with-internal-load-balancer/ilbase-createapp.png
[3]: ./media/app-service-environment-with-internal-load-balancer/ilbase-newase.png
[4]: ./media/app-service-environment-with-internal-load-balancer/ilbase-vip.png
[5]: ./media/app-service-environment-with-internal-load-balancer/ilbase-externalvip.png
[6]: ./media/app-service-environment-with-internal-load-balancer/ilbase-ilbcertificate.png

<!--Links-->
[WhatisASE]: http://azure.microsoft.com/documentation/articles/app-service-app-service-environment-intro/
[HowtoCreateASE]: http://azure.microsoft.com/documentation/articles/app-service-web-how-to-create-an-app-service-environment/
[ControlInbound]: http://azure.microsoft.com/documentation/articles/app-service-app-service-environment-control-inbound-traffic/
[virtualnetwork]: https://azure.microsoft.com/documentation/articles/virtual-networks-faq/
[AppServicePricing]: http://azure.microsoft.com/pricing/details/app-service/
[AzureAppService]: http://azure.microsoft.com/documentation/articles/app-service-value-prop-what-is/
[ASEAutoscale]: http://azure.microsoft.com/documentation/articles/app-service-environment-auto-scale/
[ExpressRoute]: http://azure.microsoft.com/documentation/articles/app-service-app-service-environment-network-configuration-expressroute/
[vnetnsgs]: http://azure.microsoft.com/documentation/articles/virtual-networks-nsg/
[ASEConfig]: http://azure.microsoft.com/documentation/articles/app-service-web-configure-an-app-service-environment/
