---
title: "implantação de aaaFlighting (teste beta) no serviço de aplicativo do Azure"
description: "Saiba como tooflight novos recursos no seu aplicativo ou beta testar as atualizações neste tutorial de ponta a ponta. Ele reúne os recursos do Serviço de Aplicativo como publicação contínua, slots, roteamento de tráfego e integração do Application Insights."
services: app-service\web
documentationcenter: 
author: cephalin
manager: erikre
editor: 
ms.assetid: 17953c51-38f8-442d-bb0b-f69c1542f0e9
ms.service: app-service-web
ms.workload: web
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 02/02/2016
ms.author: cephalin
ms.openlocfilehash: e83477b1fe46be09e5baa7bc2bd239b840b05cf7
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="flighting-deployment-beta-testing-in-azure-app-service"></a><span data-ttu-id="8e8f9-104">Implantação flighting (teste beta) no Serviço de Aplicativo do Azure</span><span class="sxs-lookup"><span data-stu-id="8e8f9-104">Flighting deployment (beta testing) in Azure App Service</span></span>
<span data-ttu-id="8e8f9-105">Este tutorial mostra como toodo *implantações flighting* integrando Olá diversos recursos de [do serviço de aplicativo do Azure](http://go.microsoft.com/fwlink/?LinkId=529714) e [Azure Application Insights](/services/application-insights/).</span><span class="sxs-lookup"><span data-stu-id="8e8f9-105">This tutorial shows you how toodo *flighting deployments* by integrating hello various capabilities of [Azure App Service](http://go.microsoft.com/fwlink/?LinkId=529714) and [Azure Application Insights](/services/application-insights/).</span></span>

<span data-ttu-id="8e8f9-106">*Flighting* é um processo de implantação que valida um novo recurso ou alteração com um número limitado de clientes reais, e é um teste importante no cenário de produção.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-106">*Flighting* is a deployment process that validates a new feature or change with a limited number of real customers, and is a major testing in production scenario.</span></span> <span data-ttu-id="8e8f9-107">É toobeta parecido testes e às vezes é conhecido como "teste controlado voo".</span><span class="sxs-lookup"><span data-stu-id="8e8f9-107">It is akin toobeta testing and is sometimes known as "controlled test flight".</span></span> <span data-ttu-id="8e8f9-108">Muitas grandes empresas com uma presença na Web usam essa abordagem para obter validação antecipada sobre suas atualizações de aplicativo em sua prática de [desenvolvimento ágil](https://en.wikipedia.org/wiki/Agile_software_development).</span><span class="sxs-lookup"><span data-stu-id="8e8f9-108">Many large enterprises with a web presence use this approach to get early validation on their app updates in their practice of [agile development](https://en.wikipedia.org/wiki/Agile_software_development).</span></span> <span data-ttu-id="8e8f9-109">Serviço de aplicativo do Azure permite que você teste toointegrate em produção com a publicação contínua e Application Insights tooimplement Olá mesmo cenário DevOps.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-109">Azure App Service enables you toointegrate test in production with continous publishing and Application Insights tooimplement hello same DevOps scenario.</span></span> <span data-ttu-id="8e8f9-110">Entre os benefícios dessa abordagem estão:</span><span class="sxs-lookup"><span data-stu-id="8e8f9-110">Benefits of this approach include:</span></span>

* <span data-ttu-id="8e8f9-111">**Obter comentários real *antes de* atualizações são lançada tooproduction** -Olá somente coisa melhor do que obter comentários assim que você soltar é obter comentários antes de liberar.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-111">**Gain real feedback *before* updates are released tooproduction** - hello only thing better than gaining feedback as soon as you release is gaining feedback before you release.</span></span> <span data-ttu-id="8e8f9-112">Você pode testar atualizações com o tráfego de usuário real e comportamentos antecipada desejados no ciclo de vida do hello.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-112">You can test updates with real user traffic and behaviors as early as you desire in hello product life cycle.</span></span>
* <span data-ttu-id="8e8f9-113">**Aprimore o [CTDD (desenvolvimento contínuo controlado por testes)](https://en.wikipedia.org/wiki/Continuous_test-driven_development)** - ao integrar o teste em produção com a integração e instrumentação contínuas com o Application Insights, a validação do usuário ocorre automaticamente e desde o início do ciclo de vida do produto.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-113">**Enhance [continuous test-driven development (CTDD)](https://en.wikipedia.org/wiki/Continuous_test-driven_development)** - By integrating test in production with continuous integration and instrumentation with Application Insights, user validation happens early and automatically in your product life cycle.</span></span> <span data-ttu-id="8e8f9-114">Isso ajuda a reduzir os investimentos em tempo na execução de teste manual.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-114">This helps reduce time investments in manual test execution.</span></span>
* <span data-ttu-id="8e8f9-115">**Otimizar o fluxo de trabalho de teste** -através da automação de teste em produção com a instrumentação de monitoramento contínua, você pode potencialmente atingir Olá objetivos de vários tipos de testes em um único processo, como [integração](https://en.wikipedia.org/wiki/Integration_testing), [regressão](https://en.wikipedia.org/wiki/Regression_testing), [usabilidade](https://en.wikipedia.org/wiki/Usability_testing), acessibilidade, localização, [desempenho](https://en.wikipedia.org/wiki/Software_performance_testing), [segurança](https://en.wikipedia.org/wiki/Security_testing), e [ aceitação](https://en.wikipedia.org/wiki/Acceptance_testing).</span><span class="sxs-lookup"><span data-stu-id="8e8f9-115">**Optimize test workflow** - By automating test in production with continuous monitoring instrumentation, you can potentially accomplish hello goals of various kinds of tests in a single process, such as [integration](https://en.wikipedia.org/wiki/Integration_testing), [regression](https://en.wikipedia.org/wiki/Regression_testing), [usability](https://en.wikipedia.org/wiki/Usability_testing), accessibility, localization, [performance](https://en.wikipedia.org/wiki/Software_performance_testing), [security](https://en.wikipedia.org/wiki/Security_testing), and [acceptance](https://en.wikipedia.org/wiki/Acceptance_testing).</span></span>

<span data-ttu-id="8e8f9-116">Uma implantação flighting não se trata apenas do roteamento de tráfego em tempo real.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-116">A flighting deployment is not just about routing live traffic.</span></span> <span data-ttu-id="8e8f9-117">Em tal implantação deseja toogain insight assim que possível, se é um erro inesperado, degradação de desempenho, problemas de experiência do usuário.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-117">In such a deployment you want toogain insight as quickly as possible, whether it be an unexpected bug, performance degradation, user experience issues.</span></span> <span data-ttu-id="8e8f9-118">Lembre-se de que você está lidando com clientes reais.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-118">Remember, you are dealing with real customers.</span></span> <span data-ttu-id="8e8f9-119">Caso toodo à direita, você deve garantir que você configurou seu toogather implantação flighting todos os dados de saudação, você precisa em ordem toomake uma decisão informada para a próxima etapa.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-119">So toodo it right, you must make sure that you have set up your flighting deployment toogather all hello data you need in order toomake an informed decision for your next step.</span></span> <span data-ttu-id="8e8f9-120">Este tutorial mostra como toocollect dados com o Application Insights, mas você podem usar o New Relic ou outras tecnologias que atenda às seu cenário.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-120">This tutorial shows you how toocollect data with Application Insights, but you can use New Relic or other technologies that suits your scenario.</span></span>

## <a name="what-you-will-do"></a><span data-ttu-id="8e8f9-121">O que você fará</span><span class="sxs-lookup"><span data-stu-id="8e8f9-121">What you will do</span></span>
<span data-ttu-id="8e8f9-122">Neste tutorial, você aprenderá como toobring Olá tootest juntos cenários a seguir em seu aplicativo de serviço de aplicativo em produção:</span><span class="sxs-lookup"><span data-stu-id="8e8f9-122">In this tutorial, you will learn how toobring hello following scenarios together tootest your App Service app in production:</span></span>

* <span data-ttu-id="8e8f9-123">[Rotear o tráfego de produção](app-service-web-test-in-production-get-start.md) tooyour beta aplicativo</span><span class="sxs-lookup"><span data-stu-id="8e8f9-123">[Route production traffic](app-service-web-test-in-production-get-start.md) tooyour beta app</span></span>
* <span data-ttu-id="8e8f9-124">[Instrumentar seu aplicativo](../application-insights/app-insights-web-track-usage.md) métricas úteis tooobtain</span><span class="sxs-lookup"><span data-stu-id="8e8f9-124">[Instrument your app](../application-insights/app-insights-web-track-usage.md) tooobtain useful metrics</span></span>
* <span data-ttu-id="8e8f9-125">Implantar continuamente seu aplicativo beta e rastrear métricas de aplicativo em tempo real</span><span class="sxs-lookup"><span data-stu-id="8e8f9-125">Continuously deploy your beta app and track live app metrics</span></span>
* <span data-ttu-id="8e8f9-126">Métricas de comparação entre o aplicativo de produção de hello e Olá beta aplicativo toosee como código altera traduzem tooresults</span><span class="sxs-lookup"><span data-stu-id="8e8f9-126">Compare metrics between hello production app and hello beta app toosee how code changes translate tooresults</span></span>

## <a name="what-you-will-need"></a><span data-ttu-id="8e8f9-127">O que será necessário</span><span class="sxs-lookup"><span data-stu-id="8e8f9-127">What you will need</span></span>
* <span data-ttu-id="8e8f9-128">Uma conta do Azure</span><span class="sxs-lookup"><span data-stu-id="8e8f9-128">An Azure account</span></span>
* <span data-ttu-id="8e8f9-129">Uma conta do [GitHub](https://github.com/)</span><span class="sxs-lookup"><span data-stu-id="8e8f9-129">A [GitHub](https://github.com/) account</span></span>
* <span data-ttu-id="8e8f9-130">Visual Studio 2015 - você pode baixar Olá [Community edition](https://www.visualstudio.com/en-us/products/visual-studio-express-vs.aspx).</span><span class="sxs-lookup"><span data-stu-id="8e8f9-130">Visual Studio 2015 - you can download hello [Community edition](https://www.visualstudio.com/en-us/products/visual-studio-express-vs.aspx).</span></span>
* <span data-ttu-id="8e8f9-131">Shell de Git (instalado com [GitHub para Windows](https://windows.github.com/))-isso permite que você toorun os dois comandos Git e do PowerShell de Olá no hello mesma sessão</span><span class="sxs-lookup"><span data-stu-id="8e8f9-131">Git Shell (installed with [GitHub for Windows](https://windows.github.com/)) - this enables you toorun both hello Git and PowerShell commands in hello same session</span></span>
* <span data-ttu-id="8e8f9-132">Bits do [Azure PowerShell](https://github.com/Azure/azure-powershell/releases/download/v0.9.8-September2015/azure-powershell.0.9.8.msi) mais recentes</span><span class="sxs-lookup"><span data-stu-id="8e8f9-132">Latest [Azure PowerShell](https://github.com/Azure/azure-powershell/releases/download/v0.9.8-September2015/azure-powershell.0.9.8.msi) bits</span></span>
* <span data-ttu-id="8e8f9-133">Noções básicas sobre a seguir hello:</span><span class="sxs-lookup"><span data-stu-id="8e8f9-133">Basic understanding of hello following:</span></span>
  * <span data-ttu-id="8e8f9-134">Implantação do modelo do [Azure Resource Manager](../azure-resource-manager/resource-group-overview.md) (veja [Implantar um aplicativo complexo de modo previsível no Azure](app-service-deploy-complex-application-predictably.md))</span><span class="sxs-lookup"><span data-stu-id="8e8f9-134">[Azure Resource Manager](../azure-resource-manager/resource-group-overview.md) template deployment (see [Deploy a complex application predictably in Azure](app-service-deploy-complex-application-predictably.md))</span></span>
  * [<span data-ttu-id="8e8f9-135">Git</span><span class="sxs-lookup"><span data-stu-id="8e8f9-135">Git</span></span>](http://git-scm.com/documentation)
  * [<span data-ttu-id="8e8f9-136">PowerShell</span><span class="sxs-lookup"><span data-stu-id="8e8f9-136">PowerShell</span></span>](https://technet.microsoft.com/library/bb978526.aspx)

> [!NOTE]
> <span data-ttu-id="8e8f9-137">Você precisa de uma conta do Azure toocomplete neste tutorial:</span><span class="sxs-lookup"><span data-stu-id="8e8f9-137">You need an Azure account toocomplete this tutorial:</span></span>
>
> * <span data-ttu-id="8e8f9-138">Você pode [abrir uma conta do Azure gratuitamente](https://azure.microsoft.com/pricing/free-trial/) -você obtém créditos você pode usar tootry out paga serviços do Azure e mesmo depois que eles são usados você pode manter a conta de saudação e use livre serviços do Azure, como aplicativos Web.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-138">You can [open an Azure account for free](https://azure.microsoft.com/pricing/free-trial/) - You get credits you can use tootry out paid Azure services, and even after they're used up you can keep hello account and use free Azure services, such as Web Apps.</span></span>
> * <span data-ttu-id="8e8f9-139">É possível [ativar os benefícios para assinantes do Visual Studio](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/) – todos os meses, sua assinatura do Visual Studio concede créditos que podem ser usados para experimentar serviços pagos do Azure.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-139">You can [activate Visual Studio subscriber benefits](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/) - Your Visual Studio subscription gives you credits every month that you can use for paid Azure services.</span></span>
>
> <span data-ttu-id="8e8f9-140">Se você quiser tooget iniciado com o serviço de aplicativo do Azure antes de se inscrever para uma conta do Azure, vá muito[tente do serviço de aplicativo](https://azure.microsoft.com/try/app-service/), onde você pode criar imediatamente um aplicativo web de curta duração starter no serviço de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-140">If you want tooget started with Azure App Service before signing up for an Azure account, go too[Try App Service](https://azure.microsoft.com/try/app-service/), where you can immediately create a short-lived starter web app in App Service.</span></span> <span data-ttu-id="8e8f9-141">Nenhum cartão de crédito é exigido, sem compromissos.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-141">No credit cards required; no commitments.</span></span>
>
>

## <a name="set-up-your-production-web-app"></a><span data-ttu-id="8e8f9-142">Configurar seu aplicativo Web de produção</span><span class="sxs-lookup"><span data-stu-id="8e8f9-142">Set up your production web app</span></span>
> [!NOTE]
> <span data-ttu-id="8e8f9-143">script Hello usado neste tutorial automaticamente irá configurar a publicação contínua de seu repositório GitHub.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-143">hello script used in this tutorial will automatically configure continuous publishing from your GitHub repository.</span></span> <span data-ttu-id="8e8f9-144">Isso exige que suas credenciais do GitHub já são armazenados no Azure, caso contrário, a implantação de Olá script falhará durante a tentativa de tooconfigure configurações de controle de origem para os aplicativos web hello.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-144">This requires that your GitHub credentials are already stored in Azure, otherwise hello scripted deployment will fail when attempting tooconfigure source control settings for hello web apps.</span></span>
>
> <span data-ttu-id="8e8f9-145">toostore seu GitHub credenciais no Azure, criar um aplicativo web no hello [Portal do Azure](https://portal.azure.com/) e [configurar implantação GitHub](app-service-continuous-deployment.md).</span><span class="sxs-lookup"><span data-stu-id="8e8f9-145">toostore your GitHub credentials in Azure, create a web app in hello [Azure Portal](https://portal.azure.com/) and [configure GitHub deployment](app-service-continuous-deployment.md).</span></span> <span data-ttu-id="8e8f9-146">Você só precisa toodo desta vez.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-146">You only need toodo this once.</span></span>
>
>

<span data-ttu-id="8e8f9-147">Em um cenário típico de DevOps, você tem um aplicativo que está em execução no Azure e desejar toomake tooit de alterações por meio da publicação contínua.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-147">In a typical DevOps scenario, you have an application that’s running live in Azure, and you want toomake changes tooit through continuous publishing.</span></span> <span data-ttu-id="8e8f9-148">Nesse cenário, você implantará tooproduction um modelo que você foram desenvolvidos e testados.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-148">In this scenario, you will deploy tooproduction a template that you have developed and tested.</span></span>

1. <span data-ttu-id="8e8f9-149">Criar seu próprio bifurcação de saudação [ToDoApp](https://github.com/azure-appservice-samples/ToDoApp) repositório.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-149">Create your own fork of hello [ToDoApp](https://github.com/azure-appservice-samples/ToDoApp) repository.</span></span> <span data-ttu-id="8e8f9-150">Para obter informações sobre como criar a bifurcação, consulte [Bifurcar um repositório](https://help.github.com/articles/fork-a-repo/).</span><span class="sxs-lookup"><span data-stu-id="8e8f9-150">For information on creating your fork, see [Fork a Repo](https://help.github.com/articles/fork-a-repo/).</span></span> <span data-ttu-id="8e8f9-151">Depois que a bifurcação é criada, você pode vê-la no navegador.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-151">Once your fork is created, you can see it in your browser.</span></span>

   ![](./media/app-service-agile-software-development/production-1-private-repo.png)
2. <span data-ttu-id="8e8f9-152">Abra uma sessão do Git Shell.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-152">Open a Git Shell session.</span></span> <span data-ttu-id="8e8f9-153">Se ainda não tiver o Git Shell, instale o [GitHub para Windows](https://windows.github.com/) agora.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-153">If you don't have Git Shell yet, install [GitHub for Windows](https://windows.github.com/) now.</span></span>
3. <span data-ttu-id="8e8f9-154">Crie um clone local de sua bifurcação executando Olá comando a seguir:</span><span class="sxs-lookup"><span data-stu-id="8e8f9-154">Create a local clone of your fork by executing hello following command:</span></span>

     <span data-ttu-id="8e8f9-155">git clone https://github.com/<your_fork>/ToDoApp.git</span><span class="sxs-lookup"><span data-stu-id="8e8f9-155">git clone https://github.com/<your_fork>/ToDoApp.git</span></span>
4. <span data-ttu-id="8e8f9-156">Uma vez que o clone local, navegue muito*&lt;repository_root >*\ARMTemplates e execução Olá deploy.ps1 script com um sufixo exclusivo, conforme mostrado abaixo:</span><span class="sxs-lookup"><span data-stu-id="8e8f9-156">Once you have your local clone, navigate too*&lt;repository_root>*\ARMTemplates, and run hello deploy.ps1 script with a unique suffix, as shown below:</span></span>

     <span data-ttu-id="8e8f9-157">.\deploy.ps1 –RepoUrl https://github.com/<your_fork>/todoapp.git -ResourceGroupSuffix <your_suffix></span><span class="sxs-lookup"><span data-stu-id="8e8f9-157">.\deploy.ps1 –RepoUrl https://github.com/<your_fork>/todoapp.git -ResourceGroupSuffix <your_suffix></span></span>
5. <span data-ttu-id="8e8f9-158">Quando solicitado, digite Olá desejado de nome de usuário e senha para acesso ao banco de dados.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-158">When prompted, type in hello desired username and password for database access.</span></span> <span data-ttu-id="8e8f9-159">Lembre-se de credenciais de seu banco de dados, pois você precisará toospecify-las novamente quando atualizar Olá grupo de recursos.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-159">Remember your database credentials because you will need toospecify them again when updating hello resource group.</span></span>

   <span data-ttu-id="8e8f9-160">Você deve ver Olá provisionamento progresso de vários recursos do Azure.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-160">You should see hello provisioning progress of various Azure resources.</span></span> <span data-ttu-id="8e8f9-161">Quando a implantação for concluída, o script hello Iniciar aplicativo hello no navegador hello e oferecem um bipe amigável.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-161">When deployment completes, hello script will launch hello application in hello browser and give you a friendly beep.</span></span>
   ![](./media/app-service-web-test-in-production-controlled-test-flight/00.1-app-in-browser.png)
6. <span data-ttu-id="8e8f9-162">De volta à sessão do Git Shell, execute:</span><span class="sxs-lookup"><span data-stu-id="8e8f9-162">Back in your Git Shell session, run:</span></span>

     <span data-ttu-id="8e8f9-163">.\swap –Name ToDoApp<your_suffix></span><span class="sxs-lookup"><span data-stu-id="8e8f9-163">.\swap –Name ToDoApp<your_suffix></span></span>

   ![](./media/app-service-web-test-in-production-controlled-test-flight/00.2-swap-to-production.png)
7. <span data-ttu-id="8e8f9-164">Quando o script hello termina, volte toobrowse toohello endereço do front-end (http://ToDoApp*&lt;your_suffix >*.azurewebsites.net/) aplicativo hello de toosee em execução em produção.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-164">When hello script finishes, go back toobrowse toohello frontend’s address (http://ToDoApp*&lt;your_suffix>*.azurewebsites.net/) toosee hello application running in production.</span></span>
8. <span data-ttu-id="8e8f9-165">Faça logon no hello [Portal do Azure](https://portal.azure.com/) e veja o que é criado.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-165">Log into hello [Azure Portal](https://portal.azure.com/) and take a look at what’s created.</span></span>

   <span data-ttu-id="8e8f9-166">Você deve ser capaz de toosee dois os aplicativos web no hello mesmo grupo de recursos, um com hello `Api` sufixo no nome de saudação.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-166">You should be able toosee two web apps in hello same resource group, one with hello `Api` suffix in hello name.</span></span> <span data-ttu-id="8e8f9-167">Se você examinar o modo de exibição de grupo de recursos Olá, você também verá Olá banco de dados SQL e servidor, Olá plano de serviço de aplicativo e slots de preparo Olá para aplicativos da web de saudação.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-167">If you look at hello resource group view, you will also see hello SQL Database and server, hello App Service plan, and hello staging slots for hello web apps.</span></span> <span data-ttu-id="8e8f9-168">Navegue pelos recursos diferentes hello e compará-los com  *&lt;repository_root >*toosee \ARMTemplates\ProdAndStage.json como eles são configurados no modelo de saudação.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-168">Browse through hello different resources and compare them with *&lt;repository_root>*\ARMTemplates\ProdAndStage.json toosee how they are configured in hello template.</span></span>

   ![](./media/app-service-web-test-in-production-controlled-test-flight/00.3-resource-group-view.png)

<span data-ttu-id="8e8f9-169">Você configurou o aplicativo de produção de hello.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-169">You have set up hello production app.</span></span>  <span data-ttu-id="8e8f9-170">Agora, vamos imaginar que você receba comentários que usabilidade é ruim para o aplicativo hello.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-170">Now, let's imagine that you receive feedback that usability is poor for hello app.</span></span> <span data-ttu-id="8e8f9-171">Portanto, você decide tooinvestigate.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-171">So you decide tooinvestigate.</span></span> <span data-ttu-id="8e8f9-172">Você vai tooinstrument toogive seu aplicativo você comentários.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-172">You're going tooinstrument your app toogive you feedback.</span></span>

## <a name="investigate-instrument-your-client-app-for-monitoringmetrics"></a><span data-ttu-id="8e8f9-173">Investigue: instrumentar o aplicativo cliente para monitoramento/métricas</span><span class="sxs-lookup"><span data-stu-id="8e8f9-173">Investigate: Instrument your client app for monitoring/metrics</span></span>
1. <span data-ttu-id="8e8f9-174">Abra *&lt;raiz_do-repositório>*\src\MultiChannelToDo.sln in Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-174">Open *&lt;repository_root>*\src\MultiChannelToDo.sln in Visual Studio.</span></span>
2. <span data-ttu-id="8e8f9-175">Restaure todos os pacotes NuGet clicando com o botão direito do mouse na solução > **Gerenciar Pacotes NuGet da Solução** > **Restaurar**.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-175">Restore all Nuget packages by right-clicking solution > **Manage NuGet Packages for Solution** > **Restore**.</span></span>
3. <span data-ttu-id="8e8f9-176">Clique com botão direito **MultiChannelToDo.Web** > **adicionar telemetria do Application Insights** > **configurar** > alterar o grupo de recursos tooToDoApp*&lt;your_suffix >* > **tooProject adicionar Application Insights**.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-176">Right-click **MultiChannelToDo.Web** > **Add Application Insights Telemetry** > **Configure Settings** > Change resource group tooToDoApp*&lt;your_suffix>* > **Add Application Insights tooProject**.</span></span>
4. <span data-ttu-id="8e8f9-177">Em Olá Portal do Azure, abra a folha de saudação para Olá **MultiChannelToDo.Web** recurso do Application Insight.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-177">In hello Azure Portal, open hello blade for hello **MultiChannelToDo.Web** Application Insight resource.</span></span> <span data-ttu-id="8e8f9-178">Em seguida, em hello **integridade do aplicativo** parte, clique em **Saiba como a página do navegador toocollect carregar dados** > Copiar código.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-178">Then in hello **Application health** part, click **Learn how toocollect browser page load data** > copy code.</span></span>
5. <span data-ttu-id="8e8f9-179">Adicionar Olá copiado o código de instrumentação JS muito*&lt;repository_root >*\src\MultiChannelToDo.Web\app\Index.cshtml logo antes de fechamento Olá `<heading>` marca.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-179">Add hello copied JS instrumentation code too*&lt;repository_root>*\src\MultiChannelToDo.Web\app\Index.cshtml, just before hello closing `<heading>` tag.</span></span> <span data-ttu-id="8e8f9-180">Ela deve conter a chave de instrumentação exclusivo de saudação do recurso Application Insight.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-180">It should contain hello unique instrumentation key of your Application Insight resource.</span></span>

        <script type="text/javascript">
        var appInsights=window.appInsights||function(config){
            function s(config){t[config]=function(){var i=arguments;t.queue.push(function(){t[config].apply(t,i)})}}var t={config:config},r=document,f=window,e="script",o=r.createElement(e),i,u;for(o.src=config.url||"//az416426.vo.msecnd.net/scripts/a/ai.0.js",r.getElementsByTagName(e)[0].parentNode.appendChild(o),t.cookie=r.cookie,t.queue=[],i=["Event","Exception","Metric","PageView","Trace"];i.length;)s("track"+i.pop());return config.disableExceptionTracking||(i="onerror",s("_"+i),u=f[i],f[i]=function(config,r,f,e,o){var s=u&&u(config,r,f,e,o);return s!==!0&&t["_"+i](config,r,f,e,o),s}),t
        }({
            instrumentationKey:"<your_unique_instrumentation_key>"
        });

        window.appInsights=appInsights;
        appInsights.trackPageView();
        </script>
6. <span data-ttu-id="8e8f9-181">Envie eventos personalizados tooApplication Insights para cliques adicionando Olá inferior do código toohello do corpo a seguir:</span><span class="sxs-lookup"><span data-stu-id="8e8f9-181">Send custom events tooApplication Insights for mouse clicks by adding hello following code toohello bottom of body:</span></span>

       <script>
           $(document.body).find("*").click(function(event) {

               appInsights.trackEvent(event.target.tagName + ": " + event.target.className);
           });
       </script>

   <span data-ttu-id="8e8f9-182">Este trecho de código JavaScript envia um evento personalizado tooApplication Insights toda vez que um usuário clica em qualquer lugar no aplicativo web de saudação.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-182">This JavaScript snippet sends a custom event tooApplication Insights every time a user clicks anywhere in hello web app.</span></span>
7. <span data-ttu-id="8e8f9-183">No Shell de Git, confirmar e enviar por push a bifurcação de tooyour alterações no GitHub.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-183">In Git Shell, commit and push your changes tooyour fork in GitHub.</span></span> <span data-ttu-id="8e8f9-184">Em seguida, aguarde o navegador de toorefresh de clientes.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-184">Then, wait for clients toorefresh browser.</span></span>

       git add -A :/
       git commit -m "add AI configuration for client app"
       git push origin master
8. <span data-ttu-id="8e8f9-185">Saudação de permuta implantado tooproduction de alterações do aplicativo:</span><span class="sxs-lookup"><span data-stu-id="8e8f9-185">Swap hello deployed app changes tooproduction:</span></span>

     <span data-ttu-id="8e8f9-186">.\swap –Name ToDoApp<your_suffix></span><span class="sxs-lookup"><span data-stu-id="8e8f9-186">.\swap –Name ToDoApp<your_suffix></span></span>
9. <span data-ttu-id="8e8f9-187">Procure o recurso do Application Insights toohello que você configurou.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-187">Browse toohello Application Insights resource that you configured.</span></span> <span data-ttu-id="8e8f9-188">Clique em Eventos personalizados.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-188">Click Custom events.</span></span>

   ![](./media/app-service-web-test-in-production-controlled-test-flight/01-custom-events.png)

   <span data-ttu-id="8e8f9-189">Se você não vir as métricas para eventos personalizados, aguarde alguns minutos e clique em **Atualizar**.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-189">If you don't see metrics for custom events, wait a few minutes and click **Refresh**.</span></span>

<span data-ttu-id="8e8f9-190">Suponha que você veja um gráfico como o mostrado abaixo:</span><span class="sxs-lookup"><span data-stu-id="8e8f9-190">Suppose you see a chart like below:</span></span>

![](./media/app-service-web-test-in-production-controlled-test-flight/02-custom-events-chart-view.png)

<span data-ttu-id="8e8f9-191">E a grade de eventos Olá abaixo dele:</span><span class="sxs-lookup"><span data-stu-id="8e8f9-191">And hello event grid below it:</span></span>

![](./media/app-service-web-test-in-production-controlled-test-flight/03-custom-event-grid-view.png)

<span data-ttu-id="8e8f9-192">De acordo com o código do aplicativo ToDoApp tooyour, Olá **botão** evento corresponde toohello no botão Enviar e hello **entrada** evento corresponde a caixa de texto toohello.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-192">According tooyour ToDoApp application code, hello **BUTTON** event corresponds toohello submit button, and hello **INPUT** event corresponds toohello textbox.</span></span> <span data-ttu-id="8e8f9-193">Até agora, as coisas fazem sentido.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-193">So far, things make sense.</span></span> <span data-ttu-id="8e8f9-194">No entanto, parece que há uma boa quantidade de cliques e cliques muito poucos itens de tarefas pendentes de hello (Olá **LI** eventos).</span><span class="sxs-lookup"><span data-stu-id="8e8f9-194">However, it looks like there's a good amount of clicks and very few clicks on hello to-do items (hello **LI** events).</span></span>

<span data-ttu-id="8e8f9-195">Com base nesse, você formulário sua hipótese que alguns usuários confundido qual parte da saudação interface do usuário é clicável e isso ocorre porque o estilo do cursor Olá para seleção de texto quando ele for colocado em itens de lista hello e seus ícones.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-195">Based on this, you form your hypothesis that some users are confused which part of hello UI is clickable and it is because hello cursor is styled for text selection when it hovers on hello list items and their icons.</span></span>

![](./media/app-service-web-test-in-production-controlled-test-flight/04-to-do-list-item-ui.png)

<span data-ttu-id="8e8f9-196">Isso pode ser um exemplo forçado.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-196">This might be a contrived example.</span></span> <span data-ttu-id="8e8f9-197">No entanto, você está indo toomake um aplicativo de tooyour aperfeiçoamento e, em seguida, executar um flighting comentários de usabilidade de tooget de implantação de clientes em tempo real.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-197">Nevertheless, you're going toomake an improvement tooyour app, and then perform a flighting deployment tooget usability feedback from live customers.</span></span>

### <a name="instrument-your-server-app-for-monitoringmetrics"></a><span data-ttu-id="8e8f9-198">Instrumentar seu aplicativo de servidor para monitoramento/métricas</span><span class="sxs-lookup"><span data-stu-id="8e8f9-198">Instrument your server app for monitoring/metrics</span></span>
<span data-ttu-id="8e8f9-199">Isso é uma tangente pois cenário Olá demonstrado neste tutorial lida apenas transações com hello aplicativo de cliente.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-199">This is a tangent since hello scenario demonstrated in this tutorial only deals with hello client app.</span></span> <span data-ttu-id="8e8f9-200">No entanto, para fins de integridade você configurará saudação do servidor app.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-200">However, for completeness you will set up hello server-side app.</span></span>

1. <span data-ttu-id="8e8f9-201">Clique com botão direito **MultiChannelToDo** > **adicionar telemetria do Application Insights** > **configurar** > alterar o grupo de recursos tooToDoApp*&lt;your_suffix >* > **tooProject adicionar Application Insights**.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-201">Right-click **MultiChannelToDo** > **Add Application Insights Telemetry** > **Configure Settings** > Change resource group tooToDoApp*&lt;your_suffix>* > **Add Application Insights tooProject**.</span></span>
2. <span data-ttu-id="8e8f9-202">No Shell de Git, confirmar e enviar por push a bifurcação de tooyour alterações no GitHub.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-202">In Git Shell, commit and push your changes tooyour fork in GitHub.</span></span> <span data-ttu-id="8e8f9-203">Em seguida, aguarde o navegador de toorefresh de clientes.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-203">Then, wait for clients toorefresh browser.</span></span>

       git add -A :/
       git commit -m "add AI configuration for server app"
       git push origin master
3. <span data-ttu-id="8e8f9-204">Saudação de permuta implantado tooproduction de alterações do aplicativo:</span><span class="sxs-lookup"><span data-stu-id="8e8f9-204">Swap hello deployed app changes tooproduction:</span></span>

     <span data-ttu-id="8e8f9-205">.\swap –Name ToDoApp<your_suffix></span><span class="sxs-lookup"><span data-stu-id="8e8f9-205">.\swap –Name ToDoApp<your_suffix></span></span>

<span data-ttu-id="8e8f9-206">É isso!</span><span class="sxs-lookup"><span data-stu-id="8e8f9-206">That's it!</span></span>

## <a name="investigate-add-slot-specific-tags-tooyour-client-app-metrics"></a><span data-ttu-id="8e8f9-207">Investigue: Adicionar métricas de aplicativo de cliente de tooyour marcas específicas de slot</span><span class="sxs-lookup"><span data-stu-id="8e8f9-207">Investigate: Add slot-specific tags tooyour client app metrics</span></span>
<span data-ttu-id="8e8f9-208">Nesta seção, você irá configurar Olá diferentes de implantação slots toosend telemetria específicos de slot toohello mesmo recurso Application Insights.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-208">In this section, you will configure hello different deployment slots toosend slot-specific telemetry toohello same Application Insights resource.</span></span> <span data-ttu-id="8e8f9-209">Dessa forma, você pode comparar a telemetria de dados entre o tráfego de slots diferentes (ambientes de implantação) tooeasily ver o efeito de saudação de suas alterações de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-209">This way, you can compare telemetry data between traffic from different slots (deployment environments) tooeasily see hello effect of your app changes.</span></span> <span data-ttu-id="8e8f9-210">AT Olá mesmo tempo, você pode separar o tráfego de produção de hello restante Olá para que você possa continuar toomonitor seu aplicativo de produção conforme necessário.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-210">At hello same time, you can separate hello production traffic from hello rest so you can continue toomonitor your production app as needed.</span></span>

<span data-ttu-id="8e8f9-211">Desde que você está coletando dados sobre o comportamento do cliente, você vai [adicionar um inicializador de telemetria tooyour código JavaScript](../application-insights/app-insights-api-filtering-sampling.md) em cshtml.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-211">Since you're gathering data on client behavior, you will [add a telemetry initializer tooyour JavaScript code](../application-insights/app-insights-api-filtering-sampling.md) in index.cshtml.</span></span> <span data-ttu-id="8e8f9-212">Se você quiser tootest desempenho do lado do servidor, por exemplo, você também pode fazer da mesma forma no código do servidor (consulte [API do Application Insights para métricas e eventos personalizados](../application-insights/app-insights-api-custom-events-metrics.md).</span><span class="sxs-lookup"><span data-stu-id="8e8f9-212">If you want tootest server-side performance, for example, you can also do similarly in your server code (see [Application Insights API for custom events and metrics](../application-insights/app-insights-api-custom-events-metrics.md).</span></span>

1. <span data-ttu-id="8e8f9-213">Primeiro, adicione Olá bewteen de código Olá dois `//` comentários abaixo no bloco de JavaScript Olá que você adicionou toohello `<heading>` marca anteriormente.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-213">First, add hello code bewteen hello two `//` comments below in hello JavaScript block that you added toohello `<heading>` tag earlier.</span></span>

        window.appInsights = appInsights;

        // Begin new code
        appInsights.queue.push(function () {
            appInsights.context.addTelemetryInitializer(function (envelope) {
                var telemetryItem = envelope.data.baseData;
                telemetryItem.properties = telemetryItem.properties || {};
                telemetryItem.properties["Environment"] = "@System.Configuration.ConfigurationManager.AppSettings["environment"]";
            });
        });
        // End new code

        appInsights.trackPageView();

    <span data-ttu-id="8e8f9-214">Esse código de inicializador causa Olá `appInsights` tooadd objeto Olá uma propriedade personalizada chamada `Environment` tooevery parte de telemetria que ele envia.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-214">This initializer code causes hello `appInsights` object tooadd hello a custom property called `Environment` tooevery piece of telemetry it sends.</span></span>
2. <span data-ttu-id="8e8f9-215">Em seguida, adicione essa propriedade personalizada como uma [configuração do slot](web-sites-staged-publishing.md#AboutConfiguration) de seu aplicativo Web no Azure.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-215">Next, add this custom property as a [slot setting](web-sites-staged-publishing.md#AboutConfiguration) for your web app in Azure.</span></span> <span data-ttu-id="8e8f9-216">toodo, Olá executar comandos a seguir em sua sessão do Shell do Git.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-216">toodo this, run hello following commands in your Git Shell session.</span></span>

        $app = Get-AzureWebsite -Name todoapp<your_suffix> -Slot production
        $app.AppSettings.Add("environment", "Production")
        $app.SlotStickyAppSettingNames.Add("environment")
        $app | Set-AzureWebsite -Name todoapp<your_suffix> -Slot production

    <span data-ttu-id="8e8f9-217">Olá Web. config em seu projeto já define Olá `environment` configuração do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-217">hello Web.config in your project already defines hello `environment` app setting.</span></span> <span data-ttu-id="8e8f9-218">Com essa configuração, quando você testar o aplicativo de saudação localmente, suas métricas serão marcadas com `VS Debugger`.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-218">With this setting, when you test hello app locally, your metrics will be tagged with `VS Debugger`.</span></span> <span data-ttu-id="8e8f9-219">No entanto, quando você enviar por push tooAzure suas alterações, Azure encontrará e usar Olá `environment` configuração em vez disso, na configuração do aplicativo da web de saudação do aplicativo e suas métricas serão marcados com `Production`.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-219">However, when you push your changes tooAzure, Azure will find and use hello `environment` app setting in hello web app's configuration instead, and your metrics will be tagged with `Production`.</span></span>
3. <span data-ttu-id="8e8f9-220">Confirmar e enviar por push a bifurcação de tooyour de alterações de código no GitHub e aguarde até que os usuários toouse Olá novo aplicativo (necessidade toorefresh Olá navegador).</span><span class="sxs-lookup"><span data-stu-id="8e8f9-220">Commit and push your code changes tooyour fork on GitHub, and then wait for your users toouse hello new app (need toorefresh hello browser).</span></span> <span data-ttu-id="8e8f9-221">Ocupa cerca de 15 minutos para Olá nova propriedade tooshow em suas ideias de aplicativo `MultiChannelToDo.Web` recursos.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-221">It takes about 15 minutes for hello new property tooshow up in your Application Insights `MultiChannelToDo.Web` resource.</span></span>

        git add -A :/
        git commit -m "add environment property tooAI events for client app"
        git push origin master
4. <span data-ttu-id="8e8f9-222">Agora, vamos toohello **eventos personalizados** folha novamente e filtro Olá métricas em `Environment=Production`.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-222">Now, go toohello **Custom events** blade again and filter hello metrics on `Environment=Production`.</span></span> <span data-ttu-id="8e8f9-223">Agora você deve ser capaz de toosee todos os Olá novos eventos personalizados em produção de hello slot com esse filtro.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-223">You should now be able toosee all hello new custom events in hello production slot with this filter.</span></span>

    ![](./media/app-service-web-test-in-production-controlled-test-flight/05-filter-on-production-environment.png)
5. <span data-ttu-id="8e8f9-224">Clique em Olá **Favoritos** como botão toosave Olá atual do Metrics Explorer configurações toosomething **eventos personalizados: produção**.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-224">Click hello **Favorites** button toosave hello current Metrics Explorer settings toosomething like **Custom events: Production**.</span></span> <span data-ttu-id="8e8f9-225">Você pode alternar facilmente entre esta exibição e uma exibição de slot de implantação posteriormente.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-225">You can easily switch between this view and a deployment slot view later.</span></span>

   > [!TIP]
   > <span data-ttu-id="8e8f9-226">Para uma análise ainda mais eficiente, considere [integrar seu recurso do Application Insights com o Power BI](../application-insights/app-insights-export-power-bi.md).</span><span class="sxs-lookup"><span data-stu-id="8e8f9-226">For even more powerful analytics, consider [integrating your Application Insights resource with Power BI](../application-insights/app-insights-export-power-bi.md).</span></span>
   >
   >

### <a name="add-slot-specific-tags-tooyour-server-app-metrics"></a><span data-ttu-id="8e8f9-227">Adicionar marcas específicas do slot tooyour aplicativo métricas</span><span class="sxs-lookup"><span data-stu-id="8e8f9-227">Add slot-specific tags tooyour server app metrics</span></span>
<span data-ttu-id="8e8f9-228">Novamente, para fins de integridade você configurará saudação do servidor app.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-228">Again, for completeness you will set up hello server-side app.</span></span> <span data-ttu-id="8e8f9-229">Ao contrário do aplicativo de cliente de saudação que é instrumentado em JavaScript, marcas específicas do slot de saudação do aplicativo de servidor é instrumentada com o código .NET.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-229">Unlike hello client app which is instrumented in JavaScript, slot-specific tags for hello server app is instrumented with .NET code.</span></span>

1. <span data-ttu-id="8e8f9-230">Abra *&lt;raiz_do_repositório>*\src\MultiChannelToDo\Global.asax.cs.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-230">Open *&lt;repository_root>*\src\MultiChannelToDo\Global.asax.cs.</span></span> <span data-ttu-id="8e8f9-231">Adicione bloco de código Olá abaixo, antes de saudação chave de fechamento namespace.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-231">Add hello code block below, just before hello closing namespace curly brace.</span></span>

        namespace MultiChannelToDo
        {
                ...

                // Begin new code
            public class ConfigInitializer
            : ITelemetryInitializer
            {
                void ITelemetryInitializer.Initialize(ITelemetry telemetry)
                {
                    telemetry.Context.Properties["Environment"] = System.Configuration.ConfigurationManager.AppSettings["environment"];
                }
            }
                // End new code
        }
2. <span data-ttu-id="8e8f9-232">Corrija os erros de resolução de nome hello adicionando Olá `using` instruções abaixo toohello a partir do arquivo hello:</span><span class="sxs-lookup"><span data-stu-id="8e8f9-232">Correct hello name resolution errors by adding hello `using` statements below toohello beginning of hello file:</span></span>

        using Microsoft.ApplicationInsights.Channel;
        using Microsoft.ApplicationInsights.Extensibility;
3. <span data-ttu-id="8e8f9-233">Adicione código Olá abaixo toohello início Olá `Application_Start()` método:</span><span class="sxs-lookup"><span data-stu-id="8e8f9-233">Add hello code below toohello beginning of hello `Application_Start()` method:</span></span>

        TelemetryConfiguration.Active.TelemetryInitializers.Add(new ConfigInitializer());
4. <span data-ttu-id="8e8f9-234">Confirmar e enviar por push a bifurcação de tooyour de alterações de código no GitHub e aguarde até que os usuários toouse Olá novo aplicativo (necessidade toorefresh Olá navegador).</span><span class="sxs-lookup"><span data-stu-id="8e8f9-234">Commit and push your code changes tooyour fork on GitHub, and then wait for your users toouse hello new app (need toorefresh hello browser).</span></span> <span data-ttu-id="8e8f9-235">Ocupa cerca de 15 minutos para Olá nova propriedade tooshow em suas ideias de aplicativo `MultiChannelToDo` recursos.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-235">It takes about 15 minutes for hello new property tooshow up in your Application Insights `MultiChannelToDo` resource.</span></span>

        git add -A :/
        git commit -m "add environment property tooAI events for server app"
        git push origin master

## <a name="update-set-up-your-beta-branch"></a><span data-ttu-id="8e8f9-236">Atualização: configurar sua ramificação beta</span><span class="sxs-lookup"><span data-stu-id="8e8f9-236">Update: Set up your beta branch</span></span>
1. <span data-ttu-id="8e8f9-237">Abra  *&lt;repository_root >*\ARMTemplates\ProdAndStagetest.json e localizar Olá `appsettings` recursos (procure `"name": "appsettings"`).</span><span class="sxs-lookup"><span data-stu-id="8e8f9-237">Open *&lt;repository_root>*\ARMTemplates\ProdAndStagetest.json and find hello `appsettings` resources (search for `"name": "appsettings"`).</span></span> <span data-ttu-id="8e8f9-238">Há quatro deles, um para cada slot.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-238">There are 4 of them, one for each slot.</span></span>
2. <span data-ttu-id="8e8f9-239">Para cada `appsettings` recurso, adicione uma `"environment": "[parameters('slotName')]"` final de toohello de configuração de aplicativo da saudação `properties` matriz.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-239">For each `appsettings` resource, add an  `"environment": "[parameters('slotName')]"` app setting toohello end of hello `properties` array.</span></span> <span data-ttu-id="8e8f9-240">Não se esqueça de linha anterior do hello tooend com uma vírgula.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-240">Don't forget tooend hello previous line with a comma.</span></span>

    ![](./media/app-service-web-test-in-production-controlled-test-flight/06-arm-app-setting-with-slot-name.png)

    <span data-ttu-id="8e8f9-241">Você acabou de adicionar Olá `environment` definindo tooall slots Olá no modelo de saudação do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-241">You have just added hello `environment` app setting tooall hello slots in hello template.</span></span>
3. <span data-ttu-id="8e8f9-242">No hello mesmo arquivo, localize Olá `slotconfignames` recursos (procure `"name": "slotconfignames"`).</span><span class="sxs-lookup"><span data-stu-id="8e8f9-242">In hello same file, find hello `slotconfignames` resources (search for `"name": "slotconfignames"`).</span></span> <span data-ttu-id="8e8f9-243">Há dois deles, um para cada aplicativo.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-243">There are 2 of them, one for each app.</span></span>
4. <span data-ttu-id="8e8f9-244">Para cada `slotconfignames` recurso, adicione `"environment"` toohello final de saudação `appSettingNames` matriz.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-244">For each `slotconfignames` resource, add `"environment"` toohello end of hello `appSettingNames` array.</span></span> <span data-ttu-id="8e8f9-245">Não se esqueça de linha anterior do hello tooend com uma vírgula.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-245">Don't forget tooend hello previous line with a comma.</span></span>

    <span data-ttu-id="8e8f9-246">Você acabou de criar hello `environment` slot de implantação do respectivos de tooits do aplicativo configuração cartão para ambos os aplicativos.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-246">You have just made hello `environment` app setting stick tooits respective deployment slot for both apps.</span></span>  
5. <span data-ttu-id="8e8f9-247">Na sua sessão do Shell de Git, Olá execução seguintes comandos com hello mesmo sufixo de grupo de recursos que você usou.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-247">In your Git Shell session, run hello following commands with hello same resource group suffix that you used before.</span></span>

        git checkout -b beta
        git push origin beta
        .\deploy.ps1 -RepoUrl https://github.com/<your_fork>/ToDoApp.git -ResourceGroupSuffix <your_suffix> -SlotName beta -Branch beta
6. <span data-ttu-id="8e8f9-248">Quando solicitado, especifique Olá as mesmas credenciais de banco de dados SQL como antes.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-248">When prompted, specify hello same SQL database credentials as before.</span></span> <span data-ttu-id="8e8f9-249">Em seguida, quando solicitado a grupo de recursos tooupdate hello, tipo `Y`, em seguida, `ENTER`.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-249">Then, when asked tooupdate hello resource group, type `Y`, then `ENTER`.</span></span>

    <span data-ttu-id="8e8f9-250">Depois que o script hello termina, todos os seus recursos no grupo de recursos original Olá são mantidos, mas um novo slot denominado "beta" for criado com hello mesmo configuração como o slot de "Preparação" hello que foi criado no início de saudação.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-250">Once hello script finishes, all your resources in hello original resource group are retained, but a new slot named "beta" is created in it with hello same configuration as hello "Staging" slot that was created in hello beginning.</span></span>

   > [!NOTE]
   > <span data-ttu-id="8e8f9-251">Esse método de criação de ambientes de implantação diferentes é diferente do método hello em [desenvolvimento de software Agile com serviço de aplicativo do Azure](app-service-agile-software-development.md).</span><span class="sxs-lookup"><span data-stu-id="8e8f9-251">This method of creating different deployment environments is different from hello method in [Agile software development with Azure App Service](app-service-agile-software-development.md).</span></span> <span data-ttu-id="8e8f9-252">Aqui, você cria ambientes de implantação com slots de implantação, enquanto que lá você cria ambientes de implantação com grupos de recursos.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-252">Here, you create deployment environments with deployment slots, where as there you create deployment environments with resource groups.</span></span> <span data-ttu-id="8e8f9-253">Gerenciando ambientes de implantação com grupos de recursos permite que você toodevelopers fora dos limites do ambiente tookeep Olá produção, mas não é fácil toodo teste em produção, o que pode ser feito facilmente com slots.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-253">Managing deployment environments with resource groups enables you tookeep hello production environment off-limits toodevelopers, but it's not easy toodo testing in production, which you can do easily with slots.</span></span>
   >
   >

<span data-ttu-id="8e8f9-254">Se desejar, você também pode criar um aplicativo alfa executando</span><span class="sxs-lookup"><span data-stu-id="8e8f9-254">If you wish, you can also create an alpha app by running</span></span>

    git checkout -b alpha
    git push origin alpha
    .\deploy.ps1 -RepoUrl https://github.com/<your_fork>/ToDoApp.git -ResourceGroupSuffix <your_suffix> -SlotName beta -Branch alpha

<span data-ttu-id="8e8f9-255">Para este tutorial, você continuará usando seu aplicativo beta.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-255">For this tutorial, you will just keep using your beta app.</span></span>

## <a name="update-push-your-updates-toohello-beta-app"></a><span data-ttu-id="8e8f9-256">Atualização: Seu aplicativo de beta de toohello de atualizações por Push</span><span class="sxs-lookup"><span data-stu-id="8e8f9-256">Update: Push your updates toohello beta app</span></span>
<span data-ttu-id="8e8f9-257">Faça tooyour aplicativo que você deseja tooimprove.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-257">Back tooyour app that you want tooimprove.</span></span>

1. <span data-ttu-id="8e8f9-258">Verifique se você está agora em sua ramificação beta</span><span class="sxs-lookup"><span data-stu-id="8e8f9-258">Make sure you're now in your beta branch</span></span>

        git checkout beta
2. <span data-ttu-id="8e8f9-259">Em  *&lt;repository_root >*\src\MultiChannelToDo.Web\app\Index.cshtml, localizar Olá `<li>` marcar e adicionar Olá `style="cursor:pointer"` atributo, conforme mostrado abaixo.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-259">In *&lt;repository_root>*\src\MultiChannelToDo.Web\app\Index.cshtml, find hello `<li>` tag and add hello `style="cursor:pointer"` attribute, as shown below.</span></span>

    ![](./media/app-service-web-test-in-production-controlled-test-flight/07-change-cursor-style-on-li.png)
3. <span data-ttu-id="8e8f9-260">Confirmar e enviar por push tooAzure.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-260">commit and push tooAzure.</span></span>
4. <span data-ttu-id="8e8f9-261">Verifique se a alteração Olá agora é refletida no slot de beta Olá navegando toohttp://todoapp*&lt;your_suffix >*-beta.azurewebsites.net/.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-261">Verify that hello change is now reflected in hello beta slot by navigating toohttp://todoapp*&lt;your_suffix>*-beta.azurewebsites.net/.</span></span> <span data-ttu-id="8e8f9-262">Se você não vir Olá alterar ainda, atualize seu código javascript novo navegador tooget hello.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-262">If you don't see hello change yet, refresh your browser tooget hello new javascript code.</span></span>

    ![](./media/app-service-web-test-in-production-controlled-test-flight/08-verify-change-in-beta-site.png)

<span data-ttu-id="8e8f9-263">Agora que você tem a alteração em execução no slot de beta hello, você está pronto tooperform uma implantação flighting.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-263">Now that you have your change running in hello beta slot, you are ready tooperform a flighting deployment.</span></span>

## <a name="validate-route-traffic-toohello-beta-app"></a><span data-ttu-id="8e8f9-264">Validar: Aplicativo de beta toohello de tráfego de rota</span><span class="sxs-lookup"><span data-stu-id="8e8f9-264">Validate: Route traffic toohello beta app</span></span>
<span data-ttu-id="8e8f9-265">Nesta seção, você será rotear tráfego toohello beta aplicativo.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-265">In this section, you will route traffic toohello beta app.</span></span> <span data-ttu-id="8e8f9-266">Para fins de clareza da demonstração, você vai tooroute uma parte significativa da saudação tooit de tráfego de usuário.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-266">For sake of clarity of demonstration, you're going tooroute a significant portion of hello user traffic tooit.</span></span> <span data-ttu-id="8e8f9-267">Na realidade, Olá quantidade de tráfego que você deseja tooroute dependerá de sua situação específica.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-267">In reality, hello amount of traffic you want tooroute will depend on your specific situation.</span></span> <span data-ttu-id="8e8f9-268">Por exemplo, se seu site estiver em escala de saudação do microsoft.com, talvez seja necessário menor que um por cento de seu tráfego total de dados de pedidos toogain útil.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-268">For example, if your site is at hello scale of microsoft.com, then you may need less than one percent of your total traffic in order toogain useful data.</span></span>

1. <span data-ttu-id="8e8f9-269">Na sua sessão do Shell de Git, execute Olá tooroute comandos a seguir metade do slot de beta Olá produção tráfego toohello:</span><span class="sxs-lookup"><span data-stu-id="8e8f9-269">In your Git Shell session, run hello following commands tooroute half of hello production traffic toohello beta slot:</span></span>

        $siteName = "ToDoApp<your suffix>"
        $rule = New-Object Microsoft.WindowsAzure.Commands.Utilities.Websites.Services.WebEntities.RampUpRule
        $rule.ActionHostName = "$siteName-beta.azurewebsites.net"
        $rule.ReroutePercentage = 50
        $rule.Name = "beta"
        Set-AzureWebsite $siteName -Slot Production -RoutingRules $rule

   <span data-ttu-id="8e8f9-270">Olá `ReroutePercentage=50` propriedade especifica que 50% do tráfego de produção de hello será a URL do aplicativo do toohello roteados beta (especificado pelo Olá `ActionHostName` propriedade).</span><span class="sxs-lookup"><span data-stu-id="8e8f9-270">hello `ReroutePercentage=50` property specifies that 50% of hello production traffic will be routed toohello beta app's URL (specified by hello `ActionHostName` property).</span></span>
2. <span data-ttu-id="8e8f9-271">Agora vá toohttp://ToDoApp*&lt;your_suffix >*. azurewebsites.net.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-271">Now navigate toohttp://ToDoApp*&lt;your_suffix>*.azurewebsites.net.</span></span> <span data-ttu-id="8e8f9-272">50% de tráfego Olá agora deve ser redirecionado toohello slot de beta.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-272">50% of hello traffic should now be redirected toohello beta slot.</span></span>
3. <span data-ttu-id="8e8f9-273">Em seu recurso Application Insights, filtrar métricas Olá pelo ambiente = "beta".</span><span class="sxs-lookup"><span data-stu-id="8e8f9-273">In your Application Insights resource, filter hello metrics by environment="beta".</span></span>

   > [!NOTE]
   > <span data-ttu-id="8e8f9-274">Se você salvar essa exibição filtrada como favorito outro, pode inverter facilmente exibições de métrica explorer Olá entre modos de exibição do beta e de produção.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-274">If you save this filtered view as another favorite, then you can easily flip hello metric explorer views between production and beta views.</span></span>
   >
   >

<span data-ttu-id="8e8f9-275">Suponha que no Application Insights, consulte a seguir toohello algo semelhante:</span><span class="sxs-lookup"><span data-stu-id="8e8f9-275">Suppose in Application Insights you see something similar toohello following:</span></span>

![](./media/app-service-web-test-in-production-controlled-test-flight/09-test-beta-site-in-production.png)

<span data-ttu-id="8e8f9-276">Não só é isso mostra que há muitos cliques mais em Olá `<li>` marcas, mas parece toobe um surto de cliques em `<li>` marcas.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-276">Not only is this showing that there are many more clicks on hello `<li>` tags, but there seems toobe a surge of clicks on `<li>` tags.</span></span> <span data-ttu-id="8e8f9-277">Pode, em seguida, concluir que as pessoas descobriram Olá novo `<li>` marcas são clicáveis e agora está limpando todas as suas tarefas previamente concluídas no aplicativo hello.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-277">You can then conclude that people have discovered hello new `<li>` tags are clickable and are now clearing all their previously-completed tasks in hello app.</span></span>

<span data-ttu-id="8e8f9-278">Com base nos dados de saudação da sua implantação flighting, você decidir que a nova interface do usuário está pronto para produção.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-278">Based on hello data of your flighting deployment, you decide that your new UI is ready for production.</span></span>

## <a name="go-live-move-your-new-code-into-production"></a><span data-ttu-id="8e8f9-279">Ativação: mover seu novo código para a produção</span><span class="sxs-lookup"><span data-stu-id="8e8f9-279">Go live: Move your new code into production</span></span>
<span data-ttu-id="8e8f9-280">Você está agora pronto toomove tooproduction sua atualização.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-280">You're now ready toomove your update tooproduction.</span></span> <span data-ttu-id="8e8f9-281">O grande é que agora você sabe que a atualização já foi validada *antes de* é enviada por push tooproduction.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-281">What's great is that now you know that your update has already been validated *before* it is pushed tooproduction.</span></span> <span data-ttu-id="8e8f9-282">Agora você pode implantá-la com confiança.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-282">So now you can confidently deploy it.</span></span> <span data-ttu-id="8e8f9-283">Desde que você fez um aplicativo de cliente atualização toohello AngularJS, validados somente código de cliente hello.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-283">Since you made an update toohello AngularJS client app, you only validated hello client-side code.</span></span> <span data-ttu-id="8e8f9-284">Se você fosse um aplicativo de API da Web de back-end do toomake alterações toohello, você pode validar as alterações da mesma forma e facilmente.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-284">If you were toomake changes toohello back-end Web API app, you could validate your changes similarly and easily.</span></span>

1. <span data-ttu-id="8e8f9-285">No Shell de Git, remova a regra de roteamento de tráfego da saudação executando Olá comando a seguir:</span><span class="sxs-lookup"><span data-stu-id="8e8f9-285">In Git Shell, remove hello traffic routing rule by running hello following command:</span></span>

        Set-AzureWebsite $siteName -Slot Production -RoutingRules @()
2. <span data-ttu-id="8e8f9-286">Execute comandos do Git hello:</span><span class="sxs-lookup"><span data-stu-id="8e8f9-286">Run hello Git commands:</span></span>

        git checkout master
        git pull origin master
        git merge beta
        git push origin master
3. <span data-ttu-id="8e8f9-287">Aguarde alguns minutos para Olá novos toohello toobe implantado slot de preparo de código, em seguida, inicie http://ToDoApp*&lt;your_suffix >*-tooverify staging.azurewebsites.net que Olá nova atualização aquecido em preparo Olá slot.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-287">Wait for a few minutes for hello new code toobe deployed toohello staging slot, then launch http://ToDoApp*&lt;your_suffix>*-staging.azurewebsites.net tooverify that hello new update is warmed up in hello staging slot.</span></span> <span data-ttu-id="8e8f9-288">Lembre-se de que Olá ramificação mestre da bifurcação está vinculado toohello preparo slot do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-288">Remember that hello your fork's master branch is linked toohello staging slot of your app.</span></span>
4. <span data-ttu-id="8e8f9-289">Agora, trocar o slot de preparação para a produção de hello</span><span class="sxs-lookup"><span data-stu-id="8e8f9-289">Now, swap hello staging slot into production</span></span>

        cd <ROOT>\ToDoApp\ARMTemplates
        .\swap.ps1 -Name todoapp<your_suffix>

## <a name="summary"></a><span data-ttu-id="8e8f9-290">Resumo</span><span class="sxs-lookup"><span data-stu-id="8e8f9-290">Summary</span></span>
<span data-ttu-id="8e8f9-291">Serviço de aplicativo do Azure facilita tootest toomedium pequenos negócios seus aplicativos voltados para o cliente em produção, algo que foi feito tradicionalmente em grandes empresas.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-291">Azure App Service makes it easy for small- toomedium-sized businesses tootest their customer-facing apps in production, something that has been traditionally done in big enterprises.</span></span> <span data-ttu-id="8e8f9-292">Esperamos que este tutorial lhe concedeu Olá conhecimento necessário toobring juntos Application Insights e do serviço de aplicativo toomake flighting implantação possíveis e outros cenários de teste em produção, seu mundo DevOps.</span><span class="sxs-lookup"><span data-stu-id="8e8f9-292">Hopefully, this tutorial has given you hello knowledge you need toobring together App Service and Application Insights toomake possible flighting deployment, and even other test-in-production scenarios, in your DevOps world.</span></span>

## <a name="more-resources"></a><span data-ttu-id="8e8f9-293">Mais recursos</span><span class="sxs-lookup"><span data-stu-id="8e8f9-293">More resources</span></span>
* [<span data-ttu-id="8e8f9-294">Desenvolvimento de software Agile com o Serviço de Aplicativo do Azure</span><span class="sxs-lookup"><span data-stu-id="8e8f9-294">Agile software development with Azure App Service</span></span>](app-service-agile-software-development.md)
* [<span data-ttu-id="8e8f9-295">Configurar ambientes de preparo para aplicativos Web no Serviço de Aplicativo do Azure</span><span class="sxs-lookup"><span data-stu-id="8e8f9-295">Set up staging environments for web apps in Azure App Service</span></span>](web-sites-staged-publishing.md)
* [<span data-ttu-id="8e8f9-296">Implantar um aplicativo complexo de modo previsível no Azure</span><span class="sxs-lookup"><span data-stu-id="8e8f9-296">Deploy a complex application predictably in Azure</span></span>](app-service-deploy-complex-application-predictably.md)
* [<span data-ttu-id="8e8f9-297">Criando modelos do Gerenciador de Recursos do Azure</span><span class="sxs-lookup"><span data-stu-id="8e8f9-297">Authoring Azure Resource Manager Templates</span></span>](../azure-resource-manager/resource-group-authoring-templates.md)
* [<span data-ttu-id="8e8f9-298">JSONLint - Olá validador de JSON</span><span class="sxs-lookup"><span data-stu-id="8e8f9-298">JSONLint - hello JSON Validator</span></span>](http://jsonlint.com/)
* [<span data-ttu-id="8e8f9-299">Ramificação Git – Conceitos básicos de ramificação e mesclagem</span><span class="sxs-lookup"><span data-stu-id="8e8f9-299">Git Branching – Basic Branching and Merging</span></span>](http://www.git-scm.com/book/en/v2/Git-Branching-Basic-Branching-and-Merging)
* [<span data-ttu-id="8e8f9-300">PowerShell do Azure</span><span class="sxs-lookup"><span data-stu-id="8e8f9-300">Azure PowerShell</span></span>](/powershell/azure/overview)
* [<span data-ttu-id="8e8f9-301">Projeto Kudu Wiki</span><span class="sxs-lookup"><span data-stu-id="8e8f9-301">Project Kudu Wiki</span></span>](https://github.com/projectkudu/kudu/wiki)
