---
title: "aaaWorking com grandes conjuntos de escala de máquina Virtual do Azure | Microsoft Docs"
description: "O que você precisa conjuntos de escala tooknow toouse grande máquina virtual do Azure"
services: virtual-machine-scale-sets
documentationcenter: 
author: gbowerman
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 76ac7fd7-2e05-4762-88ca-3b499e87906e
ms.service: virtual-machine-scale-sets
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 2/7/2017
ms.author: guybo
ms.openlocfilehash: a39aab25925d7fc50763f0a20148b1f2213b492f
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="working-with-large-virtual-machine-scale-sets"></a><span data-ttu-id="0e3ba-103">Trabalhando com conjuntos de dimensionamento grandes de máquinas virtuais</span><span class="sxs-lookup"><span data-stu-id="0e3ba-103">Working with large virtual machine scale sets</span></span>
<span data-ttu-id="0e3ba-104">Agora você pode criar Azure [conjuntos de escala de máquina virtual](/azure/virtual-machine-scale-sets/) com uma capacidade de backup too1, 000 VMs.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-104">You can now create Azure [virtual machine scale sets](/azure/virtual-machine-scale-sets/) with a capacity of up too1,000 VMs.</span></span> <span data-ttu-id="0e3ba-105">Neste documento, uma _conjunto de escalas da máquina virtual grande_ é definido como uma escala definida capaz de dimensionamento toogreater que 100 VMs.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-105">In this document, a _large virtual machine scale set_ is defined as a scale set capable of scaling toogreater than 100 VMs.</span></span> <span data-ttu-id="0e3ba-106">Esse recurso é definido por uma propriedade de conjunto de dimensionamento (_singlePlacementGroup=False_).</span><span class="sxs-lookup"><span data-stu-id="0e3ba-106">This capability is set by a scale set property (_singlePlacementGroup=False_).</span></span> 

<span data-ttu-id="0e3ba-107">Define determinados aspectos de grande escala, como domínios de falha e de balanceamento de carga se comportam diferentemente tooa conjunto de escala padrão.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-107">Certain aspects of large scale sets, such as load balancing and fault domains behave differently tooa standard scale set.</span></span> <span data-ttu-id="0e3ba-108">Este documento explica as características de saudação de conjuntos de grande escala e descreve o que você precisa tooknow toosuccessfully usá-los em seus aplicativos.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-108">This document explains hello characteristics of large scale sets, and describes what you need tooknow toosuccessfully use them in your applications.</span></span> 

<span data-ttu-id="0e3ba-109">Uma abordagem comum para implantar a infraestrutura de nuvem em grande escala é toocreate um conjunto de _dimensionar unidades_, por exemplo, criando várias VMs dimensionar conjuntos em vários VNETs e contas de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-109">A common approach for deploying cloud infrastructure at large scale is toocreate a set of _scale units_, for example by creating multiple VMs scale sets across multiple VNETs and storage accounts.</span></span> <span data-ttu-id="0e3ba-110">Essa abordagem fornece fácil gerenciamento comparado toosingle VMs e várias unidades de escala são úteis para muitos aplicativos, especialmente aqueles que exigem outros componentes empilháveis como várias redes virtuais e os pontos de extremidade.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-110">This approach provides easier management compared toosingle VMs, and multiple scale units are useful for many applications, particularly those that require other stackable components like multiple virtual networks and endpoints.</span></span> <span data-ttu-id="0e3ba-111">Se seu aplicativo requer um único cluster grande, porém, pode ser mais simples toodeploy uma única escala conjunto de backup too1, 000 VMs.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-111">If your application requires a single large cluster however, it can be more straightforward toodeploy a single scale set of up too1,000 VMs.</span></span> <span data-ttu-id="0e3ba-112">Cenários de exemplo incluem implantações de big data centralizadas ou grades de computação que exigem o gerenciamento simples de um grande pool de nós de trabalho.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-112">Example scenarios include centralized big data deployments, or compute grids requiring simple management of a large pool of worker nodes.</span></span> <span data-ttu-id="0e3ba-113">Combinado com o conjunto de escala VM [discos de dados conectados](virtual-machine-scale-sets-attached-disks.md), conjuntos de grande escala permitem que você toodeploy uma infraestrutura escalável consiste em milhares de núcleos e petabytes de armazenamento, como uma única operação.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-113">Combined with VM scale set [attached data disks](virtual-machine-scale-sets-attached-disks.md), large scale sets enable you toodeploy a scalable infrastructure consisting of thousands of cores and petabytes of storage, as a single operation.</span></span>

## <a name="placement-groups"></a><span data-ttu-id="0e3ba-114">Grupos de posicionamento</span><span class="sxs-lookup"><span data-stu-id="0e3ba-114">Placement groups</span></span> 
<span data-ttu-id="0e3ba-115">O que torna uma _grande_ conjunto especial de escala não é número de saudação de VMs, mas o número de saudação de _grupos de posicionamento_ contém.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-115">What makes a _large_ scale set special is not hello number of VMs, but hello number of _placement groups_ it contains.</span></span> <span data-ttu-id="0e3ba-116">Um grupo de posicionamento é um construção semelhante tooan Azure conjunto de disponibilidade, com seus próprios domínios de falha e domínios de atualização.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-116">A placement group is a construct similar tooan Azure availability set, with its own fault domains and upgrade domains.</span></span> <span data-ttu-id="0e3ba-117">Por padrão, um conjunto de dimensionamento consiste em um único grupo de posicionamento com tamanho máximo de 100 VMs.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-117">By default, a scale set consists of a single placement group with a maximum size of 100 VMs.</span></span> <span data-ttu-id="0e3ba-118">Se uma escala de definir a propriedade chamada _singlePlacementGroup_ está definida too_false_, Olá conjunto de escala pode ser composto de vários grupos de posicionamento e tem um intervalo de 0-1.000 VMs.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-118">If a scale set property called _singlePlacementGroup_ is set too_false_, hello scale set can be composed of multiple placement groups and has a range of 0-1,000 VMs.</span></span> <span data-ttu-id="0e3ba-119">Quando define o valor padrão toohello _true_, um conjunto de escala é composto de um grupo único posicionamento e tem um intervalo de 0 a 100 máquinas virtuais.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-119">When set toohello default value of _true_, a scale set is composed of a single placement group, and has a range of 0-100 VMs.</span></span>

## <a name="checklist-for-using-large-scale-sets"></a><span data-ttu-id="0e3ba-120">Lista de verificação para uso em conjuntos de dimensionamento grandes</span><span class="sxs-lookup"><span data-stu-id="0e3ba-120">Checklist for using large scale sets</span></span>
<span data-ttu-id="0e3ba-121">toodecide se seu aplicativo pode fazer uso eficiente de conjuntos de grande escala, considere Olá requisitos a seguir:</span><span class="sxs-lookup"><span data-stu-id="0e3ba-121">toodecide whether your application can make effective use of large scale sets, consider hello following requirements:</span></span>

- <span data-ttu-id="0e3ba-122">Conjuntos de dimensionamento grandes exigem Discos Gerenciados do Azure.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-122">Large scale sets require Azure Managed Disks.</span></span> <span data-ttu-id="0e3ba-123">Conjuntos de dimensionamento que não são criados com Discos Gerenciados exigem várias contas de armazenamento (uma para cada 20 VMs).</span><span class="sxs-lookup"><span data-stu-id="0e3ba-123">Scale sets that are not created with Managed Disks require multiple storage accounts (one for every 20 VMs).</span></span> <span data-ttu-id="0e3ba-124">Conjuntos de grande escala são toowork projetado exclusivamente com discos gerenciados tooreduce limita seu armazenamento sobrecarga de gerenciamento e tooavoid Olá risco de execução para uma assinatura para contas de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-124">Large scale sets are designed toowork exclusively with Managed Disks tooreduce your storage management overhead, and tooavoid hello risk of running into subscription limits for storage accounts.</span></span> <span data-ttu-id="0e3ba-125">Se você não usar discos gerenciados, o conjunto de escala é limitada too100 VMs.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-125">If you do not use Managed Disks, your scale set is limited too100 VMs.</span></span>
- <span data-ttu-id="0e3ba-126">Conjuntos de escala criados a partir de imagens do Azure Marketplace podem escalar verticalmente too1, 000 VMs.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-126">Scale sets created from Azure Marketplace images can scale up too1,000 VMs.</span></span>
- <span data-ttu-id="0e3ba-127">Conjuntos de escala criados a partir de imagens personalizadas (imagens VM você criar e carregar por conta própria) atualmente podem escalar verticalmente too100 VMs.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-127">Scale sets created from custom images (VM images you create and upload yourself) can currently scale up too100 VMs.</span></span>
- <span data-ttu-id="0e3ba-128">Camada 4 balanceamento de carga com hello balanceador de carga do Azure ainda não é suportada para conjuntos de escala compostos de vários grupos de posicionamento.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-128">Layer-4 load balancing with hello Azure Load Balancer is not yet supported for scale sets composed of multiple placement groups.</span></span> <span data-ttu-id="0e3ba-129">Se você precisar Olá toouse balanceador de carga do Azure Certifique-se de escala de saudação definido é toouse configurado um grupo único posicionamento, o que é a configuração padrão de saudação.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-129">If you need toouse hello Azure Load Balancer make sure hello scale set is configured toouse a single placement group, which is hello default setting.</span></span>
- <span data-ttu-id="0e3ba-130">7 de camada de balanceamento de carga com hello Azure Application Gateway tem suporte para todos os conjuntos de escala.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-130">Layer-7 load balancing with hello Azure Application Gateway is supported for all scale sets.</span></span>
- <span data-ttu-id="0e3ba-131">Um conjunto de escala é definido com uma única sub-rede - Certifique-se de que sua sub-rede tem um espaço de endereço grande o suficiente para todas as VMs de saudação é necessário.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-131">A scale set is defined with a single subnet - make sure your subnet has an address space large enough for all hello VMs you need.</span></span> <span data-ttu-id="0e3ba-132">Por padrão, uma escala definida overprovisions (cria VMs adicionais no momento da implantação ou expansão, que você não será cobrado para) tooimprove o desempenho e confiabilidade de implantação.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-132">By default a scale set overprovisions (creates extra VMs at deployment time or when scaling out, which you are not charged for) tooimprove deployment reliability and performance.</span></span> <span data-ttu-id="0e3ba-133">Permitir uma maior que Olá número de VMs planejar tooscale para endereço espaço 20%.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-133">Allow for an address space 20% greater than hello number of VMs you plan tooscale to.</span></span>
- <span data-ttu-id="0e3ba-134">Se você estiver planejando toodeploy muitas máquinas virtuais, seus limites de cota de núcleos de computação podem ser necessário toobe aumentado.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-134">If you are planning toodeploy many VMs, your Compute core quota limits may need toobe increased.</span></span>
- <span data-ttu-id="0e3ba-135">Domínios de falha e domínios de atualização só são consistentes dentro de um grupo de posicionamento.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-135">Fault domains and upgrade domains are only consistent within a placement group.</span></span> <span data-ttu-id="0e3ba-136">Essa arquitetura não altera Olá geral de uma escala de conjunto de disponibilidade, como VMs são distribuídas uniformemente por distinto hardware físico, mas não significa que se você precisar tooguarantee duas VMs estão em um hardware diferente, certifique-se de que estão em diferentes de falha Olá a domínios no mesmo grupo de posicionamento.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-136">This architecture does not change hello overall availability of a scale set, as VMs are evenly distributed across distinct physical hardware, but it does means that if you need tooguarantee two VMs are on different hardware, make sure they are in different fault domains in hello same placement group.</span></span> <span data-ttu-id="0e3ba-137">ID de grupo de domínio e o posicionamento de falha são mostrados no hello _exibição de instância_ de escala de uma conjunto de VM.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-137">Fault domain and placement group ID are shown in hello _instance view_ of a scale set VM.</span></span> <span data-ttu-id="0e3ba-138">Você pode exibir a exibição de instância de saudação de um conjunto de escala de VM no hello [Gerenciador de recursos do Azure](https://resources.azure.com/).</span><span class="sxs-lookup"><span data-stu-id="0e3ba-138">You can view hello instance view of a scale set VM in hello [Azure Resource Explorer](https://resources.azure.com/).</span></span>


## <a name="creating-a-large-scale-set"></a><span data-ttu-id="0e3ba-139">Criando um conjunto de dimensionamento grande</span><span class="sxs-lookup"><span data-stu-id="0e3ba-139">Creating a large scale set</span></span>
<span data-ttu-id="0e3ba-140">Quando você cria uma escala definida no hello portal do Azure, você pode permitir que ele tooscale toomultiple posicionamento grupos por configuração Olá _grupo de posicionamento único limite tooa_ too_False_ opção em Olá _Noções básicas sobre_ folha.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-140">When you create a scale set in hello Azure portal, you can allow it tooscale toomultiple placement groups by setting hello _Limit tooa single placement group_ option too_False_ in hello _Basics_ blade.</span></span> <span data-ttu-id="0e3ba-141">Com too_False_ de definir essa opção, você pode especificar um _a contagem de instâncias_ valor de backup too1, 000.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-141">With this option set too_False_, you can specify an _Instance count_ value of up too1,000.</span></span>

![](./media/virtual-machine-scale-sets-placement-groups/portal-large-scale.png)

<span data-ttu-id="0e3ba-142">Você pode criar uma escala VM grande definida usando Olá [CLI do Azure](https://github.com/Azure/azure-cli) _vmss az criar_ comando.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-142">You can create a large VM scale set using hello [Azure CLI](https://github.com/Azure/azure-cli) _az vmss create_ command.</span></span> <span data-ttu-id="0e3ba-143">Este comando define padrões inteligentes como tamanho da sub-rede com base em Olá _contagem de instâncias_ argumento:</span><span class="sxs-lookup"><span data-stu-id="0e3ba-143">This command sets intelligent defaults such as subnet size based on hello _instance-count_ argument:</span></span>

```bash
az group create -l southcentralus -n biginfra
az vmss create -g biginfra -n bigvmss --image ubuntults --instance-count 1000
```
<span data-ttu-id="0e3ba-144">Observe que Olá _vmss criar_ comando padrões determinados valores de configuração se você não especificá-los.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-144">Note that hello _vmss create_ command defaults certain configuration values if you do not specify them.</span></span> <span data-ttu-id="0e3ba-145">toosee Olá opções disponíveis que você pode substituir, tente:</span><span class="sxs-lookup"><span data-stu-id="0e3ba-145">toosee hello available options that you can override, try:</span></span>
```bash
az vmss create --help
```

<span data-ttu-id="0e3ba-146">Se você estiver criando uma grande escala definida pela composição de um modelo do Azure Resource Manager, verifique se o modelo de saudação cria um conjunto de escala com base em discos gerenciado do Azure.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-146">If you are creating a large scale set by composing an Azure Resource Manager template, make sure hello template creates a scale set based on Azure Managed Disks.</span></span> <span data-ttu-id="0e3ba-147">Você pode definir Olá _singlePlacementGroup_ too_false_ de propriedade em Olá _propriedades_ seção Olá _Microsoft.Compute/virtualMAchineScaleSets_ recursos.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-147">You can set hello _singlePlacementGroup_ property too_false_ in hello _properties_ section of hello _Microsoft.Compute/virtualMAchineScaleSets_ resource.</span></span> <span data-ttu-id="0e3ba-148">Olá, fragmento de JSON a seguir mostra a partir de um modelo de conjunto de escala, incluindo a capacidade VM Olá 1.000 e Olá Olá _"singlePlacementGroup": falso_ configuração:</span><span class="sxs-lookup"><span data-stu-id="0e3ba-148">hello following JSON fragment shows hello beginning of a scale set template, including hello 1,000 VM capacity and hello _"singlePlacementGroup" : false_ setting:</span></span>
```json
{
  "type": "Microsoft.Compute/virtualMachineScaleSets",
  "location": "australiaeast",
  "name": "bigvmss",
  "sku": {
    "name": "Standard_DS1_v2",
    "tier": "Standard",
    "capacity": 1000
  },
  "properties": {
    "singlePlacementGroup": false,
    "upgradePolicy": {
      "mode": "Automatic"
    }
```
<span data-ttu-id="0e3ba-149">Para obter um exemplo completo de grande escala definida no modelo, consulte muito[https://github.com/gbowerman/azure-myriad/blob/master/bigtest/bigbottle.json](https://github.com/gbowerman/azure-myriad/blob/master/bigtest/bigbottle.json).</span><span class="sxs-lookup"><span data-stu-id="0e3ba-149">For a complete example of a large scale set template, refer too[https://github.com/gbowerman/azure-myriad/blob/master/bigtest/bigbottle.json](https://github.com/gbowerman/azure-myriad/blob/master/bigtest/bigbottle.json).</span></span>

## <a name="converting-an-existing-scale-set-toospan-multiple-placement-groups"></a><span data-ttu-id="0e3ba-150">Converter uma escala existente definido toospan vários grupos de posicionamento</span><span class="sxs-lookup"><span data-stu-id="0e3ba-150">Converting an existing scale set toospan multiple placement groups</span></span>
<span data-ttu-id="0e3ba-151">toomake uma escala VM existente definida capaz de dimensionamento toomore que 100 VMs, você precisa Olá toochange _singplePlacementGroup_ too_false_ de propriedade em escala Olá definir modelo.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-151">toomake an existing VM scale set capable of scaling toomore than 100 VMs, you need toochange hello _singplePlacementGroup_ property too_false_ in hello scale set model.</span></span> <span data-ttu-id="0e3ba-152">Você pode testar a alteração dessa propriedade com hello [Gerenciador de recursos do Azure](https://resources.azure.com/).</span><span class="sxs-lookup"><span data-stu-id="0e3ba-152">You can test changing this property with hello [Azure Resource Explorer](https://resources.azure.com/).</span></span> <span data-ttu-id="0e3ba-153">Localizar um conjunto de escala existente, selecione _editar_ e alterar Olá _singlePlacementGroup_ propriedade.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-153">Find an existing scale set, select _Edit_ and change hello _singlePlacementGroup_ property.</span></span> <span data-ttu-id="0e3ba-154">Se você não vir essa propriedade, você pode estar visualizando escala Olá definida com uma versão mais antiga do hello API Microsoft. Compute.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-154">If you do not see this property, you may be viewing hello scale set with an older version of hello Microsoft.Compute API.</span></span>

>[!NOTE] 
<span data-ttu-id="0e3ba-155">Você pode alterar uma conjunto de oferecer suporte a um único posicionamento grupo apenas (comportamento padrão de saudação) tooa dando suporte a vários grupos de posicionamento de escala, mas não é possível converter Olá oposto.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-155">You can change a scale set from supporting a single placement group only (hello default behavior) tooa supporting multiple placement groups, but you cannot convert hello other way around.</span></span> <span data-ttu-id="0e3ba-156">Portanto, certifique-se de que entender propriedades Olá dos conjuntos de grande escala antes da conversão.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-156">Therefore make sure you understand hello properties of large scale sets before converting.</span></span> <span data-ttu-id="0e3ba-157">Em particular, certifique-se de que você não precisa de camada 4 balanceamento de carga com hello balanceador de carga do Azure.</span><span class="sxs-lookup"><span data-stu-id="0e3ba-157">In particular, make sure you do not need layer-4 load balancing with hello Azure Load Balancer.</span></span>


