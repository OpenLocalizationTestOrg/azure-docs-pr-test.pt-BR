---
title: "Cofre de chaves de aaaAccess atrás de um firewall | Microsoft Docs"
description: Saiba como tooaccess chave do Azure Cofre de um aplicativo protegido por um firewall
services: key-vault
documentationcenter: 
author: amitbapat
manager: mbaldwin
tags: azure-resource-manager
ms.assetid: 50d21774-2ee1-4212-8995-570c9de603c5
ms.service: key-vault
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: hero-article
ms.date: 01/07/2017
ms.author: ambapat
ms.openlocfilehash: ab4bb0c27a41fef878a20dace6cab203df04e579
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="access-azure-key-vault-behind-a-firewall"></a><span data-ttu-id="aa708-103">Acessar o Cofre de Chaves do Azure por trás de um firewall</span><span class="sxs-lookup"><span data-stu-id="aa708-103">Access Azure Key Vault behind a firewall</span></span>
### <a name="q-my-key-vault-client-application-needs-toobe-behind-a-firewall-what-ports-hosts-or-ip-addresses-should-i-open-tooenable-access-tooa-key-vault"></a><span data-ttu-id="aa708-104">P: o aplicativo de cliente do Cofre de chaves precisa toobe atrás de um firewall.</span><span class="sxs-lookup"><span data-stu-id="aa708-104">Q: My key vault client application needs toobe behind a firewall.</span></span> <span data-ttu-id="aa708-105">Quais portas, hosts ou endereços IP deve abrir Cofre de chaves acesso tooa tooenable?</span><span class="sxs-lookup"><span data-stu-id="aa708-105">What ports, hosts, or IP addresses should I open tooenable access tooa key vault?</span></span>
<span data-ttu-id="aa708-106">tooaccess um cofre de chaves, o aplicativo de cliente do Cofre de chaves tem a tooaccess vários pontos de extremidade para várias funcionalidades:</span><span class="sxs-lookup"><span data-stu-id="aa708-106">tooaccess a key vault, your key vault client application has tooaccess multiple endpoints for various functionalities:</span></span>

* <span data-ttu-id="aa708-107">Autenticação via Azure AD (Azure Active Directory)</span><span class="sxs-lookup"><span data-stu-id="aa708-107">Authentication via Azure Active Directory (Azure AD).</span></span>
* <span data-ttu-id="aa708-108">Gerenciamento do Cofre de Chaves do Azure.</span><span class="sxs-lookup"><span data-stu-id="aa708-108">Management of Azure Key Vault.</span></span> <span data-ttu-id="aa708-109">Isso inclui criar, ler, atualizar, excluir e definir políticas de acesso por meio do Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="aa708-109">This includes creating, reading, updating, deleting, and setting access policies through Azure Resource Manager.</span></span>
* <span data-ttu-id="aa708-110">Acessar e gerenciar objetos (chaves e segredos) armazenados no cofre de chaves em si, passando por Olá ponto de extremidade específico de Cofre de chave (por exemplo, [https://yourvaultname.vault.azure.net](https://yourvaultname.vault.azure.net)).</span><span class="sxs-lookup"><span data-stu-id="aa708-110">Accessing and managing objects (keys and secrets) stored in Key Vault itself, going through hello Key Vault-specific endpoint (for example, [https://yourvaultname.vault.azure.net](https://yourvaultname.vault.azure.net)).</span></span>  

<span data-ttu-id="aa708-111">Dependendo do ambiente e configuração, há algumas variações.</span><span class="sxs-lookup"><span data-stu-id="aa708-111">Depending on your configuration and environment, there are some variations.</span></span>   

## <a name="ports"></a><span data-ttu-id="aa708-112">Portas</span><span class="sxs-lookup"><span data-stu-id="aa708-112">Ports</span></span>
<span data-ttu-id="aa708-113">Todos os tráfego tooa Cofre de chaves para todas as três funções (acesso de plano de dados, gerenciamento e autenticação) vai via HTTPS: porta 443.</span><span class="sxs-lookup"><span data-stu-id="aa708-113">All traffic tooa key vault for all three functions (authentication, management, and data plane access) goes over HTTPS: port 443.</span></span> <span data-ttu-id="aa708-114">No entanto, ocasionalmente, haverá tráfego HTTP (porta 80) para CRL.</span><span class="sxs-lookup"><span data-stu-id="aa708-114">However, there will occasionally be HTTP (port 80) traffic for CRL.</span></span> <span data-ttu-id="aa708-115">Os clientes que dão suporte a OCSP não devem chegar a CRL, mas ocasionalmente podem chegar a [http://cdp1.public-trust.com/CRL/Omniroot2025.crl](http://cdp1.public-trust.com/CRL/Omniroot2025.crl).</span><span class="sxs-lookup"><span data-stu-id="aa708-115">Clients that support OCSP shouldn't reach CRL, but may occasionally reach [http://cdp1.public-trust.com/CRL/Omniroot2025.crl](http://cdp1.public-trust.com/CRL/Omniroot2025.crl).</span></span>  

## <a name="authentication"></a><span data-ttu-id="aa708-116">Autenticação</span><span class="sxs-lookup"><span data-stu-id="aa708-116">Authentication</span></span>
<span data-ttu-id="aa708-117">Aplicativos de cliente do Cofre de chaves precisará tooaccess pontos de extremidade do Azure Active Directory para autenticação.</span><span class="sxs-lookup"><span data-stu-id="aa708-117">Key vault client applications will need tooaccess Azure Active Directory endpoints for authentication.</span></span> <span data-ttu-id="aa708-118">ponto de extremidade de saudação usado depende de Olá configuração de locatário do AD do Azure, o tipo de saudação do principal (UPN ou entidade de serviço) e hello tipo de conta – por exemplo, uma conta da Microsoft ou um trabalho ou conta escolar.</span><span class="sxs-lookup"><span data-stu-id="aa708-118">hello endpoint used depends on hello Azure AD tenant configuration, hello type of principal (user principal or service principal), and hello type of account--for example, a Microsoft account or a work or school account.</span></span>  

| <span data-ttu-id="aa708-119">Tipo de entidade</span><span class="sxs-lookup"><span data-stu-id="aa708-119">Principal type</span></span> | <span data-ttu-id="aa708-120">Ponto de extremidade:porta</span><span class="sxs-lookup"><span data-stu-id="aa708-120">Endpoint:port</span></span> |
| --- | --- |
| <span data-ttu-id="aa708-121">Usuário usando a conta da Microsoft</span><span class="sxs-lookup"><span data-stu-id="aa708-121">User using Microsoft account</span></span><br> <span data-ttu-id="aa708-122">(por exemplo, user@hotmail.com)</span><span class="sxs-lookup"><span data-stu-id="aa708-122">(for example, user@hotmail.com)</span></span> |<span data-ttu-id="aa708-123">**Global:**</span><span class="sxs-lookup"><span data-stu-id="aa708-123">**Global:**</span></span><br> <span data-ttu-id="aa708-124">login.microsoftonline.com:443</span><span class="sxs-lookup"><span data-stu-id="aa708-124">login.microsoftonline.com:443</span></span><br><br> <span data-ttu-id="aa708-125">**Azure China:**</span><span class="sxs-lookup"><span data-stu-id="aa708-125">**Azure China:**</span></span><br> <span data-ttu-id="aa708-126">login.chinacloudapi.cn:443</span><span class="sxs-lookup"><span data-stu-id="aa708-126">login.chinacloudapi.cn:443</span></span><br><br><span data-ttu-id="aa708-127">**Azure Governo dos EUA:**</span><span class="sxs-lookup"><span data-stu-id="aa708-127">**Azure US Government:**</span></span><br> <span data-ttu-id="aa708-128">login-us.microsoftonline.com:443</span><span class="sxs-lookup"><span data-stu-id="aa708-128">login-us.microsoftonline.com:443</span></span><br><br><span data-ttu-id="aa708-129">**Azure Alemanha:**</span><span class="sxs-lookup"><span data-stu-id="aa708-129">**Azure Germany:**</span></span><br> <span data-ttu-id="aa708-130">login.microsoftonline.de:443</span><span class="sxs-lookup"><span data-stu-id="aa708-130">login.microsoftonline.de:443</span></span><br><br> <span data-ttu-id="aa708-131">e</span><span class="sxs-lookup"><span data-stu-id="aa708-131">and</span></span> <br><span data-ttu-id="aa708-132">login.live.com:443</span><span class="sxs-lookup"><span data-stu-id="aa708-132">login.live.com:443</span></span> |
| <span data-ttu-id="aa708-133">Usuário ou entidade de serviço usando uma conta corporativa ou de Estudante com o Azure AD (por exemplo, user@contoso.com)</span><span class="sxs-lookup"><span data-stu-id="aa708-133">User or service principal using a work or school account with Azure AD (for example, user@contoso.com)</span></span> |<span data-ttu-id="aa708-134">**Global:**</span><span class="sxs-lookup"><span data-stu-id="aa708-134">**Global:**</span></span><br> <span data-ttu-id="aa708-135">login.microsoftonline.com:443</span><span class="sxs-lookup"><span data-stu-id="aa708-135">login.microsoftonline.com:443</span></span><br><br> <span data-ttu-id="aa708-136">**Azure China:**</span><span class="sxs-lookup"><span data-stu-id="aa708-136">**Azure China:**</span></span><br> <span data-ttu-id="aa708-137">login.chinacloudapi.cn:443</span><span class="sxs-lookup"><span data-stu-id="aa708-137">login.chinacloudapi.cn:443</span></span><br><br><span data-ttu-id="aa708-138">**Azure Governo dos EUA:**</span><span class="sxs-lookup"><span data-stu-id="aa708-138">**Azure US Government:**</span></span><br> <span data-ttu-id="aa708-139">login-us.microsoftonline.com:443</span><span class="sxs-lookup"><span data-stu-id="aa708-139">login-us.microsoftonline.com:443</span></span><br><br><span data-ttu-id="aa708-140">**Azure Alemanha:**</span><span class="sxs-lookup"><span data-stu-id="aa708-140">**Azure Germany:**</span></span><br> <span data-ttu-id="aa708-141">login.microsoftonline.de:443</span><span class="sxs-lookup"><span data-stu-id="aa708-141">login.microsoftonline.de:443</span></span> |
| <span data-ttu-id="aa708-142">Usuário ou entidade de serviço usando um trabalho ou conta de estudante, além de serviços de Federação do Active Directory (AD FS) ou outro ponto de extremidade federado (por exemplo, user@contoso.com)</span><span class="sxs-lookup"><span data-stu-id="aa708-142">User or service principal using a work or school account, plus Active Directory Federation Services (AD FS) or other federated endpoint (for example, user@contoso.com)</span></span> |<span data-ttu-id="aa708-143">Todos os pontos de extremidade de uma conta corporativa ou de estudante, além do AD FS ou outros pontos de extremidade federados</span><span class="sxs-lookup"><span data-stu-id="aa708-143">All endpoints for a work or school account, plus AD FS or other federated endpoints</span></span> |

<span data-ttu-id="aa708-144">Há outros cenários complexos possíveis.</span><span class="sxs-lookup"><span data-stu-id="aa708-144">There are other possible complex scenarios.</span></span> <span data-ttu-id="aa708-145">Consulte também[fluxo do Azure Active Directory autenticação](/documentation/articles/active-directory-authentication-scenarios/), [integrando aplicativos com o Active Directory do Azure](/documentation/articles/active-directory-integrating-applications/), e [protocolos de autenticação do Active Directory](https://msdn.microsoft.com/library/azure/dn151124.aspx) Para obter informações adicionais.</span><span class="sxs-lookup"><span data-stu-id="aa708-145">Refer too[Azure Active Directory Authentication Flow](/documentation/articles/active-directory-authentication-scenarios/), [Integrating Applications with Azure Active Directory](/documentation/articles/active-directory-integrating-applications/), and [Active Directory Authentication Protocols](https://msdn.microsoft.com/library/azure/dn151124.aspx) for additional information.</span></span>  

## <a name="key-vault-management"></a><span data-ttu-id="aa708-146">Gerenciamento do Cofre de Chaves</span><span class="sxs-lookup"><span data-stu-id="aa708-146">Key Vault management</span></span>
<span data-ttu-id="aa708-147">Para o gerenciamento de Cofre de chaves (CRUD e configuração de política de acesso), o aplicativo de cliente do Cofre de chaves de saudação precisa tooaccess um ponto de extremidade do Gerenciador de recursos do Azure.</span><span class="sxs-lookup"><span data-stu-id="aa708-147">For Key Vault management (CRUD and setting access policy), hello key vault client application needs tooaccess an Azure Resource Manager endpoint.</span></span>  

| <span data-ttu-id="aa708-148">Tipo de operação</span><span class="sxs-lookup"><span data-stu-id="aa708-148">Type of operation</span></span> | <span data-ttu-id="aa708-149">Ponto de extremidade:porta</span><span class="sxs-lookup"><span data-stu-id="aa708-149">Endpoint:port</span></span> |
| --- | --- |
| <span data-ttu-id="aa708-150">Operações do plano de controle do cofre de chaves</span><span class="sxs-lookup"><span data-stu-id="aa708-150">Key Vault control plane operations</span></span><br> <span data-ttu-id="aa708-151">por meio do Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="aa708-151">via Azure Resource Manager</span></span> |<span data-ttu-id="aa708-152">**Global:**</span><span class="sxs-lookup"><span data-stu-id="aa708-152">**Global:**</span></span><br> <span data-ttu-id="aa708-153">management.azure.com:443</span><span class="sxs-lookup"><span data-stu-id="aa708-153">management.azure.com:443</span></span><br><br> <span data-ttu-id="aa708-154">**Azure China:**</span><span class="sxs-lookup"><span data-stu-id="aa708-154">**Azure China:**</span></span><br> <span data-ttu-id="aa708-155">management.chinacloudapi.cn:443</span><span class="sxs-lookup"><span data-stu-id="aa708-155">management.chinacloudapi.cn:443</span></span><br><br> <span data-ttu-id="aa708-156">**Azure Governo dos EUA:**</span><span class="sxs-lookup"><span data-stu-id="aa708-156">**Azure US Government:**</span></span><br> <span data-ttu-id="aa708-157">management.usgovcloudapi.net:443</span><span class="sxs-lookup"><span data-stu-id="aa708-157">management.usgovcloudapi.net:443</span></span><br><br> <span data-ttu-id="aa708-158">**Azure Alemanha:**</span><span class="sxs-lookup"><span data-stu-id="aa708-158">**Azure Germany:**</span></span><br> <span data-ttu-id="aa708-159">management.microsoftazure.de:443</span><span class="sxs-lookup"><span data-stu-id="aa708-159">management.microsoftazure.de:443</span></span> |
| <span data-ttu-id="aa708-160">Graph API do Active Directory do Azure</span><span class="sxs-lookup"><span data-stu-id="aa708-160">Azure Active Directory Graph API</span></span> |<span data-ttu-id="aa708-161">**Global:**</span><span class="sxs-lookup"><span data-stu-id="aa708-161">**Global:**</span></span><br> <span data-ttu-id="aa708-162">graph.windows.net:443</span><span class="sxs-lookup"><span data-stu-id="aa708-162">graph.windows.net:443</span></span><br><br> <span data-ttu-id="aa708-163">**Azure China:**</span><span class="sxs-lookup"><span data-stu-id="aa708-163">**Azure China:**</span></span><br> <span data-ttu-id="aa708-164">graph.chinacloudapi.cn:443</span><span class="sxs-lookup"><span data-stu-id="aa708-164">graph.chinacloudapi.cn:443</span></span><br><br> <span data-ttu-id="aa708-165">**Azure Governo dos EUA:**</span><span class="sxs-lookup"><span data-stu-id="aa708-165">**Azure US Government:**</span></span><br> <span data-ttu-id="aa708-166">graph.windows.net:443</span><span class="sxs-lookup"><span data-stu-id="aa708-166">graph.windows.net:443</span></span><br><br> <span data-ttu-id="aa708-167">**Azure Alemanha:**</span><span class="sxs-lookup"><span data-stu-id="aa708-167">**Azure Germany:**</span></span><br> <span data-ttu-id="aa708-168">graph.cloudapi.de:443</span><span class="sxs-lookup"><span data-stu-id="aa708-168">graph.cloudapi.de:443</span></span> |

## <a name="key-vault-operations"></a><span data-ttu-id="aa708-169">Operações do cofre de chaves</span><span class="sxs-lookup"><span data-stu-id="aa708-169">Key Vault operations</span></span>
<span data-ttu-id="aa708-170">Para todas as operações de criptografia e gerenciamento de Cofre de chaves de objeto (chaves e segredos), o cliente do Cofre de chaves de saudação precisa ponto de extremidade do tooaccess Olá Cofre de chaves.</span><span class="sxs-lookup"><span data-stu-id="aa708-170">For all key vault object (keys and secrets) management and cryptographic operations, hello key vault client needs tooaccess hello key vault endpoint.</span></span> <span data-ttu-id="aa708-171">sufixo DNS do ponto de extremidade Olá varia dependendo do local de saudação do seu Cofre de chaves.</span><span class="sxs-lookup"><span data-stu-id="aa708-171">hello endpoint DNS suffix varies depending on hello location of your key vault.</span></span> <span data-ttu-id="aa708-172">o ponto de extremidade do Hello Cofre de chaves está em formato de saudação *nome do cofre*. *região---o sufixo dns específico*, conforme descrito em Olá a tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="aa708-172">hello key vault endpoint is of hello format *vault-name*.*region-specific-dns-suffix*, as described in hello following table.</span></span>  

| <span data-ttu-id="aa708-173">Tipo de operação</span><span class="sxs-lookup"><span data-stu-id="aa708-173">Type of operation</span></span> | <span data-ttu-id="aa708-174">Ponto de extremidade:porta</span><span class="sxs-lookup"><span data-stu-id="aa708-174">Endpoint:port</span></span> |
| --- | --- |
| <span data-ttu-id="aa708-175">Operações, incluindo operações criptográficas em chaves; criar, ler, atualizar e excluir chaves e segredos; definir ou obter marcas e outros atributos em objetos de cofre de chaves (chaves ou segredos)</span><span class="sxs-lookup"><span data-stu-id="aa708-175">Operations including cryptographic operations on keys; creating, reading, updating, and deleting keys and secrets; setting or getting tags and other attributes on key vault objects (keys or secrets)</span></span> |<span data-ttu-id="aa708-176">**Global:**</span><span class="sxs-lookup"><span data-stu-id="aa708-176">**Global:**</span></span><br> <span data-ttu-id="aa708-177">&lt;vault-name&gt;.vault.azure.net:443</span><span class="sxs-lookup"><span data-stu-id="aa708-177">&lt;vault-name&gt;.vault.azure.net:443</span></span><br><br> <span data-ttu-id="aa708-178">**Azure China:**</span><span class="sxs-lookup"><span data-stu-id="aa708-178">**Azure China:**</span></span><br> <span data-ttu-id="aa708-179">&lt;vault-name&gt;.vault.azure.cn:443</span><span class="sxs-lookup"><span data-stu-id="aa708-179">&lt;vault-name&gt;.vault.azure.cn:443</span></span><br><br> <span data-ttu-id="aa708-180">**Azure Governo dos EUA:**</span><span class="sxs-lookup"><span data-stu-id="aa708-180">**Azure US Government:**</span></span><br> <span data-ttu-id="aa708-181">&lt;vault-name&gt;.vault.usgovcloudapi.net:443</span><span class="sxs-lookup"><span data-stu-id="aa708-181">&lt;vault-name&gt;.vault.usgovcloudapi.net:443</span></span><br><br> <span data-ttu-id="aa708-182">**Azure Alemanha:**</span><span class="sxs-lookup"><span data-stu-id="aa708-182">**Azure Germany:**</span></span><br> <span data-ttu-id="aa708-183">&lt;vault-name&gt;.vault.microsoftazure.de:443</span><span class="sxs-lookup"><span data-stu-id="aa708-183">&lt;vault-name&gt;.vault.microsoftazure.de:443</span></span> |

## <a name="ip-address-ranges"></a><span data-ttu-id="aa708-184">Intervalos de endereços IP</span><span class="sxs-lookup"><span data-stu-id="aa708-184">IP address ranges</span></span>
<span data-ttu-id="aa708-185">Olá serviço de Cofre de chaves usa outros recursos do Azure como a infraestrutura de PaaS.</span><span class="sxs-lookup"><span data-stu-id="aa708-185">hello Key Vault service uses other Azure resources like PaaS infrastructure.</span></span> <span data-ttu-id="aa708-186">Portanto, não é possível tooprovide um específico intervalo de endereços IP que o Cofre de chaves terão pontos de extremidade de serviço a qualquer momento determinado.</span><span class="sxs-lookup"><span data-stu-id="aa708-186">So it's not possible tooprovide a specific range of IP addresses that Key Vault service endpoints will have at any particular time.</span></span> <span data-ttu-id="aa708-187">Se o firewall oferece suporte a apenas os intervalos de endereços IP, consulte toohello [intervalos de IP de Datacenter do Microsoft Azure](https://www.microsoft.com/download/details.aspx?id=41653) documento.</span><span class="sxs-lookup"><span data-stu-id="aa708-187">If your firewall supports only IP address ranges, refer toohello [Microsoft Azure Datacenter IP Ranges](https://www.microsoft.com/download/details.aspx?id=41653) document.</span></span> <span data-ttu-id="aa708-188">Autenticação e identidade (Active Directory do Azure), seu aplicativo deve ser capaz de tooconnect toohello pontos de extremidade descritos em [endereços de autenticação e identidade](https://support.office.com/article/Office-365-URLs-and-IP-address-ranges-8548a211-3fe7-47cb-abb1-355ea5aa88a2).</span><span class="sxs-lookup"><span data-stu-id="aa708-188">For authentication and identity (Azure Active Directory), your application must be able tooconnect toohello endpoints described in [Authentication and identity addresses](https://support.office.com/article/Office-365-URLs-and-IP-address-ranges-8548a211-3fe7-47cb-abb1-355ea5aa88a2).</span></span>

## <a name="next-steps"></a><span data-ttu-id="aa708-189">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="aa708-189">Next steps</span></span>
<span data-ttu-id="aa708-190">Se você tiver dúvidas sobre o Cofre de chaves, visite Olá [fóruns do Azure Key Vault](https://social.msdn.microsoft.com/forums/azure/home?forum=AzureKeyVault).</span><span class="sxs-lookup"><span data-stu-id="aa708-190">If you have questions about Key Vault, visit hello [Azure Key Vault Forums](https://social.msdn.microsoft.com/forums/azure/home?forum=AzureKeyVault).</span></span>

