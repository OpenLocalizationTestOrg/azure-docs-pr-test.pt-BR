---
title: "Guia de solução de problemas do Stream Analytics do Azure | Microsoft Docs"
description: Como resolver problemas do trabalho do Stream Analytics
keywords: "guia de solução de problemas"
documentationcenter: 
services: stream-analytics
author: jeffstokes72
manager: jhubbard
editor: cgronlun
ms.assetid: 
ms.service: stream-analytics
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-services
ms.date: 04/20/2017
ms.author: jeffstok
ms.openlocfilehash: 8ecf279047f06691cef1bc0db06888974405a9f0
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/29/2017
---
# <a name="troubleshooting-guide-for-azure-stream-analytics"></a><span data-ttu-id="9f2eb-104">Guia de solução de problemas do Stream Analytics do Azure</span><span class="sxs-lookup"><span data-stu-id="9f2eb-104">Troubleshooting guide for Azure Stream Analytics</span></span>

<span data-ttu-id="9f2eb-105">A solução de problemas do Stream Analytics do Azure pode parecer ser um esforço complexo à primeira vista.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-105">Azure Stream Analytics troubleshooting can appear to be a complex effort at first glance.</span></span> <span data-ttu-id="9f2eb-106">Depois de trabalhar com vários usuários, criamos este guia para ajudar a simplificar o processo e remover as suposições sobre suas entradas, saídas, consultas e funções.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-106">After working with many users, we have created this guide to help streamline the process and remove the guesswork about your inputs, outputs, queries, and functions.</span></span>

## <a name="troubleshoot-your-stream-analytics-job"></a><span data-ttu-id="9f2eb-107">Resolver problemas do trabalho do Stream Analytics</span><span class="sxs-lookup"><span data-stu-id="9f2eb-107">Troubleshoot your Stream Analytics job</span></span>

<span data-ttu-id="9f2eb-108">Para obter melhores resultados na solução de problemas do trabalho do Stream Analytics, use as seguintes diretrizes:</span><span class="sxs-lookup"><span data-stu-id="9f2eb-108">For best results in troubleshooting your Stream Analytics job, use the following guidelines:</span></span>

1.  <span data-ttu-id="9f2eb-109">Testar a conectividade:</span><span class="sxs-lookup"><span data-stu-id="9f2eb-109">Test your connectivity:</span></span>
    - <span data-ttu-id="9f2eb-110">Verifique a conectividade com as entradas e saídas usando o botão **Testar Conexão** em cada entrada e saída.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-110">Verify connectivity to inputs and outputs by using the **Test Connection** button for each input and output.</span></span>

2.  <span data-ttu-id="9f2eb-111">Examinar os dados de entrada:</span><span class="sxs-lookup"><span data-stu-id="9f2eb-111">Examine your input data:</span></span>
    - <span data-ttu-id="9f2eb-112">Para verificar se os dados de entrada estão fluindo para o Hub de Eventos, use o [Gerenciador do Barramento de Serviço](https://code.msdn.microsoft.com/windowsapps/Service-Bus-Explorer-f2abca5a) para se conectar ao Hub de Eventos do Azure (caso a entrada do Hub de Eventos seja usada).</span><span class="sxs-lookup"><span data-stu-id="9f2eb-112">To verify that input data is flowing into Event Hub, use [Service Bus Explorer](https://code.msdn.microsoft.com/windowsapps/Service-Bus-Explorer-f2abca5a) to connect to Azure Event Hub (if Event Hub input is used).</span></span>  
    - <span data-ttu-id="9f2eb-113">Use o botão [**Dados de Exemplo**](stream-analytics-sample-data-input.md) para cada entrada e baixe os dados de exemplo de entrada.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-113">Use the [**Sample Data**](stream-analytics-sample-data-input.md) button for each input, and download the input sample data.</span></span>
    - <span data-ttu-id="9f2eb-114">Inspecione os dados de exemplo para entender a forma deles: o esquema e os [tipos de dados](https://msdn.microsoft.com/library/azure/dn835065.aspx).</span><span class="sxs-lookup"><span data-stu-id="9f2eb-114">Inspect the sample data to understand the shape of the data: the schema and the [data types](https://msdn.microsoft.com/library/azure/dn835065.aspx).</span></span>

3.  <span data-ttu-id="9f2eb-115">Testar a consulta:</span><span class="sxs-lookup"><span data-stu-id="9f2eb-115">Test your query:</span></span>
    - <span data-ttu-id="9f2eb-116">Na guia **Consulta**, use o botão **Testar** para testar a consulta e use os dados de exemplo baixados para [testar a consulta](stream-analytics-test-query.md).</span><span class="sxs-lookup"><span data-stu-id="9f2eb-116">On the **Query** tab, use the **Test** button to test the query, and use the downloaded sample data to [test the query](stream-analytics-test-query.md).</span></span> <span data-ttu-id="9f2eb-117">Examine os erros e tente corrigi-los.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-117">Examine any errors and attempt to correct them.</span></span>
    - <span data-ttu-id="9f2eb-118">Se você usar [**Carimbo de Data/Hora Por**](https://msdn.microsoft.com/library/azure/mt573293.aspx), verifique se os eventos têm carimbos de data/hora maiores que a [hora de início do trabalho](stream-analytics-out-of-order-and-late-events.md).</span><span class="sxs-lookup"><span data-stu-id="9f2eb-118">If you use [**Timestamp By**](https://msdn.microsoft.com/library/azure/mt573293.aspx), verify that the events have timestamps greater than the [job start time](stream-analytics-out-of-order-and-late-events.md).</span></span>

4.  <span data-ttu-id="9f2eb-119">Depurar a consulta:</span><span class="sxs-lookup"><span data-stu-id="9f2eb-119">Debug your query:</span></span>
    - <span data-ttu-id="9f2eb-120">Recompile a consulta progressivamente desde uma instrução select simples até agregações mais complexas usando etapas.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-120">Rebuild the query progressively from simple select statement to more complex aggregates by using steps.</span></span> <span data-ttu-id="9f2eb-121">Para criar a lógica da consulta passo a passo, use cláusulas [WITH](https://msdn.microsoft.com/library/azure/dn835049.aspx).</span><span class="sxs-lookup"><span data-stu-id="9f2eb-121">To build up the query logic step by step, use [WITH](https://msdn.microsoft.com/library/azure/dn835049.aspx) clauses.</span></span>
    - <span data-ttu-id="9f2eb-122">Use [SELECT INTO](stream-analytics-select-into.md) para depurar as etapas da consulta.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-122">Use [SELECT INTO](stream-analytics-select-into.md) to debug query steps.</span></span>

5.  <span data-ttu-id="9f2eb-123">Elimine armadilhas comuns, como:</span><span class="sxs-lookup"><span data-stu-id="9f2eb-123">Eliminate common pitfalls, such as:</span></span>
    - <span data-ttu-id="9f2eb-124">Uma cláusula [**WHERE**](https://msdn.microsoft.com/library/azure/dn835048.aspx) na consulta filtrou todos os eventos, impedindo que uma saída seja gerada.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-124">A [**WHERE**](https://msdn.microsoft.com/library/azure/dn835048.aspx) clause in the query filtered out all events, preventing any output from being generated.</span></span>
    - <span data-ttu-id="9f2eb-125">Ao usar funções de janela, aguarde a duração de toda a janela para ver uma saída da consulta.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-125">When you use window functions, wait for the entire window duration to see an output from the query.</span></span>
    - <span data-ttu-id="9f2eb-126">O carimbo de data/hora de eventos precede a hora de início do trabalho e, portanto, os eventos são removidos.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-126">The timestamp for events precedes the job start time and, therefore, events are being dropped.</span></span>

6.  <span data-ttu-id="9f2eb-127">Usar a ordenação de eventos:</span><span class="sxs-lookup"><span data-stu-id="9f2eb-127">Use event ordering:</span></span>
    - <span data-ttu-id="9f2eb-128">Se todas as etapas anteriores funcionaram bem, acesse a folha **Configurações** e selecione [**Ordenação de Eventos**](stream-analytics-out-of-order-and-late-events.md).</span><span class="sxs-lookup"><span data-stu-id="9f2eb-128">If all the previous steps worked fine, go to the **Settings** blade and select [**Event Ordering**](stream-analytics-out-of-order-and-late-events.md).</span></span> <span data-ttu-id="9f2eb-129">Verificar se essa política está configurada para o que faz sentido em seu cenário.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-129">Verify that this policy is configured for what makes sense in your scenario.</span></span> <span data-ttu-id="9f2eb-130">A política *não* é aplicada quando você usa o botão **Testar** para testar a consulta.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-130">The policy is *not* applied when you use the **Test** button to test the query.</span></span> <span data-ttu-id="9f2eb-131">Esse resultado é uma das diferenças entre o teste no navegador comparado à execução do trabalho em produção.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-131">This result is one difference between testing in-browser versus running the job in production.</span></span>

7.  <span data-ttu-id="9f2eb-132">Depurar usando métricas:</span><span class="sxs-lookup"><span data-stu-id="9f2eb-132">Debug by using metrics:</span></span>
    - <span data-ttu-id="9f2eb-133">Se você não obter nenhuma saída após a duração esperada (com base na consulta), tente o seguinte:</span><span class="sxs-lookup"><span data-stu-id="9f2eb-133">If you obtain no output after the expected duration (based on the query), try the following:</span></span>
        - <span data-ttu-id="9f2eb-134">Examine [**Métricas de Monitoramento**](stream-analytics-monitoring.md) na guia **Monitor**. Como os valores são agregados, as métricas são atrasadas em alguns minutos.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-134">Look at [**Monitoring Metrics**](stream-analytics-monitoring.md) on the **Monitor** tab. Because the values are aggregated, the metrics are delayed by a few minutes.</span></span>
            - <span data-ttu-id="9f2eb-135">Se os Eventos de Entrada forem > 0, o trabalho poderá ler os dados de entrada.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-135">If Input Events > 0, the job is able to read input data.</span></span> <span data-ttu-id="9f2eb-136">Se os Eventos de Entrada não forem > 0:</span><span class="sxs-lookup"><span data-stu-id="9f2eb-136">If Input Events is not > 0, then:</span></span>
                - <span data-ttu-id="9f2eb-137">Para ver se a fonte de dados tem dados válidos, verifique-a usando o [Gerenciador do Barramento de Serviço](https://code.msdn.microsoft.com/windowsapps/Service-Bus-Explorer-f2abca5a).</span><span class="sxs-lookup"><span data-stu-id="9f2eb-137">To see whether the data source has valid data, check it by using [Service Bus Explorer](https://code.msdn.microsoft.com/windowsapps/Service-Bus-Explorer-f2abca5a).</span></span> <span data-ttu-id="9f2eb-138">Essa seleção se aplica se o trabalho está usando o Hub de Eventos como entrada.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-138">This check applies if the job is using Event Hub as input.</span></span>
                - <span data-ttu-id="9f2eb-139">Verifique se o formato de serialização de dados e a codificação de dados são como esperado.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-139">Check to see whether the data serialization format and data encoding are as expected.</span></span>
                - <span data-ttu-id="9f2eb-140">Se o trabalho estiver usando um Hub de Eventos, verifique se o corpo da mensagem será *Null*.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-140">If the job is using an Event Hub, check to see whether the body of the message is *Null*.</span></span>
            - <span data-ttu-id="9f2eb-141">Se os Erros de Conversão de Dados forem > 0 e estiverem aumentando, os seguintes casos poderão ser verdadeiros:</span><span class="sxs-lookup"><span data-stu-id="9f2eb-141">If Data Conversion Errors > 0 and climbing, the following might be true:</span></span>
                - <span data-ttu-id="9f2eb-142">O trabalho pode não conseguir desserializar os eventos.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-142">The job might not be able to de-serialize the events.</span></span>
                - <span data-ttu-id="9f2eb-143">O esquema de eventos pode não corresponder ao esquema definido ou esperado dos eventos na consulta.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-143">The event schema might not match the defined or expected schema of the events in the query.</span></span>
                - <span data-ttu-id="9f2eb-144">Os tipos de dados de alguns dos campos no evento podem não corresponder às expectativas.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-144">The datatypes of some of the fields in the event might not match expectations.</span></span>
            - <span data-ttu-id="9f2eb-145">Se os Erros em Tempo de Execução forem > 0, isso significa que o trabalho pode receber os dados, mas está gerando erros durante o processamento da consulta.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-145">If Runtime Errors > 0, it means that the job can receive the data but is generating errors while processing the query.</span></span>
                - <span data-ttu-id="9f2eb-146">Para encontrar os erros, acesse os [Logs de Auditoria](../azure-resource-manager/resource-group-audit.md) e filtre o status *Com Falha*.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-146">To find the errors, go to the [Audit Logs](../azure-resource-manager/resource-group-audit.md) and filter on *Failed* status.</span></span>
            - <span data-ttu-id="9f2eb-147">Se os InputEvents forem > 0 e os OutputEvents forem = 0, isso significa que um dos seguintes casos é verdadeiro:</span><span class="sxs-lookup"><span data-stu-id="9f2eb-147">If InputEvents > 0 and OutputEvents = 0, it means that one of the following is true:</span></span>
                - <span data-ttu-id="9f2eb-148">O processamento de consulta resultou em zero evento de saída.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-148">Query processing resulted in zero output events.</span></span>
                - <span data-ttu-id="9f2eb-149">Os eventos ou seus campos podem estar malformados, resultando em nenhuma saída após o processamento da consulta.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-149">Events or its fields might be malformed, resulting in zero output after query processing.</span></span>
                - <span data-ttu-id="9f2eb-150">O trabalho não pôde enviar dados por push para o [coletor de saída](stream-analytics-select-into.md) por motivos de conectividade ou autenticação.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-150">The job was unable to push data to the [output sink](stream-analytics-select-into.md) for connectivity or authentication reasons.</span></span>
        - <span data-ttu-id="9f2eb-151">Em todos os casos de erro mencionados anteriormente, as mensagens do log de operações explicam os detalhes adicionais (incluindo o que está acontecendo), exceto nos casos em que a lógica da consulta filtrou todos os eventos.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-151">In all the previously mentioned error cases, operations log messages explain additional details (including what is happening), except in cases where the query logic filtered out all events.</span></span> <span data-ttu-id="9f2eb-152">Se o processamento de vários eventos gerar erros, o Stream Analytics registrará as três primeiras mensagens de erro do mesmo tipo em até 10 minutos nos Logs de operações.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-152">If the processing of multiple events generates errors, Stream Analytics logs the first three error messages of the same type within 10 minutes to Operations logs.</span></span> <span data-ttu-id="9f2eb-153">Em seguida, ele suprimirá erros idênticos adicionais com a mensagem “Os erros estão ocorrendo muito rapidamente e estão sendo suprimidos”.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-153">It then suppresses additional identical errors with a message that reads “Errors are happening too rapidly, these are being suppressed.”</span></span>

8. <span data-ttu-id="9f2eb-154">Depurar usando os logs de auditoria e de diagnóstico:</span><span class="sxs-lookup"><span data-stu-id="9f2eb-154">Debug by using audit and diagnostic logs:</span></span>
    - <span data-ttu-id="9f2eb-155">Use os [Logs de Auditoria](../azure-resource-manager/resource-group-audit.md) e filtre para identificar e depurar erros.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-155">Use [Audit Logs](../azure-resource-manager/resource-group-audit.md), and filter to identify and debug errors.</span></span>
    - <span data-ttu-id="9f2eb-156">Use os [logs de diagnóstico do trabalho](stream-analytics-job-diagnostic-logs.md) para identificar e depurar erros.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-156">Use [job diagnostic logs](stream-analytics-job-diagnostic-logs.md) to identify and debug errors.</span></span>

9. <span data-ttu-id="9f2eb-157">Examinar as saídas:</span><span class="sxs-lookup"><span data-stu-id="9f2eb-157">Examine the outputs:</span></span>
    - <span data-ttu-id="9f2eb-158">Quando o status do trabalho for *Em Execução*, dependendo da duração estipulada na consulta, você poderá ver a saída na fonte de dados do coletor.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-158">When the job status is *Running*, depending on the duration that's stipulated in the query, you can see the output in the sink data source.</span></span>
    - <span data-ttu-id="9f2eb-159">Se você não vir as saídas que estão indo para um tipo de saída específico, redirecione-as para um tipo de saída menos complexo, como um Blob do Azure.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-159">If you cannot see outputs that are going to a specific output type, redirect them to an output type that is less complex, such as an Azure Blob.</span></span> <span data-ttu-id="9f2eb-160">Com o Gerenciador de Armazenamento, verifique se a saída pode ser vista.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-160">By using Storage Explorer, check to see whether the output can be seen.</span></span> <span data-ttu-id="9f2eb-161">Além disso, verifique se as limitações na saída estão impedindo o recebimento de dados.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-161">Additionally, verify whether throttling limits at the output are preventing data from being received.</span></span>

10. <span data-ttu-id="9f2eb-162">Use a análise de fluxo de dados com métricas do diagrama de trabalho:</span><span class="sxs-lookup"><span data-stu-id="9f2eb-162">Use data-flow analysis with job diagram metrics:</span></span>
    - <span data-ttu-id="9f2eb-163">Para analisar o fluxo de dados e identificar problemas, use o [diagrama de trabalho com métricas](stream-analytics-job-diagram-with-metrics.md).</span><span class="sxs-lookup"><span data-stu-id="9f2eb-163">To analyze data flow and identify issues, use the [job diagram with metrics](stream-analytics-job-diagram-with-metrics.md).</span></span>

11. <span data-ttu-id="9f2eb-164">Abrir um caso de suporte:</span><span class="sxs-lookup"><span data-stu-id="9f2eb-164">Open a support case:</span></span>
    - <span data-ttu-id="9f2eb-165">Por fim, se todas as outras soluções falharem, abra um caso de suporte da Microsoft usando a SubscriptionID que contém o trabalho.</span><span class="sxs-lookup"><span data-stu-id="9f2eb-165">Finally, if all else fails, open a Microsoft support case by using the SubscriptionID that contains your job.</span></span>

## <a name="get-help"></a><span data-ttu-id="9f2eb-166">Obter ajuda</span><span class="sxs-lookup"><span data-stu-id="9f2eb-166">Get help</span></span>

<span data-ttu-id="9f2eb-167">Para obter mais assistência, experimente nosso [fórum do Stream Analytics do Azure](https://social.msdn.microsoft.com/Forums/en-US/home?forum=AzureStreamAnalytics)</span><span class="sxs-lookup"><span data-stu-id="9f2eb-167">For further assistance, try our [Azure Stream Analytics forum](https://social.msdn.microsoft.com/Forums/en-US/home?forum=AzureStreamAnalytics).</span></span>

## <a name="next-steps"></a><span data-ttu-id="9f2eb-168">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="9f2eb-168">Next steps</span></span>

* [<span data-ttu-id="9f2eb-169">Introdução ao Stream Analytics do Azure</span><span class="sxs-lookup"><span data-stu-id="9f2eb-169">Introduction to Azure Stream Analytics</span></span>](stream-analytics-introduction.md)
* [<span data-ttu-id="9f2eb-170">Introdução ao uso do Stream Analytics do Azure</span><span class="sxs-lookup"><span data-stu-id="9f2eb-170">Get started using Azure Stream Analytics</span></span>](stream-analytics-real-time-fraud-detection.md)
* [<span data-ttu-id="9f2eb-171">Dimensionar trabalhos do Stream Analytics do Azure</span><span class="sxs-lookup"><span data-stu-id="9f2eb-171">Scale Azure Stream Analytics jobs</span></span>](stream-analytics-scale-jobs.md)
* [<span data-ttu-id="9f2eb-172">Referência de Linguagem de Consulta do Stream Analytics do Azure</span><span class="sxs-lookup"><span data-stu-id="9f2eb-172">Azure Stream Analytics Query Language Reference</span></span>](https://msdn.microsoft.com/library/azure/dn834998.aspx)
* [<span data-ttu-id="9f2eb-173">Referência da API REST do Gerenciamento do Azure Stream Analytics</span><span class="sxs-lookup"><span data-stu-id="9f2eb-173">Azure Stream Analytics Management REST API Reference</span></span>](https://msdn.microsoft.com/library/azure/dn835031.aspx)
