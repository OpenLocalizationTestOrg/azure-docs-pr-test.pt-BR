---
title: "aaaSecurity considerações para o SQL Server no Azure | Microsoft Docs"
description: "Este tópico fornece diretrizes gerais para proteger o SQL Server em execução em uma Máquina Virtual do Azure."
services: virtual-machines-windows
documentationcenter: na
author: rothja
manager: jhubbard
editor: 
tags: azure-service-management
ms.assetid: d710c296-e490-43e7-8ca9-8932586b71da
ms.service: virtual-machines-sql
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows-sql-server
ms.workload: iaas-sql-server
ms.date: 06/02/2017
ms.author: jroth
ms.openlocfilehash: 14c3d828fa87446da67beea6d28886de254afe15
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="security-considerations-for-sql-server-in-azure-virtual-machines"></a><span data-ttu-id="8bbee-103">Considerações sobre Segurança para SQL Server em Máquinas Virtuais do Azure</span><span class="sxs-lookup"><span data-stu-id="8bbee-103">Security Considerations for SQL Server in Azure Virtual Machines</span></span>

<span data-ttu-id="8bbee-104">Este tópico inclui as diretrizes gerais de segurança que ajudam a estabelecer acesso seguro tooSQL Server instâncias em uma máquina virtual do Azure (VM).</span><span class="sxs-lookup"><span data-stu-id="8bbee-104">This topic includes overall security guidelines that help establish secure access tooSQL Server instances in an Azure virtual machine (VM).</span></span>

<span data-ttu-id="8bbee-105">Azure está em conformidade com vários regulamentos do setor e padrões que podem permitir que você toobuild uma solução compatível com o SQL Server em execução em uma máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="8bbee-105">Azure complies with several industry regulations and standards that can enable you toobuild a compliant solution with SQL Server running in a virtual machine.</span></span> <span data-ttu-id="8bbee-106">Para obter informações sobre conformidade regulamentar com o Azure, consulte a [Central de Confiabilidade do Azure](https://azure.microsoft.com/support/trust-center/).</span><span class="sxs-lookup"><span data-stu-id="8bbee-106">For information about regulatory compliance with Azure, see [Azure Trust Center](https://azure.microsoft.com/support/trust-center/).</span></span>

[!INCLUDE [learn-about-deployment-models](../../../../includes/learn-about-deployment-models-both-include.md)]

## <a name="control-access-toohello-sql-vm"></a><span data-ttu-id="8bbee-107">Controlar acesso toohello VM do SQL</span><span class="sxs-lookup"><span data-stu-id="8bbee-107">Control access toohello SQL VM</span></span>

<span data-ttu-id="8bbee-108">Quando você cria sua máquina de virtual do SQL Server, considere como toocarefully controlar quem tem toohello acessar o computador e tooSQL Server.</span><span class="sxs-lookup"><span data-stu-id="8bbee-108">When you create your SQL Server virtual machine, consider how toocarefully control who has access toohello machine and tooSQL Server.</span></span> <span data-ttu-id="8bbee-109">Em geral, você deve fazer a seguir hello:</span><span class="sxs-lookup"><span data-stu-id="8bbee-109">In general, you should do hello following:</span></span>

- <span data-ttu-id="8bbee-110">Restringir acesso tooSQL Server tooonly Olá aplicativos e clientes que precisam dela.</span><span class="sxs-lookup"><span data-stu-id="8bbee-110">Restrict access tooSQL Server tooonly hello applications and clients that need it.</span></span>
- <span data-ttu-id="8bbee-111">Siga as melhores práticas de gerenciamento de contas de usuário e senhas.</span><span class="sxs-lookup"><span data-stu-id="8bbee-111">Follow best practices for managing user accounts and passwords.</span></span>

<span data-ttu-id="8bbee-112">Olá seções a seguir fornece sugestões sobre pensando desses pontos.</span><span class="sxs-lookup"><span data-stu-id="8bbee-112">hello following sections provide suggestions on thinking through these points.</span></span>

## <a name="secure-connections"></a><span data-ttu-id="8bbee-113">Conexões seguras</span><span class="sxs-lookup"><span data-stu-id="8bbee-113">Secure connections</span></span>

<span data-ttu-id="8bbee-114">Quando você cria uma máquina virtual SQL Server com uma imagem da galeria, Olá **conectividade do SQL Server** opção fornece Olá escolha de **Local (dentro da VM)**, **privada (dentro de uma rede Virtual)** , ou **pública (Internet)**.</span><span class="sxs-lookup"><span data-stu-id="8bbee-114">When you create a SQL Server virtual machine with a gallery image, hello **SQL Server Connectivity** option gives you hello choice of **Local (inside VM)**, **Private (within Virtual Network)**, or **Public (Internet)**.</span></span>

![Conectividade do SQL Server](./media/virtual-machines-windows-sql-security/sql-vm-connectivity-option.png)

<span data-ttu-id="8bbee-116">Para melhor segurança de hello, escolha a opção mais restritiva Olá para seu cenário.</span><span class="sxs-lookup"><span data-stu-id="8bbee-116">For hello best security, choose hello most restrictive option for your scenario.</span></span> <span data-ttu-id="8bbee-117">Por exemplo, se você estiver executando um aplicativo que acessa o SQL Server em Olá mesma VM, em seguida, **Local** é a opção mais segura de saudação.</span><span class="sxs-lookup"><span data-stu-id="8bbee-117">For example, if you are running an application that accesses SQL Server on hello same VM, then **Local** is hello most secure choice.</span></span> <span data-ttu-id="8bbee-118">Se você estiver executando um aplicativo do Azure que requer acesso toohello SQL Server, em seguida, **privada** protege a comunicação tooSQL servidor apenas dentro de saudação especificada [rede Virtual do Azure](../../../virtual-network/virtual-networks-overview.md).</span><span class="sxs-lookup"><span data-stu-id="8bbee-118">If you are running an Azure application that requires access toohello SQL Server, then **Private** secures communication tooSQL Server only within hello specified [Azure Virtual Network](../../../virtual-network/virtual-networks-overview.md).</span></span> <span data-ttu-id="8bbee-119">Se você precisar **pública** toohello de acesso (internest) VM do SQL Server, em seguida, certifique-se de que toofollow outras práticas recomendadas em tooreduce este tópico a área de superfície de ataque.</span><span class="sxs-lookup"><span data-stu-id="8bbee-119">If you require **Public** (internest) access toohello SQL Server VM, then make sure toofollow other best practices in this topic tooreduce your attack surface area.</span></span>

<span data-ttu-id="8bbee-120">Olá opções selecionadas no portal de saudação usam regras de segurança de entrada em Olá VMs [grupo de segurança de rede](../../../virtual-network/virtual-networks-nsg.md) tooallow (NSG) ou negar máquina de virtual de tooyour de tráfego de rede.</span><span class="sxs-lookup"><span data-stu-id="8bbee-120">hello selected options in hello portal use inbound security rules on hello VMs [Network Security Group](../../../virtual-network/virtual-networks-nsg.md) (NSG) tooallow or deny network traffic tooyour virtual machine.</span></span> <span data-ttu-id="8bbee-121">Você pode modificar ou criar novas regras NSG entradas porta do tooallow tráfego toohello do SQL Server (padrão 1433).</span><span class="sxs-lookup"><span data-stu-id="8bbee-121">You can modify or create new inbound NSG rules tooallow traffic toohello SQL Server port (default 1433).</span></span> <span data-ttu-id="8bbee-122">Você também pode especificar endereços IP específicos que são permitidos toocommunicate por essa porta.</span><span class="sxs-lookup"><span data-stu-id="8bbee-122">You can also specify specific IP addresses that are allowed toocommunicate over this port.</span></span>

![Regras de grupo de segurança de rede](./media/virtual-machines-windows-sql-security/sql-vm-network-security-group-rules.png)

<span data-ttu-id="8bbee-124">Além disso, tooNSG regras toorestrict o tráfego de rede, você também pode usar o hello Firewall do Windows na máquina virtual de saudação.</span><span class="sxs-lookup"><span data-stu-id="8bbee-124">In addition tooNSG rules toorestrict network traffic, you can also use hello Windows Firewall on hello virtual machine.</span></span>

<span data-ttu-id="8bbee-125">Se você estiver usando pontos de extremidade com o modelo de implantação clássico hello, remova quaisquer pontos de extremidade na máquina virtual de saudação se você não usá-los.</span><span class="sxs-lookup"><span data-stu-id="8bbee-125">If you are using endpoints with hello classic deployment model, remove any endpoints on hello virtual machine if you do not use them.</span></span> <span data-ttu-id="8bbee-126">Para obter instruções sobre como usar ACLs com pontos de extremidade, consulte [gerenciar Olá ACL em um ponto de extremidade](../classic/setup-endpoints.md#manage-the-acl-on-an-endpoint).</span><span class="sxs-lookup"><span data-stu-id="8bbee-126">For instructions on using ACLs with endpoints, see [Manage hello ACL on an endpoint](../classic/setup-endpoints.md#manage-the-acl-on-an-endpoint).</span></span> <span data-ttu-id="8bbee-127">Isso não é necessário para VMs que usam Olá Gerenciador de recursos.</span><span class="sxs-lookup"><span data-stu-id="8bbee-127">This is not necessary for VMs that use hello Resource Manager.</span></span>

<span data-ttu-id="8bbee-128">Finalmente, considere a possibilidade de habilitar conexões criptografadas para instância Olá Olá mecanismo de banco de dados do SQL Server na máquina virtual do Azure.</span><span class="sxs-lookup"><span data-stu-id="8bbee-128">Finally, consider enabling encrypted connections for hello instance of hello SQL Server Database Engine in your Azure virtual machine.</span></span> <span data-ttu-id="8bbee-129">Configure a instância do SQL Server com um certificado assinado.</span><span class="sxs-lookup"><span data-stu-id="8bbee-129">Configure SQL server instance with a signed certificate.</span></span> <span data-ttu-id="8bbee-130">Para obter mais informações, consulte [toohello habilitar conexões criptografadas mecanismo de banco de dados](https://docs.microsoft.com/sql/database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine) e [sintaxe de cadeia de caracteres de Conexão](https://msdn.microsoft.com/library/ms254500.aspx).</span><span class="sxs-lookup"><span data-stu-id="8bbee-130">For more information, see [Enable Encrypted Connections toohello Database Engine](https://docs.microsoft.com/sql/database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine) and [Connection String Syntax](https://msdn.microsoft.com/library/ms254500.aspx).</span></span>

## <a name="use-a-non-default-port"></a><span data-ttu-id="8bbee-131">Usar uma porta não padrão</span><span class="sxs-lookup"><span data-stu-id="8bbee-131">Use a non-default port</span></span>

<span data-ttu-id="8bbee-132">Por padrão, o SQL Server escuta uma porta conhecida, 1433.</span><span class="sxs-lookup"><span data-stu-id="8bbee-132">By default, SQL Server listens on a well-known port, 1433.</span></span> <span data-ttu-id="8bbee-133">Para maior segurança, configure toolisten do SQL Server em uma porta não padrão, como 1401.</span><span class="sxs-lookup"><span data-stu-id="8bbee-133">For increased security, configure SQL Server toolisten on a non-default port, such as 1401.</span></span> <span data-ttu-id="8bbee-134">Se você provisionar uma imagem da Galeria do SQL Server no hello portal do Azure, você pode especificar essa porta no hello **configurações do SQL Server** folha.</span><span class="sxs-lookup"><span data-stu-id="8bbee-134">If you provision a SQL Server gallery image in hello Azure portal, you can specify this port in hello **SQL Server settings** blade.</span></span>

<span data-ttu-id="8bbee-135">tooconfigure este após a configuração, você tem duas opções:</span><span class="sxs-lookup"><span data-stu-id="8bbee-135">tooconfigure this after provisioning, you have two options:</span></span>

- <span data-ttu-id="8bbee-136">Para máquinas virtuais do Gerenciador de recursos, você pode selecionar **configuração do SQL Server** da folha de visão geral VM hello.</span><span class="sxs-lookup"><span data-stu-id="8bbee-136">For Resource Manager VMs, you can select **SQL Server configuration** from hello VM overview blade.</span></span> <span data-ttu-id="8bbee-137">Isso fornece uma opção de porta de saudação toochange.</span><span class="sxs-lookup"><span data-stu-id="8bbee-137">This provides an option toochange hello port.</span></span>

  ![Alteração da porta TCP no portal](./media/virtual-machines-windows-sql-security/sql-vm-change-tcp-port.png)

- <span data-ttu-id="8bbee-139">Para VMs clássico ou para VMs do SQL Server que não foram provisionados com o portal de saudação, você pode configurar manualmente o porta Olá conectando-se remotamente toohello VM.</span><span class="sxs-lookup"><span data-stu-id="8bbee-139">For Classic VMs or for SQL Server VMs that were not provisioned with hello portal, you can manually configure hello port by connecting remotely toohello VM.</span></span> <span data-ttu-id="8bbee-140">Para etapas de configuração hello, consulte [configurar tooListen um servidor em uma porta TCP específica](https://docs.microsoft.com/sql/database-engine/configure-windows/configure-a-server-to-listen-on-a-specific-tcp-port).</span><span class="sxs-lookup"><span data-stu-id="8bbee-140">For hello configuration steps, see [Configure a Server tooListen on a Specific TCP Port](https://docs.microsoft.com/sql/database-engine/configure-windows/configure-a-server-to-listen-on-a-specific-tcp-port).</span></span> <span data-ttu-id="8bbee-141">Se você usar essa técnica manual, você também precisa tooadd um tráfego de entrada de tooallow de regra de Firewall do Windows em que a porta TCP.</span><span class="sxs-lookup"><span data-stu-id="8bbee-141">If you use this manual technique, you also need tooadd a Windows Firewall rule tooallow incoming traffic on that TCP port.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8bbee-142">Especificando uma porta não padrão é uma boa ideia se a porta do SQL Server é toopublic abrir conexões de internet.</span><span class="sxs-lookup"><span data-stu-id="8bbee-142">Specifying a non-default port is a good idea if your SQL Server port is open toopublic internet connections.</span></span>

<span data-ttu-id="8bbee-143">Quando o SQL Server está escutando em uma porta não padrão, você deve especificar porta hello quando você se conectar.</span><span class="sxs-lookup"><span data-stu-id="8bbee-143">When SQL Server is listening on a non-default port, you must specify hello port when you connect.</span></span> <span data-ttu-id="8bbee-144">Por exemplo, considere um cenário em que o endereço IP do servidor de saudação é 13.55.255.255 e do SQL Server está escutando na porta 1401.</span><span class="sxs-lookup"><span data-stu-id="8bbee-144">For example, consider a scenario where hello server IP address is 13.55.255.255 and SQL Server is listening on port 1401.</span></span> <span data-ttu-id="8bbee-145">tooconnect tooSQL Server, você especificaria `13.55.255.255,1401` na cadeia de caracteres de conexão de saudação.</span><span class="sxs-lookup"><span data-stu-id="8bbee-145">tooconnect tooSQL Server, you would specify `13.55.255.255,1401` in hello connection string.</span></span>

## <a name="manage-accounts"></a><span data-ttu-id="8bbee-146">Gerenciar Contas</span><span class="sxs-lookup"><span data-stu-id="8bbee-146">Manage accounts</span></span>

<span data-ttu-id="8bbee-147">Você não deseja que os invasores tooeasily estimativa conta nomes ou senhas.</span><span class="sxs-lookup"><span data-stu-id="8bbee-147">You don't want attackers tooeasily guess account names or passwords.</span></span> <span data-ttu-id="8bbee-148">Use Olá toohelp dicas a seguir:</span><span class="sxs-lookup"><span data-stu-id="8bbee-148">Use hello following tips toohelp:</span></span>

- <span data-ttu-id="8bbee-149">Crie uma conta de administrador local exclusiva que não esteja nomeada como **Administrador**.</span><span class="sxs-lookup"><span data-stu-id="8bbee-149">Create a unique local administrator account that is not named **Administrator**.</span></span>

- <span data-ttu-id="8bbee-150">Use senhas fortes e complexas para todas as suas contas.</span><span class="sxs-lookup"><span data-stu-id="8bbee-150">Use complex strong passwords for all your accounts.</span></span> <span data-ttu-id="8bbee-151">Para obter mais informações sobre como toocreate uma senha forte, consulte [criar uma senha forte](https://support.microsoft.com/instantanswers/9bd5223b-efbe-aa95-b15a-2fb37bef637d/create-a-strong-password) artigo.</span><span class="sxs-lookup"><span data-stu-id="8bbee-151">For more information about how toocreate a strong password, see [Create a strong password](https://support.microsoft.com/instantanswers/9bd5223b-efbe-aa95-b15a-2fb37bef637d/create-a-strong-password) article.</span></span>

- <span data-ttu-id="8bbee-152">Por padrão, o Azure seleciona a autenticação do Windows durante a instalação da máquina Virtual do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="8bbee-152">By default, Azure selects Windows Authentication during SQL Server Virtual Machine setup.</span></span> <span data-ttu-id="8bbee-153">Portanto, Olá **SA** logon está desabilitado e uma senha é atribuída pela instalação.</span><span class="sxs-lookup"><span data-stu-id="8bbee-153">Therefore, hello **SA** login is disabled and a password is assigned by setup.</span></span> <span data-ttu-id="8bbee-154">É recomendável que Olá **SA** logon não deve ser usado ou habilitado.</span><span class="sxs-lookup"><span data-stu-id="8bbee-154">We recommend that hello **SA** login should not be used or enabled.</span></span> <span data-ttu-id="8bbee-155">Se você deve ter um logon do SQL, use uma das Olá estratégias a seguir:</span><span class="sxs-lookup"><span data-stu-id="8bbee-155">If you must have a SQL login, use one of hello following strategies:</span></span>

  - <span data-ttu-id="8bbee-156">Crie uma conta do SQL com um nome exclusivo que tem a associação **sysadmin**.</span><span class="sxs-lookup"><span data-stu-id="8bbee-156">Create a SQL account with a unique name that has **sysadmin** membership.</span></span> <span data-ttu-id="8bbee-157">Você pode fazer isso no portal de saudação habilitando **autenticação SQL** durante o provisionamento.</span><span class="sxs-lookup"><span data-stu-id="8bbee-157">You can do this from hello portal by enabling **SQL Authentication** during provisioning.</span></span>

    > [!TIP] 
    > <span data-ttu-id="8bbee-158">Se você não habilitar a autenticação do SQL durante o provisionamento, você deve alterar manualmente o modo de autenticação Olá muito**do SQL Server e o modo de autenticação do Windows**.</span><span class="sxs-lookup"><span data-stu-id="8bbee-158">If you do not enable SQL Authentication during provisioning, you must manually change hello authentication mode too**SQL Server and Windows Authentication Mode**.</span></span> <span data-ttu-id="8bbee-159">Para obter mais informações, consulte [Alterar Modo de Autenticação do Servidor](https://docs.microsoft.com/sql/database-engine/configure-windows/change-server-authentication-mode).</span><span class="sxs-lookup"><span data-stu-id="8bbee-159">For more information, see [Change Server Authentication Mode](https://docs.microsoft.com/sql/database-engine/configure-windows/change-server-authentication-mode).</span></span>

  - <span data-ttu-id="8bbee-160">Se você precisar usar Olá **SA** logon, habilitar Olá logon depois de provisionamento e atribuir uma nova senha forte.</span><span class="sxs-lookup"><span data-stu-id="8bbee-160">If you must use hello **SA** login, enable hello login after provisioning and assign a new strong password.</span></span>

## <a name="follow-on-premises-best-practices"></a><span data-ttu-id="8bbee-161">Seguir as melhores práticas localmente</span><span class="sxs-lookup"><span data-stu-id="8bbee-161">Follow on-premises best practices</span></span>

<span data-ttu-id="8bbee-162">Além disso toohello práticas descritos neste tópico, é recomendável que você verifique e implemente práticas de segurança tradicionais locais Olá onde aplicável.</span><span class="sxs-lookup"><span data-stu-id="8bbee-162">In addition toohello practices described in this topic, we recommend that you review and implement hello traditional on-premises security practices where applicable.</span></span> <span data-ttu-id="8bbee-163">Para obter mais informações, consulte [Considerações sobre segurança para uma instalação do SQL Server](https://docs.microsoft.com/sql/sql-server/install/security-considerations-for-a-sql-server-installation)</span><span class="sxs-lookup"><span data-stu-id="8bbee-163">For more information, see [Security Considerations for a SQL Server Installation](https://docs.microsoft.com/sql/sql-server/install/security-considerations-for-a-sql-server-installation)</span></span>

## <a name="next-steps"></a><span data-ttu-id="8bbee-164">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="8bbee-164">Next Steps</span></span>

<span data-ttu-id="8bbee-165">Se você também estiver interessado em práticas recomendadas sobre desempenho, veja [Práticas recomendadas relacionadas ao desempenho para o SQL Server em máquinas virtuais do Azure](virtual-machines-windows-sql-performance.md).</span><span class="sxs-lookup"><span data-stu-id="8bbee-165">If you are also interested in best practices around performance, see [Performance Best Practices for SQL Server in Azure Virtual Machines](virtual-machines-windows-sql-performance.md).</span></span>

<span data-ttu-id="8bbee-166">Para outros tópicos relacionados toorunning do SQL Server em VMs do Azure, consulte [do SQL Server em máquinas virtuais do Azure overview](virtual-machines-windows-sql-server-iaas-overview.md).</span><span class="sxs-lookup"><span data-stu-id="8bbee-166">For other topics related toorunning SQL Server in Azure VMs, see [SQL Server on Azure Virtual Machines overview](virtual-machines-windows-sql-server-iaas-overview.md).</span></span>

