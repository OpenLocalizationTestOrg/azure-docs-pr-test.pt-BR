---
title: Migrar um banco de dados do SQL Server para o SQL Server em uma VM | Microsoft Docs
description: "Saiba mais sobre como migrar um banco de dados de usuário local para o SQL Server em uma máquina virtual do Azure."
services: virtual-machines-windows
documentationcenter: 
author: sabotta
manager: jhubbard
editor: 
tags: azure-service-management
ms.assetid: 00fd08c6-98fa-4d62-a3b8-ca20aa5246b1
ms.service: virtual-machines-sql
ms.workload: iaas-sql-server
ms.tgt_pltfrm: vm-windows-sql-server
ms.devlang: na
ms.topic: article
ms.date: 07/17/2017
ms.author: carlasab
ms.openlocfilehash: 68767534298783083a441aa295611914d0df9db0
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/29/2017
---
# <a name="migrate-a-sql-server-database-to-sql-server-in-an-azure-vm"></a><span data-ttu-id="fd8ef-103">Migrar um banco de dados do SQL Server para o SQL Server em uma VM do Azure</span><span class="sxs-lookup"><span data-stu-id="fd8ef-103">Migrate a SQL Server database to SQL Server in an Azure VM</span></span>

<span data-ttu-id="fd8ef-104">Existem vários métodos para migrar um banco de dados de usuário do SQL Server local para o SQL Server em uma VM do Azure.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-104">There are a number of methods to migrate an on-premises SQL Server user database to SQL Server in an Azure VM.</span></span> <span data-ttu-id="fd8ef-105">Este artigo discute brevemente diversos métodos e recomenda o melhor método para vários cenários.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-105">This article will briefly discuss various methods and recommend the best method for various scenarios.</span></span>

[!INCLUDE [learn-about-deployment-models](../../../../includes/learn-about-deployment-models-both-include.md)]

## <a name="what-are-the-primary-migration-methods"></a><span data-ttu-id="fd8ef-106">Quais são os principais métodos de migração?</span><span class="sxs-lookup"><span data-stu-id="fd8ef-106">What are the primary migration methods?</span></span>
<span data-ttu-id="fd8ef-107">Os principais métodos de migração são:</span><span class="sxs-lookup"><span data-stu-id="fd8ef-107">The primary migration methods are:</span></span>

* <span data-ttu-id="fd8ef-108">Executar backup local usando a compactação e copiar manualmente o arquivo de backup para a máquina virtual do Azure</span><span class="sxs-lookup"><span data-stu-id="fd8ef-108">Perform on-premises backup using compression and manually copy the backup file into the Azure virtual machine</span></span>
* <span data-ttu-id="fd8ef-109">Executar um backup para URL e restaurar na máquina virtual do Azure desde a URL</span><span class="sxs-lookup"><span data-stu-id="fd8ef-109">Perform a backup to URL and restore into the Azure virtual machine from the URL</span></span>
* <span data-ttu-id="fd8ef-110">Desanexar e copiar os arquivos de log e de dados para o armazenamento de blobs do Azure e, em seguida, anexar ao SQL Server em uma VM do Azure desde a URL</span><span class="sxs-lookup"><span data-stu-id="fd8ef-110">Detach and then copy the data and log files to Azure blob storage and then attach to SQL Server in Azure VM from URL</span></span>
* <span data-ttu-id="fd8ef-111">Converter a máquina física local em VHD do Hyper-V, carregar no armazenamento de Blob do Azure e, em seguida, implantar como nova máquina virtual usando o VHD carregado</span><span class="sxs-lookup"><span data-stu-id="fd8ef-111">Convert on-premises physical machine to Hyper-V VHD, upload to Azure Blob storage, and then deploy as new VM using uploaded VHD</span></span>
* <span data-ttu-id="fd8ef-112">Remeter o disco rígido usando o Serviço de Importação/Exportação do Windows</span><span class="sxs-lookup"><span data-stu-id="fd8ef-112">Ship hard drive using Windows Import/Export Service</span></span>
* <span data-ttu-id="fd8ef-113">Caso você tenha uma implantação local do AlwaysOn, use o [Assistente para Adicionar uma Réplica do Azure](../classic/sql-onprem-availability.md) para criar uma réplica no Azure e executar o failover, apontando os usuários para a instância do banco de dados do Azure</span><span class="sxs-lookup"><span data-stu-id="fd8ef-113">If you have an AlwaysOn deployment on-premises, use the [Add Azure Replica Wizard](../classic/sql-onprem-availability.md) to create a replica in Azure and then failover, pointing users to the Azure database instance</span></span>
* <span data-ttu-id="fd8ef-114">Use a [replicação transacional](https://msdn.microsoft.com/library/ms151176.aspx) do SQL Server para configurar a instância do SQL Server do Azure como um assinante e, em seguida, desabilite a replicação, apontando os usuários para a instância de banco de dados do Azure</span><span class="sxs-lookup"><span data-stu-id="fd8ef-114">Use SQL Server [transactional replication](https://msdn.microsoft.com/library/ms151176.aspx) to configure the Azure SQL Server instance as a subscriber and then disable replication, pointing users to the Azure database instance</span></span>

> [!TIP]
> <span data-ttu-id="fd8ef-115">Você também pode usar essas mesmas técnicas para mover bancos de dados entre VMs do SQL Server no Azure.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-115">You can also use these same techniques to move databases between SQL Server VMs in Azure.</span></span> <span data-ttu-id="fd8ef-116">Por exemplo, não há suporte para atualizar uma VM da imagem da galeria do SQL Server de uma versão/edição para outra.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-116">For example, there is no supported way to upgrade a SQL Server gallery-image VM from one version/edition to another.</span></span> <span data-ttu-id="fd8ef-117">Nesse caso, você deve criar uma nova VM do SQL Server com a nova versão/edição e, em seguida, usar uma das técnicas de migração neste artigo para mover seus bancos de dados.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-117">In this case, you should create a new SQL Server VM with the new version/edition, and then use one of the migration techniques in this article to move your databases.</span></span> 

## <a name="choosing-your-migration-method"></a><span data-ttu-id="fd8ef-118">Escolhendo o método de migração</span><span class="sxs-lookup"><span data-stu-id="fd8ef-118">Choosing your migration method</span></span>
<span data-ttu-id="fd8ef-119">Para obter um desempenho de transferência de dados ideal, migre os arquivos de banco de dados na VM do Azure usando um arquivo de backup compactado.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-119">For optimum data transfer performance, migrate the database files into the Azure VM using a compressed backup file.</span></span>

<span data-ttu-id="fd8ef-120">Para minimizar o tempo de inatividade durante o processo de migração do banco de dados, use a opção AlwaysOn ou a opção de replicação transacional.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-120">To minimize downtime during the database migration process, use either the AlwaysOn option or the transactional replication option.</span></span>

<span data-ttu-id="fd8ef-121">Se não for possível usar os métodos acima, migre seu banco de dados manualmente.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-121">If it is not possible to use the above methods, manually migrate your database.</span></span> <span data-ttu-id="fd8ef-122">Usando esse método, você geralmente começa com um backup do banco de dados seguido por uma cópia do banco de dados de backup no Azure e, em seguida, executa uma restauração de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-122">Using this method, you will generally start with a database backup followed by a copy of the database backup into Azure and then perform a database restore.</span></span> <span data-ttu-id="fd8ef-123">Você também pode copiar os próprios arquivos do banco de dados para o Azure e anexá-los.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-123">You can also copy the database files themselves into Azure and then attach them.</span></span> <span data-ttu-id="fd8ef-124">Existem vários métodos pelos quais você pode realizar esse processo manual de migrar um banco de dados para uma VM do Azure.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-124">There are several methods by which you can accomplish this manual process of migrating a database into an Azure VM.</span></span>

> [!NOTE]
> <span data-ttu-id="fd8ef-125">Quando você atualizar para o SQL Server 2014 ou para o SQL Server 2016 de versões anteriores do SQL Server, deverá considerar se as alterações são necessárias.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-125">When you upgrade to SQL Server 2014 or SQL Server 2016 from older versions of SQL Server, you should consider whether changes are needed.</span></span> <span data-ttu-id="fd8ef-126">É recomendável resolver todas as dependências nos recursos sem suporte da nova versão do SQL Server como parte do seu projeto de migração.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-126">We recommend that you address all dependencies on features not supported by the new version of SQL Server as part of your migration project.</span></span> <span data-ttu-id="fd8ef-127">Para saber mais sobre os cenários e as edições com suporte, consulte [Atualizar para o SQL Server](https://msdn.microsoft.com/library/bb677622.aspx).</span><span class="sxs-lookup"><span data-stu-id="fd8ef-127">For more information on the supported editions and scenarios, see [Upgrade to SQL Server](https://msdn.microsoft.com/library/bb677622.aspx).</span></span>

<span data-ttu-id="fd8ef-128">A tabela a seguir lista os principais métodos de migração e discute quando o uso de cada método é mais apropriado.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-128">The following table lists each of the primary migration methods and discusses when the use of each method is most appropriate.</span></span>

| <span data-ttu-id="fd8ef-129">Método</span><span class="sxs-lookup"><span data-stu-id="fd8ef-129">Method</span></span> | <span data-ttu-id="fd8ef-130">Versão do banco de dados de origem</span><span class="sxs-lookup"><span data-stu-id="fd8ef-130">Source database version</span></span> | <span data-ttu-id="fd8ef-131">Versão do banco de dados de destino</span><span class="sxs-lookup"><span data-stu-id="fd8ef-131">Destination database version</span></span> | <span data-ttu-id="fd8ef-132">Restrição de tamanho do backup do banco de dados de origem</span><span class="sxs-lookup"><span data-stu-id="fd8ef-132">Source database backup size constraint</span></span> | <span data-ttu-id="fd8ef-133">Observações</span><span class="sxs-lookup"><span data-stu-id="fd8ef-133">Notes</span></span> |
| --- | --- | --- | --- | --- |
| [<span data-ttu-id="fd8ef-134">Execute o backup local usando a compactação e copie manualmente o arquivo de backup para a máquina virtual do Azure</span><span class="sxs-lookup"><span data-stu-id="fd8ef-134">Perform on-premises backup using compression and manually copy the backup file into the Azure virtual machine</span></span>](#backup-and-restore) |<span data-ttu-id="fd8ef-135">SQL Server 2005 ou posterior</span><span class="sxs-lookup"><span data-stu-id="fd8ef-135">SQL Server 2005 or greater</span></span> |<span data-ttu-id="fd8ef-136">SQL Server 2005 ou posterior</span><span class="sxs-lookup"><span data-stu-id="fd8ef-136">SQL Server 2005 or greater</span></span> |[<span data-ttu-id="fd8ef-137">Limite de armazenamento da VM do Azure</span><span class="sxs-lookup"><span data-stu-id="fd8ef-137">Azure VM storage limit</span></span>](https://azure.microsoft.com/documentation/articles/azure-subscription-service-limits/) | <span data-ttu-id="fd8ef-138">Essa é uma técnica muito simples e bem testada para mover bancos de dados entre máquinas.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-138">This is a very simple and well-tested technique for moving databases across machines.</span></span> |
| [<span data-ttu-id="fd8ef-139">Execute um backup para URL e restaure na máquina virtual do Azure desde a URL</span><span class="sxs-lookup"><span data-stu-id="fd8ef-139">Perform a backup to URL and restore into the Azure virtual machine from the URL</span></span>](#backup-to-url-and-restore) |<span data-ttu-id="fd8ef-140">SQL Server 2012 SP1 CU2 ou posterior</span><span class="sxs-lookup"><span data-stu-id="fd8ef-140">SQL Server 2012 SP1 CU2 or greater</span></span> |<span data-ttu-id="fd8ef-141">SQL Server 2012 SP1 CU2 ou posterior</span><span class="sxs-lookup"><span data-stu-id="fd8ef-141">SQL Server 2012 SP1 CU2 or greater</span></span> |<span data-ttu-id="fd8ef-142">< 12,8 TB para SQL Server 2016, caso contrário, < 1 TB</span><span class="sxs-lookup"><span data-stu-id="fd8ef-142">< 12.8 TB for SQL Server 2016, otherwise < 1 TB</span></span> | <span data-ttu-id="fd8ef-143">Este método é somente outra forma de mover o arquivo de backup para a VM usando o armazenamento do Azure.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-143">This method is just another way to move the backup file to the VM using Azure storage.</span></span> |
| [<span data-ttu-id="fd8ef-144">Desanexe e copie os arquivos de log e dados para o armazenamento de blob do Azure e anexe à máquina virtual do SQL Server no Azure desde a URL</span><span class="sxs-lookup"><span data-stu-id="fd8ef-144">Detach and then copy the data and log files to Azure blob storage and then attach to SQL Server in Azure virtual machine from URL</span></span>](#detach-and-attach-from-url) |<span data-ttu-id="fd8ef-145">SQL Server 2005 ou posterior</span><span class="sxs-lookup"><span data-stu-id="fd8ef-145">SQL Server 2005 or greater</span></span> |<span data-ttu-id="fd8ef-146">SQL Server 2014 ou posterior</span><span class="sxs-lookup"><span data-stu-id="fd8ef-146">SQL Server 2014 or greater</span></span> |[<span data-ttu-id="fd8ef-147">Limite de armazenamento da VM do Azure</span><span class="sxs-lookup"><span data-stu-id="fd8ef-147">Azure VM storage limit</span></span>](https://azure.microsoft.com/documentation/articles/azure-subscription-service-limits/) |<span data-ttu-id="fd8ef-148">Use este método quando pretender [armazenar esses arquivos usando o serviço de armazenamento de Blob do Azure](https://msdn.microsoft.com/library/dn385720.aspx) e anexá-los ao SQL Server em execução em uma VM do Azure, especialmente com bancos de dados muito grandes.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-148">Use this method when you plan to [store these files using the Azure Blob storage service](https://msdn.microsoft.com/library/dn385720.aspx) and attach them to SQL Server running in an Azure VM, particularly with very large databases</span></span> |
| [<span data-ttu-id="fd8ef-149">Converta a máquina local em VHDs do Hyper-V, carregue no armazenamento de Blob do Azure e, em seguida, implante uma nova máquina virtual usando o VHD carregado</span><span class="sxs-lookup"><span data-stu-id="fd8ef-149">Convert on-premises machine to Hyper-V VHDs, upload to Azure Blob storage, and then deploy a new virtual machine using uploaded VHD</span></span>](#convert-to-vm-and-upload-to-url-and-deploy-as-new-vm) |<span data-ttu-id="fd8ef-150">SQL Server 2005 ou posterior</span><span class="sxs-lookup"><span data-stu-id="fd8ef-150">SQL Server 2005 or greater</span></span> |<span data-ttu-id="fd8ef-151">SQL Server 2005 ou posterior</span><span class="sxs-lookup"><span data-stu-id="fd8ef-151">SQL Server 2005 or greater</span></span> |[<span data-ttu-id="fd8ef-152">Limite de armazenamento da VM do Azure</span><span class="sxs-lookup"><span data-stu-id="fd8ef-152">Azure VM storage limit</span></span>](https://azure.microsoft.com/documentation/articles/azure-subscription-service-limits/) |<span data-ttu-id="fd8ef-153">Use quando estiver [trazendo sua própria licença do SQL Server](../../../sql-database/sql-database-paas-vs-sql-server-iaas.md) ao migrar um banco de dados que você executará em uma versão anterior do SQL Server ou ao migrar bancos de dados do sistema e do usuário como parte da migração de banco de dados dependente de outros bancos de dados do usuário e/ou bancos de dados do sistema.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-153">Use when [bringing your own SQL Server license](../../../sql-database/sql-database-paas-vs-sql-server-iaas.md), when migrating a database that you will run on an older version of SQL Server, or when migrating system and user databases together as part of the migration of database dependent on other user databases and/or system databases.</span></span> |
| [<span data-ttu-id="fd8ef-154">Remeter o disco rígido usando o Serviço de Importação/Exportação do Windows</span><span class="sxs-lookup"><span data-stu-id="fd8ef-154">Ship hard drive using Windows Import/Export Service</span></span>](#ship-hard-drive) |<span data-ttu-id="fd8ef-155">SQL Server 2005 ou posterior</span><span class="sxs-lookup"><span data-stu-id="fd8ef-155">SQL Server 2005 or greater</span></span> |<span data-ttu-id="fd8ef-156">SQL Server 2005 ou posterior</span><span class="sxs-lookup"><span data-stu-id="fd8ef-156">SQL Server 2005 or greater</span></span> |[<span data-ttu-id="fd8ef-157">Limite de armazenamento da VM do Azure</span><span class="sxs-lookup"><span data-stu-id="fd8ef-157">Azure VM storage limit</span></span>](https://azure.microsoft.com/documentation/articles/azure-subscription-service-limits/) |<span data-ttu-id="fd8ef-158">Use o [Serviço de Importação/Exportação do Windows](../../../storage/common/storage-import-export-service.md) quando o método de cópia manual for muito lento, como com bancos de dados muito grandes</span><span class="sxs-lookup"><span data-stu-id="fd8ef-158">Use the [Windows Import/Export Service](../../../storage/common/storage-import-export-service.md) when manual copy method is too slow, such as with very large databases</span></span> |
| [<span data-ttu-id="fd8ef-159">Usar o Assistente para Adicionar uma Réplica do Azure</span><span class="sxs-lookup"><span data-stu-id="fd8ef-159">Use the Add Azure Replica Wizard</span></span>](../classic/sql-onprem-availability.md) |<span data-ttu-id="fd8ef-160">SQL Server 2012 ou posterior</span><span class="sxs-lookup"><span data-stu-id="fd8ef-160">SQL Server 2012 or greater</span></span> |<span data-ttu-id="fd8ef-161">SQL Server 2012 ou posterior</span><span class="sxs-lookup"><span data-stu-id="fd8ef-161">SQL Server 2012 or greater</span></span> |[<span data-ttu-id="fd8ef-162">Limite de armazenamento da VM do Azure</span><span class="sxs-lookup"><span data-stu-id="fd8ef-162">Azure VM storage limit</span></span>](https://azure.microsoft.com/documentation/articles/azure-subscription-service-limits/) |<span data-ttu-id="fd8ef-163">Minimiza o tempo de inatividade, use quando tiver uma implantação local do AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="fd8ef-163">Minimizes downtime, use when you have an AlwaysOn on-premises deployment</span></span> |
| [<span data-ttu-id="fd8ef-164">Usar a replicação transacional do SQL Server</span><span class="sxs-lookup"><span data-stu-id="fd8ef-164">Use SQL Server transactional replication</span></span>](https://msdn.microsoft.com/library/ms151176.aspx) |<span data-ttu-id="fd8ef-165">SQL Server 2005 ou posterior</span><span class="sxs-lookup"><span data-stu-id="fd8ef-165">SQL Server 2005 or greater</span></span> |<span data-ttu-id="fd8ef-166">SQL Server 2005 ou posterior</span><span class="sxs-lookup"><span data-stu-id="fd8ef-166">SQL Server 2005 or greater</span></span> |[<span data-ttu-id="fd8ef-167">Limite de armazenamento da VM do Azure</span><span class="sxs-lookup"><span data-stu-id="fd8ef-167">Azure VM storage limit</span></span>](https://azure.microsoft.com/documentation/articles/azure-subscription-service-limits/) |<span data-ttu-id="fd8ef-168">Use quando precisar minimizar o tempo de inatividade e não tiver uma implantação local do AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="fd8ef-168">Use when you need to minimize downtime and do not have an AlwaysOn on-premises deployment</span></span> |

## <a name="backup-and-restore"></a><span data-ttu-id="fd8ef-169">Backup e restauração</span><span class="sxs-lookup"><span data-stu-id="fd8ef-169">Backup and restore</span></span>
<span data-ttu-id="fd8ef-170">Faça o backup do seu banco de dados com a compactação, copie o backup para a VM e, em seguida, restaure o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-170">Back up your database with compression, copy the backup to the VM, and then restore the database.</span></span> <span data-ttu-id="fd8ef-171">Se o arquivo de backup tiver mais de 1 TB, você deverá dividi-lo, já que o tamanho máximo de um disco de VM é de 1 TB.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-171">If your backup file is larger than 1 TB, you must stripe it because the maximum size of a VM disk is 1 TB.</span></span> <span data-ttu-id="fd8ef-172">Use as seguintes etapas gerais para migrar um banco de dados do usuário usando este método manual:</span><span class="sxs-lookup"><span data-stu-id="fd8ef-172">Use the following general steps to migrate a user database using this manual method:</span></span>

1. <span data-ttu-id="fd8ef-173">Execute um backup de banco de dados completo para um caminho local.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-173">Perform a full database backup to an on-premises location.</span></span>
2. <span data-ttu-id="fd8ef-174">Crie ou carregue uma máquina virtual com a versão do SQL Server desejada.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-174">Create or upload a virtual machine with the version of SQL Server desired.</span></span>
3. <span data-ttu-id="fd8ef-175">Configure a conectividade com base em seus requisitos de instalação.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-175">Setup connectivity based on your requirements.</span></span> <span data-ttu-id="fd8ef-176">Consulte [Conectar-se a uma Máquina Virtual do SQL Server no Azure (Gerenciador de Recursos)](virtual-machines-windows-sql-connect.md).</span><span class="sxs-lookup"><span data-stu-id="fd8ef-176">See [Connect to a SQL Server Virtual Machine on Azure (Resource Manager)](virtual-machines-windows-sql-connect.md).</span></span>
4. <span data-ttu-id="fd8ef-177">Copie os arquivos de backup para sua VM usando a área de trabalho remota, Windows Explorer ou comando de cópia em um prompt de comando.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-177">Copy your backup file(s) to your VM using remote desktop, Windows Explorer or the copy command from a command prompt.</span></span>

## <a name="backup-to-url-and-restore"></a><span data-ttu-id="fd8ef-178">Fazer backup para URL e restaurar</span><span class="sxs-lookup"><span data-stu-id="fd8ef-178">Backup to URL and restore</span></span>
<span data-ttu-id="fd8ef-179">Em vez de fazer o backup em um arquivo local, é possível usar o [backup para URL](https://msdn.microsoft.com/library/dn435916.aspx) e, em seguida, restaurar da URL para a VM.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-179">Instead of backing up to a local file, you can use the [backup to URL](https://msdn.microsoft.com/library/dn435916.aspx) and then restore from URL to the VM.</span></span> <span data-ttu-id="fd8ef-180">Com o SQL Server 2016, conjuntos de backup divididos têm suporte, são recomendados para um melhor desempenho e são necessários para exceder os limites de tamanho por blob.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-180">With SQL Server 2016, striped backup sets are supported, are recommended for performance, and required to exceed the size limits per blob.</span></span> <span data-ttu-id="fd8ef-181">Para bancos de dados muito grandes, é recomendado o uso do [Serviço de Importação/Exportação do Windows](../../../storage/common/storage-import-export-service.md) .</span><span class="sxs-lookup"><span data-stu-id="fd8ef-181">For very large databases, the use of the [Windows Import/Export Service](../../../storage/common/storage-import-export-service.md) is recommended.</span></span>

## <a name="detach-and-attach-from-url"></a><span data-ttu-id="fd8ef-182">Desanexar e anexar da URL</span><span class="sxs-lookup"><span data-stu-id="fd8ef-182">Detach and attach from URL</span></span>
<span data-ttu-id="fd8ef-183">Desanexar os banco de dados e arquivos de log e transferi-los para [Armazenamento de Blobs do Azure](https://msdn.microsoft.com/library/dn385720.aspx).</span><span class="sxs-lookup"><span data-stu-id="fd8ef-183">Detach your database and log files and transfer them to [Azure Blob storage](https://msdn.microsoft.com/library/dn385720.aspx).</span></span> <span data-ttu-id="fd8ef-184">Em seguida, anexe o banco de dados da URL na sua VM do Azure.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-184">Then attach the database from the URL on your Azure VM.</span></span> <span data-ttu-id="fd8ef-185">Use esta opção se desejar que os arquivos de banco de dados físicos residam no armazenamento de Blobs.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-185">Use this if you want the physical database files to reside in Blob storage.</span></span> <span data-ttu-id="fd8ef-186">Isso pode ser útil para bancos de dados muito grandes.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-186">This might be useful for very large databases.</span></span> <span data-ttu-id="fd8ef-187">Use as seguintes etapas gerais para migrar um banco de dados do usuário usando este método manual:</span><span class="sxs-lookup"><span data-stu-id="fd8ef-187">Use the following general steps to migrate a user database using this manual method:</span></span>

1. <span data-ttu-id="fd8ef-188">Desanexe os arquivos de banco de dados da instância de banco de dados local.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-188">Detach the database files from the on-premises database instance.</span></span>
2. <span data-ttu-id="fd8ef-189">Copie os arquivos desanexados do banco de dados no armazenamento de blob do Azure usando o [utilitário de linha de comando AZCopy](../../../storage/common/storage-use-azcopy.md).</span><span class="sxs-lookup"><span data-stu-id="fd8ef-189">Copy the detached database files into Azure blob storage using the [AZCopy command-line utility](../../../storage/common/storage-use-azcopy.md).</span></span>
3. <span data-ttu-id="fd8ef-190">Anexe os arquivos de banco de dados da URL do Azure para a instância do SQL Server na VM do Azure.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-190">Attach the database files from the Azure URL to the SQL Server instance in the Azure VM.</span></span>

## <a name="convert-to-vm-and-upload-to-url-and-deploy-as-new-vm"></a><span data-ttu-id="fd8ef-191">Converter a VM e carregar a URL e implantar como uma nova VM</span><span class="sxs-lookup"><span data-stu-id="fd8ef-191">Convert to VM and upload to URL and deploy as new VM</span></span>
<span data-ttu-id="fd8ef-192">Use esse método para migrar todos os sistemas e bancos de dados de usuário em uma instância local do SQL Server para a máquina virtual do Azure.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-192">Use this method to migrate all system and user databases in an on-premises SQL Server instance to Azure virtual machine.</span></span> <span data-ttu-id="fd8ef-193">Use as seguintes etapas gerais para migrar de uma instância inteira do SQL Server usando este método manual:</span><span class="sxs-lookup"><span data-stu-id="fd8ef-193">Use the following general steps to migrate an entire SQL Server instance using this manual method:</span></span>

1. <span data-ttu-id="fd8ef-194">Converta máquinas físicas ou virtuais em VHDs do Hyper-V usando o [Conversor de Máquina Virtual da Microsoft](https://technet.microsoft.com/library/dn874008(v=ws.11).aspx).</span><span class="sxs-lookup"><span data-stu-id="fd8ef-194">Convert physical or virtual machines to Hyper-V VHDs by using [Microsoft Virtual Machine Converter](https://technet.microsoft.com/library/dn874008(v=ws.11).aspx).</span></span>
2. <span data-ttu-id="fd8ef-195">Carregue arquivos de VHD no armazenamento do Azure usando o [cmdlet Add-AzureVHD](https://msdn.microsoft.com/library/windowsazure/dn495173.aspx).</span><span class="sxs-lookup"><span data-stu-id="fd8ef-195">Upload VHD files to Azure Storage by using the [Add-AzureVHD cmdlet](https://msdn.microsoft.com/library/windowsazure/dn495173.aspx).</span></span>
3. <span data-ttu-id="fd8ef-196">Implante uma nova máquina virtual usando o VHD carregado.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-196">Deploy a new virtual machine by using the uploaded VHD.</span></span>

> [!NOTE]
> <span data-ttu-id="fd8ef-197">Para migrar um aplicativo inteiro, use o [Azure Site Recovery](../../../site-recovery/site-recovery-overview.md).</span><span class="sxs-lookup"><span data-stu-id="fd8ef-197">To migrate an entire application, consider using [Azure Site Recovery](../../../site-recovery/site-recovery-overview.md)].</span></span>

## <a name="ship-hard-drive"></a><span data-ttu-id="fd8ef-198">Remeter a unidade de disco rígido</span><span class="sxs-lookup"><span data-stu-id="fd8ef-198">Ship hard drive</span></span>
<span data-ttu-id="fd8ef-199">Use o [método do Serviço de Importação/Exportação do Windows](../../../storage/common/storage-import-export-service.md) para transferir grandes quantidades de dados de arquivo para o armazenamento de Blob do Azure em situações em que o carregamento pela rede seja extremamente caro ou inviável.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-199">Use the [Windows Import/Export Service method](../../../storage/common/storage-import-export-service.md) to transfer large amounts of file data to Azure Blob storage in situations where uploading over the network is prohibitively expensive or not feasible.</span></span> <span data-ttu-id="fd8ef-200">Com esse serviço, você envia um ou mais discos rígidos contendo esses dados para um data center do Azure, onde os dados serão carregados para sua conta de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-200">With this service, you send one or more hard drives containing that data to an Azure data center, where your data will be uploaded to your storage account.</span></span>

## <a name="next-steps"></a><span data-ttu-id="fd8ef-201">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="fd8ef-201">Next Steps</span></span>
<span data-ttu-id="fd8ef-202">Para obter mais informações sobre como executar o SQL Server em Máquinas Virtuais do Azure, veja [Visão geral do SQL Server em Máquinas Virtuais do Azure](virtual-machines-windows-sql-server-iaas-overview.md).</span><span class="sxs-lookup"><span data-stu-id="fd8ef-202">For more information about running SQL Server on Azure Virtual Machines, see [SQL Server on Azure Virtual Machines overview](virtual-machines-windows-sql-server-iaas-overview.md).</span></span>

<span data-ttu-id="fd8ef-203">Para obter instruções sobre como criar uma Máquina Virtual do Azure SQL Server de uma imagem capturada, confira [Tips & Tricks on ‘cloning’ Azure SQL virtual machines from captured images](https://blogs.msdn.microsoft.com/psssql/2016/07/06/tips-tricks-on-cloning-azure-sql-virtual-machines-from-captured-images/) (Dicas e truques ao 'clonar' as máquinas virtuais do Azure SQL de imagens capturadas) no blog dos Engenheiros do CSS SQL Server.</span><span class="sxs-lookup"><span data-stu-id="fd8ef-203">For instructions on creating an Azure SQL Server Virtual Machine from a captured image, see [Tips & Tricks on ‘cloning’ Azure SQL virtual machines from captured images](https://blogs.msdn.microsoft.com/psssql/2016/07/06/tips-tricks-on-cloning-azure-sql-virtual-machines-from-captured-images/) on the CSS SQL Server Engineers blog.</span></span>

