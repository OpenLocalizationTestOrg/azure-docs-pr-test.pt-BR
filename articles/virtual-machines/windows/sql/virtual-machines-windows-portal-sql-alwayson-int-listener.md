---
title: "aaaCreate um ouvinte de grupo de disponibilidade do SQL Server em máquinas virtuais do Azure | Microsoft Docs"
description: "Instruções passo a passo de como criar um ouvinte para um grupo de disponibilidade Always On para SQL Server em máquinas virtuais do Azure"
services: virtual-machines
documentationcenter: na
author: MikeRayMSFT
manager: jhubbard
editor: monicar
ms.assetid: d1f291e9-9af2-41ba-9d29-9541e3adcfcf
ms.service: virtual-machines-sql
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows-sql-server
ms.workload: iaas-sql-server
ms.date: 05/01/2017
ms.author: mikeray
ms.openlocfilehash: c6a44dc5c7c18b572c2bf5772b4651b7210aacbd
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="configure-a-load-balancer-for-an-always-on-availability-group-in-azure"></a><span data-ttu-id="04736-103">Configurar um balanceador de carga para um grupo de disponibilidade Always On no Azure</span><span class="sxs-lookup"><span data-stu-id="04736-103">Configure a load balancer for an Always On availability group in Azure</span></span>
<span data-ttu-id="04736-104">Este artigo explica como toocreate um balanceador de carga para um grupo de disponibilidade do SQL Server Always On no Azure virtual máquinas que estão em execução no Gerenciador de recursos do Azure.</span><span class="sxs-lookup"><span data-stu-id="04736-104">This article explains how toocreate a load balancer for a SQL Server Always On availability group in Azure virtual machines that are running with Azure Resource Manager.</span></span> <span data-ttu-id="04736-105">Um grupo de disponibilidade exige um balanceador de carga quando instâncias do SQL Server de saudação em máquinas virtuais do Azure.</span><span class="sxs-lookup"><span data-stu-id="04736-105">An availability group requires a load balancer when hello SQL Server instances are on Azure virtual machines.</span></span> <span data-ttu-id="04736-106">Balanceador de carga Olá armazena o endereço IP Olá para o ouvinte do grupo de disponibilidade de saudação.</span><span class="sxs-lookup"><span data-stu-id="04736-106">hello load balancer stores hello IP address for hello availability group listener.</span></span> <span data-ttu-id="04736-107">Se um grupo de disponibilidade abranger várias regiões, cada região precisará de um balanceador de carga.</span><span class="sxs-lookup"><span data-stu-id="04736-107">If an availability group spans multiple regions, each region needs a load balancer.</span></span>

<span data-ttu-id="04736-108">toocomplete nesta tarefa, você precisa toohave implantado de um grupo de disponibilidade do SQL Server em máquinas virtuais do Azure que está executando o com o Gerenciador de recursos.</span><span class="sxs-lookup"><span data-stu-id="04736-108">toocomplete this task, you need toohave a SQL Server availability group deployed on Azure virtual machines that are running with Resource Manager.</span></span> <span data-ttu-id="04736-109">Máquinas virtuais do SQL Server deve pertencer toohello mesmo conjunto de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="04736-109">Both SQL Server virtual machines must belong toohello same availability set.</span></span> <span data-ttu-id="04736-110">Você pode usar o hello [modelo Microsoft](virtual-machines-windows-portal-sql-alwayson-availability-groups.md) tooautomatically criar grupo de disponibilidade de saudação no Gerenciador de recursos.</span><span class="sxs-lookup"><span data-stu-id="04736-110">You can use hello [Microsoft template](virtual-machines-windows-portal-sql-alwayson-availability-groups.md) tooautomatically create hello availability group in Resource Manager.</span></span> <span data-ttu-id="04736-111">Este modelo cria automaticamente um balanceador de carga interno para você.</span><span class="sxs-lookup"><span data-stu-id="04736-111">This template automatically creates an internal load balancer for you.</span></span> 

<span data-ttu-id="04736-112">Se preferir, você poderá [configurar manualmente um grupo de disponibilidade](virtual-machines-windows-portal-sql-alwayson-availability-groups-manual.md).</span><span class="sxs-lookup"><span data-stu-id="04736-112">If you prefer, you can [manually configure an availability group](virtual-machines-windows-portal-sql-alwayson-availability-groups-manual.md).</span></span>

<span data-ttu-id="04736-113">Este artigo exige que os grupos de disponibilidade já estejam configurados.</span><span class="sxs-lookup"><span data-stu-id="04736-113">This article requires that your availability groups are already configured.</span></span>  

<span data-ttu-id="04736-114">Os tópicos relacionados incluem:</span><span class="sxs-lookup"><span data-stu-id="04736-114">Related topics include:</span></span>

* [<span data-ttu-id="04736-115">Configurar os grupos de disponibilidade Always On na VM do Azure (GUI)</span><span class="sxs-lookup"><span data-stu-id="04736-115">Configure Always On availability groups in Azure VM (GUI)</span></span>](virtual-machines-windows-portal-sql-alwayson-availability-groups-manual.md)   
* [<span data-ttu-id="04736-116">Configurar uma conexão de rede virtual com rede virtual usando o PowerShell e o Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="04736-116">Configure a VNet-to-VNet connection by using Azure Resource Manager and PowerShell</span></span>](../../../vpn-gateway/vpn-gateway-vnet-vnet-rm-ps.md)

<span data-ttu-id="04736-117">Examinando neste artigo, você cria e configurar um balanceador de carga no hello portal do Azure.</span><span class="sxs-lookup"><span data-stu-id="04736-117">By walking through this article, you create and configure a load balancer in hello Azure portal.</span></span> <span data-ttu-id="04736-118">Após a conclusão do processo de saudação, você configura Olá toouse Olá endereço IP do balanceador de carga Olá para o ouvinte do grupo de disponibilidade de saudação.</span><span class="sxs-lookup"><span data-stu-id="04736-118">After hello process is complete, you configure hello cluster toouse hello IP address from hello load balancer for hello availability group listener.</span></span>

## <a name="create-and-configure-hello-load-balancer-in-hello-azure-portal"></a><span data-ttu-id="04736-119">Criar e configurar o balanceador de carga Olá Olá portal do Azure</span><span class="sxs-lookup"><span data-stu-id="04736-119">Create and configure hello load balancer in hello Azure portal</span></span>
<span data-ttu-id="04736-120">Nesta parte da tarefa hello, Olá a seguir:</span><span class="sxs-lookup"><span data-stu-id="04736-120">In this portion of hello task, do hello following:</span></span>

1. <span data-ttu-id="04736-121">No hello portal do Azure, crie balanceador de carga hello e configurar o endereço IP de saudação.</span><span class="sxs-lookup"><span data-stu-id="04736-121">In hello Azure portal, create hello load balancer and configure hello IP address.</span></span>
2. <span data-ttu-id="04736-122">Configure o pool de back-end de saudação.</span><span class="sxs-lookup"><span data-stu-id="04736-122">Configure hello back-end pool.</span></span>
3. <span data-ttu-id="04736-123">Crie a investigação de saudação.</span><span class="sxs-lookup"><span data-stu-id="04736-123">Create hello probe.</span></span> 
4. <span data-ttu-id="04736-124">Definir regras de balanceamento de carga de saudação.</span><span class="sxs-lookup"><span data-stu-id="04736-124">Set hello load balancing rules.</span></span>

> [!NOTE]
> <span data-ttu-id="04736-125">Se houver instâncias do SQL Server de saudação em vários grupos de recursos e as regiões, execute cada etapa duas vezes, uma vez em cada grupo de recursos.</span><span class="sxs-lookup"><span data-stu-id="04736-125">If hello SQL Server instances are in multiple resource groups and regions, perform each step twice, once in each resource group.</span></span>
> 
> 

### <a name="step-1-create-hello-load-balancer-and-configure-hello-ip-address"></a><span data-ttu-id="04736-126">Etapa 1: Criar balanceador de carga hello e configurar o endereço IP de saudação</span><span class="sxs-lookup"><span data-stu-id="04736-126">Step 1: Create hello load balancer and configure hello IP address</span></span>
<span data-ttu-id="04736-127">Primeiro, crie o balanceador de carga de saudação.</span><span class="sxs-lookup"><span data-stu-id="04736-127">First, create hello load balancer.</span></span> 

1. <span data-ttu-id="04736-128">No portal do Azure de Olá, abra o grupo de recursos de saudação que contém máquinas virtuais a saudação do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="04736-128">In hello Azure portal, open hello resource group that contains hello SQL Server virtual machines.</span></span> 

2. <span data-ttu-id="04736-129">No grupo de recursos de saudação, clique em **adicionar**.</span><span class="sxs-lookup"><span data-stu-id="04736-129">In hello resource group, click **Add**.</span></span>

3. <span data-ttu-id="04736-130">Procurar **balanceador de carga** e, em seguida, nos resultados da pesquisa hello, selecione **balanceador de carga**, que é publicado pelo **Microsoft**.</span><span class="sxs-lookup"><span data-stu-id="04736-130">Search for **load balancer** and then, in hello search results, select **Load Balancer**, which is published by **Microsoft**.</span></span>

4. <span data-ttu-id="04736-131">Em Olá **balanceador de carga** folha, clique em **criar**.</span><span class="sxs-lookup"><span data-stu-id="04736-131">On hello **Load Balancer** blade, click **Create**.</span></span>

5. <span data-ttu-id="04736-132">Em Olá **criar balanceador de carga** caixa de diálogo caixa, configure o balanceador de carga de saudação da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="04736-132">In hello **Create load balancer** dialog box, configure hello load balancer as follows:</span></span>

   | <span data-ttu-id="04736-133">Configuração</span><span class="sxs-lookup"><span data-stu-id="04736-133">Setting</span></span> | <span data-ttu-id="04736-134">Valor</span><span class="sxs-lookup"><span data-stu-id="04736-134">Value</span></span> |
   | --- | --- |
   | <span data-ttu-id="04736-135">**Nome**</span><span class="sxs-lookup"><span data-stu-id="04736-135">**Name**</span></span> |<span data-ttu-id="04736-136">Um nome de texto que representa o balanceador de carga de saudação.</span><span class="sxs-lookup"><span data-stu-id="04736-136">A text name representing hello load balancer.</span></span> <span data-ttu-id="04736-137">Por exemplo, **sqlLB**.</span><span class="sxs-lookup"><span data-stu-id="04736-137">For example, **sqlLB**.</span></span> |
   | <span data-ttu-id="04736-138">**Tipo**</span><span class="sxs-lookup"><span data-stu-id="04736-138">**Type**</span></span> |<span data-ttu-id="04736-139">**Interno**: a maioria das implementações usar um balanceador de carga interno, que permite que aplicativos em Olá mesmo grupo de disponibilidade do toohello tooconnect de rede virtual.</span><span class="sxs-lookup"><span data-stu-id="04736-139">**Internal**: Most implementations use an internal load balancer, which allows applications within hello same virtual network tooconnect toohello availability group.</span></span>  </br> <span data-ttu-id="04736-140">**Externa**: permite que aplicativos tooconnect toohello o grupo de disponibilidade por meio de uma conexão de Internet pública.</span><span class="sxs-lookup"><span data-stu-id="04736-140">**External**: Allows applications tooconnect toohello availability group through a public Internet connection.</span></span> |
   | <span data-ttu-id="04736-141">**Rede virtual**</span><span class="sxs-lookup"><span data-stu-id="04736-141">**Virtual network**</span></span> |<span data-ttu-id="04736-142">Selecione a rede virtual Olá Olá instâncias do SQL Server estão em.</span><span class="sxs-lookup"><span data-stu-id="04736-142">Select hello virtual network that hello SQL Server intances are in.</span></span> |
   | <span data-ttu-id="04736-143">**Sub-rede**</span><span class="sxs-lookup"><span data-stu-id="04736-143">**Subnet**</span></span> |<span data-ttu-id="04736-144">Selecione a sub-rede Olá Olá instâncias do SQL Server estiverem em.</span><span class="sxs-lookup"><span data-stu-id="04736-144">Select hello subnet that hello SQL Server instances are in.</span></span> |
   | <span data-ttu-id="04736-145">**Atribuição de endereço IP**</span><span class="sxs-lookup"><span data-stu-id="04736-145">**IP address assignment**</span></span> |<span data-ttu-id="04736-146">**Estático**</span><span class="sxs-lookup"><span data-stu-id="04736-146">**Static**</span></span> |
   | <span data-ttu-id="04736-147">**Endereço IP privado**</span><span class="sxs-lookup"><span data-stu-id="04736-147">**Private IP address**</span></span> |<span data-ttu-id="04736-148">Especifique um endereço IP disponível na sub-rede hello.</span><span class="sxs-lookup"><span data-stu-id="04736-148">Specify an available IP address from hello subnet.</span></span> <span data-ttu-id="04736-149">Quando você cria um ouvinte no cluster hello, use esse endereço IP.</span><span class="sxs-lookup"><span data-stu-id="04736-149">Use this IP address when you create a listener on hello cluster.</span></span> <span data-ttu-id="04736-150">Em um script do PowerShell, neste artigo, use esse endereço de saudação `$ILBIP` variável.</span><span class="sxs-lookup"><span data-stu-id="04736-150">In a PowerShell script, later in this article, use this address for hello `$ILBIP` variable.</span></span> |
   | <span data-ttu-id="04736-151">**Assinatura**</span><span class="sxs-lookup"><span data-stu-id="04736-151">**Subscription**</span></span> |<span data-ttu-id="04736-152">Se você tiver várias assinaturas, este campo poderá aparecer.</span><span class="sxs-lookup"><span data-stu-id="04736-152">If you have multiple subscriptions, this field might appear.</span></span> <span data-ttu-id="04736-153">Selecione Olá assinatura que você deseja tooassociate com esse recurso.</span><span class="sxs-lookup"><span data-stu-id="04736-153">Select hello subscription that you want tooassociate with this resource.</span></span> <span data-ttu-id="04736-154">Ele é normalmente Olá mesma assinatura como todos os recursos de Olá Olá grupo de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="04736-154">It is normally hello same subscription as all hello resources for hello availability group.</span></span> |
   | <span data-ttu-id="04736-155">**Grupo de recursos**</span><span class="sxs-lookup"><span data-stu-id="04736-155">**Resource group**</span></span> |<span data-ttu-id="04736-156">Selecione o grupo de recursos de saudação que são instâncias do SQL Server Olá no.</span><span class="sxs-lookup"><span data-stu-id="04736-156">Select hello resource group that hello SQL Server instances are in.</span></span> |
   | <span data-ttu-id="04736-157">**Localidade**</span><span class="sxs-lookup"><span data-stu-id="04736-157">**Location**</span></span> |<span data-ttu-id="04736-158">Selecione Olá local do Azure que são instâncias do SQL Server Olá no.</span><span class="sxs-lookup"><span data-stu-id="04736-158">Select hello Azure location that hello SQL Server instances are in.</span></span> |

6. <span data-ttu-id="04736-159">Clique em **Criar**.</span><span class="sxs-lookup"><span data-stu-id="04736-159">Click **Create**.</span></span> 

<span data-ttu-id="04736-160">O Azure cria o balanceador de carga hello.</span><span class="sxs-lookup"><span data-stu-id="04736-160">Azure creates hello load balancer.</span></span> <span data-ttu-id="04736-161">o balanceador de carga Olá pertence tooa rede específica, sub-rede, grupo de recursos e local.</span><span class="sxs-lookup"><span data-stu-id="04736-161">hello load balancer belongs tooa specific network, subnet, resource group, and location.</span></span> <span data-ttu-id="04736-162">Após o Azure concluir tarefas hello, verifique se configurações de Balanceador de carga Olá no Azure.</span><span class="sxs-lookup"><span data-stu-id="04736-162">After Azure completes hello task, verify hello load balancer settings in Azure.</span></span> 

### <a name="step-2-configure-hello-back-end-pool"></a><span data-ttu-id="04736-163">Etapa 2: Configurar o pool de back-end Olá</span><span class="sxs-lookup"><span data-stu-id="04736-163">Step 2: Configure hello back-end pool</span></span>
<span data-ttu-id="04736-164">Chamadas do Azure Olá pool de endereços de back-end *pool de back-end*.</span><span class="sxs-lookup"><span data-stu-id="04736-164">Azure calls hello back-end address pool *backend pool*.</span></span> <span data-ttu-id="04736-165">Nesse caso, o pool de back-end de saudação é endereços Olá Olá duas instâncias do SQL Server em seu grupo de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="04736-165">In this case, hello back-end pool is hello addresses of hello two SQL Server instances in your availability group.</span></span> 

1. <span data-ttu-id="04736-166">No seu grupo de recursos, clique em balanceador de carga de saudação que você criou.</span><span class="sxs-lookup"><span data-stu-id="04736-166">In your resource group, click hello load balancer that you created.</span></span> 

2. <span data-ttu-id="04736-167">Em **Configurações**, clique em **Pools de back-end**.</span><span class="sxs-lookup"><span data-stu-id="04736-167">On **Settings**, click **Backend pools**.</span></span>

3. <span data-ttu-id="04736-168">Em **pools de back-end**, clique em **adicionar** toocreate um pool de endereços de back-end.</span><span class="sxs-lookup"><span data-stu-id="04736-168">On **Backend pools**, click **Add** toocreate a back-end address pool.</span></span> 

4. <span data-ttu-id="04736-169">Em **Adicionar pool de back-end**, em **nome**, digite um nome para o pool de back-end de saudação.</span><span class="sxs-lookup"><span data-stu-id="04736-169">On **Add backend pool**, under **Name**, type a name for hello back-end pool.</span></span>

5. <span data-ttu-id="04736-170">Em **Máquinas virtuais**, clique em **Adicionar uma máquina virtual**.</span><span class="sxs-lookup"><span data-stu-id="04736-170">Under **Virtual machines**, click **Add a virtual machine**.</span></span> 

6. <span data-ttu-id="04736-171">Em **escolha máquinas virtuais**, clique em **escolher um conjunto de disponibilidade**e em seguida, especifique o conjunto de disponibilidade de saudação que Olá máquinas de virtuais de SQL Server pertence ao.</span><span class="sxs-lookup"><span data-stu-id="04736-171">Under **Choose virtual machines**, click **Choose an availability set**, and then specify hello availability set that hello SQL Server virtual machines belong to.</span></span>

7. <span data-ttu-id="04736-172">Depois de ter escolhido o conjunto de disponibilidade de saudação, clique em **escolha máquinas virtuais de saudação**, selecione Olá duas máquinas virtuais que hospedam instâncias do SQL Server Olá no grupo de disponibilidade hello e, em seguida, clique em **selecione**.</span><span class="sxs-lookup"><span data-stu-id="04736-172">After you have chosen hello availability set, click **Choose hello virtual machines**, select hello two virtual machines that host hello SQL Server instances in hello availability group, and then click **Select**.</span></span> 

8. <span data-ttu-id="04736-173">Clique em **Okey** tooclose folhas de saudação para **escolha máquinas virtuais**, e **Adicionar pool de back-end**.</span><span class="sxs-lookup"><span data-stu-id="04736-173">Click **OK** tooclose hello blades for **Choose virtual machines**, and **Add backend pool**.</span></span> 

<span data-ttu-id="04736-174">Azure atualiza as configurações de saudação para o pool de endereços de back-end de saudação.</span><span class="sxs-lookup"><span data-stu-id="04736-174">Azure updates hello settings for hello back-end address pool.</span></span> <span data-ttu-id="04736-175">Agora seu conjunto de disponibilidade tem um pool de duas instâncias do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="04736-175">Now your availability set has a pool of two SQL Server instances.</span></span>

### <a name="step-3-create-a-probe"></a><span data-ttu-id="04736-176">Etapa 3: Criar uma investigação</span><span class="sxs-lookup"><span data-stu-id="04736-176">Step 3: Create a probe</span></span>
<span data-ttu-id="04736-177">investigação de saudação define como o Azure verifica que Olá instâncias do SQL Server no momento possui o ouvinte do grupo de disponibilidade de saudação.</span><span class="sxs-lookup"><span data-stu-id="04736-177">hello probe defines how Azure verifies which of hello SQL Server instances currently owns hello availability group listener.</span></span> <span data-ttu-id="04736-178">Azure sondas de serviço de saudação com base no endereço IP de saudação em uma porta que definem quando você cria a investigação de saudação.</span><span class="sxs-lookup"><span data-stu-id="04736-178">Azure probes hello service based on hello IP address on a port that you define when you create hello probe.</span></span>

1. <span data-ttu-id="04736-179">Balanceador de carga Olá **configurações** folha, clique em **sondas de integridade**.</span><span class="sxs-lookup"><span data-stu-id="04736-179">On hello load balancer **Settings** blade, click **Health probes**.</span></span> 

2. <span data-ttu-id="04736-180">Em Olá **sondas de integridade** folha, clique em **adicionar**.</span><span class="sxs-lookup"><span data-stu-id="04736-180">On hello **Health probes** blade, click **Add**.</span></span>

3. <span data-ttu-id="04736-181">Configurar a investigação de saudação em Olá **adicionar teste** folha.</span><span class="sxs-lookup"><span data-stu-id="04736-181">Configure hello probe on hello **Add probe** blade.</span></span> <span data-ttu-id="04736-182">Olá Use valores tooconfigure Olá investigação a seguir:</span><span class="sxs-lookup"><span data-stu-id="04736-182">Use hello following values tooconfigure hello probe:</span></span>

   | <span data-ttu-id="04736-183">Configuração</span><span class="sxs-lookup"><span data-stu-id="04736-183">Setting</span></span> | <span data-ttu-id="04736-184">Valor</span><span class="sxs-lookup"><span data-stu-id="04736-184">Value</span></span> |
   | --- | --- |
   | <span data-ttu-id="04736-185">**Nome**</span><span class="sxs-lookup"><span data-stu-id="04736-185">**Name**</span></span> |<span data-ttu-id="04736-186">Um nome de texto que representa a investigação de saudação.</span><span class="sxs-lookup"><span data-stu-id="04736-186">A text name representing hello probe.</span></span> <span data-ttu-id="04736-187">Por exemplo, **SQLAlwaysOnEndPointProbe**.</span><span class="sxs-lookup"><span data-stu-id="04736-187">For example, **SQLAlwaysOnEndPointProbe**.</span></span> |
   | <span data-ttu-id="04736-188">**Protocolo**</span><span class="sxs-lookup"><span data-stu-id="04736-188">**Protocol**</span></span> |<span data-ttu-id="04736-189">**TCP**</span><span class="sxs-lookup"><span data-stu-id="04736-189">**TCP**</span></span> |
   | <span data-ttu-id="04736-190">**Porta**</span><span class="sxs-lookup"><span data-stu-id="04736-190">**Port**</span></span> |<span data-ttu-id="04736-191">Você pode usar qualquer porta disponível.</span><span class="sxs-lookup"><span data-stu-id="04736-191">You can use any available port.</span></span> <span data-ttu-id="04736-192">Por exemplo, *59999*.</span><span class="sxs-lookup"><span data-stu-id="04736-192">For example, *59999*.</span></span> |
   | <span data-ttu-id="04736-193">**Intervalo**</span><span class="sxs-lookup"><span data-stu-id="04736-193">**Interval**</span></span> |<span data-ttu-id="04736-194">*5*</span><span class="sxs-lookup"><span data-stu-id="04736-194">*5*</span></span> |
   | <span data-ttu-id="04736-195">**Limite não íntegro**</span><span class="sxs-lookup"><span data-stu-id="04736-195">**Unhealthy threshold**</span></span> |<span data-ttu-id="04736-196">*2*</span><span class="sxs-lookup"><span data-stu-id="04736-196">*2*</span></span> |

4.  <span data-ttu-id="04736-197">Clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="04736-197">Click **OK**.</span></span> 

> [!NOTE]
> <span data-ttu-id="04736-198">Certifique-se de que a porta de saudação especificado é aberta no firewall Olá ambas as instâncias do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="04736-198">Make sure that hello port you specify is open on hello firewall of both SQL Server instances.</span></span> <span data-ttu-id="04736-199">Ambas as instâncias exigem uma regra de entrada para Olá a porta TCP que você usa.</span><span class="sxs-lookup"><span data-stu-id="04736-199">Both instances require an inbound rule for hello TCP port that you use.</span></span> <span data-ttu-id="04736-200">Para saber mais, confira [Adicionar ou Editar Regra de Firewall](http://technet.microsoft.com/library/cc753558.aspx).</span><span class="sxs-lookup"><span data-stu-id="04736-200">For more information, see [Add or Edit Firewall Rule](http://technet.microsoft.com/library/cc753558.aspx).</span></span> 
> 
> 

<span data-ttu-id="04736-201">Azure cria investigação hello e, em seguida, usa-tootest qual instância do SQL Server tem ouvinte Olá Olá grupo de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="04736-201">Azure creates hello probe and then uses it tootest which SQL Server instance has hello listener for hello availability group.</span></span>

### <a name="step-4-set-hello-load-balancing-rules"></a><span data-ttu-id="04736-202">Etapa 4: Definir as regras de balanceamento de carga de saudação</span><span class="sxs-lookup"><span data-stu-id="04736-202">Step 4: Set hello load balancing rules</span></span>
<span data-ttu-id="04736-203">regras de balanceamento de carga Olá configurar como o balanceador de carga de saudação roteia instâncias do tráfego toohello do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="04736-203">hello load balancing rules configure how hello load balancer routes traffic toohello SQL Server instances.</span></span> <span data-ttu-id="04736-204">Para este balanceador de carga, você deve habilitar um retorno de servidor direto porque somente um Olá duas instâncias do SQL Server possui o recurso de ouvinte de grupo de disponibilidade Olá por vez.</span><span class="sxs-lookup"><span data-stu-id="04736-204">For this load balancer, you enable direct server return because only one of hello two SQL Server instances owns hello availability group listener resource at a time.</span></span>

1. <span data-ttu-id="04736-205">Balanceador de carga Olá **configurações** folha, clique em **regras de balanceamento de carga**.</span><span class="sxs-lookup"><span data-stu-id="04736-205">On hello load balancer **Settings** blade, click **Load balancing rules**.</span></span> 

2. <span data-ttu-id="04736-206">Em Olá **regras de balanceamento de carga** folha, clique em **adicionar**.</span><span class="sxs-lookup"><span data-stu-id="04736-206">On hello **Load balancing rules** blade, click **Add**.</span></span>

3. <span data-ttu-id="04736-207">Em Olá **regras de balanceamento de carga de adicionar** folha, configurar a regra de balanceamento de carga de saudação.</span><span class="sxs-lookup"><span data-stu-id="04736-207">On hello **Add load balancing rules** blade, configure hello load balancing rule.</span></span> <span data-ttu-id="04736-208">Saudação de usar as configurações a seguir:</span><span class="sxs-lookup"><span data-stu-id="04736-208">Use hello following settings:</span></span> 

   | <span data-ttu-id="04736-209">Configuração</span><span class="sxs-lookup"><span data-stu-id="04736-209">Setting</span></span> | <span data-ttu-id="04736-210">Valor</span><span class="sxs-lookup"><span data-stu-id="04736-210">Value</span></span> |
   | --- | --- |
   | <span data-ttu-id="04736-211">**Nome**</span><span class="sxs-lookup"><span data-stu-id="04736-211">**Name**</span></span> |<span data-ttu-id="04736-212">Um nome de texto que representa as regras de balanceamento de carga de saudação.</span><span class="sxs-lookup"><span data-stu-id="04736-212">A text name representing hello load balancing rules.</span></span> <span data-ttu-id="04736-213">Por exemplo, **SQLAlwaysOnEndPointListener**.</span><span class="sxs-lookup"><span data-stu-id="04736-213">For example, **SQLAlwaysOnEndPointListener**.</span></span> |
   | <span data-ttu-id="04736-214">**Protocolo**</span><span class="sxs-lookup"><span data-stu-id="04736-214">**Protocol**</span></span> |<span data-ttu-id="04736-215">**TCP**</span><span class="sxs-lookup"><span data-stu-id="04736-215">**TCP**</span></span> |
   | <span data-ttu-id="04736-216">**Porta**</span><span class="sxs-lookup"><span data-stu-id="04736-216">**Port**</span></span> |<span data-ttu-id="04736-217">*1433*</span><span class="sxs-lookup"><span data-stu-id="04736-217">*1433*</span></span> |
   | <span data-ttu-id="04736-218">**Porta de back-end**</span><span class="sxs-lookup"><span data-stu-id="04736-218">**Backend Port**</span></span> |<span data-ttu-id="04736-219">*1433*. Esse valor é ignorado porque essa regra usa **IP flutuante (retorno de servidor direto)**.</span><span class="sxs-lookup"><span data-stu-id="04736-219">*1433*. This value is ignored because this rule uses **Floating IP (direct server return)**.</span></span> |
   | <span data-ttu-id="04736-220">**Investigação**</span><span class="sxs-lookup"><span data-stu-id="04736-220">**Probe**</span></span> |<span data-ttu-id="04736-221">Use o nome de saudação do teste de saudação que você criou para este balanceador de carga.</span><span class="sxs-lookup"><span data-stu-id="04736-221">Use hello name of hello probe that you created for this load balancer.</span></span> |
   | <span data-ttu-id="04736-222">**Persistência de sessão**</span><span class="sxs-lookup"><span data-stu-id="04736-222">**Session persistence**</span></span> |<span data-ttu-id="04736-223">**Nenhum**</span><span class="sxs-lookup"><span data-stu-id="04736-223">**None**</span></span> |
   | <span data-ttu-id="04736-224">**Tempo limite de ociosidade (minutos)**</span><span class="sxs-lookup"><span data-stu-id="04736-224">**Idle timeout (minutes)**</span></span> |<span data-ttu-id="04736-225">*4*</span><span class="sxs-lookup"><span data-stu-id="04736-225">*4*</span></span> |
   | <span data-ttu-id="04736-226">**IP flutuante (retorno de servidor direto)**</span><span class="sxs-lookup"><span data-stu-id="04736-226">**Floating IP (direct server return)**</span></span> |<span data-ttu-id="04736-227">**Habilitado**</span><span class="sxs-lookup"><span data-stu-id="04736-227">**Enabled**</span></span> |

   > [!NOTE]
   > <span data-ttu-id="04736-228">Você pode ter tooscroll para baixo Olá folha tooview todas as configurações de saudação.</span><span class="sxs-lookup"><span data-stu-id="04736-228">You might have tooscroll down hello blade tooview all hello settings.</span></span>
   > 

4. <span data-ttu-id="04736-229">Clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="04736-229">Click **OK**.</span></span> 
5. <span data-ttu-id="04736-230">Regra de balanceamento de carga de saudação o Azure configura.</span><span class="sxs-lookup"><span data-stu-id="04736-230">Azure configures hello load balancing rule.</span></span> <span data-ttu-id="04736-231">Agora o balanceador de carga de saudação está configurado tooroute tráfego toohello SQL instância de servidor que hospeda o ouvinte Olá Olá grupo de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="04736-231">Now hello load balancer is configured tooroute traffic toohello SQL Server instance that hosts hello listener for hello availability group.</span></span> 

<span data-ttu-id="04736-232">Neste ponto, o grupo de recursos de saudação tem um balanceador de carga que se conecta tooboth máquinas do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="04736-232">At this point, hello resource group has a load balancer that connects tooboth SQL Server machines.</span></span> <span data-ttu-id="04736-233">Balanceador de carga Olá também contém um endereço IP para Olá SQL Server Always On disponibilidade ouvinte de grupo, para que a máquina pode responder toorequests Olá para grupos de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="04736-233">hello load balancer also contains an IP address for hello SQL Server Always On availability group listener, so that either machine can respond toorequests for hello availability groups.</span></span>

> [!NOTE]
> <span data-ttu-id="04736-234">Se suas instâncias do SQL Server estão em duas regiões separadas, repita as etapas de saudação em Olá outra região.</span><span class="sxs-lookup"><span data-stu-id="04736-234">If your SQL Server instances are in two separate regions, repeat hello steps in hello other region.</span></span> <span data-ttu-id="04736-235">Cada região exige um balanceador de carga.</span><span class="sxs-lookup"><span data-stu-id="04736-235">Each region requires a load balancer.</span></span> 
> 
> 

## <a name="configure-hello-cluster-toouse-hello-load-balancer-ip-address"></a><span data-ttu-id="04736-236">Configurar Olá cluster toouse Olá IP balanceador de carga</span><span class="sxs-lookup"><span data-stu-id="04736-236">Configure hello cluster toouse hello load balancer IP address</span></span>
<span data-ttu-id="04736-237">Olá próxima etapa tooconfigure Olá ouvinte no cluster Olá e coloque o ouvinte Olá online.</span><span class="sxs-lookup"><span data-stu-id="04736-237">hello next step is tooconfigure hello listener on hello cluster, and bring hello listener online.</span></span> <span data-ttu-id="04736-238">Olá a seguir:</span><span class="sxs-lookup"><span data-stu-id="04736-238">Do hello following:</span></span> 

1. <span data-ttu-id="04736-239">Crie o ouvinte do grupo de disponibilidade Olá no cluster de failover de saudação.</span><span class="sxs-lookup"><span data-stu-id="04736-239">Create hello availability group listener on hello failover cluster.</span></span> 

2. <span data-ttu-id="04736-240">Coloque o ouvinte Olá online.</span><span class="sxs-lookup"><span data-stu-id="04736-240">Bring hello listener online.</span></span>

### <a name="step-5-create-hello-availability-group-listener-on-hello-failover-cluster"></a><span data-ttu-id="04736-241">Etapa 5: Criar o ouvinte do grupo de disponibilidade de saudação no cluster de failover de saudação</span><span class="sxs-lookup"><span data-stu-id="04736-241">Step 5: Create hello availability group listener on hello failover cluster</span></span>
<span data-ttu-id="04736-242">Nesta etapa, você criar manualmente o ouvinte do grupo de disponibilidade Olá no Gerenciador de Cluster de Failover e o SQL Server Management Studio.</span><span class="sxs-lookup"><span data-stu-id="04736-242">In this step, you manually create hello availability group listener in Failover Cluster Manager and SQL Server Management Studio.</span></span>

[!INCLUDE [ag-listener-configure](../../../../includes/virtual-machines-ag-listener-configure.md)]

### <a name="verify-hello-configuration-of-hello-listener"></a><span data-ttu-id="04736-243">Verificar a configuração de saudação do ouvinte Olá</span><span class="sxs-lookup"><span data-stu-id="04736-243">Verify hello configuration of hello listener</span></span>

<span data-ttu-id="04736-244">Se as dependências e os recursos de cluster Olá são configuradas corretamente, você deve estar tooview capaz de ouvinte de saudação no SQL Server Management Studio.</span><span class="sxs-lookup"><span data-stu-id="04736-244">If hello cluster resources and dependencies are correctly configured, you should be able tooview hello listener in SQL Server Management Studio.</span></span> <span data-ttu-id="04736-245">tooset Olá porta do ouvinte, Olá a seguir:</span><span class="sxs-lookup"><span data-stu-id="04736-245">tooset hello listener port, do hello following:</span></span>

1. <span data-ttu-id="04736-246">Inicie o SQL Server Management Studio e conecte a réplica primária toohello.</span><span class="sxs-lookup"><span data-stu-id="04736-246">Start SQL Server Management Studio, and then connect toohello primary replica.</span></span>

2. <span data-ttu-id="04736-247">Vá muito**alta disponibilidade AlwaysOn** > **grupos de disponibilidade** > **ouvintes do grupo de disponibilidade**.</span><span class="sxs-lookup"><span data-stu-id="04736-247">Go too**AlwaysOn High Availability** > **Availability Groups** > **Availability Group Listeners**.</span></span>  
    <span data-ttu-id="04736-248">Agora você deve ver o nome do ouvinte Olá que você criou no Gerenciador de Cluster de Failover.</span><span class="sxs-lookup"><span data-stu-id="04736-248">You should now see hello listener name that you created in Failover Cluster Manager.</span></span> 

3. <span data-ttu-id="04736-249">Clique no nome do ouvinte Olá e clique **propriedades**.</span><span class="sxs-lookup"><span data-stu-id="04736-249">Right-click hello listener name, and then click **Properties**.</span></span>

4. <span data-ttu-id="04736-250">Em Olá **porta** , especifique o número da porta saudação do ouvinte do grupo de disponibilidade Olá usando Olá $EndpointPort utilizado antes (1433 foi padrão Olá) e, em seguida, clique em **Okey**.</span><span class="sxs-lookup"><span data-stu-id="04736-250">In hello **Port** box, specify hello port number for hello availability group listener by using hello $EndpointPort you used earlier (1433 was hello default), and then click **OK**.</span></span>

<span data-ttu-id="04736-251">Agora você tem um grupo de disponibilidade nas máquinas virtuais do Azure em execução no modo Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="04736-251">You now have an availability group in Azure virtual machines running in Resource Manager mode.</span></span> 

## <a name="test-hello-connection-toohello-listener"></a><span data-ttu-id="04736-252">Ouvinte de toohello de conexão de saudação do teste</span><span class="sxs-lookup"><span data-stu-id="04736-252">Test hello connection toohello listener</span></span>
<span data-ttu-id="04736-253">Testar conexão Olá Olá seguinte:</span><span class="sxs-lookup"><span data-stu-id="04736-253">Test hello connection by doing hello following:</span></span>

1. <span data-ttu-id="04736-254">Instância do SQL Server do RDP tooa que está em Olá mesmo virtual de rede, mas não não réplica Olá próprio.</span><span class="sxs-lookup"><span data-stu-id="04736-254">RDP tooa SQL Server instance that is in hello same virtual network, but does not own hello replica.</span></span> <span data-ttu-id="04736-255">Esse servidor pode ser outra instância do SQL Server no cluster Olá Olá.</span><span class="sxs-lookup"><span data-stu-id="04736-255">This server can be hello other SQL Server instance in hello cluster.</span></span>

2. <span data-ttu-id="04736-256">Use **sqlcmd** conexão de saudação do utilitário tootest.</span><span class="sxs-lookup"><span data-stu-id="04736-256">Use **sqlcmd** utility tootest hello connection.</span></span> <span data-ttu-id="04736-257">Por exemplo, a saudação script a seguir estabelece uma **sqlcmd** réplica primária de toohello de conexão por meio do ouvinte Olá com autenticação do Windows:</span><span class="sxs-lookup"><span data-stu-id="04736-257">For example, hello following script establishes a **sqlcmd** connection toohello primary replica through hello listener with Windows authentication:</span></span>
   
        sqlcmd -S <listenerName> -E

<span data-ttu-id="04736-258">Olá conexão SQLCMD conecta-se automaticamente toohello instância de SQL Server que hospeda a réplica primária hello.</span><span class="sxs-lookup"><span data-stu-id="04736-258">hello SQLCMD connection automatically connects toohello SQL Server instance that hosts hello primary replica.</span></span> 

## <a name="create-an-ip-address-for-an-additional-availability-group"></a><span data-ttu-id="04736-259">Criar um endereço IP para um grupo de disponibilidade adicional</span><span class="sxs-lookup"><span data-stu-id="04736-259">Create an IP address for an additional availability group</span></span>

<span data-ttu-id="04736-260">Cada grupo de disponibilidade usa um ouvinte separado.</span><span class="sxs-lookup"><span data-stu-id="04736-260">Each availability group uses a separate listener.</span></span> <span data-ttu-id="04736-261">Cada ouvinte tem seu próprio endereço IP.</span><span class="sxs-lookup"><span data-stu-id="04736-261">Each listener has its own IP address.</span></span> <span data-ttu-id="04736-262">Use Olá mesmo toohold Olá IP do balanceador de carga para ouvintes adicionais.</span><span class="sxs-lookup"><span data-stu-id="04736-262">Use hello same load balancer toohold hello IP address for additional listeners.</span></span> <span data-ttu-id="04736-263">Depois de criar um grupo de disponibilidade, adicionar balanceador de carga toohello do endereço IP hello e, em seguida, configurar o ouvinte de saudação.</span><span class="sxs-lookup"><span data-stu-id="04736-263">After you create an availability group, add hello IP address toohello load balancer, and then configure hello listener.</span></span>

<span data-ttu-id="04736-264">tooadd um balanceador de carga tooa de endereço IP com hello portal do Azure, Olá a seguir:</span><span class="sxs-lookup"><span data-stu-id="04736-264">tooadd an IP address tooa load balancer with hello Azure portal, do hello following:</span></span>

1. <span data-ttu-id="04736-265">No portal do Azure de Olá, abra Olá grupo de recursos que contém o balanceador de carga hello e clique em balanceador de carga de saudação.</span><span class="sxs-lookup"><span data-stu-id="04736-265">In hello Azure portal, open hello resource group that contains hello load balancer, and then click hello load balancer.</span></span> 

2. <span data-ttu-id="04736-266">Em **CONFIGURAÇÕES**, clique em **Pool IP de front-ends** e clique em **Adicionar**.</span><span class="sxs-lookup"><span data-stu-id="04736-266">Under **SETTINGS**, click **Frontend IP pool**, and then click **Add**.</span></span> 

3. <span data-ttu-id="04736-267">Em **adicionar endereço IP de front-end**, atribua um nome para o front-end hello.</span><span class="sxs-lookup"><span data-stu-id="04736-267">Under **Add frontend IP address**, assign a name for hello front end.</span></span> 

4. <span data-ttu-id="04736-268">Verifique se esse Olá **rede Virtual** e hello **sub-rede** são Olá mesmo Olá instâncias do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="04736-268">Verify that hello **Virtual network** and hello **Subnet** are hello same as hello SQL Server instances.</span></span>

5. <span data-ttu-id="04736-269">Definir o endereço IP de saudação para ouvinte hello.</span><span class="sxs-lookup"><span data-stu-id="04736-269">Set hello IP address for hello listener.</span></span> 
   
   >[!TIP]
   ><span data-ttu-id="04736-270">Você pode definir Olá toostatic de endereço IP e digite um endereço que não está sendo usado na sub-rede hello.</span><span class="sxs-lookup"><span data-stu-id="04736-270">You can set hello IP address toostatic and type an address that is not currently used in hello subnet.</span></span> <span data-ttu-id="04736-271">Como alternativa, você pode definir Olá toodynamic de endereço IP e salvar o novo pool IP front-end hello.</span><span class="sxs-lookup"><span data-stu-id="04736-271">Alternatively, you can set hello IP address toodynamic and save hello new front-end IP pool.</span></span> <span data-ttu-id="04736-272">Quando você fizer isso, Olá portal do Azure atribui automaticamente um pool de toohello de endereços IP disponível.</span><span class="sxs-lookup"><span data-stu-id="04736-272">When you do so, hello Azure portal automatically assigns an available IP address toohello pool.</span></span> <span data-ttu-id="04736-273">Você pode, em seguida, reabra o pool de IP de front-end de saudação e alterar Olá atribuição toostatic.</span><span class="sxs-lookup"><span data-stu-id="04736-273">You can then reopen hello front-end IP pool and change hello assignment toostatic.</span></span> 

6. <span data-ttu-id="04736-274">Salve endereço IP hello ouvinte hello.</span><span class="sxs-lookup"><span data-stu-id="04736-274">Save hello IP address for hello listener.</span></span> 

7. <span data-ttu-id="04736-275">Adicione um teste de integridade usando Olá configurações a seguir:</span><span class="sxs-lookup"><span data-stu-id="04736-275">Add a health probe by using hello following settings:</span></span>

   |<span data-ttu-id="04736-276">Configuração</span><span class="sxs-lookup"><span data-stu-id="04736-276">Setting</span></span> |<span data-ttu-id="04736-277">Valor</span><span class="sxs-lookup"><span data-stu-id="04736-277">Value</span></span>
   |:-----|:----
   |<span data-ttu-id="04736-278">**Nome**</span><span class="sxs-lookup"><span data-stu-id="04736-278">**Name**</span></span> |<span data-ttu-id="04736-279">Investigação de saudação do tooidentify um nome.</span><span class="sxs-lookup"><span data-stu-id="04736-279">A name tooidentify hello probe.</span></span>
   |<span data-ttu-id="04736-280">**Protocolo**</span><span class="sxs-lookup"><span data-stu-id="04736-280">**Protocol**</span></span> |<span data-ttu-id="04736-281">TCP</span><span class="sxs-lookup"><span data-stu-id="04736-281">TCP</span></span>
   |<span data-ttu-id="04736-282">**Porta**</span><span class="sxs-lookup"><span data-stu-id="04736-282">**Port**</span></span> |<span data-ttu-id="04736-283">Uma porta TCP não usada, que deve estar disponível em todas as máquinas virtuais.</span><span class="sxs-lookup"><span data-stu-id="04736-283">An unused TCP port, which must be available on all virtual machines.</span></span> <span data-ttu-id="04736-284">Não pode ser usada para qualquer outra finalidade.</span><span class="sxs-lookup"><span data-stu-id="04736-284">It cannot be used for any other purpose.</span></span> <span data-ttu-id="04736-285">Não há dois ouvintes podem usar o hello mesma porta de investigação.</span><span class="sxs-lookup"><span data-stu-id="04736-285">No two listeners can use hello same probe port.</span></span> 
   |<span data-ttu-id="04736-286">**Intervalo**</span><span class="sxs-lookup"><span data-stu-id="04736-286">**Interval**</span></span> |<span data-ttu-id="04736-287">tentativas de quantidade de saudação de tempo entre a investigação.</span><span class="sxs-lookup"><span data-stu-id="04736-287">hello amount of time between probe attempts.</span></span> <span data-ttu-id="04736-288">Use o padrão de saudação (5).</span><span class="sxs-lookup"><span data-stu-id="04736-288">Use hello default (5).</span></span>
   |<span data-ttu-id="04736-289">**Limite não íntegro**</span><span class="sxs-lookup"><span data-stu-id="04736-289">**Unhealthy threshold**</span></span> |<span data-ttu-id="04736-290">número de saudação de limites consecutivos que deve falhar antes que uma máquina virtual é considerada não íntegra.</span><span class="sxs-lookup"><span data-stu-id="04736-290">hello number of consecutive thresholds that should fail before a virtual machine is considered unhealthy.</span></span>

8. <span data-ttu-id="04736-291">Clique em **Okey** toosave investigação de saudação.</span><span class="sxs-lookup"><span data-stu-id="04736-291">Click **OK** toosave hello probe.</span></span> 

9. <span data-ttu-id="04736-292">Criar uma regra de balanceamento de carga.</span><span class="sxs-lookup"><span data-stu-id="04736-292">Create a load balancing rule.</span></span> <span data-ttu-id="04736-293">Clique em **Regras de balanceamento de carga** e clique em **Adicionar**.</span><span class="sxs-lookup"><span data-stu-id="04736-293">Click **Load balancing rules**, and then click **Add**.</span></span>

10. <span data-ttu-id="04736-294">Configure Olá novo balanceamento de carga regra usando Olá configurações a seguir:</span><span class="sxs-lookup"><span data-stu-id="04736-294">Configure hello new load balancing rule by using hello following settings:</span></span>

   |<span data-ttu-id="04736-295">Configuração</span><span class="sxs-lookup"><span data-stu-id="04736-295">Setting</span></span> |<span data-ttu-id="04736-296">Valor</span><span class="sxs-lookup"><span data-stu-id="04736-296">Value</span></span>
   |:-----|:----
   |<span data-ttu-id="04736-297">**Nome**</span><span class="sxs-lookup"><span data-stu-id="04736-297">**Name**</span></span> |<span data-ttu-id="04736-298">Regra de balanceamento de carga de saudação de tooidentify um nome.</span><span class="sxs-lookup"><span data-stu-id="04736-298">A name tooidentify hello load balancing rule.</span></span> 
   |<span data-ttu-id="04736-299">**Endereço IP de front-end**</span><span class="sxs-lookup"><span data-stu-id="04736-299">**Frontend IP address**</span></span> |<span data-ttu-id="04736-300">Selecione o endereço IP de saudação criado por você.</span><span class="sxs-lookup"><span data-stu-id="04736-300">Select hello IP address you created.</span></span> 
   |<span data-ttu-id="04736-301">**Protocolo**</span><span class="sxs-lookup"><span data-stu-id="04736-301">**Protocol**</span></span> |<span data-ttu-id="04736-302">TCP</span><span class="sxs-lookup"><span data-stu-id="04736-302">TCP</span></span>
   |<span data-ttu-id="04736-303">**Porta**</span><span class="sxs-lookup"><span data-stu-id="04736-303">**Port**</span></span> |<span data-ttu-id="04736-304">Use a porta Olá que instâncias do SQL Server hello estão usando.</span><span class="sxs-lookup"><span data-stu-id="04736-304">Use hello port that hello SQL Server instances are using.</span></span> <span data-ttu-id="04736-305">Uma instância padrão usa a porta 1433, a menos que você tenha alterado.</span><span class="sxs-lookup"><span data-stu-id="04736-305">A default instance uses port 1433, unless you changed it.</span></span> 
   |<span data-ttu-id="04736-306">**Porta de back-end**</span><span class="sxs-lookup"><span data-stu-id="04736-306">**Backend port**</span></span> |<span data-ttu-id="04736-307">Olá Use mesmo valor **porta**.</span><span class="sxs-lookup"><span data-stu-id="04736-307">Use hello same value as **Port**.</span></span>
   |<span data-ttu-id="04736-308">**Pool de back-end**</span><span class="sxs-lookup"><span data-stu-id="04736-308">**Backend pool**</span></span> |<span data-ttu-id="04736-309">pool de saudação que contém máquinas virtuais de saudação com instâncias do SQL Server hello.</span><span class="sxs-lookup"><span data-stu-id="04736-309">hello pool that contains hello virtual machines with hello SQL Server instances.</span></span> 
   |<span data-ttu-id="04736-310">**Investigação de integridade**</span><span class="sxs-lookup"><span data-stu-id="04736-310">**Health probe**</span></span> |<span data-ttu-id="04736-311">Escolha investigação Olá criado por você.</span><span class="sxs-lookup"><span data-stu-id="04736-311">Choose hello probe you created.</span></span>
   |<span data-ttu-id="04736-312">**Persistência de sessão**</span><span class="sxs-lookup"><span data-stu-id="04736-312">**Session persistence**</span></span> |<span data-ttu-id="04736-313">Nenhum</span><span class="sxs-lookup"><span data-stu-id="04736-313">None</span></span>
   |<span data-ttu-id="04736-314">**Tempo limite de ociosidade (minutos)**</span><span class="sxs-lookup"><span data-stu-id="04736-314">**Idle timeout (minutes)**</span></span> |<span data-ttu-id="04736-315">(4) padrão</span><span class="sxs-lookup"><span data-stu-id="04736-315">Default (4)</span></span>
   |<span data-ttu-id="04736-316">**IP flutuante (retorno de servidor direto)**</span><span class="sxs-lookup"><span data-stu-id="04736-316">**Floating IP (direct server return)**</span></span> | <span data-ttu-id="04736-317">habilitado</span><span class="sxs-lookup"><span data-stu-id="04736-317">Enabled</span></span>

### <a name="configure-hello-availability-group-toouse-hello-new-ip-address"></a><span data-ttu-id="04736-318">Configurar Olá disponibilidade toouse Olá novo endereço IP do grupo</span><span class="sxs-lookup"><span data-stu-id="04736-318">Configure hello availability group toouse hello new IP address</span></span>

<span data-ttu-id="04736-319">toofinish Configurando cluster hello, etapas de repetição Olá que você seguiu quando você fez o primeiro grupo de disponibilidade hello.</span><span class="sxs-lookup"><span data-stu-id="04736-319">toofinish configuring hello cluster, repeat hello steps that you followed when you made hello first availability group.</span></span> <span data-ttu-id="04736-320">Ou seja, configurar Olá [toouse Olá novo endereço IP de cluster](#configure-the-cluster-to-use-the-load-balancer-ip-address).</span><span class="sxs-lookup"><span data-stu-id="04736-320">That is, configure hello [cluster toouse hello new IP address](#configure-the-cluster-to-use-the-load-balancer-ip-address).</span></span> 

<span data-ttu-id="04736-321">Depois que você adicionou um endereço IP de ouvinte hello, configure o grupo de disponibilidade adicional de Olá Olá seguinte:</span><span class="sxs-lookup"><span data-stu-id="04736-321">After you have added an IP address for hello listener, configure hello additional availability group by doing hello following:</span></span> 

1. <span data-ttu-id="04736-322">Verifique se a porta de investigação Olá para o novo endereço IP hello está aberta em máquinas virtuais do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="04736-322">Verify that hello probe port for hello new IP address is open on both SQL Server virtual machines.</span></span> 

2. <span data-ttu-id="04736-323">[No Gerenciador de Cluster, adicione o ponto de acesso de cliente de Olá](#addcap).</span><span class="sxs-lookup"><span data-stu-id="04736-323">[In Cluster Manager, add hello client access point](#addcap).</span></span>

3. <span data-ttu-id="04736-324">[Configurar o recurso IP Olá para o grupo de disponibilidade Olá](#congroup).</span><span class="sxs-lookup"><span data-stu-id="04736-324">[Configure hello IP resource for hello availability group](#congroup).</span></span>

   >[!IMPORTANT]
   ><span data-ttu-id="04736-325">Quando você cria um endereço IP Olá, use o endereço IP de saudação que você adicionou toohello balanceador de carga.</span><span class="sxs-lookup"><span data-stu-id="04736-325">When you create hello IP address, use hello IP address that you added toohello load balancer.</span></span>  

4. <span data-ttu-id="04736-326">[Tornar o recurso de grupo de disponibilidade do SQL Server Olá dependente no ponto de acesso de cliente Olá](#dependencyGroup).</span><span class="sxs-lookup"><span data-stu-id="04736-326">[Make hello SQL Server availability group resource dependent on hello client access point](#dependencyGroup).</span></span>

5. <span data-ttu-id="04736-327">[Verifique o acesso para cliente Olá ponto recursos dependentes no endereço IP hello](#listname).</span><span class="sxs-lookup"><span data-stu-id="04736-327">[Make hello client access point resource dependent on hello IP address](#listname).</span></span>
 
6. <span data-ttu-id="04736-328">[Definir parâmetros de cluster de saudação do PowerShell](#setparam).</span><span class="sxs-lookup"><span data-stu-id="04736-328">[Set hello cluster parameters in PowerShell](#setparam).</span></span>

<span data-ttu-id="04736-329">Depois de configurar Olá disponibilidade grupo toouse Olá novo endereço IP, configure o ouvinte de toohello de conexão de saudação.</span><span class="sxs-lookup"><span data-stu-id="04736-329">After you configure hello availability group toouse hello new IP address, configure hello connection toohello listener.</span></span> 

## <a name="next-steps"></a><span data-ttu-id="04736-330">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="04736-330">Next steps</span></span>

- [<span data-ttu-id="04736-331">Configurar um Grupo de Disponibilidade Always On do SQL Server em Máquinas Virtuais do Azure em diferentes regiões</span><span class="sxs-lookup"><span data-stu-id="04736-331">Configure a SQL Server Always On availability group on Azure virtual machines in different regions</span></span>](virtual-machines-windows-portal-sql-availability-group-dr.md)
