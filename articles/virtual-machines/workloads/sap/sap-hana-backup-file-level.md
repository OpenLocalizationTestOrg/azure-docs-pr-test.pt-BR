---
title: "aaaSAP HANA Azure Backup em nível de arquivo | Microsoft Docs"
description: "Há duas possibilidades principais de backup para SAP HANA em máquinas virtuais do Azure, e este artigo aborda o Backup do Azure do SAP HANA no nível do arquivo"
services: virtual-machines-linux
documentationcenter: 
author: hermanndms
manager: timlt
editor: 
ms.service: virtual-machines-linux
ms.devlang: NA
ms.topic: article
ums.tgt_pltfrm: vm-linux
ms.workload: infrastructure-services
ms.date: 3/13/2017
ms.author: rclaus
ms.openlocfilehash: d5a55de5634ac7724e7fd0fa3760c6c408c3db74
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="sap-hana-azure-backup-on-file-level"></a><span data-ttu-id="9c1d1-103">Backup do Azure do SAP HANA no nível do arquivo</span><span class="sxs-lookup"><span data-stu-id="9c1d1-103">SAP HANA Azure Backup on file level</span></span>

## <a name="introduction"></a><span data-ttu-id="9c1d1-104">Introdução</span><span class="sxs-lookup"><span data-stu-id="9c1d1-104">Introduction</span></span>

<span data-ttu-id="9c1d1-105">Este artigo faz parte de uma série dividida em três partes com artigos relacionados ao backup do SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-105">This is part of a three-part series of related articles on SAP HANA backup.</span></span> <span data-ttu-id="9c1d1-106">[Guia de backup para o SAP HANA em máquinas virtuais Azure](./sap-hana-backup-guide.md) fornece uma visão geral e informações sobre como começar, e [backup SAP HANA com base em instantâneos de armazenamento](./sap-hana-backup-storage-snapshots.md) abrange Olá opção backup de armazenamento baseados em instantâneo.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-106">[Backup guide for SAP HANA on Azure Virtual Machines](./sap-hana-backup-guide.md) provides an overview and information on getting started, and [SAP HANA backup based on storage snapshots](./sap-hana-backup-storage-snapshots.md) covers hello storage snapshot-based backup option.</span></span>

<span data-ttu-id="9c1d1-107">Verificando Olá tamanhos de VM do Azure, um pode ver um GS5 permite 64 discos de dados anexado.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-107">Looking at hello Azure VM sizes, one can see that a GS5 allows 64 attached data disks.</span></span> <span data-ttu-id="9c1d1-108">Para sistemas SAP HANA de grande porte, um número considerável de discos já pode estar ocupado por arquivos de log e de dados, possivelmente em combinação com RAID de software para obtenção da melhor taxa de transferência de E/S de disco.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-108">For large SAP HANA systems, a significant number of disks might already be taken for data and log files, possibly in combination with software RAID for optimal disk IO throughput.</span></span> <span data-ttu-id="9c1d1-109">pergunta de Hello, em seguida, é onde toostore SAP HANA fazer backup de arquivos, que podem preencher dados saudação anexado discos ao longo do tempo?</span><span class="sxs-lookup"><span data-stu-id="9c1d1-109">hello question then is where toostore SAP HANA backup files, which could fill up hello attached data disks over time?</span></span> <span data-ttu-id="9c1d1-110">Consulte [tamanhos de máquinas virtuais Linux no Azure](../../linux/sizes.md) para tabelas de tamanho de VM do Azure hello.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-110">See [Sizes for Linux virtual machines in Azure](../../linux/sizes.md) for hello Azure VM size tables.</span></span>

<span data-ttu-id="9c1d1-111">No momento, não há integração de backup do SAP HANA disponível com o serviço de Backup do Azure.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-111">There is no SAP HANA backup integration available with Azure Backup service at this time.</span></span> <span data-ttu-id="9c1d1-112">modo padrão de saudação toomanage backup/restauração no nível de arquivo hello é com um backup baseado em arquivo por meio do SAP HANA Studio ou instruções SQL do SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-112">hello standard way toomanage backup/restore at hello file level is with a file-based backup via SAP HANA Studio or via SAP HANA SQL statements.</span></span> <span data-ttu-id="9c1d1-113">Confira [SAP HANA SQL e referência de exibições do sistema](https://help.sap.com/hana/SAP_HANA_SQL_and_System_Views_Reference_en.pdf) para saber mais.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-113">See [SAP HANA SQL and System Views Reference](https://help.sap.com/hana/SAP_HANA_SQL_and_System_Views_Reference_en.pdf) for more information.</span></span>

![Esta figura mostra a caixa de diálogo Olá Olá backup do item de menu no SAP HANA Studio](media/sap-hana-backup-file-level/image022.png)

<span data-ttu-id="9c1d1-115">Esta figura mostra a caixa de diálogo Olá Olá backup do item de menu no SAP HANA Studio.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-115">This figure shows hello dialog of hello backup menu item in SAP HANA Studio.</span></span> <span data-ttu-id="9c1d1-116">Ao escolher o tipo &quot;arquivo,&quot; um tem um caminho toospecify no sistema de arquivos Olá onde SAP HANA grava arquivos de backup hello.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-116">When choosing type &quot;file,&quot; one has toospecify a path in hello file system where SAP HANA writes hello backup files.</span></span> <span data-ttu-id="9c1d1-117">A restauração funciona Olá mesma maneira.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-117">Restore works hello same way.</span></span>

<span data-ttu-id="9c1d1-118">Embora essa opção pareça simples e direta, há algumas considerações.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-118">While this choice sounds simple and straight forward, there are some considerations.</span></span> <span data-ttu-id="9c1d1-119">Conforme mencionado anteriormente, uma VM do Azure tem uma limitação no número de discos de dados que podem ser anexados.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-119">As mentioned before, an Azure VM has a limitation of number of data disks that can be attached.</span></span> <span data-ttu-id="9c1d1-120">Talvez não haja capacidade toostore SAP HANA arquivos de backup em sistemas de arquivos de saudação do hello VM, dependendo do tamanho de saudação do hello banco de dados e requisitos de produtividade, que pode envolver o software RAID usando distribuindo entre dados de vários discos.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-120">There might not be capacity toostore SAP HANA backup files on hello file systems of hello VM, depending on hello size of hello database and disk throughput requirements, which might involve software RAID using striping across multiple data disks.</span></span> <span data-ttu-id="9c1d1-121">Posteriormente, este artigo fornece várias opções para mover esses arquivos de backup e gerenciar as restrições de tamanho de arquivo e desempenho ao lidar com terabytes de dados.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-121">Various options for moving these backup files, and managing file size restrictions and performance when handling terabytes of data, are provided later in this article.</span></span>

<span data-ttu-id="9c1d1-122">Outra opção, que oferece mais liberdade com relação à capacidade total, é o Armazenamento de Blobs do Azure.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-122">Another option, which offers more freedom regarding total capacity, is Azure blob storage.</span></span> <span data-ttu-id="9c1d1-123">Enquanto um único blob também é restrito too1 TB, a capacidade total de saudação de um único contêiner de blob está atualmente 500 TB.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-123">While a single blob is also restricted too1 TB, hello total capacity of a single blob container is currently 500 TB.</span></span> <span data-ttu-id="9c1d1-124">Além disso, ele oferece aos clientes, chamados de tooselect choice Olá &quot;moderado&quot; armazenamento de blob, que tem um custo-benefício.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-124">Additionally, it gives customers hello choice tooselect so-called &quot;cool&quot; blob storage, which has a cost benefit.</span></span> <span data-ttu-id="9c1d1-125">Confira [Armazenamento de Blobs do Azure: camadas de armazenamento dinâmica e estática](../../../storage/blobs/storage-blob-storage-tiers.md) para obter detalhes sobre o armazenamento de blobs frio.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-125">See [Azure Blob Storage: Hot and cool storage tiers](../../../storage/blobs/storage-blob-storage-tiers.md) for details about cool blob storage.</span></span>

<span data-ttu-id="9c1d1-126">Para segurança adicional, use um armazenamento replicado geograficamente conta toostore Olá SAP HANA os backups.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-126">For additional safety, use a geo-replicated storage account toostore hello SAP HANA backups.</span></span> <span data-ttu-id="9c1d1-127">Confira [Replicação de Armazenamento do Azure](../../../storage/common/storage-redundancy.md) para obter mais detalhes sobre a replicação da conta de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-127">See [Azure Storage replication](../../../storage/common/storage-redundancy.md) for details about storage account replication.</span></span>

<span data-ttu-id="9c1d1-128">É possível colocar VHDs dedicados para backups do SAP HANA em uma conta de armazenamento de backup dedicada com replicação geográfica.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-128">One could place dedicated VHDs for SAP HANA backups in a dedicated backup storage account that is geo-replicated.</span></span> <span data-ttu-id="9c1d1-129">Caso contrário, um pode copiar VHDs Olá manter backups do SAP HANA Olá conta de armazenamento replicado geograficamente tooa ou tooa conta de armazenamento que está em uma região diferente.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-129">Or else one could copy hello VHDs that keep hello SAP HANA backups tooa geo-replicated storage account, or tooa storage account that is in a different region.</span></span>

## <a name="azure-backup-agent"></a><span data-ttu-id="9c1d1-130">Agente de backup do Azure</span><span class="sxs-lookup"><span data-stu-id="9c1d1-130">Azure backup agent</span></span>

<span data-ttu-id="9c1d1-131">Ofertas de backup do Azure Olá opção toonot backup somente completo VMs, mas também arquivos e diretórios por meio do agente de backup hello, que tem toobe instalado no sistema operacional convidado de saudação.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-131">Azure backup offers hello option toonot only back up complete VMs, but also files and directories via hello backup agent, which has toobe installed on hello guest OS.</span></span> <span data-ttu-id="9c1d1-132">Mas a partir de dezembro de 2016, o agente só tem suporte no Windows (consulte [fazer backup de um tooAzure de cliente ou servidor do Windows usando o modelo de implantação do Gerenciador de recursos de saudação](../../../backup/backup-configure-vault.md)).</span><span class="sxs-lookup"><span data-stu-id="9c1d1-132">But as of December 2016, this agent is only supported on Windows (see [Back up a Windows Server or client tooAzure using hello Resource Manager deployment model](../../../backup/backup-configure-vault.md)).</span></span>

<span data-ttu-id="9c1d1-133">Uma solução alternativa é copiar toofirst tooa de arquivos de backup do SAP HANA VM do Windows no Azure (por exemplo, por meio do compartilhamento SAMBA) e use Olá agente de backup do Azure a partir daí.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-133">A workaround is toofirst copy SAP HANA backup files tooa Windows VM on Azure (for example, via SAMBA share) and then use hello Azure backup agent from there.</span></span> <span data-ttu-id="9c1d1-134">Embora seja tecnicamente possível, ele seria adicionar complexidade e reduzir a velocidade do backup hello ou restaurar processo bastante devido a cópia toohello entre Olá Linux e hello VM do Windows.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-134">While it is technically possible, it would add complexity and slow down hello backup or restore process quite a bit due toohello copy between hello Linux and hello Windows VM.</span></span> <span data-ttu-id="9c1d1-135">Não é recomendável toofollow essa abordagem.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-135">It is not recommended toofollow this approach.</span></span>

## <a name="azure-blobxfer-utility-details"></a><span data-ttu-id="9c1d1-136">Detalhes do utilitário blobxfer do Azure</span><span class="sxs-lookup"><span data-stu-id="9c1d1-136">Azure blobxfer utility details</span></span>

<span data-ttu-id="9c1d1-137">toostore diretórios e arquivos no armazenamento do Azure, você pode usar CLI ou o PowerShell, ou desenvolva uma ferramenta usando um Olá [SDKs do Azure](https://azure.microsoft.com/downloads/).</span><span class="sxs-lookup"><span data-stu-id="9c1d1-137">toostore directories and files on Azure storage, one could use CLI or PowerShell, or develop a tool using one of hello [Azure SDKs](https://azure.microsoft.com/downloads/).</span></span> <span data-ttu-id="9c1d1-138">Também há um utilitário prontos para uso, AzCopy, para copiar o armazenamento de tooAzure de dados, mas é só Windows (consulte [transferir dados com hello utilitário de linha de comando AzCopy](../../../storage/common/storage-use-azcopy.md)).</span><span class="sxs-lookup"><span data-stu-id="9c1d1-138">There is also a ready-to-use utility, AzCopy, for copying data tooAzure storage, but it is Windows only (see [Transfer data with hello AzCopy Command-Line Utility](../../../storage/common/storage-use-azcopy.md)).</span></span>

<span data-ttu-id="9c1d1-139">Portanto, o blobxfer foi usado para copiar arquivos de backup do SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-139">Therefore blobxfer was used for copying SAP HANA backup files.</span></span> <span data-ttu-id="9c1d1-140">Ele é um software livre, usado por muitos clientes em ambientes de produção e disponível no [GitHub](https://github.com/Azure/blobxfer).</span><span class="sxs-lookup"><span data-stu-id="9c1d1-140">It is open source, used by many customers in production environments, and available on [GitHub](https://github.com/Azure/blobxfer).</span></span> <span data-ttu-id="9c1d1-141">Essa ferramenta permite que os dados toocopy diretamente tooeither Azure blob storage ou compartilhamento de arquivos do Azure.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-141">This tool allows one toocopy data directly tooeither Azure blob storage or Azure file share.</span></span> <span data-ttu-id="9c1d1-142">Ele também oferece vários recursos úteis, como o hash md5 ou o paralelismo automático ao copiar um diretório com vários arquivos.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-142">It also offers a range of useful features, like md5 hash or automatic parallelism when copying a directory with multiple files.</span></span>

## <a name="sap-hana-backup-performance"></a><span data-ttu-id="9c1d1-143">Desempenho de backup do SAP HANA</span><span class="sxs-lookup"><span data-stu-id="9c1d1-143">SAP HANA backup performance</span></span>

![Esta captura de tela é Olá SAP HANA backup console SAP HANA Studio](media/sap-hana-backup-file-level/image023.png)

<span data-ttu-id="9c1d1-145">Esta captura de tela é Olá SAP HANA backup console SAP HANA Studio.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-145">This screenshot is of hello SAP HANA backup console in SAP HANA Studio.</span></span> <span data-ttu-id="9c1d1-146">Que levou o backup do aproximadamente 42 minutos toodo Olá Olá 230 GB em um disco único armazenamento padrão do Azure anexados toohello HANA VM usando o sistema de arquivos XFS.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-146">It took about 42 minutes toodo hello backup of hello 230 GB on a single Azure standard storage disk attached toohello HANA VM using XFS file system.</span></span>

![Esta captura de tela é do YaST na VM de teste do hello SAP HANA](media/sap-hana-backup-file-level/image024.png)

<span data-ttu-id="9c1d1-148">Esta captura de tela é de YaST na VM de teste do hello SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-148">This screenshot is of YaST on hello SAP HANA test VM.</span></span> <span data-ttu-id="9c1d1-149">Um pode ver Olá 1 TB único disco de backup do SAP HANA conforme mencionado anteriormente.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-149">One can see hello 1-TB single disk for SAP HANA backup as mentioned before.</span></span> <span data-ttu-id="9c1d1-150">Levou aproximadamente 42 minutos toobackup 230 GB.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-150">It took about 42 minutes toobackup 230 GB.</span></span> <span data-ttu-id="9c1d1-151">Além disso, cinco discos de 200 GB foram anexados e o RAID de software md0 foi criado, com distribuição nesses cinco discos de dados do Azure.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-151">In addition, five 200-GB disks were attached and software RAID md0 created, with striping on top of these five Azure data disks.</span></span>

![Repetir Olá mesmo backup de RAID de software com a distribuição em cinco anexado discos de dados de armazenamento do Azure standard](media/sap-hana-backup-file-level/image025.png)

<span data-ttu-id="9c1d1-153">Olá repetição mesmo backup de RAID de software com a distribuição em cinco anexados tempo de backup do armazenamento do Azure standard dados discos colocados Olá de 42 minutos para baixo too10 minutos.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-153">Repeating hello same backup on software RAID with striping across five attached Azure standard storage data disks brought hello backup time from 42 minutes down too10 minutes.</span></span> <span data-ttu-id="9c1d1-154">Olá discos foram anexados sem cache toohello VM.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-154">hello disks were attached without caching toohello VM.</span></span> <span data-ttu-id="9c1d1-155">Portanto, é óbvio throughput de gravação de disco como importante é para o tempo de backup de saudação.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-155">So it is obvious how important disk write throughput is for hello backup time.</span></span> <span data-ttu-id="9c1d1-156">Um poderia então comutador tooAzure premium armazenamento toofurther acelerar o processo de saudação para otimizar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-156">One could then switch tooAzure premium storage toofurther accelerate hello process for optimal performance.</span></span> <span data-ttu-id="9c1d1-157">Em geral, o Armazenamento premium do Azure deve ser usado para sistemas de produção.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-157">In general, Azure premium storage should be used for production systems.</span></span>

## <a name="copy-sap-hana-backup-files-tooazure-blob-storage"></a><span data-ttu-id="9c1d1-158">Copiar o armazenamento de BLOBs do SAP HANA arquivos de backup tooAzure</span><span class="sxs-lookup"><span data-stu-id="9c1d1-158">Copy SAP HANA backup files tooAzure blob storage</span></span>

<span data-ttu-id="9c1d1-159">Como de dezembro de 2016, Olá melhor opção tooquickly repositório SAP HANA backup de arquivos é o armazenamento de BLOBs do Azure.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-159">As of December 2016, hello best option tooquickly store SAP HANA backup files is Azure blob storage.</span></span> <span data-ttu-id="9c1d1-160">Um único contêiner de blob tem um limite de 500 TB, suficiente para a maioria dos sistemas SAP HANA, em execução em uma VM GS5 no Azure, tookeep suficientes backups de SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-160">One single blob container has a limit of 500 TB, enough for most SAP HANA systems, running in a GS5 VM on Azure, tookeep sufficient SAP HANA backups.</span></span> <span data-ttu-id="9c1d1-161">Os clientes têm a opção Olá entre &quot;hot&quot; e &quot;frios&quot; armazenamento de blob (consulte [armazenamento de BLOBs do Azure: Hot e interessantes camadas de armazenamento](../../../storage/blobs/storage-blob-storage-tiers.md)).</span><span class="sxs-lookup"><span data-stu-id="9c1d1-161">Customers have hello choice between &quot;hot&quot; and &quot;cold&quot; blob storage (see [Azure Blob Storage: Hot and cool storage tiers](../../../storage/blobs/storage-blob-storage-tiers.md)).</span></span>

<span data-ttu-id="9c1d1-162">Com a ferramenta de blobxfer Olá, é fácil toocopy arquivos de backup do SAP HANA de saudação diretamente tooAzure armazenamento de blob.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-162">With hello blobxfer tool, it is easy toocopy hello SAP HANA backup files directly tooAzure blob storage.</span></span>

![Aqui um pode ver os arquivos de saudação de um backup de arquivo completo do SAP HANA](media/sap-hana-backup-file-level/image026.png)

<span data-ttu-id="9c1d1-164">Aqui um verá Olá arquivos de um backup de arquivo completo do SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-164">Here one can see hello files of a full SAP HANA file backup.</span></span> <span data-ttu-id="9c1d1-165">Há quatro arquivos e uma maior hello tem aproximadamente 230 GB.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-165">There are four files and hello biggest one has roughly 230 GB.</span></span>

![Levou aproximadamente 3000 segundos contêiner de blob toocopy Olá GB 230 tooan padrão de armazenamento do Azure conta](media/sap-hana-backup-file-level/image027.png)

<span data-ttu-id="9c1d1-167">Não usando o hash md5 no teste inicial hello, levou aproximadamente 3000 segundos toocopy Olá GB 230 tooan padrão conta blob contêiner de armazenamento Azure.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-167">Not using md5 hash in hello initial test, it took roughly 3000 seconds toocopy hello 230 GB tooan Azure standard storage account blob container.</span></span>

![Esta captura de tela, um pode ver sua aparência no hello portal do Azure](media/sap-hana-backup-file-level/image028.png)

<span data-ttu-id="9c1d1-169">Nesta captura de tela, um pode ver sua aparência no hello portal do Azure.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-169">In this screenshot, one can see how it looks on hello Azure portal.</span></span> <span data-ttu-id="9c1d1-170">Um contêiner de blob denominado &quot;backups do sap hana&quot; foi criado e inclui blobs Olá quatro, que representam os arquivos de backup Olá SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-170">A blob container named &quot;sap-hana-backups&quot; was created and includes hello four blobs, which represent hello SAP HANA backup files.</span></span> <span data-ttu-id="9c1d1-171">Um deles tem um tamanho de aproximadamente 230 GB.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-171">One of them has a size of roughly 230 GB.</span></span>

<span data-ttu-id="9c1d1-172">console backup do HANA Studio Olá permite que um tamanho de arquivo máximo Olá toorestrict HANA dos arquivos de backup.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-172">hello HANA Studio backup console allows one toorestrict hello max file size of HANA backup files.</span></span> <span data-ttu-id="9c1d1-173">No ambiente do exemplo hello, ele melhor desempenho, tornando possível toohave backup menor de vários arquivos, em vez de um arquivo grande de 230-GB.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-173">In hello sample environment, it improved performance by making it possible toohave multiple smaller backup files, instead of one large 230-GB file.</span></span>

![Definir o limite de tamanho do arquivo de backup Olá Olá HANA lado &#39; t melhorar o tempo de backup de saudação](media/sap-hana-backup-file-level/image029.png)

<span data-ttu-id="9c1d1-175">Definir o limite de tamanho do arquivo de backup Olá Olá HANA lado &#39; t melhorar o tempo de backup hello, porque os arquivos de saudação são gravados em sequência, conforme mostrado na figura.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-175">Setting hello backup file size limit on hello HANA side doesn&#39;t improve hello backup time, because hello files are written sequentially as shown in this figure.</span></span> <span data-ttu-id="9c1d1-176">limite de tamanho de arquivo Hello foi definido too60 GB, para que backup Olá criou quatro arquivos de dados grandes, em vez da saudação 230-GB arquivo único.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-176">hello file size limit was set too60 GB, so hello backup created four large data files instead of hello 230-GB single file.</span></span>

![paralelismo de tootest da ferramenta de blobxfer hello, tamanho de arquivo máximo Olá para backups do HANA foi definido, em seguida, too15 GB](media/sap-hana-backup-file-level/image030.png)

<span data-ttu-id="9c1d1-178">paralelismo de tootest da ferramenta de blobxfer hello, tamanho de arquivo máximo Olá para backups do HANA foi definido, em seguida, too15 GB, o que resultou em 19 de arquivos de backup.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-178">tootest parallelism of hello blobxfer tool, hello max file size for HANA backups was then set too15 GB, which resulted in 19 backup files.</span></span> <span data-ttu-id="9c1d1-179">Essa configuração trazidas de tempo de saudação blobxfer toocopy Olá GB 230 tooAzure armazenamento de blob de 3000 segundos para baixo too875 segundos.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-179">This configuration brought hello time for blobxfer toocopy hello 230 GB tooAzure blob storage from 3000 seconds down too875 seconds.</span></span>

<span data-ttu-id="9c1d1-180">Esse resultado é devido toohello limite de 60 MB/s para escrever um blob do Azure.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-180">This result is due toohello limit of 60 MB/sec for writing an Azure blob.</span></span> <span data-ttu-id="9c1d1-181">Paralelismo por meio de vários blobs resolve afunilamento hello, mas há uma desvantagem: armazenamento de blob aumentando o desempenho de saudação blobxfer ferramenta toocopy todos esses tooAzure de arquivos de backup do HANA coloca carga Olá HANA VM e rede hello.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-181">Parallelism via multiple blobs solves hello bottleneck, but there is a downside: increasing performance of hello blobxfer tool toocopy all these HANA backup files tooAzure blob storage puts load on both hello HANA VM and hello network.</span></span> <span data-ttu-id="9c1d1-182">Operação do sistema HANA fica afetada.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-182">Operation of HANA system becomes impacted.</span></span>

## <a name="blob-copy-of-dedicated-azure-data-disks-in-backup-software-raid"></a><span data-ttu-id="9c1d1-183">Cópia de blob de discos de dados do Azure dedicados no RAID do software de backup</span><span class="sxs-lookup"><span data-stu-id="9c1d1-183">Blob copy of dedicated Azure data disks in backup software RAID</span></span>

<span data-ttu-id="9c1d1-184">Diferentemente Olá manual VM dados backup em disco, essa abordagem um não fazer backup de todos os discos de dados de saudação em uma VM toosave Olá SAP instalação completa, inclusive dados do HANA, HANA arquivos de log e arquivos de configuração.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-184">Unlike hello manual VM data disk backup, in this approach one does not back up all hello data disks on a VM toosave hello whole SAP installation, including HANA data, HANA log files, and config files.</span></span> <span data-ttu-id="9c1d1-185">Em vez disso, ideia Olá é RAID de software toohave dedicado com distribuição entre vários VHDs de dados do Azure para armazenar um backup de arquivo completo do SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-185">Instead, hello idea is toohave dedicated software RAID with striping across multiple Azure data VHDs for storing a full SAP HANA file backup.</span></span> <span data-ttu-id="9c1d1-186">Uma copia somente esses discos, que têm o backup do SAP HANA hello.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-186">One copies only these disks, which have hello SAP HANA backup.</span></span> <span data-ttu-id="9c1d1-187">Eles facilmente pode ser mantidos em uma conta de armazenamento de backup do HANA dedicada ou anexado tooa dedicado &quot;backup gerenciamento VM&quot; para processamento adicional.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-187">They could easily be kept in a dedicated HANA backup storage account, or attached tooa dedicated &quot;backup management VM&quot; for further processing.</span></span>

![Todos os VHDs envolvidos foram copiados usando hello * * iniciar-azurestorageblobcopy * * comando do PowerShell](media/sap-hana-backup-file-level/image031.png)

<span data-ttu-id="9c1d1-189">Após Olá toohello backup local RAID de software foi concluída, todos os VHDs envolvidos foram copiados usando Olá **início azurestorageblobcopy** comando do PowerShell (consulte [AzureStorageBlobCopy início](/powershell/module/azure.storage/start-azurestorageblobcopy)).</span><span class="sxs-lookup"><span data-stu-id="9c1d1-189">After hello backup toohello local software RAID was completed, all VHDs involved were copied using hello **start-azurestorageblobcopy** PowerShell command (see [Start-AzureStorageBlobCopy](/powershell/module/azure.storage/start-azurestorageblobcopy)).</span></span> <span data-ttu-id="9c1d1-190">Como ela afeta apenas o sistema de arquivos dedicado de saudação para manter os arquivos de backup Olá, não há nenhum preocupações sobre a consistência do arquivo de dados ou de log do SAP HANA no disco hello.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-190">As it only affects hello dedicated file system for keeping hello backup files, there are no concerns about SAP HANA data or log file consistency on hello disk.</span></span> <span data-ttu-id="9c1d1-191">Uma vantagem desse comando é que ele funciona enquanto Olá VM permanece online.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-191">A benefit of this command is that it works while hello VM stays online.</span></span> <span data-ttu-id="9c1d1-192">toobe certos de que nenhum processo grava o conjunto de backup distribuído de toohello, ser toounmount-se de que ele antes de saudação cópia de blob e montá-lo novamente mais tarde.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-192">toobe certain that no process writes toohello backup stripe set, be sure toounmount it before hello blob copy, and mount it again afterwards.</span></span> <span data-ttu-id="9c1d1-193">Ou poderia ser usada uma apropriado muito&quot;congelar&quot; Olá sistema de arquivos.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-193">Or one could use an appropriate way too&quot;freeze&quot; hello file system.</span></span> <span data-ttu-id="9c1d1-194">Por exemplo, via xfs\_congelar Olá XFS sistema de arquivos.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-194">For example, via xfs\_freeze for hello XFS file system.</span></span>

![Esta captura de tela mostra a lista de saudação de blobs no contêiner de vhds Olá em Olá portal do Azure](media/sap-hana-backup-file-level/image032.png)

<span data-ttu-id="9c1d1-196">Esta captura de tela mostra a lista de saudação de blobs em Olá &quot;vhds&quot; contêiner em Olá portal do Azure.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-196">This screenshot shows hello list of blobs in hello &quot;vhds&quot; container on hello Azure portal.</span></span> <span data-ttu-id="9c1d1-197">captura de tela de saudação mostra Olá cinco VHDs, que foram anexados toohello SAP HANA server VM tooserve como Olá software RAID tookeep SAP HANA arquivos de backup.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-197">hello screenshot shows hello five VHDs, which were attached toohello SAP HANA server VM tooserve as hello software RAID tookeep SAP HANA backup files.</span></span> <span data-ttu-id="9c1d1-198">Ele também mostra Olá cinco cópias, que foram feitas por meio do comando de cópia de blob hello.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-198">It also shows hello five copies, which were taken via hello blob copy command.</span></span>

![Para fins de teste, cópias de saudação de discos RAID de software de backup de SAP HANA Olá foram anexados toohello VM do servidor de aplicativo](media/sap-hana-backup-file-level/image033.png)

<span data-ttu-id="9c1d1-200">Para fins de teste, cópias de saudação de discos RAID de software de backup de SAP HANA Olá foram anexados toohello VM do servidor de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-200">For testing purposes, hello copies of hello SAP HANA backup software RAID disks were attached toohello app server VM.</span></span>

![VM do servidor de aplicativo Hello foi desligado tooattach Olá disco cópias](media/sap-hana-backup-file-level/image034.png)

<span data-ttu-id="9c1d1-202">VM do servidor de aplicativo Hello foi desligado tooattach Olá disco cópias.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-202">hello app server VM was shut down tooattach hello disk copies.</span></span> <span data-ttu-id="9c1d1-203">Depois de iniciar Olá VM, discos hello e hello RAID detectados corretamente (montados por meio de UUID).</span><span class="sxs-lookup"><span data-stu-id="9c1d1-203">After starting hello VM, hello disks and hello RAID were discovered correctly (mounted via UUID).</span></span> <span data-ttu-id="9c1d1-204">Somente o ponto de montagem Olá estava ausente, que foi criado por meio de particionador de YaST hello.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-204">Only hello mount point was missing, which was created via hello YaST partitioner.</span></span> <span data-ttu-id="9c1d1-205">Depois cópias de backup de arquivo do SAP HANA Olá tornou-se visível no nível do sistema operacional.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-205">Afterwards hello SAP HANA backup file copies became visible on OS level.</span></span>

## <a name="copy-sap-hana-backup-files-toonfs-share"></a><span data-ttu-id="9c1d1-206">Copiar arquivos de backup do SAP HANA tooNFS compartilhar</span><span class="sxs-lookup"><span data-stu-id="9c1d1-206">Copy SAP HANA backup files tooNFS share</span></span>

<span data-ttu-id="9c1d1-207">toolessen Olá impacto em Olá sistema SAP HANA de uma perspectiva de espaço em disco ou de desempenho, um pode considerar a armazenar os arquivos de backup Olá SAP HANA em um compartilhamento NFS.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-207">toolessen hello potential impact on hello SAP HANA system from a performance or disk space perspective, one might consider storing hello SAP HANA backup files on an NFS share.</span></span> <span data-ttu-id="9c1d1-208">Tecnicamente, isso funciona, mas significa usando uma segunda VM do Azure como host de saudação da saudação de compartilhamento NFS.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-208">Technically it works, but it means using a second Azure VM as hello host of hello NFS share.</span></span> <span data-ttu-id="9c1d1-209">Não deve ser um pequeno tamanho da VM, devido a largura de banda de rede VM toohello.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-209">It should not be a small VM size, due toohello VM network bandwidth.</span></span> <span data-ttu-id="9c1d1-210">Faria sentido e tooshut para baixo isso &quot;backup VM&quot; e apenas exibi-la para executar o backup do SAP HANA hello.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-210">It would make sense then tooshut down this &quot;backup VM&quot; and only bring it up for executing hello SAP HANA backup.</span></span> <span data-ttu-id="9c1d1-211">Gravar em um NFS compartilhamento coloca a carga na rede hello e impactos Olá sistema SAP HANA, mas simplesmente gerenciar Olá arquivos de backup posteriormente em Olá &quot;backup VM&quot; seria influencia sistema do SAP HANA hello.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-211">Writing on an NFS share puts load on hello network and impacts hello SAP HANA system, but merely managing hello backup files afterwards on hello &quot;backup VM&quot; would not influence hello SAP HANA system at all.</span></span>

![Um compartilhamento NFS de outra VM do Azure foi montado toohello VM do servidor de SAP HANA](media/sap-hana-backup-file-level/image035.png)

<span data-ttu-id="9c1d1-213">caso de uso tooverify Olá NFS, um compartilhamento NFS de outra VM do Azure VM do servidor SAP HANA toohello montado.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-213">tooverify hello NFS use case, an NFS share from another Azure VM was mounted toohello SAP HANA server VM.</span></span> <span data-ttu-id="9c1d1-214">Não havia um ajuste de NFS especial aplicado.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-214">There was no special NFS tuning applied.</span></span>

![Backup de saudação toodo 1 hora e 46 minutos levou diretamente](media/sap-hana-backup-file-level/image036.png)

<span data-ttu-id="9c1d1-216">compartilhamento NFS Olá era um conjunto de distribuição rápida, como Olá no servidor do SAP HANA hello.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-216">hello NFS share was a fast stripe set, like hello one on hello SAP HANA server.</span></span> <span data-ttu-id="9c1d1-217">No entanto, ela levou 1 hora e saudação de toodo 46 minutos backup diretamente no compartilhamento NFS Olá em vez de 10 minutos, ao gravar o conjunto de distribuição local de tooa.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-217">Nevertheless, it took 1 hour and 46 minutes toodo hello backup directly on hello NFS share instead of 10 minutes, when writing tooa local stripe set.</span></span>

![alternativa de saudação não era muito mais rápida em 1 hora e 43 minutos](media/sap-hana-backup-file-level/image037.png)

<span data-ttu-id="9c1d1-219">alternativa de saudação de fazer um conjunto de distribuição local de backup tooa e copiando toohello de compartilhamento NFS no nível do sistema operacional (um simples **cp - avr** comando) não era muito mais rápida.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-219">hello alternative of doing a backup tooa local stripe set and copying toohello NFS share on OS level (a simple **cp -avr** command) wasn't much quicker.</span></span> <span data-ttu-id="9c1d1-220">Demorou 1 hora e 43 minutos.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-220">It took 1 hour and 43 minutes.</span></span>

<span data-ttu-id="9c1d1-221">Para que ele funciona, mas desempenho não era bom para teste de backup Olá 230 GB.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-221">So it works, but performance wasn't good for hello 230-GB backup test.</span></span> <span data-ttu-id="9c1d1-222">Ficaria ainda pior para vários terabytes.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-222">It would look even worse for multi terabytes.</span></span>

## <a name="copy-sap-hana-backup-files-tooazure-file-service"></a><span data-ttu-id="9c1d1-223">Copie o serviço de arquivo do SAP HANA arquivos de backup tooAzure</span><span class="sxs-lookup"><span data-stu-id="9c1d1-223">Copy SAP HANA backup files tooAzure file service</span></span>

<span data-ttu-id="9c1d1-224">É possível toomount compartilhar um arquivo do Azure dentro de uma VM do Linux do Azure.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-224">It is possible toomount an Azure file share inside an Azure Linux VM.</span></span> <span data-ttu-id="9c1d1-225">artigo Olá [como toouse armazenamento de arquivo do Azure com Linux](../../../storage/files/storage-how-to-use-files-linux.md) fornece detalhes sobre como toodo-lo.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-225">hello article [How toouse Azure File storage with Linux](../../../storage/files/storage-how-to-use-files-linux.md) provides details on how toodo it.</span></span> <span data-ttu-id="9c1d1-226">Tenha em mente de que há um limite de cota de 5 TB de um compartilhamento de arquivos do Azure e um limite de tamanho de arquivo de 1 TB por arquivo.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-226">Keep in mind that there is currently a 5-TB quota limit of one Azure file share, and a file size limit of 1 TB per file.</span></span> <span data-ttu-id="9c1d1-227">Confira [Metas de desempenho e de escalabilidade do Armazenamento do Azure](../../../storage/common/storage-scalability-targets.md) para saber mais sobre os limites de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-227">See [Azure Storage Scalability and Performance Targets](../../../storage/common/storage-scalability-targets.md) for information on storage limits.</span></span>

<span data-ttu-id="9c1d1-228">Os testes mostraram, no entanto, que o backup do SAP HANA não funciona diretamente no momento com esse tipo de montagem de CIFS.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-228">Tests have shown, however, that SAP HANA backup doesn&#39;t currently work directly with this kind of CIFS mount.</span></span> <span data-ttu-id="9c1d1-229">Também está declarado na [Nota SAP 1820529](https://launchpad.support.sap.com/#/notes/1820529) que o CIFS não é recomendado.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-229">It is also stated in [SAP Note 1820529](https://launchpad.support.sap.com/#/notes/1820529) that CIFS is not recommended.</span></span>

![Esta figura mostra um erro na caixa de diálogo backup no SAP HANA Studio Olá](media/sap-hana-backup-file-level/image038.png)

<span data-ttu-id="9c1d1-231">Esta figura mostra um erro na caixa de diálogo backup no Studio do HANA SAP, Olá durante a tentativa de tooback backup do compartilhamento de arquivos do Azure montado CIFS tooa diretamente.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-231">This figure shows an error in hello backup dialog in SAP HANA Studio, when trying tooback up directly tooa CIFS-mounted Azure file share.</span></span> <span data-ttu-id="9c1d1-232">Para um tem toodo um backup SAP HANA padrão em um sistema de arquivos de máquina virtual pela primeira vez e, em seguida, os arquivos de backup de cópia de saudação de lá tooAzure serviço de arquivo.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-232">So one has toodo a standard SAP HANA backup into a VM file system first, and then copy hello backup files from there tooAzure file service.</span></span>

![Esta figura mostra que levou sobre 929 segundos toocopy 19 SAP HANA arquivos de backup](media/sap-hana-backup-file-level/image039.png)

<span data-ttu-id="9c1d1-234">Esta figura mostra que levou sobre toocopy 929 segundos 19 arquivos de backup SAP HANA, com um tamanho total de aproximadamente 230 GB toohello do Azure do compartilhamento de arquivos.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-234">This figure shows that it took about 929 seconds toocopy 19 SAP HANA backup files with a total size of roughly 230 GB toohello Azure file share.</span></span>

![estrutura de diretórios de origem Olá na Olá SAP HANA VM foi copiado toohello compartilhamento de arquivos do Azure](media/sap-hana-backup-file-level/image040.png)

<span data-ttu-id="9c1d1-236">Nesta captura de tela, um pode ver a estrutura de diretórios de origem Olá na Olá SAP HANA VM foi copiado toohello compartilhamento de arquivos do Azure: um diretório (hana\_backup\_fsl\_15 gb) e arquivos de backup individuais 19.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-236">In this screenshot, one can see that hello source directory structure on hello SAP HANA VM was copied toohello Azure file share: one directory (hana\_backup\_fsl\_15gb) and 19 individual backup files.</span></span>

<span data-ttu-id="9c1d1-237">Armazenar arquivos de backup do SAP HANA em arquivos do Azure pode ser uma opção interessante no futuro de saudação quando backups de arquivo do SAP HANA suportam diretamente.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-237">Storing SAP HANA backup files on Azure files could be an interesting option in hello future when SAP HANA file backups support it directly.</span></span> <span data-ttu-id="9c1d1-238">Ou, quando ele se torna possível toomount Azure arquivos por meio de NFS e o limite de cota máximo Olá é consideravelmente maior do que 5 TB.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-238">Or when it becomes possible toomount Azure files via NFS and hello maximum quota limit is considerably higher than 5 TB.</span></span>

## <a name="next-steps"></a><span data-ttu-id="9c1d1-239">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="9c1d1-239">Next steps</span></span>
* <span data-ttu-id="9c1d1-240">[Guia de backup do SAP HANA nas Máquinas Virtuais do Azure](sap-hana-backup-guide.md) fornece uma visão geral e informações sobre como começar.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-240">[Backup guide for SAP HANA on Azure Virtual Machines](sap-hana-backup-guide.md) gives an overview and information on getting started.</span></span>
* <span data-ttu-id="9c1d1-241">[Backup do HANA SAP com base em instantâneos de armazenamento](sap-hana-backup-storage-snapshots.md) descreve Olá armazenamento baseado em instantâneo opção de backup.</span><span class="sxs-lookup"><span data-stu-id="9c1d1-241">[SAP HANA backup based on storage snapshots](sap-hana-backup-storage-snapshots.md) describes hello storage snapshot-based backup option.</span></span>
* <span data-ttu-id="9c1d1-242">toolearn como tooestablish alta disponibilidade e o plano de recuperação de desastres do HANA SAP no Azure (instâncias grandes), consulte [SAP HANA (instâncias grandes) alta disponibilidade e recuperação de desastres no Azure](hana-overview-high-availability-disaster-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="9c1d1-242">toolearn how tooestablish high availability and plan for disaster recovery of SAP HANA on Azure (large instances), see [SAP HANA (large instances) high availability and disaster recovery on Azure](hana-overview-high-availability-disaster-recovery.md).</span></span>
