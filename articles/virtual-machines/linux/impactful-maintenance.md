---
title: "Reinicialização de manutenção da VM para VMs do Linux no Azure | Microsoft Docs"
description: "Reinicialização de manutenção da VM para máquinas virtuais do Linux."
services: virtual-machines-linux
documentationcenter: 
author: zivr
manager: timlt
editor: 
tags: azure-service-management,azure-resource-manager
ms.assetid: eb4b92d8-be0f-44f6-a6c3-f8f7efab09fe
ms.service: virtual-machines-windows
ms.workload: infrastructure-services
ms.tgt_pltfrm: vm-linux
ms.devlang: na
ms.topic: article
ms.date: 03/27/2017
ms.author: zivr
ms.openlocfilehash: 25beee157bb869067e562189f86312dab173e68f
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 07/11/2017
---
# <a name="vm-restarting-maintenance"></a><span data-ttu-id="2a760-103">Reinicialização de manutenção da VM</span><span class="sxs-lookup"><span data-stu-id="2a760-103">VM restarting maintenance</span></span>

<span data-ttu-id="2a760-104">Há alguns casos em que as VMs são reinicializadas devido à manutenção planejada na infraestrutura subjacente.</span><span class="sxs-lookup"><span data-stu-id="2a760-104">There are few cases where your VMs are rebooted due to planned maintenance to the underlying infrastructure.</span></span> <span data-ttu-id="2a760-105">Tendo um impacto na disponibilidade das VMs hospedadas no Azure, os seguintes itens agora estão disponíveis para uso:</span><span class="sxs-lookup"><span data-stu-id="2a760-105">Being impactful to the availability of your VMs hosted in Azure, the following are now available for you to use:</span></span>

-   <span data-ttu-id="2a760-106">Notificação enviada com, no mínimo, 30 dias de antecedência do impacto.</span><span class="sxs-lookup"><span data-stu-id="2a760-106">Notification sent at least 30 days before the impact.</span></span>

-   <span data-ttu-id="2a760-107">Visibilidade das janelas de manutenção por cada VM.</span><span class="sxs-lookup"><span data-stu-id="2a760-107">Visibility to the maintenance windows per each VM.</span></span>

-   <span data-ttu-id="2a760-108">Flexibilidade e controle na definição do tempo exato da manutenção que afeta as VMs.</span><span class="sxs-lookup"><span data-stu-id="2a760-108">Flexibility and control in setting the exact time for maintenance to impact your VMs.</span></span>

<span data-ttu-id="2a760-109">A manutenção no Microsoft Azure é agendada em iterações.</span><span class="sxs-lookup"><span data-stu-id="2a760-109">Maintenance in Microsoft Azure is scheduled in iterations.</span></span> <span data-ttu-id="2a760-110">As iterações iniciais têm escopo menor, a fim de reduzir o risco envolvido na distribuição de novas correções e funcionalidades.</span><span class="sxs-lookup"><span data-stu-id="2a760-110">Initial iterations have smaller scope in order to reduce the risk involved in rolling out new fixes and capabilities.</span></span> <span data-ttu-id="2a760-111">As iterações posteriores podem abranger várias regiões (nunca do mesmo par de regiões).</span><span class="sxs-lookup"><span data-stu-id="2a760-111">Later iterations may span multiple regions (never from the same region pair).</span></span> <span data-ttu-id="2a760-112">Uma VM está incluída em uma única iteração de manutenção.</span><span class="sxs-lookup"><span data-stu-id="2a760-112">A VM is included in a single maintenance iteration.</span></span> <span data-ttu-id="2a760-113">Se uma iteração for anulada, as VMs restantes serão incluídas em outra iteração futura.</span><span class="sxs-lookup"><span data-stu-id="2a760-113">If an iteration is aborted, remaining VMs are included in another, future, iteration.</span></span>

<span data-ttu-id="2a760-114">A iteração de manutenção planejada tem duas fases: uma Janela de Manutenção Preemptiva e uma Janela de Manutenção Agendada.</span><span class="sxs-lookup"><span data-stu-id="2a760-114">The planned maintenance iteration has two phases: Pre-emptive Maintenance Window and a Scheduled-Maintenance Window.</span></span>

<span data-ttu-id="2a760-115">A **Janela de Manutenção Preemptiva** fornece a flexibilidade para iniciar a manutenção nas VMs.</span><span class="sxs-lookup"><span data-stu-id="2a760-115">The **Pre-emptive Maintenance Window** provides you with the flexibility to initiate the maintenance on your VMs.</span></span> <span data-ttu-id="2a760-116">Ao fazer isso, você pode determinar quando as VMs são afetadas, a sequência da atualização e o tempo de manutenção entre cada VM.</span><span class="sxs-lookup"><span data-stu-id="2a760-116">By doing so, you can determine when your VMs are impacted, the sequence of the update, and the time between each VM being maintained.</span></span> <span data-ttu-id="2a760-117">Você pode consultar cada VM para ver se ela está planejada para manutenção e verificar o resultado da última solicitação de manutenção iniciada.</span><span class="sxs-lookup"><span data-stu-id="2a760-117">You can query each VM to see whether it is planned for maintenance and check the result of your last initiated maintenance request.</span></span>

<span data-ttu-id="2a760-118">A **Janela de Manutenção Agendada** ocorre quando o Azure agenda as VMs para manutenção.</span><span class="sxs-lookup"><span data-stu-id="2a760-118">The **Scheduled Maintenance Window** is when Azure has scheduled your VMs for the maintenance.</span></span> <span data-ttu-id="2a760-119">Durante essa janela de tempo, que segue a janela de manutenção preemptiva, você pode ainda consultar a janela de manutenção, mas não será mais possível orquestrar a manutenção.</span><span class="sxs-lookup"><span data-stu-id="2a760-119">During this time window, which follows the pre-emptive maintenance window, you can still query for the maintenance window, but no longer be able to orchestrate the maintenance.</span></span>

## <a name="availability-considerations-during-planned-maintenance"></a><span data-ttu-id="2a760-120">Considerações sobre disponibilidade durante a manutenção planejada</span><span class="sxs-lookup"><span data-stu-id="2a760-120">Availability considerations during planned maintenance</span></span> 

### <a name="paired-regions"></a><span data-ttu-id="2a760-121">Regiões emparelhadas</span><span class="sxs-lookup"><span data-stu-id="2a760-121">Paired regions</span></span>

<span data-ttu-id="2a760-122">Cada região do Azure é emparelhada com outra região na mesma área geográfica, formando juntas um par regional.</span><span class="sxs-lookup"><span data-stu-id="2a760-122">Each Azure region is paired with another region within the same geography, together making a regional pair.</span></span> <span data-ttu-id="2a760-123">Ao executar a manutenção, o Azure atualizará apenas as instâncias de Máquina Virtual em uma única região de seu par.</span><span class="sxs-lookup"><span data-stu-id="2a760-123">When executing maintenance, Azure will only update the Virtual Machine instances in a single region of its pair.</span></span> <span data-ttu-id="2a760-124">Por exemplo, ao atualizar as Máquinas Virtuais no Centro-Norte dos EUA, o Azure não atualizará qualquer Máquina Virtual no Centro-Sul dos EUA ao mesmo tempo.</span><span class="sxs-lookup"><span data-stu-id="2a760-124">For example, when updating the Virtual Machines in North Central US, Azure will not update any Virtual Machines in South Central US at the same time.</span></span> <span data-ttu-id="2a760-125">Isso será agendado em outro momento, permitindo o failover ou o balanceamento de carga entre regiões.</span><span class="sxs-lookup"><span data-stu-id="2a760-125">This will be scheduled at a separate time, enabling failover or load balancing between regions.</span></span> <span data-ttu-id="2a760-126">No entanto, outras regiões, como o Norte da Europa, podem estar em manutenção simultaneamente com Leste dos EUA.</span><span class="sxs-lookup"><span data-stu-id="2a760-126">However, other regions such as North Europe can be under maintenance at the same time as East US.</span></span>
<span data-ttu-id="2a760-127">Leia mais sobre os [pares de regiões do Azure](https://docs.microsoft.com/azure/best-practices-availability-paired-regions).</span><span class="sxs-lookup"><span data-stu-id="2a760-127">Read more about [Azure region pairs](https://docs.microsoft.com/azure/best-practices-availability-paired-regions).</span></span>

### <a name="single-instance-vms-vs-availability-set-or-vm-scale-set"></a><span data-ttu-id="2a760-128">VMs de instância única versus conjunto de disponibilidade ou conjunto de dimensionamento de VMs</span><span class="sxs-lookup"><span data-stu-id="2a760-128">Single instance VMs vs. availability set or VM scale set</span></span>

<span data-ttu-id="2a760-129">Ao implantar uma carga de trabalho usando máquinas virtuais no Azure, é possível criar as VMs em um conjunto de disponibilidade para fornecer alta disponibilidade para o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="2a760-129">When deploying a workload using virtual machines in Azure, you can create the VMs within an availability set in order to provide high availability to your application.</span></span> <span data-ttu-id="2a760-130">Essa configuração garante que, durante uma interrupção ou eventos de manutenção, pelo menos uma máquina virtual estará disponível.</span><span class="sxs-lookup"><span data-stu-id="2a760-130">This configuration ensures that during either an outage or maintenance events, at least one virtual machine is available.</span></span>

<span data-ttu-id="2a760-131">Em um conjunto de disponibilidade, VMs individuais são distribuídas em até 20 domínios de atualização.</span><span class="sxs-lookup"><span data-stu-id="2a760-131">Within an availability set, individual VMs are spread across up to 20 update domains.</span></span> <span data-ttu-id="2a760-132">Durante a manutenção planejada, somente um único domínio de atualização é afetado em um período específico.</span><span class="sxs-lookup"><span data-stu-id="2a760-132">During planned maintenance, only a single update domain is impacted at any given time.</span></span> <span data-ttu-id="2a760-133">A ordem dos domínios de atualização afetados pode não continuar sequencialmente durante a manutenção planejada.</span><span class="sxs-lookup"><span data-stu-id="2a760-133">The order of update domains being impacted may not proceed sequentially during planned maintenance.</span></span> <span data-ttu-id="2a760-134">Para VMs de instância única (que não fazem parte do conjunto de disponibilidade), não é possível prever nem determinar quais e quantas VMs são afetadas em conjunto.</span><span class="sxs-lookup"><span data-stu-id="2a760-134">For single instance VMs (not part of availability set), there is no way to predict or determine which and how many VMs are impacted together.</span></span>

<span data-ttu-id="2a760-135">Os conjuntos de dimensionamento de máquinas virtuais são um recurso de computação do Azure que permite implantar e gerenciar um conjunto de VMs idênticas como um único recurso.</span><span class="sxs-lookup"><span data-stu-id="2a760-135">Virtual machine scale sets are an Azure compute resource that enables you to deploy and manage a set of identical VMs as a single resource.</span></span>
<span data-ttu-id="2a760-136">O conjunto de dimensionamento fornece garantias semelhantes a um conjunto de disponibilidade na forma de domínios de atualização.</span><span class="sxs-lookup"><span data-stu-id="2a760-136">The scale set provides similar guarantees to an availability set in the form of update domains.</span></span> 

<span data-ttu-id="2a760-137">Para obter mais informações sobre como configurar as máquinas virtuais para alta disponibilidade, consulte [*Gerenciar a disponibilidade das máquinas virtuais do Windows*](manage-availability.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="2a760-137">For more information about configuring your virtual machines for high availability, see [*Manage the availability of your Windows virtual machines*](manage-availability.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span></span>

### <a name="scheduled-events"></a><span data-ttu-id="2a760-138">Eventos agendados</span><span class="sxs-lookup"><span data-stu-id="2a760-138">Scheduled events</span></span>

<span data-ttu-id="2a760-139">O Serviço de Metadados do Azure permite descobrir informações sobre sua Máquina Virtual hospedada no Azure.</span><span class="sxs-lookup"><span data-stu-id="2a760-139">Azure Metadata Service enables you to discover information about your Virtual Machine hosted in Azure.</span></span> <span data-ttu-id="2a760-140">Eventos Agendados, uma das categorias expostas, revela informações sobre eventos futuros (por exemplo, de reinicialização) para que seu aplicativo possa se preparar para eles e limitar interrupções.</span><span class="sxs-lookup"><span data-stu-id="2a760-140">Scheduled Events, one of the exposed categories, surfaces information regarding upcoming events (for example, reboot) so your application can prepare for them and limit disruption.</span></span>

<span data-ttu-id="2a760-141">Para obter mais informações sobre eventos agendados, consulte [Serviço de Metadados do Azure – eventos agendados](../virtual-machines-scheduled-events.md).</span><span class="sxs-lookup"><span data-stu-id="2a760-141">For more information about scheduled events, refer to [Azure Metadata Service - Scheduled Events](../virtual-machines-scheduled-events.md).</span></span>

## <a name="maintenance-discovery-and-notifications"></a><span data-ttu-id="2a760-142">Descoberta de manutenção e notificações</span><span class="sxs-lookup"><span data-stu-id="2a760-142">Maintenance discovery and notifications</span></span>

<span data-ttu-id="2a760-143">O agendamento de manutenção é visível para os clientes nas VMs individuais.</span><span class="sxs-lookup"><span data-stu-id="2a760-143">Maintenance schedule is visible to customers at the level of individual VMs.</span></span> <span data-ttu-id="2a760-144">Você pode usar o portal do Azure, a API, o PowerShell ou a CLI para consultar as janelas de manutenção preemptiva e agendada.</span><span class="sxs-lookup"><span data-stu-id="2a760-144">You can use Azure portal, API, PowerShell, or CLI to query for the pre-emptive and scheduled maintenance windows.</span></span> <span data-ttu-id="2a760-145">Além disso, espere receber uma notificação (email) quando uma (ou mais) VMs forem afetadas durante o processo.</span><span class="sxs-lookup"><span data-stu-id="2a760-145">In addition, expect to receive a notification (email) in the case where one (or more) of your VMs are impacted during the process.</span></span>

<span data-ttu-id="2a760-146">As fases de manutenção preemptiva e agendada começam com uma notificação.</span><span class="sxs-lookup"><span data-stu-id="2a760-146">Both pre-emptive maintenance and scheduled maintenance phases begin with a notification.</span></span> <span data-ttu-id="2a760-147">Espere receber uma única notificação para cada assinatura do Azure.</span><span class="sxs-lookup"><span data-stu-id="2a760-147">Expect to receive a single notification per Azure subscription.</span></span> <span data-ttu-id="2a760-148">Por padrão, a notificação é enviada ao administrador e coadministrador da assinatura.</span><span class="sxs-lookup"><span data-stu-id="2a760-148">The notification is sent to the subscription’s admin and co-admin by default.</span></span> <span data-ttu-id="2a760-149">Você também pode configurar o público-alvo da notificação de manutenção.</span><span class="sxs-lookup"><span data-stu-id="2a760-149">You can also configure the audience for the maintenance notification.</span></span>

### <a name="view-the-maintenance-window-in-the-portal"></a><span data-ttu-id="2a760-150">Exibir a Janela de Manutenção no portal</span><span class="sxs-lookup"><span data-stu-id="2a760-150">View the maintenance window in the portal</span></span> 

<span data-ttu-id="2a760-151">É possível usar o portal do Azure e procurar as VMs agendadas para manutenção.</span><span class="sxs-lookup"><span data-stu-id="2a760-151">You can use the Azure portal and look for VMs scheduled for maintenance.</span></span>

1.  <span data-ttu-id="2a760-152">Entre no Portal do Azure.</span><span class="sxs-lookup"><span data-stu-id="2a760-152">Sign in to the Azure portal.</span></span>

2.  <span data-ttu-id="2a760-153">Clique e abra a folha **Máquinas Virtuais**.</span><span class="sxs-lookup"><span data-stu-id="2a760-153">Click and open the **Virtual Machines** blade.</span></span>

3.  <span data-ttu-id="2a760-154">Clique no botão **Colunas** para abrir a lista de colunas disponíveis para seleção</span><span class="sxs-lookup"><span data-stu-id="2a760-154">Click the **Columns** button to open the list of available columns to choose from</span></span>

4.  <span data-ttu-id="2a760-155">Selecione e adicione as colunas **Janela de Manutenção**.</span><span class="sxs-lookup"><span data-stu-id="2a760-155">Select and add the **Maintenance Window** columns.</span></span> <span data-ttu-id="2a760-156">As VMs agendadas para manutenção têm as janelas de manutenção exibidas.</span><span class="sxs-lookup"><span data-stu-id="2a760-156">VMs that are scheduled for maintenance have the maintenance windows surfaced.</span></span> <span data-ttu-id="2a760-157">Depois que a manutenção é concluída ou anulada para uma, a janela de manutenção não é mais apresentada.</span><span class="sxs-lookup"><span data-stu-id="2a760-157">Once maintenance is completed or aborted for a, the maintenance window is no longer be presented.</span></span>

### <a name="query-maintenance-details-using-the-azure-api"></a><span data-ttu-id="2a760-158">Consultar detalhes da manutenção usando a API do Azure</span><span class="sxs-lookup"><span data-stu-id="2a760-158">Query maintenance details using the Azure API</span></span>

<span data-ttu-id="2a760-159">Use a [API Obter Informações da VM](https://docs.microsoft.com/rest/api/compute/virtualmachines/virtualmachines-get) e procure a exibição da instância para descobrir os detalhes de manutenção de uma VM individual.</span><span class="sxs-lookup"><span data-stu-id="2a760-159">Use the [get VM information API](https://docs.microsoft.com/rest/api/compute/virtualmachines/virtualmachines-get) and look for the instance view to discover the maintenance details on an individual VM.</span></span> <span data-ttu-id="2a760-160">A resposta inclui os seguintes elementos:</span><span class="sxs-lookup"><span data-stu-id="2a760-160">The response includes the following elements:</span></span>

  - <span data-ttu-id="2a760-161">isCustomerInitiatedMaintenanceAllowed: indica se agora você pode iniciar a reimplantação preemptiva na VM.</span><span class="sxs-lookup"><span data-stu-id="2a760-161">isCustomerInitiatedMaintenanceAllowed: Indicates whether you can now initiate pre-emptive redeploy on the VM.</span></span>

  - <span data-ttu-id="2a760-162">preMaintenanceWindowStartTime: a hora de início da janela de manutenção preemptiva.</span><span class="sxs-lookup"><span data-stu-id="2a760-162">preMaintenanceWindowStartTime: The start time of the pre-emptive maintenance window.</span></span>

  - <span data-ttu-id="2a760-163">preMaintenanceWindowEndTime: a hora de término da janela de manutenção preemptiva.</span><span class="sxs-lookup"><span data-stu-id="2a760-163">preMaintenanceWindowEndTime: The end time of the pre-emptive maintenance window.</span></span> <span data-ttu-id="2a760-164">Após esse período, você não poderá mais iniciar a manutenção nessa VM.</span><span class="sxs-lookup"><span data-stu-id="2a760-164">After this time, you will no longer be able to initiate maintenance on this VM.</span></span>
    
  - <span data-ttu-id="2a760-165">maintenanceWindowStartTime: a hora de início da janela de manutenção agendada quando a VM é afetada.</span><span class="sxs-lookup"><span data-stu-id="2a760-165">maintenanceWindowStartTime: The start time of the scheduled maintenance window when your VM are impacted.</span></span>

  - <span data-ttu-id="2a760-166">maintenanceWindowEndTime: a hora de término da janela de manutenção agendada.</span><span class="sxs-lookup"><span data-stu-id="2a760-166">maintenanceWindowEndTime: The end time of the scheduled maintenance window.</span></span>
  
  - <span data-ttu-id="2a760-167">lastOperationResultCode: o resultado da última operação de Manutenção-Reimplantação.</span><span class="sxs-lookup"><span data-stu-id="2a760-167">lastOperationResultCode: The result of your last Maintenance-Redeploy operation.</span></span>
 
  - <span data-ttu-id="2a760-168">lastOperationMessage: uma mensagem que descreve o resultado da última operação de Manutenção-Reimplantação.</span><span class="sxs-lookup"><span data-stu-id="2a760-168">lastOperationMessage:  Message describing the result of your last Maintenance-Redeploy operation.</span></span>


## <a name="pre-emptive-redeploy"></a><span data-ttu-id="2a760-169">Reimplantação preemptiva</span><span class="sxs-lookup"><span data-stu-id="2a760-169">Pre-emptive redeploy</span></span>

<span data-ttu-id="2a760-170">A ação de reimplantação preemptiva fornece a flexibilidade para controlar o período em que a manutenção é aplicada às VMs no Azure.</span><span class="sxs-lookup"><span data-stu-id="2a760-170">Pre-emptive redeploy action provides the flexibility to control the time when maintenance is applied to your VMs in Azure.</span></span> <span data-ttu-id="2a760-171">A manutenção planejada começa com uma janela de manutenção preemptiva, em que é possível decidir sobre o tempo exato de reinicialização de cada uma das VMs.</span><span class="sxs-lookup"><span data-stu-id="2a760-171">Planned maintenance begins with a pre-emptive maintenance window where you can decide on the exact time for each of your VMs to be rebooted.</span></span> <span data-ttu-id="2a760-172">Estes são os casos de uso em que uma funcionalidade desse tipo é útil:</span><span class="sxs-lookup"><span data-stu-id="2a760-172">The following are use cases where such a functionality is useful:</span></span>

-   <span data-ttu-id="2a760-173">A manutenção precisa ser coordenada com o cliente final.</span><span class="sxs-lookup"><span data-stu-id="2a760-173">Maintenance need to be coordinated with the end customer.</span></span>

-   <span data-ttu-id="2a760-174">A janela de manutenção agendada oferecida pelo Azure não é suficiente.</span><span class="sxs-lookup"><span data-stu-id="2a760-174">The scheduled maintenance window offered by Azure is not sufficient.</span></span>
    <span data-ttu-id="2a760-175">É possível que a janela esteja no período mais ocupado da semana ou seja muito longa.</span><span class="sxs-lookup"><span data-stu-id="2a760-175">It could be that the window happens to be on the busiest time of the week or it is too long.</span></span>

-   <span data-ttu-id="2a760-176">Para aplicativos de várias instâncias ou camadas, você precisa ter tempo suficiente entre duas VMs ou determinada sequência a ser seguida.</span><span class="sxs-lookup"><span data-stu-id="2a760-176">For multi-instance or multi-tier applications, you need sufficient time between two VMs or a certain sequence to follow.</span></span>

<span data-ttu-id="2a760-177">Ao chamar a reimplantação preemptiva em uma VM, ela move a VM para um nó já atualizado e, em seguida, a liga novamente, mantendo todas as opções de configuração e os recursos associados.</span><span class="sxs-lookup"><span data-stu-id="2a760-177">When you call for pre-emptive redeploy on a VM, it moves the VM to an already updated node and then powers it back on, retaining all your configuration options and associated resources.</span></span> <span data-ttu-id="2a760-178">Ao fazer isso, o disco temporário é perdido e os endereços IP dinâmicos associados ao adaptador de rede virtual são atualizados.</span><span class="sxs-lookup"><span data-stu-id="2a760-178">While doing so, the temporary disk is lost and dynamic IP addresses associated with virtual network interface are updated.</span></span>

<span data-ttu-id="2a760-179">A reimplantação preemptiva é habilitada uma vez por VM.</span><span class="sxs-lookup"><span data-stu-id="2a760-179">Pre-emptive redeploy is enabled once per VM.</span></span> <span data-ttu-id="2a760-180">Em caso de erro durante o processo, a operação é anulada, a VM não é afetada e ela é excluída da iteração da manutenção planejada.</span><span class="sxs-lookup"><span data-stu-id="2a760-180">If there is an error during the process, the operation is aborted, the VM is not impacted and it is excluded from the planned maintenance iteration.</span></span> <span data-ttu-id="2a760-181">Você será contatado em um momento posterior com um novo agendamento e receberá uma nova oportunidade para agendar e sequenciar o impacto nas VMs.</span><span class="sxs-lookup"><span data-stu-id="2a760-181">You will be contacted in a later time with a new schedule and offered a new opportunity to schedule and sequence the impact on your VMs.</span></span>
