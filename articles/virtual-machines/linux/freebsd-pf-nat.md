---
title: toocreate de filtro de pacote do aaaUse FreeBSD um firewall no Azure | Microsoft Docs
description: Saiba como toodeploy um NAT firewall usando do FreeBSD PF no Azure.
services: virtual-machines-linux
documentationcenter: 
author: KylieLiang
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 
ms.service: virtual-machines-linux
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-linux
ms.workload: infrastructure-services
ms.date: 02/20/2017
ms.author: kyliel
ms.openlocfilehash: 3d3a5dde2ca03ba6fc384581c786f5eb746e6d92
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="how-toouse-freebsds-packet-filter-toocreate-a-secure-firewall-in-azure"></a><span data-ttu-id="33c83-103">Como toocreate de filtro de pacote do toouse FreeBSD um firewall seguro no Azure</span><span class="sxs-lookup"><span data-stu-id="33c83-103">How toouse FreeBSD's Packet Filter toocreate a secure firewall in Azure</span></span>
<span data-ttu-id="33c83-104">Este artigo apresenta como toodeploy um firewall NAT usando Packer filtro do FreeBSD por meio do modelo do Gerenciador de recursos do Azure para o cenário de servidor da web comuns.</span><span class="sxs-lookup"><span data-stu-id="33c83-104">This article introduces how toodeploy a NAT firewall using FreeBSD’s Packer Filter through Azure Resource Manager template for common web server scenario.</span></span>

## <a name="what-is-pf"></a><span data-ttu-id="33c83-105">O que é o PF?</span><span class="sxs-lookup"><span data-stu-id="33c83-105">What is PF?</span></span>
<span data-ttu-id="33c83-106">PF (Filtro de Pacote, também grafado pf) é um filtro de pacote com estado licenciado BSD, uma parte central do software de firewall.</span><span class="sxs-lookup"><span data-stu-id="33c83-106">PF (Packet Filter, also written pf) is a BSD licensed stateful packet filter, a central piece of software for firewalling.</span></span> <span data-ttu-id="33c83-107">Desde então, o PF evoluiu rapidamente e agora apresenta várias vantagens sobre outros firewalls disponíveis.</span><span class="sxs-lookup"><span data-stu-id="33c83-107">PF has since evolved quickly and now has several advantages over other available firewalls.</span></span> <span data-ttu-id="33c83-108">Conversão de endereço de rede (NAT) está em PF desde o primeiro dia, em seguida, o Agendador de pacotes e gerenciamento de fila ativa foram integradas ao PF, integrando Olá ALTQ e tornando configuráveis por meio da configuração do PF.</span><span class="sxs-lookup"><span data-stu-id="33c83-108">Network Address Translation (NAT) is in PF since day one, then packet scheduler and active queue management have been integrated into PF, by integrating hello ALTQ and making it configurable through PF's configuration.</span></span> <span data-ttu-id="33c83-109">Recursos como pfsync e CARP para failover e redundância, authpf para autenticação de sessão e proxy ftp tooease firewall Olá difícil protocolo FTP, também tem estendido PF.</span><span class="sxs-lookup"><span data-stu-id="33c83-109">Features such as pfsync and CARP for failover and redundancy, authpf for session authentication, and ftp-proxy tooease firewalling hello difficult FTP protocol, have also extended PF.</span></span> <span data-ttu-id="33c83-110">Em resumo, o PF é um firewall avançado e repleto de recursos.</span><span class="sxs-lookup"><span data-stu-id="33c83-110">In short, PF is a powerful and feature-rich firewall.</span></span> 

## <a name="get-started"></a><span data-ttu-id="33c83-111">Introdução</span><span class="sxs-lookup"><span data-stu-id="33c83-111">Get started</span></span>
<span data-ttu-id="33c83-112">Se você estiver interessado em configurar um firewall seguro na nuvem Olá para seus servidores web, vamos começar.</span><span class="sxs-lookup"><span data-stu-id="33c83-112">If you are interested in setting up a secure firewall in hello cloud for your web servers, then let’s get started.</span></span> <span data-ttu-id="33c83-113">Você também pode aplicar scripts Olá usados neste tooset de modelo do Azure Resource Manager sua topologia de rede.</span><span class="sxs-lookup"><span data-stu-id="33c83-113">You can also apply hello scripts used in this Azure Resource Manager template tooset up your networking topology.</span></span>
<span data-ttu-id="33c83-114">modelo do Gerenciador de recursos do Azure Olá configurar uma máquina virtual de FreeBSD que executa /redirection NAT usando PF duas máquinas virtuais e FreeBSD com o servidor de web de Nginx Olá instalado e configurado.</span><span class="sxs-lookup"><span data-stu-id="33c83-114">hello Azure Resource Manager template set up a FreeBSD virtual machine that performs NAT /redirection using PF and two FreeBSD virtual machines with hello Nginx web server installed and configured.</span></span> <span data-ttu-id="33c83-115">Além disso, tooperforming NAT para os dois servidores de web hello saída tráfego, Olá redirecionamento/NAT virtual machine intercepta solicitações HTTP e redirecioná-los toohello dois servidores web no modo round robin.</span><span class="sxs-lookup"><span data-stu-id="33c83-115">In addition tooperforming NAT for hello two web servers egress traffic, hello NAT/redirection virtual machine intercepts HTTP requests and redirect them toohello two web servers in round-robin fashion.</span></span> <span data-ttu-id="33c83-116">Olá VNet usa Olá privada não roteáveis IP endereço espaço 10.0.0.2/24 e você pode modificar os parâmetros de saudação do modelo de saudação.</span><span class="sxs-lookup"><span data-stu-id="33c83-116">hello VNet uses hello private non-routable IP address space 10.0.0.2/24 and you can modify hello parameters of hello template.</span></span> <span data-ttu-id="33c83-117">modelo do Gerenciador de recursos do Azure Olá também define uma tabela de rotas para Olá VNet inteira, que é uma coleção de rotas individuais usadas toooverride rotas de padrão do Azure com base no endereço IP de destino hello.</span><span class="sxs-lookup"><span data-stu-id="33c83-117">hello Azure Resource Manager template also defines a route table for hello whole VNet, which is a collection of individual routes used toooverride Azure default routes based on hello destination IP address.</span></span> 

![pf_topology](./media/freebsd-pf-nat/pf_topology.jpg)
    
### <a name="deploy-through-azure-cli"></a><span data-ttu-id="33c83-119">Implantar por meio da CLI do Azure</span><span class="sxs-lookup"><span data-stu-id="33c83-119">Deploy through Azure CLI</span></span>
<span data-ttu-id="33c83-120">Você precisa hello mais recente [2.0 do CLI do Azure](/cli/azure/install-az-cli2) instalado e conectado através de conta do Azure tooan [logon az](/cli/azure/#login).</span><span class="sxs-lookup"><span data-stu-id="33c83-120">You need hello latest [Azure CLI 2.0](/cli/azure/install-az-cli2) installed and logged in tooan Azure account using [az login](/cli/azure/#login).</span></span> <span data-ttu-id="33c83-121">Crie um grupo de recursos com [az group create](/cli/azure/group#create).</span><span class="sxs-lookup"><span data-stu-id="33c83-121">Create a resource group with [az group create](/cli/azure/group#create).</span></span> <span data-ttu-id="33c83-122">Olá, exemplo a seguir cria um nome de grupo de recursos `myResourceGroup` em Olá `West US` local.</span><span class="sxs-lookup"><span data-stu-id="33c83-122">hello following example creates a resource group name `myResourceGroup` in hello `West US` location.</span></span>

```azurecli
az group create --name myResourceGroup --location westus
```

<span data-ttu-id="33c83-123">Em seguida, implante o modelo Olá [pf-freebsd-setup](https://github.com/Azure/azure-quickstart-templates/tree/master/pf-freebsd-setup) com [criar implantação de grupo az](/cli/azure/group/deployment#create).</span><span class="sxs-lookup"><span data-stu-id="33c83-123">Next, deploy hello template [pf-freebsd-setup](https://github.com/Azure/azure-quickstart-templates/tree/master/pf-freebsd-setup) with [az group deployment create](/cli/azure/group/deployment#create).</span></span> <span data-ttu-id="33c83-124">Baixar [azuredeploy.parameters.json](https://github.com/Azure/azure-quickstart-templates/blob/master/pf-freebsd-setup/azuredeploy.parameters.json) em Olá mesmo caminho e definir seus próprios valores de recursos, tais como `adminPassword`, `networkPrefix`, e `domainNamePrefix`.</span><span class="sxs-lookup"><span data-stu-id="33c83-124">Download [azuredeploy.parameters.json](https://github.com/Azure/azure-quickstart-templates/blob/master/pf-freebsd-setup/azuredeploy.parameters.json) under hello same path and define your own resource values, such as `adminPassword`, `networkPrefix`, and `domainNamePrefix`.</span></span> 

```azurecli
az group deployment create --resource-group myResourceGroup --name myDeploymentName \
    --template-uri https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/pf-freebsd-setup/azuredeploy.json \
    --parameters '@azuredeploy.parameters.json' --verbose
```

<span data-ttu-id="33c83-125">Depois de cerca de cinco minutos, você obterá informações de saudação do `"provisioningState": "Succeeded"`.</span><span class="sxs-lookup"><span data-stu-id="33c83-125">After about five minutes, you will get hello information of `"provisioningState": "Succeeded"`.</span></span> <span data-ttu-id="33c83-126">Em seguida, você pode ssh toohello front-end VM (NAT) ou acessar o servidor de web Nginx em um navegador usando o endereço IP público de saudação ou FQDN de front-end Olá VM (NAT).</span><span class="sxs-lookup"><span data-stu-id="33c83-126">Then you can ssh toohello frontend VM (NAT) or access Nginx web server in a browser using hello public IP address or FQDN of hello frontend VM (NAT).</span></span> <span data-ttu-id="33c83-127">Olá exemplo a seguir lista FQDN e o endereço IP público atribuído toohello frontend VM (NAT) em Olá `myResourceGroup` grupo de recursos.</span><span class="sxs-lookup"><span data-stu-id="33c83-127">hello following example lists FQDN and public IP address that assigned toohello frontend VM (NAT) in hello `myResourceGroup` resource group.</span></span> 

```azurecli
az network public-ip list --resource-group myResourceGroup
```
    
## <a name="next-steps"></a><span data-ttu-id="33c83-128">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="33c83-128">Next steps</span></span>
<span data-ttu-id="33c83-129">Você deseja tooset a sua própria NAT no Azure?</span><span class="sxs-lookup"><span data-stu-id="33c83-129">Do you want tooset up your own NAT in Azure?</span></span> <span data-ttu-id="33c83-130">Software Livre: gratuito mas eficiente?</span><span class="sxs-lookup"><span data-stu-id="33c83-130">Open Source, free but powerful?</span></span> <span data-ttu-id="33c83-131">Portanto, o PF é uma boa opção.</span><span class="sxs-lookup"><span data-stu-id="33c83-131">Then PF is a good choice.</span></span> <span data-ttu-id="33c83-132">Usando o modelo de saudação [pf-freebsd-setup](https://github.com/Azure/azure-quickstart-templates/tree/master/pf-freebsd-setup), você só precisa de cinco minutos tooset um firewall NAT com o uso do FreeBSD de balanceamento de carga de round-robin PF no Azure para o cenário de servidor da web comuns.</span><span class="sxs-lookup"><span data-stu-id="33c83-132">By using hello template [pf-freebsd-setup](https://github.com/Azure/azure-quickstart-templates/tree/master/pf-freebsd-setup), you only need five minutes tooset up a NAT firewall with round-robin load balancing using FreeBSD's PF in Azure for common web server scenario.</span></span> 

<span data-ttu-id="33c83-133">Se você quiser toolearn oferta de saudação do FreeBSD no Azure, consulte muito[tooFreeBSD de Introdução no Azure](freebsd-intro-on-azure.md).</span><span class="sxs-lookup"><span data-stu-id="33c83-133">If you want toolearn hello offering of FreeBSD in Azure, refer too[introduction tooFreeBSD on Azure](freebsd-intro-on-azure.md).</span></span>

<span data-ttu-id="33c83-134">Se você quiser tooknow mais sobre PF, consulte muito[FreeBSD manual](https://www.freebsd.org/doc/handbook/firewalls-pf.html) ou [guia do usuário do-PF](https://www.freebsd.org/doc/handbook/firewalls-pf.html).</span><span class="sxs-lookup"><span data-stu-id="33c83-134">If you want tooknow more about PF, refer too[FreeBSD handbook](https://www.freebsd.org/doc/handbook/firewalls-pf.html) or [PF-User's Guide](https://www.freebsd.org/doc/handbook/firewalls-pf.html).</span></span>
