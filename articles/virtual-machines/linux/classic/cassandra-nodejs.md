---
title: aaaRun Cassandra com Linux no Azure | Microsoft Docs
description: "Como toorun um Cassandra cluster no Linux em máquinas virtuais do Azure de um aplicativo Node. js"
services: virtual-machines-linux
documentationcenter: nodejs
author: tomarcher
manager: routlaw
editor: 
tags: azure-service-management
ms.assetid: 30de1f29-e97d-492f-ae34-41ec83488de0
ms.service: virtual-machines-linux
ms.workload: infrastructure-services
ms.tgt_pltfrm: vm-linux
ms.devlang: na
ms.topic: article
ms.date: 08/17/2017
ms.author: tarcher
ms.openlocfilehash: 381ca301bbe88d3740cf182f9c44fada5b9ba7cc
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="running-cassandra-with-linux-on-azure-and-accessing-it-from-nodejs"></a><span data-ttu-id="2efa3-103">Executando Cassandra com Linux no Azure e acessando-a do Node.js</span><span class="sxs-lookup"><span data-stu-id="2efa3-103">Running Cassandra with Linux on Azure and Accessing it from Node.js</span></span>
> [!IMPORTANT] 
> <span data-ttu-id="2efa3-104">O Azure tem dois modelos de implantação diferentes para criar e trabalhar com recursos: [Gerenciador de Recursos e Clássico](../../../resource-manager-deployment-model.md).</span><span class="sxs-lookup"><span data-stu-id="2efa3-104">Azure has two different deployment models for creating and working with resources: [Resource Manager and Classic](../../../resource-manager-deployment-model.md).</span></span> <span data-ttu-id="2efa3-105">Este artigo aborda usando o modelo de implantação clássico hello.</span><span class="sxs-lookup"><span data-stu-id="2efa3-105">This article covers using hello Classic deployment model.</span></span> <span data-ttu-id="2efa3-106">A Microsoft recomenda que mais novas implantações de usam o modelo do Gerenciador de recursos de saudação.</span><span class="sxs-lookup"><span data-stu-id="2efa3-106">Microsoft recommends that most new deployments use hello Resource Manager model.</span></span> <span data-ttu-id="2efa3-107">Consulte modelos do Resource Manager para [Datastax Enterprise](https://azure.microsoft.com/documentation/templates/datastax) e [Cluster Spark e Cassandra CentOS](https://azure.microsoft.com/documentation/templates/spark-and-cassandra-on-centos/).</span><span class="sxs-lookup"><span data-stu-id="2efa3-107">See Resource Manager templates for [Datastax Enterprise](https://azure.microsoft.com/documentation/templates/datastax) and [Spark cluster and Cassandra on CentOS](https://azure.microsoft.com/documentation/templates/spark-and-cassandra-on-centos/).</span></span>

## <a name="overview"></a><span data-ttu-id="2efa3-108">Visão geral</span><span class="sxs-lookup"><span data-stu-id="2efa3-108">Overview</span></span>
<span data-ttu-id="2efa3-109">O Microsoft Azure é uma plataforma de nuvem aberta que executa tanto os softwares da Microsoft quanto os não pertencentes à Microsoft, que inclui sistemas operacionais, servidores de aplicativos, middlewares de mensagens, bem como bancos de dados SQL e NoSQL de ambos os modelos de software livre e comercial.</span><span class="sxs-lookup"><span data-stu-id="2efa3-109">Microsoft Azure is an open cloud platform that runs both Microsoft as well as non-Microsoft software which  includes operating systems, application servers, messaging middleware as well as SQL and NoSQL databases from both commercial and open source models.</span></span> <span data-ttu-id="2efa3-110">A criação de serviços resilientes em nuvens públicas, incluindo o Azure, requer um planejamento cuidadoso e uma arquitetura deliberada para ambos os servidores de aplicativos, bem como camadas de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="2efa3-110">Building resilient services on public clouds including Azure requires careful planning and deliberate architecture for both applications servers as well storage layers.</span></span> <span data-ttu-id="2efa3-111">A arquitetura de armazenamento distribuída de Cassandra naturalmente ajuda na criação de sistemas altamente disponíveis que são tolerantes a falhas para as falhas de cluster.</span><span class="sxs-lookup"><span data-stu-id="2efa3-111">Cassandra’s distributed storage architecture naturally helps in building highly available systems that are fault tolerant for cluster failures.</span></span> <span data-ttu-id="2efa3-112">Cassandra é um banco de dados NoSQL de escala na nuvem mantido pela Apache Software Foundation em cassandra.apache.org; Cassandra é escrito em Java e, portanto, pode ser executado em ambas as plataformas Windows e Linux.</span><span class="sxs-lookup"><span data-stu-id="2efa3-112">Cassandra is a cloud scale NoSQL database maintained by Apache Software Foundation at cassandra.apache.org; Cassandra is written in Java and hence runs on both on Windows as well as Linux platforms.</span></span>

<span data-ttu-id="2efa3-113">foco Olá deste artigo é implantação de Cassandra tooshow no Ubuntu como um cluster único e vários data center utilizando máquinas virtuais do Microsoft Azure e redes virtuais.</span><span class="sxs-lookup"><span data-stu-id="2efa3-113">hello focus of this article is tooshow Cassandra deployment on Ubuntu as a single and multi-data center cluster leveraging Microsoft Azure Virtual Machines and Virtual Networks.</span></span> <span data-ttu-id="2efa3-114">Hello implantação de cluster para cargas de trabalho de produção otimização está fora do escopo deste artigo conforme ele requer a configuração de nó em vários discos, Olá toosupport de modelagem de dados e de design da topologia de anel apropriado necessário replicação, a consistência dos dados, a taxa de transferência e requisitos de alta disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="2efa3-114">hello cluster deployment for production optimized workloads is out of scope of this article as it requires multi-disk node configuration, appropriate ring topology design and data modeling toosupport hello needed replication, data consistency, throughput and high availability requirements.</span></span>

<span data-ttu-id="2efa3-115">Essa demora artigo tooshow uma abordagem fundamental que o que está envolvido na criação Olá cluster Cassandra em comparação com Docker, Chef ou Puppet que pode tornar Olá muito mais fácil de implantação de infraestrutura.</span><span class="sxs-lookup"><span data-stu-id="2efa3-115">This article takes a fundamental approach tooshow what is involved in building hello Cassandra cluster compared Docker, Chef or Puppet which can make hello infrastructure deployment a lot easier.</span></span>  

## <a name="hello-deployment-models"></a><span data-ttu-id="2efa3-116">Olá modelos de implantação</span><span class="sxs-lookup"><span data-stu-id="2efa3-116">hello Deployment Models</span></span>
<span data-ttu-id="2efa3-117">Rede do Microsoft Azure permite que a implantação Olá de clusters privadas isolados, acesso de saudação do qual pode ser restrito tooattain fina rede refinada segurança.</span><span class="sxs-lookup"><span data-stu-id="2efa3-117">Microsoft Azure networking allows hello deployment of isolated private clusters, hello access of which can be restricted tooattain fine grained network security.</span></span>  <span data-ttu-id="2efa3-118">Como este artigo é sobre a implantação de Cassandra Olá em um nível fundamental de exibição, nos concentraremos não em nível de consistência hello e design de armazenamento ideal de saudação para taxa de transferência.</span><span class="sxs-lookup"><span data-stu-id="2efa3-118">Since this article is about showing hello Cassandra deployment at a fundamental level, we will not focus on hello consistency level and hello optimal storage design for throughput.</span></span> <span data-ttu-id="2efa3-119">Aqui está a lista de saudação de requisitos de rede para nosso cluster hipotético:</span><span class="sxs-lookup"><span data-stu-id="2efa3-119">Here is hello list of networking requirements for our hypothetical cluster:</span></span>

* <span data-ttu-id="2efa3-120">Os sistemas externos não podem acessar o banco de dados de Cassandra desde dentro ou fora do Azure</span><span class="sxs-lookup"><span data-stu-id="2efa3-120">External systems can’t access Cassandra database from within or outside Azure</span></span>
* <span data-ttu-id="2efa3-121">Cluster Cassandra tem toobe atrás de um balanceador de carga para tráfego thrift</span><span class="sxs-lookup"><span data-stu-id="2efa3-121">Cassandra cluster has toobe behind a load balancer for thrift traffic</span></span>
* <span data-ttu-id="2efa3-122">Implantar nós de Cassandra em dois grupos em cada data center para uma disponibilidade de cluster aprimorada</span><span class="sxs-lookup"><span data-stu-id="2efa3-122">Deploy Cassandra nodes in two groups in each data center for an enhanced cluster availability</span></span>
* <span data-ttu-id="2efa3-123">Bloquear o cluster Olá assim que somente o farm de servidores de aplicativo tem o banco de dados do access toohello diretamente</span><span class="sxs-lookup"><span data-stu-id="2efa3-123">Lock down hello cluster so that only application server farm has access toohello database directly</span></span>
* <span data-ttu-id="2efa3-124">Nenhum ponto de extremidade de rede pública diferente de SSH</span><span class="sxs-lookup"><span data-stu-id="2efa3-124">No public networking endpoints other than SSH</span></span>
* <span data-ttu-id="2efa3-125">Cada nó de Cassandra precisa de um endereço IP interno fixo</span><span class="sxs-lookup"><span data-stu-id="2efa3-125">Each Cassandra node needs a fixed internal IP address</span></span>

<span data-ttu-id="2efa3-126">Cassandra pode ser implantado tooa única região do Azure ou regiões toomultiple com base na natureza Olá distribuída de carga de trabalho de saudação.</span><span class="sxs-lookup"><span data-stu-id="2efa3-126">Cassandra can be deployed tooa single Azure region or toomultiple regions based on hello distributed nature of hello workload.</span></span> <span data-ttu-id="2efa3-127">Modelo de implantação de várias regiões pode ser utilizado tooserve os usuários finais mais tooa específico geografia por meio de saudação mesma infraestrutura Cassandra.</span><span class="sxs-lookup"><span data-stu-id="2efa3-127">Multi-region deployment model can be leveraged tooserve end users closer tooa particular geography through hello same Cassandra infrastructure.</span></span> <span data-ttu-id="2efa3-128">Nó interno replicação cuida do Cassandra da sincronização de saudação de vários mestres grava provenientes de vários data centers e apresenta uma exibição consistente de saudação tooapplications de dados.</span><span class="sxs-lookup"><span data-stu-id="2efa3-128">Cassandra’s built-in node replication takes care of hello synchronization of multi-master writes originating from multiple data centers and presents a consistent view of hello data tooapplications.</span></span> <span data-ttu-id="2efa3-129">Implantação de várias regiões também pode ajudar com a redução de riscos de saudação de interrupções de serviço do Azure mais ampla hello.</span><span class="sxs-lookup"><span data-stu-id="2efa3-129">Multi-region deployment can also help with hello risk mitigation of hello broader Azure service outages.</span></span> <span data-ttu-id="2efa3-130">A consistência ajustável e a replicação de topologia de Cassandra ajudará a atender às diversas necessidades de RPO dos aplicativos.</span><span class="sxs-lookup"><span data-stu-id="2efa3-130">Cassandra’s tunable consistency and replication topology will help in meeting diverse RPO needs of applications.</span></span>

### <a name="single-region-deployment"></a><span data-ttu-id="2efa3-131">Implantação de região única</span><span class="sxs-lookup"><span data-stu-id="2efa3-131">Single Region Deployment</span></span>
<span data-ttu-id="2efa3-132">Vamos começar com uma implantação de região única e coleta Olá conhecimentos na criação de um modelo de várias regiões.</span><span class="sxs-lookup"><span data-stu-id="2efa3-132">We will start with a single region deployment and harvest hello learnings in creating a multi-region model.</span></span> <span data-ttu-id="2efa3-133">Rede virtual do Azure será usado toocreate isolada sub-redes para que os requisitos de segurança de rede Olá mencionados acima podem ser atendidos.</span><span class="sxs-lookup"><span data-stu-id="2efa3-133">Azure virtual networking will be used toocreate isolated subnets so that hello network security requirements mentioned above can be met.</span></span>  <span data-ttu-id="2efa3-134">processo de saudação descrito na criação de implantação de região única Olá usa Ubuntu 14.04 LTS e Cassandra 2.08; No entanto, o processo de saudação pode facilmente ser adotada toohello outras variantes do Linux.</span><span class="sxs-lookup"><span data-stu-id="2efa3-134">hello process described in creating hello single region deployment uses Ubuntu 14.04 LTS and Cassandra 2.08; however, hello process can easily be adopted toohello other Linux variants.</span></span> <span data-ttu-id="2efa3-135">Olá seguem algumas das características de saudação sistemático de implantação de região única hello.</span><span class="sxs-lookup"><span data-stu-id="2efa3-135">hello following are some of hello systemic characteristics of hello single region deployment.</span></span>  

<span data-ttu-id="2efa3-136">**Alta disponibilidade:** Olá nós Cassandra mostradas Olá Figura 1 são implantados conjuntos de disponibilidade de tootwo para que nós Olá são distribuídos entre vários domínios de falha para alta disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="2efa3-136">**High Availability:** hello Cassandra nodes shown in hello Figure 1 are deployed tootwo availability sets so that hello nodes are spread between multiple fault domains for high availability.</span></span> <span data-ttu-id="2efa3-137">VMs anotadas com cada conjunto de disponibilidade é mapeada too2 domínios de falha.</span><span class="sxs-lookup"><span data-stu-id="2efa3-137">VMs annotated with each availability set is mapped too2 fault domains.</span></span>  <span data-ttu-id="2efa3-138">Microsoft Azure usa Olá conceito de toomanage de domínio de falhas não planejada para baixo de tempo (por exemplo, falhas de hardware ou software) ao conceito de saudação do domínio de atualização (por exemplo, o host ou convidado patches/atualizações do SO, atualizações de aplicativo) é usado para gerenciar agendado tempo de inatividade.</span><span class="sxs-lookup"><span data-stu-id="2efa3-138">Microsoft Azure uses hello concept of fault domain toomanage unplanned down time (e.g. hardware or software failures) while hello concept of upgrade domain (e.g. host or guest OS patching/upgrades, application upgrades) is used for managing scheduled down time.</span></span> <span data-ttu-id="2efa3-139">Consulte [recuperação de desastres e alta disponibilidade para aplicativos do Azure](http://msdn.microsoft.com/library/dn251004.aspx) para a função hello de domínios de falha e atualização na obtenção de alta disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="2efa3-139">Please see [Disaster Recovery and High Availability for Azure Applications](http://msdn.microsoft.com/library/dn251004.aspx) for hello role of fault and upgrade domains in attaining high availability.</span></span>

![Implantação de região única](./media/cassandra-nodejs/cassandra-linux1.png)

<span data-ttu-id="2efa3-141">Figura 1: implantação de região única</span><span class="sxs-lookup"><span data-stu-id="2efa3-141">Figure 1: Single region deployment</span></span>

<span data-ttu-id="2efa3-142">Observe que, no tempo de saudação da redação deste artigo, Azure não permite mapeamento explícito de saudação de um grupo de domínio de falha específico de tooa de VMs; Portanto, mesmo com o modelo de implantação Olá mostrado na Figura 1, é estatisticamente provável que todas as máquinas virtuais de saudação pode ser mapeado tootwo domínios de falha em vez de quatro.</span><span class="sxs-lookup"><span data-stu-id="2efa3-142">Note that at hello time of this writing, Azure doesn’t allow hello explicit mapping of a group of VMs tooa specific fault domain; consequently, even with hello deployment model shown in Figure 1, it is statistically probable that all hello virtual machines may be mapped tootwo fault domains instead of four.</span></span>

<span data-ttu-id="2efa3-143">**O balanceamento de carga do tráfego Thrift:** bibliotecas de cliente Thrift dentro do servidor de web hello conectar toohello cluster por meio de um balanceador de carga interno.</span><span class="sxs-lookup"><span data-stu-id="2efa3-143">**Load Balancing Thrift Traffic:** Thrift client libraries inside hello web server connect toohello cluster through an internal load balancer.</span></span> <span data-ttu-id="2efa3-144">Isso requer que o processo de saudação de adicionar sub-rede de saudação de carga interno balanceador toohello "dados" (consulte a Figura 1) no contexto de Olá Olá do serviço de nuvem hospeda Olá Cassandra cluster.</span><span class="sxs-lookup"><span data-stu-id="2efa3-144">This requires hello process of adding hello internal load balancer toohello “data” subnet (refer Figure 1) in hello context of hello cloud service hosting hello Cassandra cluster.</span></span> <span data-ttu-id="2efa3-145">Depois que o balanceador de carga interno Olá for definida, cada nó requer toobe de ponto de extremidade com balanceamento de carga Olá adicionado com anotações de saudação de um conjunto com balanceamento de carga com anteriormente nome do balanceador de carga definido.</span><span class="sxs-lookup"><span data-stu-id="2efa3-145">Once hello internal load balancer is defined, each node requires hello load balanced endpoint toobe added with hello annotations of a load balanced set with previously defined load balancer name.</span></span> <span data-ttu-id="2efa3-146">Confira [Balanceamento de carga interno do Azure ](../../../load-balancer/load-balancer-internal-overview.md)para obter mais detalhes.</span><span class="sxs-lookup"><span data-stu-id="2efa3-146">See [Azure Internal Load Balancing ](../../../load-balancer/load-balancer-internal-overview.md)for more details.</span></span>

<span data-ttu-id="2efa3-147">**Sementes de cluster:** é importante tooselect Olá a maioria de nós de alta disponibilidade para sementes como Olá novos nós se comunicará com topologia de saudação de toodiscover semente nós de cluster de saudação.</span><span class="sxs-lookup"><span data-stu-id="2efa3-147">**Cluster Seeds:** It is important tooselect hello most highly available nodes for seeds as hello new nodes will communicate with seed nodes toodiscover hello topology of hello cluster.</span></span> <span data-ttu-id="2efa3-148">Um nó de cada conjunto de disponibilidade é designado como semente nós tooavoid único ponto de falha.</span><span class="sxs-lookup"><span data-stu-id="2efa3-148">One node from each availability set is designated as seed nodes tooavoid single point of failure.</span></span>

<span data-ttu-id="2efa3-149">**Fator de replicação e o nível de consistência:** compilação em alta disponibilidade durabilidade de dados e da Cassandra é caracterizada por Olá fator de replicação (FR - número de cópias de cada linha armazenada no cluster de saudação) e (número de nível de consistência réplicas toobe lida/gravada antes de retornar o chamador de toohello resultados Olá).</span><span class="sxs-lookup"><span data-stu-id="2efa3-149">**Replication Factor and Consistency Level:** Cassandra’s build-in high-availability and data durability is characterized by hello Replication Factor (RF - number of copies of each row stored on hello cluster) and Consistency Level (number of replicas toobe read/written before returning hello result toohello caller).</span></span> <span data-ttu-id="2efa3-150">Fator de replicação é especificado durante a saudação criação KEYSPACE (banco de dados relacional de semelhante tooa) enquanto o nível de consistência de saudação for especificado ao emitir consultas CRUD hello.</span><span class="sxs-lookup"><span data-stu-id="2efa3-150">Replication factor is specified during hello KEYSPACE (similar tooa relational database) creation whereas hello consistency level is specified while issuing hello CRUD query.</span></span> <span data-ttu-id="2efa3-151">Consulte a documentação de Cassandra em [configurando para consistência](http://www.datastax.com/documentation/cassandra/2.0/cassandra/dml/dml_config_consistency_c.html) para obter detalhes de consistência e a fórmula Olá para a computação de quorum.</span><span class="sxs-lookup"><span data-stu-id="2efa3-151">See Cassandra documentation at [Configuring for Consistency](http://www.datastax.com/documentation/cassandra/2.0/cassandra/dml/dml_config_consistency_c.html) for consistency details and hello formula for quorum computation.</span></span>

<span data-ttu-id="2efa3-152">Cassandra dá suporte a dois tipos de modelos de integridade de dados – consistência e consistência Eventual. Olá fator de replicação e o nível de consistência juntos determinará se dados saudação será consistentes assim que uma operação de gravação é concluída ou é finalmente consistente.</span><span class="sxs-lookup"><span data-stu-id="2efa3-152">Cassandra supports two types of data integrity models – Consistency and Eventual Consistency; hello Replication Factor and Consistency Level will together determine if hello data will be consistent as soon as a write operation is complete or it will be eventually consistent.</span></span> <span data-ttu-id="2efa3-153">Por exemplo, QUORUM (por exemplo, um) especificando o QUORUM como Olá que nível de consistência será sempre garante a consistência de dados durante qualquer nível de consistência, abaixo do número de saudação de réplicas toobe gravado como tooattain necessário resulta em dados sendo finalmente consistente.</span><span class="sxs-lookup"><span data-stu-id="2efa3-153">For example, specifying QUORUM as hello Consistency Level will always ensures data Consistency while any consistency level, below hello number of replicas toobe written as needed tooattain QUORUM (e.g. ONE) results in data being eventually consistent.</span></span>

<span data-ttu-id="2efa3-154">mostrado acima, com um fator de replicação de 3 e QUORUM de cluster de 8 nós Hello (2 nós são lidos ou gravados para consistência) nível de consistência de leitura/gravação, pode sobreviver a perda de teórico Olá de em Olá 1 nó por replicação de grupo antes de iniciar o aplicativo hello Perceba a falha de saudação.</span><span class="sxs-lookup"><span data-stu-id="2efa3-154">hello 8-node cluster shown above, with a replication factor of 3 and QUORUM (2 nodes are read or written for consistency) read/write consistency level, can survive hello theoretical loss of at hello most 1 node per replication group before hello application start noticing hello failure.</span></span> <span data-ttu-id="2efa3-155">Isso pressupõe que todos os espaços de chave Olá também tem balanceamento de solicitações de leitura/gravação.</span><span class="sxs-lookup"><span data-stu-id="2efa3-155">This assumes that all hello key spaces have well balanced read/write requests.</span></span>  <span data-ttu-id="2efa3-156">Olá seguem parâmetros Olá que usaremos para cluster Olá implantado:</span><span class="sxs-lookup"><span data-stu-id="2efa3-156">hello following are hello parameters we will use for hello deployed cluster:</span></span>

<span data-ttu-id="2efa3-157">Configuração de cluster de Cassandra de região única:</span><span class="sxs-lookup"><span data-stu-id="2efa3-157">Single region Cassandra cluster configuration:</span></span>

| <span data-ttu-id="2efa3-158">Parâmetros de cluster</span><span class="sxs-lookup"><span data-stu-id="2efa3-158">Cluster Parameter</span></span> | <span data-ttu-id="2efa3-159">Valor</span><span class="sxs-lookup"><span data-stu-id="2efa3-159">Value</span></span> | <span data-ttu-id="2efa3-160">Comentários</span><span class="sxs-lookup"><span data-stu-id="2efa3-160">Remarks</span></span> |
| --- | --- | --- |
| <span data-ttu-id="2efa3-161">Número de nós (N)</span><span class="sxs-lookup"><span data-stu-id="2efa3-161">Number of Nodes (N)</span></span> |<span data-ttu-id="2efa3-162">8</span><span class="sxs-lookup"><span data-stu-id="2efa3-162">8</span></span> |<span data-ttu-id="2efa3-163">Número total de nós no cluster Olá</span><span class="sxs-lookup"><span data-stu-id="2efa3-163">Total number of nodes in hello cluster</span></span> |
| <span data-ttu-id="2efa3-164">Fator de replicação (RF)</span><span class="sxs-lookup"><span data-stu-id="2efa3-164">Replication Factor (RF)</span></span> |<span data-ttu-id="2efa3-165">3</span><span class="sxs-lookup"><span data-stu-id="2efa3-165">3</span></span> |<span data-ttu-id="2efa3-166">Número de réplicas de uma determinada linha</span><span class="sxs-lookup"><span data-stu-id="2efa3-166">Number of replicas of a given row</span></span> |
| <span data-ttu-id="2efa3-167">Nível de consistência (gravação)</span><span class="sxs-lookup"><span data-stu-id="2efa3-167">Consistency Level (Write)</span></span> |<span data-ttu-id="2efa3-168">QUORUM[(RF/2) +1) = 2] Olá resultado de saudação fórmula é arredondada para baixo</span><span class="sxs-lookup"><span data-stu-id="2efa3-168">QUORUM[(RF/2) +1) = 2] hello result of hello formula is rounded down</span></span> |<span data-ttu-id="2efa3-169">Grava no hello mais 2 réplicas antes de resposta de saudação é enviada do chamador toohello 3º réplica é gravada de forma consistente eventualmente.</span><span class="sxs-lookup"><span data-stu-id="2efa3-169">Writes at hello most 2 replicas before hello response is sent toohello caller; 3rd replica is written in an eventually consistent manner.</span></span> |
| <span data-ttu-id="2efa3-170">Nível de consistência (leitura)</span><span class="sxs-lookup"><span data-stu-id="2efa3-170">Consistency Level (Read)</span></span> |<span data-ttu-id="2efa3-171">QUORUM [(RF/2) + 1 = 2] resultado de saudação da fórmula Olá será arredondado para baixo</span><span class="sxs-lookup"><span data-stu-id="2efa3-171">QUORUM [(RF/2) +1= 2] hello result of hello formula is rounded down</span></span> |<span data-ttu-id="2efa3-172">Lê 2 réplicas antes de enviar o chamador de toohello de resposta.</span><span class="sxs-lookup"><span data-stu-id="2efa3-172">Reads 2 replicas before sending response toohello caller.</span></span> |
| <span data-ttu-id="2efa3-173">Estratégia de replicação</span><span class="sxs-lookup"><span data-stu-id="2efa3-173">Replication Strategy</span></span> |<span data-ttu-id="2efa3-174">NetworkTopologyStrategy consulte [Replicação de dados](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureDataDistributeReplication_c.html) na documentação de Cassandra para obter mais informações</span><span class="sxs-lookup"><span data-stu-id="2efa3-174">NetworkTopologyStrategy see [Data Replication](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureDataDistributeReplication_c.html) in Cassandra documentation for more information</span></span> |<span data-ttu-id="2efa3-175">Compreende a topologia de implantação hello e coloca réplicas em nós para que todas as réplicas de saudação não terminem em Olá mesmo rack</span><span class="sxs-lookup"><span data-stu-id="2efa3-175">Understands hello deployment topology and places replicas on nodes so that all hello replicas don’t end up on hello same rack</span></span> |
| <span data-ttu-id="2efa3-176">Informante</span><span class="sxs-lookup"><span data-stu-id="2efa3-176">Snitch</span></span> |<span data-ttu-id="2efa3-177">GossipingPropertyFileSnitch consulte [Informantes](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureSnitchesAbout_c.html) na documentação de Cassandra para obter mais informações</span><span class="sxs-lookup"><span data-stu-id="2efa3-177">GossipingPropertyFileSnitch see [Snitches](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureSnitchesAbout_c.html) in Cassandra documentation for more information</span></span> |<span data-ttu-id="2efa3-178">NetworkTopologyStrategy usa um conceito de topologia de saudação do snitch toounderstand.</span><span class="sxs-lookup"><span data-stu-id="2efa3-178">NetworkTopologyStrategy uses a concept of snitch toounderstand hello topology.</span></span> <span data-ttu-id="2efa3-179">GossipingPropertyFileSnitch fornece melhor controle no mapeamento cada centro do nó toodata e rack.</span><span class="sxs-lookup"><span data-stu-id="2efa3-179">GossipingPropertyFileSnitch gives better control in mapping each node toodata center and rack.</span></span> <span data-ttu-id="2efa3-180">cluster Hello, em seguida, usa fofocas toopropagate essas informações.</span><span class="sxs-lookup"><span data-stu-id="2efa3-180">hello cluster then uses gossip toopropagate this information.</span></span> <span data-ttu-id="2efa3-181">Isso é muito mais simples no dinâmico tooPropertyFileSnitch relativo de configuração de IP</span><span class="sxs-lookup"><span data-stu-id="2efa3-181">This is much simpler in dynamic IP setting relative tooPropertyFileSnitch</span></span> |

<span data-ttu-id="2efa3-182">**Considerações do azure para o cluster do Cassandra:** o recurso de máquinas virtuais do Microsoft Azure usa o armazenamento de Blob do Azure para persistência de disco; o Armazenamento do Azure salva 3 réplicas de cada disco para alta durabilidade.</span><span class="sxs-lookup"><span data-stu-id="2efa3-182">**Azure Considerations for Cassandra Cluster:** Microsoft Azure Virtual Machines capability uses Azure Blob storage for disk persistence; Azure Storage saves 3 replicas of each disk for high durability.</span></span> <span data-ttu-id="2efa3-183">Isso significa que cada linha de dados inseridos em uma tabela de Cassandra já esteja armazenada em 3 réplicas e, portanto, a consistência dos dados é já resolvida mesmo se Olá fator de replicação (FR) é 1.</span><span class="sxs-lookup"><span data-stu-id="2efa3-183">That means each row of data inserted into a Cassandra table is already stored in 3 replicas and hence data consistency is already taken care of even if hello Replication Factor (RF) is 1.</span></span> <span data-ttu-id="2efa3-184">Olá problema principal fator de replicação sendo 1 é que o aplicativo hello terá tempo de inatividade mesmo se um único nó Cassandra falha.</span><span class="sxs-lookup"><span data-stu-id="2efa3-184">hello main problem with Replication Factor being 1 is that hello application will experience downtime even if a single Cassandra node fails.</span></span> <span data-ttu-id="2efa3-185">No entanto, se um nó estiver inativo para problemas de saudação (por exemplo, o hardware, falhas de software do sistema) reconhecidos pelo controlador de malha do Azure, ele provisionará um novo nó no seu local usando Olá mesmo unidades de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="2efa3-185">However, if a node is down for hello problems (e.g. hardware, system software failures) recognized by Azure Fabric Controller, it will provision a new node in its place using hello same storage drives.</span></span> <span data-ttu-id="2efa3-186">O provisionamento de um novo nó tooreplace Olá antigo um pode levar alguns minutos.</span><span class="sxs-lookup"><span data-stu-id="2efa3-186">Provisioning a new node tooreplace hello old one may take a few minutes.</span></span>  <span data-ttu-id="2efa3-187">Da mesma forma para atividades de manutenção planejada, como alterações de sistema operacional convidado, Cassandra atualizações e alterações de aplicativo, controlador de malha do Azure executa atualizações de nós Olá contínuas em cluster hello.</span><span class="sxs-lookup"><span data-stu-id="2efa3-187">Similarly for planned maintenance activities like guest OS changes, Cassandra upgrades and application changes Azure Fabric Controller performs rolling upgrades of hello nodes in hello cluster.</span></span>  <span data-ttu-id="2efa3-188">Atualizações sem interrupção também podem desativar alguns nós em um momento e, portanto, o cluster Olá pode experimentar breve tempo de inatividade para algumas partições.</span><span class="sxs-lookup"><span data-stu-id="2efa3-188">Rolling upgrades also may take down a few nodes at a time and hence hello cluster may experience brief downtime for a few partitions.</span></span> <span data-ttu-id="2efa3-189">No entanto, os dados de saudação não serão perdidos devido a redundância de armazenamento do Azure interna toohello.</span><span class="sxs-lookup"><span data-stu-id="2efa3-189">However, hello data will not be lost due toohello built-in Azure Storage redundancy.</span></span>  

<span data-ttu-id="2efa3-190">Para sistemas implantados tooAzure que não exige uma alta disponibilidade (por exemplo, 99,9 em torno que é equivalente too8.76 h/ano; consulte [alta disponibilidade](http://en.wikipedia.org/wiki/High_availability) para obter detalhes) pode ser capaz de toorun com RF = 1 e nível de consistência = um.</span><span class="sxs-lookup"><span data-stu-id="2efa3-190">For systems deployed tooAzure that doesn’t require high availability (e.g. around 99.9 which is equivalent too8.76 hrs/year; see [High Availability](http://en.wikipedia.org/wiki/High_availability) for details) you may be able toorun with RF=1 and Consistency Level=ONE.</span></span>  <span data-ttu-id="2efa3-191">Para aplicativos com requisitos de alta disponibilidade, RF = 3 e nível de consistência = QUORUM será tolerar Olá tempo de inatividade do que um de nós de saudação uma das réplicas de saudação.</span><span class="sxs-lookup"><span data-stu-id="2efa3-191">For applications with high availability requirements, RF=3 and Consistency Level=QUORUM will tolerate hello down time of one of hello nodes one of hello replicas.</span></span> <span data-ttu-id="2efa3-192">RF = 1 em implantações tradicionais (por exemplo, no local) não pode ser usado devido toohello possível perda de dados resultantes de problemas, como falhas no disco.</span><span class="sxs-lookup"><span data-stu-id="2efa3-192">RF=1 in traditional deployments (e.g. on-premises) can’t be used due toohello possible data loss resulting from problems like disk failures.</span></span>   

## <a name="multi-region-deployment"></a><span data-ttu-id="2efa3-193">Implantação em várias regiões</span><span class="sxs-lookup"><span data-stu-id="2efa3-193">Multi-region Deployment</span></span>
<span data-ttu-id="2efa3-194">Da Cassandra replicação com reconhecimento de centro de dados e modelo de consistência descrito acima ajuda com a implantação de várias regiões Olá imediato saudação sem Olá necessário para qualquer ferramentas externas.</span><span class="sxs-lookup"><span data-stu-id="2efa3-194">Cassandra’s data-center-aware replication and consistency model described above helps with hello multi-region deployment out of hello box without hello need for any external tooling.</span></span> <span data-ttu-id="2efa3-195">Isso é bastante diferente do hello relacional bancos de dados tradicionais onde a instalação Olá para espelhamento de banco de dados para gravações de vários mestres pode ser bastante complexa.</span><span class="sxs-lookup"><span data-stu-id="2efa3-195">This is quite different from hello traditional relational databases where hello setup for database mirroring for multi-master writes can be quite complex.</span></span> <span data-ttu-id="2efa3-196">Cassandra em uma multi-região de configurar pode ajudar em cenários de uso de saudação incluindo Olá seguinte:</span><span class="sxs-lookup"><span data-stu-id="2efa3-196">Cassandra in a multi-region set up can help with hello usage scenarios including hello following:</span></span>

<span data-ttu-id="2efa3-197">**Implantação baseada em proximidade:** aplicativos multilocatários, com Limpar mapeamento de usuários de locatário-para-região, pode ser se beneficiam por latências de baixa do cluster de várias regiões hello.</span><span class="sxs-lookup"><span data-stu-id="2efa3-197">**Proximity based deployment:** Multi-tenant applications, with clear mapping of tenant users -to-region, can be benefited by hello multi-region cluster’s low latencies.</span></span> <span data-ttu-id="2efa3-198">Por exemplo, um gerenciamento de aprendizado de sistemas para instituições educacionais podem implantar um cluster distribuído no Leste dos EUA e Oeste dos EUA regiões tooserve Olá respectivas áreas para transacional, bem como a análise.</span><span class="sxs-lookup"><span data-stu-id="2efa3-198">For example a learning management systems for educational institutions can deploy a distributed cluster in East US and West US regions tooserve hello respective campuses for transactional as well as analytics.</span></span> <span data-ttu-id="2efa3-199">dados de saudação podem ser localmente consistentes em Olá tempo leituras e gravações e podem ser finalmente consistentes entre as duas regiões hello.</span><span class="sxs-lookup"><span data-stu-id="2efa3-199">hello data can be locally consistent at hello time reads and writes and can be eventually consistent across both hello regions.</span></span> <span data-ttu-id="2efa3-200">Existem outros exemplos, como distribuição de mídia, comércio eletrônico e qualquer coisa que sirva à base de usuários concentrada geograficamente é um bom caso de uso esse modelo de implantação.</span><span class="sxs-lookup"><span data-stu-id="2efa3-200">There are other examples like media distribution, e-commerce and anything and everything that serves geo concentrated user base is a good use case for this deployment model.</span></span>

<span data-ttu-id="2efa3-201">**Alta disponibilidade:** a redundância é um fator importante na obtenção de alta disponibilidade de software e hardware; confira Criando sistemas de nuvem confiáveis no Microsoft Azure para obter detalhes.</span><span class="sxs-lookup"><span data-stu-id="2efa3-201">**High Availability:** Redundancy is a key factor in attaining high availability of software and hardware; see Building Reliable Cloud Systems on Microsoft Azure for details.</span></span> <span data-ttu-id="2efa3-202">No Microsoft Azure, Olá único modo seguro de obter redundância real é implantando um cluster de várias regiões.</span><span class="sxs-lookup"><span data-stu-id="2efa3-202">On Microsoft Azure, hello only reliable way of achieving true redundancy is by deploying a multi-region cluster.</span></span> <span data-ttu-id="2efa3-203">Aplicativos podem ser implantados em um modo ativo-ativo ou ativo-passivo e se uma das regiões Olá estiver inativo, o Azure Traffic Manager pode redirecionar região ativa do tráfego toohello.</span><span class="sxs-lookup"><span data-stu-id="2efa3-203">Applications can be deployed in an active-active or active-passive mode and if one of hello regions is down, Azure Traffic Manager can redirect traffic toohello active region.</span></span>  <span data-ttu-id="2efa3-204">Com a implantação de região única Olá, se a disponibilidade de saudação for 99,9, uma implantação de duas regiões pode atingir uma disponibilidade de 99,9999 calculado pela fórmula Olá: (1-(1-0.999) * (1-0,999)) * 100); Consulte Olá acima papel para obter detalhes.</span><span class="sxs-lookup"><span data-stu-id="2efa3-204">With hello single region deployment, if hello availability is 99.9, a two-region deployment can attain an availability of 99.9999 computed by hello formula: (1-(1-0.999) * (1-0.999))*100); see hello above paper for details.</span></span>

<span data-ttu-id="2efa3-205">**Recuperação de desastres:** o cluster Cassandra de várias regiões, se projetado adequadamente, pode resistir a interrupções catastróficas do data center.</span><span class="sxs-lookup"><span data-stu-id="2efa3-205">**Disaster Recovery:** Multi-region Cassandra cluster, if properly designed, can withstand catastrophic data center outages.</span></span> <span data-ttu-id="2efa3-206">Se uma região estiver inativo, Olá aplicativo implantado tooother regiões podem iniciar atendendo os usuários finais de saudação.</span><span class="sxs-lookup"><span data-stu-id="2efa3-206">If one region is down, hello application deployed tooother regions can start serving hello end users.</span></span> <span data-ttu-id="2efa3-207">Como as outras implementações de continuidade de negócios, o aplicativo hello tem toobe tolerante a falhas para alguma perda de dados resultante de dados de saudação no pipeline assíncrono hello.</span><span class="sxs-lookup"><span data-stu-id="2efa3-207">Like any other business continuity implementations, hello application has toobe tolerant for some data loss resulting from hello data in hello asynchronous pipeline.</span></span> <span data-ttu-id="2efa3-208">No entanto, Cassandra torna a recuperação de saudação muito swifter do tempo de saudação usado por processos de recuperação de banco de dados tradicional.</span><span class="sxs-lookup"><span data-stu-id="2efa3-208">However, Cassandra makes hello recovery much swifter than hello time taken by traditional database recovery processes.</span></span> <span data-ttu-id="2efa3-209">A Figura 2 mostra o modelo de implantação de várias regiões típica Olá com oito nós em cada região.</span><span class="sxs-lookup"><span data-stu-id="2efa3-209">Figure 2 shows hello typical multi-region deployment model with eight nodes in each region.</span></span> <span data-ttu-id="2efa3-210">Ambas as regiões são imagens de espelhamento da outra para hello mesmo de simetria; designs de reais dependem do tipo de carga de trabalho da saudação (por exemplo, transacional ou analítico), o RPO, RTO, consistência dos dados e requisitos de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="2efa3-210">Both regions are mirror images of each other for hello same of symmetry; real world designs depend on hello workload type (e.g. transactional or analytical), RPO, RTO, data consistency and availability requirements.</span></span>

![Implantação de várias regiões](./media/cassandra-nodejs/cassandra-linux2.png)

<span data-ttu-id="2efa3-212">Figura 2: implantação do Cassandra de várias regiões</span><span class="sxs-lookup"><span data-stu-id="2efa3-212">Figure 2: Multi-region Cassandra deployment</span></span>

### <a name="network-integration"></a><span data-ttu-id="2efa3-213">Integração de rede</span><span class="sxs-lookup"><span data-stu-id="2efa3-213">Network Integration</span></span>
<span data-ttu-id="2efa3-214">Conjuntos de máquinas virtuais tooprivate implantado redes localizados em duas regiões comunica-se entre si usando um túnel VPN.</span><span class="sxs-lookup"><span data-stu-id="2efa3-214">Sets of virtual machines deployed tooprivate networks located on two regions communicates with each other using a VPN tunnel.</span></span> <span data-ttu-id="2efa3-215">túnel VPN Olá conecta dois gateways software provisionados durante o processo de implantação de rede de saudação.</span><span class="sxs-lookup"><span data-stu-id="2efa3-215">hello VPN tunnel connects two software gateways provisioned during hello network deployment process.</span></span> <span data-ttu-id="2efa3-216">Ambas as regiões têm arquitetura semelhante de rede em termos de sub-redes "web" e "dados"; Rede do Azure permite a criação de saudação de sub-redes tantos conforme necessário e aplique as ACLs conforme necessário para segurança de rede.</span><span class="sxs-lookup"><span data-stu-id="2efa3-216">Both regions have similar network architecture in terms of “web” and “data” subnets; Azure networking allows hello creation of as many subnets as needed and apply ACLs as needed by network security.</span></span> <span data-ttu-id="2efa3-217">Ao projetar a topologia de cluster Olá inter dados center comunicação latência e hello econômico impacto do tráfego de rede de saudação necessidade toobe considerado.</span><span class="sxs-lookup"><span data-stu-id="2efa3-217">While designing hello cluster topology inter data center communication latency and hello economic impact of hello network traffic need toobe considered.</span></span>

### <a name="data-consistency-for-multi-data-center-deployment"></a><span data-ttu-id="2efa3-218">Consistência de dados para implantação em vários data centers</span><span class="sxs-lookup"><span data-stu-id="2efa3-218">Data Consistency for Multi-Data Center Deployment</span></span>
<span data-ttu-id="2efa3-219">Distribuído implantações necessidade toobe atento ao impacto de topologia de cluster de saudação na taxa de transferência e a alta disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="2efa3-219">Distributed deployments need toobe aware of hello cluster topology impact on throughput and high availability.</span></span> <span data-ttu-id="2efa3-220">Olá RF e nível de consistência toobe necessidade selecionada de forma que Olá quorum não depende de disponibilidade de saudação de todos os centros de dados de saudação.</span><span class="sxs-lookup"><span data-stu-id="2efa3-220">hello RF and Consistency Level need toobe selected in such way that hello quorum doesn’t depend on hello availability of all hello data centers.</span></span>
<span data-ttu-id="2efa3-221">Para um sistema que precisa de consistência alta, um LOCAL_QUORUM para nível de consistência (para leituras e gravações) garantirá que Olá local leituras e gravações são atendidas Olá local nós enquanto os dados são replicados de forma assíncrona toohello centros de dados remotos.</span><span class="sxs-lookup"><span data-stu-id="2efa3-221">For a system that needs high consistency, a LOCAL_QUORUM for consistency level (for reads and writes) will make sure that hello local reads and writes are satisfied from hello local nodes while data is replicated asynchronously toohello remote data centers.</span></span>  <span data-ttu-id="2efa3-222">A tabela 2 resume configuração Olá detalhes para o cluster de várias regiões Olá descritas Olá gravação.</span><span class="sxs-lookup"><span data-stu-id="2efa3-222">Table 2 summarizes hello configuration details for hello multi-region cluster outlined later in hello write up.</span></span>

<span data-ttu-id="2efa3-223">**Configuração de cluster Cassandra de duas regiões**</span><span class="sxs-lookup"><span data-stu-id="2efa3-223">**Two-region Cassandra cluster configuration**</span></span>

| <span data-ttu-id="2efa3-224">Parâmetros de cluster</span><span class="sxs-lookup"><span data-stu-id="2efa3-224">Cluster Parameter</span></span> | <span data-ttu-id="2efa3-225">Valor</span><span class="sxs-lookup"><span data-stu-id="2efa3-225">Value</span></span> | <span data-ttu-id="2efa3-226">Comentários</span><span class="sxs-lookup"><span data-stu-id="2efa3-226">Remarks</span></span> |
| --- | --- | --- |
| <span data-ttu-id="2efa3-227">Número de nós (N)</span><span class="sxs-lookup"><span data-stu-id="2efa3-227">Number of Nodes (N)</span></span> |<span data-ttu-id="2efa3-228">8 + 8</span><span class="sxs-lookup"><span data-stu-id="2efa3-228">8 + 8</span></span> |<span data-ttu-id="2efa3-229">Número total de nós no cluster Olá</span><span class="sxs-lookup"><span data-stu-id="2efa3-229">Total number of nodes in hello cluster</span></span> |
| <span data-ttu-id="2efa3-230">Fator de replicação (RF)</span><span class="sxs-lookup"><span data-stu-id="2efa3-230">Replication Factor (RF)</span></span> |<span data-ttu-id="2efa3-231">3</span><span class="sxs-lookup"><span data-stu-id="2efa3-231">3</span></span> |<span data-ttu-id="2efa3-232">Número de réplicas de uma determinada linha</span><span class="sxs-lookup"><span data-stu-id="2efa3-232">Number of replicas of a given row</span></span> |
| <span data-ttu-id="2efa3-233">Nível de consistência (gravação)</span><span class="sxs-lookup"><span data-stu-id="2efa3-233">Consistency Level (Write)</span></span> |<span data-ttu-id="2efa3-234">LOCAL_QUORUM [(sum(RF)/2) +1) = 4] resultado de saudação da fórmula Olá será arredondado para baixo</span><span class="sxs-lookup"><span data-stu-id="2efa3-234">LOCAL_QUORUM [(sum(RF)/2) +1) = 4] hello result of hello formula is rounded down</span></span> |<span data-ttu-id="2efa3-235">2 nós serão gravados toohello primeiro centro de dados de forma síncrona; Olá adicionais 2 nós necessários para quorum serão gravados assincronamente toohello 2º data centers.</span><span class="sxs-lookup"><span data-stu-id="2efa3-235">2 nodes will be written toohello first data center synchronously; hello additional 2 nodes needed for quorum will be written asynchronously toohello 2nd data center.</span></span> |
| <span data-ttu-id="2efa3-236">Nível de consistência (leitura)</span><span class="sxs-lookup"><span data-stu-id="2efa3-236">Consistency Level (Read)</span></span> |<span data-ttu-id="2efa3-237">LOCAL_QUORUM ((RF/2) + 1) = 2 resultado de saudação da fórmula Olá será arredondado para baixo</span><span class="sxs-lookup"><span data-stu-id="2efa3-237">LOCAL_QUORUM ((RF/2) +1) = 2 hello result of hello formula is rounded down</span></span> |<span data-ttu-id="2efa3-238">Solicitações de leitura são atendidas apenas uma região. 2 nós são lidas antes do envio back toohello cliente de resposta de saudação.</span><span class="sxs-lookup"><span data-stu-id="2efa3-238">Read requests are satisfied from only one region; 2 nodes are read before hello response is sent back toohello client.</span></span> |
| <span data-ttu-id="2efa3-239">Estratégia de replicação</span><span class="sxs-lookup"><span data-stu-id="2efa3-239">Replication Strategy</span></span> |<span data-ttu-id="2efa3-240">NetworkTopologyStrategy consulte [Replicação de dados](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureDataDistributeReplication_c.html) na documentação de Cassandra para obter mais informações</span><span class="sxs-lookup"><span data-stu-id="2efa3-240">NetworkTopologyStrategy see [Data Replication](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureDataDistributeReplication_c.html) in Cassandra documentation for more information</span></span> |<span data-ttu-id="2efa3-241">Compreende a topologia de implantação hello e coloca réplicas em nós para que todas as réplicas de saudação não terminem em Olá mesmo rack</span><span class="sxs-lookup"><span data-stu-id="2efa3-241">Understands hello deployment topology and places replicas on nodes so that all hello replicas don’t end up on hello same rack</span></span> |
| <span data-ttu-id="2efa3-242">Informante</span><span class="sxs-lookup"><span data-stu-id="2efa3-242">Snitch</span></span> |<span data-ttu-id="2efa3-243">GossipingPropertyFileSnitch consulte [Informantes](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureSnitchesAbout_c.html) na documentação de Cassandra para obter mais informações</span><span class="sxs-lookup"><span data-stu-id="2efa3-243">GossipingPropertyFileSnitch see [Snitches](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureSnitchesAbout_c.html) in Cassandra documentation for more information</span></span> |<span data-ttu-id="2efa3-244">NetworkTopologyStrategy usa um conceito de topologia de saudação do snitch toounderstand.</span><span class="sxs-lookup"><span data-stu-id="2efa3-244">NetworkTopologyStrategy uses a concept of snitch toounderstand hello topology.</span></span> <span data-ttu-id="2efa3-245">GossipingPropertyFileSnitch fornece melhor controle no mapeamento cada centro do nó toodata e rack.</span><span class="sxs-lookup"><span data-stu-id="2efa3-245">GossipingPropertyFileSnitch gives better control in mapping each node toodata center and rack.</span></span> <span data-ttu-id="2efa3-246">cluster Hello, em seguida, usa fofocas toopropagate essas informações.</span><span class="sxs-lookup"><span data-stu-id="2efa3-246">hello cluster then uses gossip toopropagate this information.</span></span> <span data-ttu-id="2efa3-247">Isso é muito mais simples no dinâmico tooPropertyFileSnitch relativo de configuração de IP</span><span class="sxs-lookup"><span data-stu-id="2efa3-247">This is much simpler in dynamic IP setting relative tooPropertyFileSnitch</span></span> |

## <a name="hello-software-configuration"></a><span data-ttu-id="2efa3-248">Olá a configuração de SOFTWARE</span><span class="sxs-lookup"><span data-stu-id="2efa3-248">hello SOFTWARE CONFIGURATION</span></span>
<span data-ttu-id="2efa3-249">Olá versões de software a seguir é usada durante a implantação de saudação:</span><span class="sxs-lookup"><span data-stu-id="2efa3-249">hello following software versions are used during hello deployment:</span></span>

<table>
<tr><th><span data-ttu-id="2efa3-250">Software</span><span class="sxs-lookup"><span data-stu-id="2efa3-250">Software</span></span></th><th><span data-ttu-id="2efa3-251">Fonte</span><span class="sxs-lookup"><span data-stu-id="2efa3-251">Source</span></span></th><th><span data-ttu-id="2efa3-252">Versão</span><span class="sxs-lookup"><span data-stu-id="2efa3-252">Version</span></span></th></tr>
<tr><td><span data-ttu-id="2efa3-253">JRE</span><span class="sxs-lookup"><span data-stu-id="2efa3-253">JRE</span></span>    </td><td><span data-ttu-id="2efa3-254">[JRE 8](http://www.oracle.com/technetwork/java/javase/downloads/server-jre8-downloads-2133154.html) </span><span class="sxs-lookup"><span data-stu-id="2efa3-254">[JRE 8](http://www.oracle.com/technetwork/java/javase/downloads/server-jre8-downloads-2133154.html) </span></span></td><td><span data-ttu-id="2efa3-255">8U5</span><span class="sxs-lookup"><span data-stu-id="2efa3-255">8U5</span></span></td></tr>
<tr><td><span data-ttu-id="2efa3-256">JNA</span><span class="sxs-lookup"><span data-stu-id="2efa3-256">JNA</span></span>    </td><td><span data-ttu-id="2efa3-257">[JNA](https://github.com/twall/jna) </span><span class="sxs-lookup"><span data-stu-id="2efa3-257">[JNA](https://github.com/twall/jna) </span></span></td><td> <span data-ttu-id="2efa3-258">3.2.7</span><span class="sxs-lookup"><span data-stu-id="2efa3-258">3.2.7</span></span></td></tr>
<tr><td><span data-ttu-id="2efa3-259">Cassandra</span><span class="sxs-lookup"><span data-stu-id="2efa3-259">Cassandra</span></span></td><td>[<span data-ttu-id="2efa3-260">Apache Cassandra 2.0.8</span><span class="sxs-lookup"><span data-stu-id="2efa3-260">Apache Cassandra 2.0.8</span></span>](http://www.apache.org/dist/cassandra/2.0.8/apache-cassandra-2.0.8-bin.tar.gz)</td><td> <span data-ttu-id="2efa3-261">2.0.8</span><span class="sxs-lookup"><span data-stu-id="2efa3-261">2.0.8</span></span></td></tr>
<tr><td><span data-ttu-id="2efa3-262">Ubuntu</span><span class="sxs-lookup"><span data-stu-id="2efa3-262">Ubuntu</span></span>    </td><td><span data-ttu-id="2efa3-263">[Microsoft Azure](https://azure.microsoft.com/) </span><span class="sxs-lookup"><span data-stu-id="2efa3-263">[Microsoft Azure](https://azure.microsoft.com/) </span></span></td><td><span data-ttu-id="2efa3-264">14.04 LTS</span><span class="sxs-lookup"><span data-stu-id="2efa3-264">14.04 LTS</span></span></td></tr>
</table>

<span data-ttu-id="2efa3-265">Como fazer o download do JRE requer aceitação manual de licença do Oracle, implantação de saudação toosimplify, download que todos Olá área de trabalho de toohello de software necessárias para carregar mais tarde na imagem de modelo Ubuntu Olá que estamos criando como um cluster de toohello precursor implantação.</span><span class="sxs-lookup"><span data-stu-id="2efa3-265">Since downloading of JRE requires manual acceptance of Oracle license, toosimplify hello deployment, download all hello required software toohello desktop for later uploading into hello Ubuntu template image we will be creating as a precursor toohello cluster deployment.</span></span>

<span data-ttu-id="2efa3-266">Baixe Olá acima de software em um diretório de download conhecidas (por exemplo, %TEMP%/downloads no Windows ou ~/Downloads na maioria das distribuições do Linux ou Mac) no computador local hello.</span><span class="sxs-lookup"><span data-stu-id="2efa3-266">Download hello above software into a well-known download directory (e.g. %TEMP%/downloads on Windows or ~/Downloads on most Linux distributions or Mac) on hello local computer.</span></span>

### <a name="create-ubuntu-vm"></a><span data-ttu-id="2efa3-267">CRIAR UMA MV UBUNTU</span><span class="sxs-lookup"><span data-stu-id="2efa3-267">CREATE UBUNTU VM</span></span>
<span data-ttu-id="2efa3-268">Nesta etapa do processo de saudação criaremos Ubuntu imagem com o software de pré-requisito Olá para que hello imagem pode ser reutilizada para o provisionamento de vários nós Cassandra.</span><span class="sxs-lookup"><span data-stu-id="2efa3-268">In this step of hello process we will create Ubuntu image with hello pre-requisite software so that hello image can be reused for provisioning several Cassandra nodes.</span></span>  

#### <a name="step-1-generate-ssh-key-pair"></a><span data-ttu-id="2efa3-269">ETAPA 1: gerar o par de chave SSH</span><span class="sxs-lookup"><span data-stu-id="2efa3-269">STEP 1: Generate SSH key pair</span></span>
<span data-ttu-id="2efa3-270">Azure precisa de uma chave pública de PEM ou DER codificado a saudação tempo de provisionamento de X509.</span><span class="sxs-lookup"><span data-stu-id="2efa3-270">Azure needs an X509 public key that is either PEM or DER encoded at hello provisioning time.</span></span> <span data-ttu-id="2efa3-271">Gerar um par de chaves pública/privada usando instruções Olá localizadas como tooUse SSH com Linux no Azure.</span><span class="sxs-lookup"><span data-stu-id="2efa3-271">Generate a public/private key pair using hello instructions located at How tooUse SSH with Linux on Azure.</span></span> <span data-ttu-id="2efa3-272">Se você planejar toouse putty.exe como um cliente SSH no Windows ou Linux, você terá tooconvert Olá PEM codificada em formato de tooPPK de chave privada do RSA usando puttygen.exe; instruções de saudação para isso podem ser encontradas no hello acima da página da web.</span><span class="sxs-lookup"><span data-stu-id="2efa3-272">If you plan toouse putty.exe as an SSH client either on Windows or Linux, you have tooconvert hello PEM encoded RSA private key tooPPK format using puttygen.exe; hello instructions for this can be found in hello above web page.</span></span>

#### <a name="step-2-create-ubuntu-template-vm"></a><span data-ttu-id="2efa3-273">ETAPA 2: criar uma VM do modelo Ubuntu</span><span class="sxs-lookup"><span data-stu-id="2efa3-273">STEP 2: Create Ubuntu template VM</span></span>
<span data-ttu-id="2efa3-274">modelo de saudação toocreate VM, faça logon no hello Azure clássico Olá portal e use sequência a seguir: clique em novo, computação, máquina VIRTUAL, da GALERIA, UBUNTU, Ubuntu Server 14.04 LTS e, em seguida, clique na seta direita hello.</span><span class="sxs-lookup"><span data-stu-id="2efa3-274">toocreate hello template VM, log into hello Azure classic portal and use hello following sequence: Click NEW, COMPUTE, VIRTUAL MACHINE, FROM GALLERY, UBUNTU, Ubuntu Server 14.04 LTS, and then click hello right arrow.</span></span> <span data-ttu-id="2efa3-275">Para obter um tutorial que descreve como toocreate uma VM do Linux, consulte Criar uma máquina Virtual executando o Linux.</span><span class="sxs-lookup"><span data-stu-id="2efa3-275">For a tutorial that describes how toocreate a Linux VM, see Create a Virtual Machine Running Linux.</span></span>

<span data-ttu-id="2efa3-276">Digite hello segue as informações na tela hello "configuração de máquina Virtual" #1:</span><span class="sxs-lookup"><span data-stu-id="2efa3-276">Enter hello following information on hello “Virtual machine configuration” screen #1:</span></span>

<table>
<tr><th><span data-ttu-id="2efa3-277">NOME DO CAMPO</span><span class="sxs-lookup"><span data-stu-id="2efa3-277">FIELD NAME</span></span>              </td><td>       <span data-ttu-id="2efa3-278">VALOR DO CAMPO</span><span class="sxs-lookup"><span data-stu-id="2efa3-278">FIELD VALUE</span></span>               </td><td>         <span data-ttu-id="2efa3-279">COMENTÁRIOS</span><span class="sxs-lookup"><span data-stu-id="2efa3-279">REMARKS</span></span>                </td><tr>
<tr><td><span data-ttu-id="2efa3-280">DATA DE LANÇAMENTO DA VERSÃO</span><span class="sxs-lookup"><span data-stu-id="2efa3-280">VERSION RELEASE DATE</span></span>    </td><td> <span data-ttu-id="2efa3-281">Selecione uma data de saudação da lista suspensa</span><span class="sxs-lookup"><span data-stu-id="2efa3-281">Select a date from hello drop down</span></span></td><td></td><tr>
<tr><td><span data-ttu-id="2efa3-282">NOME DA MÁQUINA VIRTUAL</span><span class="sxs-lookup"><span data-stu-id="2efa3-282">VIRTUAL MACHINE NAME</span></span>    </td><td> <span data-ttu-id="2efa3-283">cass-template</span><span class="sxs-lookup"><span data-stu-id="2efa3-283">cass-template</span></span>                   </td><td> <span data-ttu-id="2efa3-284">Este é o nome de host de saudação do hello VM</span><span class="sxs-lookup"><span data-stu-id="2efa3-284">This is hello hostname of hello VM</span></span> </td><tr>
<tr><td><span data-ttu-id="2efa3-285">CAMADA</span><span class="sxs-lookup"><span data-stu-id="2efa3-285">TIER</span></span>                     </td><td> <span data-ttu-id="2efa3-286">STANDARD</span><span class="sxs-lookup"><span data-stu-id="2efa3-286">STANDARD</span></span>                           </td><td> <span data-ttu-id="2efa3-287">Deixe o padrão de saudação</span><span class="sxs-lookup"><span data-stu-id="2efa3-287">Leave hello default</span></span>              </td><tr>
<tr><td><span data-ttu-id="2efa3-288">TAMANHO adequado</span><span class="sxs-lookup"><span data-stu-id="2efa3-288">SIZE</span></span>                     </td><td> <span data-ttu-id="2efa3-289">A1</span><span class="sxs-lookup"><span data-stu-id="2efa3-289">A1</span></span>                              </td><td><span data-ttu-id="2efa3-290">Selecione Olá que VM com base em hello e/s necessidades. para essa finalidade deixe o padrão de saudação</span><span class="sxs-lookup"><span data-stu-id="2efa3-290">Select hello VM based on hello IO needs; for this purpose leave hello default</span></span> </td><tr>
<tr><td> <span data-ttu-id="2efa3-291">NOVO NOME DE USUÁRIO</span><span class="sxs-lookup"><span data-stu-id="2efa3-291">NEW USER NAME</span></span>             </td><td> <span data-ttu-id="2efa3-292">localadmin</span><span class="sxs-lookup"><span data-stu-id="2efa3-292">localadmin</span></span>                       </td><td> <span data-ttu-id="2efa3-293">"admin" é um nome de usuário reservado no Ubuntu 12.xx e depois</span><span class="sxs-lookup"><span data-stu-id="2efa3-293">"admin" is a reserved user name in Ubuntu 12.xx and after</span></span></td><tr>
<tr><td> <span data-ttu-id="2efa3-294">AUTENTICAÇÃO</span><span class="sxs-lookup"><span data-stu-id="2efa3-294">AUTHENTICATION</span></span>         </td><td> <span data-ttu-id="2efa3-295">Clique na caixa de seleção</span><span class="sxs-lookup"><span data-stu-id="2efa3-295">Click check box</span></span>                 </td><td><span data-ttu-id="2efa3-296">Verifique se você quiser toosecure com uma chave SSH</span><span class="sxs-lookup"><span data-stu-id="2efa3-296">Check if you want toosecure with an SSH key</span></span> </td><tr>
<tr><td> <span data-ttu-id="2efa3-297">CERTIFICADO</span><span class="sxs-lookup"><span data-stu-id="2efa3-297">CERTIFICATE</span></span>             </td><td> <span data-ttu-id="2efa3-298">nome do arquivo do certificado de chave pública Olá</span><span class="sxs-lookup"><span data-stu-id="2efa3-298">file name of hello public key certificate</span></span> </td><td> <span data-ttu-id="2efa3-299">Usar chave pública de saudação gerado anteriormente</span><span class="sxs-lookup"><span data-stu-id="2efa3-299">Use hello public key generated previously</span></span></td><tr>
<tr><td> <span data-ttu-id="2efa3-300">Nova senha</span><span class="sxs-lookup"><span data-stu-id="2efa3-300">New Password</span></span>    </td><td> <span data-ttu-id="2efa3-301">senha de alta segurança</span><span class="sxs-lookup"><span data-stu-id="2efa3-301">strong password</span></span> </td><td> </td><tr>
<tr><td> <span data-ttu-id="2efa3-302">Confirmar Senha</span><span class="sxs-lookup"><span data-stu-id="2efa3-302">Confirm Password</span></span>    </td><td> <span data-ttu-id="2efa3-303">senha de alta segurança</span><span class="sxs-lookup"><span data-stu-id="2efa3-303">strong password</span></span> </td><td></td><tr>
</table>

<span data-ttu-id="2efa3-304">Digite hello segue as informações na tela hello "configuração de máquina Virtual" #2:</span><span class="sxs-lookup"><span data-stu-id="2efa3-304">Enter hello following information on hello “Virtual machine configuration” screen #2:</span></span>

<table>
<tr><th><span data-ttu-id="2efa3-305">NOME DO CAMPO</span><span class="sxs-lookup"><span data-stu-id="2efa3-305">FIELD NAME</span></span>             </th><th> <span data-ttu-id="2efa3-306">VALOR DO CAMPO</span><span class="sxs-lookup"><span data-stu-id="2efa3-306">FIELD VALUE</span></span>                       </th><th> <span data-ttu-id="2efa3-307">COMENTÁRIOS</span><span class="sxs-lookup"><span data-stu-id="2efa3-307">REMARKS</span></span>                                 </th></tr>
<tr><td> <span data-ttu-id="2efa3-308">SERVIÇO DE NUVEM</span><span class="sxs-lookup"><span data-stu-id="2efa3-308">CLOUD SERVICE</span></span>    </td><td> <span data-ttu-id="2efa3-309">Crie um novo serviço de nuvem</span><span class="sxs-lookup"><span data-stu-id="2efa3-309">Create a new cloud service</span></span>    </td><td><span data-ttu-id="2efa3-310">O serviço de nuvem é um recurso de contêiner de computação, como as máquinas virtuais</span><span class="sxs-lookup"><span data-stu-id="2efa3-310">Cloud service is a container compute resources like virtual machines</span></span></td></tr>
<tr><td> <span data-ttu-id="2efa3-311">NOME DNS DO SERVIÇO DE NUVEM</span><span class="sxs-lookup"><span data-stu-id="2efa3-311">CLOUD SERVICE DNS NAME</span></span>    </td><td><span data-ttu-id="2efa3-312">ubuntu-template.cloudapp.net</span><span class="sxs-lookup"><span data-stu-id="2efa3-312">ubuntu-template.cloudapp.net</span></span>    </td><td><span data-ttu-id="2efa3-313">Dê um nome do balanceador de carga independente da máquina</span><span class="sxs-lookup"><span data-stu-id="2efa3-313">Give a machine agnostic load balancer name</span></span></td></tr>
<tr><td> <span data-ttu-id="2efa3-314">REGIÃO/GRUPO DE AFINIDADE/REDE VIRTUAL</span><span class="sxs-lookup"><span data-stu-id="2efa3-314">REGION/AFFINITY GROUP/VIRTUAL NETWORK</span></span> </td><td>    <span data-ttu-id="2efa3-315">Oeste dos EUA</span><span class="sxs-lookup"><span data-stu-id="2efa3-315">West US</span></span>    </td><td> <span data-ttu-id="2efa3-316">Selecione uma região na qual seus aplicativos web acessam cluster de Cassandra Olá</span><span class="sxs-lookup"><span data-stu-id="2efa3-316">Select a region from which your web applications access hello Cassandra cluster</span></span></td></tr>
<tr><td><span data-ttu-id="2efa3-317">CONTA DE ARMAZENAMENTO</span><span class="sxs-lookup"><span data-stu-id="2efa3-317">STORAGE ACCOUNT</span></span> </td><td>    <span data-ttu-id="2efa3-318">Usar padrão</span><span class="sxs-lookup"><span data-stu-id="2efa3-318">Use default</span></span>    </td><td><span data-ttu-id="2efa3-319">Usar conta de armazenamento saudação padrão ou uma conta de armazenamento previamente criado em uma determinada região</span><span class="sxs-lookup"><span data-stu-id="2efa3-319">Use hello default storage account  or a pre-created storage account in a particular region</span></span></td></tr>
<tr><td><span data-ttu-id="2efa3-320">Conjunto de disponibilidade</span><span class="sxs-lookup"><span data-stu-id="2efa3-320">AVAILABILITY SET</span></span> </td><td>    <span data-ttu-id="2efa3-321">Nenhum</span><span class="sxs-lookup"><span data-stu-id="2efa3-321">None</span></span> </td><td>    <span data-ttu-id="2efa3-322">Deixe em branco</span><span class="sxs-lookup"><span data-stu-id="2efa3-322">Leave it blank</span></span></td></tr>
<tr><td><span data-ttu-id="2efa3-323">PONTOS DE EXTREMIDADE</span><span class="sxs-lookup"><span data-stu-id="2efa3-323">ENDPOINTS</span></span>    </td><td><span data-ttu-id="2efa3-324">Usar padrão</span><span class="sxs-lookup"><span data-stu-id="2efa3-324">Use default</span></span> </td><td>    <span data-ttu-id="2efa3-325">Usar configuração de SSH saudação padrão</span><span class="sxs-lookup"><span data-stu-id="2efa3-325">Use hello default SSH configuration</span></span> </td></tr>
</table>

<span data-ttu-id="2efa3-326">Clique na seta para direita, mantenha os padrões de saudação na tela hello #3 e clique em hello "Verificar" botão toocomplete Olá VM processo de provisionamento.</span><span class="sxs-lookup"><span data-stu-id="2efa3-326">Click right arrow, leave hello defaults on hello screen #3 and click hello “check” button toocomplete hello VM provisioning process.</span></span> <span data-ttu-id="2efa3-327">Depois de alguns minutos, Olá VM com hello "ubuntu-modelo de nome" deve estar em um status "em execução".</span><span class="sxs-lookup"><span data-stu-id="2efa3-327">After a few minutes, hello VM with hello name “ubuntu-template” should be in a “running” status.</span></span>

### <a name="install-hello-necessary-software"></a><span data-ttu-id="2efa3-328">INSTALAR Olá SOFTWARE necessário</span><span class="sxs-lookup"><span data-stu-id="2efa3-328">INSTALL hello NECESSARY SOFTWARE</span></span>
#### <a name="step-1-upload-tarballs"></a><span data-ttu-id="2efa3-329">ETAPA 1: carregar tarballs</span><span class="sxs-lookup"><span data-stu-id="2efa3-329">STEP 1: Upload tarballs</span></span>
<span data-ttu-id="2efa3-330">Usando o scp ou pscp, Olá cópia baixados anteriormente software muito ~ / diretório de downloads usando Olá formato de comando a seguir:</span><span class="sxs-lookup"><span data-stu-id="2efa3-330">Using scp or pscp, copy hello previously downloaded software too~/downloads directory using hello following command format:</span></span>

##### <a name="pscp-server-jre-8u5-linux-x64targz-localadminhk-cas-templatecloudappnethomelocaladmindownloadsserver-jre-8u5-linux-x64targz"></a><span data-ttu-id="2efa3-331">pscp server-jre-8u5-linux-x64.tar.gz localadmin@hk-cas-template.cloudapp.net:/home/localadmin/downloads/server-jre-8u5-linux-x64.tar.gz</span><span class="sxs-lookup"><span data-stu-id="2efa3-331">pscp server-jre-8u5-linux-x64.tar.gz localadmin@hk-cas-template.cloudapp.net:/home/localadmin/downloads/server-jre-8u5-linux-x64.tar.gz</span></span>
<span data-ttu-id="2efa3-332">Repita Olá acima comando para JRE bem como para bits de Cassandra hello.</span><span class="sxs-lookup"><span data-stu-id="2efa3-332">Repeat hello above command for JRE as well as for hello Cassandra bits.</span></span>

#### <a name="step-2-prepare-hello-directory-structure-and-extract-hello-archives"></a><span data-ttu-id="2efa3-333">Etapa 2: Preparar a estrutura de diretórios hello e extrair arquivos Olá</span><span class="sxs-lookup"><span data-stu-id="2efa3-333">STEP 2: Prepare hello directory structure and extract hello archives</span></span>
<span data-ttu-id="2efa3-334">Faça logon no hello VM e criar a estrutura de diretórios hello e extrair o software como um superusuário com hello bash script abaixo:</span><span class="sxs-lookup"><span data-stu-id="2efa3-334">Log into hello VM and create hello directory structure and extract software as a super user using hello bash script below:</span></span>

    #!/bin/bash
    CASS_INSTALL_DIR="/opt/cassandra"
    JRE_INSTALL_DIR="/opt/java"
    CASS_DATA_DIR="/var/lib/cassandra"
    CASS_LOG_DIR="/var/log/cassandra"
    DOWNLOADS_DIR="~/downloads"
    JRE_TARBALL="server-jre-8u5-linux-x64.tar.gz"
    CASS_TARBALL="apache-cassandra-2.0.8-bin.tar.gz"
    SVC_USER="localadmin"

    RESET_ERROR=1
    MKDIR_ERROR=2

    reset_installation ()
    {
       rm -rf $CASS_INSTALL_DIR 2> /dev/null
       rm -rf $JRE_INSTALL_DIR 2> /dev/null
       rm -rf $CASS_DATA_DIR 2> /dev/null
       rm -rf $CASS_LOG_DIR 2> /dev/null
    }
    make_dir ()
    {
       if [ -z "$1" ]
       then
          echo "make_dir: invalid directory name"
          exit $MKDIR_ERROR
       fi

       if [ -d "$1" ]
       then
          echo "make_dir: directory already exists"
          exit $MKDIR_ERROR
       fi

       mkdir $1 2>/dev/null
       if [ $? != 0 ]
       then
          echo "directory creation failed"
          exit $MKDIR_ERROR
       fi
    }

    unzip()
    {
       if [ $# == 2 ]
       then
          tar xzf $1 -C $2
       else
          echo "archive error"
       fi

    }

    if [ -n "$1" ]
    then
       SVC_USER=$1
    fi

    reset_installation
    make_dir $CASS_INSTALL_DIR
    make_dir $JRE_INSTALL_DIR
    make_dir $CASS_DATA_DIR
    make_dir $CASS_LOG_DIR

    #unzip JRE and Cassandra
    unzip $HOME/downloads/$JRE_TARBALL $JRE_INSTALL_DIR
    unzip $HOME/downloads/$CASS_TARBALL $CASS_INSTALL_DIR

    #Change hello ownership toohello service credentials

    chown -R $SVC_USER:$GROUP $CASS_DATA_DIR
    chown -R $SVC_USER:$GROUP $CASS_LOG_DIR
    echo "edit /etc/profile tooadd JRE toohello PATH"
    echo "installation is complete"


<span data-ttu-id="2efa3-335">Se você colar esse script na janela vim, fazer o carro de saudação tooremove se retornar ('\r ") usando o comando a seguir de saudação:</span><span class="sxs-lookup"><span data-stu-id="2efa3-335">If you paste this script into vim window, make sure tooremove hello carriage return (‘\r”) using hello following command:</span></span>

    tr -d '\r' <infile.sh >outfile.sh

#### <a name="step-3-edit-etcprofile"></a><span data-ttu-id="2efa3-336">Etapa 3: editar etc/profile</span><span class="sxs-lookup"><span data-stu-id="2efa3-336">Step 3: Edit etc/profile</span></span>
<span data-ttu-id="2efa3-337">Acrescente o seguinte Olá final hello:</span><span class="sxs-lookup"><span data-stu-id="2efa3-337">Append hello following at hello end:</span></span>

    JAVA_HOME=/opt/java/jdk1.8.0_05
    CASS_HOME= /opt/cassandra/apache-cassandra-2.0.8
    PATH=$PATH:$HOME/bin:$JAVA_HOME/bin:$CASS_HOME/bin
    export JAVA_HOME
    export CASS_HOME
    export PATH

#### <a name="step-4-install-jna-for-production-systems"></a><span data-ttu-id="2efa3-338">Etapa 4: instalar JNA para sistemas de produção</span><span class="sxs-lookup"><span data-stu-id="2efa3-338">Step 4: Install JNA for production systems</span></span>
<span data-ttu-id="2efa3-339">Sequência de comando a seguir de saudação de uso: comando a seguir Olá jna install-3.2.7.jar e jna de plataforma de 3.2.7.jar too/usr/share.java diretório sudo apt get instalará libjna java</span><span class="sxs-lookup"><span data-stu-id="2efa3-339">Use hello following command sequence: hello following command will install jna-3.2.7.jar and jna-platform-3.2.7.jar too/usr/share.java directory sudo apt-get install libjna-java</span></span>

<span data-ttu-id="2efa3-340">Crie links simbólicos no diretório $CASS_HOME/lib para que o script de inicialização de Cassandra possa encontrar essas jars:</span><span class="sxs-lookup"><span data-stu-id="2efa3-340">Create symbolic links in $CASS_HOME/lib directory so that Cassandra startup script can find these jars:</span></span>

    ln -s /usr/share/java/jna-3.2.7.jar $CASS_HOME/lib/jna.jar

    ln -s /usr/share/java/jna-platform-3.2.7.jar $CASS_HOME/lib/jna-platform.jar

#### <a name="step-5-configure-cassandrayaml"></a><span data-ttu-id="2efa3-341">Etapa 5: configurar o cassandra.yaml</span><span class="sxs-lookup"><span data-stu-id="2efa3-341">Step 5: Configure cassandra.yaml</span></span>
<span data-ttu-id="2efa3-342">Edite cassandra.yaml em cada configuração da VM tooreflect necessária para todas as máquinas virtuais de saudação [nós serão ajustar isso durante o provisionamento real de saudação]:</span><span class="sxs-lookup"><span data-stu-id="2efa3-342">Edit cassandra.yaml on each VM tooreflect configuration needed by all hello virtual machines [we will tweak this during hello actual provisioning]:</span></span>

<table>
<tr><th><span data-ttu-id="2efa3-343">Nome do campo</span><span class="sxs-lookup"><span data-stu-id="2efa3-343">Field Name</span></span>   </th><th> <span data-ttu-id="2efa3-344">Valor</span><span class="sxs-lookup"><span data-stu-id="2efa3-344">Value</span></span>  </th><th>    <span data-ttu-id="2efa3-345">Comentários</span><span class="sxs-lookup"><span data-stu-id="2efa3-345">Remarks</span></span> </th></tr>
<tr><td><span data-ttu-id="2efa3-346">cluster_name</span><span class="sxs-lookup"><span data-stu-id="2efa3-346">cluster_name</span></span> </td><td>    <span data-ttu-id="2efa3-347">"CustomerService"</span><span class="sxs-lookup"><span data-stu-id="2efa3-347">“CustomerService”</span></span>    </td><td> <span data-ttu-id="2efa3-348">Use o nome de saudação que reflete a implantação</span><span class="sxs-lookup"><span data-stu-id="2efa3-348">Use hello name that reflects your deployment</span></span></td></tr>
<tr><td><span data-ttu-id="2efa3-349">listen_address</span><span class="sxs-lookup"><span data-stu-id="2efa3-349">listen_address</span></span>    </td><td><span data-ttu-id="2efa3-350">[deixe em branco]</span><span class="sxs-lookup"><span data-stu-id="2efa3-350">[leave it blank]</span></span>    </td><td> <span data-ttu-id="2efa3-351">Excluir "localhost"</span><span class="sxs-lookup"><span data-stu-id="2efa3-351">Delete “localhost”</span></span> </td></tr>
<tr><td><span data-ttu-id="2efa3-352">rpc_addres</span><span class="sxs-lookup"><span data-stu-id="2efa3-352">rpc_addres</span></span>   </td><td><span data-ttu-id="2efa3-353">[deixe em branco]</span><span class="sxs-lookup"><span data-stu-id="2efa3-353">[leave it blank]</span></span>    </td><td> <span data-ttu-id="2efa3-354">Excluir "localhost"</span><span class="sxs-lookup"><span data-stu-id="2efa3-354">Delete “localhost”</span></span> </td></tr>
<tr><td><span data-ttu-id="2efa3-355">sementes</span><span class="sxs-lookup"><span data-stu-id="2efa3-355">seeds</span></span>    </td><td><span data-ttu-id="2efa3-356">"10.1.2.4, 10.1.2.6, 10.1.2.8"</span><span class="sxs-lookup"><span data-stu-id="2efa3-356">"10.1.2.4, 10.1.2.6, 10.1.2.8"</span></span>    </td><td><span data-ttu-id="2efa3-357">Lista de todos os endereços IP de saudação que são designados como sementes.</span><span class="sxs-lookup"><span data-stu-id="2efa3-357">List of  all hello IP addresses which are designated as seeds.</span></span></td></tr>
<tr><td><span data-ttu-id="2efa3-358">endpoint_snitch</span><span class="sxs-lookup"><span data-stu-id="2efa3-358">endpoint_snitch</span></span> </td><td> <span data-ttu-id="2efa3-359">org.apache.cassandra.locator.GossipingPropertyFileSnitch</span><span class="sxs-lookup"><span data-stu-id="2efa3-359">org.apache.cassandra.locator.GossipingPropertyFileSnitch</span></span> </td><td> <span data-ttu-id="2efa3-360">Isso é usado por Olá NetworkTopologyStrateg inferindo Olá data center e rack de saudação do hello VM</span><span class="sxs-lookup"><span data-stu-id="2efa3-360">This is used by hello NetworkTopologyStrateg for inferring hello data center and hello rack of hello VM</span></span></td></tr>
</table>

#### <a name="step-6-capture-hello-vm-image"></a><span data-ttu-id="2efa3-361">Etapa 6: Capturar a imagem da VM Olá</span><span class="sxs-lookup"><span data-stu-id="2efa3-361">Step 6: Capture hello VM image</span></span>
<span data-ttu-id="2efa3-362">Faça logon na máquina virtual de saudação usando Olá hostname (hk-cas-template.cloudapp.net) e a chave privada de SSH de saudação criado anteriormente.</span><span class="sxs-lookup"><span data-stu-id="2efa3-362">Log into hello virtual machine using hello hostname (hk-cas-template.cloudapp.net) and hello SSH private key previously created.</span></span> <span data-ttu-id="2efa3-363">Consulte como tooUse SSH com Linux no Azure para detalhes sobre como toolog usando Olá comando ssh ou putty.exe.</span><span class="sxs-lookup"><span data-stu-id="2efa3-363">See How tooUse SSH with Linux on Azure for details on how toolog in using hello command ssh or putty.exe.</span></span>

<span data-ttu-id="2efa3-364">Execute Olá sequência da imagem de saudação toocapture ações a seguir:</span><span class="sxs-lookup"><span data-stu-id="2efa3-364">Execute hello following sequence of actions toocapture hello image:</span></span>

##### <a name="1-deprovision"></a><span data-ttu-id="2efa3-365">1. Desprovisionar</span><span class="sxs-lookup"><span data-stu-id="2efa3-365">1. Deprovision</span></span>
<span data-ttu-id="2efa3-366">Use o comando hello "sudo waagent – desprovisionamento + user" tooremove informações específicas da instância de máquina Virtual.</span><span class="sxs-lookup"><span data-stu-id="2efa3-366">Use hello command “sudo waagent –deprovision+user” tooremove Virtual Machine instance specific information.</span></span> <span data-ttu-id="2efa3-367">Consulte para [como tooCapture uma máquina Virtual Linux](capture-image.md) tooUse como um modelo de obter mais detalhes sobre o processo de captura de imagem de saudação.</span><span class="sxs-lookup"><span data-stu-id="2efa3-367">See for [How tooCapture a Linux Virtual Machine](capture-image.md) tooUse as a Template more details on hello image capture process.</span></span>

##### <a name="2-shutdown-hello-vm"></a><span data-ttu-id="2efa3-368">2: Olá desligar VM</span><span class="sxs-lookup"><span data-stu-id="2efa3-368">2: Shutdown hello VM</span></span>
<span data-ttu-id="2efa3-369">Certifique-se de que a máquina virtual hello está realçada e clique Olá desligamento link na barra de comandos Olá inferior.</span><span class="sxs-lookup"><span data-stu-id="2efa3-369">Make sure that hello virtual machine is highlighted and click hello SHUTDOWN link from hello bottom command bar.</span></span>

##### <a name="3-capture-hello-image"></a><span data-ttu-id="2efa3-370">3: captura de imagem de saudação</span><span class="sxs-lookup"><span data-stu-id="2efa3-370">3: Capture hello image</span></span>
<span data-ttu-id="2efa3-371">Certifique-se de que a máquina virtual hello está realçada e clique Olá captura link na barra de comandos Olá inferior.</span><span class="sxs-lookup"><span data-stu-id="2efa3-371">Make sure that hello virtual machine is highlighted and click hello CAPTURE link from hello bottom command bar.</span></span> <span data-ttu-id="2efa3-372">Na próxima tela de Olá, dê um nome de imagem (por exemplo, hk-cas-2-08-ub-14-04-2014071), apropriado a descrição da imagem e clique em processo de captura do hello "Verificar" marca toofinish hello.</span><span class="sxs-lookup"><span data-stu-id="2efa3-372">In hello next screen, give an IMAGE NAME (e.g. hk-cas-2-08-ub-14-04-2014071), appropriate IMAGE DESCRIPTION, and click hello “check” mark toofinish hello CAPTURE process.</span></span>

<span data-ttu-id="2efa3-373">Isso levará alguns segundos e imagem Olá deve estar disponível na seção de Minhas imagens da Galeria de imagens de saudação.</span><span class="sxs-lookup"><span data-stu-id="2efa3-373">This will take a few seconds and hello image should be available in MY IMAGES section of hello image gallery.</span></span> <span data-ttu-id="2efa3-374">VM de origem Hello será excluída automaticamente após a imagem de saudação é capturada com êxito.</span><span class="sxs-lookup"><span data-stu-id="2efa3-374">hello source VM will be automatically deleted after hello image is successfully captured.</span></span> 

## <a name="single-region-deployment-process"></a><span data-ttu-id="2efa3-375">Processo de implantação de região única</span><span class="sxs-lookup"><span data-stu-id="2efa3-375">Single Region Deployment Process</span></span>
<span data-ttu-id="2efa3-376">**Etapa 1: Criar rede Virtual de saudação** login Olá portal do Azure e criar uma rede virtual (clássica) com atributos Olá Olá a tabela a seguir mostrada.</span><span class="sxs-lookup"><span data-stu-id="2efa3-376">**Step 1: Create hello Virtual Network** Log into hello Azure portal and create a virtual network (classic) with hello attributes shown in hello following table.</span></span> <span data-ttu-id="2efa3-377">Consulte [criar uma rede virtual (clássica) usando o portal do Azure de saudação](../../../virtual-network/virtual-networks-create-vnet-classic-pportal.md) para obter etapas detalhadas do processo de saudação.</span><span class="sxs-lookup"><span data-stu-id="2efa3-377">See [Create a virtual network (classic) using hello Azure portal](../../../virtual-network/virtual-networks-create-vnet-classic-pportal.md) for detailed steps of hello process.</span></span>      

<table>
<tr><th><span data-ttu-id="2efa3-378">Nome do atributo da VM</span><span class="sxs-lookup"><span data-stu-id="2efa3-378">VM Attribute Name</span></span></th><th><span data-ttu-id="2efa3-379">Valor</span><span class="sxs-lookup"><span data-stu-id="2efa3-379">Value</span></span></th><th><span data-ttu-id="2efa3-380">Comentários</span><span class="sxs-lookup"><span data-stu-id="2efa3-380">Remarks</span></span></th></tr>
<tr><td><span data-ttu-id="2efa3-381">Nome</span><span class="sxs-lookup"><span data-stu-id="2efa3-381">Name</span></span></td><td><span data-ttu-id="2efa3-382">vnet-cass-west-us</span><span class="sxs-lookup"><span data-stu-id="2efa3-382">vnet-cass-west-us</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="2efa3-383">Região</span><span class="sxs-lookup"><span data-stu-id="2efa3-383">Region</span></span></td><td><span data-ttu-id="2efa3-384">Oeste dos EUA</span><span class="sxs-lookup"><span data-stu-id="2efa3-384">West US</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="2efa3-385">Servidores DNS</span><span class="sxs-lookup"><span data-stu-id="2efa3-385">DNS Servers</span></span></td><td><span data-ttu-id="2efa3-386">Nenhum</span><span class="sxs-lookup"><span data-stu-id="2efa3-386">None</span></span></td><td><span data-ttu-id="2efa3-387">Ignore isso, pois não estamos usando um servidor DNS</span><span class="sxs-lookup"><span data-stu-id="2efa3-387">Ignore this as we are not using a DNS Server</span></span></td></tr>
<tr><td><span data-ttu-id="2efa3-388">Espaço de endereço</span><span class="sxs-lookup"><span data-stu-id="2efa3-388">Address Space</span></span></td><td><span data-ttu-id="2efa3-389">10.1.0.0/16</span><span class="sxs-lookup"><span data-stu-id="2efa3-389">10.1.0.0/16</span></span></td><td></td></tr>    
<tr><td><span data-ttu-id="2efa3-390">IP Inicial</span><span class="sxs-lookup"><span data-stu-id="2efa3-390">Starting IP</span></span></td><td><span data-ttu-id="2efa3-391">10.1.0.0</span><span class="sxs-lookup"><span data-stu-id="2efa3-391">10.1.0.0</span></span></td><td></td></tr>    
<tr><td><span data-ttu-id="2efa3-392">CIDR</span><span class="sxs-lookup"><span data-stu-id="2efa3-392">CIDR</span></span> </td><td><span data-ttu-id="2efa3-393">/16 (65531)</span><span class="sxs-lookup"><span data-stu-id="2efa3-393">/16 (65531)</span></span></td><td></td></tr>
</table>

<span data-ttu-id="2efa3-394">Adicione Olá seguintes sub-redes:</span><span class="sxs-lookup"><span data-stu-id="2efa3-394">Add hello following subnets:</span></span>

<table>
<tr><th><span data-ttu-id="2efa3-395">Nome</span><span class="sxs-lookup"><span data-stu-id="2efa3-395">Name</span></span></th><th><span data-ttu-id="2efa3-396">IP Inicial</span><span class="sxs-lookup"><span data-stu-id="2efa3-396">Starting IP</span></span></th><th><span data-ttu-id="2efa3-397">CIDR</span><span class="sxs-lookup"><span data-stu-id="2efa3-397">CIDR</span></span></th><th><span data-ttu-id="2efa3-398">Comentários</span><span class="sxs-lookup"><span data-stu-id="2efa3-398">Remarks</span></span></th></tr>
<tr><td><span data-ttu-id="2efa3-399">web</span><span class="sxs-lookup"><span data-stu-id="2efa3-399">web</span></span></td><td><span data-ttu-id="2efa3-400">10.1.1.0</span><span class="sxs-lookup"><span data-stu-id="2efa3-400">10.1.1.0</span></span></td><td><span data-ttu-id="2efa3-401">/24 (251)</span><span class="sxs-lookup"><span data-stu-id="2efa3-401">/24 (251)</span></span></td><td><span data-ttu-id="2efa3-402">Subrede do farm da web de saudação</span><span class="sxs-lookup"><span data-stu-id="2efa3-402">Subnet for hello web farm</span></span></td></tr>
<tr><td><span data-ttu-id="2efa3-403">data</span><span class="sxs-lookup"><span data-stu-id="2efa3-403">data</span></span></td><td><span data-ttu-id="2efa3-404">10.1.2.0</span><span class="sxs-lookup"><span data-stu-id="2efa3-404">10.1.2.0</span></span></td><td><span data-ttu-id="2efa3-405">/24 (251)</span><span class="sxs-lookup"><span data-stu-id="2efa3-405">/24 (251)</span></span></td><td><span data-ttu-id="2efa3-406">Sub-rede para nós de banco de dados de saudação</span><span class="sxs-lookup"><span data-stu-id="2efa3-406">Subnet for hello database nodes</span></span></td></tr>
</table>

<span data-ttu-id="2efa3-407">Subredes da Web e dados podem ser protegidos por meio de grupos de segurança de rede cobertura de saudação do qual está fora do escopo deste artigo.</span><span class="sxs-lookup"><span data-stu-id="2efa3-407">Data and Web subnets can be protected through network security groups hello coverage of which is out of scope for this article.</span></span>  

<span data-ttu-id="2efa3-408">**Etapa 2: Provisionar máquinas de virtuais** usando a imagem de saudação criada anteriormente, criaremos Olá seguintes máquinas virtuais na nuvem Olá servidor "hk-c-svc-Oeste" e associá-las toohello respectivas sub-redes conforme mostrado abaixo:</span><span class="sxs-lookup"><span data-stu-id="2efa3-408">**Step 2: Provision Virtual Machines** Using hello image created previously, we will create hello following virtual machines in hello cloud server “hk-c-svc-west” and bind them toohello respective subnets as shown below:</span></span>

<table>
<tr><th><span data-ttu-id="2efa3-409">Nome da máquina</span><span class="sxs-lookup"><span data-stu-id="2efa3-409">Machine Name</span></span>    </th><th><span data-ttu-id="2efa3-410">Sub-rede</span><span class="sxs-lookup"><span data-stu-id="2efa3-410">Subnet</span></span>    </th><th><span data-ttu-id="2efa3-411">Endereço IP</span><span class="sxs-lookup"><span data-stu-id="2efa3-411">IP Address</span></span>    </th><th><span data-ttu-id="2efa3-412">Conjunto de disponibilidade</span><span class="sxs-lookup"><span data-stu-id="2efa3-412">Availability set</span></span></th><th><span data-ttu-id="2efa3-413">DC/Rack</span><span class="sxs-lookup"><span data-stu-id="2efa3-413">DC/Rack</span></span></th><th><span data-ttu-id="2efa3-414">Propagar?</span><span class="sxs-lookup"><span data-stu-id="2efa3-414">Seed?</span></span></th></tr>
<tr><td><span data-ttu-id="2efa3-415">hk-c1-west-us</span><span class="sxs-lookup"><span data-stu-id="2efa3-415">hk-c1-west-us</span></span>    </td><td><span data-ttu-id="2efa3-416">data</span><span class="sxs-lookup"><span data-stu-id="2efa3-416">data</span></span>    </td><td><span data-ttu-id="2efa3-417">10.1.2.4</span><span class="sxs-lookup"><span data-stu-id="2efa3-417">10.1.2.4</span></span>    </td><td><span data-ttu-id="2efa3-418">hk-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="2efa3-418">hk-c-aset-1</span></span>    </td><td><span data-ttu-id="2efa3-419">dc =WESTUS rack =rack1</span><span class="sxs-lookup"><span data-stu-id="2efa3-419">dc =WESTUS rack =rack1</span></span> </td><td><span data-ttu-id="2efa3-420">Sim</span><span class="sxs-lookup"><span data-stu-id="2efa3-420">Yes</span></span></td></tr>
<tr><td><span data-ttu-id="2efa3-421">hk-c2-west-us</span><span class="sxs-lookup"><span data-stu-id="2efa3-421">hk-c2-west-us</span></span>    </td><td><span data-ttu-id="2efa3-422">data</span><span class="sxs-lookup"><span data-stu-id="2efa3-422">data</span></span>    </td><td><span data-ttu-id="2efa3-423">10.1.2.5</span><span class="sxs-lookup"><span data-stu-id="2efa3-423">10.1.2.5</span></span>    </td><td><span data-ttu-id="2efa3-424">hk-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="2efa3-424">hk-c-aset-1</span></span>    </td><td><span data-ttu-id="2efa3-425">dc =WESTUS rack =rack1</span><span class="sxs-lookup"><span data-stu-id="2efa3-425">dc =WESTUS rack =rack1</span></span>    </td><td><span data-ttu-id="2efa3-426">Não</span><span class="sxs-lookup"><span data-stu-id="2efa3-426">No</span></span> </td></tr>
<tr><td><span data-ttu-id="2efa3-427">hk-c3-west-us</span><span class="sxs-lookup"><span data-stu-id="2efa3-427">hk-c3-west-us</span></span>    </td><td><span data-ttu-id="2efa3-428">data</span><span class="sxs-lookup"><span data-stu-id="2efa3-428">data</span></span>    </td><td><span data-ttu-id="2efa3-429">10.1.2.6</span><span class="sxs-lookup"><span data-stu-id="2efa3-429">10.1.2.6</span></span>    </td><td><span data-ttu-id="2efa3-430">hk-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="2efa3-430">hk-c-aset-1</span></span>    </td><td><span data-ttu-id="2efa3-431">dc =WESTUS rack =rack2</span><span class="sxs-lookup"><span data-stu-id="2efa3-431">dc =WESTUS rack =rack2</span></span>    </td><td><span data-ttu-id="2efa3-432">Sim</span><span class="sxs-lookup"><span data-stu-id="2efa3-432">Yes</span></span></td></tr>
<tr><td><span data-ttu-id="2efa3-433">hk-c4-west-us</span><span class="sxs-lookup"><span data-stu-id="2efa3-433">hk-c4-west-us</span></span>    </td><td><span data-ttu-id="2efa3-434">data</span><span class="sxs-lookup"><span data-stu-id="2efa3-434">data</span></span>    </td><td><span data-ttu-id="2efa3-435">10.1.2.7</span><span class="sxs-lookup"><span data-stu-id="2efa3-435">10.1.2.7</span></span>    </td><td><span data-ttu-id="2efa3-436">hk-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="2efa3-436">hk-c-aset-1</span></span>    </td><td><span data-ttu-id="2efa3-437">dc =WESTUS rack =rack2</span><span class="sxs-lookup"><span data-stu-id="2efa3-437">dc =WESTUS rack =rack2</span></span>    </td><td><span data-ttu-id="2efa3-438">Não</span><span class="sxs-lookup"><span data-stu-id="2efa3-438">No</span></span> </td></tr>
<tr><td><span data-ttu-id="2efa3-439">hk-c5-west-us</span><span class="sxs-lookup"><span data-stu-id="2efa3-439">hk-c5-west-us</span></span>    </td><td><span data-ttu-id="2efa3-440">data</span><span class="sxs-lookup"><span data-stu-id="2efa3-440">data</span></span>    </td><td><span data-ttu-id="2efa3-441">10.1.2.8</span><span class="sxs-lookup"><span data-stu-id="2efa3-441">10.1.2.8</span></span>    </td><td><span data-ttu-id="2efa3-442">hk-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="2efa3-442">hk-c-aset-2</span></span>    </td><td><span data-ttu-id="2efa3-443">dc =WESTUS rack =rack3</span><span class="sxs-lookup"><span data-stu-id="2efa3-443">dc =WESTUS rack =rack3</span></span>    </td><td><span data-ttu-id="2efa3-444">Sim</span><span class="sxs-lookup"><span data-stu-id="2efa3-444">Yes</span></span></td></tr>
<tr><td><span data-ttu-id="2efa3-445">hk-c6-west-us</span><span class="sxs-lookup"><span data-stu-id="2efa3-445">hk-c6-west-us</span></span>    </td><td><span data-ttu-id="2efa3-446">data</span><span class="sxs-lookup"><span data-stu-id="2efa3-446">data</span></span>    </td><td><span data-ttu-id="2efa3-447">10.1.2.9</span><span class="sxs-lookup"><span data-stu-id="2efa3-447">10.1.2.9</span></span>    </td><td><span data-ttu-id="2efa3-448">hk-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="2efa3-448">hk-c-aset-2</span></span>    </td><td><span data-ttu-id="2efa3-449">dc =WESTUS rack =rack3</span><span class="sxs-lookup"><span data-stu-id="2efa3-449">dc =WESTUS rack =rack3</span></span>    </td><td><span data-ttu-id="2efa3-450">Não</span><span class="sxs-lookup"><span data-stu-id="2efa3-450">No</span></span> </td></tr>
<tr><td><span data-ttu-id="2efa3-451">hk-c7-west-us</span><span class="sxs-lookup"><span data-stu-id="2efa3-451">hk-c7-west-us</span></span>    </td><td><span data-ttu-id="2efa3-452">data</span><span class="sxs-lookup"><span data-stu-id="2efa3-452">data</span></span>    </td><td><span data-ttu-id="2efa3-453">10.1.2.10</span><span class="sxs-lookup"><span data-stu-id="2efa3-453">10.1.2.10</span></span>    </td><td><span data-ttu-id="2efa3-454">hk-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="2efa3-454">hk-c-aset-2</span></span>    </td><td><span data-ttu-id="2efa3-455">dc =WESTUS rack =rack4</span><span class="sxs-lookup"><span data-stu-id="2efa3-455">dc =WESTUS rack =rack4</span></span>    </td><td><span data-ttu-id="2efa3-456">Sim</span><span class="sxs-lookup"><span data-stu-id="2efa3-456">Yes</span></span></td></tr>
<tr><td><span data-ttu-id="2efa3-457">hk-c8-west-us</span><span class="sxs-lookup"><span data-stu-id="2efa3-457">hk-c8-west-us</span></span>    </td><td><span data-ttu-id="2efa3-458">data</span><span class="sxs-lookup"><span data-stu-id="2efa3-458">data</span></span>    </td><td><span data-ttu-id="2efa3-459">10.1.2.11</span><span class="sxs-lookup"><span data-stu-id="2efa3-459">10.1.2.11</span></span>    </td><td><span data-ttu-id="2efa3-460">hk-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="2efa3-460">hk-c-aset-2</span></span>    </td><td><span data-ttu-id="2efa3-461">dc =WESTUS rack =rack4</span><span class="sxs-lookup"><span data-stu-id="2efa3-461">dc =WESTUS rack =rack4</span></span>    </td><td><span data-ttu-id="2efa3-462">Não</span><span class="sxs-lookup"><span data-stu-id="2efa3-462">No</span></span> </td></tr>
<tr><td><span data-ttu-id="2efa3-463">hk-w1-west-us</span><span class="sxs-lookup"><span data-stu-id="2efa3-463">hk-w1-west-us</span></span>    </td><td><span data-ttu-id="2efa3-464">web</span><span class="sxs-lookup"><span data-stu-id="2efa3-464">web</span></span>    </td><td><span data-ttu-id="2efa3-465">10.1.1.4</span><span class="sxs-lookup"><span data-stu-id="2efa3-465">10.1.1.4</span></span>    </td><td><span data-ttu-id="2efa3-466">hk-w-aset-1</span><span class="sxs-lookup"><span data-stu-id="2efa3-466">hk-w-aset-1</span></span>    </td><td>                       </td><td><span data-ttu-id="2efa3-467">N/D</span><span class="sxs-lookup"><span data-stu-id="2efa3-467">N/A</span></span></td></tr>
<tr><td><span data-ttu-id="2efa3-468">hk-w2-west-us</span><span class="sxs-lookup"><span data-stu-id="2efa3-468">hk-w2-west-us</span></span>    </td><td><span data-ttu-id="2efa3-469">web</span><span class="sxs-lookup"><span data-stu-id="2efa3-469">web</span></span>    </td><td><span data-ttu-id="2efa3-470">10.1.1.5</span><span class="sxs-lookup"><span data-stu-id="2efa3-470">10.1.1.5</span></span>    </td><td><span data-ttu-id="2efa3-471">hk-w-aset-1</span><span class="sxs-lookup"><span data-stu-id="2efa3-471">hk-w-aset-1</span></span>    </td><td>                       </td><td><span data-ttu-id="2efa3-472">N/D</span><span class="sxs-lookup"><span data-stu-id="2efa3-472">N/A</span></span></td></tr>
</table>

<span data-ttu-id="2efa3-473">Criação de saudação acima da lista de VMs requer Olá processo a seguir:</span><span class="sxs-lookup"><span data-stu-id="2efa3-473">Creation of hello above list of VMs requires hello following process:</span></span>

1. <span data-ttu-id="2efa3-474">Crie um serviço de nuvem vazio em uma determinada região</span><span class="sxs-lookup"><span data-stu-id="2efa3-474">Create an empty cloud service in a particular region</span></span>
2. <span data-ttu-id="2efa3-475">Criar uma VM da imagem capturada anteriormente hello e anexá-lo a rede virtual do toohello criado anteriormente; Repita essa etapa para todas as VMs Olá</span><span class="sxs-lookup"><span data-stu-id="2efa3-475">Create a VM from hello previously captured image and attach it toohello virtual network created previously; repeat this for all hello VMs</span></span>
3. <span data-ttu-id="2efa3-476">Adicionar um serviço de nuvem de toohello de Balanceador de carga interno e anexá-lo a sub-rede toohello "dados"</span><span class="sxs-lookup"><span data-stu-id="2efa3-476">Add an internal load balancer toohello cloud service and attach it toohello “data” subnet</span></span>
4. <span data-ttu-id="2efa3-477">Para cada VM criada anteriormente, adicione um ponto de extremidade com balanceamento de carga para tráfego de thrift por meio de um balanceador de carga interno com balanceamento de carga conjunto conectado toohello criada anteriormente</span><span class="sxs-lookup"><span data-stu-id="2efa3-477">For each VM created previously, add a load balanced endpoint for thrift traffic through a load balanced set connected toohello previously created internal load balancer</span></span>

<span data-ttu-id="2efa3-478">Olá acima processo pode ser executado usando o portal clássico do Azure; Use um computador Windows (use uma VM no Azure se você não tiver uma máquina com Windows tooa acesso), use Olá tooprovision de script do PowerShell a seguir todas as 8 VMs automaticamente.</span><span class="sxs-lookup"><span data-stu-id="2efa3-478">hello above process can be executed using Azure classic portal; use a Windows machine (use a VM on Azure if you don't have access tooa Windows machine), use hello following PowerShell script tooprovision all 8 VMs automatically.</span></span>

<span data-ttu-id="2efa3-479">**Lista 1: script do PowerShell para provisionamento de máquinas virtuais**</span><span class="sxs-lookup"><span data-stu-id="2efa3-479">**List 1: PowerShell script for provisioning virtual machines**</span></span>

        #Tested with Azure Powershell - November 2014
        #This powershell script deployes a number of VMs from an existing image inside an Azure region
        #Import your Azure subscription into hello current Powershell session before proceeding
        #hello process: 1. create Azure Storage account, 2. create virtual network, 3.create hello VM template, 2. crate a list of VMs from hello template

        #fundamental variables - change these tooreflect your subscription
        $country="us"; $region="west"; $vnetName = "your_vnet_name";$storageAccount="your_storage_account"
        $numVMs=8;$prefix = "hk-cass";$ilbIP="your_ilb_ip"
        $subscriptionName = "Azure_subscription_name";
        $vmSize="ExtraSmall"; $imageName="your_linux_image_name"
        $ilbName="ThriftInternalLB"; $thriftEndPoint="ThriftEndPoint"

        #generated variables
        $serviceName = "$prefix-svc-$region-$country"; $azureRegion = "$region $country"

        $vmNames = @()
        for ($i=0; $i -lt $numVMs; $i++)
        {
           $vmNames+=("$prefix-vm"+($i+1) + "-$region-$country" );
        }

        #select an Azure subscription already imported into Powershell session
        Select-AzureSubscription -SubscriptionName $subscriptionName -Current
        Set-AzureSubscription -SubscriptionName $subscriptionName -CurrentStorageAccountName $storageAccount

        #create an empty cloud service
        New-AzureService -ServiceName $serviceName -Label "hkcass$region" -Location $azureRegion
        Write-Host "Created $serviceName"

        $VMList= @()   # stores hello list of azure vm configuration objects
        #create hello list of VMs
        foreach($vmName in $vmNames)
        {
           $VMList += New-AzureVMConfig -Name $vmName -InstanceSize ExtraSmall -ImageName $imageName |
           Add-AzureProvisioningConfig -Linux -LinuxUser "localadmin" -Password "Local123" |
           Set-AzureSubnet "data"
        }

        New-AzureVM -ServiceName $serviceName -VNetName $vnetName -VMs $VMList

        #Create internal load balancer
        Add-AzureInternalLoadBalancer -ServiceName $serviceName -InternalLoadBalancerName $ilbName -SubnetName "data" -StaticVNetIPAddress "$ilbIP"
        Write-Host "Created $ilbName"
        #Add add hello thrift endpoint toohello internal load balancer for all hello VMs
        foreach($vmName in $vmNames)
        {
            Get-AzureVM -ServiceName $serviceName -Name $vmName |
                Add-AzureEndpoint -Name $thriftEndPoint -LBSetName "ThriftLBSet" -Protocol tcp -LocalPort 9160 -PublicPort 9160 -ProbePort 9160 -ProbeProtocol tcp -ProbeIntervalInSeconds 10 -InternalLoadBalancerName $ilbName |
                Update-AzureVM

            Write-Host "created $vmName"     
        }

<span data-ttu-id="2efa3-480">**Etapa 3: configurar o Cassandra em cada VM**</span><span class="sxs-lookup"><span data-stu-id="2efa3-480">**Step 3: Configure Cassandra on each VM**</span></span>

<span data-ttu-id="2efa3-481">Faça logon no hello VM e executar Olá seguinte:</span><span class="sxs-lookup"><span data-stu-id="2efa3-481">Log into hello VM and perform hello following:</span></span>

* <span data-ttu-id="2efa3-482">Edite $CASS_HOME/conf/cassandra-rackdc.properties toospecify Olá data center e rack propriedades:</span><span class="sxs-lookup"><span data-stu-id="2efa3-482">Edit $CASS_HOME/conf/cassandra-rackdc.properties toospecify hello data center and rack properties:</span></span>
  
       dc =EASTUS, rack =rack1
* <span data-ttu-id="2efa3-483">Edite nós de propagação de tooconfigure cassandra.yaml como abaixo:</span><span class="sxs-lookup"><span data-stu-id="2efa3-483">Edit cassandra.yaml tooconfigure seed nodes as below:</span></span>
  
       Seeds: "10.1.2.4,10.1.2.6,10.1.2.8,10.1.2.10"

<span data-ttu-id="2efa3-484">**Etapa 4: Iniciar VMs hello e testar a saudação do cluster**</span><span class="sxs-lookup"><span data-stu-id="2efa3-484">**Step 4: Start hello VMs and test hello cluster**</span></span>

<span data-ttu-id="2efa3-485">Log em um de nós de saudação (por exemplo, Hong Kong-c1-Oeste-us) e execução Olá seguindo o status do comando toosee saudação do cluster hello:</span><span class="sxs-lookup"><span data-stu-id="2efa3-485">Log into one of hello nodes (e.g. hk-c1-west-us) and run hello following command toosee hello status of hello cluster:</span></span>

       nodetool –h 10.1.2.4 –p 7199 status

<span data-ttu-id="2efa3-486">Você deve ver Olá exibição semelhante toohello um abaixo de um cluster de 8 nós:</span><span class="sxs-lookup"><span data-stu-id="2efa3-486">You should see hello display similar toohello one below for an 8-node cluster:</span></span>

<table>
<tr><th><span data-ttu-id="2efa3-487">Status</span><span class="sxs-lookup"><span data-stu-id="2efa3-487">Status</span></span></th><th><span data-ttu-id="2efa3-488">Endereço</span><span class="sxs-lookup"><span data-stu-id="2efa3-488">Address</span></span>    </th><th><span data-ttu-id="2efa3-489">Carregar</span><span class="sxs-lookup"><span data-stu-id="2efa3-489">Load</span></span>    </th><th><span data-ttu-id="2efa3-490">Tokens</span><span class="sxs-lookup"><span data-stu-id="2efa3-490">Tokens</span></span>    </th><th><span data-ttu-id="2efa3-491">Possui</span><span class="sxs-lookup"><span data-stu-id="2efa3-491">Owns</span></span> </th><th><span data-ttu-id="2efa3-492">ID do host</span><span class="sxs-lookup"><span data-stu-id="2efa3-492">Host ID</span></span>    </th><th><span data-ttu-id="2efa3-493">Rack</span><span class="sxs-lookup"><span data-stu-id="2efa3-493">Rack</span></span></th></tr>
<tr><th><span data-ttu-id="2efa3-494">UN</span><span class="sxs-lookup"><span data-stu-id="2efa3-494">UN</span></span>    </td><td><span data-ttu-id="2efa3-495">10.1.2.4</span><span class="sxs-lookup"><span data-stu-id="2efa3-495">10.1.2.4</span></span>     </td><td><span data-ttu-id="2efa3-496">87.81 KB</span><span class="sxs-lookup"><span data-stu-id="2efa3-496">87.81 KB</span></span>    </td><td><span data-ttu-id="2efa3-497">256</span><span class="sxs-lookup"><span data-stu-id="2efa3-497">256</span></span>    </td><td><span data-ttu-id="2efa3-498">38,0%</span><span class="sxs-lookup"><span data-stu-id="2efa3-498">38.0%</span></span>    </td><td><span data-ttu-id="2efa3-499">Guid (removido)</span><span class="sxs-lookup"><span data-stu-id="2efa3-499">Guid (removed)</span></span></td><td><span data-ttu-id="2efa3-500">rack1</span><span class="sxs-lookup"><span data-stu-id="2efa3-500">rack1</span></span></td></tr>
<tr><th><span data-ttu-id="2efa3-501">UN</span><span class="sxs-lookup"><span data-stu-id="2efa3-501">UN</span></span>    </td><td><span data-ttu-id="2efa3-502">10.1.2.5</span><span class="sxs-lookup"><span data-stu-id="2efa3-502">10.1.2.5</span></span>     </td><td><span data-ttu-id="2efa3-503">41.08 KB</span><span class="sxs-lookup"><span data-stu-id="2efa3-503">41.08 KB</span></span>    </td><td><span data-ttu-id="2efa3-504">256</span><span class="sxs-lookup"><span data-stu-id="2efa3-504">256</span></span>    </td><td><span data-ttu-id="2efa3-505">68.9%</span><span class="sxs-lookup"><span data-stu-id="2efa3-505">68.9%</span></span>    </td><td><span data-ttu-id="2efa3-506">Guid (removido)</span><span class="sxs-lookup"><span data-stu-id="2efa3-506">Guid (removed)</span></span></td><td><span data-ttu-id="2efa3-507">rack1</span><span class="sxs-lookup"><span data-stu-id="2efa3-507">rack1</span></span></td></tr>
<tr><th><span data-ttu-id="2efa3-508">UN</span><span class="sxs-lookup"><span data-stu-id="2efa3-508">UN</span></span>    </td><td><span data-ttu-id="2efa3-509">10.1.2.6</span><span class="sxs-lookup"><span data-stu-id="2efa3-509">10.1.2.6</span></span>     </td><td><span data-ttu-id="2efa3-510">55.29 KB</span><span class="sxs-lookup"><span data-stu-id="2efa3-510">55.29 KB</span></span>    </td><td><span data-ttu-id="2efa3-511">256</span><span class="sxs-lookup"><span data-stu-id="2efa3-511">256</span></span>    </td><td><span data-ttu-id="2efa3-512">68.8%</span><span class="sxs-lookup"><span data-stu-id="2efa3-512">68.8%</span></span>    </td><td><span data-ttu-id="2efa3-513">Guid (removido)</span><span class="sxs-lookup"><span data-stu-id="2efa3-513">Guid (removed)</span></span></td><td><span data-ttu-id="2efa3-514">rack2</span><span class="sxs-lookup"><span data-stu-id="2efa3-514">rack2</span></span></td></tr>
<tr><th><span data-ttu-id="2efa3-515">UN</span><span class="sxs-lookup"><span data-stu-id="2efa3-515">UN</span></span>    </td><td><span data-ttu-id="2efa3-516">10.1.2.7</span><span class="sxs-lookup"><span data-stu-id="2efa3-516">10.1.2.7</span></span>     </td><td><span data-ttu-id="2efa3-517">55.29 KB</span><span class="sxs-lookup"><span data-stu-id="2efa3-517">55.29 KB</span></span>    </td><td><span data-ttu-id="2efa3-518">256</span><span class="sxs-lookup"><span data-stu-id="2efa3-518">256</span></span>    </td><td><span data-ttu-id="2efa3-519">68.8%</span><span class="sxs-lookup"><span data-stu-id="2efa3-519">68.8%</span></span>    </td><td><span data-ttu-id="2efa3-520">Guid (removido)</span><span class="sxs-lookup"><span data-stu-id="2efa3-520">Guid (removed)</span></span></td><td><span data-ttu-id="2efa3-521">rack2</span><span class="sxs-lookup"><span data-stu-id="2efa3-521">rack2</span></span></td></tr>
<tr><th><span data-ttu-id="2efa3-522">UN</span><span class="sxs-lookup"><span data-stu-id="2efa3-522">UN</span></span>    </td><td><span data-ttu-id="2efa3-523">10.1.2.8</span><span class="sxs-lookup"><span data-stu-id="2efa3-523">10.1.2.8</span></span>     </td><td><span data-ttu-id="2efa3-524">55.29 KB</span><span class="sxs-lookup"><span data-stu-id="2efa3-524">55.29 KB</span></span>    </td><td><span data-ttu-id="2efa3-525">256</span><span class="sxs-lookup"><span data-stu-id="2efa3-525">256</span></span>    </td><td><span data-ttu-id="2efa3-526">68.8%</span><span class="sxs-lookup"><span data-stu-id="2efa3-526">68.8%</span></span>    </td><td><span data-ttu-id="2efa3-527">Guid (removido)</span><span class="sxs-lookup"><span data-stu-id="2efa3-527">Guid (removed)</span></span></td><td><span data-ttu-id="2efa3-528">rack3</span><span class="sxs-lookup"><span data-stu-id="2efa3-528">rack3</span></span></td></tr>
<tr><th><span data-ttu-id="2efa3-529">UN</span><span class="sxs-lookup"><span data-stu-id="2efa3-529">UN</span></span>    </td><td><span data-ttu-id="2efa3-530">10.1.2.9</span><span class="sxs-lookup"><span data-stu-id="2efa3-530">10.1.2.9</span></span>     </td><td><span data-ttu-id="2efa3-531">55.29 KB</span><span class="sxs-lookup"><span data-stu-id="2efa3-531">55.29 KB</span></span>    </td><td><span data-ttu-id="2efa3-532">256</span><span class="sxs-lookup"><span data-stu-id="2efa3-532">256</span></span>    </td><td><span data-ttu-id="2efa3-533">68.8%</span><span class="sxs-lookup"><span data-stu-id="2efa3-533">68.8%</span></span>    </td><td><span data-ttu-id="2efa3-534">Guid (removido)</span><span class="sxs-lookup"><span data-stu-id="2efa3-534">Guid (removed)</span></span></td><td><span data-ttu-id="2efa3-535">rack3</span><span class="sxs-lookup"><span data-stu-id="2efa3-535">rack3</span></span></td></tr>
<tr><th><span data-ttu-id="2efa3-536">UN</span><span class="sxs-lookup"><span data-stu-id="2efa3-536">UN</span></span>    </td><td><span data-ttu-id="2efa3-537">10.1.2.10</span><span class="sxs-lookup"><span data-stu-id="2efa3-537">10.1.2.10</span></span>     </td><td><span data-ttu-id="2efa3-538">55.29 KB</span><span class="sxs-lookup"><span data-stu-id="2efa3-538">55.29 KB</span></span>    </td><td><span data-ttu-id="2efa3-539">256</span><span class="sxs-lookup"><span data-stu-id="2efa3-539">256</span></span>    </td><td><span data-ttu-id="2efa3-540">68.8%</span><span class="sxs-lookup"><span data-stu-id="2efa3-540">68.8%</span></span>    </td><td><span data-ttu-id="2efa3-541">Guid (removido)</span><span class="sxs-lookup"><span data-stu-id="2efa3-541">Guid (removed)</span></span></td><td><span data-ttu-id="2efa3-542">rack4</span><span class="sxs-lookup"><span data-stu-id="2efa3-542">rack4</span></span></td></tr>
<tr><th><span data-ttu-id="2efa3-543">UN</span><span class="sxs-lookup"><span data-stu-id="2efa3-543">UN</span></span>    </td><td><span data-ttu-id="2efa3-544">10.1.2.11</span><span class="sxs-lookup"><span data-stu-id="2efa3-544">10.1.2.11</span></span>     </td><td><span data-ttu-id="2efa3-545">55.29 KB</span><span class="sxs-lookup"><span data-stu-id="2efa3-545">55.29 KB</span></span>    </td><td><span data-ttu-id="2efa3-546">256</span><span class="sxs-lookup"><span data-stu-id="2efa3-546">256</span></span>    </td><td><span data-ttu-id="2efa3-547">68.8%</span><span class="sxs-lookup"><span data-stu-id="2efa3-547">68.8%</span></span>    </td><td><span data-ttu-id="2efa3-548">Guid (removido)</span><span class="sxs-lookup"><span data-stu-id="2efa3-548">Guid (removed)</span></span></td><td><span data-ttu-id="2efa3-549">rack4</span><span class="sxs-lookup"><span data-stu-id="2efa3-549">rack4</span></span></td></tr>
</table>

## <a name="test-hello-single-region-cluster"></a><span data-ttu-id="2efa3-550">Saudação de teste único Cluster de região</span><span class="sxs-lookup"><span data-stu-id="2efa3-550">Test hello Single Region Cluster</span></span>
<span data-ttu-id="2efa3-551">Use Olá cluster de saudação do tootest as etapas a seguir:</span><span class="sxs-lookup"><span data-stu-id="2efa3-551">Use hello following steps tootest hello cluster:</span></span>

1. <span data-ttu-id="2efa3-552">Usando Olá Powershell comando Get-AzureInternalLoadbalancer commandlet, obter o endereço IP de saudação do balanceador de carga interno de saudação (por exemplo  10.1.2.101).</span><span class="sxs-lookup"><span data-stu-id="2efa3-552">Using hello Powershell command Get-AzureInternalLoadbalancer commandlet, obtain hello IP address of hello internal load balancer (e.g.  10.1.2.101).</span></span> <span data-ttu-id="2efa3-553">sintaxe de saudação do comando de saudação é mostrado abaixo: Get-AzureLoadbalancer – ServiceName "hk-c-svc-Oeste-us" [exibe detalhes de saudação do balanceador de carga interno Olá junto com seu endereço IP]</span><span class="sxs-lookup"><span data-stu-id="2efa3-553">hello syntax of hello command is shown below: Get-AzureLoadbalancer –ServiceName "hk-c-svc-west-us” [displays hello details of hello internal load balancer along with its IP address]</span></span>
2. <span data-ttu-id="2efa3-554">Faça logon no farm de web hello VM (por exemplo, Hong Kong-w1-Oeste-us) usando Putty ou ssh</span><span class="sxs-lookup"><span data-stu-id="2efa3-554">Log into hello web farm VM (e.g. hk-w1-west-us) using Putty or ssh</span></span>
3. <span data-ttu-id="2efa3-555">Execute $CASS_HOME/bin/cqlsh 10.1.2.101 9160</span><span class="sxs-lookup"><span data-stu-id="2efa3-555">Execute $CASS_HOME/bin/cqlsh 10.1.2.101 9160</span></span>
4. <span data-ttu-id="2efa3-556">Use Olá CQL tooverify de comandos a seguir se Olá cluster está funcionando:</span><span class="sxs-lookup"><span data-stu-id="2efa3-556">Use hello following CQL commands tooverify if hello cluster is working:</span></span>
   
     <span data-ttu-id="2efa3-557">CREATE KEYSPACE customers_ks WITH REPLICATION = { 'class' : 'SimpleStrategy', 'replication_factor' : 3 };   USE customers_ks;   CREATE TABLE Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   INSERT INTO Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   INSERT INTO Customers(customer_id, firstname, lastname) VALUES (2, 'Jane', 'Doe');</span><span class="sxs-lookup"><span data-stu-id="2efa3-557">CREATE KEYSPACE customers_ks WITH REPLICATION = { 'class' : 'SimpleStrategy', 'replication_factor' : 3 };   USE customers_ks;   CREATE TABLE Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   INSERT INTO Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   INSERT INTO Customers(customer_id, firstname, lastname) VALUES (2, 'Jane', 'Doe');</span></span>
   
     <span data-ttu-id="2efa3-558">SELECT * FROM Customers;</span><span class="sxs-lookup"><span data-stu-id="2efa3-558">SELECT * FROM Customers;</span></span>

<span data-ttu-id="2efa3-559">Você deve ver uma exibição como Olá abaixo:</span><span class="sxs-lookup"><span data-stu-id="2efa3-559">You should see a display like hello one below:</span></span>

<table>
  <tr><th> <span data-ttu-id="2efa3-560">customer_id</span><span class="sxs-lookup"><span data-stu-id="2efa3-560">customer_id</span></span> </th><th> <span data-ttu-id="2efa3-561">nome</span><span class="sxs-lookup"><span data-stu-id="2efa3-561">firstname</span></span> </th><th> <span data-ttu-id="2efa3-562">Sobrenome</span><span class="sxs-lookup"><span data-stu-id="2efa3-562">lastname</span></span> </th></tr>
  <tr><td> <span data-ttu-id="2efa3-563">1</span><span class="sxs-lookup"><span data-stu-id="2efa3-563">1</span></span> </td><td> <span data-ttu-id="2efa3-564">John</span><span class="sxs-lookup"><span data-stu-id="2efa3-564">John</span></span> </td><td> <span data-ttu-id="2efa3-565">Doe</span><span class="sxs-lookup"><span data-stu-id="2efa3-565">Doe</span></span> </td></tr>
  <tr><td> <span data-ttu-id="2efa3-566">2</span><span class="sxs-lookup"><span data-stu-id="2efa3-566">2</span></span> </td><td> <span data-ttu-id="2efa3-567">Jane</span><span class="sxs-lookup"><span data-stu-id="2efa3-567">Jane</span></span> </td><td> <span data-ttu-id="2efa3-568">Doe</span><span class="sxs-lookup"><span data-stu-id="2efa3-568">Doe</span></span> </td></tr>
</table>

<span data-ttu-id="2efa3-569">Observe que keyspace Olá criado na etapa 4 usa SimpleStrategy com um replication_factor de 3.</span><span class="sxs-lookup"><span data-stu-id="2efa3-569">Please note that hello keyspace created in step 4 uses SimpleStrategy with a  replication_factor of 3.</span></span> <span data-ttu-id="2efa3-570">SimpleStrategy é recomendado para implantações únicas de data center, enquanto NetworkTopologyStrategy é recomendado para implantações de vários data centers.</span><span class="sxs-lookup"><span data-stu-id="2efa3-570">SimpleStrategy is recommended for single data center deployments whereas NetworkTopologyStrategy for multi-data center deployments.</span></span> <span data-ttu-id="2efa3-571">Um replication_factor de 3 fornecerá tolerância às falhas do nó.</span><span class="sxs-lookup"><span data-stu-id="2efa3-571">A replication_factor of 3 will give tolerance for node failures.</span></span>

## <span data-ttu-id="2efa3-572"><a id="tworegion"> </a>Processo de implantação de várias regiões</span><span class="sxs-lookup"><span data-stu-id="2efa3-572"><a id="tworegion"> </a>Multi-Region Deployment Process</span></span>
<span data-ttu-id="2efa3-573">Será aproveitar a implantação de região única Olá concluída e repita Olá mesmo processo para instalar a segunda área de saudação.</span><span class="sxs-lookup"><span data-stu-id="2efa3-573">Will leverage hello single region deployment completed and repeat hello same process for installing hello second region.</span></span> <span data-ttu-id="2efa3-574">Olá principal diferença entre hello único e implantação de várias regiões é a configuração de túnel VPN Olá para comunicação entre região; Vamos começar com a instalação de rede hello, provisionar máquinas virtuais de saudação e configurar Cassandra.</span><span class="sxs-lookup"><span data-stu-id="2efa3-574">hello key difference between hello single and multiple region deployment is hello VPN tunnel setup for inter-region communication; we will start with hello network installation, provision hello VMs and configure Cassandra.</span></span>

### <a name="step-1-create-hello-virtual-network-at-hello-2nd-region"></a><span data-ttu-id="2efa3-575">Etapa 1: Criar hello rede Virtual no hello 2º região</span><span class="sxs-lookup"><span data-stu-id="2efa3-575">Step 1: Create hello Virtual Network at hello 2nd Region</span></span>
<span data-ttu-id="2efa3-576">Faça logon no hello portal clássico do Azure e criar uma rede Virtual com hello Mostrar de atributos na tabela de saudação.</span><span class="sxs-lookup"><span data-stu-id="2efa3-576">Log into hello Azure classic portal and create a Virtual Network with hello attributes show in hello table.</span></span> <span data-ttu-id="2efa3-577">Consulte [configurar uma rede Virtual somente em nuvem no portal clássico do Azure de saudação](../../../virtual-network/virtual-networks-create-vnet-classic-pportal.md) para obter etapas detalhadas do processo de saudação.</span><span class="sxs-lookup"><span data-stu-id="2efa3-577">See [Configure a Cloud-Only Virtual Network in hello Azure classic portal](../../../virtual-network/virtual-networks-create-vnet-classic-pportal.md) for detailed steps of hello process.</span></span>      

<table>
<tr><th><span data-ttu-id="2efa3-578">Nome do atributo</span><span class="sxs-lookup"><span data-stu-id="2efa3-578">Attribute Name</span></span>    </th><th><span data-ttu-id="2efa3-579">Valor</span><span class="sxs-lookup"><span data-stu-id="2efa3-579">Value</span></span>    </th><th><span data-ttu-id="2efa3-580">Comentários</span><span class="sxs-lookup"><span data-stu-id="2efa3-580">Remarks</span></span></th></tr>
<tr><td><span data-ttu-id="2efa3-581">Name</span><span class="sxs-lookup"><span data-stu-id="2efa3-581">Name</span></span>    </td><td><span data-ttu-id="2efa3-582">vnet-cass-east-us</span><span class="sxs-lookup"><span data-stu-id="2efa3-582">vnet-cass-east-us</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="2efa3-583">Região</span><span class="sxs-lookup"><span data-stu-id="2efa3-583">Region</span></span>    </td><td><span data-ttu-id="2efa3-584">Leste dos EUA</span><span class="sxs-lookup"><span data-stu-id="2efa3-584">East US</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="2efa3-585">Servidores DNS</span><span class="sxs-lookup"><span data-stu-id="2efa3-585">DNS Servers</span></span>        </td><td></td><td><span data-ttu-id="2efa3-586">Ignore isso, pois não estamos usando um servidor DNS</span><span class="sxs-lookup"><span data-stu-id="2efa3-586">Ignore this as we are not using a DNS Server</span></span></td></tr>
<tr><td><span data-ttu-id="2efa3-587">Configurar uma VPN ponto a site</span><span class="sxs-lookup"><span data-stu-id="2efa3-587">Configure a point-to-site VPN</span></span></td><td></td><td>        <span data-ttu-id="2efa3-588">Ignore isso</span><span class="sxs-lookup"><span data-stu-id="2efa3-588">Ignore this</span></span></td></tr>
<tr><td><span data-ttu-id="2efa3-589">Configurar uma VPN site a site</span><span class="sxs-lookup"><span data-stu-id="2efa3-589">Configure a site-to-site VPN</span></span></td><td></td><td>        <span data-ttu-id="2efa3-590">Ignore isso</span><span class="sxs-lookup"><span data-stu-id="2efa3-590">Ignore this</span></span></td></tr>
<tr><td><span data-ttu-id="2efa3-591">Espaço de endereço</span><span class="sxs-lookup"><span data-stu-id="2efa3-591">Address Space</span></span>    </td><td><span data-ttu-id="2efa3-592">10.2.0.0/16</span><span class="sxs-lookup"><span data-stu-id="2efa3-592">10.2.0.0/16</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="2efa3-593">IP Inicial</span><span class="sxs-lookup"><span data-stu-id="2efa3-593">Starting IP</span></span>    </td><td><span data-ttu-id="2efa3-594">10.2.0.0</span><span class="sxs-lookup"><span data-stu-id="2efa3-594">10.2.0.0</span></span>    </td><td></td></tr>
<tr><td><span data-ttu-id="2efa3-595">CIDR</span><span class="sxs-lookup"><span data-stu-id="2efa3-595">CIDR</span></span>    </td><td><span data-ttu-id="2efa3-596">/16 (65531)</span><span class="sxs-lookup"><span data-stu-id="2efa3-596">/16 (65531)</span></span></td><td></td></tr>
</table>

<span data-ttu-id="2efa3-597">Adicione Olá seguintes sub-redes:</span><span class="sxs-lookup"><span data-stu-id="2efa3-597">Add hello following subnets:</span></span>

<table>
<tr><th><span data-ttu-id="2efa3-598">Nome</span><span class="sxs-lookup"><span data-stu-id="2efa3-598">Name</span></span>    </th><th><span data-ttu-id="2efa3-599">IP Inicial</span><span class="sxs-lookup"><span data-stu-id="2efa3-599">Starting IP</span></span>    </th><th><span data-ttu-id="2efa3-600">CIDR</span><span class="sxs-lookup"><span data-stu-id="2efa3-600">CIDR</span></span>    </th><th><span data-ttu-id="2efa3-601">Comentários</span><span class="sxs-lookup"><span data-stu-id="2efa3-601">Remarks</span></span></th></tr>
<tr><td><span data-ttu-id="2efa3-602">web</span><span class="sxs-lookup"><span data-stu-id="2efa3-602">web</span></span>    </td><td><span data-ttu-id="2efa3-603">10.2.1.0</span><span class="sxs-lookup"><span data-stu-id="2efa3-603">10.2.1.0</span></span>    </td><td><span data-ttu-id="2efa3-604">/24 (251)</span><span class="sxs-lookup"><span data-stu-id="2efa3-604">/24 (251)</span></span>    </td><td><span data-ttu-id="2efa3-605">Subrede do farm da web de saudação</span><span class="sxs-lookup"><span data-stu-id="2efa3-605">Subnet for hello web farm</span></span></td></tr>
<tr><td><span data-ttu-id="2efa3-606">data</span><span class="sxs-lookup"><span data-stu-id="2efa3-606">data</span></span>    </td><td><span data-ttu-id="2efa3-607">10.2.2.0</span><span class="sxs-lookup"><span data-stu-id="2efa3-607">10.2.2.0</span></span>    </td><td><span data-ttu-id="2efa3-608">/24 (251)</span><span class="sxs-lookup"><span data-stu-id="2efa3-608">/24 (251)</span></span>    </td><td><span data-ttu-id="2efa3-609">Sub-rede para nós de banco de dados de saudação</span><span class="sxs-lookup"><span data-stu-id="2efa3-609">Subnet for hello database nodes</span></span></td></tr>
</table>


### <a name="step-2-create-local-networks"></a><span data-ttu-id="2efa3-610">Etapa 2: criar Redes Locais</span><span class="sxs-lookup"><span data-stu-id="2efa3-610">Step 2: Create Local Networks</span></span>
<span data-ttu-id="2efa3-611">Uma rede Local na rede virtual do Azure é um espaço de endereço de proxy que mapeia o site remoto tooa, incluindo uma nuvem privada ou outra região do Azure.</span><span class="sxs-lookup"><span data-stu-id="2efa3-611">A Local Network in Azure virtual networking is a proxy address space that maps tooa remote site including a private cloud or another Azure region.</span></span> <span data-ttu-id="2efa3-612">Este espaço de endereço de proxy é tooa associado o gateway remoto para roteamento toohello rede direito destinos de sistema de rede.</span><span class="sxs-lookup"><span data-stu-id="2efa3-612">This proxy address space is bound tooa remote gateway for routing network toohello right networking destinations.</span></span> <span data-ttu-id="2efa3-613">Consulte [configurar uma Conexão de tooVNet de VNet](../../../vpn-gateway/virtual-networks-configure-vnet-to-vnet-connection.md) para obter instruções sobre como estabelecer a conexão de rede virtual a rede hello.</span><span class="sxs-lookup"><span data-stu-id="2efa3-613">See [Configure a VNet tooVNet Connection](../../../vpn-gateway/virtual-networks-configure-vnet-to-vnet-connection.md) for hello instructions on establishing VNET-to-VNET connection.</span></span>

<span data-ttu-id="2efa3-614">Crie duas redes locais por Olá detalhes a seguir:</span><span class="sxs-lookup"><span data-stu-id="2efa3-614">Create two local networks per hello following details:</span></span>

| <span data-ttu-id="2efa3-615">Nome da rede</span><span class="sxs-lookup"><span data-stu-id="2efa3-615">Network Name</span></span> | <span data-ttu-id="2efa3-616">Endereço do Gateway da VPN</span><span class="sxs-lookup"><span data-stu-id="2efa3-616">VPN Gateway Address</span></span> | <span data-ttu-id="2efa3-617">Espaço de endereço</span><span class="sxs-lookup"><span data-stu-id="2efa3-617">Address Space</span></span> | <span data-ttu-id="2efa3-618">Comentários</span><span class="sxs-lookup"><span data-stu-id="2efa3-618">Remarks</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="2efa3-619">hk-lnet-map-to-east-us</span><span class="sxs-lookup"><span data-stu-id="2efa3-619">hk-lnet-map-to-east-us</span></span> |<span data-ttu-id="2efa3-620">23.1.1.1</span><span class="sxs-lookup"><span data-stu-id="2efa3-620">23.1.1.1</span></span> |<span data-ttu-id="2efa3-621">10.2.0.0/16</span><span class="sxs-lookup"><span data-stu-id="2efa3-621">10.2.0.0/16</span></span> |<span data-ttu-id="2efa3-622">Ao criar hello rede Local oferecem um espaço reservado para o endereço de gateway.</span><span class="sxs-lookup"><span data-stu-id="2efa3-622">While creating hello Local Network give a placeholder gateway address.</span></span> <span data-ttu-id="2efa3-623">endereço de gateway real Olá é preenchido quando Olá gateway é criado.</span><span class="sxs-lookup"><span data-stu-id="2efa3-623">hello real gateway address is filled once hello gateway is created.</span></span> <span data-ttu-id="2efa3-624">Certifique-se de espaço de endereço Olá corresponde exatamente Olá respectiva rede virtual remota; Nesse caso hello rede virtual criado no hello região Leste dos EUA.</span><span class="sxs-lookup"><span data-stu-id="2efa3-624">Make sure hello address space exactly matches hello respective remote VNET; in this case hello VNET created in hello East US region.</span></span> |
| <span data-ttu-id="2efa3-625">hk-lnet-map-to-west-us</span><span class="sxs-lookup"><span data-stu-id="2efa3-625">hk-lnet-map-to-west-us</span></span> |<span data-ttu-id="2efa3-626">23.2.2.2</span><span class="sxs-lookup"><span data-stu-id="2efa3-626">23.2.2.2</span></span> |<span data-ttu-id="2efa3-627">10.1.0.0/16</span><span class="sxs-lookup"><span data-stu-id="2efa3-627">10.1.0.0/16</span></span> |<span data-ttu-id="2efa3-628">Ao criar hello rede Local oferecem um espaço reservado para o endereço de gateway.</span><span class="sxs-lookup"><span data-stu-id="2efa3-628">While creating hello Local Network give a placeholder gateway address.</span></span> <span data-ttu-id="2efa3-629">endereço de gateway real Olá é preenchido quando Olá gateway é criado.</span><span class="sxs-lookup"><span data-stu-id="2efa3-629">hello real gateway address is filled once hello gateway is created.</span></span> <span data-ttu-id="2efa3-630">Certifique-se de espaço de endereço Olá corresponde exatamente Olá respectiva rede virtual remota; Nesse caso hello rede virtual criado no hello região Oeste dos EUA.</span><span class="sxs-lookup"><span data-stu-id="2efa3-630">Make sure hello address space exactly matches hello respective remote VNET; in this case hello VNET created in hello West US region.</span></span> |

### <a name="step-3-map-local-network-toohello-respective-vnets"></a><span data-ttu-id="2efa3-631">Etapa 3: Mapa "Local" rede toohello VNETs do respectivos</span><span class="sxs-lookup"><span data-stu-id="2efa3-631">Step 3: Map “Local” network toohello respective VNETs</span></span>
<span data-ttu-id="2efa3-632">De Olá portal clássico do Azure, selecione cada rede virtual, clique em "Configurar", verifique "Conectar toohello local rede" e selecione Olá de redes locais por Olá detalhes a seguir:</span><span class="sxs-lookup"><span data-stu-id="2efa3-632">From hello Azure classic portal, select each vnet, click “Configure”, check “Connect toohello local network”, and select hello Local Networks per hello following details:</span></span>

| <span data-ttu-id="2efa3-633">Rede Virtual</span><span class="sxs-lookup"><span data-stu-id="2efa3-633">Virtual Network</span></span> | <span data-ttu-id="2efa3-634">Rede Local</span><span class="sxs-lookup"><span data-stu-id="2efa3-634">Local Network</span></span> |
| --- | --- |
| <span data-ttu-id="2efa3-635">hk-vnet-west-us</span><span class="sxs-lookup"><span data-stu-id="2efa3-635">hk-vnet-west-us</span></span> |<span data-ttu-id="2efa3-636">hk-lnet-map-to-east-us</span><span class="sxs-lookup"><span data-stu-id="2efa3-636">hk-lnet-map-to-east-us</span></span> |
| <span data-ttu-id="2efa3-637">hk-vnet-east-us</span><span class="sxs-lookup"><span data-stu-id="2efa3-637">hk-vnet-east-us</span></span> |<span data-ttu-id="2efa3-638">hk-lnet-map-to-west-us</span><span class="sxs-lookup"><span data-stu-id="2efa3-638">hk-lnet-map-to-west-us</span></span> |

### <a name="step-4-create-gateways-on-vnet1-and-vnet2"></a><span data-ttu-id="2efa3-639">Etapa 4: criar Gateways em VNET1 e VNET2</span><span class="sxs-lookup"><span data-stu-id="2efa3-639">Step 4: Create Gateways on VNET1 and VNET2</span></span>
<span data-ttu-id="2efa3-640">No painel de saudação de ambas as redes virtuais hello, clique criar GATEWAY que irá disparar o processo de provisionamento do gateway VPN hello.</span><span class="sxs-lookup"><span data-stu-id="2efa3-640">From hello dashboard of both hello virtual networks, click CREATE GATEWAY which will trigger hello VPN gateway provisioning process.</span></span> <span data-ttu-id="2efa3-641">Depois de alguns minutos Olá painel de cada rede virtual deve exibir o endereço de gateway real hello.</span><span class="sxs-lookup"><span data-stu-id="2efa3-641">After a few minutes hello dashboard of each virtual network should display hello actual gateway address.</span></span>

### <a name="step-5-update-local-networks-with-hello-respective-gateway-addresses"></a><span data-ttu-id="2efa3-642">Etapa 5: Redes de "Local" atualização com endereços de Gateway do respectivos"" hello</span><span class="sxs-lookup"><span data-stu-id="2efa3-642">Step 5: Update “Local” networks with hello respective “Gateway” addresses</span></span>
<span data-ttu-id="2efa3-643">Edite os dois Olá redes locais tooreplace Olá espaço reservado gateway IP endereço com endereço IP real de saudação do hello apenas provisionado gateways.</span><span class="sxs-lookup"><span data-stu-id="2efa3-643">Edit both hello local networks tooreplace hello placeholder gateway IP address with hello real IP address of hello just provisioned gateways.</span></span> <span data-ttu-id="2efa3-644">Use Olá mapeamento a seguir:</span><span class="sxs-lookup"><span data-stu-id="2efa3-644">Use hello following mapping:</span></span>

<table>
<tr><th><span data-ttu-id="2efa3-645">Rede Local</span><span class="sxs-lookup"><span data-stu-id="2efa3-645">Local Network</span></span>    </th><th><span data-ttu-id="2efa3-646">Gateway de Rede Virtual</span><span class="sxs-lookup"><span data-stu-id="2efa3-646">Virtual Network Gateway</span></span></th></tr>
<tr><td><span data-ttu-id="2efa3-647">hk-lnet-map-to-east-us</span><span class="sxs-lookup"><span data-stu-id="2efa3-647">hk-lnet-map-to-east-us</span></span> </td><td><span data-ttu-id="2efa3-648">Gateway de hk-vnet-west-us</span><span class="sxs-lookup"><span data-stu-id="2efa3-648">Gateway of hk-vnet-west-us</span></span></td></tr>
<tr><td><span data-ttu-id="2efa3-649">hk-lnet-map-to-west-us</span><span class="sxs-lookup"><span data-stu-id="2efa3-649">hk-lnet-map-to-west-us</span></span> </td><td><span data-ttu-id="2efa3-650">Gateway de hk-vnet-east-us</span><span class="sxs-lookup"><span data-stu-id="2efa3-650">Gateway of hk-vnet-east-us</span></span></td></tr>
</table>

### <a name="step-6-update-hello-shared-key"></a><span data-ttu-id="2efa3-651">Etapa 6: Atualizar a chave compartilhada Olá</span><span class="sxs-lookup"><span data-stu-id="2efa3-651">Step 6: Update hello shared key</span></span>
<span data-ttu-id="2efa3-652">Saudação de uso após a chave do Powershell script tooupdate Olá IPSec de cada gateway VPN [usar Olá mesma chave para ambos os gateways Olá]: hk-lnet-map-to-west-us LocalNetworkSiteName - conjunto-AzureVNetGatewayKey - VNetName hk-vnet-Leste-us - SharedKey D9E76BKK Conjunto AzureVNetGatewayKey - VNetName hk-vnet-Oeste-us - LocalNetworkSiteName hk-lnet-map-to-east-us - SharedKey D9E76BKK</span><span class="sxs-lookup"><span data-stu-id="2efa3-652">Use hello following Powershell script tooupdate hello IPSec key of each VPN gateway [use hello sake key for both hello gateways]: Set-AzureVNetGatewayKey -VNetName hk-vnet-east-us -LocalNetworkSiteName hk-lnet-map-to-west-us -SharedKey D9E76BKK Set-AzureVNetGatewayKey -VNetName hk-vnet-west-us -LocalNetworkSiteName hk-lnet-map-to-east-us -SharedKey D9E76BKK</span></span>

### <a name="step-7-establish-hello-vnet-to-vnet-connection"></a><span data-ttu-id="2efa3-653">Etapa 7: Estabeleça conexão Olá VNET para VNET</span><span class="sxs-lookup"><span data-stu-id="2efa3-653">Step 7: Establish hello VNET-to-VNET connection</span></span>
<span data-ttu-id="2efa3-654">De Olá portal clássico do Azure, use o menu de "Painel" de saudação de ambas as conexão de gateway a gateway tooestablish Olá redes virtuais.</span><span class="sxs-lookup"><span data-stu-id="2efa3-654">From hello Azure classic portal, use hello “DASHBOARD” menu of both hello virtual networks tooestablish gateway-to-gateway connection.</span></span> <span data-ttu-id="2efa3-655">Use itens de menu "Conectar-se" Olá, na barra de ferramentas do hello inferior.</span><span class="sxs-lookup"><span data-stu-id="2efa3-655">Use hello “CONNECT” menu items in hello bottom toolbar.</span></span> <span data-ttu-id="2efa3-656">Depois de alguns minutos painel Olá deve exibir detalhes de conexão Olá graficamente.</span><span class="sxs-lookup"><span data-stu-id="2efa3-656">After a few minutes hello dashboard should display hello connection details graphically.</span></span>

### <a name="step-8-create-hello-virtual-machines-in-region-2"></a><span data-ttu-id="2efa3-657">Etapa 8: Criar máquinas virtuais de saudação na região #2</span><span class="sxs-lookup"><span data-stu-id="2efa3-657">Step 8: Create hello virtual machines in region #2</span></span>
<span data-ttu-id="2efa3-658">Criar imagem de Ubuntu Olá conforme descrito na implantação de região #1 pela seguinte Olá mesmo etapas ou copiar Olá imagem VHD arquivo toohello conta de armazenamento Azure localizada na região #2 e criar imagem hello.</span><span class="sxs-lookup"><span data-stu-id="2efa3-658">Create hello Ubuntu image as described in region #1 deployment by following hello same steps or copy hello image VHD file toohello Azure storage account located in region #2 and create hello image.</span></span> <span data-ttu-id="2efa3-659">Usar essa imagem e criar hello seguindo a lista de máquinas virtuais em um novo serviço de nuvem hk-c-svc-Leste-nos:</span><span class="sxs-lookup"><span data-stu-id="2efa3-659">Use this image and create hello following list of virtual machines into a new cloud service hk-c-svc-east-us:</span></span>

| <span data-ttu-id="2efa3-660">Nome da máquina</span><span class="sxs-lookup"><span data-stu-id="2efa3-660">Machine Name</span></span> | <span data-ttu-id="2efa3-661">Sub-rede</span><span class="sxs-lookup"><span data-stu-id="2efa3-661">Subnet</span></span> | <span data-ttu-id="2efa3-662">Endereço IP</span><span class="sxs-lookup"><span data-stu-id="2efa3-662">IP Address</span></span> | <span data-ttu-id="2efa3-663">Conjunto de disponibilidade</span><span class="sxs-lookup"><span data-stu-id="2efa3-663">Availability set</span></span> | <span data-ttu-id="2efa3-664">DC/Rack</span><span class="sxs-lookup"><span data-stu-id="2efa3-664">DC/Rack</span></span> | <span data-ttu-id="2efa3-665">Propagar?</span><span class="sxs-lookup"><span data-stu-id="2efa3-665">Seed?</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="2efa3-666">hk-c1-east-us</span><span class="sxs-lookup"><span data-stu-id="2efa3-666">hk-c1-east-us</span></span> |<span data-ttu-id="2efa3-667">data</span><span class="sxs-lookup"><span data-stu-id="2efa3-667">data</span></span> |<span data-ttu-id="2efa3-668">10.2.2.4</span><span class="sxs-lookup"><span data-stu-id="2efa3-668">10.2.2.4</span></span> |<span data-ttu-id="2efa3-669">hk-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="2efa3-669">hk-c-aset-1</span></span> |<span data-ttu-id="2efa3-670">dc =EASTUS rack =rack1</span><span class="sxs-lookup"><span data-stu-id="2efa3-670">dc =EASTUS rack =rack1</span></span> |<span data-ttu-id="2efa3-671">Sim</span><span class="sxs-lookup"><span data-stu-id="2efa3-671">Yes</span></span> |
| <span data-ttu-id="2efa3-672">hk-c2-east-us</span><span class="sxs-lookup"><span data-stu-id="2efa3-672">hk-c2-east-us</span></span> |<span data-ttu-id="2efa3-673">data</span><span class="sxs-lookup"><span data-stu-id="2efa3-673">data</span></span> |<span data-ttu-id="2efa3-674">10.2.2.5</span><span class="sxs-lookup"><span data-stu-id="2efa3-674">10.2.2.5</span></span> |<span data-ttu-id="2efa3-675">hk-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="2efa3-675">hk-c-aset-1</span></span> |<span data-ttu-id="2efa3-676">dc =EASTUS rack =rack1</span><span class="sxs-lookup"><span data-stu-id="2efa3-676">dc =EASTUS rack =rack1</span></span> |<span data-ttu-id="2efa3-677">Não</span><span class="sxs-lookup"><span data-stu-id="2efa3-677">No</span></span> |
| <span data-ttu-id="2efa3-678">hk-c3-east-us</span><span class="sxs-lookup"><span data-stu-id="2efa3-678">hk-c3-east-us</span></span> |<span data-ttu-id="2efa3-679">data</span><span class="sxs-lookup"><span data-stu-id="2efa3-679">data</span></span> |<span data-ttu-id="2efa3-680">10.2.2.6</span><span class="sxs-lookup"><span data-stu-id="2efa3-680">10.2.2.6</span></span> |<span data-ttu-id="2efa3-681">hk-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="2efa3-681">hk-c-aset-1</span></span> |<span data-ttu-id="2efa3-682">dc =EASTUS rack =rack2</span><span class="sxs-lookup"><span data-stu-id="2efa3-682">dc =EASTUS rack =rack2</span></span> |<span data-ttu-id="2efa3-683">Sim</span><span class="sxs-lookup"><span data-stu-id="2efa3-683">Yes</span></span> |
| <span data-ttu-id="2efa3-684">hk-c5-east-us</span><span class="sxs-lookup"><span data-stu-id="2efa3-684">hk-c5-east-us</span></span> |<span data-ttu-id="2efa3-685">data</span><span class="sxs-lookup"><span data-stu-id="2efa3-685">data</span></span> |<span data-ttu-id="2efa3-686">10.2.2.8</span><span class="sxs-lookup"><span data-stu-id="2efa3-686">10.2.2.8</span></span> |<span data-ttu-id="2efa3-687">hk-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="2efa3-687">hk-c-aset-2</span></span> |<span data-ttu-id="2efa3-688">dc =EASTUS rack =rack3</span><span class="sxs-lookup"><span data-stu-id="2efa3-688">dc =EASTUS rack =rack3</span></span> |<span data-ttu-id="2efa3-689">Sim</span><span class="sxs-lookup"><span data-stu-id="2efa3-689">Yes</span></span> |
| <span data-ttu-id="2efa3-690">hk-c6-east-us</span><span class="sxs-lookup"><span data-stu-id="2efa3-690">hk-c6-east-us</span></span> |<span data-ttu-id="2efa3-691">data</span><span class="sxs-lookup"><span data-stu-id="2efa3-691">data</span></span> |<span data-ttu-id="2efa3-692">10.2.2.9</span><span class="sxs-lookup"><span data-stu-id="2efa3-692">10.2.2.9</span></span> |<span data-ttu-id="2efa3-693">hk-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="2efa3-693">hk-c-aset-2</span></span> |<span data-ttu-id="2efa3-694">dc =EASTUS rack =rack3</span><span class="sxs-lookup"><span data-stu-id="2efa3-694">dc =EASTUS rack =rack3</span></span> |<span data-ttu-id="2efa3-695">Não</span><span class="sxs-lookup"><span data-stu-id="2efa3-695">No</span></span> |
| <span data-ttu-id="2efa3-696">hk-c7-east-us</span><span class="sxs-lookup"><span data-stu-id="2efa3-696">hk-c7-east-us</span></span> |<span data-ttu-id="2efa3-697">data</span><span class="sxs-lookup"><span data-stu-id="2efa3-697">data</span></span> |<span data-ttu-id="2efa3-698">10.2.2.10</span><span class="sxs-lookup"><span data-stu-id="2efa3-698">10.2.2.10</span></span> |<span data-ttu-id="2efa3-699">hk-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="2efa3-699">hk-c-aset-2</span></span> |<span data-ttu-id="2efa3-700">dc =EASTUS rack =rack4</span><span class="sxs-lookup"><span data-stu-id="2efa3-700">dc =EASTUS rack =rack4</span></span> |<span data-ttu-id="2efa3-701">Sim</span><span class="sxs-lookup"><span data-stu-id="2efa3-701">Yes</span></span> |
| <span data-ttu-id="2efa3-702">hk-c8-east-us</span><span class="sxs-lookup"><span data-stu-id="2efa3-702">hk-c8-east-us</span></span> |<span data-ttu-id="2efa3-703">data</span><span class="sxs-lookup"><span data-stu-id="2efa3-703">data</span></span> |<span data-ttu-id="2efa3-704">10.2.2.11</span><span class="sxs-lookup"><span data-stu-id="2efa3-704">10.2.2.11</span></span> |<span data-ttu-id="2efa3-705">hk-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="2efa3-705">hk-c-aset-2</span></span> |<span data-ttu-id="2efa3-706">dc =EASTUS rack =rack4</span><span class="sxs-lookup"><span data-stu-id="2efa3-706">dc =EASTUS rack =rack4</span></span> |<span data-ttu-id="2efa3-707">Não</span><span class="sxs-lookup"><span data-stu-id="2efa3-707">No</span></span> |
| <span data-ttu-id="2efa3-708">hk-w1-east-us</span><span class="sxs-lookup"><span data-stu-id="2efa3-708">hk-w1-east-us</span></span> |<span data-ttu-id="2efa3-709">web</span><span class="sxs-lookup"><span data-stu-id="2efa3-709">web</span></span> |<span data-ttu-id="2efa3-710">10.2.1.4</span><span class="sxs-lookup"><span data-stu-id="2efa3-710">10.2.1.4</span></span> |<span data-ttu-id="2efa3-711">hk-w-aset-1</span><span class="sxs-lookup"><span data-stu-id="2efa3-711">hk-w-aset-1</span></span> |<span data-ttu-id="2efa3-712">N/D</span><span class="sxs-lookup"><span data-stu-id="2efa3-712">N/A</span></span> |<span data-ttu-id="2efa3-713">N/D</span><span class="sxs-lookup"><span data-stu-id="2efa3-713">N/A</span></span> |
| <span data-ttu-id="2efa3-714">hk-w2-east-us</span><span class="sxs-lookup"><span data-stu-id="2efa3-714">hk-w2-east-us</span></span> |<span data-ttu-id="2efa3-715">web</span><span class="sxs-lookup"><span data-stu-id="2efa3-715">web</span></span> |<span data-ttu-id="2efa3-716">10.2.1.5</span><span class="sxs-lookup"><span data-stu-id="2efa3-716">10.2.1.5</span></span> |<span data-ttu-id="2efa3-717">hk-w-aset-1</span><span class="sxs-lookup"><span data-stu-id="2efa3-717">hk-w-aset-1</span></span> |<span data-ttu-id="2efa3-718">N/D</span><span class="sxs-lookup"><span data-stu-id="2efa3-718">N/A</span></span> |<span data-ttu-id="2efa3-719">N/D</span><span class="sxs-lookup"><span data-stu-id="2efa3-719">N/A</span></span> |

<span data-ttu-id="2efa3-720">Siga Olá mesmo instruções como região #1 mas usam o espaço de endereço 10.2.xxx.xxx.</span><span class="sxs-lookup"><span data-stu-id="2efa3-720">Follow hello same instructions as region #1 but use 10.2.xxx.xxx address space.</span></span>

### <a name="step-9-configure-cassandra-on-each-vm"></a><span data-ttu-id="2efa3-721">Etapa 9: configurar o Cassandra em cada VM</span><span class="sxs-lookup"><span data-stu-id="2efa3-721">Step 9: Configure Cassandra on each VM</span></span>
<span data-ttu-id="2efa3-722">Faça logon no hello VM e executar Olá seguinte:</span><span class="sxs-lookup"><span data-stu-id="2efa3-722">Log into hello VM and perform hello following:</span></span>

1. <span data-ttu-id="2efa3-723">Editar $CASS_HOME/conf/cassandra-rackdc.properties toospecify Olá center e rack propriedades de dados em formato de saudação: dc = rack EASTUS = rack1</span><span class="sxs-lookup"><span data-stu-id="2efa3-723">Edit $CASS_HOME/conf/cassandra-rackdc.properties toospecify hello data center and rack properties in hello format:  dc =EASTUS  rack =rack1</span></span>
2. <span data-ttu-id="2efa3-724">Editar nós de propagação de tooconfigure cassandra.yaml: sementes: "10.1.2.4,10.1.2.6,10.1.2.8,10.1.2.10,10.2.2.4,10.2.2.6,10.2.2.8,10.2.2.10"</span><span class="sxs-lookup"><span data-stu-id="2efa3-724">Edit cassandra.yaml tooconfigure seed nodes:  Seeds: "10.1.2.4,10.1.2.6,10.1.2.8,10.1.2.10,10.2.2.4,10.2.2.6,10.2.2.8,10.2.2.10"</span></span>

### <a name="step-10-start-cassandra"></a><span data-ttu-id="2efa3-725">Etapa 10: iniciar o Cassandra</span><span class="sxs-lookup"><span data-stu-id="2efa3-725">Step 10: Start Cassandra</span></span>
<span data-ttu-id="2efa3-726">Faça logon em cada VM e inicie Cassandra no plano de fundo Olá executando o comando a seguir de saudação: $CASS_HOME/bin/cassandra</span><span class="sxs-lookup"><span data-stu-id="2efa3-726">Log into each VM and start Cassandra in hello background by running hello following command: $CASS_HOME/bin/cassandra</span></span>

## <a name="test-hello-multi-region-cluster"></a><span data-ttu-id="2efa3-727">Cluster de várias regiões de saudação de teste</span><span class="sxs-lookup"><span data-stu-id="2efa3-727">Test hello Multi-Region Cluster</span></span>
<span data-ttu-id="2efa3-728">Agora Cassandra foi implantado too16 nós com 8 nós em cada região do Azure.</span><span class="sxs-lookup"><span data-stu-id="2efa3-728">By now Cassandra has been deployed too16 nodes with 8 nodes in each Azure region.</span></span> <span data-ttu-id="2efa3-729">Esses nós estão em Olá mesmo cluster por meio de nome de cluster comum hello e a configuração de nó de semente hello.</span><span class="sxs-lookup"><span data-stu-id="2efa3-729">These nodes are in hello same cluster by virtue of hello common cluster name and hello seed node configuration.</span></span> <span data-ttu-id="2efa3-730">Use Olá cluster de saudação do processo tootest a seguir:</span><span class="sxs-lookup"><span data-stu-id="2efa3-730">Use hello following process tootest hello cluster:</span></span>

### <a name="step-1-get-hello-internal-load-balancer-ip-for-both-hello-regions-using-powershell"></a><span data-ttu-id="2efa3-731">Etapa 1: Obter Olá IP de Balanceador de carga interno para ambas as regiões hello usando o PowerShell</span><span class="sxs-lookup"><span data-stu-id="2efa3-731">Step 1: Get hello internal load balancer IP for both hello regions using PowerShell</span></span>
* <span data-ttu-id="2efa3-732">Get-AzureInternalLoadbalancer -ServiceName "hk-c-svc-west-us"</span><span class="sxs-lookup"><span data-stu-id="2efa3-732">Get-AzureInternalLoadbalancer -ServiceName "hk-c-svc-west-us"</span></span>
* <span data-ttu-id="2efa3-733">Get-AzureInternalLoadbalancer -ServiceName "hk-c-svc-east-us"</span><span class="sxs-lookup"><span data-stu-id="2efa3-733">Get-AzureInternalLoadbalancer -ServiceName "hk-c-svc-east-us"</span></span>  
  
    <span data-ttu-id="2efa3-734">Observe os endereços IP hello (por exemplo, oeste - 10.1.2.101 Leste - 10.2.2.101) exibido.</span><span class="sxs-lookup"><span data-stu-id="2efa3-734">Note hello IP addresses (e.g. west - 10.1.2.101, east - 10.2.2.101) displayed.</span></span>

### <a name="step-2-execute-hello-following-in-hello-west-region-after-logging-into-hk-w1-west-us"></a><span data-ttu-id="2efa3-735">Etapa 2: Execute o seguinte de saudação na região oeste de saudação depois de fazer logon em Hong Kong-w1-Oeste-us</span><span class="sxs-lookup"><span data-stu-id="2efa3-735">Step 2: Execute hello following in hello west region after logging into hk-w1-west-us</span></span>
1. <span data-ttu-id="2efa3-736">Execute $CASS_HOME/bin/cqlsh 10.1.2.101 9160</span><span class="sxs-lookup"><span data-stu-id="2efa3-736">Execute $CASS_HOME/bin/cqlsh 10.1.2.101 9160</span></span>
2. <span data-ttu-id="2efa3-737">Execute Olá comandos CQL a seguir:</span><span class="sxs-lookup"><span data-stu-id="2efa3-737">Execute hello following CQL commands:</span></span>
   
     <span data-ttu-id="2efa3-738">CREATE KEYSPACE customers_ks   WITH REPLICATION = { 'class' : 'NetworkToplogyStrategy', 'WESTUS' : 3, 'EASTUS' : 3};   USE customers_ks;   CREATE TABLE Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   INSERT INTO Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   INSERT INTO Customers(customer_id, firstname, lastname) VALUES (2, 'Jane', 'Doe');   SELECT * FROM Customers;</span><span class="sxs-lookup"><span data-stu-id="2efa3-738">CREATE KEYSPACE customers_ks   WITH REPLICATION = { 'class' : 'NetworkToplogyStrategy', 'WESTUS' : 3, 'EASTUS' : 3};   USE customers_ks;   CREATE TABLE Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   INSERT INTO Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   INSERT INTO Customers(customer_id, firstname, lastname) VALUES (2, 'Jane', 'Doe');   SELECT * FROM Customers;</span></span>

<span data-ttu-id="2efa3-739">Você deve ver uma exibição como Olá abaixo:</span><span class="sxs-lookup"><span data-stu-id="2efa3-739">You should see a display like hello one below:</span></span>

| <span data-ttu-id="2efa3-740">customer_id</span><span class="sxs-lookup"><span data-stu-id="2efa3-740">customer_id</span></span> | <span data-ttu-id="2efa3-741">nome</span><span class="sxs-lookup"><span data-stu-id="2efa3-741">firstname</span></span> | <span data-ttu-id="2efa3-742">Sobrenome</span><span class="sxs-lookup"><span data-stu-id="2efa3-742">Lastname</span></span> |
| --- | --- | --- |
| <span data-ttu-id="2efa3-743">1</span><span class="sxs-lookup"><span data-stu-id="2efa3-743">1</span></span> |<span data-ttu-id="2efa3-744">John</span><span class="sxs-lookup"><span data-stu-id="2efa3-744">John</span></span> |<span data-ttu-id="2efa3-745">Doe</span><span class="sxs-lookup"><span data-stu-id="2efa3-745">Doe</span></span> |
| <span data-ttu-id="2efa3-746">2</span><span class="sxs-lookup"><span data-stu-id="2efa3-746">2</span></span> |<span data-ttu-id="2efa3-747">Jane</span><span class="sxs-lookup"><span data-stu-id="2efa3-747">Jane</span></span> |<span data-ttu-id="2efa3-748">Doe</span><span class="sxs-lookup"><span data-stu-id="2efa3-748">Doe</span></span> |

### <a name="step-3-execute-hello-following-in-hello-east-region-after-logging-into-hk-w1-east-us"></a><span data-ttu-id="2efa3-749">Etapa 3: Execute o seguinte Olá na região Leste de saudação depois de fazer logon em Hong Kong-w1-Leste-nos:</span><span class="sxs-lookup"><span data-stu-id="2efa3-749">Step 3: Execute hello following in hello east region after logging into hk-w1-east-us:</span></span>
1. <span data-ttu-id="2efa3-750">Execute $CASS_HOME/bin/cqlsh 10.2.2.101 9160</span><span class="sxs-lookup"><span data-stu-id="2efa3-750">Execute $CASS_HOME/bin/cqlsh 10.2.2.101 9160</span></span>
2. <span data-ttu-id="2efa3-751">Execute Olá comandos CQL a seguir:</span><span class="sxs-lookup"><span data-stu-id="2efa3-751">Execute hello following CQL commands:</span></span>
   
     <span data-ttu-id="2efa3-752">USE customers_ks;   CREATE TABLE Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   INSERT INTO Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   INSERT INTO Customers(customer_id, firstname, lastname) VALUES (2, 'Jane', 'Doe');   SELECT * FROM Customers;</span><span class="sxs-lookup"><span data-stu-id="2efa3-752">USE customers_ks;   CREATE TABLE Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   INSERT INTO Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   INSERT INTO Customers(customer_id, firstname, lastname) VALUES (2, 'Jane', 'Doe');   SELECT * FROM Customers;</span></span>

<span data-ttu-id="2efa3-753">Você deve ver Olá mesmo exibir como visto para região oeste de saudação:</span><span class="sxs-lookup"><span data-stu-id="2efa3-753">You should see hello same display as seen for hello West region:</span></span>

| <span data-ttu-id="2efa3-754">customer_id</span><span class="sxs-lookup"><span data-stu-id="2efa3-754">customer_id</span></span> | <span data-ttu-id="2efa3-755">nome</span><span class="sxs-lookup"><span data-stu-id="2efa3-755">firstname</span></span> | <span data-ttu-id="2efa3-756">Sobrenome</span><span class="sxs-lookup"><span data-stu-id="2efa3-756">Lastname</span></span> |
| --- | --- | --- |
| <span data-ttu-id="2efa3-757">1</span><span class="sxs-lookup"><span data-stu-id="2efa3-757">1</span></span> |<span data-ttu-id="2efa3-758">John</span><span class="sxs-lookup"><span data-stu-id="2efa3-758">John</span></span> |<span data-ttu-id="2efa3-759">Doe</span><span class="sxs-lookup"><span data-stu-id="2efa3-759">Doe</span></span> |
| <span data-ttu-id="2efa3-760">2</span><span class="sxs-lookup"><span data-stu-id="2efa3-760">2</span></span> |<span data-ttu-id="2efa3-761">Jane</span><span class="sxs-lookup"><span data-stu-id="2efa3-761">Jane</span></span> |<span data-ttu-id="2efa3-762">Doe</span><span class="sxs-lookup"><span data-stu-id="2efa3-762">Doe</span></span> |

<span data-ttu-id="2efa3-763">Executar inserções mais alguns e ver que os obtenham replicado toowest-us faz parte do cluster de saudação.</span><span class="sxs-lookup"><span data-stu-id="2efa3-763">Execute a few more inserts and see that those get replicated toowest-us part of hello cluster.</span></span>

## <a name="test-cassandra-cluster-from-nodejs"></a><span data-ttu-id="2efa3-764">Testar o cluster de Cassandra do Node.js</span><span class="sxs-lookup"><span data-stu-id="2efa3-764">Test Cassandra Cluster from Node.js</span></span>
<span data-ttu-id="2efa3-765">Usando uma das VMs do Linux Olá criado anteriormente na camada de "web" Olá, podemos executará um simples Node. js script tooread Olá inserida anteriormente de dados</span><span class="sxs-lookup"><span data-stu-id="2efa3-765">Using one of hello Linux VMs crated in hello "web" tier previously, we will execute a simple Node.js script tooread hello previously inserted data</span></span>

<span data-ttu-id="2efa3-766">**Etapa 1: instalar o Node.js e o cliente do Cassandra**</span><span class="sxs-lookup"><span data-stu-id="2efa3-766">**Step 1: Install Node.js and Cassandra Client**</span></span>

1. <span data-ttu-id="2efa3-767">Instale o Node.js e npm</span><span class="sxs-lookup"><span data-stu-id="2efa3-767">Install Node.js and npm</span></span>
2. <span data-ttu-id="2efa3-768">Instale o pacote de nó "cassandra-client" usando npm</span><span class="sxs-lookup"><span data-stu-id="2efa3-768">Install node package "cassandra-client" using npm</span></span>
3. <span data-ttu-id="2efa3-769">Execute Olá script no prompt de shell Olá que exibe a cadeia de caracteres de json de Olá Olá recuperada dados a seguir:</span><span class="sxs-lookup"><span data-stu-id="2efa3-769">Execute hello following script at hello shell prompt which displays hello json string of hello retrieved data:</span></span>
   
        var pooledCon = require('cassandra-client').PooledConnection;
        var ksName = "custsupport_ks";
        var cfName = "customers_cf";
        var hostList = ['internal_loadbalancer_ip:9160'];
        var ksConOptions = { hosts: hostList,
                             keyspace: ksName, use_bigints: false };
   
        function createKeyspace(callback){
           var cql = 'CREATE KEYSPACE ' + ksName + ' WITH strategy_class=SimpleStrategy AND strategy_options:replication_factor=1';
           var sysConOptions = { hosts: hostList,  
                                 keyspace: 'system', use_bigints: false };
           var con = new pooledCon(sysConOptions);
           con.execute(cql,[],function(err) {
           if (err) {
             console.log("Failed toocreate Keyspace: " + ksName);
             console.log(err);
           }
           else {
             console.log("Created Keyspace: " + ksName);
             callback(ksConOptions, populateCustomerData);
           }
           });
           con.shutdown();
        }
   
        function createColumnFamily(ksConOptions, callback){
          var params = ['customers_cf','custid','varint','custname',
                        'text','custaddress','text'];
          var cql = 'CREATE COLUMNFAMILY ? (? ? PRIMARY KEY,? ?, ? ?)';
        var con =  new pooledCon(ksConOptions);
          con.execute(cql,params,function(err) {
              if (err) {
                 console.log("Failed toocreate column family: " + params[0]);
                 console.log(err);
              }
              else {
                 console.log("Created column family: " + params[0]);
                 callback();
              }
          });
          con.shutdown();
        }
   
        //populate Data
        function populateCustomerData() {
           var params = ['John','Infinity Dr, TX', 1];
           updateCustomer(ksConOptions,params);
   
           params = ['Tom','Fermat Ln, WA', 2];
           updateCustomer(ksConOptions,params);
        }
   
        //update will also insert hello record if none exists
        function updateCustomer(ksConOptions,params)
        {
          var cql = 'UPDATE customers_cf SET custname=?,custaddress=? where custid=?';
          var con = new pooledCon(ksConOptions);
          con.execute(cql,params,function(err) {
              if (err) console.log(err);
              else console.log("Inserted customer : " + params[0]);
          });
          con.shutdown();
        }
   
        //read hello two rows inserted above
        function readCustomer(ksConOptions)
        {
          var cql = 'SELECT * FROM customers_cf WHERE custid IN (1,2)';
          var con = new pooledCon(ksConOptions);
          con.execute(cql,[],function(err,rows) {
              if (err)
                 console.log(err);
              else
                 for (var i=0; i<rows.length; i++)
                    console.log(JSON.stringify(rows[i]));
            });
           con.shutdown();
        }
   
        //exectue hello code
        createKeyspace(createColumnFamily);
        readCustomer(ksConOptions)

## <a name="conclusion"></a><span data-ttu-id="2efa3-770">Conclusão</span><span class="sxs-lookup"><span data-stu-id="2efa3-770">Conclusion</span></span>
<span data-ttu-id="2efa3-771">Microsoft Azure é uma plataforma flexível que permite a execução de saudação da Microsoft, bem como software livre conforme demonstrado por este exercício.</span><span class="sxs-lookup"><span data-stu-id="2efa3-771">Microsoft Azure is a flexible platform that allows hello running of both Microsoft as well as open source software as demonstrated by this exercise.</span></span> <span data-ttu-id="2efa3-772">Clusters de Cassandra altamente disponíveis podem ser implantados em um único data center por meio de saudação distribuindo Olá nós de cluster em vários domínios de falha.</span><span class="sxs-lookup"><span data-stu-id="2efa3-772">Highly available Cassandra clusters can be deployed on a single data center through hello spreading of hello cluster nodes across multiple fault domains.</span></span> <span data-ttu-id="2efa3-773">Os clusters de Cassandra também podem ser implantados em regiões geograficamente distantes do Azure para sistemas à prova de desastres.</span><span class="sxs-lookup"><span data-stu-id="2efa3-773">Cassandra clusters can also be deployed across multiple geographically distant Azure regions for disaster proof systems.</span></span> <span data-ttu-id="2efa3-774">Azure e habilita juntas Cassandra Olá construção de altamente escalonável, altamente disponível e os serviços de nuvem recuperáveis de desastres necessário pela internet de hoje dimensionar serviços.</span><span class="sxs-lookup"><span data-stu-id="2efa3-774">Azure and Cassandra together enables hello construction of highly scalable, highly available and disaster recoverable cloud services needed by today's internet scale services.</span></span>  

## <a name="references"></a><span data-ttu-id="2efa3-775">Referências</span><span class="sxs-lookup"><span data-stu-id="2efa3-775">References</span></span>
* [<span data-ttu-id="2efa3-776">http://cassandra.apache.org</span><span class="sxs-lookup"><span data-stu-id="2efa3-776">http://cassandra.apache.org</span></span>](http://cassandra.apache.org)
* [<span data-ttu-id="2efa3-777">http://www.datastax.com</span><span class="sxs-lookup"><span data-stu-id="2efa3-777">http://www.datastax.com</span></span>](http://www.datastax.com)
* [<span data-ttu-id="2efa3-778">http://www.nodejs.org</span><span class="sxs-lookup"><span data-stu-id="2efa3-778">http://www.nodejs.org</span></span>](http://www.nodejs.org)

