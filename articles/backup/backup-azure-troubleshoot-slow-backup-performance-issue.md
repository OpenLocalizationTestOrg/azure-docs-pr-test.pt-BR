---
title: "Solução do problema de lentidão de backup de arquivos e pastas no Backup do Azure | Microsoft Docs"
description: "Fornece orientação para solução de problemas para ajudá-lo a diagnosticar a causa dos problemas de desempenho de Backup do Azure"
services: backup
documentationcenter: 
author: genlin
manager: cshepard
editor: 
ms.assetid: e379180a-db13-4e0c-90e4-28e5dd6f5b14
ms.service: backup
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/13/2017
ms.author: genli
ms.openlocfilehash: 1688846957df3fbf0df747a6cd2a94b481d851b4
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 07/11/2017
---
# <a name="troubleshoot-slow-backup-of-files-and-folders-in-azure-backup"></a><span data-ttu-id="e60e5-103">Solução de problemas de lentidão de backup de arquivos e pastas no Backup do Azure</span><span class="sxs-lookup"><span data-stu-id="e60e5-103">Troubleshoot slow backup of files and folders in Azure Backup</span></span>
<span data-ttu-id="e60e5-104">Este artigo fornece orientação para solução de problemas para ajudá-lo a diagnosticar a causa do baixo desempenho de backup de arquivos e pastas quando você usa o Backup do Azure.</span><span class="sxs-lookup"><span data-stu-id="e60e5-104">This article provides troubleshooting guidance to help you diagnose the cause of slow backup performance for files and folders when you're using Azure Backup.</span></span> <span data-ttu-id="e60e5-105">Quando você usa o agente do Backup do Azure para fazer backup de arquivos, o processo de backup pode demorar mais do que o esperado.</span><span class="sxs-lookup"><span data-stu-id="e60e5-105">When you use the Azure Backup agent to back up files, the backup process might take longer than expected.</span></span> <span data-ttu-id="e60e5-106">Esse atraso pode ser causado por um ou mais dos seguintes itens:</span><span class="sxs-lookup"><span data-stu-id="e60e5-106">This delay might be caused by one or more of the following:</span></span>

* [<span data-ttu-id="e60e5-107">Há afunilamentos de desempenho no computador do qual está sendo feito o backup.</span><span class="sxs-lookup"><span data-stu-id="e60e5-107">There are performance bottlenecks on the computer that’s being backed up.</span></span>](#cause1)
* [<span data-ttu-id="e60e5-108">Outro processo ou software antivírus está interferindo com o processo de Backup do Azure.</span><span class="sxs-lookup"><span data-stu-id="e60e5-108">Another process or antivirus software is interfering with the Azure Backup process.</span></span>](#cause2)
* [<span data-ttu-id="e60e5-109">O agente do Backup está em execução em uma VM (máquina virtual) do Azure.</span><span class="sxs-lookup"><span data-stu-id="e60e5-109">The Backup agent is running on an Azure virtual machine (VM).</span></span>](#cause3)  
* [<span data-ttu-id="e60e5-110">Você está fazendo backup de um grande número de arquivos (milhões).</span><span class="sxs-lookup"><span data-stu-id="e60e5-110">You're backing up a large number (millions) of files.</span></span>](#cause4)

<span data-ttu-id="e60e5-111">Antes de começar a solucionar o problema, recomendamos o download e a instalação do [agente mais recente do Backup do Azure](http://aka.ms/azurebackup_agent).</span><span class="sxs-lookup"><span data-stu-id="e60e5-111">Before you start troubleshooting issues, we recommend that you download and install the [latest Azure Backup agent](http://aka.ms/azurebackup_agent).</span></span> <span data-ttu-id="e60e5-112">Fazemos atualizações frequentes do agente de Backup para corrigir vários problemas, adicionar recursos e melhorar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="e60e5-112">We make frequent updates to the Backup agent to fix various issues, add features, and improve performance.</span></span>

<span data-ttu-id="e60e5-113">Também recomendamos que você revise as [Perguntas frequentes do serviço Backup do Azure](backup-azure-backup-faq.md) para ter certeza de que você não está enfrentando problemas comuns de configuração.</span><span class="sxs-lookup"><span data-stu-id="e60e5-113">We also strongly recommend that you review the [Azure Backup service FAQ](backup-azure-backup-faq.md) to make sure you're not experiencing any of the common configuration issues.</span></span>

[!INCLUDE [support-disclaimer](../../includes/support-disclaimer.md)]

<a id="cause1"></a>

## <a name="cause-performance-bottlenecks-on-the-computer"></a><span data-ttu-id="e60e5-114">Causa: afunilamentos de desempenho no computador</span><span class="sxs-lookup"><span data-stu-id="e60e5-114">Cause: Performance bottlenecks on the computer</span></span>
<span data-ttu-id="e60e5-115">Afunilamentos no computador do qual está sendo feito backup podem causar atrasos.</span><span class="sxs-lookup"><span data-stu-id="e60e5-115">Bottlenecks on the computer that's being backed up can cause delays.</span></span> <span data-ttu-id="e60e5-116">Por exemplo, a capacidade do computador de ler ou gravar em disco ou a largura de banda disponível para enviar dados pela rede podem causar afunilamentos.</span><span class="sxs-lookup"><span data-stu-id="e60e5-116">For example, the computer's ability to read or write to disk, or available bandwidth to send data over the network, can cause bottlenecks.</span></span>

<span data-ttu-id="e60e5-117">O Windows fornece uma ferramenta interna chamada [Monitor de Desempenho](https://technet.microsoft.com/magazine/2008.08.pulse.aspx) (Perfmon) para detectar esses afunilamentos.</span><span class="sxs-lookup"><span data-stu-id="e60e5-117">Windows provides a built-in tool that's called [Performance Monitor](https://technet.microsoft.com/magazine/2008.08.pulse.aspx) (Perfmon) to detect these bottlenecks.</span></span>

<span data-ttu-id="e60e5-118">Veja alguns contadores de desempenho e intervalos que podem ser úteis para diagnosticar afunilamentos para obter o backup ideal.</span><span class="sxs-lookup"><span data-stu-id="e60e5-118">Here are some performance counters and ranges that can be helpful in diagnosing bottlenecks for optimal backups.</span></span>

| <span data-ttu-id="e60e5-119">Contador</span><span class="sxs-lookup"><span data-stu-id="e60e5-119">Counter</span></span> | <span data-ttu-id="e60e5-120">Status</span><span class="sxs-lookup"><span data-stu-id="e60e5-120">Status</span></span> |
| --- | --- |
| <span data-ttu-id="e60e5-121">Disco Lógico(Disco Físico) – %ocioso</span><span class="sxs-lookup"><span data-stu-id="e60e5-121">Logical Disk(Physical Disk)--%idle</span></span> |<span data-ttu-id="e60e5-122">• 100% a 50% ociosos = Íntegro</span><span class="sxs-lookup"><span data-stu-id="e60e5-122">• 100% idle to 50% idle = Healthy</span></span></br><span data-ttu-id="e60e5-123">• 49% a 20% ocioso = Aviso ou Monitor</span><span class="sxs-lookup"><span data-stu-id="e60e5-123">• 49% idle to 20% idle = Warning or Monitor</span></span></br><span data-ttu-id="e60e5-124">• 19% a 0% ocioso = Crítico ou Fora de Especificação</span><span class="sxs-lookup"><span data-stu-id="e60e5-124">• 19% idle to 0% idle = Critical or Out of Spec</span></span> |
| <span data-ttu-id="e60e5-125">Disco Lógico(Disco Físico) -- %média</span><span class="sxs-lookup"><span data-stu-id="e60e5-125">Logical Disk(Physical Disk)--%Avg.</span></span> <span data-ttu-id="e60e5-126">Leitura ou Gravação do Disco por S</span><span class="sxs-lookup"><span data-stu-id="e60e5-126">Disk Sec Read or Write</span></span> |<span data-ttu-id="e60e5-127">• 0,001 ms a 0,015 ms = Íntegro</span><span class="sxs-lookup"><span data-stu-id="e60e5-127">• 0.001 ms to 0.015 ms  = Healthy</span></span></br><span data-ttu-id="e60e5-128">• 0,015 ms a ms 0.025 ms = Aviso ou Monitor</span><span class="sxs-lookup"><span data-stu-id="e60e5-128">• 0.015 ms to 0.025 ms = Warning or Monitor</span></span></br><span data-ttu-id="e60e5-129">• 0,026 ms ou mais = Crítico ou Fora de Especificação</span><span class="sxs-lookup"><span data-stu-id="e60e5-129">• 0.026 ms or longer = Critical or Out of Spec</span></span> |
| <span data-ttu-id="e60e5-130">Disco Lógico(Disco Físico) -- Comprimento da Fila do Disco Atual (para todas as instâncias)</span><span class="sxs-lookup"><span data-stu-id="e60e5-130">Logical Disk(Physical Disk)--Current Disk Queue Length (for all instances)</span></span> |<span data-ttu-id="e60e5-131">80 solicitações por mais de seis minutos</span><span class="sxs-lookup"><span data-stu-id="e60e5-131">80 requests for more than 6 minutes</span></span> |
| <span data-ttu-id="e60e5-132">Memória--Bytes de Pool não Pagináveis</span><span class="sxs-lookup"><span data-stu-id="e60e5-132">Memory--Pool Non Paged Bytes</span></span> |<span data-ttu-id="e60e5-133">• Menos de 60% do pool consumidos = Íntegro</span><span class="sxs-lookup"><span data-stu-id="e60e5-133">• Less than 60% of pool consumed = Healthy</span></span><br><span data-ttu-id="e60e5-134">• 61% a 80% de pool consumido = Aviso ou Monitor</span><span class="sxs-lookup"><span data-stu-id="e60e5-134">• 61% to 80% of pool consumed = Warning or Monitor</span></span></br><span data-ttu-id="e60e5-135">• Mais de 80% do pool consumidos = Crítico ou Fora de Especificação</span><span class="sxs-lookup"><span data-stu-id="e60e5-135">• Greater than 80% pool consumed = Critical or Out of Spec</span></span> |
| <span data-ttu-id="e60e5-136">Memória--Bytes de Pool Pagináveis</span><span class="sxs-lookup"><span data-stu-id="e60e5-136">Memory--Pool Paged Bytes</span></span> |<span data-ttu-id="e60e5-137">• Menos de 60% do pool consumidos = Íntegro</span><span class="sxs-lookup"><span data-stu-id="e60e5-137">• Less than 60% of pool consumed = Healthy</span></span></br><span data-ttu-id="e60e5-138">• 61% a 80% de pool consumido = Aviso ou Monitor</span><span class="sxs-lookup"><span data-stu-id="e60e5-138">• 61% to 80% of pool consumed = Warning or Monitor</span></span></br><span data-ttu-id="e60e5-139">• Mais de 80% do pool consumidos = Crítico ou Fora de Especificação</span><span class="sxs-lookup"><span data-stu-id="e60e5-139">• Greater than 80% pool consumed = Critical or Out of Spec</span></span> |
| <span data-ttu-id="e60e5-140">Memória--Megabytes disponíveis</span><span class="sxs-lookup"><span data-stu-id="e60e5-140">Memory--Available Megabytes</span></span> |<span data-ttu-id="e60e5-141">• 50% de memória livre disponíveis ou mais = Íntegro</span><span class="sxs-lookup"><span data-stu-id="e60e5-141">• 50% of free memory available or more = Healthy</span></span></br><span data-ttu-id="e60e5-142">• 25% de memória livre disponível = Monitor</span><span class="sxs-lookup"><span data-stu-id="e60e5-142">• 25% of free memory available = Monitor</span></span></br><span data-ttu-id="e60e5-143">• 10% de memória livre disponível = Aviso</span><span class="sxs-lookup"><span data-stu-id="e60e5-143">• 10% of free memory available = Warning</span></span></br><span data-ttu-id="e60e5-144">• Menos de 100 MB ou 100% de memória livre disponíveis = Crítico ou Fora de Especificação</span><span class="sxs-lookup"><span data-stu-id="e60e5-144">• Less than 100 MB or 5% of free memory available = Critical or Out of Spec</span></span> |
| <span data-ttu-id="e60e5-145">Processor--\%Tempo do Processor (todas as instâncias)</span><span class="sxs-lookup"><span data-stu-id="e60e5-145">Processor--\%Processor Time (all instances)</span></span> |<span data-ttu-id="e60e5-146">• Menos de 60% consumido = Íntegro</span><span class="sxs-lookup"><span data-stu-id="e60e5-146">• Less than 60% consumed = Healthy</span></span></br><span data-ttu-id="e60e5-147">• 61% a 90% consumido = Monitor ou Cuidado</span><span class="sxs-lookup"><span data-stu-id="e60e5-147">• 61% to 90% consumed = Monitor or Caution</span></span></br><span data-ttu-id="e60e5-148">• 91% a 100% consumido = Crítico</span><span class="sxs-lookup"><span data-stu-id="e60e5-148">• 91% to 100% consumed = Critical</span></span> |

> [!NOTE]
> <span data-ttu-id="e60e5-149">Se você determinar que a infraestrutura é o motivo, é recomendável desfragmentar os discos regularmente para melhorar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="e60e5-149">If you determine that the infrastructure is the culprit, we recommend that you defragment the disks regularly for better performance.</span></span>
>
>

<a id="cause2"></a>

## <a name="cause-another-process-or-antivirus-software-interfering-with-azure-backup"></a><span data-ttu-id="e60e5-150">Causa: outro processo ou software antivírus está interferindo com o Backup do Azure</span><span class="sxs-lookup"><span data-stu-id="e60e5-150">Cause: Another process or antivirus software interfering with Azure Backup</span></span>
<span data-ttu-id="e60e5-151">Vimos várias instâncias nas quais outros processos no sistema do Windows afetou negativamente o desempenho do processo do agente de Backup do Azure.</span><span class="sxs-lookup"><span data-stu-id="e60e5-151">We've seen several instances where other processes in the Windows system have negatively affected performance of the Azure Backup agent process.</span></span> <span data-ttu-id="e60e5-152">Por exemplo, se você usar o agente de Backup do Azure e outro programa para fazer backup de dados, ou se um software antivírus estiver em execução e bloquear os arquivos dos quais o backup deverá ser feito, os vários bloqueios nos arquivos poderão causar contenção.</span><span class="sxs-lookup"><span data-stu-id="e60e5-152">For example, if you use both the Azure Backup agent and another program to back up data, or if antivirus software is running and has a lock on files to be backed up, the multiple locks on files might cause contention.</span></span> <span data-ttu-id="e60e5-153">Nessa situação, o backup pode falhar ou o trabalho pode levar mais tempo do que o esperado.</span><span class="sxs-lookup"><span data-stu-id="e60e5-153">In this situation, the backup might fail, or the job might take longer than expected.</span></span>

<span data-ttu-id="e60e5-154">A melhor recomendação nesse cenário é desativar o outro programa backup para ver se o tempo de backup do agente de Backup do Azure muda.</span><span class="sxs-lookup"><span data-stu-id="e60e5-154">The best recommendation in this scenario is to turn off the other backup program to see whether the backup time for the Azure Backup agent changes.</span></span> <span data-ttu-id="e60e5-155">Geralmente, certificar-se de que não haja vários trabalhos de backup em execução simultaneamente é suficiente para impedir que eles afetem um ao outro.</span><span class="sxs-lookup"><span data-stu-id="e60e5-155">Usually, making sure that multiple backup jobs are not running at the same time is sufficient to prevent them from affecting each other.</span></span>

<span data-ttu-id="e60e5-156">Para programas antivírus, recomendamos a exclusão dos seguintes arquivos e locais:</span><span class="sxs-lookup"><span data-stu-id="e60e5-156">For antivirus programs, we recommend that you exclude the following files and locations:</span></span>

* <span data-ttu-id="e60e5-157">C:\Program Files\Microsoft Azure Recovery Services Agent\bin\cbengine.exe como um processo</span><span class="sxs-lookup"><span data-stu-id="e60e5-157">C:\Program Files\Microsoft Azure Recovery Services Agent\bin\cbengine.exe as a process</span></span>
* <span data-ttu-id="e60e5-158">C:\Program Files\Microsoft Azure Recovery Services Agent\ pastas</span><span class="sxs-lookup"><span data-stu-id="e60e5-158">C:\Program Files\Microsoft Azure Recovery Services Agent\ folders</span></span>
* <span data-ttu-id="e60e5-159">Local de rascunho (se você não estiver usando o local padrão)</span><span class="sxs-lookup"><span data-stu-id="e60e5-159">Scratch location (if you're not using the standard location)</span></span>

<a id="cause3"></a>

## <a name="cause-backup-agent-running-on-an-azure-virtual-machine"></a><span data-ttu-id="e60e5-160">Causa: agente de backup em execução em uma máquina virtual do Azure</span><span class="sxs-lookup"><span data-stu-id="e60e5-160">Cause: Backup agent running on an Azure virtual machine</span></span>
<span data-ttu-id="e60e5-161">Se você estiver executando o agente de Backup em uma máquina virtual, o desempenho será mais lento do que quando você executá-lo em uma máquina física.</span><span class="sxs-lookup"><span data-stu-id="e60e5-161">If you're running the Backup agent on a VM, performance will be slower than when you run it on a physical machine.</span></span> <span data-ttu-id="e60e5-162">Isso é esperado devido a limitações de IOPS.</span><span class="sxs-lookup"><span data-stu-id="e60e5-162">This is expected due to IOPS limitations.</span></span>  <span data-ttu-id="e60e5-163">No entanto, você pode otimizar o desempenho alternando as unidades de dados que estão passando por backup no Armazenamento Premium do Azure.</span><span class="sxs-lookup"><span data-stu-id="e60e5-163">However, you can optimize the performance by switching the data drives that are being backed up to Azure Premium Storage.</span></span> <span data-ttu-id="e60e5-164">Estamos trabalhando para corrigir esse problema, e a correção estará disponível em uma versão futura.</span><span class="sxs-lookup"><span data-stu-id="e60e5-164">We're working on fixing this issue, and the fix will be available in a future release.</span></span>

<a id="cause4"></a>

## <a name="cause-backing-up-a-large-number-millions-of-files"></a><span data-ttu-id="e60e5-165">Causa: backup de um grande número de arquivos (milhões)</span><span class="sxs-lookup"><span data-stu-id="e60e5-165">Cause: Backing up a large number (millions) of files</span></span>
<span data-ttu-id="e60e5-166">Mover um grande volume de dados levará mais tempo do que mover um menor volume de dados.</span><span class="sxs-lookup"><span data-stu-id="e60e5-166">Moving a large volume of data will take longer than moving a smaller volume of data.</span></span> <span data-ttu-id="e60e5-167">Em alguns casos, o tempo de backup está relacionado não apenas ao tamanho dos dados, mas também ao número de arquivos ou pastas.</span><span class="sxs-lookup"><span data-stu-id="e60e5-167">In some cases, backup time is related to not only the size of the data, but also the number of files or folders.</span></span> <span data-ttu-id="e60e5-168">Isso é particularmente verdadeiro quando está sendo feito backup de milhões de arquivos pequenos (alguns bytes ou poucos kilobytes).</span><span class="sxs-lookup"><span data-stu-id="e60e5-168">This is especially true when millions of small files (a few bytes to a few kilobytes) are being backed up.</span></span>

<span data-ttu-id="e60e5-169">Esse comportamento ocorre porque, enquanto você faz backup dos dados e os move para o Azure, o Azure simultaneamente cataloga seus arquivos.</span><span class="sxs-lookup"><span data-stu-id="e60e5-169">This behavior occurs because while you're backing up the data and moving it to Azure, Azure is simultaneously cataloging your files.</span></span> <span data-ttu-id="e60e5-170">Em algumas situações raras, a operação de catálogo pode demorar mais do que o esperado.</span><span class="sxs-lookup"><span data-stu-id="e60e5-170">In some rare scenarios, the catalog operation might take longer than expected.</span></span>

<span data-ttu-id="e60e5-171">Os seguintes indicadores podem ajudá-lo a entender o gargalo e funcionam adequadamente nas próximas etapas:</span><span class="sxs-lookup"><span data-stu-id="e60e5-171">The following indicators can help you understand the bottleneck and accordingly work on the next steps:</span></span>

* <span data-ttu-id="e60e5-172">**A interface do usuário está mostrando o progresso para a transferência de dados**.</span><span class="sxs-lookup"><span data-stu-id="e60e5-172">**UI is showing progress for the data transfer**.</span></span> <span data-ttu-id="e60e5-173">Os dados ainda estão sendo transferidos.</span><span class="sxs-lookup"><span data-stu-id="e60e5-173">The data is still being transferred.</span></span> <span data-ttu-id="e60e5-174">A largura de banda de rede ou o tamanho dos dados podem estar causando atrasos.</span><span class="sxs-lookup"><span data-stu-id="e60e5-174">The network bandwidth or the size of data might be causing delays.</span></span>
* <span data-ttu-id="e60e5-175">**A interface do usuário não está mostrando o progresso para a transferência de dados**.</span><span class="sxs-lookup"><span data-stu-id="e60e5-175">**UI is not showing progress for the data transfer**.</span></span> <span data-ttu-id="e60e5-176">Abra os logs localizados em C:\Microsoft Azure Recovery Services Agent\Temp e verifique a entrada FileProvider::EndData nos logs.</span><span class="sxs-lookup"><span data-stu-id="e60e5-176">Open the logs located at C:\Microsoft Azure Recovery Services Agent\Temp, and then check for the FileProvider::EndData entry in the logs.</span></span> <span data-ttu-id="e60e5-177">Essa entrada significa que a transferência de dados foi concluída e a operação de catálogo está ocorrendo.</span><span class="sxs-lookup"><span data-stu-id="e60e5-177">This entry signifies that the data transfer finished and the catalog operation is happening.</span></span> <span data-ttu-id="e60e5-178">Não cancele os trabalhos de backup.</span><span class="sxs-lookup"><span data-stu-id="e60e5-178">Don't cancel the backup jobs.</span></span> <span data-ttu-id="e60e5-179">Em vez disso, espere um pouco mais até a conclusão da operação de catálogo.</span><span class="sxs-lookup"><span data-stu-id="e60e5-179">Instead, wait a little longer for the catalog operation to finish.</span></span> <span data-ttu-id="e60e5-180">Se o problema persistir, contate o [suporte do Azure](https://portal.azure.com/#create/Microsoft.Support).</span><span class="sxs-lookup"><span data-stu-id="e60e5-180">If the problem persists, contact [Azure support](https://portal.azure.com/#create/Microsoft.Support).</span></span>
