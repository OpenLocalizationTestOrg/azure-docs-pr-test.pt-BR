---
title: "aaaGet iniciado com funções, permissões e segurança com o Monitor do Azure | Microsoft Docs"
description: "Saiba como do Monitor do Azure toouse funções internas e permissões toorestrict acessam os recursos de toomonitoring."
author: johnkemnetz
manager: orenr
editor: 
services: monitoring-and-diagnostics
documentationcenter: monitoring-and-diagnostics
ms.assetid: 2686e53b-72f0-4312-bcd3-3dc1b4a9b912
ms.service: monitoring-and-diagnostics
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 09/26/2016
ms.author: johnkem
ms.openlocfilehash: 44fdf2a697050309480dfc164ebab51445b19bc8
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="get-started-with-roles-permissions-and-security-with-azure-monitor"></a><span data-ttu-id="6669e-103">Introdução às funções, permissões e segurança com o Azure Monitor</span><span class="sxs-lookup"><span data-stu-id="6669e-103">Get started with roles, permissions, and security with Azure Monitor</span></span>
<span data-ttu-id="6669e-104">Muitas equipes necessário toostrictly regular o acesso toomonitoring dados e configurações.</span><span class="sxs-lookup"><span data-stu-id="6669e-104">Many teams need toostrictly regulate access toomonitoring data and settings.</span></span> <span data-ttu-id="6669e-105">Por exemplo, se você tem os membros da equipe que trabalham exclusivamente no monitoramento (engenheiros de suporte, os engenheiros de devops) ou se você usar um provedor de serviço gerenciado, convém toogrant tooonly dados de monitoramento e restrinja sua capacidade toocreate a eles acesso, modificar, ou Exclua recursos.</span><span class="sxs-lookup"><span data-stu-id="6669e-105">For example, if you have team members who work exclusively on monitoring (support engineers, devops engineers) or if you use a managed service provider, you may want toogrant them access tooonly monitoring data while restricting their ability toocreate, modify, or delete resources.</span></span> <span data-ttu-id="6669e-106">Este artigo mostra como tooquickly aplicar um monitoramento RBAC função tooa usuário internas no Azure ou criar sua própria função personalizada para um usuário que precisa de permissões limitadas de monitoramentos.</span><span class="sxs-lookup"><span data-stu-id="6669e-106">This article shows how tooquickly apply a built-in monitoring RBAC role tooa user in Azure or build your own custom role for a user who needs limited monitoring permissions.</span></span> <span data-ttu-id="6669e-107">Também discute considerações de segurança para os recursos relacionados ao Monitor do Azure e como você pode limitar o acesso toohello dados que eles contêm.</span><span class="sxs-lookup"><span data-stu-id="6669e-107">It then discusses security considerations for your Azure Monitor-related resources and how you can limit access toohello data they contain.</span></span>

## <a name="built-in-monitoring-roles"></a><span data-ttu-id="6669e-108">Funções internas de monitoramento</span><span class="sxs-lookup"><span data-stu-id="6669e-108">Built-in monitoring roles</span></span>
<span data-ttu-id="6669e-109">Funções internas do Monitor do Azure são tooresources de acesso de limite toohelp projetado em uma assinatura, permitindo que os responsáveis pelo monitoramento de infraestrutura tooobtain e configurar dados Olá necessários.</span><span class="sxs-lookup"><span data-stu-id="6669e-109">Azure Monitor’s built-in roles are designed toohelp limit access tooresources in a subscription while still enabling those responsible for monitoring infrastructure tooobtain and configure hello data they need.</span></span> <span data-ttu-id="6669e-110">O Azure Monitor fornece duas funções integradas: um Leitor de monitoramento e um Colaborador de monitoramento.</span><span class="sxs-lookup"><span data-stu-id="6669e-110">Azure Monitor provides two out-of-the-box roles: A Monitoring Reader and a Monitoring Contributor.</span></span>

### <a name="monitoring-reader"></a><span data-ttu-id="6669e-111">Leitor de monitoramento</span><span class="sxs-lookup"><span data-stu-id="6669e-111">Monitoring Reader</span></span>
<span data-ttu-id="6669e-112">Pessoas atribuídas a função de leitor de monitoramento de saudação podem exibir todos os dados de monitoramentos em uma assinatura, mas não pode modificar qualquer recurso ou editar as configurações relacionadas toomonitoring recursos.</span><span class="sxs-lookup"><span data-stu-id="6669e-112">People assigned hello Monitoring Reader role can view all monitoring data in a subscription but cannot modify any resource or edit any settings related toomonitoring resources.</span></span> <span data-ttu-id="6669e-113">Essa função é apropriada para usuários em uma organização, como engenheiros de suporte ou de operações, que precisam de toobe capaz de:</span><span class="sxs-lookup"><span data-stu-id="6669e-113">This role is appropriate for users in an organization, such as support or operations engineers, who need toobe able to:</span></span>

* <span data-ttu-id="6669e-114">Exibir painéis de monitoramentos no portal de saudação e criar seus próprios painéis de monitoramentos privados.</span><span class="sxs-lookup"><span data-stu-id="6669e-114">View monitoring dashboards in hello portal and create their own private monitoring dashboards.</span></span>
* <span data-ttu-id="6669e-115">Consulta de métricas usando Olá [API REST do Azure Monitor](https://msdn.microsoft.com/library/azure/dn931930.aspx), [cmdlets do PowerShell](insights-powershell-samples.md), ou [CLI de plataforma cruzada](insights-cli-samples.md).</span><span class="sxs-lookup"><span data-stu-id="6669e-115">Query for metrics using hello [Azure Monitor REST API](https://msdn.microsoft.com/library/azure/dn931930.aspx), [PowerShell cmdlets](insights-powershell-samples.md), or [cross-platform CLI](insights-cli-samples.md).</span></span>
* <span data-ttu-id="6669e-116">Consulta hello atividade de Log usando o portal de hello, API de REST do Monitor do Azure, cmdlets do PowerShell ou CLI de plataforma cruzada.</span><span class="sxs-lookup"><span data-stu-id="6669e-116">Query hello Activity Log using hello portal, Azure Monitor REST API, PowerShell cmdlets, or cross-platform CLI.</span></span>
* <span data-ttu-id="6669e-117">Saudação de exibição [configurações de diagnóstico](monitoring-overview-of-diagnostic-logs.md#resource-diagnostic-settings) para um recurso.</span><span class="sxs-lookup"><span data-stu-id="6669e-117">View hello [diagnostic settings](monitoring-overview-of-diagnostic-logs.md#resource-diagnostic-settings) for a resource.</span></span>
* <span data-ttu-id="6669e-118">Saudação de exibição [log perfil](monitoring-overview-activity-logs.md#export-the-activity-log-with-a-log-profile) para uma assinatura.</span><span class="sxs-lookup"><span data-stu-id="6669e-118">View hello [log profile](monitoring-overview-activity-logs.md#export-the-activity-log-with-a-log-profile) for a subscription.</span></span>
* <span data-ttu-id="6669e-119">Exibir as configurações de autoescala.</span><span class="sxs-lookup"><span data-stu-id="6669e-119">View autoscale settings.</span></span>
* <span data-ttu-id="6669e-120">Exibir as configurações e a atividade do alerta.</span><span class="sxs-lookup"><span data-stu-id="6669e-120">View alert activity and settings.</span></span>
* <span data-ttu-id="6669e-121">Acessar os dados do Application Insights e exiba os dados na Análise de AI.</span><span class="sxs-lookup"><span data-stu-id="6669e-121">Access Application Insights data and view data in AI Analytics.</span></span>
* <span data-ttu-id="6669e-122">Pesquisar dados de espaço de trabalho de análise de Log (OMS), incluindo dados de uso do espaço de trabalho de saudação.</span><span class="sxs-lookup"><span data-stu-id="6669e-122">Search Log Analytics (OMS) workspace data including usage data for hello workspace.</span></span>
* <span data-ttu-id="6669e-123">Exibir grupos de gerenciamento do Log Analytics (OMS).</span><span class="sxs-lookup"><span data-stu-id="6669e-123">View Log Analytics (OMS) management groups.</span></span>
* <span data-ttu-id="6669e-124">Recupere o esquema de saudação de pesquisa de análise de Log (OMS).</span><span class="sxs-lookup"><span data-stu-id="6669e-124">Retrieve hello Log Analytics (OMS) search schema.</span></span>
* <span data-ttu-id="6669e-125">Listar os pacotes de inteligência do Log Analytics (OMS).</span><span class="sxs-lookup"><span data-stu-id="6669e-125">List Log Analytics (OMS) intelligence packs.</span></span>
* <span data-ttu-id="6669e-126">Recuperar e executar as pesquisas salvas do Log Analytics (OMS).</span><span class="sxs-lookup"><span data-stu-id="6669e-126">Retrieve and execute Log Analytics (OMS) saved searches.</span></span>
* <span data-ttu-id="6669e-127">Recupere a configuração de armazenamento da análise de Log (OMS) hello.</span><span class="sxs-lookup"><span data-stu-id="6669e-127">Retrieve hello Log Analytics (OMS) storage configuration.</span></span>

> [!NOTE]
> <span data-ttu-id="6669e-128">Essa função não dá acesso de leitura toolog dados que foi hub de eventos tooan transmitidos ou armazenados em uma conta de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="6669e-128">This role does not give read access toolog data that has been streamed tooan event hub or stored in a storage account.</span></span> <span data-ttu-id="6669e-129">[Veja abaixo](#security-considerations-for-monitoring-data) para obter informações sobre como configurar recursos de toothese de acesso.</span><span class="sxs-lookup"><span data-stu-id="6669e-129">[See below](#security-considerations-for-monitoring-data) for information on configuring access toothese resources.</span></span>
> 
> 

### <a name="monitoring-contributor"></a><span data-ttu-id="6669e-130">Colaborador de monitoramento</span><span class="sxs-lookup"><span data-stu-id="6669e-130">Monitoring Contributor</span></span>
<span data-ttu-id="6669e-131">Pessoas atribuídas Olá Colaborador de monitoramento de função pode exibir todos os dados de monitoramentos em uma assinatura e criar ou modificar as configurações de monitoramento, mas não é possível modificar todos os outros recursos.</span><span class="sxs-lookup"><span data-stu-id="6669e-131">People assigned hello Monitoring Contributor role can view all monitoring data in a subscription and create or modify monitoring settings, but cannot modify any other resources.</span></span> <span data-ttu-id="6669e-132">Essa função é um superconjunto da função de leitor de monitoramento de saudação e é apropriada para membros da equipe de monitoramento ou provedores de serviço gerenciado que, além de permissões de toohello acima, também precisam toobe capaz de uma organização:</span><span class="sxs-lookup"><span data-stu-id="6669e-132">This role is a superset of hello Monitoring Reader role, and is appropriate for members of an organization’s monitoring team or managed service providers who, in addition toohello permissions above, also need toobe able to:</span></span>

* <span data-ttu-id="6669e-133">Publicra os painéis de monitoramentos como um painel compartilhado.</span><span class="sxs-lookup"><span data-stu-id="6669e-133">Publish monitoring dashboards as a shared dashboard.</span></span>
* <span data-ttu-id="6669e-134">Definir as [configurações de diagnóstico](monitoring-overview-of-diagnostic-logs.md#resource-diagnostic-settings) para um recurso.*</span><span class="sxs-lookup"><span data-stu-id="6669e-134">Set [diagnostic settings](monitoring-overview-of-diagnostic-logs.md#resource-diagnostic-settings) for a resource.*</span></span>
* <span data-ttu-id="6669e-135">Saudação de conjunto [log perfil](monitoring-overview-activity-logs.md#export-the-activity-log-with-a-log-profile) para um subscription.*</span><span class="sxs-lookup"><span data-stu-id="6669e-135">Set hello [log profile](monitoring-overview-activity-logs.md#export-the-activity-log-with-a-log-profile) for a subscription.*</span></span>
* <span data-ttu-id="6669e-136">Definir as configurações e a atividade do alerta.</span><span class="sxs-lookup"><span data-stu-id="6669e-136">Set alert activity and settings.</span></span>
* <span data-ttu-id="6669e-137">Criar testes Web e componentes do Application Insights.</span><span class="sxs-lookup"><span data-stu-id="6669e-137">Create Application Insights web tests and components.</span></span>
* <span data-ttu-id="6669e-138">Listar chaves de espaço de trabalho compartilhadas do Log Analytics (OMS).</span><span class="sxs-lookup"><span data-stu-id="6669e-138">List Log Analytics (OMS) workspace shared keys.</span></span>
* <span data-ttu-id="6669e-139">Ativar ou desativar os pacotes de inteligência do Log Analytics (OMS).</span><span class="sxs-lookup"><span data-stu-id="6669e-139">Enable or disable Log Analytics (OMS) intelligence packs.</span></span>
* <span data-ttu-id="6669e-140">Criar e excluir as pesquisas salvas do Log Analytics (OMS).</span><span class="sxs-lookup"><span data-stu-id="6669e-140">Create and delete and execute Log Analytics (OMS) saved searches.</span></span>
* <span data-ttu-id="6669e-141">Criar e excluir configuração de armazenamento da análise de Log (OMS) hello.</span><span class="sxs-lookup"><span data-stu-id="6669e-141">Create and delete hello Log Analytics (OMS) storage configuration.</span></span>

<span data-ttu-id="6669e-142">* usuário separadamente também deve receber permissão de ListKeys Olá destino recursos (armazenamento conta ou evento de namespace de hub) tooset um perfil de registro ou configuração de diagnóstico.</span><span class="sxs-lookup"><span data-stu-id="6669e-142">*user must also separately be granted ListKeys permission on hello target resource (storage account or event hub namespace) tooset a log profile or diagnostic setting.</span></span>

> [!NOTE]
> <span data-ttu-id="6669e-143">Essa função não dá acesso de leitura toolog dados que foi hub de eventos tooan transmitidos ou armazenados em uma conta de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="6669e-143">This role does not give read access toolog data that has been streamed tooan event hub or stored in a storage account.</span></span> <span data-ttu-id="6669e-144">[Veja abaixo](#security-considerations-for-monitoring-data) para obter informações sobre como configurar recursos de toothese de acesso.</span><span class="sxs-lookup"><span data-stu-id="6669e-144">[See below](#security-considerations-for-monitoring-data) for information on configuring access toothese resources.</span></span>
> 
> 

## <a name="monitoring-permissions-and-custom-rbac-roles"></a><span data-ttu-id="6669e-145">Monitoramento de permissões e funções RBAC personalizadas</span><span class="sxs-lookup"><span data-stu-id="6669e-145">Monitoring permissions and custom RBAC roles</span></span>
<span data-ttu-id="6669e-146">Se Olá acima funções internas não atenderem às necessidades de saudação da sua equipe, você pode [criar uma função personalizada de RBAC](../active-directory/role-based-access-control-custom-roles.md) com permissões mais granulares.</span><span class="sxs-lookup"><span data-stu-id="6669e-146">If hello above built-in roles don’t meet hello exact needs of your team, you can [create a custom RBAC role](../active-directory/role-based-access-control-custom-roles.md) with more granular permissions.</span></span> <span data-ttu-id="6669e-147">Abaixo está Olá operações comuns de RBAC do Monitor do Azure e suas descrições.</span><span class="sxs-lookup"><span data-stu-id="6669e-147">Below are hello common Azure Monitor RBAC operations with their descriptions.</span></span>

| <span data-ttu-id="6669e-148">Operação</span><span class="sxs-lookup"><span data-stu-id="6669e-148">Operation</span></span> | <span data-ttu-id="6669e-149">Descrição</span><span class="sxs-lookup"><span data-stu-id="6669e-149">Description</span></span> |
| --- | --- |
| <span data-ttu-id="6669e-150">Microsoft.Insights/AlertRules/[Read, Write, Delete]</span><span class="sxs-lookup"><span data-stu-id="6669e-150">Microsoft.Insights/AlertRules/[Read, Write, Delete]</span></span> |<span data-ttu-id="6669e-151">Leitura/gravação/exclusão de regras de alerta.</span><span class="sxs-lookup"><span data-stu-id="6669e-151">Read/write/delete alert rules.</span></span> |
| <span data-ttu-id="6669e-152">Microsoft.Insights/AlertRules/Incidents/Read</span><span class="sxs-lookup"><span data-stu-id="6669e-152">Microsoft.Insights/AlertRules/Incidents/Read</span></span> |<span data-ttu-id="6669e-153">Lista de incidentes (histórico de regra de alerta hello está sendo disparado) de regras de alerta.</span><span class="sxs-lookup"><span data-stu-id="6669e-153">List incidents (history of hello alert rule being triggered) for alert rules.</span></span> <span data-ttu-id="6669e-154">Isso só se aplica a toohello portal.</span><span class="sxs-lookup"><span data-stu-id="6669e-154">This only applies toohello portal.</span></span> |
| <span data-ttu-id="6669e-155">Microsoft.Insights/AutoscaleSettings/[Read, Write, Delete]</span><span class="sxs-lookup"><span data-stu-id="6669e-155">Microsoft.Insights/AutoscaleSettings/[Read, Write, Delete]</span></span> |<span data-ttu-id="6669e-156">Leitura/gravação/exclusão de configurações de dimensionamento automático.</span><span class="sxs-lookup"><span data-stu-id="6669e-156">Read/write/delete autoscale settings.</span></span> |
| <span data-ttu-id="6669e-157">Microsoft.Insights/DiagnosticSettings/[Read, Write, Delete]</span><span class="sxs-lookup"><span data-stu-id="6669e-157">Microsoft.Insights/DiagnosticSettings/[Read, Write, Delete]</span></span> |<span data-ttu-id="6669e-158">Leitura/gravação/exclusão de configurações de diagnóstico.</span><span class="sxs-lookup"><span data-stu-id="6669e-158">Read/write/delete diagnostic settings.</span></span> |
| <span data-ttu-id="6669e-159">Microsoft.Insights/eventtypes/digestevents/Read</span><span class="sxs-lookup"><span data-stu-id="6669e-159">Microsoft.Insights/eventtypes/digestevents/Read</span></span> |<span data-ttu-id="6669e-160">Essa permissão é necessária para os usuários que precisam acessar os Logs de tooActivity por meio do portal de saudação.</span><span class="sxs-lookup"><span data-stu-id="6669e-160">This permission is necessary for users who need access tooActivity Logs via hello portal.</span></span> |
| <span data-ttu-id="6669e-161">Microsoft.Insights/eventtypes/values/Read</span><span class="sxs-lookup"><span data-stu-id="6669e-161">Microsoft.Insights/eventtypes/values/Read</span></span> |<span data-ttu-id="6669e-162">Listar eventos do Log de atividades (eventos de gerenciamento) em um assinatura.</span><span class="sxs-lookup"><span data-stu-id="6669e-162">List Activity Log events (management events) in a subscription.</span></span> <span data-ttu-id="6669e-163">Essa permissão é aplicável tooboth acesso programático e portal toohello Log de atividades.</span><span class="sxs-lookup"><span data-stu-id="6669e-163">This permission is applicable tooboth programmatic and portal access toohello Activity Log.</span></span> |
| <span data-ttu-id="6669e-164">Microsoft.Insights/LogDefinitions/Read</span><span class="sxs-lookup"><span data-stu-id="6669e-164">Microsoft.Insights/LogDefinitions/Read</span></span> |<span data-ttu-id="6669e-165">Essa permissão é necessária para os usuários que precisam acessar os Logs de tooActivity por meio do portal de saudação.</span><span class="sxs-lookup"><span data-stu-id="6669e-165">This permission is necessary for users who need access tooActivity Logs via hello portal.</span></span> |
| <span data-ttu-id="6669e-166">Microsoft.Insights/MetricDefinitions/Read</span><span class="sxs-lookup"><span data-stu-id="6669e-166">Microsoft.Insights/MetricDefinitions/Read</span></span> |<span data-ttu-id="6669e-167">Ler definições de métricas (lista de tipos de métrica disponíveis para um recurso).</span><span class="sxs-lookup"><span data-stu-id="6669e-167">Read metric definitions (list of available metric types for a resource).</span></span> |
| <span data-ttu-id="6669e-168">Microsoft.Insights/Metrics/Read</span><span class="sxs-lookup"><span data-stu-id="6669e-168">Microsoft.Insights/Metrics/Read</span></span> |<span data-ttu-id="6669e-169">Ler as métricas para um recurso.</span><span class="sxs-lookup"><span data-stu-id="6669e-169">Read metrics for a resource.</span></span> |

> [!NOTE]
> <span data-ttu-id="6669e-170">Acesso tooalerts, configurações de diagnóstico e métricas para um recurso requer que o usuário Olá tem o tipo de recurso de toohello de acesso de leitura e o escopo do recurso.</span><span class="sxs-lookup"><span data-stu-id="6669e-170">Access tooalerts, diagnostic settings, and metrics for a resource requires that hello user has Read access toohello resource type and scope of that resource.</span></span> <span data-ttu-id="6669e-171">Criando ("gravação") um perfil de configuração ou o log de diagnóstico arquivos tooa armazenamento conta ou fluxos tooevent hubs requer Olá usuário tooalso ter permissão do ListKeys no recurso de destino hello.</span><span class="sxs-lookup"><span data-stu-id="6669e-171">Creating (“write”) a diagnostic setting or log profile that archives tooa storage account or streams tooevent hubs requires hello user tooalso have ListKeys permission on hello target resource.</span></span>
> 
> 

<span data-ttu-id="6669e-172">Por exemplo, usando Olá acima da tabela você pode criar uma função RBAC personalizada para um "leitor de Log de atividade" assim:</span><span class="sxs-lookup"><span data-stu-id="6669e-172">For example, using hello above table you could create a custom RBAC role for an “Activity Log Reader” like this:</span></span>

```powershell
$role = Get-AzureRmRoleDefinition "Reader"
$role.Id = $null
$role.Name = "Activity Log Reader"
$role.Description = "Can view activity logs."
$role.Actions.Clear()
$role.Actions.Add("Microsoft.Insights/eventtypes/*")
$role.AssignableScopes.Clear()
$role.AssignableScopes.Add("/subscriptions/mySubscription")
New-AzureRmRoleDefinition -Role $role 
```

## <a name="security-considerations-for-monitoring-data"></a><span data-ttu-id="6669e-173">Considerações de segurança para dados de monitoramento</span><span class="sxs-lookup"><span data-stu-id="6669e-173">Security considerations for monitoring data</span></span>
<span data-ttu-id="6669e-174">Dados de monitoramento — especialmente os arquivos de log — podem conter informações confidenciais, como endereços IP ou nomes de usuário.</span><span class="sxs-lookup"><span data-stu-id="6669e-174">Monitoring data—particularly log files—can contain sensitive information, such as IP addresses or user names.</span></span> <span data-ttu-id="6669e-175">Os dados de monitoramento do Azure vêm em três formas básicas:</span><span class="sxs-lookup"><span data-stu-id="6669e-175">Monitoring data from Azure comes in three basic forms:</span></span>

1. <span data-ttu-id="6669e-176">Hello atividade de Log, que descreve todas as ações do plano de controle em sua assinatura do Azure.</span><span class="sxs-lookup"><span data-stu-id="6669e-176">hello Activity Log, which describes all control-plane actions on your Azure subscription.</span></span>
2. <span data-ttu-id="6669e-177">Logs de diagnóstico, que são logs emitidos por um recurso.</span><span class="sxs-lookup"><span data-stu-id="6669e-177">Diagnostic Logs, which are logs emitted by a resource.</span></span>
3. <span data-ttu-id="6669e-178">Métricas, que são emitidas pelos recursos.</span><span class="sxs-lookup"><span data-stu-id="6669e-178">Metrics, which are emitted by resources.</span></span>

<span data-ttu-id="6669e-179">Três desses tipos de dados podem ser armazenados em uma conta de armazenamento ou tooEvent Hub, que são recursos do Azure para fins gerais de streaming.</span><span class="sxs-lookup"><span data-stu-id="6669e-179">All three of these data types can be stored in a storage account or streamed tooEvent Hub, both of which are general-purpose Azure resources.</span></span> <span data-ttu-id="6669e-180">Como esses são recursos de finalidade geral, criar, excluir e acessá-los são operações privilegiadas, normalmente reservadas para o administrador.</span><span class="sxs-lookup"><span data-stu-id="6669e-180">Because these are general-purpose resources, creating, deleting, and accessing them is a privileged operation usually reserved for an administrator.</span></span> <span data-ttu-id="6669e-181">Sugerimos que você use Olá seguir práticas recomendadas para o uso indevido de tooprevent relacionados ao monitoramento de recursos:</span><span class="sxs-lookup"><span data-stu-id="6669e-181">We suggest that you use hello following practices for monitoring-related resources tooprevent misuse:</span></span>

* <span data-ttu-id="6669e-182">Use uma conta de armazenamento única e dedicada para os dados de monitoramento.</span><span class="sxs-lookup"><span data-stu-id="6669e-182">Use a single, dedicated storage account for monitoring data.</span></span> <span data-ttu-id="6669e-183">Se você precisar tooseparate dados de monitoramento em várias contas de armazenamento, nunca compartilham o uso de uma conta de armazenamento entre o monitoramento e aqueles que só precisam acessar os dados de toomonitoring (por exemplo, inadvertidamente podem resultar em dados não de monitoramento, como isso</span><span class="sxs-lookup"><span data-stu-id="6669e-183">If you need tooseparate monitoring data into multiple storage accounts, never share usage of a storage account between monitoring and non-monitoring data, as this may inadvertently give those who only need access toomonitoring data (eg.</span></span> <span data-ttu-id="6669e-184">um terceiro SIEM) acessar dados de monitoramento de toonon.</span><span class="sxs-lookup"><span data-stu-id="6669e-184">a third-party SIEM) access toonon-monitoring data.</span></span>
* <span data-ttu-id="6669e-185">Use um namespace de barramento de serviço ou Hub de evento único e dedicado em todas as configurações de diagnósticas para Olá pelo mesmo motivo como acima.</span><span class="sxs-lookup"><span data-stu-id="6669e-185">Use a single, dedicated Service Bus or Event Hub namespace across all diagnostic settings for hello same reason as above.</span></span>
* <span data-ttu-id="6669e-186">Limitar as contas de acesso de armazenamento relacionada toomonitoring ou hubs de eventos ao mantê-las em um grupo de recursos separado, e [usar escopo](../active-directory/role-based-access-control-what-is.md#basics-of-access-management-in-azure) em suas funções de monitoramentos toolimit acessar tooonly nesse grupo de recursos.</span><span class="sxs-lookup"><span data-stu-id="6669e-186">Limit access toomonitoring-related storage accounts or event hubs by keeping them in a separate resource group, and [use scope](../active-directory/role-based-access-control-what-is.md#basics-of-access-management-in-azure) on your monitoring roles toolimit access tooonly that resource group.</span></span>
* <span data-ttu-id="6669e-187">Nunca conceda permissão do ListKeys Olá para contas de armazenamento ou hubs de eventos no escopo de assinatura quando um usuário só precisa acessar toomonitoring dados.</span><span class="sxs-lookup"><span data-stu-id="6669e-187">Never grant hello ListKeys permission for either storage accounts or event hubs at subscription scope when a user only needs access toomonitoring data.</span></span> <span data-ttu-id="6669e-188">Em vez disso, conceder essas permissões toohello do usuário em um recurso ou grupo de recursos (se você tiver um grupo de recursos de monitoramento dedicado) escopo.</span><span class="sxs-lookup"><span data-stu-id="6669e-188">Instead, give these permissions toohello user at a resource or resource group (if you have a dedicated monitoring resource group) scope.</span></span>

### <a name="limiting-access-toomonitoring-related-storage-accounts"></a><span data-ttu-id="6669e-189">Limitar as contas de acesso de armazenamento relacionada toomonitoring</span><span class="sxs-lookup"><span data-stu-id="6669e-189">Limiting access toomonitoring-related storage accounts</span></span>
<span data-ttu-id="6669e-190">Quando um usuário ou aplicativo precisa acessar dados de toomonitoring em uma conta de armazenamento, você deve [gerar uma SAS da conta](https://msdn.microsoft.com/library/azure/mt584140.aspx) na conta de armazenamento Olá que contém dados de monitoramento com o armazenamento de tooblob acesso somente leitura de nível de serviço.</span><span class="sxs-lookup"><span data-stu-id="6669e-190">When a user or application needs access toomonitoring data in a storage account, you should [generate an Account SAS](https://msdn.microsoft.com/library/azure/mt584140.aspx) on hello storage account that contains monitoring data with service-level read-only access tooblob storage.</span></span> <span data-ttu-id="6669e-191">No PowerShell, isso pode ser semelhante a:</span><span class="sxs-lookup"><span data-stu-id="6669e-191">In PowerShell, this might look like:</span></span>

```powershell
$context = New-AzureStorageContext -ConnectionString "[connection string for your monitoring Storage Account]"
$token = New-AzureStorageAccountSASToken -ResourceType Service -Service Blob -Permission "rl" -Context $context
```

<span data-ttu-id="6669e-192">Em seguida, você pode dar a entidade do token toohello Olá que precisa tooread dessa conta de armazenamento, e pode listar e ler todos os blobs na conta de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="6669e-192">You can then give hello token toohello entity that needs tooread from that storage account, and it can list and read from all blobs in that storage account.</span></span>

<span data-ttu-id="6669e-193">Como alternativa, se você precisar toocontrol essa permissão com RBAC, você pode conceder esse Olá entidade Microsoft.Storage/storageAccounts/listkeys/action permissão na conta de armazenamento específico.</span><span class="sxs-lookup"><span data-stu-id="6669e-193">Alternatively, if you need toocontrol this permission with RBAC, you can grant that entity hello Microsoft.Storage/storageAccounts/listkeys/action permission on that particular storage account.</span></span> <span data-ttu-id="6669e-194">Isso é necessário para usuários que precisam toobe capaz de tooset um diagnóstico log ou configuração de perfil tooarchive tooa conta de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="6669e-194">This is necessary for users who need toobe able tooset a diagnostic setting or log profile tooarchive tooa storage account.</span></span> <span data-ttu-id="6669e-195">Por exemplo, você poderia criar hello função RBAC personalizada para um usuário ou aplicativo que precisa apenas tooread de uma conta de armazenamento a seguir:</span><span class="sxs-lookup"><span data-stu-id="6669e-195">For example, you could create hello following custom RBAC role for a user or application that only needs tooread from one storage account:</span></span>

```powershell
$role = Get-AzureRmRoleDefinition "Reader"
$role.Id = $null
$role.Name = "Monitoring Storage Account Reader"
$role.Description = "Can get hello storage account keys for a monitoring storage account."
$role.Actions.Clear()
$role.Actions.Add("Microsoft.Storage/storageAccounts/listkeys/action")
$role.Actions.Add("Microsoft.Storage/storageAccounts/Read")
$role.AssignableScopes.Clear()
$role.AssignableScopes.Add("/subscriptions/mySubscription/resourceGroups/myResourceGroup/providers/Microsoft.Storage/storageAccounts/myMonitoringStorageAccount")
New-AzureRmRoleDefinition -Role $role 
```

> [!WARNING]
> <span data-ttu-id="6669e-196">Olá permissão do ListKeys permite que chaves de conta de armazenamento primário e secundário Olá usuário toolist hello.</span><span class="sxs-lookup"><span data-stu-id="6669e-196">hello ListKeys permission enables hello user toolist hello primary and secondary storage account keys.</span></span> <span data-ttu-id="6669e-197">Essas chaves conceder usuário Olá tudo assinado permissões (leitura, gravação, criar blobs, excluir blobs, etc.) em todos os serviços (blob, fila, tabela, arquivo) na conta de armazenamento de assinatura.</span><span class="sxs-lookup"><span data-stu-id="6669e-197">These keys grant hello user all signed permissions (read, write, create blobs, delete blobs, etc.) across all signed services (blob, queue, table, file) in that storage account.</span></span> <span data-ttu-id="6669e-198">Recomendamos usar uma SAS da conta descrita acima, quando possível.</span><span class="sxs-lookup"><span data-stu-id="6669e-198">We recommend using an Account SAS described above when possible.</span></span>
> 
> 

### <a name="limiting-access-toomonitoring-related-event-hubs"></a><span data-ttu-id="6669e-199">Limitando a hubs de eventos relacionados a toomonitoring de acesso</span><span class="sxs-lookup"><span data-stu-id="6669e-199">Limiting access toomonitoring-related event hubs</span></span>
<span data-ttu-id="6669e-200">Um padrão semelhante pode ser seguido com hubs de eventos, mas primeiro você precisa toocreate uma regra de autorização de escuta dedicada.</span><span class="sxs-lookup"><span data-stu-id="6669e-200">A similar pattern can be followed with event hubs, but first you need toocreate a dedicated Listen authorization rule.</span></span> <span data-ttu-id="6669e-201">Se você quiser toogrant acesso tooan aplicativo que só precisa de hubs de evento relacionado à toomonitoring toolisten, Olá a seguir:</span><span class="sxs-lookup"><span data-stu-id="6669e-201">If you want toogrant access tooan application that only needs toolisten toomonitoring-related event hubs, do hello following:</span></span>

1. <span data-ttu-id="6669e-202">Crie uma política de acesso compartilhado em hubs de evento Olá que foram criadas para o fluxo de dados de monitoramentos com apenas declarações de escuta.</span><span class="sxs-lookup"><span data-stu-id="6669e-202">Create a shared access policy on hello event hub(s) that were created for streaming monitoring data with only Listen claims.</span></span> <span data-ttu-id="6669e-203">Isso pode ser feito no portal de saudação.</span><span class="sxs-lookup"><span data-stu-id="6669e-203">This can be done in hello portal.</span></span> <span data-ttu-id="6669e-204">Por exemplo, você pode chamá-la de "monitoringReadOnly."</span><span class="sxs-lookup"><span data-stu-id="6669e-204">For example, you might call it “monitoringReadOnly.”</span></span> <span data-ttu-id="6669e-205">Se possível, você desejará toogive que toohello consumidor diretamente da chave e ignorar Olá próxima etapa.</span><span class="sxs-lookup"><span data-stu-id="6669e-205">If possible, you will want toogive that key directly toohello consumer and skip hello next step.</span></span>
2. <span data-ttu-id="6669e-206">Se o consumidor Olá precisar toobe tooget capaz de saudação chave ad hoc, conceda ação do ListKeys saudação do hello usuário hub de evento.</span><span class="sxs-lookup"><span data-stu-id="6669e-206">If hello consumer needs toobe able tooget hello key ad-hoc, grant hello user hello ListKeys action for that event hub.</span></span> <span data-ttu-id="6669e-207">Isso também é necessário para usuários que precisam toobe capaz de tooset uma configuração de diagnóstica ou de log hubs do perfil toostream tooevent.</span><span class="sxs-lookup"><span data-stu-id="6669e-207">This is also necessary for users who need toobe able tooset a diagnostic setting or log profile toostream tooevent hubs.</span></span> <span data-ttu-id="6669e-208">Por exemplo, você pode criar uma regra RBAC:</span><span class="sxs-lookup"><span data-stu-id="6669e-208">For example, you might create an RBAC rule:</span></span>
   
   ```powershell
   $role = Get-AzureRmRoleDefinition "Reader"
   $role.Id = $null
   $role.Name = "Monitoring Event Hub Listener"
   $role.Description = "Can get hello key toolisten tooan event hub streaming monitoring data."
   $role.Actions.Clear()
   $role.Actions.Add("Microsoft.ServiceBus/namespaces/authorizationrules/listkeys/action")
   $role.Actions.Add("Microsoft.ServiceBus/namespaces/Read")
   $role.AssignableScopes.Clear()
   $role.AssignableScopes.Add("/subscriptions/mySubscription/resourceGroups/myResourceGroup/providers/Microsoft.ServiceBus/namespaces/mySBNameSpace")
   New-AzureRmRoleDefinition -Role $role 
   ```

## <a name="next-steps"></a><span data-ttu-id="6669e-209">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="6669e-209">Next steps</span></span>
* [<span data-ttu-id="6669e-210">Leia sobre RBAC e permissões no Gerenciador de Recursos</span><span class="sxs-lookup"><span data-stu-id="6669e-210">Read about RBAC and permissions in Resource Manager</span></span>](../active-directory/role-based-access-control-what-is.md)
* [<span data-ttu-id="6669e-211">Visão geral de saudação de leitura de monitoramento no Azure</span><span class="sxs-lookup"><span data-stu-id="6669e-211">Read hello overview of monitoring in Azure</span></span>](monitoring-overview.md)

