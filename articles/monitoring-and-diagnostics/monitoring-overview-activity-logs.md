---
title: "Visão geral do Log de Atividades do Azure | Microsoft Docs"
description: "Saiba o que é o Log de Atividades do Azure e como usá-lo para compreender os eventos que ocorrem dentro de sua assinatura do Azure."
author: johnkemnetz
manager: orenr
editor: 
services: monitoring-and-diagnostics
documentationcenter: monitoring-and-diagnostics
ms.assetid: c274782f-039d-4c28-9ddb-f89ce21052c7
ms.service: monitoring-and-diagnostics
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/02/2017
ms.author: johnkem
ms.openlocfilehash: 8ff9f73fc0732cd2227b7e0cc1091e04d69014eb
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/18/2017
---
# <a name="monitor-subscription-activity-with-the-azure-activity-log"></a><span data-ttu-id="c8316-103">Monitorar a atividade da assinatura com o Log de Atividades do Azure</span><span class="sxs-lookup"><span data-stu-id="c8316-103">Monitor Subscription Activity with the Azure Activity Log</span></span>
<span data-ttu-id="c8316-104">O **Log de Atividades do Azure** é um log de assinatura que fornece informações sobre eventos no nível da assinatura que ocorreram no Azure.</span><span class="sxs-lookup"><span data-stu-id="c8316-104">The **Azure Activity Log** is a subscription log that provides insight into subscription-level events that have occurred in Azure.</span></span> <span data-ttu-id="c8316-105">Isso inclui um intervalo de dados, de dados operacionais do Azure Resource Manager para atualizações em eventos de Integridade do Serviço.</span><span class="sxs-lookup"><span data-stu-id="c8316-105">This includes a range of data, from Azure Resource Manager operational data to updates on Service Health events.</span></span> <span data-ttu-id="c8316-106">O Log de Atividades era conhecido como "Logs de Auditoria" ou "Logs Operacionais", já que a categoria Administrativa relata eventos de plano de controle de suas assinaturas.</span><span class="sxs-lookup"><span data-stu-id="c8316-106">The Activity Log was previously known as “Audit Logs” or “Operational Logs,” since the Administrative category reports control-plane events for your subscriptions.</span></span> <span data-ttu-id="c8316-107">Usando o Log de Atividades, você pode determinar 'o que, quem e quando' para quaisquer operações de gravação (PUT, POST, DELETE) executadas nos recursos em sua assinatura.</span><span class="sxs-lookup"><span data-stu-id="c8316-107">Using the Activity Log, you can determine the ‘what, who, and when’ for any write operations (PUT, POST, DELETE) taken on the resources in your subscription.</span></span> <span data-ttu-id="c8316-108">Também é possível compreender o status da operação e outras propriedades relevantes.</span><span class="sxs-lookup"><span data-stu-id="c8316-108">You can also understand the status of the operation and other relevant properties.</span></span> <span data-ttu-id="c8316-109">O Log de Atividades não inclui operações de leitura (GET) ou operações para recursos que usam o modelo Clássico/"RDFE".</span><span class="sxs-lookup"><span data-stu-id="c8316-109">The Activity Log does not include read (GET) operations or operations for resources that use the Classic/"RDFE" model.</span></span>

![<span data-ttu-id="c8316-110">Logs de Atividade X outros tipos de logs</span><span class="sxs-lookup"><span data-stu-id="c8316-110">Activity Logs vs other types of logs</span></span> ](./media/monitoring-overview-activity-logs/Activity_Log_vs_other_logs_v5.png)

<span data-ttu-id="c8316-111">Figura 1: Logs de Atividade X outros tipos de logs</span><span class="sxs-lookup"><span data-stu-id="c8316-111">Figure 1: Activity Logs vs other types of logs</span></span>

<span data-ttu-id="c8316-112">O Log de Atividades difere dos [Logs de Diagnóstico](monitoring-overview-of-diagnostic-logs.md).</span><span class="sxs-lookup"><span data-stu-id="c8316-112">The Activity Log differs from [Diagnostic Logs](monitoring-overview-of-diagnostic-logs.md).</span></span> <span data-ttu-id="c8316-113">Os Logs de Atividade fornecem dados sobre as operações em um recurso externo (o “plano de controle”).</span><span class="sxs-lookup"><span data-stu-id="c8316-113">Activity Logs provide data about the operations on a resource from the outside (the "control plane").</span></span> <span data-ttu-id="c8316-114">Os Logs de Diagnóstico são emitidos por um recurso e fornecem informações sobre a operação do recurso (o “plano de dados”).</span><span class="sxs-lookup"><span data-stu-id="c8316-114">Diagnostics Logs are emitted by a resource and provide information about the operation of that resource (the "data plane").</span></span>

<span data-ttu-id="c8316-115">Você pode recuperar os eventos de seu Log de Atividade usando o Portal do Azure, a CLI, cmdlets do PowerShell e a API REST do Azure Monitor.</span><span class="sxs-lookup"><span data-stu-id="c8316-115">You can retrieve events from your Activity Log using the Azure portal, CLI, PowerShell cmdlets, and Azure Monitor REST API.</span></span>


> [!WARNING]
> <span data-ttu-id="c8316-116">O Log de Atividades do Azure é usado principalmente para atividades que ocorrem no Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="c8316-116">The Azure Activity Log is primarily for activities that occur in Azure Resource Manager.</span></span> <span data-ttu-id="c8316-117">Ele não controla os recursos usando o modelo Clássico/RDFE.</span><span class="sxs-lookup"><span data-stu-id="c8316-117">It does not track resources using the Classic/RDFE model.</span></span> <span data-ttu-id="c8316-118">Alguns tipos de recursos Clássicos têm um provedor de recursos de proxy no Azure Resource Manager (por exemplo, Microsoft.ClassicCompute).</span><span class="sxs-lookup"><span data-stu-id="c8316-118">Some Classic resource types have a proxy resource provider in Azure Resource Manager (for example, Microsoft.ClassicCompute).</span></span> <span data-ttu-id="c8316-119">Se você interagir com um tipo de recurso Clássico por meio do Azure Resource Manager usando esses provedores de recursos de proxy, as operações aparecerão no Log de Atividades.</span><span class="sxs-lookup"><span data-stu-id="c8316-119">If you interact with a Classic resource type through Azure Resource Manager using these proxy resource providers, the operations appear in the Activity Log.</span></span> <span data-ttu-id="c8316-120">Se você interagir com um tipo de recurso clássico no portal Clássico ou fora dos proxies do Azure Resource Manager, suas ações somente serão registradas no Log de Operação.</span><span class="sxs-lookup"><span data-stu-id="c8316-120">If you interact with a Classic resource type in the Classic portal or otherwise outside of the Azure Resource Manager proxies, your actions are only recorded in the Operation Log.</span></span> <span data-ttu-id="c8316-121">O Log de Operação só pode ser acessado no portal Clássico.</span><span class="sxs-lookup"><span data-stu-id="c8316-121">The Operation Log is accessible only in the Classic portal.</span></span>
>
>

<span data-ttu-id="c8316-122">Exiba o vídeo de introdução do Log de Atividades a seguir.</span><span class="sxs-lookup"><span data-stu-id="c8316-122">View the following video introducing the Activity Log.</span></span>
> [!VIDEO https://channel9.msdn.com/Blogs/Seth-Juarez/Logs-John-Kemnetz/player]
> 
>

## <a name="categories-in-the-activity-log"></a><span data-ttu-id="c8316-123">Categorias no Log de Atividades</span><span class="sxs-lookup"><span data-stu-id="c8316-123">Categories in the Activity Log</span></span>
<span data-ttu-id="c8316-124">O Log de Atividades contém várias categorias de dados.</span><span class="sxs-lookup"><span data-stu-id="c8316-124">The Activity Log contains several categories of data.</span></span> <span data-ttu-id="c8316-125">Para obter todos os detalhes sobre o esquema dessas categorias, [veja este artigo](monitoring-activity-log-schema.md).</span><span class="sxs-lookup"><span data-stu-id="c8316-125">For full details on the schemata of these categories, [see this article](monitoring-activity-log-schema.md).</span></span> <span data-ttu-id="c8316-126">Estão incluídos:</span><span class="sxs-lookup"><span data-stu-id="c8316-126">These include:</span></span>
* <span data-ttu-id="c8316-127">**Administrativos** -essa categoria contém o registro de todas as operações de criação, atualização, exclusão e ação executadas por meio do Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="c8316-127">**Administrative** - This category contains the record of all create, update, delete, and action operations performed through Resource Manager.</span></span> <span data-ttu-id="c8316-128">Os exemplos dos tipos de eventos que você vê nessa categoria incluem "criar máquina virtual" e "excluir grupo de segurança". Cada ação tomada por um usuário ou um aplicativo usando o Resource Manager é modelada como uma operação em um tipo de recurso específico.</span><span class="sxs-lookup"><span data-stu-id="c8316-128">Examples of the types of events you would see in this category include "create virtual machine" and "delete network security group" Every action taken by a user or application using Resource Manager is modeled as an operation on a particular resource type.</span></span> <span data-ttu-id="c8316-129">Se o tipo de operação for Gravação, Exclusão ou Ação, os registros do início e do êxito ou falha da operação são registrados na categoria Administrativa.</span><span class="sxs-lookup"><span data-stu-id="c8316-129">If the operation type is Write, Delete, or Action, the records of both the start and success or fail of that operation are recorded in the Administrative category.</span></span> <span data-ttu-id="c8316-130">A categoria administrativa também inclui alterações de controle de acesso baseado em função em uma assinatura.</span><span class="sxs-lookup"><span data-stu-id="c8316-130">The Administrative category also includes any changes to role-based access control in a subscription.</span></span>
* <span data-ttu-id="c8316-131">**Integridade do Serviço** - essa categoria contém o registro de qualquer incidente de integridade do serviço ocorrido no Azure.</span><span class="sxs-lookup"><span data-stu-id="c8316-131">**Service Health** - This category contains the record of any service health incidents that have occurred in Azure.</span></span> <span data-ttu-id="c8316-132">Um exemplo do tipo de evento que você vê nessa categoria é "SQL Azure no Leste dos EUA está passando por tempo de inatividade".</span><span class="sxs-lookup"><span data-stu-id="c8316-132">An example of the type of event you would see in this category is "SQL Azure in East US is experiencing downtime."</span></span> <span data-ttu-id="c8316-133">Os eventos de serviço de integridade são fornecidos em cinco variedades: Ação Necessária, Recuperação Assistida, Incidente, Manutenção, Informações ou Segurança, e só aparecerão se você tiver um recurso na assinatura que seria afetada pelo evento.</span><span class="sxs-lookup"><span data-stu-id="c8316-133">Service health events come in five varieties: Action Required, Assisted Recovery, Incident, Maintenance, Information, or Security, and only appear if you have a resource in the subscription that would be impacted by the event.</span></span>
* <span data-ttu-id="c8316-134">**Alerta** - esta categoria contém o registro de todas as ativações de alertas do Azure.</span><span class="sxs-lookup"><span data-stu-id="c8316-134">**Alert** - This category contains the record of all activations of Azure alerts.</span></span> <span data-ttu-id="c8316-135">Um exemplo do tipo de evento que você vê nessa categoria é "% de CPU em myVM foi 80 nos últimos 5 minutos."</span><span class="sxs-lookup"><span data-stu-id="c8316-135">An example of the type of event you would see in this category is "CPU % on myVM has been over 80 for the past 5 minutes."</span></span> <span data-ttu-id="c8316-136">Uma variedade de sistemas do Azure têm um conceito de alerta – você pode definir uma regra de algum tipo e receber uma notificação quando as condições corresponderem a essa regra.</span><span class="sxs-lookup"><span data-stu-id="c8316-136">A variety of Azure systems have an alerting concept -- you can define a rule of some sort and receive a notification when conditions match that rule.</span></span> <span data-ttu-id="c8316-137">Cada vez que um tipo de alerta com suporte do Azure é 'ativado', ou as condições são atendidas para gerar uma notificação, um registro de ativação também é enviado para essa categoria de Log de Atividades.</span><span class="sxs-lookup"><span data-stu-id="c8316-137">Each time a supported Azure alert type 'activates,' or the conditions are met to generate a notification, a record of the activation is also pushed to this category of the Activity Log.</span></span>
* <span data-ttu-id="c8316-138">**Dimensionamento automático** -essa categoria contém o registro de todos os eventos relacionados à operação do mecanismo de dimensionamento automático com base em quaisquer configurações de dimensionamento automático que você definiu na sua assinatura.</span><span class="sxs-lookup"><span data-stu-id="c8316-138">**Autoscale** - This category contains the record of any events related to the operation of the autoscale engine based on any autoscale settings you have defined in your subscription.</span></span> <span data-ttu-id="c8316-139">Um exemplo do tipo de evento que você veria nessa categoria é "Falha na ação de escalar horizontalmente do Dimensionamento Automático".</span><span class="sxs-lookup"><span data-stu-id="c8316-139">An example of the type of event you would see in this category is "Autoscale scale up action failed."</span></span> <span data-ttu-id="c8316-140">Usando o dimensionamento automático, você pode dimensionar o número de instâncias em um tipo de recurso com suporte com base na hora do dia e/ou dados de carga (métricas) usando uma configuração de dimensionamento automático.</span><span class="sxs-lookup"><span data-stu-id="c8316-140">Using autoscale, you can automatically scale out or scale in the number of instances in a supported resource type based on time of day and/or load (metric) data using an autoscale setting.</span></span> <span data-ttu-id="c8316-141">Quando as condições de redimensionamento forem atendidas, os eventos iniciados e bem-sucedidos ou com falha serão registrados nessa categoria.</span><span class="sxs-lookup"><span data-stu-id="c8316-141">When the conditions are met to scale up or down, the start and succeeded or failed events are recorded in this category.</span></span>
* <span data-ttu-id="c8316-142">**Recomendação** - essa categoria contém eventos de recomendação de certos tipos de recursos, como sites e servidores SQL.</span><span class="sxs-lookup"><span data-stu-id="c8316-142">**Recommendation** - This category contains recommendation events from certain resource types, such as web sites and SQL servers.</span></span> <span data-ttu-id="c8316-143">Estes eventos oferecem recomendações sobre como utilizar melhor seus recursos.</span><span class="sxs-lookup"><span data-stu-id="c8316-143">These events offer recommendations for how to better utilize your resources.</span></span> <span data-ttu-id="c8316-144">Você só receberá eventos desse tipo se tiver recursos que emitam recomendações.</span><span class="sxs-lookup"><span data-stu-id="c8316-144">You only receive events of this type if you have resources that emit recommendations.</span></span>
* <span data-ttu-id="c8316-145">**Política de segurança e integridade de recursos** -essas categorias não contêm eventos; elas estão reservadas para uso futuro.</span><span class="sxs-lookup"><span data-stu-id="c8316-145">**Policy, Security, and Resource Health** - These categories do not contain any events; they are reserved for future use.</span></span>

## <a name="event-schema-per-category"></a><span data-ttu-id="c8316-146">Esquema de eventos por categoria</span><span class="sxs-lookup"><span data-stu-id="c8316-146">Event schema per category</span></span>
[<span data-ttu-id="c8316-147">Veja este artigo para compreender o esquema de evento do Log de Atividades por categoria.</span><span class="sxs-lookup"><span data-stu-id="c8316-147">See this article to understand the Activity Log event schema per category.</span></span>](monitoring-activity-log-schema.md)

## <a name="what-you-can-do-with-the-activity-log"></a><span data-ttu-id="c8316-148">O que você pode fazer com o Log de Atividades</span><span class="sxs-lookup"><span data-stu-id="c8316-148">What you can do with the Activity Log</span></span>
<span data-ttu-id="c8316-149">Veja algumas coisas que você pode fazer com o Log de Atividades:</span><span class="sxs-lookup"><span data-stu-id="c8316-149">Here are some of the things you can do with the Activity Log:</span></span>

![Log de Atividades do Azure](./media/monitoring-overview-activity-logs/Activity_Log_Overview_v3.png)


* <span data-ttu-id="c8316-151">Consultar e exibi-lo no **Portal do Azure**.</span><span class="sxs-lookup"><span data-stu-id="c8316-151">Query and view it in the **Azure portal**.</span></span>
* [<span data-ttu-id="c8316-152">Criar um alerta em um evento do Log de Atividades.</span><span class="sxs-lookup"><span data-stu-id="c8316-152">Create an alert on an Activity Log event.</span></span>](monitoring-activity-log-alerts.md)
* <span data-ttu-id="c8316-153">[Transmiti-lo para um **Hub de Eventos**](monitoring-stream-activity-logs-event-hubs.md) para ingestão por um serviço de terceiro ou solução de análise personalizada, como o PowerBI.</span><span class="sxs-lookup"><span data-stu-id="c8316-153">[Stream it to an **Event Hub**](monitoring-stream-activity-logs-event-hubs.md) for ingestion by a third-party service or custom analytics solution such as PowerBI.</span></span>
* <span data-ttu-id="c8316-154">Analisá-lo no PowerBI usando o [**Pacote de conteúdo do PowerBI**](https://powerbi.microsoft.com/documentation/powerbi-content-pack-azure-audit-logs/).</span><span class="sxs-lookup"><span data-stu-id="c8316-154">Analyze it in PowerBI using the [**PowerBI content pack**](https://powerbi.microsoft.com/documentation/powerbi-content-pack-azure-audit-logs/).</span></span>
* <span data-ttu-id="c8316-155">[Salvá-lo em uma **Conta de Armazenamento** para inspeção manual ou arquivamento](monitoring-archive-activity-log.md).</span><span class="sxs-lookup"><span data-stu-id="c8316-155">[Save it to a **Storage Account** for archival or manual inspection](monitoring-archive-activity-log.md).</span></span> <span data-ttu-id="c8316-156">Você pode especificar o tempo de retenção (em dias) usando o **Perfil de Log**.</span><span class="sxs-lookup"><span data-stu-id="c8316-156">You can specify the retention time (in days) using the **Log Profile**.</span></span>
* <span data-ttu-id="c8316-157">Consultar por meio de Cmdlet do PowerShell, da CLI ou da API REST.</span><span class="sxs-lookup"><span data-stu-id="c8316-157">Query it via PowerShell Cmdlet, CLI, or REST API.</span></span>

## <a name="query-the-activity-log-in-the-azure-portal"></a><span data-ttu-id="c8316-158">Consultar o Log de Atividades no Portal do Azure</span><span class="sxs-lookup"><span data-stu-id="c8316-158">Query the Activity Log in the Azure portal</span></span>
<span data-ttu-id="c8316-159">No Portal do Azure, você pode exibir seu Log de Atividades em vários locais:</span><span class="sxs-lookup"><span data-stu-id="c8316-159">Within the Azure portal you can view your Activity Log in several places:</span></span>
* <span data-ttu-id="c8316-160">A **folha Log de Atividades**, que pode ser acessada pesquisando Log de Atividades em "Mais Serviços" no painel de navegação esquerdo.</span><span class="sxs-lookup"><span data-stu-id="c8316-160">The **Activity Log blade**, which you can access by searching for the Activity Log under "More Services" in the left-hand navigation pane.</span></span>
* <span data-ttu-id="c8316-161">A **folha Monitor**, que é exibida por padrão no painel de navegação esquerdo.</span><span class="sxs-lookup"><span data-stu-id="c8316-161">The **Monitor blade**, which appears by default in the left-hand navigation pane.</span></span> <span data-ttu-id="c8316-162">O Log de Atividades é uma seção dessa folha do Azure Monitor.</span><span class="sxs-lookup"><span data-stu-id="c8316-162">The Activity Log is one section of this Azure Monitor blade.</span></span>
* <span data-ttu-id="c8316-163">Qualquer **folha de recursos** do recurso, por exemplo, a folha de configuração de uma máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="c8316-163">Any resource's **resource blade**, for example, the configuration blade for a Virtual Machine.</span></span> <span data-ttu-id="c8316-164">O Log de Atividades é uma das seções na maioria das folhas de recursos, e ao clicar nele os eventos relacionados a esse recurso específico são filtrados automaticamente.</span><span class="sxs-lookup"><span data-stu-id="c8316-164">The Activity Log is be one of the sections on most of these resource blades, and clicking on it automatically filters the events to those related to that specific resource.</span></span>

<span data-ttu-id="c8316-165">No Portal do Azure, você pode filtrar seu Log de Atividades por estes campos:</span><span class="sxs-lookup"><span data-stu-id="c8316-165">In the Azure portal, you can filter your Activity Log by these fields:</span></span>
* <span data-ttu-id="c8316-166">Intervalo de tempo – A hora de início e de término dos eventos.</span><span class="sxs-lookup"><span data-stu-id="c8316-166">Timespan - The start and end time for events.</span></span>
* <span data-ttu-id="c8316-167">Categoria – A categoria do evento conforme descrito acima.</span><span class="sxs-lookup"><span data-stu-id="c8316-167">Category - The event category as described above.</span></span>
* <span data-ttu-id="c8316-168">Assinatura – Um ou mais nomes de assinatura do Azure.</span><span class="sxs-lookup"><span data-stu-id="c8316-168">Subscription - One or more Azure subscription names.</span></span>
* <span data-ttu-id="c8316-169">Grupo de recursos – Um ou mais grupos de recursos nessas assinaturas.</span><span class="sxs-lookup"><span data-stu-id="c8316-169">Resource group - One or more resource groups within those subscriptions.</span></span>
* <span data-ttu-id="c8316-170">Recurso (nome) – O nome de um recurso específico.</span><span class="sxs-lookup"><span data-stu-id="c8316-170">Resource (name) - The name of a specific resource.</span></span>
* <span data-ttu-id="c8316-171">Tipo de recurso – O tipo de recurso, por exemplo, Microsoft.Compute/virtualmachines.</span><span class="sxs-lookup"><span data-stu-id="c8316-171">Resource type - The type of resource, for example, Microsoft.Compute/virtualmachines.</span></span>
* <span data-ttu-id="c8316-172">Nome da operação – O nome de uma operação do Azure Resource Manager, por exemplo, Microsoft.SQL/servers/Write.</span><span class="sxs-lookup"><span data-stu-id="c8316-172">Operation name - The name of an Azure Resource Manager operation, for example, Microsoft.SQL/servers/Write.</span></span>
* <span data-ttu-id="c8316-173">Gravidade – O nível de gravidade do evento (Informativo, Aviso, Erro, Crítico).</span><span class="sxs-lookup"><span data-stu-id="c8316-173">Severity - The severity level of the event (Informational, Warning, Error, Critical).</span></span>
* <span data-ttu-id="c8316-174">Evento iniciado por – O "chamador" ou o usuário que realizou a operação.</span><span class="sxs-lookup"><span data-stu-id="c8316-174">Event initiated by - The 'caller,' or user who performed the operation.</span></span>
* <span data-ttu-id="c8316-175">Pesquisa aberta – Isso é uma caixa de pesquisa de texto aberto que procura essa cadeia de caracteres em todos os campos de todos os eventos.</span><span class="sxs-lookup"><span data-stu-id="c8316-175">Open search - This is an open text search box that searches for that string across all fields in all events.</span></span>

<span data-ttu-id="c8316-176">Após a definição de um conjunto de filtros, salve-o como uma consulta que é persistente entre as sessões, se você precisar executar a mesma consulta com os filtros aplicados novamente.</span><span class="sxs-lookup"><span data-stu-id="c8316-176">Once you have defined a set of filters, you can save it as a query that is persisted across sessions if you ever need to perform the same query with those filters applied again in the future.</span></span> <span data-ttu-id="c8316-177">Você também pode fixar uma consulta em seu painel do Azure para sempre ficar atento a eventos específicos.</span><span class="sxs-lookup"><span data-stu-id="c8316-177">You can also pin a query to your Azure dashboard to always keep an eye on specific events.</span></span>

<span data-ttu-id="c8316-178">Clicar em "Aplicar" executa sua consulta e mostrar todos os eventos correspondentes.</span><span class="sxs-lookup"><span data-stu-id="c8316-178">Clicking "Apply" runs your query and show all matching events.</span></span> <span data-ttu-id="c8316-179">Clicar em qualquer evento na lista mostra o resumo desse evento, bem como o JSON bruto e completo desse evento.</span><span class="sxs-lookup"><span data-stu-id="c8316-179">Clicking on any event in the list shows the summary of that event as well as the full raw JSON of that event.</span></span>

<span data-ttu-id="c8316-180">Para ter ainda mais recursos, você pode clicar no ícone **Pesquisa de Log**, que exibe os dados de seu Log de Atividades na [solução de Análise do Log de Atividades do Log Analytics](../log-analytics/log-analytics-activity.md).</span><span class="sxs-lookup"><span data-stu-id="c8316-180">For even more power, you can click the **Log Search** icon, which displays your Activity Log data in the [Log Analytics Activity Log Analytics solution](../log-analytics/log-analytics-activity.md).</span></span> <span data-ttu-id="c8316-181">A folha Log de Atividades oferece uma experiência básica de filtro/procura nos logs, mas o Log Analytics permite que você dinamize, consulte e visualize os dados de formas mais eficientes.</span><span class="sxs-lookup"><span data-stu-id="c8316-181">The Activity Log blade offers a basic filter/browse experience on logs, but Log Analytics enables you to pivot, query, and visualize your data in more powerful ways.</span></span>

## <a name="export-the-activity-log-with-a-log-profile"></a><span data-ttu-id="c8316-182">Exportar o Log de Atividades com um Perfil de Log</span><span class="sxs-lookup"><span data-stu-id="c8316-182">Export the Activity Log with a Log Profile</span></span>
<span data-ttu-id="c8316-183">Um **Perfil de Log** controla o modo de exportação de seu Log de Atividades.</span><span class="sxs-lookup"><span data-stu-id="c8316-183">A **Log Profile** controls how your Activity Log is exported.</span></span> <span data-ttu-id="c8316-184">Com um Perfil de Log, você pode configurar:</span><span class="sxs-lookup"><span data-stu-id="c8316-184">Using a Log Profile, you can configure:</span></span>

* <span data-ttu-id="c8316-185">Aonde o Log de Atividades deve ser enviado (Conta de Armazenamento ou Hubs de Eventos)</span><span class="sxs-lookup"><span data-stu-id="c8316-185">Where the Activity Log should be sent (Storage Account or Event Hubs)</span></span>
* <span data-ttu-id="c8316-186">Quais categorias de evento (Gravação, Exclusão, Ação) devem ser enviadas.</span><span class="sxs-lookup"><span data-stu-id="c8316-186">Which event categories (Write, Delete, Action) should be sent.</span></span> <span data-ttu-id="c8316-187">*O significado de "categoria" em Perfis de Log e eventos de Log de Atividades é diferente. No Perfil de Log, "Category" representa o tipo de operação (Gravar, Excluir, Ação). Em um evento do Log de Atividades, a propriedade "category" representa a origem ou o tipo de evento (por exemplo, Administração, Serviço de Integridade, Alerta e muito mais).*</span><span class="sxs-lookup"><span data-stu-id="c8316-187">*The meaning of "category" in Log Profiles and Activity Log events is different. In the Log Profile, "Category" represents the operation type (Write, Delete, Action). In an Activity Log event, the "category" property represents the source or type of event (for example, Administration, ServiceHealth, Alert, and more).*</span></span>
* <span data-ttu-id="c8316-188">Quais regiões (locais) devem ser exportados.</span><span class="sxs-lookup"><span data-stu-id="c8316-188">Which regions (locations) should be exported.</span></span> <span data-ttu-id="c8316-189">Inclua "global", pois muitos eventos no Log de Atividades são eventos globais.</span><span class="sxs-lookup"><span data-stu-id="c8316-189">Make sure to include "global," as many events in the Activity Log are global events.</span></span>
* <span data-ttu-id="c8316-190">Quanto tempo o Log de Atividades deve ser mantido em uma Conta de Armazenamento.</span><span class="sxs-lookup"><span data-stu-id="c8316-190">How long the Activity Log should be retained in a Storage Account.</span></span>
    - <span data-ttu-id="c8316-191">Uma retenção de zero dias significa que os registros serão mantidos indefinidamente.</span><span class="sxs-lookup"><span data-stu-id="c8316-191">A retention of zero days means logs are kept forever.</span></span> <span data-ttu-id="c8316-192">O valor pode ser qualquer quantidade de dias, entre 1 e 2147483647.</span><span class="sxs-lookup"><span data-stu-id="c8316-192">Otherwise, the value can be any number of days between 1 and 2147483647.</span></span>
    - <span data-ttu-id="c8316-193">Se as políticas de retenção são definidas, mas o armazenamento dos logs em uma Conta de Armazenamento está desabilitado (por exemplo, se apenas as opções Hubs de Eventos ou OMS estão selecionadas), as políticas de retenção não têm nenhum efeito.</span><span class="sxs-lookup"><span data-stu-id="c8316-193">If retention policies are set but storing logs in a Storage Account is disabled (for example, if only Event Hubs or OMS options are selected), the retention policies have no effect.</span></span>
    - <span data-ttu-id="c8316-194">As políticas de retenção são aplicadas por dia, para que, ao final de um dia (UTC), os logs do dia após a política de retenção sejam excluídos.</span><span class="sxs-lookup"><span data-stu-id="c8316-194">Retention policies are applied per-day, so at the end of a day (UTC), logs from the day that is now beyond the retention policy are deleted.</span></span> <span data-ttu-id="c8316-195">Por exemplo, se você tiver uma política de retenção de um dia, no início do dia de hoje, os logs de anteontem serão excluídos.</span><span class="sxs-lookup"><span data-stu-id="c8316-195">For example, if you had a retention policy of one day, at the beginning of the day today the logs from the day before yesterday would be deleted.</span></span>

<span data-ttu-id="c8316-196">Você pode usar uma conta de armazenamento ou um namespace de hub de eventos que não esteja na mesma assinatura para emitir logs.</span><span class="sxs-lookup"><span data-stu-id="c8316-196">You can use a storage account or event hub namespace that is not in the same subscription as the one emitting logs.</span></span> <span data-ttu-id="c8316-197">O usuário que define a configuração deve ter o devido acesso RBAC para ambas as assinaturas.</span><span class="sxs-lookup"><span data-stu-id="c8316-197">The user who configures the setting must have the appropriate RBAC access to both subscriptions.</span></span>

<span data-ttu-id="c8316-198">Essas configurações podem ser definidas por meio da opção "Exportar" na folha do Log de Atividades no portal.</span><span class="sxs-lookup"><span data-stu-id="c8316-198">These settings can be configured via the “Export” option in the Activity Log blade in the portal.</span></span> <span data-ttu-id="c8316-199">Elas também podem ser definidas por meio de programação [usando a API REST do Azure Monitor](https://msdn.microsoft.com/library/azure/dn931927.aspx), de cmdlets do PowerShell ou da CLI.</span><span class="sxs-lookup"><span data-stu-id="c8316-199">They can also be configured programmatically [using the Azure Monitor REST API](https://msdn.microsoft.com/library/azure/dn931927.aspx), PowerShell cmdlets, or CLI.</span></span> <span data-ttu-id="c8316-200">Uma assinatura pode ter somente um perfil de log.</span><span class="sxs-lookup"><span data-stu-id="c8316-200">A subscription can only have one log profile.</span></span>

### <a name="configure-log-profiles-using-the-azure-portal"></a><span data-ttu-id="c8316-201">Configurar os perfis de log usando o Portal do Azure</span><span class="sxs-lookup"><span data-stu-id="c8316-201">Configure log profiles using the Azure portal</span></span>
<span data-ttu-id="c8316-202">Você pode transmitir o Log de Atividades para um Hub de Eventos ou armazená-lo em uma Conta de Armazenamento usando a opção "Exportar" no Portal do Azure.</span><span class="sxs-lookup"><span data-stu-id="c8316-202">You can stream the Activity Log to an Event Hub or store them in a Storage Account by using the “Export” option in the Azure portal.</span></span>

1. <span data-ttu-id="c8316-203">Navegue até a folha **Log de Atividades** usando o menu no lado esquerdo do portal.</span><span class="sxs-lookup"><span data-stu-id="c8316-203">Navigate to the **Activity Log** blade using the menu on the left side of the portal.</span></span>

    ![Navegue até o Log de Atividades no portal](./media/monitoring-overview-activity-logs/activity-logs-portal-navigate.png)
2. <span data-ttu-id="c8316-205">Clique no botão **Exportar** na parte superior da folha.</span><span class="sxs-lookup"><span data-stu-id="c8316-205">Click the **Export** button at the top of the blade.</span></span>

    ![Botão Exportar no portal](./media/monitoring-overview-activity-logs/activity-logs-portal-export.png)
3. <span data-ttu-id="c8316-207">Na folha que aparece, você pode selecionar:</span><span class="sxs-lookup"><span data-stu-id="c8316-207">In the blade that appears, you can select:</span></span>  
  * <span data-ttu-id="c8316-208">regiões para as quais você deseja exportar eventos</span><span class="sxs-lookup"><span data-stu-id="c8316-208">regions for which you would like to export events</span></span>
  * <span data-ttu-id="c8316-209">a conta de armazenamento na qual você deseja salvar os eventos</span><span class="sxs-lookup"><span data-stu-id="c8316-209">the Storage Account to which you would like to save events</span></span>
  * <span data-ttu-id="c8316-210">o número de dias para manter esses eventos no armazenamento.</span><span class="sxs-lookup"><span data-stu-id="c8316-210">the number of days you want to retain these events in storage.</span></span> <span data-ttu-id="c8316-211">Uma configuração de 0 dias retém os logs para sempre.</span><span class="sxs-lookup"><span data-stu-id="c8316-211">A setting of 0 days retains the logs forever.</span></span>
  * <span data-ttu-id="c8316-212">o namespace do Barramento de Serviço no qual você deseja que um Hub de Eventos seja criado para transmitir esses eventos.</span><span class="sxs-lookup"><span data-stu-id="c8316-212">the Service Bus Namespace in which you would like an Event Hub to be created for streaming these events.</span></span>

     ![Folha Exportar Log de Atividades](./media/monitoring-overview-activity-logs/activity-logs-portal-export-blade.png)
4. <span data-ttu-id="c8316-214">Clique em **Salvar** para salvar as configurações.</span><span class="sxs-lookup"><span data-stu-id="c8316-214">Click **Save** to save these settings.</span></span> <span data-ttu-id="c8316-215">As configurações serão aplicadas imediatamente à sua assinatura.</span><span class="sxs-lookup"><span data-stu-id="c8316-215">The settings are immediately be applied to your subscription.</span></span>

### <a name="configure-log-profiles-using-the-azure-powershell-cmdlets"></a><span data-ttu-id="c8316-216">Configurar os perfis de log usando Cmdlets do Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="c8316-216">Configure log profiles using the Azure PowerShell Cmdlets</span></span>
#### <a name="get-existing-log-profile"></a><span data-ttu-id="c8316-217">Obter o perfil de log existente</span><span class="sxs-lookup"><span data-stu-id="c8316-217">Get existing log profile</span></span>
```
Get-AzureRmLogProfile
```

#### <a name="add-a-log-profile"></a><span data-ttu-id="c8316-218">Adicionar um perfil de log</span><span class="sxs-lookup"><span data-stu-id="c8316-218">Add a log profile</span></span>
```
Add-AzureRmLogProfile -Name my_log_profile -StorageAccountId /subscriptions/s1/resourceGroups/myrg1/providers/Microsoft.Storage/storageAccounts/my_storage -serviceBusRuleId /subscriptions/s1/resourceGroups/Default-ServiceBus-EastUS/providers/Microsoft.ServiceBus/namespaces/mytestSB/authorizationrules/RootManageSharedAccessKey -Locations global,westus,eastus -RetentionInDays 90 -Categories Write,Delete,Action
```

| <span data-ttu-id="c8316-219">Propriedade</span><span class="sxs-lookup"><span data-stu-id="c8316-219">Property</span></span> | <span data-ttu-id="c8316-220">Obrigatório</span><span class="sxs-lookup"><span data-stu-id="c8316-220">Required</span></span> | <span data-ttu-id="c8316-221">Descrição</span><span class="sxs-lookup"><span data-stu-id="c8316-221">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="c8316-222">Nome</span><span class="sxs-lookup"><span data-stu-id="c8316-222">Name</span></span> |<span data-ttu-id="c8316-223">Sim</span><span class="sxs-lookup"><span data-stu-id="c8316-223">Yes</span></span> |<span data-ttu-id="c8316-224">Nome de seu perfil de log.</span><span class="sxs-lookup"><span data-stu-id="c8316-224">Name of your log profile.</span></span> |
| <span data-ttu-id="c8316-225">StorageAccountId</span><span class="sxs-lookup"><span data-stu-id="c8316-225">StorageAccountId</span></span> |<span data-ttu-id="c8316-226">Não</span><span class="sxs-lookup"><span data-stu-id="c8316-226">No</span></span> |<span data-ttu-id="c8316-227">ID de recursos da Conta de Armazenamento na qual o Log de Atividades deve ser salvo.</span><span class="sxs-lookup"><span data-stu-id="c8316-227">Resource ID of the Storage Account to which the Activity Log should be saved.</span></span> |
| <span data-ttu-id="c8316-228">serviceBusRuleId</span><span class="sxs-lookup"><span data-stu-id="c8316-228">serviceBusRuleId</span></span> |<span data-ttu-id="c8316-229">Não</span><span class="sxs-lookup"><span data-stu-id="c8316-229">No</span></span> |<span data-ttu-id="c8316-230">ID da Regra de Barramento de Serviço para o namespace do Barramento de Serviço no qual você gostaria que os hubs de eventos fossem criados.</span><span class="sxs-lookup"><span data-stu-id="c8316-230">Service Bus Rule ID for the Service Bus namespace you would like to have event hubs created in.</span></span> <span data-ttu-id="c8316-231">É uma cadeia de caracteres com este formato: `{service bus resource ID}/authorizationrules/{key name}`.</span><span class="sxs-lookup"><span data-stu-id="c8316-231">Is a string with this format: `{service bus resource ID}/authorizationrules/{key name}`.</span></span> |
| <span data-ttu-id="c8316-232">Locais</span><span class="sxs-lookup"><span data-stu-id="c8316-232">Locations</span></span> |<span data-ttu-id="c8316-233">Sim</span><span class="sxs-lookup"><span data-stu-id="c8316-233">Yes</span></span> |<span data-ttu-id="c8316-234">Lista separada por vírgulas de regiões para as quais você gostaria de coletar eventos do Log de Atividades.</span><span class="sxs-lookup"><span data-stu-id="c8316-234">Comma-separated list of regions for which you would like to collect Activity Log events.</span></span> |
| <span data-ttu-id="c8316-235">RetentionInDays</span><span class="sxs-lookup"><span data-stu-id="c8316-235">RetentionInDays</span></span> |<span data-ttu-id="c8316-236">Sim</span><span class="sxs-lookup"><span data-stu-id="c8316-236">Yes</span></span> |<span data-ttu-id="c8316-237">Número de dias durante os quais os eventos devem ser mantidos, entre 1 e 2147483647.</span><span class="sxs-lookup"><span data-stu-id="c8316-237">Number of days for which events should be retained, between 1 and 2147483647.</span></span> <span data-ttu-id="c8316-238">Um valor de zero armazena os logs indefinidamente (para sempre).</span><span class="sxs-lookup"><span data-stu-id="c8316-238">A value of zero stores the logs indefinitely (forever).</span></span> |
| <span data-ttu-id="c8316-239">Categorias</span><span class="sxs-lookup"><span data-stu-id="c8316-239">Categories</span></span> |<span data-ttu-id="c8316-240">Não</span><span class="sxs-lookup"><span data-stu-id="c8316-240">No</span></span> |<span data-ttu-id="c8316-241">Lista separada por vírgulas de categorias de eventos que devem ser coletados.</span><span class="sxs-lookup"><span data-stu-id="c8316-241">Comma-separated list of event categories that should be collected.</span></span> <span data-ttu-id="c8316-242">Os valores possíveis são Gravação, Exclusão e Ação.</span><span class="sxs-lookup"><span data-stu-id="c8316-242">Possible values are Write, Delete, and Action.</span></span> |

#### <a name="remove-a-log-profile"></a><span data-ttu-id="c8316-243">Remover um perfil de log</span><span class="sxs-lookup"><span data-stu-id="c8316-243">Remove a log profile</span></span>
```
Remove-AzureRmLogProfile -name my_log_profile
```

### <a name="configure-log-profiles-using-the-azure-cross-platform-cli"></a><span data-ttu-id="c8316-244">Configurar os perfis de log usando a CLI de plataforma cruzada do Azure</span><span class="sxs-lookup"><span data-stu-id="c8316-244">Configure log profiles Using the Azure Cross-Platform CLI</span></span>
#### <a name="get-existing-log-profile"></a><span data-ttu-id="c8316-245">Obter o perfil de log existente</span><span class="sxs-lookup"><span data-stu-id="c8316-245">Get existing log profile</span></span>
```
azure insights logprofile list
```
```
azure insights logprofile get --name my_log_profile
```
<span data-ttu-id="c8316-246">A propriedade `name` deve ser o nome de seu perfil de log.</span><span class="sxs-lookup"><span data-stu-id="c8316-246">The `name` property should be the name of your log profile.</span></span>

#### <a name="add-a-log-profile"></a><span data-ttu-id="c8316-247">Adicionar um perfil de log</span><span class="sxs-lookup"><span data-stu-id="c8316-247">Add a log profile</span></span>
```
azure insights logprofile add --name my_log_profile --storageId /subscriptions/s1/resourceGroups/insights-integration/providers/Microsoft.Storage/storageAccounts/my_storage --serviceBusRuleId /subscriptions/s1/resourceGroups/Default-ServiceBus-EastUS/providers/Microsoft.ServiceBus/namespaces/mytestSB/authorizationrules/RootManageSharedAccessKey --locations global,westus,eastus,northeurope --retentionInDays 90 –categories Write,Delete,Action
```

| <span data-ttu-id="c8316-248">Propriedade</span><span class="sxs-lookup"><span data-stu-id="c8316-248">Property</span></span> | <span data-ttu-id="c8316-249">Obrigatório</span><span class="sxs-lookup"><span data-stu-id="c8316-249">Required</span></span> | <span data-ttu-id="c8316-250">Descrição</span><span class="sxs-lookup"><span data-stu-id="c8316-250">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="c8316-251">name</span><span class="sxs-lookup"><span data-stu-id="c8316-251">name</span></span> |<span data-ttu-id="c8316-252">Sim</span><span class="sxs-lookup"><span data-stu-id="c8316-252">Yes</span></span> |<span data-ttu-id="c8316-253">Nome de seu perfil de log.</span><span class="sxs-lookup"><span data-stu-id="c8316-253">Name of your log profile.</span></span> |
| <span data-ttu-id="c8316-254">storageId</span><span class="sxs-lookup"><span data-stu-id="c8316-254">storageId</span></span> |<span data-ttu-id="c8316-255">Não</span><span class="sxs-lookup"><span data-stu-id="c8316-255">No</span></span> |<span data-ttu-id="c8316-256">ID de recursos da Conta de Armazenamento na qual o Log de Atividades deve ser salvo.</span><span class="sxs-lookup"><span data-stu-id="c8316-256">Resource ID of the Storage Account to which the Activity Log should be saved.</span></span> |
| <span data-ttu-id="c8316-257">serviceBusRuleId</span><span class="sxs-lookup"><span data-stu-id="c8316-257">serviceBusRuleId</span></span> |<span data-ttu-id="c8316-258">Não</span><span class="sxs-lookup"><span data-stu-id="c8316-258">No</span></span> |<span data-ttu-id="c8316-259">ID da Regra de Barramento de Serviço para o namespace do Barramento de Serviço no qual você gostaria que os hubs de eventos fossem criados.</span><span class="sxs-lookup"><span data-stu-id="c8316-259">Service Bus Rule ID for the Service Bus namespace you would like to have event hubs created in.</span></span> <span data-ttu-id="c8316-260">É uma cadeia de caracteres com este formato: `{service bus resource ID}/authorizationrules/{key name}`.</span><span class="sxs-lookup"><span data-stu-id="c8316-260">Is a string with this format: `{service bus resource ID}/authorizationrules/{key name}`.</span></span> |
| <span data-ttu-id="c8316-261">locais</span><span class="sxs-lookup"><span data-stu-id="c8316-261">locations</span></span> |<span data-ttu-id="c8316-262">Sim</span><span class="sxs-lookup"><span data-stu-id="c8316-262">Yes</span></span> |<span data-ttu-id="c8316-263">Lista separada por vírgulas de regiões para as quais você gostaria de coletar eventos do Log de Atividades.</span><span class="sxs-lookup"><span data-stu-id="c8316-263">Comma-separated list of regions for which you would like to collect Activity Log events.</span></span> |
| <span data-ttu-id="c8316-264">RetentionInDays</span><span class="sxs-lookup"><span data-stu-id="c8316-264">retentionInDays</span></span> |<span data-ttu-id="c8316-265">Sim</span><span class="sxs-lookup"><span data-stu-id="c8316-265">Yes</span></span> |<span data-ttu-id="c8316-266">Número de dias durante os quais os eventos devem ser mantidos, entre 1 e 2147483647.</span><span class="sxs-lookup"><span data-stu-id="c8316-266">Number of days for which events should be retained, between 1 and 2147483647.</span></span> <span data-ttu-id="c8316-267">Um valor de zero armazena os logs indefinidamente (para sempre).</span><span class="sxs-lookup"><span data-stu-id="c8316-267">A value of zero stores the logs indefinitely (forever).</span></span> |
| <span data-ttu-id="c8316-268">Categorias</span><span class="sxs-lookup"><span data-stu-id="c8316-268">categories</span></span> |<span data-ttu-id="c8316-269">Não</span><span class="sxs-lookup"><span data-stu-id="c8316-269">No</span></span> |<span data-ttu-id="c8316-270">Lista separada por vírgulas de categorias de eventos que devem ser coletados.</span><span class="sxs-lookup"><span data-stu-id="c8316-270">Comma-separated list of event categories that should be collected.</span></span> <span data-ttu-id="c8316-271">Os valores possíveis são Gravação, Exclusão e Ação.</span><span class="sxs-lookup"><span data-stu-id="c8316-271">Possible values are Write, Delete, and Action.</span></span> |

#### <a name="remove-a-log-profile"></a><span data-ttu-id="c8316-272">Remover um perfil de log</span><span class="sxs-lookup"><span data-stu-id="c8316-272">Remove a log profile</span></span>
```
azure insights logprofile delete --name my_log_profile
```

## <a name="next-steps"></a><span data-ttu-id="c8316-273">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="c8316-273">Next Steps</span></span>
* [<span data-ttu-id="c8316-274">Saiba mais sobre o Log de Atividades (anteriormente conhecido como Logs de Auditoria)</span><span class="sxs-lookup"><span data-stu-id="c8316-274">Learn more about the Activity Log (formerly Audit Logs)</span></span>](../azure-resource-manager/resource-group-audit.md)
* [<span data-ttu-id="c8316-275">Transmissão do Log de Atividades do Azure para os Hubs de Eventos</span><span class="sxs-lookup"><span data-stu-id="c8316-275">Stream the Azure Activity Log to Event Hubs</span></span>](monitoring-stream-activity-logs-event-hubs.md)
