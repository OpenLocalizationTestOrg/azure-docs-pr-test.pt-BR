---
title: "práticas recomendadas de aaaBest para dimensionamento automático | Microsoft Docs"
description: "Padrões de dimensionamento automático no Azure para Aplicativos Web, conjuntos de Dimensionamento de Máquina Virtual e Serviços de Nuvem"
author: anirudhcavale
manager: orenr
editor: 
services: monitoring-and-diagnostics
documentationcenter: monitoring-and-diagnostics
ms.assetid: 9fa2b94b-dfa5-4106-96ff-74fd1fba4657
ms.service: monitoring-and-diagnostics
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/07/2017
ms.author: ancav
ms.openlocfilehash: eb731c15e440af93a2675210583878814d0d8818
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="best-practices-for-autoscale"></a><span data-ttu-id="5e702-103">Práticas recomendadas para Dimensionamento Automático</span><span class="sxs-lookup"><span data-stu-id="5e702-103">Best practices for Autoscale</span></span>
<span data-ttu-id="5e702-104">Este artigo ensina tooautoscale de práticas recomendada no Azure.</span><span class="sxs-lookup"><span data-stu-id="5e702-104">This article teaches best practices tooautoscale in Azure.</span></span> <span data-ttu-id="5e702-105">Dimensionamento automático de Monitor do Azure se aplica apenas muito[conjuntos de escala de máquina Virtual](https://azure.microsoft.com/services/virtual-machine-scale-sets/), [serviços de nuvem](https://azure.microsoft.com/services/cloud-services/), e [do serviço de aplicativo - aplicativos Web](https://azure.microsoft.com/services/app-service/web/).</span><span class="sxs-lookup"><span data-stu-id="5e702-105">Azure Monitor autoscale applies only too[Virtual Machine Scale Sets](https://azure.microsoft.com/services/virtual-machine-scale-sets/), [Cloud Services](https://azure.microsoft.com/services/cloud-services/), and [App Service - Web Apps](https://azure.microsoft.com/services/app-service/web/).</span></span> <span data-ttu-id="5e702-106">Outros serviços do Azure usam métodos de dimensionamento diferentes.</span><span class="sxs-lookup"><span data-stu-id="5e702-106">Other Azure services use different scaling methods.</span></span>

## <a name="autoscale-concepts"></a><span data-ttu-id="5e702-107">Conceitos de dimensionamento automático</span><span class="sxs-lookup"><span data-stu-id="5e702-107">Autoscale concepts</span></span>
* <span data-ttu-id="5e702-108">Um recurso pode ter apenas *uma* configuração de Dimensionamento Automático</span><span class="sxs-lookup"><span data-stu-id="5e702-108">A resource can have only *one* autoscale setting</span></span>
* <span data-ttu-id="5e702-109">Uma configuração de Dimensionamento Automático pode ter um ou mais perfis e cada perfil pode ter uma ou mais regras de dimensionamento automático.</span><span class="sxs-lookup"><span data-stu-id="5e702-109">An autoscale setting can have one or more profiles and each profile can have one or more autoscale rules.</span></span>
* <span data-ttu-id="5e702-110">Uma configuração de AutoEscala dimensiona instâncias horizontalmente, que é *out* aumentando instâncias hello e *em* , diminuindo o número de saudação de instâncias.</span><span class="sxs-lookup"><span data-stu-id="5e702-110">An autoscale setting scales instances horizontally, which is *out* by increasing hello instances and *in* by decreasing hello number of instances.</span></span>
  <span data-ttu-id="5e702-111">Uma configuração de dimensionamento automático tem um valor máximo, mínimo e padrão de instâncias.</span><span class="sxs-lookup"><span data-stu-id="5e702-111">An autoscale setting has a maximum, minimum, and default value of instances.</span></span>
* <span data-ttu-id="5e702-112">Um trabalho de dimensionamento automático sempre lê Olá associados tooscale métrica, verificando se ele tem ultrapassou o limite configurado de saudação para expansão ou escala no.</span><span class="sxs-lookup"><span data-stu-id="5e702-112">An autoscale job always reads hello associated metric tooscale by, checking if it has crossed hello configured threshold for scale-out or scale-in.</span></span> <span data-ttu-id="5e702-113">Você pode exibir uma lista de métricas que o dimensionamento automático pode dimensionar em [métricas comuns de dimensionamento automático do Azure Monitor](insights-autoscale-common-metrics.md).</span><span class="sxs-lookup"><span data-stu-id="5e702-113">You can view a list of metrics that autoscale can scale by at [Azure Monitor autoscaling common metrics](insights-autoscale-common-metrics.md).</span></span>
* <span data-ttu-id="5e702-114">Todos os limites são calculados em um nível de instância.</span><span class="sxs-lookup"><span data-stu-id="5e702-114">All thresholds are calculated at an instance level.</span></span> <span data-ttu-id="5e702-115">Por exemplo, "escala fora por 1 instância quando médio da CPU > 80% quando a contagem de instâncias é 2", significa expansão quando Olá média de CPU em todas as instâncias é maior do que 80%.</span><span class="sxs-lookup"><span data-stu-id="5e702-115">For example, "scale out by 1 instance when average CPU > 80% when instance count is 2", means scale-out when hello average CPU across all instances is greater than 80%.</span></span>
* <span data-ttu-id="5e702-116">Você sempre receberá notificações de falha via email.</span><span class="sxs-lookup"><span data-stu-id="5e702-116">You always receive failure notifications via email.</span></span> <span data-ttu-id="5e702-117">Especificamente, o proprietário hello, Colaborador e leitores do recurso de destino Olá recebem email.</span><span class="sxs-lookup"><span data-stu-id="5e702-117">Specifically, hello owner, contributor, and readers of hello target resource receive email.</span></span> <span data-ttu-id="5e702-118">Você também receberá um email de *recuperação* quando o dimensionamento automático se recuperar de uma falha e iniciar o funcionamento normalmente.</span><span class="sxs-lookup"><span data-stu-id="5e702-118">You also always receive a *recovery* email when autoscale recovers from a failure and starts functioning normally.</span></span>
* <span data-ttu-id="5e702-119">Você pode participar tooreceive uma notificação de ação de escala com êxito por meio de email e webhooks.</span><span class="sxs-lookup"><span data-stu-id="5e702-119">You can opt-in tooreceive a successful scale action notification via email and webhooks.</span></span>

## <a name="autoscale-best-practices"></a><span data-ttu-id="5e702-120">Práticas recomendadas de dimensionamento automático</span><span class="sxs-lookup"><span data-stu-id="5e702-120">Autoscale best practices</span></span>
<span data-ttu-id="5e702-121">Use Olá seguir as práticas recomendadas ao usar o dimensionamento automático.</span><span class="sxs-lookup"><span data-stu-id="5e702-121">Use hello following best practices as you use autoscale.</span></span>

### <a name="ensure-hello-maximum-and-minimum-values-are-different-and-have-an-adequate-margin-between-them"></a><span data-ttu-id="5e702-122">Verifique os valores mínimo e máximo Olá são diferentes e tem uma margem suficiente entre eles</span><span class="sxs-lookup"><span data-stu-id="5e702-122">Ensure hello maximum and minimum values are different and have an adequate margin between them</span></span>
<span data-ttu-id="5e702-123">Se você tiver uma configuração que tenha o mínimo = 2, máximo = 2 e a contagem atual de instâncias de saudação é 2, nenhuma ação de escala pode ocorrer.</span><span class="sxs-lookup"><span data-stu-id="5e702-123">If you have a setting that has minimum=2, maximum=2 and hello current instance count is 2, no scale action can occur.</span></span> <span data-ttu-id="5e702-124">Manter uma margem suficiente entre contagens de instância máximo e mínimo hello, que são inclusivos.</span><span class="sxs-lookup"><span data-stu-id="5e702-124">Keep an adequate margin between hello maximum and minimum instance counts, which are inclusive.</span></span> <span data-ttu-id="5e702-125">O dimensionamento automático sempre dimensiona dentro desses limites.</span><span class="sxs-lookup"><span data-stu-id="5e702-125">Autoscale always scales between these limits.</span></span>

### <a name="manual-scaling-is-reset-by-autoscale-min-and-max"></a><span data-ttu-id="5e702-126">O redimensionamento manual é redefinido pelo máximo e pelo mínimo do dimensionamento automático</span><span class="sxs-lookup"><span data-stu-id="5e702-126">Manual scaling is reset by autoscale min and max</span></span>
<span data-ttu-id="5e702-127">Se você atualizar Olá instância contagem tooa valor acima ou abaixo do máximo de Olá Olá AutoEscala mecanismo automaticamente manualmente dimensiona back toohello mínimo (se abaixo) ou hello máximo (se estiver acima).</span><span class="sxs-lookup"><span data-stu-id="5e702-127">If you manually update hello instance count tooa value above or below hello maximum, hello autoscale engine automatically scales back toohello minimum (if below) or hello maximum (if above).</span></span> <span data-ttu-id="5e702-128">Por exemplo, você define o intervalo de saudação entre 3 e 6.</span><span class="sxs-lookup"><span data-stu-id="5e702-128">For example, you set hello range between 3 and 6.</span></span> <span data-ttu-id="5e702-129">Se você tiver uma instância em execução, o mecanismo de dimensionamento automático Olá dimensiona too3 instâncias na sua próxima execução.</span><span class="sxs-lookup"><span data-stu-id="5e702-129">If you have one running instance, hello autoscale engine scales too3 instances on its next run.</span></span> <span data-ttu-id="5e702-130">Da mesma forma, ele seria escala-in 8 instâncias fazer too6 na sua próxima execução.</span><span class="sxs-lookup"><span data-stu-id="5e702-130">Likewise, it would scale-in 8 instances back too6 on its next run.</span></span>  <span data-ttu-id="5e702-131">Redimensionamento manual é muito temporária, a menos que você redefina regras de AutoEscala Olá também.</span><span class="sxs-lookup"><span data-stu-id="5e702-131">Manual scaling is very temporary unless you reset hello autoscale rules as well.</span></span>

### <a name="always-use-a-scale-out-and-scale-in-rule-combination-that-performs-an-increase-and-decrease"></a><span data-ttu-id="5e702-132">Sempre use uma combinação de regras de escala e redução horizontal que executa um aumento e uma redução</span><span class="sxs-lookup"><span data-stu-id="5e702-132">Always use a scale-out and scale-in rule combination that performs an increase and decrease</span></span>
<span data-ttu-id="5e702-133">Se você usar apenas uma parte da combinação de hello, AutoEscala escala-in se o único limite ou, até Olá máximo ou mínimo, é atingido.</span><span class="sxs-lookup"><span data-stu-id="5e702-133">If you use only one part of hello combination, autoscale scale-in that single out, or in, until hello maximum, or minimum, is reached.</span></span>

### <a name="do-not-switch-between-hello-azure-portal-and-hello-azure-classic-portal-when-managing-autoscale"></a><span data-ttu-id="5e702-134">Não alternar entre Olá portal do Azure e hello portal clássico do Azure ao gerenciar o dimensionamento automático</span><span class="sxs-lookup"><span data-stu-id="5e702-134">Do not switch between hello Azure portal and hello Azure classic portal when managing Autoscale</span></span>
<span data-ttu-id="5e702-135">Para serviços de nuvem e serviços de aplicativos (aplicativos da Web), use Olá portal do Azure (portal.azure.com) toocreate e gerenciar configurações de dimensionamento automático.</span><span class="sxs-lookup"><span data-stu-id="5e702-135">For Cloud Services and App Services (Web Apps), use hello Azure portal (portal.azure.com) toocreate and manage autoscale settings.</span></span> <span data-ttu-id="5e702-136">Para conjuntos de escala de máquina Virtual use toocreate PowerShell, CLI ou API REST e gerenciar a configuração de dimensionamento automático.</span><span class="sxs-lookup"><span data-stu-id="5e702-136">For Virtual Machine Scale Sets use PowerShell, CLI or REST API toocreate and manage autoscale setting.</span></span> <span data-ttu-id="5e702-137">Não alterne entre Olá portal clássico do Azure (manage.windowsazure.com) e hello (portal.azure.com) do portal do Azure ao gerenciar configurações de dimensionamento automático.</span><span class="sxs-lookup"><span data-stu-id="5e702-137">Do not switch between hello Azure classic portal (manage.windowsazure.com) and hello Azure portal (portal.azure.com) when managing autoscale configurations.</span></span> <span data-ttu-id="5e702-138">Olá portal clássico do Azure e seu back-end subjacente tem limitações.</span><span class="sxs-lookup"><span data-stu-id="5e702-138">hello Azure classic portal and its underlying backend has limitations.</span></span> <span data-ttu-id="5e702-139">Mova toohello toomanage portal do Azure AutoEscala usando uma interface gráfica do usuário.</span><span class="sxs-lookup"><span data-stu-id="5e702-139">Move toohello Azure portal toomanage autoscale using a graphical user interface.</span></span> <span data-ttu-id="5e702-140">Opções de saudação são toouse Olá AutoEscala PowerShell, CLI ou API REST (por meio do Gerenciador de recursos do Azure).</span><span class="sxs-lookup"><span data-stu-id="5e702-140">hello options are toouse hello autoscale PowerShell, CLI or REST API (via Azure Resource Explorer).</span></span>

### <a name="choose-hello-appropriate-statistic-for-your-diagnostics-metric"></a><span data-ttu-id="5e702-141">Escolha a estatística de saudação apropriado para sua métrica de diagnóstico</span><span class="sxs-lookup"><span data-stu-id="5e702-141">Choose hello appropriate statistic for your diagnostics metric</span></span>
<span data-ttu-id="5e702-142">Para métricas de diagnóstico, você pode escolher entre *médio*, *mínimo*, *máximo* e *Total* como uma métrica tooscale por.</span><span class="sxs-lookup"><span data-stu-id="5e702-142">For diagnostics metrics, you can choose among *Average*, *Minimum*, *Maximum* and *Total* as a metric tooscale by.</span></span> <span data-ttu-id="5e702-143">estatística de Hello mais comum é *médio*.</span><span class="sxs-lookup"><span data-stu-id="5e702-143">hello most common statistic is *Average*.</span></span>

### <a name="choose-hello-thresholds-carefully-for-all-metric-types"></a><span data-ttu-id="5e702-144">Escolha os limites de saudação cuidadosamente para todos os tipos de métrica</span><span class="sxs-lookup"><span data-stu-id="5e702-144">Choose hello thresholds carefully for all metric types</span></span>
<span data-ttu-id="5e702-145">Recomendamos escolher cuidadosamente limites diferentes para escalar e reduzir horizontalmente com base em situações práticas.</span><span class="sxs-lookup"><span data-stu-id="5e702-145">We recommend carefully choosing different thresholds for scale-out and scale-in based on practical situations.</span></span>

<span data-ttu-id="5e702-146">Estamos *não é recomendável* configurações de dimensionamento automático como exemplos de saudação abaixo com hello valores de limite mesmo ou muito semelhantes para sair e entrar condições:</span><span class="sxs-lookup"><span data-stu-id="5e702-146">We *do not recommend* autoscale settings like hello examples below with hello same or very similar threshold values for out and in conditions:</span></span>

* <span data-ttu-id="5e702-147">Aumentar as instâncias por contagem de 1 quando a Contagem de Threads < = 600</span><span class="sxs-lookup"><span data-stu-id="5e702-147">Increase instances by 1 count when Thread Count <= 600</span></span>
* <span data-ttu-id="5e702-148">Reduzir as instâncias por contagem de 1 quando a Contagem de Threads >= 600</span><span class="sxs-lookup"><span data-stu-id="5e702-148">Decrease instances by 1 count when Thread Count >= 600</span></span>

<span data-ttu-id="5e702-149">Vejamos um exemplo de como o que pode levar o comportamento de tooa que pode parecer confuso.</span><span class="sxs-lookup"><span data-stu-id="5e702-149">Let's look at an example of what can lead tooa behavior that may seem confusing.</span></span> <span data-ttu-id="5e702-150">Considere Olá sequência a seguir.</span><span class="sxs-lookup"><span data-stu-id="5e702-150">Consider hello following sequence.</span></span>

1. <span data-ttu-id="5e702-151">Suponha que há 2 toobegin instâncias com e, em seguida, o número médio de saudação de threads por instância cresce too625.</span><span class="sxs-lookup"><span data-stu-id="5e702-151">Assume there are 2 instances toobegin with and then hello average number of threads per instance grows too625.</span></span>
2. <span data-ttu-id="5e702-152">O dimensionamento automático escala horizontalmente uma terceira instância.</span><span class="sxs-lookup"><span data-stu-id="5e702-152">Autoscale scales out adding a 3rd instance.</span></span>
3. <span data-ttu-id="5e702-153">Em seguida, suponha que contagem de threads de média de saudação em instância fica too575.</span><span class="sxs-lookup"><span data-stu-id="5e702-153">Next, assume that hello average thread count across instance falls too575.</span></span>
4. <span data-ttu-id="5e702-154">Antes de redução, o dimensionamento automático tenta tooestimate estado final Olá será se ele é dimensionado em.</span><span class="sxs-lookup"><span data-stu-id="5e702-154">Before scaling down, autoscale tries tooestimate what hello final state will be if it scaled in.</span></span> <span data-ttu-id="5e702-155">Por exemplo, 575 x 3 (contagem de instância atual) = 1.725 / 2 (número final de instâncias quando reduzido verticalmente) = 862.5 threads.</span><span class="sxs-lookup"><span data-stu-id="5e702-155">For example, 575 x  3 (current instance count) = 1,725 / 2 (final number of instances when scaled down) = 862.5 threads.</span></span> <span data-ttu-id="5e702-156">Isso significa AutoEscala teria tooimmediately expansão novamente mesmo depois que ele dimensionada, se Olá thread médio contagem permanece Olá mesmo ou até mesmo se apenas uma pequena quantidade.</span><span class="sxs-lookup"><span data-stu-id="5e702-156">This means autoscale would have tooimmediately scale-out again even after it scaled in, if hello average thread count remains hello same or even falls only a small amount.</span></span> <span data-ttu-id="5e702-157">No entanto, se ele expandidos novamente, deve repetir o processo inteiro hello, resultando tooan infinita.</span><span class="sxs-lookup"><span data-stu-id="5e702-157">However, if it scaled up again, hello whole process would repeat, leading tooan infinite loop.</span></span>
5. <span data-ttu-id="5e702-158">tooavoid nessa situação (chamada de "falta de sincronismo"), dimensionamento automático não expande para baixo em todos os.</span><span class="sxs-lookup"><span data-stu-id="5e702-158">tooavoid this situation (termed "flapping"), autoscale does not scale down at all.</span></span> <span data-ttu-id="5e702-159">Em vez disso, ele ignora e reavalia Olá condição novamente trabalho Olá próximo tempo saudação do serviço é executado.</span><span class="sxs-lookup"><span data-stu-id="5e702-159">Instead, it skips and reevaluates hello condition again hello next time hello service's job executes.</span></span> <span data-ttu-id="5e702-160">Isso pode confundir muitas pessoas porque o dimensionamento automático não aparece toowork quando a contagem de threads de média de saudação foi 575.</span><span class="sxs-lookup"><span data-stu-id="5e702-160">This could confuse many people because autoscale wouldn't appear toowork when hello average thread count was 575.</span></span>

<span data-ttu-id="5e702-161">Estimativa durante uma escala é pretendido tooavoid "oscilando" situações, em que ações em escala e expansão continuamente ir e voltar.</span><span class="sxs-lookup"><span data-stu-id="5e702-161">Estimation during a scale-in is intended tooavoid "flapping" situations, where scale-in and scale-out actions continually go back and forth.</span></span> <span data-ttu-id="5e702-162">Lembre-se esse comportamento quando você escolhe Olá mesmos limites de escalabilidade horizontal e no.</span><span class="sxs-lookup"><span data-stu-id="5e702-162">Keep this behavior in mind when you choose hello same thresholds for scale-out and in.</span></span>

<span data-ttu-id="5e702-163">É recomendável escolher uma margem suficiente entre Olá expansão e em limites.</span><span class="sxs-lookup"><span data-stu-id="5e702-163">We recommend choosing an adequate margin between hello scale-out and in thresholds.</span></span> <span data-ttu-id="5e702-164">Por exemplo, considere Olá melhor combinação de regra a seguir.</span><span class="sxs-lookup"><span data-stu-id="5e702-164">As an example, consider hello following better rule combination.</span></span>

* <span data-ttu-id="5e702-165">Aumentar as instâncias por contagem de 1 quando CPU% >= 80</span><span class="sxs-lookup"><span data-stu-id="5e702-165">Increase instances by 1 count when CPU%  >= 80</span></span>
* <span data-ttu-id="5e702-166">Reduzir as instâncias por contagem de 1 quando CPU% <= 60</span><span class="sxs-lookup"><span data-stu-id="5e702-166">Decrease instances by 1 count when CPU% <= 60</span></span>

<span data-ttu-id="5e702-167">Nesse caso</span><span class="sxs-lookup"><span data-stu-id="5e702-167">In this case</span></span>  

1. <span data-ttu-id="5e702-168">Suponha que há 2 toostart instâncias com.</span><span class="sxs-lookup"><span data-stu-id="5e702-168">Assume there are 2 instances toostart with.</span></span>
2. <span data-ttu-id="5e702-169">Se Olá porcentagem média de CPU em instâncias ficar too80, dimensionamento automático seja dimensionável adicionando uma terceira instância.</span><span class="sxs-lookup"><span data-stu-id="5e702-169">If hello average CPU% across instances goes too80, autoscale scales out adding a third instance.</span></span>
3. <span data-ttu-id="5e702-170">Agora suponha pela hora Olá CPU % cai too60.</span><span class="sxs-lookup"><span data-stu-id="5e702-170">Now assume that over time hello CPU% falls too60.</span></span>
4. <span data-ttu-id="5e702-171">Regra na escala do dimensionamento automático calcula o estado final Olá se fosse tooscale-in.</span><span class="sxs-lookup"><span data-stu-id="5e702-171">Autoscale's scale-in rule estimates hello final state if it were tooscale-in.</span></span> <span data-ttu-id="5e702-172">Por exemplo, 60 x 3 (contagem de instância atual) = 180 / 2 (número final de instâncias quando reduzido verticalmente) = 90 threads.</span><span class="sxs-lookup"><span data-stu-id="5e702-172">For example, 60 x 3 (current instance count) = 180 / 2 (final number of instances when scaled down) = 90.</span></span> <span data-ttu-id="5e702-173">Para dimensionamento automático não escala-in porque ela teria tooscale-out novamente imediatamente.</span><span class="sxs-lookup"><span data-stu-id="5e702-173">So autoscale does not scale-in because it would have tooscale-out again immediately.</span></span> <span data-ttu-id="5e702-174">Em vez disso, ele ignora a redução vertical.</span><span class="sxs-lookup"><span data-stu-id="5e702-174">Instead, it skips scaling down.</span></span>
5. <span data-ttu-id="5e702-175">Olá próximo tempo AutoEscala verifica, Olá CPU continua toofall too50.</span><span class="sxs-lookup"><span data-stu-id="5e702-175">hello next time autoscale checks, hello CPU continues toofall too50.</span></span> <span data-ttu-id="5e702-176">Estima novamente - instância 50 x 3 = 150 / 2 instâncias = 75, que está abaixo do limite de escalabilidade horizontal de saudação de 80, para que ele é dimensionado em instâncias de too2 com êxito.</span><span class="sxs-lookup"><span data-stu-id="5e702-176">It estimates again -  50 x 3 instance = 150 / 2 instances = 75, which is below hello scale-out threshold of 80, so it scales in successfully too2 instances.</span></span>

### <a name="considerations-for-scaling-threshold-values-for-special-metrics"></a><span data-ttu-id="5e702-177">Considerações sobre valores de dimensionamento de limite para métricas especiais</span><span class="sxs-lookup"><span data-stu-id="5e702-177">Considerations for scaling threshold values for special metrics</span></span>
 <span data-ttu-id="5e702-178">Para métricas especiais, como a métrica do comprimento da fila do barramento de serviço ou de armazenamento, o limite de saudação é número médio de saudação de mensagens disponíveis por número atual de instâncias.</span><span class="sxs-lookup"><span data-stu-id="5e702-178">For special metrics such as Storage or Service Bus Queue length metric, hello threshold is hello average number of messages available per current number of instances.</span></span> <span data-ttu-id="5e702-179">Escolha cuidadosamente Olá escolha Olá valor de limite para esta métrica.</span><span class="sxs-lookup"><span data-stu-id="5e702-179">Carefully choose hello choose hello threshold value for this metric.</span></span>

<span data-ttu-id="5e702-180">Vamos ilustrá-lo com um exemplo tooensure você entender o comportamento de saudação melhor.</span><span class="sxs-lookup"><span data-stu-id="5e702-180">Let's illustrate it with an example tooensure you understand hello behavior better.</span></span>

* <span data-ttu-id="5e702-181">Aumentar o número de instâncias por contagem de 1 quando a contagem de mensagem de Fila de Armazenamento > = 50</span><span class="sxs-lookup"><span data-stu-id="5e702-181">Increase instances by 1 count when Storage Queue message count >= 50</span></span>
* <span data-ttu-id="5e702-182">Reduzir o número de instâncias por contagem 1 de contagem de mensagem de Fila de Armazenamento > = 10</span><span class="sxs-lookup"><span data-stu-id="5e702-182">Decrease instances by 1 count when Storage Queue message count <= 10</span></span>

<span data-ttu-id="5e702-183">Considere Olá sequência a seguir:</span><span class="sxs-lookup"><span data-stu-id="5e702-183">Consider hello following sequence:</span></span>

1. <span data-ttu-id="5e702-184">Há duas instâncias de fila de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="5e702-184">There are 2 storage queue instances.</span></span>
2. <span data-ttu-id="5e702-185">Mensagens continuam chegando e ao examinar a fila de armazenamento hello, contagem total de saudação lê 50.</span><span class="sxs-lookup"><span data-stu-id="5e702-185">Messages keep coming and when you review hello storage queue, hello total count reads 50.</span></span> <span data-ttu-id="5e702-186">Você pode pressupor que o dimensionamento automático deve iniciar uma ação de escala horizontal.</span><span class="sxs-lookup"><span data-stu-id="5e702-186">You might assume that autoscale should start a scale-out action.</span></span> <span data-ttu-id="5e702-187">No entanto, observe que ainda é 50/2 = 25 mensagens por instância.</span><span class="sxs-lookup"><span data-stu-id="5e702-187">However, note that it is still 50/2 = 25 messages per instance.</span></span> <span data-ttu-id="5e702-188">Portanto, a escala horizontal não ocorrerá.</span><span class="sxs-lookup"><span data-stu-id="5e702-188">So, scale-out does not occur.</span></span> <span data-ttu-id="5e702-189">Para Olá primeiro toohappen de expansão, contagem total de mensagens de saudação na fila de armazenamento Olá deve ser 100.</span><span class="sxs-lookup"><span data-stu-id="5e702-189">For hello first scale-out toohappen, hello total message count in hello storage queue should be 100.</span></span>
3. <span data-ttu-id="5e702-190">Em seguida, suponha que a contagem total de mensagens de saudação atinge 100.</span><span class="sxs-lookup"><span data-stu-id="5e702-190">Next, assume that hello total message count reaches 100.</span></span>
4. <span data-ttu-id="5e702-191">Uma instância de fila de armazenamento 3º é adicionada devido a ação de expansão tooa.</span><span class="sxs-lookup"><span data-stu-id="5e702-191">A 3rd storage queue instance is added due tooa scale-out action.</span></span>  <span data-ttu-id="5e702-192">Olá próxima ação de expansão não acontecerá até Olá total contagem de mensagens na fila de saudação atinge 150 pois 150/3 = 50.</span><span class="sxs-lookup"><span data-stu-id="5e702-192">hello next scale-out action will not happen until hello total message count in hello queue reaches 150 because 150/3 = 50.</span></span>
5. <span data-ttu-id="5e702-193">Agora número Olá de mensagens na fila de saudação é reduzido.</span><span class="sxs-lookup"><span data-stu-id="5e702-193">Now hello number of messages in hello queue gets smaller.</span></span> <span data-ttu-id="5e702-194">Com 3 instâncias, ação de escala no primeiro Olá acontece quando hello total de mensagens em todas as filas somar too30 porque 30/3 = 10 mensagens por instância, que é o limite de escala em hello.</span><span class="sxs-lookup"><span data-stu-id="5e702-194">With 3 instances, hello first scale-in action happens when hello total messages in all queues add up too30 because 30/3 = 10 messages per instance, which is hello scale-in threshold.</span></span>

### <a name="considerations-for-scaling-when-multiple-profiles-are-configured-in-an-autoscale-setting"></a><span data-ttu-id="5e702-195">Considerações sobre dimensionamento quando vários perfis são configurados em uma configuração de dimensionamento automático</span><span class="sxs-lookup"><span data-stu-id="5e702-195">Considerations for scaling when multiple profiles are configured in an autoscale setting</span></span>
<span data-ttu-id="5e702-196">Em uma configuração de dimensionamento automático, você pode escolher um perfil padrão, que é sempre aplicado sem qualquer dependência de agenda ou hora, ou você pode escolher um perfil recorrente ou um perfil para um período fixo com um intervalo de data e hora.</span><span class="sxs-lookup"><span data-stu-id="5e702-196">In an autoscale setting, you can choose a default profile, which is always applied without any dependency on schedule or time, or you can choose a recurring profile or a profile for a fixed period with a date and time range.</span></span>

<span data-ttu-id="5e702-197">Quando o serviço de AutoEscala processa-las, sempre verifica no hello ordem a seguir:</span><span class="sxs-lookup"><span data-stu-id="5e702-197">When autoscale service processes them, it always checks in hello following order:</span></span>

1. <span data-ttu-id="5e702-198">Perfil de Data Fixa</span><span class="sxs-lookup"><span data-stu-id="5e702-198">Fixed Date profile</span></span>
2. <span data-ttu-id="5e702-199">Perfil recorrente</span><span class="sxs-lookup"><span data-stu-id="5e702-199">Recurring profile</span></span>
3. <span data-ttu-id="5e702-200">Perfil ("Sempre") Padrão</span><span class="sxs-lookup"><span data-stu-id="5e702-200">Default ("Always") profile</span></span>

<span data-ttu-id="5e702-201">Se um perfil condição for atendida, dimensionamento automático não verifica a próxima condição de perfil Olá abaixo dela.</span><span class="sxs-lookup"><span data-stu-id="5e702-201">If a profile condition is met, autoscale does not check hello next profile condition below it.</span></span> <span data-ttu-id="5e702-202">O dimensionamento automático só processa um perfil por vez.</span><span class="sxs-lookup"><span data-stu-id="5e702-202">Autoscale only processes one profile at a time.</span></span> <span data-ttu-id="5e702-203">Isso significa que, se você quiser tooalso incluem uma condição de processamento de um perfil de camada inferior, você deve incluir essas regras também no perfil atual hello.</span><span class="sxs-lookup"><span data-stu-id="5e702-203">This means if you want tooalso include a processing condition from a lower-tier profile, you must include those rules as well in hello current profile.</span></span>

<span data-ttu-id="5e702-204">Vamos examinar isso usando um exemplo:</span><span class="sxs-lookup"><span data-stu-id="5e702-204">Let's review this using an example:</span></span>

<span data-ttu-id="5e702-205">imagem de saudação abaixo mostra uma configuração de AutoEscala com um perfil de padrão de instâncias mínimas = 2 e máximo de instâncias = 10.</span><span class="sxs-lookup"><span data-stu-id="5e702-205">hello image below shows an autoscale setting with a default profile of minimum instances = 2 and maximum instances = 10.</span></span> <span data-ttu-id="5e702-206">Neste exemplo, regras são configurada tooscale-out quando Olá a contagem de mensagens na fila de saudação é maior que 10 e na escala quando a contagem de mensagem de saudação na fila de saudação é menor que 3.</span><span class="sxs-lookup"><span data-stu-id="5e702-206">In this example, rules are configured tooscale-out when hello message count in hello queue is greater than 10 and scale-in when hello message count in hello queue is less than 3.</span></span> <span data-ttu-id="5e702-207">Agora o recurso Olá pode dimensionar entre 2 e 10 instâncias.</span><span class="sxs-lookup"><span data-stu-id="5e702-207">So now hello resource can scale between 2 and 10 instances.</span></span>

<span data-ttu-id="5e702-208">Além disso, há um perfil recorrente para segunda-feira.</span><span class="sxs-lookup"><span data-stu-id="5e702-208">In addition, there is a recurring profile set for Monday.</span></span> <span data-ttu-id="5e702-209">Ele é definido para instâncias mínimas = 2 e máximo de instâncias = 12.</span><span class="sxs-lookup"><span data-stu-id="5e702-209">It is set for minimum instances = 2 and maximum instances = 12.</span></span> <span data-ttu-id="5e702-210">Isso significa que na segunda-feira, Olá primeiro tempo AutoEscala procura por esta condição, se a contagem de instâncias de saudação for 2, ele é dimensionado toohello mínimo de 3.</span><span class="sxs-lookup"><span data-stu-id="5e702-210">This means on Monday, hello first time autoscale checks for this condition, if hello instance count is 2, it scales toohello new minimum of 3.</span></span> <span data-ttu-id="5e702-211">Como AutoEscala continua toofind essa condição de perfil correspondente (segunda-feira), ele processará somente Olá CPU regras baseadas em escala-out ou em configurado para este perfil.</span><span class="sxs-lookup"><span data-stu-id="5e702-211">As long as autoscale continues toofind this profile condition matched (Monday), it only processes hello CPU-based scale-out/in rules configured for this profile.</span></span> <span data-ttu-id="5e702-212">Neste momento, ele não verifica para comprimento da fila de saudação.</span><span class="sxs-lookup"><span data-stu-id="5e702-212">At this time, it does not check for hello queue length.</span></span> <span data-ttu-id="5e702-213">No entanto, se você deseja comprimento de fila de saudação condição toobe marcada, você deve incluir essas regras de perfil de padrão de saudação bem em seu perfil de segunda-feira.</span><span class="sxs-lookup"><span data-stu-id="5e702-213">However, if you also want hello queue length condition toobe checked, you should include those rules from hello default profile as well in your Monday profile.</span></span>

<span data-ttu-id="5e702-214">Da mesma forma, quando o dimensionamento automático muda toohello back padrão perfil, ele primeiro verifica se Olá mínimo e máximo condições.</span><span class="sxs-lookup"><span data-stu-id="5e702-214">Similarly, when autoscale switches back toohello default profile, it first checks if hello minimum and maximum conditions are met.</span></span> <span data-ttu-id="5e702-215">Se o número de saudação de instâncias em tempo de saudação for 12, ele é dimensionado em too10, Olá máximo permitido para o perfil de padrão de saudação.</span><span class="sxs-lookup"><span data-stu-id="5e702-215">If hello number of instances at hello time is 12, it scales in too10, hello maximum allowed for hello default profile.</span></span>

![configurações de dimensionamento automático](./media/insights-autoscale-best-practices/insights-autoscale-best-practices-2.png)

### <a name="considerations-for-scaling-when-multiple-rules-are-configured-in-a-profile"></a><span data-ttu-id="5e702-217">Considerações sobre dimensionamento quando várias regras são configuradas em um perfil</span><span class="sxs-lookup"><span data-stu-id="5e702-217">Considerations for scaling when multiple rules are configured in a profile</span></span>
<span data-ttu-id="5e702-218">Há casos em que você pode ter tooset várias regras em um perfil.</span><span class="sxs-lookup"><span data-stu-id="5e702-218">There are cases where you may have tooset multiple rules in a profile.</span></span> <span data-ttu-id="5e702-219">Olá conjunto de regras de AutoEscala a seguir é usado pelo uso de serviços quando várias regras são definidas.</span><span class="sxs-lookup"><span data-stu-id="5e702-219">hello following set of autoscale rules are used by services use when multiple rules are set.</span></span>

<span data-ttu-id="5e702-220">Em *escalar horizontalmente*, o dimensionamento automático será executado se nenhuma regra for atendida.</span><span class="sxs-lookup"><span data-stu-id="5e702-220">On *scale out*, autoscale runs if any rule is met.</span></span>
<span data-ttu-id="5e702-221">Em *em escala*, AutoEscala exigem todas as regras toobe atendidos.</span><span class="sxs-lookup"><span data-stu-id="5e702-221">On *scale-in*, autoscale require all rules toobe met.</span></span>

<span data-ttu-id="5e702-222">tooillustrate, suponha que você tenha Olá seguindo as regras de AutoEscala 4:</span><span class="sxs-lookup"><span data-stu-id="5e702-222">tooillustrate, assume that you have hello following 4 autoscale rules:</span></span>

* <span data-ttu-id="5e702-223">Se CPU < 30%, reduza horizontalmente em 1</span><span class="sxs-lookup"><span data-stu-id="5e702-223">If CPU < 30 %, scale-in by 1</span></span>
* <span data-ttu-id="5e702-224">Se Memória < 50%, reduza horizontalmente em 1</span><span class="sxs-lookup"><span data-stu-id="5e702-224">If Memory < 50%, scale-in by 1</span></span>
* <span data-ttu-id="5e702-225">Se CPU < 75%, escale horizontalmente em 1</span><span class="sxs-lookup"><span data-stu-id="5e702-225">If CPU > 75%, scale-out by 1</span></span>
* <span data-ttu-id="5e702-226">Se Memória < 75, escale horizontalmente em 1</span><span class="sxs-lookup"><span data-stu-id="5e702-226">If Memory > 75%, scale-out by 1</span></span>

<span data-ttu-id="5e702-227">Em seguida, siga Olá ocorre:</span><span class="sxs-lookup"><span data-stu-id="5e702-227">Then hello follow occurs:</span></span>

* <span data-ttu-id="5e702-228">Se a CPU for 76% e a Memória 50%, escalaremos horizontalmente.</span><span class="sxs-lookup"><span data-stu-id="5e702-228">If CPU is 76% and Memory is 50%, we scale-out.</span></span>
* <span data-ttu-id="5e702-229">Se a CPU for 50% e a Memória 76%, escalaremos horizontalmente.</span><span class="sxs-lookup"><span data-stu-id="5e702-229">If CPU is 50% and Memory is 76% we scale-out.</span></span>

<span data-ttu-id="5e702-230">Olá por outro lado, se a CPU é 25% e memória faz AutoEscala 51% **não** na escala.</span><span class="sxs-lookup"><span data-stu-id="5e702-230">On hello other hand, if CPU is 25% and memory is 51% autoscale does **not** scale-in.</span></span> <span data-ttu-id="5e702-231">Tooscale-in, CPU deve ser 29% e memória 49%.</span><span class="sxs-lookup"><span data-stu-id="5e702-231">In order tooscale-in, CPU must be 29% and Memory 49%.</span></span>

### <a name="always-select-a-safe-default-instance-count"></a><span data-ttu-id="5e702-232">Sempre selecione uma contagem de instância de segurança padrão</span><span class="sxs-lookup"><span data-stu-id="5e702-232">Always select a safe default instance count</span></span>
<span data-ttu-id="5e702-233">Contagem de instâncias padrão Olá é importante AutoEscala sua contagem de toothat de serviço é dimensionado quando métricas não estão disponíveis.</span><span class="sxs-lookup"><span data-stu-id="5e702-233">hello default instance count is important autoscale scales your service toothat count when metrics are not available.</span></span> <span data-ttu-id="5e702-234">Portanto, selecione uma contagem de instância padrão que seja segura para suas cargas de trabalho.</span><span class="sxs-lookup"><span data-stu-id="5e702-234">Therefore, select a default instance count that's safe for your workloads.</span></span>

### <a name="configure-autoscale-notifications"></a><span data-ttu-id="5e702-235">Configurar notificações de dimensionamento automático</span><span class="sxs-lookup"><span data-stu-id="5e702-235">Configure autoscale notifications</span></span>
<span data-ttu-id="5e702-236">Dimensionamento automático notifica administradores hello e colaboradores de recurso Olá por email se ocorrer qualquer uma das seguintes condições de saudação:</span><span class="sxs-lookup"><span data-stu-id="5e702-236">Autoscale notifies hello administrators and contributors of hello resource by email if any of hello following conditions occur:</span></span>

* <span data-ttu-id="5e702-237">serviço de dimensionamento automático não tootake uma ação.</span><span class="sxs-lookup"><span data-stu-id="5e702-237">autoscale service fails tootake an action.</span></span>
* <span data-ttu-id="5e702-238">Métricas não estão disponíveis para o serviço de AutoEscala toomake uma decisão de escala.</span><span class="sxs-lookup"><span data-stu-id="5e702-238">Metrics are not available for autoscale service toomake a scale decision.</span></span>
* <span data-ttu-id="5e702-239">Métricas estão disponível (recuperação) toomake novamente uma decisão de escala.</span><span class="sxs-lookup"><span data-stu-id="5e702-239">Metrics are available (recovery) again toomake a scale decision.</span></span>
  <span data-ttu-id="5e702-240">Além disso condições toohello acima, você pode configurar tooget de notificações por email ou webhook notificado para ações de dimensionamento bem-sucedido.</span><span class="sxs-lookup"><span data-stu-id="5e702-240">In addition toohello conditions above, you can configure email or webhook notifications tooget notified for successful scale actions.</span></span>
  
<span data-ttu-id="5e702-241">Você também pode usar uma integridade do Log de atividades toomonitor alerta saudação do mecanismo de dimensionamento automático hello.</span><span class="sxs-lookup"><span data-stu-id="5e702-241">You can also use an Activity Log alert toomonitor hello health of hello autoscale engine.</span></span> <span data-ttu-id="5e702-242">Aqui estão exemplos muito[criar um alerta de Log da atividade toomonitor todas as operações de mecanismo de dimensionamento automático em sua assinatura](https://github.com/Azure/azure-quickstart-templates/tree/master/monitor-autoscale-alert) ou muito[criar um alerta de Log da atividade toomonitor todos Falha na escala de dimensionamento automático em / expansão de operações no sua assinatura](https://github.com/Azure/azure-quickstart-templates/tree/master/monitor-autoscale-failed-alert).</span><span class="sxs-lookup"><span data-stu-id="5e702-242">Here are examples too[create an Activity Log Alert toomonitor all autoscale engine operations on your subscription](https://github.com/Azure/azure-quickstart-templates/tree/master/monitor-autoscale-alert) or too[create an Activity Log Alert toomonitor all failed autoscale scale in/scale out operations on your subscription](https://github.com/Azure/azure-quickstart-templates/tree/master/monitor-autoscale-failed-alert).</span></span>

## <a name="next-steps"></a><span data-ttu-id="5e702-243">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="5e702-243">Next Steps</span></span>
- [<span data-ttu-id="5e702-244">Crie um alerta de Log da atividade toomonitor todas as operações de mecanismo de dimensionamento automático em sua assinatura.</span><span class="sxs-lookup"><span data-stu-id="5e702-244">Create an Activity Log Alert toomonitor all autoscale engine operations on your subscription.</span></span>](https://github.com/Azure/azure-quickstart-templates/tree/master/monitor-autoscale-alert)
- [<span data-ttu-id="5e702-245">Criar um alerta de Log da atividade toomonitor todos Falha na escala de dimensionamento automático em / expansão de operações em sua assinatura</span><span class="sxs-lookup"><span data-stu-id="5e702-245">Create an Activity Log Alert toomonitor all failed autoscale scale in/scale out operations on your subscription</span></span>](https://github.com/Azure/azure-quickstart-templates/tree/master/monitor-autoscale-failed-alert)
