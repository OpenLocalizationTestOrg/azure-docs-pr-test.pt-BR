---
title: "arquitetura de saudação aaaReview para tooAzure de replicação de servidor físico, usando o Azure Site Recovery | Microsoft Docs"
description: "Este artigo fornece uma visão geral dos componentes e arquitetura usada ao replicar local tooAzure de servidores físicos com hello serviço Azure Site Recovery"
services: site-recovery
documentationcenter: 
author: rayne-wiselman
manager: carmonm
editor: 
ms.assetid: 09c9b136-35f5-465e-8d0f-f4c5d5d9f880
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/27/2017
ms.author: raynew
ms.openlocfilehash: 4f334c181fa6f0821adf978ebe9dbd7d36a3c753
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="step-1-review-hello-architecture-for-physical-server-replication-tooazure"></a><span data-ttu-id="9d78e-103">Etapa 1: Revisar arquitetura Olá para tooAzure de replicação de servidor físico</span><span class="sxs-lookup"><span data-stu-id="9d78e-103">Step 1: Review hello architecture for physical server replication tooAzure</span></span>

<span data-ttu-id="9d78e-104">Este artigo descreve os componentes de saudação e processos usados quando você replica tooAzure de servidores físicos do Windows/Linux local, usando Olá [do Azure Site Recovery](site-recovery-overview.md) serviço.</span><span class="sxs-lookup"><span data-stu-id="9d78e-104">This article describes hello components and processes used when you replicate on-premises Windows/Linux physical servers tooAzure, using hello [Azure Site Recovery](site-recovery-overview.md) service.</span></span>

<span data-ttu-id="9d78e-105">Lançar os comentários na parte inferior da saudação deste artigo, ou fazer perguntas no hello [Fórum de serviços de recuperação do Azure](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span><span class="sxs-lookup"><span data-stu-id="9d78e-105">Post any comments at hello bottom of this article, or ask questions in hello [Azure Recovery Services Forum](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span></span>


## <a name="architectural-components"></a><span data-ttu-id="9d78e-106">Componentes de arquitetura</span><span class="sxs-lookup"><span data-stu-id="9d78e-106">Architectural components</span></span>

<span data-ttu-id="9d78e-107">tabela de saudação Resume componentes Olá que necessários.</span><span class="sxs-lookup"><span data-stu-id="9d78e-107">hello table summarizes hello components you need.</span></span>

<span data-ttu-id="9d78e-108">**Componente**</span><span class="sxs-lookup"><span data-stu-id="9d78e-108">**Component**</span></span> | <span data-ttu-id="9d78e-109">**Requisito**</span><span class="sxs-lookup"><span data-stu-id="9d78e-109">**Requirement**</span></span> | <span data-ttu-id="9d78e-110">**Detalhes**</span><span class="sxs-lookup"><span data-stu-id="9d78e-110">**Details**</span></span>
--- | --- | ---
<span data-ttu-id="9d78e-111">**As tabelas**</span><span class="sxs-lookup"><span data-stu-id="9d78e-111">**Azure**</span></span> | <span data-ttu-id="9d78e-112">Você precisa de uma conta do Azure, uma conta de armazenamento do Azure e uma rede do Azure.</span><span class="sxs-lookup"><span data-stu-id="9d78e-112">You need an Azure account, an Azure storage account, and an Azure network.</span></span> | <span data-ttu-id="9d78e-113">Dados replicados são armazenados na conta de armazenamento hello e VMs do Azure são criadas com dados replicado de saudação quando ocorre um failover.</span><span class="sxs-lookup"><span data-stu-id="9d78e-113">Replicated data is stored in hello storage account, and Azure VMs are created with hello replicated data when failover occurs.</span></span> <span data-ttu-id="9d78e-114">Máquinas virtuais do Azure conectam toohello rede virtual do Azure quando eles são criados.</span><span class="sxs-lookup"><span data-stu-id="9d78e-114">Azure VMs connect toohello Azure virtual network when they're created.</span></span>
<span data-ttu-id="9d78e-115">**Servidor de configuração**</span><span class="sxs-lookup"><span data-stu-id="9d78e-115">**Configuration server**</span></span> | <span data-ttu-id="9d78e-116">Um único servidor de gerenciamento (servidor físico ou VM VMware) que executa todos os Olá local componentes de recuperação de Site no local.</span><span class="sxs-lookup"><span data-stu-id="9d78e-116">A single on-premises management server (physical server or VMware VM) that runs all hello on-premises Site Recovery components.</span></span> <span data-ttu-id="9d78e-117">Isso inclui um servidor de configuração, um servidor em processo e um servidor de destino mestre.</span><span class="sxs-lookup"><span data-stu-id="9d78e-117">These include a configuration server, process server, master target server.</span></span> | <span data-ttu-id="9d78e-118">componente de servidor de configuração de saudação coordena as comunicações entre o local e o Azure e gerencia a replicação de dados.</span><span class="sxs-lookup"><span data-stu-id="9d78e-118">hello configuration server component coordinates communications between on-premises and Azure, and manages data replication.</span></span>
 <span data-ttu-id="9d78e-119">**Servidor de processo**</span><span class="sxs-lookup"><span data-stu-id="9d78e-119">**Process server**</span></span>  | <span data-ttu-id="9d78e-120">Instalado por padrão no servidor de configuração de saudação.</span><span class="sxs-lookup"><span data-stu-id="9d78e-120">Installed by default on hello configuration server.</span></span> | <span data-ttu-id="9d78e-121">Atua como um gateway de replicação.</span><span class="sxs-lookup"><span data-stu-id="9d78e-121">Acts as a replication gateway.</span></span> <span data-ttu-id="9d78e-122">Recebe dados de replicação, otimizá-lo com o cache, a compactação e criptografia e envia tooAzure armazenamento.</span><span class="sxs-lookup"><span data-stu-id="9d78e-122">Receives replication data, optimizes it with caching, compression, and encryption, and sends it tooAzure storage.</span></span><br/><br/> <span data-ttu-id="9d78e-123">servidor de processo Olá também lida com a instalação por push de máquinas de tooprotected de serviço de mobilidade hello.</span><span class="sxs-lookup"><span data-stu-id="9d78e-123">hello process server also handles push installation of hello Mobility service tooprotected machines.</span></span><br/><br/> <span data-ttu-id="9d78e-124">Você pode adicionar servidores adicionais processo dedicado separado, toohandle aumentar os volumes de tráfego de replicação.</span><span class="sxs-lookup"><span data-stu-id="9d78e-124">You can add additional separate dedicated process servers, toohandle increasing volumes of replication traffic.</span></span>
 <span data-ttu-id="9d78e-125">**Servidor de destino mestre**</span><span class="sxs-lookup"><span data-stu-id="9d78e-125">**Master target server**</span></span> | <span data-ttu-id="9d78e-126">Instalado por padrão no servidor de configuração local hello.</span><span class="sxs-lookup"><span data-stu-id="9d78e-126">Installed by default on hello on-premises configuration server.</span></span> | <span data-ttu-id="9d78e-127">Lida com os dados de replicação durante o failback do Azure.</span><span class="sxs-lookup"><span data-stu-id="9d78e-127">Handles replication data during failback from Azure.</span></span><br/><br/> <span data-ttu-id="9d78e-128">Se os volumes de tráfego de failback forem altos, você poderá implantar um servidor de destino mestre separado para failback.</span><span class="sxs-lookup"><span data-stu-id="9d78e-128">If volumes of failback traffic are high, you can deploy a separate master target server for failback.</span></span>
<span data-ttu-id="9d78e-129">**Servidores replicados**</span><span class="sxs-lookup"><span data-stu-id="9d78e-129">**Replicated servers**</span></span> | <span data-ttu-id="9d78e-130">Olá componente de serviço de mobilidade está instalado em cada servidor do Windows/Linux que você deseja tooreplicate.</span><span class="sxs-lookup"><span data-stu-id="9d78e-130">hello Mobility service component is installed on each Windows/Linux server you want tooreplicate.</span></span> <span data-ttu-id="9d78e-131">Ele pode ser instalado manualmente em cada computador, ou com uma instalação por push saudação do servidor de processo.</span><span class="sxs-lookup"><span data-stu-id="9d78e-131">It can be installed manually on each machine, or with a push installation from hello process server.</span></span>
<span data-ttu-id="9d78e-132">**Failback**</span><span class="sxs-lookup"><span data-stu-id="9d78e-132">**Failback**</span></span> | <span data-ttu-id="9d78e-133">Para o failback, uma infraestrutura do VMware é necessária.</span><span class="sxs-lookup"><span data-stu-id="9d78e-133">For failback a VMware infrastructure is required.</span></span> <span data-ttu-id="9d78e-134">Não é possível reprovar servidor físico tooa voltar.</span><span class="sxs-lookup"><span data-stu-id="9d78e-134">You can't fail back tooa physical server.</span></span>


<span data-ttu-id="9d78e-135">**Figura 1: TooAzure físico componentes**</span><span class="sxs-lookup"><span data-stu-id="9d78e-135">**Figure 1: Physical tooAzure components**</span></span>

![Componentes](./media/physical-walkthrough-architecture/arch-enhanced.png)

## <a name="replication-process"></a><span data-ttu-id="9d78e-137">Processo de replicação</span><span class="sxs-lookup"><span data-stu-id="9d78e-137">Replication process</span></span>

1. <span data-ttu-id="9d78e-138">Configurar implantação hello, incluindo o local e os componentes do Azure.</span><span class="sxs-lookup"><span data-stu-id="9d78e-138">You set up hello deployment, including on-premises and Azure components.</span></span> <span data-ttu-id="9d78e-139">No cofre de serviços de recuperação hello, você pode especificar origem da replicação hello e destino, configurar o servidor de configuração de hello, criar uma política de replicação, implantar o serviço de mobilidade hello, habilitar a replicação e executar um failover de teste.</span><span class="sxs-lookup"><span data-stu-id="9d78e-139">In hello Recovery Services vault, you specify hello replication source and target, set up hello configuration server, create a replication policy, deploy hello Mobility service, enable replication, and run a test failover.</span></span>
2.  <span data-ttu-id="9d78e-140">Replicar máquinas acordo com a política de replicação hello e uma cópia inicial dos dados de saudação é replicado tooAzure de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="9d78e-140">Machines replicate in accordance with hello replication policy, and an initial copy of hello data is replicated tooAzure storage.</span></span>
4. <span data-ttu-id="9d78e-141">Após a conclusão da replicação inicial, a replicação delta alterações tooAzure começa.</span><span class="sxs-lookup"><span data-stu-id="9d78e-141">After initial replication finishes, replication of delta changes tooAzure begins.</span></span> <span data-ttu-id="9d78e-142">As alterações acompanhadas para uma máquina são mantidas em um arquivo .hrl.</span><span class="sxs-lookup"><span data-stu-id="9d78e-142">Tracked changes for a machine are held in a .hrl file.</span></span>
    - <span data-ttu-id="9d78e-143">Replicadas máquinas se comunicar com servidor de configuração de saudação na porta HTTPS 443 entrada para o gerenciamento de replicação.</span><span class="sxs-lookup"><span data-stu-id="9d78e-143">Replicating machines communicate with hello configuration server on port HTTPS 443 inbound, for replication management.</span></span>
    - <span data-ttu-id="9d78e-144">Replicadas máquinas enviam servidor de processo de toohello de dados de replicação na porta HTTPS 9443 entrada (pode ser modificada).</span><span class="sxs-lookup"><span data-stu-id="9d78e-144">Replicating machines send replication data toohello process server on port HTTPS 9443 inbound (can be modified).</span></span>
    - <span data-ttu-id="9d78e-145">servidor de configuração de saudação orquestra o gerenciamento de replicação com o Azure através da porta HTTPS 443 de saída.</span><span class="sxs-lookup"><span data-stu-id="9d78e-145">hello configuration server orchestrates replication management with Azure over port HTTPS 443 outbound.</span></span>
    - <span data-ttu-id="9d78e-146">servidor de processo Olá recebe dados de máquinas de origem, otimiza criptografa e envia tooAzure armazenamento pela porta 443 saída.</span><span class="sxs-lookup"><span data-stu-id="9d78e-146">hello process server receives data from source machines, optimizes and encrypts it, and sends it tooAzure storage over port 443 outbound.</span></span>
    - <span data-ttu-id="9d78e-147">Se você habilitar a consistência de várias VMs, em seguida, máquinas no grupo de replicação Olá comunicam entre si pela porta 20004.</span><span class="sxs-lookup"><span data-stu-id="9d78e-147">If you enable multi-VM consistency, then machines in hello replication group communicate with each other over port 20004.</span></span> <span data-ttu-id="9d78e-148">Várias VMS serão usadas se você agrupar vários computadores em grupos de replicação que compartilham pontos de recuperação consistentes com o aplicativo e com falhas ao realizar o failover.</span><span class="sxs-lookup"><span data-stu-id="9d78e-148">Multi-VM is used if you group multiple machines into replication groups that share crash-consistent and app-consistent recovery points when they fail over.</span></span> <span data-ttu-id="9d78e-149">Isso é útil se estiver executando máquinas Olá a mesma carga de trabalho e precisam toobe consistente.</span><span class="sxs-lookup"><span data-stu-id="9d78e-149">This is useful if machines are running hello same workload and need toobe consistent.</span></span>
5. <span data-ttu-id="9d78e-150">O tráfego é replicado tooAzure armazenamento pontos de extremidade públicos, mais Olá da internet.</span><span class="sxs-lookup"><span data-stu-id="9d78e-150">Traffic is replicated tooAzure storage public endpoints, over hello internet.</span></span> <span data-ttu-id="9d78e-151">Como alternativa, você pode usar o [emparelhamento público](../expressroute/expressroute-circuit-peerings.md#public-peering) do Azure ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="9d78e-151">Alternately, you can use Azure ExpressRoute [public peering](../expressroute/expressroute-circuit-peerings.md#public-peering).</span></span> <span data-ttu-id="9d78e-152">Replicação do tráfego por uma VPN site a site de um tooAzure de site local não tem suporte.</span><span class="sxs-lookup"><span data-stu-id="9d78e-152">Replicating traffic over a site-to-site VPN from an on-premises site tooAzure isn't supported.</span></span>

<span data-ttu-id="9d78e-153">**Figura 2: TooAzure físico replicação**</span><span class="sxs-lookup"><span data-stu-id="9d78e-153">**Figure 2: Physical tooAzure replication**</span></span>

![Avançado](./media/physical-walkthrough-architecture/v2a-architecture-henry.png)

## <a name="failover-and-failback-process"></a><span data-ttu-id="9d78e-155">Processo de failover e failback</span><span class="sxs-lookup"><span data-stu-id="9d78e-155">Failover and failback process</span></span>

<span data-ttu-id="9d78e-156">Depois de verificar que se o failover de teste está funcionando como esperado, você pode executar failovers não planejados tooAzure conforme necessário.</span><span class="sxs-lookup"><span data-stu-id="9d78e-156">After you verify that test failover is working as expected, you can run unplanned failovers tooAzure as required.</span></span> <span data-ttu-id="9d78e-157">Ao executar um failover, as VMs do Azure são criadas com base nos dados replicados.</span><span class="sxs-lookup"><span data-stu-id="9d78e-157">When you run a failover, Azure VMs are created from replicated data.</span></span> <span data-ttu-id="9d78e-158">Depois, quando o site primário local estiver disponível novamente, você poderá fazer failback.</span><span class="sxs-lookup"><span data-stu-id="9d78e-158">Then, when your primary on-premises site is available again, you can fail back.</span></span> <span data-ttu-id="9d78e-159">Observe que:</span><span class="sxs-lookup"><span data-stu-id="9d78e-159">Note that:</span></span>

- <span data-ttu-id="9d78e-160">Não há suporte para failover planejado.</span><span class="sxs-lookup"><span data-stu-id="9d78e-160">Planned failover isn't supported.</span></span>
- <span data-ttu-id="9d78e-161">Você pode fazer o failover de um único computador ou criar [planos de recuperação](site-recovery-create-recovery-plans.md), toofail em vários computadores juntos.</span><span class="sxs-lookup"><span data-stu-id="9d78e-161">You can fail over a single machine, or create [recovery plans](site-recovery-create-recovery-plans.md), toofail over multiple machines together.</span></span>
- <span data-ttu-id="9d78e-162">Você pode confirmar uma failover toostart acessando Olá carga de trabalho da réplica Olá VM do Azure.</span><span class="sxs-lookup"><span data-stu-id="9d78e-162">You commit a failover toostart accessing hello workload from hello replica Azure VM.</span></span>
- <span data-ttu-id="9d78e-163">Quando o site primário hello está disponível novamente, você replicar máquina de saudação do site primário do hello toohello secundário.</span><span class="sxs-lookup"><span data-stu-id="9d78e-163">When hello primary site is available again, you replicate hello machine from hello secondary toohello primary site.</span></span> <span data-ttu-id="9d78e-164">Em seguida, execute um failover não planejado do site secundário hello.</span><span class="sxs-lookup"><span data-stu-id="9d78e-164">Then, run an unplanned failover from hello secondary site.</span></span> <span data-ttu-id="9d78e-165">Após você confirmar esse failover, dados serão back local e você precisa tooenable replicação tooAzure novamente.</span><span class="sxs-lookup"><span data-stu-id="9d78e-165">After you commit this failover, data will be back on-premises, and you need tooenable replication tooAzure again.</span></span>

<span data-ttu-id="9d78e-166">Os componentes do failback incluem:</span><span class="sxs-lookup"><span data-stu-id="9d78e-166">Failback components include:</span></span>

- <span data-ttu-id="9d78e-167">**Servidor de processo temporário no Azure**: É necessário tooset um tooact de VM do Azure como um servidor de processo, a replicação toohandle do Azure.</span><span class="sxs-lookup"><span data-stu-id="9d78e-167">**Temporary process server in Azure**: You need tooset up an Azure VM tooact as a process server, toohandle replication from Azure.</span></span> <span data-ttu-id="9d78e-168">Você pode excluir a VM após a conclusão do failback.</span><span class="sxs-lookup"><span data-stu-id="9d78e-168">You can delete this VM after failback finishes.</span></span>
- <span data-ttu-id="9d78e-169">**Conexão VPN**: É necessário uma conexão VPN (ou rota expressa do Azure) de saudação do Azure rede toohello no site local.</span><span class="sxs-lookup"><span data-stu-id="9d78e-169">**VPN connection**: You need a VPN connection (or Azure ExpressRoute) from hello Azure network toohello on-premises site.</span></span>
- <span data-ttu-id="9d78e-170">**O servidor de destino mestre local separado**: servidor de destino mestre local hello (instalado por padrão no servidor de configuração de saudação) trata o failback.</span><span class="sxs-lookup"><span data-stu-id="9d78e-170">**Separate on-premises master target server**: hello on-premises master target server (installed by default on hello configuration server) handles failback.</span></span> <span data-ttu-id="9d78e-171">Se você fizer failback de grandes volumes de tráfego, deverá configurar um servidor de destino mestre local separado para essa finalidade.</span><span class="sxs-lookup"><span data-stu-id="9d78e-171">If you fail back large volumes of traffic, you should set up a separate on-premises master target server for this purpose.</span></span>
- <span data-ttu-id="9d78e-172">**Política de failback**: você precisa de uma política de failback.</span><span class="sxs-lookup"><span data-stu-id="9d78e-172">**Failback policy**: You need a failback policy.</span></span> <span data-ttu-id="9d78e-173">Isso é criado automaticamente quando você cria sua política de replicação.</span><span class="sxs-lookup"><span data-stu-id="9d78e-173">This is automatically created when you created your replication policy.</span></span>
- <span data-ttu-id="9d78e-174">**O VMware infrastructure**: você deve realizar failback tooan de VM do VMware no local.</span><span class="sxs-lookup"><span data-stu-id="9d78e-174">**VMware infrastructure**: You must fail back tooan on-premises VMware VM.</span></span> <span data-ttu-id="9d78e-175">Isso significa que você precisa de uma infra-estrutura de VMware no local, mesmo se você estiver replicando tooAzure de servidores físicos no local.</span><span class="sxs-lookup"><span data-stu-id="9d78e-175">This means you need an on-premises VMware infrastructure, even if you're replicating on-premises physical servers tooAzure.</span></span>

<span data-ttu-id="9d78e-176">**Figura 3: Failback de servidor físico**</span><span class="sxs-lookup"><span data-stu-id="9d78e-176">**Figure 3: Physical server failback**</span></span>

![Failback](./media/physical-walkthrough-architecture/enhanced-failback.png)


## <a name="next-steps"></a><span data-ttu-id="9d78e-178">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="9d78e-178">Next steps</span></span>

<span data-ttu-id="9d78e-179">Vá muito[etapa 2: verificar os pré-requisitos e limitações](physical-walkthrough-prerequisites.md)</span><span class="sxs-lookup"><span data-stu-id="9d78e-179">Go too[Step 2: Verify prerequisites and limitations](physical-walkthrough-prerequisites.md)</span></span>
