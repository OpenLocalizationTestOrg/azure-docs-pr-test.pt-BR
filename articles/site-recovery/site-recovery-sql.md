---
title: Replicar aplicativos com o SQL Server e o Azure Site Recovery | Microsoft Docs
description: Este artigo descreve como replicar o SQL Server usando o Azure Site Recovery para as funcionalidades de desastre do SQL Server.
services: site-recovery
documentationcenter: 
author: prateek9us
manager: gauravd
editor: 
ms.assetid: 9126f5e8-e9ed-4c31-b6b4-bf969c12c184
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/11/2017
ms.author: pratshar
ms.openlocfilehash: e53f60979e01a0eabe118d3ae6457a61bd4b0ded
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/18/2017
---
# <a name="protect-sql-server-using-sql-server-disaster-recovery-and-azure-site-recovery"></a><span data-ttu-id="5fe6a-103">Proteger o SQL Server usando a recuperação de desastre do SQL Server e o Azure Site Recovery</span><span class="sxs-lookup"><span data-stu-id="5fe6a-103">Protect SQL Server using SQL Server disaster recovery and Azure Site Recovery</span></span>

<span data-ttu-id="5fe6a-104">Este artigo descreve como proteger o back-end do SQL Server de um aplicativo usando uma combinação de tecnologias BCDR (continuidade dos negócios e recuperação de desastre) do SQL Server e o [Azure Site Recovery](site-recovery-overview.md).</span><span class="sxs-lookup"><span data-stu-id="5fe6a-104">This article describes how to protect the SQL Server back end of an application using a combination of SQL Server business continuity and disaster recovery (BCDR) technologies, and [Azure Site Recovery](site-recovery-overview.md).</span></span>

<span data-ttu-id="5fe6a-105">Antes de começar, verifique se você entendeu as funcionalidades de recuperação de desastre do SQL Server, incluindo o clustering de failover, grupos de disponibilidade do AlwaysOn, espelhamento de banco de dados e envio de log.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-105">Before you start, make sure you understand SQL Server disaster recovery capabilities, including failover clustering, Always On availability groups, database mirroring, and log shipping.</span></span>


## <a name="sql-server-deployments"></a><span data-ttu-id="5fe6a-106">Implantações do SQL Server</span><span class="sxs-lookup"><span data-stu-id="5fe6a-106">SQL Server deployments</span></span>

<span data-ttu-id="5fe6a-107">Muitas cargas de trabalho usam o SQL Server como base, e ele pode ser integrado com aplicativos como o SharePoint, Dynamics e SAP, para implementar os serviços de dados.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-107">Many workloads use SQL Server as a foundation, and it can be integrated with apps such as SharePoint, Dynamics, and SAP, to implement data services.</span></span>  <span data-ttu-id="5fe6a-108">O SQL Server pode ser implantado de várias maneiras:</span><span class="sxs-lookup"><span data-stu-id="5fe6a-108">SQL Server can be deployed in a number of ways:</span></span>

* <span data-ttu-id="5fe6a-109">**SQL Server autônomo**: o SQL Server e todos os bancos de dados são hospedados em um único computador (físico ou virtual).</span><span class="sxs-lookup"><span data-stu-id="5fe6a-109">**Standalone SQL Server**: SQL Server and all databases are hosted on a single machine (physical or a virtual).</span></span> <span data-ttu-id="5fe6a-110">Quando virtualizado, o cluster de host é usado para alta disponibilidade local.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-110">When virtualized, host clustering is used for local high availability.</span></span> <span data-ttu-id="5fe6a-111">A alta disponibilidade no nível de convidado não é implementada.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-111">Guest-level high availability isn't implemented.</span></span>
* <span data-ttu-id="5fe6a-112">**Instâncias de cluster de Failover (FCI do Always On) do SQL Server**: dois ou mais nós executando o SQL Server com instâncias de discos compartilhados são configurados em um cluster de Failover do Windows.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-112">**SQL Server Failover Clustering Instances (Always On FCI)**: Two or more nodes running SQL Server instanced with shared disks are configured in a Windows Failover cluster.</span></span> <span data-ttu-id="5fe6a-113">Se um nó estiver inativo, o cluster poderá realizar o failover do SQL Server em outra instância.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-113">If a node is down, the cluster can fail SQL Server over to another instance.</span></span> <span data-ttu-id="5fe6a-114">Essa configuração é usada normalmente para implementar a alta disponibilidade em um site primário.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-114">This setup is typically used to implement high availability at a primary site.</span></span> <span data-ttu-id="5fe6a-115">Essa implantação não protege contra falhas ou interrupção na camada de armazenamento compartilhada.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-115">This deployment doesn't protect against failure or outage in the shared storage layer.</span></span> <span data-ttu-id="5fe6a-116">Um disco compartilhado pode ser implementado usando ISCSI, Fiber Channel ou vhdx compartilhado.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-116">A shared disk can be implemented using iSCSI, fiber channel or shared vhdx.</span></span>
* <span data-ttu-id="5fe6a-117">**Grupos de Disponibilidade AlwaysOn do SQL**: dois ou mais nós podem ser configurados em um cluster sem compartilhamento, com bancos de dados SQL Server configurados em um grupo de disponibilidade, com replicação síncrona e failover automático.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-117">**SQL Always On Availability Groups**: Two or more nodes are set up in a shared nothing cluster, with SQL Server databases configured in an availability group, with synchronous replication and automatic failover.</span></span>

 <span data-ttu-id="5fe6a-118">Este artigo utiliza as seguintes tecnologias de recuperação de desastre nativas do SQL para recuperar bancos de dados em um local remoto:</span><span class="sxs-lookup"><span data-stu-id="5fe6a-118">This article leverages the following native SQL disaster recovery technologies for recovering databases to a remote site:</span></span>

* <span data-ttu-id="5fe6a-119">Grupos de Disponibilidade AlwaysOn do SQL, a fim de fornecer recuperação de desastres para SQL Server 2012 ou 2014 edições Enterprise.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-119">SQL Always On Availability Groups, to provide for disaster recovery for SQL Server 2012 or 2014 Enterprise editions.</span></span>
* <span data-ttu-id="5fe6a-120">Espelhamento de banco de dados SQL no modo de alta segurança para SQL Server Standard Edition (qualquer versão), ou para o SQL Server 2008 R2.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-120">SQL database mirroring in high safety mode, for SQL Server Standard edition (any version), or for SQL Server 2008 R2.</span></span>

## <a name="site-recovery-support"></a><span data-ttu-id="5fe6a-121">Suporte do Site Recovery</span><span class="sxs-lookup"><span data-stu-id="5fe6a-121">Site Recovery support</span></span>

### <a name="supported-scenarios"></a><span data-ttu-id="5fe6a-122">Cenários com suporte</span><span class="sxs-lookup"><span data-stu-id="5fe6a-122">Supported scenarios</span></span>
<span data-ttu-id="5fe6a-123">O Site Recovery pode proteger o SQL Server, como resumido na tabela.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-123">Site Recovery can protect SQL Server as summarized in the table.</span></span>

<span data-ttu-id="5fe6a-124">**Cenário**</span><span class="sxs-lookup"><span data-stu-id="5fe6a-124">**Scenario**</span></span> | <span data-ttu-id="5fe6a-125">**Para um site secundário**</span><span class="sxs-lookup"><span data-stu-id="5fe6a-125">**To a secondary site**</span></span> | <span data-ttu-id="5fe6a-126">**Para o Azure**</span><span class="sxs-lookup"><span data-stu-id="5fe6a-126">**To Azure**</span></span>
--- | --- | ---
<span data-ttu-id="5fe6a-127">**Hyper-V**</span><span class="sxs-lookup"><span data-stu-id="5fe6a-127">**Hyper-V**</span></span> | <span data-ttu-id="5fe6a-128">Sim</span><span class="sxs-lookup"><span data-stu-id="5fe6a-128">Yes</span></span> | <span data-ttu-id="5fe6a-129">Sim</span><span class="sxs-lookup"><span data-stu-id="5fe6a-129">Yes</span></span>
<span data-ttu-id="5fe6a-130">**VMware**</span><span class="sxs-lookup"><span data-stu-id="5fe6a-130">**VMware**</span></span> | <span data-ttu-id="5fe6a-131">Sim</span><span class="sxs-lookup"><span data-stu-id="5fe6a-131">Yes</span></span> | <span data-ttu-id="5fe6a-132">Sim</span><span class="sxs-lookup"><span data-stu-id="5fe6a-132">Yes</span></span>
<span data-ttu-id="5fe6a-133">**Servidor físico**</span><span class="sxs-lookup"><span data-stu-id="5fe6a-133">**Physical server**</span></span> | <span data-ttu-id="5fe6a-134">Sim</span><span class="sxs-lookup"><span data-stu-id="5fe6a-134">Yes</span></span> | <span data-ttu-id="5fe6a-135">Sim</span><span class="sxs-lookup"><span data-stu-id="5fe6a-135">Yes</span></span>

### <a name="supported-sql-server-versions"></a><span data-ttu-id="5fe6a-136">Versões do SQL Server com suporte</span><span class="sxs-lookup"><span data-stu-id="5fe6a-136">Supported SQL Server versions</span></span>
<span data-ttu-id="5fe6a-137">Essas versões do SQL Server tem suporte nos cenários com suporte:</span><span class="sxs-lookup"><span data-stu-id="5fe6a-137">These SQL Server versions are supported, for the supported scenarios:</span></span>

* <span data-ttu-id="5fe6a-138">SQL Server 2016 Enterprise e Standard</span><span class="sxs-lookup"><span data-stu-id="5fe6a-138">SQL Server 2016 Enterprise and Standard</span></span>
* <span data-ttu-id="5fe6a-139">SQL Server 2014 Enterprise e Standard</span><span class="sxs-lookup"><span data-stu-id="5fe6a-139">SQL Server 2014 Enterprise and Standard</span></span>
* <span data-ttu-id="5fe6a-140">SQL Server 2012 Enterprise e Standard</span><span class="sxs-lookup"><span data-stu-id="5fe6a-140">SQL Server 2012 Enterprise and Standard</span></span>
* <span data-ttu-id="5fe6a-141">SQL Server 2008 R2 Enterprise e Standard</span><span class="sxs-lookup"><span data-stu-id="5fe6a-141">SQL Server 2008 R2 Enterprise and Standard</span></span>

### <a name="supported-sql-server-integration"></a><span data-ttu-id="5fe6a-142">Integração do SQL Server com suporte</span><span class="sxs-lookup"><span data-stu-id="5fe6a-142">Supported SQL Server integration</span></span>

<span data-ttu-id="5fe6a-143">O Site Recovery pode ser integrado com tecnologias nativas de BCDR do SQL Server, resumidas na tabela a fim de fornecer uma solução de recuperação de desastres.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-143">Site Recovery can be integrated with native SQL Server BCDR technologies summarized in the table, to provide a disaster recovery solution.</span></span>

<span data-ttu-id="5fe6a-144">**Recurso**</span><span class="sxs-lookup"><span data-stu-id="5fe6a-144">**Feature**</span></span> | <span data-ttu-id="5fe6a-145">**Detalhes**</span><span class="sxs-lookup"><span data-stu-id="5fe6a-145">**Details**</span></span> | <span data-ttu-id="5fe6a-146">**SQL Server**</span><span class="sxs-lookup"><span data-stu-id="5fe6a-146">**SQL Server**</span></span> |
--- | --- | ---
<span data-ttu-id="5fe6a-147">**Grupo de disponibilidade Sempre Ativo**</span><span class="sxs-lookup"><span data-stu-id="5fe6a-147">**Always On availability group**</span></span> | <span data-ttu-id="5fe6a-148">Várias instâncias autônomas do SQL Server cada uma executando em um cluster de failover com vários nós.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-148">Multiple standalone instances of SQL Server each run in a failover cluster that has multiple nodes.</span></span><br/><br/><span data-ttu-id="5fe6a-149">Os bancos de dados podem ser agrupados em grupos de failover, que podem ser copiados (espelhados) em instâncias do SQL Server, de modo que não exista a necessidade de armazenamento compartilhado.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-149">Databases can be grouped into failover groups that can be copied (mirrored) on SQL Server instances so that no shared storage is needed.</span></span><br/><br/><span data-ttu-id="5fe6a-150">Fornece a recuperação de desastres entre um site primário e um ou mais sites secundários.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-150">Provides disaster recovery between a primary site and one or more secondary sites.</span></span> <span data-ttu-id="5fe6a-151">Dois nós podem ser configurados em um cluster sem compartilhamento, com bancos de dados do SQL Server configurados em um grupo de disponibilidade, com replicação síncrona e failover automático.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-151">Two nodes can be set up in a shared nothing cluster with SQL Server databases configured in an availability group with synchronous replication and automatic failover.</span></span> | <span data-ttu-id="5fe6a-152">SQL Server 2014 & 2012 Enterprise Edition</span><span class="sxs-lookup"><span data-stu-id="5fe6a-152">SQL Server 2014 & 2012 Enterprise edition</span></span>
<span data-ttu-id="5fe6a-153">**Clustering de failover (FCI AlwaysOn)**</span><span class="sxs-lookup"><span data-stu-id="5fe6a-153">**Failover clustering (Always On FCI)**</span></span> | <span data-ttu-id="5fe6a-154">O SQL Server aproveita o Clustering de Failover do Windows para proporcionar a alta disponibilidade de cargas de trabalho local do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-154">SQL Server leverages Windows failover clustering for high availability of on-premises SQL Server workloads.</span></span><br/><br/><span data-ttu-id="5fe6a-155">Os nós que executam instâncias do SQL Server com discos compartilhados são configurados em um cluster de failover.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-155">Nodes running instances of SQL Server with shared disks are configured in a failover cluster.</span></span> <span data-ttu-id="5fe6a-156">Se uma instância estiver inoperante, o cluster realiza o failover para outro.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-156">If an instance is down the cluster fails over to different one.</span></span><br/><br/><span data-ttu-id="5fe6a-157">O cluster não protege contra falhas ou interrupções no armazenamento compartilhado.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-157">The cluster doesn't protect against failure or outages in shared storage.</span></span> <span data-ttu-id="5fe6a-158">O disco compartilhado pode ser implementado com iSCSI, fiber channel ou VHDXs compartilhados.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-158">The shared disk can be implemented with iSCSI, fiber channel, or shared VHDXs.</span></span> | <span data-ttu-id="5fe6a-159">Edições do SQL Server Enterprise</span><span class="sxs-lookup"><span data-stu-id="5fe6a-159">SQL Server Enterprise editions</span></span><br/><br/><span data-ttu-id="5fe6a-160">Edição SQL Server Standard (limitada somente a dois nós)</span><span class="sxs-lookup"><span data-stu-id="5fe6a-160">SQL Server Standard edition (limited to two nodes only)</span></span>
<span data-ttu-id="5fe6a-161">**Espelhamento de banco de dados (modo de alta segurança)**</span><span class="sxs-lookup"><span data-stu-id="5fe6a-161">**Database mirroring (high safety mode)**</span></span> | <span data-ttu-id="5fe6a-162">Protege um único banco de dados para uma única cópia secundária.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-162">Protects a single database to a single secondary copy.</span></span> <span data-ttu-id="5fe6a-163">Disponível nos modos de replicação de alta segurança (síncrona) e de alto desempenho (assíncrono).</span><span class="sxs-lookup"><span data-stu-id="5fe6a-163">Available in both high safety (synchronous) and high performance (asynchronous) replication modes.</span></span> <span data-ttu-id="5fe6a-164">Não requer um cluster de failover.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-164">Doesn’t require a failover cluster.</span></span> | <span data-ttu-id="5fe6a-165">SQL Server 2008 R2</span><span class="sxs-lookup"><span data-stu-id="5fe6a-165">SQL Server 2008 R2</span></span><br/><br/><span data-ttu-id="5fe6a-166">Todas as edições do SQL Server Enterprise</span><span class="sxs-lookup"><span data-stu-id="5fe6a-166">SQL Server Enterprise all editions</span></span>
<span data-ttu-id="5fe6a-167">**SQL Server autônomo**</span><span class="sxs-lookup"><span data-stu-id="5fe6a-167">**Standalone SQL Server**</span></span> | <span data-ttu-id="5fe6a-168">O SQL Server e o banco de dados estão hospedados em um único servidor (físico ou virtual).</span><span class="sxs-lookup"><span data-stu-id="5fe6a-168">The SQL Server and database are hosted on a single server (physical or virtual).</span></span> <span data-ttu-id="5fe6a-169">O clustering de host é usado para alta disponibilidade, se o servidor for virtual.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-169">Host clustering is used for high availability if the server is virtual.</span></span> <span data-ttu-id="5fe6a-170">Sem alta disponibilidade no nível do convidado.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-170">No guest-level high availability.</span></span> | <span data-ttu-id="5fe6a-171">Edição Enterprise ou Standard</span><span class="sxs-lookup"><span data-stu-id="5fe6a-171">Enterprise or Standard edition</span></span>

## <a name="deployment-recommendations"></a><span data-ttu-id="5fe6a-172">Recomendações de implantação</span><span class="sxs-lookup"><span data-stu-id="5fe6a-172">Deployment recommendations</span></span>

<span data-ttu-id="5fe6a-173">Esta tabela resume nossas recomendações para a integração de tecnologias de BCDR do SQL Server com a Recuperação de Site.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-173">This table summarizes our recommendations for integrating SQL Server BCDR technologies with Site Recovery.</span></span>

| <span data-ttu-id="5fe6a-174">**Versão**</span><span class="sxs-lookup"><span data-stu-id="5fe6a-174">**Version**</span></span> | <span data-ttu-id="5fe6a-175">**Edição**</span><span class="sxs-lookup"><span data-stu-id="5fe6a-175">**Edition**</span></span> | <span data-ttu-id="5fe6a-176">**Implantação**</span><span class="sxs-lookup"><span data-stu-id="5fe6a-176">**Deployment**</span></span> | <span data-ttu-id="5fe6a-177">**Local para local**</span><span class="sxs-lookup"><span data-stu-id="5fe6a-177">**On-prem to on-prem**</span></span> | <span data-ttu-id="5fe6a-178">**Local para o Azure**</span><span class="sxs-lookup"><span data-stu-id="5fe6a-178">**On-prem to Azure**</span></span> |
| --- | --- | --- | --- | --- |
| <span data-ttu-id="5fe6a-179">SQL Server 2014 ou 2012</span><span class="sxs-lookup"><span data-stu-id="5fe6a-179">SQL Server 2014 or 2012</span></span> |<span data-ttu-id="5fe6a-180">Enterprise</span><span class="sxs-lookup"><span data-stu-id="5fe6a-180">Enterprise</span></span> |<span data-ttu-id="5fe6a-181">Instância do cluster de failover</span><span class="sxs-lookup"><span data-stu-id="5fe6a-181">Failover cluster instance</span></span> |<span data-ttu-id="5fe6a-182">Grupos de disponibilidade AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="5fe6a-182">Always On availability groups</span></span> |<span data-ttu-id="5fe6a-183">Grupos de disponibilidade AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="5fe6a-183">Always On availability groups</span></span> |
|| <span data-ttu-id="5fe6a-184">Enterprise</span><span class="sxs-lookup"><span data-stu-id="5fe6a-184">Enterprise</span></span> |<span data-ttu-id="5fe6a-185">Grupos de disponibilidade AlwaysOn para alta disponibilidade</span><span class="sxs-lookup"><span data-stu-id="5fe6a-185">Always On availability groups for high availability</span></span> |<span data-ttu-id="5fe6a-186">Grupos de disponibilidade AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="5fe6a-186">Always On availability groups</span></span> |<span data-ttu-id="5fe6a-187">Grupos de disponibilidade AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="5fe6a-187">Always On availability groups</span></span> | |
|| <span data-ttu-id="5fe6a-188">Standard</span><span class="sxs-lookup"><span data-stu-id="5fe6a-188">Standard</span></span> |<span data-ttu-id="5fe6a-189">FCI (instância do cluster de failover)</span><span class="sxs-lookup"><span data-stu-id="5fe6a-189">Failover cluster instance (FCI)</span></span> |<span data-ttu-id="5fe6a-190">Replicação de Recuperação de Site com espelhamento local</span><span class="sxs-lookup"><span data-stu-id="5fe6a-190">Site Recovery replication with local mirror</span></span> |<span data-ttu-id="5fe6a-191">Replicação de Recuperação de Site com espelhamento local</span><span class="sxs-lookup"><span data-stu-id="5fe6a-191">Site Recovery replication with local mirror</span></span> | |
|| <span data-ttu-id="5fe6a-192">Enterprise ou Standard</span><span class="sxs-lookup"><span data-stu-id="5fe6a-192">Enterprise or Standard</span></span> |<span data-ttu-id="5fe6a-193">Autônomo</span><span class="sxs-lookup"><span data-stu-id="5fe6a-193">Standalone</span></span> |<span data-ttu-id="5fe6a-194">Replicação de recuperação de site</span><span class="sxs-lookup"><span data-stu-id="5fe6a-194">Site Recovery replication</span></span> |<span data-ttu-id="5fe6a-195">Replicação de recuperação de site</span><span class="sxs-lookup"><span data-stu-id="5fe6a-195">Site Recovery replication</span></span> | |
| <span data-ttu-id="5fe6a-196">SQL Server 2008 R2 ou 2008</span><span class="sxs-lookup"><span data-stu-id="5fe6a-196">SQL Server 2008 R2 or 2008</span></span> |<span data-ttu-id="5fe6a-197">Enterprise ou Standard</span><span class="sxs-lookup"><span data-stu-id="5fe6a-197">Enterprise or Standard</span></span> |<span data-ttu-id="5fe6a-198">FCI (instância do cluster de failover)</span><span class="sxs-lookup"><span data-stu-id="5fe6a-198">Failover cluster instance (FCI)</span></span> |<span data-ttu-id="5fe6a-199">Replicação de Recuperação de Site com espelhamento local</span><span class="sxs-lookup"><span data-stu-id="5fe6a-199">Site Recovery replication with local mirror</span></span> |<span data-ttu-id="5fe6a-200">Replicação de Recuperação de Site com espelhamento local</span><span class="sxs-lookup"><span data-stu-id="5fe6a-200">Site Recovery replication with local mirror</span></span> |
|| <span data-ttu-id="5fe6a-201">Enterprise ou Standard</span><span class="sxs-lookup"><span data-stu-id="5fe6a-201">Enterprise or Standard</span></span> |<span data-ttu-id="5fe6a-202">Autônomo</span><span class="sxs-lookup"><span data-stu-id="5fe6a-202">Standalone</span></span> |<span data-ttu-id="5fe6a-203">Replicação de recuperação de site</span><span class="sxs-lookup"><span data-stu-id="5fe6a-203">Site Recovery replication</span></span> |<span data-ttu-id="5fe6a-204">Replicação de recuperação de site</span><span class="sxs-lookup"><span data-stu-id="5fe6a-204">Site Recovery replication</span></span> | |
| <span data-ttu-id="5fe6a-205">SQL Server (qualquer versão)</span><span class="sxs-lookup"><span data-stu-id="5fe6a-205">SQL Server (Any version)</span></span> |<span data-ttu-id="5fe6a-206">Enterprise ou Standard</span><span class="sxs-lookup"><span data-stu-id="5fe6a-206">Enterprise or Standard</span></span> |<span data-ttu-id="5fe6a-207">Instância do cluster de failover – aplicativo DTC</span><span class="sxs-lookup"><span data-stu-id="5fe6a-207">Failover cluster instance - DTC application</span></span> |<span data-ttu-id="5fe6a-208">Replicação de recuperação de site</span><span class="sxs-lookup"><span data-stu-id="5fe6a-208">Site Recovery replication</span></span> |<span data-ttu-id="5fe6a-209">Sem suporte</span><span class="sxs-lookup"><span data-stu-id="5fe6a-209">Not Supported</span></span> |

## <a name="deployment-prerequisites"></a><span data-ttu-id="5fe6a-210">Pré-requisitos de implantação</span><span class="sxs-lookup"><span data-stu-id="5fe6a-210">Deployment prerequisites</span></span>

* <span data-ttu-id="5fe6a-211">Uma implantação local do SQL Server executando uma versão com suporte do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-211">An on-premises SQL Server deployment, running a supported SQL Server version.</span></span> <span data-ttu-id="5fe6a-212">Normalmente, também é necessário ter um Active Directory para o SQL Server.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-212">Typically, you also need Active Directory for your SQL server.</span></span>
* <span data-ttu-id="5fe6a-213">Os requisitos para o cenário que você deseja implantar.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-213">The requirements for the scenario you want to deploy.</span></span> <span data-ttu-id="5fe6a-214">Saiba mais sobre os requisitos de suporte para [replicação no Azure](site-recovery-support-matrix-to-azure.md) e [no local](site-recovery-support-matrix.md) e [os pré-requisitos de implantação](site-recovery-prereq.md).</span><span class="sxs-lookup"><span data-stu-id="5fe6a-214">Learn more about support requirements for [replication to Azure](site-recovery-support-matrix-to-azure.md) and [on-premises](site-recovery-support-matrix.md), and [deployment prerequisites](site-recovery-prereq.md).</span></span>
* <span data-ttu-id="5fe6a-215">Para configurar a recuperação no Azure, será necessário executar a ferramenta [Avaliação de preparação da máquina virtual do Azure](http://www.microsoft.com/download/details.aspx?id=40898) nas máquinas virtuais do SQL Server a fim de verificar se são compatíveis com o Azure e com o Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-215">To set up recovery in Azure, run the [Azure Virtual Machine Readiness Assessment](http://www.microsoft.com/download/details.aspx?id=40898) tool on your SQL Server virtual machines, to make sure they're compatible with Azure and Site Recovery.</span></span>

## <a name="set-up-active-directory"></a><span data-ttu-id="5fe6a-216">Configurar o Active Directory</span><span class="sxs-lookup"><span data-stu-id="5fe6a-216">Set up Active Directory</span></span>

<span data-ttu-id="5fe6a-217">Configure o Active Directory no site de recuperação secundário para que o SQL Server seja executado corretamente.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-217">Set up Active Directory, in the secondary recovery site, for SQL Server to run properly.</span></span>

* <span data-ttu-id="5fe6a-218">**Pequena empresa**— Com uma quantidade pequena de aplicativos e um único controlador de domínio para o site local, se você quiser realizar o failover de todo o site, recomendamos o uso da replicação do Site Recovery para replicar o controlador de domínio para o armazenamento de dados secundário ou para o Azure.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-218">**Small enterprise**—With a small number of applications, and single domain controller for the on-premises site, if you want to fail over the entire site, we recommend you use Site Recovery replication to replicate the domain controller to the secondary datacenter, or to Azure.</span></span>
* <span data-ttu-id="5fe6a-219">**Empresa de médio e grande porte**— Se você tiver uma grande quantidade de aplicativos, uma floresta do Active Directory e quiser realizar o failover por aplicativo ou carga de trabalho, recomendamos a configuração de um controlador de domínio adicional no armazenamento de dados secundário ou no Azure.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-219">**Medium to large enterprise**—If you have a large number of applications, an Active Directory forest, and you want to fail over by application or workload, we recommend you set up an additional domain controller in the secondary datacenter, or in Azure.</span></span> <span data-ttu-id="5fe6a-220">Se você estiver usando os grupos de disponibilidade AlwaysOn para recuperar em um site remoto, recomendamos a configuração de outro controlador de domínio adicional no site secundário ou no Azure, a fim de usá-lo para a instância do SQL Server recuperada.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-220">If you're using Always On availability groups to recover to a remote site, we recommend you set up another additional domain controller on the secondary site or in Azure, to use for the recovered SQL Server instance.</span></span>

<span data-ttu-id="5fe6a-221">As instruções neste artigo supõem que exista um controlador de domínio disponível no local secundário.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-221">The instructions in this article presume that a domain controller is available in the secondary location.</span></span> <span data-ttu-id="5fe6a-222">[Ler mais](site-recovery-active-directory.md) sobre como proteger o Active Directory com o Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-222">[Read more](site-recovery-active-directory.md) about protecting Active Directory with Site Recovery.</span></span>


## <a name="integrate-with-sql-server-always-on-for-replication-to-azure"></a><span data-ttu-id="5fe6a-223">Integrar com o SQL Server Always On para replicação no Azure</span><span class="sxs-lookup"><span data-stu-id="5fe6a-223">Integrate with SQL Server Always On for replication to Azure</span></span>

<span data-ttu-id="5fe6a-224">Você precisa saber do seguinte:</span><span class="sxs-lookup"><span data-stu-id="5fe6a-224">Here's what you need to do:</span></span>

1. <span data-ttu-id="5fe6a-225">Importar scripts para sua conta da Automação do Azure.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-225">Import scripts into your Azure Automation account.</span></span> <span data-ttu-id="5fe6a-226">Contém os scripts de failover do grupo de disponibilidade do SQL em uma [máquina virtual do Resource Manager](https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/asr-automation-recovery/scripts/ASR-SQL-FailoverAG.ps1) e uma [máquina virtual clássica](https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/asr-automation-recovery/scripts/ASR-SQL-FailoverAGClassic.ps1).</span><span class="sxs-lookup"><span data-stu-id="5fe6a-226">This contains the scripts to failover SQL Availability Group in a [Resource Manager virtual machine](https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/asr-automation-recovery/scripts/ASR-SQL-FailoverAG.ps1) and a [Classic virtual machine](https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/asr-automation-recovery/scripts/ASR-SQL-FailoverAGClassic.ps1).</span></span>

    <span data-ttu-id="5fe6a-227">[![Implantar no Azure](https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/c4803408-340e-49e3-9a1f-0ed3f689813d.png)](https://aka.ms/asr-automationrunbooks-deploy)</span><span class="sxs-lookup"><span data-stu-id="5fe6a-227">[![Deploy to Azure](https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/c4803408-340e-49e3-9a1f-0ed3f689813d.png)](https://aka.ms/asr-automationrunbooks-deploy)</span></span>


1. <span data-ttu-id="5fe6a-228">Adicione ASR-SQL-FailoverAG como uma ação prévia do primeiro grupo do plano de recuperação.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-228">Add ASR-SQL-FailoverAG as a pre action of the first group of the recovery plan.</span></span>

1. <span data-ttu-id="5fe6a-229">Siga as instruções disponíveis no script para criar uma variável de automação para fornecer o nome dos grupos de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-229">Follow the instructions available in the script to create an automation variable to provide the name of the availability groups.</span></span>

### <a name="steps-to-do-a-test-failover"></a><span data-ttu-id="5fe6a-230">Etapas para fazer um failover de teste</span><span class="sxs-lookup"><span data-stu-id="5fe6a-230">Steps to do a test failover</span></span>

<span data-ttu-id="5fe6a-231">O SQL AlwaysOn não dá suporte nativo ao failover de teste.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-231">SQL Always On doesn’t natively support test failover.</span></span> <span data-ttu-id="5fe6a-232">Portanto, recomendamos o seguinte:</span><span class="sxs-lookup"><span data-stu-id="5fe6a-232">Therefore, we recommend the following:</span></span>

1. <span data-ttu-id="5fe6a-233">Configure o [Backup do Azure](../backup/backup-azure-vms.md) na máquina virtual que hospeda a réplica do grupo de disponibilidade no Azure.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-233">Set up [Azure Backup](../backup/backup-azure-vms.md) on the virtual machine that hosts the availability group replica in Azure.</span></span>

1. <span data-ttu-id="5fe6a-234">Antes de disparar o failover de teste do plano de recuperação, recupere a máquina virtual no backup feito na etapa anterior.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-234">Before triggering test failover of the recovery plan, recover the virtual machine from the backup taken in the previous step.</span></span>

    ![<span data-ttu-id="5fe6a-235">Restaurar do Backup do Azure</span><span class="sxs-lookup"><span data-stu-id="5fe6a-235">Restore from Azure Backup</span></span> ](./media/site-recovery-sql/restore-from-backup.png)

1. <span data-ttu-id="5fe6a-236">[Imponha um quorum](https://docs.microsoft.com/sql/sql-server/failover-clusters/windows/force-a-wsfc-cluster-to-start-without-a-quorum#PowerShellProcedure) na máquina virtual restaurada do backup.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-236">[Force a quorum](https://docs.microsoft.com/sql/sql-server/failover-clusters/windows/force-a-wsfc-cluster-to-start-without-a-quorum#PowerShellProcedure) in the virtual machine restored from backup.</span></span>

1. <span data-ttu-id="5fe6a-237">Atualize o IP do ouvinte para um IP disponível na rede de failover de teste.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-237">Update IP of the listener to an IP available in the test failover network.</span></span>

    ![Atualizar o Ouvinte de IP](./media/site-recovery-sql/update-listener-ip.png)

1. <span data-ttu-id="5fe6a-239">Coloque o ouvinte online.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-239">Bring listener online.</span></span>

    ![Colocar o Ouvinte Online](./media/site-recovery-sql/bring-listener-online.png)

1. <span data-ttu-id="5fe6a-241">Crie um balanceador de carga com um IP criado no pool IP de front-end correspondente a cada ouvinte de grupo de disponibilidade e com a máquina virtual do SQL adicionada no pool de back-end.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-241">Create a load balancer with one IP created under frontend IP pool corresponding to each availability group listener and with the SQL virtual machine added in the backend pool.</span></span>

     ![<span data-ttu-id="5fe6a-242">Criar balanceador de carga – pool IP de front-end</span><span class="sxs-lookup"><span data-stu-id="5fe6a-242">Create Load Balancer - Frontend IP pool</span></span> ](./media/site-recovery-sql/create-load-balancer1.png)

    ![<span data-ttu-id="5fe6a-243">Criar balanceador de carga – pool de back-end</span><span class="sxs-lookup"><span data-stu-id="5fe6a-243">Create Load Balancer - Backend pool</span></span> ](./media/site-recovery-sql/create-load-balancer2.png)

1. <span data-ttu-id="5fe6a-244">Execute o failover de teste do plano de recuperação.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-244">Do a test failover of the recovery plan.</span></span>

### <a name="steps-to-do-a-failover"></a><span data-ttu-id="5fe6a-245">Etapas para fazer um failover</span><span class="sxs-lookup"><span data-stu-id="5fe6a-245">Steps to do a failover</span></span>

<span data-ttu-id="5fe6a-246">Depois de adicionar o script no plano de recuperação e validar o plano de recuperação seguindo um failover de teste, você pode fazer o failover do plano de recuperação.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-246">Once you have added the script in the recovery plan and validated the recovery plan by doing a test failover, you can do failover of the recovery plan.</span></span>


## <a name="integrate-with-sql-server-always-on-for-replication-to-a-secondary-on-premises-site"></a><span data-ttu-id="5fe6a-247">Integração com o SQL Server Always On para replicação em um site local secundário</span><span class="sxs-lookup"><span data-stu-id="5fe6a-247">Integrate with SQL Server Always On for replication to a secondary on-premises site</span></span>

<span data-ttu-id="5fe6a-248">Se o SQL Server estiver usando grupos de disponibilidade para alta disponibilidade (ou uma FCI), recomendamos também o uso dos grupos de disponibilidade no site de recuperação.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-248">If the SQL Server is using availability groups for high availability (or an FCI), we recommend using availability groups on the recovery site as well.</span></span> <span data-ttu-id="5fe6a-249">Observe que isso se aplica a aplicativos que não usam transações distribuídas.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-249">Note that this applies to apps that don't use distributed transactions.</span></span>

1. <span data-ttu-id="5fe6a-250">[Configure bancos de dados](https://msdn.microsoft.com/library/hh213078.aspx) em grupos de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-250">[Configure databases](https://msdn.microsoft.com/library/hh213078.aspx) into availability groups.</span></span>
1. <span data-ttu-id="5fe6a-251">Crie uma rede virtual no site secundário.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-251">Create a virtual network on the secondary site.</span></span>
1. <span data-ttu-id="5fe6a-252">Configure uma conexão de VPN site a site entre a rede virtual e o site primário.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-252">Set up a site-to-site VPN connection between the virtual network, and the primary site.</span></span>
1. <span data-ttu-id="5fe6a-253">Crie uma máquina virtual no site de recuperação e instale nela o SQL Server.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-253">Create a virtual machine on the recovery site, and install SQL Server on it.</span></span>
1. <span data-ttu-id="5fe6a-254">Estenda os grupos de disponibilidade Always On existentes para a nova VM do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-254">Extend the existing Always On availability groups to the new SQL Server VM.</span></span> <span data-ttu-id="5fe6a-255">Configure essa instância do SQL Server como uma cópia de réplica assíncrona.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-255">Configure this SQL Server instance as an asynchronous replica copy.</span></span>
1. <span data-ttu-id="5fe6a-256">Crie um ouvinte do grupo de disponibilidade ou atualize o ouvinte existente para incluir a máquina virtual de réplica assíncrona.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-256">Create an availability group listener, or update the existing listener to include the asynchronous replica virtual machine.</span></span>
1. <span data-ttu-id="5fe6a-257">Certifique-se de que o farm de aplicativos esteja configurado usando o ouvinte.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-257">Make sure that the application farm is set up using the listener.</span></span> <span data-ttu-id="5fe6a-258">Se a instalação tiver usado o nome de servidor do banco de dados, atualize-o para usar o ouvinte de modo que você não precise reconfigurá-lo após o failover.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-258">If it's setup up using the database server name, update it to use the listener, so you don't need to reconfigure it after the failover.</span></span>

<span data-ttu-id="5fe6a-259">Para aplicativos que usam transações distribuídas, recomendamos a implantação do Site Recovery com a [replicação site a site do VMware/servidor físico](site-recovery-vmware-to-vmware.md).</span><span class="sxs-lookup"><span data-stu-id="5fe6a-259">For applications that use distributed transactions, we recommend you deploy Site Recovery with [VMware/physical server site-to-site replication](site-recovery-vmware-to-vmware.md).</span></span>

### <a name="recovery-plan-considerations"></a><span data-ttu-id="5fe6a-260">Considerações sobre o Plano de Recuperação</span><span class="sxs-lookup"><span data-stu-id="5fe6a-260">Recovery plan considerations</span></span>
1. <span data-ttu-id="5fe6a-261">Adicione este exemplo de script à biblioteca do VMM nos sites primário e secundário.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-261">Add this sample script to the VMM library, on the primary and secondary sites.</span></span>

        Param(
        [string]$SQLAvailabilityGroupPath
        )
        import-module sqlps
        Switch-SqlAvailabilityGroup -Path $SQLAvailabilityGroupPath -AllowDataLoss -force

1. <span data-ttu-id="5fe6a-262">Ao criar um plano de recuperação para o aplicativo, adicione uma ação prévia à etapa com script Group-1, que invoca o script para fazer o failover de grupos de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-262">When you create a recovery plan for the application, add a pre action to Group-1 scripted step, that invokes the script to fail over availability groups.</span></span>

## <a name="protect-a-standalone-sql-server"></a><span data-ttu-id="5fe6a-263">Proteger um SQL Server autônomo</span><span class="sxs-lookup"><span data-stu-id="5fe6a-263">Protect a standalone SQL Server</span></span>

<span data-ttu-id="5fe6a-264">Nesse cenário, recomendamos o uso da replicação de Site Recovery para proteger a máquina do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-264">In this scenario, we recommend that you use Site Recovery replication to protect the SQL Server machine.</span></span> <span data-ttu-id="5fe6a-265">As etapas exatas dependerão se o SQL Server é uma VM ou um servidor físico, e se você deseja replicar para o Azure ou para um site secundário local.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-265">The exact steps will depend whether SQL Server is a VM or a physical server, and whether you want to replicate to Azure or a secondary on-premises site.</span></span> <span data-ttu-id="5fe6a-266">Saiba mais sobre [cenários do Site Recovery](site-recovery-overview.md).</span><span class="sxs-lookup"><span data-stu-id="5fe6a-266">Learn about [Site Recovery scenarios](site-recovery-overview.md).</span></span>

## <a name="protect-a-sql-server-cluster-standard-editionwindows-server-2008-r2"></a><span data-ttu-id="5fe6a-267">Proteger um cluster do SQL Server (edição standard/Windows Server 2008 R2)</span><span class="sxs-lookup"><span data-stu-id="5fe6a-267">Protect a SQL Server cluster (standard edition/Windows Server 2008 R2)</span></span>

<span data-ttu-id="5fe6a-268">Para um cluster executando o SQL Server Standard ou o SQL Server 2008 R2, recomendamos o uso da replicação do Site Recovery para proteger o SQL Server.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-268">For a cluster running SQL Server Standard edition, or SQL Server 2008 R2, we recommend you use Site Recovery replication to protect SQL Server.</span></span>

### <a name="on-premises-to-on-premises"></a><span data-ttu-id="5fe6a-269">Local para o próprio local</span><span class="sxs-lookup"><span data-stu-id="5fe6a-269">On-premises to on-premises</span></span>

* <span data-ttu-id="5fe6a-270">Caso o aplicativo use transações distribuídas, recomendamos implantar o [Site Recovery com replicação SAN](site-recovery-vmm-san.md) para um ambiente Hyper-V ou [VMware/servidor físico para VMware](site-recovery-vmware-to-vmware.md) para um ambiente VMware.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-270">If the app uses distributed transactions we recommend you deploy [Site Recovery with SAN replication](site-recovery-vmm-san.md) for a Hyper-V environment, or [VMware/physical server to VMware](site-recovery-vmware-to-vmware.md) for a VMware environment.</span></span>
* <span data-ttu-id="5fe6a-271">Para aplicativos não DTC, use a abordagem anterior para recuperar o cluster como um servidor autônomo, aproveitando um espelho de banco de dados local de segurança alta.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-271">For non-DTC applications, use the above approach to recover the cluster as a standalone server, by leveraging a local high safety DB mirror.</span></span>

### <a name="on-premises-to-azure"></a><span data-ttu-id="5fe6a-272">Local para o Azure</span><span class="sxs-lookup"><span data-stu-id="5fe6a-272">On-premises to Azure</span></span>

<span data-ttu-id="5fe6a-273">O Site Recovery não dá suporte a clusters convidados ao replicar para o Azure.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-273">Site Recovery doesn't provide guest cluster support when replicating to Azure.</span></span> <span data-ttu-id="5fe6a-274">O SQL Server também não fornece uma solução de recuperação de desastres de baixo custo para a edição Standard.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-274">SQL Server also doesn't provide a low-cost disaster recovery solution for Standard edition.</span></span> <span data-ttu-id="5fe6a-275">Nesse cenário, recomendamos a proteção do cluster local do SQL Server para um SQL Server autônomo e sua recuperação no Azure.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-275">In this scenario, we recommend you protect the on-premises SQL Server cluster to a standalone SQL Server, and recover it in Azure.</span></span>

1. <span data-ttu-id="5fe6a-276">Configure uma instância do SQL Server Autônomo adicional no site local.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-276">Configure an additional standalone SQL Server instance on the on-premises site.</span></span>
1. <span data-ttu-id="5fe6a-277">Configure a instância para servir como um espelho para os bancos de dados que você quer proteger.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-277">Configure the instance to serve as a mirror for the databases you want to protect.</span></span> <span data-ttu-id="5fe6a-278">Configure o espelhamento no modo de alta segurança.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-278">Configure mirroring in high safety mode.</span></span>
1. <span data-ttu-id="5fe6a-279">Configure o Site Recovery no site local para [Hyper-V](site-recovery-hyper-v-site-to-azure.md) ou [VMs VMware/servidores físicos](site-recovery-vmware-to-azure-classic.md).</span><span class="sxs-lookup"><span data-stu-id="5fe6a-279">Configure Site Recovery on the on-premises site, for ([Hyper-V](site-recovery-hyper-v-site-to-azure.md) or [VMware VMs/physical servers)](site-recovery-vmware-to-azure-classic.md).</span></span>
1. <span data-ttu-id="5fe6a-280">Use a replicação da Recuperação de Site para replicar a nova instância do SQL Server para o Azure.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-280">Use Site Recovery replication to replicate the new SQL Server instance to Azure.</span></span> <span data-ttu-id="5fe6a-281">Como é uma cópia espelhada de alta segurança, ela será sincronizada com o cluster primário, mas será replicada para o Microsoft Azure usando a replicação do Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-281">Since it's a high safety mirror copy, it will be synchronized with the primary cluster, but it will be replicated to Azure using Site Recovery replication.</span></span>


![Cluster padrão](./media/site-recovery-sql/standalone-cluster-local.png)

### <a name="failback-considerations"></a><span data-ttu-id="5fe6a-283">Considerações sobre failback</span><span class="sxs-lookup"><span data-stu-id="5fe6a-283">Failback considerations</span></span>

<span data-ttu-id="5fe6a-284">Para clusters do SQL Server Standard, a realização do failback após um failover não planejado exige um backup e restauração do SQL Server, a partir da instância de espelho para o cluster original com o restabelecimento do espelhamento.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-284">For SQL Server Standard clusters, failback after an unplanned failover requires a SQL server backup and restore, from the mirror instance to the original cluster, with reestablishment of the mirror.</span></span>

## <a name="next-steps"></a><span data-ttu-id="5fe6a-285">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="5fe6a-285">Next steps</span></span>
<span data-ttu-id="5fe6a-286">[Saiba mais](site-recovery-components.md) sobre a arquitetura do Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="5fe6a-286">[Learn more](site-recovery-components.md) about Site Recovery architecture.</span></span>
