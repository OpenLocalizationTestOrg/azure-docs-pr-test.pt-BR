---
title: "aaaHow funciona VMware replicação tooAzure no Azure Site Recovery? | Microsoft Docs"
description: "Este artigo fornece uma visão geral dos componentes e arquitetura usada quando replicar local VMs VMware e servidores físicos tooAzure com hello serviço Azure Site Recovery"
services: site-recovery
documentationcenter: 
author: rayne-wiselman
manager: carmonm
editor: 
ms.assetid: c413efcd-d750-4b22-b34b-15bcaa03934a
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 05/29/2017
ms.author: raynew
ROBOTS: NOINDEX, NOFOLLOW
redirect_url: vmware-walkthrough-architecture
ms.openlocfilehash: f0fb834f8b251640f97e4d0163b2b9e54de691e1
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="how-does-vmware-replication-tooazure-work-in-site-recovery"></a><span data-ttu-id="309c1-104">Como funciona a VMware replicação tooAzure na recuperação de Site?</span><span class="sxs-lookup"><span data-stu-id="309c1-104">How does VMware replication tooAzure work in Site Recovery?</span></span>

<span data-ttu-id="309c1-105">Este artigo descreve os componentes de saudação e processos envolvidos ao replicar tooAzure máquinas virtuais e servidores físicos do Windows/Linux, VMware usando Olá local [do Azure Site Recovery](site-recovery-overview.md) serviço.</span><span class="sxs-lookup"><span data-stu-id="309c1-105">This article describes hello components and processes involved when replicating on-premises VMware virtual machines, and Windows/Linux physical servers, tooAzure using hello [Azure Site Recovery](site-recovery-overview.md) service.</span></span>

<span data-ttu-id="309c1-106">Quando você replica tooAzure de servidores locais físicos, a replicação usa também Olá mesmo componentes e processos como a replicação de VM do VMware, com essas diferenças:</span><span class="sxs-lookup"><span data-stu-id="309c1-106">When you replicate physical on-premises servers tooAzure, replication uses also hello same components and processes as VMware VM replication, with these differences:</span></span>

- <span data-ttu-id="309c1-107">Você pode usar um servidor físico para o servidor de configuração hello, em vez de uma VM do VMware.</span><span class="sxs-lookup"><span data-stu-id="309c1-107">You can use a physical server for hello configuration server, instead of a VMware VM.</span></span>
- <span data-ttu-id="309c1-108">Você precisará de uma infraestrutura do VMware local para failback.</span><span class="sxs-lookup"><span data-stu-id="309c1-108">You will need an on-premises VMware infrastructure for failback.</span></span> <span data-ttu-id="309c1-109">Não é possível reprovar máquina física tooa voltar.</span><span class="sxs-lookup"><span data-stu-id="309c1-109">You can't fail back tooa physical machine.</span></span>

<span data-ttu-id="309c1-110">Lançar os comentários na parte inferior da saudação deste artigo, ou fazer perguntas no hello [Fórum de serviços de recuperação do Azure](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span><span class="sxs-lookup"><span data-stu-id="309c1-110">Post any comments at hello bottom of this article, or ask questions in hello [Azure Recovery Services Forum](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span></span>


## <a name="architectural-components"></a><span data-ttu-id="309c1-111">Componentes de arquitetura</span><span class="sxs-lookup"><span data-stu-id="309c1-111">Architectural components</span></span>

<span data-ttu-id="309c1-112">Há vários componentes envolvidos ao replicar máquinas virtuais do VMware e servidores físicos tooAzure.</span><span class="sxs-lookup"><span data-stu-id="309c1-112">There are a number of components involved when replicating VMware VMs and physical servers tooAzure.</span></span>

<span data-ttu-id="309c1-113">**Componente**</span><span class="sxs-lookup"><span data-stu-id="309c1-113">**Component**</span></span> | <span data-ttu-id="309c1-114">**Localidade**</span><span class="sxs-lookup"><span data-stu-id="309c1-114">**Location**</span></span> | <span data-ttu-id="309c1-115">**Detalhes**</span><span class="sxs-lookup"><span data-stu-id="309c1-115">**Details**</span></span>
--- | --- | ---
<span data-ttu-id="309c1-116">**As tabelas**</span><span class="sxs-lookup"><span data-stu-id="309c1-116">**Azure**</span></span> | <span data-ttu-id="309c1-117">No Azure, você precisa de uma conta do Azure, uma conta de armazenamento do Azure e uma rede do Azure.</span><span class="sxs-lookup"><span data-stu-id="309c1-117">In Azure you need an Azure account, an Azure storage account, and an Azure network.</span></span> | <span data-ttu-id="309c1-118">Dados replicados são armazenados na conta de armazenamento hello e VMs do Azure são criadas com dados replicado de saudação quando ocorrer failover do seu site local.</span><span class="sxs-lookup"><span data-stu-id="309c1-118">Replicated data is stored in hello storage account, and Azure VMs are created with hello replicated data when failover from your on-premises site occurs.</span></span> <span data-ttu-id="309c1-119">Olá VMs do Azure conectar toohello rede virtual do Azure quando eles são criados.</span><span class="sxs-lookup"><span data-stu-id="309c1-119">hello Azure VMs connect toohello Azure virtual network when they're created.</span></span>
<span data-ttu-id="309c1-120">**Servidor de configuração**</span><span class="sxs-lookup"><span data-stu-id="309c1-120">**Configuration server**</span></span> | <span data-ttu-id="309c1-121">Um único servidor de gerenciamento (VMWare VM) que executa todos os componentes de local de saudação que são necessárias para a implantação de hello, incluindo o servidor de configuração de saudação, o servidor de processo, o servidor de destino mestre local</span><span class="sxs-lookup"><span data-stu-id="309c1-121">A single on-premises management server (VMWare VM) that runs all hello on-premises components that are needed for hello deployment, including hello configuration server, process server, master target server</span></span> | <span data-ttu-id="309c1-122">componente de servidor de configuração de saudação coordena as comunicações entre o local e o Azure e gerencia a replicação de dados.</span><span class="sxs-lookup"><span data-stu-id="309c1-122">hello configuration server component coordinates communications between on-premises and Azure, and manages data replication.</span></span>
 <span data-ttu-id="309c1-123">**Servidor de processo**:</span><span class="sxs-lookup"><span data-stu-id="309c1-123">**Process server**:</span></span>  | <span data-ttu-id="309c1-124">Instalado por padrão no servidor de configuração de saudação.</span><span class="sxs-lookup"><span data-stu-id="309c1-124">Installed by default on hello configuration server.</span></span> | <span data-ttu-id="309c1-125">Atua como um gateway de replicação.</span><span class="sxs-lookup"><span data-stu-id="309c1-125">Acts as a replication gateway.</span></span> <span data-ttu-id="309c1-126">Recebe dados de replicação, otimizá-lo com o cache, a compactação e criptografia e envia tooAzure armazenamento.</span><span class="sxs-lookup"><span data-stu-id="309c1-126">Receives replication data, optimizes it with caching, compression, and encryption, and sends it tooAzure storage.</span></span><br/><br/> <span data-ttu-id="309c1-127">servidor de processo Olá também lida com a instalação por push de máquinas de tooprotected de serviço de mobilidade hello e executa a descoberta automática de máquinas virtuais do VMware.</span><span class="sxs-lookup"><span data-stu-id="309c1-127">hello process server also handles push installation of hello Mobility service tooprotected machines, and performs automatic discovery of VMware VMs.</span></span><br/><br/> <span data-ttu-id="309c1-128">À medida que aumenta sua implantação, você pode adicionar mais processo dedicado separado servidores toohandle aumentar os volumes de tráfego de replicação.</span><span class="sxs-lookup"><span data-stu-id="309c1-128">As your deployment grows you can add additional separate dedicated process servers toohandle increasing volumes of replication traffic.</span></span>
 <span data-ttu-id="309c1-129">**Servidor de destino mestre**</span><span class="sxs-lookup"><span data-stu-id="309c1-129">**Master target server**</span></span> | <span data-ttu-id="309c1-130">Instalado por padrão no servidor de configuração local hello.</span><span class="sxs-lookup"><span data-stu-id="309c1-130">Installed by default on hello on-premises configuration server.</span></span> | <span data-ttu-id="309c1-131">Lida com os dados de replicação durante o failback do Azure.</span><span class="sxs-lookup"><span data-stu-id="309c1-131">Handles replication data during failback from Azure.</span></span><br/><br/> <span data-ttu-id="309c1-132">Se os volumes de tráfego de failback forem altos, você poderá implantar um servidor de destino mestre separado para failback.</span><span class="sxs-lookup"><span data-stu-id="309c1-132">If volumes of failback traffic are high, you can deploy a separate master target server for failback.</span></span>
<span data-ttu-id="309c1-133">**Servidores VMware**</span><span class="sxs-lookup"><span data-stu-id="309c1-133">**VMware servers**</span></span> | <span data-ttu-id="309c1-134">Máquinas virtuais do VMware são hospedadas em servidores de ESXi do vSphere, e é recomendável um vCenter hosts de saudação do servidor toomanage.</span><span class="sxs-lookup"><span data-stu-id="309c1-134">VMware VMs are hosted on vSphere ESXi servers, and we recommend a vCenter server toomanage hello hosts.</span></span> | <span data-ttu-id="309c1-135">Adicione o Cofre de serviços de recuperação de tooyour de servidores do VMware.</span><span class="sxs-lookup"><span data-stu-id="309c1-135">You add VMware servers tooyour Recovery Services vault.</span></span>
<span data-ttu-id="309c1-136">**Computadores replicados**</span><span class="sxs-lookup"><span data-stu-id="309c1-136">**Replicated machines**</span></span> | <span data-ttu-id="309c1-137">Olá serviço de mobilidade será instalado em cada máquina virtual que você deseja tooreplicate VMware.</span><span class="sxs-lookup"><span data-stu-id="309c1-137">hello Mobility service will be installed on each VMware VM you want tooreplicate.</span></span> <span data-ttu-id="309c1-138">Ele pode ser instalado manualmente em cada computador, ou com uma instalação por push saudação do servidor de processo.</span><span class="sxs-lookup"><span data-stu-id="309c1-138">It can be installed manually on each machine, or with a push installation from hello process server.</span></span>

<span data-ttu-id="309c1-139">Saiba mais sobre os pré-requisitos de implantação de saudação e requisitos para cada um desses componentes de saudação [matriz de suporte](site-recovery-support-matrix-to-azure.md).</span><span class="sxs-lookup"><span data-stu-id="309c1-139">Learn about hello deployment prerequisites and requirements for each of these components in hello [support matrix](site-recovery-support-matrix-to-azure.md).</span></span>

<span data-ttu-id="309c1-140">**Figura 1: VMware tooAzure componentes**</span><span class="sxs-lookup"><span data-stu-id="309c1-140">**Figure 1: VMware tooAzure components**</span></span>

![Componentes](./media/site-recovery-components/arch-enhanced.png)

## <a name="replication-process"></a><span data-ttu-id="309c1-142">Processo de replicação</span><span class="sxs-lookup"><span data-stu-id="309c1-142">Replication process</span></span>

1. <span data-ttu-id="309c1-143">Configurar implantação hello, incluindo componentes do Azure e um cofre de serviços de recuperação.</span><span class="sxs-lookup"><span data-stu-id="309c1-143">You set up hello deployment, including Azure components, and a Recovery Services vault.</span></span> <span data-ttu-id="309c1-144">No cofre Olá você especificar origem da replicação hello e destino, configurar o servidor de configuração Olá, adicionar servidores VMware, crie uma política de replicação, implantar o serviço de mobilidade Olá, habilitar a replicação e executar um failover de teste.</span><span class="sxs-lookup"><span data-stu-id="309c1-144">In hello vault you specify hello replication source and target, set up hello configuration server, add VMware servers, create a replication policy, deploy hello Mobility service, enable replication, and run a test failover.</span></span>
2.  <span data-ttu-id="309c1-145">Máquinas iniciam a replicação de acordo com a política de replicação Olá, e uma cópia inicial dos dados de saudação é replicado tooAzure armazenamento.</span><span class="sxs-lookup"><span data-stu-id="309c1-145">Machines start replicating in accordance with hello replication policy, and an initial copy of hello data is replicated tooAzure storage.</span></span>
4. <span data-ttu-id="309c1-146">A replicação de tooAzure de alterações delta começa após a conclusão da replicação inicial de saudação.</span><span class="sxs-lookup"><span data-stu-id="309c1-146">Replication of delta changes tooAzure begins after hello initial replication finishes.</span></span> <span data-ttu-id="309c1-147">As alterações acompanhadas para uma máquina são mantidas em um arquivo .hrl.</span><span class="sxs-lookup"><span data-stu-id="309c1-147">Tracked changes for a machine are held in a .hrl file.</span></span>
    - <span data-ttu-id="309c1-148">Replicadas máquinas se comunicar com servidor de configuração de saudação na porta HTTPS 443 entrada para o gerenciamento de replicação.</span><span class="sxs-lookup"><span data-stu-id="309c1-148">Replicating machines communicate with hello configuration server on port HTTPS 443 inbound, for replication management.</span></span>
    - <span data-ttu-id="309c1-149">Replicadas máquinas enviam servidor de processo de toohello de dados de replicação na porta HTTPS 9443 entrada (pode ser configurado).</span><span class="sxs-lookup"><span data-stu-id="309c1-149">Replicating machines send replication data toohello process server on port HTTPS 9443 inbound (can be configured).</span></span>
    - <span data-ttu-id="309c1-150">servidor de configuração de saudação orquestra o gerenciamento de replicação com o Azure através da porta HTTPS 443 de saída.</span><span class="sxs-lookup"><span data-stu-id="309c1-150">hello configuration server orchestrates replication management with Azure over port HTTPS 443 outbound.</span></span>
    - <span data-ttu-id="309c1-151">servidor de processo Olá recebe dados de máquinas de origem, otimiza criptografa e envia tooAzure armazenamento pela porta 443 saída.</span><span class="sxs-lookup"><span data-stu-id="309c1-151">hello process server receives data from source machines, optimizes and encrypts it, and sends it tooAzure storage over port 443 outbound.</span></span>
    - <span data-ttu-id="309c1-152">Se você habilitar a consistência de várias VMs, em seguida, máquinas no grupo de replicação Olá comunicam entre si pela porta 20004.</span><span class="sxs-lookup"><span data-stu-id="309c1-152">If you enable multi-VM consistency, then machines in hello replication group communicate with each other over port 20004.</span></span> <span data-ttu-id="309c1-153">Várias VMS serão usadas se você agrupar vários computadores em grupos de replicação que compartilham pontos de recuperação consistentes com o aplicativo e com falhas ao realizar o failover.</span><span class="sxs-lookup"><span data-stu-id="309c1-153">Multi-VM is used if you group multiple machines into replication groups that share crash-consistent and app-consistent recovery points when they fail over.</span></span> <span data-ttu-id="309c1-154">Isso é útil se estiver executando máquinas Olá a mesma carga de trabalho e precisam toobe consistente.</span><span class="sxs-lookup"><span data-stu-id="309c1-154">This is useful if machines are running hello same workload and need toobe consistent.</span></span>
5. <span data-ttu-id="309c1-155">O tráfego é replicado tooAzure armazenamento pontos de extremidade públicos, mais Olá da internet.</span><span class="sxs-lookup"><span data-stu-id="309c1-155">Traffic is replicated tooAzure storage public endpoints, over hello internet.</span></span> <span data-ttu-id="309c1-156">Como alternativa, você pode usar o [emparelhamento público](../expressroute/expressroute-circuit-peerings.md#public-peering) do Azure ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="309c1-156">Alternately, you can use Azure ExpressRoute [public peering](../expressroute/expressroute-circuit-peerings.md#public-peering).</span></span> <span data-ttu-id="309c1-157">Replicação do tráfego por uma VPN site a site de um tooAzure de site local não tem suporte.</span><span class="sxs-lookup"><span data-stu-id="309c1-157">Replicating traffic over a site-to-site VPN from an on-premises site tooAzure isn't supported.</span></span>

<span data-ttu-id="309c1-158">**Figura 2: VMware tooAzure replicação**</span><span class="sxs-lookup"><span data-stu-id="309c1-158">**Figure 2: VMware tooAzure replication**</span></span>

![Avançado](./media/site-recovery-components/v2a-architecture-henry.png)

## <a name="failover-and-failback-process"></a><span data-ttu-id="309c1-160">Processo de failover e failback</span><span class="sxs-lookup"><span data-stu-id="309c1-160">Failover and failback process</span></span>

1. <span data-ttu-id="309c1-161">Depois de verificar que se o failover de teste está funcionando como esperado, você pode executar failovers não planejados tooAzure conforme necessário.</span><span class="sxs-lookup"><span data-stu-id="309c1-161">After you verify that test failover is working as expected, you can run unplanned failovers tooAzure as required.</span></span> <span data-ttu-id="309c1-162">Não há suporte para failover planejado.</span><span class="sxs-lookup"><span data-stu-id="309c1-162">Planned failover isn't supported.</span></span>
2. <span data-ttu-id="309c1-163">Você pode fazer o failover de um único computador ou criar [planos de recuperação](site-recovery-create-recovery-plans.md), toofail entre várias VMs.</span><span class="sxs-lookup"><span data-stu-id="309c1-163">You can fail over a single machine, or create [recovery plans](site-recovery-create-recovery-plans.md), toofail over multiple VMs.</span></span>
3. <span data-ttu-id="309c1-164">Ao executar um failover, VMs de réplica são criadas no Azure.</span><span class="sxs-lookup"><span data-stu-id="309c1-164">When you run a failover, replica VMs are created in Azure.</span></span> <span data-ttu-id="309c1-165">Você pode confirmar uma failover toostart acessando Olá carga de trabalho da réplica Olá VM do Azure.</span><span class="sxs-lookup"><span data-stu-id="309c1-165">You commit a failover toostart accessing hello workload from hello replica Azure VM.</span></span>
4. <span data-ttu-id="309c1-166">Quando o site primário local estiver disponível novamente, você poderá executar o failback.</span><span class="sxs-lookup"><span data-stu-id="309c1-166">When your primary on-premises site is available again, you can fail back.</span></span> <span data-ttu-id="309c1-167">Configurar uma infra-estrutura de failback, iniciar a replicação de máquina de saudação do hello site secundário toohello primário e executar um failover não planejado do site secundário hello.</span><span class="sxs-lookup"><span data-stu-id="309c1-167">You set up a failback infrastructure, start replicating hello machine from hello secondary site toohello primary, and run an unplanned failover from hello secondary site.</span></span> <span data-ttu-id="309c1-168">Após você confirmar esse failover, dados serão back local e você precisa tooenable replicação tooAzure novamente.</span><span class="sxs-lookup"><span data-stu-id="309c1-168">After you commit this failover, data will be back on-premises, and you need tooenable replication tooAzure again.</span></span> [<span data-ttu-id="309c1-169">Saiba mais</span><span class="sxs-lookup"><span data-stu-id="309c1-169">Learn more</span></span>](site-recovery-failback-azure-to-vmware.md)

<span data-ttu-id="309c1-170">Há alguns requisitos de failback:</span><span class="sxs-lookup"><span data-stu-id="309c1-170">There are a few failback requirements:</span></span>


- <span data-ttu-id="309c1-171">**Servidor de processo temporário no Azure**: se você quiser toofail do Azure após o failover, você precisará tooset a uma VM do Azure configurado como um servidor de processo, a replicação toohandle do Azure.</span><span class="sxs-lookup"><span data-stu-id="309c1-171">**Temporary process server in Azure**: If you want toofail back from Azure after failover you'll need tooset up an Azure VM configured as a process server, toohandle replication from Azure.</span></span> <span data-ttu-id="309c1-172">Você pode excluir a VM após a conclusão do failback.</span><span class="sxs-lookup"><span data-stu-id="309c1-172">You can delete this VM after failback finishes.</span></span>
- <span data-ttu-id="309c1-173">**Conexão VPN**: para failback, você precisará de uma conexão VPN (ou rota expressa do Azure) configurar de saudação do Azure rede toohello no site local.</span><span class="sxs-lookup"><span data-stu-id="309c1-173">**VPN connection**: For failback you'll need a VPN connection (or Azure ExpressRoute) set up from hello Azure network toohello on-premises site.</span></span>
- <span data-ttu-id="309c1-174">**O servidor de destino mestre local separado**: servidor de destino mestre local Olá manipula failback.</span><span class="sxs-lookup"><span data-stu-id="309c1-174">**Separate on-premises master target server**: hello on-premises master target server handles failback.</span></span> <span data-ttu-id="309c1-175">o servidor de destino mestre Olá é instalado por padrão no servidor de gerenciamento hello, mas se você estiver falhando volta maiores volumes de tráfego de você deve configurar um servidor de destino mestre local separado para essa finalidade.</span><span class="sxs-lookup"><span data-stu-id="309c1-175">hello master target server is installed by default on hello management server, but if you're failing back larger volumes of traffic you should set up a separate on-premises master target server for this purpose.</span></span>
- <span data-ttu-id="309c1-176">**Diretiva de failback**: tooyour back tooreplicate site local, você precisará de uma política de failback.</span><span class="sxs-lookup"><span data-stu-id="309c1-176">**Failback policy**: tooreplicate back tooyour on-premises site, you need a failback policy.</span></span> <span data-ttu-id="309c1-177">Isso é criado automaticamente quando você cria sua política de replicação.</span><span class="sxs-lookup"><span data-stu-id="309c1-177">This is automatically created when you created your replication policy.</span></span>
- <span data-ttu-id="309c1-178">**O VMware infrastructure**: você deve realizar failback tooan de VM do VMware no local.</span><span class="sxs-lookup"><span data-stu-id="309c1-178">**VMware infrastructure**: You must fail back tooan on-premises VMware VM.</span></span> <span data-ttu-id="309c1-179">Isso significa que você precisa de uma infra-estrutura de VMware no local, mesmo se você estiver replicando tooAzure de servidores físicos no local.</span><span class="sxs-lookup"><span data-stu-id="309c1-179">This means you need an on-premises VMware infrastructure, even if you're replicating on-premises physical servers tooAzure.</span></span>

<span data-ttu-id="309c1-180">**Figura 3: failback físico/de VMware**</span><span class="sxs-lookup"><span data-stu-id="309c1-180">**Figure 3: VMware/physical failback**</span></span>

![Failback](./media/site-recovery-components/enhanced-failback.png)


## <a name="next-steps"></a><span data-ttu-id="309c1-182">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="309c1-182">Next steps</span></span>

<span data-ttu-id="309c1-183">Saudação de revisão [matriz de suporte](site-recovery-support-matrix-to-azure.md)</span><span class="sxs-lookup"><span data-stu-id="309c1-183">Review hello [support matrix](site-recovery-support-matrix-to-azure.md)</span></span>
