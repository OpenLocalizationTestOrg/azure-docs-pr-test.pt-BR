---
title: Failover de teste para o Azure no Site Recovery | Microsoft Docs
description: "Aprenda sobre a execução de um failover de teste do local para o Azure"
services: site-recovery
documentationcenter: 
author: prateek9us
manager: gauravd
editor: 
ms.assetid: 44813a48-c680-4581-a92e-cecc57cc3b1e
ms.service: site-recovery
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: storage-backup-recovery
ms.date: 07/04/2017
ms.author: pratshar
ms.openlocfilehash: 54f62af6abcdd38254fd5379b95baa05656dc90b
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 07/11/2017
---
# <a name="test--failover-to-azure-in-site-recovery"></a><span data-ttu-id="9751d-103">Failover de teste para o Azure no Site Recovery</span><span class="sxs-lookup"><span data-stu-id="9751d-103">Test  Failover to Azure in Site Recovery</span></span>



<span data-ttu-id="9751d-104">Este artigo fornece informações e instruções sobre como fazer um failover de teste ou uma simulação de recuperação de desastre de máquinas virtuais e servidores físicos protegidos com o Site Recovery usando o Azure como o local de recuperação.</span><span class="sxs-lookup"><span data-stu-id="9751d-104">This article provides information and instructions for doing a test failover or a DR drill of virtual machines and physical servers that are protected with Site Recovery using Azure as the recovery site.</span></span>

<span data-ttu-id="9751d-105">Publique eventuais comentários ou perguntas no final deste artigo ou no [Fórum dos Serviços de Recuperação do Azure](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span><span class="sxs-lookup"><span data-stu-id="9751d-105">Post any comments or questions at the bottom of this article, or on the [Azure Recovery Services Forum](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span></span>

<span data-ttu-id="9751d-106">O failover de teste é executado para validar sua estratégia de replicação ou executar uma simulação de recuperação de desastre sem nenhuma perda de dados ou tempo de inatividade.</span><span class="sxs-lookup"><span data-stu-id="9751d-106">Test failover is run to validate your replication strategy or perform a disaster recovery drill without any data loss or downtime.</span></span> <span data-ttu-id="9751d-107">Fazer o failover de teste não afeta a replicação em andamento ou em seu ambiente de produção.</span><span class="sxs-lookup"><span data-stu-id="9751d-107">Doing a test failover doesn't have any impact on the ongoing replication or on your production environment.</span></span> <span data-ttu-id="9751d-108">O failover de teste pode ser feito em uma máquina virtual ou a [plano de recuperação](site-recovery-create-recovery-plans.md).</span><span class="sxs-lookup"><span data-stu-id="9751d-108">Test failover can be done either on a virtual machine or a [recovery plan](site-recovery-create-recovery-plans.md).</span></span> <span data-ttu-id="9751d-109">Quando disparar um failover de teste, que você precisa especificar a rede à qual as máquinas virtuais de teste devem se conectar.</span><span class="sxs-lookup"><span data-stu-id="9751d-109">When triggering a test failover, you need to specify the network to which test virtual machines would connect to.</span></span> <span data-ttu-id="9751d-110">Depois que um failover de teste for disparado, você poderá acompanhar o progresso na página **Trabalhos**.</span><span class="sxs-lookup"><span data-stu-id="9751d-110">Once a test failover is triggered, you can track progress in the **Jobs** page.</span></span>  


## <a name="supported-scenarios"></a><span data-ttu-id="9751d-111">Cenários com suporte</span><span class="sxs-lookup"><span data-stu-id="9751d-111">Supported scenarios</span></span>
<span data-ttu-id="9751d-112">Failover de teste é suportado em todos os cenários de implantação, além de [site herdado do VMware no Azure](site-recovery-vmware-to-azure-classic-legacy.md).</span><span class="sxs-lookup"><span data-stu-id="9751d-112">Test failover is supported in all deployment scenarios other than [legacy VMware site to Azure](site-recovery-vmware-to-azure-classic-legacy.md).</span></span> <span data-ttu-id="9751d-113">O failover de teste também não terá suporte quando a máquina virtual tiver feito failover no Azure.</span><span class="sxs-lookup"><span data-stu-id="9751d-113">Test failover is also not supported when virtual machine has been failed over to Azure.</span></span>  


## <a name="run-a-test-failover"></a><span data-ttu-id="9751d-114">Execute um teste de failover</span><span class="sxs-lookup"><span data-stu-id="9751d-114">Run a test failover</span></span>
<span data-ttu-id="9751d-115">Este procedimento descreve como executar um failover de teste para um plano de recuperação.</span><span class="sxs-lookup"><span data-stu-id="9751d-115">This procedure describes how to run a test failover for a recovery plan.</span></span> <span data-ttu-id="9751d-116">Como alternativa, você também pode executar o failover de teste para um único computador usando a opção apropriada nele.</span><span class="sxs-lookup"><span data-stu-id="9751d-116">Alternatively you can also run test failover for a single machine by using the appropriate option on it.</span></span>

![Failover de Teste](./media/site-recovery-test-failover-to-azure/TestFailover.png)


1. <span data-ttu-id="9751d-118">Selecione **Planos de Recuperação** > *recoveryplan_name*.</span><span class="sxs-lookup"><span data-stu-id="9751d-118">Select **Recovery Plans** > *recoveryplan_name*.</span></span> <span data-ttu-id="9751d-119">Clique em **Failover de Teste**.</span><span class="sxs-lookup"><span data-stu-id="9751d-119">Click **Test Failover**.</span></span>
1. <span data-ttu-id="9751d-120">Selecione um **ponto de recuperação** para failover.</span><span class="sxs-lookup"><span data-stu-id="9751d-120">Select a **Recovery Point** to failover to.</span></span> <span data-ttu-id="9751d-121">Você pode usar uma das seguintes opções:</span><span class="sxs-lookup"><span data-stu-id="9751d-121">You can use one of the following options:</span></span>
    1.  <span data-ttu-id="9751d-122">**Mais recentes processados**: essa opção faz failover em todas as máquinas virtuais do plano de recuperação para o último ponto de recuperação que já foi processado pelo serviço de Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="9751d-122">**Latest processed**: This option fails over all virtual machines of the recovery plan to the latest recovery point that has already been processed by Site Recovery service.</span></span> <span data-ttu-id="9751d-123">Quando você estiver realizando o failover de teste de uma máquina virtual, o carimbo de data/hora do último ponto de recuperação processado também é mostrado.</span><span class="sxs-lookup"><span data-stu-id="9751d-123">When you are doing test failover of a virtual machine, time stamp of the latest processed recovery point is also shown.</span></span> <span data-ttu-id="9751d-124">Se estiver fazendo o failover de um plano de recuperação, você pode ir para a máquina virtual individual e visualizar o bloco **Últimos Pontos de Recuperação** para obter essas informações.</span><span class="sxs-lookup"><span data-stu-id="9751d-124">If you are doing failover of a recovery plan, you can go to individual virtual machine and look at **Latest Recovery Points** tile to get this information.</span></span> <span data-ttu-id="9751d-125">Como nenhum tempo é gasto para processar os dados não processados, esta opção fornece uma opção de failover de baixo RTO (objetivo de tempo de recuperação).</span><span class="sxs-lookup"><span data-stu-id="9751d-125">As no time is spent to process the unprocessed data, this option provides a low RTO (Recovery Time Objective) failover option.</span></span>
    1.  <span data-ttu-id="9751d-126">**Consistente de aplicativo mais recente**: essa opção realiza failover em todas as máquinas virtuais do plano de recuperação para o último ponto de recuperação consistente de aplicativo que já foi processado pelo serviço do Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="9751d-126">**Latest app-consistent**: This option fails over all virtual machines of the recovery plan to the latest application consistent recovery point that has already been processed by Site Recovery service.</span></span> <span data-ttu-id="9751d-127">Quando você estiver realizando failover de teste de uma máquina virtual, o carimbo de data/hora do ponto mais recente recuperação consistentes com o aplicativo também é mostrado.</span><span class="sxs-lookup"><span data-stu-id="9751d-127">When you are doing test failover of a virtual machine, time stamp of the latest app-consistent recovery point is also shown.</span></span> <span data-ttu-id="9751d-128">Se estiver fazendo o failover de um plano de recuperação, você pode ir para a máquina virtual individual e visualizar o bloco **Últimos Pontos de Recuperação** para obter essas informações.</span><span class="sxs-lookup"><span data-stu-id="9751d-128">If you are doing failover of a recovery plan, you can go to individual virtual machine and look at **Latest Recovery Points** tile to get this information.</span></span>
    1.  <span data-ttu-id="9751d-129">**Mais recente**: essa opção primeiro processa todos os dados que foram enviados ao serviço do Site Recovery para criar um ponto de recuperação para cada máquina virtual antes de failover para ele.</span><span class="sxs-lookup"><span data-stu-id="9751d-129">**Latest**: This option first processes all the data that has been sent to Site Recovery service to create a recovery point for each virtual machine before failing them over to it.</span></span> <span data-ttu-id="9751d-130">Essa opção oferece o menor RPO (objetivo de ponto de recuperação) da máquina virtual criada após failover terá todos os dados que tenha sido replicada para o serviço do Site Recovery quando o failover foi disparado.</span><span class="sxs-lookup"><span data-stu-id="9751d-130">This option provides the lowest RPO (Recovery Point Objective) as the virtual machine created after failover will have all the data that has been replicated to Site Recovery service when the failover was triggered.</span></span>
    1.  <span data-ttu-id="9751d-131">**Várias VMs processadas mais recentemente**: essa opção só está disponível para os planos de recuperação que têm pelo menos uma máquina virtual com consistência de várias VMs ativada.</span><span class="sxs-lookup"><span data-stu-id="9751d-131">**Latest multi-VM processed**: This option is only available for recovery plans that have at least one virtual machine with multi-VM consistency ON.</span></span> <span data-ttu-id="9751d-132">As máquinas virtuais que fazem parte de um failover de grupo de replicação para o ponto de recuperação consistente de várias VMs comuns mais recentes.</span><span class="sxs-lookup"><span data-stu-id="9751d-132">Virtual machines that are part of a replication group failover to the latest common multi-VM consistent recovery point.</span></span> <span data-ttu-id="9751d-133">Outras máquinas virtuais fazem failover para seus últimos pontos de recuperação processados.</span><span class="sxs-lookup"><span data-stu-id="9751d-133">Other virtual machines failover to their latest processed recovery point.</span></span>  
    1.  <span data-ttu-id="9751d-134">**Várias VMs mais recentes consistentes com aplicativo**: essa opção só está disponível para os planos de recuperação que têm pelo menos uma máquina virtual com consistência de várias VMs ativada.</span><span class="sxs-lookup"><span data-stu-id="9751d-134">**Latest multi-VM app-consistent**: This option is only available for recovery plans that have at least one virtual machine with multi-VM consistency ON.</span></span> <span data-ttu-id="9751d-135">Máquinas virtuais que fazem parte de um failover do grupo de replicação para o ponto de recuperação comum mais recente de várias VMs consistente com aplicativo.</span><span class="sxs-lookup"><span data-stu-id="9751d-135">Virtual machines that are part of a replication group failover to the latest common multi-VM application-consistent recovery point.</span></span> <span data-ttu-id="9751d-136">Outras máquinas virtuais fazem failover para seus últimos pontos de recuperação consistentes com aplicativo.</span><span class="sxs-lookup"><span data-stu-id="9751d-136">Other virtual machines failover to their latest application-consistent recovery point.</span></span> 
    1.  <span data-ttu-id="9751d-137">**Personalizado**: se você estiver realizando teste de failover de uma máquina virtual, você pode usar essa opção de failover para um determinado ponto de recuperação.</span><span class="sxs-lookup"><span data-stu-id="9751d-137">**Custom**: If you are doing test failover of a virtual machine, then you can use this option to failover to a particular recovery point.</span></span>
1. <span data-ttu-id="9751d-138">Selecione uma **rede virtual do Azure**: forneça uma rede virtual do Azure, onde as máquinas virtuais de teste seriam criadas.</span><span class="sxs-lookup"><span data-stu-id="9751d-138">Select an **Azure virtual network**: Provide an Azure virtual network where the test virtual machines would be created.</span></span> <span data-ttu-id="9751d-139">O Site Recovery tenta criar máquinas virtuais de teste em uma sub-rede de mesmo nome e usando o mesmo IP fornecido nas configurações de **Computação e Rede** da máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="9751d-139">Site Recovery attempts to create test virtual machines in a subnet of same name and using the same IP as that provided in **Compute and Network** settings of the virtual machine.</span></span> <span data-ttu-id="9751d-140">Se a sub-rede de mesmo nome não estiver disponível na rede virtual do Azure fornecida para failover de teste, então a máquina virtual de teste será criada na primeira sub-rede em ordem alfabética.</span><span class="sxs-lookup"><span data-stu-id="9751d-140">If subnet of same name is not available in the Azure virtual network provided for test failover, then test virtual machine is created in the first subnet alphabetically.</span></span> <span data-ttu-id="9751d-141">Se o mesmo IP não estiver disponível na sub-rede, a máquina virtual receberá outro endereço IP disponível na sub-rede.</span><span class="sxs-lookup"><span data-stu-id="9751d-141">If same IP is not available in the subnet, then virtual machine gets another IP address available in the subnet.</span></span> <span data-ttu-id="9751d-142">Leia esta seção para obter [mais detalhes](#creating-a-network-for-test-failover)</span><span class="sxs-lookup"><span data-stu-id="9751d-142">Read this section for [more details](#creating-a-network-for-test-failover)</span></span>
1. <span data-ttu-id="9751d-143">Se estiver fazendo failover no Azure e a criptografia de dados estiver habilitada, em **Chave de Criptografia**, selecione o certificado que foi emitido quando você habilitou a criptografia de dados durante a instalação do provedor.</span><span class="sxs-lookup"><span data-stu-id="9751d-143">If you're failing over to Azure and data encryption is enabled, in **Encryption Key** select the certificate that was issued when you enabled data encryption during Provider installation.</span></span> <span data-ttu-id="9751d-144">Você pode ignorar esta etapa se você não ativou a criptografia na máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="9751d-144">You can ignore this step if you have not enabled encryption on the virtual machine.</span></span>
1. <span data-ttu-id="9751d-145">Acompanhe o progresso do failover na guia **Trabalhos** .</span><span class="sxs-lookup"><span data-stu-id="9751d-145">Track failover progress on the **Jobs** tab.</span></span> <span data-ttu-id="9751d-146">Você deve poder ver o computador de réplica de teste no portal do Azure.</span><span class="sxs-lookup"><span data-stu-id="9751d-146">You should be able to see the test replica machine in the Azure portal.</span></span>
1. <span data-ttu-id="9751d-147">Para iniciar uma conexão de RDP na máquina virtual será necessário [adicionar um ip público](site-recovery-monitoring-and-troubleshooting.md#adding-a-public-ip-on-a-resource-manager-virtual-machine) na interface de rede de máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="9751d-147">To initiate an RDP connection on the virtual machine, you will need to [add a public ip](site-recovery-monitoring-and-troubleshooting.md#adding-a-public-ip-on-a-resource-manager-virtual-machine) on the network interface of the failed over virtual machine.</span></span> <span data-ttu-id="9751d-148">Se o failover para uma máquina virtual do clássico, você precisará [adicionar um ponto de extremidade](../virtual-machines/windows/classic/setup-endpoints.md) na porta 3389</span><span class="sxs-lookup"><span data-stu-id="9751d-148">If you are failing over to a Classic virtual machine, then you need to [add an endpoint](../virtual-machines/windows/classic/setup-endpoints.md) on port 3389</span></span>
1. <span data-ttu-id="9751d-149">Quando terminar, clique em **Failover de teste de limpeza** no plano de recuperação.</span><span class="sxs-lookup"><span data-stu-id="9751d-149">Once you're done, click **Cleanup test failover** on the recovery plan.</span></span> <span data-ttu-id="9751d-150">Em **Observações** , registre e salve todas as observações associadas ao failover de teste.</span><span class="sxs-lookup"><span data-stu-id="9751d-150">In **Notes** record and save any observations associated with the test failover.</span></span> <span data-ttu-id="9751d-151">Isso exclui as máquinas virtuais que foram criadas durante o failover de teste.</span><span class="sxs-lookup"><span data-stu-id="9751d-151">This deletes the virtual machines that were created during test failover.</span></span>


> [!TIP]
> <span data-ttu-id="9751d-152">O Site Recovery tenta criar máquinas virtuais de teste em uma sub-rede de mesmo nome e usando o mesmo IP fornecido nas configurações de **Computação e Rede** da máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="9751d-152">Site Recovery attempts to create test virtual machines in a subnet of same name and using the same IP as that provided in **Compute and Network** settings of the virtual machine.</span></span> <span data-ttu-id="9751d-153">Se a sub-rede de mesmo nome não estiver disponível na rede virtual do Azure fornecida para failover de teste, então a máquina virtual de teste será criada na primeira sub-rede em ordem alfabética.</span><span class="sxs-lookup"><span data-stu-id="9751d-153">If subnet of same name is not available in the Azure virtual network provided for test failover, then test virtual machine is created in the first subnet alphabetically.</span></span> <span data-ttu-id="9751d-154">Se o IP de destino fizer parte da sub-rede escolhida, o Site Recovery tentará criar a máquina virtual do failover de teste usando o IP de destino.</span><span class="sxs-lookup"><span data-stu-id="9751d-154">If the target IP is part of the chosen subnet, then site recovery tries to create the test failover virtual machine using the target IP.</span></span> <span data-ttu-id="9751d-155">Se o IP de destino não fizer parte da sub-rede escolhida, a máquina virtual do failover de teste será criada usando qualquer IP disponível na sub-rede escolhida.</span><span class="sxs-lookup"><span data-stu-id="9751d-155">If the target IP is not part of the chosen subnet then test failover virtual machine gets created using any available IP in the chosen subnet.</span></span>
>
>

## <a name="test-failover-job"></a><span data-ttu-id="9751d-156">Trabalho de failover de teste</span><span class="sxs-lookup"><span data-stu-id="9751d-156">Test failover job</span></span>

![Failover de Teste](./media/site-recovery-test-failover-to-azure/TestFailoverJob.png)

<span data-ttu-id="9751d-158">Quando é disparado, um failover de teste envolve as seguintes etapas:</span><span class="sxs-lookup"><span data-stu-id="9751d-158">When a test failover is triggered, it involves following steps:</span></span>

1. <span data-ttu-id="9751d-159">Verificação de pré-requisitos: essa etapa garante que todas as condições necessárias para o failover sejam atendidas</span><span class="sxs-lookup"><span data-stu-id="9751d-159">Prerequisites check: This step ensures that all conditions required for failover are met</span></span>
1. <span data-ttu-id="9751d-160">Failover: essa etapa processa os dados, deixando-os prontos para que uma máquina virtual do Azure seja criada a partir deles.</span><span class="sxs-lookup"><span data-stu-id="9751d-160">Failover: This step processes the data and makes it ready so that an Azure virtual machine can be created out of it.</span></span> <span data-ttu-id="9751d-161">Se você tiver escolhido o ponto de recuperação **Mais recente**, essa etapa cria um ponto de recuperação dos dados que foram enviados para o serviço.</span><span class="sxs-lookup"><span data-stu-id="9751d-161">If you have chosen **Latest** recovery point, this step creates a recovery point from the data that has been sent to the service.</span></span>
1. <span data-ttu-id="9751d-162">Início: essa etapa cria uma máquina virtual do Azure usando os dados processados na etapa anterior.</span><span class="sxs-lookup"><span data-stu-id="9751d-162">Start: This step creates an Azure virtual machine using the data processed in the previous step.</span></span>

## <a name="time-taken-for-failover"></a><span data-ttu-id="9751d-163">Tempo necessário para failover</span><span class="sxs-lookup"><span data-stu-id="9751d-163">Time taken for failover</span></span>

<span data-ttu-id="9751d-164">Em certos casos, o failover de máquinas virtuais requer uma etapa intermediária extra que geralmente leva cerca de oito a 10 minutos para ser concluída.</span><span class="sxs-lookup"><span data-stu-id="9751d-164">In certain cases, failover of virtual machines requires an extra intermediate step that usually takes around 8  to 10 minutes to complete.</span></span> <span data-ttu-id="9751d-165">Esses casos são os seguintes:</span><span class="sxs-lookup"><span data-stu-id="9751d-165">These cases are as following:</span></span>

* <span data-ttu-id="9751d-166">Máquinas virtuais VMware que usam uma versão do Serviço de mobilidade anterior a 9.8</span><span class="sxs-lookup"><span data-stu-id="9751d-166">VMware virtual machines using a version of the Mobility service older than 9.8</span></span>
* <span data-ttu-id="9751d-167">Servidores físicos</span><span class="sxs-lookup"><span data-stu-id="9751d-167">Physical servers</span></span>
* <span data-ttu-id="9751d-168">Máquinas virtuais VMware Linux</span><span class="sxs-lookup"><span data-stu-id="9751d-168">VMware Linux virtual machines</span></span>
* <span data-ttu-id="9751d-169">Máquinas virtuais Hyper-V protegidas como servidores físicos</span><span class="sxs-lookup"><span data-stu-id="9751d-169">Hyper-V virtual machines protected as physical servers</span></span>
* <span data-ttu-id="9751d-170">Máquinas virtuais VMware em que os drivers a seguir não estão presentes como drivers de inicialização</span><span class="sxs-lookup"><span data-stu-id="9751d-170">VMware virtual machines where following drivers are not present as boot drivers</span></span>
    * <span data-ttu-id="9751d-171">storvsc</span><span class="sxs-lookup"><span data-stu-id="9751d-171">storvsc</span></span>
    * <span data-ttu-id="9751d-172">vmbus</span><span class="sxs-lookup"><span data-stu-id="9751d-172">vmbus</span></span>
    * <span data-ttu-id="9751d-173">storflt</span><span class="sxs-lookup"><span data-stu-id="9751d-173">storflt</span></span>
    * <span data-ttu-id="9751d-174">intelide</span><span class="sxs-lookup"><span data-stu-id="9751d-174">intelide</span></span>
    * <span data-ttu-id="9751d-175">atapi</span><span class="sxs-lookup"><span data-stu-id="9751d-175">atapi</span></span>
* <span data-ttu-id="9751d-176">Máquinas virtuais VMware que não têm o serviço DHCP habilitado, independentemente de estarem usando endereços DHCP ou IP estáticos</span><span class="sxs-lookup"><span data-stu-id="9751d-176">VMware virtual machines that don't have DHCP service enabled irrespective of whether they are using DHCP or static IP addresses</span></span>

<span data-ttu-id="9751d-177">Em todos outros casos, essa etapa intermediária não é necessária, e o tempo necessário para o failover é significativamente menor.</span><span class="sxs-lookup"><span data-stu-id="9751d-177">In all the other cases this intermediate step is not required and the time taken for the failover is significantly lower.</span></span>


## <a name="creating-a-network-for-test-failover"></a><span data-ttu-id="9751d-178">Criar uma rede para failover de teste</span><span class="sxs-lookup"><span data-stu-id="9751d-178">Creating a network for test failover</span></span>
<span data-ttu-id="9751d-179">É recomendável que, quando você estiver realizando um failover de teste você escolher uma rede isolada da rede de site de recuperação de produção que você forneceu na **de computação e rede** configurações para a máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="9751d-179">It is recommended that when you are doing a test failover you choose a network that is isolated from your production recovery site network that you provided in **Compute and Network** settings for the virtual machine.</span></span> <span data-ttu-id="9751d-180">Por padrão quando você cria uma rede virtual do Azure, é isolado de outras redes.</span><span class="sxs-lookup"><span data-stu-id="9751d-180">By default when you create an Azure virtual network, it is isolated from other networks.</span></span> <span data-ttu-id="9751d-181">Essa rede deve imitar a sua rede de produção:</span><span class="sxs-lookup"><span data-stu-id="9751d-181">This network should mimic your production network:</span></span>

1. <span data-ttu-id="9751d-182">A rede de teste deve ter o mesmo número de sub-redes que em sua rede de produção e com o mesmo nome que aquelas de subents em sua rede de produção.</span><span class="sxs-lookup"><span data-stu-id="9751d-182">Test network should have same number of subnets as that in your production network and with the same name as those of the subnets in your production network.</span></span>
1. <span data-ttu-id="9751d-183">Rede de teste deve usar o mesmo intervalo IP da rede de produção.</span><span class="sxs-lookup"><span data-stu-id="9751d-183">Test network should use the same IP range as that of your production network.</span></span>
1. <span data-ttu-id="9751d-184">Atualizar o DNS da rede de teste como o IP que você atribuiu como IP de destino para a máquina virtual DNS em **de computação e rede** configurações.</span><span class="sxs-lookup"><span data-stu-id="9751d-184">Update the DNS of the Test Network as the IP that you gave as target IP for the DNS virtual machine under **Compute and Network** settings.</span></span> <span data-ttu-id="9751d-185">Leia a seção [considerações sobre failover de teste para o Active Directory](site-recovery-active-directory.md#test-failover-considerations) para obter mais detalhes.</span><span class="sxs-lookup"><span data-stu-id="9751d-185">Go through [test failover considerations for active directory](site-recovery-active-directory.md#test-failover-considerations) section for more details.</span></span>


## <a name="test-failover-to-a-production-network-on-recovery-site"></a><span data-ttu-id="9751d-186">Failover de teste para uma rede de produção no site de recuperação</span><span class="sxs-lookup"><span data-stu-id="9751d-186">Test failover to a production network on recovery site</span></span>
<span data-ttu-id="9751d-187">É recomendável que, quando você estiver realizando um failover de teste você escolher uma rede diferente da sua rede de site de recuperação de produção que você forneceu no **de computação e rede** configurações para a máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="9751d-187">It is recommended that when you are doing a test failover you choose a network that is different from your production recovery site network that you provided in **Compute and Network** settings for the virtual machine.</span></span> <span data-ttu-id="9751d-188">Mas se você realmente deseja validar a conectividade de rede ponta a ponta em uma falha na máquina virtual, observe os seguintes pontos:</span><span class="sxs-lookup"><span data-stu-id="9751d-188">But if you really want to validate end to end network connectivity in a failed over virtual machine, note the following points:</span></span>

1. <span data-ttu-id="9751d-189">Verifique se máquina virtual primária está desligada quando você estiver realizando o failover de teste.</span><span class="sxs-lookup"><span data-stu-id="9751d-189">Make sure that the primary virtual machine is shutdown when you are doing the test failover.</span></span> <span data-ttu-id="9751d-190">Se você não fizer isso, existirão duas máquinas virtuais com a mesma identidade em execução na mesma rede ao mesmo tempo, e isso pode levar a consequências indesejadas.</span><span class="sxs-lookup"><span data-stu-id="9751d-190">If you don't do so, there will be two virtual machines with the same identity running in the same network at the same time and that can lead to undesired consequences.</span></span>
1. <span data-ttu-id="9751d-191">As alterações feitas nas máquinas virtuais de failover de teste são perdidas quando elas são limpas.</span><span class="sxs-lookup"><span data-stu-id="9751d-191">Any changes that you make into the test failover virtual machines would be lost when you cleanup the test failover virtual machines.</span></span> <span data-ttu-id="9751d-192">Essas alterações não serão replicadas para a máquina virtual primária.</span><span class="sxs-lookup"><span data-stu-id="9751d-192">These changes will not be replicated back to the primary virtual machine.</span></span>
1. <span data-ttu-id="9751d-193">Essa forma de teste resulta em um tempo de inatividade do seu aplicativo de produção.</span><span class="sxs-lookup"><span data-stu-id="9751d-193">This way of doing testing leads to a downtime of your production application.</span></span> <span data-ttu-id="9751d-194">Os usuários do aplicativo devem ser solicitados a para não usar o aplicativo quando a análise de DR está em andamento.</span><span class="sxs-lookup"><span data-stu-id="9751d-194">Users of the application should be asked to not use the application when the DR drill is in progress.</span></span>  



## <a name="prepare-active-directory-and-dns"></a><span data-ttu-id="9751d-195">Preparar o Active Directory e o DNS</span><span class="sxs-lookup"><span data-stu-id="9751d-195">Prepare Active Directory and DNS</span></span>
<span data-ttu-id="9751d-196">Para executar um failover de teste em um teste de aplicativo, você precisará de uma cópia do ambiente de produção do Active Directory no ambiente de teste.</span><span class="sxs-lookup"><span data-stu-id="9751d-196">To run a test failover for application testing, you need a copy of the production Active Directory environment in your test environment.</span></span> <span data-ttu-id="9751d-197">Leia a seção [considerações sobre failover de teste para o Active Directory](site-recovery-active-directory.md#test-failover-considerations) para obter mais detalhes.</span><span class="sxs-lookup"><span data-stu-id="9751d-197">Go through [test failover considerations for active directory](site-recovery-active-directory.md#test-failover-considerations) section for more details.</span></span>

## <a name="prepare-to-connect-to-azure-vms-after-failover"></a><span data-ttu-id="9751d-198">Preparar para conectar VMs do Azure após o failover</span><span class="sxs-lookup"><span data-stu-id="9751d-198">Prepare to connect to Azure VMs after failover</span></span>

<span data-ttu-id="9751d-199">Se você quiser se conectar às VMs do Azure usando o RDP após o failover, realize as ações resumidas na tabela.</span><span class="sxs-lookup"><span data-stu-id="9751d-199">If you want to connect to Azure VMs using RDP after failover, make sure you do the actions summarized in the table.</span></span>

<span data-ttu-id="9751d-200">**Failover**</span><span class="sxs-lookup"><span data-stu-id="9751d-200">**Failover**</span></span> | <span data-ttu-id="9751d-201">**Localidade**</span><span class="sxs-lookup"><span data-stu-id="9751d-201">**Location**</span></span> | <span data-ttu-id="9751d-202">**Ações**</span><span class="sxs-lookup"><span data-stu-id="9751d-202">**Actions**</span></span>
--- | --- | ---
<span data-ttu-id="9751d-203">**VM do Azure executando o Windows**</span><span class="sxs-lookup"><span data-stu-id="9751d-203">**Azure VM running Windows**</span></span> | <span data-ttu-id="9751d-204">No computador local antes do failover</span><span class="sxs-lookup"><span data-stu-id="9751d-204">On on-premises machine before failover</span></span> | <span data-ttu-id="9751d-205">Para acessar a VM do Azure pela Internet, habilite o RDP, certifique-se de que as regras de TCP e UDP sejam adicionadas para o **Público** e verifique se o RDP foi permitido no **Firewall do Windows** > **Aplicativos Permitidos** para todos os perfis.</span><span class="sxs-lookup"><span data-stu-id="9751d-205">To access the Azure VM over the internet, enable RDP, make sure TCP, and UDP rules are added for the **Public**, and that RDP is allowed in **Windows Firewall** > **Allowed Apps**, for all profiles.</span></span><br/><br/> <span data-ttu-id="9751d-206">Para acesso por meio de uma conexão site a site, habilite o RDP no computador e verifique se o RDP foi permitido no **Firewall do Windows** -> **Aplicativos e recursos permitidos** para as redes **Domínio e Particular**.</span><span class="sxs-lookup"><span data-stu-id="9751d-206">To access over a site-to-site connection, enable RDP on the machine, and ensure that RDP is allowed in the **Windows Firewall** -> **Allowed apps and features** for **Domain and Private** networks.</span></span><br/><br/>  <span data-ttu-id="9751d-207">Certifique-se de que a política de SAN do sistema operacional esteja definida como **OnlineAll**.</span><span class="sxs-lookup"><span data-stu-id="9751d-207">Make sure the operating system's SAN policy is set to **OnlineAll**.</span></span> <span data-ttu-id="9751d-208">[Saiba mais](https://support.microsoft.com/kb/3031135).</span><span class="sxs-lookup"><span data-stu-id="9751d-208">[Learn more](https://support.microsoft.com/kb/3031135).</span></span><br/><br/> <span data-ttu-id="9751d-209">Verifique se não existem Windows atualizações pendentes na máquina virtual quando disparar um failover.</span><span class="sxs-lookup"><span data-stu-id="9751d-209">Make sure there are no Windows updates pending on the virtual machine when you trigger a failover.</span></span> <span data-ttu-id="9751d-210">A atualização do Windows pode começar quando você fizer failover e não for capaz de se conectar à máquina virtual até a atualização ser concluída.</span><span class="sxs-lookup"><span data-stu-id="9751d-210">Windows update might start when you failover and you will not be able to login to the virtual machine until the update completes.</span></span> <br/><br/>
<span data-ttu-id="9751d-211">**VM do Azure executando o Windows**</span><span class="sxs-lookup"><span data-stu-id="9751d-211">**Azure VM running Windows**</span></span> | <span data-ttu-id="9751d-212">Na VM do Azure após o failover</span><span class="sxs-lookup"><span data-stu-id="9751d-212">On Azure VM after failover</span></span> | <span data-ttu-id="9751d-213">Para uma máquina virtual clássica, [adicione um ponto de extremidade público](../virtual-machines/windows/classic/setup-endpoints.md) ao protocolo RDP (porta 3389)</span><span class="sxs-lookup"><span data-stu-id="9751d-213">For a classic virtual machine, [add a public endpoint](../virtual-machines/windows/classic/setup-endpoints.md) for the RDP protocol (port 3389)</span></span><br/><br/>  <span data-ttu-id="9751d-214">Para uma máquina virtual do Resource Manager, [adicione um IP público](site-recovery-monitoring-and-troubleshooting.md#adding-a-public-ip-on-a-resource-manager-virtual-machine) a ela.</span><span class="sxs-lookup"><span data-stu-id="9751d-214">For a Resource Manager virtual machine, [add a public IP](site-recovery-monitoring-and-troubleshooting.md#adding-a-public-ip-on-a-resource-manager-virtual-machine) on it.</span></span><br/><br/> <span data-ttu-id="9751d-215">As regras de grupo de segurança de rede na VM com failover e a sub-rede do Azure à qual ela está conectada precisam permitir conexões de entrada para a porta RDP.</span><span class="sxs-lookup"><span data-stu-id="9751d-215">The network security group rules on the failed over VM, and the Azure subnet to which it is connected, need to allow incoming connections to the RDP port.</span></span><br/><br/> <span data-ttu-id="9751d-216">Para uma máquina virtual do Resource Manager, você pode verificar **Inicializar diagnóstico** para examinar uma captura de tela da máquina virtual</span><span class="sxs-lookup"><span data-stu-id="9751d-216">For a Resource Manager virtual machine, you can check **Boot diagnostics** to look at a screenshot of the virtual machine</span></span><br/><br/> <span data-ttu-id="9751d-217">Se você não pode se conectar, verifique se a máquina virtual está funcionando e, em seguida, examinar esses [dicas de solução de problemas](http://social.technet.microsoft.com/wiki/contents/articles/31666.troubleshooting-remote-desktop-connection-after-failover-using-asr.aspx).</span><span class="sxs-lookup"><span data-stu-id="9751d-217">If you can't connect, check that the VM is running and then look at these [troubleshooting tips](http://social.technet.microsoft.com/wiki/contents/articles/31666.troubleshooting-remote-desktop-connection-after-failover-using-asr.aspx).</span></span><br/><br/>
<span data-ttu-id="9751d-218">**VM do Azure executando Linux**</span><span class="sxs-lookup"><span data-stu-id="9751d-218">**Azure VM running Linux**</span></span> | <span data-ttu-id="9751d-219">No computador local antes do failover</span><span class="sxs-lookup"><span data-stu-id="9751d-219">On on-premises machine before failover</span></span> | <span data-ttu-id="9751d-220">Verifique se o serviço Secure Shell na VM do Azure está definido para iniciar automaticamente na inicialização do sistema.</span><span class="sxs-lookup"><span data-stu-id="9751d-220">Ensure that the Secure Shell service on the Azure VM is set to start automatically on system boot.</span></span><br/><br/> <span data-ttu-id="9751d-221">Verifique se as regras de firewall permitem uma conexão SSH com ele.</span><span class="sxs-lookup"><span data-stu-id="9751d-221">Check that firewall rules allow an SSH connection to it.</span></span>
<span data-ttu-id="9751d-222">**VM do Azure executando Linux**</span><span class="sxs-lookup"><span data-stu-id="9751d-222">**Azure VM running Linux**</span></span> | <span data-ttu-id="9751d-223">VM do Azure após o failover</span><span class="sxs-lookup"><span data-stu-id="9751d-223">Azure VM after failover</span></span> | <span data-ttu-id="9751d-224">As regras de grupo de segurança de rede na VM com failover e a sub-rede do Azure à qual ela está conectada precisam permitir conexões de entrada para a porta SSH.</span><span class="sxs-lookup"><span data-stu-id="9751d-224">The network security group rules on the failed over VM, and the Azure subnet to which it is connected, need to allow incoming connections to the SSH port.</span></span><br/><br/> <span data-ttu-id="9751d-225">Para uma máquina virtual clássica, [adicione um ponto de extremidade público](../virtual-machines/windows/classic/setup-endpoints.md) deve ser criado para permitir conexões de entrada na porta SSH (porta TCP 22, por padrão).</span><span class="sxs-lookup"><span data-stu-id="9751d-225">For  a classic virtual machine, [add a public endpoint](../virtual-machines/windows/classic/setup-endpoints.md) should be created, to allow incoming connections on the SSH port (TCP port 22 by default).</span></span><br/><br/> <span data-ttu-id="9751d-226">Para uma máquina virtual do Resource Manager, [adicione um IP público](site-recovery-monitoring-and-troubleshooting.md#adding-a-public-ip-on-a-resource-manager-virtual-machine) a ela.</span><span class="sxs-lookup"><span data-stu-id="9751d-226">For a Resource Manager virtual machine, [add a public IP](site-recovery-monitoring-and-troubleshooting.md#adding-a-public-ip-on-a-resource-manager-virtual-machine) on it.</span></span><br/><br/> <span data-ttu-id="9751d-227">Para uma máquina virtual do Resource Manager, você pode verificar **Inicializar diagnóstico** para examinar uma captura de tela da máquina virtual</span><span class="sxs-lookup"><span data-stu-id="9751d-227">For a Resource Manager virtual machine, you can check **Boot diagnostics** to look at a screenshot of the virtual machine</span></span><br/><br/>



## <a name="next-steps"></a><span data-ttu-id="9751d-228">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="9751d-228">Next steps</span></span>
<span data-ttu-id="9751d-229">Depois de tentar executar um failover de teste com êxito, você poderá tentar executar um [failover](site-recovery-failover.md).</span><span class="sxs-lookup"><span data-stu-id="9751d-229">Once you have successfully tried a test failover you can try doing a [failover](site-recovery-failover.md).</span></span>
