---
title: "aaaHow funciona Hyper-V replicação tooAzure na recuperação de Site? | Microsoft Docs"
description: "Este artigo fornece uma visão geral do funcionamento da replicação do Hyper-V no Azure Site Recovery"
services: site-recovery
documentationcenter: 
author: rayne-wiselman
manager: jwhit
editor: 
ms.assetid: c413efcd-d750-4b22-b34b-15bcaa03934a
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 06/14/2017
ms.author: raynew
ROBOTS: NOINDEX, NOFOLLOW
redirect_url: site-recovery-architecture-hyper-v-to-azure
ms.openlocfilehash: e982806b4d6cdec2f71f82d8c73c17cc50ad3c33
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="how-does-hyper-v-replication-tooazure-work"></a><span data-ttu-id="40016-104">Como funciona o tooAzure de replicação do Hyper-V?</span><span class="sxs-lookup"><span data-stu-id="40016-104">How does Hyper-V replication tooAzure work?</span></span>

<span data-ttu-id="40016-105">Leia esta arquitetura de saudação do artigo toounderstand e fluxos de trabalho para tooAzure de replicação do Hyper-V usando Olá [do Azure Site Recovery](site-recovery-overview.md) serviço.</span><span class="sxs-lookup"><span data-stu-id="40016-105">Read this article toounderstand hello architecture and workflows for Hyper-V replication tooAzure using hello [Azure Site Recovery](site-recovery-overview.md) service.</span></span>

<span data-ttu-id="40016-106">Lançar os comentários na parte inferior deste artigo ou de saudação do hello [Fórum de serviços de recuperação do Azure](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span><span class="sxs-lookup"><span data-stu-id="40016-106">Post any comments at hello bottom of this article, or in hello [Azure Recovery Services Forum](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span></span>

<span data-ttu-id="40016-107">Você pode replicar Olá tooAzure a seguir:</span><span class="sxs-lookup"><span data-stu-id="40016-107">You can replicate hello following tooAzure:</span></span>
- <span data-ttu-id="40016-108">**Hyper-V com o VMM**: as máquinas virtuais em hosts do Hyper-V local gerenciadas nas nuvens do System Center Virtual MAchine Manager (VMM).</span><span class="sxs-lookup"><span data-stu-id="40016-108">**Hyper-V with VMM**: VMs located on on-premises Hyper-V hosts managed in  System Center Virtual MAchine Manager (VMM) clouds.</span></span> <span data-ttu-id="40016-109">Os hosts podem estar executando qualquer [sistema operacional com suporte](site-recovery-support-matrix-to-azure.md#support-for-datacenter-management-servers).</span><span class="sxs-lookup"><span data-stu-id="40016-109">Hosts can be running any [supported operating system](site-recovery-support-matrix-to-azure.md#support-for-datacenter-management-servers).</span></span> <span data-ttu-id="40016-110">Replique VMs Hyper-V executando qualquer sistema operacional convidado [com suporte do Hyper-V e do Azure](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/supported-windows-guest-operating-systems-for-hyper-v-on-windows).</span><span class="sxs-lookup"><span data-stu-id="40016-110">You can replicate Hyper-V VMs running any guest operating system [supported by Hyper-V and Azure](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/supported-windows-guest-operating-systems-for-hyper-v-on-windows).</span></span>
- <span data-ttu-id="40016-111">**Hyper-V sem o VMM**: VMs locais localizadas nos hosts Hyper-V que não são gerenciadas em nuvens do VMM.</span><span class="sxs-lookup"><span data-stu-id="40016-111">**Hyper-V without VMM**: On-premises VMs located on Hyper-V hosts that aren't managed in VMM clouds.</span></span> <span data-ttu-id="40016-112">Hosts podem executar qualquer um dos Olá [sistemas operacionais com suporte](site-recovery-support-matrix-to-azure.md#support-for-replicated-machine-os-versions).</span><span class="sxs-lookup"><span data-stu-id="40016-112">Hosts can run any of hello [supported operating systems](site-recovery-support-matrix-to-azure.md#support-for-replicated-machine-os-versions).</span></span> <span data-ttu-id="40016-113">Replique VMs Hyper-V executando qualquer sistema operacional convidado [com suporte do Hyper-V e do Azure](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/supported-windows-guest-operating-systems-for-hyper-v-on-windows).</span><span class="sxs-lookup"><span data-stu-id="40016-113">You can replicate Hyper-V VMs running any guest operating system [supported by Hyper-V and Azure](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/supported-windows-guest-operating-systems-for-hyper-v-on-windows).</span></span>


## <a name="architectural-components"></a><span data-ttu-id="40016-114">Componentes de arquitetura</span><span class="sxs-lookup"><span data-stu-id="40016-114">Architectural components</span></span>

<span data-ttu-id="40016-115">**Área**</span><span class="sxs-lookup"><span data-stu-id="40016-115">**Area**</span></span> | <span data-ttu-id="40016-116">**Componente**</span><span class="sxs-lookup"><span data-stu-id="40016-116">**Component**</span></span> | <span data-ttu-id="40016-117">**Detalhes**</span><span class="sxs-lookup"><span data-stu-id="40016-117">**Details**</span></span>
--- | --- | ---
<span data-ttu-id="40016-118">**As tabelas**</span><span class="sxs-lookup"><span data-stu-id="40016-118">**Azure**</span></span> | <span data-ttu-id="40016-119">No Azure, você precisa de uma conta do Microsoft Azure, uma conta de armazenamento do Azure e uma rede do Azure.</span><span class="sxs-lookup"><span data-stu-id="40016-119">In Azure you need a Microsoft Azure account, an Azure storage account, and a Azure network.</span></span> | <span data-ttu-id="40016-120">O armazenamento e a rede podem ser contas baseadas no Gerenciador de Recursos ou clássicas.</span><span class="sxs-lookup"><span data-stu-id="40016-120">Storage and network can be Resource Manager-based, or classic accounts.</span></span><br/><br/> <span data-ttu-id="40016-121">Dados replicados são armazenados na conta de armazenamento hello e VMs do Azure são criadas com dados replicado de saudação quando ocorrer failover do seu site local.</span><span class="sxs-lookup"><span data-stu-id="40016-121">Replicated data is stored in hello storage account, and Azure VMs are created with hello replicated data when failover from your on-premises site occurs.</span></span><br/><br/> <span data-ttu-id="40016-122">Olá VMs do Azure conectar toohello rede virtual do Azure quando eles são criados.</span><span class="sxs-lookup"><span data-stu-id="40016-122">hello Azure VMs connect toohello Azure virtual network when they're created.</span></span>
<span data-ttu-id="40016-123">**Servidor VMM**</span><span class="sxs-lookup"><span data-stu-id="40016-123">**VMM server**</span></span> | <span data-ttu-id="40016-124">Hosts Hyper-V localizados em nuvens do VMM</span><span class="sxs-lookup"><span data-stu-id="40016-124">Hyper-V hosts located in VMM clouds</span></span> | <span data-ttu-id="40016-125">Se os hosts Hyper-V são gerenciadas em nuvens do VMM, registre o servidor do VMM Olá no Olá que Cofre de serviços de recuperação.</span><span class="sxs-lookup"><span data-stu-id="40016-125">If Hyper-V hosts are managed in VMM clouds, you register hello VMM server in hello Recovery Services vault.</span></span><br/><br/> <span data-ttu-id="40016-126">No servidor do VMM Olá você instala a replicação de tooorchestrate de provedor de recuperação de Site Olá com o Azure.</span><span class="sxs-lookup"><span data-stu-id="40016-126">On hello VMM server you install hello Site Recovery Provider tooorchestrate replication with Azure.</span></span><br/><br/> <span data-ttu-id="40016-127">Você precisa lógicas e redes VM Configurar mapeamento de rede tooconfigure.</span><span class="sxs-lookup"><span data-stu-id="40016-127">You need logical and VM networks set up tooconfigure network mapping.</span></span> <span data-ttu-id="40016-128">Uma rede VM deve ser vinculado tooa rede lógica associada com a nuvem de saudação.</span><span class="sxs-lookup"><span data-stu-id="40016-128">A VM network should be linked tooa logical network that's associated with hello cloud.</span></span>
<span data-ttu-id="40016-129">**Host Hyper-V**</span><span class="sxs-lookup"><span data-stu-id="40016-129">**Hyper-V host**</span></span> | <span data-ttu-id="40016-130">Os servidores Hyper-V podem ser implantados com ou sem o servidor do VMM.</span><span class="sxs-lookup"><span data-stu-id="40016-130">Hyper-V servers can be deployed with or without VMM server.</span></span> | <span data-ttu-id="40016-131">Se não houver nenhum servidor do VMM, Olá provedor de recuperação de Site está instalado em replicação de tooorchestrate Olá host com a recuperação de Site sobre Olá da internet.</span><span class="sxs-lookup"><span data-stu-id="40016-131">If there's no VMM server, hello Site Recovery Provider is installed on hello host tooorchestrate replication with Site Recovery over hello internet.</span></span> <span data-ttu-id="40016-132">Se houver um servidor do VMM, Olá provedor está instalado nele e não no host de saudação.</span><span class="sxs-lookup"><span data-stu-id="40016-132">If there's a VMM server, hello Provider is installed on it, and not on hello host.</span></span><br/><br/> <span data-ttu-id="40016-133">Agente de serviços de recuperação de saudação é instalado na replicação de dados de toohandle Olá host.</span><span class="sxs-lookup"><span data-stu-id="40016-133">hello Recovery Services agent is installed on hello host toohandle data replication.</span></span><br/><br/> <span data-ttu-id="40016-134">Comunicações de saudação provedor e agente de saudação são seguro e criptografado.</span><span class="sxs-lookup"><span data-stu-id="40016-134">Communications from both hello Provider and hello agent are secure and encrypted.</span></span> <span data-ttu-id="40016-135">Os dados replicados no armazenamento do Azure também são criptografados.</span><span class="sxs-lookup"><span data-stu-id="40016-135">Replicated data in Azure storage is also encrypted.</span></span>
<span data-ttu-id="40016-136">**VMs Hyper-V**</span><span class="sxs-lookup"><span data-stu-id="40016-136">**Hyper-V VMs**</span></span> | <span data-ttu-id="40016-137">Você precisa de uma ou mais VMs no servidor de host do Hyper-V hello.</span><span class="sxs-lookup"><span data-stu-id="40016-137">You need one or more VMs on hello Hyper-V host server.</span></span> | <span data-ttu-id="40016-138">Não é necessário nada tooexplicitly instalado em máquinas virtuais</span><span class="sxs-lookup"><span data-stu-id="40016-138">Nothing needs tooexplicitly installed on VMs</span></span>

## <a name="deployment-steps"></a><span data-ttu-id="40016-139">Etapas de implantação.</span><span class="sxs-lookup"><span data-stu-id="40016-139">Deployment steps</span></span>

1. <span data-ttu-id="40016-140">**Azure**: configurar Olá componentes do Azure.</span><span class="sxs-lookup"><span data-stu-id="40016-140">**Azure**: You set up hello Azure components.</span></span> <span data-ttu-id="40016-141">Recomendamos que você configure as contas de armazenamento e rede antes de começar a implantação da Recuperação de Site.</span><span class="sxs-lookup"><span data-stu-id="40016-141">We recommend you set up storage and network accounts before you begin Site Recovery deployment.</span></span>
2. <span data-ttu-id="40016-142">**Cofre**: crie um cofre de Serviços de Recuperação para o Site Recovery e defina configurações de cofre, inclusive as configurações de origem e destino, configuração de uma política de replicação e habilitando a replicação.</span><span class="sxs-lookup"><span data-stu-id="40016-142">**Vault**: You create a Recovery Services vault for Site Recovery, and configure vault settings, including configuring source and target settings, setting up a replication policy, and enabling replication.</span></span>
3. <span data-ttu-id="40016-143">**Origem e destino**:</span><span class="sxs-lookup"><span data-stu-id="40016-143">**Source and target**:</span></span>
    - <span data-ttu-id="40016-144">**Hosts do Hyper-V nas nuvens do VMM**: como parte da especificação de configurações de fonte, você pode baixar e instalar Olá provedor Azure Site Recovery no servidor do VMM hello e agente de serviços de recuperação do Azure de saudação em cada host Hyper-V.</span><span class="sxs-lookup"><span data-stu-id="40016-144">**Hyper-V hosts in VMM clouds**: As part of specifying source settings, you download and install hello Azure Site Recovery Provider on hello VMM server, and hello Azure Recovery Services agent on each Hyper-V host.</span></span> <span data-ttu-id="40016-145">origem de saudação será servidor do VMM hello.</span><span class="sxs-lookup"><span data-stu-id="40016-145">hello source will be hello VMM server.</span></span> <span data-ttu-id="40016-146">destino de saudação é o Azure.</span><span class="sxs-lookup"><span data-stu-id="40016-146">hello target is Azure.</span></span>
    - <span data-ttu-id="40016-147">Hosts do Hyper-V sem o VMM: quando você especificar configurações de fonte, você baixar e instalar hello provedor e agente em cada host Hyper-V.</span><span class="sxs-lookup"><span data-stu-id="40016-147">Hyper-V hosts without VMM: When you specify source settings, you download and install hello Provider and agent on each Hyper-V host.</span></span> <span data-ttu-id="40016-148">Durante a implantação reunir hosts Olá em um site do Hyper-V e especifique este site como fonte de saudação.</span><span class="sxs-lookup"><span data-stu-id="40016-148">During deployment you gather hello hosts into a Hyper-V site, and specify this site as hello source.</span></span> <span data-ttu-id="40016-149">destino de saudação é o Azure.</span><span class="sxs-lookup"><span data-stu-id="40016-149">hello target is Azure.</span></span>

    <span data-ttu-id="40016-150">![Replicação do Hyper-V/VMM tooAzure](./media/site-recovery-components/arch-onprem-onprem-azure-vmm.png) ![tooAzure de replicação de site do Hyper-V](./media/site-recovery-components/arch-onprem-azure-hypervsite.png)</span><span class="sxs-lookup"><span data-stu-id="40016-150">![Hyper-V/VMM replication tooAzure](./media/site-recovery-components/arch-onprem-onprem-azure-vmm.png) ![Hyper-V site replication tooAzure](./media/site-recovery-components/arch-onprem-azure-hypervsite.png)</span></span>


4. <span data-ttu-id="40016-151">**Política de replicação**: criar uma política de replicação para o site Olá Hyper-V ou de nuvem do VMM.</span><span class="sxs-lookup"><span data-stu-id="40016-151">**Replication policy**: You create a replication policy for hello Hyper-V site or VMM cloud.</span></span> <span data-ttu-id="40016-152">política de saudação é tooall aplicada VMs localizadas em hosts na nuvem ou site hello.</span><span class="sxs-lookup"><span data-stu-id="40016-152">hello policy is applied tooall VMs located on hosts in hello site or cloud.</span></span>
5. <span data-ttu-id="40016-153">**Habilitar replicação**: habilite a replicação para máquinas virtuais do Hyper-V.</span><span class="sxs-lookup"><span data-stu-id="40016-153">**Enable replication**: You enable replication for Hyper-V VMs.</span></span> <span data-ttu-id="40016-154">A replicação inicial ocorre de acordo com as configurações de política de replicação hello.</span><span class="sxs-lookup"><span data-stu-id="40016-154">Initial replication occurs in accordance with hello replication policy settings.</span></span> <span data-ttu-id="40016-155">As alterações de dados são rastreadas e a replicação de tooAzure de alterações delta começa após a conclusão da replicação inicial de saudação.</span><span class="sxs-lookup"><span data-stu-id="40016-155">Data changes are tracked, and replication of delta changes tooAzure begins after hello initial replication finishes.</span></span> <span data-ttu-id="40016-156">As alterações acompanhadas para um item são mantidas em um arquivo .hrl.</span><span class="sxs-lookup"><span data-stu-id="40016-156">Tracked changes for an item are held in a .hrl file.</span></span>
6. <span data-ttu-id="40016-157">**Failover de teste**: executar um toomake de failover de teste se tudo está funcionando conforme o esperado.</span><span class="sxs-lookup"><span data-stu-id="40016-157">**Test failover**:  You run a test failover toomake sure everything's working as expected.</span></span>

<span data-ttu-id="40016-158">Saiba mais sobre a implantação:</span><span class="sxs-lookup"><span data-stu-id="40016-158">Learn more about deployment:</span></span>
- [<span data-ttu-id="40016-159">Introdução ao Hyper-V VM replicação tooAzure - com o VMM</span><span class="sxs-lookup"><span data-stu-id="40016-159">Get started with Hyper-V VM replication tooAzure - with VMM</span></span>](site-recovery-vmm-to-azure.md)
- [<span data-ttu-id="40016-160">Introdução ao Hyper-V VM replicação tooAzure - do VMM</span><span class="sxs-lookup"><span data-stu-id="40016-160">Get started with Hyper-V VM replication tooAzure - without VMM</span></span>](site-recovery-hyper-v-site-to-azure.md)

## <a name="hyper-v-replication-workflow"></a><span data-ttu-id="40016-161">Fluxo de trabalho de replicação do Hyper-V</span><span class="sxs-lookup"><span data-stu-id="40016-161">Hyper-V replication workflow</span></span>

### <a name="enable-protection"></a><span data-ttu-id="40016-162">Habilitar proteção</span><span class="sxs-lookup"><span data-stu-id="40016-162">Enable protection</span></span>

1. <span data-ttu-id="40016-163">Depois de habilitar a proteção para uma VM Hyper-V, em Olá portal do Azure ou no local, Olá **Habilitar proteção** inicia.</span><span class="sxs-lookup"><span data-stu-id="40016-163">After you enable protection for a Hyper-V VM, in hello Azure portal or on-premises, hello **Enable protection** starts.</span></span>
2. <span data-ttu-id="40016-164">Olá trabalho verifica máquina hello está em conformidade com os pré-requisitos, antes de chamar hello [CreateReplicationRelationship](https://msdn.microsoft.com/library/hh850036.aspx), tooset a replicação com configurações de saudação configurado.</span><span class="sxs-lookup"><span data-stu-id="40016-164">hello job checks that hello machine complies with prerequisites, before invoking hello [CreateReplicationRelationship](https://msdn.microsoft.com/library/hh850036.aspx), tooset up replication with hello settings you've configured.</span></span>
3. <span data-ttu-id="40016-165">trabalho Olá inicia a replicação inicial invocando Olá [StartReplication](https://msdn.microsoft.com/library/hh850303.aspx) método tooinitialize uma replicação completa de VM e tooAzure de discos virtuais da VM de saudação do envio.</span><span class="sxs-lookup"><span data-stu-id="40016-165">hello job starts initial replication by invoking hello [StartReplication](https://msdn.microsoft.com/library/hh850303.aspx) method, tooinitialize a full VM replication, and send hello VM's virtual disks tooAzure.</span></span>
4. <span data-ttu-id="40016-166">Você pode monitorar o trabalho Olá Olá **trabalhos** guia.      ![Lista de trabalhos](media/site-recovery-hyper-v-azure-architecture/image1.png) ![Habilitar busca detalhada da proteção](media/site-recovery-hyper-v-azure-architecture/image2.png)</span><span class="sxs-lookup"><span data-stu-id="40016-166">You can monitor hello job in hello **Jobs** tab.      ![Jobs list](media/site-recovery-hyper-v-azure-architecture/image1.png) ![Enable protection drill down](media/site-recovery-hyper-v-azure-architecture/image2.png)</span></span>

### <a name="initial-replication"></a><span data-ttu-id="40016-167">Replicação inicial</span><span class="sxs-lookup"><span data-stu-id="40016-167">Initial replication</span></span>

1. <span data-ttu-id="40016-168">Um [Instantâneo da VM do Hyper-V](https://technet.microsoft.com/library/dd560637.aspx) é tirado quando a replicação inicial é disparada.</span><span class="sxs-lookup"><span data-stu-id="40016-168">A [Hyper-V VM snapshot](https://technet.microsoft.com/library/dd560637.aspx) snapshot is taken when initial replication is triggered.</span></span>
2. <span data-ttu-id="40016-169">Discos rígidos virtuais são replicadas uma até que são todos os tooAzure copiado.</span><span class="sxs-lookup"><span data-stu-id="40016-169">Virtual hard disks are replicated one by one until they're all copied tooAzure.</span></span> <span data-ttu-id="40016-170">Ele pode demorar um pouco, dependendo da saudação tamanho da VM e largura de banda de rede.</span><span class="sxs-lookup"><span data-stu-id="40016-170">It could take a while, depending on hello VM size, and network bandwidth.</span></span> <span data-ttu-id="40016-171">toooptimize o uso da rede, consulte [como toomanage local tooAzure uso de largura de banda de rede de proteção](https://support.microsoft.com/kb/3056159).</span><span class="sxs-lookup"><span data-stu-id="40016-171">toooptimize your network usage, see [How toomanage on-premises tooAzure protection network bandwidth usage](https://support.microsoft.com/kb/3056159).</span></span>
3. <span data-ttu-id="40016-172">Se ocorrerem alterações de disco enquanto a replicação inicial está em andamento, Olá rastreador de replicação de réplica do Hyper-V rastreia as alterações como Logs de replicação do Hyper-V (. hrl).</span><span class="sxs-lookup"><span data-stu-id="40016-172">If disk changes occur while initial replication is in progress, hello Hyper-V Replica Replication Tracker tracks those changes as Hyper-V Replication Logs (.hrl).</span></span> <span data-ttu-id="40016-173">Esses arquivos estão localizados em Olá mesma pasta que os discos de saudação.</span><span class="sxs-lookup"><span data-stu-id="40016-173">These files are located in hello same folder as hello disks.</span></span> <span data-ttu-id="40016-174">Cada disco tem um arquivo. hrl associado que será enviado toosecondary armazenamento.</span><span class="sxs-lookup"><span data-stu-id="40016-174">Each disk has an associated .hrl file that will be sent toosecondary storage.</span></span>
4. <span data-ttu-id="40016-175">arquivos de log e de instantâneo de saudação consumam recursos de disco enquanto a replicação inicial está em andamento.</span><span class="sxs-lookup"><span data-stu-id="40016-175">hello snapshot and log files consume disk resources while initial replication is in progress.</span></span>
5. <span data-ttu-id="40016-176">Quando a replicação inicial Olá for concluído, o instantâneo de VM Olá é excluído.</span><span class="sxs-lookup"><span data-stu-id="40016-176">When hello initial replication finishes, hello VM snapshot is deleted.</span></span> <span data-ttu-id="40016-177">As alterações de disco delta no log de saudação são sincronizados e mesclada toohello pai disco.</span><span class="sxs-lookup"><span data-stu-id="40016-177">Delta disk changes in hello log are synchronized and merged toohello parent disk.</span></span>


### <a name="finalize-protection"></a><span data-ttu-id="40016-178">Finalizar proteção</span><span class="sxs-lookup"><span data-stu-id="40016-178">Finalize protection</span></span>

1. <span data-ttu-id="40016-179">Após a replicação inicial hello, hello **finalizar proteção na máquina virtual de saudação** trabalho configura rede e outras configurações depois da replicação, para que a máquina virtual hello está protegida.</span><span class="sxs-lookup"><span data-stu-id="40016-179">After hello initial replication finishes, hello **Finalize protection on hello virtual machine** job configures network and other post-replication settings, so that hello virtual machine is protected.</span></span>
    <span data-ttu-id="40016-180">![Finalizar trabalho de proteção](media/site-recovery-hyper-v-azure-architecture/image3.png)</span><span class="sxs-lookup"><span data-stu-id="40016-180">![Finalize protection job](media/site-recovery-hyper-v-azure-architecture/image3.png)</span></span>
2. <span data-ttu-id="40016-181">Se você estiver replicando tooAzure, você pode precisar de configurações de Olá tootweak para a máquina virtual de saudação para que ele está pronto para failover.</span><span class="sxs-lookup"><span data-stu-id="40016-181">If you're replicating tooAzure, you might need tootweak hello settings for hello virtual machine so that it's ready for failover.</span></span> <span data-ttu-id="40016-182">Neste ponto, você pode executar um toocheck de failover de teste que tudo está funcionando conforme o esperado.</span><span class="sxs-lookup"><span data-stu-id="40016-182">At this point you can run a test failover toocheck everything is working as expected.</span></span>

### <a name="delta-replication"></a><span data-ttu-id="40016-183">Replicação delta</span><span class="sxs-lookup"><span data-stu-id="40016-183">Delta replication</span></span>

1. <span data-ttu-id="40016-184">Após a replicação inicial hello, sincronização delta começa, de acordo com as configurações de replicação.</span><span class="sxs-lookup"><span data-stu-id="40016-184">After hello initial replication, delta synchronization begins, in accordance with replication settings.</span></span>
2. <span data-ttu-id="40016-185">Olá rastreador de replicação de réplica do Hyper-V controla Olá alterações tooa do disco rígido virtual como arquivos. hrl.</span><span class="sxs-lookup"><span data-stu-id="40016-185">hello Hyper-V Replica Replication Tracker tracks hello changes tooa virtual hard disk as .hrl files.</span></span> <span data-ttu-id="40016-186">Cada disco configurado para a replicação tem um arquivo .hrl associado.</span><span class="sxs-lookup"><span data-stu-id="40016-186">Each disk that's configured for replication has an associated .hrl file.</span></span> <span data-ttu-id="40016-187">Esse log é enviado a conta de armazenamento do cliente toohello após a conclusão da replicação inicial.</span><span class="sxs-lookup"><span data-stu-id="40016-187">This log is sent toohello customer's storage account after initial replication is complete.</span></span> <span data-ttu-id="40016-188">Quando um log está em trânsito tooAzure, as alterações de saudação no disco principal Olá são rastreadas em outro arquivo de log, em Olá mesmo diretório.</span><span class="sxs-lookup"><span data-stu-id="40016-188">When a log is in transit tooAzure, hello changes in hello primary disk are tracked in another log file, in hello same directory.</span></span>
3. <span data-ttu-id="40016-189">Durante a replicação inicial e delta, você pode monitorar Olá VM em Olá exibição VM.</span><span class="sxs-lookup"><span data-stu-id="40016-189">During initial and delta replication, you can monitor hello VM in hello VM view.</span></span> <span data-ttu-id="40016-190">[Saiba mais](site-recovery-monitoring-and-troubleshooting.md#monitor-replication-health-for-virtual-machines).</span><span class="sxs-lookup"><span data-stu-id="40016-190">[Learn more](site-recovery-monitoring-and-troubleshooting.md#monitor-replication-health-for-virtual-machines).</span></span>  

### <a name="replication-synchronization"></a><span data-ttu-id="40016-191">Sincronização de replicação</span><span class="sxs-lookup"><span data-stu-id="40016-191">Replication synchronization</span></span>

1. <span data-ttu-id="40016-192">Se a replicação delta falhar, e uma replicação completa for dispendiosa em termos de largura de banda ou tempo, a VM fica marcada para ressincronização.</span><span class="sxs-lookup"><span data-stu-id="40016-192">If delta replication fails, and a full replication would be costly in terms of bandwidth or time, then a VM is marked for resynchronization.</span></span> <span data-ttu-id="40016-193">Por exemplo, se hello. hrl arquivos cheguem ao 50% do tamanho do disco hello, em seguida, hello VM será marcada para ressincronização.</span><span class="sxs-lookup"><span data-stu-id="40016-193">For example, if hello .hrl files reach 50% of hello disk size, then hello VM will be marked for resynchronization.</span></span>
2.  <span data-ttu-id="40016-194">A ressincronização minimiza a quantidade de saudação dos dados enviados Calculando somas de verificação de máquinas de virtuais de origem e destino hello e enviar somente dados de delta hello.</span><span class="sxs-lookup"><span data-stu-id="40016-194">Resynchronization minimizes hello amount of data sent by computing checksums of hello source and target virtual machines, and sending only hello delta data.</span></span> <span data-ttu-id="40016-195">A ressincronização usa um algoritmo de agrupamento de bloco fixo em que os arquivos de origem e destino são divididos em partes fixas.</span><span class="sxs-lookup"><span data-stu-id="40016-195">Resynchronization uses a fixed-block chunking algorithm where source and target files are divided into fixed chunks.</span></span> <span data-ttu-id="40016-196">Somas de verificação para cada bloco são geradas e, em seguida, em comparação com toodetermine que bloqueia o hello origem necessidade toobe toohello aplicada destino.</span><span class="sxs-lookup"><span data-stu-id="40016-196">Checksums for each chunk are generated and then compared toodetermine which blocks from hello source need toobe applied toohello target.</span></span>
3. <span data-ttu-id="40016-197">Após a conclusão da ressincronização, a replicação delta normal deverá ser retomada.</span><span class="sxs-lookup"><span data-stu-id="40016-197">After resynchronization finishes, normal delta replication should resume.</span></span> <span data-ttu-id="40016-198">Por padrão, a ressincronização é agendado toorun automaticamente fora do expediente, mas você pode ressincronizar uma máquina virtual manualmente.</span><span class="sxs-lookup"><span data-stu-id="40016-198">By default resynchronization is scheduled toorun automatically outside office hours, but you can resynchronize a virtual machine manually.</span></span> <span data-ttu-id="40016-199">Por exemplo, se ocorrer uma interrupção da rede ou outra interrupção qualquer, você poderá retomar a ressincronização.</span><span class="sxs-lookup"><span data-stu-id="40016-199">For example, you can resume resynchronization if a network outage or another outage occurs.</span></span> <span data-ttu-id="40016-200">toodo isso, selecione Olá VM no portal de hello > **ressincronizar**.</span><span class="sxs-lookup"><span data-stu-id="40016-200">toodo this, select hello VM in hello portal > **Resynchronize**.</span></span>

    ![Ressincronização manual](media/site-recovery-hyper-v-azure-architecture/image4.png)


### <a name="retries"></a><span data-ttu-id="40016-202">Novas tentativas</span><span class="sxs-lookup"><span data-stu-id="40016-202">Retries</span></span>

<span data-ttu-id="40016-203">Se um erro de replicação ocorrer, haverá uma repetição interna.</span><span class="sxs-lookup"><span data-stu-id="40016-203">If a replication error occurs, there's a built-in retry.</span></span> <span data-ttu-id="40016-204">Ela pode ser classificada em duas categorias:</span><span class="sxs-lookup"><span data-stu-id="40016-204">This logic can be classified into two categories:</span></span>

<span data-ttu-id="40016-205">**Categoria**</span><span class="sxs-lookup"><span data-stu-id="40016-205">**Category**</span></span> | <span data-ttu-id="40016-206">**Detalhes**</span><span class="sxs-lookup"><span data-stu-id="40016-206">**Details**</span></span>
--- | ---
<span data-ttu-id="40016-207">**Erros não recuperáveis**</span><span class="sxs-lookup"><span data-stu-id="40016-207">**Non-recoverable errors**</span></span> | <span data-ttu-id="40016-208">Nenhuma nova tentativa é feita.</span><span class="sxs-lookup"><span data-stu-id="40016-208">No retry is attempted.</span></span> <span data-ttu-id="40016-209">O status da VM será **Crítico** e há necessidade de intervenção do administrador.</span><span class="sxs-lookup"><span data-stu-id="40016-209">VM status will be **Critical**, and administrator intervention is required.</span></span> <span data-ttu-id="40016-210">Exemplos desses erros: dividido cadeia VHD; Estado inválido para a réplica Olá VM; Erros de autenticação de rede: erros de autorização. VM não encontrou erros (para servidores do Hyper-V autônomo)</span><span class="sxs-lookup"><span data-stu-id="40016-210">Examples of these errors include: broken VHD chain; Invalid state for hello replica VM; Network authentication errors: authorization errors; VM not found errors (for standalone Hyper-V servers)</span></span>
<span data-ttu-id="40016-211">**Erros recuperáveis**</span><span class="sxs-lookup"><span data-stu-id="40016-211">**Recoverable errors**</span></span> | <span data-ttu-id="40016-212">Novas tentativas ocorrem a cada intervalo de replicação, usando uma retirada exponencial que aumenta o intervalo de repetição de saudação do início de saudação da primeira tentativa hello, 1, 2, 4, 8 e 10 minutos.</span><span class="sxs-lookup"><span data-stu-id="40016-212">Retries occur every replication interval, using an exponential back-off that increases hello retry interval from hello start of hello first attempt by 1, 2, 4, 8, and 10 minutes.</span></span> <span data-ttu-id="40016-213">Se o erro persistir, repita a operação a cada 30 minutos.</span><span class="sxs-lookup"><span data-stu-id="40016-213">If an error persists, retry every 30 minutes.</span></span> <span data-ttu-id="40016-214">Os exemplos incluem: erros da rede; erros de pouco espaço em disco; condições de memória insuficiente</span><span class="sxs-lookup"><span data-stu-id="40016-214">Examples include: network errors; low disk  errors; low memory conditions</span></span> |

## <a name="protection-and-recovery-lifecycle"></a><span data-ttu-id="40016-215">Proteção e ciclo de vida de recuperação</span><span class="sxs-lookup"><span data-stu-id="40016-215">Protection and recovery lifecycle</span></span>

![fluxo de trabalho](./media/site-recovery-components/arch-hyperv-azure-workflow.png)

## <a name="next-steps"></a><span data-ttu-id="40016-217">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="40016-217">Next steps</span></span>

- [<span data-ttu-id="40016-218">Verificar pré-requisitos da implantação</span><span class="sxs-lookup"><span data-stu-id="40016-218">Check deployment prerequisites</span></span>](site-recovery-prereq.md)
- <span data-ttu-id="40016-219">Solucionar problemas com:</span><span class="sxs-lookup"><span data-stu-id="40016-219">Troubleshoot with:</span></span>
    - [<span data-ttu-id="40016-220">Monitorar e solucionar problemas de proteção</span><span class="sxs-lookup"><span data-stu-id="40016-220">Monitor and troubleshoot protection</span></span>](site-recovery-monitoring-and-troubleshooting.md)
    - [<span data-ttu-id="40016-221">Ajuda do suporte da Microsoft</span><span class="sxs-lookup"><span data-stu-id="40016-221">Help from Microsoft support</span></span>](site-recovery-monitoring-and-troubleshooting.md#reach-out-for-microsoft-support)
    - [<span data-ttu-id="40016-222">Erros comuns e resoluções</span><span class="sxs-lookup"><span data-stu-id="40016-222">Common errors and resolutions</span></span>](site-recovery-monitoring-and-troubleshooting.md#common-azure-site-recovery-errors-and-their-resolutions)
