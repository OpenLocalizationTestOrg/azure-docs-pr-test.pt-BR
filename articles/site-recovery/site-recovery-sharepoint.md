---
title: "aaaReplicate um aplicativo do SharePoint de várias camado usando o Azure Site Recovery | Microsoft Docs"
description: "Este artigo descreve como tooreplicate um aplicativo do SharePoint de várias camado usando recursos do Azure Site Recovery."
services: site-recovery
documentationcenter: 
author: sujayt
manager: rochakm
editor: 
ms.assetid: 
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/10/2017
ms.author: sutalasi
ms.openlocfilehash: d856034ac2a3c95b0c1f0cf85e62c4e7a5a3210f
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="replicate-a-multi-tier-sharepoint-application-for-disaster-recovery-using-azure-site-recovery"></a><span data-ttu-id="d8aa8-103">Replicar um aplicativo do SharePoint de várias camadas para recuperação de desastre usando funcionalidades do Azure Site Recovery</span><span class="sxs-lookup"><span data-stu-id="d8aa8-103">Replicate a multi-tier SharePoint application for disaster recovery using Azure Site Recovery</span></span>

<span data-ttu-id="d8aa8-104">Este artigo descreve detalhadamente como tooprotect um aplicativo do SharePoint usando [do Azure Site Recovery](site-recovery-overview.md).</span><span class="sxs-lookup"><span data-stu-id="d8aa8-104">This article describes in detail how tooprotect a SharePoint application using  [Azure Site Recovery](site-recovery-overview.md).</span></span>


## <a name="overview"></a><span data-ttu-id="d8aa8-105">Visão geral</span><span class="sxs-lookup"><span data-stu-id="d8aa8-105">Overview</span></span>

<span data-ttu-id="d8aa8-106">O Microsoft SharePoint é um aplicativo avançado que pode ajudar um grupo ou departamento a organizar, colaborar com e compartilhar informações.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-106">Microsoft SharePoint is a powerful application that can help a group or department organize, collaborate, and share information.</span></span> <span data-ttu-id="d8aa8-107">O SharePoint pode fornecer portais de intranet, gerenciamento de arquivos e documentos, colaboração, redes sociais, extranets, sites, Enterprise Search e business intelligence.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-107">SharePoint can provide intranet portals, document and file management, collaboration, social networks, extranets, websites, enterprise search, and business intelligence.</span></span> <span data-ttu-id="d8aa8-108">Ele também tem integração de sistemas, integração de processos e funcionalidades de automação de fluxo de trabalho.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-108">It also has system integration, process integration, and workflow automation capabilities.</span></span> <span data-ttu-id="d8aa8-109">Normalmente, as organizações considerá-lo como uma nível 1 aplicativo confidencial toodowntime e perda de dados.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-109">Typically, organizations consider it as a Tier-1 application sensitive toodowntime and data loss.</span></span>

<span data-ttu-id="d8aa8-110">Hoje, o Microsoft SharePoint não fornece nenhuma funcionalidade integrada de recuperação de desastre.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-110">Today, Microsoft SharePoint  does not provide any out-of-the-box disaster recovery capabilities.</span></span> <span data-ttu-id="d8aa8-111">Independentemente do tipo hello e escala de um desastre, recuperação envolve o uso de saudação de um centro de dados em espera que você pode recuperar o farm de saudação.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-111">Regardless of hello type and scale of a disaster, recovery involves hello use of a standby data center that you can recover hello farm to.</span></span> <span data-ttu-id="d8aa8-112">Centros de dados em espera são necessários para cenários em que local sistemas redundantes e os backups não podem se recuperar interrupção Olá Olá data center primário.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-112">Standby data centers are required for scenarios where local redundant systems and backups cannot recover from hello outage at hello primary data center.</span></span>

<span data-ttu-id="d8aa8-113">Uma solução de recuperação de desastres BOM deve permitir que a modelagem de planos de recuperação nas arquiteturas de aplicativo complexo hello como o SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-113">A good disaster recovery solution should allow modeling of recovery plans around hello  complex application architectures such as SharePoint.</span></span> <span data-ttu-id="d8aa8-114">Ele também deve ter Olá capacidade tooadd personalizado etapas toohandle aplicativo mapeamentos entre várias camadas e, portanto, fornecendo um failover de clique simples com um RTO inferior no evento de saudação de um desastre.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-114">It should also have hello ability tooadd customized steps toohandle application mappings between various tiers and hence providing a single-click failover with a lower RTO in hello event of a disaster.</span></span>

<span data-ttu-id="d8aa8-115">Este artigo descreve detalhadamente como tooprotect um aplicativo do SharePoint usando [do Azure Site Recovery](site-recovery-overview.md).</span><span class="sxs-lookup"><span data-stu-id="d8aa8-115">This article describes in detail how tooprotect a SharePoint application using [Azure Site Recovery](site-recovery-overview.md).</span></span> <span data-ttu-id="d8aa8-116">Este artigo aborda as práticas recomendadas para replicar um tooAzure de aplicativo do SharePoint de três camadas, como você pode fazer uma simulação de recuperação de desastres e como você pode tooAzure de aplicativo de saudação do failover.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-116">This article will cover best practices for replicating a three tier SharePoint application tooAzure, how you can do a disaster recovery drill, and how you can failover hello application tooAzure.</span></span>

<span data-ttu-id="d8aa8-117">Você pode assistir Olá abaixo vídeo sobre como recuperar um tooAzure de aplicativo da camada várias.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-117">You can watch hello below video about recovering a multi tier application tooAzure.</span></span>

> [!VIDEO https://channel9.msdn.com/Series/Azure-Site-Recovery/Disaster-Recovery-of-load-balanced-multi-tier-applications-using-Azure-Site-Recovery/player]


## <a name="prerequisites"></a><span data-ttu-id="d8aa8-118">Pré-requisitos</span><span class="sxs-lookup"><span data-stu-id="d8aa8-118">Prerequisites</span></span>

<span data-ttu-id="d8aa8-119">Antes de começar, certifique-se de que compreender o seguinte hello:</span><span class="sxs-lookup"><span data-stu-id="d8aa8-119">Before you start, make sure you understand hello following:</span></span>

1. [<span data-ttu-id="d8aa8-120">Replicando tooAzure uma máquina virtual</span><span class="sxs-lookup"><span data-stu-id="d8aa8-120">Replicating a virtual machine tooAzure</span></span>](site-recovery-vmware-to-azure.md)
2. <span data-ttu-id="d8aa8-121">Como muito[criar uma rede de recuperação](site-recovery-network-design.md)</span><span class="sxs-lookup"><span data-stu-id="d8aa8-121">How too[design a recovery network](site-recovery-network-design.md)</span></span>
3. [<span data-ttu-id="d8aa8-122">Fazer um tooAzure de failover de teste</span><span class="sxs-lookup"><span data-stu-id="d8aa8-122">Doing a test failover tooAzure</span></span>](site-recovery-test-failover-to-azure.md)
4. [<span data-ttu-id="d8aa8-123">Fazer um failover tooAzure</span><span class="sxs-lookup"><span data-stu-id="d8aa8-123">Doing a failover tooAzure</span></span>](site-recovery-failover.md)
5. <span data-ttu-id="d8aa8-124">Como muito[replicar um controlador de domínio](site-recovery-active-directory.md)</span><span class="sxs-lookup"><span data-stu-id="d8aa8-124">How too[replicate a domain controller](site-recovery-active-directory.md)</span></span>
6. <span data-ttu-id="d8aa8-125">Como muito[replicar do SQL Server](site-recovery-sql.md)</span><span class="sxs-lookup"><span data-stu-id="d8aa8-125">How too[replicate SQL Server](site-recovery-sql.md)</span></span>

## <a name="sharepoint-architecture"></a><span data-ttu-id="d8aa8-126">Arquitetura do SharePoint</span><span class="sxs-lookup"><span data-stu-id="d8aa8-126">SharePoint architecture</span></span>

<span data-ttu-id="d8aa8-127">O SharePoint pode ser implantado em um ou mais servidores usando topologias em camadas e funções de servidor tooimplement um design de farm que atenda a metas e objetivos específicos.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-127">SharePoint can be deployed on one or more servers using tiered topologies and server roles tooimplement a farm design that meets specific goals and objectives.</span></span> <span data-ttu-id="d8aa8-128">Um farm grande e de alta demanda típico do SharePoint Server, que dá suporte a um grande número de usuários simultâneos e um grande número de itens de conteúdo usam o agrupamento de serviços como parte de sua estratégia de escalabilidade.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-128">A typical large, high-demand SharePoint server farm that supports a high number of concurrent users and a large number of content items use service grouping as part of their scalability strategy.</span></span> <span data-ttu-id="d8aa8-129">Essa abordagem envolve a execução de serviços em servidores dedicados, o agrupamento desses serviços e a expansão servidores hello como um grupo.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-129">This approach involves running services on dedicated servers, grouping these services together, and then scaling out hello servers as a group.</span></span> <span data-ttu-id="d8aa8-130">Olá topologia a seguir ilustra serviço hello e agrupamento para um farm de servidores do SharePoint de três camadas de servidores.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-130">hello following topology illustrates hello service and server grouping for a three tier SharePoint server farm.</span></span> <span data-ttu-id="d8aa8-131">Consulte tooSharePoint documentação e arquiteturas de linha de produto para obter orientações detalhadas sobre diferentes topologias de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-131">Please refer tooSharePoint documentation and product line architectures for detailed guidance on different SharePoint topologies.</span></span> <span data-ttu-id="d8aa8-132">Você pode encontrar mais detalhes sobre a implantação do SharePoint 2013 [neste documento](https://technet.microsoft.com/en-us/library/cc303422.aspx).</span><span class="sxs-lookup"><span data-stu-id="d8aa8-132">You can find more details about SharePoint 2013 deployment in [this document](https://technet.microsoft.com/en-us/library/cc303422.aspx).</span></span>



![Padrão de Implantação 1](./media/site-recovery-sharepoint/sharepointarch.png)


## <a name="site-recovery-support"></a><span data-ttu-id="d8aa8-134">Suporte do Site Recovery</span><span class="sxs-lookup"><span data-stu-id="d8aa8-134">Site Recovery support</span></span>

<span data-ttu-id="d8aa8-135">Para criar este artigo, usamos as máquinas virtuais VMware com o Windows Server 2012 R2 Enterprise.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-135">For creating this article, VMware virtual machines with Windows Server 2012 R2 Enterprise were used.</span></span> <span data-ttu-id="d8aa8-136">Foram usados o SharePoint 2013 Enterprise edition e o SQL Server 2014 Enterprise edition.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-136">SharePoint 2013 Enterprise edition and SQL server 2014 Enterprise edition were used.</span></span> <span data-ttu-id="d8aa8-137">Como a replicação de recuperação de Site é independente do aplicativo, fornecidas recomendações Olá aqui são toohold esperado para cenários a seguir também.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-137">As Site Recovery replication is application agnostic, hello recommendations provided here are expected toohold on for following scenarios as well.</span></span>

### <a name="source-and-target"></a><span data-ttu-id="d8aa8-138">Origem e destino</span><span class="sxs-lookup"><span data-stu-id="d8aa8-138">Source and target</span></span>

<span data-ttu-id="d8aa8-139">**Cenário**</span><span class="sxs-lookup"><span data-stu-id="d8aa8-139">**Scenario**</span></span> | <span data-ttu-id="d8aa8-140">**site secundário tooa**</span><span class="sxs-lookup"><span data-stu-id="d8aa8-140">**tooa secondary site**</span></span> | <span data-ttu-id="d8aa8-141">**tooAzure**</span><span class="sxs-lookup"><span data-stu-id="d8aa8-141">**tooAzure**</span></span>
--- | --- | ---
<span data-ttu-id="d8aa8-142">**Hyper-V**</span><span class="sxs-lookup"><span data-stu-id="d8aa8-142">**Hyper-V**</span></span> | <span data-ttu-id="d8aa8-143">Sim</span><span class="sxs-lookup"><span data-stu-id="d8aa8-143">Yes</span></span> | <span data-ttu-id="d8aa8-144">Sim</span><span class="sxs-lookup"><span data-stu-id="d8aa8-144">Yes</span></span>
<span data-ttu-id="d8aa8-145">**VMware**</span><span class="sxs-lookup"><span data-stu-id="d8aa8-145">**VMware**</span></span> | <span data-ttu-id="d8aa8-146">Sim</span><span class="sxs-lookup"><span data-stu-id="d8aa8-146">Yes</span></span> | <span data-ttu-id="d8aa8-147">Sim</span><span class="sxs-lookup"><span data-stu-id="d8aa8-147">Yes</span></span>
<span data-ttu-id="d8aa8-148">**Servidor físico**</span><span class="sxs-lookup"><span data-stu-id="d8aa8-148">**Physical server**</span></span> | <span data-ttu-id="d8aa8-149">Sim</span><span class="sxs-lookup"><span data-stu-id="d8aa8-149">Yes</span></span> | <span data-ttu-id="d8aa8-150">Sim</span><span class="sxs-lookup"><span data-stu-id="d8aa8-150">Yes</span></span>

### <a name="sharepoint-versions"></a><span data-ttu-id="d8aa8-151">Versões do SharePoint</span><span class="sxs-lookup"><span data-stu-id="d8aa8-151">SharePoint Versions</span></span>
<span data-ttu-id="d8aa8-152">Olá versões de servidor do SharePoint a seguir têm suporte.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-152">hello following SharePoint server versions are supported.</span></span>

* <span data-ttu-id="d8aa8-153">SharePoint Server 2013 Standard</span><span class="sxs-lookup"><span data-stu-id="d8aa8-153">SharePoint server 2013 Standard</span></span>
* <span data-ttu-id="d8aa8-154">SharePoint Server 2013 Enterprise</span><span class="sxs-lookup"><span data-stu-id="d8aa8-154">SharePoint server 2013 Enterprise</span></span>
* <span data-ttu-id="d8aa8-155">SharePoint Server 2016 Standard</span><span class="sxs-lookup"><span data-stu-id="d8aa8-155">SharePoint server 2016 Standard</span></span>
* <span data-ttu-id="d8aa8-156">SharePoint Server 2016 Enterprise</span><span class="sxs-lookup"><span data-stu-id="d8aa8-156">SharePoint server 2016 Enterprise</span></span>

### <a name="things-tookeep-in-mind"></a><span data-ttu-id="d8aa8-157">Tookeep coisas em mente</span><span class="sxs-lookup"><span data-stu-id="d8aa8-157">Things tookeep in mind</span></span>

<span data-ttu-id="d8aa8-158">Se você estiver usando um cluster compartilhado com base em disco em qualquer camada em seu aplicativo, você não poderá ser capaz de toouse tooreplicate de replicação de recuperação de Site essas máquinas virtuais.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-158">If you are using a shared disk-based cluster as any tier in your application then you will not be able toouse Site Recovery replication tooreplicate those virtual machines.</span></span> <span data-ttu-id="d8aa8-159">Você pode usar replicação nativa fornecida pelo aplicativo hello e, em seguida, usar um [plano de recuperação](site-recovery-create-recovery-plans.md) toofailover todas as camadas.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-159">You can use native replication provided by hello application and then use a [recovery plan](site-recovery-create-recovery-plans.md) toofailover all tiers.</span></span>

## <a name="replicating-virtual-machines"></a><span data-ttu-id="d8aa8-160">Replicação de máquinas virtuais</span><span class="sxs-lookup"><span data-stu-id="d8aa8-160">Replicating virtual machines</span></span>

<span data-ttu-id="d8aa8-161">Execute [neste guia](site-recovery-vmware-to-azure.md) toostart replicando Olá tooAzure de máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-161">Follow [this guidance](site-recovery-vmware-to-azure.md) toostart replicating hello virtual machine tooAzure.</span></span>

* <span data-ttu-id="d8aa8-162">Após a conclusão da replicação hello, certifique-se de ir tooeach máquina de virtual de cada camada e selecione o mesmo conjunto de disponibilidade no ' replicadas item > Configurações > Propriedades > de computação e de rede '.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-162">Once hello replication is complete, make sure you go tooeach virtual machine of each tier and select same availability set in 'Replicated item > Settings > Properties > Compute and Network'.</span></span> <span data-ttu-id="d8aa8-163">Por exemplo, se a camada da web tem 3 máquinas virtuais, certifique-se de saudação todos os 3 máquinas virtuais são configuradas toobe parte do mesmo conjunto de disponibilidade no Azure.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-163">For example, if your web tier has 3 VMs, ensure all hello 3 VMs are configured toobe part of same availability set in Azure.</span></span>

    ![Definir Conjunto de Disponibilidade](./media/site-recovery-sharepoint/select-av-set.png)

* <span data-ttu-id="d8aa8-165">Para obter orientação sobre como proteger o Active Directory e DNS, consulte muito[proteger o Active Directory e DNS](site-recovery-active-directory.md) documento.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-165">For guidance on protecting Active Directory and DNS, refer too[Protect Active Directory and DNS](site-recovery-active-directory.md) document.</span></span>

* <span data-ttu-id="d8aa8-166">Para obter orientações sobre a proteção da camada de banco de dados em execução no SQL server, consulte muito[proteger o SQL Server](site-recovery-active-directory.md) documento.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-166">For guidance on protecting database tier running on SQL server, refer too[Protect SQL Server](site-recovery-active-directory.md) document.</span></span>

## <a name="networking-configuration"></a><span data-ttu-id="d8aa8-167">Configuração de rede</span><span class="sxs-lookup"><span data-stu-id="d8aa8-167">Networking configuration</span></span>

### <a name="network-properties"></a><span data-ttu-id="d8aa8-168">Propriedades da rede</span><span class="sxs-lookup"><span data-stu-id="d8aa8-168">Network properties</span></span>

* <span data-ttu-id="d8aa8-169">Olá aplicativo e da camada de Web VMs, defina configurações de rede no portal do Azure para que VMs Olá toohello anexado à direita DR rede após o failover.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-169">For hello App and Web tier VMs, configure network settings in Azure portal so that hello VMs get attached toohello right DR network after failover.</span></span>

    ![Selecionar Rede](./media/site-recovery-sharepoint/select-network.png)


* <span data-ttu-id="d8aa8-171">Se você estiver usando um endereço IP estático, em seguida, especifique Olá IP que você deseja Olá tootake de máquina virtual em Olá **IP de destino** campo</span><span class="sxs-lookup"><span data-stu-id="d8aa8-171">If you are using a static IP, then specify hello IP that you want hello virtual machine tootake in hello **Target IP** field</span></span>

    ![Definir o IP Estático](./media/site-recovery-sharepoint/set-static-ip.png)

### <a name="dns-and-traffic-routing"></a><span data-ttu-id="d8aa8-173">Roteamento de Tráfego e de DNS</span><span class="sxs-lookup"><span data-stu-id="d8aa8-173">DNS and Traffic Routing</span></span>

<span data-ttu-id="d8aa8-174">Para sites da internet [criar um perfil do Gerenciador de tráfego do tipo 'Priority'](../traffic-manager/traffic-manager-create-profile.md) em Olá assinatura do Azure.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-174">For internet facing sites, [create a Traffic Manager profile of 'Priority' type](../traffic-manager/traffic-manager-create-profile.md) in hello Azure subscription.</span></span> <span data-ttu-id="d8aa8-175">E, em seguida, configurar seu perfil DNS e o Gerenciador de tráfego em Olá maneira a seguir.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-175">And then configure your DNS and Traffic Manager profile in hello following manner.</span></span>


| <span data-ttu-id="d8aa8-176">**Onde**</span><span class="sxs-lookup"><span data-stu-id="d8aa8-176">**Where**</span></span> | <span data-ttu-id="d8aa8-177">**Fonte**</span><span class="sxs-lookup"><span data-stu-id="d8aa8-177">**Source**</span></span> | <span data-ttu-id="d8aa8-178">**Destino**</span><span class="sxs-lookup"><span data-stu-id="d8aa8-178">**Target**</span></span>|
| --- | --- | --- |
| <span data-ttu-id="d8aa8-179">DNS público</span><span class="sxs-lookup"><span data-stu-id="d8aa8-179">Public DNS</span></span> | <span data-ttu-id="d8aa8-180">DNS público para sites do SharePoint</span><span class="sxs-lookup"><span data-stu-id="d8aa8-180">Public DNS for SharePoint sites</span></span> <br/><br/> <span data-ttu-id="d8aa8-181">Por exemplo: sharepoint.contoso.com</span><span class="sxs-lookup"><span data-stu-id="d8aa8-181">Ex: sharepoint.contoso.com</span></span> | <span data-ttu-id="d8aa8-182">Gerenciador de Tráfego</span><span class="sxs-lookup"><span data-stu-id="d8aa8-182">Traffic Manager</span></span> <br/><br/> <span data-ttu-id="d8aa8-183">contososharepoint.trafficmanager.net</span><span class="sxs-lookup"><span data-stu-id="d8aa8-183">contososharepoint.trafficmanager.net</span></span> |
| <span data-ttu-id="d8aa8-184">DNS local</span><span class="sxs-lookup"><span data-stu-id="d8aa8-184">On-premises DNS</span></span> | <span data-ttu-id="d8aa8-185">sharepointonprem.contoso.com</span><span class="sxs-lookup"><span data-stu-id="d8aa8-185">sharepointonprem.contoso.com</span></span> | <span data-ttu-id="d8aa8-186">IP público em Olá farm local</span><span class="sxs-lookup"><span data-stu-id="d8aa8-186">Public IP on hello on-premises farm</span></span> |


<span data-ttu-id="d8aa8-187">Em Olá perfil do Gerenciador de tráfego, [criar hello pontos de extremidade primário e de recuperação](../traffic-manager/traffic-manager-configure-priority-routing-method.md).</span><span class="sxs-lookup"><span data-stu-id="d8aa8-187">In hello Traffic Manager profile, [create hello primary and recovery endpoints](../traffic-manager/traffic-manager-configure-priority-routing-method.md).</span></span> <span data-ttu-id="d8aa8-188">Use ponto de extremidade externo Olá para o ponto de extremidade local e o IP público para o ponto de extremidade do Azure.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-188">Use hello external endpoint for on-premises endpoint and public IP for Azure endpoint.</span></span> <span data-ttu-id="d8aa8-189">Verifique se a prioridade de saudação é definida o ponto de extremidade superior tooon-local.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-189">Ensure that hello priority is set higher tooon-premises endpoint.</span></span>

<span data-ttu-id="d8aa8-190">Host de uma página de teste em uma porta específica (por exemplo, 800) na camada de web do SharePoint Olá para que o Traffic Manager tooautomatically detectar disponibilidade após failover.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-190">Host a test page on a specific port (for example, 800) in hello SharePoint web tier in order for Traffic Manager tooautomatically detect availability post failover.</span></span> <span data-ttu-id="d8aa8-191">Essa é uma solução alternativa caso você não possa habilitar a autenticação anônima em nenhum dos seus sites do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-191">This is a workaround in case you cannot enable anonymous authentication on any of your SharePoint sites.</span></span>

<span data-ttu-id="d8aa8-192">[Configurar o perfil do Gerenciador de tráfego Olá](../traffic-manager/traffic-manager-configure-priority-routing-method.md) com hello abaixo as configurações.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-192">[Configure hello Traffic Manager profile](../traffic-manager/traffic-manager-configure-priority-routing-method.md) with hello below settings.</span></span>

* <span data-ttu-id="d8aa8-193">Método de roteamento – 'Prioridade'</span><span class="sxs-lookup"><span data-stu-id="d8aa8-193">Routing method - 'Priority'</span></span>
* <span data-ttu-id="d8aa8-194">DNS tempo toolive (TTL) - 30 ' segundos'</span><span class="sxs-lookup"><span data-stu-id="d8aa8-194">DNS time toolive (TTL) - '30 seconds'</span></span>
* <span data-ttu-id="d8aa8-195">Configurações do monitor de ponto de extremidade – se você pode habilitar a autenticação anônima, pode também fornecer um ponto de extremidade de site específico.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-195">Endpoint monitor settings - If you can enable anonymous authentication, you can give a specific website endpoint.</span></span> <span data-ttu-id="d8aa8-196">Ou então, você pode usar uma página de teste em uma porta específica (por exemplo, 800).</span><span class="sxs-lookup"><span data-stu-id="d8aa8-196">Or, you can use a test page on a specific port (for example, 800).</span></span>

## <a name="creating-a-recovery-plan"></a><span data-ttu-id="d8aa8-197">Criar um plano de recuperação</span><span class="sxs-lookup"><span data-stu-id="d8aa8-197">Creating a recovery plan</span></span>

<span data-ttu-id="d8aa8-198">Um plano de recuperação permite sequenciamento Olá failover de várias camadas em um aplicativo de várias camada, assim, manter a consistência do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-198">A recovery plan allows sequencing hello failover of various tiers in a multi-tier application, hence, maintaining application consistency.</span></span> <span data-ttu-id="d8aa8-199">Siga Olá etapas a seguir ao criar um plano de recuperação para um aplicativo web de várias camadas.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-199">Follow hello below steps while creating a recovery plan for a multi-tier web application.</span></span> <span data-ttu-id="d8aa8-200">[Saiba mais sobre a criação de um plano de recuperação](site-recovery-runbook-automation.md#customize-the-recovery-plan).</span><span class="sxs-lookup"><span data-stu-id="d8aa8-200">[Learn more about creating a recovery plan](site-recovery-runbook-automation.md#customize-the-recovery-plan).</span></span>

### <a name="adding-virtual-machines-toofailover-groups"></a><span data-ttu-id="d8aa8-201">A adição de grupos de toofailover de máquinas virtuais</span><span class="sxs-lookup"><span data-stu-id="d8aa8-201">Adding virtual machines toofailover groups</span></span>

1. <span data-ttu-id="d8aa8-202">Crie um plano de recuperação adicionando Olá aplicativo e a camada da Web VMs.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-202">Create a recovery plan by adding hello App and Web tier VMs.</span></span>
2. <span data-ttu-id="d8aa8-203">Clique em 'Personalizar' toogroup Olá VMs.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-203">Click on 'Customize' toogroup hello VMs.</span></span> <span data-ttu-id="d8aa8-204">Por padrão, todas as VMs são parte do 'Grupo 1'.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-204">By default, all VMs are part of 'Group 1'.</span></span>

    ![Personalizar RP](./media/site-recovery-sharepoint/rp-groups.png)

3. <span data-ttu-id="d8aa8-206">Crie outro grupo (grupo 2) e mover a camada da Web de saudação VMs para Olá novo grupo.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-206">Create another Group (Group 2) and move hello Web tier VMs into hello new group.</span></span> <span data-ttu-id="d8aa8-207">Suas VMs de camada de aplicativo devem ser parte do 'Grupo 1' e as VMs de camada da Web devem ser parte do 'Grupo 2'.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-207">Your App tier VMs should be part of 'Group 1' and Web tier VMs should be part of 'Group 2'.</span></span> <span data-ttu-id="d8aa8-208">Isso é tooensure que Olá aplicativo da camada VMs inicializam primeiro, seguido por máquinas virtuais de camada da Web.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-208">This is tooensure that hello App tier VMs boot up first followed by Web tier VMs.</span></span>


### <a name="adding-scripts-toohello-recovery-plan"></a><span data-ttu-id="d8aa8-209">Adicionar plano de recuperação de toohello de scripts</span><span class="sxs-lookup"><span data-stu-id="d8aa8-209">Adding scripts toohello recovery plan</span></span>

<span data-ttu-id="d8aa8-210">Você pode implantar scripts do Azure Site Recovery hello mais comumente usada em sua conta de automação botão Olá 'Implantar tooAzure' abaixo.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-210">You can deploy hello most commonly used Azure Site Recovery scripts into your Automation account clicking hello 'Deploy tooAzure' button below.</span></span> <span data-ttu-id="d8aa8-211">Quando você estiver usando qualquer script publicado, certifique-se de que você seguir as orientações de saudação no script hello.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-211">When you are using any published script, ensure you follow hello guidance in hello script.</span></span>

<span data-ttu-id="d8aa8-212">[![Implantar tooAzure](https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/c4803408-340e-49e3-9a1f-0ed3f689813d.png)](https://aka.ms/asr-automationrunbooks-deploy)</span><span class="sxs-lookup"><span data-stu-id="d8aa8-212">[![Deploy tooAzure](https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/c4803408-340e-49e3-9a1f-0ed3f689813d.png)](https://aka.ms/asr-automationrunbooks-deploy)</span></span>

1. <span data-ttu-id="d8aa8-213">Adicione um script de pré-ação de too'Group 1' toofailover grupo de disponibilidade SQL.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-213">Add a pre-action script too'Group 1' toofailover SQL Availability group.</span></span> <span data-ttu-id="d8aa8-214">Use script de 'FailoverAG de SQL ASR' hello publicada em scripts de exemplo hello.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-214">Use hello 'ASR-SQL-FailoverAG' script published in hello sample scripts.</span></span> <span data-ttu-id="d8aa8-215">Certifique-se de seguir as orientações Olá no script hello e fazer alterações de saudação necessárias no script hello adequadamente.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-215">Ensure you follow hello guidance in hello script and make hello required changes in hello script appropriately.</span></span>

    ![Add-AG-Script-Step-1](./media/site-recovery-sharepoint/add-ag-script-step1.png)

    ![Add-AG-Script-Step-2](./media/site-recovery-sharepoint/add-ag-script-step2.png)

2. <span data-ttu-id="d8aa8-218">Adicione um tooattach de script de ação de postagem de um balanceador de carga Olá failover em máquinas virtuais da camada da Web (grupo 2).</span><span class="sxs-lookup"><span data-stu-id="d8aa8-218">Add a post action script tooattach a load balancer on hello failed over virtual machines of Web tier (Group 2).</span></span> <span data-ttu-id="d8aa8-219">Use script de 'ASR AddSingleLoadBalancer' hello publicada em scripts de exemplo hello.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-219">Use hello 'ASR-AddSingleLoadBalancer' script published in hello sample scripts.</span></span> <span data-ttu-id="d8aa8-220">Certifique-se de seguir as orientações Olá no script hello e fazer alterações de saudação necessárias no script hello adequadamente.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-220">Ensure you follow hello guidance in hello script and make hello required changes in hello script appropriately.</span></span>

    ![Add-LB-Script-Step-1](./media/site-recovery-sharepoint/add-lb-script-step1.png)

    ![Add-LB-Script-Step-2](./media/site-recovery-sharepoint/add-lb-script-step2.png)

3. <span data-ttu-id="d8aa8-223">Adicione um etapa manual tooupdate Olá DNS registros toopoint toohello novo farm no Azure.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-223">Add a manual step tooupdate hello DNS records toopoint toohello new farm in Azure.</span></span>

    * <span data-ttu-id="d8aa8-224">Para sites voltados para a Internet, não há atualizações DNS necessárias após o failover.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-224">For internet facing sites, no DNS updates are required post failover.</span></span> <span data-ttu-id="d8aa8-225">Execute as etapas de saudação descritas em tooconfigure de seção 'Diretrizes de rede' de saudação do Traffic Manager.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-225">Follow hello steps described in hello 'Networking guidance' section tooconfigure Traffic Manager.</span></span> <span data-ttu-id="d8aa8-226">Se Olá perfil do Traffic Manager foi configurado conforme descrito na seção anterior hello, adicione uma porta de fictício de tooopen (800 no exemplo hello) do script em Olá VM do Azure.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-226">If hello Traffic Manager profile has been set up as described in hello previous section, add a script tooopen dummy port (800 in hello example) on hello Azure VM.</span></span>

    * <span data-ttu-id="d8aa8-227">Para sites internos de opostas, adicione IP de Balanceador de carga de uma etapa manual tooupdate Olá DNS registro toopoint toohello novo Web da camada da VM.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-227">For internal facing sites, add a manual step tooupdate hello DNS record toopoint toohello new Web tier VM’s load balancer IP.</span></span>

4. <span data-ttu-id="d8aa8-228">Adicionar um aplicativo de pesquisa toorestore etapa manual de um backup ou iniciar um novo serviço de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-228">Add a manual step toorestore search application from a backup or start a new search service.</span></span>

5. <span data-ttu-id="d8aa8-229">Para restaurar o aplicativo de serviço de pesquisa de um backup, execute as etapas abaixo.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-229">For restoring Search service application from a backup, follow below steps.</span></span>

    * <span data-ttu-id="d8aa8-230">Esse método presume que foi feito um backup de aplicativo de serviço de pesquisa do hello antes do evento catastrófico hello e backup hello está disponível no site de saudação DR.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-230">This method assumes that a backup of hello Search Service Application was performed before hello catastrophic event and that hello backup is available at hello DR site.</span></span>
    * <span data-ttu-id="d8aa8-231">Isso pode ser obtido facilmente agendamento de backup de saudação (por exemplo, uma vez diariamente) e usando um backup de saudação de tooplace de procedimento de cópia no site Olá DR.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-231">This can easily be achieved by scheduling hello backup (for example, once daily) and using a copy procedure tooplace hello backup at hello DR site.</span></span> <span data-ttu-id="d8aa8-232">Os procedimentos de cópia podem incluir programas em script, como o AzCopy (Cópia do Azure) ou a configuração de DFSR (Serviços de Replicação de Arquivos Distribuído).</span><span class="sxs-lookup"><span data-stu-id="d8aa8-232">Copy procedures could include scripted programs such as AzCopy (Azure Copy) or setting up DFSR (Distributed File Services Replication).</span></span>
    * <span data-ttu-id="d8aa8-233">Agora que saudação do SharePoint farm estiver em execução, navegue Olá Administração Central, 'Backup e restauração' e selecione restaurar.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-233">Now that hello SharePoint farm is running, navigate hello Central Administration, 'Backup and Restore' and select Restore.</span></span> <span data-ttu-id="d8aa8-234">restauração Hello interroga local de backup Olá especificado (talvez seja necessário tooupdate valor de saudação).</span><span class="sxs-lookup"><span data-stu-id="d8aa8-234">hello restore interrogates hello backup location specified (you may need tooupdate hello value).</span></span> <span data-ttu-id="d8aa8-235">Selecione o backup de aplicativo de serviço de pesquisa de Olá você gostaria que toorestore.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-235">Select hello Search Service Application backup you would like toorestore.</span></span>
    * <span data-ttu-id="d8aa8-236">A pesquisa é restaurada.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-236">Search is restored.</span></span> <span data-ttu-id="d8aa8-237">Tenha em mente que Olá restauração espera toofind Olá mesmo topologia (mesmo número de servidores) e as mesmas rígido letras da unidade atribuídas toothose servidores.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-237">Keep in mind that hello restore expects toofind hello same topology (same number of servers) and same hard drive letters assigned toothose servers.</span></span> <span data-ttu-id="d8aa8-238">Para obter mais informações, consulte o documento ['Restaurar aplicativo de serviço de Pesquisa no SharePoint 2013'](https://technet.microsoft.com/library/ee748654.aspx).</span><span class="sxs-lookup"><span data-stu-id="d8aa8-238">For more information, see ['Restore Search service application in SharePoint 2013'](https://technet.microsoft.com/library/ee748654.aspx) document.</span></span>


6. <span data-ttu-id="d8aa8-239">Para iniciar com um novo aplicativo de serviço de Pesquisa, execute as etapas a seguir.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-239">For starting with a new Search service application, follow below steps.</span></span>

    * <span data-ttu-id="d8aa8-240">Este método assume que um backup de banco de dados de "Administração de pesquisa" hello está disponível no site de saudação DR.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-240">This method assumes that a backup of hello “Search Administration” database is available at hello DR site.</span></span>
    * <span data-ttu-id="d8aa8-241">Como hello outros bancos de dados do aplicativo de serviço de pesquisa não são replicados, eles precisam toobe criado novamente.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-241">Since hello other Search Service Application databases are not replicated, they need toobe re-created.</span></span> <span data-ttu-id="d8aa8-242">toodo, então, navegue tooCentral administração e excluir Olá aplicativo de serviço de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-242">toodo so, navigate tooCentral Administration and delete hello Search Service Application.</span></span> <span data-ttu-id="d8aa8-243">Em todos os servidores que Olá host índice de pesquisa, excluir arquivos de índice de saudação.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-243">On any servers which host hello Search Index, delete hello index files.</span></span>
    * <span data-ttu-id="d8aa8-244">Olá crie novamente o aplicativo de serviço de pesquisa e isso cria bancos de dados Olá novamente.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-244">Re-create hello Search Service Application and this re-creates hello databases.</span></span> <span data-ttu-id="d8aa8-245">É recomendável toohave um script preparado que recria este aplicativo de serviço porque não é possível tooperform todas as ações via Olá GUI.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-245">It is recommended toohave a prepared script that re-creates this service application since it is not possible tooperform all actions via hello GUI.</span></span> <span data-ttu-id="d8aa8-246">Por exemplo, o local da unidade índice hello e configuração de topologia de pesquisa de saudação são possível somente usando cmdlets do PowerShell do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-246">For example, setting hello index drive location and configuring hello search topology are only possible by using SharePoint PowerShell cmdlets.</span></span> <span data-ttu-id="d8aa8-247">Use o cmdlet do Windows PowerShell Olá SPEnterpriseSearchServiceApplication de restauração e especifique hello com envio de log e banco de dados de administração de pesquisa, Search_Service__DB replicado.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-247">Use hello Windows PowerShell cmdlet Restore-SPEnterpriseSearchServiceApplication and specify hello log-shipped and replicated Search Administration database, Search_Service__DB.</span></span> <span data-ttu-id="d8aa8-248">Esse cmdlet oferece a configuração de pesquisa hello, esquema, propriedades gerenciadas, regras e fontes e cria um conjunto padrão de saudação outros componentes.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-248">This cmdlet gives hello search configuration, schema, managed properties, rules, and sources and creates a default set of hello other components.</span></span>
    * <span data-ttu-id="d8aa8-249">Quando Olá que aplicativo de serviço de pesquisa tem ser recriados, você deve iniciar um rastreamento completo para cada Olá toorestore de fonte de conteúdo serviço de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-249">Once hello Search Service Application has be re-created, you must start a full crawl for each content source toorestore hello Search Service.</span></span> <span data-ttu-id="d8aa8-250">Você perder algumas informações de análise do farm local hello como recomendações de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-250">You lose some analytics information from hello on-premises farm, such as search recommendations.</span></span>

7. <span data-ttu-id="d8aa8-251">Depois que todas as etapas de saudação são concluídas, salvar o plano de recuperação de saudação e plano de recuperação final Olá será semelhante ao seguinte.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-251">Once all hello steps are completed, save hello recovery plan and hello final recovery plan will look like following.</span></span>

    ![RP Salvo](./media/site-recovery-sharepoint/saved-rp.png)

## <a name="doing-a-test-failover"></a><span data-ttu-id="d8aa8-253">Executar um failover de teste</span><span class="sxs-lookup"><span data-stu-id="d8aa8-253">Doing a test failover</span></span>
<span data-ttu-id="d8aa8-254">Execute [neste guia](site-recovery-test-failover-to-azure.md) toodo um failover de teste.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-254">Follow [this guidance](site-recovery-test-failover-to-azure.md) toodo a test failover.</span></span>

1.  <span data-ttu-id="d8aa8-255">Vá tooAzure portal e selecione seu Cofre de recuperação de serviço.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-255">Go tooAzure portal and select your Recovery Service vault.</span></span>
2.  <span data-ttu-id="d8aa8-256">Clique no plano de recuperação de saudação criado para o aplicativo do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-256">Click on hello recovery plan created for SharePoint application.</span></span>
3.  <span data-ttu-id="d8aa8-257">Clique em 'Failover de Teste'.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-257">Click on 'Test Failover'.</span></span>
4.  <span data-ttu-id="d8aa8-258">Selecione o ponto de recuperação e o processo de failover de teste do rede virtual do Azure toostart hello.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-258">Select recovery point and Azure virtual network toostart hello test failover process.</span></span>
5.  <span data-ttu-id="d8aa8-259">Após ambiente secundário hello, você pode executar a validação.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-259">Once hello secondary environment is up, you can perform your validations.</span></span>
6.  <span data-ttu-id="d8aa8-260">Depois que as validações de saudação estiverem concluídas, você pode clicar em 'Failover de teste de limpeza' no plano de recuperação hello e ambiente de failover de teste de saudação é limpo.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-260">Once hello validations are complete, you can click 'Cleanup test failover' on hello recovery plan and hello test failover environment is cleaned.</span></span>

<span data-ttu-id="d8aa8-261">Para obter orientação sobre como fazer o failover de teste para o AD e DNS, consulte muito[teste considerações de failover para o AD e DNS](site-recovery-active-directory.md#test-failover-considerations) documento.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-261">For guidance on doing test failover for AD and DNS, refer too[Test failover considerations for AD and DNS](site-recovery-active-directory.md#test-failover-considerations) document.</span></span>

<span data-ttu-id="d8aa8-262">Para obter orientações sobre como fazer o failover de teste para SQL sempre em grupos de disponibilidade, consulte muito[realizando teste de failover para o SQL Server Always On](site-recovery-sql.md#steps-to-do-a-test-failover) documento.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-262">For guidance on doing test failover for SQL Always ON availability groups, refer too[Doing Test failover for SQL Server Always On](site-recovery-sql.md#steps-to-do-a-test-failover) document.</span></span>

## <a name="doing-a-failover"></a><span data-ttu-id="d8aa8-263">Executar um failover</span><span class="sxs-lookup"><span data-stu-id="d8aa8-263">Doing a failover</span></span>
<span data-ttu-id="d8aa8-264">Siga [estas diretrizes](site-recovery-failover.md) para fazer um failover.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-264">Follow [this guidance](site-recovery-failover.md) for doing a failover.</span></span>

1.  <span data-ttu-id="d8aa8-265">Visite o portal tooAzure e selecione seu Cofre de serviços de recuperação.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-265">Go tooAzure portal and select your Recovery Services vault.</span></span>
2.  <span data-ttu-id="d8aa8-266">Clique no plano de recuperação de saudação criado para o aplicativo do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-266">Click on hello recovery plan created for SharePoint application.</span></span>
3.  <span data-ttu-id="d8aa8-267">Clique em 'Failover'.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-267">Click on 'Failover'.</span></span>
4.  <span data-ttu-id="d8aa8-268">Selecione o processo de failover de saudação de toostart de ponto de recuperação.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-268">Select recovery point toostart hello failover process.</span></span>

## <a name="next-steps"></a><span data-ttu-id="d8aa8-269">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="d8aa8-269">Next steps</span></span>
<span data-ttu-id="d8aa8-270">Você pode saber mais sobre [replicar outros aplicativos](site-recovery-workload.md) usando o Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="d8aa8-270">You can learn more about [replicating other applications](site-recovery-workload.md) using Site Recovery.</span></span>
