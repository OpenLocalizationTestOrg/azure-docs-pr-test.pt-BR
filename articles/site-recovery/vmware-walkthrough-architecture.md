---
title: "arquitetura de saudação aaaReview para VMware replicação tooAzure | Microsoft Docs"
description: "Este artigo fornece uma visão geral dos componentes e arquitetura usada ao replicar tooAzure de VMs VMware locais com hello serviço Azure Site Recovery"
services: site-recovery
documentationcenter: 
author: rayne-wiselman
manager: carmonm
editor: 
ms.assetid: c413efcd-d750-4b22-b34b-15bcaa03934a
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/27.017
ms.author: raynew
ms.openlocfilehash: 7acb1d8e83a846dca79e175fd1af9324f2c31e65
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="step-1-review-hello-architecture-for-vmware-replication-tooazure"></a><span data-ttu-id="3d71e-103">Etapa 1: Revisar arquitetura Olá para VMware tooAzure de replicação</span><span class="sxs-lookup"><span data-stu-id="3d71e-103">Step 1: Review hello architecture for VMware replication tooAzure</span></span>

<span data-ttu-id="3d71e-104">Este artigo descreve os componentes de saudação e processos usados quando a replicação local tooAzure de máquinas virtuais VMware usando Olá [do Azure Site Recovery](site-recovery-overview.md) serviço.</span><span class="sxs-lookup"><span data-stu-id="3d71e-104">This article describes hello components and processes used when replicating on-premises VMware virtual machines tooAzure using hello [Azure Site Recovery](site-recovery-overview.md) service.</span></span>

<span data-ttu-id="3d71e-105">Lançar os comentários na parte inferior da saudação deste artigo, ou fazer perguntas no hello [Fórum de serviços de recuperação do Azure](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span><span class="sxs-lookup"><span data-stu-id="3d71e-105">Post any comments at hello bottom of this article, or ask questions in hello [Azure Recovery Services Forum](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span></span>


## <a name="architectural-components"></a><span data-ttu-id="3d71e-106">Componentes de arquitetura</span><span class="sxs-lookup"><span data-stu-id="3d71e-106">Architectural components</span></span>

<span data-ttu-id="3d71e-107">tabela de saudação Resume componentes Olá que necessários.</span><span class="sxs-lookup"><span data-stu-id="3d71e-107">hello table summarizes hello components you need.</span></span>

<span data-ttu-id="3d71e-108">**Componente**</span><span class="sxs-lookup"><span data-stu-id="3d71e-108">**Component**</span></span> | <span data-ttu-id="3d71e-109">**Requisito**</span><span class="sxs-lookup"><span data-stu-id="3d71e-109">**Requirement**</span></span> | <span data-ttu-id="3d71e-110">**Detalhes**</span><span class="sxs-lookup"><span data-stu-id="3d71e-110">**Details**</span></span>
--- | --- | ---
<span data-ttu-id="3d71e-111">**As tabelas**</span><span class="sxs-lookup"><span data-stu-id="3d71e-111">**Azure**</span></span> | <span data-ttu-id="3d71e-112">Você precisa de uma assinatura do Azure, uma conta de armazenamento do Azure e uma rede do Azure.</span><span class="sxs-lookup"><span data-stu-id="3d71e-112">You need an Azure subscription, an Azure storage account, and an Azure network.</span></span> | <span data-ttu-id="3d71e-113">Dados replicados são armazenados na conta de armazenamento hello.</span><span class="sxs-lookup"><span data-stu-id="3d71e-113">Replicated data is stored in hello storage account.</span></span> <span data-ttu-id="3d71e-114">Máquinas virtuais do Azure são criados com dados replicado de saudação quando ocorrer failover do seu site local.</span><span class="sxs-lookup"><span data-stu-id="3d71e-114">Azure VMs are created with hello replicated data when failover from your on-premises site occurs.</span></span> <span data-ttu-id="3d71e-115">Olá VMs do Azure conectar toohello rede virtual do Azure quando eles são criados.</span><span class="sxs-lookup"><span data-stu-id="3d71e-115">hello Azure VMs connect toohello Azure virtual network when they're created.</span></span>
<span data-ttu-id="3d71e-116">**Servidor de configuração**</span><span class="sxs-lookup"><span data-stu-id="3d71e-116">**Configuration server**</span></span> | <span data-ttu-id="3d71e-117">Um único servidor de gerenciamento (VMware VM) que executa todos os Olá local componentes do Site Recovery para a implantação de saudação no local.</span><span class="sxs-lookup"><span data-stu-id="3d71e-117">A single on-premises management server (VMware VM) that runs all hello on-premises Site Recovery components for hello deployment.</span></span> <span data-ttu-id="3d71e-118">Isso inclui um servidor de configuração, um servidor em processo e um servidor de destino mestre.</span><span class="sxs-lookup"><span data-stu-id="3d71e-118">These include a configuration server, process server, master target server.</span></span> | <span data-ttu-id="3d71e-119">componente de servidor de configuração de saudação coordena as comunicações entre o local e o Azure e gerencia a replicação de dados.</span><span class="sxs-lookup"><span data-stu-id="3d71e-119">hello configuration server component coordinates communications between on-premises and Azure, and manages data replication.</span></span>
 <span data-ttu-id="3d71e-120">**Servidor de processo**:</span><span class="sxs-lookup"><span data-stu-id="3d71e-120">**Process server**:</span></span>  | <span data-ttu-id="3d71e-121">Instalado por padrão no servidor de configuração de saudação.</span><span class="sxs-lookup"><span data-stu-id="3d71e-121">Installed by default on hello configuration server.</span></span> | <span data-ttu-id="3d71e-122">Atua como um gateway de replicação.</span><span class="sxs-lookup"><span data-stu-id="3d71e-122">Acts as a replication gateway.</span></span> <span data-ttu-id="3d71e-123">Recebe dados de replicação, otimizá-lo com o cache, a compactação e criptografia e envia tooAzure armazenamento.</span><span class="sxs-lookup"><span data-stu-id="3d71e-123">Receives replication data, optimizes it with caching, compression, and encryption, and sends it tooAzure storage.</span></span><br/><br/> <span data-ttu-id="3d71e-124">servidor de processo Olá também lida com a instalação por push de máquinas de tooprotected de serviço de mobilidade hello e executa a descoberta automática de máquinas virtuais do VMware.</span><span class="sxs-lookup"><span data-stu-id="3d71e-124">hello process server also handles push installation of hello Mobility service tooprotected machines, and performs automatic discovery of VMware VMs.</span></span><br/><br/> <span data-ttu-id="3d71e-125">À medida que aumenta sua implantação, você pode adicionar mais processo dedicado separado servidores toohandle aumentar os volumes de tráfego de replicação.</span><span class="sxs-lookup"><span data-stu-id="3d71e-125">As your deployment grows you can add additional separate dedicated process servers toohandle increasing volumes of replication traffic.</span></span>
 <span data-ttu-id="3d71e-126">**Servidor de destino mestre**</span><span class="sxs-lookup"><span data-stu-id="3d71e-126">**Master target server**</span></span> | <span data-ttu-id="3d71e-127">Instalado por padrão no servidor de configuração local hello.</span><span class="sxs-lookup"><span data-stu-id="3d71e-127">Installed by default on hello on-premises configuration server.</span></span> | <span data-ttu-id="3d71e-128">Lida com os dados de replicação durante o failback do Azure.</span><span class="sxs-lookup"><span data-stu-id="3d71e-128">Handles replication data during failback from Azure.</span></span><br/><br/> <span data-ttu-id="3d71e-129">Se os volumes de tráfego de failback forem altos, você poderá implantar um servidor de destino mestre separado para failback.</span><span class="sxs-lookup"><span data-stu-id="3d71e-129">If volumes of failback traffic are high, you can deploy a separate master target server for failback.</span></span>
<span data-ttu-id="3d71e-130">**Servidores VMware**</span><span class="sxs-lookup"><span data-stu-id="3d71e-130">**VMware servers**</span></span> | <span data-ttu-id="3d71e-131">Máquinas virtuais do VMware são hospedadas em servidores de ESXi do vSphere, e é recomendável um vCenter hosts de saudação do servidor toomanage.</span><span class="sxs-lookup"><span data-stu-id="3d71e-131">VMware VMs are hosted on vSphere ESXi servers, and we recommend a vCenter server toomanage hello hosts.</span></span> | <span data-ttu-id="3d71e-132">Adicione o Cofre de serviços de recuperação de tooyour de servidores do VMware.</span><span class="sxs-lookup"><span data-stu-id="3d71e-132">You add VMware servers tooyour Recovery Services vault.</span></span>
<span data-ttu-id="3d71e-133">**Computadores replicados**</span><span class="sxs-lookup"><span data-stu-id="3d71e-133">**Replicated machines**</span></span> | <span data-ttu-id="3d71e-134">Olá serviço de mobilidade será instalado em cada VM VMware replicar.</span><span class="sxs-lookup"><span data-stu-id="3d71e-134">hello Mobility service will be installed on each VMware VM you replicate.</span></span> <span data-ttu-id="3d71e-135">Ele pode ser instalado manualmente em cada computador, ou com uma instalação por push saudação do servidor de processo.</span><span class="sxs-lookup"><span data-stu-id="3d71e-135">It can be installed manually on each machine, or with a push installation from hello process server.</span></span>

<span data-ttu-id="3d71e-136">**Figura 1: VMware tooAzure componentes**</span><span class="sxs-lookup"><span data-stu-id="3d71e-136">**Figure 1: VMware tooAzure components**</span></span>

![Componentes](./media/vmware-walkthrough-architecture/arch-enhanced.png)

## <a name="replication-process"></a><span data-ttu-id="3d71e-138">Processo de replicação</span><span class="sxs-lookup"><span data-stu-id="3d71e-138">Replication process</span></span>

1. <span data-ttu-id="3d71e-139">Configurar implantação hello, incluindo o local e os componentes do Azure.</span><span class="sxs-lookup"><span data-stu-id="3d71e-139">You set up hello deployment, including on-premises and Azure components.</span></span> <span data-ttu-id="3d71e-140">No cofre de serviços de recuperação hello, você pode especificar origem da replicação hello e destino, configurar o servidor de configuração de hello, criar uma política de replicação, implantar o serviço de mobilidade hello, habilitar a replicação e executar um failover de teste.</span><span class="sxs-lookup"><span data-stu-id="3d71e-140">In hello Recovery Services vault, you specify hello replication source and target, set up hello configuration server, create a replication policy, deploy hello Mobility service, enable replication, and run a test failover.</span></span>
2. <span data-ttu-id="3d71e-141">Replicar máquinas acordo com a política de replicação hello e uma cópia inicial dos dados de saudação é replicado tooAzure de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="3d71e-141">Machines replicate in accordance with hello replication policy, and an initial copy of hello data is replicated tooAzure storage.</span></span>
3. <span data-ttu-id="3d71e-142">Após a conclusão da replicação inicial, a replicação delta alterações tooAzure começa.</span><span class="sxs-lookup"><span data-stu-id="3d71e-142">After initial replication finishes, replication of delta changes tooAzure begins.</span></span> <span data-ttu-id="3d71e-143">As alterações acompanhadas para uma máquina são mantidas em um arquivo .hrl.</span><span class="sxs-lookup"><span data-stu-id="3d71e-143">Tracked changes for a machine are held in a .hrl file.</span></span>
    - <span data-ttu-id="3d71e-144">Replicadas máquinas se comunicar com servidor de configuração de saudação na porta HTTPS 443 entrada para o gerenciamento de replicação.</span><span class="sxs-lookup"><span data-stu-id="3d71e-144">Replicating machines communicate with hello configuration server on port HTTPS 443 inbound, for replication management.</span></span>
    - <span data-ttu-id="3d71e-145">Replicadas máquinas enviam servidor de processo de toohello de dados de replicação na porta HTTPS 9443 entrada (pode ser modificada).</span><span class="sxs-lookup"><span data-stu-id="3d71e-145">Replicating machines send replication data toohello process server on port HTTPS 9443 inbound (can be modified).</span></span>
    - <span data-ttu-id="3d71e-146">servidor de configuração de saudação orquestra o gerenciamento de replicação com o Azure através da porta HTTPS 443 de saída.</span><span class="sxs-lookup"><span data-stu-id="3d71e-146">hello configuration server orchestrates replication management with Azure over port HTTPS 443 outbound.</span></span>
    - <span data-ttu-id="3d71e-147">servidor de processo Olá recebe dados de máquinas de origem, otimiza criptografa e envia tooAzure armazenamento pela porta 443 saída.</span><span class="sxs-lookup"><span data-stu-id="3d71e-147">hello process server receives data from source machines, optimizes and encrypts it, and sends it tooAzure storage over port 443 outbound.</span></span>
    - <span data-ttu-id="3d71e-148">Se você habilitar a consistência de várias VMs, em seguida, máquinas no grupo de replicação Olá comunicam entre si pela porta 20004.</span><span class="sxs-lookup"><span data-stu-id="3d71e-148">If you enable multi-VM consistency, then machines in hello replication group communicate with each other over port 20004.</span></span> <span data-ttu-id="3d71e-149">Várias VMS serão usadas se você agrupar vários computadores em grupos de replicação que compartilham pontos de recuperação consistentes com o aplicativo e com falhas ao realizar o failover.</span><span class="sxs-lookup"><span data-stu-id="3d71e-149">Multi-VM is used if you group multiple machines into replication groups that share crash-consistent and app-consistent recovery points when they fail over.</span></span> <span data-ttu-id="3d71e-150">Isso é útil se estiver executando máquinas Olá a mesma carga de trabalho e precisam toobe consistente.</span><span class="sxs-lookup"><span data-stu-id="3d71e-150">This is useful if machines are running hello same workload and need toobe consistent.</span></span>
4. <span data-ttu-id="3d71e-151">O tráfego é replicado tooAzure armazenamento pontos de extremidade públicos, mais Olá da internet.</span><span class="sxs-lookup"><span data-stu-id="3d71e-151">Traffic is replicated tooAzure storage public endpoints, over hello internet.</span></span> <span data-ttu-id="3d71e-152">Como alternativa, você pode usar o [emparelhamento público](../expressroute/expressroute-circuit-peerings.md#public-peering) do Azure ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="3d71e-152">Alternately, you can use Azure ExpressRoute [public peering](../expressroute/expressroute-circuit-peerings.md#public-peering).</span></span> <span data-ttu-id="3d71e-153">Replicação do tráfego por uma VPN site a site de um tooAzure de site local não tem suporte.</span><span class="sxs-lookup"><span data-stu-id="3d71e-153">Replicating traffic over a site-to-site VPN from an on-premises site tooAzure isn't supported.</span></span>


<span data-ttu-id="3d71e-154">**Figura 2: VMware tooAzure replicação**</span><span class="sxs-lookup"><span data-stu-id="3d71e-154">**Figure 2: VMware tooAzure replication**</span></span>

![Avançado](./media/vmware-walkthrough-architecture/v2a-architecture-henry.png)

## <a name="failover-and-failback-process"></a><span data-ttu-id="3d71e-156">Processo de failover e failback</span><span class="sxs-lookup"><span data-stu-id="3d71e-156">Failover and failback process</span></span>

1. <span data-ttu-id="3d71e-157">Depois de verificar que se o failover de teste está funcionando como esperado, você pode executar failovers não planejados tooAzure conforme necessário.</span><span class="sxs-lookup"><span data-stu-id="3d71e-157">After you verify that test failover is working as expected, you can run unplanned failovers tooAzure as required.</span></span> <span data-ttu-id="3d71e-158">Não há suporte para failover planejado.</span><span class="sxs-lookup"><span data-stu-id="3d71e-158">Planned failover isn't supported.</span></span>
2. <span data-ttu-id="3d71e-159">Você pode fazer o failover de um único computador ou criar [planos de recuperação](site-recovery-create-recovery-plans.md), toofail entre várias VMs.</span><span class="sxs-lookup"><span data-stu-id="3d71e-159">You can fail over a single machine, or create [recovery plans](site-recovery-create-recovery-plans.md), toofail over multiple VMs.</span></span>
3. <span data-ttu-id="3d71e-160">Ao executar um failover, VMs de réplica são criadas no Azure.</span><span class="sxs-lookup"><span data-stu-id="3d71e-160">When you run a failover, replica VMs are created in Azure.</span></span> <span data-ttu-id="3d71e-161">Você pode confirmar uma failover toostart acessando Olá carga de trabalho da réplica Olá VM do Azure.</span><span class="sxs-lookup"><span data-stu-id="3d71e-161">You commit a failover toostart accessing hello workload from hello replica Azure VM.</span></span>
4. <span data-ttu-id="3d71e-162">Quando o site primário local estiver disponível novamente, você poderá executar o failback.</span><span class="sxs-lookup"><span data-stu-id="3d71e-162">When your primary on-premises site is available again, you can fail back.</span></span> <span data-ttu-id="3d71e-163">Configurar uma infra-estrutura de failback, iniciar a replicação de máquina de saudação do hello site secundário toohello primário e executar um failover não planejado do site secundário hello.</span><span class="sxs-lookup"><span data-stu-id="3d71e-163">You set up a failback infrastructure, start replicating hello machine from hello secondary site toohello primary, and run an unplanned failover from hello secondary site.</span></span> <span data-ttu-id="3d71e-164">Após você confirmar esse failover, dados serão back local e você precisa tooenable replicação tooAzure novamente.</span><span class="sxs-lookup"><span data-stu-id="3d71e-164">After you commit this failover, data will be back on-premises, and you need tooenable replication tooAzure again.</span></span> [<span data-ttu-id="3d71e-165">Saiba mais</span><span class="sxs-lookup"><span data-stu-id="3d71e-165">Learn more</span></span>](site-recovery-failback-azure-to-vmware.md)

<span data-ttu-id="3d71e-166">Há alguns requisitos de failback:</span><span class="sxs-lookup"><span data-stu-id="3d71e-166">There are a few failback requirements:</span></span>


- <span data-ttu-id="3d71e-167">**Servidor de processo temporário no Azure**: se você quiser toofail do Azure após o failover, você precisará tooset a uma VM do Azure configurado como um servidor de processo, a replicação toohandle do Azure.</span><span class="sxs-lookup"><span data-stu-id="3d71e-167">**Temporary process server in Azure**: If you want toofail back from Azure after failover you'll need tooset up an Azure VM configured as a process server, toohandle replication from Azure.</span></span> <span data-ttu-id="3d71e-168">Você pode excluir a VM após a conclusão do failback.</span><span class="sxs-lookup"><span data-stu-id="3d71e-168">You can delete this VM after failback finishes.</span></span>
- <span data-ttu-id="3d71e-169">**Conexão VPN**: para failback, você precisará de uma conexão VPN (ou rota expressa do Azure) configurar de saudação do Azure rede toohello no site local.</span><span class="sxs-lookup"><span data-stu-id="3d71e-169">**VPN connection**: For failback you'll need a VPN connection (or Azure ExpressRoute) set up from hello Azure network toohello on-premises site.</span></span>
- <span data-ttu-id="3d71e-170">**O servidor de destino mestre local separado**: servidor de destino mestre local Olá manipula failback.</span><span class="sxs-lookup"><span data-stu-id="3d71e-170">**Separate on-premises master target server**: hello on-premises master target server handles failback.</span></span> <span data-ttu-id="3d71e-171">o servidor de destino mestre Olá é instalado por padrão no servidor de gerenciamento hello, mas se você estiver falhando volta maiores volumes de tráfego de você deve configurar um servidor de destino mestre local separado para essa finalidade.</span><span class="sxs-lookup"><span data-stu-id="3d71e-171">hello master target server is installed by default on hello management server, but if you're failing back larger volumes of traffic you should set up a separate on-premises master target server for this purpose.</span></span>
- <span data-ttu-id="3d71e-172">**Diretiva de failback**: tooyour back tooreplicate site local, você precisará de uma política de failback.</span><span class="sxs-lookup"><span data-stu-id="3d71e-172">**Failback policy**: tooreplicate back tooyour on-premises site, you need a failback policy.</span></span> <span data-ttu-id="3d71e-173">Isso é criado automaticamente quando você cria sua política de replicação.</span><span class="sxs-lookup"><span data-stu-id="3d71e-173">This is automatically created when you created your replication policy.</span></span>
- <span data-ttu-id="3d71e-174">**O VMware infrastructure**: você deve realizar failback tooan de VM do VMware no local.</span><span class="sxs-lookup"><span data-stu-id="3d71e-174">**VMware infrastructure**: You must fail back tooan on-premises VMware VM.</span></span> <span data-ttu-id="3d71e-175">Isso significa que você precisa de uma infra-estrutura de VMware no local, mesmo se você estiver replicando tooAzure de servidores físicos no local.</span><span class="sxs-lookup"><span data-stu-id="3d71e-175">This means you need an on-premises VMware infrastructure, even if you're replicating on-premises physical servers tooAzure.</span></span>

<span data-ttu-id="3d71e-176">**Figura 3: failback físico/de VMware**</span><span class="sxs-lookup"><span data-stu-id="3d71e-176">**Figure 3: VMware/physical failback**</span></span>

![Failback](./media/vmware-walkthrough-architecture/enhanced-failback.png)


## <a name="next-steps"></a><span data-ttu-id="3d71e-178">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="3d71e-178">Next steps</span></span>

<span data-ttu-id="3d71e-179">Vá muito[etapa 2: verificar os pré-requisitos e limitações](vmware-walkthrough-prerequisites.md)</span><span class="sxs-lookup"><span data-stu-id="3d71e-179">Go too[Step 2: Verify prerequisites and limitations](vmware-walkthrough-prerequisites.md)</span></span>
