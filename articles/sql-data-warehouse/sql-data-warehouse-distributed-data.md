---
title: "Como os dados distribuídos funcionam no SQL Data Warehouse do Azure | Microsoft Docs"
description: "Saiba como os dados são distribuídos para MPP (Processamento Paralelo Maciço) e as opções de distribuição tabelas no SQL Data Warehouse do Azure e Parallel Data Warehouse."
services: sql-data-warehouse
documentationcenter: NA
author: jrowlandjones
manager: jhubbard
editor: 
ms.assetid: bae494a6-7ac5-4c38-8ca3-ab2696c63a9f
ms.service: sql-data-warehouse
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: data-services
ms.custom: tables
ms.date: 07/12/2017
ms.author: jrj;barbkess
ms.openlocfilehash: 3c166acb17193caae32d7bad133ec510ff679353
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/03/2017
---
# <a name="distributed-data-and-distributed-tables-for-massively-parallel-processing-mpp"></a><span data-ttu-id="793e9-103">Dados distribuídos e tabelas distribuídas para MPP (Processamento Paralelo Maciço)</span><span class="sxs-lookup"><span data-stu-id="793e9-103">Distributed data and distributed tables for Massively Parallel Processing (MPP)</span></span>
<span data-ttu-id="793e9-104">Saiba como os dados do usuário são distribuídos no SQL Data Warehouse do Azure e Parallel Data Warehouse, que são os sistemas de MPP (Processamento Paralelo Maciço) da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="793e9-104">Learn how user data is distributed in Azure SQL Data Warehouse and Parallel Data Warehouse, which are Microsoft's Massively Parallel Processing (MPP) systems.</span></span> <span data-ttu-id="793e9-105">Criar seu data warehouse para usar dados distribuídos efetivamente ajuda a obter a benefícios de processamento de consulta da arquitetura MPP.</span><span class="sxs-lookup"><span data-stu-id="793e9-105">Designing your data warehouse to use distributed data effectively helps you to achieve the query processing benefits of the MPP architecture.</span></span> <span data-ttu-id="793e9-106">Algumas opções de design de banco de dados podem ter um impacto significativo sobre como melhorar o desempenho da consulta.</span><span class="sxs-lookup"><span data-stu-id="793e9-106">A few database design choices can have a significant impact on improving query performance.</span></span>  

> [!NOTE]
> <span data-ttu-id="793e9-107">O SQL Data Warehouse do Azure e o Parallel Data Warehouse usam o mesmo design MPP (Processamento Paralelo Maciço), mas eles têm algumas diferenças devido à plataforma subjacente.</span><span class="sxs-lookup"><span data-stu-id="793e9-107">Azure SQL Data Warehouse and Parallel Data Warehouse use the same Massively Parallel Processing (MPP) design, but they have a few differences because of the underlying platform.</span></span> <span data-ttu-id="793e9-108">O SQL Data Warehouse é uma PaaS (plataforma como serviço) executada no Azure.</span><span class="sxs-lookup"><span data-stu-id="793e9-108">SQL Data Warehouse is a Platform as a Service (PaaS) that runs on Azure.</span></span> <span data-ttu-id="793e9-109">Parallel Data Warehouse é executado no APS (sistema de Plataforma de Análise), que é um dispositivo local executado no Windows Server.</span><span class="sxs-lookup"><span data-stu-id="793e9-109">Parallel Data Warehouse runs on Analytics Platform System (APS) which is an on-premises appliance that runs on Windows Server.</span></span>
> 
> 

## <a name="what-is-distributed-data"></a><span data-ttu-id="793e9-110">O que são dados distribuídos?</span><span class="sxs-lookup"><span data-stu-id="793e9-110">What is distributed data?</span></span>
<span data-ttu-id="793e9-111">No SQL Data Warehouse e Parallel Data Warehouse, dados distribuídos refere-se a dados de usuário armazenados em vários locais em todo o sistema MPP.</span><span class="sxs-lookup"><span data-stu-id="793e9-111">In SQL Data Warehouse and Parallel Data Warehouse, distributed data refers to user data that is stored in multiple locations across the MPP system.</span></span> <span data-ttu-id="793e9-112">Cada um desses locais funciona como um armazenamento independente e a unidade de processamento que executa consultas em sua parte dos dados.</span><span class="sxs-lookup"><span data-stu-id="793e9-112">Each of those locations functions as an independent storage and processing unit that runs queries on its portion of the data.</span></span> <span data-ttu-id="793e9-113">Dados distribuídos são fundamentais para a execução de consultas em paralelo para alcançar o alto desempenho de consulta.</span><span class="sxs-lookup"><span data-stu-id="793e9-113">Distributed data is fundamental to running queries in parallel to achieve high query performance.</span></span>

<span data-ttu-id="793e9-114">Para distribuir os dados, o data warehouse atribui cada linha de uma tabela de usuário para um local distribuído.</span><span class="sxs-lookup"><span data-stu-id="793e9-114">To distribute data, the data warehouse assigns each row of a user table to one distributed location.</span></span>  <span data-ttu-id="793e9-115">Você pode distribuir tabelas com um método de distribuição de hash ou um método round robin.</span><span class="sxs-lookup"><span data-stu-id="793e9-115">You can distribute tables with a hash-distribution method or a round-robin method.</span></span> <span data-ttu-id="793e9-116">O método de distribuição é especificado na instrução CREATE TABLE.</span><span class="sxs-lookup"><span data-stu-id="793e9-116">The distribution method is specified in the CREATE TABLE statement.</span></span> 

## <a name="hash-distributed-tables"></a><span data-ttu-id="793e9-117">Tabelas distribuídas em hash</span><span class="sxs-lookup"><span data-stu-id="793e9-117">Hash-distributed tables</span></span>
<span data-ttu-id="793e9-118">O diagrama a seguir ilustra como uma (tabela não distribuída) completa é armazenada como uma tabela distribuída em hash.</span><span class="sxs-lookup"><span data-stu-id="793e9-118">The following diagram illustrates how a full (non-distributed table) gets stored as a hash-distributed table.</span></span> <span data-ttu-id="793e9-119">Uma função determinística atribui cada linha para pertencer a uma distribuição.</span><span class="sxs-lookup"><span data-stu-id="793e9-119">A deterministic function assigns each row to belong to one distribution.</span></span> <span data-ttu-id="793e9-120">Na definição de tabela, uma das colunas é designada como a coluna de distribuição.</span><span class="sxs-lookup"><span data-stu-id="793e9-120">In the table definition, one of the columns is designated as the distribution column.</span></span> <span data-ttu-id="793e9-121">A função de hash usa o valor na coluna de distribuição para atribuir cada linha a uma distribuição.</span><span class="sxs-lookup"><span data-stu-id="793e9-121">The hash function uses the value in the distribution column to assign each row to a distribution.</span></span>

<span data-ttu-id="793e9-122">Há considerações de desempenho para a seleção de uma coluna de distribuição, como distinção, distorção de dados e tipos de consultas executadas no sistema.</span><span class="sxs-lookup"><span data-stu-id="793e9-122">There are performance considerations for the selection of a distribution column, such as distinctness, data skew, and the types of queries run on the system.</span></span>

<span data-ttu-id="793e9-123">![Tabela distribuída](media/sql-data-warehouse-distributed-data/hash-distributed-table.png "Tabela distribuída")</span><span class="sxs-lookup"><span data-stu-id="793e9-123">![Distributed table](media/sql-data-warehouse-distributed-data/hash-distributed-table.png "Distributed table")</span></span>  

* <span data-ttu-id="793e9-124">Cada linha pertence a uma distribuição.</span><span class="sxs-lookup"><span data-stu-id="793e9-124">Each row belongs to one distribution.</span></span>  
* <span data-ttu-id="793e9-125">Um algoritmo de hash determinístico atribui cada linha a uma distribuição.</span><span class="sxs-lookup"><span data-stu-id="793e9-125">A deterministic hash algorithm assigns each row to one distribution.</span></span>  
* <span data-ttu-id="793e9-126">O número de linhas de tabela por distribuição varia conforme mostrado pelos diferentes tamanhos de tabelas.</span><span class="sxs-lookup"><span data-stu-id="793e9-126">The number of table rows per distribution varies as shown by the different sizes of tables.</span></span>

## <a name="round-robin-distributed-tables"></a><span data-ttu-id="793e9-127">Tabelas distribuídas round robin</span><span class="sxs-lookup"><span data-stu-id="793e9-127">Round-robin distributed tables</span></span>
<span data-ttu-id="793e9-128">Uma tabela distribuída round robin distribui as linhas atribuindo a cada linha uma distribuição de forma sequencial.</span><span class="sxs-lookup"><span data-stu-id="793e9-128">A round-robin distributed table distributes the rows by assigning each row to a distribution in a sequential manner.</span></span> <span data-ttu-id="793e9-129">É rápido carregar dados em uma tabela round robin, mas o desempenho de consulta pode ser mais lento.</span><span class="sxs-lookup"><span data-stu-id="793e9-129">It is quick to load data into a round-robin table, but query performance might be slower.</span></span>  <span data-ttu-id="793e9-130">Ingressar em uma tabela de round robin normalmente requer recombinar as linhas para habilitar a consulta a produzir um resultado preciso, o que leva tempo.</span><span class="sxs-lookup"><span data-stu-id="793e9-130">Joining a round-robin table usually requires reshuffling the rows to enable the query to produce an accurate result, which takes time.</span></span>

## <a name="distributed-storage-locations-are-called-distributions"></a><span data-ttu-id="793e9-131">Locais de armazenamento distribuído são chamados de distribuições</span><span class="sxs-lookup"><span data-stu-id="793e9-131">Distributed storage locations are called distributions</span></span>
<span data-ttu-id="793e9-132">Cada local distribuído é chamado de distribuição.</span><span class="sxs-lookup"><span data-stu-id="793e9-132">Each distributed location is called a distribution.</span></span> <span data-ttu-id="793e9-133">Quando uma consulta é executada em paralelo, cada distribuição executa uma consulta SQL em sua parte dos dados.</span><span class="sxs-lookup"><span data-stu-id="793e9-133">When a query runs in parallel, each distribution performs a SQL query on its portion of the data.</span></span> <span data-ttu-id="793e9-134">SQL Data Warehouse usa um Banco de Dados SQL para executar a consulta.</span><span class="sxs-lookup"><span data-stu-id="793e9-134">SQL Data Warehouse uses SQL Database to run the query.</span></span> <span data-ttu-id="793e9-135">Parallel Data Warehouse usa o SQL Server para executar a consulta.</span><span class="sxs-lookup"><span data-stu-id="793e9-135">Parallel Data Warehouse uses SQL Server to run the query.</span></span> <span data-ttu-id="793e9-136">Esse design de arquitetura de nada compartilhado é fundamental para alcançar a computação paralela em escala horizontal.</span><span class="sxs-lookup"><span data-stu-id="793e9-136">This shared-nothing architecture design is fundamental to achieving scale-out parallel computing.</span></span>

### <a name="can-i-view-the-distributions"></a><span data-ttu-id="793e9-137">Posso exibir as distribuições?</span><span class="sxs-lookup"><span data-stu-id="793e9-137">Can I view the distributions?</span></span>
<span data-ttu-id="793e9-138">Cada distribuição tem uma ID de distribuição e está visível nas exibições do sistema que pertencem ao SQL Data Warehouse e ao Parallel Data Warehouse.</span><span class="sxs-lookup"><span data-stu-id="793e9-138">Each distribution has a distribution ID and is visible in system views that pertain to SQL Data Warehouse and Parallel Data Warehouse.</span></span> <span data-ttu-id="793e9-139">Você pode usar a ID de distribuição para solucionar problemas de desempenho da consulta e outros problemas.</span><span class="sxs-lookup"><span data-stu-id="793e9-139">You can use the distribution ID to troubleshoot query performance and other problems.</span></span> <span data-ttu-id="793e9-140">Para obter uma lista das exibições de sistema, consulte [Exibição do sistema MPP](sql-data-warehouse-reference-tsql-statements.md).</span><span class="sxs-lookup"><span data-stu-id="793e9-140">For a list of the system views, see the [MPP system view](sql-data-warehouse-reference-tsql-statements.md).</span></span>

## <a name="difference-between-a-distribution-and-a-compute-node"></a><span data-ttu-id="793e9-141">Diferença entre uma distribuição e um nó de Computação</span><span class="sxs-lookup"><span data-stu-id="793e9-141">Difference between a distribution and a Compute node</span></span>
<span data-ttu-id="793e9-142">Uma distribuição é a unidade básica de armazenamento de dados distribuídos e processamento de consultas paralelas.</span><span class="sxs-lookup"><span data-stu-id="793e9-142">A distribution is the basic unit for storing distributed data and processing parallel queries.</span></span> <span data-ttu-id="793e9-143">Distribuições são agrupadas em nós de Computação.</span><span class="sxs-lookup"><span data-stu-id="793e9-143">Distributions are grouped into Compute nodes.</span></span> <span data-ttu-id="793e9-144">Cada nó de Computação rastreia uma ou mais distribuições.</span><span class="sxs-lookup"><span data-stu-id="793e9-144">Each Compute node tracks one or more distributions.</span></span>  

* <span data-ttu-id="793e9-145">O Analytics Platform System usa nós de Computação como um componente central dos recursos de escala horizontal arquitetura de hardware.</span><span class="sxs-lookup"><span data-stu-id="793e9-145">Analytics Platform System uses Compute nodes as a central component of the hardware architecture and scale-out capabilities.</span></span> <span data-ttu-id="793e9-146">Ele sempre usa oito distribuições por nó de computação, conforme mostrado no diagrama para tabelas distribuídas em hash.</span><span class="sxs-lookup"><span data-stu-id="793e9-146">It always uses eight distributions per Compute node, as shown in the diagram for hash-distributed tables.</span></span> <span data-ttu-id="793e9-147">O número de nós de Computação e, portanto, o número de distribuições são determinados pelo número de nós de Computação que você compra para o dispositivo.</span><span class="sxs-lookup"><span data-stu-id="793e9-147">The number of Compute nodes, and therefore the number of distributions, is determined by the number of Compute nodes you purchase for the appliance.</span></span> <span data-ttu-id="793e9-148">Por exemplo, se você comprar oito nós de Computação, obterá 64 distribuições (oito nós de computação x oito distribuições/nó).</span><span class="sxs-lookup"><span data-stu-id="793e9-148">For example, if you purchase eight Compute nodes, you get 64 distributions (8 Compute nodes x 8 distributions/node).</span></span> 
* <span data-ttu-id="793e9-149">O SQL Data Warehouse tem um número fixo de 60 distribuições e um número flexível de nós de Computação.</span><span class="sxs-lookup"><span data-stu-id="793e9-149">SQL Data Warehouse has a fixed number of 60 distributions and a flexible number of Compute nodes.</span></span> <span data-ttu-id="793e9-150">Os nós de Computação são implementados com recursos de computação e armazenamento do Azure.</span><span class="sxs-lookup"><span data-stu-id="793e9-150">The Compute nodes are implemented with Azure computing and storage resources.</span></span> <span data-ttu-id="793e9-151">O número de nós de computação pode mudar de acordo com a carga de trabalho do serviço de back-end e a capacidade de computação (DWUs) especificadas para o data warehouse.</span><span class="sxs-lookup"><span data-stu-id="793e9-151">The number of Compute nodes can change according to the backend service workload and the computing capacity (DWUs) you specify for the data warehouse.</span></span> <span data-ttu-id="793e9-152">Quando o número de nós de Computação muda, o número de distribuições por nó de computação também muda.</span><span class="sxs-lookup"><span data-stu-id="793e9-152">When the number of Compute nodes changes, the number of distributions per Compute node also changes.</span></span> 

### <a name="can-i-view-the-compute-nodes"></a><span data-ttu-id="793e9-153">Posso exibir os nós de Computação?</span><span class="sxs-lookup"><span data-stu-id="793e9-153">Can I view the Compute nodes?</span></span>
<span data-ttu-id="793e9-154">Cada nó de computação tem uma ID de nó e está visível nas exibições do sistema referentes ao SQL Data Warehouse e ao Parallel Data Warehouse.</span><span class="sxs-lookup"><span data-stu-id="793e9-154">Each Compute node has a node ID and is visible in system views that pertain to SQL Data Warehouse and Parallel Data Warehouse.</span></span>  <span data-ttu-id="793e9-155">Você pode ver o nó de Computação olhando para a coluna node_id nas exibições do sistema cujos nomes começam com sys.pdw_nodes.</span><span class="sxs-lookup"><span data-stu-id="793e9-155">You can see the Compute node by looking for the node_id column in system views whose names begin with sys.pdw_nodes.</span></span> <span data-ttu-id="793e9-156">Para obter uma lista das exibições de sistema, consulte [Exibição do sistema MPP](sql-data-warehouse-reference-tsql-statements.md).</span><span class="sxs-lookup"><span data-stu-id="793e9-156">For a list of the system views, see the [MPP system view](sql-data-warehouse-reference-tsql-statements.md).</span></span>

## <span data-ttu-id="793e9-157"><a name="Replicated"></a>Tabelas Replicadas</span><span class="sxs-lookup"><span data-stu-id="793e9-157"><a name="Replicated"></a>Replicated Tables</span></span>
<span data-ttu-id="793e9-158">Uma tabela replicada tem uma cópia completa da tabela armazenada em cada nó de Computação.</span><span class="sxs-lookup"><span data-stu-id="793e9-158">A table that is replicated has a fully copy of the table stored on each Compute node.</span></span> <span data-ttu-id="793e9-159">Replicar uma tabela elimina a necessidade de transferir dados entre nós de Computação antes de uma junção ou agregação.</span><span class="sxs-lookup"><span data-stu-id="793e9-159">Replicating a table removes the need to transfer data among Compute nodes before a join or aggregation.</span></span> <span data-ttu-id="793e9-160">Tabelas replicadas só são viáveis com tabelas pequenas devido ao armazenamento extra necessário para armazenar a tabela completa em cada nó de computação.</span><span class="sxs-lookup"><span data-stu-id="793e9-160">Replicated tables are only feasible with small tables because of the extra storage required to store the full table on each compute node.</span></span>  

<span data-ttu-id="793e9-161">O diagrama a seguir mostra uma tabela replicada armazenada em cada nó de Computação.</span><span class="sxs-lookup"><span data-stu-id="793e9-161">The following diagram shows a replicated table that is stored on each Compute node.</span></span> <span data-ttu-id="793e9-162">Para SQL Data Warehouse, a tabela replicada é totalmente copiada para um banco de dados de distribuição em cada nó de computação.</span><span class="sxs-lookup"><span data-stu-id="793e9-162">For SQL Data Warehouse, the replicated table is fully copied to a distribution database on each Compute node.</span></span> <span data-ttu-id="793e9-163">Para o Data Warehouse Paralelo, a tabela replicada é armazenada em todos os discos atribuídos ao nó de Computação.</span><span class="sxs-lookup"><span data-stu-id="793e9-163">For Parallel Data Warehouse, the replicated table is stored across all disks assigned to the Compute node.</span></span>  <span data-ttu-id="793e9-164">Essa estratégia de disco é implementada usando grupos de arquivos do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="793e9-164">This disk strategy is implemented by using SQL Server filegroups.</span></span>  

<span data-ttu-id="793e9-165">![Tabela replicada](media/sql-data-warehouse-distributed-data/replicated-table.png "Tabela replicada")</span><span class="sxs-lookup"><span data-stu-id="793e9-165">![Replicated table](media/sql-data-warehouse-distributed-data/replicated-table.png "Replicated table")</span></span> 

## <a name="next-steps"></a><span data-ttu-id="793e9-166">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="793e9-166">Next steps</span></span>
<span data-ttu-id="793e9-167">Para usar tabelas distribuídas com eficiência, consulte [Distribuir tabelas no SQL Data Warehouse](sql-data-warehouse-tables-distribute.md)</span><span class="sxs-lookup"><span data-stu-id="793e9-167">To use distributed tables effectively, see [Distributing tables in SQL Data Warehouse](sql-data-warehouse-tables-distribute.md)</span></span>  

