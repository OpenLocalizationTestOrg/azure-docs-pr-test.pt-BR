---
title: "aaaUser autenticação para aplicativos de API no serviço de aplicativo do Azure | Microsoft Docs"
description: "Saiba como tooprotect um aplicativo de API no serviço de aplicativo do Azure, permitindo acesso tooauthenticated somente usuários."
services: app-service\api
documentationcenter: .net
author: alexkarcher-msft
manager: erikre
editor: 
ms.assetid: 3896760d-46ff-4b67-b98a-edd233f24758
ms.service: app-service-api
ms.workload: na
ms.tgt_pltfrm: dotnet
ms.devlang: na
ms.topic: article
ms.date: 06/30/2016
ms.author: alkarche
ms.openlocfilehash: 4702fc77fcfe736405e22b033c35d22ae3c5a300
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="user-authentication-for-api-apps-in-azure-app-service"></a><span data-ttu-id="f1880-103">Autenticação de usuário para Aplicativos de API no Serviço de Aplicativo do Azure</span><span class="sxs-lookup"><span data-stu-id="f1880-103">User authentication for API Apps in Azure App Service</span></span>
## <a name="overview"></a><span data-ttu-id="f1880-104">Visão geral</span><span class="sxs-lookup"><span data-stu-id="f1880-104">Overview</span></span>
<span data-ttu-id="f1880-105">Este artigo mostra como um aplicativo de API do Azure para que somente usuários autenticados do tooprotect pode chamá-lo.</span><span class="sxs-lookup"><span data-stu-id="f1880-105">This article shows how tooprotect an Azure API app so that only authenticated users can call it.</span></span> <span data-ttu-id="f1880-106">Olá artigo pressupõe que você leu Olá [visão geral da autenticação do serviço de aplicativo do Azure](../app-service/app-service-authentication-overview.md).</span><span class="sxs-lookup"><span data-stu-id="f1880-106">hello article assumes that you have read hello [Azure App Service authentication overview](../app-service/app-service-authentication-overview.md).</span></span>

<span data-ttu-id="f1880-107">Você aprenderá a:</span><span class="sxs-lookup"><span data-stu-id="f1880-107">You'll learn:</span></span>

* <span data-ttu-id="f1880-108">Como tooconfigure um provedor de autenticação, com detalhes para o Azure Active Directory (AD do Azure).</span><span class="sxs-lookup"><span data-stu-id="f1880-108">How tooconfigure an authentication provider, with details for Azure Active Directory (Azure AD).</span></span>
* <span data-ttu-id="f1880-109">Como tooconsume um aplicativo de API protegido usando Olá [autenticação biblioteca ADAL (Active Directory) para JavaScript](https://github.com/AzureAD/azure-activedirectory-library-for-js).</span><span class="sxs-lookup"><span data-stu-id="f1880-109">How tooconsume a protected API app by using hello [Active Directory Authentication Library (ADAL) for JavaScript](https://github.com/AzureAD/azure-activedirectory-library-for-js).</span></span>

<span data-ttu-id="f1880-110">artigo Olá contém duas seções:</span><span class="sxs-lookup"><span data-stu-id="f1880-110">hello article contains two sections:</span></span>

* <span data-ttu-id="f1880-111">Olá [como tooconfigure de autenticação de usuário no serviço de aplicativo do Azure](#authconfig) seção explica como geral tooconfigure de autenticação de usuário para qualquer aplicativo de API e se aplica igualmente tooall estruturas com suporte pelo serviço de aplicativo, incluindo .NET, Node.js e Java.</span><span class="sxs-lookup"><span data-stu-id="f1880-111">hello [How tooconfigure user authentication in Azure App Service](#authconfig) section explains in general how tooconfigure user authentication for any API app and applies equally tooall frameworks supported by App Service, including .NET, Node.js, and Java.</span></span>
* <span data-ttu-id="f1880-112">Começando com hello [continuar tutoriais de aplicativos de API .NET Olá](#tutorialstart) seção, Olá guias artigo você pela configuração de um aplicativo de exemplo com um .NET fazer final e um front-end do AngularJS para que ele usa o Active Directory do Azure para usuário autenticação.</span><span class="sxs-lookup"><span data-stu-id="f1880-112">Starting with hello [Continuing hello .NET API Apps tutorials](#tutorialstart) section, hello article guides you through configuring a sample application with a .NET back end and an AngularJS front end so that it uses Azure Active Directory for user authentication.</span></span> 

## <span data-ttu-id="f1880-113"><a id="authconfig"></a>Como tooconfigure de autenticação de usuário no serviço de aplicativo do Azure</span><span class="sxs-lookup"><span data-stu-id="f1880-113"><a id="authconfig"></a> How tooconfigure user authentication in Azure App Service</span></span>
<span data-ttu-id="f1880-114">Esta seção fornece instruções gerais que se aplicam a tooany do aplicativo de API.</span><span class="sxs-lookup"><span data-stu-id="f1880-114">This section provides general instructions that apply tooany API app.</span></span> <span data-ttu-id="f1880-115">Para etapas específicas toohello tooDo aplicativo de exemplo .NET de lista, vá muito[continuar tutoriais de Introdução .NET de saudação](#tutorialstart).</span><span class="sxs-lookup"><span data-stu-id="f1880-115">For steps specific toohello tooDo List .NET sample application, go too[Continuing hello .NET getting-started tutorials](#tutorialstart).</span></span>

1. <span data-ttu-id="f1880-116">Em Olá [portal do Azure](https://portal.azure.com/), navegar toohello **configurações** folha do aplicativo hello API que você deseja tooprotect, localizar Olá **recursos** seção e, em seguida, clique em  **Autenticação / autorização**.</span><span class="sxs-lookup"><span data-stu-id="f1880-116">In hello [Azure portal](https://portal.azure.com/), navigate toohello **Settings** blade of hello API app that you want tooprotect, find hello **Features** section, and then click **Authentication/ Authorization**.</span></span>
   
    ![Autenticação/Autorização do portal do Azure](./media/app-service-api-dotnet-user-principal-auth/features.png)
2. <span data-ttu-id="f1880-118">Em Olá **autenticação / autorização** folha, clique em **em**.</span><span class="sxs-lookup"><span data-stu-id="f1880-118">In hello **Authentication / Authorization** blade, click **On**.</span></span>
3. <span data-ttu-id="f1880-119">Selecione uma das opções de saudação do hello **tootake de ação quando a solicitação não está autenticada** lista suspensa.</span><span class="sxs-lookup"><span data-stu-id="f1880-119">Select one of hello options from hello **Action tootake when request is not authenticated** drop-down list.</span></span>
   
   * <span data-ttu-id="f1880-120">Se você quiser apenas chamadas autenticadas tooreach seu aplicativo de API, escolha uma saudação **fazer login...**  opções.</span><span class="sxs-lookup"><span data-stu-id="f1880-120">If you want only authenticated calls tooreach your API app, choose one of hello **Log in with ...** options.</span></span> <span data-ttu-id="f1880-121">Essa opção permite que você tooprotect Olá API aplicativo sem gravar qualquer código que é executado nele.</span><span class="sxs-lookup"><span data-stu-id="f1880-121">This option enables you tooprotect hello API app without writing any code that runs in it.</span></span>
   * <span data-ttu-id="f1880-122">Se você desejar que todas as chamadas tooreach seu aplicativo de API, escolha **Permitir solicitação (nenhuma ação)**.</span><span class="sxs-lookup"><span data-stu-id="f1880-122">If you want all calls tooreach your API app, choose **Allow request (no action)**.</span></span> <span data-ttu-id="f1880-123">Você pode usar essa opção de tooa opção toodirect não autenticado chamadores de provedores de autenticação.</span><span class="sxs-lookup"><span data-stu-id="f1880-123">You can use this option toodirect unauthenticated callers tooa choice of authentication providers.</span></span> <span data-ttu-id="f1880-124">Com essa opção, você tem autorização de toohandle toowrite código.</span><span class="sxs-lookup"><span data-stu-id="f1880-124">With this option you have toowrite code toohandle authorization.</span></span>
     
     <span data-ttu-id="f1880-125">Para saber mais, confira [Autenticação e autorização para Aplicativos de API no Serviço de Aplicativo do Azure](app-service-api-authentication.md#multiple-protection-options).</span><span class="sxs-lookup"><span data-stu-id="f1880-125">For more information, see [Authentication and authorization for API Apps in Azure App Service](app-service-api-authentication.md#multiple-protection-options).</span></span>
4. <span data-ttu-id="f1880-126">Selecione um ou mais Olá **provedores de autenticação**.</span><span class="sxs-lookup"><span data-stu-id="f1880-126">Select one or more of hello **Authentication Providers**.</span></span>
   
    <span data-ttu-id="f1880-127">imagem de saudação mostra opções que exigem todos os toobe chamadores autenticadas pelo AD do Azure.</span><span class="sxs-lookup"><span data-stu-id="f1880-127">hello image shows    choices that require all callers toobe authenticated by Azure AD.</span></span>
   
    ![Folha Autenticação/Autorização do portal do Azure](./media/app-service-api-dotnet-user-principal-auth/authblade.png)
   
    <span data-ttu-id="f1880-129">Quando você escolher um provedor de autenticação, o portal de saudação exibe uma folha de configuração para o provedor.</span><span class="sxs-lookup"><span data-stu-id="f1880-129">When you choose an authentication provider, hello portal displays a configuration blade for that provider.</span></span> 
   
    <span data-ttu-id="f1880-130">Para obter instruções que explicam como tooconfigure Olá folhas de configuração do provedor de autenticação, consulte [como tooconfigure seu logon de Active Directory do Azure do serviço de aplicativo aplicativo toouse](../app-service-mobile/app-service-mobile-how-to-configure-active-directory-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="f1880-130">For detailed instructions that explain how tooconfigure hello authentication provider configuration blades, see [How tooconfigure your App Service application toouse Azure Active Directory login](../app-service-mobile/app-service-mobile-how-to-configure-active-directory-authentication.md).</span></span> <span data-ttu-id="f1880-131">(link Olá vai tooan artigo sobre o AD do Azure, mas artigo Olá próprio contém guias que vinculam tooarticles para Olá outros provedores de autenticação).</span><span class="sxs-lookup"><span data-stu-id="f1880-131">(hello link goes tooan article about Azure AD, but hello article itself contains tabs that link tooarticles for hello other authentication providers.)</span></span>
5. <span data-ttu-id="f1880-132">Quando tiver terminado com folha de configuração do provedor de autenticação de saudação, clique em **Okey**.</span><span class="sxs-lookup"><span data-stu-id="f1880-132">When you're done with hello authentication provider configuration blade, click **OK**.</span></span>
6. <span data-ttu-id="f1880-133">Em Olá **autenticação / autorização** folha, clique em **salvar**.</span><span class="sxs-lookup"><span data-stu-id="f1880-133">In hello **Authentication / Authorization** blade, click **Save**.</span></span>

<span data-ttu-id="f1880-134">Quando isso for feito, o serviço de aplicativo autentica todas as chamadas de API antes que elas atinjam o aplicativo de API de saudação.</span><span class="sxs-lookup"><span data-stu-id="f1880-134">When this is done, App Service authenticates all API calls before they reach hello API app.</span></span> <span data-ttu-id="f1880-135">trabalho de serviços de autenticação Olá Olá mesmo para todos os idiomas com suporte do serviço de aplicativo, incluindo .NET, Node.js e Java.</span><span class="sxs-lookup"><span data-stu-id="f1880-135">hello authentication services work hello same for all languages that App service supports, including .NET, Node.js, and Java.</span></span> 

<span data-ttu-id="f1880-136">toomake autenticado chamadas de API, chamador Olá inclui o token de portador OAuth 2.0 do provedor de autenticação Olá no cabeçalho de autorização de saudação de solicitações HTTP.</span><span class="sxs-lookup"><span data-stu-id="f1880-136">toomake authenticated API calls, hello caller includes hello authentication provider's OAuth 2.0 bearer token in hello Authorization header of HTTP requests.</span></span> <span data-ttu-id="f1880-137">token de saudação pode ser adquirida por meio SDK do provedor de autenticação Olá.</span><span class="sxs-lookup"><span data-stu-id="f1880-137">hello token can be acquired by using hello authentication provider's SDK.</span></span>

## <span data-ttu-id="f1880-138"><a id="tutorialstart"></a>Tutoriais de aplicativos de API .NET Olá continuando</span><span class="sxs-lookup"><span data-stu-id="f1880-138"><a id="tutorialstart"></a> Continuing hello .NET API Apps tutorials</span></span>
<span data-ttu-id="f1880-139">Se você estiver seguindo os tutoriais de saudação Node. js ou Java para aplicativos de API, ignorar toohello próximo artigo, [autenticação principal do serviço para aplicativos de API](app-service-api-dotnet-service-principal-auth.md).</span><span class="sxs-lookup"><span data-stu-id="f1880-139">If you are following hello Node.js or Java tutorials for API apps, skip toohello next article, [service principal authentication for API apps](app-service-api-dotnet-service-principal-auth.md).</span></span> 

<span data-ttu-id="f1880-140">Se você estiver seguindo a série de tutoriais Olá .NET para aplicativos de API e já implantou o aplicativo de exemplo hello conforme indicado na Olá [primeiro](app-service-api-dotnet-get-started.md) e [segundo](app-service-api-cors-consume-javascript.md) tutoriais, ignorar toohello [configurar autenticação no serviço de aplicativo e o Azure AD](#azureauth) seção.</span><span class="sxs-lookup"><span data-stu-id="f1880-140">If you are following hello .NET tutorial series for API apps and have already deployed hello sample application as directed in hello [first](app-service-api-dotnet-get-started.md) and [second](app-service-api-cors-consume-javascript.md) tutorials, skip toohello [Set up authentication in App Service and Azure AD](#azureauth) section.</span></span>

<span data-ttu-id="f1880-141">Se você quiser toofollow neste tutorial, sem passar pelo tutoriais de primeiro e segundo Olá, Olá seguindo as etapas que explicam como tooget iniciado usando um aplicativo de exemplo do processo automatizado toodeploy hello.</span><span class="sxs-lookup"><span data-stu-id="f1880-141">If you want toofollow this tutorial without going through hello first and second tutorials, do hello following steps which explain how tooget started by using an automated process toodeploy hello sample application.</span></span>

> [!NOTE]
> <span data-ttu-id="f1880-142">Olá etapas a seguir que você toohello ponto inicial mesmo que você Olá dois primeiros tutoriais, com uma exceção: Visual Studio já não saberá qual aplicativo web ou aplicativo de API que cada projeto é implantado.</span><span class="sxs-lookup"><span data-stu-id="f1880-142">hello following steps get you toohello same starting point as if you did hello first two tutorials, with one exception: Visual Studio won't already know which web app or API app that each project gets deployed to.</span></span> <span data-ttu-id="f1880-143">Isso significa que você não terá as instruções exatas neste tutorial que explicam como toodeploy toohello direita destinos.</span><span class="sxs-lookup"><span data-stu-id="f1880-143">That means you won't have exact instructions in this tutorial that explain how toodeploy toohello right targets.</span></span> <span data-ttu-id="f1880-144">Se você não estiver familiarizado com a descobrir como as etapas de implantação de saudação toodo por conta própria, é melhor toofollow Olá série de tutoriais de saudação [primeiro tutorial](app-service-api-dotnet-get-started.md) que toostart com essa automatizada o processo de implantação.</span><span class="sxs-lookup"><span data-stu-id="f1880-144">If you're not comfortable with figuring out how toodo hello deployment steps on your own, it's better toofollow hello tutorial series from hello [first tutorial](app-service-api-dotnet-get-started.md) than toostart with this automated deployment process.</span></span>
> 
> 

1. <span data-ttu-id="f1880-145">Certifique-se de que você tem todos os pré-requisitos de saudação listados no hello [primeiro tutorial](app-service-api-dotnet-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="f1880-145">Make sure that you have all of hello prerequisites listed in hello [first tutorial](app-service-api-dotnet-get-started.md).</span></span> <span data-ttu-id="f1880-146">Adição toohello os pré-requisitos listados, esses tutoriais de autenticação supõem que você tenha trabalhado com aplicativos do serviço de aplicativo web e aplicativos de API no Visual Studio e Olá portal do Azure.</span><span class="sxs-lookup"><span data-stu-id="f1880-146">In addition toohello prerequisites listed, these authentication tutorials assume that you have worked with App Service web apps and API apps in Visual Studio and hello Azure portal.</span></span>
2. <span data-ttu-id="f1880-147">Clique em Olá **implantar tooAzure** botão Olá [arquivo Leiame de repositório de exemplo do tooDo lista](https://github.com/azure-samples/app-service-api-dotnet-todo-list/blob/master/readme.md) toodeploy Olá API aplicativos e hello de aplicativo da web.</span><span class="sxs-lookup"><span data-stu-id="f1880-147">Click hello **Deploy tooAzure** button in hello [tooDo List sample repository readme file](https://github.com/azure-samples/app-service-api-dotnet-todo-list/blob/master/readme.md) toodeploy hello API apps and hello web app.</span></span> <span data-ttu-id="f1880-148">Faça uma anotação hello Azure do grupo de recursos que é criado, porque você pode usar este posterior toolook o aplicativo web e nomes de aplicativo de API.</span><span class="sxs-lookup"><span data-stu-id="f1880-148">Make a note of hello Azure resource group that gets created, as you can use this later toolook up web app and API app names.</span></span>
3. <span data-ttu-id="f1880-149">Download ou o clone hello [repositório de exemplo lista tooDo](https://github.com/Azure-Samples/app-service-api-dotnet-todo-list) código de saudação tooget que você trabalhará com localmente no Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="f1880-149">Download or clone hello [tooDo List sample repository](https://github.com/Azure-Samples/app-service-api-dotnet-todo-list) tooget hello code that you'll work with locally in Visual Studio.</span></span>

## <span data-ttu-id="f1880-150"><a id="azureauth"></a> Configurar a autenticação no Serviço de Aplicativo e no Azure AD</span><span class="sxs-lookup"><span data-stu-id="f1880-150"><a id="azureauth"></a> Set up authentication in App Service and Azure AD</span></span>
<span data-ttu-id="f1880-151">Agora, você tem um aplicativo hello em execução no serviço de aplicativo do Azure sem a necessidade de que os usuários autenticados.</span><span class="sxs-lookup"><span data-stu-id="f1880-151">You now have hello application running in Azure App Service without requiring that users be authenticated.</span></span> <span data-ttu-id="f1880-152">Nesta seção você pode adicionar autenticação fazendo Olá tarefas a seguir:</span><span class="sxs-lookup"><span data-stu-id="f1880-152">In this section you add authentication by doing hello following tasks:</span></span>

* <span data-ttu-id="f1880-153">Configure a autenticação do serviço de aplicativo toorequire Azure Active Directory (AD do Azure) para chamar o aplicativo de camada intermediária API hello.</span><span class="sxs-lookup"><span data-stu-id="f1880-153">Configure App Service toorequire Azure Active Directory (Azure AD) authentication for calling hello middle tier API app.</span></span>
* <span data-ttu-id="f1880-154">Criar um aplicativo Azure AD.</span><span class="sxs-lookup"><span data-stu-id="f1880-154">Create an Azure AD application.</span></span>
* <span data-ttu-id="f1880-155">Configure o token de portador de Olá Olá AD do Azure aplicativo toosend após logon toohello AngularJS front-end.</span><span class="sxs-lookup"><span data-stu-id="f1880-155">Configure hello Azure AD application toosend hello bearer token after logon toohello AngularJS front end.</span></span> 

<span data-ttu-id="f1880-156">Se você tiver problemas ao tutorial instruções a seguir hello, consulte Olá [solução de problemas](#troubleshooting) seção final Olá tutorial hello.</span><span class="sxs-lookup"><span data-stu-id="f1880-156">If you run into problems while following hello tutorial directions, see hello [Troubleshooting](#troubleshooting) section at hello end of hello tutorial.</span></span> 

### <a name="configure-authentication-for-hello-middle-tier-api-app"></a><span data-ttu-id="f1880-157">Configurar a autenticação para a camada intermediária de saudação do aplicativo de API</span><span class="sxs-lookup"><span data-stu-id="f1880-157">Configure authentication for hello middle tier API app</span></span>
1. <span data-ttu-id="f1880-158">Em Olá [portal do Azure](https://portal.azure.com/), navegar toohello **configurações** folha do aplicativo hello API que você criou para o projeto de ToDoListAPI hello, localize Olá **recursos** seção e, em seguida, Clique em **autenticação / autorização**.</span><span class="sxs-lookup"><span data-stu-id="f1880-158">In hello [Azure portal](https://portal.azure.com/), navigate toohello **Settings** blade of hello API app that you created for hello ToDoListAPI project, find hello **Features** section, and then click **Authentication / Authorization**.</span></span>
   
    ![Autenticação/Autorização do portal do Azure](./media/app-service-api-dotnet-user-principal-auth/features.png)
2. <span data-ttu-id="f1880-160">Em Olá **autenticação / autorização** folha, clique em **em**.</span><span class="sxs-lookup"><span data-stu-id="f1880-160">In hello **Authentication / Authorization** blade, click **On**.</span></span>
3. <span data-ttu-id="f1880-161">Em Olá **tootake de ação quando a solicitação não está autenticada** lista suspensa, selecione **fazer logon com Active Directory do Azure**.</span><span class="sxs-lookup"><span data-stu-id="f1880-161">In hello **Action tootake when request is not authenticated** drop-down list, select **Log in with Azure Active Directory**.</span></span>
   
    <span data-ttu-id="f1880-162">Essa opção garante que nenhuma solicitação unauathenticated alcançará saudação do aplicativo de API.</span><span class="sxs-lookup"><span data-stu-id="f1880-162">This option ensures that no unauathenticated requests will reach hello API app.</span></span> 
4. <span data-ttu-id="f1880-163">Em **Provedores de Autenticação**, clique em **Azure Active Directory**.</span><span class="sxs-lookup"><span data-stu-id="f1880-163">Under **Authentication Providers**, click **Azure Active Directory**.</span></span>
   
    ![Folha Autenticação/Autorização do portal do Azure](./media/app-service-api-dotnet-user-principal-auth/authblade.png)
5. <span data-ttu-id="f1880-165">Em Olá **configurações do Active Directory do Azure** folha, clique em **Express**</span><span class="sxs-lookup"><span data-stu-id="f1880-165">In hello **Azure Active Directory Settings** blade, click **Express**</span></span>
   
    ![Opção Autenticação/Autorização Expressa do portal do Azure](./media/app-service-api-dotnet-user-principal-auth/aadsettings.png)
   
    <span data-ttu-id="f1880-167">Com hello **Express** opção, o serviço de aplicativo pode criar automaticamente um aplicativo do AD do Azure no AD do Azure [locatário](https://msdn.microsoft.com/en-us/library/azure/jj573650.aspx#BKMK_WhatIsAnAzureADTenant).</span><span class="sxs-lookup"><span data-stu-id="f1880-167">With hello **Express** option, App Service can automatically create an Azure AD application in your Azure AD [tenant](https://msdn.microsoft.com/en-us/library/azure/jj573650.aspx#BKMK_WhatIsAnAzureADTenant).</span></span> 
   
    <span data-ttu-id="f1880-168">Você não tem toocreate um locatário, porque cada conta do Azure tem uma automaticamente.</span><span class="sxs-lookup"><span data-stu-id="f1880-168">You don't have toocreate a tenant, because every Azure account automatically has one.</span></span>
6. <span data-ttu-id="f1880-169">Em **modo de gerenciamento**, clique em **criar novo aplicativo AD** se ainda não estiver selecionado e observe o valor Olá no hello **criar aplicativo** caixa de texto; você procurará esse AAD aplicativo em Olá portal clássico do Azure posteriormente.</span><span class="sxs-lookup"><span data-stu-id="f1880-169">Under **Management mode**, click **Create New AD App** if it isn't already selected, and notice hello value that is in hello **Create App** text box; you'll look up this AAD application in hello Azure classic portal later.</span></span>
   
    ![Configurações do Azure AD no portal do Azure](./media/app-service-api-dotnet-user-principal-auth/aadsettings2.png)
   
    <span data-ttu-id="f1880-171">Azure criará automaticamente um aplicativo do AD do Azure com o nome de saudação indicada em seu locatário do AD do Azure.</span><span class="sxs-lookup"><span data-stu-id="f1880-171">Azure will automatically create an Azure AD application with hello indicated name in your Azure AD tenant.</span></span> <span data-ttu-id="f1880-172">Por padrão, Olá aplicativo AD do Azure é denominado hello mesmo como o aplicativo hello API.</span><span class="sxs-lookup"><span data-stu-id="f1880-172">By default, hello Azure AD application is named hello same as hello API app.</span></span> <span data-ttu-id="f1880-173">Se preferir, você pode inserir um nome diferente.</span><span class="sxs-lookup"><span data-stu-id="f1880-173">If you prefer, you can enter a different name.</span></span>
7. <span data-ttu-id="f1880-174">Clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="f1880-174">Click **OK**.</span></span>
8. <span data-ttu-id="f1880-175">Em Olá **autenticação / autorização** folha, clique em **salvar**.</span><span class="sxs-lookup"><span data-stu-id="f1880-175">In hello **Authentication / Authorization** blade, click **Save**.</span></span>
   
    ![Clique em Salvar](./media/app-service-api-dotnet-user-principal-auth/authsave.png)

<span data-ttu-id="f1880-177">Agora apenas os usuários em seu locatário do AD do Azure podem chamar o aplicativo de API de saudação.</span><span class="sxs-lookup"><span data-stu-id="f1880-177">Now only users in your Azure AD tenant can call hello API app.</span></span>

### <a name="optional-test-hello-api-app"></a><span data-ttu-id="f1880-178">Opcional: Testar o aplicativo hello API</span><span class="sxs-lookup"><span data-stu-id="f1880-178">Optional: Test hello API app</span></span>
1. <span data-ttu-id="f1880-179">Em um navegador, vá toohello URL do aplicativo hello API: no hello **aplicativo de API** folha em Olá portal do Azure, clique o link de saudação em **URL**.</span><span class="sxs-lookup"><span data-stu-id="f1880-179">In a browser go toohello URL of hello API app: in hello **API app** blade in hello Azure portal, click hello link under **URL**.</span></span>  
   
    <span data-ttu-id="f1880-180">Você está a tela de login tooa redirecionado porque as solicitações não autenticadas não são permitidas tooreach saudação do aplicativo de API.</span><span class="sxs-lookup"><span data-stu-id="f1880-180">You are redirected tooa login screen because unauthenticated requests are not allowed tooreach hello API app.</span></span>
   
    <span data-ttu-id="f1880-181">Se seu navegador der página toohello "criado com êxito", já pode estar conectado navegador hello – nesse caso, abra uma janela InPrivate ou Incognito e acesse a URL do aplicativo toohello API.</span><span class="sxs-lookup"><span data-stu-id="f1880-181">If your browser goes toohello "successfully created" page, hello browser might already be logged on -- in that case, open an InPrivate or Incognito window and go toohello API app's URL.</span></span>
2. <span data-ttu-id="f1880-182">Faça logon usando as credenciais de um usuário no locatário do Azure AD.</span><span class="sxs-lookup"><span data-stu-id="f1880-182">Log on using credentials for a user in your Azure AD tenant.</span></span>
   
    <span data-ttu-id="f1880-183">Quando você fizer logon, Olá "criado com êxito" página aparece no navegador de saudação.</span><span class="sxs-lookup"><span data-stu-id="f1880-183">When you're logged on, hello "successfully created" page appears in hello browser.</span></span>
3. <span data-ttu-id="f1880-184">Navegador de saudação fechar.</span><span class="sxs-lookup"><span data-stu-id="f1880-184">Close hello browser.</span></span>

### <a name="configure-hello-azure-ad-application"></a><span data-ttu-id="f1880-185">Configurar o aplicativo hello AD do Azure</span><span class="sxs-lookup"><span data-stu-id="f1880-185">Configure hello Azure AD application</span></span>
<span data-ttu-id="f1880-186">Quando você configurou a autenticação do Azure AD, o Serviço de Aplicativo criou um aplicativo Azure AD para você.</span><span class="sxs-lookup"><span data-stu-id="f1880-186">When you configured Azure AD authentication, App Service created an Azure AD application for you.</span></span> <span data-ttu-id="f1880-187">Por padrão o aplicativo hello novo AD do Azure foi URL do aplicativo de API toohello token portador tooprovide configurado hello.</span><span class="sxs-lookup"><span data-stu-id="f1880-187">By default hello new Azure AD application was configured tooprovide hello bearer token toohello API app's URL.</span></span> <span data-ttu-id="f1880-188">Nesta seção você configurar Olá AD do Azure aplicativo tooprovide Olá portador token toohello AngularJS front-end em vez de aplicativo de camada intermediária API toohello diretamente.</span><span class="sxs-lookup"><span data-stu-id="f1880-188">In this section you configure hello Azure AD application tooprovide hello bearer token toohello AngularJS front end instead of directly toohello middle tier API app.</span></span> <span data-ttu-id="f1880-189">front-end de AngularJS Olá enviará Olá token toohello API do aplicativo quando ele chama o aplicativo de API de saudação.</span><span class="sxs-lookup"><span data-stu-id="f1880-189">hello AngularJS front end will send hello token toohello API app when it calls hello API app.</span></span>

> [!NOTE]
> <span data-ttu-id="f1880-190">processo de saudação tookeep tão simple quanto possível, este tutorial usa um único AD do Azure para o front-end hello e o aplicativo de camada intermediária API hello.</span><span class="sxs-lookup"><span data-stu-id="f1880-190">tookeep hello process as simple as possible, this tutorial uses a single Azure AD application for both hello front end and hello middle tier API app.</span></span> <span data-ttu-id="f1880-191">Outra opção é toouse dois aplicativos do AD do Azure.</span><span class="sxs-lookup"><span data-stu-id="f1880-191">Another option is toouse two Azure AD applications.</span></span> <span data-ttu-id="f1880-192">Nesse caso, você teria do toogive Olá front-end AD do Azure aplicativo permissão toocall Olá intermediária aplicativo da camada AD do Azure.</span><span class="sxs-lookup"><span data-stu-id="f1880-192">In that case you would have toogive hello front end's Azure AD application permission toocall hello middle tier's Azure AD application.</span></span> <span data-ttu-id="f1880-193">Essa abordagem de vários aplicativo oferecem maior controle granular sobre a camada de tooeach de permissões.</span><span class="sxs-lookup"><span data-stu-id="f1880-193">This multi-application approach would give you more granular control over permissions tooeach tier.</span></span>
> 
> 

1. <span data-ttu-id="f1880-194">Em Olá [portal clássico do Azure](https://manage.windowsazure.com/), ir muito**Active Directory do Azure**.</span><span class="sxs-lookup"><span data-stu-id="f1880-194">In hello [Azure classic portal](https://manage.windowsazure.com/), go too**Azure Active Directory**.</span></span>
   
   <span data-ttu-id="f1880-195">Você tem o portal clássico do toouse Olá porque algumas configurações do Active Directory do Azure que você precisa acessar tooare ainda não está disponível no portal do Azure atual de saudação.</span><span class="sxs-lookup"><span data-stu-id="f1880-195">You have toouse hello classic portal because certain Azure Active Directory settings that you need access tooare not yet available in hello current Azure portal.</span></span>
2. <span data-ttu-id="f1880-196">Em Olá **diretório** , clique em seu locatário do AAD.</span><span class="sxs-lookup"><span data-stu-id="f1880-196">On hello **Directory** tab, click your AAD tenant.</span></span>
   
   ![Azure AD no portal clássico](./media/app-service-api-dotnet-user-principal-auth/selecttenant.png)
3. <span data-ttu-id="f1880-198">Clique em **aplicativos > aplicativos que minha empresa possui**e, em seguida, clique em marca de seleção de saudação.</span><span class="sxs-lookup"><span data-stu-id="f1880-198">Click **Applications > Applications my company owns**, and then click hello check mark.</span></span>
   
   <span data-ttu-id="f1880-199">Você também pode ter toorefresh Olá página toosee Olá novo aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f1880-199">You might also have toorefresh hello page toosee hello new application.</span></span>
4. <span data-ttu-id="f1880-200">Na lista de Olá de aplicativos, clique em nome de saudação do hello que Azure criado para você quando você habilitou a autenticação para seu aplicativo de API.</span><span class="sxs-lookup"><span data-stu-id="f1880-200">In hello list of applications, click hello name of hello one that Azure created for you when you enabled authentication for your API app.</span></span>
   
   ![Guia Aplicativos Azure AD](./media/app-service-api-dotnet-user-principal-auth/appstab.png)
5. <span data-ttu-id="f1880-202">Clique em **Configurar**.</span><span class="sxs-lookup"><span data-stu-id="f1880-202">Click **Configure**.</span></span>
   
   ![Guia Configurar Azure AD](./media/app-service-api-dotnet-user-principal-auth/configure.png)
6. <span data-ttu-id="f1880-204">Definir **URL de logon** toohello URL para seu aplicativo da web do AngularJS, nenhuma barra à direita.</span><span class="sxs-lookup"><span data-stu-id="f1880-204">Set **Sign-on URL** toohello URL for your AngularJS web app, no trailing slash.</span></span>
   
   <span data-ttu-id="f1880-205">Por exemplo: https://todolistangular.azurewebsites.net</span><span class="sxs-lookup"><span data-stu-id="f1880-205">For example: https://todolistangular.azurewebsites.net</span></span>
   
   ![URL de logon](./media/app-service-api-dotnet-user-principal-auth/signonurlazure.png)
7. <span data-ttu-id="f1880-207">Definir **URL de resposta** toohello URL para seu aplicativo web, nenhuma barra à direita.</span><span class="sxs-lookup"><span data-stu-id="f1880-207">Set **Reply URL** toohello URL for your web app, no trailing slash.</span></span>
   
   <span data-ttu-id="f1880-208">Por exemplo: https://todolistsangular.azurewebsites.net</span><span class="sxs-lookup"><span data-stu-id="f1880-208">For example: https://todolistsangular.azurewebsites.net</span></span>
8. <span data-ttu-id="f1880-209">Clique em **Salvar**.</span><span class="sxs-lookup"><span data-stu-id="f1880-209">Click **Save**.</span></span>
   
   ![URL de resposta](./media/app-service-api-dotnet-user-principal-auth/replyurlazure.png)
9. <span data-ttu-id="f1880-211">Final Olá Olá página, clique em **gerenciar manifesto > Download manifesto**.</span><span class="sxs-lookup"><span data-stu-id="f1880-211">At hello bottom of hello page, click **Manage manifest > Download manifest**.</span></span>
   
   ![Baixar manifesto](./media/app-service-api-dotnet-user-principal-auth/downloadmanifest.png)
10. <span data-ttu-id="f1880-213">Baixe tooa local do arquivo de saudação onde você pode editá-lo.</span><span class="sxs-lookup"><span data-stu-id="f1880-213">Download hello file tooa location where you can edit it.</span></span>
11. <span data-ttu-id="f1880-214">No arquivo de manifesto Olá baixado, procure Olá `oauth2AllowImplicitFlow` propriedade.</span><span class="sxs-lookup"><span data-stu-id="f1880-214">In hello downloaded manifest file, search for hello  `oauth2AllowImplicitFlow` property.</span></span> <span data-ttu-id="f1880-215">Alterar valor Olá dessa propriedade de `false` muito`true`e, em seguida, salve o arquivo hello.</span><span class="sxs-lookup"><span data-stu-id="f1880-215">Change hello value of this property from `false` too`true`, and then save hello file.</span></span>
    
    <span data-ttu-id="f1880-216">Essa configuração é necessária para o acesso de um aplicativo de página única de JavaScript.</span><span class="sxs-lookup"><span data-stu-id="f1880-216">This setting is required for access from a JavaScript single-page application.</span></span> <span data-ttu-id="f1880-217">Ele permite Olá Oauth 2.0 portador token toobe retornado no fragmento de URL hello.</span><span class="sxs-lookup"><span data-stu-id="f1880-217">It enables hello Oauth 2.0 bearer token toobe returned in hello URL fragment.</span></span>
12. <span data-ttu-id="f1880-218">Clique em **gerenciar manifesto > carregar manifesto**e carregar arquivo hello que você atualizou no hello anterior da etapa.</span><span class="sxs-lookup"><span data-stu-id="f1880-218">Click **Manage manifest > Upload manifest**, and upload hello file that you updated in hello preceding step.</span></span>
    
    ![Carregar manifesto](./media/app-service-api-dotnet-user-principal-auth/uploadmanifest.png)
13. <span data-ttu-id="f1880-220">Saudação de cópia **ID do cliente** valor e salve-o em algum lugar, você poderá obtê-lo de mais tarde.</span><span class="sxs-lookup"><span data-stu-id="f1880-220">Copy hello **Client ID** value and save it somewhere you can get it from later.</span></span>

## <a name="configure-hello-todolistangular-project-toouse-authentication"></a><span data-ttu-id="f1880-221">Configurar a autenticação de toouse Olá ToDoListAngular projeto</span><span class="sxs-lookup"><span data-stu-id="f1880-221">Configure hello ToDoListAngular project toouse authentication</span></span>
<span data-ttu-id="f1880-222">Nesta seção, você alterar front-end de AngularJS Olá para que ele usa a biblioteca de autenticação do Active Directory (ADAL) para tooacquire JS um token de portador Olá logon do usuário do AD do Azure.</span><span class="sxs-lookup"><span data-stu-id="f1880-222">In this section you change hello AngularJS front end so that it uses Active Directory Authentication Library (ADAL) for JS tooacquire a bearer token for hello logged-on user from Azure AD.</span></span> <span data-ttu-id="f1880-223">código de saudação incluirá token Olá em solicitações HTTP enviadas toohello de camada intermediária, conforme mostrado no diagrama a seguir de saudação.</span><span class="sxs-lookup"><span data-stu-id="f1880-223">hello code will include hello token in HTTP requests sent toohello middle tier, as shown in hello following diagram.</span></span> 

![Diagrama de autenticação de usuário](./media/app-service-api-dotnet-user-principal-auth/appdiagram.png)

<span data-ttu-id="f1880-225">Verifique Olá toofiles alterações no projeto de ToDoListAngular Olá a seguir.</span><span class="sxs-lookup"><span data-stu-id="f1880-225">Make hello following changes toofiles in hello ToDoListAngular project.</span></span>

1. <span data-ttu-id="f1880-226">Olá abrir *cshtml* arquivo.</span><span class="sxs-lookup"><span data-stu-id="f1880-226">Open hello *index.cshtml* file.</span></span>
2. <span data-ttu-id="f1880-227">Descomente as linhas de saudação que fazem referência a saudação biblioteca de autenticação do Active Directory (ADAL) para scripts JS.</span><span class="sxs-lookup"><span data-stu-id="f1880-227">Uncomment hello lines that reference hello Active Directory Authentication Library (ADAL) for JS scripts.</span></span>
   
        <script src="app/scripts/adal.js"></script>
        <script src="app/scripts/adal-angular.js"></script>
3. <span data-ttu-id="f1880-228">Olá abrir *app/scripts/app.js* arquivo.</span><span class="sxs-lookup"><span data-stu-id="f1880-228">Open hello *app/scripts/app.js* file.</span></span>
4. <span data-ttu-id="f1880-229">Comente o bloco de saudação de código marcado para "sem autenticação" e remova o bloco de saudação de código marcado para "autenticação com".</span><span class="sxs-lookup"><span data-stu-id="f1880-229">Comment out hello block of code marked for "without authentication" and uncomment hello block of code marked for "with authentication".</span></span>
   
    <span data-ttu-id="f1880-230">Essa alteração referencia o provedor de autenticação de ADAL JS hello e fornece tooit de valores de configuração.</span><span class="sxs-lookup"><span data-stu-id="f1880-230">This change references hello ADAL JS authentication provider and provides configuration values tooit.</span></span> <span data-ttu-id="f1880-231">Olá etapas você define valores de configuração Olá para o aplicativo de API e o aplicativo do AD do Azure.</span><span class="sxs-lookup"><span data-stu-id="f1880-231">In hello following steps you set hello configuration values for your API app and Azure AD application.</span></span>
5. <span data-ttu-id="f1880-232">No código de saudação que define Olá `endpoints` Olá variável, defina URL da API toohello URL do aplicativo hello API que você criou para o projeto de ToDoListAPI Olá e defina Olá AD do Azure ID toohello cliente ID do aplicativo que você copiou da saudação portal clássico do Azure.</span><span class="sxs-lookup"><span data-stu-id="f1880-232">In hello code that sets hello `endpoints` variable, set hello API URL toohello URL of hello API app that you created for hello ToDoListAPI project, and set hello Azure AD application ID toohello client ID that you copied from hello Azure classic portal.</span></span>
   
    <span data-ttu-id="f1880-233">código de saudação agora é semelhante toohello exemplo a seguir.</span><span class="sxs-lookup"><span data-stu-id="f1880-233">hello code is now similar toohello following example.</span></span>
   
        var endpoints = {
            "https://todolistapi0121.azurewebsites.net/": "1cf55bc9-9ed8-4df31cf55bc9-9ed8-4df3"
        };
6. <span data-ttu-id="f1880-234">Olá chamar muito`adalProvider.init`, defina `tenant` tooyour o nome do locatário e `clientId` toosame valor usado na etapa anterior hello.</span><span class="sxs-lookup"><span data-stu-id="f1880-234">In hello call too`adalProvider.init`, set `tenant` tooyour tenant name and `clientId` toosame value you used in hello previous step.</span></span>
   
    <span data-ttu-id="f1880-235">código de saudação agora é semelhante toohello exemplo a seguir.</span><span class="sxs-lookup"><span data-stu-id="f1880-235">hello code is now similar toohello following example.</span></span>
   
        adalProvider.init(
            {
                instance: 'https://login.microsoftonline.com/', 
                tenant: 'contoso.onmicrosoft.com',
                clientId: '1cf55bc9-9ed8-4df31cf55bc9-9ed8-4df3',
                extraQueryParameter: 'nux=1',
                endpoints: endpoints
            },
            $httpProvider
            );
   
    <span data-ttu-id="f1880-236">Essas alterações muito`app.js` especificar que o código de chamada hello e Olá chamado API estão no aplicativo hello mesmo Azure AD.</span><span class="sxs-lookup"><span data-stu-id="f1880-236">These changes too`app.js` specify that hello calling code and hello called API are in hello same Azure AD application.</span></span>
7. <span data-ttu-id="f1880-237">Olá abrir *app/scripts/homeCtrl.js* arquivo.</span><span class="sxs-lookup"><span data-stu-id="f1880-237">Open hello *app/scripts/homeCtrl.js* file.</span></span>
8. <span data-ttu-id="f1880-238">Comente o bloco de saudação de código marcado para "sem autenticação" e remova o bloco de saudação de código marcado para "autenticação com".</span><span class="sxs-lookup"><span data-stu-id="f1880-238">Comment out hello block of code marked for "without authentication" and uncomment hello block of code marked for "with authentication".</span></span>
9. <span data-ttu-id="f1880-239">Olá abrir *app/scripts/indexCtrl.js* arquivo.</span><span class="sxs-lookup"><span data-stu-id="f1880-239">Open hello *app/scripts/indexCtrl.js* file.</span></span>
10. <span data-ttu-id="f1880-240">Comente o bloco de saudação de código marcado para "sem autenticação" e remova o bloco de saudação de código marcado para "autenticação com".</span><span class="sxs-lookup"><span data-stu-id="f1880-240">Comment out hello block of code marked for "without authentication" and uncomment hello block of code marked for "with authentication".</span></span>

### <a name="deploy-hello-todolistangular-project-tooazure"></a><span data-ttu-id="f1880-241">Implantar Olá ToDoListAngular projeto tooAzure</span><span class="sxs-lookup"><span data-stu-id="f1880-241">Deploy hello ToDoListAngular project tooAzure</span></span>
1. <span data-ttu-id="f1880-242">Em **Solution Explorer**, clique com botão direito Olá ToDoListAngular e, em seguida, clique em **publicar**.</span><span class="sxs-lookup"><span data-stu-id="f1880-242">In **Solution Explorer**, right-click hello ToDoListAngular project, and then click **Publish**.</span></span>
2. <span data-ttu-id="f1880-243">Clique em **Publicar**.</span><span class="sxs-lookup"><span data-stu-id="f1880-243">Click **Publish**.</span></span>
   
    <span data-ttu-id="f1880-244">Visual Studio implanta o projeto hello e abre URL de base de um navegador toohello aplicativo web.</span><span class="sxs-lookup"><span data-stu-id="f1880-244">Visual Studio deploys hello project and opens a browser toohello web app's base URL.</span></span> <span data-ttu-id="f1880-245">Isso mostrará uma página de 403 erro, que é normal para uma URL base de tentativa toogo tooa API da Web em um navegador.</span><span class="sxs-lookup"><span data-stu-id="f1880-245">This will show a 403 error page, which is normal for an attempt toogo tooa Web API base URL from a browser.</span></span>
   
    <span data-ttu-id="f1880-246">Você ainda terá toomake uma alteração toohello intermediária do aplicativo de API antes de testar o aplicativo hello.</span><span class="sxs-lookup"><span data-stu-id="f1880-246">You still have toomake a change toohello middle tier API app before you can test hello application.</span></span>
3. <span data-ttu-id="f1880-247">Navegador de saudação fechar.</span><span class="sxs-lookup"><span data-stu-id="f1880-247">Close hello browser.</span></span>

## <a name="configure-hello-todolistapi-project-toouse-authentication"></a><span data-ttu-id="f1880-248">Configurar a autenticação de toouse Olá ToDoListAPI projeto</span><span class="sxs-lookup"><span data-stu-id="f1880-248">Configure hello ToDoListAPI project toouse authentication</span></span>
<span data-ttu-id="f1880-249">Olá atualmente envios de projeto ToDoListAPI "*" como Olá `owner` tooToDoListDataAPI de valor.</span><span class="sxs-lookup"><span data-stu-id="f1880-249">Currently hello ToDoListAPI project sends "*" as hello `owner` value tooToDoListDataAPI.</span></span> <span data-ttu-id="f1880-250">Nesta seção, você alterar Olá código toosend Olá ID de usuário com logon hello.</span><span class="sxs-lookup"><span data-stu-id="f1880-250">In this section you change hello code toosend hello ID of hello logged-on user.</span></span>

<span data-ttu-id="f1880-251">Verifique Olá após as alterações no projeto de ToDoListAPI hello.</span><span class="sxs-lookup"><span data-stu-id="f1880-251">Make hello following changes in hello ToDoListAPI project.</span></span>

1. <span data-ttu-id="f1880-252">Olá abrir *Controllers/ToDoListController.cs* de arquivo e remova os comentários de linha de saudação em cada método de ação que define `owner` toohello AD do Azure `NameIdentifier` valor de declaração.</span><span class="sxs-lookup"><span data-stu-id="f1880-252">Open hello *Controllers/ToDoListController.cs* file, and uncomment hello line in each action method that sets `owner` toohello Azure AD `NameIdentifier` claim value.</span></span> <span data-ttu-id="f1880-253">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="f1880-253">For example:</span></span>
   
        owner = ((ClaimsIdentity)User.Identity).FindFirst(ClaimTypes.NameIdentifier).Value;
   
    <span data-ttu-id="f1880-254">**Importante**: não remova o código no hello `ToDoListDataAPI` método; você fará isso mais tarde para tutorial de autenticação principal do serviço hello.</span><span class="sxs-lookup"><span data-stu-id="f1880-254">**Important**: Don't uncomment code in hello `ToDoListDataAPI` method; you'll do that later for hello service principal authentication tutorial.</span></span>

### <a name="deploy-hello-todolistapi-project-tooazure"></a><span data-ttu-id="f1880-255">Implantar Olá ToDoListAPI projeto tooAzure</span><span class="sxs-lookup"><span data-stu-id="f1880-255">Deploy hello ToDoListAPI project tooAzure</span></span>
1. <span data-ttu-id="f1880-256">Em **Solution Explorer**, clique com botão direito Olá ToDoListAPI e, em seguida, clique em **publicar**.</span><span class="sxs-lookup"><span data-stu-id="f1880-256">In **Solution Explorer**, right-click hello ToDoListAPI project, and then click **Publish**.</span></span>
2. <span data-ttu-id="f1880-257">Clique em **Publicar**.</span><span class="sxs-lookup"><span data-stu-id="f1880-257">Click **Publish**.</span></span>
   
    <span data-ttu-id="f1880-258">Visual Studio implanta o projeto hello e abre URL de base de um navegador toohello aplicativo de API.</span><span class="sxs-lookup"><span data-stu-id="f1880-258">Visual Studio deploys hello project and opens a browser toohello API app's base URL.</span></span>
3. <span data-ttu-id="f1880-259">Navegador de saudação fechar.</span><span class="sxs-lookup"><span data-stu-id="f1880-259">Close hello browser.</span></span>

### <a name="test-hello-application"></a><span data-ttu-id="f1880-260">Testar o aplicativo hello</span><span class="sxs-lookup"><span data-stu-id="f1880-260">Test hello application</span></span>
1. <span data-ttu-id="f1880-261">Vá toohello URL do aplicativo web de hello, **usando HTTPS, não HTTP**.</span><span class="sxs-lookup"><span data-stu-id="f1880-261">Go toohello URL of hello web app, **using HTTPS, not HTTP**.</span></span>
2. <span data-ttu-id="f1880-262">Clique em Olá **tooDo lista** guia.</span><span class="sxs-lookup"><span data-stu-id="f1880-262">Click hello **tooDo List** tab.</span></span>
   
    <span data-ttu-id="f1880-263">Você está toolog solicitada no.</span><span class="sxs-lookup"><span data-stu-id="f1880-263">You are prompted toolog in.</span></span>
3. <span data-ttu-id="f1880-264">Faça logon com credenciais de saudação de um usuário em seu locatário do AAD.</span><span class="sxs-lookup"><span data-stu-id="f1880-264">Log in with hello credentials of a user in your AAD tenant.</span></span>
4. <span data-ttu-id="f1880-265">Olá **tooDo lista** página será exibida.</span><span class="sxs-lookup"><span data-stu-id="f1880-265">hello **tooDo List** page appears.</span></span>
   
   ![página de lista de tooDo](./media/app-service-api-dotnet-user-principal-auth/webappindex.png)
   
   <span data-ttu-id="f1880-267">Não são exibidos itens pendentes porque, até agora, todos eles eram para o proprietário "*".</span><span class="sxs-lookup"><span data-stu-id="f1880-267">No to-do items are displayed because until now they have all been for owner "*".</span></span> <span data-ttu-id="f1880-268">Agora camada intermediária hello está solicitando itens para Olá logon do usuário e nenhum foi criado.</span><span class="sxs-lookup"><span data-stu-id="f1880-268">Now hello middle tier is requesting items for hello logged-on user, and none have been created yet.</span></span>
5. <span data-ttu-id="f1880-269">Adicione novo tooverify de itens de tarefas que o aplicativo hello está funcionando.</span><span class="sxs-lookup"><span data-stu-id="f1880-269">Add new to-do items tooverify that hello application is working.</span></span>
6. <span data-ttu-id="f1880-270">Em outra janela do navegador, vá toohello URL Swagger de interface do usuário para o aplicativo de API ToDoListDataAPI hello e clique em **ToDoList > obter**.</span><span class="sxs-lookup"><span data-stu-id="f1880-270">In another browser window, go toohello Swagger UI URL for hello ToDoListDataAPI API app and click **ToDoList > Get**.</span></span> <span data-ttu-id="f1880-271">Insira um asterisco para Olá `owner` parâmetro e clique **Experimente**.</span><span class="sxs-lookup"><span data-stu-id="f1880-271">Enter an asterisk for hello `owner` parameter, and then click **Try it out**.</span></span>
   
   <span data-ttu-id="f1880-272">resposta de saudação mostra que o novos itens de tarefas pendentes Olá têm ID de usuário Olá real do AD do Azure na propriedade do proprietário hello.</span><span class="sxs-lookup"><span data-stu-id="f1880-272">hello response shows that hello new to-do items have hello actual Azure AD user ID in hello Owner property.</span></span>
   
   ![ID do proprietário na resposta JSON](./media/app-service-api-dotnet-user-principal-auth/todolistapiauth.png)

## <a name="building-hello-projects-from-scratch"></a><span data-ttu-id="f1880-274">Compilando projetos de saudação do zero</span><span class="sxs-lookup"><span data-stu-id="f1880-274">Building hello projects from scratch</span></span>
<span data-ttu-id="f1880-275">projetos de API da Web Hello dois foram criados usando Olá **aplicativo de API do Azure** modelo e substituindo controlador de valores padrão de saudação com um controlador de lista de tarefas do projeto.</span><span class="sxs-lookup"><span data-stu-id="f1880-275">hello two Web API projects were created by using hello **Azure API App** project template and replacing hello default Values controller with a ToDoList controller.</span></span> 

<span data-ttu-id="f1880-276">Para obter informações sobre como criar também um aplicativo de página única AngularJS com um back-end da Web API 2, consulte [mãos no laboratório: criar um aplicativo de página única (SPA) com a API da Web do ASP.NET e Angular.js](http://www.asp.net/web-api/overview/getting-started-with-aspnet-web-api/build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs).</span><span class="sxs-lookup"><span data-stu-id="f1880-276">For information about how too create an AngularJS single-page application with a Web API 2 back end, see  [Hands On Lab: Build a Single Page Application (SPA) with ASP.NET Web API and Angular.js](http://www.asp.net/web-api/overview/getting-started-with-aspnet-web-api/build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs).</span></span> <span data-ttu-id="f1880-277">Para obter informações sobre como tooadd código de autenticação do AD do Azure, consulte Olá recursos a seguir:</span><span class="sxs-lookup"><span data-stu-id="f1880-277">For information about how tooadd Azure AD authentication code, see hello following resources:</span></span>

* <span data-ttu-id="f1880-278">[Como proteger aplicativos de página única AngularJS com o Azure AD](../active-directory/active-directory-devquickstarts-angular.md).</span><span class="sxs-lookup"><span data-stu-id="f1880-278">[Securing AngularJS Single Page Apps with Azure AD](../active-directory/active-directory-devquickstarts-angular.md).</span></span>
* [<span data-ttu-id="f1880-279">Apresentação da ADAL JS v1</span><span class="sxs-lookup"><span data-stu-id="f1880-279">Introducing ADAL JS v1</span></span>](http://www.cloudidentity.com/blog/2015/02/19/introducing-adal-js-v1/)

## <a name="troubleshooting"></a><span data-ttu-id="f1880-280">Solução de problemas</span><span class="sxs-lookup"><span data-stu-id="f1880-280">Troubleshooting</span></span>
[!INCLUDE [troubleshooting](../../includes/app-service-api-auth-troubleshooting.md)]

* <span data-ttu-id="f1880-281">Não confunda ToDoListAPI (camada intermediária) e ToDoListDataAPI (camada de dados).</span><span class="sxs-lookup"><span data-stu-id="f1880-281">Make sure that you don't confuse ToDoListAPI (middle tier) and ToDoListDataAPI (data tier).</span></span> <span data-ttu-id="f1880-282">Por exemplo, verifique se você adicionou o aplicativo de API do autenticação toohello camada intermediária, camada de dados do hello.</span><span class="sxs-lookup"><span data-stu-id="f1880-282">For example, verify that you added authentication toohello middle tier API app, not hello data tier.</span></span> 
* <span data-ttu-id="f1880-283">Certifique-se de que a URL do aplicativo hello API de camada intermediária Olá do referências de código de origem AngularJS (ToDoListAPI, não ToDoListDataAPI) e hello corrigir ID de cliente do AD do Azure.</span><span class="sxs-lookup"><span data-stu-id="f1880-283">Make sure that hello AngularJS source code references hello middle tier API app URL (ToDoListAPI, not ToDoListDataAPI)and hello correct Azure AD client ID.</span></span> 

## <a name="next-steps"></a><span data-ttu-id="f1880-284">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="f1880-284">Next steps</span></span>
<span data-ttu-id="f1880-285">Neste tutorial, você aprendeu como toouse autenticação de serviço de aplicativo para um aplicativo de API e como toocall Olá aplicativo de API usando Olá biblioteca ADAL JS.</span><span class="sxs-lookup"><span data-stu-id="f1880-285">In this tutorial you learned how toouse App Service authentication for an API app and how toocall hello API app by using hello ADAL JS library.</span></span> <span data-ttu-id="f1880-286">Olá Avançar tutorial você aprenderá como muito[acesso seguro tooyour API do aplicativo para cenários de serviço a serviço](app-service-api-dotnet-service-principal-auth.md).</span><span class="sxs-lookup"><span data-stu-id="f1880-286">In hello next tutorial you'll learn how too[secure access tooyour API app for service-to-service scenarios](app-service-api-dotnet-service-principal-auth.md).</span></span>

