---
title: "aaaWrite aplicativos que usam filas do barramento de serviço do Azure | Microsoft Docs"
description: "Como toowrite um aplicativo simple baseado em fila que usa o barramento de serviço do Azure."
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: 754d91b3-1426-405e-84b4-fd36d65b114a
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 08/07/2017
ms.author: sethm
ms.openlocfilehash: 93b75902a06becd6e33e05298e09f5669d0e2aef
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="create-applications-that-use-service-bus-queues"></a><span data-ttu-id="ab2aa-103">Criar aplicativos que usem as filas do Barramento de Serviço</span><span class="sxs-lookup"><span data-stu-id="ab2aa-103">Create applications that use Service Bus queues</span></span>
<span data-ttu-id="ab2aa-104">Este tópico descreve as filas do barramento de serviço e mostra como toowrite um aplicativo simple baseado em fila que usa o barramento de serviço.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-104">This topic describes Service Bus queues and shows how toowrite a simple queue-based application that uses Service Bus.</span></span>

<span data-ttu-id="ab2aa-105">Considere um cenário de Olá mundo de varejo em que os dados de vendas de individuais Point-of-Sale (POS) terminais devem ser roteados tooan sistema de gerenciamento de estoque que usa Olá dados toodetermine quando deve toobe ocorrer a reposição do estoque.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-105">Consider a scenario from hello world of retail in which sales data from individual Point-of-Sale (POS) terminals must be routed tooan inventory management system that uses hello data toodetermine when stock has toobe replenished.</span></span> <span data-ttu-id="ab2aa-106">Esta solução usa o barramento de serviço do sistema de mensagens para comunicação de saudação entre terminais hello e sistema de gerenciamento de estoque hello, conforme ilustrado na figura a seguir de saudação:</span><span class="sxs-lookup"><span data-stu-id="ab2aa-106">This solution uses Service Bus messaging for hello communication between hello terminals and hello inventory management system, as illustrated in hello following figure:</span></span>

![Filas de Barramento de Serviço imagem 1](./media/service-bus-create-queues/IC657161.gif)

<span data-ttu-id="ab2aa-108">Cada terminal de POS transmite seus dados de vendas enviando mensagens toohello **DataCollectionQueue**.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-108">Each POS terminal reports its sales data by sending messages toohello **DataCollectionQueue**.</span></span> <span data-ttu-id="ab2aa-109">Essas mensagens permanecem nessa fila até que eles são recuperados pelo sistema de gerenciamento de estoque hello.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-109">These messages remain in this queue until they are retrieved by hello inventory management system.</span></span> <span data-ttu-id="ab2aa-110">Esse padrão é geralmente denominado *mensagens assíncronas*, porque o terminal de POS da saudação não tem toowait por uma resposta do processamento de toocontinue de sistema do gerenciamento de estoque hello.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-110">This pattern is often termed *asynchronous messaging*, because hello POS terminal does not have toowait for a reply from hello inventory management system toocontinue processing.</span></span>

## <a name="why-queuing"></a><span data-ttu-id="ab2aa-111">Por que usar filas?</span><span class="sxs-lookup"><span data-stu-id="ab2aa-111">Why queuing?</span></span>
<span data-ttu-id="ab2aa-112">Antes de examinarmos o código Olá tooset necessária a esse aplicativo, considere as vantagens de saudação do uso de uma fila nesse cenário, em vez de ter os terminais de POS da saudação falar diretamente (de forma síncrona) toohello inventário de sistema de gerenciamento.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-112">Before we look at hello code that is required tooset up this application, consider hello advantages of using a queue in this scenario instead of having hello POS terminals talk directly (synchronously) toohello inventory management system.</span></span>

### <a name="temporal-decoupling"></a><span data-ttu-id="ab2aa-113">Desacoplamento temporal</span><span class="sxs-lookup"><span data-stu-id="ab2aa-113">Temporal decoupling</span></span>
<span data-ttu-id="ab2aa-114">Com o padrão de mensagens assíncronas hello, produtores e consumidores não há toobe online Olá simultaneamente.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-114">With hello asynchronous messaging pattern, producers and consumers do not have toobe online at hello same time.</span></span> <span data-ttu-id="ab2aa-115">infraestrutura de mensagens de saudação confiável armazena as mensagens até a parte consumidora Olá é tooreceive pronto-los.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-115">hello messaging infrastructure reliably stores messages until hello consuming party is ready tooreceive them.</span></span> <span data-ttu-id="ab2aa-116">Isso significa que componentes de saudação do aplicativo hello distribuída podem ser desconectados, ou voluntariamente; Por exemplo, para manutenção ou devido a falha do componente tooa, sem afetar o sistema inteiro hello.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-116">This means hello components of hello distributed application can be disconnected, either voluntarily; for example, for maintenance, or due tooa component crash, without affecting hello whole system.</span></span> <span data-ttu-id="ab2aa-117">Além disso, Olá consumindo o aplicativo pode ter somente toobe online durante determinadas horas do dia de saudação.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-117">Furthermore, hello consuming application may only have toobe online during certain times of hello day.</span></span> <span data-ttu-id="ab2aa-118">Por exemplo, no cenário de varejo, sistema de gerenciamento de estoque Olá pode ter somente toocome online após o término de saudação do dia de trabalho de saudação.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-118">For example, in this retail scenario, hello inventory management system may only have toocome online after hello end of hello business day.</span></span>

### <a name="load-leveling"></a><span data-ttu-id="ab2aa-119">Nivelamento de carga</span><span class="sxs-lookup"><span data-stu-id="ab2aa-119">Load leveling</span></span>
<span data-ttu-id="ab2aa-120">Em muitos aplicativos de carga do sistema varia ao longo do tempo, enquanto que o tempo de processamento de saudação necessário para cada unidade de trabalho é normalmente constante.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-120">In many applications system load varies over time, whereas hello processing time required for each unit of work is typically constant.</span></span> <span data-ttu-id="ab2aa-121">A intermediação mensagem produtores e consumidores com um meio de fila que Olá aplicativo de consumo (trabalho Olá) tem apenas toobe provisionados tooservice uma média de carga em vez de uma carga de pico.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-121">Intermediating message producers and consumers with a queue means that hello consuming application (hello worker) only has toobe provisioned tooservice an average load rather than a peak load.</span></span> <span data-ttu-id="ab2aa-122">profundidade de saudação da fila de saudação crescerão e contrato como Olá carga de entrada varia.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-122">hello depth of hello queue will grow and contract as hello incoming load varies.</span></span> <span data-ttu-id="ab2aa-123">Isso economiza o dinheiro diretamente com valor de toohello considerar a infraestrutura necessária tooservice Olá de carregamento de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-123">This directly saves money with regard toohello amount of infrastructure required tooservice hello application load.</span></span>

![Filas de Barramento de Serviço imagem 2](./media/service-bus-create-queues/IC657162.gif)

### <a name="load-balancing"></a><span data-ttu-id="ab2aa-125">Balanceamento de carga</span><span class="sxs-lookup"><span data-stu-id="ab2aa-125">Load balancing</span></span>
<span data-ttu-id="ab2aa-126">Como Olá carga aumenta, mais processos de trabalho podem ser adicionado tooread da fila de trabalho hello.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-126">As hello load increases, more worker processes can be added tooread from hello worker queue.</span></span> <span data-ttu-id="ab2aa-127">Cada mensagem é processada por apenas um dos processos de trabalho hello.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-127">Each message is processed by only one of hello worker processes.</span></span> <span data-ttu-id="ab2aa-128">Além disso, esse balanceamento de carga baseado em pull permite o uso otimizado dos computadores de trabalho Olá mesmo que Olá computadores tenham diferentes com capacidade de tooprocessing de relação, como eles efetuarão pull das mensagens em sua própria velocidade máxima.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-128">Furthermore, this pull-based load balancing allows for optimum usage of hello worker computers even if hello worker computers differ with regard tooprocessing power, as they will pull messages at their own maximum rate.</span></span> <span data-ttu-id="ab2aa-129">Esse padrão é geralmente denominado padrão de consumidor concorrente hello.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-129">This pattern is often termed hello competing consumer pattern.</span></span>

![Filas de Barramento de Serviço imagem 3](./media/service-bus-create-queues/IC657163.gif)

### <a name="loose-coupling"></a><span data-ttu-id="ab2aa-131">Acoplamento flexível</span><span class="sxs-lookup"><span data-stu-id="ab2aa-131">Loose coupling</span></span>
<span data-ttu-id="ab2aa-132">Usar toointermediate enfileiramento de mensagens entre os consumidores e produtores de mensagens fornece um acoplamento flexível intrínseco entre os componentes de saudação.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-132">Using message queuing toointermediate between message producers and consumers provides an intrinsic loose coupling between hello components.</span></span> <span data-ttu-id="ab2aa-133">Como produtores e consumidores não têm conhecimento uns dos outros, um consumidor pode ser atualizado sem causar qualquer impacto produtor hello.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-133">Because producers and consumers are not aware of each other, a consumer can be upgraded without having any effect on hello producer.</span></span> <span data-ttu-id="ab2aa-134">Além disso, Olá topologia de mensagens poderá evoluir sem afetar a pontos de extremidade existentes hello.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-134">Furthermore, hello messaging topology can evolve without affecting hello existing endpoints.</span></span> <span data-ttu-id="ab2aa-135">Discutiremos um pouco mais desse assunto quando falarmos sobre publicação/assinatura.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-135">We’ll discuss this more when we talk about publish/subscribe.</span></span>

## <a name="show-me-hello-code"></a><span data-ttu-id="ab2aa-136">Mostre-me Olá código</span><span class="sxs-lookup"><span data-stu-id="ab2aa-136">Show me hello code</span></span>
<span data-ttu-id="ab2aa-137">Olá a seguinte seção mostra como toobuild do barramento de serviço toouse este aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-137">hello following section shows how toouse Service Bus toobuild this application.</span></span>

### <a name="sign-up-for-an-azure-account"></a><span data-ttu-id="ab2aa-138">Inscrever-se em uma conta do Azure</span><span class="sxs-lookup"><span data-stu-id="ab2aa-138">Sign up for an Azure account</span></span>
<span data-ttu-id="ab2aa-139">Você precisará de uma conta do Azure em ordem toostart trabalhando com o barramento de serviço.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-139">You’ll need an Azure account in order toostart working with Service Bus.</span></span> <span data-ttu-id="ab2aa-140">Se você ainda não tiver uma assinatura, poderá se inscrever em uma conta gratuita [aqui](https://azure.microsoft.com/pricing/free-trial/?WT.mc_id=A85619ABF).</span><span class="sxs-lookup"><span data-stu-id="ab2aa-140">If you do not already have one, you can sign up for a free account [here](https://azure.microsoft.com/pricing/free-trial/?WT.mc_id=A85619ABF).</span></span>

### <a name="create-a-namespace"></a><span data-ttu-id="ab2aa-141">Criar um namespace</span><span class="sxs-lookup"><span data-stu-id="ab2aa-141">Create a namespace</span></span>
<span data-ttu-id="ab2aa-142">Quando tiver uma assinatura, você poderá [criar um novo namespace](service-bus-create-namespace-portal.md).</span><span class="sxs-lookup"><span data-stu-id="ab2aa-142">Once you have a subscription, you can [create a service namespace](service-bus-create-namespace-portal.md).</span></span> <span data-ttu-id="ab2aa-143">Cada namespace age como um contêiner de escopo para um conjunto de entidades do Barramento de Serviço.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-143">Each namespace acts as a scoping container for a set of Service Bus entities.</span></span> <span data-ttu-id="ab2aa-144">Dê um nome exclusivo ao seu novo namespace em todas as contas do Barramento de Serviço.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-144">Give your new namespace a unique name across all Service Bus accounts.</span></span> 

### <a name="install-hello-nuget-package"></a><span data-ttu-id="ab2aa-145">Instalar o pacote do NuGet Olá</span><span class="sxs-lookup"><span data-stu-id="ab2aa-145">Install hello NuGet package</span></span>
<span data-ttu-id="ab2aa-146">namespace de barramento de serviço do toouse hello, um aplicativo deve fazer referência a saudação assembly do barramento de serviço, especificamente o Microsoft.ServiceBus.dll.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-146">toouse hello Service Bus namespace, an application must reference hello Service Bus assembly, specifically Microsoft.ServiceBus.dll.</span></span> <span data-ttu-id="ab2aa-147">Você pode encontrar esse assembly como parte do SDK do Microsoft Azure de saudação e download de saudação está disponível na Olá [página de download do SDK do Azure](https://azure.microsoft.com/downloads/).</span><span class="sxs-lookup"><span data-stu-id="ab2aa-147">You can find this assembly as part of hello Microsoft Azure SDK, and hello download is available at hello [Azure SDK download page](https://azure.microsoft.com/downloads/).</span></span> <span data-ttu-id="ab2aa-148">No entanto, Olá [pacote NuGet do barramento de serviço](https://www.nuget.org/packages/WindowsAzure.ServiceBus) é Olá mais fácil maneira tooget Olá API do barramento de serviço e tooconfigure seu aplicativo com todas as dependências de barramento de serviço hello.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-148">However, hello [Service Bus NuGet package](https://www.nuget.org/packages/WindowsAzure.ServiceBus) is hello easiest way tooget hello Service Bus API and tooconfigure your application with all of hello Service Bus dependencies.</span></span>

### <a name="create-hello-queue"></a><span data-ttu-id="ab2aa-149">Criar fila Olá</span><span class="sxs-lookup"><span data-stu-id="ab2aa-149">Create hello queue</span></span>
<span data-ttu-id="ab2aa-150">Operações de gerenciamento para entidades de mensagens (filas e a publicação/assinatura tópicos) são executadas por meio de saudação do barramento de serviço [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) classe.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-150">Management operations for Service Bus messaging entities (queues and publish/subscribe topics) are performed via hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) class.</span></span> <span data-ttu-id="ab2aa-151">O Barramento de Serviço usa um modelo de segurança baseado na [Assinatura de Acesso Compartilhado (SAS)](service-bus-sas.md).</span><span class="sxs-lookup"><span data-stu-id="ab2aa-151">Service Bus uses a [Shared Access Signature (SAS)](service-bus-sas.md) based security model.</span></span> <span data-ttu-id="ab2aa-152">Olá [TokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider) classe representa um provedor de token de segurança com métodos de fábrica interna retornando alguns provedores de token bem conhecidos.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-152">hello [TokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider) class represents a security token provider with built-in factory methods returning some well-known token providers.</span></span> <span data-ttu-id="ab2aa-153">Usaremos uma [CreateSharedAccessSignatureTokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider#Microsoft_ServiceBus_TokenProvider_CreateSharedAccessSignatureTokenProvider_System_String_) credenciais do método toohold Olá SAS.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-153">We’ll use a [CreateSharedAccessSignatureTokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider#Microsoft_ServiceBus_TokenProvider_CreateSharedAccessSignatureTokenProvider_System_String_) method toohold hello SAS credentials.</span></span> <span data-ttu-id="ab2aa-154">Olá [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) instância é construída com o endereço base Olá Olá namespace de barramento de serviço e o provedor de token de saudação.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-154">hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) instance is then constructed with hello base address of hello Service Bus namespace and hello token provider.</span></span>

<span data-ttu-id="ab2aa-155">Olá [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) classe fornece métodos toocreate, enumerar e excluir entidades de mensagens.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-155">hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) class provides methods toocreate, enumerate and delete messaging entities.</span></span> <span data-ttu-id="ab2aa-156">Olá código mostrado aqui mostra como Olá [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) instância é criada e usada toocreate Olá **DataCollectionQueue** fila.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-156">hello code that is shown here shows how hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) instance is created and used toocreate hello **DataCollectionQueue** queue.</span></span>

```csharp
Uri uri = ServiceBusEnvironment.CreateServiceUri("sb", 
                "test-blog", string.Empty);
string name = "RootManageSharedAccessKey";
string key = "abcdefghijklmopqrstuvwxyz";

TokenProvider tokenProvider = 
    TokenProvider.CreateSharedAccessSignatureTokenProvider(name, key);
NamespaceManager namespaceManager = 
    new NamespaceManager(uri, tokenProvider);
namespaceManager.CreateQueue("DataCollectionQueue");
```

<span data-ttu-id="ab2aa-157">Observe que há sobrecargas de saudação [CreateQueue](/dotnet/api/microsoft.servicebus.namespacemanager#Microsoft_ServiceBus_NamespaceManager_CreateQueue_System_String_) método que permitem que propriedades de saudação fila toobe ajustadas.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-157">Note that there are overloads of hello [CreateQueue](/dotnet/api/microsoft.servicebus.namespacemanager#Microsoft_ServiceBus_NamespaceManager_CreateQueue_System_String_) method that enable properties of hello queue toobe tuned.</span></span> <span data-ttu-id="ab2aa-158">Por exemplo, você pode definir Olá time-to-live (TTL) valor padrão para mensagens enviadas da fila de toohello.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-158">For example, you can set hello default time-to-live (TTL) value for messages sent toohello queue.</span></span>

### <a name="send-messages-toohello-queue"></a><span data-ttu-id="ab2aa-159">Mensagens toohello fila de envio</span><span class="sxs-lookup"><span data-stu-id="ab2aa-159">Send messages toohello queue</span></span>
<span data-ttu-id="ab2aa-160">Para operações de tempo de execução em entidades do Barramento de Serviço; por exemplo, para enviar e receber mensagens, primeiro um aplicativo deverá criar um objeto [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory).</span><span class="sxs-lookup"><span data-stu-id="ab2aa-160">For run-time operations on Service Bus entities; for example, sending and receiving messages, an application must first create a [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) object.</span></span> <span data-ttu-id="ab2aa-161">Semelhante toohello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) classe hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) instância é criada a partir do endereço de base de saudação do hello namespace de serviço e o provedor de token de saudação.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-161">Similar toohello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) class, hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) instance is created from hello base address of hello service namespace and hello token provider.</span></span>

```csharp
 BrokeredMessage bm = new BrokeredMessage(salesData);
 bm.Label = "SalesReport";
 bm.Properties["StoreName"] = "Redmond";
 bm.Properties["MachineID"] = "POS_1";
```

<span data-ttu-id="ab2aa-162">As mensagens enviadas para e recebidas do barramento de serviço filas são instâncias da saudação [BrokeredMessage](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage) classe.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-162">Messages sent to, and received from Service Bus queues are instances of hello [BrokeredMessage](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage) class.</span></span> <span data-ttu-id="ab2aa-163">Essa classe consiste em um conjunto de propriedades padrão (como [rótulo](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label) e [TimeToLive](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_TimeToLive)), um dicionário que é usado toohold propriedades do aplicativo e um corpo de dados arbitrários do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-163">This class consists of a set of standard properties (such as [Label](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label) and [TimeToLive](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_TimeToLive)), a dictionary that is used toohold application properties, and a body of arbitrary application data.</span></span> <span data-ttu-id="ab2aa-164">Um aplicativo pode definir corpo Olá passando qualquer objeto serializável (hello exemplo a seguir passa um **SalesData** objeto que representa os dados de vendas de saudação do terminal de POS da saudação), que usará Olá [ DataContractSerializer](https://msdn.microsoft.com/library/system.runtime.serialization.datacontractserializer.aspx) tooserialize objeto de saudação.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-164">An application can set hello body by passing in any serializable object (hello following example passes in a **SalesData** object that represents hello sales data from hello POS terminal), which will use hello [DataContractSerializer](https://msdn.microsoft.com/library/system.runtime.serialization.datacontractserializer.aspx) tooserialize hello object.</span></span> <span data-ttu-id="ab2aa-165">Como alternativa, poderá ser fornecido um objeto [Stream](https://msdn.microsoft.com/library/system.io.stream.aspx).</span><span class="sxs-lookup"><span data-stu-id="ab2aa-165">Alternatively, a [Stream](https://msdn.microsoft.com/library/system.io.stream.aspx) object can be provided.</span></span>

<span data-ttu-id="ab2aa-166">Olá mais fácil maneira toosend mensagens tooa fornecido fila, no nosso caso Olá **DataCollectionQueue**, é toouse [CreateMessageSender](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageSender_System_String_) toocreate um [MessageSender](/dotnet/api/microsoft.servicebus.messaging.messagesender) objeto diretamente da saudação [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) instância.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-166">hello easiest way toosend messages tooa given queue, in our case hello **DataCollectionQueue**, is toouse [CreateMessageSender](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageSender_System_String_) toocreate a [MessageSender](/dotnet/api/microsoft.servicebus.messaging.messagesender) object directly from hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) instance.</span></span>

```csharp
MessageSender sender = factory.CreateMessageSender("DataCollectionQueue");
sender.Send(bm);
```

### <a name="receiving-messages-from-hello-queue"></a><span data-ttu-id="ab2aa-167">Receber mensagens da fila de saudação</span><span class="sxs-lookup"><span data-stu-id="ab2aa-167">Receiving messages from hello queue</span></span>
<span data-ttu-id="ab2aa-168">tooreceive mensagens da fila de saudação, você pode usar um [MessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagereceiver) objeto que criar diretamente de saudação [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) usando [CreateMessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageReceiver_System_String_).</span><span class="sxs-lookup"><span data-stu-id="ab2aa-168">tooreceive messages from hello queue, you can use a [MessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagereceiver) object which you create directly from hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) using [CreateMessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageReceiver_System_String_).</span></span> <span data-ttu-id="ab2aa-169">Os receptores da mensagem poderão trabalhar em dois modos diferentes: **ReceiveAndDelete** e **PeekLock**.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-169">Message receivers can work in two different modes: **ReceiveAndDelete** and **PeekLock**.</span></span> <span data-ttu-id="ab2aa-170">Olá [ReceiveMode](/dotnet/api/microsoft.servicebus.messaging.receivemode) é definido quando o destinatário da mensagem de saudação é criado, como um parâmetro toohello [CreateMessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagingfactory?redirectedfrom=MSDN#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageReceiver_System_String_Microsoft_ServiceBus_Messaging_ReceiveMode_) chamar.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-170">hello [ReceiveMode](/dotnet/api/microsoft.servicebus.messaging.receivemode) is set when hello message receiver is created, as a parameter toohello [CreateMessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagingfactory?redirectedfrom=MSDN#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageReceiver_System_String_Microsoft_ServiceBus_Messaging_ReceiveMode_) call.</span></span>

<span data-ttu-id="ab2aa-171">Ao usar o hello **ReceiveAndDelete** modo, Olá recebe é uma operação única etapa; ou seja, quando o barramento de serviço recebe a solicitação de hello, ele marca a mensagem de saudação como sendo consumida e retorna-toohello aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-171">When using hello **ReceiveAndDelete** mode, hello receive is a single-shot operation; that is, when Service Bus receives hello request, it marks hello message as being consumed and returns it toohello application.</span></span> <span data-ttu-id="ab2aa-172">**ReceiveAndDelete** modo é o modelo mais simples de saudação e funciona melhor para cenários nos quais Olá aplicativo pode tolerar não processar uma mensagem se uma falha de toooccur.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-172">**ReceiveAndDelete** mode is hello simplest model and works best for scenarios in which hello application can tolerate not processing a message if a failure were toooccur.</span></span> <span data-ttu-id="ab2aa-173">toounderstand isso, considere um cenário em que problemas do consumidor Olá Olá receber a solicitação e falha antes de processá-lo.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-173">toounderstand this, consider a scenario in which hello consumer issues hello receive request and then crashes before processing it.</span></span> <span data-ttu-id="ab2aa-174">Desde que o barramento de serviço marcado como mensagem de saudação como sendo consumida, quando reiniciar o aplicativo hello e começa a consumir mensagens novamente, ele terá perdido mensagem de saudação consumido antes da falha de saudação.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-174">Since Service Bus marked hello message as being consumed, when hello application restarts and starts consuming messages again, it will have missed hello message that was consumed before hello crash.</span></span>

<span data-ttu-id="ab2aa-175">Em **PeekLock** receber de saudação do modo, torna-se uma operação de dois estágios, o que torna possível toosupport aplicativos que não podem tolerar mensagens ausentes.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-175">In **PeekLock** mode, hello receive becomes a two-stage operation, which makes it possible toosupport applications that cannot tolerate missing messages.</span></span> <span data-ttu-id="ab2aa-176">Quando o barramento de serviço recebe a solicitação de hello, ele localiza Olá próxima mensagem toobe consumida, boqueia-tooprevent outros consumidores a recebam e retorna toohello aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-176">When Service Bus receives hello request, it finds hello next message toobe consumed, locks it tooprevent other consumers receiving it, and then returns it toohello application.</span></span> <span data-ttu-id="ab2aa-177">Depois que o aplicativo hello termina de processar a mensagem de saudação (ou armazena com segurança para processamento futuro), ele conclui Olá segunda etapa de saudação processo de recebimento chamando [concluir](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete) na mensagem recebida.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-177">After hello application finishes processing hello message (or stores it reliably for future processing), it completes hello second stage of hello receive process by calling [Complete](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete) on hello received message.</span></span> <span data-ttu-id="ab2aa-178">Quando o Service Bus vê Olá [concluir](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete) chamada, ele marca a mensagem de saudação como sendo consumida.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-178">When Service Bus sees hello [Complete](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete) call, it marks hello message as being consumed.</span></span>

<span data-ttu-id="ab2aa-179">Dois outros resultados são possíveis.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-179">Two other outcomes are possible.</span></span> <span data-ttu-id="ab2aa-180">Primeiro, se o aplicativo hello não puder tooprocess Olá mensagem por algum motivo, ele pode chamar [abandonar](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Abandon) na mensagem recebida (em vez de [concluir](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete)).</span><span class="sxs-lookup"><span data-stu-id="ab2aa-180">First, if hello application is unable tooprocess hello message for some reason, it can call [Abandon](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Abandon) on hello received message (instead of [Complete](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete)).</span></span> <span data-ttu-id="ab2aa-181">Isso faz com que a mensagem de saudação do barramento de serviço toounlock e torná-lo disponível toobe recebida novamente, pelo Olá mesmo consumidor ou por outro consumidor de conclusão.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-181">This causes Service Bus toounlock hello message and make it available toobe received again, either by hello same consumer or by another completing consumer.</span></span> <span data-ttu-id="ab2aa-182">Segundo, há um tempo limite associado Olá bloqueio e se o aplicativo hello não é possível processar a mensagem de saudação antes Olá bloqueio tempo limite expirar (por exemplo, se o aplicativo hello falhar), e o barramento de serviço desbloquear Olá mensagem e torná-lo disponível toobe recebida novamente (basicamente a realização de uma [abandonar](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Abandon) operação por padrão).</span><span class="sxs-lookup"><span data-stu-id="ab2aa-182">Second, there is a time-out associated with hello lock and if hello application cannot process hello message before hello lock time-out expires (for example, if hello application crashes), then Service Bus will unlock hello message and make it available toobe received again (essentially performing an [Abandon](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Abandon) operation by default).</span></span>

<span data-ttu-id="ab2aa-183">Observe que, se hello aplicativo falhar após processar a mensagem de saudação, mas antes de saudação [concluir](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete) solicitação foi emitida, a mensagem será entregue novamente toohello aplicativo quando ele for reiniciado.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-183">Note that if hello application crashes after it processes hello message but before hello [Complete](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete) request was issued, hello message will be redelivered toohello application when it restarts.</span></span> <span data-ttu-id="ab2aa-184">Isso é geralmente denominado * pelo menos uma vez * processamento.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-184">This is often termed *At Least Once * processing.</span></span> <span data-ttu-id="ab2aa-185">Isso significa que cada mensagem será processada pelo menos uma vez, mas em certo Olá situações mesma mensagem pode ser entregue novamente.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-185">This means that each message will be processed at least once but in certain situations hello same message may be redelivered.</span></span> <span data-ttu-id="ab2aa-186">Se o cenário de saudação não puder tolerar o processamento duplicado, lógica adicional será necessária em duplicatas de toodetect aplicativo hello.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-186">If hello scenario cannot tolerate duplicate processing, then additional logic is required in hello application toodetect duplicates.</span></span> <span data-ttu-id="ab2aa-187">Isso pode ser feito com base em Olá [MessageId](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_MessageId) propriedade de mensagem de saudação.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-187">This can be achieved based on hello [MessageId](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_MessageId) property of hello message.</span></span> <span data-ttu-id="ab2aa-188">valor Olá dessa propriedade permanece constante entre tentativas de entrega.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-188">hello value of this property remains constant across delivery attempts.</span></span> <span data-ttu-id="ab2aa-189">Isso é conhecido como processamento *Exatamente Uma Vez*.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-189">This is termed *Exactly Once* processing.</span></span>

<span data-ttu-id="ab2aa-190">Olá código mostrado aqui recebe e processa uma mensagem usando Olá **PeekLock** modo, o que é o padrão de saudação se nenhum [ReceiveMode](/dotnet/api/microsoft.servicebus.messaging.receivemode) valor é explicitamente fornecido.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-190">hello code that is shown here receives and processes a message using hello **PeekLock** mode, which is hello default if no [ReceiveMode](/dotnet/api/microsoft.servicebus.messaging.receivemode) value is explicitly provided.</span></span>

```csharp
MessageReceiver receiver = factory.CreateMessageReceiver("DataCollectionQueue");
BrokeredMessage receivedMessage = receiver.Receive();
try
{
    ProcessMessage(receivedMessage);
    receivedMessage.Complete();
}
catch (Exception e)
{
    receivedMessage.Abandon();
}
```

### <a name="use-hello-queue-client"></a><span data-ttu-id="ab2aa-191">Usar o cliente de fila Olá</span><span class="sxs-lookup"><span data-stu-id="ab2aa-191">Use hello queue client</span></span>
<span data-ttu-id="ab2aa-192">Olá exemplos anteriormente nesta seção criado [MessageSender](/dotnet/api/microsoft.servicebus.messaging.messagesender) e [MessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagereceiver) objetos diretamente da saudação [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) toosend e receber mensagens da fila de hello, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-192">hello examples earlier in this section created [MessageSender](/dotnet/api/microsoft.servicebus.messaging.messagesender) and [MessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagereceiver) objects directly from hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) toosend and receive messages from hello queue, respectively.</span></span> <span data-ttu-id="ab2aa-193">Uma abordagem alternativa é toouse uma [QueueClient](/dotnet/api/microsoft.servicebus.messaging.queueclient) objeto, que oferece suporte para enviar e receber operações em adição toomore recursos avançados, como sessões.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-193">An alternative approach is toouse a [QueueClient](/dotnet/api/microsoft.servicebus.messaging.queueclient) object, which supports both send and receive operations in addition toomore advanced features, such as sessions.</span></span>

```csharp
QueueClient queueClient = factory.CreateQueueClient("DataCollectionQueue");
queueClient.Send(bm);

BrokeredMessage message = queueClient.Receive();

try
{
    ProcessMessage(message);
    message.Complete();
}
catch (Exception e)
{
    message.Abandon();
} 
```

## <a name="next-steps"></a><span data-ttu-id="ab2aa-194">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="ab2aa-194">Next steps</span></span>
<span data-ttu-id="ab2aa-195">Agora que você aprendeu as Noções básicas de saudação de filas, consulte [criar aplicativos que usam tópicos do barramento de serviço e as assinaturas](service-bus-create-topics-subscriptions.md) toocontinue esta discussão usando recursos de publicação/assinatura Olá dos tópicos do barramento de serviço e assinaturas.</span><span class="sxs-lookup"><span data-stu-id="ab2aa-195">Now that you've learned hello basics of queues, see [Create applications that use Service Bus topics and subscriptions](service-bus-create-topics-subscriptions.md) toocontinue this discussion using hello publish/subscribe capabilities of Service Bus topics and subscriptions.</span></span>

