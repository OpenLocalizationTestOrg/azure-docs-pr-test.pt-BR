---
title: "Visão geral da arquitetura de processamento de mensagens do Barramento de Serviço do Azure | Microsoft Docs"
description: "Descreve a arquitetura de processamento de mensagens do Barramento de Serviço do Azure."
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: baf94c2d-0e58-4d5d-a588-767f996ccf7f
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: get-started-article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 08/23/2017
ms.author: sethm
ms.openlocfilehash: 83456d775c5ff2a2476ba46e9c78a8dc1bb482e8
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/29/2017
---
# <a name="service-bus-architecture"></a><span data-ttu-id="79be6-103">Arquitetura do Barramento de Serviço</span><span class="sxs-lookup"><span data-stu-id="79be6-103">Service Bus architecture</span></span>
<span data-ttu-id="79be6-104">Este artigo descreve a arquitetura de processamento de mensagens do Barramento de Serviço do Azure.</span><span class="sxs-lookup"><span data-stu-id="79be6-104">This article describes the message processing architecture of Azure Service Bus.</span></span>

## <a name="service-bus-scale-units"></a><span data-ttu-id="79be6-105">Unidades de escala do Barramento de Serviço</span><span class="sxs-lookup"><span data-stu-id="79be6-105">Service Bus scale units</span></span>
<span data-ttu-id="79be6-106">O Barramento de Serviço é organizado por *unidades de escala*.</span><span class="sxs-lookup"><span data-stu-id="79be6-106">Service Bus is organized by *scale units*.</span></span> <span data-ttu-id="79be6-107">Uma unidade de escala é uma unidade de implantação que contém todos os componentes necessários para executar o serviço.</span><span class="sxs-lookup"><span data-stu-id="79be6-107">A scale unit is a unit of deployment and contains all components required run the service.</span></span> <span data-ttu-id="79be6-108">Cada região implanta uma ou mais unidades de escala do Barramento de Serviço.</span><span class="sxs-lookup"><span data-stu-id="79be6-108">Each region deploys one or more Service Bus scale units.</span></span>

<span data-ttu-id="79be6-109">Um namespace de Barramento de Serviço é mapeado para uma unidade de escala.</span><span class="sxs-lookup"><span data-stu-id="79be6-109">A Service Bus namespace is mapped to a scale unit.</span></span> <span data-ttu-id="79be6-110">A unidade de escala trata todos os tipos de entidade do Barramento de Serviço (filas, tópicos, assinaturas).</span><span class="sxs-lookup"><span data-stu-id="79be6-110">The scale unit handles all types of Service Bus entities (queues, topics, subscriptions).</span></span> <span data-ttu-id="79be6-111">Uma unidade de escala do Barramento de Serviço consiste nos seguintes componentes:</span><span class="sxs-lookup"><span data-stu-id="79be6-111">A Service Bus scale unit consists of the following components:</span></span>

* <span data-ttu-id="79be6-112">**Um conjunto de nós de gateway.**</span><span class="sxs-lookup"><span data-stu-id="79be6-112">**A set of gateway nodes.**</span></span> <span data-ttu-id="79be6-113">Os nós de gateway autenticam solicitações de entrada.</span><span class="sxs-lookup"><span data-stu-id="79be6-113">Gateway nodes authenticate incoming requests.</span></span> <span data-ttu-id="79be6-114">Cada nó de gateway tem um endereço IP público.</span><span class="sxs-lookup"><span data-stu-id="79be6-114">Each gateway node has a public IP address.</span></span>
* <span data-ttu-id="79be6-115">**Um conjunto de nós do agente de mensagens.**</span><span class="sxs-lookup"><span data-stu-id="79be6-115">**A set of messaging broker nodes.**</span></span> <span data-ttu-id="79be6-116">Os nós do agente de mensagens processam solicitações referentes às entidades de mensagens.</span><span class="sxs-lookup"><span data-stu-id="79be6-116">Messaging broker nodes process requests concerning messaging entities.</span></span>
* <span data-ttu-id="79be6-117">**Um repositório de gateway.**</span><span class="sxs-lookup"><span data-stu-id="79be6-117">**One gateway store.**</span></span> <span data-ttu-id="79be6-118">O repositório de gateway mantém os dados para cada entidade definida nessa unidade de escala.</span><span class="sxs-lookup"><span data-stu-id="79be6-118">The gateway store holds the data for every entity that is defined in this scale unit.</span></span> <span data-ttu-id="79be6-119">O repositório de gateway é implementado sobre um banco de dados do SQL do Azure.</span><span class="sxs-lookup"><span data-stu-id="79be6-119">The gateway store is implemented on top of a SQL Azure database.</span></span>
* <span data-ttu-id="79be6-120">**Múltiplos repositórios de mensagens.**</span><span class="sxs-lookup"><span data-stu-id="79be6-120">**Multiple messaging stores.**</span></span> <span data-ttu-id="79be6-121">Repositórios de mensagens mantêm as mensagens de todas as filas, tópicos e assinaturas que são definidas na unidade de escala.</span><span class="sxs-lookup"><span data-stu-id="79be6-121">Messaging stores hold the messages of all queues, topics and subscriptions that are defined in this scale unit.</span></span> <span data-ttu-id="79be6-122">Eles também contêm todos os dados de assinatura.</span><span class="sxs-lookup"><span data-stu-id="79be6-122">It also contains all subscription data.</span></span> <span data-ttu-id="79be6-123">A menos que o [particionamento de entidades de mensagens](service-bus-partitioning.md) esteja habilitado, uma fila ou tópico é mapeado para um repositório de mensagens.</span><span class="sxs-lookup"><span data-stu-id="79be6-123">Unless [partitioning messaging entities](service-bus-partitioning.md) is enabled, a queue or topic is mapped to one messaging store.</span></span> <span data-ttu-id="79be6-124">As assinaturas são armazenadas no mesmo repositório de mensagens que o tópico pai.</span><span class="sxs-lookup"><span data-stu-id="79be6-124">Subscriptions are stored in the same messaging store as their parent topic.</span></span> <span data-ttu-id="79be6-125">Com exceção do [Sistema de Mensagens Premium](service-bus-premium-messaging.md)do Barramento de Serviço, os repositórios de mensagens são implementados no topo de bancos de dados do SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="79be6-125">Except for Service Bus [Premium Messaging](service-bus-premium-messaging.md), the messaging stores are implemented on top of SQL Azure databases.</span></span>

## <a name="containers"></a><span data-ttu-id="79be6-126">Contêineres</span><span class="sxs-lookup"><span data-stu-id="79be6-126">Containers</span></span>
<span data-ttu-id="79be6-127">Cada entidade de mensagens é atribuída a um contêiner específico.</span><span class="sxs-lookup"><span data-stu-id="79be6-127">Each messaging entity is assigned a specific container.</span></span> <span data-ttu-id="79be6-128">Um contêiner é um constructo lógico que utiliza exatamente um repositório de mensagens para todos os dados relevantes para esse contêiner.</span><span class="sxs-lookup"><span data-stu-id="79be6-128">A container is a logical construct that uses exactly one messaging store to store all relevant data for this container.</span></span> <span data-ttu-id="79be6-129">Cada contêiner é atribuído a um nó do agente de mensagens.</span><span class="sxs-lookup"><span data-stu-id="79be6-129">Each container is assigned to a messaging broker node.</span></span> <span data-ttu-id="79be6-130">Normalmente, há mais contêineres que nós do agente de mensagens.</span><span class="sxs-lookup"><span data-stu-id="79be6-130">Typically, there are more containers than messaging broker nodes.</span></span> <span data-ttu-id="79be6-131">Portanto, cada nó do agente de mensagens carrega diversos contêineres.</span><span class="sxs-lookup"><span data-stu-id="79be6-131">Therefore, each messaging broker node loads multiple containers.</span></span> <span data-ttu-id="79be6-132">A distribuição de contêineres para um nó do agente de mensagens é organizada de modo que todos os nós do agende de mensagens sejam carregados igualmente.</span><span class="sxs-lookup"><span data-stu-id="79be6-132">The distribution of containers to a messaging broker node is organized such that all messaging broker nodes are equally loaded.</span></span> <span data-ttu-id="79be6-133">Se o padrão de carga mudar (por exemplo, um dos contêineres ficar muito ocupado) ou se um nó do agente de mensagens ficar indisponível temporariamente, os contêineres serão redistribuídos entre os nós de agente de mensagens.</span><span class="sxs-lookup"><span data-stu-id="79be6-133">If the load pattern changes (for example, one of the containers gets very busy), or if a messaging broker node becomes temporarily unavailable, the containers are redistributed among the messaging broker nodes.</span></span>

## <a name="processing-of-incoming-messaging-requests"></a><span data-ttu-id="79be6-134">Processamento de mensagens de solicitações de entrada</span><span class="sxs-lookup"><span data-stu-id="79be6-134">Processing of incoming messaging requests</span></span>
<span data-ttu-id="79be6-135">Quando um cliente envia uma solicitação ao Barramento de Serviço, o balanceador de carga do Azure direciona para qualquer um de nós do gateway.</span><span class="sxs-lookup"><span data-stu-id="79be6-135">When a client sends a request to Service Bus, the Azure load balancer routes it to any of the gateway nodes.</span></span> <span data-ttu-id="79be6-136">O nó do gateway autoriza a solicitação.</span><span class="sxs-lookup"><span data-stu-id="79be6-136">The gateway node authorizes the request.</span></span> <span data-ttu-id="79be6-137">Se a solicitação for referente a uma entidade de mensagens (fila, tópico, assinatura), o nó do gateway busca a entidade no repositório de gateway e determina em qual repositório de mensagens a entidade está localizada.</span><span class="sxs-lookup"><span data-stu-id="79be6-137">If the request concerns a messaging entity (queue, topic, subscription), the gateway node looks up the entity in the gateway store and determines in which messaging store the entity is located.</span></span> <span data-ttu-id="79be6-138">Depois, ele procura qual nó do agente de mensagens está servindo o contêiner e envia a solicitação para esse nó.</span><span class="sxs-lookup"><span data-stu-id="79be6-138">It then looks up which messaging broker node is currently servicing this container, and sends the request to that messaging broker node.</span></span> <span data-ttu-id="79be6-139">O nó do agente de mensagens processa a solicitação e atualiza o estado da entidade no repositório do contêiner.</span><span class="sxs-lookup"><span data-stu-id="79be6-139">The messaging broker node processes the request and updates the entity state in the container store.</span></span> <span data-ttu-id="79be6-140">O nó do agente de mensagens, em seguida, envia a resposta de volta ao nó do gateway, que envia uma resposta apropriada para o cliente que emitiu a solicitação original.</span><span class="sxs-lookup"><span data-stu-id="79be6-140">The messaging broker node then sends the response back to the gateway node, which sends an appropriate response back to the client that issued the original request.</span></span>

![Processamento de mensagens de solicitações de entrada](./media/service-bus-architecture/ic690644.png)

## <a name="next-steps"></a><span data-ttu-id="79be6-142">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="79be6-142">Next steps</span></span>
<span data-ttu-id="79be6-143">Agora que você leu uma visão geral da arquitetura do Barramento de Serviço, consulte os seguintes links para obter mais informações:</span><span class="sxs-lookup"><span data-stu-id="79be6-143">Now that you've read an overview of Service Bus architecture, visit the following links for more information:</span></span>

* [<span data-ttu-id="79be6-144">Visão geral de mensagens do Barramento de Serviço</span><span class="sxs-lookup"><span data-stu-id="79be6-144">Service Bus messaging overview</span></span>](service-bus-messaging-overview.md)
* [<span data-ttu-id="79be6-145">Conceitos fundamentais do barramento de serviço</span><span class="sxs-lookup"><span data-stu-id="79be6-145">Service Bus fundamentals</span></span>](service-bus-fundamentals-hybrid-solutions.md)
* [<span data-ttu-id="79be6-146">Uma solução de mensagens na fila usando filas do Barramento de Serviço</span><span class="sxs-lookup"><span data-stu-id="79be6-146">A queued messaging solution using Service Bus queues</span></span>](service-bus-dotnet-multi-tier-app-using-service-bus-queues.md)


