---
title: "aplicativos do Azure Service Bus aaaInsulating contra interrupções e desastres | Microsoft Docs"
description: "Descreve técnicas que você pode usar tooprotect aplicativos contra uma interrupção potencial do barramento de serviço."
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: tysonn
ms.assetid: fd9fa8ab-f4c4-43f7-974f-c876df1614d4
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 04/12/2017
ms.author: sethm
ms.openlocfilehash: 349b4968456c9f15375753d83495246f5a3ddfdb
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="best-practices-for-insulating-applications-against-service-bus-outages-and-disasters"></a><span data-ttu-id="18cc5-103">Práticas recomendadas para isolar aplicativos contra interrupções e desastres do Barramento de Serviço</span><span class="sxs-lookup"><span data-stu-id="18cc5-103">Best practices for insulating applications against Service Bus outages and disasters</span></span>
<span data-ttu-id="18cc5-104">Aplicativos de missão crítica devem operar continuamente, mesmo na presença de saudação de falhas inesperadas ou desastres.</span><span class="sxs-lookup"><span data-stu-id="18cc5-104">Mission-critical applications must operate continuously, even in hello presence of unplanned outages or disasters.</span></span> <span data-ttu-id="18cc5-105">Este tópico descreve técnicas que você pode usar os aplicativos do barramento de serviço tooprotect contra uma potencial interrupção do serviço ou um desastre.</span><span class="sxs-lookup"><span data-stu-id="18cc5-105">This topic describes techniques you can use tooprotect Service Bus applications against a potential service outage or disaster.</span></span>

<span data-ttu-id="18cc5-106">Uma interrupção é definida como indisponibilidade temporária de saudação do barramento de serviço do Azure.</span><span class="sxs-lookup"><span data-stu-id="18cc5-106">An outage is defined as hello temporary unavailability of Azure Service Bus.</span></span> <span data-ttu-id="18cc5-107">Falha de saudação pode afetar alguns componentes do barramento de serviço, como um repositório de mensagens ou o datacenter inteiro Olá mesmo.</span><span class="sxs-lookup"><span data-stu-id="18cc5-107">hello outage can affect some components of Service Bus, such as a messaging store, or even hello entire datacenter.</span></span> <span data-ttu-id="18cc5-108">Depois de corrigir o problema de saudação, barramento de serviço ficar disponível novamente.</span><span class="sxs-lookup"><span data-stu-id="18cc5-108">After hello problem has been fixed, Service Bus becomes available again.</span></span> <span data-ttu-id="18cc5-109">Normalmente, uma interrupção não causa a perda de mensagens ou de outros dados.</span><span class="sxs-lookup"><span data-stu-id="18cc5-109">Typically, an outage does not cause loss of messages or other data.</span></span> <span data-ttu-id="18cc5-110">Um exemplo de uma falha do componente é indisponibilidade de saudação de um repositório de mensagens específico.</span><span class="sxs-lookup"><span data-stu-id="18cc5-110">An example of a component failure is hello unavailability of a particular messaging store.</span></span> <span data-ttu-id="18cc5-111">Um exemplo de uma interrupção de todo o datacenter é uma falha de energia de datacenter hello, ou um comutador de rede do datacenter com falha.</span><span class="sxs-lookup"><span data-stu-id="18cc5-111">An example of a datacenter-wide outage is a power failure of hello datacenter, or a faulty datacenter network switch.</span></span> <span data-ttu-id="18cc5-112">Uma falha pode durar de alguns tooa de minutos a alguns dias.</span><span class="sxs-lookup"><span data-stu-id="18cc5-112">An outage can last from a few minutes tooa few days.</span></span>

<span data-ttu-id="18cc5-113">Um desastre é definido como perda permanente de saudação de uma unidade de escala de barramento de serviço ou datacenter.</span><span class="sxs-lookup"><span data-stu-id="18cc5-113">A disaster is defined as hello permanent loss of a Service Bus scale unit or datacenter.</span></span> <span data-ttu-id="18cc5-114">Olá datacenter pode ou não pode ficar disponível novamente.</span><span class="sxs-lookup"><span data-stu-id="18cc5-114">hello datacenter may or may not become available again.</span></span> <span data-ttu-id="18cc5-115">Normalmente, um desastre causa perda de algumas ou de todas as mensagens ou de outros dados.</span><span class="sxs-lookup"><span data-stu-id="18cc5-115">Typically a disaster causes loss of some or all messages or other data.</span></span> <span data-ttu-id="18cc5-116">Exemplos de desastres são incêndios, enchentes ou terremoto.</span><span class="sxs-lookup"><span data-stu-id="18cc5-116">Examples of disasters are fire, flooding, or earthquake.</span></span>

## <a name="current-architecture"></a><span data-ttu-id="18cc5-117">Arquitetura atual</span><span class="sxs-lookup"><span data-stu-id="18cc5-117">Current architecture</span></span>
<span data-ttu-id="18cc5-118">Barramento de serviço usa vários repositórios toostore mensagens enviadas tooqueues ou tópicos.</span><span class="sxs-lookup"><span data-stu-id="18cc5-118">Service Bus uses multiple messaging stores toostore messages that are sent tooqueues or topics.</span></span> <span data-ttu-id="18cc5-119">Uma fila não particionado ou tópico é atribuído tooone repositório de mensagens.</span><span class="sxs-lookup"><span data-stu-id="18cc5-119">A non-partitioned queue or topic is assigned tooone messaging store.</span></span> <span data-ttu-id="18cc5-120">Se esse repositório de mensagens não estiver disponível, todas as operações na fila ou no tópico falharão.</span><span class="sxs-lookup"><span data-stu-id="18cc5-120">If this messaging store is unavailable, all operations on that queue or topic will fail.</span></span>

<span data-ttu-id="18cc5-121">Todas as entidades de mensagens do Barramento de Serviço (filas, tópicos, retransmissões) residem em um namespace de serviço, que está associado a um datacenter.</span><span class="sxs-lookup"><span data-stu-id="18cc5-121">All Service Bus messaging entities (queues, topics, relays) reside in a service namespace, which is affiliated with a datacenter.</span></span> <span data-ttu-id="18cc5-122">Barramento de serviço não habilitar a replicação geográfica automática de dados, ele também não permite um namespace toospan vários datacenters.</span><span class="sxs-lookup"><span data-stu-id="18cc5-122">Service Bus does not enable automatic geo-replication of data, nor does it allow a namespace toospan multiple datacenters.</span></span>

## <a name="protecting-against-acs-outages"></a><span data-ttu-id="18cc5-123">Proteção contra interrupções do ACS</span><span class="sxs-lookup"><span data-stu-id="18cc5-123">Protecting against ACS outages</span></span>
<span data-ttu-id="18cc5-124">Se você estiver usando as credenciais do ACS e ele ficar indisponível, os clientes não poderão mais obter tokens.</span><span class="sxs-lookup"><span data-stu-id="18cc5-124">If you are using ACS credentials, and ACS becomes unavailable, clients can no longer obtain tokens.</span></span> <span data-ttu-id="18cc5-125">Os clientes que possuem um token no tempo de saudação que ACS cair podem continuar toouse barramento de serviço até a data de expiração de tokens de saudação.</span><span class="sxs-lookup"><span data-stu-id="18cc5-125">Clients that have a token at hello time ACS goes down can continue toouse Service Bus until hello tokens expire.</span></span> <span data-ttu-id="18cc5-126">vida útil do token padrão Olá é de 3 horas.</span><span class="sxs-lookup"><span data-stu-id="18cc5-126">hello default token lifetime is 3 hours.</span></span>

<span data-ttu-id="18cc5-127">tooprotect contra falhas do ACS, use tokens de assinatura de acesso compartilhado (SAS).</span><span class="sxs-lookup"><span data-stu-id="18cc5-127">tooprotect against ACS outages, use Shared Access Signature (SAS) tokens.</span></span> <span data-ttu-id="18cc5-128">Nesse caso, Olá autentica diretamente com o barramento do serviço Assinando um token sem uso com uma chave secreta.</span><span class="sxs-lookup"><span data-stu-id="18cc5-128">In this case, hello client authenticates directly with Service Bus by signing a self-minted token with a secret key.</span></span> <span data-ttu-id="18cc5-129">TooACS chamadas não são mais necessários.</span><span class="sxs-lookup"><span data-stu-id="18cc5-129">Calls tooACS are no longer required.</span></span> <span data-ttu-id="18cc5-130">Para saber mais sobre tokens SAS, confira [Autenticação do Barramento de Serviço][Service Bus authentication].</span><span class="sxs-lookup"><span data-stu-id="18cc5-130">For more information about SAS tokens, see [Service Bus authentication][Service Bus authentication].</span></span>

## <a name="protecting-queues-and-topics-against-messaging-store-failures"></a><span data-ttu-id="18cc5-131">Protegendo filas e tópicos contra falhas do repositório de mensagens</span><span class="sxs-lookup"><span data-stu-id="18cc5-131">Protecting queues and topics against messaging store failures</span></span>
<span data-ttu-id="18cc5-132">Uma fila não particionado ou tópico é atribuído tooone repositório de mensagens.</span><span class="sxs-lookup"><span data-stu-id="18cc5-132">A non-partitioned queue or topic is assigned tooone messaging store.</span></span> <span data-ttu-id="18cc5-133">Se esse repositório de mensagens não estiver disponível, todas as operações na fila ou no tópico falharão.</span><span class="sxs-lookup"><span data-stu-id="18cc5-133">If this messaging store is unavailable, all operations on that queue or topic will fail.</span></span> <span data-ttu-id="18cc5-134">Um particionada fila, Olá outro lado, consiste em vários fragmentos.</span><span class="sxs-lookup"><span data-stu-id="18cc5-134">A partitioned queue, on hello other hand, consists of multiple fragments.</span></span> <span data-ttu-id="18cc5-135">Cada fragmento é armazenado em um repositório de mensagens diferente.</span><span class="sxs-lookup"><span data-stu-id="18cc5-135">Each fragment is stored in a different messaging store.</span></span> <span data-ttu-id="18cc5-136">Quando uma mensagem é enviada tooa fila ou tópico particionado, o barramento de serviço atribui tooone de mensagem de saudação de fragmentos de saudação.</span><span class="sxs-lookup"><span data-stu-id="18cc5-136">When a message is sent tooa partitioned queue or topic, Service Bus assigns hello message tooone of hello fragments.</span></span> <span data-ttu-id="18cc5-137">Se o repositório de mensagens correspondente Olá estiver indisponível, o barramento de serviço grava fragmento diferente de saudação mensagem tooa, se possível.</span><span class="sxs-lookup"><span data-stu-id="18cc5-137">If hello corresponding messaging store is unavailable, Service Bus writes hello message tooa different fragment, if possible.</span></span> <span data-ttu-id="18cc5-138">Para obter mais informações sobre entidades particionadas, veja as [Entidades de Mensagens Particionadas][Partitioned messaging entities].</span><span class="sxs-lookup"><span data-stu-id="18cc5-138">For more information about partitioned entities, see [Partitioned messaging entities][Partitioned messaging entities].</span></span>

## <a name="protecting-against-datacenter-outages-or-disasters"></a><span data-ttu-id="18cc5-139">Proteção contra interrupções ou desastres de datacenter</span><span class="sxs-lookup"><span data-stu-id="18cc5-139">Protecting against datacenter outages or disasters</span></span>
<span data-ttu-id="18cc5-140">tooallow para um failover entre dois datacenters, você pode criar um namespace de serviço do barramento de serviço em cada datacenter.</span><span class="sxs-lookup"><span data-stu-id="18cc5-140">tooallow for a failover between two datacenters, you can create a Service Bus service namespace in each datacenter.</span></span> <span data-ttu-id="18cc5-141">Por exemplo, Olá namespace de serviço do barramento de serviço **Contosoprimario.ServiceBus.Windows.NET** pode estar localizada na região/Centro-Norte dos Estados Unidos hello e **Contososecundario.ServiceBus.Windows.NET**pode estar localizada na região do hello nos Sul/Central.</span><span class="sxs-lookup"><span data-stu-id="18cc5-141">For example, hello Service Bus service namespace **contosoPrimary.servicebus.windows.net** might be located in hello United States North/Central region, and **contosoSecondary.servicebus.windows.net** might be located in hello US South/Central region.</span></span> <span data-ttu-id="18cc5-142">Se uma entidade de mensagens do Service Bus deverá permanecer acessível na presença de saudação de uma interrupção do datacenter, você pode criar essa entidade em ambos os namespaces.</span><span class="sxs-lookup"><span data-stu-id="18cc5-142">If a Service Bus messaging entity must remain accessible in hello presence of a datacenter outage, you can create that entity in both namespaces.</span></span>

<span data-ttu-id="18cc5-143">Para obter mais informações, consulte hello "Falha do barramento de serviço em um datacenter do Azure" seção [assíncrona de alta disponibilidade e padrões de mensagens][Asynchronous messaging patterns and high availability].</span><span class="sxs-lookup"><span data-stu-id="18cc5-143">For more information, see hello "Failure of Service Bus within an Azure datacenter" section in [Asynchronous messaging patterns and high availability][Asynchronous messaging patterns and high availability].</span></span>

## <a name="protecting-relay-endpoints-against-datacenter-outages-or-disasters"></a><span data-ttu-id="18cc5-144">Protegendo pontos de extremidade de retransmissão contra interrupções ou desastres</span><span class="sxs-lookup"><span data-stu-id="18cc5-144">Protecting relay endpoints against datacenter outages or disasters</span></span>
<span data-ttu-id="18cc5-145">A replicação geográfica de pontos de extremidade de retransmissão permite que um serviço que expõe um toobe de ponto de extremidade de retransmissão acessível na presença de saudação de interrupções de barramento de serviço.</span><span class="sxs-lookup"><span data-stu-id="18cc5-145">Geo-replication of relay endpoints allows a service that exposes a relay endpoint toobe reachable in hello presence of Service Bus outages.</span></span> <span data-ttu-id="18cc5-146">tooachieve replicação geográfica, o serviço de saudação deve criar dois pontos de extremidade de retransmissão em namespaces diferentes.</span><span class="sxs-lookup"><span data-stu-id="18cc5-146">tooachieve geo-replication, hello service must create two relay endpoints in different namespaces.</span></span> <span data-ttu-id="18cc5-147">Olá namespaces devem residir em datacenters diferentes e dois pontos de extremidade de saudação devem ter nomes diferentes.</span><span class="sxs-lookup"><span data-stu-id="18cc5-147">hello namespaces must reside in different datacenters and hello two endpoints must have different names.</span></span> <span data-ttu-id="18cc5-148">Por exemplo, um ponto de extremidade primário pode ser acessado em **contosoPrimary.servicebus.windows.net/myPrimaryService**, enquanto seu equivalente secundário pode ser acessado em **contosoSecondary.servicebus.windows.net/mySecondaryService**.</span><span class="sxs-lookup"><span data-stu-id="18cc5-148">For example, a primary endpoint can be reached under **contosoPrimary.servicebus.windows.net/myPrimaryService**, while its secondary counterpart can be reached under **contosoSecondary.servicebus.windows.net/mySecondaryService**.</span></span>

<span data-ttu-id="18cc5-149">Olá serviço escuta ambos os pontos de extremidade e um cliente pode invocar o serviço Olá por meio de um ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="18cc5-149">hello service then listens on both endpoints, and a client can invoke hello service via either endpoint.</span></span> <span data-ttu-id="18cc5-150">Um aplicativo cliente aleatoriamente escolhe uma saudação retransmissões como Olá ponto de extremidade primário e envia seu ponto de extremidade solicitação toohello ativo.</span><span class="sxs-lookup"><span data-stu-id="18cc5-150">A client application randomly picks one of hello relays as hello primary endpoint, and sends its request toohello active endpoint.</span></span> <span data-ttu-id="18cc5-151">Se a operação de saudação falhará com um código de erro, essa falha indica que esse ponto de extremidade de retransmissão Olá não está disponível.</span><span class="sxs-lookup"><span data-stu-id="18cc5-151">If hello operation fails with an error code, this failure indicates that hello relay endpoint is not available.</span></span> <span data-ttu-id="18cc5-152">aplicativo Hello abre um ponto de extremidade canal toohello backup e emite novamente a solicitação de saudação.</span><span class="sxs-lookup"><span data-stu-id="18cc5-152">hello application opens a channel toohello backup endpoint and reissues hello request.</span></span> <span data-ttu-id="18cc5-153">Nesse momento, hello ativo e pontos de extremidade de backup Olá alternam funções: aplicativo de cliente hello considera Olá antigo ponto de extremidade ativo toobe Olá novo ponto de extremidade de backup e toobe de ponto de extremidade de backup antigos Olá Olá novo ponto de extremidade ativo.</span><span class="sxs-lookup"><span data-stu-id="18cc5-153">At that point hello active and hello backup endpoints switch roles: hello client application considers hello old active endpoint toobe hello new backup endpoint, and hello old backup endpoint toobe hello new active endpoint.</span></span> <span data-ttu-id="18cc5-154">Se ambos envio falharem, funções de saudação de duas entidades de saudação permanecem inalteradas e um erro será retornado.</span><span class="sxs-lookup"><span data-stu-id="18cc5-154">If both send operations fail, hello roles of hello two entities remain unchanged and an error is returned.</span></span>

<span data-ttu-id="18cc5-155">Olá [replicação geográfica com o barramento de serviço retransmitidas mensagens] [ Geo-replication with Service Bus relayed Messages] demonstra como tooreplicate retransmissões.</span><span class="sxs-lookup"><span data-stu-id="18cc5-155">hello [Geo-replication with Service Bus relayed messages][Geo-replication with Service Bus relayed Messages] sample demonstrates how tooreplicate relays.</span></span>

## <a name="protecting-queues-and-topics-against-datacenter-outages-or-disasters"></a><span data-ttu-id="18cc5-156">Protegendo filas e tópicos contra interrupções ou desastres do datacenter</span><span class="sxs-lookup"><span data-stu-id="18cc5-156">Protecting queues and topics against datacenter outages or disasters</span></span>
<span data-ttu-id="18cc5-157">tooachieve resiliência contra falhas do datacenter ao usar mensagens orientadas, barramento de serviço oferece suporte a duas abordagens: *active* e *passivo* replicação.</span><span class="sxs-lookup"><span data-stu-id="18cc5-157">tooachieve resilience against datacenter outages when using brokered messaging, Service Bus supports two approaches: *active* and *passive* replication.</span></span> <span data-ttu-id="18cc5-158">Para cada abordagem, se uma determinada fila ou tópico precisar permanecer acessível na presença de saudação de uma interrupção do datacenter, você pode criá-lo nos dois namespaces.</span><span class="sxs-lookup"><span data-stu-id="18cc5-158">For each approach, if a given queue or topic must remain accessible in hello presence of a datacenter outage, you can create it in both namespaces.</span></span> <span data-ttu-id="18cc5-159">Ambas as entidades podem ter Olá mesmo nome.</span><span class="sxs-lookup"><span data-stu-id="18cc5-159">Both entities can have hello same name.</span></span> <span data-ttu-id="18cc5-160">Por exemplo, uma fila primária pode ser acessada em **contosoPrimary.servicebus.windows.net/myQueue**, enquanto sua equivalente secundária pode ser acessada em **contosoSecondary.servicebus.windows.net/myQueue**.</span><span class="sxs-lookup"><span data-stu-id="18cc5-160">For example, a primary queue can be reached under **contosoPrimary.servicebus.windows.net/myQueue**, while its secondary counterpart can be reached under **contosoSecondary.servicebus.windows.net/myQueue**.</span></span>

<span data-ttu-id="18cc5-161">Se o aplicativo hello não requer comunicação permanente do remetente e o receptor, o aplicativo hello pode implementar uma fila durável do lado do cliente tooprevent perda e tooshield Olá remetente da mensagem de quaisquer erros transitórios de barramento de serviço.</span><span class="sxs-lookup"><span data-stu-id="18cc5-161">If hello application does not require permanent sender-to-receiver communication, hello application can implement a durable client-side queue tooprevent message loss and tooshield hello sender from any transient Service Bus errors.</span></span>

## <a name="active-replication"></a><span data-ttu-id="18cc5-162">Replicação ativa</span><span class="sxs-lookup"><span data-stu-id="18cc5-162">Active replication</span></span>
<span data-ttu-id="18cc5-163">A replicação ativa usa entidades em ambos os namespaces para todas as operações.</span><span class="sxs-lookup"><span data-stu-id="18cc5-163">Active replication uses entities in both namespaces for every operation.</span></span> <span data-ttu-id="18cc5-164">Qualquer cliente que envia uma mensagem envia duas cópias da saudação mesma mensagem.</span><span class="sxs-lookup"><span data-stu-id="18cc5-164">Any client that sends a message sends two copies of hello same message.</span></span> <span data-ttu-id="18cc5-165">Olá primeira cópia é enviada a entidade principal toohello (por exemplo, **contosoPrimary.servicebus.windows.net/sales**), e a segunda cópia saudação da mensagem de saudação é enviada a entidade secundária toohello (por exemplo,  **contosoSecondary.servicebus.windows.net/sales**).</span><span class="sxs-lookup"><span data-stu-id="18cc5-165">hello first copy is sent toohello primary entity (for example, **contosoPrimary.servicebus.windows.net/sales**), and hello second copy of hello message is sent toohello secondary entity (for example, **contosoSecondary.servicebus.windows.net/sales**).</span></span>

<span data-ttu-id="18cc5-166">Um cliente recebe mensagens de ambas as filas.</span><span class="sxs-lookup"><span data-stu-id="18cc5-166">A client receives messages from both queues.</span></span> <span data-ttu-id="18cc5-167">processos de destinatário Olá Olá primeira cópia de uma mensagem e Olá segunda cópia é suprimida.</span><span class="sxs-lookup"><span data-stu-id="18cc5-167">hello receiver processes hello first copy of a message, and hello second copy is suppressed.</span></span> <span data-ttu-id="18cc5-168">toosuppress de mensagens duplicadas, o remetente Olá deve marcar cada mensagem com um identificador exclusivo.</span><span class="sxs-lookup"><span data-stu-id="18cc5-168">toosuppress duplicate messages, hello sender must tag each message with a unique identifier.</span></span> <span data-ttu-id="18cc5-169">Ambas as cópias da mensagem de saudação devem ser marcadas com hello mesmo identificador.</span><span class="sxs-lookup"><span data-stu-id="18cc5-169">Both copies of hello message must be tagged with hello same identifier.</span></span> <span data-ttu-id="18cc5-170">Você pode usar o hello [BrokeredMessage.MessageId] [ BrokeredMessage.MessageId] ou [BrokeredMessage.Label] [ BrokeredMessage.Label] propriedades ou saudação de tootag uma propriedade personalizada Mensagem.</span><span class="sxs-lookup"><span data-stu-id="18cc5-170">You can use hello [BrokeredMessage.MessageId][BrokeredMessage.MessageId] or [BrokeredMessage.Label][BrokeredMessage.Label] properties, or a custom property tootag hello message.</span></span> <span data-ttu-id="18cc5-171">receptor de saudação deve manter uma lista de mensagens que ele recebeu.</span><span class="sxs-lookup"><span data-stu-id="18cc5-171">hello receiver must maintain a list of messages that it has already received.</span></span>

<span data-ttu-id="18cc5-172">Olá [replicação geográfica com mensagens orientadas do barramento do serviço] [ Geo-replication with Service Bus Brokered Messages] demonstra a replicação ativa de entidades de mensagens.</span><span class="sxs-lookup"><span data-stu-id="18cc5-172">hello [Geo-replication with Service Bus Brokered Messages][Geo-replication with Service Bus Brokered Messages] sample demonstrates active replication of messaging entities.</span></span>

> [!NOTE]
> <span data-ttu-id="18cc5-173">abordagem de replicação ativa Olá dobra o número de saudação de operações, portanto essa abordagem pode gerar toohigher custo.</span><span class="sxs-lookup"><span data-stu-id="18cc5-173">hello active replication approach doubles hello number of operations, therefore this approach can lead toohigher cost.</span></span>
> 
> 

## <a name="passive-replication"></a><span data-ttu-id="18cc5-174">Replicação passiva</span><span class="sxs-lookup"><span data-stu-id="18cc5-174">Passive replication</span></span>
<span data-ttu-id="18cc5-175">No caso sem falhas hello, a replicação passiva usa apenas uma das duas entidades de mensagens de saudação.</span><span class="sxs-lookup"><span data-stu-id="18cc5-175">In hello fault-free case, passive replication uses only one of hello two messaging entities.</span></span> <span data-ttu-id="18cc5-176">Um cliente envia a entidade ativa de toohello de mensagem de saudação.</span><span class="sxs-lookup"><span data-stu-id="18cc5-176">A client sends hello message toohello active entity.</span></span> <span data-ttu-id="18cc5-177">Se a operação de saudação entidade ativa Olá falhará com um código de erro que indica o datacenter Olá que a entidade ativa de saudação de hosts pode estar indisponível, cliente Olá envia uma cópia da entidade de backup do toohello de mensagem de saudação.</span><span class="sxs-lookup"><span data-stu-id="18cc5-177">If hello operation on hello active entity fails with an error code that indicates hello datacenter that hosts hello active entity might be unavailable, hello client sends a copy of hello message toohello backup entity.</span></span> <span data-ttu-id="18cc5-178">Nesse momento, hello ativa e entidades de backup Olá alternam funções: cliente remetente Olá considera Olá antiga entidade ativa toobe Olá nova entidade de backup e Olá antigo backup entidade é Olá novo ativo.</span><span class="sxs-lookup"><span data-stu-id="18cc5-178">At that point hello active and hello backup entities switch roles: hello sending client considers hello old active entity toobe hello new backup entity, and hello old backup entity is hello new active entity.</span></span> <span data-ttu-id="18cc5-179">Se ambos envio falharem, funções de saudação de duas entidades de saudação permanecem inalteradas e um erro será retornado.</span><span class="sxs-lookup"><span data-stu-id="18cc5-179">If both send operations fail, hello roles of hello two entities remain unchanged and an error is returned.</span></span>

<span data-ttu-id="18cc5-180">Um cliente recebe mensagens de ambas as filas.</span><span class="sxs-lookup"><span data-stu-id="18cc5-180">A client receives messages from both queues.</span></span> <span data-ttu-id="18cc5-181">Porque há uma possibilidade de que Olá recebe duas cópias da saudação a mesma mensagem, hello receptor deve suprimir mensagens duplicadas.</span><span class="sxs-lookup"><span data-stu-id="18cc5-181">Because there is a chance that hello receiver receives two copies of hello same message, hello receiver must suppress duplicate messages.</span></span> <span data-ttu-id="18cc5-182">Você pode suprimir duplicatas no hello mesma forma descrita para a replicação ativa.</span><span class="sxs-lookup"><span data-stu-id="18cc5-182">You can suppress duplicates in hello same way as described for active replication.</span></span>

<span data-ttu-id="18cc5-183">Em geral, a replicação passiva é mais econômica do que a replicação ativa porque, na maioria dos casos, somente uma operação é executada.</span><span class="sxs-lookup"><span data-stu-id="18cc5-183">In general, passive replication is more economical than active replication because in most cases only one operation is performed.</span></span> <span data-ttu-id="18cc5-184">Latência, a taxa de transferência e os custos monetários são idênticos toohello não replicado cenário.</span><span class="sxs-lookup"><span data-stu-id="18cc5-184">Latency, throughput, and monetary cost are identical toohello non-replicated scenario.</span></span>

<span data-ttu-id="18cc5-185">Ao usar replicação passiva, em hello mensagens de cenários a seguir podem ser perdidas ou recebidas duas vezes:</span><span class="sxs-lookup"><span data-stu-id="18cc5-185">When using passive replication, in hello following scenarios messages can be lost or received twice:</span></span>

* <span data-ttu-id="18cc5-186">**Perda ou atraso de mensagens**: pressupõem que o remetente Olá enviadas com êxito uma fila do mensagem m1 toohello primário e fila Olá torna-se indisponível antes Olá recebe m1.</span><span class="sxs-lookup"><span data-stu-id="18cc5-186">**Message delay or loss**: Assume that hello sender successfully sent a message m1 toohello primary queue, and then hello queue becomes unavailable before hello receiver receives m1.</span></span> <span data-ttu-id="18cc5-187">remetente Olá envia fila secundária do m2 toohello uma mensagem subsequente.</span><span class="sxs-lookup"><span data-stu-id="18cc5-187">hello sender sends a subsequent message m2 toohello secondary queue.</span></span> <span data-ttu-id="18cc5-188">Se a fila primária hello está temporariamente indisponível, o receptor Olá recebe m1 depois Olá fila ficar disponível novamente.</span><span class="sxs-lookup"><span data-stu-id="18cc5-188">If hello primary queue is temporarily unavailable, hello receiver receives m1 after hello queue becomes available again.</span></span> <span data-ttu-id="18cc5-189">Em caso de desastre, o receptor de saudação pode nunca receber m1.</span><span class="sxs-lookup"><span data-stu-id="18cc5-189">In case of a disaster, hello receiver may never receive m1.</span></span>
* <span data-ttu-id="18cc5-190">**Recebimento duplicado**: suponha que esse remetente Olá envia uma fila principal de toohello mensagem m.</span><span class="sxs-lookup"><span data-stu-id="18cc5-190">**Duplicate reception**: Assume that hello sender sends a message m toohello primary queue.</span></span> <span data-ttu-id="18cc5-191">Barramento de serviço com êxito processa m, mas falhar toosend uma resposta.</span><span class="sxs-lookup"><span data-stu-id="18cc5-191">Service Bus successfully processes m but fails toosend a response.</span></span> <span data-ttu-id="18cc5-192">Depois Olá enviar operação expirar, o remetente de Olá envia uma cópia idêntica de fila secundária do toohello m.</span><span class="sxs-lookup"><span data-stu-id="18cc5-192">After hello send operation times out, hello sender sends an identical copy of m toohello secondary queue.</span></span> <span data-ttu-id="18cc5-193">Se receptor Olá for capaz de tooreceive Olá primeira cópia de m antes de fila primária Olá fica indisponível, Olá recebe ambas as cópias de m em aproximadamente Olá simultaneamente.</span><span class="sxs-lookup"><span data-stu-id="18cc5-193">If hello receiver is able tooreceive hello first copy of m before hello primary queue becomes unavailable, hello receiver receives both copies of m at approximately hello same time.</span></span> <span data-ttu-id="18cc5-194">Se receptor Olá não é capaz de tooreceive Olá primeira cópia de m antes de fila primária Olá fica indisponível, receptor Olá inicialmente recebe apenas Olá segunda cópia de m, mas, em seguida, recebe uma segunda cópia de m quando a fila primária Olá fica disponível.</span><span class="sxs-lookup"><span data-stu-id="18cc5-194">If hello receiver is not able tooreceive hello first copy of m before hello primary queue becomes unavailable, hello receiver initially receives only hello second copy of m, but then receives a second copy of m when hello primary queue becomes available.</span></span>

<span data-ttu-id="18cc5-195">Olá [replicação geográfica com o barramento de serviço orientado a mensagens] [ Geo-replication with Service Bus Brokered Messages] demonstra a replicação passiva de entidades de mensagens.</span><span class="sxs-lookup"><span data-stu-id="18cc5-195">hello [Geo-replication with Service Bus brokered messages][Geo-replication with Service Bus Brokered Messages] sample demonstrates passive replication of messaging entities.</span></span>

## <a name="next-steps"></a><span data-ttu-id="18cc5-196">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="18cc5-196">Next steps</span></span>
<span data-ttu-id="18cc5-197">toolearn mais sobre a recuperação de desastres, consulte estes artigos:</span><span class="sxs-lookup"><span data-stu-id="18cc5-197">toolearn more about disaster recovery, see these articles:</span></span>

* <span data-ttu-id="18cc5-198">[Continuidade dos negócios no Banco de dados SQL do Azure][Azure SQL Database Business Continuity]</span><span class="sxs-lookup"><span data-stu-id="18cc5-198">[Azure SQL Database Business Continuity][Azure SQL Database Business Continuity]</span></span>
* <span data-ttu-id="18cc5-199">[Projetando aplicativos resilientes para Azure][Azure resiliency technical guidance]</span><span class="sxs-lookup"><span data-stu-id="18cc5-199">[Designing resilient applications for Azure][Azure resiliency technical guidance]</span></span>

[Service Bus Authentication]: service-bus-authentication-and-authorization.md
[Partitioned messaging entities]: service-bus-partitioning.md
[Asynchronous messaging patterns and high availability]: service-bus-async-messaging.md#failure-of-service-bus-within-an-azure-datacenter
[Geo-replication with Service Bus Relayed Messages]: http://code.msdn.microsoft.com/Geo-replication-with-16dbfecd
[BrokeredMessage.MessageId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_MessageId
[BrokeredMessage.Label]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label
[Geo-replication with Service Bus Brokered Messages]: http://code.msdn.microsoft.com/Geo-replication-with-f5688664
[Azure SQL Database Business Continuity]: ../sql-database/sql-database-business-continuity.md
[Azure resiliency technical guidance]: /azure/architecture/resiliency
