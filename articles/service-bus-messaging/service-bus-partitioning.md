---
title: "Criar tópicos e filas particionados do Barramento de Serviço | Microsoft Docs"
description: "Descreve como particionar filas e tópicos do Barramento de Serviço usando vários agentes de mensagem."
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: a0c7d5a2-4876-42cb-8344-a1fc988746e7
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 08/07/2017
ms.author: sethm;hillaryc
ms.openlocfilehash: 5a4e69ea7e13cb017f8fb432c524c6a8ce9228a8
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/18/2017
---
# <a name="partitioned-queues-and-topics"></a><span data-ttu-id="95592-103">Filas e tópicos particionados</span><span class="sxs-lookup"><span data-stu-id="95592-103">Partitioned queues and topics</span></span>
<span data-ttu-id="95592-104">O Barramento de Serviço do Azure emprega vários agentes de mensagens para processar mensagens e vários repositórios de mensagens para armazenar mensagens.</span><span class="sxs-lookup"><span data-stu-id="95592-104">Azure Service Bus employs multiple message brokers to process messages and multiple messaging stores to store messages.</span></span> <span data-ttu-id="95592-105">Uma fila ou um tópico convencional é manipulado por um único agente de mensagem e armazenado em um repositório de mensagens.</span><span class="sxs-lookup"><span data-stu-id="95592-105">A conventional queue or topic is handled by a single message broker and stored in one messaging store.</span></span> <span data-ttu-id="95592-106">As *partições* do Barramento de Serviço permitem que filas ou tópicos, ou *entidades de mensagens*, sejam particionados entre diversos agentes e repositórios de mensagens.</span><span class="sxs-lookup"><span data-stu-id="95592-106">Service Bus *partitions* enable queues and topics, or *messaging entities*, to be partitioned across multiple message brokers and messaging stores.</span></span> <span data-ttu-id="95592-107">Isso significa que a taxa de transferência geral de uma entidade particionada não é mais limitada pelo desempenho de um único agente ou repositório de mensagens.</span><span class="sxs-lookup"><span data-stu-id="95592-107">This means that the overall throughput of a partitioned entity is no longer limited by the performance of a single message broker or messaging store.</span></span> <span data-ttu-id="95592-108">Além disso, uma interrupção temporária de um repositório de mensagens não torna uma fila ou um tópico particionado indisponível.</span><span class="sxs-lookup"><span data-stu-id="95592-108">In addition, a temporary outage of a messaging store does not render a partitioned queue or topic unavailable.</span></span> <span data-ttu-id="95592-109">Filas e tópicos particionados podem conter todos os recursos avançados do Barramento de Serviço, como o suporte a transações e sessões.</span><span class="sxs-lookup"><span data-stu-id="95592-109">Partitioned queues and topics can contain all advanced Service Bus features, such as support for transactions and sessions.</span></span>

<span data-ttu-id="95592-110">Para saber mais sobre aspectos internos do Barramento de Serviço, confira o artigo [Arquitetura do Barramento de Serviço][Service Bus architecture].</span><span class="sxs-lookup"><span data-stu-id="95592-110">For information about Service Bus internals, see the [Service Bus architecture][Service Bus architecture] article.</span></span>

<span data-ttu-id="95592-111">O particionamento é habilitado por padrão na criação da entidade em todos os tópicos e filas de mensagens Standard e Premium.</span><span class="sxs-lookup"><span data-stu-id="95592-111">Partitioning is enabled by default at entity creation on all queues and topics in both Standard and Premium messaging.</span></span> <span data-ttu-id="95592-112">Você pode criar entidades da camada de mensagens Standard sem particionamento, mas filas e tópicos em um namespace Premium são sempre particionados; essa opção não pode ser desabilitada.</span><span class="sxs-lookup"><span data-stu-id="95592-112">You can create Standard messaging tier entities without partitioning, but queues and topics in a Premium namespace are always partitioned; this option cannot be disabled.</span></span> 

<span data-ttu-id="95592-113">Não é possível alterar a opção de particionamento em uma fila ou um tópico existente nas camadas Standard e Premium. Você pode definir a opção apenas quando cria a entidade.</span><span class="sxs-lookup"><span data-stu-id="95592-113">It is not possible to change the partitioning option on an existing queue or topic in either Standard or Premium tiers, you can only set the option when you create the entity.</span></span>

## <a name="how-it-works"></a><span data-ttu-id="95592-114">Como ele funciona</span><span class="sxs-lookup"><span data-stu-id="95592-114">How it works</span></span>

<span data-ttu-id="95592-115">Cada fila ou tópico particionado consiste em vários fragmentos.</span><span class="sxs-lookup"><span data-stu-id="95592-115">Each partitioned queue or topic consists of multiple fragments.</span></span> <span data-ttu-id="95592-116">Cada fragmento é armazenado em um repositório de mensagens diferente e manipulado por um agente de mensagens diferente.</span><span class="sxs-lookup"><span data-stu-id="95592-116">Each fragment is stored in a different messaging store and handled by a different message broker.</span></span> <span data-ttu-id="95592-117">Quando uma mensagem é enviada a uma fila ou um tópico particionado, o Barramento de Serviço atribui a mensagem a um dos fragmentos.</span><span class="sxs-lookup"><span data-stu-id="95592-117">When a message is sent to a partitioned queue or topic, Service Bus assigns the message to one of the fragments.</span></span> <span data-ttu-id="95592-118">A seleção é feita aleatoriamente pelo Barramento de Serviço ou por uma chave de partição que pode ser especificada pelo remetente.</span><span class="sxs-lookup"><span data-stu-id="95592-118">The selection is done randomly by Service Bus or by using a partition key that the sender can specify.</span></span>

<span data-ttu-id="95592-119">Quando um cliente deseja receber uma mensagem de uma fila particionada ou de uma assinatura de um tópico particionado, o Barramento de Serviço consulta todos os fragmentos de mensagens e, em seguida, retorna a primeira mensagem obtida de qualquer um dos repositórios de mensagens para o destinatário.</span><span class="sxs-lookup"><span data-stu-id="95592-119">When a client wants to receive a message from a partitioned queue, or from a subscription to a partitioned topic, Service Bus queries all fragments for messages, then returns the first message that is obtained from any of the messaging stores to the receiver.</span></span> <span data-ttu-id="95592-120">O Barramento de Serviço armazena em cache as outras mensagens e as retorna ao receber solicitações de recebimento adicionais.</span><span class="sxs-lookup"><span data-stu-id="95592-120">Service Bus caches the other messages and returns them when it receives additional receive requests.</span></span> <span data-ttu-id="95592-121">Um cliente receptor não está ciente do particionamento; o comportamento voltado para o cliente de uma fila ou um tópico particionado (por exemplo, ler, concluir, adiar, colocar mensagem na fila de mensagens mortas, executar pré-busca) é idêntico ao comportamento de uma entidade regular.</span><span class="sxs-lookup"><span data-stu-id="95592-121">A receiving client is not aware of the partitioning; the client-facing behavior of a partitioned queue or topic (for example, read, complete, defer, deadletter, prefetching) is identical to the behavior of a regular entity.</span></span>

<span data-ttu-id="95592-122">Não há custo adicional ao enviar ou receber uma mensagem de uma fila ou um tópico particionado.</span><span class="sxs-lookup"><span data-stu-id="95592-122">There is no additional cost when sending a message to, or receiving a message from, a partitioned queue or topic.</span></span>

## <a name="enable-partitioning"></a><span data-ttu-id="95592-123">Habilitar particionamento</span><span class="sxs-lookup"><span data-stu-id="95592-123">Enable partitioning</span></span>

<span data-ttu-id="95592-124">Para usar filas e tópicos particionados com o Barramento de Serviço do Azure, use o SDK do Azure versão 2.2 ou posterior, ou especifique `api-version=2013-10` em suas solicitações HTTP.</span><span class="sxs-lookup"><span data-stu-id="95592-124">To use partitioned queues and topics with Azure Service Bus, use the Azure SDK version 2.2 or later, or specify `api-version=2013-10` in your HTTP requests.</span></span>

### <a name="standard"></a><span data-ttu-id="95592-125">Standard</span><span class="sxs-lookup"><span data-stu-id="95592-125">Standard</span></span>

<span data-ttu-id="95592-126">Na camada de mensagens Standard, é possível criar filas e tópicos do Barramento de Serviço em tamanhos de 1, 2, 3, 4 ou 5 GB (o padrão é 1 GB).</span><span class="sxs-lookup"><span data-stu-id="95592-126">In the Standard messaging tier, you can create Service Bus queues and topics in 1, 2, 3, 4, or 5 GB sizes (the default is 1 GB).</span></span> <span data-ttu-id="95592-127">Com o particionamento habilitado, o Barramento de Serviço cria 16 cópias (16 partições) da entidade para cada GB especificado.</span><span class="sxs-lookup"><span data-stu-id="95592-127">With partitioning enabled, Service Bus creates 16 copies (16 partitions) of the entity for each GB you specify.</span></span> <span data-ttu-id="95592-128">Assim, se você criar uma fila que tenha 5 GB, com 16 partições, o tamanho máximo da fila será (5 \* 16) = 80 GB.</span><span class="sxs-lookup"><span data-stu-id="95592-128">As such, if you create a queue that's 5 GB in size, with 16 partitions the maximum queue size becomes (5 \* 16) = 80 GB.</span></span> <span data-ttu-id="95592-129">É possível ver o tamanho máximo da fila ou do tópico particionado observando sua entrada no [Portal do Azure][Azure portal], na folha **Visão Geral** da entidade em questão.</span><span class="sxs-lookup"><span data-stu-id="95592-129">You can see the maximum size of your partitioned queue or topic by looking at its entry on the [Azure portal][Azure portal], in the **Overview** blade for that entity.</span></span>

### <a name="premium"></a><span data-ttu-id="95592-130">Premium</span><span class="sxs-lookup"><span data-stu-id="95592-130">Premium</span></span>

<span data-ttu-id="95592-131">Em um namespace de camada Premium, você pode criar filas e tópicos do Barramento de Serviços em tamanhos de 1, 2, 3, 4, 5, 10, 20, 40 ou 80 GB (o padrão é 1 GB).</span><span class="sxs-lookup"><span data-stu-id="95592-131">In a Premium tier namespace, you can create Service Bus queues and topics in 1, 2, 3, 4, 5, 10, 20, 40, or 80 GB sizes (the default is 1 GB).</span></span> <span data-ttu-id="95592-132">Com o particionamento habilitado por padrão, o Barramento de Serviço cria duas partições por entidade.</span><span class="sxs-lookup"><span data-stu-id="95592-132">With partitioning enabled by default, Service Bus creates two partitions per entity.</span></span> <span data-ttu-id="95592-133">É possível ver o tamanho máximo da fila ou do tópico particionado observando sua entrada no [Portal do Azure][Azure portal], na folha **Visão Geral** da entidade em questão.</span><span class="sxs-lookup"><span data-stu-id="95592-133">You can see the maximum size of your partitioned queue or topic by looking at its entry on the [Azure portal][Azure portal], in the **Overview** blade for that entity.</span></span>

<span data-ttu-id="95592-134">Para saber mais sobre o particionamento na camada de mensagens Premium, confira [Camadas de sistema de mensagens Premium e Standard do Barramento de Serviço](service-bus-premium-messaging.md).</span><span class="sxs-lookup"><span data-stu-id="95592-134">For more information about partitioning in the Premium messaging tier, see [Service Bus Premium and Standard messaging tiers](service-bus-premium-messaging.md).</span></span> 

### <a name="create-a-partitioned-entity"></a><span data-ttu-id="95592-135">Criar uma entidade particionada</span><span class="sxs-lookup"><span data-stu-id="95592-135">Create a partitioned entity</span></span>

<span data-ttu-id="95592-136">Há várias maneiras de criar uma fila ou um tópico particionado.</span><span class="sxs-lookup"><span data-stu-id="95592-136">There are several ways to create a partitioned queue or topic.</span></span> <span data-ttu-id="95592-137">Ao criar a fila ou o tópico de seu aplicativo, você pode habilitar o particionamento de fila ou tópico definindo respectivamente a propriedade [QueueDescription.EnablePartitioning][QueueDescription.EnablePartitioning] ou [TopicDescription.EnablePartitioning][TopicDescription.EnablePartitioning] como **true**.</span><span class="sxs-lookup"><span data-stu-id="95592-137">When you create the queue or topic from your application, you can enable partitioning for the queue or topic by respectively setting the [QueueDescription.EnablePartitioning][QueueDescription.EnablePartitioning] or [TopicDescription.EnablePartitioning][TopicDescription.EnablePartitioning] property to **true**.</span></span> <span data-ttu-id="95592-138">Essas propriedades devem ser definidas no momento em que a fila ou o tópico é criado.</span><span class="sxs-lookup"><span data-stu-id="95592-138">These properties must be set at the time the queue or topic is created.</span></span> <span data-ttu-id="95592-139">Conforme declarado anteriormente, não é possível alterar essas propriedades em uma fila ou um tópico existente.</span><span class="sxs-lookup"><span data-stu-id="95592-139">As stated previously, it is not possible to change these properties on an existing queue or topic.</span></span> <span data-ttu-id="95592-140">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="95592-140">For example:</span></span>

```csharp
// Create partitioned topic
NamespaceManager ns = NamespaceManager.CreateFromConnectionString(myConnectionString);
TopicDescription td = new TopicDescription(TopicName);
td.EnablePartitioning = true;
ns.CreateTopic(td);
```

<span data-ttu-id="95592-141">Como alternativa, você pode criar uma fila ou um tópico particionado no [Portal do Azure][Azure portal] ou no Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="95592-141">Alternatively, you can create a partitioned queue or topic in the [Azure portal][Azure portal] or in Visual Studio.</span></span> <span data-ttu-id="95592-142">Ao criar uma fila ou um tópico no portal, a opção **Habilitar particionamento** na folha **Criar** da fila ou do tópico é marcada por padrão.</span><span class="sxs-lookup"><span data-stu-id="95592-142">When you create a queue or topic in the portal, the **Enable partitioning** option in the queue or topic **Create** blade is checked by default.</span></span> <span data-ttu-id="95592-143">Você só pode desabilitar essa opção em uma entidade da camada Standard; na camada Premium, o particionamento está sempre habilitado.</span><span class="sxs-lookup"><span data-stu-id="95592-143">You can only disable this option in a Standard tier entity; in the Premium tier partitioning is always enabled.</span></span> <span data-ttu-id="95592-144">No Visual Studio, clique na caixa de seleção **Habilitar Particionamento** na caixa de diálogo **Nova Fila** ou **Novo Tópico**.</span><span class="sxs-lookup"><span data-stu-id="95592-144">In Visual Studio, click the **Enable Partitioning** checkbox in the **New Queue** or **New Topic** dialog box.</span></span>

## <a name="use-of-partition-keys"></a><span data-ttu-id="95592-145">Uso de chaves de partição</span><span class="sxs-lookup"><span data-stu-id="95592-145">Use of partition keys</span></span>
<span data-ttu-id="95592-146">Quando uma mensagem é enfileirada em uma fila ou um tópico particionado, o Barramento de Serviço verifica a presença de uma chave de partição.</span><span class="sxs-lookup"><span data-stu-id="95592-146">When a message is enqueued into a partitioned queue or topic, Service Bus checks for the presence of a partition key.</span></span> <span data-ttu-id="95592-147">Se encontrar uma, ele selecionará o fragmento com base na chave.</span><span class="sxs-lookup"><span data-stu-id="95592-147">If it finds one, it selects the fragment based on that key.</span></span> <span data-ttu-id="95592-148">Se não encontrar uma chave de partição, ele selecionará o fragmento com base em um algoritmo interno.</span><span class="sxs-lookup"><span data-stu-id="95592-148">If it does not find a partition key, it selects the fragment based on an internal algorithm.</span></span>

### <a name="using-a-partition-key"></a><span data-ttu-id="95592-149">Usando uma chave de partição</span><span class="sxs-lookup"><span data-stu-id="95592-149">Using a partition key</span></span>
<span data-ttu-id="95592-150">Alguns cenários, como sessões ou transações, exigem que as mensagens sejam armazenadas em um fragmento específico.</span><span class="sxs-lookup"><span data-stu-id="95592-150">Some scenarios, such as sessions or transactions, require messages to be stored in a specific fragment.</span></span> <span data-ttu-id="95592-151">Todos esses cenários exigem o uso de uma chave de partição.</span><span class="sxs-lookup"><span data-stu-id="95592-151">All these scenarios require the use of a partition key.</span></span> <span data-ttu-id="95592-152">Todas as mensagens que usam a mesma chave de partição são atribuídas ao mesmo fragmento.</span><span class="sxs-lookup"><span data-stu-id="95592-152">All messages that use the same partition key are assigned to the same fragment.</span></span> <span data-ttu-id="95592-153">Se o fragmento estiver indisponível temporariamente, o Barramento de Serviço retornará um erro.</span><span class="sxs-lookup"><span data-stu-id="95592-153">If the fragment is temporarily unavailable, Service Bus returns an error.</span></span>

<span data-ttu-id="95592-154">Dependendo do cenário, propriedades de mensagem diferentes são usadas como uma chave de partição:</span><span class="sxs-lookup"><span data-stu-id="95592-154">Depending on the scenario, different message properties are used as a partition key:</span></span>

<span data-ttu-id="95592-155">**SessionId**: caso uma mensagem tenha a propriedade [BrokeredMessage.SessionId][BrokeredMessage.SessionId] definida, o Barramento de Serviço usará essa propriedade como a chave de partição.</span><span class="sxs-lookup"><span data-stu-id="95592-155">**SessionId**: If a message has the [BrokeredMessage.SessionId][BrokeredMessage.SessionId] property set, then Service Bus uses this property as the partition key.</span></span> <span data-ttu-id="95592-156">Dessa forma, todas as mensagens que pertencem à mesma sessão são manipuladas pelo mesmo agente de mensagens.</span><span class="sxs-lookup"><span data-stu-id="95592-156">This way, all messages that belong to the same session are handled by the same message broker.</span></span> <span data-ttu-id="95592-157">Isso habilita o Barramento de Serviço a garantir a ordenação das mensagens, bem como a consistência dos estados de sessão.</span><span class="sxs-lookup"><span data-stu-id="95592-157">This enables Service Bus to guarantee message ordering as well as the consistency of session states.</span></span>

<span data-ttu-id="95592-158">**PartitionKey**: caso uma mensagem tenha a propriedade [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] definida, mas não a propriedade [BrokeredMessage.SessionId][BrokeredMessage.SessionId], o Barramento de Serviço usará a propriedade [PartitionKey][PartitionKey] como a chave de partição.</span><span class="sxs-lookup"><span data-stu-id="95592-158">**PartitionKey**: If a message has the [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] property but not the [BrokeredMessage.SessionId][BrokeredMessage.SessionId] property set, then Service Bus uses the [PartitionKey][PartitionKey] property as the partition key.</span></span> <span data-ttu-id="95592-159">Caso a mensagem tenha as propriedades [SessionId][SessionId] e [PartitionKey][PartitionKey] definidas, as propriedades deverão ser idênticas.</span><span class="sxs-lookup"><span data-stu-id="95592-159">If the message has both the [SessionId][SessionId] and the [PartitionKey][PartitionKey] properties set, both properties must be identical.</span></span> <span data-ttu-id="95592-160">Se a propriedade [PartitionKey][PartitionKey] for definida com um valor diferente da propriedade [SessionId][SessionId], o Barramento de Serviço retornará uma exceção de operação inválida.</span><span class="sxs-lookup"><span data-stu-id="95592-160">If the [PartitionKey][PartitionKey] property is set to a different value than the [SessionId][SessionId] property, Service Bus returns an invalid operation exception.</span></span> <span data-ttu-id="95592-161">A propriedade [PartitionKey][PartitionKey] deverá ser usada caso um remetente envie mensagens transacionais sem reconhecimento de sessão.</span><span class="sxs-lookup"><span data-stu-id="95592-161">The [PartitionKey][PartitionKey] property should be used if a sender sends non-session aware transactional messages.</span></span> <span data-ttu-id="95592-162">A chave de partição garante que todas as mensagens enviadas em uma transação sejam manipuladas pelo mesmo agente de mensagens.</span><span class="sxs-lookup"><span data-stu-id="95592-162">The partition key ensures that all messages that are sent within a transaction are handled by the same messaging broker.</span></span>

<span data-ttu-id="95592-163">**MessageId**: caso a fila ou o tópico tenha a propriedade [QueueDescription.RequiresDuplicateDetection][QueueDescription.RequiresDuplicateDetection] definida como **true** e as propriedades [BrokeredMessage.SessionId][BrokeredMessage.SessionId] ou [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] não forem definidas, a propriedade [BrokeredMessage.MessageId][BrokeredMessage.MessageId] servirá como a chave de partição.</span><span class="sxs-lookup"><span data-stu-id="95592-163">**MessageId**: If the queue or topic has the [QueueDescription.RequiresDuplicateDetection][QueueDescription.RequiresDuplicateDetection] property set to **true** and the [BrokeredMessage.SessionId][BrokeredMessage.SessionId] or [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] properties are not set, then the [BrokeredMessage.MessageId][BrokeredMessage.MessageId] property serves as the partition key.</span></span> <span data-ttu-id="95592-164">(Observe que as bibliotecas Microsoft .NET e AMQP atribuirão automaticamente uma ID de mensagem se o aplicativo de envio não o fizer.) Nesse caso, todas as cópias da mesma mensagem são manipuladas pelo mesmo agente de mensagens.</span><span class="sxs-lookup"><span data-stu-id="95592-164">(Note that the Microsoft .NET and AMQP libraries automatically assign a message ID if the sending application does not.) In this case, all copies of the same message are handled by the same message broker.</span></span> <span data-ttu-id="95592-165">Isso permite que o Barramento de Serviço detecte e elimine mensagens duplicadas.</span><span class="sxs-lookup"><span data-stu-id="95592-165">This enables Service Bus to detect and eliminate duplicate messages.</span></span> <span data-ttu-id="95592-166">Se a propriedade [QueueDescription.RequiresDuplicateDetection][QueueDescription.RequiresDuplicateDetection] não for definida como **true**, o Barramento de Serviço não considerará a propriedade [MessageId][MessageId] como uma chave de partição.</span><span class="sxs-lookup"><span data-stu-id="95592-166">If the [QueueDescription.RequiresDuplicateDetection][QueueDescription.RequiresDuplicateDetection] property is not set to **true**, Service Bus does not consider the [MessageId][MessageId] property as a partition key.</span></span>

### <a name="not-using-a-partition-key"></a><span data-ttu-id="95592-167">Não usando uma chave de partição</span><span class="sxs-lookup"><span data-stu-id="95592-167">Not using a partition key</span></span>
<span data-ttu-id="95592-168">Na ausência de uma chave de partição, o Barramento de Serviço distribui mensagens em forma de round robin para todos os fragmentos da fila ou do tópico particionado.</span><span class="sxs-lookup"><span data-stu-id="95592-168">In the absence of a partition key, Service Bus distributes messages in a round-robin fashion to all the fragments of the partitioned queue or topic.</span></span> <span data-ttu-id="95592-169">Se o fragmento escolhido não estiver disponível, o Barramento de Serviço atribuirá a mensagem a um fragmento diferente.</span><span class="sxs-lookup"><span data-stu-id="95592-169">If the chosen fragment is not available, Service Bus assigns the message to a different fragment.</span></span> <span data-ttu-id="95592-170">Dessa forma, a operação de envio será bem-sucedida independentemente da indisponibilidade temporária de um repositório de mensagens.</span><span class="sxs-lookup"><span data-stu-id="95592-170">This way, the send operation succeeds despite the temporary unavailability of a messaging store.</span></span> <span data-ttu-id="95592-171">No entanto, você não obterá a ordenação garantida que uma chave de partição oferece.</span><span class="sxs-lookup"><span data-stu-id="95592-171">However, you will not achieve the guaranteed ordering that a partition key provides.</span></span>

<span data-ttu-id="95592-172">Para obter uma discussão mais detalhada sobre a compensação entre disponibilidade (sem chave de partição) e consistência (usando uma chave de partição), consulte [este artigo](../event-hubs/event-hubs-availability-and-consistency.md).</span><span class="sxs-lookup"><span data-stu-id="95592-172">For a more in-depth discussion of the tradeoff between availability (no partition key) and consistency (using a partition key), see [this article](../event-hubs/event-hubs-availability-and-consistency.md).</span></span> <span data-ttu-id="95592-173">Essa informação aplica-se igualmente às entidades do Barramento de Serviço particionadas e partições de Hubs de Eventos.</span><span class="sxs-lookup"><span data-stu-id="95592-173">This information applies equally to partitioned Service Bus entities and Event Hubs partitions.</span></span>

<span data-ttu-id="95592-174">Para dar ao Barramento de Serviço tempo suficiente para enfileirar a mensagem em um fragmento diferente, o valor de [MessagingFactorySettings.OperationTimeout][MessagingFactorySettings.OperationTimeout] especificado pelo cliente que envia a mensagem deve ser maior que 15 segundos.</span><span class="sxs-lookup"><span data-stu-id="95592-174">To give Service Bus enough time to enqueue the message into a different fragment, the [MessagingFactorySettings.OperationTimeout][MessagingFactorySettings.OperationTimeout] value specified by the client that sends the message must be greater than 15 seconds.</span></span> <span data-ttu-id="95592-175">É recomendável definir a propriedade [OperationTimeout][OperationTimeout] com o valor padrão de 60 segundos.</span><span class="sxs-lookup"><span data-stu-id="95592-175">It is recommended that you set the [OperationTimeout][OperationTimeout] property to the default value of 60 seconds.</span></span>

<span data-ttu-id="95592-176">Observe que uma chave de partição "fixa" uma mensagem a um fragmento específico.</span><span class="sxs-lookup"><span data-stu-id="95592-176">Note that a partition key "pins" a message to a specific fragment.</span></span> <span data-ttu-id="95592-177">Se o repositório de mensagens que mantém o fragmento estiver indisponível, o Barramento de Serviço retornará um erro.</span><span class="sxs-lookup"><span data-stu-id="95592-177">If the messaging store that holds this fragment is unavailable, Service Bus returns an error.</span></span> <span data-ttu-id="95592-178">Na ausência de uma chave de partição, o Barramento de Serviço pode escolher um fragmento diferente, e a operação será bem-sucedida.</span><span class="sxs-lookup"><span data-stu-id="95592-178">In the absence of a partition key, Service Bus can choose a different fragment and the operation succeeds.</span></span> <span data-ttu-id="95592-179">Portanto, é recomendável que você não forneça uma chave de partição, a menos que seja necessário.</span><span class="sxs-lookup"><span data-stu-id="95592-179">Therefore, it is recommended that you do not supply a partition key unless it is required.</span></span>

## <a name="advanced-topics-use-transactions-with-partitioned-entities"></a><span data-ttu-id="95592-180">Tópicos avançados: usar transações com entidades particionadas</span><span class="sxs-lookup"><span data-stu-id="95592-180">Advanced topics: use transactions with partitioned entities</span></span>
<span data-ttu-id="95592-181">As mensagens enviadas como parte de uma transação devem especificar uma chave de partição.</span><span class="sxs-lookup"><span data-stu-id="95592-181">Messages that are sent as part of a transaction must specify a partition key.</span></span> <span data-ttu-id="95592-182">Essa pode ser uma das seguintes propriedades: [BrokeredMessage.SessionId][BrokeredMessage.SessionId], [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] ou [BrokeredMessage.MessageId][BrokeredMessage.MessageId].</span><span class="sxs-lookup"><span data-stu-id="95592-182">This can be one of the following properties: [BrokeredMessage.SessionId][BrokeredMessage.SessionId], [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey], or [BrokeredMessage.MessageId][BrokeredMessage.MessageId].</span></span> <span data-ttu-id="95592-183">Todas as mensagens que são enviadas como parte da mesma transação devem especificar a mesma chave de partição.</span><span class="sxs-lookup"><span data-stu-id="95592-183">All messages that are sent as part of the same transaction must specify the same partition key.</span></span> <span data-ttu-id="95592-184">Caso você tente enviar uma mensagem sem uma chave de partição em uma transação, o Barramento de Serviço retornará uma exceção de operação inválida.</span><span class="sxs-lookup"><span data-stu-id="95592-184">If you attempt to send a message without a partition key within a transaction, Service Bus returns an invalid operation exception.</span></span> <span data-ttu-id="95592-185">Caso você tente enviar várias mensagens que tenham chaves de partição diferentes na mesma transação, o Barramento de Serviço retornará uma exceção de operação inválida.</span><span class="sxs-lookup"><span data-stu-id="95592-185">If you attempt to send multiple messages within the same transaction that have different partition keys, Service Bus returns an invalid operation exception.</span></span> <span data-ttu-id="95592-186">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="95592-186">For example:</span></span>

```csharp
CommittableTransaction committableTransaction = new CommittableTransaction();
using (TransactionScope ts = new TransactionScope(committableTransaction))
{
    BrokeredMessage msg = new BrokeredMessage("This is a message");
    msg.PartitionKey = "myPartitionKey";
    messageSender.Send(msg); 
    ts.Complete();
}
committableTransaction.Commit();
```

<span data-ttu-id="95592-187">Se qualquer uma das propriedades que servem como uma chave de partição for definida, o Barramento de Serviço fixará a mensagem a um fragmento específico.</span><span class="sxs-lookup"><span data-stu-id="95592-187">If any of the properties that serve as a partition key are set, Service Bus pins the message to a specific fragment.</span></span> <span data-ttu-id="95592-188">Esse comportamento ocorre quer uma transação seja usada ou não.</span><span class="sxs-lookup"><span data-stu-id="95592-188">This behavior occurs whether or not a transaction is used.</span></span> <span data-ttu-id="95592-189">É recomendável que você não especifique uma chave de partição se isso não for necessário.</span><span class="sxs-lookup"><span data-stu-id="95592-189">It is recommended that you do not specify a partition key if it is not necessary.</span></span>

## <a name="using-sessions-with-partitioned-entities"></a><span data-ttu-id="95592-190">Usando sessões com entidades particionadas</span><span class="sxs-lookup"><span data-stu-id="95592-190">Using sessions with partitioned entities</span></span>
<span data-ttu-id="95592-191">Para enviar uma mensagem transacional a uma fila ou um tópico com reconhecimento de sessão, a mensagem deve ter a propriedade [BrokeredMessage.SessionId][BrokeredMessage.SessionId] definida.</span><span class="sxs-lookup"><span data-stu-id="95592-191">To send a transactional message to a session-aware topic or queue, the message must have the [BrokeredMessage.SessionId][BrokeredMessage.SessionId] property set.</span></span> <span data-ttu-id="95592-192">Se a propriedade [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] também for especificada, ela deverá ser idêntica à propriedade [SessionId][SessionId].</span><span class="sxs-lookup"><span data-stu-id="95592-192">If the [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] property is specified as well, it must be identical to the [SessionId][SessionId] property.</span></span> <span data-ttu-id="95592-193">Caso elas sejam diferentes, o Barramento de Serviço retornará uma exceção de operação inválida.</span><span class="sxs-lookup"><span data-stu-id="95592-193">If they differ, Service Bus returns an invalid operation exception.</span></span>

<span data-ttu-id="95592-194">Diferentemente de filas ou tópicos regulares (não particionados), não é possível usar uma única transação para enviar várias mensagens a sessões diferentes.</span><span class="sxs-lookup"><span data-stu-id="95592-194">Unlike regular (non-partitioned) queues or topics, it is not possible to use a single transaction to send multiple messages to different sessions.</span></span> <span data-ttu-id="95592-195">Se você tentar fazer isso, o Barramento de Serviço retornará uma exceção de operação inválida.</span><span class="sxs-lookup"><span data-stu-id="95592-195">If attempted, Service Bus returns an invalid operation exception.</span></span> <span data-ttu-id="95592-196">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="95592-196">For example:</span></span>

```csharp
CommittableTransaction committableTransaction = new CommittableTransaction();
using (TransactionScope ts = new TransactionScope(committableTransaction))
{
    BrokeredMessage msg = new BrokeredMessage("This is a message");
    msg.SessionId = "mySession";
    messageSender.Send(msg); 
    ts.Complete();
}
committableTransaction.Commit();
```

## <a name="automatic-message-forwarding-with-partitioned-entities"></a><span data-ttu-id="95592-197">Encaminhamento automático de mensagens com entidades particionadas</span><span class="sxs-lookup"><span data-stu-id="95592-197">Automatic message forwarding with partitioned entities</span></span>
<span data-ttu-id="95592-198">O Barramento de Serviço dá suporte ao encaminhamento automático de mensagens de, para ou entre entidades particionadas.</span><span class="sxs-lookup"><span data-stu-id="95592-198">Service Bus supports automatic message forwarding from, to, or between partitioned entities.</span></span> <span data-ttu-id="95592-199">Para habilitar o encaminhamento automático de mensagens, defina a propriedade [QueueDescription.ForwardTo][QueueDescription.ForwardTo] na assinatura ou fila de origem.</span><span class="sxs-lookup"><span data-stu-id="95592-199">To enable automatic message forwarding, set the [QueueDescription.ForwardTo][QueueDescription.ForwardTo] property on the source queue or subscription.</span></span> <span data-ttu-id="95592-200">Se a mensagem especificar uma chave de partição ([SessionId][SessionId], [PartitionKey][PartitionKey] ou [MessageId][MessageId]), ela será usada para a entidade de destino.</span><span class="sxs-lookup"><span data-stu-id="95592-200">If the message specifies a partition key ([SessionId][SessionId], [PartitionKey][PartitionKey], or [MessageId][MessageId]), that partition key is used for the destination entity.</span></span>

## <a name="considerations-and-guidelines"></a><span data-ttu-id="95592-201">Considerações e diretrizes</span><span class="sxs-lookup"><span data-stu-id="95592-201">Considerations and guidelines</span></span>
* <span data-ttu-id="95592-202">**Recursos de alta consistência**: se uma entidade usa recursos como sessões, detecção de duplicidades ou controle explícito de chave de particionamento, as operações de mensagens serão sempre roteadas para fragmentos específicos.</span><span class="sxs-lookup"><span data-stu-id="95592-202">**High consistency features**: If an entity uses features such as sessions, duplicate detection, or explicit control of partitioning key, then the messaging operations are always routed to specific fragments.</span></span> <span data-ttu-id="95592-203">Se qualquer um dos fragmentos tiver alto tráfego ou se o repositório subjacente não estiver íntegro, essas operações falharão e a disponibilidade será reduzida.</span><span class="sxs-lookup"><span data-stu-id="95592-203">If any of the fragments experience high traffic or the underlying store is unhealthy, those operations fail and availability is reduced.</span></span> <span data-ttu-id="95592-204">Em geral, a consistência ainda é muito maior do que em entidades não particionadas; somente um subconjunto de tráfego tem problemas, em vez de todo o tráfego.</span><span class="sxs-lookup"><span data-stu-id="95592-204">Overall, the consistency is still much higher than non-partitioned entities; only a subset of traffic is experiencing issues, as opposed to all the traffic.</span></span> <span data-ttu-id="95592-205">Para obter mais informações, consulte esta [discussão sobre disponibilidade e consistência](../event-hubs/event-hubs-availability-and-consistency.md).</span><span class="sxs-lookup"><span data-stu-id="95592-205">For more information, see this [discussion of availability and consistency](../event-hubs/event-hubs-availability-and-consistency.md).</span></span>
* <span data-ttu-id="95592-206">**Gerenciamento**: operações como Criar, Atualizar e Excluir devem ser executadas em todos os fragmentos da entidade.</span><span class="sxs-lookup"><span data-stu-id="95592-206">**Management**: Operations such as Create, Update and Delete must be performed on all the fragments of the entity.</span></span> <span data-ttu-id="95592-207">Se qualquer fragmento não estiver íntegro, isso poderá resultar em falhas para essas operações.</span><span class="sxs-lookup"><span data-stu-id="95592-207">If any fragment is unhealthy it could result in failures for these operations.</span></span> <span data-ttu-id="95592-208">Para a operação Get, informações como contagens de mensagens devem ser agregadas de todos os fragmentos.</span><span class="sxs-lookup"><span data-stu-id="95592-208">For the Get operation, information such as message counts must be aggregated from all fragments.</span></span> <span data-ttu-id="95592-209">Se qualquer fragmento não estiver íntegro, o status de disponibilidade será relatado como limitado.</span><span class="sxs-lookup"><span data-stu-id="95592-209">If any fragment is unhealthy, the entity availability status is reported as limited.</span></span>
* <span data-ttu-id="95592-210">**Cenários de mensagens de baixo volume**: para esses cenários, particularmente ao usar o protocolo HTTP, talvez você precise executar várias operações de recebimento para obter todas as mensagens.</span><span class="sxs-lookup"><span data-stu-id="95592-210">**Low volume message scenarios**: For such scenarios, especially when using the HTTP protocol, you may have to perform multiple receive operations in order to obtain all the messages.</span></span> <span data-ttu-id="95592-211">Para solicitações de recebimento, o front-end executa um recebimento em todos os fragmentos e armazena em cache todas as respostas recebidas.</span><span class="sxs-lookup"><span data-stu-id="95592-211">For receive requests, the front end performs a receive on all the fragments and caches all the responses received.</span></span> <span data-ttu-id="95592-212">Uma solicitação de recebimento subsequente na mesma conexão se beneficiará desse armazenamento em cache, e as latências de recebimento serão menores.</span><span class="sxs-lookup"><span data-stu-id="95592-212">A subsequent receive request on the same connection would benefit from this caching and receive latencies will be lower.</span></span> <span data-ttu-id="95592-213">No entanto, se você tiver várias conexões ou se usar HTTP, isso estabelecerá uma nova conexão para cada solicitação.</span><span class="sxs-lookup"><span data-stu-id="95592-213">However, if you have multiple connections or use HTTP, that establishes a new connection for each request.</span></span> <span data-ttu-id="95592-214">Assim, não há garantia de que ela chegará ao mesmo nó.</span><span class="sxs-lookup"><span data-stu-id="95592-214">As such, there is no guarantee that it would land on the same node.</span></span> <span data-ttu-id="95592-215">Se todas as mensagens existentes forem bloqueadas e armazenadas em cache no outro front-end, a operação de recebimento resultará em **nulo**.</span><span class="sxs-lookup"><span data-stu-id="95592-215">If all existing messages are locked and cached in another front end, the receive operation returns **null**.</span></span> <span data-ttu-id="95592-216">As mensagens eventualmente expiram e você pode recebê-las novamente.</span><span class="sxs-lookup"><span data-stu-id="95592-216">Messages eventually expire and you can receive them again.</span></span> <span data-ttu-id="95592-217">O keep-alive de HTTP é recomendável.</span><span class="sxs-lookup"><span data-stu-id="95592-217">HTTP keep-alive is recommended.</span></span>
* <span data-ttu-id="95592-218">**Pesquisar/inspecionar mensagens**: o [PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) nem sempre retorna o número de mensagens especificado na propriedade [MessageCount](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_MessageCount).</span><span class="sxs-lookup"><span data-stu-id="95592-218">**Browse/Peek messages**: [PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) does not always return the number of messages specified in the [MessageCount](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_MessageCount) property.</span></span> <span data-ttu-id="95592-219">Há duas razões comuns para isso.</span><span class="sxs-lookup"><span data-stu-id="95592-219">There are two common reasons for this.</span></span> <span data-ttu-id="95592-220">Uma razão é que o tamanho agregado da coleção de mensagens excede o tamanho máximo de 256 KB.</span><span class="sxs-lookup"><span data-stu-id="95592-220">One reason is that the aggregated size of the collection of messages exceeds the maximum size of 256KB.</span></span> <span data-ttu-id="95592-221">Outra razão é que, se a fila ou o tópico tiver a [Propriedade EnablePartitioning](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_EnablePartitioning) definida como **verdadeiro**, uma partição poderá não ter mensagens suficientes para concluir o número solicitado de mensagens.</span><span class="sxs-lookup"><span data-stu-id="95592-221">Another reason is that if the queue or topic has the [EnablePartitioning property](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_EnablePartitioning) set to **true**, a partition may not have enough messages to complete the requested number of messages.</span></span> <span data-ttu-id="95592-222">Em geral, se um aplicativo quiser receber um número específico de mensagens, ele deverá solicitar [PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) repetidamente até obter o número de mensagens ou até não existirem mais mensagens para inspecionar.</span><span class="sxs-lookup"><span data-stu-id="95592-222">In general, if an application wants to receive a specific number of messages, it should call [PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) repeatedly until it gets that number of messages, or there are no more messages to peek.</span></span> <span data-ttu-id="95592-223">Para obter mais informações, incluindo exemplos de código, confira [QueueClient.PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) ou [SubscriptionClient.PeekBatch](/dotnet/api/microsoft.servicebus.messaging.subscriptionclient#Microsoft_ServiceBus_Messaging_SubscriptionClient_PeekBatch_System_Int32_).</span><span class="sxs-lookup"><span data-stu-id="95592-223">For more information, including code samples, see [QueueClient.PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) or [SubscriptionClient.PeekBatch](/dotnet/api/microsoft.servicebus.messaging.subscriptionclient#Microsoft_ServiceBus_Messaging_SubscriptionClient_PeekBatch_System_Int32_).</span></span>

## <a name="latest-added-features"></a><span data-ttu-id="95592-224">Últimos recursos adicionados</span><span class="sxs-lookup"><span data-stu-id="95592-224">Latest added features</span></span>
* <span data-ttu-id="95592-225">Agora há suporte para adicionar ou remover regras com entidades particionadas.</span><span class="sxs-lookup"><span data-stu-id="95592-225">Add or remove rule is now supported with partitioned entities.</span></span> <span data-ttu-id="95592-226">Diferentes de entidades não particionadas, essas operações não têm suporte em transações.</span><span class="sxs-lookup"><span data-stu-id="95592-226">Different from non-partitioned entities, these operations are not supported under transactions.</span></span> 
* <span data-ttu-id="95592-227">Agora há suporte a AMQP para enviar e receber mensagens de e para uma entidade particionada.</span><span class="sxs-lookup"><span data-stu-id="95592-227">AMQP is now supported for sending and receiving messages to and from a partitioned entity.</span></span>
* <span data-ttu-id="95592-228">O AMQP agora tem suporte para as seguintes operações: [Enviar em Lote](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_SendBatch_System_Collections_Generic_IEnumerable_Microsoft_ServiceBus_Messaging_BrokeredMessage__), [Receber em Lote](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_ReceiveBatch_System_Int32_), [Receber pelo Número de Sequência](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_Receive_System_Int64_), [Inspecionar](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_Peek), [Renovar Bloqueio](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_RenewMessageLock_System_Guid_), [Agendar Mensagem](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_ScheduleMessageAsync_Microsoft_ServiceBus_Messaging_BrokeredMessage_System_DateTimeOffset_), [Cancelar Mensagem Agendada](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_CancelScheduledMessageAsync_System_Int64_), [Adicionar Regra](/dotnet/api/microsoft.servicebus.messaging.ruledescription), [Remover Regra](/dotnet/api/microsoft.servicebus.messaging.ruledescription), [Renovar Bloqueio de Sessão](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_RenewLock), [Definir Estado de Sessão](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_SetState_System_IO_Stream_), [Obter Estado de Sessão](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_GetState) e [Enumerar Sessões](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_GetMessageSessionsAsync).</span><span class="sxs-lookup"><span data-stu-id="95592-228">AMQP is now supported for the following operations: [Batch Send](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_SendBatch_System_Collections_Generic_IEnumerable_Microsoft_ServiceBus_Messaging_BrokeredMessage__), [Batch Receive](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_ReceiveBatch_System_Int32_), [Receive by Sequence Number](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_Receive_System_Int64_), [Peek](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_Peek), [Renew Lock](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_RenewMessageLock_System_Guid_), [Schedule Message](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_ScheduleMessageAsync_Microsoft_ServiceBus_Messaging_BrokeredMessage_System_DateTimeOffset_), [Cancel Scheduled Message](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_CancelScheduledMessageAsync_System_Int64_), [Add Rule](/dotnet/api/microsoft.servicebus.messaging.ruledescription), [Remove Rule](/dotnet/api/microsoft.servicebus.messaging.ruledescription), [Session Renew Lock](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_RenewLock), [Set Session State](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_SetState_System_IO_Stream_), [Get Session State](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_GetState), and [Enumerate Sessions](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_GetMessageSessionsAsync).</span></span>

## <a name="partitioned-entities-limitations"></a><span data-ttu-id="95592-229">Limitações das entidades particionadas</span><span class="sxs-lookup"><span data-stu-id="95592-229">Partitioned entities limitations</span></span>
<span data-ttu-id="95592-230">Atualmente, o Barramento de Serviço impõe as seguintes limitações a filas e tópicos particionados:</span><span class="sxs-lookup"><span data-stu-id="95592-230">Currently Service Bus imposes the following limitations on partitioned queues and topics:</span></span>

* <span data-ttu-id="95592-231">Filas e tópicos particionados não dão suporte ao envio de mensagens que pertencem a sessões diferentes em uma única transação.</span><span class="sxs-lookup"><span data-stu-id="95592-231">Partitioned queues and topics do not support sending messages that belong to different sessions in a single transaction.</span></span>
* <span data-ttu-id="95592-232">O Barramento de Serviço atualmente permite até 100 filas ou tópicos particionados por namespace.</span><span class="sxs-lookup"><span data-stu-id="95592-232">Service Bus currently allows up to 100 partitioned queues or topics per namespace.</span></span> <span data-ttu-id="95592-233">Cada fila ou tópico particionado conta para a cota de 10.000 entidades por namespace (não se aplica à camada Premium).</span><span class="sxs-lookup"><span data-stu-id="95592-233">Each partitioned queue or topic counts towards the quota of 10,000 entities per namespace (does not apply to Premium tier).</span></span>

## <a name="next-steps"></a><span data-ttu-id="95592-234">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="95592-234">Next steps</span></span>
<span data-ttu-id="95592-235">Veja a discussão sobre o [Suporte a AMQP 1.0 para filas e tópicos particionados do Barramento de Serviço][AMQP 1.0 support for Service Bus partitioned queues and topics] para saber mais sobre como particionar entidades de mensagens.</span><span class="sxs-lookup"><span data-stu-id="95592-235">See the discussion of [AMQP 1.0 support for Service Bus partitioned queues and topics][AMQP 1.0 support for Service Bus partitioned queues and topics] to learn more about partitioning messaging entities.</span></span> 

[Service Bus architecture]: service-bus-architecture.md
[Azure portal]: https://portal.azure.com
[QueueDescription.EnablePartitioning]: /dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_EnablePartitioning
[TopicDescription.EnablePartitioning]: /dotnet/api/microsoft.servicebus.messaging.topicdescription#Microsoft_ServiceBus_Messaging_TopicDescription_EnablePartitioning
[BrokeredMessage.SessionId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_SessionId
[BrokeredMessage.PartitionKey]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_PartitionKey
[SessionId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_SessionId
[PartitionKey]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_PartitionKey
[QueueDescription.RequiresDuplicateDetection]: /dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_RequiresDuplicateDetection
[BrokeredMessage.MessageId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_MessageId
[MessageId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_MessageId
[MessagingFactorySettings.OperationTimeout]: /dotnet/api/microsoft.servicebus.messaging.messagingfactorysettings#Microsoft_ServiceBus_Messaging_MessagingFactorySettings_OperationTimeout
[OperationTimeout]: /dotnet/api/microsoft.servicebus.messaging.messagingfactorysettings#Microsoft_ServiceBus_Messaging_MessagingFactorySettings_OperationTimeout
[QueueDescription.ForwardTo]: /dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_ForwardTo
[AMQP 1.0 support for Service Bus partitioned queues and topics]: service-bus-partitioned-queues-and-topics-amqp-overview.md
