---
title: "Autenticação do Barramento de Serviço do Azure com Assinaturas de Acesso Compartilhado | Microsoft Docs"
description: "Visão geral da Autenticação do Barramento de Serviço usando a visão geral de Assinaturas de Acesso Compartilhado, detalhes sobre a autenticação SAS com o Barramento de Serviço do Azure."
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: 
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 08/23/2017
ms.author: sethm
ms.openlocfilehash: a2760072acb7c62204759f3ec0d3cb9899460f2d
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/29/2017
---
# <a name="service-bus-authentication-with-shared-access-signatures"></a><span data-ttu-id="e8363-103">Autenticação do Barramento de Serviço com Assinaturas de Acesso Compartilhado</span><span class="sxs-lookup"><span data-stu-id="e8363-103">Service Bus authentication with Shared Access Signatures</span></span>

<span data-ttu-id="e8363-104">As *Assinaturas de Acesso Compartilhado* (SAS) são o mecanismo de segurança principal para mensagens do Barramento de Serviço.</span><span class="sxs-lookup"><span data-stu-id="e8363-104">*Shared Access Signatures* (SAS) are the primary security mechanism for Service Bus messaging.</span></span> <span data-ttu-id="e8363-105">Este artigo discute as SAS, como elas funcionam e como usá-las de maneira independente da plataforma.</span><span class="sxs-lookup"><span data-stu-id="e8363-105">This article discusses SAS, how they work, and how to use them in a platform-agnostic way.</span></span>

<span data-ttu-id="e8363-106">A autenticação por SAS permite que os aplicativos se autentiquem no Barramento de Serviço usando uma chave de acesso configurada no namespace ou na entidade do sistema de mensagens (fila ou tópico) à qual estão associados direitos específicos.</span><span class="sxs-lookup"><span data-stu-id="e8363-106">SAS authentication enables applications to authenticate to Service Bus using an access key configured on the namespace, or on the messaging entity (queue or topic) with which specific rights are associated.</span></span> <span data-ttu-id="e8363-107">Você poderá então usar essa chave para gerar um token SAS que os clientes poderão usar para se autenticarem no Barramento de Serviço.</span><span class="sxs-lookup"><span data-stu-id="e8363-107">You can then use this key to generate a SAS token that clients can in turn use to authenticate to Service Bus.</span></span>

<span data-ttu-id="e8363-108">O suporte à autenticação SAS está incluído no SDK do Azure versão 2.0 e posteriores.</span><span class="sxs-lookup"><span data-stu-id="e8363-108">SAS authentication support is included in the Azure SDK version 2.0 and later.</span></span>

## <a name="overview-of-sas"></a><span data-ttu-id="e8363-109">Visão geral das SAS</span><span class="sxs-lookup"><span data-stu-id="e8363-109">Overview of SAS</span></span>

<span data-ttu-id="e8363-110">Assinaturas de acesso compartilhado são um mecanismo de autenticação com base em hashes seguros SHA-256 ou URIs.</span><span class="sxs-lookup"><span data-stu-id="e8363-110">Shared Access Signatures are an authentication mechanism based on SHA-256 secure hashes or URIs.</span></span> <span data-ttu-id="e8363-111">As SAS são um mecanismo extremamente poderoso usado por todos os serviços do Barramento de Serviço.</span><span class="sxs-lookup"><span data-stu-id="e8363-111">SAS is an extremely powerful mechanism that is used by all Service Bus services.</span></span> <span data-ttu-id="e8363-112">Na utilização real, as SAS têm dois componentes: uma *política de acesso compartilhado* e uma *Assinatura de Acesso Compartilhado* (normalmente chamada de *token*).</span><span class="sxs-lookup"><span data-stu-id="e8363-112">In actual use, SAS has two components: a *shared access policy* and a *Shared Access Signature* (often called a *token*).</span></span>

<span data-ttu-id="e8363-113">A autenticação SAS no Barramento de Serviço envolve a configuração de uma chave criptográfica com direitos associados em um recurso do Barramento de Serviço.</span><span class="sxs-lookup"><span data-stu-id="e8363-113">SAS authentication in Service Bus involves the configuration of a cryptographic key with associated rights on a Service Bus resource.</span></span> <span data-ttu-id="e8363-114">Os clientes solicitam acesso aos recursos do Barramento de Serviço ao apresentarem um token SAS.</span><span class="sxs-lookup"><span data-stu-id="e8363-114">Clients claim access to Service Bus resources by presenting a SAS token.</span></span> <span data-ttu-id="e8363-115">Esse token consiste no URI do recurso sendo acessado e uma expiração assinada com a chave  configurada.</span><span class="sxs-lookup"><span data-stu-id="e8363-115">This token consists of the resource URI being accessed, and an expiry signed with the configured key.</span></span>

<span data-ttu-id="e8363-116">É possível configurar regras de autorização de Assinatura de Acesso Compartilhado nas [retransmissões](service-bus-fundamentals-hybrid-solutions.md#relays), [filas](service-bus-fundamentals-hybrid-solutions.md#queues) e [tópicos](service-bus-fundamentals-hybrid-solutions.md#topics) do Barramento de Serviço.</span><span class="sxs-lookup"><span data-stu-id="e8363-116">You can configure Shared Access Signature authorization rules on Service Bus [relays](service-bus-fundamentals-hybrid-solutions.md#relays), [queues](service-bus-fundamentals-hybrid-solutions.md#queues), and [topics](service-bus-fundamentals-hybrid-solutions.md#topics).</span></span>

<span data-ttu-id="e8363-117">A autenticação SAS utiliza os seguintes elementos:</span><span class="sxs-lookup"><span data-stu-id="e8363-117">SAS authentication uses the following elements:</span></span>

* <span data-ttu-id="e8363-118">[Regra de autorização de Acesso Compartilhado](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule): uma chave criptográfica primária de 256 bits na representação Base64, uma chave secundária opcional e um nome de chave e os direitos associados (uma coleção de direitos *Listen*, *Send* ou *Manage*).</span><span class="sxs-lookup"><span data-stu-id="e8363-118">[Shared Access authorization rule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule): A 256-bit primary cryptographic key in Base64 representation, an optional secondary key, and a key name and associated rights (a collection of *Listen*, *Send*, or *Manage* rights).</span></span>
* <span data-ttu-id="e8363-119">[Assinatura de Acesso Compartilhado](/dotnet/api/microsoft.servicebus.sharedaccesssignaturetokenprovider) : gerado usando o HMAC-SHA256 de uma cadeia de caracteres de recurso, que consiste no URI do recurso acessado e em uma expiração, com a chave de criptografia.</span><span class="sxs-lookup"><span data-stu-id="e8363-119">[Shared Access Signature](/dotnet/api/microsoft.servicebus.sharedaccesssignaturetokenprovider) token: Generated using the HMAC-SHA256 of a resource string, consisting of the URI of the resource that is accessed and an expiry, with the cryptographic key.</span></span> <span data-ttu-id="e8363-120">A assinatura e outros elementos descritos nas seções a seguir são formatados em uma cadeia de caracteres para formar o token SAS.</span><span class="sxs-lookup"><span data-stu-id="e8363-120">The signature and other elements described in the following sections are formatted into a string to form the SAS token.</span></span>

## <a name="shared-access-policy"></a><span data-ttu-id="e8363-121">Política de acesso compartilhado</span><span class="sxs-lookup"><span data-stu-id="e8363-121">Shared access policy</span></span>

<span data-ttu-id="e8363-122">Uma coisa importante para entender sobre a SAS é que ela começa com uma política.</span><span class="sxs-lookup"><span data-stu-id="e8363-122">An important thing to understand about SAS is that it starts with a policy.</span></span> <span data-ttu-id="e8363-123">Para cada política, você toma decisões quanto a três informações: **nome**, **escopo** e **permissões**.</span><span class="sxs-lookup"><span data-stu-id="e8363-123">For each policy, you decide on three pieces of information: **name**, **scope**, and **permissions**.</span></span> <span data-ttu-id="e8363-124">O **nome** é apenas isso, um nome exclusivo dentro do escopo.</span><span class="sxs-lookup"><span data-stu-id="e8363-124">The **name** is just that; a unique name within that scope.</span></span> <span data-ttu-id="e8363-125">O escopo é bastante simples: é o URI do recurso em questão.</span><span class="sxs-lookup"><span data-stu-id="e8363-125">The scope is easy enough: it's the URI of the resource in question.</span></span> <span data-ttu-id="e8363-126">Para um namespace do Barramento de Serviço, o escopo é o FQDN (nome de domínio totalmente qualificado), como `https://<yournamespace>.servicebus.windows.net/`.</span><span class="sxs-lookup"><span data-stu-id="e8363-126">For a Service Bus namespace, the scope is the fully qualified domain name (FQDN), such as `https://<yournamespace>.servicebus.windows.net/`.</span></span>

<span data-ttu-id="e8363-127">As permissões disponíveis para uma política são bastante autoexplicativas:</span><span class="sxs-lookup"><span data-stu-id="e8363-127">The available permissions for a policy are largely self-explanatory:</span></span>

* <span data-ttu-id="e8363-128">Enviar</span><span class="sxs-lookup"><span data-stu-id="e8363-128">Send</span></span>
* <span data-ttu-id="e8363-129">Escutar</span><span class="sxs-lookup"><span data-stu-id="e8363-129">Listen</span></span>
* <span data-ttu-id="e8363-130">Gerenciar</span><span class="sxs-lookup"><span data-stu-id="e8363-130">Manage</span></span>

<span data-ttu-id="e8363-131">Depois de você criar a política, ela recebe uma *Chave primária* e uma *Chave secundária*.</span><span class="sxs-lookup"><span data-stu-id="e8363-131">After you create the policy, it is assigned a *Primary Key* and a *Secondary Key*.</span></span> <span data-ttu-id="e8363-132">Essas chaves são criptograficamente fortes.</span><span class="sxs-lookup"><span data-stu-id="e8363-132">These are cryptographically strong keys.</span></span> <span data-ttu-id="e8363-133">Não as perca ou divulgue - elas sempre estarão disponíveis no [portal do Azure][Azure portal].</span><span class="sxs-lookup"><span data-stu-id="e8363-133">Don't lose them or leak them - they'll always be available in the [Azure portal][Azure portal].</span></span> <span data-ttu-id="e8363-134">Você pode usar qualquer uma das chaves geradas e pode gerá-las novamente a qualquer momento.</span><span class="sxs-lookup"><span data-stu-id="e8363-134">You can use either of the generated keys, and you can regenerate them at any time.</span></span> <span data-ttu-id="e8363-135">No entanto, se você gera novamente ou altera a chave primária da política, quaisquer Assinaturas de acesso compartilhado criadas por meio dela serão invalidadas.</span><span class="sxs-lookup"><span data-stu-id="e8363-135">However, if you regenerate or change the primary key in the policy, any Shared Access Signatures created from it will be invalidated.</span></span>

<span data-ttu-id="e8363-136">Quando você cria um namespace do Barramento de Serviço, é criada automaticamente uma política para todo o namespace chamada **RootManageSharedAccessKey**, e essa política tem todas as permissões.</span><span class="sxs-lookup"><span data-stu-id="e8363-136">When you create a Service Bus namespace, a policy is automatically created for the entire namespace called **RootManageSharedAccessKey**, and this policy has all permissions.</span></span> <span data-ttu-id="e8363-137">Você não faz logon como **raiz**.</span><span class="sxs-lookup"><span data-stu-id="e8363-137">You don't log on as **root**, so don't use this policy unless there's a really good reason.</span></span> <span data-ttu-id="e8363-138">É possível criar políticas adicionais na guia **Configurar** para o namespace no Portal.</span><span class="sxs-lookup"><span data-stu-id="e8363-138">You can create additional policies in the **Configure** tab for the namespace in the portal.</span></span> <span data-ttu-id="e8363-139">É importante observar que um único nível de árvore no Barramento de Serviço (namespace, fila etc.) só pode ter até 12 políticas anexadas a ele.</span><span class="sxs-lookup"><span data-stu-id="e8363-139">It's important to note that a single tree level in Service Bus (namespace, queue, etc.) can only have up to 12 policies attached to it.</span></span>

## <a name="configuration-for-shared-access-signature-authentication"></a><span data-ttu-id="e8363-140">Configuração da autenticação de Assinatura de Acesso Compartilhado</span><span class="sxs-lookup"><span data-stu-id="e8363-140">Configuration for Shared Access Signature authentication</span></span>
<span data-ttu-id="e8363-141">Você pode configurar a regra [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) em namespaces, filas ou tópicos do Barramento de Serviço.</span><span class="sxs-lookup"><span data-stu-id="e8363-141">You can configure the [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) rule on Service Bus namespaces, queues, or topics.</span></span> <span data-ttu-id="e8363-142">A configuração de um [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) em uma assinatura do Barramento de Serviço não tem suporte no momento, mas você pode usar regras configuradas em um namespace ou em um tópico para proteger o acesso a assinaturas.</span><span class="sxs-lookup"><span data-stu-id="e8363-142">Configuring a [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) on a Service Bus subscription is currently not supported, but you can use rules configured on a namespace or topic to secure access to subscriptions.</span></span> <span data-ttu-id="e8363-143">Para obter um exemplo funcional que ilustre este procedimento, confira o exemplo [Usando a autenticação de Assinatura de Acesso Compartilhado (SAS) com assinaturas do Barramento de Serviço](http://code.msdn.microsoft.com/Using-Shared-Access-e605b37c) .</span><span class="sxs-lookup"><span data-stu-id="e8363-143">For a working sample that illustrates this procedure, see the [Using Shared Access Signature (SAS) authentication with Service Bus Subscriptions](http://code.msdn.microsoft.com/Using-Shared-Access-e605b37c) sample.</span></span>

<span data-ttu-id="e8363-144">Você pode configurar até 12 dessas regras em um namespace, fila ou tópico do Barramento de Serviço.</span><span class="sxs-lookup"><span data-stu-id="e8363-144">A maximum of 12 such rules can be configured on a Service Bus namespace, queue, or topic.</span></span> <span data-ttu-id="e8363-145">As regras configuradas em um namespace do Barramento de Serviço se aplicam a todas as entidades nesse namespace.</span><span class="sxs-lookup"><span data-stu-id="e8363-145">Rules that are configured on a Service Bus namespace apply to all entities in that namespace.</span></span>

![SAS](./media/service-bus-sas/service-bus-namespace.png)

<span data-ttu-id="e8363-147">Nessa figura, as regras de autorização *manageRuleNS*, *sendRuleNS* e *listenRuleNS* se aplicam à fila Q1 e ao tópico T1, enquanto *listenRuleQ* e *sendRuleQ* se aplicam somente à fila Q1 e *sendRuleT* se aplica apenas ao tópico T1.</span><span class="sxs-lookup"><span data-stu-id="e8363-147">In this figure, the *manageRuleNS*, *sendRuleNS*, and *listenRuleNS* authorization rules apply to both queue Q1 and topic T1, while *listenRuleQ* and *sendRuleQ* apply only to queue Q1 and *sendRuleT* applies only to topic T1.</span></span>

<span data-ttu-id="e8363-148">Os parâmetros de chave de uma [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) são os seguintes:</span><span class="sxs-lookup"><span data-stu-id="e8363-148">The key parameters of a [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) are as follows:</span></span>

| <span data-ttu-id="e8363-149">Parâmetro</span><span class="sxs-lookup"><span data-stu-id="e8363-149">Parameter</span></span> | <span data-ttu-id="e8363-150">Descrição</span><span class="sxs-lookup"><span data-stu-id="e8363-150">Description</span></span> |
| --- | --- |
| <span data-ttu-id="e8363-151">*KeyName*</span><span class="sxs-lookup"><span data-stu-id="e8363-151">*KeyName*</span></span> |<span data-ttu-id="e8363-152">Uma cadeia de caracteres que descreve a regra de autorização.</span><span class="sxs-lookup"><span data-stu-id="e8363-152">A string that describes the authorization rule.</span></span> |
| <span data-ttu-id="e8363-153">*PrimaryKey*</span><span class="sxs-lookup"><span data-stu-id="e8363-153">*PrimaryKey*</span></span> |<span data-ttu-id="e8363-154">Uma chave primária de 256 bits codificada em base64 para assinatura e validação do token SAS.</span><span class="sxs-lookup"><span data-stu-id="e8363-154">A base64-encoded 256-bit primary key for signing and validating the SAS token.</span></span> |
| <span data-ttu-id="e8363-155">*SecondaryKey*</span><span class="sxs-lookup"><span data-stu-id="e8363-155">*SecondaryKey*</span></span> |<span data-ttu-id="e8363-156">Uma chave secundária de 256 bits codificada em base64 para assinatura e validação do token SAS.</span><span class="sxs-lookup"><span data-stu-id="e8363-156">A base64-encoded 256-bit secondary key for signing and validating the SAS token.</span></span> |
| <span data-ttu-id="e8363-157">*AccessRights*</span><span class="sxs-lookup"><span data-stu-id="e8363-157">*AccessRights*</span></span> |<span data-ttu-id="e8363-158">Uma lista de direitos de acesso concedidos pela regra de autorização.</span><span class="sxs-lookup"><span data-stu-id="e8363-158">A list of access rights granted by the authorization rule.</span></span> <span data-ttu-id="e8363-159">Esses direitos podem ser qualquer coleção de direitos Escutar, Enviar e Gerenciar.</span><span class="sxs-lookup"><span data-stu-id="e8363-159">These rights can be any collection of Listen, Send, and Manage rights.</span></span> |

<span data-ttu-id="e8363-160">Quando um namespace do Barramento de Serviço é provisionado, uma [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) com [KeyName](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_KeyName) definido como **RootManageSharedAccessKey** é criada por padrão.</span><span class="sxs-lookup"><span data-stu-id="e8363-160">When a Service Bus namespace is provisioned, a [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule), with [KeyName](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_KeyName) set to **RootManageSharedAccessKey**, is created by default.</span></span>

## <a name="generate-a-shared-access-signature-token"></a><span data-ttu-id="e8363-161">Gerar uma Assinatura de Acesso Compartilhado (token)</span><span class="sxs-lookup"><span data-stu-id="e8363-161">Generate a Shared Access Signature (token)</span></span>

<span data-ttu-id="e8363-162">A política em si não é o token de acesso para o Barramento de Serviço.</span><span class="sxs-lookup"><span data-stu-id="e8363-162">The policy itself is not the access token for Service Bus.</span></span> <span data-ttu-id="e8363-163">Ela é o objeto por meio do qual o token de acesso é gerado - usando a chave primária ou secundária.</span><span class="sxs-lookup"><span data-stu-id="e8363-163">It is the object from which the access token is generated - using either the primary or secondary key.</span></span> <span data-ttu-id="e8363-164">Qualquer cliente que tenha acesso às chaves de assinatura especificadas na regra de autorização de acesso compartilhado poderá gerar o token SAS.</span><span class="sxs-lookup"><span data-stu-id="e8363-164">Any client that has access to the signing keys specified in the shared access authorization rule can generate the SAS token.</span></span> <span data-ttu-id="e8363-165">O token é gerado ao criar cuidadosamente uma cadeia de caracteres no seguinte formato:</span><span class="sxs-lookup"><span data-stu-id="e8363-165">The token is generated by carefully crafting a string in the following format:</span></span>

```
SharedAccessSignature sig=<signature-string>&se=<expiry>&skn=<keyName>&sr=<URL-encoded-resourceURI>
```

<span data-ttu-id="e8363-166">Em que `signature-string` é o hash SHA-256 do escopo do token (**escopo** conforme descrito na seção anterior) com um CRLF anexado e uma hora de validade (em segundos desde a época: `00:00:00 UTC` em 1º de janeiro de 1970).</span><span class="sxs-lookup"><span data-stu-id="e8363-166">Where `signature-string` is the SHA-256 hash of the scope of the token (**scope** as described in the previous section) with a CRLF appended and an expiry time (in seconds since the epoch: `00:00:00 UTC` on 1 January 1970).</span></span> 

> [!NOTE]
> <span data-ttu-id="e8363-167">Para evitar um tempo de expiração curto de token, é recomendável que você codificar o valor de tempo de expiração como pelo menos um inteiro não assinado de 32 bits ou, preferencialmente, um inteiro longo (64 bits).</span><span class="sxs-lookup"><span data-stu-id="e8363-167">To avoid a short token expiry time, it is recommended that you encode the expiry time value as at least a 32-bit unsigned integer, or preferably a long (64-bit) integer.</span></span>  
> 
> 

<span data-ttu-id="e8363-168">O hash é semelhante ao seguinte pseudocódigo e retorna 32 bytes.</span><span class="sxs-lookup"><span data-stu-id="e8363-168">The hash looks similar to the following pseudo code and returns 32 bytes.</span></span>

```
SHA-256('https://<yournamespace>.servicebus.windows.net/'+'\n'+ 1438205742)
```

<span data-ttu-id="e8363-169">Os valores não hash estão na cadeia de caracteres **SharedAccessSignature** para que o destinatário possa calcular o hash com os mesmos parâmetros para garantir que o mesmo resultado seja retornado.</span><span class="sxs-lookup"><span data-stu-id="e8363-169">The non-hashed values are in the **SharedAccessSignature** string so that the recipient can compute the hash with the same parameters, to be sure that it returns the same result.</span></span> <span data-ttu-id="e8363-170">O URI especifica o escopo e o nome da chave identifica a política a ser usada para computar o hash.</span><span class="sxs-lookup"><span data-stu-id="e8363-170">The URI specifies the scope, and the key name identifies the policy to be used to compute the hash.</span></span> <span data-ttu-id="e8363-171">Isso é importante de um ponto de vista de segurança.</span><span class="sxs-lookup"><span data-stu-id="e8363-171">This is important from a security standpoint.</span></span> <span data-ttu-id="e8363-172">Se a assinatura não coincidir com aquela que o destinatário (Barramento de Serviço) calcula, o acesso é negado.</span><span class="sxs-lookup"><span data-stu-id="e8363-172">If the signature doesn't match that which the recipient (Service Bus) calculates, then access is denied.</span></span> <span data-ttu-id="e8363-173">Nesse ponto, você pode ter certeza de que o remetente tinha acesso à chave e de que deve ter os direitos especificados na política.</span><span class="sxs-lookup"><span data-stu-id="e8363-173">At this point you can be sure that the sender had access to the key and should be granted the rights specified in the policy.</span></span>

<span data-ttu-id="e8363-174">Observe que você deve usar o URI do recurso codificado para esta operação.</span><span class="sxs-lookup"><span data-stu-id="e8363-174">Note that you should use the encoded resource URI for this operation.</span></span> <span data-ttu-id="e8363-175">O URI do recurso é o URI completo do recurso do Barramento de Serviço ao qual o acesso é solicitado.</span><span class="sxs-lookup"><span data-stu-id="e8363-175">The resource URI is the full URI of the Service Bus resource to which access is claimed.</span></span> <span data-ttu-id="e8363-176">Por exemplo, `http://<namespace>.servicebus.windows.net/<entityPath>` ou `sb://<namespace>.servicebus.windows.net/<entityPath>`; ou seja, `http://contoso.servicebus.windows.net/contosoTopics/T1/Subscriptions/S3`.</span><span class="sxs-lookup"><span data-stu-id="e8363-176">For example, `http://<namespace>.servicebus.windows.net/<entityPath>` or `sb://<namespace>.servicebus.windows.net/<entityPath>`; that is, `http://contoso.servicebus.windows.net/contosoTopics/T1/Subscriptions/S3`.</span></span>

<span data-ttu-id="e8363-177">A regra de autorização de acesso compartilhado usada para assinar deve ser configurada na entidade especificada por esse URI ou por um de seus pais hierárquicos.</span><span class="sxs-lookup"><span data-stu-id="e8363-177">The shared access authorization rule used for signing must be configured on the entity specified by this URI, or by one of its hierarchical parents.</span></span> <span data-ttu-id="e8363-178">Por exemplo, `http://contoso.servicebus.windows.net/contosoTopics/T1` ou `http://contoso.servicebus.windows.net` no exemplo anterior.</span><span class="sxs-lookup"><span data-stu-id="e8363-178">For example, `http://contoso.servicebus.windows.net/contosoTopics/T1` or `http://contoso.servicebus.windows.net` in the previous example.</span></span>

<span data-ttu-id="e8363-179">Um token SAS é válido para todos os recursos sob o `<resourceURI>` usado na `signature-string`.</span><span class="sxs-lookup"><span data-stu-id="e8363-179">A SAS token is valid for all resources under the `<resourceURI>` used in the `signature-string`.</span></span>

<span data-ttu-id="e8363-180">O [KeyName](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_KeyName) no token SAS refere-se ao **keyName** da regra de autorização de acesso compartilhado usada para gerar o token.</span><span class="sxs-lookup"><span data-stu-id="e8363-180">The [KeyName](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_KeyName) in the SAS token refers to the **keyName** of the shared access authorization rule used to generate the token.</span></span>

<span data-ttu-id="e8363-181">O *URL-encoded-resourceURI* deve ser igual ao URI usado na cadeia de caracteres a assinar durante o cálculo da assinatura.</span><span class="sxs-lookup"><span data-stu-id="e8363-181">The *URL-encoded-resourceURI* must be the same as the URI used in the string-to-sign during the computation of the signature.</span></span> <span data-ttu-id="e8363-182">Ele deve ser [codificado por percentual](https://msdn.microsoft.com/library/4fkewx0t.aspx).</span><span class="sxs-lookup"><span data-stu-id="e8363-182">It should be [percent-encoded](https://msdn.microsoft.com/library/4fkewx0t.aspx).</span></span>

<span data-ttu-id="e8363-183">É recomendável que você regenere periodicamente as chaves usadas no objeto [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) .</span><span class="sxs-lookup"><span data-stu-id="e8363-183">It is recommended that you periodically regenerate the keys used in the [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) object.</span></span> <span data-ttu-id="e8363-184">Geralmente, os aplicativos devem usar a [PrimaryKey](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_PrimaryKey) para gerar um token SAS.</span><span class="sxs-lookup"><span data-stu-id="e8363-184">Applications should generally use the [PrimaryKey](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_PrimaryKey) to generate a SAS token.</span></span> <span data-ttu-id="e8363-185">Ao regenerar as chaves, você deverá substituir a [SecondaryKey](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_SecondaryKey) pela chave primária antiga e gerar uma nova chave como a nova chave primária.</span><span class="sxs-lookup"><span data-stu-id="e8363-185">When regenerating the keys, you should replace the [SecondaryKey](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_SecondaryKey) with the old primary key, and generate a new key as the new primary key.</span></span> <span data-ttu-id="e8363-186">Isso permite que você continue usando tokens para autorização que tenham sido emitidos com a antiga chave primária e que ainda não tenham expirado.</span><span class="sxs-lookup"><span data-stu-id="e8363-186">This enables you to continue using tokens for authorization that were issued with the old primary key, and that have not yet expired.</span></span>

<span data-ttu-id="e8363-187">Se uma chave estiver comprometida e se você precisar revogar as chaves, será possível gerar novamente a [PrimaryKey](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_PrimaryKey) e a [SecondaryKey](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_SecondaryKey) de uma [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule), substituindo-as por novas chaves.</span><span class="sxs-lookup"><span data-stu-id="e8363-187">If a key is compromised and you have to revoke the keys, you can regenerate both the [PrimaryKey](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_PrimaryKey) and the [SecondaryKey](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_SecondaryKey) of a [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule), replacing them with new keys.</span></span> <span data-ttu-id="e8363-188">Este procedimento invalida todos os tokens assinados com as chaves antigas.</span><span class="sxs-lookup"><span data-stu-id="e8363-188">This procedure invalidates all tokens signed with the old keys.</span></span>

## <a name="how-to-use-shared-access-signature-authentication-with-service-bus"></a><span data-ttu-id="e8363-189">Como usar a autenticação de Assinatura de Acesso Compartilhado com Barramento de Serviço</span><span class="sxs-lookup"><span data-stu-id="e8363-189">How to use Shared Access Signature authentication with Service Bus</span></span>

<span data-ttu-id="e8363-190">Os cenários a seguir incluem a configuração de regras de autorização, a geração de tokens SAS e a autorização de cliente.</span><span class="sxs-lookup"><span data-stu-id="e8363-190">The following scenarios include configuration of authorization rules, generation of SAS tokens, and client authorization.</span></span>

<span data-ttu-id="e8363-191">Para um exemplo funcional completo de um aplicativo do Barramento de Serviço que ilustre a configuração e use a autorização SAS, confira [Autenticação de Assinatura de Acesso Compartilhado com o Barramento de Serviço](http://code.msdn.microsoft.com/Shared-Access-Signature-0a88adf8).</span><span class="sxs-lookup"><span data-stu-id="e8363-191">For a full working sample of a Service Bus application that illustrates the configuration and uses SAS authorization, see [Shared Access Signature authentication with Service Bus](http://code.msdn.microsoft.com/Shared-Access-Signature-0a88adf8).</span></span> <span data-ttu-id="e8363-192">Há um exemplo relacionado que ilustra o uso de regras de autorização SAS configuradas em namespaces ou em tópicos para proteger assinaturas do Barramento de Serviço disponível aqui: [Usando a autenticação de Assinatura de Acesso Compartilhado (SAS) com as assinaturas do Barramento de Serviço](http://code.msdn.microsoft.com/Using-Shared-Access-e605b37c).</span><span class="sxs-lookup"><span data-stu-id="e8363-192">A related sample that illustrates the use of SAS authorization rules configured on namespaces or topics to secure Service Bus subscriptions is available here: [Using Shared Access Signature (SAS) authentication with Service Bus Subscriptions](http://code.msdn.microsoft.com/Using-Shared-Access-e605b37c).</span></span>

## <a name="access-shared-access-authorization-rules-on-a-namespace"></a><span data-ttu-id="e8363-193">Acessar regras de autorização de Acesso Compartilhado em um namespace</span><span class="sxs-lookup"><span data-stu-id="e8363-193">Access Shared Access Authorization rules on a namespace</span></span>

<span data-ttu-id="e8363-194">As operações na raiz do namespace do Barramento de Serviço exigem a autenticação de certificado.</span><span class="sxs-lookup"><span data-stu-id="e8363-194">Operations on the Service Bus namespace root require certificate authentication.</span></span> <span data-ttu-id="e8363-195">Você deve carregar um certificado de gerenciamento da sua assinatura do Azure.</span><span class="sxs-lookup"><span data-stu-id="e8363-195">You must upload a management certificate for your Azure subscription.</span></span> <span data-ttu-id="e8363-196">Para carregar um certificado de gerenciamento, siga as etapas [aqui](../cloud-services/cloud-services-configure-ssl-certificate-portal.md#step-3-upload-a-certificate), usando o [portal do Azure][Azure portal].</span><span class="sxs-lookup"><span data-stu-id="e8363-196">To upload a management certificate, follow the steps [here](../cloud-services/cloud-services-configure-ssl-certificate-portal.md#step-3-upload-a-certificate), using the [Azure portal][Azure portal].</span></span> <span data-ttu-id="e8363-197">Para saber mais sobre certificados de gerenciamento do Azure, confira [Visão geral sobre certificados do Azure](../cloud-services/cloud-services-certs-create.md#what-are-management-certificates).</span><span class="sxs-lookup"><span data-stu-id="e8363-197">For more information about Azure management certificates, see the [Azure certificates overview](../cloud-services/cloud-services-certs-create.md#what-are-management-certificates).</span></span>

<span data-ttu-id="e8363-198">O ponto de extremidade para acessar regras de autorização de acesso compartilhado em um namespace do Barramento de Serviço é o seguinte:</span><span class="sxs-lookup"><span data-stu-id="e8363-198">The endpoint for accessing shared access authorization rules on a Service Bus namespace is as follows:</span></span>

```http
https://management.core.windows.net/{subscriptionId}/services/ServiceBus/namespaces/{namespace}/AuthorizationRules/
```

<span data-ttu-id="e8363-199">Para criar um objeto [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) em um namespace do Barramento de Serviço, execute uma operação POST nesse ponto de extremidade com as informações da regra serializadas como JSON ou XML.</span><span class="sxs-lookup"><span data-stu-id="e8363-199">To create a [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) object on a Service Bus namespace, execute a POST operation on this endpoint with the rule information serialized as JSON or XML.</span></span> <span data-ttu-id="e8363-200">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="e8363-200">For example:</span></span>

```csharp
// Base address for accessing authorization rules on a namespace
string baseAddress = @"https://management.core.windows.net/<subscriptionId>/services/ServiceBus/namespaces/<namespace>/AuthorizationRules/";

// Configure authorization rule with base64-encoded 256-bit key and Send rights
var sendRule = new SharedAccessAuthorizationRule("contosoSendAll",
    SharedAccessAuthorizationRule.GenerateRandomKey(),
    new[] { AccessRights.Send });

// Operations on the Service Bus namespace root require certificate authentication.
WebRequestHandler handler = new WebRequestHandler
{
    ClientCertificateOptions = ClientCertificateOption.Manual
};
// Access the management certificate by subject name
handler.ClientCertificates.Add(GetCertificate(<certificateSN>));

HttpClient httpClient = new HttpClient(handler)
{
    BaseAddress = new Uri(baseAddress)
};
httpClient.DefaultRequestHeaders.Accept.Add(
    new MediaTypeWithQualityHeaderValue("application/json"));
httpClient.DefaultRequestHeaders.Add("x-ms-version", "2015-01-01");

// Execute a POST operation on the baseAddress above to create an auth rule
var postResult = httpClient.PostAsJsonAsync("", sendRule).Result;
```

<span data-ttu-id="e8363-201">Da mesma forma, use uma operação GET no ponto de extremidade para ler as regras de autorização configuradas no namespace.</span><span class="sxs-lookup"><span data-stu-id="e8363-201">Similarly, use a GET operation on the endpoint to read the authorization rules configured on the namespace.</span></span>

<span data-ttu-id="e8363-202">Para atualizar ou excluir uma regra de autorização específica, use o ponto de extremidade a seguir:</span><span class="sxs-lookup"><span data-stu-id="e8363-202">To update or delete a specific authorization rule, use the following endpoint:</span></span>

```http
https://management.core.windows.net/{subscriptionId}/services/ServiceBus/namespaces/{namespace}/AuthorizationRules/{KeyName}
```

## <a name="access-shared-access-authorization-rules-on-an-entity"></a><span data-ttu-id="e8363-203">Acessar regras de Autorização de Acesso Compartilhado em uma entidade</span><span class="sxs-lookup"><span data-stu-id="e8363-203">Access Shared Access Authorization rules on an entity</span></span>

<span data-ttu-id="e8363-204">É possível acessar um objeto [Microsoft.ServiceBus.Messaging.SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) configurado em uma fila ou tópico do Barramento de Serviço por meio da coleção [AuthorizationRules](/dotnet/api/microsoft.servicebus.messaging.authorizationrules) na [QueueDescription](/dotnet/api/microsoft.servicebus.messaging.queuedescription) ou na [TopicDescription](/dotnet/api/microsoft.servicebus.messaging.topicdescription).</span><span class="sxs-lookup"><span data-stu-id="e8363-204">You can access a [Microsoft.ServiceBus.Messaging.SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) object configured on a Service Bus queue or topic through the [AuthorizationRules](/dotnet/api/microsoft.servicebus.messaging.authorizationrules) collection in the corresponding [QueueDescription](/dotnet/api/microsoft.servicebus.messaging.queuedescription) or [TopicDescription](/dotnet/api/microsoft.servicebus.messaging.topicdescription).</span></span>

<span data-ttu-id="e8363-205">O código a seguir mostra como adicionar regras de autorização para uma fila.</span><span class="sxs-lookup"><span data-stu-id="e8363-205">The following code shows how to add authorization rules for a queue.</span></span>

```csharp
// Create an instance of NamespaceManager for the operation
NamespaceManager nsm = NamespaceManager.CreateFromConnectionString(
    <connectionString> );
QueueDescription qd = new QueueDescription( <qPath> );

// Create a rule with send rights with keyName as "contosoQSendKey"
// and add it to the queue description.
qd.Authorization.Add(new SharedAccessAuthorizationRule("contosoSendKey",
    SharedAccessAuthorizationRule.GenerateRandomKey(),
    new[] { AccessRights.Send }));

// Create a rule with listen rights with keyName as "contosoQListenKey"
// and add it to the queue description.
qd.Authorization.Add(new SharedAccessAuthorizationRule("contosoQListenKey",
    SharedAccessAuthorizationRule.GenerateRandomKey(),
    new[] { AccessRights.Listen }));

// Create a rule with manage rights with keyName as "contosoQManageKey"
// and add it to the queue description.
// A rule with manage rights must also have send and receive rights.
qd.Authorization.Add(new SharedAccessAuthorizationRule("contosoQManageKey",
    SharedAccessAuthorizationRule.GenerateRandomKey(),
    new[] {AccessRights.Manage, AccessRights.Listen, AccessRights.Send }));

// Create the queue.
nsm.CreateQueue(qd);
```

## <a name="use-shared-access-signature-authorization"></a><span data-ttu-id="e8363-206">Usar a autorização de Assinatura de Acesso Compartilhado</span><span class="sxs-lookup"><span data-stu-id="e8363-206">Use Shared Access Signature authorization</span></span>

<span data-ttu-id="e8363-207">Aplicativos usando o SDK do .NET do Azure com as bibliotecas .NET do Barramento de Serviço podem usar a autorização SAS por meio da classe [SharedAccessSignatureTokenProvider](/dotnet/api/microsoft.servicebus.sharedaccesssignaturetokenprovider) .</span><span class="sxs-lookup"><span data-stu-id="e8363-207">Applications using the Azure .NET SDK with the Service Bus .NET libraries can use SAS authorization through the [SharedAccessSignatureTokenProvider](/dotnet/api/microsoft.servicebus.sharedaccesssignaturetokenprovider) class.</span></span> <span data-ttu-id="e8363-208">O código a seguir ilustra o uso do provedor do token para enviar mensagens para uma fila do Barramento de Serviço.</span><span class="sxs-lookup"><span data-stu-id="e8363-208">The following code illustrates the use of the token provider to send messages to a Service Bus queue.</span></span>

```csharp
Uri runtimeUri = ServiceBusEnvironment.CreateServiceUri("sb",
    <yourServiceNamespace>, string.Empty);
MessagingFactory mf = MessagingFactory.Create(runtimeUri,
    TokenProvider.CreateSharedAccessSignatureTokenProvider(keyName, key));
QueueClient sendClient = mf.CreateQueueClient(qPath);

//Sending hello message to queue.
BrokeredMessage helloMessage = new BrokeredMessage("Hello, Service Bus!");
helloMessage.MessageId = "SAS-Sample-Message";
sendClient.Send(helloMessage);
```

<span data-ttu-id="e8363-209">Os aplicativos também podem usar SAS para autenticação usando uma cadeia de conexão SAS em métodos que aceitem cadeias de conexão.</span><span class="sxs-lookup"><span data-stu-id="e8363-209">Applications can also use SAS for authentication by using a SAS connection string in methods that accept connection strings.</span></span>

<span data-ttu-id="e8363-210">Observe que, para usar a autorização SAS com as retransmissões do Barramento de Serviço, você poderá utilizar as chaves SAS configuradas no namespace do Barramento de Serviço.</span><span class="sxs-lookup"><span data-stu-id="e8363-210">Note that to use SAS authorization with Service Bus relays, you can use SAS keys configured on the Service Bus namespace.</span></span> <span data-ttu-id="e8363-211">Se você criar explicitamente uma retransmissão no namespace ([NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) com uma [RelayDescription](/dotnet/api/microsoft.servicebus.messaging.relaydescription)), será possível definir as regras SAS apenas para essa retransmissão.</span><span class="sxs-lookup"><span data-stu-id="e8363-211">If you explicitly create a relay on the namespace ([NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) with a [RelayDescription](/dotnet/api/microsoft.servicebus.messaging.relaydescription)) object, you can set the SAS rules just for that relay.</span></span> <span data-ttu-id="e8363-212">Para usar a autorização SAS com assinaturas do Barramento de Serviço, você poderá usar as chaves SAS configuradas em um namespace ou em um tópico do Barramento de Serviço.</span><span class="sxs-lookup"><span data-stu-id="e8363-212">To use SAS authorization with Service Bus subscriptions, you can use SAS keys configured on a Service Bus namespace or on a topic.</span></span>

## <a name="use-the-shared-access-signature-at-http-level"></a><span data-ttu-id="e8363-213">Usar a Assinatura de Acesso Compartilhado (no nível do HTTP)</span><span class="sxs-lookup"><span data-stu-id="e8363-213">Use the Shared Access Signature (at HTTP level)</span></span>

<span data-ttu-id="e8363-214">Agora que sabe como criar Assinaturas de acesso compartilhado para qualquer entidade no Barramento de Serviço, você está pronto para executar um HTTP POST:</span><span class="sxs-lookup"><span data-stu-id="e8363-214">Now that you know how to create Shared Access Signatures for any entities in Service Bus, you are ready to perform an HTTP POST:</span></span>

```http
POST https://<yournamespace>.servicebus.windows.net/<yourentity>/messages
Content-Type: application/json
Authorization: SharedAccessSignature sr=https%3A%2F%2F<yournamespace>.servicebus.windows.net%2F<yourentity>&sig=<yoursignature from code above>&se=1438205742&skn=KeyName
ContentType: application/atom+xml;type=entry;charset=utf-8
``` 

<span data-ttu-id="e8363-215">Lembre-se de que isso funciona para tudo.</span><span class="sxs-lookup"><span data-stu-id="e8363-215">Remember, this works for everything.</span></span> <span data-ttu-id="e8363-216">Você pode criar SAS para uma fila, tópico ou assinatura.</span><span class="sxs-lookup"><span data-stu-id="e8363-216">You can create SAS for a queue, topic, or subscription.</span></span> 

<span data-ttu-id="e8363-217">Se você fornecer a um remetente ou um cliente um token SAS, eles não têm a chave diretamente e não podem reverter o hash para obtê-la.</span><span class="sxs-lookup"><span data-stu-id="e8363-217">If you give a sender or client a SAS token, they don't have the key directly, and they cannot reverse the hash to obtain it.</span></span> <span data-ttu-id="e8363-218">Dessa forma, você tem controle sobre o que eles podem acessar e por quanto tempo.</span><span class="sxs-lookup"><span data-stu-id="e8363-218">As such, you have control over what they can access, and for how long.</span></span> <span data-ttu-id="e8363-219">É importante se lembrar de que se você alterar a chave primária da política, quaisquer Assinaturas de acesso compartilhado criadas por meio dela serão invalidadas.</span><span class="sxs-lookup"><span data-stu-id="e8363-219">An important thing to remember is that if you change the primary key in the policy, any Shared Access Signatures created from it will be invalidated.</span></span>

## <a name="use-the-shared-access-signature-at-amqp-level"></a><span data-ttu-id="e8363-220">Usar a Assinatura de Acesso Compartilhado (no nível do AMQP)</span><span class="sxs-lookup"><span data-stu-id="e8363-220">Use the Shared Access Signature (at AMQP level)</span></span>

<span data-ttu-id="e8363-221">Na seção anterior, você viu como usar o token SAS com uma solicitação HTTP POST para envio dos dados ao Barramento de Serviço.</span><span class="sxs-lookup"><span data-stu-id="e8363-221">In the previous section, you saw how to use the SAS token with an HTTP POST request for sending data to the Service Bus.</span></span> <span data-ttu-id="e8363-222">Como você sabe, é possível acessar o Barramento de Serviço usando o protocolo AMQP (Advanced Message Queuing Protocol), que é o protocolo preferencial por motivos de desempenho em muitos cenários.</span><span class="sxs-lookup"><span data-stu-id="e8363-222">As you know, you can access Service Bus using the Advanced Message Queuing Protocol (AMQP) that is the preferred protocol to use for performance reasons, in many scenarios.</span></span> <span data-ttu-id="e8363-223">O uso de tokens SAS com AMQP é descrito no documento [AMQP Claim-Based Security Version 1.0](https://www.oasis-open.org/committees/download.php/50506/amqp-cbs-v1%200-wd02%202013-08-12.doc) , em estado de rascunho funcional desde 2013, mas que conta com amplo suporte do Azure no momento.</span><span class="sxs-lookup"><span data-stu-id="e8363-223">The SAS token usage with AMQP is described in the document [AMQP Claim-Based Security Version 1.0](https://www.oasis-open.org/committees/download.php/50506/amqp-cbs-v1%200-wd02%202013-08-12.doc) that is in working draft since 2013 but well-supported by Azure today.</span></span>

<span data-ttu-id="e8363-224">Antes de começar a enviar dados ao Barramento de Serviço, o editor precisa enviar o token SAS dentro de uma mensagem AMQP para um nó AMQP bem definido chamado **$cbs** (veja-o como uma fila "especial" usada pelo serviço para adquirir e validar todos os tokens SAS).</span><span class="sxs-lookup"><span data-stu-id="e8363-224">Before starting to send data to Service Bus, the publisher must send the SAS token inside an AMQP message to a well-defined AMQP node named **$cbs** (you can see it as a "special" queue used by the service to acquire and validate all the SAS tokens).</span></span> <span data-ttu-id="e8363-225">O editor deve especificar o campo **ReplyTo** dentro da mensagem AMQP; esse é o nó em que o serviço responde ao editor com o resultado da validação do token (um padrão simples de solicitação/resposta entre o editor e o serviço).</span><span class="sxs-lookup"><span data-stu-id="e8363-225">The publisher must specify the **ReplyTo** field inside the AMQP message; this is the node in which the service replies to the publisher with the result of the token validation (a simple request/reply pattern between publisher and service).</span></span> <span data-ttu-id="e8363-226">Esse nó de resposta é criado "dinamicamente", falando sobre "criação dinâmica de nó remoto", como descrito pela especificação do AMQP 1.0.</span><span class="sxs-lookup"><span data-stu-id="e8363-226">This reply node is created "on the fly," speaking about "dynamic creation of remote node" as described by the AMQP 1.0 specification.</span></span> <span data-ttu-id="e8363-227">Depois de verificar a validade do token SAS, o editor poderá começar a enviar dados ao serviço.</span><span class="sxs-lookup"><span data-stu-id="e8363-227">After checking that the SAS token is valid, the publisher can go forward and start to send data to the service.</span></span>

<span data-ttu-id="e8363-228">As etapas a seguir mostram como enviar o token SAS com o protocolo AMQP usando a biblioteca [AMQP.Net Lite](https://github.com/Azure/amqpnetlite) .</span><span class="sxs-lookup"><span data-stu-id="e8363-228">The following steps show how to send the SAS token with AMQP protocol using the [AMQP.Net Lite](https://github.com/Azure/amqpnetlite) library.</span></span> <span data-ttu-id="e8363-229">Isso será útil se você não puder usar o SDK oficial do Barramento de Serviço (por exemplo, no WinRT, no .Net Compact Framework, no .Net Micro Framework e no Mono) ao desenvolver em C\#.</span><span class="sxs-lookup"><span data-stu-id="e8363-229">This is useful if you can't use the official Service Bus SDK (for example on WinRT, .Net Compact Framework, .Net Micro Framework and Mono) developing in C\#.</span></span> <span data-ttu-id="e8363-230">Obviamente, essa biblioteca é útil para entender como funciona a segurança baseada em declarações no nível do AMQP, como você viu que funciona no nível HTTP (com uma solicitação HTTP POST e o token SAS enviados dentro do cabeçalho "Authorization").</span><span class="sxs-lookup"><span data-stu-id="e8363-230">Of course, this library is useful to help understand how claims-based security works at the AMQP level, as you saw how it works at the HTTP level (with an HTTP POST request and the SAS token sent inside the "Authorization" header).</span></span> <span data-ttu-id="e8363-231">Se não precisar desse conhecimento avançado sobre AMQP, você poderá usar o SDK oficial do Barramento de Serviço com aplicativos do .Net Framework, que farão exatamente isso para você.</span><span class="sxs-lookup"><span data-stu-id="e8363-231">If you don't need such deep knowledge about AMQP, you can use the official Service Bus SDK with .Net Framework applications, which will do it for you.</span></span>

### <a name="c35"></a><span data-ttu-id="e8363-232">C&#35;</span><span class="sxs-lookup"><span data-stu-id="e8363-232">C&#35;</span></span>

```csharp
/// <summary>
/// Send claim-based security (CBS) token
/// </summary>
/// <param name="shareAccessSignature">Shared access signature (token) to send</param>
private bool PutCbsToken(Connection connection, string sasToken)
{
    bool result = true;
    Session session = new Session(connection);

    string cbsClientAddress = "cbs-client-reply-to";
    var cbsSender = new SenderLink(session, "cbs-sender", "$cbs");
    var cbsReceiver = new ReceiverLink(session, cbsClientAddress, "$cbs");

    // construct the put-token message
    var request = new Message(sasToken);
    request.Properties = new Properties();
    request.Properties.MessageId = Guid.NewGuid().ToString();
    request.Properties.ReplyTo = cbsClientAddress;
    request.ApplicationProperties = new ApplicationProperties();
    request.ApplicationProperties["operation"] = "put-token";
    request.ApplicationProperties["type"] = "servicebus.windows.net:sastoken";
    request.ApplicationProperties["name"] = Fx.Format("amqp://{0}/{1}", sbNamespace, entity);
    cbsSender.Send(request);

    // receive the response
    var response = cbsReceiver.Receive();
    if (response == null || response.Properties == null || response.ApplicationProperties == null)
    {
        result = false;
    }
    else
    {
        int statusCode = (int)response.ApplicationProperties["status-code"];
        if (statusCode != (int)HttpStatusCode.Accepted && statusCode != (int)HttpStatusCode.OK)
        {
            result = false;
        }
    }

    // the sender/receiver may be kept open for refreshing tokens
    cbsSender.Close();
    cbsReceiver.Close();
    session.Close();

    return result;
}
```

<span data-ttu-id="e8363-233">O método `PutCbsToken()` recebe a *conexão* (instância da classe de conexão AMQP, conforme fornecida pela [biblioteca AMQP .Net Lite](https://github.com/Azure/amqpnetlite)), que representa a conexão TCP com o serviço, e o parâmetro *sasToken*, o token SAS a ser enviado.</span><span class="sxs-lookup"><span data-stu-id="e8363-233">The `PutCbsToken()` method receives the *connection* (AMQP connection class instance as provided by the [AMQP .NET Lite library](https://github.com/Azure/amqpnetlite)) that represents the TCP connection to the service and the *sasToken* parameter that is the SAS token to send.</span></span> 

> [!NOTE]
> <span data-ttu-id="e8363-234">É importante que a conexão seja criada com o **mecanismo de autenticação SASL definido como EXTERNAL** (e não o padrão PLAIN com nome de usuário e senha usados quando você não precisa enviar o token SAS).</span><span class="sxs-lookup"><span data-stu-id="e8363-234">It's important that the connection is created with **SASL authentication mechanism set to EXTERNAL** (and not the default PLAIN with username and password used when you don't need to send the SAS token).</span></span>
> 
> 

<span data-ttu-id="e8363-235">Em seguida, o editor cria dois links AMQP para enviar o token SAS e receber a resposta (resultado da validação do token) do serviço.</span><span class="sxs-lookup"><span data-stu-id="e8363-235">Next, the publisher creates two AMQP links for sending the SAS token and receiving the reply (the token validation result) from the service.</span></span>

<span data-ttu-id="e8363-236">A mensagem AMQP contém um conjunto de propriedades e mais informações do que uma mensagem simples.</span><span class="sxs-lookup"><span data-stu-id="e8363-236">The AMQP message contains a set of properties, and more information than a simple message.</span></span> <span data-ttu-id="e8363-237">O token SAS é o corpo da mensagem (usando o construtor).</span><span class="sxs-lookup"><span data-stu-id="e8363-237">The SAS token is the body of the message (using its constructor).</span></span> <span data-ttu-id="e8363-238">A propriedade **"ReplyTo"** é definida como o nome do nó para receber o resultado da validação no link receptor (você pode alterar o nome dele se quiser e ele será criado dinamicamente pelo serviço).</span><span class="sxs-lookup"><span data-stu-id="e8363-238">The **"ReplyTo"** property is set to the node name for receiving the validation result on the receiver link (you can change its name if you want, and it will be created dynamically by the service).</span></span> <span data-ttu-id="e8363-239">As três últimas propriedades application/custom são usadas pelo serviço para indicar o tipo de operação que ele deve executar.</span><span class="sxs-lookup"><span data-stu-id="e8363-239">The last three application/custom properties are used by the service to indicate what kind of operation it has to execute.</span></span> <span data-ttu-id="e8363-240">Conforme descrito pela especificação do rascunho CBS, elas devem ser o **nome da operação** ("put-token"), o **tipo de token** (nesse caso, um "servicebus.windows.net:sastoken") e o **"nome" do público-alvo** ao qual o token se aplica (toda a entidade).</span><span class="sxs-lookup"><span data-stu-id="e8363-240">As described by the CBS draft specification, they must be the **operation name** ("put-token"), the **type of token** (in this case, a "servicebus.windows.net:sastoken"), and the **"name" of the audience** to which the token applies (the entire entity).</span></span>

<span data-ttu-id="e8363-241">Depois de enviar o token SAS pelo link do remetente, o editor deverá ler a resposta no link receptor.</span><span class="sxs-lookup"><span data-stu-id="e8363-241">After sending the SAS token on the sender link, the publisher must read the reply on the receiver link.</span></span> <span data-ttu-id="e8363-242">A resposta é uma mensagem AMQP simples com uma propriedade de aplicativo chamada **"código de status"** , que pode conter os mesmos valores que um código de status HTTP.</span><span class="sxs-lookup"><span data-stu-id="e8363-242">The reply is a simple AMQP message with an application property named **"status-code"** that can contain the same values as an HTTP status code.</span></span>

## <a name="rights-required-for-service-bus-operations"></a><span data-ttu-id="e8363-243">Direitos necessários para operações do Barramento de Serviço</span><span class="sxs-lookup"><span data-stu-id="e8363-243">Rights required for Service Bus operations</span></span>

<span data-ttu-id="e8363-244">A tabela a seguir mostra os direitos de acesso necessários para diversas operações em recursos do Barramento de Serviço.</span><span class="sxs-lookup"><span data-stu-id="e8363-244">The following table shows the access rights required for various operations on Service Bus resources.</span></span>

| <span data-ttu-id="e8363-245">Operação</span><span class="sxs-lookup"><span data-stu-id="e8363-245">Operation</span></span> | <span data-ttu-id="e8363-246">Declaração Obrigatória</span><span class="sxs-lookup"><span data-stu-id="e8363-246">Claim Required</span></span> | <span data-ttu-id="e8363-247">Escopo da Declaração</span><span class="sxs-lookup"><span data-stu-id="e8363-247">Claim Scope</span></span> |
| --- | --- | --- |
| <span data-ttu-id="e8363-248">**Namespace**</span><span class="sxs-lookup"><span data-stu-id="e8363-248">**Namespace**</span></span> | | |
| <span data-ttu-id="e8363-249">Configurar regra de autorização em um namespace</span><span class="sxs-lookup"><span data-stu-id="e8363-249">Configure authorization rule on a namespace</span></span> |<span data-ttu-id="e8363-250">Gerenciar</span><span class="sxs-lookup"><span data-stu-id="e8363-250">Manage</span></span> |<span data-ttu-id="e8363-251">Qualquer endereço de namespace</span><span class="sxs-lookup"><span data-stu-id="e8363-251">Any namespace address</span></span> |
| <span data-ttu-id="e8363-252">**Registro do Serviço**</span><span class="sxs-lookup"><span data-stu-id="e8363-252">**Service Registry**</span></span> | | |
| <span data-ttu-id="e8363-253">Enumerar Políticas de Privacidade</span><span class="sxs-lookup"><span data-stu-id="e8363-253">Enumerate Private Policies</span></span> |<span data-ttu-id="e8363-254">Gerenciar</span><span class="sxs-lookup"><span data-stu-id="e8363-254">Manage</span></span> |<span data-ttu-id="e8363-255">Qualquer endereço de namespace</span><span class="sxs-lookup"><span data-stu-id="e8363-255">Any namespace address</span></span> |
| <span data-ttu-id="e8363-256">Iniciar a escuta em um namespace</span><span class="sxs-lookup"><span data-stu-id="e8363-256">Begin listening on a namespace</span></span> |<span data-ttu-id="e8363-257">Escutar</span><span class="sxs-lookup"><span data-stu-id="e8363-257">Listen</span></span> |<span data-ttu-id="e8363-258">Qualquer endereço de namespace</span><span class="sxs-lookup"><span data-stu-id="e8363-258">Any namespace address</span></span> |
| <span data-ttu-id="e8363-259">Enviar mensagens a um ouvinte em um namespace</span><span class="sxs-lookup"><span data-stu-id="e8363-259">Send messages to a listener at a namespace</span></span> |<span data-ttu-id="e8363-260">Enviar</span><span class="sxs-lookup"><span data-stu-id="e8363-260">Send</span></span> |<span data-ttu-id="e8363-261">Qualquer endereço de namespace</span><span class="sxs-lookup"><span data-stu-id="e8363-261">Any namespace address</span></span> |
| <span data-ttu-id="e8363-262">**Fila**</span><span class="sxs-lookup"><span data-stu-id="e8363-262">**Queue**</span></span> | | |
| <span data-ttu-id="e8363-263">Criar uma fila</span><span class="sxs-lookup"><span data-stu-id="e8363-263">Create a queue</span></span> |<span data-ttu-id="e8363-264">Gerenciar</span><span class="sxs-lookup"><span data-stu-id="e8363-264">Manage</span></span> |<span data-ttu-id="e8363-265">Qualquer endereço de namespace</span><span class="sxs-lookup"><span data-stu-id="e8363-265">Any namespace address</span></span> |
| <span data-ttu-id="e8363-266">Excluir uma fila</span><span class="sxs-lookup"><span data-stu-id="e8363-266">Delete a queue</span></span> |<span data-ttu-id="e8363-267">Gerenciar</span><span class="sxs-lookup"><span data-stu-id="e8363-267">Manage</span></span> |<span data-ttu-id="e8363-268">Qualquer endereço de fila válido</span><span class="sxs-lookup"><span data-stu-id="e8363-268">Any valid queue address</span></span> |
| <span data-ttu-id="e8363-269">Enumerar filas</span><span class="sxs-lookup"><span data-stu-id="e8363-269">Enumerate queues</span></span> |<span data-ttu-id="e8363-270">Gerenciar</span><span class="sxs-lookup"><span data-stu-id="e8363-270">Manage</span></span> |<span data-ttu-id="e8363-271">/$Resources/Queues</span><span class="sxs-lookup"><span data-stu-id="e8363-271">/$Resources/Queues</span></span> |
| <span data-ttu-id="e8363-272">Obter a descrição da fila</span><span class="sxs-lookup"><span data-stu-id="e8363-272">Get the queue description</span></span> |<span data-ttu-id="e8363-273">Gerenciar</span><span class="sxs-lookup"><span data-stu-id="e8363-273">Manage</span></span> |<span data-ttu-id="e8363-274">Qualquer endereço de fila válido</span><span class="sxs-lookup"><span data-stu-id="e8363-274">Any valid queue address</span></span> |
| <span data-ttu-id="e8363-275">Configurar regra de autorização para uma fila</span><span class="sxs-lookup"><span data-stu-id="e8363-275">Configure authorization rule for a queue</span></span> |<span data-ttu-id="e8363-276">Gerenciar</span><span class="sxs-lookup"><span data-stu-id="e8363-276">Manage</span></span> |<span data-ttu-id="e8363-277">Qualquer endereço de fila válido</span><span class="sxs-lookup"><span data-stu-id="e8363-277">Any valid queue address</span></span> |
| <span data-ttu-id="e8363-278">Enviar para a fila</span><span class="sxs-lookup"><span data-stu-id="e8363-278">Send into to the queue</span></span> |<span data-ttu-id="e8363-279">Enviar</span><span class="sxs-lookup"><span data-stu-id="e8363-279">Send</span></span> |<span data-ttu-id="e8363-280">Qualquer endereço de fila válido</span><span class="sxs-lookup"><span data-stu-id="e8363-280">Any valid queue address</span></span> |
| <span data-ttu-id="e8363-281">Receber mensagens de uma fila</span><span class="sxs-lookup"><span data-stu-id="e8363-281">Receive messages from a queue</span></span> |<span data-ttu-id="e8363-282">Escutar</span><span class="sxs-lookup"><span data-stu-id="e8363-282">Listen</span></span> |<span data-ttu-id="e8363-283">Qualquer endereço de fila válido</span><span class="sxs-lookup"><span data-stu-id="e8363-283">Any valid queue address</span></span> |
| <span data-ttu-id="e8363-284">Abandonar ou concluir as mensagens após o recebimento da mensagem em modo de bloqueio de pico</span><span class="sxs-lookup"><span data-stu-id="e8363-284">Abandon or complete messages after receiving the message in peek-lock mode</span></span> |<span data-ttu-id="e8363-285">Escutar</span><span class="sxs-lookup"><span data-stu-id="e8363-285">Listen</span></span> |<span data-ttu-id="e8363-286">Qualquer endereço de fila válido</span><span class="sxs-lookup"><span data-stu-id="e8363-286">Any valid queue address</span></span> |
| <span data-ttu-id="e8363-287">Adiar uma mensagem para recuperação posterior</span><span class="sxs-lookup"><span data-stu-id="e8363-287">Defer a message for later retrieval</span></span> |<span data-ttu-id="e8363-288">Escutar</span><span class="sxs-lookup"><span data-stu-id="e8363-288">Listen</span></span> |<span data-ttu-id="e8363-289">Qualquer endereço de fila válido</span><span class="sxs-lookup"><span data-stu-id="e8363-289">Any valid queue address</span></span> |
| <span data-ttu-id="e8363-290">Colocar uma mensagem nas mensagens mortas</span><span class="sxs-lookup"><span data-stu-id="e8363-290">Deadletter a message</span></span> |<span data-ttu-id="e8363-291">Escutar</span><span class="sxs-lookup"><span data-stu-id="e8363-291">Listen</span></span> |<span data-ttu-id="e8363-292">Qualquer endereço de fila válido</span><span class="sxs-lookup"><span data-stu-id="e8363-292">Any valid queue address</span></span> |
| <span data-ttu-id="e8363-293">Obter o estado associado a uma sessão de fila de mensagens</span><span class="sxs-lookup"><span data-stu-id="e8363-293">Get the state associated with a message queue session</span></span> |<span data-ttu-id="e8363-294">Escutar</span><span class="sxs-lookup"><span data-stu-id="e8363-294">Listen</span></span> |<span data-ttu-id="e8363-295">Qualquer endereço de fila válido</span><span class="sxs-lookup"><span data-stu-id="e8363-295">Any valid queue address</span></span> |
| <span data-ttu-id="e8363-296">Definir o estado associado a uma sessão de fila de mensagens</span><span class="sxs-lookup"><span data-stu-id="e8363-296">Set the state associated with a message queue session</span></span> |<span data-ttu-id="e8363-297">Escutar</span><span class="sxs-lookup"><span data-stu-id="e8363-297">Listen</span></span> |<span data-ttu-id="e8363-298">Qualquer endereço de fila válido</span><span class="sxs-lookup"><span data-stu-id="e8363-298">Any valid queue address</span></span> |
| <span data-ttu-id="e8363-299">**Tópico**</span><span class="sxs-lookup"><span data-stu-id="e8363-299">**Topic**</span></span> | | |
| <span data-ttu-id="e8363-300">Criar um tópico</span><span class="sxs-lookup"><span data-stu-id="e8363-300">Create a topic</span></span> |<span data-ttu-id="e8363-301">Gerenciar</span><span class="sxs-lookup"><span data-stu-id="e8363-301">Manage</span></span> |<span data-ttu-id="e8363-302">Qualquer endereço de namespace</span><span class="sxs-lookup"><span data-stu-id="e8363-302">Any namespace address</span></span> |
| <span data-ttu-id="e8363-303">Excluir um tópico</span><span class="sxs-lookup"><span data-stu-id="e8363-303">Delete a topic</span></span> |<span data-ttu-id="e8363-304">Gerenciar</span><span class="sxs-lookup"><span data-stu-id="e8363-304">Manage</span></span> |<span data-ttu-id="e8363-305">Qualquer endereço de tópico válido</span><span class="sxs-lookup"><span data-stu-id="e8363-305">Any valid topic address</span></span> |
| <span data-ttu-id="e8363-306">Enumerar tópicos</span><span class="sxs-lookup"><span data-stu-id="e8363-306">Enumerate topics</span></span> |<span data-ttu-id="e8363-307">Gerenciar</span><span class="sxs-lookup"><span data-stu-id="e8363-307">Manage</span></span> |<span data-ttu-id="e8363-308">/$Resources/Topics</span><span class="sxs-lookup"><span data-stu-id="e8363-308">/$Resources/Topics</span></span> |
| <span data-ttu-id="e8363-309">Obter a descrição do tópico</span><span class="sxs-lookup"><span data-stu-id="e8363-309">Get the topic description</span></span> |<span data-ttu-id="e8363-310">Gerenciar</span><span class="sxs-lookup"><span data-stu-id="e8363-310">Manage</span></span> |<span data-ttu-id="e8363-311">Qualquer endereço de tópico válido</span><span class="sxs-lookup"><span data-stu-id="e8363-311">Any valid topic address</span></span> |
| <span data-ttu-id="e8363-312">Configurar regra de autorização para um tópico</span><span class="sxs-lookup"><span data-stu-id="e8363-312">Configure authorization rule for a topic</span></span> |<span data-ttu-id="e8363-313">Gerenciar</span><span class="sxs-lookup"><span data-stu-id="e8363-313">Manage</span></span> |<span data-ttu-id="e8363-314">Qualquer endereço de tópico válido</span><span class="sxs-lookup"><span data-stu-id="e8363-314">Any valid topic address</span></span> |
| <span data-ttu-id="e8363-315">Enviar ao tópico</span><span class="sxs-lookup"><span data-stu-id="e8363-315">Send to the topic</span></span> |<span data-ttu-id="e8363-316">Enviar</span><span class="sxs-lookup"><span data-stu-id="e8363-316">Send</span></span> |<span data-ttu-id="e8363-317">Qualquer endereço de tópico válido</span><span class="sxs-lookup"><span data-stu-id="e8363-317">Any valid topic address</span></span> |
| <span data-ttu-id="e8363-318">**Assinatura**</span><span class="sxs-lookup"><span data-stu-id="e8363-318">**Subscription**</span></span> | | |
| <span data-ttu-id="e8363-319">Criar uma assinatura</span><span class="sxs-lookup"><span data-stu-id="e8363-319">Create a subscription</span></span> |<span data-ttu-id="e8363-320">Gerenciar</span><span class="sxs-lookup"><span data-stu-id="e8363-320">Manage</span></span> |<span data-ttu-id="e8363-321">Qualquer endereço de namespace</span><span class="sxs-lookup"><span data-stu-id="e8363-321">Any namespace address</span></span> |
| <span data-ttu-id="e8363-322">Excluir assinatura</span><span class="sxs-lookup"><span data-stu-id="e8363-322">Delete subscription</span></span> |<span data-ttu-id="e8363-323">Gerenciar</span><span class="sxs-lookup"><span data-stu-id="e8363-323">Manage</span></span> |<span data-ttu-id="e8363-324">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="e8363-324">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="e8363-325">Enumerar assinaturas</span><span class="sxs-lookup"><span data-stu-id="e8363-325">Enumerate subscriptions</span></span> |<span data-ttu-id="e8363-326">Gerenciar</span><span class="sxs-lookup"><span data-stu-id="e8363-326">Manage</span></span> |<span data-ttu-id="e8363-327">../myTopic/Subscriptions</span><span class="sxs-lookup"><span data-stu-id="e8363-327">../myTopic/Subscriptions</span></span> |
| <span data-ttu-id="e8363-328">Obter descrição da assinatura</span><span class="sxs-lookup"><span data-stu-id="e8363-328">Get subscription description</span></span> |<span data-ttu-id="e8363-329">Gerenciar</span><span class="sxs-lookup"><span data-stu-id="e8363-329">Manage</span></span> |<span data-ttu-id="e8363-330">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="e8363-330">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="e8363-331">Abandonar ou concluir as mensagens após o recebimento da mensagem em modo de bloqueio de pico</span><span class="sxs-lookup"><span data-stu-id="e8363-331">Abandon or complete messages after receiving the message in peek-lock mode</span></span> |<span data-ttu-id="e8363-332">Escutar</span><span class="sxs-lookup"><span data-stu-id="e8363-332">Listen</span></span> |<span data-ttu-id="e8363-333">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="e8363-333">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="e8363-334">Adiar uma mensagem para recuperação posterior</span><span class="sxs-lookup"><span data-stu-id="e8363-334">Defer a message for later retrieval</span></span> |<span data-ttu-id="e8363-335">Escutar</span><span class="sxs-lookup"><span data-stu-id="e8363-335">Listen</span></span> |<span data-ttu-id="e8363-336">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="e8363-336">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="e8363-337">Colocar uma mensagem nas mensagens mortas</span><span class="sxs-lookup"><span data-stu-id="e8363-337">Deadletter a message</span></span> |<span data-ttu-id="e8363-338">Escutar</span><span class="sxs-lookup"><span data-stu-id="e8363-338">Listen</span></span> |<span data-ttu-id="e8363-339">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="e8363-339">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="e8363-340">Obter o estado associado a uma sessão de tópico</span><span class="sxs-lookup"><span data-stu-id="e8363-340">Get the state associated with a topic session</span></span> |<span data-ttu-id="e8363-341">Escutar</span><span class="sxs-lookup"><span data-stu-id="e8363-341">Listen</span></span> |<span data-ttu-id="e8363-342">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="e8363-342">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="e8363-343">Definir o estado associado a uma sessão de tópico</span><span class="sxs-lookup"><span data-stu-id="e8363-343">Set the state associated with a topic session</span></span> |<span data-ttu-id="e8363-344">Escutar</span><span class="sxs-lookup"><span data-stu-id="e8363-344">Listen</span></span> |<span data-ttu-id="e8363-345">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="e8363-345">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="e8363-346">**Regras**</span><span class="sxs-lookup"><span data-stu-id="e8363-346">**Rules**</span></span> | | |
| <span data-ttu-id="e8363-347">Criar uma regra</span><span class="sxs-lookup"><span data-stu-id="e8363-347">Create a rule</span></span> |<span data-ttu-id="e8363-348">Gerenciar</span><span class="sxs-lookup"><span data-stu-id="e8363-348">Manage</span></span> |<span data-ttu-id="e8363-349">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="e8363-349">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="e8363-350">Excluir uma regra</span><span class="sxs-lookup"><span data-stu-id="e8363-350">Delete a rule</span></span> |<span data-ttu-id="e8363-351">Gerenciar</span><span class="sxs-lookup"><span data-stu-id="e8363-351">Manage</span></span> |<span data-ttu-id="e8363-352">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="e8363-352">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="e8363-353">Enumerar regras</span><span class="sxs-lookup"><span data-stu-id="e8363-353">Enumerate rules</span></span> |<span data-ttu-id="e8363-354">Gerenciar ou Escutar</span><span class="sxs-lookup"><span data-stu-id="e8363-354">Manage or Listen</span></span> |<span data-ttu-id="e8363-355">../myTopic/Subscriptions/mySubscription/Rules</span><span class="sxs-lookup"><span data-stu-id="e8363-355">../myTopic/Subscriptions/mySubscription/Rules</span></span> 

## <a name="next-steps"></a><span data-ttu-id="e8363-356">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="e8363-356">Next steps</span></span>

<span data-ttu-id="e8363-357">Para saber mais sobre as mensagens do Barramento de Serviço, confira os tópicos a seguir.</span><span class="sxs-lookup"><span data-stu-id="e8363-357">To learn more about Service Bus messaging, see the following topics.</span></span>

* [<span data-ttu-id="e8363-358">Conceitos fundamentais do barramento de serviço</span><span class="sxs-lookup"><span data-stu-id="e8363-358">Service Bus fundamentals</span></span>](service-bus-fundamentals-hybrid-solutions.md)
* [<span data-ttu-id="e8363-359">Filas, tópicos e assinaturas do Barramento de Serviço</span><span class="sxs-lookup"><span data-stu-id="e8363-359">Service Bus queues, topics, and subscriptions</span></span>](service-bus-queues-topics-subscriptions.md)
* [<span data-ttu-id="e8363-360">Como usar filas do Barramento de Serviço</span><span class="sxs-lookup"><span data-stu-id="e8363-360">How to use Service Bus queues</span></span>](service-bus-dotnet-get-started-with-queues.md)
* [<span data-ttu-id="e8363-361">Como usar tópicos e assinaturas do Barramento de Serviço</span><span class="sxs-lookup"><span data-stu-id="e8363-361">How to use Service Bus topics and subscriptions</span></span>](service-bus-dotnet-how-to-use-topics-subscriptions.md)

[Azure portal]: https://portal.azure.com