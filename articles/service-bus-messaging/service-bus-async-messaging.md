---
title: "aaaService do barramento do sistema de mensagens assíncronas | Microsoft Docs"
description: "Descrição da mensagem assíncrona do Barramento de Serviço do Azure."
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: f1435549-e1f2-40cb-a280-64ea07b39fc7
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 04/19/2017
ms.author: sethm
ms.openlocfilehash: 5ab6ddf052155a9dd975b413cfaf393119c1999d
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="asynchronous-messaging-patterns-and-high-availability"></a><span data-ttu-id="39910-103">Padrões de mensagens assíncronas e alta disponibilidade</span><span class="sxs-lookup"><span data-stu-id="39910-103">Asynchronous messaging patterns and high availability</span></span>

<span data-ttu-id="39910-104">O serviço de mensagens assíncrono pode ser implementado de diversas maneiras diferentes.</span><span class="sxs-lookup"><span data-stu-id="39910-104">Asynchronous messaging can be implemented in a variety of different ways.</span></span> <span data-ttu-id="39910-105">Com filas, tópicos e assinaturas, o Barramento de Serviço do Azure dá suporte ao assincronismo por meio de um mecanismo de encaminhamento e repositório.</span><span class="sxs-lookup"><span data-stu-id="39910-105">With queues, topics, and subscriptions, Azure Service Bus supports asynchronism via a store and forward mechanism.</span></span> <span data-ttu-id="39910-106">Em operação (síncrona) normal, enviar mensagens tooqueues e tópicos e receber mensagens de filas e assinaturas.</span><span class="sxs-lookup"><span data-stu-id="39910-106">In normal (synchronous) operation, you send messages tooqueues and topics, and receive messages from queues and subscriptions.</span></span> <span data-ttu-id="39910-107">Os aplicativos escritos por você dependem de essas entidades estarem sempre disponíveis.</span><span class="sxs-lookup"><span data-stu-id="39910-107">Applications you write depend on these entities always being available.</span></span> <span data-ttu-id="39910-108">Quando alterado de integridade de entidade Olá, devido tooa várias circunstâncias, é necessário um tooprovide de maneira uma entidade de reduzir a capacidade que pode satisfazer a maioria das necessidades.</span><span class="sxs-lookup"><span data-stu-id="39910-108">When hello entity health changes, due tooa variety of circumstances, you need a way tooprovide a reduced capability entity that can satisfy most needs.</span></span>

<span data-ttu-id="39910-109">Aplicativos geralmente usam tooenable mensagens padrões assíncronas vários cenários de comunicação.</span><span class="sxs-lookup"><span data-stu-id="39910-109">Applications typically use asynchronous messaging patterns tooenable a number of communication scenarios.</span></span> <span data-ttu-id="39910-110">Você pode criar aplicativos no qual os clientes podem enviar mensagens tooservices, mesmo quando o serviço Olá não está em execução.</span><span class="sxs-lookup"><span data-stu-id="39910-110">You can build applications in which clients can send messages tooservices, even when hello service is not running.</span></span> <span data-ttu-id="39910-111">Para aplicativos que apresentam picos de comunicações, uma fila pode ajudar Olá nível de carga, fornecendo uma comunicação de toobuffer local.</span><span class="sxs-lookup"><span data-stu-id="39910-111">For applications that experience bursts of communications, a queue can help level hello load by providing a place toobuffer communications.</span></span> <span data-ttu-id="39910-112">Por fim, você pode obter uma carga simple, porém efetiva mensagens de toodistribute balanceador em vários computadores.</span><span class="sxs-lookup"><span data-stu-id="39910-112">Finally, you can get a simple but effective load balancer toodistribute messages across multiple machines.</span></span>

<span data-ttu-id="39910-113">Disponibilidade de toomaintain de ordem de qualquer uma dessas entidades, considere um número de diferentes maneiras em que essas entidades podem aparecer indisponíveis para um sistema de mensagens durável.</span><span class="sxs-lookup"><span data-stu-id="39910-113">In order toomaintain availability of any of these entities, consider a number of different ways in which these entities can appear unavailable for a durable messaging system.</span></span> <span data-ttu-id="39910-114">Em geral, podemos ver entidade Olá se tornar indisponível tooapplications que gravamos Olá diferentes maneiras a seguir:</span><span class="sxs-lookup"><span data-stu-id="39910-114">Generally speaking, we see hello entity become unavailable tooapplications we write in hello following different ways:</span></span>

* <span data-ttu-id="39910-115">Não é possível toosend mensagens.</span><span class="sxs-lookup"><span data-stu-id="39910-115">Unable toosend messages.</span></span>
* <span data-ttu-id="39910-116">Não é possível tooreceive mensagens.</span><span class="sxs-lookup"><span data-stu-id="39910-116">Unable tooreceive messages.</span></span>
* <span data-ttu-id="39910-117">Não é possível toomanage entidades (criar, recuperar, atualizar ou excluir entidades).</span><span class="sxs-lookup"><span data-stu-id="39910-117">Unable toomanage entities (create, retrieve, update, or delete entities).</span></span>
* <span data-ttu-id="39910-118">Serviço de saudação toocontact não é possível.</span><span class="sxs-lookup"><span data-stu-id="39910-118">Unable toocontact hello service.</span></span>

<span data-ttu-id="39910-119">Para cada uma dessas falhas, existe modos de falhas diferentes que permitem que um trabalho do aplicativo toocontinue tooperform em algum nível de capacidade reduzida.</span><span class="sxs-lookup"><span data-stu-id="39910-119">For each of these failures, different failure modes exist that enable an application toocontinue tooperform work at some level of reduced capability.</span></span> <span data-ttu-id="39910-120">Por exemplo, um sistema que pode enviar mensagens, mas não recebê-las, ainda pode receber pedidos de clientes, mas não pode processar esses pedidos.</span><span class="sxs-lookup"><span data-stu-id="39910-120">For example, a system that can send messages but not receive them can still receive orders from customers but cannot process those orders.</span></span> <span data-ttu-id="39910-121">Este tópico aborda problemas potenciais que podem ocorrer e como eles são atenuados.</span><span class="sxs-lookup"><span data-stu-id="39910-121">This topic discusses potential issues that can occur, and how those issues are mitigated.</span></span> <span data-ttu-id="39910-122">Barramento de serviço introduziu um número de mitigações que você deve aceitar e este tópico também discute Olá regras que administram Olá usam essas opções de atenuantes.</span><span class="sxs-lookup"><span data-stu-id="39910-122">Service Bus has introduced a number of mitigations which you must opt into, and this topic also discusses hello rules governing hello use of those opt-in mitigations.</span></span>

## <a name="reliability-in-service-bus"></a><span data-ttu-id="39910-123">Confiabilidade no Barramento de Serviço</span><span class="sxs-lookup"><span data-stu-id="39910-123">Reliability in Service Bus</span></span>
<span data-ttu-id="39910-124">Há várias maneiras de problemas de mensagem e entidade toohandle e há diretrizes que regem o uso de saudação apropriado dessas atenuantes.</span><span class="sxs-lookup"><span data-stu-id="39910-124">There are several ways toohandle message and entity issues, and there are guidelines governing hello appropriate use of those mitigations.</span></span> <span data-ttu-id="39910-125">diretrizes de saudação toounderstand, você deve compreender o que pode falhar no barramento de serviço.</span><span class="sxs-lookup"><span data-stu-id="39910-125">toounderstand hello guidelines, you must first understand what can fail in Service Bus.</span></span> <span data-ttu-id="39910-126">Devido a toohello design dos sistemas do Azure, todos esses problemas tendem toobe curta duração.</span><span class="sxs-lookup"><span data-stu-id="39910-126">Due toohello design of Azure systems, all of these issues tend toobe short-lived.</span></span> <span data-ttu-id="39910-127">Em um nível alto, diferentes causas Olá de indisponibilidade aparecem da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="39910-127">At a high level, hello different causes of unavailability appear as follows:</span></span>

* <span data-ttu-id="39910-128">A limitação de um sistema externo do qual o Barramento de Serviço depende.</span><span class="sxs-lookup"><span data-stu-id="39910-128">Throttling from an external system on which Service Bus depends.</span></span> <span data-ttu-id="39910-129">A limitação ocorre devido a interações com os recursos de computação e armazenamento.</span><span class="sxs-lookup"><span data-stu-id="39910-129">Throttling occurs from interactions with storage and compute resources.</span></span>
* <span data-ttu-id="39910-130">Problema para um sistema do qual o Barramento de Serviço depende.</span><span class="sxs-lookup"><span data-stu-id="39910-130">Issue for a system on which Service Bus depends.</span></span> <span data-ttu-id="39910-131">Por exemplo, determinado armazenamento pode encontrar problemas.</span><span class="sxs-lookup"><span data-stu-id="39910-131">For example, a given part of storage can encounter issues.</span></span>
* <span data-ttu-id="39910-132">Falha do Barramento de Serviço em um único subsistema.</span><span class="sxs-lookup"><span data-stu-id="39910-132">Failure of Service Bus on single subsystem.</span></span> <span data-ttu-id="39910-133">Nessa situação, um nó de computação pode entrar em um estado inconsistente e deve reiniciar sozinho, fazendo com que todas as entidades serve saldo tooload tooother nós.</span><span class="sxs-lookup"><span data-stu-id="39910-133">In this situation, a compute node can get into an inconsistent state and must restart itself, causing all entities it serves tooload balance tooother nodes.</span></span> <span data-ttu-id="39910-134">Por sua vez, isso pode causar um curto período de processamento de mensagens lento.</span><span class="sxs-lookup"><span data-stu-id="39910-134">This in turn can cause a short period of slow message processing.</span></span>
* <span data-ttu-id="39910-135">Falha do Barramento de Serviço em um datacenter do Azure.</span><span class="sxs-lookup"><span data-stu-id="39910-135">Failure of Service Bus within an Azure datacenter.</span></span> <span data-ttu-id="39910-136">Este é uma "Falha catastrófica" durante o qual o sistema hello está inacessível por vários minutos ou algumas horas.</span><span class="sxs-lookup"><span data-stu-id="39910-136">This is a "catastrophic failure" during which hello system is unreachable for many minutes or a few hours.</span></span>

> [!NOTE]
> <span data-ttu-id="39910-137">termo Olá **armazenamento** pode significar o armazenamento do Azure e SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="39910-137">hello term **storage** can mean both Azure Storage and SQL Azure.</span></span>
> 
> 

<span data-ttu-id="39910-138">O Barramento de Serviço contém várias mitigações para esses problemas.</span><span class="sxs-lookup"><span data-stu-id="39910-138">Service Bus contains a number of mitigations for these issues.</span></span> <span data-ttu-id="39910-139">Olá seções a seguir discutem cada problema e as respectivas atenuantes.</span><span class="sxs-lookup"><span data-stu-id="39910-139">hello following sections discuss each issue and their respective mitigations.</span></span>

### <a name="throttling"></a><span data-ttu-id="39910-140">Limitação</span><span class="sxs-lookup"><span data-stu-id="39910-140">Throttling</span></span>
<span data-ttu-id="39910-141">Com o Barramento de Serviço, a limitação possibilita o gerenciamento cooperativo de taxa de mensagens.</span><span class="sxs-lookup"><span data-stu-id="39910-141">With Service Bus, throttling enables cooperative message rate management.</span></span> <span data-ttu-id="39910-142">Cada nó individual do Barramento de Serviço hospeda várias entidades.</span><span class="sxs-lookup"><span data-stu-id="39910-142">Each individual Service Bus node houses many entities.</span></span> <span data-ttu-id="39910-143">Cada uma dessas entidades exige Olá sistema em termos de CPU, memória, armazenamento e outras facetas.</span><span class="sxs-lookup"><span data-stu-id="39910-143">Each of those entities makes demands on hello system in terms of CPU, memory, storage, and other facets.</span></span> <span data-ttu-id="39910-144">Quando qualquer um desses aspectos detecta uso que excede os limites definidos, o Barramento de Serviço pode negar determinada solicitação.</span><span class="sxs-lookup"><span data-stu-id="39910-144">When any of these facets detects usage that exceeds defined thresholds, Service Bus can deny a given request.</span></span> <span data-ttu-id="39910-145">Olá chamador recebe um [ServerBusyException] [ ServerBusyException] e recupera após 10 segundos.</span><span class="sxs-lookup"><span data-stu-id="39910-145">hello caller receives a [ServerBusyException][ServerBusyException] and retries after 10 seconds.</span></span>

<span data-ttu-id="39910-146">Como uma mitigação código Olá deve Olá erro de leitura e parar qualquer recuperação da mensagem de saudação pelo menos 10 segundos.</span><span class="sxs-lookup"><span data-stu-id="39910-146">As a mitigation, hello code must read hello error and halt any retries of hello message for at least 10 seconds.</span></span> <span data-ttu-id="39910-147">Como Olá erro pode ocorrer em pedaços do aplicativo de cliente hello, espera-se que cada pedaço execute independentemente uma lógica de repetição de saudação.</span><span class="sxs-lookup"><span data-stu-id="39910-147">Since hello error can happen across pieces of hello customer application, it is expected that each piece independently executes hello retry logic.</span></span> <span data-ttu-id="39910-148">código de saudação pode reduzir a probabilidade de saudação do que está sendo limitado ao ativar particionamento em uma fila ou tópico.</span><span class="sxs-lookup"><span data-stu-id="39910-148">hello code can reduce hello probability of being throttled by enabling partitioning on a queue or topic.</span></span>

### <a name="issue-for-an-azure-dependency"></a><span data-ttu-id="39910-149">Problema para uma dependência do Azure</span><span class="sxs-lookup"><span data-stu-id="39910-149">Issue for an Azure dependency</span></span>
<span data-ttu-id="39910-150">Ocasionalmente, outros componentes do Azure podem ter problemas de serviço.</span><span class="sxs-lookup"><span data-stu-id="39910-150">Other components within Azure can occasionally have service issues.</span></span> <span data-ttu-id="39910-151">Por exemplo, quando um sistema que usa o Barramento de Serviço está sendo atualizado, esse sistema pode ter os recursos reduzidos temporariamente.</span><span class="sxs-lookup"><span data-stu-id="39910-151">For example, when a system that Service Bus uses is being upgraded, that system can temporarily experience reduced capabilities.</span></span> <span data-ttu-id="39910-152">toowork com esses tipos de problemas, Service Bus regularmente investiga e implementa atenuantes.</span><span class="sxs-lookup"><span data-stu-id="39910-152">toowork around these types of issues, Service Bus regularly investigates and implements mitigations.</span></span> <span data-ttu-id="39910-153">Ocorrem efeitos colaterais dessas mitigações.</span><span class="sxs-lookup"><span data-stu-id="39910-153">Side effects of these mitigations do appear.</span></span> <span data-ttu-id="39910-154">Por exemplo, toohandle transitório problemas com armazenamento, barramento de serviço implementa um sistema que permite toowork de operações de envio de mensagem de forma consistente.</span><span class="sxs-lookup"><span data-stu-id="39910-154">For example, toohandle transient issues with storage, Service Bus implements a system that allows message send operations toowork consistently.</span></span> <span data-ttu-id="39910-155">Devido a natureza toohello mitigação Olá, uma mensagem enviada pode levar até too15 minutos tooappear na fila de saudação afetada ou assinatura e esteja pronto para uma operação de recebimento.</span><span class="sxs-lookup"><span data-stu-id="39910-155">Due toohello nature of hello mitigation, a sent message can take up too15 minutes tooappear in hello affected queue or subscription and be ready for a receive operation.</span></span> <span data-ttu-id="39910-156">Em termos gerais, a maioria das entidades não enfrentará esse problema.</span><span class="sxs-lookup"><span data-stu-id="39910-156">Generally speaking, most entities will not experience this issue.</span></span> <span data-ttu-id="39910-157">No entanto, dado o número de saudação de entidades no barramento de serviço no Azure, essa atenuação às vezes é necessária para um pequeno subconjunto de clientes do barramento de serviço.</span><span class="sxs-lookup"><span data-stu-id="39910-157">However, given hello number of entities in Service Bus within Azure, this mitigation is sometimes needed for a small subset of Service Bus customers.</span></span>

### <a name="service-bus-failure-on-a-single-subsystem"></a><span data-ttu-id="39910-158">Falha do Barramento de Serviço em um único subsistema</span><span class="sxs-lookup"><span data-stu-id="39910-158">Service Bus failure on a single subsystem</span></span>
<span data-ttu-id="39910-159">Com qualquer aplicativo, circunstâncias podem fazer um componente interno do barramento de serviço toobecome inconsistente.</span><span class="sxs-lookup"><span data-stu-id="39910-159">With any application, circumstances can cause an internal component of Service Bus toobecome inconsistent.</span></span> <span data-ttu-id="39910-160">Quando o barramento de serviço detecta isso, ele coleta dados de saudação aplicativo tooaid diagnosticar o que aconteceu.</span><span class="sxs-lookup"><span data-stu-id="39910-160">When Service Bus detects this, it collects data from hello application tooaid in diagnosing what happened.</span></span> <span data-ttu-id="39910-161">Depois de saudação os dados são coletados, o aplicativo hello é reiniciado em uma tentativa de tooreturn-estado consistente de tooa.</span><span class="sxs-lookup"><span data-stu-id="39910-161">Once hello data is collected, hello application is restarted in an attempt tooreturn it tooa consistent state.</span></span> <span data-ttu-id="39910-162">Esse processo acontece muito rapidamente e resulta em uma entidade aparecendo toobe não está disponível para backup tooa alguns minutos, embora típico para baixo vezes é mais curtos.</span><span class="sxs-lookup"><span data-stu-id="39910-162">This process happens fairly quickly, and results in an entity appearing toobe unavailable for up tooa few minutes, though typical down times are much shorter.</span></span>

<span data-ttu-id="39910-163">Nesses casos, o aplicativo de cliente hello gera um [System. TimeoutException] [ System.TimeoutException] ou [MessagingException] [ MessagingException] exceção.</span><span class="sxs-lookup"><span data-stu-id="39910-163">In these cases, hello client application generates a [System.TimeoutException][System.TimeoutException] or [MessagingException][MessagingException] exception.</span></span> <span data-ttu-id="39910-164">Barramento de serviço contém uma atenuante para esse problema na forma de saudação de lógica de repetição automatizada de cliente.</span><span class="sxs-lookup"><span data-stu-id="39910-164">Service Bus contains a mitigation for this issue in hello form of automated client retry logic.</span></span> <span data-ttu-id="39910-165">Depois de saudação período esgota e mensagem de saudação não for entregue, você pode explorar usando outros recursos, como [emparelhado namespaces][paired namespaces].</span><span class="sxs-lookup"><span data-stu-id="39910-165">Once hello retry period is exhausted and hello message is not delivered, you can explore using other features such as [paired namespaces][paired namespaces].</span></span> <span data-ttu-id="39910-166">Namespaces emparelhados têm outras restrições que são abordadas neste artigo.</span><span class="sxs-lookup"><span data-stu-id="39910-166">Paired namespaces have other caveats that are discussed in that article.</span></span>

### <a name="failure-of-service-bus-within-an-azure-datacenter"></a><span data-ttu-id="39910-167">Falha do Barramento de Serviço em um datacenter do Azure</span><span class="sxs-lookup"><span data-stu-id="39910-167">Failure of Service Bus within an Azure datacenter</span></span>
<span data-ttu-id="39910-168">a razão mais provável saudação de uma falha em um datacenter do Azure é uma implantação de atualização com falha do barramento de serviço ou um sistema dependente.</span><span class="sxs-lookup"><span data-stu-id="39910-168">hello most probable reason for a failure in an Azure datacenter is a failed upgrade deployment of Service Bus or a dependent system.</span></span> <span data-ttu-id="39910-169">Como plataforma Olá amadureceu, probabilidade Olá desse tipo de falha é reduzida.</span><span class="sxs-lookup"><span data-stu-id="39910-169">As hello platform has matured, hello likelihood of this type of failure has diminished.</span></span> <span data-ttu-id="39910-170">Uma falha de datacenter pode também acontecer por razões que incluem hello seguinte:</span><span class="sxs-lookup"><span data-stu-id="39910-170">A datacenter failure can also happen for reasons that include hello following:</span></span>

* <span data-ttu-id="39910-171">Falta de energia (a fonte de energia e a geração de energia ficam indisponíveis).</span><span class="sxs-lookup"><span data-stu-id="39910-171">Electrical outage (power supply and generating power disappear).</span></span>
* <span data-ttu-id="39910-172">Conectividade (interrupção da Internet entre o cliente e o Azure).</span><span class="sxs-lookup"><span data-stu-id="39910-172">Connectivity (internet break between your clients and Azure).</span></span>

<span data-ttu-id="39910-173">Em ambos os casos, um desastre natural ou humano causou o problema de saudação.</span><span class="sxs-lookup"><span data-stu-id="39910-173">In both cases, a natural or man-made disaster caused hello issue.</span></span> <span data-ttu-id="39910-174">toowork esse problema e certifique-se de que você ainda pode enviar mensagens, você pode usar [emparelhado namespaces] [ paired namespaces] tooenable mensagens enviada de toobe tooa segundo local enquanto Olá primeira localização torna íntegra novamente.</span><span class="sxs-lookup"><span data-stu-id="39910-174">toowork around this and make sure that you can still send messages, you can use [paired namespaces][paired namespaces] tooenable messages toobe sent tooa second location while hello primary location is made healthy again.</span></span> <span data-ttu-id="39910-175">Para saber mais, confira [Práticas recomendadas para isolar aplicativos contra interrupções e desastres do Barramento de Serviço][Best practices for insulating applications against Service Bus outages and disasters].</span><span class="sxs-lookup"><span data-stu-id="39910-175">For more information, see [Best practices for insulating applications against Service Bus outages and disasters][Best practices for insulating applications against Service Bus outages and disasters].</span></span>

## <a name="paired-namespaces"></a><span data-ttu-id="39910-176">Namespaces emparelhados</span><span class="sxs-lookup"><span data-stu-id="39910-176">Paired namespaces</span></span>
<span data-ttu-id="39910-177">Olá [emparelhado namespaces] [ paired namespaces] recurso dá suporte a cenários em que uma entidade de barramento de serviço ou uma implantação em um data center torna-se indisponível.</span><span class="sxs-lookup"><span data-stu-id="39910-177">hello [paired namespaces][paired namespaces] feature supports scenarios in which a Service Bus entity or deployment within a data center becomes unavailable.</span></span> <span data-ttu-id="39910-178">Enquanto esse evento ocorra raramente, sistemas distribuídos ainda devem ser preparados toohandle piores cenários.</span><span class="sxs-lookup"><span data-stu-id="39910-178">While this event occurs infrequently, distributed systems still must be prepared toohandle worst case scenarios.</span></span> <span data-ttu-id="39910-179">Normalmente, esse evento acontece porque algum elemento dos quais o Barramento de Serviço depende está enfrentando um problema de curto prazo.</span><span class="sxs-lookup"><span data-stu-id="39910-179">Typically, this event happens because some element on which Service Bus depends is experiencing a short-term issue.</span></span> <span data-ttu-id="39910-180">disponibilidade de aplicativos toomaintain durante uma interrupção, a usuários de barramento de serviço podem usar dois namespaces separados, preferencialmente em data centers separados, toohost suas entidades de mensagens.</span><span class="sxs-lookup"><span data-stu-id="39910-180">toomaintain application availability during an outage, Service Bus users can use two separate namespaces, preferably in separate data centers, toohost their messaging entities.</span></span> <span data-ttu-id="39910-181">restante desta seção Olá usa Olá terminologia a seguir:</span><span class="sxs-lookup"><span data-stu-id="39910-181">hello remainder of this section uses hello following terminology:</span></span>

* <span data-ttu-id="39910-182">Namespace primário: Olá namespace ao qual seu aplicativo interage, para enviar e receber operações.</span><span class="sxs-lookup"><span data-stu-id="39910-182">Primary namespace: hello namespace with which your application interacts, for send and receive operations.</span></span>
* <span data-ttu-id="39910-183">Namespace secundário: Olá namespace que atua como um namespace primário toohello backup.</span><span class="sxs-lookup"><span data-stu-id="39910-183">Secondary namespace: hello namespace that acts as a backup toohello primary namespace.</span></span> <span data-ttu-id="39910-184">A lógica de aplicativo não interage com esse namespace.</span><span class="sxs-lookup"><span data-stu-id="39910-184">Application logic does not interact with this namespace.</span></span>
* <span data-ttu-id="39910-185">Intervalo de failover: quantidade de saudação de falhas normais de tooaccept de tempo antes do aplicativo hello alterna do namespace secundário do toohello Olá namespace primário.</span><span class="sxs-lookup"><span data-stu-id="39910-185">Failover interval: hello amount of time tooaccept normal failures before hello application switches from hello primary namespace toohello secondary namespace.</span></span>

<span data-ttu-id="39910-186">Namespaces emparelhados dão suporte à *disponibilidade de envio*.</span><span class="sxs-lookup"><span data-stu-id="39910-186">Paired namespaces support *send availability*.</span></span> <span data-ttu-id="39910-187">Envie mensagens de saudação do toosend capacidade preserva a disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="39910-187">Send availability preserves hello ability toosend messages.</span></span> <span data-ttu-id="39910-188">disponibilidade de envio toouse, seu aplicativo deve atender aos Olá requisitos a seguir:</span><span class="sxs-lookup"><span data-stu-id="39910-188">toouse send availability, your application must meet hello following requirements:</span></span>

1. <span data-ttu-id="39910-189">As mensagens são recebidas apenas do namespace primário hello.</span><span class="sxs-lookup"><span data-stu-id="39910-189">Messages are only received from hello primary namespace.</span></span>
2. <span data-ttu-id="39910-190">As mensagens enviadas tooa fila ou tópico determinado pode chegar fora de ordem.</span><span class="sxs-lookup"><span data-stu-id="39910-190">Messages sent tooa given queue or topic might arrive out of order.</span></span>
3. <span data-ttu-id="39910-191">As mensagens em uma sessão podem chegar fora de ordem.</span><span class="sxs-lookup"><span data-stu-id="39910-191">Messages within a session might arrive out of order.</span></span> <span data-ttu-id="39910-192">Essa é uma falha de funcionalidade normal das sessões.</span><span class="sxs-lookup"><span data-stu-id="39910-192">This is a break from normal functionality of sessions.</span></span> <span data-ttu-id="39910-193">Isso significa que o aplicativo usa mensagens de grupo de toologically de sessões.</span><span class="sxs-lookup"><span data-stu-id="39910-193">This means that your application uses sessions toologically group messages.</span></span>
4. <span data-ttu-id="39910-194">Estado da sessão é mantido somente no namespace primário hello.</span><span class="sxs-lookup"><span data-stu-id="39910-194">Session state is only maintained on hello primary namespace.</span></span>
5. <span data-ttu-id="39910-195">fila primária Olá pode ficar online e começar a aceitar mensagens antes de fila secundária Olá apresenta todas as mensagens em fila primária hello.</span><span class="sxs-lookup"><span data-stu-id="39910-195">hello primary queue can come online and start accepting messages before hello secondary queue delivers all messages into hello primary queue.</span></span>

<span data-ttu-id="39910-196">Olá seções a seguir discutem Olá APIs, como Olá APIs são implementadas e código de exemplo mostra que usa o recurso de saudação.</span><span class="sxs-lookup"><span data-stu-id="39910-196">hello following sections discuss hello APIs, how hello APIs are implemented, and shows sample code that uses hello feature.</span></span> <span data-ttu-id="39910-197">Observe que há implicações de cobranças associadas a esse recurso.</span><span class="sxs-lookup"><span data-stu-id="39910-197">Note that there are billing implications associated with this feature.</span></span>

### <a name="hello-messagingfactorypairnamespaceasync-api"></a><span data-ttu-id="39910-198">Olá API messagingfactory. Pairnamespaceasync</span><span class="sxs-lookup"><span data-stu-id="39910-198">hello MessagingFactory.PairNamespaceAsync API</span></span>
<span data-ttu-id="39910-199">inclui o recurso dos namespaces emparelhados Olá Olá [PairNamespaceAsync] [ PairNamespaceAsync] método hello [Microsoft.ServiceBus.Messaging.MessagingFactory] [ Microsoft.ServiceBus.Messaging.MessagingFactory] classe:</span><span class="sxs-lookup"><span data-stu-id="39910-199">hello paired namespaces feature includes hello [PairNamespaceAsync][PairNamespaceAsync] method on hello [Microsoft.ServiceBus.Messaging.MessagingFactory][Microsoft.ServiceBus.Messaging.MessagingFactory] class:</span></span>

```csharp
public Task PairNamespaceAsync(PairedNamespaceOptions options);
```

<span data-ttu-id="39910-200">Quando concluir a tarefa hello, Olá emparelhamento de namespace também é concluído e pronto tooact após para qualquer [MessageReceiver][MessageReceiver], [QueueClient] [ QueueClient], ou [TopicClient] [ TopicClient] criado com hello [MessagingFactory] [ MessagingFactory] instância.</span><span class="sxs-lookup"><span data-stu-id="39910-200">When hello task completes, hello namespace pairing is also complete and ready tooact upon for any [MessageReceiver][MessageReceiver], [QueueClient][QueueClient], or [TopicClient][TopicClient] created with hello [MessagingFactory][MessagingFactory] instance.</span></span> <span data-ttu-id="39910-201">[Microsoft.ServiceBus.Messaging.PairedNamespaceOptions] [ Microsoft.ServiceBus.Messaging.PairedNamespaceOptions] é a classe base Olá para hello diferentes tipos de emparelhamento que estão disponíveis com um [MessagingFactory] [ MessagingFactory] objeto.</span><span class="sxs-lookup"><span data-stu-id="39910-201">[Microsoft.ServiceBus.Messaging.PairedNamespaceOptions][Microsoft.ServiceBus.Messaging.PairedNamespaceOptions] is hello base class for hello different types of pairing that are available with a [MessagingFactory][MessagingFactory] object.</span></span> <span data-ttu-id="39910-202">Atualmente, Olá somente a classe derivada é uma chamada [SendAvailabilityPairedNamespaceOptions][SendAvailabilityPairedNamespaceOptions], que implementa os requisitos de disponibilidade de envio de saudação.</span><span class="sxs-lookup"><span data-stu-id="39910-202">Currently, hello only derived class is one named [SendAvailabilityPairedNamespaceOptions][SendAvailabilityPairedNamespaceOptions], which implements hello send availability requirements.</span></span> <span data-ttu-id="39910-203">[SendAvailabilityPairedNamespaceOptions][SendAvailabilityPairedNamespaceOptions] tem um conjunto de construtores que se baseiam uns nos outros.</span><span class="sxs-lookup"><span data-stu-id="39910-203">[SendAvailabilityPairedNamespaceOptions][SendAvailabilityPairedNamespaceOptions] has a set of constructors that build on each other.</span></span> <span data-ttu-id="39910-204">Procurando no construtor de saudação com hello a maioria dos parâmetros, você pode entender Olá comportamento de saudação outros construtores.</span><span class="sxs-lookup"><span data-stu-id="39910-204">Looking at hello constructor with hello most parameters, you can understand hello behavior of hello other constructors.</span></span>

```csharp
public SendAvailabilityPairedNamespaceOptions(
    NamespaceManager secondaryNamespaceManager,
    MessagingFactory messagingFactory,
    int backlogQueueCount,
    TimeSpan failoverInterval,
    bool enableSyphon)
```

<span data-ttu-id="39910-205">Esses parâmetros têm Olá significados a seguir:</span><span class="sxs-lookup"><span data-stu-id="39910-205">These parameters have hello following meanings:</span></span>

* <span data-ttu-id="39910-206">*secondaryNamespaceManager*: uma inicializado [NamespaceManager] [ NamespaceManager] instância para o namespace secundário Olá que Olá [PairNamespaceAsync] [ PairNamespaceAsync] método pode usar tooset o namespace secundário hello.</span><span class="sxs-lookup"><span data-stu-id="39910-206">*secondaryNamespaceManager*: An initialized [NamespaceManager][NamespaceManager] instance for hello secondary namespace that hello [PairNamespaceAsync][PairNamespaceAsync] method can use tooset up hello secondary namespace.</span></span> <span data-ttu-id="39910-207">Gerenciador de namespace de saudação é a lista de saudação de tooobtain usado de filas no namespace hello e toomake-se de que existam filas de lista de pendências de Olá necessário.</span><span class="sxs-lookup"><span data-stu-id="39910-207">hello namespace manager is used tooobtain hello list of queues in hello namespace and toomake sure that hello required backlog queues exist.</span></span> <span data-ttu-id="39910-208">Se essas filas não existirem, elas serão criadas.</span><span class="sxs-lookup"><span data-stu-id="39910-208">If those queues do not exist, they are created.</span></span> <span data-ttu-id="39910-209">[NamespaceManager] [ NamespaceManager] requer Olá capacidade toocreate um token com hello **gerenciar** de declaração.</span><span class="sxs-lookup"><span data-stu-id="39910-209">[NamespaceManager][NamespaceManager] requires hello ability toocreate a token with hello **Manage** claim.</span></span>
* <span data-ttu-id="39910-210">*messagingFactory*: Olá [MessagingFactory] [ MessagingFactory] instância para o namespace secundário hello.</span><span class="sxs-lookup"><span data-stu-id="39910-210">*messagingFactory*: hello [MessagingFactory][MessagingFactory] instance for hello secondary namespace.</span></span> <span data-ttu-id="39910-211">Olá [MessagingFactory] [ MessagingFactory] objeto é toosend usado e, se hello [EnableSyphon] [ EnableSyphon] propriedade for definida muito**true** , receber mensagens de filas de lista de pendências de saudação.</span><span class="sxs-lookup"><span data-stu-id="39910-211">hello [MessagingFactory][MessagingFactory] object is used toosend and, if hello [EnableSyphon][EnableSyphon] property is set too**true**, receive messages from hello backlog queues.</span></span>
* <span data-ttu-id="39910-212">*backlogQueueCount*: número de saudação da lista de pendências filas toocreate.</span><span class="sxs-lookup"><span data-stu-id="39910-212">*backlogQueueCount*: hello number of backlog queues toocreate.</span></span> <span data-ttu-id="39910-213">Esse valor deve ser pelo menos 1.</span><span class="sxs-lookup"><span data-stu-id="39910-213">This value must be at least 1.</span></span> <span data-ttu-id="39910-214">Ao enviar a lista de pendências de toohello de mensagens, uma dessas filas é escolhida aleatoriamente.</span><span class="sxs-lookup"><span data-stu-id="39910-214">When sending messages toohello backlog, one of these queues is randomly chosen.</span></span> <span data-ttu-id="39910-215">Se você definir Olá valor too1, somente uma fila nunca pode ser usada.</span><span class="sxs-lookup"><span data-stu-id="39910-215">If you set hello value too1, then only one queue can ever be used.</span></span> <span data-ttu-id="39910-216">Quando isso acontece e fila de registros acumulados hello gera erros, o cliente de Olá não é capaz de tootry uma fila de registros acumulados diferente e pode falhar toosend sua mensagem.</span><span class="sxs-lookup"><span data-stu-id="39910-216">When this happens and hello one backlog queue generates errors, hello client is not able tootry a different backlog queue and may fail toosend your message.</span></span> <span data-ttu-id="39910-217">É recomendável definir este valor toosome maior valor e padrão Olá valor too10.</span><span class="sxs-lookup"><span data-stu-id="39910-217">We recommend setting this value toosome larger value and default hello value too10.</span></span> <span data-ttu-id="39910-218">Você pode alterar esse tooa superior ou o valor mais baixo dependendo de quantos dados o aplicativo envia por dia.</span><span class="sxs-lookup"><span data-stu-id="39910-218">You can change this tooa higher or lower value depending on how much data your application sends per day.</span></span> <span data-ttu-id="39910-219">Cada fila de registros acumulados pode manter a too5 GB de mensagens.</span><span class="sxs-lookup"><span data-stu-id="39910-219">Each backlog queue can hold up too5 GB of messages.</span></span>
* <span data-ttu-id="39910-220">*failoverInterval*: Olá quantidade de tempo durante o qual você irá aceitar falhas no namespace primário Olá antes de alterar qualquer entidade única em um namespace secundário toohello.</span><span class="sxs-lookup"><span data-stu-id="39910-220">*failoverInterval*: hello amount of time during which you will accept failures on hello primary namespace before switching any single entity over toohello secondary namespace.</span></span> <span data-ttu-id="39910-221">Os failovers ocorrem em entidades individuais.</span><span class="sxs-lookup"><span data-stu-id="39910-221">Failovers occur on an entity-by-entity basis.</span></span> <span data-ttu-id="39910-222">Entidades em um único namespace frequentemente estão em nós diferentes no Barramento de Serviço.</span><span class="sxs-lookup"><span data-stu-id="39910-222">Entities in a single namespace frequently live in different nodes within Service Bus.</span></span> <span data-ttu-id="39910-223">Uma falha em uma entidade não implica falha em outra.</span><span class="sxs-lookup"><span data-stu-id="39910-223">A failure in one entity does not imply a failure in another.</span></span> <span data-ttu-id="39910-224">Você pode definir esse valor muito[System.TimeSpan.Zero] [ System.TimeSpan.Zero] toofailover toohello secundário imediatamente após a falha em primeiro lugar, não transitório.</span><span class="sxs-lookup"><span data-stu-id="39910-224">You can set this value too[System.TimeSpan.Zero][System.TimeSpan.Zero] toofailover toohello secondary immediately after your first, non-transient failure.</span></span> <span data-ttu-id="39910-225">Falhas que acionam o timer do failover Olá são qualquer [MessagingException] [ MessagingException] no qual Olá [IsTransient] [ IsTransient] propriedade é false, ou um [System. TimeoutException][System.TimeoutException].</span><span class="sxs-lookup"><span data-stu-id="39910-225">Failures that trigger hello failover timer are any [MessagingException][MessagingException] in which hello [IsTransient][IsTransient] property is false, or a [System.TimeoutException][System.TimeoutException].</span></span> <span data-ttu-id="39910-226">Outras exceções, como [UnauthorizedAccessException] [ UnauthorizedAccessException] não causam o failover, pois elas indicam que o cliente hello está configurado incorretamente.</span><span class="sxs-lookup"><span data-stu-id="39910-226">Other exceptions, such as [UnauthorizedAccessException][UnauthorizedAccessException] do not cause failover, because they indicate that hello client is configured incorrectly.</span></span> <span data-ttu-id="39910-227">Um [ServerBusyException] [ ServerBusyException] não causa failover porque o padrão correto Olá é toowait 10 segundos, em seguida, envia mensagem de saudação novamente.</span><span class="sxs-lookup"><span data-stu-id="39910-227">A [ServerBusyException][ServerBusyException] does not cause failover because hello correct pattern is toowait 10 seconds, then send hello message again.</span></span>
* <span data-ttu-id="39910-228">*enableSyphon*: indica que um emparelhamento particular deve também tirar com sifão mensagens de saudação secundário toohello back principal de namespace.</span><span class="sxs-lookup"><span data-stu-id="39910-228">*enableSyphon*: Indicates that this particular pairing should also syphon messages from hello secondary namespace back toohello primary namespace.</span></span> <span data-ttu-id="39910-229">Em geral, os aplicativos que enviam mensagens devem definir esse valor muito**false**; aplicativos que recebem mensagens devem definir esse valor muito**true**.</span><span class="sxs-lookup"><span data-stu-id="39910-229">In general, applications that send messages should set this value too**false**; applications that receive messages should set this value too**true**.</span></span> <span data-ttu-id="39910-230">motivo Olá para isso é frequentemente, há menos receptores de mensagens que remetentes de mensagens.</span><span class="sxs-lookup"><span data-stu-id="39910-230">hello reason for this is that frequently, there are fewer message receivers than message senders.</span></span> <span data-ttu-id="39910-231">Dependendo do número de saudação de destinatários, você pode escolher tarefas de sifão um único aplicativo instância identificador Olá toohave.</span><span class="sxs-lookup"><span data-stu-id="39910-231">Depending on hello number of receivers, you can choose toohave a single application instance handle hello syphon duties.</span></span> <span data-ttu-id="39910-232">Usar muitos receptores tem implicações de cobranças para cada fila de lista de pendências.</span><span class="sxs-lookup"><span data-stu-id="39910-232">Using many receivers has billing implications for each backlog queue.</span></span>

<span data-ttu-id="39910-233">toouse Olá código, crie um primário [MessagingFactory] [ MessagingFactory] instância, um secundário [MessagingFactory] [ MessagingFactory] instância, um secundário [NamespaceManager] [ NamespaceManager] instância e um [SendAvailabilityPairedNamespaceOptions] [ SendAvailabilityPairedNamespaceOptions] instância.</span><span class="sxs-lookup"><span data-stu-id="39910-233">toouse hello code, create a primary [MessagingFactory][MessagingFactory] instance, a secondary [MessagingFactory][MessagingFactory] instance, a secondary [NamespaceManager][NamespaceManager] instance, and a [SendAvailabilityPairedNamespaceOptions][SendAvailabilityPairedNamespaceOptions] instance.</span></span> <span data-ttu-id="39910-234">chamada de saudação pode ser tão simple quanto a seguir hello:</span><span class="sxs-lookup"><span data-stu-id="39910-234">hello call can be as simple as hello following:</span></span>

```csharp
SendAvailabilityPairedNamespaceOptions sendAvailabilityOptions = new SendAvailabilityPairedNamespaceOptions(secondaryNamespaceManager, secondary);
primary.PairNamespaceAsync(sendAvailabilityOptions).Wait();
```

<span data-ttu-id="39910-235">Olá quando a tarefa retornada por Olá [PairNamespaceAsync] [ PairNamespaceAsync] método é concluído, tudo está configurado e pronto toouse.</span><span class="sxs-lookup"><span data-stu-id="39910-235">When hello task returned by hello [PairNamespaceAsync][PairNamespaceAsync] method completes, everything is set up and ready toouse.</span></span> <span data-ttu-id="39910-236">Antes de tarefa Olá é retornada, você pode não concluiu todo o trabalho de plano de fundo de saudação necessário para Olá emparelhamento toowork direita.</span><span class="sxs-lookup"><span data-stu-id="39910-236">Before hello task is returned, you may not have completed all of hello background work necessary for hello pairing toowork right.</span></span> <span data-ttu-id="39910-237">Como resultado, você não comece a enviar mensagens até que a tarefa de saudação retorna.</span><span class="sxs-lookup"><span data-stu-id="39910-237">As a result, you should not start sending messages until hello task returns.</span></span> <span data-ttu-id="39910-238">Se nenhuma falha ocorrer, como credenciais incorretas ou filas de pendências da saudação falha toocreate, essas exceções serão lançadas após a conclusão da tarefa de saudação.</span><span class="sxs-lookup"><span data-stu-id="39910-238">If any failures occurred, such as bad credentials, or failure toocreate hello backlog queues, those exceptions will be thrown once hello task completes.</span></span> <span data-ttu-id="39910-239">Depois que a tarefa Olá retorna, verifique se filas Olá foram encontradas ou criadas por meio do exame Olá [BacklogQueueCount] [ BacklogQueueCount] propriedade em seu [SendAvailabilityPairedNamespaceOptions] [ SendAvailabilityPairedNamespaceOptions] instância.</span><span class="sxs-lookup"><span data-stu-id="39910-239">Once hello task returns, verify that hello queues were found or created by examining hello [BacklogQueueCount][BacklogQueueCount] property on your [SendAvailabilityPairedNamespaceOptions][SendAvailabilityPairedNamespaceOptions] instance.</span></span> <span data-ttu-id="39910-240">Para Olá precede o código, a operação aparece da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="39910-240">For hello preceding code, that operation appears as follows:</span></span>

```csharp
if (sendAvailabilityOptions.BacklogQueueCount < 1)
{
    // Handle case where no queues were created.
}
```

## <a name="next-steps"></a><span data-ttu-id="39910-241">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="39910-241">Next steps</span></span>
<span data-ttu-id="39910-242">Agora que você aprendeu as Noções básicas de saudação do sistema de mensagens assíncronas no barramento de serviço, leia mais detalhes sobre [emparelhado namespaces][paired namespaces].</span><span class="sxs-lookup"><span data-stu-id="39910-242">Now that you've learned hello basics of asynchronous messaging in Service Bus, read more details about [paired namespaces][paired namespaces].</span></span>

[ServerBusyException]: /dotnet/api/microsoft.servicebus.messaging.serverbusyexception
[System.TimeoutException]: https://msdn.microsoft.com/library/system.timeoutexception.aspx
[MessagingException]: /dotnet/api/microsoft.servicebus.messaging.messagingexception
[Best practices for insulating applications against Service Bus outages and disasters]: service-bus-outages-disasters.md
[Microsoft.ServiceBus.Messaging.MessagingFactory]: /dotnet/api/microsoft.servicebus.messaging.messagingfactory
[MessageReceiver]: /dotnet/api/microsoft.servicebus.messaging.messagereceiver
[QueueClient]: /dotnet/api/microsoft.servicebus.messaging.queueclient
[TopicClient]: /dotnet/api/microsoft.servicebus.messaging.topicclient
[Microsoft.ServiceBus.Messaging.PairedNamespaceOptions]: /dotnet/api/microsoft.servicebus.messaging.pairednamespaceoptions
[MessagingFactory]: /dotnet/api/microsoft.servicebus.messaging.messagingfactory
[SendAvailabilityPairedNamespaceOptions]: /dotnet/api/microsoft.servicebus.messaging.sendavailabilitypairednamespaceoptions
[NamespaceManager]: /dotnet/api/microsoft.servicebus.namespacemanager
[PairNamespaceAsync]: /dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_PairNamespaceAsync_Microsoft_ServiceBus_Messaging_PairedNamespaceOptions_
[EnableSyphon]: /dotnet/api/microsoft.servicebus.messaging.sendavailabilitypairednamespaceoptions#Microsoft_ServiceBus_Messaging_SendAvailabilityPairedNamespaceOptions_EnableSyphon
[System.TimeSpan.Zero]: https://msdn.microsoft.com/library/system.timespan.zero.aspx
[IsTransient]: /dotnet/api/microsoft.servicebus.messaging.messagingexception#Microsoft_ServiceBus_Messaging_MessagingException_IsTransient
[UnauthorizedAccessException]: https://msdn.microsoft.com/library/system.unauthorizedaccessexception.aspx
[BacklogQueueCount]: /dotnet/api/microsoft.servicebus.messaging.sendavailabilitypairednamespaceoptions?redirectedfrom=MSDN#Microsoft_ServiceBus_Messaging_SendAvailabilityPairedNamespaceOptions_BacklogQueueCount
[paired namespaces]: service-bus-paired-namespaces.md
