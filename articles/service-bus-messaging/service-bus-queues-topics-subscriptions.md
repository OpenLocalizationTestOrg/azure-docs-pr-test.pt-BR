---
title: "aaaOverview de mensagens de filas, tópicos e assinaturas do Azure Service Bus | Microsoft Docs"
description: "Visão geral de entidades do sistema de mensagens do Barramento de Serviço."
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: a306ced4-74e9-47c6-990a-d9c47efa31d5
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 06/28/2017
ms.author: sethm
ms.openlocfilehash: 73135d2658e341c14dbb114ab938faed91578ff1
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="service-bus-queues-topics-and-subscriptions"></a><span data-ttu-id="cb145-103">Filas, tópicos e assinaturas do Barramento de Serviço</span><span class="sxs-lookup"><span data-stu-id="cb145-103">Service Bus queues, topics, and subscriptions</span></span>

<span data-ttu-id="cb145-104">O Barramento de Serviço do Microsoft Azure oferece suporte a um conjunto de tecnologias middleware orientado a mensagens, baseado em nuvem, incluindo o serviço de enfileiramento de mensagens confiável e o sistema de mensagens de publicação/assinatura durável.</span><span class="sxs-lookup"><span data-stu-id="cb145-104">Microsoft Azure Service Bus supports a set of cloud-based, message-oriented middleware technologies including reliable message queuing and durable publish/subscribe messaging.</span></span> <span data-ttu-id="cb145-105">Esses recursos de mensagens "orientadas" podem ser considerados separado recursos que suporte publicação / assinatura de mensagens, temporal desacoplamento e cenários de malha mensagens do barramento de serviço de saudação de balanceamento de carga.</span><span class="sxs-lookup"><span data-stu-id="cb145-105">These "brokered" messaging capabilities can be thought of as decoupled messaging features that support publish-subscribe, temporal decoupling, and load balancing scenarios using hello Service Bus messaging fabric.</span></span> <span data-ttu-id="cb145-106">A comunicação desacoplada tem diversas vantagens; por exemplo, clientes e servidores podem se conectar como necessário e executar as operações deles de forma assíncrona.</span><span class="sxs-lookup"><span data-stu-id="cb145-106">Decoupled communication has many advantages; for example, clients and servers can connect as needed and perform their operations in an asynchronous fashion.</span></span>

<span data-ttu-id="cb145-107">entidades de mensagens de saudação que formam o núcleo de saudação de recursos no barramento de serviço de mensagens de saudação são filas, tópicos, assinaturas e regras/ações.</span><span class="sxs-lookup"><span data-stu-id="cb145-107">hello messaging entities that form hello core of hello messaging capabilities in Service Bus are queues, topics and subscriptions, and rules/actions.</span></span>

## <a name="queues"></a><span data-ttu-id="cb145-108">Filas</span><span class="sxs-lookup"><span data-stu-id="cb145-108">Queues</span></span>

<span data-ttu-id="cb145-109">As filas oferecem *primeiro a entrar, primeiro a sair* tooone de entrega de mensagem (PEPS) ou mais consumidores concorrentes.</span><span class="sxs-lookup"><span data-stu-id="cb145-109">Queues offer *First In, First Out* (FIFO) message delivery tooone or more competing consumers.</span></span> <span data-ttu-id="cb145-110">Ou seja, as mensagens são normalmente esperado toobe recebidas e processadas pelos destinatários de saudação na Olá ordem em que eles foram adicionados toohello fila, e cada mensagem é recebida e processada por apenas um cliente de mensagem.</span><span class="sxs-lookup"><span data-stu-id="cb145-110">That is, messages are typically expected toobe received and processed by hello receivers in hello order in which they were added toohello queue, and each message is received and processed by only one message consumer.</span></span> <span data-ttu-id="cb145-111">Uma importante vantagem de usar filas é tooachieve "desacoplamento temporal" dos componentes do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="cb145-111">A key benefit of using queues is tooachieve "temporal decoupling" of application components.</span></span> <span data-ttu-id="cb145-112">Olá em outras palavras, os produtores (remetentes) e os consumidores (destinatários) não tem toobe enviar e receber mensagens em Olá mesmo tempo porque as mensagens são armazenadas de forma duradoura na fila de saudação.</span><span class="sxs-lookup"><span data-stu-id="cb145-112">In other words, hello producers (senders) and consumers (receivers) do not have toobe sending and receiving messages at hello same time, because messages are stored durably in hello queue.</span></span> <span data-ttu-id="cb145-113">Além disso, produtor Olá não tem toowait por uma resposta do consumidor de saudação em ordem toocontinue tooprocess e enviar mensagens.</span><span class="sxs-lookup"><span data-stu-id="cb145-113">Furthermore, hello producer does not have toowait for a reply from hello consumer in order toocontinue tooprocess and send messages.</span></span>

<span data-ttu-id="cb145-114">Um benefício relacionado é "carga redistribuição," que permite que produtores e consumidores toosend e recebe mensagens em diferentes taxas.</span><span class="sxs-lookup"><span data-stu-id="cb145-114">A related benefit is "load leveling," which enables producers and consumers toosend and receive messages at different rates.</span></span> <span data-ttu-id="cb145-115">Em muitos aplicativos, a carga do sistema Olá varia ao longo do tempo; No entanto, o tempo de processamento de saudação necessário para cada unidade de trabalho é normalmente constante.</span><span class="sxs-lookup"><span data-stu-id="cb145-115">In many applications, hello system load varies over time; however, hello processing time required for each unit of work is typically constant.</span></span> <span data-ttu-id="cb145-116">Intermediação dos produtores e consumidores com uma fila significa que Olá consumindo o aplicativo só tem toobe toobe provisionados toohandle capaz de carga média em vez de picos de carga.</span><span class="sxs-lookup"><span data-stu-id="cb145-116">Intermediating message producers and consumers with a queue means that hello consuming application only has toobe provisioned toobe able toohandle average load instead of peak load.</span></span> <span data-ttu-id="cb145-117">profundidade de saudação da fila de saudação aumenta e diminui conforme a carga de entrada hello varia.</span><span class="sxs-lookup"><span data-stu-id="cb145-117">hello depth of hello queue grows and contracts as hello incoming load varies.</span></span> <span data-ttu-id="cb145-118">Isso economiza o dinheiro diretamente com valor de toohello considerar a infraestrutura necessária tooservice Olá de carregamento de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="cb145-118">This directly saves money with regard toohello amount of infrastructure required tooservice hello application load.</span></span> <span data-ttu-id="cb145-119">Como Olá carga aumenta, mais processos de trabalho podem ser adicionado tooread da fila de saudação.</span><span class="sxs-lookup"><span data-stu-id="cb145-119">As hello load increases, more worker processes can be added tooread from hello queue.</span></span> <span data-ttu-id="cb145-120">Cada mensagem é processada por apenas um dos processos de trabalho hello.</span><span class="sxs-lookup"><span data-stu-id="cb145-120">Each message is processed by only one of hello worker processes.</span></span> <span data-ttu-id="cb145-121">Além disso, esse balanceamento de carga baseado em pull permite o uso otimizado dos computadores de trabalho Olá mesmo que sejam diferentes computadores de trabalho Olá com capacidade de tooprocessing de relação, conforme eles efetuarão pull das mensagens em sua própria velocidade máxima.</span><span class="sxs-lookup"><span data-stu-id="cb145-121">Furthermore, this pull-based load balancing allows for optimum use of hello worker computers even if hello worker computers differ with regard tooprocessing power, as they will pull messages at their own maximum rate.</span></span> <span data-ttu-id="cb145-122">Esse padrão é geralmente denominado padrão de "consumidor concorrente" hello.</span><span class="sxs-lookup"><span data-stu-id="cb145-122">This pattern is often termed hello "competing consumer" pattern.</span></span>

<span data-ttu-id="cb145-123">Usar filas toointermediate entre os consumidores e produtores de mensagens fornece um acoplamento flexível entre os componentes de saudação.</span><span class="sxs-lookup"><span data-stu-id="cb145-123">Using queues toointermediate between message producers and consumers provides an inherent loose coupling between hello components.</span></span> <span data-ttu-id="cb145-124">Como produtores e consumidores não têm conhecimento uns dos outros, um consumidor pode ser atualizado sem causar qualquer impacto produtor hello.</span><span class="sxs-lookup"><span data-stu-id="cb145-124">Because producers and consumers are not aware of each other, a consumer can be upgraded without having any effect on hello producer.</span></span>

<span data-ttu-id="cb145-125">A criação de uma fila é um processo de várias etapas.</span><span class="sxs-lookup"><span data-stu-id="cb145-125">Creating a queue is a multi-step process.</span></span> <span data-ttu-id="cb145-126">Executar operações de gerenciamento para entidades (filas e tópicos) por meio de saudação de mensagens do barramento de serviço [Microsoft.ServiceBus.NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) classe, que é construído, fornecendo o endereço de base de saudação do hello barramento de serviço namespace e hello credenciais do usuário.</span><span class="sxs-lookup"><span data-stu-id="cb145-126">You perform management operations for Service Bus messaging entities (both queues and topics) via hello [Microsoft.ServiceBus.NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) class, which is constructed by supplying hello base address of hello Service Bus namespace and hello user credentials.</span></span> <span data-ttu-id="cb145-127">[Gerenciador de namespace](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) fornece métodos toocreate, enumerar e excluir entidades de mensagens.</span><span class="sxs-lookup"><span data-stu-id="cb145-127">[NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) provides methods toocreate, enumerate and delete messaging entities.</span></span> <span data-ttu-id="cb145-128">Depois de criar um [Microsoft.ServiceBus.TokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider#microsoft_servicebus_tokenprovider) objeto do nome SAS do hello e chave e um gerenciamento de namespace de serviço do objeto, você pode usar o hello [Microsoft.ServiceBus.NamespaceManager.CreateQueue](/dotnet/api/microsoft.servicebus.namespacemanager#Microsoft_ServiceBus_NamespaceManager_CreateQueue_System_String_) fila de saudação do método toocreate.</span><span class="sxs-lookup"><span data-stu-id="cb145-128">After creating a [Microsoft.ServiceBus.TokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider#microsoft_servicebus_tokenprovider) object from hello SAS name and key, and a service namespace management object, you can use hello [Microsoft.ServiceBus.NamespaceManager.CreateQueue](/dotnet/api/microsoft.servicebus.namespacemanager#Microsoft_ServiceBus_NamespaceManager_CreateQueue_System_String_) method toocreate hello queue.</span></span> <span data-ttu-id="cb145-129">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="cb145-129">For example:</span></span>

```csharp
// Create management credentials
TokenProvider credentials = TokenProvider.CreateSharedAccessSignatureTokenProvider(sasKeyName,sasKeyValue);
// Create namespace client
NamespaceManager namespaceClient = new NamespaceManager(ServiceBusEnvironment.CreateServiceUri("sb", ServiceNamespace, string.Empty), credentials);
```

<span data-ttu-id="cb145-130">Em seguida, você pode criar um objeto de fila e uma fábrica de mensagens com hello URI de barramento de serviço como um argumento.</span><span class="sxs-lookup"><span data-stu-id="cb145-130">You can then create a queue object and a messaging factory with hello Service Bus URI as an argument.</span></span> <span data-ttu-id="cb145-131">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="cb145-131">For example:</span></span>

```csharp
QueueDescription myQueue;
myQueue = namespaceClient.CreateQueue("TestQueue");
MessagingFactory factory = MessagingFactory.Create(ServiceBusEnvironment.CreateServiceUri("sb", ServiceNamespace, string.Empty), credentials); 
QueueClient myQueueClient = factory.CreateQueueClient("TestQueue");
```

<span data-ttu-id="cb145-132">Em seguida, você pode enviar fila de mensagens de toohello.</span><span class="sxs-lookup"><span data-stu-id="cb145-132">You can then send messages toohello queue.</span></span> <span data-ttu-id="cb145-133">Por exemplo, se você tiver uma lista de mensagens orientadas chamado `MessageList`, código de saudação é exibido a seguir toohello semelhante:</span><span class="sxs-lookup"><span data-stu-id="cb145-133">For example, if you have a list of brokered messages called `MessageList`, hello code appears similar toohello following:</span></span>

```csharp
for (int count = 0; count < 6; count++)
{
    var issue = MessageList[count];
    issue.Label = issue.Properties["IssueTitle"].ToString();
    myQueueClient.Send(issue);
}
```

<span data-ttu-id="cb145-134">Você então receber mensagens da fila de saudação da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="cb145-134">You then receive messages from hello queue as follows:</span></span>

```csharp
while ((message = myQueueClient.Receive(new TimeSpan(hours: 0, minutes: 0, seconds: 5))) != null)
    {
        Console.WriteLine(string.Format("Message received: {0}, {1}, {2}", message.SequenceNumber, message.Label, message.MessageId));
        message.Complete();

        Console.WriteLine("Processing message (sleeping...)");
        Thread.Sleep(1000);
    }
```

<span data-ttu-id="cb145-135">Em Olá [ReceiveAndDelete](/dotnet/api/microsoft.servicebus.messaging.receivemode) modo, Olá receber operação é a única etapa; ou seja, quando o barramento de serviço recebe a solicitação de hello, ele marca a mensagem de saudação como sendo consumida e retorna-toohello aplicativo.</span><span class="sxs-lookup"><span data-stu-id="cb145-135">In hello [ReceiveAndDelete](/dotnet/api/microsoft.servicebus.messaging.receivemode) mode, hello receive operation is single-shot; that is, when Service Bus receives hello request, it marks hello message as being consumed and returns it toohello application.</span></span> <span data-ttu-id="cb145-136">**ReceiveAndDelete** modo é o modelo mais simples de saudação e funciona melhor para cenários em que Olá aplicativo pode tolerar o não processar uma mensagem em caso de saudação de uma falha.</span><span class="sxs-lookup"><span data-stu-id="cb145-136">**ReceiveAndDelete** mode is hello simplest model and works best for scenarios in which hello application can tolerate not processing a message in hello event of a failure.</span></span> <span data-ttu-id="cb145-137">toounderstand isso, considere um cenário em que problemas do consumidor Olá Olá receber a solicitação e falha antes de processá-lo.</span><span class="sxs-lookup"><span data-stu-id="cb145-137">toounderstand this, consider a scenario in which hello consumer issues hello receive request and then crashes before processing it.</span></span> <span data-ttu-id="cb145-138">Porque o barramento de serviço marca a mensagem de saudação como sendo consumida, quando o aplicativo hello reinicia e começa a consumir mensagens novamente, ele terá perdido mensagem de saudação foi consumido falha toohello anterior.</span><span class="sxs-lookup"><span data-stu-id="cb145-138">Because Service Bus marks hello message as being consumed, when hello application restarts and begins consuming messages again, it will have missed hello message that was consumed prior toohello crash.</span></span>

<span data-ttu-id="cb145-139">Em [PeekLock](/dotnet/api/microsoft.servicebus.messaging.receivemode) modo, Olá receber operação torna-se dois estágios, que torna possível toosupport aplicativos que não podem tolerar mensagens ausentes.</span><span class="sxs-lookup"><span data-stu-id="cb145-139">In [PeekLock](/dotnet/api/microsoft.servicebus.messaging.receivemode) mode, hello receive operation becomes two-stage, which makes it possible toosupport applications that cannot tolerate missing messages.</span></span> <span data-ttu-id="cb145-140">Ao barramento de serviço recebe a solicitação de Olá, localiza Olá próxima mensagem toobe consumida, boqueia-tooprevent outros consumidores do recebimento e, em seguida, ele retorna toohello aplicativo.</span><span class="sxs-lookup"><span data-stu-id="cb145-140">When Service Bus receives hello request, it finds hello next message toobe consumed, locks it tooprevent other consumers from receiving it, and then returns it toohello application.</span></span> <span data-ttu-id="cb145-141">Depois que o aplicativo hello termina de processar a mensagem de saudação (ou armazena com segurança para processamento futuro), ele conclui Olá segunda etapa de saudação processo de recebimento chamando [concluir](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete) na mensagem recebida.</span><span class="sxs-lookup"><span data-stu-id="cb145-141">After hello application finishes processing hello message (or stores it reliably for future processing), it completes hello second stage of hello receive process by calling [Complete](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete) on hello received message.</span></span> <span data-ttu-id="cb145-142">Quando o Service Bus vê Olá **concluir** chamada, ele marca a mensagem de saudação como sendo consumida.</span><span class="sxs-lookup"><span data-stu-id="cb145-142">When Service Bus sees hello **Complete** call, it marks hello message as being consumed.</span></span>

<span data-ttu-id="cb145-143">Caso o aplicativo hello não é possível tooprocess Olá mensagem por algum motivo, ele pode chamar hello [abandonar](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Abandon) método na mensagem recebida (em vez de [concluir](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete)).</span><span class="sxs-lookup"><span data-stu-id="cb145-143">If hello application is unable tooprocess hello message for some reason, it can call hello [Abandon](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Abandon) method on hello received message (instead of [Complete](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete)).</span></span> <span data-ttu-id="cb145-144">Isso permite que a mensagem de saudação do barramento de serviço toounlock e torná-lo disponível toobe recebida novamente, pelo Olá mesmo consumidor ou por outro consumidor concorrente.</span><span class="sxs-lookup"><span data-stu-id="cb145-144">This enables Service Bus toounlock hello message and make it available toobe received again, either by hello same consumer or by another competing consumer.</span></span> <span data-ttu-id="cb145-145">Em segundo lugar, há um tempo limite associado bloqueio hello e se o aplicativo hello falha tooprocess Olá mensagem antes de tempo limite de bloqueio de saudação expira (por exemplo, se o aplicativo hello falhar), barramento de serviço desbloqueia a mensagem de saudação e torna disponível toobe recebida novamente (basicamente a realização de uma [abandonar](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Abandon) operação por padrão).</span><span class="sxs-lookup"><span data-stu-id="cb145-145">Secondly, there is a timeout associated with hello lock and if hello application fails tooprocess hello message before hello lock timeout expires (for example, if hello application crashes), then Service Bus unlocks hello message and makes it available toobe received again (essentially performing an [Abandon](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Abandon) operation by default).</span></span>

<span data-ttu-id="cb145-146">Observe que, em Olá evento Olá aplicativo falha após o processamento de mensagem de saudação, mas antes de saudação **concluir** solicitação é emitida, a mensagem de saudação é entregue novamente toohello aplicativo quando ele for reiniciado.</span><span class="sxs-lookup"><span data-stu-id="cb145-146">Note that in hello event that hello application crashes after processing hello message, but before hello **Complete** request is issued, hello message is redelivered toohello application when it restarts.</span></span> <span data-ttu-id="cb145-147">Com frequência, isso é chamado de processamento *Pelo menos uma vez*; ou seja, cada mensagem é processada pelo menos uma vez.</span><span class="sxs-lookup"><span data-stu-id="cb145-147">This is often called *At Least Once* processing; that is, each message is processed at least once.</span></span> <span data-ttu-id="cb145-148">No entanto, em determinados Olá situações mesma mensagem pode ser entregue novamente.</span><span class="sxs-lookup"><span data-stu-id="cb145-148">However, in certain situations hello same message may be redelivered.</span></span> <span data-ttu-id="cb145-149">Se o cenário de saudação não puder tolerar o processamento duplicado, lógica adicional será necessária em duplicatas de toodetect de aplicativo hello que podem ser obtidas com base no hello **MessageId** propriedade da mensagem de saudação, que permanece constante entre tentativas de entrega.</span><span class="sxs-lookup"><span data-stu-id="cb145-149">If hello scenario cannot tolerate duplicate processing, then additional logic is required in hello application toodetect duplicates which can be achieved based upon hello **MessageId** property of hello message, which remains constant across delivery attempts.</span></span> <span data-ttu-id="cb145-150">Isso é conhecido como processamento *Exatamente Uma Vez*.</span><span class="sxs-lookup"><span data-stu-id="cb145-150">This is known as *Exactly Once* processing.</span></span>

## <a name="topics-and-subscriptions"></a><span data-ttu-id="cb145-151">Tópicos e assinaturas</span><span class="sxs-lookup"><span data-stu-id="cb145-151">Topics and subscriptions</span></span>
<span data-ttu-id="cb145-152">Em contraste tooqueues, em que cada mensagem é processada por um único consumidor, *tópicos* e *assinaturas* fornecem uma forma de um-para-muitos de comunicação, em um *depublicação/assinatura* padrão.</span><span class="sxs-lookup"><span data-stu-id="cb145-152">In contrast tooqueues, in which each message is processed by a single consumer, *topics* and *subscriptions* provide a one-to-many form of communication, in a *publish/subscribe* pattern.</span></span> <span data-ttu-id="cb145-153">Útil para dimensionamento toovery grande número de destinatários, cada mensagem publicada é feita tooeach disponível assinatura registrada com o tópico de saudação.</span><span class="sxs-lookup"><span data-stu-id="cb145-153">Useful for scaling toovery large numbers of recipients, each published message is made available tooeach subscription registered with hello topic.</span></span> <span data-ttu-id="cb145-154">As mensagens são enviadas tooa tópico e entregue tooone ou mais assinaturas associadas, dependendo de regras de filtro que podem ser definidas em uma base por assinatura.</span><span class="sxs-lookup"><span data-stu-id="cb145-154">Messages are sent tooa topic and delivered tooone or more associated subscriptions, depending on filter rules that can be set on a per-subscription basis.</span></span> <span data-ttu-id="cb145-155">assinaturas de saudação podem usar mensagens de saudação toorestrict filtros adicionais que deseja tooreceive.</span><span class="sxs-lookup"><span data-stu-id="cb145-155">hello subscriptions can use additional filters toorestrict hello messages that they want tooreceive.</span></span> <span data-ttu-id="cb145-156">As mensagens são enviadas tooa tópico em Olá mesmo propósito são enviados tooa fila, mas as mensagens não são recebidas diretamente do tópico hello.</span><span class="sxs-lookup"><span data-stu-id="cb145-156">Messages are sent tooa topic in hello same way they are sent tooa queue, but messages are not received from hello topic directly.</span></span> <span data-ttu-id="cb145-157">Em vez disso, elas são recebidas de assinaturas.</span><span class="sxs-lookup"><span data-stu-id="cb145-157">Instead, they are received from subscriptions.</span></span> <span data-ttu-id="cb145-158">Uma assinatura de tópico é semelhante a uma fila virtual que recebe cópias das mensagens de saudação enviadas toohello tópico.</span><span class="sxs-lookup"><span data-stu-id="cb145-158">A topic subscription resembles a virtual queue that receives copies of hello messages that are sent toohello topic.</span></span> <span data-ttu-id="cb145-159">As mensagens são recebidas de uma assinatura de forma idêntica toohello maneira que são recebidas de uma fila.</span><span class="sxs-lookup"><span data-stu-id="cb145-159">Messages are received from a subscription identically toohello way they are received from a queue.</span></span>

<span data-ttu-id="cb145-160">Por comparação, hello funcionalidade de envio de mensagens de uma fila é mapeado diretamente tooa tópico e sua funcionalidade de recebimento de mensagens mapeia tooa assinatura.</span><span class="sxs-lookup"><span data-stu-id="cb145-160">By way of comparison, hello message-sending functionality of a queue maps directly tooa topic and its message-receiving functionality maps tooa subscription.</span></span> <span data-ttu-id="cb145-161">Entre outras coisas, isso significa que as assinaturas admitem Olá mesmos padrões descritos anteriormente nesta seção com relação tooqueues: consumidor concorrente, desacoplamento temporal, nivelamento de carga e balanceamento de carga.</span><span class="sxs-lookup"><span data-stu-id="cb145-161">Among other things, this means that subscriptions support hello same patterns described earlier in this section with regard tooqueues: competing consumer, temporal decoupling, load leveling, and load balancing.</span></span>

<span data-ttu-id="cb145-162">Criar um tópico é semelhante toocreating uma fila, conforme mostrado no exemplo hello na seção anterior hello.</span><span class="sxs-lookup"><span data-stu-id="cb145-162">Creating a topic is similar toocreating a queue, as shown in hello example in hello previous section.</span></span> <span data-ttu-id="cb145-163">Criar o URI do serviço hello e use Olá [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) cliente do namespace classe toocreate hello.</span><span class="sxs-lookup"><span data-stu-id="cb145-163">Create hello service URI, and then use hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) class toocreate hello namespace client.</span></span> <span data-ttu-id="cb145-164">Você pode criar um tópico usando Olá [CreateTopic](/dotnet/api/microsoft.servicebus.namespacemanager#Microsoft_ServiceBus_NamespaceManager_CreateTopic_System_String_) método.</span><span class="sxs-lookup"><span data-stu-id="cb145-164">You can then create a topic using hello [CreateTopic](/dotnet/api/microsoft.servicebus.namespacemanager#Microsoft_ServiceBus_NamespaceManager_CreateTopic_System_String_) method.</span></span> <span data-ttu-id="cb145-165">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="cb145-165">For example:</span></span>

```csharp
TopicDescription dataCollectionTopic = namespaceClient.CreateTopic("DataCollectionTopic");
```

<span data-ttu-id="cb145-166">Em seguida, adicione assinaturas como desejado:</span><span class="sxs-lookup"><span data-stu-id="cb145-166">Next, add subscriptions as desired:</span></span>

```csharp
SubscriptionDescription myAgentSubscription = namespaceClient.CreateSubscription(myTopic.Path, "Inventory");
SubscriptionDescription myAuditSubscription = namespaceClient.CreateSubscription(myTopic.Path, "Dashboard");
```

<span data-ttu-id="cb145-167">Então, você poderá criar um cliente de tópico.</span><span class="sxs-lookup"><span data-stu-id="cb145-167">You can then create a topic client.</span></span> <span data-ttu-id="cb145-168">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="cb145-168">For example:</span></span>

```csharp
MessagingFactory factory = MessagingFactory.Create(serviceUri, tokenProvider);
TopicClient myTopicClient = factory.CreateTopicClient(myTopic.Path)
```

<span data-ttu-id="cb145-169">Usando o remetente da mensagem de saudação, você pode enviar e receber mensagens tooand do tópico hello, conforme mostrado na seção anterior hello.</span><span class="sxs-lookup"><span data-stu-id="cb145-169">Using hello message sender, you can send and receive messages tooand from hello topic, as shown in hello previous section.</span></span> <span data-ttu-id="cb145-170">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="cb145-170">For example:</span></span>

```csharp
foreach (BrokeredMessage message in messageList)
{
    myTopicClient.Send(message);
    Console.WriteLine(
    string.Format("Message sent: Id = {0}, Body = {1}", message.MessageId, message.GetBody<string>()));
}
```

<span data-ttu-id="cb145-171">Tooqueues semelhantes, as mensagens são recebidas de uma assinatura usando um [SubscriptionClient](/dotnet/api/microsoft.servicebus.messaging.subscriptionclient) do objeto, em vez de um [QueueClient](/dotnet/api/microsoft.servicebus.messaging.queueclient) objeto.</span><span class="sxs-lookup"><span data-stu-id="cb145-171">Similar tooqueues, messages are received from a subscription using a [SubscriptionClient](/dotnet/api/microsoft.servicebus.messaging.subscriptionclient) object instead of a [QueueClient](/dotnet/api/microsoft.servicebus.messaging.queueclient) object.</span></span> <span data-ttu-id="cb145-172">Criar o cliente de assinatura hello, passando o nome Olá Olá tópico, nome hello de assinatura Olá, e (opcionalmente) Olá modo de recebimento como parâmetros.</span><span class="sxs-lookup"><span data-stu-id="cb145-172">Create hello subscription client, passing hello name of hello topic, hello name of hello subscription, and (optionally) hello receive mode as parameters.</span></span> <span data-ttu-id="cb145-173">Por exemplo, com hello **inventário** assinatura:</span><span class="sxs-lookup"><span data-stu-id="cb145-173">For example, with hello **Inventory** subscription:</span></span>

```csharp
// Create hello subscription client
MessagingFactory factory = MessagingFactory.Create(serviceUri, tokenProvider); 

SubscriptionClient agentSubscriptionClient = factory.CreateSubscriptionClient("IssueTrackingTopic", "Inventory", ReceiveMode.PeekLock);
SubscriptionClient auditSubscriptionClient = factory.CreateSubscriptionClient("IssueTrackingTopic", "Dashboard", ReceiveMode.ReceiveAndDelete); 

while ((message = agentSubscriptionClient.Receive(TimeSpan.FromSeconds(5))) != null)
{
    Console.WriteLine("\nReceiving message from Inventory...");
    Console.WriteLine(string.Format("Message received: Id = {0}, Body = {1}", message.MessageId, message.GetBody<string>()));
    message.Complete();
}          

// Create a receiver using ReceiveAndDelete mode
while ((message = auditSubscriptionClient.Receive(TimeSpan.FromSeconds(5))) != null)
{
    Console.WriteLine("\nReceiving message from Dashboard...");
    Console.WriteLine(string.Format("Message received: Id = {0}, Body = {1}", message.MessageId, message.GetBody<string>()));
}
```

### <a name="rules-and-actions"></a><span data-ttu-id="cb145-174">Regras e ações</span><span class="sxs-lookup"><span data-stu-id="cb145-174">Rules and actions</span></span>
<span data-ttu-id="cb145-175">Em muitos cenários, as mensagens com características específicas precisam ser processadas de maneiras diferentes.</span><span class="sxs-lookup"><span data-stu-id="cb145-175">In many scenarios, messages that have specific characteristics must be processed in different ways.</span></span> <span data-ttu-id="cb145-176">tooenable isso, você pode configurar assinaturas toofind mensagens que tenham propriedades desejadas e, em seguida, executam determinadas propriedades de toothose modificações.</span><span class="sxs-lookup"><span data-stu-id="cb145-176">tooenable this, you can configure subscriptions toofind messages that have desired properties and then perform certain modifications toothose properties.</span></span> <span data-ttu-id="cb145-177">Enquanto as assinaturas do barramento de serviço vejam todas as mensagens enviadas toohello tópico, você só pode copiar um subconjunto da fila de assinatura virtual de toohello mensagens.</span><span class="sxs-lookup"><span data-stu-id="cb145-177">While Service Bus subscriptions see all messages sent toohello topic, you can only copy a subset of those messages toohello virtual subscription queue.</span></span> <span data-ttu-id="cb145-178">Isso é feito usando filtros de assinatura.</span><span class="sxs-lookup"><span data-stu-id="cb145-178">This is accomplished using subscription filters.</span></span> <span data-ttu-id="cb145-179">Tais modificações são chamadas de *ações de filtro*.</span><span class="sxs-lookup"><span data-stu-id="cb145-179">Such modifications are called *filter actions*.</span></span> <span data-ttu-id="cb145-180">Quando uma assinatura é criada, você pode fornecer uma expressão de filtro que opera nas propriedades de saudação de mensagem de saudação, ambos Olá propriedades do sistema (por exemplo, **rótulo**) e as propriedades de aplicativo personalizado (por exemplo, **StoreName**.) Olá expressão de filtro SQL é opcional, nesse caso; sem uma expressão de filtro SQL, qualquer ação de filtro definida em uma assinatura será executada em todas as mensagens de saudação para essa assinatura.</span><span class="sxs-lookup"><span data-stu-id="cb145-180">When a subscription is created, you can supply a filter expression that operates on hello properties of hello message, both hello system properties (for example, **Label**) and custom application properties (for example, **StoreName**.) hello SQL filter expression is optional in this case; without a SQL filter expression, any filter action defined on a subscription will be performed on all hello messages for that subscription.</span></span>

<span data-ttu-id="cb145-181">Usando o exemplo anterior de saudação, toofilter mensagens vindas apenas de **Store1**, você deve criar a assinatura do painel de saudação da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="cb145-181">Using hello previous example, toofilter messages coming only from **Store1**, you would create hello Dashboard subscription as follows:</span></span>

```csharp
namespaceManager.CreateSubscription("IssueTrackingTopic", "Dashboard", new SqlFilter("StoreName = 'Store1'"));
```

<span data-ttu-id="cb145-182">Com esse filtro de assinatura no local, somente as mensagens com hello `StoreName` propriedade definida muito`Store1` são copiados toohello fila virtual Olá `Dashboard` assinatura.</span><span class="sxs-lookup"><span data-stu-id="cb145-182">With this subscription filter in place, only messages that have hello `StoreName` property set too`Store1` are copied toohello virtual queue for hello `Dashboard` subscription.</span></span>

<span data-ttu-id="cb145-183">Para obter mais informações sobre possíveis valores de filtro, consulte documentação Olá Olá [SqlFilter](/dotnet/api/microsoft.servicebus.messaging.sqlfilter) e [SqlRuleAction](/dotnet/api/microsoft.servicebus.messaging.sqlruleaction) classes.</span><span class="sxs-lookup"><span data-stu-id="cb145-183">For more information about possible filter values, see hello documentation for hello [SqlFilter](/dotnet/api/microsoft.servicebus.messaging.sqlfilter) and [SqlRuleAction](/dotnet/api/microsoft.servicebus.messaging.sqlruleaction) classes.</span></span> <span data-ttu-id="cb145-184">Consulte também Olá [mensagens orientadas: filtros avançados](http://code.msdn.microsoft.com/Brokered-Messaging-6b0d2749) e [tópico filtros](https://github.com/Azure-Samples/azure-servicebus-messaging-samples/tree/master/TopicFilters) exemplos.</span><span class="sxs-lookup"><span data-stu-id="cb145-184">Also, see hello [Brokered Messaging: Advanced Filters](http://code.msdn.microsoft.com/Brokered-Messaging-6b0d2749) and [Topic Filters](https://github.com/Azure-Samples/azure-servicebus-messaging-samples/tree/master/TopicFilters) samples.</span></span>

## <a name="next-steps"></a><span data-ttu-id="cb145-185">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="cb145-185">Next steps</span></span>
<span data-ttu-id="cb145-186">Consulte a seguir Olá tópicos para obter mais informações e exemplos de como usar o barramento de serviço de mensagens avançados.</span><span class="sxs-lookup"><span data-stu-id="cb145-186">See hello following advanced topics for more information and examples of using Service Bus messaging.</span></span>

* [<span data-ttu-id="cb145-187">Visão geral de mensagens do Barramento de Serviço</span><span class="sxs-lookup"><span data-stu-id="cb145-187">Service Bus messaging overview</span></span>](service-bus-messaging-overview.md)
* [<span data-ttu-id="cb145-188">Tutorial do .NET do sistema de mensagens agenciado do Barramento de Serviço</span><span class="sxs-lookup"><span data-stu-id="cb145-188">Service Bus brokered messaging .NET tutorial</span></span>](service-bus-brokered-tutorial-dotnet.md)
* [<span data-ttu-id="cb145-189">Tutorial REST do sistema de mensagens agenciado do Barramento de Serviço</span><span class="sxs-lookup"><span data-stu-id="cb145-189">Service Bus brokered messaging REST tutorial</span></span>](service-bus-brokered-tutorial-rest.md)
* [<span data-ttu-id="cb145-190">Exemplo de filtros do tópico</span><span class="sxs-lookup"><span data-stu-id="cb145-190">Topic Filters sample </span></span>](https://github.com/Azure/azure-service-bus/tree/master/samples/DotNet/Microsoft.ServiceBus.Messaging/TopicFilters)
* [<span data-ttu-id="cb145-191">Sistema de mensagens agenciado: filtros avançados</span><span class="sxs-lookup"><span data-stu-id="cb145-191">Brokered Messaging: Advanced Filters sample</span></span>](http://code.msdn.microsoft.com/Brokered-Messaging-6b0d2749)

