---
title: "escala de aaaAutomatically nós de computação em um pool de lote do Azure | Microsoft Docs"
description: "Habilitar o dimensionamento automático em um toodynamically de pool de nuvem ajustar o número de saudação de nós de computação no pool de saudação."
services: batch
documentationcenter: 
author: tamram
manager: timlt
editor: tysonn
ms.assetid: c624cdfc-c5f2-4d13-a7d7-ae080833b779
ms.service: batch
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: multiple
ms.date: 06/20/2017
ms.author: tamram
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: b6d1e0c5d8e0e56e15a4d3588150f2466a689f19
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="create-an-automatic-scaling-formula-for-scaling-compute-nodes-in-a-batch-pool"></a><span data-ttu-id="e5796-103">Criar uma fórmula de dimensionamento automático para expandir nós de computação em um pool do Lote</span><span class="sxs-lookup"><span data-stu-id="e5796-103">Create an automatic scaling formula for scaling compute nodes in a Batch pool</span></span>

<span data-ttu-id="e5796-104">Lote do Azure pode escalar automaticamente os pools baseado nos parâmetros que você definir.</span><span class="sxs-lookup"><span data-stu-id="e5796-104">Azure Batch can automatically scale pools based on parameters that you define.</span></span> <span data-ttu-id="e5796-105">Com o dimensionamento automático, lote adiciona dinamicamente pool tooa de nós como aumento de demandas de tarefa e remove nós de computação conforme eles diminuem.</span><span class="sxs-lookup"><span data-stu-id="e5796-105">With automatic scaling, Batch dynamically adds nodes tooa pool as task demands increase, and removes compute nodes as they decrease.</span></span> <span data-ttu-id="e5796-106">Você pode poupar tempo e dinheiro ajustar automaticamente o número de saudação de nós de computação usados pelo seu aplicativo de lote.</span><span class="sxs-lookup"><span data-stu-id="e5796-106">You can save both time and money by automatically adjusting hello number of compute nodes used by your Batch application.</span></span> 

<span data-ttu-id="e5796-107">Você habilita o dimensionamento automático em um pool de nós de computação, associando a ele uma *fórmula de dimensionamento automático* definida por você.</span><span class="sxs-lookup"><span data-stu-id="e5796-107">You enable automatic scaling on a pool of compute nodes by associating with it an *autoscale formula* that you define.</span></span> <span data-ttu-id="e5796-108">Olá serviço de lote usa Olá AutoEscala toodetermine fórmula Olá quantos nós de computação que são necessária tooexecute sua carga de trabalho.</span><span class="sxs-lookup"><span data-stu-id="e5796-108">hello Batch service uses hello autoscale formula toodetermine hello number of compute nodes that are needed tooexecute your workload.</span></span> <span data-ttu-id="e5796-109">Os nós de computação podem ser nós dedicados ou [nós de baixa prioridade](batch-low-pri-vms.md).</span><span class="sxs-lookup"><span data-stu-id="e5796-109">Compute nodes may be dedicated nodes or [low-priority nodes](batch-low-pri-vms.md).</span></span> <span data-ttu-id="e5796-110">Lote responde tooservice dados de métricas coletadas periodicamente.</span><span class="sxs-lookup"><span data-stu-id="e5796-110">Batch responds tooservice metrics data that is collected periodically.</span></span> <span data-ttu-id="e5796-111">Usando esses dados de métricas, lote ajusta o número de saudação de nós de computação no pool de saudação com base em sua fórmula e em um intervalo configurável.</span><span class="sxs-lookup"><span data-stu-id="e5796-111">Using this metrics data, Batch adjusts hello number of compute nodes in hello pool based on your formula and at a configurable interval.</span></span>

<span data-ttu-id="e5796-112">É possível habilitar a escala automática quando um pool é criado ou em um pool existente.</span><span class="sxs-lookup"><span data-stu-id="e5796-112">You can enable automatic scaling either when a pool is created, or on an existing pool.</span></span> <span data-ttu-id="e5796-113">Além disso, você pode alterar uma fórmula existente em um pool configurado para dimensionamento automático.</span><span class="sxs-lookup"><span data-stu-id="e5796-113">You can also change an existing formula on a pool that is configured for autoscaling.</span></span> <span data-ttu-id="e5796-114">Lote permite que você tooevaluate suas fórmulas antes de atribuí-los toopools e toomonitor status Olá de dimensionamento automático é executado.</span><span class="sxs-lookup"><span data-stu-id="e5796-114">Batch enables you tooevaluate your formulas before assigning them toopools and toomonitor hello status of automatic scaling runs.</span></span>

<span data-ttu-id="e5796-115">Este artigo aborda Olá várias entidades que compõem as fórmulas de dimensionamento automático, incluindo variáveis, operações, funções e operadores.</span><span class="sxs-lookup"><span data-stu-id="e5796-115">This article discusses hello various entities that make up your autoscale formulas, including variables, operators, operations, and functions.</span></span> <span data-ttu-id="e5796-116">Discutiremos como tooobtain várias métricas de recursos e tarefas em lote de computação.</span><span class="sxs-lookup"><span data-stu-id="e5796-116">We discuss how tooobtain various compute resource and task metrics within Batch.</span></span> <span data-ttu-id="e5796-117">Você pode usar esses tooadjust métricas contagem de nós do pool com base no status de tarefa e uso de recursos.</span><span class="sxs-lookup"><span data-stu-id="e5796-117">You can use these metrics tooadjust your pool's node count based on resource usage and task status.</span></span> <span data-ttu-id="e5796-118">Em seguida, descreveremos como tooconstruct uma fórmula e habilitação automáticas de escala em um pool usando Olá restante do lote e APIs .NET.</span><span class="sxs-lookup"><span data-stu-id="e5796-118">We then describe how tooconstruct a formula and enable automatic scaling on a pool by using both hello Batch REST and .NET APIs.</span></span> <span data-ttu-id="e5796-119">Finalmente, concluímos utilizando algumas fórmulas de exemplo.</span><span class="sxs-lookup"><span data-stu-id="e5796-119">Finally, we finish up with a few example formulas.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="e5796-120">Quando você criar uma conta de lote, você pode especificar Olá [configuração de conta](batch-api-basics.md#account), que determina se os pools são alocados em uma assinatura de serviço de lote (padrão de saudação) ou em sua assinatura do usuário.</span><span class="sxs-lookup"><span data-stu-id="e5796-120">When you create a Batch account, you can specify hello [account configuration](batch-api-basics.md#account), which determines whether pools are allocated in a Batch service subscription (hello default), or in your user subscription.</span></span> <span data-ttu-id="e5796-121">Se você criou sua conta em lotes com a configuração de serviço de lote padrão hello, sua conta está tooa limita o número máximo de núcleos que podem ser usados para processamento.</span><span class="sxs-lookup"><span data-stu-id="e5796-121">If you created your Batch account with hello default Batch Service configuration, then your account is limited tooa maximum number of cores that can be used for processing.</span></span> <span data-ttu-id="e5796-122">Olá serviço de lote dimensiona os nós de computação somente o limite de núcleo toothat.</span><span class="sxs-lookup"><span data-stu-id="e5796-122">hello Batch service scales compute nodes only up toothat core limit.</span></span> <span data-ttu-id="e5796-123">Por esse motivo, Olá serviço de lote pode não alcançar o número de destino de saudação de nós de computação especificado por uma fórmula de dimensionamento automático.</span><span class="sxs-lookup"><span data-stu-id="e5796-123">For this reason, hello Batch service may not reach hello target number of compute nodes specified by an autoscale formula.</span></span> <span data-ttu-id="e5796-124">Consulte [cotas e limites de saudação do serviço Azure Batch](batch-quota-limit.md) para obter informações sobre como exibir e aumentar as cotas de conta.</span><span class="sxs-lookup"><span data-stu-id="e5796-124">See [Quotas and limits for hello Azure Batch service](batch-quota-limit.md) for information on viewing and increasing your account quotas.</span></span>
>
><span data-ttu-id="e5796-125">Se você criou sua conta com a configuração de assinatura de usuário hello, sua conta compartilha na cota de núcleos Olá para assinatura de saudação.</span><span class="sxs-lookup"><span data-stu-id="e5796-125">If you created your account with hello User Subscription configuration, then your account shares in hello core quota for hello subscription.</span></span> <span data-ttu-id="e5796-126">Para saber mais, confira[Limites das Máquinas Virtuais](../azure-subscription-service-limits.md#virtual-machines-limits) e [Assinatura e limites de serviço, cotas e restrições do Azure](../azure-subscription-service-limits.md).</span><span class="sxs-lookup"><span data-stu-id="e5796-126">For more information, see [Virtual Machines limits](../azure-subscription-service-limits.md#virtual-machines-limits) in [Azure subscription and service limits, quotas, and constraints](../azure-subscription-service-limits.md).</span></span>
>
>

## <a name="automatic-scaling-formulas"></a><span data-ttu-id="e5796-127">Fórmulas de dimensionamento automático</span><span class="sxs-lookup"><span data-stu-id="e5796-127">Automatic scaling formulas</span></span>
<span data-ttu-id="e5796-128">Uma fórmula de dimensionamento automático é um valor de cadeia de caracteres que você definir e que contém uma ou mais instruções.</span><span class="sxs-lookup"><span data-stu-id="e5796-128">An automatic scaling formula is a string value that you define that contains one or more statements.</span></span> <span data-ttu-id="e5796-129">fórmula de dimensionamento automático Olá é atribuída do pool de tooa [autoScaleFormula] [ rest_autoscaleformula] elemento (lote REST) ou [CloudPool.AutoScaleFormula] [ net_cloudpool_autoscaleformula] propriedade (lote .NET).</span><span class="sxs-lookup"><span data-stu-id="e5796-129">hello autoscale formula is assigned tooa pool's [autoScaleFormula][rest_autoscaleformula] element (Batch REST) or [CloudPool.AutoScaleFormula][net_cloudpool_autoscaleformula] property (Batch .NET).</span></span> <span data-ttu-id="e5796-130">Olá serviço de lote usa o número de destino Olá toodetermine fórmulas de nós de computação no pool de saudação para o próximo intervalo de saudação do processamento.</span><span class="sxs-lookup"><span data-stu-id="e5796-130">hello Batch service uses your formula toodetermine hello target number of compute nodes in hello pool for hello next interval of processing.</span></span> <span data-ttu-id="e5796-131">cadeia de caracteres fórmula Olá não pode exceder 8 KB, pode incluir a instruções de too100 que são separadas por ponto e vírgula e podem incluir quebras de linha e comentários.</span><span class="sxs-lookup"><span data-stu-id="e5796-131">hello formula string cannot exceed 8 KB, can include up too100 statements that are separated by semicolons, and can include line breaks and comments.</span></span>

<span data-ttu-id="e5796-132">Você pode pensar em fórmulas de dimensionamento automático como uma "linguagem" de autoescala do Lote.</span><span class="sxs-lookup"><span data-stu-id="e5796-132">You can think of automatic scaling formulas as a Batch autoscale "language."</span></span> <span data-ttu-id="e5796-133">Instruções de fórmulas são expressões de forma livre que podem incluir variáveis definidas pelo serviço (variáveis definidas pelo serviço de lote de saudação) e variáveis definidas pelo usuário (variáveis que você definir).</span><span class="sxs-lookup"><span data-stu-id="e5796-133">Formula statements are free-formed expressions that can include both service-defined variables (variables defined by hello Batch service) and user-defined variables (variables that you define).</span></span> <span data-ttu-id="e5796-134">Eles podem executar várias operações com esses valores usando tipos, operadores e funções internas.</span><span class="sxs-lookup"><span data-stu-id="e5796-134">They can perform various operations on these values by using built-in types, operators, and functions.</span></span> <span data-ttu-id="e5796-135">Por exemplo, uma instrução pode levar Olá formulário a seguir:</span><span class="sxs-lookup"><span data-stu-id="e5796-135">For example, a statement might take hello following form:</span></span>

```
$myNewVariable = function($ServiceDefinedVariable, $myCustomVariable);
```

<span data-ttu-id="e5796-136">Geralmente, as fórmulas contêm várias instruções que executam operações nos valores que são obtidos nas instruções anteriores.</span><span class="sxs-lookup"><span data-stu-id="e5796-136">Formulas generally contain multiple statements that perform operations on values that are obtained in previous statements.</span></span> <span data-ttu-id="e5796-137">Por exemplo, primeiro obtemos um valor para `variable1`, em seguida, passe tooa função toopopulate `variable2`:</span><span class="sxs-lookup"><span data-stu-id="e5796-137">For example, first we obtain a value for `variable1`, then pass it tooa function toopopulate `variable2`:</span></span>

```
$variable1 = function1($ServiceDefinedVariable);
$variable2 = function2($OtherServiceDefinedVariable, $variable1);
```

<span data-ttu-id="e5796-138">Inclua essas instruções em seu tooarrive de fórmula de dimensionamento automático em um número de nós de computação de destino.</span><span class="sxs-lookup"><span data-stu-id="e5796-138">Include these statements in your autoscale formula tooarrive at a target number of compute nodes.</span></span> <span data-ttu-id="e5796-139">Nós dedicados e nós de baixa prioridade possuem cada um suas próprias configurações de destino, de modo que você pode definir um destino para cada tipo de nó.</span><span class="sxs-lookup"><span data-stu-id="e5796-139">Dedicated nodes and low-priority nodes each have their own target settings, so that you can define a target for each type of node.</span></span> <span data-ttu-id="e5796-140">Uma fórmula de autoescala pode incluir um valor de destino para nós dedicados, um valor de destino para nós de baixa prioridade ou ambos.</span><span class="sxs-lookup"><span data-stu-id="e5796-140">An autoscale formula can include a target value for dedicated nodes, a target value for low-priority nodes, or both.</span></span>

<span data-ttu-id="e5796-141">número de destino de saudação de nós pode ser superior, inferior ou Olá mesmo que o número atual de nós desse tipo no pool de saudação do hello.</span><span class="sxs-lookup"><span data-stu-id="e5796-141">hello target number of nodes may be higher, lower, or hello same as hello current number of nodes of that type in hello pool.</span></span> <span data-ttu-id="e5796-142">O Lote avalia a fórmula de autoescala de um pool em um intervalo específico (consulte [intervalos de dimensionamento automático](#automatic-scaling-interval)).</span><span class="sxs-lookup"><span data-stu-id="e5796-142">Batch evaluates a pool's autoscale formula at a specific interval (see [automatic scaling intervals](#automatic-scaling-interval)).</span></span> <span data-ttu-id="e5796-143">Lote ajusta o número de destino de saudação de cada tipo de nó no número de toohello de pool Olá que especifica a fórmula de dimensionamento automático no tempo de saudação da avaliação.</span><span class="sxs-lookup"><span data-stu-id="e5796-143">Batch adjusts hello target number of each type of node in hello pool toohello number that your autoscale formula specifies at hello time of evaluation.</span></span>

### <a name="sample-autoscale-formula"></a><span data-ttu-id="e5796-144">Fórmula de dimensionamento automático de exemplo</span><span class="sxs-lookup"><span data-stu-id="e5796-144">Sample autoscale formula</span></span>

<span data-ttu-id="e5796-145">Aqui está um exemplo de uma fórmula de dimensionamento automático que pode ser ajustada toowork na maioria dos cenários.</span><span class="sxs-lookup"><span data-stu-id="e5796-145">Here is an example of an autoscale formula that can be adjusted toowork for most scenarios.</span></span> <span data-ttu-id="e5796-146">Olá variáveis `startingNumberOfVMs` e `maxNumberofVMs` em Olá fórmula de exemplo pode ser ajustada tooyour necessidades.</span><span class="sxs-lookup"><span data-stu-id="e5796-146">hello variables `startingNumberOfVMs` and `maxNumberofVMs` in hello example formula can be adjusted tooyour needs.</span></span> <span data-ttu-id="e5796-147">Esta fórmula dimensiona nós dedicado, mas pode ser modificado tooapply tooscale também nós de baixa prioridade.</span><span class="sxs-lookup"><span data-stu-id="e5796-147">This formula scales dedicated nodes, but can be modified tooapply tooscale low-priority nodes as well.</span></span> 

```
startingNumberOfVMs = 1;
maxNumberofVMs = 25;
pendingTaskSamplePercent = $PendingTasks.GetSamplePercent(180 * TimeInterval_Second);
pendingTaskSamples = pendingTaskSamplePercent < 70 ? startingNumberOfVMs : avg($PendingTasks.GetSample(180 * TimeInterval_Second));
$TargetDedicatedNodes=min(maxNumberofVMs, pendingTaskSamples);
```

<span data-ttu-id="e5796-148">Com esta fórmula de dimensionamento automático, o pool de saudação é criado inicialmente com uma única VM.</span><span class="sxs-lookup"><span data-stu-id="e5796-148">With this autoscale formula, hello pool is initially created with a single VM.</span></span> <span data-ttu-id="e5796-149">Olá `$PendingTasks` métrica define o número de saudação de tarefas que estão em execução ou na fila.</span><span class="sxs-lookup"><span data-stu-id="e5796-149">hello `$PendingTasks` metric defines hello number of tasks that are running or queued.</span></span> <span data-ttu-id="e5796-150">fórmula de saudação localiza Olá média de tarefas pendentes no hello Últimos 180 segundos e define Olá `$TargetDedicatedNodes` variável adequadamente.</span><span class="sxs-lookup"><span data-stu-id="e5796-150">hello formula finds hello average number of pending tasks in hello last 180 seconds and sets hello `$TargetDedicatedNodes` variable accordingly.</span></span> <span data-ttu-id="e5796-151">fórmula de saudação garante que o número de destino de saudação de nós dedicado nunca excede 25 VMs.</span><span class="sxs-lookup"><span data-stu-id="e5796-151">hello formula ensures that hello target number of dedicated nodes never exceeds 25 VMs.</span></span> <span data-ttu-id="e5796-152">Conforme novas tarefas forem enviadas, o pool de saudação cresce automaticamente.</span><span class="sxs-lookup"><span data-stu-id="e5796-152">As new tasks are submitted, hello pool automatically grows.</span></span> <span data-ttu-id="e5796-153">Como conclusão de tarefas, as VMs se tornam livre uma e fórmula de dimensionamento automático Olá diminui pool hello.</span><span class="sxs-lookup"><span data-stu-id="e5796-153">As tasks complete, VMs become free one by one and hello autoscaling formula shrinks hello pool.</span></span>

## <a name="variables"></a><span data-ttu-id="e5796-154">variáveis</span><span class="sxs-lookup"><span data-stu-id="e5796-154">Variables</span></span>
<span data-ttu-id="e5796-155">Você pode usar as variáveis **definidas pelo serviço** e **definidas pelo usuário** em suas fórmulas de dimensionamento automático.</span><span class="sxs-lookup"><span data-stu-id="e5796-155">You can use both **service-defined** and **user-defined** variables in your autoscale formulas.</span></span> <span data-ttu-id="e5796-156">as variáveis definidas pelo serviço Olá baseiam-se no serviço de lote de toohello.</span><span class="sxs-lookup"><span data-stu-id="e5796-156">hello service-defined variables are built in toohello Batch service.</span></span> <span data-ttu-id="e5796-157">Algumas variáveis definidas pelo serviço são de leitura e gravação e algumas são somente leitura.</span><span class="sxs-lookup"><span data-stu-id="e5796-157">Some service-defined variables are read-write, and some are read-only.</span></span> <span data-ttu-id="e5796-158">Variáveis definidas pelo usuário são as variáveis que você definir.</span><span class="sxs-lookup"><span data-stu-id="e5796-158">User-defined variables are variables that you define.</span></span> <span data-ttu-id="e5796-159">Fórmula de exemplo hello mostrado na seção anterior do hello, `$TargetDedicatedNodes` e `$PendingTasks` são variáveis definidas pelo serviço.</span><span class="sxs-lookup"><span data-stu-id="e5796-159">In hello example formula shown in hello previous section, `$TargetDedicatedNodes` and `$PendingTasks` are service-defined variables.</span></span> <span data-ttu-id="e5796-160">As variáveis de `startingNumberOfVMs` e `maxNumberofVMs` são variáveis definidas pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="e5796-160">Variables `startingNumberOfVMs` and `maxNumberofVMs` are user-defined variables.</span></span>

> [!NOTE]
> <span data-ttu-id="e5796-161">As variáveis definidas pelo serviço sempre são precedidas de um sinal de dólar ($).</span><span class="sxs-lookup"><span data-stu-id="e5796-161">Service-defined variables are always preceded by a dollar sign ($).</span></span> <span data-ttu-id="e5796-162">Para variáveis definidas pelo usuário, Olá cifrão é opcional.</span><span class="sxs-lookup"><span data-stu-id="e5796-162">For user-defined variables, hello dollar sign is optional.</span></span>
>
>

<span data-ttu-id="e5796-163">Olá tabelas a seguir mostra as de leitura-gravação e Olá de variáveis somente leitura que são definidas pelo serviço de lote.</span><span class="sxs-lookup"><span data-stu-id="e5796-163">hello following tables show both read-write and read-only variables that are defined by hello Batch service.</span></span>

<span data-ttu-id="e5796-164">Você pode obter e definir valores de saudação dessas variáveis definidas pelo serviço de número de saudação toomanage de nós de computação em um pool de:</span><span class="sxs-lookup"><span data-stu-id="e5796-164">You can get and set hello values of these service-defined variables toomanage hello number of compute nodes in a pool:</span></span>

| <span data-ttu-id="e5796-165">Variáveis definidas pelo serviço de leitura/gravação</span><span class="sxs-lookup"><span data-stu-id="e5796-165">Read-write service-defined variables</span></span> | <span data-ttu-id="e5796-166">Descrição</span><span class="sxs-lookup"><span data-stu-id="e5796-166">Description</span></span> |
| --- | --- |
| <span data-ttu-id="e5796-167">$TargetDedicatedNodes</span><span class="sxs-lookup"><span data-stu-id="e5796-167">$TargetDedicatedNodes</span></span> |<span data-ttu-id="e5796-168">número de destino de saudação de dedicado nós para o pool de saudação de computação.</span><span class="sxs-lookup"><span data-stu-id="e5796-168">hello target number of dedicated compute nodes for hello pool.</span></span> <span data-ttu-id="e5796-169">número de saudação de nós dedicado é especificado como um destino porque um pool não pode obter sempre número desejado de saudação de nós.</span><span class="sxs-lookup"><span data-stu-id="e5796-169">hello number of dedicated nodes is specified as a target because a pool may not always achieve hello desired number of nodes.</span></span> <span data-ttu-id="e5796-170">Por exemplo, se o número de destino de saudação de nós dedicado é modificado por uma avaliação de dimensionamento automático antes de saudação pool tiver atingido o destino de saudação inicial e pool Olá pode não alcançar o destino de saudação.</span><span class="sxs-lookup"><span data-stu-id="e5796-170">For example, if hello target number of dedicated nodes is modified by an autoscale evaluation before hello pool has reached hello initial target, then hello pool may not reach hello target.</span></span> <br /><br /> <span data-ttu-id="e5796-171">Um pool em uma conta criada com a configuração de serviço de lote de saudação não pode atingir seu destino se o destino de saudação exceder uma cota de nó ou núcleos de conta do lote.</span><span class="sxs-lookup"><span data-stu-id="e5796-171">A pool in an account created with hello Batch Service configuration may not achieve its target if hello target exceeds a Batch account node or core quota.</span></span> <span data-ttu-id="e5796-172">Um pool em uma conta criada com a configuração de assinatura de usuário de saudação não pode obter seu destino se o destino Olá excede a cota de núcleo compartilhado Olá para assinatura de saudação.</span><span class="sxs-lookup"><span data-stu-id="e5796-172">A pool in an account created with hello User Subscription configuration may not achieve its target if hello target exceeds hello shared core quota for hello subscription.</span></span>|
| <span data-ttu-id="e5796-173">$TargetLowPriorityNodes</span><span class="sxs-lookup"><span data-stu-id="e5796-173">$TargetLowPriorityNodes</span></span> |<span data-ttu-id="e5796-174">nós para o pool de saudação de computação do número de destino de saudação de baixa prioridade.</span><span class="sxs-lookup"><span data-stu-id="e5796-174">hello target number of low-priority compute nodes for hello pool.</span></span> <span data-ttu-id="e5796-175">número de saudação de nós de baixa prioridade é especificado como um destino porque um pool não pode obter sempre número desejado de saudação de nós.</span><span class="sxs-lookup"><span data-stu-id="e5796-175">hello number of low-priority nodes is specified as a target because a pool may not always achieve hello desired number of nodes.</span></span> <span data-ttu-id="e5796-176">Por exemplo, se o número de destino de saudação de nós de baixa prioridade é modificado por uma avaliação de dimensionamento automático antes de saudação pool tiver atingido o destino de saudação inicial e pool Olá pode não alcançar o destino de saudação.</span><span class="sxs-lookup"><span data-stu-id="e5796-176">For example, if hello target number of low-priority nodes is modified by an autoscale evaluation before hello pool has reached hello initial target, then hello pool may not reach hello target.</span></span> <span data-ttu-id="e5796-177">Um pool pode também obter seu destino não se destino Olá exceder uma cota de nó ou núcleos de conta do lote.</span><span class="sxs-lookup"><span data-stu-id="e5796-177">A pool may also not achieve its target if hello target exceeds a Batch account node or core quota.</span></span> <br /><br /> <span data-ttu-id="e5796-178">Para obter mais informações sobre nós de computação de baixa prioridade, consulte [Usar VMs de baixa prioridade com o Lote (versão prévia)](batch-low-pri-vms.md).</span><span class="sxs-lookup"><span data-stu-id="e5796-178">For more information on low-priority compute nodes, see [Use low-priority VMs with Batch (Preview)](batch-low-pri-vms.md).</span></span> |
| <span data-ttu-id="e5796-179">$NodeDeallocationOption</span><span class="sxs-lookup"><span data-stu-id="e5796-179">$NodeDeallocationOption</span></span> |<span data-ttu-id="e5796-180">ação de saudação que ocorre quando nós de computação são removidos de um pool.</span><span class="sxs-lookup"><span data-stu-id="e5796-180">hello action that occurs when compute nodes are removed from a pool.</span></span> <span data-ttu-id="e5796-181">Os valores possíveis são:</span><span class="sxs-lookup"><span data-stu-id="e5796-181">Possible values are:</span></span><ul><li><span data-ttu-id="e5796-182">**enfileiramento**– finaliza as tarefas imediatamente e as coloca novamente na fila de trabalho Olá para que elas sejam reagendadas.</span><span class="sxs-lookup"><span data-stu-id="e5796-182">**requeue**--Terminates tasks immediately and puts them back on hello job queue so that they are rescheduled.</span></span><li><span data-ttu-id="e5796-183">**encerrar**– finaliza as tarefas imediatamente e as remove da fila de trabalho hello.</span><span class="sxs-lookup"><span data-stu-id="e5796-183">**terminate**--Terminates tasks immediately and removes them from hello job queue.</span></span><li><span data-ttu-id="e5796-184">**taskcompletion**– aguarda para em execução no momento toofinish as tarefas e, em seguida, remove o nó de saudação do pool de saudação.</span><span class="sxs-lookup"><span data-stu-id="e5796-184">**taskcompletion**--Waits for currently running tasks toofinish and then removes hello node from hello pool.</span></span><li><span data-ttu-id="e5796-185">**retaineddata**– aguarda todos Olá retidos de tarefa dados locais em Olá nó toobe limpos antes de remover o nó de saudação do pool de saudação.</span><span class="sxs-lookup"><span data-stu-id="e5796-185">**retaineddata**--Waits for all hello local task-retained data on hello node toobe cleaned up before removing hello node from hello pool.</span></span></ul> |

<span data-ttu-id="e5796-186">Você pode obter o valor de saudação esses ajustes toomake variáveis definidas pelo serviço com base nas métricas de serviço de lote hello:</span><span class="sxs-lookup"><span data-stu-id="e5796-186">You can get hello value of these service-defined variables toomake adjustments that are based on metrics from hello Batch service:</span></span>

| <span data-ttu-id="e5796-187">Variáveis somente leitura definidas pelo serviço</span><span class="sxs-lookup"><span data-stu-id="e5796-187">Read-only service-defined variables</span></span> | <span data-ttu-id="e5796-188">Descrição</span><span class="sxs-lookup"><span data-stu-id="e5796-188">Description</span></span> |
| --- | --- |
| <span data-ttu-id="e5796-189">$CPUPercent</span><span class="sxs-lookup"><span data-stu-id="e5796-189">$CPUPercent</span></span> |<span data-ttu-id="e5796-190">porcentagem média de saudação do uso de CPU.</span><span class="sxs-lookup"><span data-stu-id="e5796-190">hello average percentage of CPU usage.</span></span> |
| <span data-ttu-id="e5796-191">$WallClockSeconds</span><span class="sxs-lookup"><span data-stu-id="e5796-191">$WallClockSeconds</span></span> |<span data-ttu-id="e5796-192">Olá quantos segundos consumidos.</span><span class="sxs-lookup"><span data-stu-id="e5796-192">hello number of seconds consumed.</span></span> |
| <span data-ttu-id="e5796-193">$MemoryBytes</span><span class="sxs-lookup"><span data-stu-id="e5796-193">$MemoryBytes</span></span> |<span data-ttu-id="e5796-194">número médio de saudação de megabytes usados.</span><span class="sxs-lookup"><span data-stu-id="e5796-194">hello average number of megabytes used.</span></span> |
| <span data-ttu-id="e5796-195">$DiskBytes</span><span class="sxs-lookup"><span data-stu-id="e5796-195">$DiskBytes</span></span> |<span data-ttu-id="e5796-196">número médio de saudação de gigabytes usados em discos locais hello.</span><span class="sxs-lookup"><span data-stu-id="e5796-196">hello average number of gigabytes used on hello local disks.</span></span> |
| <span data-ttu-id="e5796-197">$DiskReadBytes</span><span class="sxs-lookup"><span data-stu-id="e5796-197">$DiskReadBytes</span></span> |<span data-ttu-id="e5796-198">número de saudação de bytes lidos.</span><span class="sxs-lookup"><span data-stu-id="e5796-198">hello number of bytes read.</span></span> |
| <span data-ttu-id="e5796-199">$DiskWriteBytes</span><span class="sxs-lookup"><span data-stu-id="e5796-199">$DiskWriteBytes</span></span> |<span data-ttu-id="e5796-200">número de saudação de bytes gravados.</span><span class="sxs-lookup"><span data-stu-id="e5796-200">hello number of bytes written.</span></span> |
| <span data-ttu-id="e5796-201">$DiskReadOps</span><span class="sxs-lookup"><span data-stu-id="e5796-201">$DiskReadOps</span></span> |<span data-ttu-id="e5796-202">Contagem de saudação de operações de leitura de disco é executada.</span><span class="sxs-lookup"><span data-stu-id="e5796-202">hello count of read disk operations performed.</span></span> |
| <span data-ttu-id="e5796-203">$DiskWriteOps</span><span class="sxs-lookup"><span data-stu-id="e5796-203">$DiskWriteOps</span></span> |<span data-ttu-id="e5796-204">Contagem de saudação de operações de gravação de disco executadas.</span><span class="sxs-lookup"><span data-stu-id="e5796-204">hello count of write disk operations performed.</span></span> |
| <span data-ttu-id="e5796-205">$NetworkInBytes</span><span class="sxs-lookup"><span data-stu-id="e5796-205">$NetworkInBytes</span></span> |<span data-ttu-id="e5796-206">número de saudação de bytes de entrada.</span><span class="sxs-lookup"><span data-stu-id="e5796-206">hello number of inbound bytes.</span></span> |
| <span data-ttu-id="e5796-207">$NetworkOutBytes</span><span class="sxs-lookup"><span data-stu-id="e5796-207">$NetworkOutBytes</span></span> |<span data-ttu-id="e5796-208">número de saudação de bytes de saída.</span><span class="sxs-lookup"><span data-stu-id="e5796-208">hello number of outbound bytes.</span></span> |
| <span data-ttu-id="e5796-209">$SampleNodeCount</span><span class="sxs-lookup"><span data-stu-id="e5796-209">$SampleNodeCount</span></span> |<span data-ttu-id="e5796-210">Contagem de saudação de nós de computação.</span><span class="sxs-lookup"><span data-stu-id="e5796-210">hello count of compute nodes.</span></span> |
| <span data-ttu-id="e5796-211">$ActiveTasks</span><span class="sxs-lookup"><span data-stu-id="e5796-211">$ActiveTasks</span></span> |<span data-ttu-id="e5796-212">número de saudação de tarefas tooexecute pronto, mas ainda não está executando.</span><span class="sxs-lookup"><span data-stu-id="e5796-212">hello number of tasks that are ready tooexecute but are not yet executing.</span></span> <span data-ttu-id="e5796-213">Contagem de saudação $ActiveTasks inclui todas as tarefas que estão em estado ativo hello e cujas dependências foram atendidas.</span><span class="sxs-lookup"><span data-stu-id="e5796-213">hello $ActiveTasks count includes all tasks that are in hello active state and whose dependencies have been satisfied.</span></span> <span data-ttu-id="e5796-214">As tarefas que estão no estado ativo Olá mas cujas dependências não foram satisfeitas são excluídas da contagem de saudação $ActiveTasks.</span><span class="sxs-lookup"><span data-stu-id="e5796-214">Any tasks that are in hello active state but whose dependencies have not been satisfied are excluded from hello $ActiveTasks count.</span></span>|
| <span data-ttu-id="e5796-215">$RunningTasks</span><span class="sxs-lookup"><span data-stu-id="e5796-215">$RunningTasks</span></span> |<span data-ttu-id="e5796-216">número de saudação de tarefas em um estado de execução.</span><span class="sxs-lookup"><span data-stu-id="e5796-216">hello number of tasks in a running state.</span></span> |
| <span data-ttu-id="e5796-217">$PendingTasks</span><span class="sxs-lookup"><span data-stu-id="e5796-217">$PendingTasks</span></span> |<span data-ttu-id="e5796-218">soma de saudação do $ActiveTasks e $RunningTasks.</span><span class="sxs-lookup"><span data-stu-id="e5796-218">hello sum of $ActiveTasks and $RunningTasks.</span></span> |
| <span data-ttu-id="e5796-219">$SucceededTasks</span><span class="sxs-lookup"><span data-stu-id="e5796-219">$SucceededTasks</span></span> |<span data-ttu-id="e5796-220">número de saudação de tarefas que foram concluídas com êxito.</span><span class="sxs-lookup"><span data-stu-id="e5796-220">hello number of tasks that finished successfully.</span></span> |
| <span data-ttu-id="e5796-221">$FailedTasks</span><span class="sxs-lookup"><span data-stu-id="e5796-221">$FailedTasks</span></span> |<span data-ttu-id="e5796-222">número de saudação de tarefas que falharam.</span><span class="sxs-lookup"><span data-stu-id="e5796-222">hello number of tasks that failed.</span></span> |
| <span data-ttu-id="e5796-223">$CurrentDedicatedNodes</span><span class="sxs-lookup"><span data-stu-id="e5796-223">$CurrentDedicatedNodes</span></span> |<span data-ttu-id="e5796-224">número atual de saudação do dedicado de nós de computação.</span><span class="sxs-lookup"><span data-stu-id="e5796-224">hello current number of dedicated compute nodes.</span></span> |
| <span data-ttu-id="e5796-225">$CurrentLowPriorityNodes</span><span class="sxs-lookup"><span data-stu-id="e5796-225">$CurrentLowPriorityNodes</span></span> |<span data-ttu-id="e5796-226">número atual de saudação de baixa prioridade nós, incluindo todos os nós que foram antecipados de computação.</span><span class="sxs-lookup"><span data-stu-id="e5796-226">hello current number of low-priority compute nodes, including any nodes that have been pre-empted.</span></span> |
| <span data-ttu-id="e5796-227">$PreemptedNodeCount</span><span class="sxs-lookup"><span data-stu-id="e5796-227">$PreemptedNodeCount</span></span> | <span data-ttu-id="e5796-228">número de saudação de nós no pool de saudação que estão em um estado antecipado.</span><span class="sxs-lookup"><span data-stu-id="e5796-228">hello number of nodes in hello pool that are in a pre-empted state.</span></span> |

> [!TIP]
> <span data-ttu-id="e5796-229">Olá variáveis somente leitura, definição de serviço que são mostradas na tabela anterior Olá são *objetos* que fornecem vários métodos tooaccess dados associados a cada.</span><span class="sxs-lookup"><span data-stu-id="e5796-229">hello read-only, service-defined variables that are shown in hello previous table are *objects* that provide various methods tooaccess data associated with each.</span></span> <span data-ttu-id="e5796-230">Para obter mais informações, consulte [Obter amostras de dados](#getsampledata) a seguir neste artigo.</span><span class="sxs-lookup"><span data-stu-id="e5796-230">For more information, see [Obtain sample data](#getsampledata) later in this article.</span></span>
>
>

## <a name="types"></a><span data-ttu-id="e5796-231">Tipos</span><span class="sxs-lookup"><span data-stu-id="e5796-231">Types</span></span>
<span data-ttu-id="e5796-232">Esses tipos têm suporte em uma fórmula:</span><span class="sxs-lookup"><span data-stu-id="e5796-232">These types are supported in a formula:</span></span>

* <span data-ttu-id="e5796-233">double</span><span class="sxs-lookup"><span data-stu-id="e5796-233">double</span></span>
* <span data-ttu-id="e5796-234">doubleVec</span><span class="sxs-lookup"><span data-stu-id="e5796-234">doubleVec</span></span>
* <span data-ttu-id="e5796-235">doubleVecList</span><span class="sxs-lookup"><span data-stu-id="e5796-235">doubleVecList</span></span>
* <span data-ttu-id="e5796-236">string</span><span class="sxs-lookup"><span data-stu-id="e5796-236">string</span></span>
* <span data-ttu-id="e5796-237">timestamp - timestamp é uma estrutura composta que contém Olá membros a seguir:</span><span class="sxs-lookup"><span data-stu-id="e5796-237">timestamp--timestamp is a compound structure that contains hello following members:</span></span>

  * <span data-ttu-id="e5796-238">year</span><span class="sxs-lookup"><span data-stu-id="e5796-238">year</span></span>
  * <span data-ttu-id="e5796-239">month (1-12)</span><span class="sxs-lookup"><span data-stu-id="e5796-239">month (1-12)</span></span>
  * <span data-ttu-id="e5796-240">day (1-31)</span><span class="sxs-lookup"><span data-stu-id="e5796-240">day (1-31)</span></span>
  * <span data-ttu-id="e5796-241">dia da semana (no formato de saudação do número; por exemplo, 1 para segunda-feira)</span><span class="sxs-lookup"><span data-stu-id="e5796-241">weekday (in hello format of number; for example, 1 for Monday)</span></span>
  * <span data-ttu-id="e5796-242">hour (no formato de número de 24 horas, por exemplo, 13 significa 1 PM)</span><span class="sxs-lookup"><span data-stu-id="e5796-242">hour (in 24-hour number format; for example, 13 means 1 PM)</span></span>
  * <span data-ttu-id="e5796-243">minute (00-59)</span><span class="sxs-lookup"><span data-stu-id="e5796-243">minute (00-59)</span></span>
  * <span data-ttu-id="e5796-244">second (00-59)</span><span class="sxs-lookup"><span data-stu-id="e5796-244">second (00-59)</span></span>
* <span data-ttu-id="e5796-245">timeinterval</span><span class="sxs-lookup"><span data-stu-id="e5796-245">timeinterval</span></span>

  * <span data-ttu-id="e5796-246">TimeInterval_Zero</span><span class="sxs-lookup"><span data-stu-id="e5796-246">TimeInterval_Zero</span></span>
  * <span data-ttu-id="e5796-247">TimeInterval_100ns</span><span class="sxs-lookup"><span data-stu-id="e5796-247">TimeInterval_100ns</span></span>
  * <span data-ttu-id="e5796-248">TimeInterval_Microsecond</span><span class="sxs-lookup"><span data-stu-id="e5796-248">TimeInterval_Microsecond</span></span>
  * <span data-ttu-id="e5796-249">TimeInterval_Millisecond</span><span class="sxs-lookup"><span data-stu-id="e5796-249">TimeInterval_Millisecond</span></span>
  * <span data-ttu-id="e5796-250">TimeInterval_Second</span><span class="sxs-lookup"><span data-stu-id="e5796-250">TimeInterval_Second</span></span>
  * <span data-ttu-id="e5796-251">TimeInterval_Minute</span><span class="sxs-lookup"><span data-stu-id="e5796-251">TimeInterval_Minute</span></span>
  * <span data-ttu-id="e5796-252">TimeInterval_Hour</span><span class="sxs-lookup"><span data-stu-id="e5796-252">TimeInterval_Hour</span></span>
  * <span data-ttu-id="e5796-253">TimeInterval_Day</span><span class="sxs-lookup"><span data-stu-id="e5796-253">TimeInterval_Day</span></span>
  * <span data-ttu-id="e5796-254">TimeInterval_Week</span><span class="sxs-lookup"><span data-stu-id="e5796-254">TimeInterval_Week</span></span>
  * <span data-ttu-id="e5796-255">TimeInterval_Year</span><span class="sxs-lookup"><span data-stu-id="e5796-255">TimeInterval_Year</span></span>

## <a name="operations"></a><span data-ttu-id="e5796-256">Operações</span><span class="sxs-lookup"><span data-stu-id="e5796-256">Operations</span></span>
<span data-ttu-id="e5796-257">Essas operações são permitidas nos tipos de saudação que são listados na seção anterior hello.</span><span class="sxs-lookup"><span data-stu-id="e5796-257">These operations are allowed on hello types that are listed in hello previous section.</span></span>

| <span data-ttu-id="e5796-258">Operação</span><span class="sxs-lookup"><span data-stu-id="e5796-258">Operation</span></span> | <span data-ttu-id="e5796-259">Operadores com suporte</span><span class="sxs-lookup"><span data-stu-id="e5796-259">Supported operators</span></span> | <span data-ttu-id="e5796-260">Tipo de resultado</span><span class="sxs-lookup"><span data-stu-id="e5796-260">Result type</span></span> |
| --- | --- | --- |
| <span data-ttu-id="e5796-261">double *operador* double</span><span class="sxs-lookup"><span data-stu-id="e5796-261">double *operator* double</span></span> |<span data-ttu-id="e5796-262">+, -, *, /</span><span class="sxs-lookup"><span data-stu-id="e5796-262">+, -, *, /</span></span> |<span data-ttu-id="e5796-263">double</span><span class="sxs-lookup"><span data-stu-id="e5796-263">double</span></span> |
| <span data-ttu-id="e5796-264">double *operador* timeinterval</span><span class="sxs-lookup"><span data-stu-id="e5796-264">double *operator* timeinterval</span></span> |* |<span data-ttu-id="e5796-265">timeinterval</span><span class="sxs-lookup"><span data-stu-id="e5796-265">timeinterval</span></span> |
| <span data-ttu-id="e5796-266">doubleVec *operador* double</span><span class="sxs-lookup"><span data-stu-id="e5796-266">doubleVec *operator* double</span></span> |<span data-ttu-id="e5796-267">+, -, *, /</span><span class="sxs-lookup"><span data-stu-id="e5796-267">+, -, *, /</span></span> |<span data-ttu-id="e5796-268">doubleVec</span><span class="sxs-lookup"><span data-stu-id="e5796-268">doubleVec</span></span> |
| <span data-ttu-id="e5796-269">doubleVec *operador* doubleVec</span><span class="sxs-lookup"><span data-stu-id="e5796-269">doubleVec *operator* doubleVec</span></span> |<span data-ttu-id="e5796-270">+, -, *, /</span><span class="sxs-lookup"><span data-stu-id="e5796-270">+, -, *, /</span></span> |<span data-ttu-id="e5796-271">doubleVec</span><span class="sxs-lookup"><span data-stu-id="e5796-271">doubleVec</span></span> |
| <span data-ttu-id="e5796-272">timeinterval *operador* double</span><span class="sxs-lookup"><span data-stu-id="e5796-272">timeinterval *operator* double</span></span> |<span data-ttu-id="e5796-273">*, /</span><span class="sxs-lookup"><span data-stu-id="e5796-273">*, /</span></span> |<span data-ttu-id="e5796-274">timeinterval</span><span class="sxs-lookup"><span data-stu-id="e5796-274">timeinterval</span></span> |
| <span data-ttu-id="e5796-275">timeinterval *operador* timeinterval</span><span class="sxs-lookup"><span data-stu-id="e5796-275">timeinterval *operator* timeinterval</span></span> |<span data-ttu-id="e5796-276">+, -</span><span class="sxs-lookup"><span data-stu-id="e5796-276">+, -</span></span> |<span data-ttu-id="e5796-277">timeinterval</span><span class="sxs-lookup"><span data-stu-id="e5796-277">timeinterval</span></span> |
| <span data-ttu-id="e5796-278">timeinterval *operador* timestamp</span><span class="sxs-lookup"><span data-stu-id="e5796-278">timeinterval *operator* timestamp</span></span> |+ |<span data-ttu-id="e5796-279"> timestamp</span><span class="sxs-lookup"><span data-stu-id="e5796-279">timestamp</span></span> |
| <span data-ttu-id="e5796-280">timestamp *operador* timeinterval</span><span class="sxs-lookup"><span data-stu-id="e5796-280">timestamp *operator* timeinterval</span></span> |+ |<span data-ttu-id="e5796-281"> timestamp</span><span class="sxs-lookup"><span data-stu-id="e5796-281">timestamp</span></span> |
| <span data-ttu-id="e5796-282">timestamp *operador* timestamp</span><span class="sxs-lookup"><span data-stu-id="e5796-282">timestamp *operator* timestamp</span></span> |- |<span data-ttu-id="e5796-283">timeinterval</span><span class="sxs-lookup"><span data-stu-id="e5796-283">timeinterval</span></span> |
| <span data-ttu-id="e5796-284">*operador*double</span><span class="sxs-lookup"><span data-stu-id="e5796-284">*operator*double</span></span> |<span data-ttu-id="e5796-285">-, !</span><span class="sxs-lookup"><span data-stu-id="e5796-285">-, !</span></span> |<span data-ttu-id="e5796-286">double</span><span class="sxs-lookup"><span data-stu-id="e5796-286">double</span></span> |
| <span data-ttu-id="e5796-287">*operador*timeinterval</span><span class="sxs-lookup"><span data-stu-id="e5796-287">*operator*timeinterval</span></span> |- |<span data-ttu-id="e5796-288">timeinterval</span><span class="sxs-lookup"><span data-stu-id="e5796-288">timeinterval</span></span> |
| <span data-ttu-id="e5796-289">double *operador* double</span><span class="sxs-lookup"><span data-stu-id="e5796-289">double *operator* double</span></span> |<span data-ttu-id="e5796-290"><, <=, ==, >=, >, !=</span><span class="sxs-lookup"><span data-stu-id="e5796-290"><, <=, ==, >=, >, !=</span></span> |<span data-ttu-id="e5796-291">double</span><span class="sxs-lookup"><span data-stu-id="e5796-291">double</span></span> |
| <span data-ttu-id="e5796-292">string *operador* string</span><span class="sxs-lookup"><span data-stu-id="e5796-292">string *operator* string</span></span> |<span data-ttu-id="e5796-293"><, <=, ==, >=, >, !=</span><span class="sxs-lookup"><span data-stu-id="e5796-293"><, <=, ==, >=, >, !=</span></span> |<span data-ttu-id="e5796-294">double</span><span class="sxs-lookup"><span data-stu-id="e5796-294">double</span></span> |
| <span data-ttu-id="e5796-295">timestamp *operador* timestamp</span><span class="sxs-lookup"><span data-stu-id="e5796-295">timestamp *operator* timestamp</span></span> |<span data-ttu-id="e5796-296"><, <=, ==, >=, >, !=</span><span class="sxs-lookup"><span data-stu-id="e5796-296"><, <=, ==, >=, >, !=</span></span> |<span data-ttu-id="e5796-297">double</span><span class="sxs-lookup"><span data-stu-id="e5796-297">double</span></span> |
| <span data-ttu-id="e5796-298">timeinterval *operador* timeinterval</span><span class="sxs-lookup"><span data-stu-id="e5796-298">timeinterval *operator* timeinterval</span></span> |<span data-ttu-id="e5796-299"><, <=, ==, >=, >, !=</span><span class="sxs-lookup"><span data-stu-id="e5796-299"><, <=, ==, >=, >, !=</span></span> |<span data-ttu-id="e5796-300">double</span><span class="sxs-lookup"><span data-stu-id="e5796-300">double</span></span> |
| <span data-ttu-id="e5796-301">double *operador* double</span><span class="sxs-lookup"><span data-stu-id="e5796-301">double *operator* double</span></span> |<span data-ttu-id="e5796-302">&&, &#124;&#124;</span><span class="sxs-lookup"><span data-stu-id="e5796-302">&&, &#124;&#124;</span></span> |<span data-ttu-id="e5796-303">double</span><span class="sxs-lookup"><span data-stu-id="e5796-303">double</span></span> |

<span data-ttu-id="e5796-304">Ao testar um double com um operador ternário (`double ? statement1 : statement2`), um item diferente de zero é **true** e zero é **false**.</span><span class="sxs-lookup"><span data-stu-id="e5796-304">When testing a double with a ternary operator (`double ? statement1 : statement2`), nonzero is **true**, and zero is **false**.</span></span>

## <a name="functions"></a><span data-ttu-id="e5796-305">Funções</span><span class="sxs-lookup"><span data-stu-id="e5796-305">Functions</span></span>
<span data-ttu-id="e5796-306">Esses predefinidos **funções** estão disponíveis para você toouse na definição de uma fórmula de dimensionamento automático.</span><span class="sxs-lookup"><span data-stu-id="e5796-306">These predefined **functions** are available for you toouse in defining an automatic scaling formula.</span></span>

| <span data-ttu-id="e5796-307">Função</span><span class="sxs-lookup"><span data-stu-id="e5796-307">Function</span></span> | <span data-ttu-id="e5796-308">Tipo de retorno</span><span class="sxs-lookup"><span data-stu-id="e5796-308">Return type</span></span> | <span data-ttu-id="e5796-309">Descrição</span><span class="sxs-lookup"><span data-stu-id="e5796-309">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="e5796-310">avg(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="e5796-310">avg(doubleVecList)</span></span> |<span data-ttu-id="e5796-311">double</span><span class="sxs-lookup"><span data-stu-id="e5796-311">double</span></span> |<span data-ttu-id="e5796-312">Retorna Olá valor médio para todos os valores no doubleVecList hello.</span><span class="sxs-lookup"><span data-stu-id="e5796-312">Returns hello average value for all values in hello doubleVecList.</span></span> |
| <span data-ttu-id="e5796-313">len(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="e5796-313">len(doubleVecList)</span></span> |<span data-ttu-id="e5796-314">double</span><span class="sxs-lookup"><span data-stu-id="e5796-314">double</span></span> |<span data-ttu-id="e5796-315">Retorna Olá comprimento do vetor de saudação que é criada a partir de doubleVecList hello.</span><span class="sxs-lookup"><span data-stu-id="e5796-315">Returns hello length of hello vector that is created from hello doubleVecList.</span></span> |
| <span data-ttu-id="e5796-316">lg(double)</span><span class="sxs-lookup"><span data-stu-id="e5796-316">lg(double)</span></span> |<span data-ttu-id="e5796-317">double</span><span class="sxs-lookup"><span data-stu-id="e5796-317">double</span></span> |<span data-ttu-id="e5796-318">Retorna um log Olá base 2 de saudação double.</span><span class="sxs-lookup"><span data-stu-id="e5796-318">Returns hello log base 2 of hello double.</span></span> |
| <span data-ttu-id="e5796-319">lg(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="e5796-319">lg(doubleVecList)</span></span> |<span data-ttu-id="e5796-320">doubleVec</span><span class="sxs-lookup"><span data-stu-id="e5796-320">doubleVec</span></span> |<span data-ttu-id="e5796-321">Retorna o log component-wise Olá base 2 de saudação doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="e5796-321">Returns hello component-wise log base 2 of hello doubleVecList.</span></span> <span data-ttu-id="e5796-322">Um vec (Double) deve ser passado explicitamente para o parâmetro hello.</span><span class="sxs-lookup"><span data-stu-id="e5796-322">A vec(double) must be explicitly passed for hello parameter.</span></span> <span data-ttu-id="e5796-323">Caso contrário, versão de duplo lg(double) Olá será assumido.</span><span class="sxs-lookup"><span data-stu-id="e5796-323">Otherwise, hello double lg(double) version is assumed.</span></span> |
| <span data-ttu-id="e5796-324">ln(double)</span><span class="sxs-lookup"><span data-stu-id="e5796-324">ln(double)</span></span> |<span data-ttu-id="e5796-325">double</span><span class="sxs-lookup"><span data-stu-id="e5796-325">double</span></span> |<span data-ttu-id="e5796-326">Retorna Olá log natural de saudação dupla.</span><span class="sxs-lookup"><span data-stu-id="e5796-326">Returns hello natural log of hello double.</span></span> |
| <span data-ttu-id="e5796-327">ln(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="e5796-327">ln(doubleVecList)</span></span> |<span data-ttu-id="e5796-328">doubleVec</span><span class="sxs-lookup"><span data-stu-id="e5796-328">doubleVec</span></span> |<span data-ttu-id="e5796-329">Retorna o log component-wise Olá base 2 de saudação doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="e5796-329">Returns hello component-wise log base 2 of hello doubleVecList.</span></span> <span data-ttu-id="e5796-330">Um vec (Double) deve ser passado explicitamente para o parâmetro hello.</span><span class="sxs-lookup"><span data-stu-id="e5796-330">A vec(double) must be explicitly passed for hello parameter.</span></span> <span data-ttu-id="e5796-331">Caso contrário, versão de duplo lg(double) Olá será assumido.</span><span class="sxs-lookup"><span data-stu-id="e5796-331">Otherwise, hello double lg(double) version is assumed.</span></span> |
| <span data-ttu-id="e5796-332">log(double)</span><span class="sxs-lookup"><span data-stu-id="e5796-332">log(double)</span></span> |<span data-ttu-id="e5796-333">double</span><span class="sxs-lookup"><span data-stu-id="e5796-333">double</span></span> |<span data-ttu-id="e5796-334">Retorna um log Olá base 10 da saudação double.</span><span class="sxs-lookup"><span data-stu-id="e5796-334">Returns hello log base 10 of hello double.</span></span> |
| <span data-ttu-id="e5796-335">log(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="e5796-335">log(doubleVecList)</span></span> |<span data-ttu-id="e5796-336">doubleVec</span><span class="sxs-lookup"><span data-stu-id="e5796-336">doubleVec</span></span> |<span data-ttu-id="e5796-337">Retorna o log component-wise Olá base 10 da saudação doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="e5796-337">Returns hello component-wise log base 10 of hello doubleVecList.</span></span> <span data-ttu-id="e5796-338">Um vec (Double) deve ser passado explicitamente para o único parâmetro double de saudação.</span><span class="sxs-lookup"><span data-stu-id="e5796-338">A vec(double) must be explicitly passed for hello single double parameter.</span></span> <span data-ttu-id="e5796-339">Caso contrário, versão de duplo log(double) Olá será assumido.</span><span class="sxs-lookup"><span data-stu-id="e5796-339">Otherwise, hello double log(double) version is assumed.</span></span> |
| <span data-ttu-id="e5796-340">max(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="e5796-340">max(doubleVecList)</span></span> |<span data-ttu-id="e5796-341">double</span><span class="sxs-lookup"><span data-stu-id="e5796-341">double</span></span> |<span data-ttu-id="e5796-342">Retorna Olá valor máximo na doubleVecList hello.</span><span class="sxs-lookup"><span data-stu-id="e5796-342">Returns hello maximum value in hello doubleVecList.</span></span> |
| <span data-ttu-id="e5796-343">min(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="e5796-343">min(doubleVecList)</span></span> |<span data-ttu-id="e5796-344">double</span><span class="sxs-lookup"><span data-stu-id="e5796-344">double</span></span> |<span data-ttu-id="e5796-345">Retorna Olá valor mínimo na doubleVecList hello.</span><span class="sxs-lookup"><span data-stu-id="e5796-345">Returns hello minimum value in hello doubleVecList.</span></span> |
| <span data-ttu-id="e5796-346">norm(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="e5796-346">norm(doubleVecList)</span></span> |<span data-ttu-id="e5796-347">double</span><span class="sxs-lookup"><span data-stu-id="e5796-347">double</span></span> |<span data-ttu-id="e5796-348">Retorna Olá norma dupla do vetor de saudação que é criada a partir de doubleVecList hello.</span><span class="sxs-lookup"><span data-stu-id="e5796-348">Returns hello two-norm of hello vector that is created from hello doubleVecList.</span></span> |
| <span data-ttu-id="e5796-349">percentile(doubleVec v, double p)</span><span class="sxs-lookup"><span data-stu-id="e5796-349">percentile(doubleVec v, double p)</span></span> |<span data-ttu-id="e5796-350">double</span><span class="sxs-lookup"><span data-stu-id="e5796-350">double</span></span> |<span data-ttu-id="e5796-351">Retorna Olá elemento percentile do vetor de saudação v.</span><span class="sxs-lookup"><span data-stu-id="e5796-351">Returns hello percentile element of hello vector v.</span></span> |
| <span data-ttu-id="e5796-352">rand()</span><span class="sxs-lookup"><span data-stu-id="e5796-352">rand()</span></span> |<span data-ttu-id="e5796-353">double</span><span class="sxs-lookup"><span data-stu-id="e5796-353">double</span></span> |<span data-ttu-id="e5796-354">Retorna um valor aleatório entre 0,0 e 1,0.</span><span class="sxs-lookup"><span data-stu-id="e5796-354">Returns a random value between 0.0 and 1.0.</span></span> |
| <span data-ttu-id="e5796-355">range(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="e5796-355">range(doubleVecList)</span></span> |<span data-ttu-id="e5796-356">double</span><span class="sxs-lookup"><span data-stu-id="e5796-356">double</span></span> |<span data-ttu-id="e5796-357">Retorna a diferença de saudação entre Olá valores mínimo e máximos em doubleVecList hello.</span><span class="sxs-lookup"><span data-stu-id="e5796-357">Returns hello difference between hello min and max values in hello doubleVecList.</span></span> |
| <span data-ttu-id="e5796-358">std(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="e5796-358">std(doubleVecList)</span></span> |<span data-ttu-id="e5796-359">double</span><span class="sxs-lookup"><span data-stu-id="e5796-359">double</span></span> |<span data-ttu-id="e5796-360">Retorna Olá desvio padrão dos valores Olá Olá doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="e5796-360">Returns hello sample standard deviation of hello values in hello doubleVecList.</span></span> |
| <span data-ttu-id="e5796-361">stop()</span><span class="sxs-lookup"><span data-stu-id="e5796-361">stop()</span></span> | |<span data-ttu-id="e5796-362">Interrompe a avaliação da expressão de dimensionamento automático hello.</span><span class="sxs-lookup"><span data-stu-id="e5796-362">Stops evaluation of hello autoscaling expression.</span></span> |
| <span data-ttu-id="e5796-363">sum(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="e5796-363">sum(doubleVecList)</span></span> |<span data-ttu-id="e5796-364">double</span><span class="sxs-lookup"><span data-stu-id="e5796-364">double</span></span> |<span data-ttu-id="e5796-365">Retorna Olá soma de todos os componentes de saudação do hello doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="e5796-365">Returns hello sum of all hello components of hello doubleVecList.</span></span> |
| <span data-ttu-id="e5796-366">time(string dateTime="")</span><span class="sxs-lookup"><span data-stu-id="e5796-366">time(string dateTime="")</span></span> |<span data-ttu-id="e5796-367">timestamp</span><span class="sxs-lookup"><span data-stu-id="e5796-367">timestamp</span></span> |<span data-ttu-id="e5796-368">Retorna o carimbo de hora de saudação do hello hora atual se sem parâmetros são transmitidos ou Olá carimbo de data / hora de cadeia de caracteres de data e hora de saudação se ele for passado.</span><span class="sxs-lookup"><span data-stu-id="e5796-368">Returns hello time stamp of hello current time if no parameters are passed, or hello time stamp of hello dateTime string if it is passed.</span></span> <span data-ttu-id="e5796-369">Os formatos de dateTime com suporte são W3C-DTF e RFC1123.</span><span class="sxs-lookup"><span data-stu-id="e5796-369">Supported dateTime formats are W3C-DTF and RFC 1123.</span></span> |
| <span data-ttu-id="e5796-370">val(doubleVec v, double i)</span><span class="sxs-lookup"><span data-stu-id="e5796-370">val(doubleVec v, double i)</span></span> |<span data-ttu-id="e5796-371">double</span><span class="sxs-lookup"><span data-stu-id="e5796-371">double</span></span> |<span data-ttu-id="e5796-372">Retorna o valor de saudação do elemento de saudação no local i no vetor v, com um índice inicial de zero.</span><span class="sxs-lookup"><span data-stu-id="e5796-372">Returns hello value of hello element that is at location i in vector v, with a starting index of zero.</span></span> |

<span data-ttu-id="e5796-373">Algumas das funções de saudação que são descritas na tabela anterior Olá podem aceitar uma lista como um argumento.</span><span class="sxs-lookup"><span data-stu-id="e5796-373">Some of hello functions that are described in hello previous table can accept a list as an argument.</span></span> <span data-ttu-id="e5796-374">lista separada por vírgulas de saudação é qualquer combinação de *duplo* e *doubleVec*.</span><span class="sxs-lookup"><span data-stu-id="e5796-374">hello comma-separated list is any combination of *double* and *doubleVec*.</span></span> <span data-ttu-id="e5796-375">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="e5796-375">For example:</span></span>

`doubleVecList := ( (double | doubleVec)+(, (double | doubleVec) )* )?`

<span data-ttu-id="e5796-376">Olá *doubleVecList* valor é convertido tooa único *doubleVec* antes da avaliação.</span><span class="sxs-lookup"><span data-stu-id="e5796-376">hello *doubleVecList* value is converted tooa single *doubleVec* before evaluation.</span></span> <span data-ttu-id="e5796-377">Por exemplo, se `v = [1,2,3]`, em seguida, chamar `avg(v)` é o equivalente toocalling `avg(1,2,3)`.</span><span class="sxs-lookup"><span data-stu-id="e5796-377">For example, if `v = [1,2,3]`, then calling `avg(v)` is equivalent toocalling `avg(1,2,3)`.</span></span> <span data-ttu-id="e5796-378">Chamando `avg(v, 7)` é o equivalente toocalling `avg(1,2,3,7)`.</span><span class="sxs-lookup"><span data-stu-id="e5796-378">Calling `avg(v, 7)` is equivalent toocalling `avg(1,2,3,7)`.</span></span>

## <span data-ttu-id="e5796-379"><a name="getsampledata"></a>Obter dados de exemplo</span><span class="sxs-lookup"><span data-stu-id="e5796-379"><a name="getsampledata"></a>Obtain sample data</span></span>
<span data-ttu-id="e5796-380">Fórmulas de dimensionamento automático agir sobre dados de métricas (exemplos) que são fornecidos pelo serviço de lote de saudação.</span><span class="sxs-lookup"><span data-stu-id="e5796-380">Autoscale formulas act on metrics data (samples) that is provided by hello Batch service.</span></span> <span data-ttu-id="e5796-381">Uma fórmula aumenta ou diminui o tamanho do pool com base nos valores de saudação que ele obtém do serviço de saudação.</span><span class="sxs-lookup"><span data-stu-id="e5796-381">A formula grows or shrinks pool size based on hello values that it obtains from hello service.</span></span> <span data-ttu-id="e5796-382">as variáveis definidas pelo serviço Olá que foram descritas anteriormente são objetos que fornecem vários métodos tooaccess dados que está associados esse objeto.</span><span class="sxs-lookup"><span data-stu-id="e5796-382">hello service-defined variables that were described previously are objects that provide various methods tooaccess data that is associated with that object.</span></span> <span data-ttu-id="e5796-383">Por exemplo, hello expressão a seguir mostra uma saudação de tooget solicitação últimos cinco minutos de uso da CPU:</span><span class="sxs-lookup"><span data-stu-id="e5796-383">For example, hello following expression shows a request tooget hello last five minutes of CPU usage:</span></span>

```
$CPUPercent.GetSample(TimeInterval_Minute * 5)
```

| <span data-ttu-id="e5796-384">Método</span><span class="sxs-lookup"><span data-stu-id="e5796-384">Method</span></span> | <span data-ttu-id="e5796-385">Descrição</span><span class="sxs-lookup"><span data-stu-id="e5796-385">Description</span></span> |
| --- | --- |
| <span data-ttu-id="e5796-386">GetSample()</span><span class="sxs-lookup"><span data-stu-id="e5796-386">GetSample()</span></span> |<span data-ttu-id="e5796-387">Olá `GetSample()` método retorna um vetor de exemplos de dados.</span><span class="sxs-lookup"><span data-stu-id="e5796-387">hello `GetSample()` method returns a vector of data samples.</span></span><br/><br/><span data-ttu-id="e5796-388">Uma amostra é de 30 segundos de dados de métrica.</span><span class="sxs-lookup"><span data-stu-id="e5796-388">A sample is 30 seconds worth of metrics data.</span></span> <span data-ttu-id="e5796-389">Em outras palavras, os exemplos são obtidos a cada 30 segundos.</span><span class="sxs-lookup"><span data-stu-id="e5796-389">In other words, samples are obtained every 30 seconds.</span></span> <span data-ttu-id="e5796-390">Mas, conforme observado a seguir, há um atraso entre quando uma amostra é coletada e quando ele está disponível tooa fórmula.</span><span class="sxs-lookup"><span data-stu-id="e5796-390">But as noted below, there is a delay between when a sample is collected and when it is available tooa formula.</span></span> <span data-ttu-id="e5796-391">Como tal, é possível que nem todas as amostras para um determinado período de tempo estejam disponíveis para avaliação por uma fórmula.</span><span class="sxs-lookup"><span data-stu-id="e5796-391">As such, not all samples for a given time period may be available for evaluation by a formula.</span></span><ul><li>`doubleVec GetSample(double count)`<br/><span data-ttu-id="e5796-392">Especifica o número de saudação de exemplos tooobtain exemplos de hello mais recentes que foram coletados.</span><span class="sxs-lookup"><span data-stu-id="e5796-392">Specifies hello number of samples tooobtain from hello most recent samples that were collected.</span></span><br/><br/><span data-ttu-id="e5796-393">`GetSample(1)`Retorna a última amostra disponível de saudação.</span><span class="sxs-lookup"><span data-stu-id="e5796-393">`GetSample(1)` returns hello last available sample.</span></span> <span data-ttu-id="e5796-394">Para métricas como `$CPUPercent`, no entanto, isso não deve ser usado porque é impossível tooknow *quando* Olá exemplo foi coletado.</span><span class="sxs-lookup"><span data-stu-id="e5796-394">For metrics like `$CPUPercent`, however, this should not be used because it is impossible tooknow *when* hello sample was collected.</span></span> <span data-ttu-id="e5796-395">Pode ser recente ou, devido a problemas do sistema, muito mais antigo.</span><span class="sxs-lookup"><span data-stu-id="e5796-395">It might be recent, or, because of system issues, it might be much older.</span></span> <span data-ttu-id="e5796-396">É melhor em tal casos de toouse um intervalo de tempo, conforme mostrado abaixo.</span><span class="sxs-lookup"><span data-stu-id="e5796-396">It is better in such cases toouse a time interval as shown below.</span></span><li>`doubleVec GetSample((timestamp or timeinterval) startTime [, double samplePercent])`<br/><span data-ttu-id="e5796-397">Especifica um intervalo de tempo para coleta de dados de exemplo.</span><span class="sxs-lookup"><span data-stu-id="e5796-397">Specifies a time frame for gathering sample data.</span></span> <span data-ttu-id="e5796-398">Opcionalmente, ela também especifica porcentagem Olá de amostras que deve estar disponível no hello solicitado período de tempo.</span><span class="sxs-lookup"><span data-stu-id="e5796-398">Optionally, it also specifies hello percentage of samples that must be available in hello requested time frame.</span></span><br/><br/><span data-ttu-id="e5796-399">`$CPUPercent.GetSample(TimeInterval_Minute * 10)`retornaria 20 amostras se todas as amostras para Olá últimos 10 minutos estão presentes no histórico de CPUPercent hello.</span><span class="sxs-lookup"><span data-stu-id="e5796-399">`$CPUPercent.GetSample(TimeInterval_Minute * 10)` would return 20 samples if all samples for hello last 10 minutes are present in hello CPUPercent history.</span></span> <span data-ttu-id="e5796-400">No entanto, se Olá última hora de histórico não estava disponível, apenas 18 exemplos serão retornados.</span><span class="sxs-lookup"><span data-stu-id="e5796-400">If hello last minute of history was not available, however, only 18 samples would be returned.</span></span> <span data-ttu-id="e5796-401">Nesse caso:</span><span class="sxs-lookup"><span data-stu-id="e5796-401">In this case:</span></span><br/><br/><span data-ttu-id="e5796-402">`$CPUPercent.GetSample(TimeInterval_Minute * 10, 95)`falhará porque somente 90% de exemplos de saudação estão disponíveis.</span><span class="sxs-lookup"><span data-stu-id="e5796-402">`$CPUPercent.GetSample(TimeInterval_Minute * 10, 95)` would fail because only 90 percent of hello samples are available.</span></span><br/><br/><span data-ttu-id="e5796-403">`$CPUPercent.GetSample(TimeInterval_Minute * 10, 80)` teria êxito.</span><span class="sxs-lookup"><span data-stu-id="e5796-403">`$CPUPercent.GetSample(TimeInterval_Minute * 10, 80)` would succeed.</span></span><li>`doubleVec GetSample((timestamp or timeinterval) startTime, (timestamp or timeinterval) endTime [, double samplePercent])`<br/><span data-ttu-id="e5796-404">Especifica um intervalo de tempo para coleta de dados, com uma hora de início e uma hora de término.</span><span class="sxs-lookup"><span data-stu-id="e5796-404">Specifies a time frame for gathering data, with both a start time and an end time.</span></span><br/><br/><span data-ttu-id="e5796-405">Conforme mencionado acima, há um atraso entre quando uma amostra é coletada e quando ele está disponível tooa fórmula.</span><span class="sxs-lookup"><span data-stu-id="e5796-405">As mentioned above, there is a delay between when a sample is collected and when it is available tooa formula.</span></span> <span data-ttu-id="e5796-406">Considere esse atraso quando você usar o hello `GetSample` método.</span><span class="sxs-lookup"><span data-stu-id="e5796-406">Consider this delay when you use hello `GetSample` method.</span></span> <span data-ttu-id="e5796-407">Veja `GetSamplePercent` abaixo.</span><span class="sxs-lookup"><span data-stu-id="e5796-407">See `GetSamplePercent` below.</span></span> |
| <span data-ttu-id="e5796-408">GetSamplePeriod()</span><span class="sxs-lookup"><span data-stu-id="e5796-408">GetSamplePeriod()</span></span> |<span data-ttu-id="e5796-409">Retorna o período de saudação de exemplos que foram executadas em um conjunto de dados históricos de exemplo.</span><span class="sxs-lookup"><span data-stu-id="e5796-409">Returns hello period of samples that were taken in a historical sample data set.</span></span> |
| <span data-ttu-id="e5796-410">Count()</span><span class="sxs-lookup"><span data-stu-id="e5796-410">Count()</span></span> |<span data-ttu-id="e5796-411">Retorna Olá número total de amostras no histórico de métrica de saudação.</span><span class="sxs-lookup"><span data-stu-id="e5796-411">Returns hello total number of samples in hello metric history.</span></span> |
| <span data-ttu-id="e5796-412">HistoryBeginTime()</span><span class="sxs-lookup"><span data-stu-id="e5796-412">HistoryBeginTime()</span></span> |<span data-ttu-id="e5796-413">Retorna Olá carimbo de hora de exemplo de dados disponível mais antigo hello de métrica de saudação.</span><span class="sxs-lookup"><span data-stu-id="e5796-413">Returns hello time stamp of hello oldest available data sample for hello metric.</span></span> |
| <span data-ttu-id="e5796-414">GetSamplePercent()</span><span class="sxs-lookup"><span data-stu-id="e5796-414">GetSamplePercent()</span></span> |<span data-ttu-id="e5796-415">Retorna Olá porcentagem de amostras que estão disponíveis para um determinado intervalo.</span><span class="sxs-lookup"><span data-stu-id="e5796-415">Returns hello percentage of samples that are available for a given time interval.</span></span> <span data-ttu-id="e5796-416">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="e5796-416">For example:</span></span><br/><br/>`doubleVec GetSamplePercent( (timestamp or timeinterval) startTime [, (timestamp or timeinterval) endTime] )`<br/><br/><span data-ttu-id="e5796-417">Porque Olá `GetSample` método falhará se a porcentagem de saudação de amostras retornado é menor que Olá `samplePercent` especificado, você pode usar o hello `GetSamplePercent` toocheck método primeiro.</span><span class="sxs-lookup"><span data-stu-id="e5796-417">Because hello `GetSample` method fails if hello percentage of samples returned is less than hello `samplePercent` specified, you can use hello `GetSamplePercent` method toocheck first.</span></span> <span data-ttu-id="e5796-418">Em seguida, você pode executar uma ação alternativa se insuficiente exemplos estiverem presentes, sem interromper a avaliação de dimensionamento automático hello.</span><span class="sxs-lookup"><span data-stu-id="e5796-418">Then you can perform an alternate action if insufficient samples are present, without halting hello automatic scaling evaluation.</span></span> |

### <a name="samples-sample-percentage-and-hello-getsample-method"></a><span data-ttu-id="e5796-419">Olá, a porcentagem de exemplo e exemplos *GetSample()* método</span><span class="sxs-lookup"><span data-stu-id="e5796-419">Samples, sample percentage, and hello *GetSample()* method</span></span>
<span data-ttu-id="e5796-420">operação principal de saudação de uma fórmula de dimensionamento automático é dados de métrica tarefas e recursos tooobtain e, em seguida, ajustar o tamanho do pool com base nesses dados.</span><span class="sxs-lookup"><span data-stu-id="e5796-420">hello core operation of an autoscale formula is tooobtain task and resource metric data and then adjust pool size based on that data.</span></span> <span data-ttu-id="e5796-421">Como tal, é importante toohave uma compreensão clara de como as fórmulas de dimensionamento automático interagem com dados de métricas (exemplos).</span><span class="sxs-lookup"><span data-stu-id="e5796-421">As such, it is important toohave a clear understanding of how autoscale formulas interact with metrics data (samples).</span></span>

<span data-ttu-id="e5796-422">**Exemplos**</span><span class="sxs-lookup"><span data-stu-id="e5796-422">**Samples**</span></span>

<span data-ttu-id="e5796-423">Olá serviço de lote periodicamente usa exemplos de métricas de recursos e tarefas e torna disponível tooyour fórmulas de dimensionamento automático.</span><span class="sxs-lookup"><span data-stu-id="e5796-423">hello Batch service periodically takes samples of task and resource metrics and makes them available tooyour autoscale formulas.</span></span> <span data-ttu-id="e5796-424">Esses exemplos são registrados a cada 30 segundos por Olá serviço de lote.</span><span class="sxs-lookup"><span data-stu-id="e5796-424">These samples are recorded every 30 seconds by hello Batch service.</span></span> <span data-ttu-id="e5796-425">No entanto, há geralmente um atraso entre quando esses exemplos foram registrados e quando eles são disponibilizados muito (e podem ser lidos por) suas fórmulas de dimensionamento automático.</span><span class="sxs-lookup"><span data-stu-id="e5796-425">However, there is typically a delay between when those samples were recorded and when they are made available too(and can be read by) your autoscale formulas.</span></span> <span data-ttu-id="e5796-426">Além disso, devido a fatores de toovarious, como a rede ou outros problemas de infraestrutura, exemplos podem não ser gravados para um determinado intervalo.</span><span class="sxs-lookup"><span data-stu-id="e5796-426">Additionally, due toovarious factors such as network or other infrastructure issues, samples may not be recorded for a particular interval.</span></span>

<span data-ttu-id="e5796-427">**Exemplo de porcentagem**</span><span class="sxs-lookup"><span data-stu-id="e5796-427">**Sample percentage**</span></span>

<span data-ttu-id="e5796-428">Quando `samplePercent` é passado toohello `GetSample()` método ou hello `GetSamplePercent()` método é chamado, _%_ refere-se a comparação de tooa entre o número total possível de saudação de exemplos que são registradas pelo serviço de lote de saudação e número de saudação de exemplos de fórmula de dimensionamento automático tooyour disponíveis.</span><span class="sxs-lookup"><span data-stu-id="e5796-428">When `samplePercent` is passed toohello `GetSample()` method or hello `GetSamplePercent()` method is called, _percent_ refers tooa comparison between hello total possible number of samples that are recorded by hello Batch service and hello number of samples that are available tooyour autoscale formula.</span></span>

<span data-ttu-id="e5796-429">Vamos examinar um período de 10 minutos como exemplo.</span><span class="sxs-lookup"><span data-stu-id="e5796-429">Let's look at a 10-minute timespan as an example.</span></span> <span data-ttu-id="e5796-430">Como exemplos são registrados a cada 30 segundos dentro de um período de tempo de 10 minutos, Olá máximo total de exemplos que são registradas pelo lote seria 20 amostras (2 por minuto).</span><span class="sxs-lookup"><span data-stu-id="e5796-430">Because samples are recorded every 30 seconds within a 10-minute timespan, hello maximum total number of samples that are recorded by Batch would be 20 samples (2 per minute).</span></span> <span data-ttu-id="e5796-431">No entanto, devido a latência inerente de toohello de saudação reporting mecanismo e outros problemas no Azure, pode haver apenas 15 exemplos de fórmula de dimensionamento automático tooyour disponível para leitura.</span><span class="sxs-lookup"><span data-stu-id="e5796-431">However, due toohello inherent latency of hello reporting mechanism and other issues within Azure, there may be only 15 samples that are available tooyour autoscale formula for reading.</span></span> <span data-ttu-id="e5796-432">Assim, por exemplo, para aquele período de 10 minutos, somente 75% do número total de saudação de amostras registrado pode ser fórmula tooyour disponíveis.</span><span class="sxs-lookup"><span data-stu-id="e5796-432">So, for example, for that 10-minute period, only 75% of hello total number of samples recorded may be available tooyour formula.</span></span>

<span data-ttu-id="e5796-433">**GetSample() e intervalos de exemplo**</span><span class="sxs-lookup"><span data-stu-id="e5796-433">**GetSample() and sample ranges**</span></span>

<span data-ttu-id="e5796-434">As fórmulas de dimensionamento automático são contínuo toobe aumentando e reduzindo os pools &mdash; adicionar nós ou remover nós.</span><span class="sxs-lookup"><span data-stu-id="e5796-434">Your autoscale formulas are going toobe growing and shrinking your pools &mdash; adding nodes or removing nodes.</span></span> <span data-ttu-id="e5796-435">Como nós custam dinheiro, convém tooensure que as fórmulas usam um método inteligente de análise com base em dados suficientes.</span><span class="sxs-lookup"><span data-stu-id="e5796-435">Because nodes cost you money, you want tooensure that your formulas use an intelligent method of analysis that is based on sufficient data.</span></span> <span data-ttu-id="e5796-436">Portanto, recomendamos que você use uma análise de tipo de tendência em suas fórmulas.</span><span class="sxs-lookup"><span data-stu-id="e5796-436">Therefore, we recommend that you use a trending-type analysis in your formulas.</span></span> <span data-ttu-id="e5796-437">Este tipo aumenta e diminui seus pools baseado em uma variedade de exemplos coletados.</span><span class="sxs-lookup"><span data-stu-id="e5796-437">This type grows and shrinks your pools based on a range of collected samples.</span></span>

<span data-ttu-id="e5796-438">Assim, use toodo `GetSample(interval look-back start, interval look-back end)` tooreturn um vetor de amostras:</span><span class="sxs-lookup"><span data-stu-id="e5796-438">toodo so, use `GetSample(interval look-back start, interval look-back end)` tooreturn a vector of samples:</span></span>

```
$runningTasksSample = $RunningTasks.GetSample(1 * TimeInterval_Minute, 6 * TimeInterval_Minute);
```

<span data-ttu-id="e5796-439">Quando Olá acima da linha é avaliada pelo lote, ele retorna um intervalo de exemplos de como um vetor de valores.</span><span class="sxs-lookup"><span data-stu-id="e5796-439">When hello above line is evaluated by Batch, it returns a range of samples as a vector of values.</span></span> <span data-ttu-id="e5796-440">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="e5796-440">For example:</span></span>

```
$runningTasksSample=[1,1,1,1,1,1,1,1,1,1];
```

<span data-ttu-id="e5796-441">Depois que você coletou vetor Olá de amostras, você pode usar funções como `min()`, `max()`, e `avg()` tooderive significativo valores hello coletados intervalo.</span><span class="sxs-lookup"><span data-stu-id="e5796-441">Once you've collected hello vector of samples, you can then use functions like `min()`, `max()`, and `avg()` tooderive meaningful values from hello collected range.</span></span>

<span data-ttu-id="e5796-442">Para segurança adicional, você pode forçar uma toofail de avaliação de fórmulas se menor que uma determinada porcentagem de exemplo está disponível para um determinado período de tempo.</span><span class="sxs-lookup"><span data-stu-id="e5796-442">For additional security, you can force a formula evaluation toofail if less than a certain sample percentage is available for a particular time period.</span></span> <span data-ttu-id="e5796-443">Quando você forçar um toofail de avaliação de fórmulas, você instruir o lote toocease mais avaliação da fórmula Olá se Olá especificado porcentagem de amostras não está disponível.</span><span class="sxs-lookup"><span data-stu-id="e5796-443">When you force a formula evaluation toofail, you instruct Batch toocease further evaluation of hello formula if hello specified percentage of samples is not available.</span></span> <span data-ttu-id="e5796-444">Nesse caso, nenhuma alteração é feita toohello o tamanho do pool.</span><span class="sxs-lookup"><span data-stu-id="e5796-444">In this case, no change is made toohello pool size.</span></span> <span data-ttu-id="e5796-445">toospecify uma porcentagem necessária de amostras para Olá toosucceed de avaliação, especifique-Olá terceiro parâmetro muito`GetSample()`.</span><span class="sxs-lookup"><span data-stu-id="e5796-445">toospecify a required percentage of samples for hello evaluation toosucceed, specify it as hello third parameter too`GetSample()`.</span></span> <span data-ttu-id="e5796-446">Aqui, é especificado um requisito de 75% de exemplos:</span><span class="sxs-lookup"><span data-stu-id="e5796-446">Here, a requirement of 75 percent of samples is specified:</span></span>

```
$runningTasksSample = $RunningTasks.GetSample(60 * TimeInterval_Second, 120 * TimeInterval_Second, 75);
```

<span data-ttu-id="e5796-447">Como pode haver um atraso na disponibilidade de exemplo, é importante tooalways especificar um intervalo de tempo com uma hora de início de retorno de aparência com mais de um minuto.</span><span class="sxs-lookup"><span data-stu-id="e5796-447">Because there may be a delay in sample availability, it is important tooalways specify a time range with a look-back start time that is older than one minute.</span></span> <span data-ttu-id="e5796-448">Demora aproximadamente um minuto para exemplos toopropagate por meio do sistema hello, portanto amostras no intervalo de saudação `(0 * TimeInterval_Second, 60 * TimeInterval_Second)` pode não estar disponível.</span><span class="sxs-lookup"><span data-stu-id="e5796-448">It takes approximately one minute for samples toopropagate through hello system, so samples in hello range `(0 * TimeInterval_Second, 60 * TimeInterval_Second)` may not be available.</span></span> <span data-ttu-id="e5796-449">Novamente, você pode usar o parâmetro de percentual de saudação do `GetSample()` tooforce um requisito de porcentagem de exemplo específico.</span><span class="sxs-lookup"><span data-stu-id="e5796-449">Again, you can use hello percentage parameter of `GetSample()` tooforce a particular sample percentage requirement.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="e5796-450">**Recomendamos expressamente** que você **evite contar *somente* com `GetSample(1)` em suas fórmulas de dimensionamento automático**.</span><span class="sxs-lookup"><span data-stu-id="e5796-450">We **strongly recommend** that you **avoid relying *only* on `GetSample(1)` in your autoscale formulas**.</span></span> <span data-ttu-id="e5796-451">Isso ocorre porque `GetSample(1)` essencialmente diz toohello serviço de lote, "Dê-me Olá última amostra que você tem, não importa quanto tempo atrás recuperá-lo."</span><span class="sxs-lookup"><span data-stu-id="e5796-451">This is because `GetSample(1)` essentially says toohello Batch service, "Give me hello last sample you have, no matter how long ago you retrieved it."</span></span> <span data-ttu-id="e5796-452">Como é apenas um único exemplo e pode ser um exemplo mais antigo, pode não ser representativo de imagem maior de saudação do estado de recurso ou tarefa recente.</span><span class="sxs-lookup"><span data-stu-id="e5796-452">Since it is only a single sample, and it may be an older sample, it may not be representative of hello larger picture of recent task or resource state.</span></span> <span data-ttu-id="e5796-453">Se você usar `GetSample(1)`, certifique-se de que é parte de uma instrução maior e Olá não apenas o ponto de dados que depende de sua fórmula.</span><span class="sxs-lookup"><span data-stu-id="e5796-453">If you do use `GetSample(1)`, make sure that it's part of a larger statement and not hello only data point that your formula relies on.</span></span>
>
>

## <a name="metrics"></a><span data-ttu-id="e5796-454">Métricas</span><span class="sxs-lookup"><span data-stu-id="e5796-454">Metrics</span></span>
<span data-ttu-id="e5796-455">Você pode usar as métricas do recurso e da tarefa quando estiver definindo uma fórmula.</span><span class="sxs-lookup"><span data-stu-id="e5796-455">You can use both resource and task metrics when you're defining a formula.</span></span> <span data-ttu-id="e5796-456">Você ajustar o número de destino de saudação de nós dedicado no pool de saudação com base nos dados de métricas de saudação que você obtenha e avalia.</span><span class="sxs-lookup"><span data-stu-id="e5796-456">You adjust hello target number of dedicated nodes in hello pool based on hello metrics data that you obtain and evaluate.</span></span> <span data-ttu-id="e5796-457">Consulte Olá [variáveis](#variables) seção acima para obter mais informações sobre cada métrica.</span><span class="sxs-lookup"><span data-stu-id="e5796-457">See hello [Variables](#variables) section above for more information on each metric.</span></span>

<table>
  <tr>
    <th><span data-ttu-id="e5796-458">Métrica</span><span class="sxs-lookup"><span data-stu-id="e5796-458">Metric</span></span></th>
    <th><span data-ttu-id="e5796-459">Descrição</span><span class="sxs-lookup"><span data-stu-id="e5796-459">Description</span></span></th>
  </tr>
  <tr>
    <td><span data-ttu-id="e5796-460"><b>Recurso</b></span><span class="sxs-lookup"><span data-stu-id="e5796-460"><b>Resource</b></span></span></td>
    <td><p><span data-ttu-id="e5796-461">Métricas de recursos se baseiam no hello CPU, uso de memória de saudação de nós de computação, de largura de banda de saudação e Olá número de nós.</span><span class="sxs-lookup"><span data-stu-id="e5796-461">Resource metrics are based on hello CPU, hello bandwidth, hello memory usage of compute nodes, and hello number of nodes.</span></span></p>
        <p> <span data-ttu-id="e5796-462">Essas variáveis definidas pelo serviço são úteis para fazer ajustes com base na contagem de nós:</span><span class="sxs-lookup"><span data-stu-id="e5796-462">These service-defined variables are useful for making adjustments based on node count:</span></span></p>
    <p><ul>
            <li><span data-ttu-id="e5796-463">$TargetDedicatedNodes</span><span class="sxs-lookup"><span data-stu-id="e5796-463">$TargetDedicatedNodes</span></span></li>
            <li><span data-ttu-id="e5796-464">$TargetLowPriorityNodes</span><span class="sxs-lookup"><span data-stu-id="e5796-464">$TargetLowPriorityNodes</span></span></li>
            <li><span data-ttu-id="e5796-465">$CurrentDedicatedNodes</span><span class="sxs-lookup"><span data-stu-id="e5796-465">$CurrentDedicatedNodes</span></span></li>
            <li><span data-ttu-id="e5796-466">$CurrentLowPriorityNodes</span><span class="sxs-lookup"><span data-stu-id="e5796-466">$CurrentLowPriorityNodes</span></span></li>
            <li><span data-ttu-id="e5796-467">$preemptedNodeCount</span><span class="sxs-lookup"><span data-stu-id="e5796-467">$preemptedNodeCount</span></span></li>
            <li><span data-ttu-id="e5796-468">$SampleNodeCount</span><span class="sxs-lookup"><span data-stu-id="e5796-468">$SampleNodeCount</span></span></li>
    </ul></p>
    <p><span data-ttu-id="e5796-469">Estas variáveis definidas pelo serviço são úteis para fazer ajustes com base no uso de recursos do nó:</span><span class="sxs-lookup"><span data-stu-id="e5796-469">These service-defined variables are useful for making adjustments based on node resource usage:</span></span></p>
    <p><ul>
      <li><span data-ttu-id="e5796-470">$CPUPercent</span><span class="sxs-lookup"><span data-stu-id="e5796-470">$CPUPercent</span></span></li>
      <li><span data-ttu-id="e5796-471">$WallClockSeconds</span><span class="sxs-lookup"><span data-stu-id="e5796-471">$WallClockSeconds</span></span></li>
      <li><span data-ttu-id="e5796-472">$MemoryBytes</span><span class="sxs-lookup"><span data-stu-id="e5796-472">$MemoryBytes</span></span></li>
      <li><span data-ttu-id="e5796-473">$DiskBytes</span><span class="sxs-lookup"><span data-stu-id="e5796-473">$DiskBytes</span></span></li>
      <li><span data-ttu-id="e5796-474">$DiskReadBytes</span><span class="sxs-lookup"><span data-stu-id="e5796-474">$DiskReadBytes</span></span></li>
      <li><span data-ttu-id="e5796-475">$DiskWriteBytes</span><span class="sxs-lookup"><span data-stu-id="e5796-475">$DiskWriteBytes</span></span></li>
      <li><span data-ttu-id="e5796-476">$DiskReadOps</span><span class="sxs-lookup"><span data-stu-id="e5796-476">$DiskReadOps</span></span></li>
      <li><span data-ttu-id="e5796-477">$DiskWriteOps</span><span class="sxs-lookup"><span data-stu-id="e5796-477">$DiskWriteOps</span></span></li>
      <li><span data-ttu-id="e5796-478">$NetworkInBytes</span><span class="sxs-lookup"><span data-stu-id="e5796-478">$NetworkInBytes</span></span></li>
      <li><span data-ttu-id="e5796-479">$NetworkOutBytes</span><span class="sxs-lookup"><span data-stu-id="e5796-479">$NetworkOutBytes</span></span></li></ul></p>
  </tr>
  <tr>
    <td><span data-ttu-id="e5796-480"><b>Tarefa</b></span><span class="sxs-lookup"><span data-stu-id="e5796-480"><b>Task</b></span></span></td>
    <td><p><span data-ttu-id="e5796-481">Métricas de tarefa são com base no status de saudação de tarefas, como ativo, pendente e concluídas.</span><span class="sxs-lookup"><span data-stu-id="e5796-481">Task metrics are based on hello status of tasks, such as Active, Pending, and Completed.</span></span> <span data-ttu-id="e5796-482">Olá a variáveis definidas pelo serviço a seguir são úteis para fazer ajustes de tamanho do pool com base nas métricas de tarefa:</span><span class="sxs-lookup"><span data-stu-id="e5796-482">hello following service-defined variables are useful for making pool-size adjustments based on task metrics:</span></span></p>
    <p><ul>
      <li><span data-ttu-id="e5796-483">$ActiveTasks</span><span class="sxs-lookup"><span data-stu-id="e5796-483">$ActiveTasks</span></span></li>
      <li><span data-ttu-id="e5796-484">$RunningTasks</span><span class="sxs-lookup"><span data-stu-id="e5796-484">$RunningTasks</span></span></li>
      <li><span data-ttu-id="e5796-485">$PendingTasks</span><span class="sxs-lookup"><span data-stu-id="e5796-485">$PendingTasks</span></span></li>
      <li><span data-ttu-id="e5796-486">$SucceededTasks</span><span class="sxs-lookup"><span data-stu-id="e5796-486">$SucceededTasks</span></span></li>
            <li><span data-ttu-id="e5796-487">$FailedTasks</span><span class="sxs-lookup"><span data-stu-id="e5796-487">$FailedTasks</span></span></li></ul></p>
        </td>
  </tr>
</table>

## <a name="write-an-autoscale-formula"></a><span data-ttu-id="e5796-488">Criar uma fórmula de autoescala</span><span class="sxs-lookup"><span data-stu-id="e5796-488">Write an autoscale formula</span></span>
<span data-ttu-id="e5796-489">Criar uma fórmula de dimensionamento automático formando instruções que usam Olá acima componentes, e combinar essas instruções em uma fórmula completa.</span><span class="sxs-lookup"><span data-stu-id="e5796-489">You build an autoscale formula by forming statements that use hello above components, then combine those statements into a complete formula.</span></span> <span data-ttu-id="e5796-490">Nesta seção, criamos um exemplo de fórmula de autoescala que pode executar algumas decisões de dimensionamento do mundo real.</span><span class="sxs-lookup"><span data-stu-id="e5796-490">In this section, we create an example autoscale formula that can perform some real-world scaling decisions.</span></span>

<span data-ttu-id="e5796-491">Primeiro, vamos definir requisitos Olá para nossa nova fórmula de dimensionamento automático.</span><span class="sxs-lookup"><span data-stu-id="e5796-491">First, let's define hello requirements for our new autoscale formula.</span></span> <span data-ttu-id="e5796-492">fórmula de saudação deve:</span><span class="sxs-lookup"><span data-stu-id="e5796-492">hello formula should:</span></span>

1. <span data-ttu-id="e5796-493">Aumente o número de destino de saudação de nós de computação dedicado em um pool se o uso da CPU é alto.</span><span class="sxs-lookup"><span data-stu-id="e5796-493">Increase hello target number of dedicated compute nodes in a pool if CPU usage is high.</span></span>
2. <span data-ttu-id="e5796-494">Diminua o número de destino de saudação de nós de computação dedicado em um pool de quando o uso da CPU é baixo.</span><span class="sxs-lookup"><span data-stu-id="e5796-494">Decrease hello target number of dedicated compute nodes in a pool when CPU usage is low.</span></span>
3. <span data-ttu-id="e5796-495">Sempre restringir o número máximo de saudação de nós dedicado too400.</span><span class="sxs-lookup"><span data-stu-id="e5796-495">Always restrict hello maximum number of dedicated nodes too400.</span></span>

<span data-ttu-id="e5796-496">número de saudação do tooincrease de nós durante o alto uso de CPU, defina a instrução de saudação que preenche uma variável definida pelo usuário (`$totalDedicatedNodes`) com um valor que é 110% do número de destino atual Olá nós dedicado, mas apenas se Olá uso mínimo de CPU média durante a saudação últimos 10 minutos foi acima de 70%.</span><span class="sxs-lookup"><span data-stu-id="e5796-496">tooincrease hello number of nodes during high CPU usage, define hello statement that populates a user-defined variable (`$totalDedicatedNodes`) with a value that is 110 percent of hello current target number of dedicated nodes, but only if hello minimum average CPU usage during hello last 10 minutes was above 70 percent.</span></span> <span data-ttu-id="e5796-497">Caso contrário, use o valor de saudação para número atual de saudação de nós dedicado.</span><span class="sxs-lookup"><span data-stu-id="e5796-497">Otherwise, use hello value for hello current number of dedicated nodes.</span></span>

```
$totalDedicatedNodes =
    (min($CPUPercent.GetSample(TimeInterval_Minute * 10)) > 0.7) ?
    ($CurrentDedicatedNodes * 1.1) : $CurrentDedicatedNodes;
```

<span data-ttu-id="e5796-498">muito*diminuir* Olá número de nós dedicado durante a baixa utilização da CPU, Olá próxima instrução na nossa fórmula conjuntos Olá mesmo `$totalDedicatedNodes` too90 variável % do número de destino atual Olá de nós dedicado se hello média de uso da CPU Olá últimos 60 minutos em era 20 por cento.</span><span class="sxs-lookup"><span data-stu-id="e5796-498">too*decrease* hello number of dedicated nodes during low CPU usage, hello next statement in our formula sets hello same `$totalDedicatedNodes` variable too90 percent of hello current target number of dedicated nodes if hello average CPU usage in hello past 60 minutes was under 20 percent.</span></span> <span data-ttu-id="e5796-499">Caso contrário, use o valor atual de saudação do `$totalDedicatedNodes` que é preenchida na instrução de saudação acima.</span><span class="sxs-lookup"><span data-stu-id="e5796-499">Otherwise, use hello current value of `$totalDedicatedNodes` that we populated in hello statement above.</span></span>

```
$totalDedicatedNodes =
    (avg($CPUPercent.GetSample(TimeInterval_Minute * 60)) < 0.2) ?
    ($CurrentDedicatedNodes * 0.9) : $totalDedicatedNodes;
```

<span data-ttu-id="e5796-500">Limite o número de destino de saudação de máximo de tooa de nós de computação dedicado de 400 agora:</span><span class="sxs-lookup"><span data-stu-id="e5796-500">Now limit hello target number of dedicated compute nodes tooa maximum of 400:</span></span>

```
$TargetDedicatedNodes = min(400, $totalDedicatedNodes)
```

<span data-ttu-id="e5796-501">Aqui está a fórmula completa de saudação:</span><span class="sxs-lookup"><span data-stu-id="e5796-501">Here's hello complete formula:</span></span>

```
$totalDedicatedNodes =
    (min($CPUPercent.GetSample(TimeInterval_Minute * 10)) > 0.7) ?
    ($CurrentDedicatedNodes * 1.1) : $CurrentDedicatedNodes;
$totalDedicatedNodes =
    (avg($CPUPercent.GetSample(TimeInterval_Minute * 60)) < 0.2) ?
    ($CurrentDedicatedNodes * 0.9) : $totalDedicatedNodes;
$TargetDedicatedNodes = min(400, $totalDedicatedNodes)
```

## <a name="create-an-autoscale-enabled-pool-with-net"></a><span data-ttu-id="e5796-502">Criar um pool habilitado para autoescala com .NET</span><span class="sxs-lookup"><span data-stu-id="e5796-502">Create an autoscale-enabled pool with .NET</span></span>

<span data-ttu-id="e5796-503">toocreate um pool com o dimensionamento automático habilitado no .NET, siga estas etapas:</span><span class="sxs-lookup"><span data-stu-id="e5796-503">toocreate a pool with autoscaling enabled in .NET, follow these steps:</span></span>

1. <span data-ttu-id="e5796-504">Criar pool de saudação com [BatchClient.PoolOperations.CreatePool](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.createpool).</span><span class="sxs-lookup"><span data-stu-id="e5796-504">Create hello pool with [BatchClient.PoolOperations.CreatePool](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.createpool).</span></span>
2. <span data-ttu-id="e5796-505">Saudação de conjunto [CloudPool.AutoScaleEnabled](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleenabled) propriedade muito`true`.</span><span class="sxs-lookup"><span data-stu-id="e5796-505">Set hello [CloudPool.AutoScaleEnabled](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleenabled) property too`true`.</span></span>
3. <span data-ttu-id="e5796-506">Saudação de conjunto [CloudPool.AutoScaleFormula](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleformula) propriedade com a fórmula de dimensionamento automático.</span><span class="sxs-lookup"><span data-stu-id="e5796-506">Set hello [CloudPool.AutoScaleFormula](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleformula) property with your autoscale formula.</span></span>
4. <span data-ttu-id="e5796-507">(Opcional) Saudação de conjunto [CloudPool.AutoScaleEvaluationInterval](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleevaluationinterval) propriedade (o padrão é 15 minutos).</span><span class="sxs-lookup"><span data-stu-id="e5796-507">(Optional) Set hello [CloudPool.AutoScaleEvaluationInterval](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleevaluationinterval) property (default is 15 minutes).</span></span>
5. <span data-ttu-id="e5796-508">Confirmar pool Olá com [CloudPool.Commit](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.commit) ou [CommitAsync](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.commitasync).</span><span class="sxs-lookup"><span data-stu-id="e5796-508">Commit hello pool with [CloudPool.Commit](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.commit) or [CommitAsync](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.commitasync).</span></span>

<span data-ttu-id="e5796-509">Olá trecho de código a seguir cria um pool de AutoEscala habilitada no .NET.</span><span class="sxs-lookup"><span data-stu-id="e5796-509">hello following code snippet creates an autoscale-enabled pool in .NET.</span></span> <span data-ttu-id="e5796-510">Olá fórmula de dimensionamento automático do pool define Olá destino número de nós dedicado too5 às segundas-feiras e 1 em todos os outros dias da semana hello.</span><span class="sxs-lookup"><span data-stu-id="e5796-510">hello pool's autoscale formula sets hello target number of dedicated nodes too5 on Mondays, and 1 on every other day of hello week.</span></span> <span data-ttu-id="e5796-511">Olá [intervalo de dimensionamento automático](#automatic-scaling-interval) é definir too30 minutos.</span><span class="sxs-lookup"><span data-stu-id="e5796-511">hello [automatic scaling interval](#automatic-scaling-interval) is set too30 minutes.</span></span> <span data-ttu-id="e5796-512">Neste e Olá outros trechos de código c# neste artigo, `myBatchClient` é uma instância inicializada corretamente do hello [BatchClient] [ net_batchclient] classe.</span><span class="sxs-lookup"><span data-stu-id="e5796-512">In this and hello other C# snippets in this article, `myBatchClient` is a properly initialized instance of hello [BatchClient][net_batchclient] class.</span></span>

```csharp
CloudPool pool = myBatchClient.PoolOperations.CreatePool(
                    poolId: "mypool",
                    virtualMachineSize: "small", // single-core, 1.75 GB memory, 225 GB disk
                    cloudServiceConfiguration: new CloudServiceConfiguration(osFamily: "5"));    
pool.AutoScaleEnabled = true;
pool.AutoScaleFormula = "$TargetDedicatedNodes = (time().weekday == 1 ? 5:1);";
pool.AutoScaleEvaluationInterval = TimeSpan.FromMinutes(30);
await pool.CommitAsync();
```

> [!IMPORTANT]
> <span data-ttu-id="e5796-513">Quando você cria um pool de dimensionamento automático habilitado, não especifique Olá _targetDedicatedComputeNodes_ parâmetro ou hello _targetLowPriorityComputeNodes_ parâmetro hello chamar muito** CreatePool**.</span><span class="sxs-lookup"><span data-stu-id="e5796-513">When you create an autoscale-enabled pool, do not specify hello _targetDedicatedComputeNodes_ parameter or hello _targetLowPriorityComputeNodes_ parameter on hello call too**CreatePool**.</span></span> <span data-ttu-id="e5796-514">Em vez disso, especifique Olá **AutoScaleEnabled** e **AutoScaleFormula** propriedades no pool de saudação.</span><span class="sxs-lookup"><span data-stu-id="e5796-514">Instead, specify hello **AutoScaleEnabled** and **AutoScaleFormula** properties on hello pool.</span></span> <span data-ttu-id="e5796-515">valores de Olá para essas propriedades determinam o número de destino de saudação de cada tipo de nó.</span><span class="sxs-lookup"><span data-stu-id="e5796-515">hello values for these properties determine hello target number of each type of node.</span></span> <span data-ttu-id="e5796-516">Além disso, toomanually redimensionar um pool de dimensionamento automático habilitado (por exemplo, com [BatchClient.PoolOperations.ResizePoolAsync][net_poolops_resizepoolasync]), primeiro **desabilitar** o dimensionamento automático em Olá pool e, em seguida, redimensioná-la.</span><span class="sxs-lookup"><span data-stu-id="e5796-516">Also, toomanually resize an autoscale-enabled pool (for example, with [BatchClient.PoolOperations.ResizePoolAsync][net_poolops_resizepoolasync]), first **disable** automatic scaling on hello pool, then resize it.</span></span>
>
>

<span data-ttu-id="e5796-517">Além disso tooBatch .NET, você pode usar qualquer um dos outros Olá [SDKs de lote](batch-apis-tools.md#azure-accounts-for-batch-development), [restante do lote](https://docs.microsoft.com/rest/api/batchservice/), [cmdlets do PowerShell do lote](batch-powershell-cmdlets-get-started.md)e hello [lote CLI](batch-cli-get-started.md)tooconfigure AutoEscala.</span><span class="sxs-lookup"><span data-stu-id="e5796-517">In addition tooBatch .NET, you can use any of hello other [Batch SDKs](batch-apis-tools.md#azure-accounts-for-batch-development), [Batch REST](https://docs.microsoft.com/rest/api/batchservice/), [Batch PowerShell cmdlets](batch-powershell-cmdlets-get-started.md), and hello [Batch CLI](batch-cli-get-started.md) tooconfigure autoscaling.</span></span>


### <a name="automatic-scaling-interval"></a><span data-ttu-id="e5796-518">Intervalo de dimensionamento automático</span><span class="sxs-lookup"><span data-stu-id="e5796-518">Automatic scaling interval</span></span>
<span data-ttu-id="e5796-519">Por padrão, Olá serviço de lote ajusta o tamanho do pool de acordo com tooits fórmula de dimensionamento automático a cada 15 minutos.</span><span class="sxs-lookup"><span data-stu-id="e5796-519">By default, hello Batch service adjusts a pool's size according tooits autoscale formula every 15 minutes.</span></span> <span data-ttu-id="e5796-520">Esse intervalo é configurável usando Olá seguintes propriedades do pool:</span><span class="sxs-lookup"><span data-stu-id="e5796-520">This interval is configurable by using hello following pool properties:</span></span>

* <span data-ttu-id="e5796-521">[CloudPool.AutoScaleEvaluationInterval][net_cloudpool_autoscaleevalinterval] (.NET do Lote)</span><span class="sxs-lookup"><span data-stu-id="e5796-521">[CloudPool.AutoScaleEvaluationInterval][net_cloudpool_autoscaleevalinterval] (Batch .NET)</span></span>
* <span data-ttu-id="e5796-522">[autoScaleEvaluationInterval][rest_autoscaleinterval] (API REST)</span><span class="sxs-lookup"><span data-stu-id="e5796-522">[autoScaleEvaluationInterval][rest_autoscaleinterval] (REST API)</span></span>

<span data-ttu-id="e5796-523">intervalo mínimo de saudação é de cinco minutos e Olá máximo é 168 horas.</span><span class="sxs-lookup"><span data-stu-id="e5796-523">hello minimum interval is five minutes, and hello maximum is 168 hours.</span></span> <span data-ttu-id="e5796-524">Se for especificado um intervalo fora desse intervalo, Olá serviço de lote retorna um erro de solicitação incorreta (400).</span><span class="sxs-lookup"><span data-stu-id="e5796-524">If an interval outside this range is specified, hello Batch service returns a Bad Request (400) error.</span></span>

> [!NOTE]
> <span data-ttu-id="e5796-525">Dimensionamento automático não é atualmente pretendido toorespond toochanges em menos de um minuto, mas em vez disso é projetada tooadjust tamanho de saudação de seu pool gradualmente como executar uma carga de trabalho.</span><span class="sxs-lookup"><span data-stu-id="e5796-525">Autoscaling is not currently intended toorespond toochanges in less than a minute, but rather is intended tooadjust hello size of your pool gradually as you run a workload.</span></span>
>
>

## <a name="enable-autoscaling-on-an-existing-pool"></a><span data-ttu-id="e5796-526">Habilitar autoescala em um pool existente</span><span class="sxs-lookup"><span data-stu-id="e5796-526">Enable autoscaling on an existing pool</span></span>

<span data-ttu-id="e5796-527">Cada lote SDK fornece um dimensionamento automático tooenable de maneira.</span><span class="sxs-lookup"><span data-stu-id="e5796-527">Each Batch SDK provides a way tooenable autoscaling.</span></span> <span data-ttu-id="e5796-528">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="e5796-528">For example:</span></span>

* <span data-ttu-id="e5796-529">[BatchClient.PoolOperations.EnableAutoScaleAsync][net_enableautoscaleasync] (.NET do Lote)</span><span class="sxs-lookup"><span data-stu-id="e5796-529">[BatchClient.PoolOperations.EnableAutoScaleAsync][net_enableautoscaleasync] (Batch .NET)</span></span>
* <span data-ttu-id="e5796-530">[Habilitar o dimensionamento automático em um pool][rest_enableautoscale] (API REST)</span><span class="sxs-lookup"><span data-stu-id="e5796-530">[Enable automatic scaling on a pool][rest_enableautoscale] (REST API)</span></span>

<span data-ttu-id="e5796-531">Quando você habilita o dimensionamento automático em um pool existente, lembre-Olá mente pontos a seguir:</span><span class="sxs-lookup"><span data-stu-id="e5796-531">When you enable autoscaling on an existing pool, keep in mind hello following points:</span></span>

* <span data-ttu-id="e5796-532">Se o dimensionamento automático está desabilitado no pool hello quando você emite o dimensionamento automático tooenable de solicitação hello, você deve especificar uma fórmula de dimensionamento automático válido quando você emitir a solicitação de saudação.</span><span class="sxs-lookup"><span data-stu-id="e5796-532">If automatic scaling is currently disabled on hello pool when you issue hello request tooenable autoscaling, you must specify a valid autoscale formula when you issue hello request.</span></span> <span data-ttu-id="e5796-533">Opcionalmente, é possível especificar um intervalo de avaliação de autoescala.</span><span class="sxs-lookup"><span data-stu-id="e5796-533">You can optionally specify an autoscale evaluation interval.</span></span> <span data-ttu-id="e5796-534">Se você não especificar um intervalo, o valor padrão de saudação de 15 minutos é usado.</span><span class="sxs-lookup"><span data-stu-id="e5796-534">If you do not specify an interval, hello default value of 15 minutes is used.</span></span>
* <span data-ttu-id="e5796-535">Se o dimensionamento automático estiver habilitado no pool de saudação, você pode especificar uma fórmula de dimensionamento automático, um intervalo de avaliação ou ambos.</span><span class="sxs-lookup"><span data-stu-id="e5796-535">If autoscale is currently enabled on hello pool, you can specify an autoscale formula, an evaluation interval, or both.</span></span> <span data-ttu-id="e5796-536">É necessário especificar pelo menos uma dessas propriedades.</span><span class="sxs-lookup"><span data-stu-id="e5796-536">You must specify at least one of these properties.</span></span>

  * <span data-ttu-id="e5796-537">Se você especificar um novo intervalo de avaliação de dimensionamento automático, em seguida, Olá agenda de avaliação existente é interrompida e uma nova agenda é iniciada.</span><span class="sxs-lookup"><span data-stu-id="e5796-537">If you specify a new autoscale evaluation interval, then hello existing evaluation schedule is stopped and a new schedule is started.</span></span> <span data-ttu-id="e5796-538">hora de início da agenda Olá novo é hora de Olá quais Olá dimensionamento automático tooenable de solicitação foi emitido.</span><span class="sxs-lookup"><span data-stu-id="e5796-538">hello new schedule's start time is hello time at which hello request tooenable autoscaling was issued.</span></span>
  * <span data-ttu-id="e5796-539">Se você omitir o intervalo de saudação AutoEscala fórmula ou avaliação, Olá serviço de lote continua toouse Olá atual valor dessa configuração.</span><span class="sxs-lookup"><span data-stu-id="e5796-539">If you omit either hello autoscale formula or evaluation interval, hello Batch service continues toouse hello current value of that setting.</span></span>

> [!NOTE]
> <span data-ttu-id="e5796-540">Se você especificou valores para Olá *targetDedicatedComputeNodes* ou *targetLowPriorityComputeNodes* parâmetros de saudação **CreatePool** método quando você criou Olá pool de .NET ou para parâmetros de saudação comparável em outro idioma e, em seguida, esses valores são ignorados quando Olá automática de escala a fórmula é avaliada.</span><span class="sxs-lookup"><span data-stu-id="e5796-540">If you specified values for hello *targetDedicatedComputeNodes* or *targetLowPriorityComputeNodes* parameters of hello **CreatePool** method when you created hello pool in .NET, or for hello comparable parameters in another language, then those values are ignored when hello automatic scaling formula is evaluated.</span></span>
>
>

<span data-ttu-id="e5796-541">Este trecho de código c# usa Olá [Batch .NET] [ net_api] dimensionamento automático tooenable de biblioteca em um pool existente:</span><span class="sxs-lookup"><span data-stu-id="e5796-541">This C# code snippet uses hello [Batch .NET][net_api] library tooenable autoscaling on an existing pool:</span></span>

```csharp
// Define hello autoscaling formula. This formula sets hello target number of nodes
// too5 on Mondays, and 1 on every other day of hello week
string myAutoScaleFormula = "$TargetDedicatedNodes = (time().weekday == 1 ? 5:1);";

// Set hello autoscale formula on hello existing pool
await myBatchClient.PoolOperations.EnableAutoScaleAsync(
    "myexistingpool",
    autoscaleFormula: myAutoScaleFormula);
```

### <a name="update-an-autoscale-formula"></a><span data-ttu-id="e5796-542">Atualizar uma fórmula de autoescala</span><span class="sxs-lookup"><span data-stu-id="e5796-542">Update an autoscale formula</span></span>

<span data-ttu-id="e5796-543">fórmula de saudação tooupdate em um AutoEscala habilitada pool existente, chamada hello operação tooenable autoscaling novamente com a nova fórmula de saudação.</span><span class="sxs-lookup"><span data-stu-id="e5796-543">tooupdate hello formula on an existing autoscale-enabled pool, call hello operation tooenable autoscaling again with hello new formula.</span></span> <span data-ttu-id="e5796-544">Por exemplo, se o dimensionamento automático já está habilitado na `myexistingpool` quando Olá código .NET a seguir é executado, sua fórmula de dimensionamento automático é substituída pelo conteúdo de saudação do `myNewFormula`.</span><span class="sxs-lookup"><span data-stu-id="e5796-544">For example, if autoscaling is already enabled on `myexistingpool` when hello following .NET code is executed, its autoscale formula is replaced with hello contents of `myNewFormula`.</span></span>

```csharp
await myBatchClient.PoolOperations.EnableAutoScaleAsync(
    "myexistingpool",
    autoscaleFormula: myNewFormula);
```

### <a name="update-hello-autoscale-interval"></a><span data-ttu-id="e5796-545">Intervalo de atualização de dimensionamento automático Olá</span><span class="sxs-lookup"><span data-stu-id="e5796-545">Update hello autoscale interval</span></span>

<span data-ttu-id="e5796-546">intervalo de avaliação tooupdate saudação de dimensionamento automático de um AutoEscala habilitada pool existente, chamada hello operação tooenable autoscaling novamente com o novo intervalo de saudação.</span><span class="sxs-lookup"><span data-stu-id="e5796-546">tooupdate hello autoscale evaluation interval of an existing autoscale-enabled pool, call hello operation tooenable autoscaling again with hello new interval.</span></span> <span data-ttu-id="e5796-547">Por exemplo, tooset Olá AutoEscala avaliação intervalo too60 minutos para um pool que já está habilitado para dimensionamento automático no .NET:</span><span class="sxs-lookup"><span data-stu-id="e5796-547">For example, tooset hello autoscale evaluation interval too60 minutes for a pool that's already autoscale-enabled in .NET:</span></span>

```csharp
await myBatchClient.PoolOperations.EnableAutoScaleAsync(
    "myexistingpool",
    autoscaleEvaluationInterval: TimeSpan.FromMinutes(60));
```

## <a name="evaluate-an-autoscale-formula"></a><span data-ttu-id="e5796-548">Avaliar uma fórmula de autoescala</span><span class="sxs-lookup"><span data-stu-id="e5796-548">Evaluate an autoscale formula</span></span>

<span data-ttu-id="e5796-549">Você pode avaliar uma fórmula antes de aplicá-la tooa pool.</span><span class="sxs-lookup"><span data-stu-id="e5796-549">You can evaluate a formula before applying it tooa pool.</span></span> <span data-ttu-id="e5796-550">Dessa forma, você pode testar Olá toosee fórmula como suas instruções avaliem antes de colocar fórmula Olá em produção.</span><span class="sxs-lookup"><span data-stu-id="e5796-550">In this way, you can test hello formula toosee how its statements evaluate before you put hello formula into production.</span></span>

<span data-ttu-id="e5796-551">tooevaluate uma fórmula de dimensionamento automático, você deve primeiro habilitar dimensionamento automático no pool de saudação com uma fórmula válida.</span><span class="sxs-lookup"><span data-stu-id="e5796-551">tooevaluate an autoscale formula, you must first enable autoscaling on hello pool with a valid formula.</span></span> <span data-ttu-id="e5796-552">tootest uma fórmula em um pool que ainda não tenha o dimensionamento automático habilitado, use fórmula de uma linha de saudação `$TargetDedicatedNodes = 0` quando você primeiro habilita o dimensionamento automático.</span><span class="sxs-lookup"><span data-stu-id="e5796-552">tootest a formula on a pool that doesn't yet have autoscaling enabled, use hello one-line formula `$TargetDedicatedNodes = 0` when you first enable autoscaling.</span></span> <span data-ttu-id="e5796-553">Em seguida, use um dos Olá seguinte tooevaluate Olá fórmula deseja tootest:</span><span class="sxs-lookup"><span data-stu-id="e5796-553">Then, use one of hello following tooevaluate hello formula you want tootest:</span></span>

* <span data-ttu-id="e5796-554">[BatchClient.PoolOperations.EvaluateAutoScale](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.evaluateautoscale) ou [EvaluateAutoScaleAsync](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.evaluateautoscaleasync)</span><span class="sxs-lookup"><span data-stu-id="e5796-554">[BatchClient.PoolOperations.EvaluateAutoScale](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.evaluateautoscale) or [EvaluateAutoScaleAsync](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.evaluateautoscaleasync)</span></span>

    <span data-ttu-id="e5796-555">Esses métodos de lote .NET exigem Olá ID de um pool existente e uma cadeia de caracteres que contém tooevaluate de fórmula de dimensionamento automático hello.</span><span class="sxs-lookup"><span data-stu-id="e5796-555">These Batch .NET methods require hello ID of an existing pool and a string containing hello autoscale formula tooevaluate.</span></span>

* [<span data-ttu-id="e5796-556">Avaliar uma fórmula de autoescala</span><span class="sxs-lookup"><span data-stu-id="e5796-556">Evaluate an automatic scaling formula</span></span>](https://docs.microsoft.com/rest/api/batchservice/evaluate-an-automatic-scaling-formula)

    <span data-ttu-id="e5796-557">Nesta solicitação de API REST, especifique a ID de pool de saudação no URI de saudação e Olá fórmula de dimensionamento automático no hello *autoScaleFormula* elemento Olá do corpo da solicitação.</span><span class="sxs-lookup"><span data-stu-id="e5796-557">In this REST API request, specify hello pool ID in hello URI, and hello autoscale formula in hello *autoScaleFormula* element of hello request body.</span></span> <span data-ttu-id="e5796-558">resposta de saudação da operação de saudação contém qualquer informação de erro que pode ser relacionadas toohello fórmula.</span><span class="sxs-lookup"><span data-stu-id="e5796-558">hello response of hello operation contains any error information that might be related toohello formula.</span></span>

<span data-ttu-id="e5796-559">Neste trecho de código [ .NET do Lote][net_api], avaliamos uma fórmula de autoescala.</span><span class="sxs-lookup"><span data-stu-id="e5796-559">In this [Batch .NET][net_api] code snippet, we evaluate an autoscale formula.</span></span> <span data-ttu-id="e5796-560">Se o pool de saudação não tem o dimensionamento automático habilitado, podemos habilitá-la primeiro.</span><span class="sxs-lookup"><span data-stu-id="e5796-560">If hello pool does not have autoscaling enabled, we enable it first.</span></span>

```csharp
// First obtain a reference tooan existing pool
CloudPool pool = await batchClient.PoolOperations.GetPoolAsync("myExistingPool");

// If autoscaling isn't already enabled on hello pool, enable it.
// You can't evaluate an autoscale formula on non-autoscale-enabled pool.
if (pool.AutoScaleEnabled == false)
{
    // We need a valid autoscale formula tooenable autoscaling on the
    // pool. This formula is valid, but won't resize hello pool:
    await pool.EnableAutoScaleAsync(
        autoscaleFormula: "$TargetDedicatedNodes = {pool.CurrentDedicatedNodes};",
        autoscaleEvaluationInterval: TimeSpan.FromMinutes(5));

    // Batch limits EnableAutoScaleAsync calls tooonce every 30 seconds.
    // Because we want tooapply our new autoscale formula below if it
    // evaluates successfully, and we *just* enabled autoscaling on
    // this pool, we pause here tooensure we pass that threshold.
    Thread.Sleep(TimeSpan.FromSeconds(31));

    // Refresh hello properties of hello pool so that we've got the
    // latest value for AutoScaleEnabled
    await pool.RefreshAsync();
}

// We must ensure that autoscaling is enabled on hello pool prior to
// evaluating a formula
if (pool.AutoScaleEnabled == true)
{
    // hello formula tooevaluate - adjusts target number of nodes based on
    // day of week and time of day
    string myFormula = @"
        $curTime = time();
        $workHours = $curTime.hour >= 8 && $curTime.hour < 18;
        $isWeekday = $curTime.weekday >= 1 && $curTime.weekday <= 5;
        $isWorkingWeekdayHour = $workHours && $isWeekday;
        $TargetDedicatedNodes = $isWorkingWeekdayHour ? 20:10;
    ";

    // Perform hello autoscale formula evaluation. Note that this code does not
    // actually apply hello formula toohello pool.
    AutoScaleRun eval =
        await batchClient.PoolOperations.EvaluateAutoScaleAsync(pool.Id, myFormula);

    if (eval.Error == null)
    {
        // Evaluation success - print hello results of hello AutoScaleRun.
        // This will display hello values of each variable as evaluated by the
        // autoscale formula.
        Console.WriteLine("AutoScaleRun.Results: " +
            eval.Results.Replace("$", "\n    $"));

        // Apply hello formula toohello pool since it evaluated successfully
        await batchClient.PoolOperations.EnableAutoScaleAsync(pool.Id, myFormula);
    }
    else
    {
        // Evaluation failed, output hello message associated with hello error
        Console.WriteLine("AutoScaleRun.Error.Message: " +
            eval.Error.Message);
    }
}
```

<span data-ttu-id="e5796-561">Avaliação bem-sucedida de fórmula Olá mostrada neste trecho de código produz resultados semelhantes:</span><span class="sxs-lookup"><span data-stu-id="e5796-561">Successful evaluation of hello formula shown in this code snippet produces results similar to:</span></span>

```
AutoScaleRun.Results:
    $TargetDedicatedNodes=10;
    $NodeDeallocationOption=requeue;
    $curTime=2016-10-13T19:18:47.805Z;
    $isWeekday=1;
    $isWorkingWeekdayHour=0;
    $workHours=0
```

## <a name="get-information-about-autoscale-runs"></a><span data-ttu-id="e5796-562">Obter informações sobre execuções de autoescala</span><span class="sxs-lookup"><span data-stu-id="e5796-562">Get information about autoscale runs</span></span>

<span data-ttu-id="e5796-563">tooensure sua fórmula está sendo executado como esperado, é recomendável que você verifique periodicamente resultados Olá Olá execuções de dimensionamento automático que executa o lote em seu pool.</span><span class="sxs-lookup"><span data-stu-id="e5796-563">tooensure that your formula is performing as expected, we recommend that you periodically check hello results of hello autoscaling runs that Batch performs on your pool.</span></span> <span data-ttu-id="e5796-564">toodo assim, get (ou atualizar) toohello uma referência pool e, em seguida, examine as propriedades de saudação do seu último AutoEscala executar.</span><span class="sxs-lookup"><span data-stu-id="e5796-564">toodo so, get (or refresh) a reference toohello pool, and examine hello properties of its last autoscale run.</span></span>

<span data-ttu-id="e5796-565">No .NET em lotes, Olá [CloudPool.AutoScaleRun](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscalerun) propriedade tem várias propriedades que fornecem informações sobre hello mais recente o dimensionamento automático executar executada no pool de saudação:</span><span class="sxs-lookup"><span data-stu-id="e5796-565">In Batch .NET, hello [CloudPool.AutoScaleRun](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscalerun) property has several properties that provide information about hello latest automatic scaling run performed on hello pool:</span></span>

* [<span data-ttu-id="e5796-566">AutoScaleRun.Timestamp</span><span class="sxs-lookup"><span data-stu-id="e5796-566">AutoScaleRun.Timestamp</span></span>](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.autoscalerun.timestamp)
* [<span data-ttu-id="e5796-567">AutoScaleRun.Results</span><span class="sxs-lookup"><span data-stu-id="e5796-567">AutoScaleRun.Results</span></span>](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.autoscalerun.results)
* [<span data-ttu-id="e5796-568">AutoScaleRun.Error</span><span class="sxs-lookup"><span data-stu-id="e5796-568">AutoScaleRun.Error</span></span>](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.autoscalerun.error)

<span data-ttu-id="e5796-569">Na API REST do hello, Olá [obter informações sobre um pool](https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-pool) solicitação retorna informações sobre o pool de saudação, que inclui hello mais recente o dimensionamento automático informações de execução em Olá [autoScaleRun](https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-pool#bk_autrun) propriedade.</span><span class="sxs-lookup"><span data-stu-id="e5796-569">In hello REST API, hello [Get information about a pool](https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-pool) request returns information about hello pool, which includes hello latest automatic scaling run information in hello [autoScaleRun](https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-pool#bk_autrun) property.</span></span>

<span data-ttu-id="e5796-570">Olá, seguinte trecho de código c# usa Olá Batch .NET biblioteca tooprint informações sobre hello autoscaling última execução no pool de _myPool_:</span><span class="sxs-lookup"><span data-stu-id="e5796-570">hello following C# code snippet uses hello Batch .NET library tooprint information about hello last autoscaling run on pool _myPool_:</span></span>

```csharp
await Cloud pool = myBatchClient.PoolOperations.GetPoolAsync("myPool");
Console.WriteLine("Last execution: " + pool.AutoScaleRun.Timestamp);
Console.WriteLine("Result:" + pool.AutoScaleRun.Results.Replace("$", "\n  $"));
Console.WriteLine("Error: " + pool.AutoScaleRun.Error);
```

<span data-ttu-id="e5796-571">Exemplo de saída do hello precede o trecho de código:</span><span class="sxs-lookup"><span data-stu-id="e5796-571">Sample output of hello preceding snippet:</span></span>

```
Last execution: 10/14/2016 18:36:43
Result:
  $TargetDedicatedNodes=10;
  $NodeDeallocationOption=requeue;
  $curTime=2016-10-14T18:36:43.282Z;
  $isWeekday=1;
  $isWorkingWeekdayHour=0;
  $workHours=0
Error:
```

## <a name="example-autoscale-formulas"></a><span data-ttu-id="e5796-572">Fórmulas de autoescala de exemplo</span><span class="sxs-lookup"><span data-stu-id="e5796-572">Example autoscale formulas</span></span>
<span data-ttu-id="e5796-573">Vamos examinar algumas fórmulas que mostram a quantidade de saudação tooadjust maneiras diferentes de recursos de computação em um pool.</span><span class="sxs-lookup"><span data-stu-id="e5796-573">Let's look at a few formulas that show different ways tooadjust hello amount of compute resources in a pool.</span></span>

### <a name="example-1-time-based-adjustment"></a><span data-ttu-id="e5796-574">Exemplo 1: ajuste baseado no tempo</span><span class="sxs-lookup"><span data-stu-id="e5796-574">Example 1: Time-based adjustment</span></span>
<span data-ttu-id="e5796-575">Suponha que você deseja que o tamanho do pool de saudação tooadjust com base no dia de saudação da semana hello e a hora do dia.</span><span class="sxs-lookup"><span data-stu-id="e5796-575">Suppose you want tooadjust hello pool size based on hello day of hello week and time of day.</span></span> <span data-ttu-id="e5796-576">Este exemplo mostra como número de saudação tooincrease ou diminuição de nós no hello pool de adequadamente.</span><span class="sxs-lookup"><span data-stu-id="e5796-576">This example shows how tooincrease or decrease hello number of nodes in hello pool accordingly.</span></span>

<span data-ttu-id="e5796-577">fórmula de saudação primeiro obtém Olá hora atual.</span><span class="sxs-lookup"><span data-stu-id="e5796-577">hello formula first obtains hello current time.</span></span> <span data-ttu-id="e5796-578">Se for um dia da semana (1-5) e dentro do horário comercial (too6 8: 00 PM), tamanho do pool de destino Olá é definido too20 nós.</span><span class="sxs-lookup"><span data-stu-id="e5796-578">If it's a weekday (1-5) and within working hours (8 AM too6 PM), hello target pool size is set too20 nodes.</span></span> <span data-ttu-id="e5796-579">Caso contrário, ele definiu too10 nós.</span><span class="sxs-lookup"><span data-stu-id="e5796-579">Otherwise, it's set too10 nodes.</span></span>

```
$curTime = time();
$workHours = $curTime.hour >= 8 && $curTime.hour < 18;
$isWeekday = $curTime.weekday >= 1 && $curTime.weekday <= 5;
$isWorkingWeekdayHour = $workHours && $isWeekday;
$TargetDedicatedNodes = $isWorkingWeekdayHour ? 20:10;
```

### <a name="example-2-task-based-adjustment"></a><span data-ttu-id="e5796-580">Exemplo 2: ajuste baseado na tarefa</span><span class="sxs-lookup"><span data-stu-id="e5796-580">Example 2: Task-based adjustment</span></span>
<span data-ttu-id="e5796-581">Neste exemplo, o tamanho do pool de saudação é ajustado com base no número de saudação de tarefas na fila de saudação.</span><span class="sxs-lookup"><span data-stu-id="e5796-581">In this example, hello pool size is adjusted based on hello number of tasks in hello queue.</span></span> <span data-ttu-id="e5796-582">Ambos os comentários e as quebras de linha são aceitáveis em cadeias de caracteres de fórmulas.</span><span class="sxs-lookup"><span data-stu-id="e5796-582">Both comments and line breaks are acceptable in formula strings.</span></span>

```csharp
// Get pending tasks for hello past 15 minutes.
$samples = $ActiveTasks.GetSamplePercent(TimeInterval_Minute * 15);
// If we have fewer than 70 percent data points, we use hello last sample point,
// otherwise we use hello maximum of last sample point and hello history average.
$tasks = $samples < 70 ? max(0,$ActiveTasks.GetSample(1)) : max( $ActiveTasks.GetSample(1), avg($ActiveTasks.GetSample(TimeInterval_Minute * 15)));
// If number of pending tasks is not 0, set targetVM toopending tasks, otherwise
// half of current dedicated.
$targetVMs = $tasks > 0? $tasks:max(0, $TargetDedicatedNodes/2);
// hello pool size is capped at 20, if target VM value is more than that, set it
// too20. This value should be adjusted according tooyour use case.
$TargetDedicatedNodes = max(0, min($targetVMs, 20));
// Set node deallocation mode - keep nodes active only until tasks finish
$NodeDeallocationOption = taskcompletion;
```

### <a name="example-3-accounting-for-parallel-tasks"></a><span data-ttu-id="e5796-583">Exemplo 3: contagem de tarefas paralelas</span><span class="sxs-lookup"><span data-stu-id="e5796-583">Example 3: Accounting for parallel tasks</span></span>
<span data-ttu-id="e5796-584">Este exemplo ajusta o tamanho do pool de saudação com base no número de saudação de tarefas.</span><span class="sxs-lookup"><span data-stu-id="e5796-584">This example adjusts hello pool size based on hello number of tasks.</span></span> <span data-ttu-id="e5796-585">Esta fórmula também leva em Olá conta [MaxTasksPerComputeNode] [ net_maxtasks] valor tiver sido definido para o pool de saudação.</span><span class="sxs-lookup"><span data-stu-id="e5796-585">This formula also takes into account hello [MaxTasksPerComputeNode][net_maxtasks] value that has been set for hello pool.</span></span> <span data-ttu-id="e5796-586">Essa abordagem é útil em situações nas quais a [execução de tarefas paralelas](batch-parallel-node-tasks.md) foi habilitada em seu pool.</span><span class="sxs-lookup"><span data-stu-id="e5796-586">This approach is useful in situations where [parallel task execution](batch-parallel-node-tasks.md) has been enabled on your pool.</span></span>

```csharp
// Determine whether 70 percent of hello samples have been recorded in hello past
// 15 minutes; if not, use last sample
$samples = $ActiveTasks.GetSamplePercent(TimeInterval_Minute * 15);
$tasks = $samples < 70 ? max(0,$ActiveTasks.GetSample(1)) : max( $ActiveTasks.GetSample(1),avg($ActiveTasks.GetSample(TimeInterval_Minute * 15)));
// Set hello number of nodes tooadd tooone-fourth hello number of active tasks (the
// MaxTasksPerComputeNode property on this pool is set too4, adjust this number
// for your use case)
$cores = $TargetDedicatedNodes * 4;
$extraVMs = (($tasks - $cores) + 3) / 4;
$targetVMs = ($TargetDedicatedNodes + $extraVMs);
// Attempt toogrow hello number of compute nodes toomatch hello number of active
// tasks, with a maximum of 3
$TargetDedicatedNodes = max(0,min($targetVMs,3));
// Keep hello nodes active until hello tasks finish
$NodeDeallocationOption = taskcompletion;
```

### <a name="example-4-setting-an-initial-pool-size"></a><span data-ttu-id="e5796-587">Exemplo 4: definindo um tamanho de pool inicial</span><span class="sxs-lookup"><span data-stu-id="e5796-587">Example 4: Setting an initial pool size</span></span>
<span data-ttu-id="e5796-588">Este exemplo mostra um c# code trecho com uma fórmula de dimensionamento automático que define Olá tooa de tamanho do pool especificado o número de nós por um período de tempo inicial.</span><span class="sxs-lookup"><span data-stu-id="e5796-588">This example shows a C# code snippet with an autoscale formula that sets hello pool size tooa specified number of nodes for an initial time period.</span></span> <span data-ttu-id="e5796-589">Em seguida, ele ajusta o tamanho do pool de saudação com base no número de saudação em execução e tarefas ativas após a saudação inicial período de tempo decorrido.</span><span class="sxs-lookup"><span data-stu-id="e5796-589">Then it adjusts hello pool size based on hello number of running and active tasks after hello initial time period has elapsed.</span></span>

<span data-ttu-id="e5796-590">fórmula Olá Olá trecho de código a seguir:</span><span class="sxs-lookup"><span data-stu-id="e5796-590">hello formula in hello following code snippet:</span></span>

* <span data-ttu-id="e5796-591">Define o pool inicial de saudação nós de toofour de tamanho.</span><span class="sxs-lookup"><span data-stu-id="e5796-591">Sets hello initial pool size toofour nodes.</span></span>
* <span data-ttu-id="e5796-592">Não ajustar o tamanho de pool de saudação em Olá primeiros 10 minutos do ciclo de vida do pool de saudação.</span><span class="sxs-lookup"><span data-stu-id="e5796-592">Does not adjust hello pool size within hello first 10 minutes of hello pool's lifecycle.</span></span>
* <span data-ttu-id="e5796-593">Depois de 10 minutos, obtém o valor máximo de saudação do hello ativo e número de execução as tarefas dentro de saudação nos últimos 60 minutos.</span><span class="sxs-lookup"><span data-stu-id="e5796-593">After 10 minutes, obtains hello max value of hello number of running and active tasks within hello past 60 minutes.</span></span>
  * <span data-ttu-id="e5796-594">Se ambos os valores são 0 (indicando que nenhum tarefas foram em execução ou ativo no hello últimos 60 minutos), o tamanho do pool de saudação é definido too0.</span><span class="sxs-lookup"><span data-stu-id="e5796-594">If both values are 0 (indicating that no tasks were running or active in hello last 60 minutes), hello pool size is set too0.</span></span>
  * <span data-ttu-id="e5796-595">Se um dos valores for maior do que zero, nenhuma alteração será feita</span><span class="sxs-lookup"><span data-stu-id="e5796-595">If either value is greater than zero, no change is made.</span></span>

```csharp
string now = DateTime.UtcNow.ToString("r");
string formula = string.Format(@"
    $TargetDedicatedNodes = {1};
    lifespan         = time() - time(""{0}"");
    span             = TimeInterval_Minute * 60;
    startup          = TimeInterval_Minute * 10;
    ratio            = 50;

    $TargetDedicatedNodes = (lifespan > startup ? (max($RunningTasks.GetSample(span, ratio), $ActiveTasks.GetSample(span, ratio)) == 0 ? 0 : $TargetDedicatedNodes) : {1});
    ", now, 4);
```

## <a name="next-steps"></a><span data-ttu-id="e5796-596">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="e5796-596">Next steps</span></span>
* <span data-ttu-id="e5796-597">[Maximizar o uso de recursos de computação do Azure Batch com tarefas simultâneas do nó](batch-parallel-node-tasks.md) contém detalhes sobre como você pode executar várias tarefas simultaneamente em nós de computação de saudação em seu pool.</span><span class="sxs-lookup"><span data-stu-id="e5796-597">[Maximize Azure Batch compute resource usage with concurrent node tasks](batch-parallel-node-tasks.md) contains details about how you can execute multiple tasks simultaneously on hello compute nodes in your pool.</span></span> <span data-ttu-id="e5796-598">Além disso tooautoscaling, esse recurso pode ajudar toolower duração do trabalho para algumas cargas de trabalho, reduzindo os custos.</span><span class="sxs-lookup"><span data-stu-id="e5796-598">In addition tooautoscaling, this feature may help toolower job duration for some workloads, saving you money.</span></span>
* <span data-ttu-id="e5796-599">Para outro de expansão de eficiência, certifique-se de que suas consultas de aplicativo do lote Olá serviço de lote no hello mais de maneira ideal.</span><span class="sxs-lookup"><span data-stu-id="e5796-599">For another efficiency booster, ensure that your Batch application queries hello Batch service in hello most optimal way.</span></span> <span data-ttu-id="e5796-600">Consulte [consultar o serviço de lote do Azure Olá com eficiência](batch-efficient-list-queries.md) toolearn como toolimit Olá a quantidade de dados que passam durante a transmissão hello quando você consulta o status de saudação potencialmente milhares de computação nós ou tarefas.</span><span class="sxs-lookup"><span data-stu-id="e5796-600">See [Query hello Azure Batch service efficiently](batch-efficient-list-queries.md) toolearn how toolimit hello amount of data that crosses hello wire when you query hello status of potentially thousands of compute nodes or tasks.</span></span>

[net_api]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch
[net_batchclient]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.batchclient
[net_cloudpool_autoscaleformula]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleformula
[net_cloudpool_autoscaleevalinterval]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleevaluationinterval
[net_enableautoscaleasync]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.enableautoscaleasync
[net_maxtasks]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.maxtaskspercomputenode
[net_poolops_resizepoolasync]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.resizepoolasync

[rest_api]: https://docs.microsoft.com/rest/api/batchservice/
[rest_autoscaleformula]: https://docs.microsoft.com/rest/api/batchservice/enable-automatic-scaling-on-a-pool
[rest_autoscaleinterval]: https://docs.microsoft.com/rest/api/batchservice/enable-automatic-scaling-on-a-pool
[rest_enableautoscale]: https://docs.microsoft.com/rest/api/batchservice/enable-automatic-scaling-on-a-pool
