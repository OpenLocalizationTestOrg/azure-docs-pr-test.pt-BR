---
title: "Visão geral do Lote do Azure para desenvolvedores | Microsoft Docs"
description: "Conheça os recursos do serviço de Lote e suas APIs do ponto de vista de um desenvolvedor."
services: batch
documentationcenter: .net
author: tamram
manager: timlt
editor: 
ms.assetid: 416b95f8-2d7b-4111-8012-679b0f60d204
ms.service: batch
ms.devlang: multiple
ms.topic: get-started-article
ms.tgt_pltfrm: na
ms.workload: big-compute
ms.date: 06/28/2017
ms.author: tamram
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: c2f2a878414e4efd626d674ef9a182ae52eeb1ff
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/29/2017
---
# <a name="develop-large-scale-parallel-compute-solutions-with-batch"></a><span data-ttu-id="aa2e8-103">Desenvolva soluções de computação paralela em larga escala com o Lote</span><span class="sxs-lookup"><span data-stu-id="aa2e8-103">Develop large-scale parallel compute solutions with Batch</span></span>

<span data-ttu-id="aa2e8-104">Nesta visão geral dos componentes principais do serviço de Lote do Azure, vamos abordar os recursos do serviço primário que os desenvolvedores do Lote podem usar para criar soluções de computação paralela em grande escala.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-104">In this overview of the core components of the Azure Batch service, we discuss the primary service features and resources that Batch developers can use to build large-scale parallel compute solutions.</span></span>

<span data-ttu-id="aa2e8-105">Se você estiver desenvolvendo um aplicativo de computador distribuído ou serviço que faz chamadas diretas da [API REST][batch_rest_api] ou estiver usando um dos [SDKs de Lote](batch-apis-tools.md#azure-accounts-for-batch-development), usará muitos dos recursos analisados neste artigo.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-105">Whether you're developing a distributed computational application or service that issues direct [REST API][batch_rest_api] calls or you're using one of the [Batch SDKs](batch-apis-tools.md#azure-accounts-for-batch-development), you'll use many of the resources and features discussed in this article.</span></span>

> [!TIP]
> <span data-ttu-id="aa2e8-106">Para obter uma introdução de nível superior do serviço de Lote, consulte os [Fundamentos do Lote do Azure](batch-technical-overview.md).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-106">For a higher-level introduction to the Batch service, see [Basics of Azure Batch](batch-technical-overview.md).</span></span>
>
>

## <a name="batch-service-workflow"></a><span data-ttu-id="aa2e8-107">Fluxo de trabalho de serviço do Lote</span><span class="sxs-lookup"><span data-stu-id="aa2e8-107">Batch service workflow</span></span>
<span data-ttu-id="aa2e8-108">O seguinte fluxo de trabalho de alto nível é típico de quase todos os aplicativos e serviços que usam o serviço de Lote para o processamento de cargas de trabalho paralelas:</span><span class="sxs-lookup"><span data-stu-id="aa2e8-108">The following high-level workflow is typical of nearly all applications and services that use the Batch service for processing parallel workloads:</span></span>

1. <span data-ttu-id="aa2e8-109">Carregue os **arquivos de dados** que você deseja processar em uma conta de [Armazenamento do Azure ][azure_storage].</span><span class="sxs-lookup"><span data-stu-id="aa2e8-109">Upload the **data files** that you want to process to an [Azure Storage][azure_storage] account.</span></span> <span data-ttu-id="aa2e8-110">O Lote inclui suporte interno para acessar o armazenamento de Blobs do Azure, e as tarefas podem baixar esses arquivos para [nós de computação](#compute-node) quando são executadas.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-110">Batch includes built-in support for accessing Azure Blob storage, and your tasks can download these files to [compute nodes](#compute-node) when the tasks are run.</span></span>
2. <span data-ttu-id="aa2e8-111">Carregue os **arquivos de aplicativo** que as tarefas executarão.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-111">Upload the **application files** that your tasks will run.</span></span> <span data-ttu-id="aa2e8-112">Esses arquivos podem ser binários ou scripts e suas dependências e são executados pelas tarefas em seus trabalhos.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-112">These files can be binaries or scripts and their dependencies, and are executed by the tasks in your jobs.</span></span> <span data-ttu-id="aa2e8-113">As tarefas podem baixar esses arquivos de sua conta de armazenamento ou você pode usar o recurso dos [pacotes de aplicativos](#application-packages) de lote para a implantação e o gerenciamento dos aplicativos.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-113">Your tasks can download these files from your Storage account, or you can use the [application packages](#application-packages) feature of Batch for application management and deployment.</span></span>
3. <span data-ttu-id="aa2e8-114">Crie um [pool](#pool) de nós de computação.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-114">Create a [pool](#pool) of compute nodes.</span></span> <span data-ttu-id="aa2e8-115">Quando você cria um pool, pode especificar o número de nós de computação para o pool, seu tamanho e o sistema operacional.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-115">When you create a pool, you specify the number of compute nodes for the pool, their size, and the operating system.</span></span> <span data-ttu-id="aa2e8-116">Quando cada tarefa no trabalho é executada, ela é atribuída para ser executada em um de nós no pool.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-116">When each task in your job runs, it's assigned to execute on one of the nodes in your pool.</span></span>
4. <span data-ttu-id="aa2e8-117">Crie um [trabalho](#job).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-117">Create a [job](#job).</span></span> <span data-ttu-id="aa2e8-118">Um trabalho gerencia uma coleção de tarefas.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-118">A job manages a collection of tasks.</span></span> <span data-ttu-id="aa2e8-119">Você associa cada trabalho a um pool específico no qual as tarefas do trabalho serão executadas.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-119">You associate each job to a specific pool where that job's tasks will run.</span></span>
5. <span data-ttu-id="aa2e8-120">Adicione [tarefas](#task) ao trabalho.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-120">Add [tasks](#task) to the job.</span></span> <span data-ttu-id="aa2e8-121">Cada tarefa executa o aplicativo ou script que você carregou para processar os arquivos de dados que ele baixa de sua conta do Armazenamento.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-121">Each task runs the application or script that you uploaded to process the data files it downloads from your Storage account.</span></span> <span data-ttu-id="aa2e8-122">À medida que cada tarefa é concluída, pode carregar sua saída para o Armazenamento do Azure.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-122">As each task completes, it can upload its output to Azure Storage.</span></span>
6. <span data-ttu-id="aa2e8-123">Monitore o andamento dos trabalhos e recupere a saída de tarefas do Armazenamento do Azure.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-123">Monitor job progress and retrieve the task output from Azure Storage.</span></span>

<span data-ttu-id="aa2e8-124">As seções a seguir discutem esses e outros recursos do Lote que habilitarão que seu cenário de computação distribuída.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-124">The following sections discuss these and the other resources of Batch that enable your distributed computational scenario.</span></span>

> [!NOTE]
> <span data-ttu-id="aa2e8-125">Você precisa de uma [Conta do Lote](#account) para usar o serviço do Lote.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-125">You need a [Batch account](#account) to use the Batch service.</span></span> <span data-ttu-id="aa2e8-126">A maioria das soluções do Lote também usa uma conta de [Armazenamento do Azure][azure_storage] para o armazenamento de arquivos e a recuperação.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-126">Most Batch solutions also use an [Azure Storage][azure_storage] account for file storage and retrieval.</span></span> <span data-ttu-id="aa2e8-127">Atualmente, o Lote dá suporte apenas ao tipo de conta de armazenamento **uso-geral**, conforme descrito na etapa 5 de [Criar uma conta de armazenamento](../storage/common/storage-create-storage-account.md#create-a-storage-account) em [Sobre as contas de armazenamento do Azure](../storage/common/storage-create-storage-account.md).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-127">Batch currently supports only the **general-purpose** storage account type, as described in step 5 of [Create a storage account](../storage/common/storage-create-storage-account.md#create-a-storage-account) in [About Azure storage accounts](../storage/common/storage-create-storage-account.md).</span></span>
>
>

## <a name="batch-service-resources"></a><span data-ttu-id="aa2e8-128">Recursos do serviço de lote</span><span class="sxs-lookup"><span data-stu-id="aa2e8-128">Batch service resources</span></span>
<span data-ttu-id="aa2e8-129">Alguns dos recursos a seguir - contas, nó de computação, pool, trabalhos e tarefa - são necessários para todas as soluções que usam o serviço de Lote.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-129">Some of the following resources--accounts, compute nodes, pools, jobs, and tasks--are required by all solutions that use the Batch service.</span></span> <span data-ttu-id="aa2e8-130">Outros, como agendas de trabalho e pacotes de aplicativos, são recursos úteis, mas opcionais.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-130">Others, like job schedules and application packages, are helpful, but optional, features.</span></span>

* [<span data-ttu-id="aa2e8-131">Conta</span><span class="sxs-lookup"><span data-stu-id="aa2e8-131">Account</span></span>](#account)
* [<span data-ttu-id="aa2e8-132">Nó de computação</span><span class="sxs-lookup"><span data-stu-id="aa2e8-132">Compute node</span></span>](#compute-node)
* [<span data-ttu-id="aa2e8-133">Pool</span><span class="sxs-lookup"><span data-stu-id="aa2e8-133">Pool</span></span>](#pool)
* [<span data-ttu-id="aa2e8-134">Trabalho</span><span class="sxs-lookup"><span data-stu-id="aa2e8-134">Job</span></span>](#job)

  * [<span data-ttu-id="aa2e8-135">Agendas de trabalho</span><span class="sxs-lookup"><span data-stu-id="aa2e8-135">Job schedules</span></span>](#scheduled-jobs)
* [<span data-ttu-id="aa2e8-136">Tarefa</span><span class="sxs-lookup"><span data-stu-id="aa2e8-136">Task</span></span>](#task)

  * [<span data-ttu-id="aa2e8-137">Iniciar tarefa</span><span class="sxs-lookup"><span data-stu-id="aa2e8-137">Start task</span></span>](#start-task)
  * [<span data-ttu-id="aa2e8-138">Tarefa do Gerenciador de Trabalhos</span><span class="sxs-lookup"><span data-stu-id="aa2e8-138">Job manager task</span></span>](#job-manager-task)
  * [<span data-ttu-id="aa2e8-139">Tarefas de preparação e liberação do trabalho</span><span class="sxs-lookup"><span data-stu-id="aa2e8-139">Job preparation and release tasks</span></span>](#job-preparation-and-release-tasks)
  * [<span data-ttu-id="aa2e8-140">MPI (tarefa de várias instâncias)</span><span class="sxs-lookup"><span data-stu-id="aa2e8-140">Multi-instance task (MPI)</span></span>](#multi-instance-tasks)
  * [<span data-ttu-id="aa2e8-141">Dependências da tarefa</span><span class="sxs-lookup"><span data-stu-id="aa2e8-141">Task dependencies</span></span>](#task-dependencies)
* [<span data-ttu-id="aa2e8-142">Pacotes de aplicativos</span><span class="sxs-lookup"><span data-stu-id="aa2e8-142">Application packages</span></span>](#application-packages)

## <a name="account"></a><span data-ttu-id="aa2e8-143">Conta</span><span class="sxs-lookup"><span data-stu-id="aa2e8-143">Account</span></span>
<span data-ttu-id="aa2e8-144">Uma conta do Batch é uma entidade identificada exclusivamente no serviço Batch.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-144">A Batch account is a uniquely identified entity within the Batch service.</span></span> <span data-ttu-id="aa2e8-145">Todo o processamento é feito por meio de uma conta do Lote.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-145">All processing is associated with a Batch account.</span></span>

<span data-ttu-id="aa2e8-146">Você pode criar uma conta do Lote do Azure usando o [portal do Azure](batch-account-create-portal.md) ou por meio de programação, como com a [biblioteca .NET do Gerenciamento de Lote](batch-management-dotnet.md).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-146">You can create an Azure Batch account using the [Azure portal](batch-account-create-portal.md) or programmatically, such as with the [Batch Management .NET library](batch-management-dotnet.md).</span></span> <span data-ttu-id="aa2e8-147">Ao criar a conta, você poderá associar uma conta do Armazenamento do Azure.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-147">When creating the account, you can associate an Azure storage account.</span></span>

### <a name="pool-allocation-mode"></a><span data-ttu-id="aa2e8-148">Modo de alocação de pools</span><span class="sxs-lookup"><span data-stu-id="aa2e8-148">Pool allocation mode</span></span>

<span data-ttu-id="aa2e8-149">Quando você cria uma conta do Lote, pode especificar como os [pools](#pool) dos nós de computação são alocados.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-149">When you create a Batch account, you can specify how [pools](#pool) of compute nodes are allocated.</span></span> <span data-ttu-id="aa2e8-150">Você pode optar por alocar pools de nós de computação em uma assinatura gerenciada pelo Lote do Azure ou pode alocá-los em sua própria assinatura.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-150">You can choose to allocate pools of compute nodes in a subscription managed by Azure Batch, or you can allocate them in your own subscription.</span></span> <span data-ttu-id="aa2e8-151">A propriedade *modo de alocação de pool* da conta determina onde os pools são alocados.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-151">The *pool allocation mode* property for the account determines where pools are allocated.</span></span> 

<span data-ttu-id="aa2e8-152">Para decidir qual modo de alocação de pools usar, considere o que melhor se adapta à sua situação:</span><span class="sxs-lookup"><span data-stu-id="aa2e8-152">To decide which pool allocation mode to use, consider which best fits your scenario:</span></span>

* <span data-ttu-id="aa2e8-153">**Serviço em Lotes**: o Serviço em Lotes é o modo de alocação de pools padrão, no qual os pools são alocados em segundo plano em assinaturas gerenciadas do Azure.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-153">**Batch Service**: Batch Service is the default pool allocation mode, in which pools are allocated behind the scenes in Azure-managed subscriptions.</span></span> <span data-ttu-id="aa2e8-154">Tenha em mente esses pontos-chave sobre o modo de alocação de pools do Serviço em Lotes:</span><span class="sxs-lookup"><span data-stu-id="aa2e8-154">Keep in mind these key points about the Batch Service pool allocation mode:</span></span>

    - <span data-ttu-id="aa2e8-155">O modo de alocação de pools do Serviço em Lotes dá suporte a pools de Serviço de Nuvem e de Máquina Virtual.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-155">The Batch Service pool allocation mode supports both Cloud Service and Virtual Machine pools.</span></span>
    - <span data-ttu-id="aa2e8-156">O modo de alocação de pools do Serviço em Lotes dá suporte tanto à autenticação de chave compartilhada quanto à [Autenticação do Azure AD](batch-aad-auth.md) (Azure Active Directory).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-156">The Batch Service pool allocation mode supports both shared key authentication or [Azure Active Directory authentication](batch-aad-auth.md) (Azure AD).</span></span> 
    - <span data-ttu-id="aa2e8-157">Você pode usar nós de computação de baixa prioridade ou dedicados em pools alocados com o modo de alocação de pools do Serviço em Lotes.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-157">You can use either dedicated or low-priority compute nodes in pools allocated with the Batch Service pool allocation mode.</span></span>
    - <span data-ttu-id="aa2e8-158">Não use o modo de alocação de pools do Serviço em Lotes se você planeja criar pools de máquina virtual do Azure a partir de imagens VM personalizadas ou se planeja usar uma rede virtual.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-158">Do not use the Batch Service pool allocation mode if you plan to create Azure virtual machine pools from custom VM images, or if you plan to use a virtual network.</span></span> <span data-ttu-id="aa2e8-159">Crie sua conta com o modo de alocação de pools de Assinatura de Usuário.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-159">Create your account with the User Subscription pool allocation mode instead.</span></span>
    - <span data-ttu-id="aa2e8-160">Os pools de Máquina Virtual provisionados em uma conta criada com o modo de alocação de pools do Serviço em Lotes devem ser criados com imagens do [Marketplace de Máquinas Virtuais do Azure][vm_marketplace].</span><span class="sxs-lookup"><span data-stu-id="aa2e8-160">Virtual Machine pools provisioned in an account created with the Batch Service pool allocation mode must be created from [Azure Virtual Machines Marketplace][vm_marketplace] images.</span></span>

* <span data-ttu-id="aa2e8-161">**Assinatura de usuário**: com o modo de alocação de pools de Assinatura de Usuário, os pools do Lote são alocados na assinatura do Azure onde a conta é criada.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-161">**User subscription**: With the User Subscription pool allocation mode, Batch pools are allocated in the Azure subscription where the account is created.</span></span> <span data-ttu-id="aa2e8-162">Tenha em mente estes pontos-chave sobre o modo de alocação de pools da Assinatura de Usuário:</span><span class="sxs-lookup"><span data-stu-id="aa2e8-162">Keep in mind these key points about the User Subscription pool allocation mode:</span></span>
     
    - <span data-ttu-id="aa2e8-163">O modo de alocação de pools de Assinatura de Usuário dá suporte somente a pools de Máquina Virtual.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-163">The User Subscription pool allocation mode supports only Virtual Machine pools.</span></span> <span data-ttu-id="aa2e8-164">Ele não dá suporte a pools dos Serviços de Nuvem.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-164">It does not support Cloud Services pools.</span></span>
    - <span data-ttu-id="aa2e8-165">Para criar pools de máquina virtual de imagens VM personalizadas ou usar uma rede virtual com pools de Máquina Virtual, você deverá usar o modo de alocação de pools de Assinatura de Usuário.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-165">To create Virtual Machine pools from custom VM images or to use a virtual network with Virtual Machine pools, you must use the User Subscription pool allocation mode.</span></span>  
    - <span data-ttu-id="aa2e8-166">Você deve usar a [Autenticação do Azure Active Directory](batch-aad-auth.md) com pools alocados na assinatura do usuário.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-166">You must use [Azure Active Directory authentication](batch-aad-auth.md) with pools that are allocated in the user subscription.</span></span> 
    - <span data-ttu-id="aa2e8-167">Você deve configurar um cofre de chaves do Azure para sua conta do Lote se o modo de alocação de pool estiver definido como Assinatura de Usuário.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-167">You must set up an Azure key vault for your Batch account if the pool allocation mode is set to User Subscription.</span></span> 
    - <span data-ttu-id="aa2e8-168">Você pode usar somente nós de computação dedicados em pools em uma conta criada com o modo de alocação de pools de Assinatura de Usuário.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-168">You can use only dedicated compute nodes in pools in an account created with the User Subscription pool allocation mode.</span></span> <span data-ttu-id="aa2e8-169">Não há suporte para nós de baixa prioridade.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-169">Low-priority nodes are not supported.</span></span>
    - <span data-ttu-id="aa2e8-170">Os pools de Máquina Virtual provisionados em uma conta com o modo de alocação de pools de Assinatura de Usuário devem ser criados com imagens do [Marketplace de Máquinas Virtuais do Azure][vm_marketplace] ou de imagens personalizadas fornecidas por você.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-170">Virtual Machine pools provisioned in an account with the User Subscription pool allocation mode can be created either from [Azure Virtual Machines Marketplace][vm_marketplace] images, or from custom images that you provide.</span></span>

<span data-ttu-id="aa2e8-171">A tabela a seguir compara os modos de alocação de pools do Serviço em Lotes e da Assinatura de Usuário.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-171">The following table compares the Batch Service and User Subscription pool allocation modes.</span></span>

| <span data-ttu-id="aa2e8-172">**Modo de alocação de pools**</span><span class="sxs-lookup"><span data-stu-id="aa2e8-172">**Pool allocation mode**</span></span>                 | <span data-ttu-id="aa2e8-173">**Serviço em Lotes**</span><span class="sxs-lookup"><span data-stu-id="aa2e8-173">**Batch Service**</span></span>                                                                                       | <span data-ttu-id="aa2e8-174">**Assinatura de Usuário**</span><span class="sxs-lookup"><span data-stu-id="aa2e8-174">**User Subscription**</span></span>                                                              |
|-------------------------------------------|---------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------|
| <span data-ttu-id="aa2e8-175">**Os pools são alocados em**</span><span class="sxs-lookup"><span data-stu-id="aa2e8-175">**Pools are allocated in**</span></span>               | <span data-ttu-id="aa2e8-176">Em uma assinatura gerenciada pelo Azure</span><span class="sxs-lookup"><span data-stu-id="aa2e8-176">An Azure-managed subscription</span></span>                                                                           | <span data-ttu-id="aa2e8-177">Na assinatura do usuário em que a conta do Lote é criada</span><span class="sxs-lookup"><span data-stu-id="aa2e8-177">The user subscription in which the Batch account is created</span></span>                        |
| <span data-ttu-id="aa2e8-178">**Configurações com suporte**</span><span class="sxs-lookup"><span data-stu-id="aa2e8-178">**Supported configurations**</span></span>             | <ul><li><span data-ttu-id="aa2e8-179">Configuração do Serviço de Nuvem</span><span class="sxs-lookup"><span data-stu-id="aa2e8-179">Cloud Service Configuration</span></span></li><li><span data-ttu-id="aa2e8-180">Configuração da Máquina Virtual (Linux e Windows)</span><span class="sxs-lookup"><span data-stu-id="aa2e8-180">Virtual Machine Configuration (Linux and Windows)</span></span></li></ul> | <ul><li><span data-ttu-id="aa2e8-181">Configuração da Máquina Virtual (Linux e Windows)</span><span class="sxs-lookup"><span data-stu-id="aa2e8-181">Virtual Machine Configuration (Linux and Windows)</span></span></li></ul>                |
| <span data-ttu-id="aa2e8-182">**Imagens de VM com suporte**</span><span class="sxs-lookup"><span data-stu-id="aa2e8-182">**Supported VM images**</span></span>                  | <ul><li><span data-ttu-id="aa2e8-183">Imagens do Azure Marketplace</span><span class="sxs-lookup"><span data-stu-id="aa2e8-183">Azure Marketplace images</span></span></li></ul>                                                              | <ul><li><span data-ttu-id="aa2e8-184">Imagens do Azure Marketplace</span><span class="sxs-lookup"><span data-stu-id="aa2e8-184">Azure Marketplace images</span></span></li><li><span data-ttu-id="aa2e8-185">Imagens personalizadas</span><span class="sxs-lookup"><span data-stu-id="aa2e8-185">Custom images</span></span></li></ul>                   |
| <span data-ttu-id="aa2e8-186">**Tipos de nós de computação com suporte**</span><span class="sxs-lookup"><span data-stu-id="aa2e8-186">**Supported compute node types**</span></span>         | <ul><li><span data-ttu-id="aa2e8-187">Nós dedicados</span><span class="sxs-lookup"><span data-stu-id="aa2e8-187">Dedicated nodes</span></span></li><li><span data-ttu-id="aa2e8-188">Nós de baixa prioridade</span><span class="sxs-lookup"><span data-stu-id="aa2e8-188">Low-priority nodes</span></span></li></ul>                                            | <ul><li><span data-ttu-id="aa2e8-189">Nós dedicados</span><span class="sxs-lookup"><span data-stu-id="aa2e8-189">Dedicated nodes</span></span></li></ul>                                                  |
| <span data-ttu-id="aa2e8-190">**Autenticação com suporte**</span><span class="sxs-lookup"><span data-stu-id="aa2e8-190">**Supported authentication**</span></span>             | <ul><li><span data-ttu-id="aa2e8-191">Chave compartilhada</span><span class="sxs-lookup"><span data-stu-id="aa2e8-191">Shared Key</span></span></li><li><span data-ttu-id="aa2e8-192">AD do Azure</span><span class="sxs-lookup"><span data-stu-id="aa2e8-192">Azure AD</span></span></li></ul>                                                           | <ul><li><span data-ttu-id="aa2e8-193">AD do Azure</span><span class="sxs-lookup"><span data-stu-id="aa2e8-193">Azure AD</span></span></li></ul>                                                         |
| <span data-ttu-id="aa2e8-194">**Azure Key Vault obrigatório**</span><span class="sxs-lookup"><span data-stu-id="aa2e8-194">**Azure Key Vault required**</span></span>             | <span data-ttu-id="aa2e8-195">Não</span><span class="sxs-lookup"><span data-stu-id="aa2e8-195">No</span></span>                                                                                                      | <span data-ttu-id="aa2e8-196">Sim</span><span class="sxs-lookup"><span data-stu-id="aa2e8-196">Yes</span></span>                                                                                |
| <span data-ttu-id="aa2e8-197">**Cota de núcleos**</span><span class="sxs-lookup"><span data-stu-id="aa2e8-197">**Core quota**</span></span>                           | <span data-ttu-id="aa2e8-198">Determinado pela cota de núcleos do Lote</span><span class="sxs-lookup"><span data-stu-id="aa2e8-198">Determined by Batch core quota</span></span>                                                                          | <span data-ttu-id="aa2e8-199">Determinado pela cota de núcleos da assinatura</span><span class="sxs-lookup"><span data-stu-id="aa2e8-199">Determined by subscription core quota</span></span>                                              |
| <span data-ttu-id="aa2e8-200">**Suporte a VNet (Rede Virtual) do Azure**</span><span class="sxs-lookup"><span data-stu-id="aa2e8-200">**Azure Virtual Network (Vnet) support**</span></span> | <span data-ttu-id="aa2e8-201">Pools criados com a Configuração do Serviço de Nuvem</span><span class="sxs-lookup"><span data-stu-id="aa2e8-201">Pools created with the Cloud Service Configuration</span></span>                                                      | <span data-ttu-id="aa2e8-202">Pools criados com a Configuração de Máquina Virtual</span><span class="sxs-lookup"><span data-stu-id="aa2e8-202">Pools created with the Virtual Machine Configuration</span></span>                               |
| <span data-ttu-id="aa2e8-203">**Modelo de implantação de rede virtual com suporte**</span><span class="sxs-lookup"><span data-stu-id="aa2e8-203">**Vnet deployment model supported**</span></span>      | <span data-ttu-id="aa2e8-204">VNets criadas com o modelo de implantação clássico</span><span class="sxs-lookup"><span data-stu-id="aa2e8-204">Vnets created with classic deployment model</span></span>                                                             | <span data-ttu-id="aa2e8-205">VNets criadas com o modelo de implantação clássico ou com o Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="aa2e8-205">Vnets created with either the classic deployment model or Azure   Resource Manager</span></span> |

## <a name="azure-storage-account"></a><span data-ttu-id="aa2e8-206">Conta de Armazenamento do Azure</span><span class="sxs-lookup"><span data-stu-id="aa2e8-206">Azure Storage account</span></span>

<span data-ttu-id="aa2e8-207">A maioria das soluções do Lote usa o Armazenamento do Azure para armazenar arquivos de recurso e de saída.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-207">Most Batch solutions use Azure Storage for storing resource files and output files.</span></span>  

<span data-ttu-id="aa2e8-208">Atualmente, o Lote dá suporte apenas ao tipo da conta de armazenamento de Uso geral, conforme descrito na etapa 5 de [Criar uma conta de armazenamento](../storage/common/storage-create-storage-account.md#create-a-storage-account) em [Sobre as contas de armazenamento do Azure](../storage/common/storage-create-storage-account.md).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-208">Batch currently supports only the general-purpose storage account type, as described in step 5 of [Create a storage account](../storage/common/storage-create-storage-account.md#create-a-storage-account) in [About Azure storage accounts](../storage/common/storage-create-storage-account.md).</span></span> <span data-ttu-id="aa2e8-209">As tarefas do Lote (incluindo as tarefas padrão, tarefas iniciais, tarefas de preparação do trabalho e tarefas de liberação do trabalho) devem especificar os arquivos de recurso que residem nas contas de armazenamento de finalidade geral.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-209">Your Batch tasks (including standard tasks, start tasks, job preparation tasks, and job release tasks) must specify resource files that reside in general-purpose storage accounts.</span></span>


## <a name="compute-node"></a><span data-ttu-id="aa2e8-210">Nó de computação</span><span class="sxs-lookup"><span data-stu-id="aa2e8-210">Compute node</span></span>
<span data-ttu-id="aa2e8-211">Um nó de computação é uma máquina virtual (VM) do Azure ou VM do serviço de nuvem que é dedicada ao processamento de uma parte da carga de trabalho do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-211">A compute node is an Azure virtual machine (VM) or cloud service VM that is dedicated to processing a portion of your application's workload.</span></span> <span data-ttu-id="aa2e8-212">O tamanho de um nó determina o número de núcleos de CPU, a capacidade da memória e o tamanho do sistema de arquivos local alocado para o nó.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-212">The size of a node determines the number of CPU cores, memory capacity, and local file system size that is allocated to the node.</span></span> <span data-ttu-id="aa2e8-213">Você pode criar pools de nós de Windows ou Linux usando os Serviços de Nuvem do Azure, imagens do [Marketplace de Máquinas Virtuais do Azure][vm_marketplace] ou imagens personalizadas preparadas por você.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-213">You can create pools of Windows or Linux nodes by using Azure Cloud Services, images from the [Azure Virtual Machines Marketplace][vm_marketplace], or custom images that you prepare.</span></span> <span data-ttu-id="aa2e8-214">Consulte o seguinte seção [Pool](#pool) para obter mais informações sobre essas opções.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-214">See the following [Pool](#pool) section for more information on these options.</span></span>

<span data-ttu-id="aa2e8-215">Os nós podem executar qualquer executável ou script que tenha suporte no ambiente do sistema operacional do nó.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-215">Nodes can run any executable or script that is supported by the operating system environment of the node.</span></span> <span data-ttu-id="aa2e8-216">Isso inclui \*.exe, \*.cmd, \*.bat e os scripts do PowerShell para Windows e binários, shell e scripts Python para Linux.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-216">This includes \*.exe, \*.cmd, \*.bat and PowerShell scripts for Windows--and binaries, shell, and Python scripts for Linux.</span></span>

<span data-ttu-id="aa2e8-217">Todos os nós de computação no Lote também incluem:</span><span class="sxs-lookup"><span data-stu-id="aa2e8-217">All compute nodes in Batch also include:</span></span>

* <span data-ttu-id="aa2e8-218">Uma [estrutura de pastas](#files-and-directories) padrão e as [variáveis de ambiente](#environment-settings-for-tasks) associadas disponíveis para a referência por tarefas.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-218">A standard [folder structure](#files-and-directories) and associated [environment variables](#environment-settings-for-tasks) that are available for reference by tasks.</span></span>
* <span data-ttu-id="aa2e8-219">**firewall** que são definidas para controlar o acesso.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-219">**Firewall** settings that are configured to control access.</span></span>
* <span data-ttu-id="aa2e8-220">[Acesso remoto](#connecting-to-compute-nodes) para os nós do Windows (Remote Desktop Protocol (RDP)) e do Linux (Secure Shell (SSH)).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-220">[Remote access](#connecting-to-compute-nodes) to both Windows (Remote Desktop Protocol (RDP)) and Linux (Secure Shell (SSH)) nodes.</span></span>

## <a name="pool"></a><span data-ttu-id="aa2e8-221">pool</span><span class="sxs-lookup"><span data-stu-id="aa2e8-221">Pool</span></span>
<span data-ttu-id="aa2e8-222">Um pool é uma coleção de nós na qual seu aplicativo é executado.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-222">A pool is a collection of nodes that your application runs on.</span></span> <span data-ttu-id="aa2e8-223">O pool pode ser criado manualmente por você ou automaticamente pelo serviço de Lote quando você especifica o trabalho a ser feito.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-223">The pool can be created manually by you, or automatically by the Batch service when you specify the work to be done.</span></span> <span data-ttu-id="aa2e8-224">Você pode criar e gerenciar um pool que atenda às exigências de recursos de seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-224">You can create and manage a pool that meets the resource requirements of your application.</span></span> <span data-ttu-id="aa2e8-225">Um pool pode ser usado somente pela conta do Lote na qual foi criado.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-225">A pool can be used only by the Batch account in which it was created.</span></span> <span data-ttu-id="aa2e8-226">Uma conta do Batch pode ter mais de um pool.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-226">A Batch account can have more than one pool.</span></span>

<span data-ttu-id="aa2e8-227">Os pools do Lote do Azure se baseiam na plataforma de computação principal do Azure.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-227">Azure Batch pools build on top of the core Azure compute platform.</span></span> <span data-ttu-id="aa2e8-228">Eles fornecem alocação em larga escala, instalação de aplicativos, distribuição de dados, monitoramento de integridade e ajuste flexível do número de nós de computação em um pool ([dimensionamento](#scaling-compute-resources)).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-228">They provide large-scale allocation, application installation, data distribution, health monitoring, and flexible adjustment of the number of compute nodes within a pool ([scaling](#scaling-compute-resources)).</span></span>

<span data-ttu-id="aa2e8-229">Todos os nós adicionados a um pool recebem um nome e um endereço IP exclusivos.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-229">Every node that is added to a pool is assigned a unique name and IP address.</span></span> <span data-ttu-id="aa2e8-230">Quando um nó é removido de um pool, todas as alterações feitas no sistema operacional ou arquivos são perdidas e seu nome e endereço IP são liberados para o uso futuro.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-230">When a node is removed from a pool, any changes that are made to the operating system or files are lost, and its name and IP address are released for future use.</span></span> <span data-ttu-id="aa2e8-231">Quando um nó deixa um pool, seu tempo de vida termina.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-231">When a node leaves a pool, its lifetime is over.</span></span>

<span data-ttu-id="aa2e8-232">Ao criar um pool, você pode especificar os seguintes atributos.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-232">When you create a pool, you can specify the following attributes.</span></span> <span data-ttu-id="aa2e8-233">Algumas configurações são diferentes dependendo do modo de alocação de pool da [conta](#account) do Lote:</span><span class="sxs-lookup"><span data-stu-id="aa2e8-233">Some settings differ, depending on the pool allocation mode of the Batch [account](#account):</span></span>

- <span data-ttu-id="aa2e8-234">Sistema operacional e versão do nó de computação</span><span class="sxs-lookup"><span data-stu-id="aa2e8-234">Compute node operating system and version</span></span>
- <span data-ttu-id="aa2e8-235">Tipo de nó de computação e número de nós de destino</span><span class="sxs-lookup"><span data-stu-id="aa2e8-235">Compute node type and target number of nodes</span></span>
- <span data-ttu-id="aa2e8-236">Tamanho dos nós de computação</span><span class="sxs-lookup"><span data-stu-id="aa2e8-236">Size of the compute nodes</span></span>
- <span data-ttu-id="aa2e8-237">Política de dimensionamento</span><span class="sxs-lookup"><span data-stu-id="aa2e8-237">Scaling policy</span></span>
- <span data-ttu-id="aa2e8-238">Política de agendamento de tarefas</span><span class="sxs-lookup"><span data-stu-id="aa2e8-238">Task scheduling policy</span></span>
- <span data-ttu-id="aa2e8-239">Status de comunicação de nós de computação</span><span class="sxs-lookup"><span data-stu-id="aa2e8-239">Communication status for compute nodes</span></span>
- <span data-ttu-id="aa2e8-240">Tarefas iniciais para nós de computação</span><span class="sxs-lookup"><span data-stu-id="aa2e8-240">Start tasks for compute nodes</span></span>
- <span data-ttu-id="aa2e8-241">pacotes de aplicativos</span><span class="sxs-lookup"><span data-stu-id="aa2e8-241">Application packages</span></span>
- <span data-ttu-id="aa2e8-242">Configuração de rede</span><span class="sxs-lookup"><span data-stu-id="aa2e8-242">Network configuration</span></span>

<span data-ttu-id="aa2e8-243">Cada uma dessas configurações é descrita mais detalhadamente nas seções a seguir.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-243">Each of these settings is described in more detail in the following sections.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="aa2e8-244">As contas do Lote criadas com o modo de alocação de pools do Serviço em Lotes possuem uma cota padrão que limita o número de núcleos em uma conta do Lote.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-244">Batch accounts created with the Batch Service pool allocation mode have a default quota that limits the number of cores in a Batch account.</span></span> <span data-ttu-id="aa2e8-245">O número de núcleos corresponde ao número de nós de computação.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-245">The number of cores corresponds to the number of compute nodes.</span></span> <span data-ttu-id="aa2e8-246">Você pode encontrar as cotas padrão e instruções sobre como [aumentar uma cota](batch-quota-limit.md#increase-a-quota) em [Cotas e limites para o serviço Lote do Azure](batch-quota-limit.md).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-246">You can find the default quotas and instructions on how to [increase a quota](batch-quota-limit.md#increase-a-quota) in [Quotas and limits for the Azure Batch service](batch-quota-limit.md).</span></span> <span data-ttu-id="aa2e8-247">Se o pool não está alcançando seu número desejado de nós, a cota de núcleo pode ser o motivo.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-247">If your pool is not achieving its target number of nodes, the core quota might be the reason.</span></span>
>
><span data-ttu-id="aa2e8-248">As contas do Lote criadas com o modo de alocação de pools de Assinatura de Usuário não estão sujeitas às cotas do serviço em Lotes.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-248">Batch accounts created with the User Subscription pool allocation mode do not observe the Batch service quotas.</span></span> <span data-ttu-id="aa2e8-249">Elas compartilham a cota de núcleos da assinatura especificada.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-249">Instead, they share in the core quota for the specified subscription.</span></span> <span data-ttu-id="aa2e8-250">Para saber mais, confira[Limites das Máquinas Virtuais](../azure-subscription-service-limits.md#virtual-machines-limits) e [Assinatura e limites de serviço, cotas e restrições do Azure](../azure-subscription-service-limits.md).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-250">For more information, see [Virtual Machines limits](../azure-subscription-service-limits.md#virtual-machines-limits) in [Azure subscription and service limits, quotas, and constraints](../azure-subscription-service-limits.md).</span></span>
>
>

### <a name="compute-node-operating-system-and-version"></a><span data-ttu-id="aa2e8-251">Sistema operacional e versão do nó de computação</span><span class="sxs-lookup"><span data-stu-id="aa2e8-251">Compute node operating system and version</span></span>

<span data-ttu-id="aa2e8-252">Quando você cria um pool do Lote, pode especificar a configuração de máquina virtual do Azure e o tipo de sistema operacional que deseja executar em cada nó de computação no pool.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-252">When you create a Batch pool, you can specify the Azure virtual machine configuration and the type of operating system you want to run on each compute node in the pool.</span></span> <span data-ttu-id="aa2e8-253">Os dois tipos de configuração disponíveis no Lote são:</span><span class="sxs-lookup"><span data-stu-id="aa2e8-253">The two types of configurations available in Batch are:</span></span>

- <span data-ttu-id="aa2e8-254">A **configuração de máquina virtual**, que especifica que o pool é composto de máquinas virtuais do Azure.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-254">The **Virtual Machine Configuration**, which specifies that the pool is comprised of Azure virtual machines.</span></span> <span data-ttu-id="aa2e8-255">Essas máquinas virtuais podem ser criadas de imagens Linux ou Windows.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-255">These VMs may be created from either Linux or Windows images.</span></span> 

    <span data-ttu-id="aa2e8-256">Ao criar um pool baseado na Configuração da Máquina Virtual, você deverá especificar não apenas o tamanho dos nós e a origem das imagens usadas para criá-los, mas também a **referência da imagem da máquina virtual** e a **SKU do agente de nó** do Lote a ser instalada nos nós.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-256">When you create a pool based on the Virtual Machine Configuration, you must specify not only the size of the nodes and the source of the images used to create them, but also the **virtual machine image reference** and the Batch **node agent SKU** to be installed on the nodes.</span></span> <span data-ttu-id="aa2e8-257">Para saber mais sobre como especificar essas propriedades de pool, confira [Provisionar nós de computação do Linux em pools do Lote do Azure](batch-linux-nodes.md).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-257">For more information about specifying these pool properties, see [Provision Linux compute nodes in Azure Batch pools](batch-linux-nodes.md).</span></span>

- <span data-ttu-id="aa2e8-258">A **configuração dos Serviços de Nuvem**, que especifica que o pool é composto de nós dos Serviços de Nuvem do Azure.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-258">The **Cloud Services Configuration**, which specifies that the pool is comprised of Azure Cloud Services nodes.</span></span> <span data-ttu-id="aa2e8-259">Os Serviços de Nuvem fornecem *somente* nós de computação do Windows.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-259">Cloud Services provide Windows compute nodes *only*.</span></span>

    <span data-ttu-id="aa2e8-260">Os sistemas operacionais disponíveis para pools de Configuração de Serviços de Nuvem são listados na [matriz de compatibilidade de SDK e versões de SO Convidado do Azure](../cloud-services/cloud-services-guestos-update-matrix.md).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-260">Available operating systems for Cloud Services Configuration pools are listed in the [Azure Guest OS releases and SDK compatibility matrix](../cloud-services/cloud-services-guestos-update-matrix.md).</span></span> <span data-ttu-id="aa2e8-261">Ao criar um pool que contém os nós dos Serviços de Nuvem, você precisa especificar o tamanho do nó e sua *Família de SOs*.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-261">When you create a pool that contains Cloud Services nodes, you need to specify the node size and its *OS Family*.</span></span> <span data-ttu-id="aa2e8-262">Os Serviços de Nuvem são implantados no Azure mais rapidamente do que as máquinas virtuais que executam o Windows.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-262">Cloud Services are deployed to Azure more quickly than virtual machines running Windows.</span></span> <span data-ttu-id="aa2e8-263">Se você deseja ter pools de nós de computação do Windows, pode achar os Serviços de Nuvem mais vantajosos no desempenho em relação a tempo de implantação.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-263">If you want pools of Windows compute nodes, you may find that Cloud Services provide a performance benefit in terms of deployment time.</span></span>

    * <span data-ttu-id="aa2e8-264">A *Família de SO* também determina quais versões do .NET são instaladas com o sistema operacional.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-264">The *OS Family* also determines which versions of .NET are installed with the OS.</span></span>
    * <span data-ttu-id="aa2e8-265">Assim como ocorre com as funções de trabalho nos Serviços de Nuvem, você pode especificar uma *Versão do SO* (para obter mais informações sobre as funções de trabalho, consulte a seção [Sobre os serviços de nuvem](../cloud-services/cloud-services-choose-me.md#tell-me-about-cloud-services) na [Visão geral dos Serviços de Nuvem](../cloud-services/cloud-services-choose-me.md)).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-265">As with worker roles within Cloud Services, you can specify an *OS Version* (for more information on worker roles, see the [Tell me about cloud services](../cloud-services/cloud-services-choose-me.md#tell-me-about-cloud-services) section in the [Cloud Services overview](../cloud-services/cloud-services-choose-me.md)).</span></span>
    * <span data-ttu-id="aa2e8-266">Assim como ocorre com as funções de trabalho, é recomendável especificar `*` para a *Versão do SO* de forma que os nós sejam automaticamente atualizados e não haja nenhum trabalho necessário para atender as versões recém-lançadas.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-266">As with worker roles, we recommend that you specify `*` for the *OS Version* so that the nodes are automatically upgraded, and there is no work required to cater to newly released versions.</span></span> <span data-ttu-id="aa2e8-267">O caso de uso principal para selecionar uma versão específica do SO é garantir a compatibilidade dos aplicativos, permitindo que os testes de compatibilidade retroativa sejam executados antes de permitir que a versão seja atualizada.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-267">The primary use case for selecting a specific OS version is to ensure application compatibility, which allows backward compatibility testing to be performed before allowing the version to be updated.</span></span> <span data-ttu-id="aa2e8-268">Após a validação, a *Versão do SO* para o pool pode ser atualizada e a nova imagem do SO pode ser instalada – as tarefas em execução serão interrompidas e colocadas novamente na fila.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-268">After validation, the *OS Version* for the pool can be updated and the new OS image can be installed--any running tasks are interrupted and requeued.</span></span>

<span data-ttu-id="aa2e8-269">Quando você cria um pool, precisa selecionar o **nodeAgentSkuId** apropriado, dependendo do sistema operacional da imagem base do seu VHD.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-269">When you create a pool, you need to select the appropriate **nodeAgentSkuId**, depending on the OS of the base image of your VHD.</span></span> <span data-ttu-id="aa2e8-270">Você pode obter um mapeamento das IDs de SKU do agente de nó disponível para suas referências de imagem do SO chamando a operação [Listar SKUs do agente de nó](https://docs.microsoft.com/rest/api/batchservice/list-supported-node-agent-skus).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-270">You can get a mapping of available node agent SKU ID's to their OS Image references by calling the [List Supported Node Agent SKUs](https://docs.microsoft.com/rest/api/batchservice/list-supported-node-agent-skus) operation.</span></span>

<span data-ttu-id="aa2e8-271">Confira a seção [Conta](#account) para saber mais sobre como definir o modo de alocação de pool ao criar uma conta do Lote.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-271">See the [Account](#account) section for information on setting the pool allocation mode when you create a Batch account.</span></span>

#### <a name="custom-images-for-virtual-machine-pools"></a><span data-ttu-id="aa2e8-272">Imagens personalizadas para pools de máquina virtual</span><span class="sxs-lookup"><span data-stu-id="aa2e8-272">Custom images for Virtual Machine pools</span></span>

<span data-ttu-id="aa2e8-273">Para usar uma imagem personalizada e provisionar os pools de Máquina Virtual, crie sua conta do Lote com o modo de alocação de pools de Assinatura de Usuário.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-273">To use a custom image to provision Virtual Machine pools, create your Batch account with the User Subscription pool allocation mode.</span></span> <span data-ttu-id="aa2e8-274">Com esse modo, os pools do Lote são alocados para a assinatura onde reside a conta.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-274">With this mode, Batch pools are allocated into the subscription where the account resides.</span></span> <span data-ttu-id="aa2e8-275">Confira a seção [Conta](#account) para saber mais sobre como definir o modo de alocação de pool ao criar uma conta do Lote.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-275">See the [Account](#account) section for information on setting the pool allocation mode when you create a Batch account.</span></span>

<span data-ttu-id="aa2e8-276">Para usar uma imagem personalizada, você precisará preparar a imagem generalizando-a.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-276">To use a custom image, you'll need to prepare the image by generalizing it.</span></span> <span data-ttu-id="aa2e8-277">Para obter informações sobre como preparar imagens personalizadas do Linux de VMs do Azure, confira [Capturar uma VM Linux do Azure para usar como modelo](../virtual-machines/linux/capture-image-nodejs.md).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-277">For information about preparing custom Linux images from Azure VMs, see [Capture an Azure Linux VM to use as a template](../virtual-machines/linux/capture-image-nodejs.md).</span></span> <span data-ttu-id="aa2e8-278">Para obter informações sobre como preparar imagens personalizadas do Windows de VMs do Azure, confira [Criar imagens de VM personalizadas com o Azure PowerShell](../virtual-machines/windows/tutorial-custom-images.md).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-278">For information about preparing custom Windows images from Azure VMs, see [Create custom VM images with Azure PowerShell](../virtual-machines/windows/tutorial-custom-images.md).</span></span> 

> [!IMPORTANT]
> <span data-ttu-id="aa2e8-279">Ao preparar sua imagem personalizada, lembre-se do seguinte:</span><span class="sxs-lookup"><span data-stu-id="aa2e8-279">When preparing your custom image, keep in mind the following:</span></span>
> - <span data-ttu-id="aa2e8-280">Verifique se a imagem do sistema operacional base usada para provisionar os pools do Lote não têm extensões do Azure pré-instaladas, como a extensão Script Personalizado.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-280">Ensure that the base OS image you use to provision your Batch pools does not have any pre-installed Azure extensions, such as the Custom Script extension.</span></span> <span data-ttu-id="aa2e8-281">Se a imagem contém uma extensão pré-instalada, o Azure pode ter problemas ao implantar a VM.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-281">If the image contains a pre-installed extension, Azure may encounter problems deploying the VM.</span></span>
> - <span data-ttu-id="aa2e8-282">Verifique se a imagem do sistema operacional base fornecida usa a unidade temporária padrão, já que o agente de nó do Lote espera a unidade temporária padrão.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-282">Ensure that the base OS image you provide uses the default temp drive, as the Batch node agent currently expects the default temp drive.</span></span>
>
>

<span data-ttu-id="aa2e8-283">Para criar um pool de configuração de máquina virtual usando uma imagem personalizada, você precisará de uma ou mais contas de Armazenamento do Azure padrão para armazenar as imagens VHD personalizadas.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-283">To create a Virtual Machine Configuration pool using a custom image, you'll need one or more standard Azure Storage accounts to store your custom VHD images.</span></span> <span data-ttu-id="aa2e8-284">As imagens personalizadas são armazenadas como blobs.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-284">Custom images are stored as blobs.</span></span> <span data-ttu-id="aa2e8-285">Para fazer referência a imagens personalizadas ao criar um pool, especifique os URIs dos blobs VHD de imagem personalizada para a propriedade [osDisk](https://docs.microsoft.com/rest/api/batchservice/add-a-pool-to-an-account#bk_osdisk) da propriedade [virtualMachineConfiguration](https://docs.microsoft.com/rest/api/batchservice/add-a-pool-to-an-account#bk_vmconf).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-285">To reference your custom images when you create a pool, specify the URIs of the custom image VHD blobs for the [osDisk](https://docs.microsoft.com/rest/api/batchservice/add-a-pool-to-an-account#bk_osdisk) property of the [virtualMachineConfiguration](https://docs.microsoft.com/rest/api/batchservice/add-a-pool-to-an-account#bk_vmconf) property.</span></span>

<span data-ttu-id="aa2e8-286">Verifique se suas contas de armazenamento atendem aos seguintes critérios:</span><span class="sxs-lookup"><span data-stu-id="aa2e8-286">Make sure that your storage accounts meet the following criteria:</span></span>   

- <span data-ttu-id="aa2e8-287">As contas de armazenamento que contém os blobs VHD de imagem personalizada precisam estar na mesma assinatura que a conta do Lote (a assinatura de usuário).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-287">The storage accounts containing the custom image VHD blobs need to be in the same subscription as the Batch account (the user subscription).</span></span>
- <span data-ttu-id="aa2e8-288">As contas de armazenamento especificadas precisam estar na mesma região que a conta do Lote.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-288">The specified storage accounts need to be in the same region as the Batch account.</span></span>
- <span data-ttu-id="aa2e8-289">No momento, somente as contas de armazenamento padrão de uso geral têm suporte.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-289">Only standard general-purpose storage accounts are currently supported.</span></span> <span data-ttu-id="aa2e8-290">O armazenamento Premium do Azure terá suporte no futuro.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-290">Azure Premium storage will be supported in the future.</span></span>
- <span data-ttu-id="aa2e8-291">Você pode especificar uma conta de armazenamento com vários blobs VHD personalizados ou várias contas de armazenamento, cada uma com um único blob.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-291">You can specify one storage account with multiple custom VHD blobs or multiple storage accounts each having a single blob.</span></span> <span data-ttu-id="aa2e8-292">Recomendamos que você use várias contas de armazenamento para obter um melhor desempenho.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-292">We recommend you to use multiple storage accounts to get a better performance.</span></span>
- <span data-ttu-id="aa2e8-293">Um blob VHD de imagem personalizada pode dar suporte a até 40 instâncias de VM Linux ou 20 instâncias de VM Windows.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-293">One unique custom image VHD blob can support up to 40 Linux VM instances or 20 Windows VM instances.</span></span> <span data-ttu-id="aa2e8-294">Você precisa criar cópias do blob VHD para criar pools com mais VMs.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-294">You will need to create copies of the VHD blob to create pools with more VMs.</span></span> <span data-ttu-id="aa2e8-295">Por exemplo, um pool com 200 máquinas virtuais Windows precisa de 10 blobs VHD exclusivos especificados para a propriedade **osDisk**.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-295">For example, a pool with 200 Windows VMs needs 10 unique VHD blobs specified for the **osDisk** property.</span></span>

<span data-ttu-id="aa2e8-296">Para criar um pool de uma imagem personalizada usando o portal do Azure:</span><span class="sxs-lookup"><span data-stu-id="aa2e8-296">To create a pool from a custom image using the Azure portal:</span></span>

1. <span data-ttu-id="aa2e8-297">Navegue até sua conta do Lote no portal do Azure.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-297">Navigate to your Batch account in the Azure portal.</span></span>
2. <span data-ttu-id="aa2e8-298">Na folha **Configurações**, selecione o item de menu **Pools**.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-298">On the **Settings** blade, select the **Pools** menu item.</span></span>
3. <span data-ttu-id="aa2e8-299">Na folha **Pools**, selecione o comando **Adicionar**; a folha **Adicionar pool** será exibida.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-299">On the **Pools** blade, select the **Add** command; the **Add pool** blade will be displayed.</span></span>
4. <span data-ttu-id="aa2e8-300">Selecione **Imagem personalizada (Windows/Linux)** na lista suspensa **Tipo de Imagem**.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-300">Select **Custom Image (Linux/Windows)** from the **Image Type** dropdown.</span></span> <span data-ttu-id="aa2e8-301">O portal exibe o seletor **Imagem Personalizada**.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-301">The portal displays the **Custom Image** picker.</span></span> <span data-ttu-id="aa2e8-302">Escolha um ou mais VHDs do mesmo contêiner e clique no botão **Selecionar**.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-302">Choose one or more VHDs from the same container and click the **Select** button.</span></span> 
    <span data-ttu-id="aa2e8-303">Suporte para vários VHDs de contas de armazenamento e de contêineres diferentes será adicionado no futuro.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-303">Support for multiple VHDs from different storage accounts and different containers will be added in the future.</span></span>
5. <span data-ttu-id="aa2e8-304">Selecione a **oferta/publicador/SKU** correta para seus VHDs personalizados, selecione o modo **cache** e preencha todos os outros parâmetros do pool.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-304">Select the correct **Publisher/Offer/Sku** for your custom VHDs, select the desired **Caching** mode, then fill in all the other parameters for the pool.</span></span>
6. <span data-ttu-id="aa2e8-305">Para verificar se um pool é baseado em uma imagem personalizada, consulte a propriedade **Sistema operacional** na seção de resumo de recursos da folha **Pool**.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-305">To check if a pool is based on a custom image, see the **Operating System** property in the resource summary section of the **Pool** blade.</span></span> <span data-ttu-id="aa2e8-306">O valor dessa propriedade deve ser **Imagem de VM personalizada**.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-306">The value of this property should be **Custom VM image**.</span></span>
7. <span data-ttu-id="aa2e8-307">Todos os VHDs personalizados associados a um pool são exibidos na folha **propriedades** do pool.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-307">All custom VHDs associated with a pool are displayed on the pool's **Properties** blade.</span></span>

### <a name="compute-node-type-and-target-number-of-nodes"></a><span data-ttu-id="aa2e8-308">Tipo de nó de computação e número de nós de destino</span><span class="sxs-lookup"><span data-stu-id="aa2e8-308">Compute node type and target number of nodes</span></span>

<span data-ttu-id="aa2e8-309">Quando você cria um pool, você pode especificar os tipos de nós de computação que você deseja e o número de destino para cada um.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-309">When you create a pool, you can specify which types of compute nodes you want and the target number for each.</span></span> <span data-ttu-id="aa2e8-310">Os dois tipos de nós de computação são:</span><span class="sxs-lookup"><span data-stu-id="aa2e8-310">The two types of compute nodes are:</span></span>

- <span data-ttu-id="aa2e8-311">**Nós de computação dedicados.**</span><span class="sxs-lookup"><span data-stu-id="aa2e8-311">**Dedicated compute nodes.**</span></span> <span data-ttu-id="aa2e8-312">Nós de computação dedicados são reservados para suas cargas de trabalho.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-312">Dedicated compute nodes are reserved for your workloads.</span></span> <span data-ttu-id="aa2e8-313">Eles são mais caros que os nós de baixa prioridade, mas é garantido que nunca sofrerão preempção.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-313">They are more expensive than low-priority nodes, but they are guaranteed to never be preempted.</span></span>

- <span data-ttu-id="aa2e8-314">**Nós de computação de baixa prioridade.**</span><span class="sxs-lookup"><span data-stu-id="aa2e8-314">**Low-priority compute nodes.**</span></span> <span data-ttu-id="aa2e8-315">Nós de baixa prioridade aproveitam a capacidade excedente no Azure para executar cargas de trabalho de Lote.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-315">Low-priority nodes take advantage of surplus capacity in Azure to run your Batch workloads.</span></span> <span data-ttu-id="aa2e8-316">Nós de baixa prioridade são mais baratos por hora do que nós dedicados e permitem cargas de trabalho que exigem muita capacidade de computação.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-316">Low-priority nodes are less expensive per hour than dedicated nodes, and enable workloads requiring a lot of compute power.</span></span> <span data-ttu-id="aa2e8-317">Para obter mais informações, consulte [Usar VMs de baixa prioridade com o Lote](batch-low-pri-vms.md).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-317">For more information, see [Use low-priority VMs with Batch](batch-low-pri-vms.md).</span></span>

    <span data-ttu-id="aa2e8-318">Pode ocorrer preempção de nós de computação de baixa prioridade quando o Azure tem capacidade excedente insuficiente.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-318">Low-priority compute nodes may be preempted when Azure has insufficient surplus capacity.</span></span> <span data-ttu-id="aa2e8-319">Se ocorrer preempção de um nó durante a execução de tarefas, as tarefas serão retiradas da fila e executadas novamente depois que um nó de computação ficar disponível novamente.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-319">If a node is preempted while running tasks, the tasks are requeued and run again once a compute node becomes available again.</span></span> <span data-ttu-id="aa2e8-320">Nós de baixa prioridade são uma boa opção para cargas de trabalho nas quais o tempo para conclusão do trabalho é flexível e o trabalho é distribuído entre muitos nós.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-320">Low-priority nodes are a good option for workloads where the job completion time is flexible and the work is distributed across many nodes.</span></span> <span data-ttu-id="aa2e8-321">Antes de decidir usar nós de baixa prioridade para seu cenário, verifique se os trabalhos perdidos devido a preempção serão poucos e fáceis de se recriar.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-321">Before you decide to use low-priority nodes for your scenario, make sure that any work lost due to preemption will be minimal and easy to recreate.</span></span>

    <span data-ttu-id="aa2e8-322">Nós de computação de baixa prioridade estão disponíveis apenas para contas de Lote criadas com o modo de alocação do pool definido para **Serviço em Lotes**.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-322">Low-priority compute nodes are available only for Batch accounts created with the pool allocation mode set to **Batch Service**.</span></span>

<span data-ttu-id="aa2e8-323">Você pode ter nós de computação de baixa prioridade e dedicados no mesmo pool.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-323">You can have both low-priority and dedicated compute nodes in the same pool.</span></span> <span data-ttu-id="aa2e8-324">Cada tipo de nó &mdash; dedicado e de baixa prioridade &mdash; tem sua própria configuração de destino, para que você pode especificar o número desejado de nós.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-324">Each type of node &mdash; low-priority and dedicated &mdash; has its own target setting, for which you can specify the desired number of nodes.</span></span> 
    
<span data-ttu-id="aa2e8-325">O número de nós de computação é conhecido como um *destino* porque, em algumas situações, o pool pode não alcançar o número desejado de nós.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-325">The number of compute nodes is referred to as a *target* because, in some situations, your pool might not reach the desired number of nodes.</span></span> <span data-ttu-id="aa2e8-326">Por exemplo, um pool talvez não alcance o destino se ele atingir a [cota de núcleo](batch-quota-limit.md) da conta do Lote primeiro.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-326">For example, a pool might not achieve the target if it reaches the [core quota](batch-quota-limit.md) for your Batch account first.</span></span> <span data-ttu-id="aa2e8-327">Ou então, o pool poderá não alcançar o destino se você tiver aplicado uma fórmula de dimensionamento automático que limita o número máximo de nós ao pool.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-327">Or, the pool might not achieve the target if you have applied an auto-scaling formula to the pool that limits the maximum number of nodes.</span></span>

<span data-ttu-id="aa2e8-328">Para informações sobre preços de ambos os nós de computação de baixa prioridade e dedicado, consulte [Preços de Lote](https://azure.microsoft.com/pricing/details/batch/).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-328">For pricing information for both low-priority and dedicated compute nodes, see [Batch Pricing](https://azure.microsoft.com/pricing/details/batch/).</span></span>

### <a name="size-of-the-compute-nodes"></a><span data-ttu-id="aa2e8-329">Tamanho dos nós de computação</span><span class="sxs-lookup"><span data-stu-id="aa2e8-329">Size of the compute nodes</span></span>

<span data-ttu-id="aa2e8-330">**Configuração dos Serviços de Nuvem** são listados em [Tamanhos para Serviços de Nuvem](../cloud-services/cloud-services-sizes-specs.md).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-330">**Cloud Services Configuration** compute node sizes are listed in [Sizes for Cloud Services](../cloud-services/cloud-services-sizes-specs.md).</span></span> <span data-ttu-id="aa2e8-331">O Lote dá suporte a todos os tamanhos de Serviços de Nuvem, exceto `ExtraSmall`, `STANDARD_A1_V2` e `STANDARD_A2_V2`.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-331">Batch supports all Cloud Services sizes except `ExtraSmall`, `STANDARD_A1_V2`, and `STANDARD_A2_V2`.</span></span>

<span data-ttu-id="aa2e8-332">Os tamanhos de nós de computação da **Configuração de Máquina Virtual** são listados em [Tamanhos de máquinas virtuais no Azure](../virtual-machines/linux/sizes.md) (Linux) e [Tamanhos de máquinas virtuais no Azure](../virtual-machines/windows/sizes.md) (Windows).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-332">**Virtual Machine Configuration** compute node sizes are listed in [Sizes for virtual machines in Azure](../virtual-machines/linux/sizes.md) (Linux) and [Sizes for virtual machines in Azure](../virtual-machines/windows/sizes.md) (Windows).</span></span> <span data-ttu-id="aa2e8-333">O Lote dá suporte a todos os tamanhos de VM do Azure, exceto `STANDARD_A0` e aqueles com armazenamento premium (série `STANDARD_GS`, `STANDARD_DS` e `STANDARD_DSV2`).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-333">Batch supports all Azure VM sizes except `STANDARD_A0` and those with premium storage (`STANDARD_GS`, `STANDARD_DS`, and `STANDARD_DSV2` series).</span></span>

<span data-ttu-id="aa2e8-334">Ao selecionar um tamanho de nó de computação, considere as características e os requisitos dos aplicativos que você vai executar nos nós.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-334">When selecting a compute node size, consider the characteristics and requirements of the applications you'll run on the nodes.</span></span> <span data-ttu-id="aa2e8-335">Os aspectos como se o aplicativo tem multithread e quanta memória ele consome podem ajudar a determinar o tamanho do nó mais adequado e econômico.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-335">Aspects like whether the application is multithreaded and how much memory it consumes can help determine the most suitable and cost-effective node size.</span></span> <span data-ttu-id="aa2e8-336">Geralmente, você seleciona um tamanho de nó supondo que uma tarefa seja executada no nó por vez.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-336">It's typical to select a node size assuming one task will run on a node at a time.</span></span> <span data-ttu-id="aa2e8-337">No entanto, é possível ter várias tarefas (e, portanto, várias instâncias do aplicativo) [executadas em paralelo](batch-parallel-node-tasks.md) em nós de computação durante a execução do trabalho.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-337">However, it is possible to have multiple tasks (and therefore multiple application instances) [run in parallel](batch-parallel-node-tasks.md) on compute nodes during job execution.</span></span> <span data-ttu-id="aa2e8-338">Nesse caso, é comum escolher um tamanho maior de nó para acomodar a demanda crescente de execução de tarefas paralelas.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-338">In this case, it is common to choose a larger node size to accommodate the increased demand of parallel task execution.</span></span> <span data-ttu-id="aa2e8-339">Confira [Política de agendamento](#task-scheduling-policy) de tarefas para obter mais informações.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-339">See [Task scheduling policy](#task-scheduling-policy) for more information.</span></span>

<span data-ttu-id="aa2e8-340">Todos os nós em um pool têm o mesmo tamanho.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-340">All of the nodes in a pool are the same size.</span></span> <span data-ttu-id="aa2e8-341">Se você pretende executar aplicativos com diferentes requisitos de sistema e/ou níveis de carga, é recomendável usar pools separados.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-341">If you intend to run applications with differing system requirements and/or load levels, we recommend that you use separate pools.</span></span>

### <a name="scaling-policy"></a><span data-ttu-id="aa2e8-342">Política de dimensionamento</span><span class="sxs-lookup"><span data-stu-id="aa2e8-342">Scaling policy</span></span>

<span data-ttu-id="aa2e8-343">Para as cargas de trabalho dinâmicas, você pode gravar e aplicar uma [fórmula de dimensionamento automático](#scaling-compute-resources) em um pool.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-343">For dynamic workloads, you can write and apply an [auto-scaling formula](#scaling-compute-resources) to a pool.</span></span> <span data-ttu-id="aa2e8-344">O serviço de Lote avalia periodicamente a fórmula e ajusta o número de nós no pool com base em vários parâmetros do pool, trabalho e tarefa que você pode especificar.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-344">The Batch service periodically evaluates your formula and adjusts the number of nodes within the pool based on various pool, job, and task parameters that you can specify.</span></span>

### <a name="task-scheduling-policy"></a><span data-ttu-id="aa2e8-345">Política de agendamento de tarefas</span><span class="sxs-lookup"><span data-stu-id="aa2e8-345">Task scheduling policy</span></span>

<span data-ttu-id="aa2e8-346">A opção de configuração [máx. de tarefas por nó](batch-parallel-node-tasks.md) determina o número máximo de tarefas que podem ser executadas em paralelo em cada nó de computação no pool.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-346">The [max tasks per node](batch-parallel-node-tasks.md) configuration option determines the maximum number of tasks that can be run in parallel on each compute node within the pool.</span></span>

<span data-ttu-id="aa2e8-347">A configuração padrão especifica que uma tarefa de cada vez seja executada em um nó, mas há situações em que é útil ter duas ou mais tarefas executadas simultaneamente em um nó.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-347">The default configuration specifies that one task at a time runs on a node, but there are scenarios where it is beneficial to have two or more tasks executed on a node simultaneously.</span></span> <span data-ttu-id="aa2e8-348">Veja o [cenário de exemplo](batch-parallel-node-tasks.md#example-scenario) no artigo sobre as [tarefas de nó simultâneas](batch-parallel-node-tasks.md) para ver como você pode aproveitar as várias tarefas por nó.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-348">See the [example scenario](batch-parallel-node-tasks.md#example-scenario) in the [concurrent node tasks](batch-parallel-node-tasks.md) article to see how you can benefit from multiple tasks per node.</span></span>

<span data-ttu-id="aa2e8-349">Você também pode especificar um *tipo de preenchimento* que determina se o Lote distribui as tarefas igualmente entre todos os nós de um pool ou empacota cada nó com o número máximo de tarefas antes de atribuir tarefas a outro nó.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-349">You can also specify a *fill type* which determines whether Batch spreads the tasks evenly across all nodes in a pool, or packs each node with the maximum number of tasks before assigning tasks to another node.</span></span>

### <a name="communication-status-for-compute-nodes"></a><span data-ttu-id="aa2e8-350">Status de comunicação de nós de computação</span><span class="sxs-lookup"><span data-stu-id="aa2e8-350">Communication status for compute nodes</span></span>

<span data-ttu-id="aa2e8-351">Na maioria dos cenários, as tarefas operam de forma independente e não precisam comunicar-se umas com as outras.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-351">In most scenarios, tasks operate independently and do not need to communicate with one another.</span></span> <span data-ttu-id="aa2e8-352">No entanto, há alguns aplicativos em que as tarefas precisam se comunicar, como os [cenários MPI](batch-mpi.md).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-352">However, there are some applications in which tasks must communicate, like [MPI scenarios](batch-mpi.md).</span></span>

<span data-ttu-id="aa2e8-353">Você pode configurar um pool para permitir a  **comunicação entre os nós**, de modo que os nós em um pool possam comunicar-se durante a execução.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-353">You can configure a pool to allow **internode communication**, so that nodes within a pool can communicate at runtime.</span></span> <span data-ttu-id="aa2e8-354">Quando a comunicação entre nós é habilitada, os nós nos pools de Configuração dos Serviços de Nuvem podem comunicar-se uns com os outros nas portas acima de 1100 e os pools de Configuração da Máquina Virtual não restringem o tráfego em nenhuma porta.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-354">When internode communication is enabled, nodes in Cloud Services Configuration pools can communicate with each other on ports greater than 1100, and Virtual Machine Configuration pools do not restrict traffic on any port.</span></span>

<span data-ttu-id="aa2e8-355">Observe que habilitar a comunicação entre nós também afeta a colocação dos nós nos clusters e pode limitar o número máximo de nós em um pool devido às restrições da implantação.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-355">Note that enabling internode communication also impacts the placement of the nodes within clusters and might limit the maximum number of nodes in a pool because of deployment restrictions.</span></span> <span data-ttu-id="aa2e8-356">Se seu aplicativo não precisar da comunicação entre os nós, o serviço de Lote poderá alocar um número potencialmente grande de nós para o pool a partir de vários clusters e data centers diferentes para permitir uma capacidade maior do processamento paralelo.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-356">If your application does not require communication between nodes, the Batch service can allocate a potentially large number of nodes to the pool from many different clusters and datacenters to enable increased parallel processing power.</span></span>

### <a name="start-tasks-for-compute-nodes"></a><span data-ttu-id="aa2e8-357">Tarefas iniciais para nós de computação</span><span class="sxs-lookup"><span data-stu-id="aa2e8-357">Start tasks for compute nodes</span></span>

<span data-ttu-id="aa2e8-358">A *tarefa inicial* opcional é executada em cada nó quando ele ingressa no pool e sempre que um nó é reiniciado ou sua imagem é refeita.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-358">The optional *start task* executes on each node as that node joins the pool, and each time a node is restarted or reimaged.</span></span> <span data-ttu-id="aa2e8-359">A tarefa inicial é particularmente útil para preparar nós de computação para a execução de tarefas, como instalar aplicativos que as tarefas executarão nos nós de computação.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-359">The start task is especially useful for preparing compute nodes for the execution of tasks, like installing the applications that your tasks run on the compute nodes.</span></span>

### <a name="application-packages"></a><span data-ttu-id="aa2e8-360">pacotes de aplicativos</span><span class="sxs-lookup"><span data-stu-id="aa2e8-360">Application packages</span></span>

<span data-ttu-id="aa2e8-361">Você pode especificar [pacotes de aplicativos](#application-packages) para implantar os nós de computação no pool.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-361">You can specify [application packages](#application-packages) to deploy to the compute nodes in the pool.</span></span> <span data-ttu-id="aa2e8-362">Os pacotes de aplicativos fornecem uma implantação simplificada e controle de versão dos aplicativos que suas tarefas executam.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-362">Application packages provide simplified deployment and versioning of the applications that your tasks run.</span></span> <span data-ttu-id="aa2e8-363">Os pacotes de aplicativos que você especifica para um pool são instalados em cada nó que ingressa no pool e sempre que um nó é reinicializado ou sua imagem é recriada.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-363">Application packages that you specify for a pool are installed on every node that joins that pool, and every time a node is rebooted or reimaged.</span></span>

> [!NOTE]
> <span data-ttu-id="aa2e8-364">Os pacotes de aplicativos têm suporte em todos os pools do Lote criados após 5 de julho de 2017.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-364">Application packages are supported on all Batch pools created after 5 July 2017.</span></span> <span data-ttu-id="aa2e8-365">Elas só terão suporte em pools do Lote criados entre 10 de março de 2016 e 5 de julho de 2017 se o pool tiver sido criado usando uma configuração de Serviço de Nuvem.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-365">They are supported on Batch pools created between 10 March 2016 and 5 July 2017 only if the pool was created using a Cloud Service configuration.</span></span> <span data-ttu-id="aa2e8-366">Os pools do Lote criados antes de 10 de março de 2016 não dão suporte a pacotes de aplicativos.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-366">Batch pools created prior to 10 March 2016 do not support application packages.</span></span> <span data-ttu-id="aa2e8-367">Para saber mais sobre como usar pacotes de aplicativos para implantar os aplicativos nos nós do Lote, veja [Implantar aplicativos em nós de computação com pacotes de aplicativos do Lote](batch-application-packages.md).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-367">For more information about using application packages to deploy your applications to your Batch nodes, see [Deploy applications to compute nodes with Batch application packages](batch-application-packages.md).</span></span>
>
>

### <a name="network-configuration"></a><span data-ttu-id="aa2e8-368">Configuração de rede</span><span class="sxs-lookup"><span data-stu-id="aa2e8-368">Network configuration</span></span>

<span data-ttu-id="aa2e8-369">Você pode especificar a sub-rede de uma [rede virtual (VNet)](../virtual-network/virtual-networks-overview.md) do Azure em que nós de computação do pool devem ser criados.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-369">You can specify the subnet of an Azure [virtual network (VNet)](../virtual-network/virtual-networks-overview.md) in which the pool's compute nodes should be created.</span></span> <span data-ttu-id="aa2e8-370">Veja a seção [Configuração de rede do pool](#pool-network-configuration) para obter mais informações.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-370">See the [Pool network configuration](#pool-network-configuration) section for more information.</span></span>


## <a name="job"></a><span data-ttu-id="aa2e8-371">Trabalho</span><span class="sxs-lookup"><span data-stu-id="aa2e8-371">Job</span></span>
<span data-ttu-id="aa2e8-372">Um trabalho é uma coleção de tarefas.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-372">A job is a collection of tasks.</span></span> <span data-ttu-id="aa2e8-373">Ele gerencia como a computação é realizada por suas tarefas nos nós de computação em um pool.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-373">It manages how computation is performed by its tasks on the compute nodes in a pool.</span></span>

* <span data-ttu-id="aa2e8-374">O trabalho especifica o **pool** no qual o trabalho é executado.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-374">The job specifies the **pool** in which the work is to be run.</span></span> <span data-ttu-id="aa2e8-375">Você pode criar um novo pool para cada trabalho ou usar um pool para vários trabalhos.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-375">You can create a new pool for each job, or use one pool for many jobs.</span></span> <span data-ttu-id="aa2e8-376">Você pode criar um pool para cada trabalho associado a um agendamento de trabalho ou para todos os trabalhos associados a um agendamento de trabalho.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-376">You can create a pool for each job that is associated with a job schedule, or for all jobs that are associated with a job schedule.</span></span>
* <span data-ttu-id="aa2e8-377">Você pode especificar uma **prioridade de trabalho**opcional.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-377">You can specify an optional **job priority**.</span></span> <span data-ttu-id="aa2e8-378">Quando um trabalho é enviado com uma prioridade mais alta que os trabalhos em andamento atualmente, as tarefas do trabalho com prioridade mais alta são inseridas na fila antes das tarefas dos trabalhos com prioridade mais baixa.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-378">When a job is submitted with a higher priority than jobs that are currently in progress, the tasks for the higher-priority job are inserted into the queue ahead of tasks for the lower-priority jobs.</span></span> <span data-ttu-id="aa2e8-379">As tarefas com prioridade mais baixa que já estejam em execução não são antecipadas.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-379">Tasks in lower-priority jobs that are already running are not preempted.</span></span>
* <span data-ttu-id="aa2e8-380">Você pode usar as restrições do **trabalho** para especificar certos limites para seus trabalhos:</span><span class="sxs-lookup"><span data-stu-id="aa2e8-380">You can use job **constraints** to specify certain limits for your jobs:</span></span>

    <span data-ttu-id="aa2e8-381">Você pode definir uma **hora do relógio máxima**, de modo que se um trabalho for executado por mais tempo que a hora do relógio máxima especificada, o trabalho e todas as suas tarefas serão encerrados.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-381">You can set a **maximum wallclock time**, so that if a job runs for longer than the maximum wallclock time that is specified, the job and all of its tasks are terminated.</span></span>

    <span data-ttu-id="aa2e8-382">O Lote pode detectar e repetir as tarefas com falha.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-382">Batch can detect and then retry failed tasks.</span></span> <span data-ttu-id="aa2e8-383">Você pode especificar o **número máximo de tentativas de tarefa** como uma restrição, inclusive se uma tarefa é repetida *sempre* ou *nunca* é repetida.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-383">You can specify the **maximum number of task retries** as a constraint, including whether a task is *always* or *never* retried.</span></span> <span data-ttu-id="aa2e8-384">Repetir uma tarefa significa que a tarefa é colocada na fila para ser executada novamente.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-384">Retrying a task means that the task is requeued to be run again.</span></span>
* <span data-ttu-id="aa2e8-385">O aplicativo do cliente pode adicionar tarefas a um trabalho ou você pode especificar uma [tarefa do gerenciador de trabalhos](#job-manager-task).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-385">Your client application can add tasks to a job, or you can specify a [job manager task](#job-manager-task).</span></span> <span data-ttu-id="aa2e8-386">Uma tarefa do gerenciador de trabalhos contém as informações necessárias para criar as tarefas necessárias para um trabalho, com a tarefa do gerenciador de trabalhos sendo executada em um de nós de computação no pool.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-386">A job manager task contains the information that is necessary to create the required tasks for a job, with the job manager task being run on one of the compute nodes in the pool.</span></span> <span data-ttu-id="aa2e8-387">A tarefa do gerenciador de trabalhos é tratada especificamente pelo Lote – ela é colocada na fila assim que o trabalho é criado e é reiniciada, caso falhe.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-387">The job manager task is handled specifically by Batch--it is queued as soon as the job is created, and is restarted if it fails.</span></span> <span data-ttu-id="aa2e8-388">Uma tarefa do gerenciador de trabalhos é *necessária* para os trabalhos criados por um [agendamento de trabalho](#scheduled-jobs) , pois é a única maneira de definir as tarefas antes do trabalho ser instanciado.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-388">A job manager task is *required* for jobs that are created by a [job schedule](#scheduled-jobs) because it is the only way to define the tasks before the job is instantiated.</span></span>
* <span data-ttu-id="aa2e8-389">Por padrão, os trabalhos permanecem no estado ativo quando todas as tarefas no trabalho são concluídas.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-389">By default, jobs remain in the active state when all tasks within the job are complete.</span></span> <span data-ttu-id="aa2e8-390">Você pode alterar esse comportamento para que o trabalho seja encerrado automaticamente quando todas as tarefas no trabalho forem concluídas.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-390">You can change this behavior so that the job is automatically terminated when all tasks in the job are complete.</span></span> <span data-ttu-id="aa2e8-391">Defina a propriedade **onAllTasksComplete** do trabalho ([OnAllTasksComplete][net_onalltaskscomplete] no .NET do Lote) para *terminatejob* para encerrar automaticamente o trabalho quando todas as tarefas estão no estado concluído.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-391">Set the job's **onAllTasksComplete** property ([OnAllTasksComplete][net_onalltaskscomplete] in Batch .NET) to *terminatejob* to automatically terminate the job when all of its tasks are in the completed state.</span></span>

    <span data-ttu-id="aa2e8-392">Observe que o serviço de Lote considera que um trabalho *sem* tarefas tem todas as suas tarefas concluídas.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-392">Note that the Batch service considers a job with *no* tasks to have all of its tasks completed.</span></span> <span data-ttu-id="aa2e8-393">Portanto, essa opção é mais comumente usada com uma [tarefa do gerenciador de trabalhos](#job-manager-task).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-393">Therefore, this option is most commonly used with a [job manager task](#job-manager-task).</span></span> <span data-ttu-id="aa2e8-394">Se você quiser usar o encerramento automático de trabalho sem um gerenciador de trabalhos, defina inicialmente a propriedade **onAllTasksComplete** de um novo trabalho como *noaction*. Depois, defina-a como *terminatejob* somente depois que você terminar de adicionar tarefas ao trabalho.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-394">If you want to use automatic job termination without a job manager, you should initially set a new job's **onAllTasksComplete** property to *noaction*, then set it to *terminatejob* only after you've finished adding tasks to the job.</span></span>

### <a name="job-priority"></a><span data-ttu-id="aa2e8-395">prioridade de trabalho</span><span class="sxs-lookup"><span data-stu-id="aa2e8-395">Job priority</span></span>
<span data-ttu-id="aa2e8-396">Você pode atribuir uma prioridade a trabalhos criados no Lote.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-396">You can assign a priority to jobs that you create in Batch.</span></span> <span data-ttu-id="aa2e8-397">O serviço Lote usa o valor da prioridade do trabalho para determinar a ordem de agendamento dos trabalhos em uma conta (isso não deve ser confundido com um [trabalho agendado](#scheduled-jobs)).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-397">The Batch service uses the priority value of the job to determine the order of job scheduling within an account (this is not to be confused with a [scheduled job](#scheduled-jobs)).</span></span> <span data-ttu-id="aa2e8-398">Os valores de prioridade variam de -1000 a 1000, em que -1000 é a prioridade mais baixa e 1000 a mais alta.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-398">The priority values range from -1000 to 1000, with -1000 being the lowest priority and 1000 being the highest.</span></span> <span data-ttu-id="aa2e8-399">Para atualizar a prioridade de um trabalho, chame a operação [Atualizar as propriedades de um trabalho] [rest_update_job] \(REST do Lote) ou modifique a propriedade [CloudJob.Priority] [net_cloudjob_priority] \(.NET do Lote).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-399">To update the priority of a job, call the [Update the properties of a job][rest_update_job] operation (Batch REST), or modify the [CloudJob.Priority][net_cloudjob_priority] property (Batch .NET).</span></span>

<span data-ttu-id="aa2e8-400">Em uma mesma conta, os trabalhos com prioridade mais alta têm precedência no agendamento sobre aqueles com prioridade mais baixa.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-400">Within the same account, higher-priority jobs have scheduling precedence over lower-priority jobs.</span></span> <span data-ttu-id="aa2e8-401">Um trabalho com valor de prioridade mais alto em uma conta não tem precedência no agendamento sobre outro trabalho com valor de prioridade mais baixo em uma conta diferente.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-401">A job with a higher-priority value in one account does not have scheduling precedence over another job with a lower-priority value in a different account.</span></span>

<span data-ttu-id="aa2e8-402">O plano de trabalho em pools é independente.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-402">Job scheduling across pools is independent.</span></span> <span data-ttu-id="aa2e8-403">Entre pools diferentes, não é garantido que um trabalho com prioridade mais alta seja agendado primeiro, caso faltem nós ociosos em seu pool associado.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-403">Between different pools, it is not guaranteed that a higher-priority job is scheduled first if its associated pool is short of idle nodes.</span></span> <span data-ttu-id="aa2e8-404">No mesmo pool, trabalhos com o mesmo nível de prioridade têm a mesma chance de ser agendados.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-404">In the same pool, jobs with the same priority level have an equal chance of being scheduled.</span></span>

### <a name="scheduled-jobs"></a><span data-ttu-id="aa2e8-405">Trabalhos agendados</span><span class="sxs-lookup"><span data-stu-id="aa2e8-405">Scheduled jobs</span></span>
<span data-ttu-id="aa2e8-406">As [Agendas de trabalho][rest_job_schedules] permitem criar trabalhos recorrentes dentro do serviço de Lote.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-406">[Job schedules][rest_job_schedules] enable you to create recurring jobs within the Batch service.</span></span> <span data-ttu-id="aa2e8-407">Um plano de trabalho especifica quando executar trabalhos e inclui as especificações para os trabalhos a serem executados.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-407">A job schedule specifies when to run jobs and includes the specifications for the jobs to be run.</span></span> <span data-ttu-id="aa2e8-408">Você pode especificar a duração do agendamento - quanto tempo e quando o agendamento entra em vigor – e com que frequência os trabalhos são criados durante o período agendado.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-408">You can specify the duration of the schedule--how long and when the schedule is in effect--and how frequently jobs are created during the scheduled period.</span></span>

## <a name="task"></a><span data-ttu-id="aa2e8-409">Tarefa</span><span class="sxs-lookup"><span data-stu-id="aa2e8-409">Task</span></span>
<span data-ttu-id="aa2e8-410">Uma tarefa é uma unidade de computação que está associada a um trabalho.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-410">A task is a unit of computation that is associated with a job.</span></span> <span data-ttu-id="aa2e8-411">Ela é executada em um nó.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-411">It runs on a node.</span></span> <span data-ttu-id="aa2e8-412">As tarefas são atribuídas a um nó para execução ou estão na fila até que um nó fique livre.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-412">Tasks are assigned to a node for execution, or are queued until a node becomes free.</span></span> <span data-ttu-id="aa2e8-413">Resumindo, uma tarefa executa um ou mais programas ou scripts em um nó de computação para executar o trabalho necessário.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-413">Put simply, a task runs one or more programs or scripts on a compute node to perform the work you need done.</span></span>

<span data-ttu-id="aa2e8-414">Ao criar uma tarefa, você pode especificar:</span><span class="sxs-lookup"><span data-stu-id="aa2e8-414">When you create a task, you can specify:</span></span>

* <span data-ttu-id="aa2e8-415">A **linha de comando** da tarefa.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-415">The **command line** for the task.</span></span> <span data-ttu-id="aa2e8-416">Essa é a linha de comando que executa o aplicativo ou script nos nós de computação.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-416">This is the command line that runs your application or script on the compute node.</span></span>

    <span data-ttu-id="aa2e8-417">É importante observar que a linha de comando realmente não é executada em um shell.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-417">It is important to note that the command line does not actually run under a shell.</span></span> <span data-ttu-id="aa2e8-418">Portanto, não é possível aproveitar nativamente os recursos do shell, como a expansão da [variável de ambiente](#environment-settings-for-tasks) (isso inclui `PATH`).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-418">Therefore, it cannot natively take advantage of shell features like [environment variable](#environment-settings-for-tasks) expansion (this includes the `PATH`).</span></span> <span data-ttu-id="aa2e8-419">Para aproveitar esses recursos, você deve chamar o shell na linha de comando – por exemplo, iniciando `cmd.exe` nos nós do Windows ou `/bin/sh` no Linux:</span><span class="sxs-lookup"><span data-stu-id="aa2e8-419">To take advantage of such features, you must invoke the shell in the command line--for example, by launching `cmd.exe` on Windows nodes or `/bin/sh` on Linux:</span></span>

    `cmd /c MyTaskApplication.exe %MY_ENV_VAR%`

    `/bin/sh -c MyTaskApplication $MY_ENV_VAR`

    <span data-ttu-id="aa2e8-420">Se as tarefas precisarem executar um aplicativo ou script que não esteja no `PATH` do nó ou fazer referência às variáveis de ambiente, chame o shell explicitamente na linha de comando da tarefa.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-420">If your tasks need to run an application or script that is not in the node's `PATH` or reference environment variables, invoke the shell explicitly in the task command line.</span></span>
* <span data-ttu-id="aa2e8-421">**Arquivos de recursos** que contêm os dados a serem processados.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-421">**Resource files** that contain the data to be processed.</span></span> <span data-ttu-id="aa2e8-422">Esses arquivos são copiados automaticamente para o nó a partir do armazenamento de Blobs em uma conta de Armazenamento do Azure geral, antes da linha de comando da tarefa ser executada.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-422">These files are automatically copied to the node from Blob storage in a general-purpose Azure Storage account before the task's command line is executed.</span></span> <span data-ttu-id="aa2e8-423">Para obter mais informações, consulte as seções [Tarefa inicial](#start-task) e [Arquivos e diretórios](#files-and-directories).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-423">For more information, see the sections [Start task](#start-task) and [Files and directories](#files-and-directories).</span></span>
* <span data-ttu-id="aa2e8-424">As **variáveis de ambiente** que são exigidas pelo aplicativo.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-424">The **environment variables** that are required by your application.</span></span> <span data-ttu-id="aa2e8-425">Para obter mais informações, consulte a seção [Configurações do ambiente para tarefas](#environment-settings-for-tasks) .</span><span class="sxs-lookup"><span data-stu-id="aa2e8-425">For more information, see the [Environment settings for tasks](#environment-settings-for-tasks) section.</span></span>
* <span data-ttu-id="aa2e8-426">As **restrições** de acordo com as quais a tarefa deve ser executada.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-426">The **constraints** under which the task should execute.</span></span> <span data-ttu-id="aa2e8-427">Por exemplo, as restrições incluem o tempo máximo que a tarefa pode ser executada, o número máximo de vezes que uma tarefa com falha deve ser repetida e o tempo máximo que os arquivos no diretório de trabalho da tarefa são mantidos.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-427">For example, constraints include the maximum time that the task is allowed to run, the maximum number of times a failed task should be retried, and the maximum time that files in the task's working directory are retained.</span></span>
* <span data-ttu-id="aa2e8-428">**Pacotes de aplicativos** para implantar no nó de computação no qual a tarefa está agendada para ser executada.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-428">**Application packages** to deploy to the compute node on which the task is scheduled to run.</span></span> <span data-ttu-id="aa2e8-429">[Application packages](#application-packages) fornecem uma implantação simplificada e controle de versão dos aplicativos que suas tarefas executam.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-429">[Application packages](#application-packages) provide simplified deployment and versioning of the applications that your tasks run.</span></span> <span data-ttu-id="aa2e8-430">Os pacotes de aplicativos de nível de tarefa são especialmente úteis em ambientes de pool compartilhado, em que diferentes trabalhos são executados em um pool e o pool não é excluído quando um trabalho é concluído.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-430">Task-level application packages are especially useful in shared-pool environments, where different jobs are run on one pool, and the pool is not deleted when a job is completed.</span></span> <span data-ttu-id="aa2e8-431">Se o trabalho tiver menos tarefas do que os nós no pool, pacotes de aplicativos de tarefa poderão minimizar a transferência de dados, pois o aplicativo é implantado apenas para os nós que executam tarefas.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-431">If your job has fewer tasks than nodes in the pool, task application packages can minimize data transfer since your application is deployed only to the nodes that run tasks.</span></span>

<span data-ttu-id="aa2e8-432">Além das tarefas que você pode definir para realizar computação em um nó, as tarefas especiais a seguir também são fornecidas pelo serviço Lote:</span><span class="sxs-lookup"><span data-stu-id="aa2e8-432">In addition to tasks you define to perform computation on a node, the following special tasks are also provided by the Batch service:</span></span>

* [<span data-ttu-id="aa2e8-433">Iniciar tarefa</span><span class="sxs-lookup"><span data-stu-id="aa2e8-433">Start task</span></span>](#start-task)
* [<span data-ttu-id="aa2e8-434">Tarefa do Gerenciador de Trabalhos</span><span class="sxs-lookup"><span data-stu-id="aa2e8-434">Job manager task</span></span>](#job-manager-task)
* [<span data-ttu-id="aa2e8-435">Tarefas de preparação e liberação do trabalho</span><span class="sxs-lookup"><span data-stu-id="aa2e8-435">Job preparation and release tasks</span></span>](#job-preparation-and-release-tasks)
* [<span data-ttu-id="aa2e8-436">MPI (Tarefas de várias instâncias)</span><span class="sxs-lookup"><span data-stu-id="aa2e8-436">Multi-instance tasks (MPI)</span></span>](#multi-instance-tasks)
* [<span data-ttu-id="aa2e8-437">Dependências da tarefa</span><span class="sxs-lookup"><span data-stu-id="aa2e8-437">Task dependencies</span></span>](#task-dependencies)

### <a name="start-task"></a><span data-ttu-id="aa2e8-438">Iniciar tarefa</span><span class="sxs-lookup"><span data-stu-id="aa2e8-438">Start task</span></span>
<span data-ttu-id="aa2e8-439">Associando uma **tarefa inicial** a um pool, você pode preparar o ambiente operacional de seus nós.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-439">By associating a **start task** with a pool, you can prepare the operating environment of its nodes.</span></span> <span data-ttu-id="aa2e8-440">Por exemplo, você pode executar ações como instalar os aplicativos que suas tarefas executarão e iniciar os processos em segundo plano.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-440">For example, you can perform actions like installing the applications that your tasks run or starting background processes.</span></span> <span data-ttu-id="aa2e8-441">A tarefa inicial é executada sempre que um nó inicia, contanto que ele permaneça no pool - incluindo quando o nó é adicionado pela primeira vez ao pool e quando ele é reiniciado ou sua imagem é recriada.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-441">The start task runs every time a node starts, for as long as it remains in the pool--including when the node is first added to the pool and when it is restarted or reimaged.</span></span>

<span data-ttu-id="aa2e8-442">O principal benefício da tarefa inicial é que ela pode conter todas as informações necessárias para configurar um nó de computação e instalar os aplicativos necessários para a execução da tarefa.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-442">A primary benefit of the start task is that it can contain all of the information that is necessary to configure a compute node and install the applications that are required for task execution.</span></span> <span data-ttu-id="aa2e8-443">Portanto, aumentar o número de nós em um pool é tão simples quanto especificar a nova contagem de nós de destino.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-443">Therefore, increasing the number of nodes in a pool is as simple as specifying the new target node count.</span></span> <span data-ttu-id="aa2e8-444">A tarefa inicial fornece ao serviço de Lote as informações necessárias para configurar os novos nós e prepará-los para a aceitação das tarefas.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-444">The start task provides the Batch service the information that is needed to configure the new nodes and get them ready for accepting tasks.</span></span>

<span data-ttu-id="aa2e8-445">Como com qualquer tarefa em Lote do Azure, você pode especificar uma lista de **arquivos de recursos** no [Armazenamento do Azure][azure_storage], além de uma **linha de comando** a ser executada.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-445">As with any Azure Batch task, you can specify a list of **resource files** in [Azure Storage][azure_storage], in addition to a **command line** to be executed.</span></span> <span data-ttu-id="aa2e8-446">Primeiro, o serviço de Lote copia os arquivos de recursos para o nó no Armazenamento do Azure, depois, executa a linha de comando.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-446">The Batch service first copies the resource files to the node from Azure Storage, and then runs the command line.</span></span> <span data-ttu-id="aa2e8-447">Para uma tarefa inicial do pool, a lista de arquivos normalmente contém o aplicativo da tarefa e suas dependências.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-447">For a pool start task, the file list typically contains the task application and its dependencies.</span></span>

<span data-ttu-id="aa2e8-448">No entanto, ela também pode incluir os dados de referência a serem usados por todas as tarefas em execução no nó de computação.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-448">However, the start task could also include reference data to be used by all tasks that are running on the compute node.</span></span> <span data-ttu-id="aa2e8-449">Por exemplo, a linha de comando da tarefa inicial pode executar uma `robocopy` operação para copiar os arquivos do aplicativo (que foram especificados como arquivos de recurso e baixados para o nó) do [diretório de trabalho](#files-and-directories) da tarefa inicial para a [pasta compartilhada](#files-and-directories), em seguida, executar um MSI ou `setup.exe`.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-449">For example, a start task's command line could perform a `robocopy` operation to copy application files (which were specified as resource files and downloaded to the node) from the start task's [working directory](#files-and-directories) to the [shared folder](#files-and-directories), and then run an MSI or `setup.exe`.</span></span>

<span data-ttu-id="aa2e8-450">Geralmente é desejável que o serviço de Lote aguarde a conclusão da tarefa inicial antes de considerar o nó pronto para ter tarefas atribuídas, mas isso pode ser configurado.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-450">It is typically desirable for the Batch service to wait for the start task to complete before considering the node ready to be assigned tasks, but you can configure this.</span></span>

<span data-ttu-id="aa2e8-451">Se uma tarefa de inicialização falhar em um nó de computação, o estado do nó será atualizado para refletir a falha e o nó não tem nenhuma tarefa atribuída a ele.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-451">If a start task fails on a compute node, then the state of the node is updated to reflect the failure, and the node is not assigned any tasks.</span></span> <span data-ttu-id="aa2e8-452">Uma tarefa inicial poderá falhar se houver um problema ao copiar seus arquivos de recursos do armazenamento ou se o processo executado por sua linha de comando retornar um código de saída diferente de zero.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-452">A start task can fail if there is an issue copying its resource files from storage, or if the process executed by its command line returns a nonzero exit code.</span></span>

<span data-ttu-id="aa2e8-453">Se você adicionar ou atualizar a tarefa inicial para um pool existente , deverá reinicializar seus nós de computação para que a tarefa inicial seja aplicada aos nós.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-453">If you add or update the start task for an existing pool, you must reboot its compute nodes for the start task to be applied to the nodes.</span></span>

>[!NOTE]
> <span data-ttu-id="aa2e8-454">O tamanho total de uma tarefa de início deve ser menor ou igual a 32768 caracteres, incluindo arquivos de recurso e variáveis de ambiente.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-454">The total size of a start task must be less than or equal to 32768 characters, including resource files and environment variables.</span></span> <span data-ttu-id="aa2e8-455">Para garantir que a tarefa de início atenda a esse requisito, você pode usar uma das duas abordagens:</span><span class="sxs-lookup"><span data-stu-id="aa2e8-455">To ensure that your start task meets this requirement, you can use one of two approaches:</span></span>
>
> 1. <span data-ttu-id="aa2e8-456">Você pode usar pacotes de aplicativos para distribuir aplicativos ou dados em cada nó no pool do Lote.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-456">You can use application packages to distribute applications or data across each node in your Batch pool.</span></span> <span data-ttu-id="aa2e8-457">Para saber mais sobre pacotes de aplicativos, veja [Implantar aplicativos em nós de computação com pacotes de aplicativos do Lote](batch-application-packages.md).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-457">For more information about application packages, see [Deploy applications to compute nodes with Batch application packages](batch-application-packages.md).</span></span>
> 2. <span data-ttu-id="aa2e8-458">Você pode criar um arquivo compactado que contém os arquivos de aplicativos manualmente.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-458">You can manually create a zipped archive containing your applications files.</span></span> <span data-ttu-id="aa2e8-459">Carregue seu arquivo compactado no Armazenamento do Azure como um blob.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-459">Upload your zipped archive to Azure Storage as a blob.</span></span> <span data-ttu-id="aa2e8-460">Especifique o arquivo compactado como um arquivo de recurso para a tarefa de início.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-460">Specify the zipped archive as a resource file for your start task.</span></span> <span data-ttu-id="aa2e8-461">Antes de executar a linha de comando para a tarefa de início, descompacte o arquivo da linha de comando.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-461">Before you run the command line for your start task, unzip the archive from the command line.</span></span> 
>
>    <span data-ttu-id="aa2e8-462">Para descompactar o arquivo, você pode usar sua ferramenta de arquivamento preferida.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-462">To unzip the archive, you can use the archiving tool of your choice.</span></span> <span data-ttu-id="aa2e8-463">Você precisará incluir a ferramenta usada para descompactar o arquivo como um arquivo de recurso para a tarefa inicial.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-463">You will need to include the tool that you use to unzip the archive as a resource file for the start task.</span></span>
>
>

### <a name="job-manager-task"></a><span data-ttu-id="aa2e8-464">Tarefa do Gerenciador de Trabalhos</span><span class="sxs-lookup"><span data-stu-id="aa2e8-464">Job manager task</span></span>
<span data-ttu-id="aa2e8-465">Você geralmente usa uma **tarefa do gerenciador de trabalhos** para controlar e/ou monitorar a execução do trabalho — por exemplo, para criar e enviar tarefas para um trabalho, determinar as tarefas adicionais a executar e quando o trabalho é concluído.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-465">You typically use a **job manager task** to control and/or monitor job execution--for example, to create and submit the tasks for a job, determine additional tasks to run, and determine when work is complete.</span></span> <span data-ttu-id="aa2e8-466">No entanto, uma tarefa do gerenciador de trabalhos não está limitada a essas atividades.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-466">However, a job manager task is not restricted to these activities.</span></span> <span data-ttu-id="aa2e8-467">É uma tarefa completa que pode executar as ações necessárias para o trabalho.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-467">It is a fully fledged task that can perform any actions that are required for the job.</span></span> <span data-ttu-id="aa2e8-468">Por exemplo, uma tarefa do gerenciador de trabalhos pode baixar um arquivo especificado como um parâmetro, analisar o conteúdo desse arquivo e enviar tarefas adicionais com base no conteúdo.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-468">For example, a job manager task might download a file that is specified as a parameter, analyze the contents of that file, and submit additional tasks based on those contents.</span></span>

<span data-ttu-id="aa2e8-469">Uma tarefa do gerenciador de trabalho é iniciada antes de todas as outras tarefas.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-469">A job manager task is started before all other tasks.</span></span> <span data-ttu-id="aa2e8-470">Ela fornece os seguintes recursos:</span><span class="sxs-lookup"><span data-stu-id="aa2e8-470">It provides the following features:</span></span>

* <span data-ttu-id="aa2e8-471">Ela é criada automaticamente pelo serviço Lote quando o trabalho é criado.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-471">It is automatically submitted as a task by the Batch service when the job is created.</span></span>
* <span data-ttu-id="aa2e8-472">É agendada para execução antes das outras tarefas em um trabalho.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-472">It is scheduled to execute before the other tasks in a job.</span></span>
* <span data-ttu-id="aa2e8-473">O nó associado é o último a ser removido de um pool quando o pool está sendo reduzido.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-473">Its associated node is the last to be removed from a pool when the pool is being downsized.</span></span>
* <span data-ttu-id="aa2e8-474">Seu término pode ser vinculado ao término de todas as tarefas existentes no trabalho.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-474">Its termination can be tied to the termination of all tasks in the job.</span></span>
* <span data-ttu-id="aa2e8-475">Uma tarefa do gerenciador de trabalhos tem a prioridade mais alta quando precisa ser reiniciada.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-475">A job manager task is given the highest priority when it needs to be restarted.</span></span> <span data-ttu-id="aa2e8-476">Se não houver um nó ocioso disponível, o serviço de Lote poderá encerrar uma das outras tarefas em execução no pool para liberar espaço para a tarefa do gerenciador de trabalhos ser executada.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-476">If an idle node is not available, the Batch service might terminate one of the other running tasks in the pool to make room for the job manager task to run.</span></span>
* <span data-ttu-id="aa2e8-477">Uma tarefa de gerenciador de trabalhos em um trabalho não tem prioridade sobre tarefas em outros trabalhos.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-477">A job manager task in one job does not have priority over the tasks of other jobs.</span></span> <span data-ttu-id="aa2e8-478">Entre diferentes trabalhos, somente as prioridades de nível de trabalho são observadas.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-478">Across jobs, only job-level priorities are observed.</span></span>

### <a name="job-preparation-and-release-tasks"></a><span data-ttu-id="aa2e8-479">Tarefas de preparação e liberação do trabalho</span><span class="sxs-lookup"><span data-stu-id="aa2e8-479">Job preparation and release tasks</span></span>
<span data-ttu-id="aa2e8-480">O Lote fornece tarefas de preparação do trabalho para a instalação de execução pré-trabalho.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-480">Batch provides job preparation tasks for pre-job execution setup.</span></span> <span data-ttu-id="aa2e8-481">As tarefas de liberação do trabalho são para a manutenção ou a limpeza pós-trabalho.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-481">Job release tasks are for post-job maintenance or cleanup.</span></span>

* <span data-ttu-id="aa2e8-482">**Tarefa de preparação do trabalho**– a tarefa de preparação do trabalho é executada em todos os nós de computação agendados para executar as tarefas, antes de qualquer outra tarefa do trabalho ser executada.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-482">**Job preparation task**: A job preparation task runs on all compute nodes that are scheduled to run tasks, before any of the other job tasks are executed.</span></span> <span data-ttu-id="aa2e8-483">É possível usar a tarefa de preparação do trabalho para copiar os dados compartilhados por todas as tarefas, mas é exclusiva para o trabalho, por exemplo.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-483">You can use a job preparation task to copy data that is shared by all tasks, but is unique to the job, for example.</span></span>
* <span data-ttu-id="aa2e8-484">**Tarefa de liberação do trabalho**– quando o trabalho for concluído, a tarefa de liberação do trabalho será executada em cada nó no pool que executou pelo menos uma tarefa.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-484">**Job release task**: When a job has completed, a job release task runs on each node in the pool that executed at least one task.</span></span> <span data-ttu-id="aa2e8-485">É possível usar a tarefa de liberação do trabalho para excluir os dados copiados pela tarefa de preparação do trabalho ou compactar e carregar os dados do log de diagnóstico, por exemplo.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-485">You can use a job release task to delete data that is copied by the job preparation task, or to compress and upload diagnostic log data, for example.</span></span>

<span data-ttu-id="aa2e8-486">As tarefas de preparação e liberação do trabalho permitem especificar uma linha de comando a ser executada quando a tarefa é chamada.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-486">Both job preparation and release tasks allow you to specify a command line to run when the task is invoked.</span></span> <span data-ttu-id="aa2e8-487">Elas oferecem recursos, como download de arquivo, execução elevada, variáveis de ambiente personalizadas, duração máxima da execução, contagem de repetição e tempo de retenção do arquivo.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-487">They offer features like file download, elevated execution, custom environment variables, maximum execution duration, retry count, and file retention time.</span></span>

<span data-ttu-id="aa2e8-488">Para saber mais sobre tarefas de preparação e de liberação de trabalho, consulte [Executar tarefas de preparação e de conclusão de trabalhos em nós de computação do Lote do Azure](batch-job-prep-release.md).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-488">For more information on job preparation and release tasks, see [Run job preparation and completion tasks on Azure Batch compute nodes](batch-job-prep-release.md).</span></span>

### <a name="multi-instance-task"></a><span data-ttu-id="aa2e8-489">Tarefa de várias instâncias</span><span class="sxs-lookup"><span data-stu-id="aa2e8-489">Multi-instance task</span></span>
<span data-ttu-id="aa2e8-490">Uma [tarefa de várias instâncias](batch-mpi.md) é a que é configurada para ser executada simultaneamente em mais de um nó de computação.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-490">A [multi-instance task](batch-mpi.md) is a task that is configured to run on more than one compute node simultaneously.</span></span> <span data-ttu-id="aa2e8-491">Com as tarefas de várias instâncias, você pode habilitar os cenários de computação de alto desempenho, que requerem um grupo de nós de computação alocados juntos para processar uma única carga de trabalho (como a Interface de Troca de Mensagens (MPI)).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-491">With multi-instance tasks, you can enable high-performance computing scenarios that require a group of compute nodes that are allocated together to process a single workload (like Message Passing Interface (MPI)).</span></span>

<span data-ttu-id="aa2e8-492">Para obter uma análise detalhada sobre como executar os trabalhos da MPI no Lote usando a biblioteca .NET do Lote, confira [Usar tarefas de várias instâncias para executar os aplicativos da MPI (Interface de Troca de Mensagens) no Lote do Azure](batch-mpi.md).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-492">For a detailed discussion on running MPI jobs in Batch by using the Batch .NET library, check out [Use multi-instance tasks to run Message Passing Interface (MPI) applications in Azure Batch](batch-mpi.md).</span></span>

### <a name="task-dependencies"></a><span data-ttu-id="aa2e8-493">Dependências da tarefa</span><span class="sxs-lookup"><span data-stu-id="aa2e8-493">Task dependencies</span></span>
<span data-ttu-id="aa2e8-494">As [dependências de tarefas](batch-task-dependencies.md), como o nome indica, permitem especificar que uma tarefa depende da conclusão de outras tarefas antes de sua execução.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-494">[Task dependencies](batch-task-dependencies.md), as the name implies, allow you to specify that a task depends on the completion of other tasks before its execution.</span></span> <span data-ttu-id="aa2e8-495">Este recurso fornece suporte para situações em que uma tarefa "downstream" consome a saída de uma tarefa "upstream" - ou quando uma tarefa upstream executa alguma inicialização necessária para uma tarefa downstream.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-495">This feature provides support for situations in which a "downstream" task consumes the output of an "upstream" task--or when an upstream task performs some initialization that is required by a downstream task.</span></span> <span data-ttu-id="aa2e8-496">Para usar esse recurso, primeiro você deve habilitar as dependências em seu trabalho do Lote.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-496">To use this feature, you must first enable task dependencies on your Batch job.</span></span> <span data-ttu-id="aa2e8-497">Em seguida, para cada tarefa que dependa de outra (ou de muitas outras), especifique as tarefas das quais essa tarefa depende.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-497">Then, for each task that depends on another (or many others), you specify the tasks which that task depends on.</span></span>

<span data-ttu-id="aa2e8-498">Com as dependências de tarefas, você pode configurar cenários como o seguinte:</span><span class="sxs-lookup"><span data-stu-id="aa2e8-498">With task dependencies, you can configure scenarios like the following:</span></span>

* <span data-ttu-id="aa2e8-499">A *tarefaB* depende da *tarefaA* (a *tarefaB* não começará sua execução até que a *tarefaA* tenha terminado).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-499">*taskB* depends on *taskA* (*taskB* will not begin execution until *taskA* has completed).</span></span>
* <span data-ttu-id="aa2e8-500">A *tarefaC* depende da *tarefaA* e da *tarefaB*.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-500">*taskC* depends on both *taskA* and *taskB*.</span></span>
* <span data-ttu-id="aa2e8-501">A *tarefaD* depende de várias tarefas, como as tarefas de *1* a *10*, antes de ser executada.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-501">*taskD* depends on a range of tasks, such as tasks *1* through *10*, before it executes.</span></span>

<span data-ttu-id="aa2e8-502">Confira as [Dependências da tarefa no Lote do Azure](batch-task-dependencies.md) e o exemplo de código [TaskDependencies][github_sample_taskdeps] no repositório GitHub [azure-batch-samples][github_samples] para obter mais detalhes sobre esse recurso.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-502">Check out [Task dependencies in Azure Batch](batch-task-dependencies.md) and the [TaskDependencies][github_sample_taskdeps] code sample in the [azure-batch-samples][github_samples] GitHub repository for more in-depth details on this feature.</span></span>

## <a name="environment-settings-for-tasks"></a><span data-ttu-id="aa2e8-503">Configurações do ambiente para tarefas</span><span class="sxs-lookup"><span data-stu-id="aa2e8-503">Environment settings for tasks</span></span>
<span data-ttu-id="aa2e8-504">Cada tarefa executada pelo serviço Lote tem acesso a variáveis de ambiente definidas em nós de computação.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-504">Each task executed by the Batch service has access to environment variables that it sets on compute nodes.</span></span> <span data-ttu-id="aa2e8-505">Isso inclui as variáveis de ambiente definidas pelo serviço de Lote ([service-defined][msdn_env_vars]) e as variáveis de ambiente personalizadas que você pode definir para suas tarefas.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-505">This includes environment variables defined by the Batch service ([service-defined][msdn_env_vars]) and custom environment variables that you can define for your tasks.</span></span> <span data-ttu-id="aa2e8-506">Os aplicativos e scripts executados pelas tarefas têm acesso a essas variáveis de ambiente durante a execução.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-506">The applications and scripts your tasks execute have access to these environment variables during execution.</span></span>

<span data-ttu-id="aa2e8-507">Você pode definir variáveis de ambiente personalizadas no nível de tarefa ou de trabalho populando a propriedade *configurações de ambiente* para essas entidades.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-507">You can set custom environment variables at the task or job level by populating the *environment settings* property for these entities.</span></span> <span data-ttu-id="aa2e8-508">Por exemplo, consulte a operação [Adicionar uma tarefa a um trabalho][rest_add_task] (API REST do Lote) ou as propriedades [CloudTask.EnvironmentSettings][net_cloudtask_env] e [CloudJob.CommonEnvironmentSettings][net_job_env] no .NET do Lote.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-508">For example, see the [Add a task to a job][rest_add_task] operation (Batch REST API), or the [CloudTask.EnvironmentSettings][net_cloudtask_env] and [CloudJob.CommonEnvironmentSettings][net_job_env] properties in Batch .NET.</span></span>

<span data-ttu-id="aa2e8-509">Seu aplicativo cliente ou serviço pode obter as variáveis de ambiente da tarefa, definidas pelo serviço e personalizadas, usando a operação [Obter informações sobre uma tarefa][rest_get_task_info] (REST do Lote) ou acessando a propriedade [CloudTask.EnvironmentSettings][net_cloudtask_env] (.NET do Lote).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-509">Your client application or service can obtain a task's environment variables, both service-defined and custom, by using the [Get information about a task][rest_get_task_info] operation (Batch REST) or by accessing the [CloudTask.EnvironmentSettings][net_cloudtask_env] property (Batch .NET).</span></span> <span data-ttu-id="aa2e8-510">Os processos em execução em um nó de computação podem acessar essas e outras variáveis de ambiente no nó, por exemplo, usando a sintaxe familiar do `%VARIABLE_NAME%` (Windows) ou `$VARIABLE_NAME` (Linux).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-510">Processes executing on a compute node can access these and other environment variables on the node, for example, by using the familiar `%VARIABLE_NAME%` (Windows) or `$VARIABLE_NAME` (Linux) syntax.</span></span>

<span data-ttu-id="aa2e8-511">Você pode encontrar uma lista completa de todas as variáveis de ambiente definidas pelo serviço em [Variáveis de ambiente do nó de computação][msdn_env_vars].</span><span class="sxs-lookup"><span data-stu-id="aa2e8-511">You can find a full list of all service-defined environment variables in [Compute node environment variables][msdn_env_vars].</span></span>

## <a name="files-and-directories"></a><span data-ttu-id="aa2e8-512">Arquivos e diretórios</span><span class="sxs-lookup"><span data-stu-id="aa2e8-512">Files and directories</span></span>
<span data-ttu-id="aa2e8-513">Cada tarefa tem um *diretório de trabalho* em que ela cria zero ou mais arquivos e diretórios.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-513">Each task has a *working directory* under which it creates zero or more files and directories.</span></span> <span data-ttu-id="aa2e8-514">Esse diretório de trabalho pode ser usado para armazenar o programa executado pela tarefa, os dados que ele processa e a saída do processamento executado.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-514">This working directory can be used for storing the program that is run by the task, the data that it processes, and the output of the processing it performs.</span></span> <span data-ttu-id="aa2e8-515">Todos os arquivos e diretórios de uma tarefa são pertencentes ao usuário de tarefa.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-515">All files and directories of a task are owned by the task user.</span></span>

<span data-ttu-id="aa2e8-516">O serviço de Lote exibe uma parte do sistema de arquivos em um nó como o *diretório-raiz*.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-516">The Batch service exposes a portion of the file system on a node as the *root directory*.</span></span> <span data-ttu-id="aa2e8-517">As tarefas podem acessar esse diretório-raiz referenciando a variável de ambiente `AZ_BATCH_NODE_ROOT_DIR` .</span><span class="sxs-lookup"><span data-stu-id="aa2e8-517">Tasks can access the root directory by referencing the `AZ_BATCH_NODE_ROOT_DIR` environment variable.</span></span> <span data-ttu-id="aa2e8-518">Para saber mais sobre como usar as variáveis de ambiente, consulte [Configurações de ambiente para tarefas](#environment-settings-for-tasks).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-518">For more information about using environment variables, see [Environment settings for tasks](#environment-settings-for-tasks).</span></span>

<span data-ttu-id="aa2e8-519">O diretório raiz contém a seguinte estrutura de diretório:</span><span class="sxs-lookup"><span data-stu-id="aa2e8-519">The root directory contains the following directory structure:</span></span>

![Estrutura de diretórios do nó de computação][1]

* <span data-ttu-id="aa2e8-521">**compartilhado**– esse diretório fornece acesso de leitura/gravação a *todas* as tarefas executadas em um nó.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-521">**shared**: This directory provides read/write access to *all* tasks that run on a node.</span></span> <span data-ttu-id="aa2e8-522">Qualquer tarefa executada no nó pode criar, ler, atualizar e excluir arquivos nesse diretório.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-522">Any task that runs on the node can create, read, update, and delete files in this directory.</span></span> <span data-ttu-id="aa2e8-523">As tarefas podem acessar esse diretório referenciando a variável de ambiente `AZ_BATCH_NODE_SHARED_DIR` .</span><span class="sxs-lookup"><span data-stu-id="aa2e8-523">Tasks can access this directory by referencing the `AZ_BATCH_NODE_SHARED_DIR` environment variable.</span></span>
* <span data-ttu-id="aa2e8-524">**inicialização**– esse diretório é usado por uma tarefa inicial como seu diretório de trabalho.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-524">**startup**: This directory is used by a start task as its working directory.</span></span> <span data-ttu-id="aa2e8-525">Todos os arquivos que são baixados para o nó pela tarefa de inicialização são armazenados aqui.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-525">All of the files that are downloaded to the node by the start task are stored here.</span></span> <span data-ttu-id="aa2e8-526">A tarefa inicial pode criar, ler, atualizar e excluir arquivos nesse diretório.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-526">The start task can create, read, update, and delete files under this directory.</span></span> <span data-ttu-id="aa2e8-527">As tarefas podem acessar esse diretório referenciando a variável de ambiente `AZ_BATCH_NODE_STARTUP_DIR` .</span><span class="sxs-lookup"><span data-stu-id="aa2e8-527">Tasks can access this directory by referencing the `AZ_BATCH_NODE_STARTUP_DIR` environment variable.</span></span>
* <span data-ttu-id="aa2e8-528">**Tarefas**- um diretório é criado para cada tarefa executada no nó.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-528">**Tasks**: A directory is created for each task that runs on the node.</span></span> <span data-ttu-id="aa2e8-529">É acessado referenciando a variável de ambiente `AZ_BATCH_TASK_DIR` .</span><span class="sxs-lookup"><span data-stu-id="aa2e8-529">It is accessed by referencing the `AZ_BATCH_TASK_DIR` environment variable.</span></span>

    <span data-ttu-id="aa2e8-530">Em cada diretório de tarefas, o serviço Lote cria um diretório de trabalho (`wd`) cujo caminho exclusivo é especificado pela variável de ambiente `AZ_BATCH_TASK_WORKING_DIR`.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-530">Within each task directory, the Batch service creates a working directory (`wd`) whose unique path is specified by the `AZ_BATCH_TASK_WORKING_DIR` environment variable.</span></span> <span data-ttu-id="aa2e8-531">Esse diretório oferece acesso de leitura/gravação à tarefa.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-531">This directory provides read/write access to the task.</span></span> <span data-ttu-id="aa2e8-532">A tarefa pode criar, ler, atualizar e excluir arquivos contidos nesse diretório.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-532">The task can create, read, update, and delete files under this directory.</span></span> <span data-ttu-id="aa2e8-533">Esse diretório é mantido com base na restrição *RetentionTime* especificada para a tarefa.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-533">This directory is retained based on the *RetentionTime* constraint that is specified for the task.</span></span>

    <span data-ttu-id="aa2e8-534">`stdout.txt` e `stderr.txt` – esses arquivos são gravados na pasta de tarefas durante a execução da tarefa.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-534">`stdout.txt` and `stderr.txt`: These files are written to the task folder during the execution of the task.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="aa2e8-535">Quando um nó é removido do pool, *todos* os arquivos armazenados no nó são removidos.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-535">When a node is removed from the pool, *all* of the files that are stored on the node are removed.</span></span>
>
>

## <a name="application-packages"></a><span data-ttu-id="aa2e8-536">pacotes de aplicativos</span><span class="sxs-lookup"><span data-stu-id="aa2e8-536">Application packages</span></span>
<span data-ttu-id="aa2e8-537">O recurso dos [pacotes de aplicativos](batch-application-packages.md) fornece um gerenciamento e implantação fáceis dos aplicativos para os nós de computação em seus pools.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-537">The [application packages](batch-application-packages.md) feature provides easy management and deployment of applications to the compute nodes in your pools.</span></span> <span data-ttu-id="aa2e8-538">Você pode carregar e gerenciar várias versões dos aplicativos executados por suas tarefas, incluindo seus binários e arquivos de suporte.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-538">You can upload and manage multiple versions of the applications run by your tasks, including their binaries and support files.</span></span> <span data-ttu-id="aa2e8-539">Então, você pode implantar automaticamente um ou mais desses aplicativos nos nós de computação em seu pool.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-539">Then you can automatically deploy one or more of these applications to the compute nodes in your pool.</span></span>

<span data-ttu-id="aa2e8-540">Você pode especificar os pacotes de aplicativos no nível do pool e de tarefa.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-540">You can specify application packages at the pool and task level.</span></span> <span data-ttu-id="aa2e8-541">Quando você especifica os pacotes de aplicativos do pool, o aplicativo é implantado para todos os nós no pool.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-541">When you specify pool application packages, the application is deployed to every node in the pool.</span></span> <span data-ttu-id="aa2e8-542">Quando você especifica os pacotes de aplicativos de tarefa, o aplicativo é implantado apenas para nós que estão agendados para execução de pelo menos uma das tarefas do trabalho, antes que a linha de comando da tarefa seja executada.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-542">When you specify task application packages, the application is deployed only to nodes that are scheduled to run at least one of the job's tasks, just before the task's command line is run.</span></span>

<span data-ttu-id="aa2e8-543">O Lote lida com os detalhes de como trabalhar com o Armazenamento do Azure para armazenar pacotes de aplicativos e implantá-los para nós de computação. Portanto, a sobrecarga de gerenciamento e código pode ser simplificada.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-543">Batch handles the details of working with Azure Storage to store your application packages and deploy them to compute nodes, so both your code and management overhead can be simplified.</span></span>

<span data-ttu-id="aa2e8-544">Para saber mais sobre o recurso do pacote de aplicativos, confira a [Implantar aplicativos em nós de computação com pacotes de aplicativos do Lote do Azure](batch-application-packages.md).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-544">To find out more about the application package feature, check out [Deploy applications to compute nodes with Batch application packages](batch-application-packages.md).</span></span>

> [!NOTE]
> <span data-ttu-id="aa2e8-545">Se você adicionar pacotes de aplicativos do pool a um pool *existente* , deverá reinicializar seus nós de computação para que os pacotes de aplicativos sejam implantados nos nós.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-545">If you add pool application packages to an *existing* pool, you must reboot its compute nodes for the application packages to be deployed to the nodes.</span></span>
>
>

## <a name="pool-and-compute-node-lifetime"></a><span data-ttu-id="aa2e8-546">Tempo de vida de nó de computação e de pool</span><span class="sxs-lookup"><span data-stu-id="aa2e8-546">Pool and compute node lifetime</span></span>
<span data-ttu-id="aa2e8-547">Ao projetar sua solução do Lote do Azure, você deve tomar uma decisão de design sobre como e quando os pools são criados, e por quanto tempo os nós de computação nesses pools ficarão disponíveis.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-547">When you design your Azure Batch solution, you have to make a design decision about how and when pools are created, and how long compute nodes within those pools are kept available.</span></span>

<span data-ttu-id="aa2e8-548">Em uma extremidade do espectro, você pode criar um pool para cada trabalho enviado e excluir o pool logo após o término da execução de suas tarefas.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-548">On one end of the spectrum, you can create a pool for each job that you submit, and delete the pool as soon as its tasks finish execution.</span></span> <span data-ttu-id="aa2e8-549">Isso maximiza a utilização porque os nós só serão alocados quando necessário, e desligados assim que ficarem ociosos.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-549">This maximizes utilization because the nodes are only allocated when needed, and shut down as soon as they're idle.</span></span> <span data-ttu-id="aa2e8-550">Embora isso signifique que o trabalho deva aguardar até que os nós sejam alocados, é importante observar que as tarefas serão agendadas para execução assim que os nós estiverem disponíveis individualmente, alocadas e a tarefa inicial tiver sido concluída.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-550">While this means that the job must wait for the nodes to be allocated, it's important to note that tasks are scheduled for execution as soon as nodes are individually available, allocated, and the start task has completed.</span></span> <span data-ttu-id="aa2e8-551">O Lote *não* aguarda até que todos os nós em um pool estejam disponíveis antes de atribuir as tarefas aos nós.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-551">Batch does *not* wait until all nodes within a pool are available before assigning tasks to the nodes.</span></span> <span data-ttu-id="aa2e8-552">Isso garante a máxima utilização de todos os nós disponíveis.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-552">This ensures maximum utilization of all available nodes.</span></span>

<span data-ttu-id="aa2e8-553">Por outro lado, se ter os trabalhos iniciados imediatamente for a prioridade mais alta, você poderá criar um pool antecipadamente e tornar seus nós disponíveis antes dos trabalhos serem enviados.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-553">At the other end of the spectrum, if having jobs start immediately is the highest priority, you can create a pool ahead of time and make its nodes available before jobs are submitted.</span></span> <span data-ttu-id="aa2e8-554">Nesse cenário, as tarefas podem começar imediatamente, mas os nós poderão ficar ociosos enquanto aguardam a atribuição delas.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-554">In this scenario, tasks can start immediately, but nodes might sit idle while waiting for them to be assigned.</span></span>

<span data-ttu-id="aa2e8-555">Uma abordagem combinada normalmente é usada para lidar com uma carga variável, mas em andamento.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-555">A combined approach is typically used for handling a variable, but ongoing, load.</span></span> <span data-ttu-id="aa2e8-556">Você pode ter um pool para o qual vários trabalhos são enviados, mas pode aumentar ou diminuir o número de nós de acordo com a carga de trabalho (confira [Dimensionando os recursos de computação](#scaling-compute-resources) na seção a seguir).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-556">You can have a pool that multiple jobs are submitted to, but can scale the number of nodes up or down according to the job load (see [Scaling compute resources](#scaling-compute-resources) in the following section).</span></span> <span data-ttu-id="aa2e8-557">Isso pode ser feito de maneira reativa, com base na carga atual, ou proativamente, se a carga puder ser prevista.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-557">You can do this reactively, based on current load, or proactively, if load can be predicted.</span></span>

## <a name="virtual-network-vnet-and-firewall-configuration"></a><span data-ttu-id="aa2e8-558">Configuração de firewall e VNet (rede virtual)</span><span class="sxs-lookup"><span data-stu-id="aa2e8-558">Virtual network (VNet) and firewall configuration</span></span> 

<span data-ttu-id="aa2e8-559">Quando você provisiona um pool de nós de computação no Lote do Azure, pode associar o pool de uma sub-rede de uma [VNet (rede virtual)](../virtual-network/virtual-networks-overview.md) do Azure.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-559">When you provision a pool of compute nodes in Azure Batch, you can associate the pool with a subnet of an Azure [virtual network (VNet)](../virtual-network/virtual-networks-overview.md).</span></span> <span data-ttu-id="aa2e8-560">Para saber mais sobre como criar uma rede virtual com sub-redes, confira [Criar uma rede virtual do Azure com sub-redes](../virtual-network/virtual-networks-create-vnet-arm-pportal.md).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-560">To learn more about creating a VNet with subnets, see [Create an Azure virtual network with subnets](../virtual-network/virtual-networks-create-vnet-arm-pportal.md).</span></span> 

 * <span data-ttu-id="aa2e8-561">A rede virtual associada a um pool deve ser:</span><span class="sxs-lookup"><span data-stu-id="aa2e8-561">The VNet associated with a pool must be:</span></span>

   * <span data-ttu-id="aa2e8-562">Na mesma **região** do Azure que a conta do Lote do Azure.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-562">In the same Azure **region** as the Azure Batch account.</span></span>
   * <span data-ttu-id="aa2e8-563">Na mesma **assinatura** do Azure que a conta do Lote do Azure.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-563">In the same **subscription** as the Azure Batch account.</span></span>

* <span data-ttu-id="aa2e8-564">O tipo de VNet suportado depende de como os pools estão sendo alocados para a conta do lote:</span><span class="sxs-lookup"><span data-stu-id="aa2e8-564">The type of VNet supported depends on how pools are being allocated for the Batch account:</span></span>

    - <span data-ttu-id="aa2e8-565">Se o modo de alocação de pools para sua conta do Lote estiver definido como Serviço em Lotes, você só pode atribuir uma rede virtual aos pools criados com a **Configuração dos Serviços de Nuvem**.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-565">If the pool allocation mode for your Batch account is set to Batch Service, then you can assign a VNet only to pools created with the **Cloud Services Configuration**.</span></span> <span data-ttu-id="aa2e8-566">Além disso, a VNet especificada deve ser criada com o modelo de implantação clássico.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-566">Additionally, the specified VNet must be created with the classic deployment model.</span></span> <span data-ttu-id="aa2e8-567">Não há suporte para VNets criadas com o modelo de implantação do Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-567">VNets created with the Azure Resource Manager deployment model are not supported.</span></span>
 
    - <span data-ttu-id="aa2e8-568">Se o modo de alocação de pools para sua conta do Lote estiver definido como Assinatura de Usuário, você só pode atribuir uma rede virtual aos pools criados com a **Configuração da Máquina Virtual**.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-568">If the pool allocation mode for your Batch account is set to User Subscription, then you can assign a VNet only to pools created with the **Virtual Machine Configuration**.</span></span> <span data-ttu-id="aa2e8-569">Não há suporte para pools criados com a **Configuração do Serviço de Nuvem**.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-569">Pools created with the **Cloud Service Configuration** are not supported.</span></span> <span data-ttu-id="aa2e8-570">A rede virtual associada pode ser criada com o modelo de implantação do Azure Resource Manager ou com o modelo de implantação clássico.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-570">The associated VNet may be created with either the Azure Resource Manager deployment model or the classic deployment model.</span></span>

    <span data-ttu-id="aa2e8-571">Para obter uma tabela resumindo o suporte à rede virtual de acordo com o modo de alocação de pools, confira a seção [Modo de alocação de pools](#pool-allocation-mode).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-571">For a table summarizing VNet support according to pool allocation mode, see the [Pool allocation mode](#pool-allocation-mode) section.</span></span>

* <span data-ttu-id="aa2e8-572">Se o modo de alocação de pools para sua conta do Lote estiver definido como Serviço Lote, você deve fornecer permissões para a entidade de serviço do Lote para acessar a rede virtual.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-572">If the pool allocation mode for your Batch account is set to Batch Service, then you must provide permissions for the Batch service principal to access the VNet.</span></span> <span data-ttu-id="aa2e8-573">A rede virtual deve atribuir a função [RBAC (Controle de Acesso Baseado em Função) da máquina virtual clássica](https://azure.microsoft.com/documentation/articles/role-based-access-built-in-roles/#classic-virtual-machine-contributor) para a entidade de Serviço em Lotes.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-573">The VNet must assign the [Classic Virtual Machine Contributor Role-Based Access Control (RBAC)](https://azure.microsoft.com/documentation/articles/role-based-access-built-in-roles/#classic-virtual-machine-contributor) role to the Batch service principal.</span></span> <span data-ttu-id="aa2e8-574">Se a função RBAC especificada não for fornecida, o serviço de lote retornará 400 (solicitação incorreta).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-574">If the specified RBAC role is not provided, the Batch service returns 400 (Bad Request).</span></span> <span data-ttu-id="aa2e8-575">Para adicionar a função no portal do Azure:</span><span class="sxs-lookup"><span data-stu-id="aa2e8-575">To add the role in the Azure portal:</span></span>

    1. <span data-ttu-id="aa2e8-576">Selecione a **VNet**, em seguida, **Controle de Acesso (IAM)** > **Funções** > **Colaborador de Máquina Virtual** > **Adicionar**.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-576">Select the **VNet**, then **Access control (IAM)** > **Roles** > **Virtual Machine Contributor** > **Add**.</span></span>
    2. <span data-ttu-id="aa2e8-577">Na folha **Adicionar permissões**, selecione a função **Colaborador da Máquina Virtual**.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-577">On the **Add permissions** blade, select the **Virtual Machine Contributor** role.</span></span>
    3. <span data-ttu-id="aa2e8-578">Na folha **Adicionar permissões**, procure a API do Lote.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-578">On the **Add permissions** blade, search for the Batch API.</span></span> <span data-ttu-id="aa2e8-579">Procure cada uma dessas cadeias de caracteres por vez até encontrar a API:</span><span class="sxs-lookup"><span data-stu-id="aa2e8-579">Search for each of these strings in turn until you find the API:</span></span>
        1. <span data-ttu-id="aa2e8-580">**MicrosoftAzureBatch**.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-580">**MicrosoftAzureBatch**.</span></span>
        2. <span data-ttu-id="aa2e8-581">**Lote do Microsoft Azure**.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-581">**Microsoft Azure Batch**.</span></span> <span data-ttu-id="aa2e8-582">Os locatários mais recentes do Azure AD podem usar esse nome.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-582">Newer Azure AD tenants may use this name.</span></span>
        3. <span data-ttu-id="aa2e8-583">**ddbf3205-c6bd-46ae-8127-60eb93363864** é a ID para a API do Lote.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-583">**ddbf3205-c6bd-46ae-8127-60eb93363864** is the ID for the Batch API.</span></span> 
    3. <span data-ttu-id="aa2e8-584">Selecione a entidade de serviço de API do Lote.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-584">Select the Batch API service principal.</span></span> 
    4. <span data-ttu-id="aa2e8-585">Clique em **Salvar**.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-585">Click **Save**.</span></span>

        ![Atribuir função de Colaborador de VM à entidade de serviço do Lote](./media/batch-api-basics/iam-add-role.png)


* <span data-ttu-id="aa2e8-587">A sub-rede especificada deve ter **endereços IP** suficientemente livres para acomodar o número total de nós de destino; ou seja, a soma das propriedades `targetDedicatedNodes` e `targetLowPriorityNodes` do pool.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-587">The specified subnet should have enough free **IP addresses** to accommodate the total number of target nodes; that is, the sum of the `targetDedicatedNodes` and `targetLowPriorityNodes` properties of the pool.</span></span> <span data-ttu-id="aa2e8-588">Se a sub-rede não tiver endereços IP suficientes livres, o serviço de Lote alocará parcialmente os nós de computação no pool e retornará um erro de redimensionamento.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-588">If the subnet doesn't have enough free IP addresses, the Batch service partially allocates the compute nodes in the pool and returns a resize error.</span></span>

* <span data-ttu-id="aa2e8-589">A sub-rede especificada deve permitir a comunicação do serviço do Lote para que seja capaz de agendar tarefas nos nós de computação.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-589">The specified subnet must allow communication from the Batch service to be able to schedule tasks on the compute nodes.</span></span> <span data-ttu-id="aa2e8-590">Se a comunicação com os nós de computação for negada por um **NSG (grupo de segurança de rede)** associado com a VNet, o serviço de lote definirá o estado de nós de computação para **inutilizável**.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-590">If communication to the compute nodes is denied by a **Network Security Group (NSG)** associated with the VNet, then the Batch service sets the state of the compute nodes to **unusable**.</span></span>

* <span data-ttu-id="aa2e8-591">Se a VNet especificada tiver **NSGs (grupos de segurança de rede)** e/ou um **firewall** associados, algumas portas reservadas do sistema devem ser habilitadas para comunicação de entrada:</span><span class="sxs-lookup"><span data-stu-id="aa2e8-591">If the specified VNet has associated **Network Security Groups (NSGs)** and/or a **firewall**, then a few reserved system ports must be enabled for inbound communication:</span></span>

- <span data-ttu-id="aa2e8-592">Para pools criados com uma configuração de máquina virtual, habilite as portas 29876 e 29877, bem como a porta 22 para Linux e a porta 3389 para Windows.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-592">For pools created with a virtual machine configuration, enable ports 29876 and 29877, as well as port 22 for Linux and port 3389 for Windows.</span></span> 
- <span data-ttu-id="aa2e8-593">Para pools criados com uma configuração de serviço de nuvem, habilite as portas 10100, 20100 e 30100.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-593">For pools created with a cloud service configuration, enable ports 10100, 20100, and 30100.</span></span> 
- <span data-ttu-id="aa2e8-594">Permita as conexões de saída para o Armazenamento do Azure na porta 443.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-594">Enable outbound connections to Azure Storage on port 443.</span></span> <span data-ttu-id="aa2e8-595">Além disso, verifique se seu ponto de extremidade do Armazenamento do Azure pode ser resolvido por servidores DNS personalizados que servem sua rede virtual.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-595">Also, ensure that your Azure Storage endpoint can be resolved by any custom DNS servers that serve your VNET.</span></span> <span data-ttu-id="aa2e8-596">Especificamente, uma URL do formato `<account>.table.core.windows.net` deve ser resolvida.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-596">Specifically, a URL of the form `<account>.table.core.windows.net` should be resolvable.</span></span>

    <span data-ttu-id="aa2e8-597">A tabela a seguir descreve as portas de entrada que você precisa habilitar para grupos criados com a configuração da máquina virtual:</span><span class="sxs-lookup"><span data-stu-id="aa2e8-597">The following table describes the inbound ports that you need to enable for pools that you created with the virtual machine configuration:</span></span>

    |    <span data-ttu-id="aa2e8-598">Portas de destino</span><span class="sxs-lookup"><span data-stu-id="aa2e8-598">Destination Port(s)</span></span>    |    <span data-ttu-id="aa2e8-599">Endereço IP de origem</span><span class="sxs-lookup"><span data-stu-id="aa2e8-599">Source IP address</span></span>      |    <span data-ttu-id="aa2e8-600">O Lote adiciona NSGs?</span><span class="sxs-lookup"><span data-stu-id="aa2e8-600">Does Batch add NSGs?</span></span>    |    <span data-ttu-id="aa2e8-601">Necessário para que a máquina virtual possa ser usada?</span><span class="sxs-lookup"><span data-stu-id="aa2e8-601">Required for VM to be usable?</span></span>    |    <span data-ttu-id="aa2e8-602">Ação do usuário</span><span class="sxs-lookup"><span data-stu-id="aa2e8-602">Action from user</span></span>   |
    |---------------------------|---------------------------|----------------------------|-------------------------------------|-----------------------|
    |    <ul><li><span data-ttu-id="aa2e8-603">Para pools criados com a configuração de máquina virtual: 29876, 29877</span><span class="sxs-lookup"><span data-stu-id="aa2e8-603">For pools created with the virtual machine configuration: 29876, 29877</span></span></li><li><span data-ttu-id="aa2e8-604">Para pools criados com a configuração de serviço de nuvem: 10100, 20100, 30100</span><span class="sxs-lookup"><span data-stu-id="aa2e8-604">For pools created with the cloud service configuration: 10100, 20100, 30100</span></span></li></ul>         |    <span data-ttu-id="aa2e8-605">Endereços IP com função de serviço Somente Lote</span><span class="sxs-lookup"><span data-stu-id="aa2e8-605">Only Batch service role IP addresses</span></span> |    <span data-ttu-id="aa2e8-606">Sim.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-606">Yes.</span></span> <span data-ttu-id="aa2e8-607">O Lote adiciona os NSGs no nível dos NIC (adaptadores de rede) anexados às VMs.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-607">Batch adds NSGs at the level of network interfaces (NIC) attached to VMs.</span></span> <span data-ttu-id="aa2e8-608">Essas NSGs permitem o tráfego somente de endereços IP com função de serviço do Lote.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-608">These NSGs allow traffic only from Batch service role IP addresses.</span></span> <span data-ttu-id="aa2e8-609">Mesmo que você abra essas portas para toda a Web, o tráfego será bloqueado no NIC.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-609">Even if you open these ports for the  entire web, the traffic will get blocked at the NIC.</span></span> |    <span data-ttu-id="aa2e8-610">Sim</span><span class="sxs-lookup"><span data-stu-id="aa2e8-610">Yes</span></span>  |  <span data-ttu-id="aa2e8-611">Não é necessário especificar um NSG, pois o Lote permite somente os endereços IP do Lote.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-611">You do not need to specify an NSG, because Batch allows only Batch IP addresses.</span></span> <br /><br /> <span data-ttu-id="aa2e8-612">No entanto, se você especificar um NSG, verifique se essas portas estão abertas para tráfego de entrada.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-612">However, if you do specify an NSG, please ensure that these ports are open for inbound traffic.</span></span> <br /><br /> <span data-ttu-id="aa2e8-613">Se você especificar * como o IP de origem em seu NSG, o Lote ainda adicionará os NSGs no nível de NIC anexados às VMs.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-613">If you specify * as the source IP in your NSG, Batch still adds NSGs at the level of NIC attached to VMs.</span></span> |
    |    <span data-ttu-id="aa2e8-614">3389, 22</span><span class="sxs-lookup"><span data-stu-id="aa2e8-614">3389, 22</span></span>               |    <span data-ttu-id="aa2e8-615">Máquinas de usuário, usadas para depuração, para que você possa acessar a máquina virtual remotamente.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-615">User machines, used for debugging purposes, so that you can remotely access the VM.</span></span>    |    <span data-ttu-id="aa2e8-616">Não</span><span class="sxs-lookup"><span data-stu-id="aa2e8-616">No</span></span>                                    |    <span data-ttu-id="aa2e8-617">Não</span><span class="sxs-lookup"><span data-stu-id="aa2e8-617">No</span></span>                     |    <span data-ttu-id="aa2e8-618">Adicione os NSGs se quiser permitir o acesso remoto (RDP/SSH) à máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-618">Add NSGs if you want to permit remote access (RDP/SSH) to the VM.</span></span>   |                 

    <span data-ttu-id="aa2e8-619">A tabela abaixo descreve a porta de saída que você precisa habilitar para permitir o acesso ao Armazenamento do Azure:</span><span class="sxs-lookup"><span data-stu-id="aa2e8-619">The following table describes the outbound port that you need to enable to permit access to Azure Storage:</span></span>

    |    <span data-ttu-id="aa2e8-620">Portas de saída</span><span class="sxs-lookup"><span data-stu-id="aa2e8-620">Outbound Port(s)</span></span>    |    <span data-ttu-id="aa2e8-621">Destino</span><span class="sxs-lookup"><span data-stu-id="aa2e8-621">Destination</span></span>    |    <span data-ttu-id="aa2e8-622">O Lote adiciona NSGs?</span><span class="sxs-lookup"><span data-stu-id="aa2e8-622">Does Batch add NSGs?</span></span>    |    <span data-ttu-id="aa2e8-623">Necessário para que a máquina virtual possa ser usada?</span><span class="sxs-lookup"><span data-stu-id="aa2e8-623">Required for VM to be usable?</span></span>    |    <span data-ttu-id="aa2e8-624">Ação do usuário</span><span class="sxs-lookup"><span data-stu-id="aa2e8-624">Action from user</span></span>    |
    |------------------------|-------------------|----------------------------|-------------------------------------|------------------------|
    |    <span data-ttu-id="aa2e8-625">443</span><span class="sxs-lookup"><span data-stu-id="aa2e8-625">443</span></span>    |    <span data-ttu-id="aa2e8-626">Armazenamento do Azure</span><span class="sxs-lookup"><span data-stu-id="aa2e8-626">Azure Storage</span></span>    |    <span data-ttu-id="aa2e8-627">Não</span><span class="sxs-lookup"><span data-stu-id="aa2e8-627">No</span></span>    |    <span data-ttu-id="aa2e8-628">Sim</span><span class="sxs-lookup"><span data-stu-id="aa2e8-628">Yes</span></span>    |    <span data-ttu-id="aa2e8-629">Se você adicionar NSGs, verifique se essa porta está aberta para tráfego de saída.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-629">If you add any NSGs, then ensure that this port is open to outbound   traffic.</span></span>    |


## <a name="scaling-compute-resources"></a><span data-ttu-id="aa2e8-630">Dimensionando os recursos de computação</span><span class="sxs-lookup"><span data-stu-id="aa2e8-630">Scaling compute resources</span></span>
<span data-ttu-id="aa2e8-631">Com o [dimensionamento automático](batch-automatic-scaling.md), você pode deixar que o serviço de Lote ajuste dinamicamente o número de nós de computação em um pool de acordo com a carga de trabalho e o uso de recursos atuais do cenário de computação.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-631">With [automatic scaling](batch-automatic-scaling.md), you can have the Batch service dynamically adjust the number of compute nodes in a pool according to the current workload and resource usage of your compute scenario.</span></span> <span data-ttu-id="aa2e8-632">Isso permite reduzir o custo geral de execução do aplicativo usando apenas os recursos necessários e liberando os que você não precisa.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-632">This allows you to lower the overall cost of running your application by using only the resources you need, and releasing those you don't need.</span></span>

<span data-ttu-id="aa2e8-633">Você habilita o dimensionamento automático escrevendo uma [fórmula de dimensionamento automático](batch-automatic-scaling.md#automatic-scaling-formulas) e associando-a a um pool.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-633">You enable automatic scaling by writing an [automatic scaling formula](batch-automatic-scaling.md#automatic-scaling-formulas) and associating that formula with a pool.</span></span> <span data-ttu-id="aa2e8-634">O serviço de Lote usa a fórmula para determinar o número de nós no pool de destino para o próximo intervalo de dimensionamento (um intervalo que você pode configurar).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-634">The Batch service uses the formula to determine the target number of nodes in the pool for the next scaling interval (an interval that you can configure).</span></span> <span data-ttu-id="aa2e8-635">Você pode especificar as configurações de dimensionamento automático para um pool ao criá-lo ou habilitar o dimensionamento mais tarde em um pool.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-635">You can specify the automatic scaling settings for a pool when you create it, or enable scaling on a pool later.</span></span> <span data-ttu-id="aa2e8-636">Você também pode atualizar as configurações de dimensionamento em um pool com dimensionamento habilitado.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-636">You can also update the scaling settings on a scaling-enabled pool.</span></span>

<span data-ttu-id="aa2e8-637">Por exemplo, talvez um trabalho exija que você envie um grande número de tarefas a serem executadas.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-637">As an example, perhaps a job requires that you submit a very large number of tasks to be executed.</span></span> <span data-ttu-id="aa2e8-638">Você pode atribuir uma fórmula de dimensionamento ao pool que ajusta o número de nós nele com base no número atual de tarefas enfileiradas e a taxa de conclusão das tarefas no trabalho.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-638">You can assign a scaling formula to the pool that adjusts the number of nodes in the pool based on the current number of queued tasks and the completion rate of the tasks in the job.</span></span> <span data-ttu-id="aa2e8-639">Periodicamente, o serviço de Lote avalia a fórmula e redimensiona o pool com base na carga de trabalho e em outras configurações da fórmula.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-639">The Batch service periodically evaluates the formula and resizes the pool, based on workload and your other formula settings.</span></span> <span data-ttu-id="aa2e8-640">O serviço adiciona nós conforme necessário quando há um grande número de tarefas em fila e remove os nós quando não existem tarefas em execução ou fila.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-640">The service adds nodes as needed when there are a large number of queued tasks, and removes nodes when there are no queued or running tasks.</span></span>

<span data-ttu-id="aa2e8-641">Uma fórmula de dimensionamento pode basear-se nas seguintes métricas:</span><span class="sxs-lookup"><span data-stu-id="aa2e8-641">A scaling formula can be based on the following metrics:</span></span>

* <span data-ttu-id="aa2e8-642">**métricas do tempo** são baseadas nas estatísticas coletadas a cada cinco minutos no número de horas especificado.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-642">**Time metrics** are based on statistics collected every five minutes in the specified number of hours.</span></span>
* <span data-ttu-id="aa2e8-643">**métricas do recurso** são baseadas nos usos da CPU, da largura de banda e da memória, e no número de nós.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-643">**Resource metrics** are based on CPU usage, bandwidth usage, memory usage, and number of nodes.</span></span>
* <span data-ttu-id="aa2e8-644">As **métricas de tarefa** são baseadas no estado da tarefa, como *Ativa* (na fila), *Em execução* ou *Concluída*.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-644">**Task metrics** are based on task state, such as *Active* (queued), *Running*, or *Completed*.</span></span>

<span data-ttu-id="aa2e8-645">Quando o dimensionamento automático diminui o número de nós de computação em um pool, você deve considerar como lidar com as tarefas em execução no momento da operação de redução.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-645">When automatic scaling decreases the number of compute nodes in a pool, you must consider how to handle tasks that are running at the time of the decrease operation.</span></span> <span data-ttu-id="aa2e8-646">Para aceitar isso, o Lote fornece uma *opção de desalocação do nó* que você pode incluir em suas fórmulas.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-646">To accommodate this, Batch provides a *node deallocation option* that you can include in your formulas.</span></span> <span data-ttu-id="aa2e8-647">Por exemplo, você pode especificar que as tarefas em execução sejam interrompidas imediatamente, interrompidas imediatamente e colocadas novamente na fila para execução em outro nó ou concluídas antes que o nó seja removido do pool.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-647">For example, you can specify that running tasks are stopped immediately, stopped immediately and then requeued for execution on another node, or allowed to finish before the node is removed from the pool.</span></span>

<span data-ttu-id="aa2e8-648">Para saber mais sobre o dimensionamento automático de um aplicativo, consulte [Dimensionar automaticamente nós de computação em um pool do Lote do Azure](batch-automatic-scaling.md).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-648">For more information about automatically scaling an application, see [Automatically scale compute nodes in an Azure Batch pool](batch-automatic-scaling.md).</span></span>

> [!TIP]
> <span data-ttu-id="aa2e8-649">Para maximizar a utilização de recursos de computação, defina o número de destino de nós como zero ao fim de um trabalho, mas permita a conclusão das tarefas em execução.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-649">To maximize compute resource utilization, set the target number of nodes to zero at the end of a job, but allow running tasks to finish.</span></span>
>
>

## <a name="security-with-certificates"></a><span data-ttu-id="aa2e8-650">Segurança com certificados</span><span class="sxs-lookup"><span data-stu-id="aa2e8-650">Security with certificates</span></span>
<span data-ttu-id="aa2e8-651">Normalmente, você precisa usar certificados ao criptografar ou descriptografar informações confidenciais para as tarefas, como a chave para uma [conta de Armazenamento do Azure][azure_storage].</span><span class="sxs-lookup"><span data-stu-id="aa2e8-651">You typically need to use certificates when you encrypt or decrypt sensitive information for tasks, like the key for an [Azure Storage account][azure_storage].</span></span> <span data-ttu-id="aa2e8-652">Para dar suporte a isso, você pode instalar certificados nos nós.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-652">To support this, you can install certificates on nodes.</span></span> <span data-ttu-id="aa2e8-653">Os segredos criptografados são passados para tarefas por meio dos parâmetros de linha de comando ou incorporados em um dos recursos de tarefa, e os certificados instalados podem ser usados para descriptografá-los.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-653">Encrypted secrets are passed to tasks via command-line parameters or embedded in one of the task resources, and the installed certificates can be used to decrypt them.</span></span>

<span data-ttu-id="aa2e8-654">Você usa a operação [Adicionar certificado][rest_add_cert] (REST do Lote) ou o método [CertificateOperations.CreateCertificate][net_create_cert] (.NET do Lote) para adicionar um certificado a uma conta do Lote.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-654">You use the [Add certificate][rest_add_cert] operation (Batch REST) or [CertificateOperations.CreateCertificate][net_create_cert] method (Batch .NET) to add a certificate to a Batch account.</span></span> <span data-ttu-id="aa2e8-655">Então, pode associar o certificado a um pool novo ou existente.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-655">You can then associate the certificate with a new or existing pool.</span></span> <span data-ttu-id="aa2e8-656">Quando um certificado está associado a um pool, o serviço em lote instala o certificado em cada nó presente no pool.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-656">When a certificate is associated with a pool, the Batch service installs the certificate on each node in the pool.</span></span> <span data-ttu-id="aa2e8-657">O serviço Lote instala os certificados apropriados quando o nó é inicializado, antes que ele execute qualquer tarefa (incluindo a tarefa inicial e a tarefa do gerenciador de trabalhos).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-657">The Batch service installs the appropriate certificates when the node starts up, before launching any tasks (including the start task and job manager task).</span></span>

<span data-ttu-id="aa2e8-658">Se você adicionar certificados a um pool *existente* , deverá reinicializar seus nós de computação para que os certificados sejam aplicados aos nós.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-658">If you add certificates to an *existing* pool, you must reboot its compute nodes for the certificates to be applied to the nodes.</span></span>

## <a name="error-handling"></a><span data-ttu-id="aa2e8-659">Tratamento de erros</span><span class="sxs-lookup"><span data-stu-id="aa2e8-659">Error handling</span></span>
<span data-ttu-id="aa2e8-660">Talvez seja necessário lidar com as falhas da tarefa e do aplicativo em sua solução do Lote.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-660">You might find it necessary to handle both task and application failures within your Batch solution.</span></span>

### <a name="task-failure-handling"></a><span data-ttu-id="aa2e8-661">Manipulação de falha de tarefa</span><span class="sxs-lookup"><span data-stu-id="aa2e8-661">Task failure handling</span></span>
<span data-ttu-id="aa2e8-662">As falhas de tarefas se enquadram nestas categorias:</span><span class="sxs-lookup"><span data-stu-id="aa2e8-662">Task failures fall into these categories:</span></span>

* <span data-ttu-id="aa2e8-663">**Falhas de pré-processamento**</span><span class="sxs-lookup"><span data-stu-id="aa2e8-663">**Pre-processing failures**</span></span>

    <span data-ttu-id="aa2e8-664">Se uma tarefa não for iniciada, um erro de pré-processamento é definido para a tarefa.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-664">If a task fails to start, a pre-processing error is set for the task.</span></span>  

    <span data-ttu-id="aa2e8-665">Poderão ocorrer erros de processamento se os arquivos de recurso da tarefa forem movidos, se a conta de armazenamento não estiver mais disponível ou se outro problema que impediu a cópia bem-sucedida dos arquivos para o nó foi encontrado.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-665">Pre-processing errors can occur if the task's resource files have moved, the Storage account is no longer available, or another issue was encountered that prevented the successful copying of files to the node.</span></span>

* <span data-ttu-id="aa2e8-666">**Falhas de carregamento de arquivo**</span><span class="sxs-lookup"><span data-stu-id="aa2e8-666">**File upload failures**</span></span>

    <span data-ttu-id="aa2e8-667">Se o carregamento de arquivos especificados para uma tarefa falhar por algum motivo, um erro de carregamento de arquivo é definido para a tarefa.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-667">If uploading files that are specified for a task fails for any reason, a file upload error is set for the task.</span></span>

    <span data-ttu-id="aa2e8-668">Poderá ocorrer erros de carregamento de arquivo se as SAS fornecidas para acessar o armazenamento do Azure estiverem inválidas ou não se forneceram permissões de gravação, se a conta de armazenamento não estiver mais disponível ou se foi encontrado um outro problema que impediu a cópia bem-sucedida dos arquivos a partir do nó.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-668">File upload errors can occur if the SAS supplied for accessing Azure Storage is invalid or does not provide write permissions, if the storage account is no longer available, or if another issue was encountered that prevented the successful copying of files from the node.</span></span>    

* <span data-ttu-id="aa2e8-669">**Falhas de aplicativo**</span><span class="sxs-lookup"><span data-stu-id="aa2e8-669">**Application failures**</span></span>

    <span data-ttu-id="aa2e8-670">O processo especificado pela linha de comando da tarefa também pode falhar.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-670">The process that is specified by the task's command line can also fail.</span></span> <span data-ttu-id="aa2e8-671">O processo é considerado com falha quando é retornado um código de saída diferente de zero pelo processo executado pela tarefa (consulte *Códigos de saída da tarefa* na tarefa a seguir).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-671">The process is deemed to have failed when a nonzero exit code is returned by the process that is executed by the task (see *Task exit codes* in the next section).</span></span>

    <span data-ttu-id="aa2e8-672">Para as falhas do aplicativo, você pode configurar o Lote para repetir automaticamente a tarefa até um número especificado de vezes.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-672">For application failures, you can configure Batch to automatically retry the task up to a specified number of times.</span></span>

* <span data-ttu-id="aa2e8-673">**Falhas de restrição**</span><span class="sxs-lookup"><span data-stu-id="aa2e8-673">**Constraint failures**</span></span>

    <span data-ttu-id="aa2e8-674">Você pode definir uma restrição que especifique a duração máxima da execução de um trabalho ou uma tarefa, *maxWallClockTime*.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-674">You can set a constraint that specifies the maximum execution duration for a job or task, the *maxWallClockTime*.</span></span> <span data-ttu-id="aa2e8-675">Isso pode ser útil para encerrar as tarefas sem progresso.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-675">This can be useful for terminating tasks that fail to progress.</span></span>

    <span data-ttu-id="aa2e8-676">Quando o tempo máximo tiver sido excedido, a tarefa será marcada como *concluída*, mas o código de saída será definido para `0xC000013A` e o campo *schedulingError* será marcado como `{ category:"ServerError", code="TaskEnded"}`.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-676">When the maximum amount of time has been exceeded, the task is marked as *completed*, but the exit code is set to `0xC000013A` and the *schedulingError* field is marked as `{ category:"ServerError", code="TaskEnded"}`.</span></span>

### <a name="debugging-application-failures"></a><span data-ttu-id="aa2e8-677">Falhas de depuração de aplicativos</span><span class="sxs-lookup"><span data-stu-id="aa2e8-677">Debugging application failures</span></span>
* <span data-ttu-id="aa2e8-678">`stderr` e `stdout`</span><span class="sxs-lookup"><span data-stu-id="aa2e8-678">`stderr` and `stdout`</span></span>

    <span data-ttu-id="aa2e8-679">Durante a execução, um aplicativo pode produzir uma saída de diagnóstico que pode ser usada para solucionar os problemas.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-679">During execution, an application might produce diagnostic output that you can use to troubleshoot issues.</span></span> <span data-ttu-id="aa2e8-680">Conforme mencionado na seção [Arquivos e diretórios](#files-and-directories) anterior, o serviço de Lote grava a saída padrão e os erros padrão nos arquivos `stdout.txt` e `stderr.txt` no diretório da tarefa no nó de computação.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-680">As mentioned in the earlier section [Files and directories](#files-and-directories), the Batch service writes standard output and standard error output to `stdout.txt` and `stderr.txt` files in the task directory on the compute node.</span></span> <span data-ttu-id="aa2e8-681">Você pode usar o portal do Azure ou um dos SDKs do Lote para baixar esses arquivos.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-681">You can use the Azure portal or one of the Batch SDKs to download these files.</span></span> <span data-ttu-id="aa2e8-682">Por exemplo, você pode recuperar esses e outros arquivos para solucionar problemas usando [ComputeNode.GetNodeFile][net_getfile_node] e [CloudTask.GetNodeFile][net_getfile_task] na biblioteca do .NET do Lote.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-682">For example, you can retrieve these and other files for troubleshooting purposes by using [ComputeNode.GetNodeFile][net_getfile_node] and [CloudTask.GetNodeFile][net_getfile_task] in the Batch .NET library.</span></span>

* <span data-ttu-id="aa2e8-683">**Códigos de saída de tarefas**</span><span class="sxs-lookup"><span data-stu-id="aa2e8-683">**Task exit codes**</span></span>

    <span data-ttu-id="aa2e8-684">Conforme mencionado anterior, uma tarefa é marcada como tendo falhas pelo serviço de Lote se o processo executado pela tarefa retorna um código de saída diferente de zero.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-684">As mentioned earlier, a task is marked as failed by the Batch service if the process that is executed by the task returns a nonzero exit code.</span></span> <span data-ttu-id="aa2e8-685">Quando uma tarefa executa um processo, o Lote preenche a propriedade do código de saída da tarefa com o *código de retorno do processo*.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-685">When a task executes a process, Batch populates the task's exit code property with the *return code of the process*.</span></span> <span data-ttu-id="aa2e8-686">É importante observar que o código de saída da tarefa não **é** determinado pelo serviço de Lote.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-686">It is important to note that a task's exit code is **not** determined by the Batch service.</span></span> <span data-ttu-id="aa2e8-687">O código de saída da tarefa é determinado pelo próprio processo ou pelo sistema operacional no qual o processo é executado.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-687">A task's exit code is determined by the process itself or the operating system on which the process executed.</span></span>

### <a name="accounting-for-task-failures-or-interruptions"></a><span data-ttu-id="aa2e8-688">Contabilidade de interrupções ou de falhas de tarefas</span><span class="sxs-lookup"><span data-stu-id="aa2e8-688">Accounting for task failures or interruptions</span></span>
<span data-ttu-id="aa2e8-689">As tarefas podem falhar ou ser interrompidas ocasionalmente.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-689">Tasks might occasionally fail or be interrupted.</span></span> <span data-ttu-id="aa2e8-690">O próprio aplicativo da tarefa pode falhar, o nó no qual a tarefa está em execução pode ser reinicializado ou o nó pode ser removido do pool durante uma operação de redimensionamento, caso a política de desalocação do pool seja definida para remover o nó imediatamente sem esperar que as tarefas sejam concluídas.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-690">The task application itself might fail, the node on which the task is running might be rebooted, or the node might be removed from the pool during a resize operation if the pool's deallocation policy is set to remove nodes immediately without waiting for tasks to finish.</span></span> <span data-ttu-id="aa2e8-691">Em todos os casos, a tarefa pode ser automaticamente recolocada na fila pelo Lote para a execução em outro nó.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-691">In all cases, the task can be automatically requeued by Batch for execution on another node.</span></span>

<span data-ttu-id="aa2e8-692">Também é possível que um problema intermitente faça com que uma tarefa falhe ou demore muito para ser executada.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-692">It is also possible for an intermittent issue to cause a task to hang or take too long to execute.</span></span> <span data-ttu-id="aa2e8-693">Você pode definir o intervalo máximo de execução de uma tarefa.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-693">You can set the maximum execution interval for a task.</span></span> <span data-ttu-id="aa2e8-694">Se o intervalo máximo de execução for excedido, o serviço de Lote irá interromper o aplicativo da tarefa.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-694">If the maximum execution interval is exceeded, the Batch service interrupts the task application.</span></span>

### <a name="connecting-to-compute-nodes"></a><span data-ttu-id="aa2e8-695">Conectar-se a nós de computação</span><span class="sxs-lookup"><span data-stu-id="aa2e8-695">Connecting to compute nodes</span></span>
<span data-ttu-id="aa2e8-696">Você pode executar uma depuração e solução de problemas adicionais conectando um nó de computação remotamente.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-696">You can perform additional debugging and troubleshooting by signing in to a compute node remotely.</span></span> <span data-ttu-id="aa2e8-697">Você pode usar o portal do Azure para baixar um arquivo RDP (Remote Desktop Protocol) para os nós do Windows e obter informações da conexão SSH (Secure Shell) para os nós do Linux.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-697">You can use the Azure portal to download a Remote Desktop Protocol (RDP) file for Windows nodes and obtain Secure Shell (SSH) connection information for Linux nodes.</span></span> <span data-ttu-id="aa2e8-698">Você também pode fazer isso usando as APIs do Lote – por exemplo, com o [.NET do Lote][net_rdpfile] ou o [Python do Lote](batch-linux-nodes.md#connect-to-linux-nodes-using-ssh).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-698">You can also do this by using the Batch APIs--for example, with [Batch .NET][net_rdpfile] or [Batch Python](batch-linux-nodes.md#connect-to-linux-nodes-using-ssh).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="aa2e8-699">Para se conectar a um nó via RDP ou SSH, primeiro você deve criar um usuário no nó.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-699">To connect to a node via RDP or SSH, you must first create a user on the node.</span></span> <span data-ttu-id="aa2e8-700">Para tanto, você pode usar o portal do Azure, [adicionar uma conta de usuário a um nó][rest_create_user] usando a API REST do Lote, chamar o método [ComputeNode.CreateComputeNodeUser][net_create_user] no .NET do Lote ou chamar o método [add_user][py_add_user] no módulo Python do Lote.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-700">To do this, you can use the Azure portal, [add a user account to a node][rest_create_user] by using the Batch REST API, call the [ComputeNode.CreateComputeNodeUser][net_create_user] method in Batch .NET, or call the [add_user][py_add_user] method in the Batch Python module.</span></span>
>
>

### <a name="troubleshooting-problematic-compute-nodes"></a><span data-ttu-id="aa2e8-701">Solucionando os nós de computação problemáticos</span><span class="sxs-lookup"><span data-stu-id="aa2e8-701">Troubleshooting problematic compute nodes</span></span>
<span data-ttu-id="aa2e8-702">Em situações em que algumas das tarefas falham, o aplicativo cliente ou o serviço de Lote pode examinar os metadados das tarefas com falha para identificar um nó com comportamento inadequado.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-702">In situations where some of your tasks are failing, your Batch client application or service can examine the metadata of the failed tasks to identify a misbehaving node.</span></span> <span data-ttu-id="aa2e8-703">Cada nó em um pool tem uma ID exclusiva, e o nó no qual uma tarefa é executada é incluído nos metadados da tarefa.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-703">Each node in a pool is given a unique ID, and the node on which a task runs is included in the task metadata.</span></span> <span data-ttu-id="aa2e8-704">Após identificar um nó com problemas, você poderá executar várias ações nele:</span><span class="sxs-lookup"><span data-stu-id="aa2e8-704">After you've identified a problem node, you can take several actions with it:</span></span>

* <span data-ttu-id="aa2e8-705">**Reiniciar o nó** ([REST][rest_reboot] | [.NET][net_reboot])</span><span class="sxs-lookup"><span data-stu-id="aa2e8-705">**Reboot the node** ([REST][rest_reboot] | [.NET][net_reboot])</span></span>

    <span data-ttu-id="aa2e8-706">Às vezes, reiniciar o nó pode corrigir problemas latentes, como processos bloqueados ou com falha.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-706">Restarting the node can sometimes clear up latent issues like stuck or crashed processes.</span></span> <span data-ttu-id="aa2e8-707">Observe que, se o pool usar uma tarefa de inicialização ou se o trabalho usar uma tarefa de preparação de trabalho, eles serão executados quando o nó for reiniciado.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-707">Note that if your pool uses a start task or your job uses a job preparation task, they are executed when the node restarts.</span></span>
* <span data-ttu-id="aa2e8-708">**Refazer a imagem do nó** ([REST][rest_reimage] | [.NET][net_reimage])</span><span class="sxs-lookup"><span data-stu-id="aa2e8-708">**Reimage the node** ([REST][rest_reimage] | [.NET][net_reimage])</span></span>

    <span data-ttu-id="aa2e8-709">Esse procedimento reinstala o sistema operacional no nó.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-709">This reinstalls the operating system on the node.</span></span> <span data-ttu-id="aa2e8-710">Assim como ocorre com a reinicialização de um nó, as tarefas de inicialização e de preparação de trabalho são executadas novamente depois que a imagem do nó é refeita.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-710">As with rebooting a node, start tasks and job preparation tasks are rerun after the node has been reimaged.</span></span>
* <span data-ttu-id="aa2e8-711">**Remover o nó do pool** ([REST][rest_remove] | [.NET][net_remove])</span><span class="sxs-lookup"><span data-stu-id="aa2e8-711">**Remove the node from the pool** ([REST][rest_remove] | [.NET][net_remove])</span></span>

    <span data-ttu-id="aa2e8-712">Às vezes, é necessário remover completamente o nó do pool.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-712">Sometimes it is necessary to completely remove the node from the pool.</span></span>
* <span data-ttu-id="aa2e8-713">**Desabilitar o agendamento de tarefas no nó** ([REST][rest_offline] | [.NET][net_offline])</span><span class="sxs-lookup"><span data-stu-id="aa2e8-713">**Disable task scheduling on the node** ([REST][rest_offline] | [.NET][net_offline])</span></span>

    <span data-ttu-id="aa2e8-714">Isso efetivamente coloca o nó offline para que nenhuma tarefa adicional seja atribuída a ele, mas permite que o nó permaneça em execução e no pool.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-714">This effectively takes the node offline so that no further tasks are assigned to it, but allows the node to remain running and in the pool.</span></span> <span data-ttu-id="aa2e8-715">Isso o habilita a continuar a investigar a causa das falhas sem perder os dados da tarefa com falha e sem que o nó cause falhas de tarefas adicionais.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-715">This enables you to perform further investigation into the cause of the failures without losing the failed task's data, and without the node causing additional task failures.</span></span> <span data-ttu-id="aa2e8-716">Por exemplo, você pode desabilitar o agendamento de tarefas no nó e [fazer logon remotamente](#connecting-to-compute-nodes) para examinar os logs de evento do nó ou solucionar outros problemas.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-716">For example, you can disable task scheduling on the node, then [sign in remotely](#connecting-to-compute-nodes) to examine the node's event logs or perform other troubleshooting.</span></span> <span data-ttu-id="aa2e8-717">Depois de concluir sua investigação, você poderá colocar o nó online novamente, permitindo o agendamento da tarefa ([REST][rest_online] | [.NET][net_online]) ou executar uma das ações analisadas anteriormente.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-717">After you've finished your investigation, you can then bring the node back online by enabling task scheduling ([REST][rest_online] | [.NET][net_online]), or perform one of the other actions discussed earlier.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="aa2e8-718">Com cada ação descrita nesta seção – reinicializar, refazer a imagem, remover e desabilitar o agendamento de tarefas – é possível especificar como as tarefas atualmente em execução no nó são lidadas quando você executa a ação.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-718">With each action that is described in this section--reboot, reimage, remove, and disable task scheduling--you are able to specify how tasks currently running on the node are handled when you perform the action.</span></span> <span data-ttu-id="aa2e8-719">Por exemplo, quando você desabilita o agendamento de tarefas em um nó usando a biblioteca de cliente .NET do Lote, pode especificar um valor de enumeração [DisableComputeNodeSchedulingOption][net_offline_option] para especificar se deseja **Terminar** as tarefas em execução, **Recolocar em fila** para o agendamento em outros nós ou permitir que a execução das tarefas conclua antes de executar a ação (**TaskCompletion**).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-719">For example, when you disable task scheduling on a node by using the Batch .NET client library, you can specify a [DisableComputeNodeSchedulingOption][net_offline_option] enum value to specify whether to **Terminate** running tasks, **Requeue** them for scheduling on other nodes, or allow running tasks to complete before performing the action (**TaskCompletion**).</span></span>
>
>

## <a name="next-steps"></a><span data-ttu-id="aa2e8-720">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="aa2e8-720">Next steps</span></span>
* <span data-ttu-id="aa2e8-721">Saiba mais sobre as [Ferramentas e APIs do Lote](batch-apis-tools.md) disponíveis para a criação de soluções do Lote.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-721">Learn about the [Batch APIs and tools](batch-apis-tools.md) available for building Batch solutions.</span></span>
* <span data-ttu-id="aa2e8-722">Veja o passo a passo do aplicativo de exemplo do Lote em [Introdução à Biblioteca do Lote do Azure para .NET](batch-dotnet-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-722">Walk through a sample Batch application step-by-step in [Get started with the Azure Batch Library for .NET](batch-dotnet-get-started.md).</span></span> <span data-ttu-id="aa2e8-723">Também há uma [versão em Python](batch-python-tutorial.md) do tutorial que executa uma carga de trabalho nos nós de computação do Linux.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-723">There is also a [Python version](batch-python-tutorial.md) of the tutorial that runs a workload on Linux compute nodes.</span></span>
* <span data-ttu-id="aa2e8-724">Baixe e compile o projeto de exemplo [Gerenciador do Lote][github_batchexplorer] para usar durante o desenvolvimento de suas soluções de Lote.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-724">Download and build the [Batch Explorer][github_batchexplorer] sample project for use while you develop your Batch solutions.</span></span> <span data-ttu-id="aa2e8-725">Usando o Gerenciador do Lote, você pode executar o seguinte e muito mais:</span><span class="sxs-lookup"><span data-stu-id="aa2e8-725">Using the Batch Explorer, you can perform the following and more:</span></span>

  * <span data-ttu-id="aa2e8-726">Monitorar e manipular pools, trabalhos e tarefas em sua conta do Lote</span><span class="sxs-lookup"><span data-stu-id="aa2e8-726">Monitor and manipulate pools, jobs, and tasks within your Batch account</span></span>
  * <span data-ttu-id="aa2e8-727">Baixe `stdout.txt`, `stderr.txt` e outros arquivos de nós</span><span class="sxs-lookup"><span data-stu-id="aa2e8-727">Download `stdout.txt`, `stderr.txt`, and other files from nodes</span></span>
  * <span data-ttu-id="aa2e8-728">Criar usuários em nós e baixar arquivos RDP para logon remoto</span><span class="sxs-lookup"><span data-stu-id="aa2e8-728">Create users on nodes and download RDP files for remote login</span></span>
* <span data-ttu-id="aa2e8-729">Saiba como [criar pools de nós de computação do Linux](batch-linux-nodes.md).</span><span class="sxs-lookup"><span data-stu-id="aa2e8-729">Learn how to [create pools of Linux compute nodes](batch-linux-nodes.md).</span></span>
* <span data-ttu-id="aa2e8-730">Visite o [fórum do Lote do Azure][batch_forum] no MSDN.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-730">Visit the [Azure Batch forum][batch_forum] on MSDN.</span></span> <span data-ttu-id="aa2e8-731">O fórum é um bom lugar para fazer perguntas se você está apenas aprendendo ou se é especialista no Lote.</span><span class="sxs-lookup"><span data-stu-id="aa2e8-731">The forum is a good place to ask questions, whether you are just learning or are an expert in using Batch.</span></span>

[1]: ./media/batch-api-basics/node-folder-structure.png

[azure_storage]: https://azure.microsoft.com/services/storage/
[batch_forum]: https://social.msdn.microsoft.com/Forums/en-US/home?forum=azurebatch
[cloud_service_sizes]: ../cloud-services/cloud-services-sizes-specs.md
[msmpi]: https://msdn.microsoft.com/library/bb524831.aspx
[github_samples]: https://github.com/Azure/azure-batch-samples
[github_sample_taskdeps]:  https://github.com/Azure/azure-batch-samples/tree/master/CSharp/ArticleProjects/TaskDependencies
[github_batchexplorer]: https://github.com/Azure/azure-batch-samples/tree/master/CSharp/BatchExplorer
[batch_net_api]: https://msdn.microsoft.com/library/azure/mt348682.aspx
[msdn_env_vars]: https://msdn.microsoft.com/library/azure/mt743623.aspx
[net_cloudjob_jobmanagertask]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.cloudjob.jobmanagertask.aspx
[net_cloudjob_priority]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.cloudjob.priority.aspx
[net_cloudpool_starttask]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.cloudpool.starttask.aspx
[net_cloudtask_env]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.cloudtask.environmentsettings.aspx
[net_create_cert]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.certificateoperations.createcertificate.aspx
[net_create_user]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.computenode.createcomputenodeuser.aspx
[net_getfile_node]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.computenode.getnodefile.aspx
[net_getfile_task]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.cloudtask.getnodefile.aspx
[net_job_env]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.cloudjob.commonenvironmentsettings.aspx
[net_multiinstancesettings]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.multiinstancesettings.aspx
[net_onalltaskscomplete]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.cloudjob.onalltaskscomplete.aspx
[net_rdp]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.computenode.getrdpfile.aspx
[net_reboot]: https://msdn.microsoft.com/library/azure/mt631495.aspx
[net_reimage]: https://msdn.microsoft.com/library/azure/mt631496.aspx
[net_remove]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.pooloperations.removefrompoolasync.aspx
[net_offline]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.computenode.disableschedulingasync.aspx
[net_online]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.computenode.enableschedulingasync.aspx
[net_offline_option]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.common.disablecomputenodeschedulingoption.aspx
[net_rdpfile]: https://msdn.microsoft.com/library/azure/Mt272127.aspx
[vnet]: https://msdn.microsoft.com/library/azure/dn820174.aspx#bk_netconf

[py_add_user]: http://azure-sdk-for-python.readthedocs.io/en/latest/ref/azure.batch.operations.html#azure.batch.operations.ComputeNodeOperations.add_user

[batch_rest_api]: https://msdn.microsoft.com/library/azure/Dn820158.aspx
[rest_add_job]: https://msdn.microsoft.com/library/azure/mt282178.aspx
[rest_add_pool]: https://msdn.microsoft.com/library/azure/dn820174.aspx
[rest_add_cert]: https://msdn.microsoft.com/library/azure/dn820169.aspx
[rest_add_task]: https://msdn.microsoft.com/library/azure/dn820105.aspx
[rest_create_user]: https://msdn.microsoft.com/library/azure/dn820137.aspx
[rest_get_task_info]: https://msdn.microsoft.com/library/azure/dn820133.aspx
[rest_job_schedules]: https://msdn.microsoft.com/library/azure/mt282179.aspx
[rest_multiinstance]: https://msdn.microsoft.com/library/azure/mt637905.aspx
[rest_multiinstancesettings]: https://msdn.microsoft.com/library/azure/dn820105.aspx#multiInstanceSettings
[rest_update_job]: https://msdn.microsoft.com/library/azure/dn820162.aspx
[rest_rdp]: https://msdn.microsoft.com/library/azure/dn820120.aspx
[rest_reboot]: https://msdn.microsoft.com/library/azure/dn820171.aspx
[rest_reimage]: https://msdn.microsoft.com/library/azure/dn820157.aspx
[rest_remove]: https://msdn.microsoft.com/library/azure/dn820194.aspx
[rest_offline]: https://msdn.microsoft.com/library/azure/mt637904.aspx
[rest_online]: https://msdn.microsoft.com/library/azure/mt637907.aspx

[vm_marketplace]: https://azure.microsoft.com/marketplace/virtual-machines/
