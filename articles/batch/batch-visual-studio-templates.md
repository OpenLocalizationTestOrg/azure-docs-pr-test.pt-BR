---
title: "aaaStart criar soluções de lote com modelos de projeto do Visual Studio - Azure | Microsoft Docs"
description: "Saiba como os modelos de projeto do Visual Studio podem ajudar você a implementar e executar suas cargas de trabalho de computação intensa no Lote do Azure."
services: batch
documentationcenter: .net
author: fayora
manager: timlt
editor: 
ms.assetid: 5e041ae2-25af-4882-a79e-3aa63c4bfb20
ms.service: batch
ms.devlang: multiple
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: big-compute
ms.date: 02/27/2017
ms.author: tamram
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: a61c480ddc4dffd66c01220a137a3e852e39c338
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="use-visual-studio-project-templates-toojump-start-batch-solutions"></a><span data-ttu-id="8648b-103">Usar soluções do Visual Studio project modelos toojump Iniciar em lotes</span><span class="sxs-lookup"><span data-stu-id="8648b-103">Use Visual Studio project templates toojump-start Batch solutions</span></span>

<span data-ttu-id="8648b-104">Olá **Gerenciador de trabalhos** e **modelos do Visual Studio do processador de tarefa** de lote de fornecer código toohelp você tooimplement e executar suas cargas de trabalho com computação intensiva em lote com hello menos esforço.</span><span class="sxs-lookup"><span data-stu-id="8648b-104">hello **Job Manager** and **Task Processor Visual Studio templates** for Batch provide code toohelp you tooimplement and run your compute-intensive workloads on Batch with hello least amount of effort.</span></span> <span data-ttu-id="8648b-105">Este documento descreve esses modelos e fornece orientação sobre como toouse-los.</span><span class="sxs-lookup"><span data-stu-id="8648b-105">This document describes these templates and provides guidance for how toouse them.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8648b-106">Este artigo discute somente modelos de toothese aplicável duas informações e pressupõe que você esteja familiarizado com o serviço de lote hello e tooit relacionados conceitos principais: computação de pools, nós, trabalhos e tarefas, tarefas do Gerenciador de trabalho, variáveis de ambiente e outros informações relevantes.</span><span class="sxs-lookup"><span data-stu-id="8648b-106">This article discusses only information applicable toothese two templates, and assumes that you are familiar with hello Batch service and key concepts related tooit: pools, compute nodes, jobs and tasks, job manager tasks, environment variables, and other relevant information.</span></span> <span data-ttu-id="8648b-107">Você pode encontrar mais informações em [Noções básicas do lote do Azure](batch-technical-overview.md), [visão geral do recurso de lote para desenvolvedores](batch-api-basics.md), e [Introdução à biblioteca do lote do Azure de saudação para .NET](batch-dotnet-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="8648b-107">You can find more information in [Basics of Azure Batch](batch-technical-overview.md), [Batch feature overview for developers](batch-api-basics.md), and [Get started with hello Azure Batch library for .NET](batch-dotnet-get-started.md).</span></span>
> 
> 

## <a name="high-level-overview"></a><span data-ttu-id="8648b-108">Visão geral de alto nível</span><span class="sxs-lookup"><span data-stu-id="8648b-108">High-level overview</span></span>
<span data-ttu-id="8648b-109">modelos de Gerenciador de trabalhos e tarefas processador Olá podem ser usado toocreate dois componentes úteis:</span><span class="sxs-lookup"><span data-stu-id="8648b-109">hello Job Manager and Task Processor templates can be used toocreate two useful components:</span></span>

* <span data-ttu-id="8648b-110">Uma tarefa do gerenciador de trabalho que implementa um divisor de trabalho que pode, por sua vez, dividir um trabalho em várias tarefas que podem ser executadas de forma independente, em paralelo.</span><span class="sxs-lookup"><span data-stu-id="8648b-110">A job manager task that implements a job splitter that can break a job down into multiple tasks that can run independently, in parallel.</span></span>
* <span data-ttu-id="8648b-111">Um processador de tarefas que pode ser usados tooperform pré-processando e pós-processamento em torno de uma linha de comando do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="8648b-111">A task processor that can be used tooperform pre-processing and post-processing around an application command line.</span></span>

<span data-ttu-id="8648b-112">Por exemplo, em um cenário de renderização de filme, divisor de trabalho Olá seria transformar um trabalho único de filme em centenas ou milhares de tarefas separadas que processam quadros individuais separadamente.</span><span class="sxs-lookup"><span data-stu-id="8648b-112">For example, in a movie rendering scenario, hello job splitter would turn a single movie job into hundreds or thousands of separate tasks that would process individual frames separately.</span></span> <span data-ttu-id="8648b-113">De forma correspondente, processador de tarefa Olá seria invocar Olá renderização de aplicativo e todos os processos dependentes que são necessária toorender cada quadro, bem como executar ações adicionais (por exemplo, copiando Olá renderizado quadro tooa local de armazenamento).</span><span class="sxs-lookup"><span data-stu-id="8648b-113">Correspondingly, hello task processor would invoke hello rendering application and all dependent processes that are needed toorender each frame, as well as perform any additional actions (for example, copying hello rendered frame tooa storage location).</span></span>

> [!NOTE]
> <span data-ttu-id="8648b-114">modelos de Gerenciador de trabalhos e tarefas processador Olá são independentes entre si, assim você pode escolher toouse ambos ou apenas um deles, dependendo dos requisitos de saudação do seu trabalho de computação e em suas preferências.</span><span class="sxs-lookup"><span data-stu-id="8648b-114">hello Job Manager and Task Processor templates are independent of each other, so you can choose toouse both, or only one of them, depending on hello requirements of your compute job and on your preferences.</span></span>
> 
> 

<span data-ttu-id="8648b-115">Conforme mostrado no diagrama de saudação abaixo, um trabalho de computação que usa esses modelos passará por três estágios:</span><span class="sxs-lookup"><span data-stu-id="8648b-115">As shown in hello diagram below, a compute job that uses these templates will go through three stages:</span></span>

1. <span data-ttu-id="8648b-116">código de cliente da saudação (por exemplo, aplicativo, serviço web, etc.) envia um serviço de lote no Azure, especificando como seu programa de Gerenciador de trabalho trabalho manager tarefa Olá de toohello de trabalho.</span><span class="sxs-lookup"><span data-stu-id="8648b-116">hello client code (e.g., application, web service, etc.) submits a job toohello Batch service on Azure, specifying as its job manager task hello job manager program.</span></span>
2. <span data-ttu-id="8648b-117">serviço de lote Olá executa a tarefa do Gerenciador de trabalho Olá em um nó de computação e hello trabalho divisor inicia Olá especificado número de tarefas de processador, em como muitos nós de computação conforme necessário, com base nas especificações no código do divisor de trabalho hello e parâmetros de saudação.</span><span class="sxs-lookup"><span data-stu-id="8648b-117">hello Batch service runs hello job manager task on a compute node and hello job splitter launches hello specified number of task processor tasks, on as many compute nodes as required, based on hello parameters and specifications in hello job splitter code.</span></span>
3. <span data-ttu-id="8648b-118">Olá processador tarefas executam de forma independente, em paralelo, tooprocess os dados de entrada hello e geram dados de saída de saudação.</span><span class="sxs-lookup"><span data-stu-id="8648b-118">hello task processor tasks run independently, in parallel, tooprocess hello input data and generate hello output data.</span></span>

![Diagrama mostrando como o código do cliente interage com hello serviço de lote][diagram01]

## <a name="prerequisites"></a><span data-ttu-id="8648b-120">Pré-requisitos</span><span class="sxs-lookup"><span data-stu-id="8648b-120">Prerequisites</span></span>
<span data-ttu-id="8648b-121">toouse modelos de lote hello, você precisará seguir hello:</span><span class="sxs-lookup"><span data-stu-id="8648b-121">toouse hello Batch templates, you will need hello following:</span></span>

* <span data-ttu-id="8648b-122">Um computador com o Visual Studio 2015 instalado.</span><span class="sxs-lookup"><span data-stu-id="8648b-122">A computer with Visual Studio 2015 installed.</span></span> <span data-ttu-id="8648b-123">Modelos de lote atualmente só têm suporte para o Visual Studio 2015.</span><span class="sxs-lookup"><span data-stu-id="8648b-123">Batch templates are currently only supported for Visual Studio 2015.</span></span>
* <span data-ttu-id="8648b-124">modelos de lote Hello, que estão disponíveis no hello [Galeria do Visual Studio] [ vs_gallery] como extensões do Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="8648b-124">hello Batch templates, which are available from hello [Visual Studio Gallery][vs_gallery] as Visual Studio extensions.</span></span> <span data-ttu-id="8648b-125">Há duas maneiras de modelos de saudação tooget:</span><span class="sxs-lookup"><span data-stu-id="8648b-125">There are two ways tooget hello templates:</span></span>
  
  * <span data-ttu-id="8648b-126">Instalar os modelos de saudação usando Olá **extensões e atualizações** caixa de diálogo no Visual Studio (para obter mais informações, consulte [Localizando e usando extensões do Visual Studio][vs_find_use_ext]).</span><span class="sxs-lookup"><span data-stu-id="8648b-126">Install hello templates using hello **Extensions and Updates** dialog box in Visual Studio (for more information, see [Finding and Using Visual Studio Extensions][vs_find_use_ext]).</span></span> <span data-ttu-id="8648b-127">Em Olá **extensões e atualizações** caixa de diálogo, pesquisa e download Olá duas extensões a seguir:</span><span class="sxs-lookup"><span data-stu-id="8648b-127">In hello **Extensions and Updates** dialog box, search and download hello following two extensions:</span></span>
    
    * <span data-ttu-id="8648b-128">Gerenciador de Trabalhos do Lote do Azure com o Divisor de Trabalho</span><span class="sxs-lookup"><span data-stu-id="8648b-128">Azure Batch Job Manager with Job Splitter</span></span>
    * <span data-ttu-id="8648b-129">Processador de Tarefas do Lote do Azure</span><span class="sxs-lookup"><span data-stu-id="8648b-129">Azure Batch Task Processor</span></span>
  * <span data-ttu-id="8648b-130">Baixar modelos de saudação da galeria online Olá para o Visual Studio: [modelos de projeto de lote do Microsoft Azure][vs_gallery_templates]</span><span class="sxs-lookup"><span data-stu-id="8648b-130">Download hello templates from hello online gallery for Visual Studio: [Microsoft Azure Batch Project Templates][vs_gallery_templates]</span></span>
* <span data-ttu-id="8648b-131">Se você planejar Olá toouse [pacotes de aplicativos](batch-application-packages.md) nós de computação do Gerenciador de trabalhos do recurso toodeploy hello e toohello do processador de tarefa em lotes, é necessário toolink uma conta de armazenamento tooyour conta do lote.</span><span class="sxs-lookup"><span data-stu-id="8648b-131">If you plan toouse hello [Application Packages](batch-application-packages.md) feature toodeploy hello job manager and task processor toohello Batch compute nodes, you need toolink a storage account tooyour Batch account.</span></span>

## <a name="preparation"></a><span data-ttu-id="8648b-132">Preparação</span><span class="sxs-lookup"><span data-stu-id="8648b-132">Preparation</span></span>
<span data-ttu-id="8648b-133">É recomendável criar uma solução que pode conter seu Gerenciador de trabalho, bem como o processador de tarefa, porque isso pode tornar mais fácil código tooshare entre o Gerenciador de trabalhos e programas de processador da tarefa.</span><span class="sxs-lookup"><span data-stu-id="8648b-133">We recommend creating a solution that can contain your job manager as well as your task processor, because this can make it easier tooshare code between your job manager and task processor programs.</span></span> <span data-ttu-id="8648b-134">toocreate nesta solução, siga estas etapas:</span><span class="sxs-lookup"><span data-stu-id="8648b-134">toocreate this solution, follow these steps:</span></span>

1. <span data-ttu-id="8648b-135">Abra o Visual Studio e selecione **Arquivo** > **Novo** > **Projeto**.</span><span class="sxs-lookup"><span data-stu-id="8648b-135">Open Visual Studio and select **File** > **New** > **Project**.</span></span>
2. <span data-ttu-id="8648b-136">Em **Modelos**, expanda **Outros Tipos de Projeto**, clique em **Soluções do Visual Studio** e, em seguida, selecione **Solução em Branco**.</span><span class="sxs-lookup"><span data-stu-id="8648b-136">Under **Templates**, expand **Other Project Types**, click **Visual Studio Solutions**, and then select **Blank Solution**.</span></span>
3. <span data-ttu-id="8648b-137">Digite um nome que descreve a finalidade de aplicativo e hello dessa solução (por exemplo, "LitwareBatchTaskPrograms").</span><span class="sxs-lookup"><span data-stu-id="8648b-137">Type a name that describes your application and hello purpose of this solution (e.g., "LitwareBatchTaskPrograms").</span></span>
4. <span data-ttu-id="8648b-138">toocreate Olá nova solução, clique em **Okey**.</span><span class="sxs-lookup"><span data-stu-id="8648b-138">toocreate hello new solution, click **OK**.</span></span>

## <a name="job-manager-template"></a><span data-ttu-id="8648b-139">Modelo do Gerenciador de trabalho</span><span class="sxs-lookup"><span data-stu-id="8648b-139">Job Manager template</span></span>
<span data-ttu-id="8648b-140">modelo do Gerenciador de trabalhos Olá ajuda tooimplement uma tarefa do Gerenciador de trabalho que pode executar Olá ações a seguir:</span><span class="sxs-lookup"><span data-stu-id="8648b-140">hello Job Manager template helps you tooimplement a job manager task that can perform hello following actions:</span></span>

* <span data-ttu-id="8648b-141">Dividir um trabalho em várias tarefas.</span><span class="sxs-lookup"><span data-stu-id="8648b-141">Split a job into multiple tasks.</span></span>
* <span data-ttu-id="8648b-142">Envie toorun essas tarefas em lote.</span><span class="sxs-lookup"><span data-stu-id="8648b-142">Submit those tasks toorun on Batch.</span></span>

> [!NOTE]
> <span data-ttu-id="8648b-143">Para saber mais sobre as tarefas do Gerenciador de trabalho, confira [Visão geral do recurso Lote para desenvolvedores](batch-api-basics.md#job-manager-task).</span><span class="sxs-lookup"><span data-stu-id="8648b-143">For more information about job manager tasks, see [Batch feature overview for developers](batch-api-basics.md#job-manager-task).</span></span>
> 
> 

### <a name="create-a-job-manager-using-hello-template"></a><span data-ttu-id="8648b-144">Criar um Gerenciador de trabalho usando o modelo de saudação</span><span class="sxs-lookup"><span data-stu-id="8648b-144">Create a Job Manager using hello template</span></span>
<span data-ttu-id="8648b-145">tooadd uma solução de toohello do Gerenciador de trabalho que você criou anteriormente, siga estas etapas:</span><span class="sxs-lookup"><span data-stu-id="8648b-145">tooadd a job manager toohello solution that you created earlier, follow these steps:</span></span>

1. <span data-ttu-id="8648b-146">Abra sua solução existente no Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="8648b-146">Open your existing solution in Visual Studio.</span></span>
2. <span data-ttu-id="8648b-147">No Gerenciador de soluções, solução de saudação com o botão direito, clique em **adicionar** > **novo projeto**.</span><span class="sxs-lookup"><span data-stu-id="8648b-147">In Solution Explorer, right-click hello solution, click **Add** > **New Project**.</span></span>
3. <span data-ttu-id="8648b-148">No **Visual C#**, clique em **Nuvem** e em **Gerenciador de trabalho do Lote do Azure com o Divisor de trabalho**.</span><span class="sxs-lookup"><span data-stu-id="8648b-148">Under **Visual C#**, click **Cloud**, and then click **Azure Batch Job Manager with Job Splitter**.</span></span>
4. <span data-ttu-id="8648b-149">Digite um nome que descreva o aplicativo e identifica este projeto como Gerenciador de trabalhos da saudação (por exemplo "GerenciadorDeTrabalhoLitware").</span><span class="sxs-lookup"><span data-stu-id="8648b-149">Type a name that describes your application and identifies this project as hello job manager (e.g. "LitwareJobManager").</span></span>
5. <span data-ttu-id="8648b-150">projeto de saudação toocreate, clique em **Okey**.</span><span class="sxs-lookup"><span data-stu-id="8648b-150">toocreate hello project, click **OK**.</span></span>
6. <span data-ttu-id="8648b-151">Finalmente, referenciado de compilação Olá projeto tooforce Visual Studio tooload todos os pacotes do NuGet e tooverify que Olá projeto é válido antes de começar a modificá-lo.</span><span class="sxs-lookup"><span data-stu-id="8648b-151">Finally, build hello project tooforce Visual Studio tooload all referenced NuGet packages and tooverify that hello project is valid before you start modifying it.</span></span>

### <a name="job-manager-template-files-and-their-purpose"></a><span data-ttu-id="8648b-152">Arquivos do modelo do Gerenciador de trabalho e suas finalidades</span><span class="sxs-lookup"><span data-stu-id="8648b-152">Job Manager template files and their purpose</span></span>
<span data-ttu-id="8648b-153">Quando você cria um projeto usando o modelo do Gerenciador de trabalhos hello, ele gera três grupos de arquivos de código:</span><span class="sxs-lookup"><span data-stu-id="8648b-153">When you create a project using hello Job Manager template, it generates three groups of code files:</span></span>

* <span data-ttu-id="8648b-154">arquivo de programa principal Hello (Program.cs).</span><span class="sxs-lookup"><span data-stu-id="8648b-154">hello main program file (Program.cs).</span></span> <span data-ttu-id="8648b-155">Ele contém o ponto de entrada de programa hello e manipulação de exceção de nível superior.</span><span class="sxs-lookup"><span data-stu-id="8648b-155">This contains hello program entry point and top-level exception handling.</span></span> <span data-ttu-id="8648b-156">Você normalmente não precisa toomodify isso.</span><span class="sxs-lookup"><span data-stu-id="8648b-156">You shouldn't normally need toomodify this.</span></span>
* <span data-ttu-id="8648b-157">diretório do Framework Hello.</span><span class="sxs-lookup"><span data-stu-id="8648b-157">hello Framework directory.</span></span> <span data-ttu-id="8648b-158">Isso contém arquivos de saudação responsáveis pelo trabalho 'padrão' hello pelo programa de Gerenciador de trabalho hello – desempacotar parâmetros, adicionando o trabalho de lote de toohello de tarefas, etc. Você normalmente não precisa toomodify esses arquivos.</span><span class="sxs-lookup"><span data-stu-id="8648b-158">This contains hello files responsible for hello 'boilerplate' work done by hello job manager program – unpacking parameters, adding tasks toohello Batch job, etc. You shouldn't normally need toomodify these files.</span></span>
* <span data-ttu-id="8648b-159">arquivo separador Olá trabalho (JobSplitter.cs).</span><span class="sxs-lookup"><span data-stu-id="8648b-159">hello job splitter file (JobSplitter.cs).</span></span> <span data-ttu-id="8648b-160">É nesse arquivo que você colocará a lógica específica ao aplicativo para a divisão de um trabalho em tarefas.</span><span class="sxs-lookup"><span data-stu-id="8648b-160">This is where you will put your application-specific logic for splitting a job into tasks.</span></span>

<span data-ttu-id="8648b-161">Obviamente você pode adicionar arquivos adicionais como toosupport necessário seu código de separador de trabalho, dependendo da complexidade de saudação do trabalho Olá divisão lógica.</span><span class="sxs-lookup"><span data-stu-id="8648b-161">Of course you can add additional files as required toosupport your job splitter code, depending on hello complexity of hello job splitting logic.</span></span>

<span data-ttu-id="8648b-162">modelo de saudação também gera arquivos de projeto padrão do .NET como um arquivo. csproj App. config, Packages, etc.</span><span class="sxs-lookup"><span data-stu-id="8648b-162">hello template also generates standard .NET project files such as a .csproj file, app.config, packages.config, etc.</span></span>

<span data-ttu-id="8648b-163">restante Olá desta seção descreve Olá diferentes arquivos e sua estrutura de código e explica o que faz cada classe.</span><span class="sxs-lookup"><span data-stu-id="8648b-163">hello rest of this section describes hello different files and their code structure, and explains what each class does.</span></span>

![Visual Studio Gerenciador de soluções mostrando a solução de modelo do Gerenciador de trabalhos Olá][solution_explorer01]

<span data-ttu-id="8648b-165">**Arquivos do Framework**</span><span class="sxs-lookup"><span data-stu-id="8648b-165">**Framework files**</span></span>

* <span data-ttu-id="8648b-166">`Configuration.cs`: Encapsula o carregamento de saudação de dados de configuração de trabalho, como detalhes da conta, as credenciais de conta de armazenamento vinculada, informações de trabalhos e tarefas e parâmetros do trabalho em lotes.</span><span class="sxs-lookup"><span data-stu-id="8648b-166">`Configuration.cs`: Encapsulates hello loading of job configuration data such as Batch account details, linked storage account credentials, job and task information, and job parameters.</span></span> <span data-ttu-id="8648b-167">Ele também fornece acesso definido tooBatch as variáveis de ambiente (consulte as configurações de ambiente para tarefas, na documentação do lote Olá) por meio da classe Configuration.EnvironmentVariable hello.</span><span class="sxs-lookup"><span data-stu-id="8648b-167">It also provides access tooBatch-defined environment variables (see Environment settings for tasks, in hello Batch documentation) via hello Configuration.EnvironmentVariable class.</span></span>
* <span data-ttu-id="8648b-168">`IConfiguration.cs`: Resumo Olá implementação de classe de configuração de hello, para que você possa de teste de unidade o divisor de trabalho usando um objeto de configuração falsas ou fictícias.</span><span class="sxs-lookup"><span data-stu-id="8648b-168">`IConfiguration.cs`: Abstracts hello implementation of hello Configuration class, so that you can unit test your job splitter using a fake or mock configuration object.</span></span>
* <span data-ttu-id="8648b-169">`JobManager.cs`: Coordena os componentes de saudação do programa de Gerenciador de trabalho Olá.</span><span class="sxs-lookup"><span data-stu-id="8648b-169">`JobManager.cs`: Orchestrates hello components of hello job manager program.</span></span> <span data-ttu-id="8648b-170">É responsável por Olá Inicializando divisor de trabalho hello, invocando divisor de trabalho Olá, e expedir tarefas Olá retornado pelo emissor da tarefa toohello Olá trabalho divisor.</span><span class="sxs-lookup"><span data-stu-id="8648b-170">It is responsible for hello initializing hello job splitter, invoking hello job splitter, and dispatching hello tasks returned by hello job splitter toohello task submitter.</span></span>
* <span data-ttu-id="8648b-171">`JobManagerException.cs`Representa um erro que exige Olá tooterminate de Gerenciador de trabalho.</span><span class="sxs-lookup"><span data-stu-id="8648b-171">`JobManagerException.cs`: Represents an error that requires hello job manager tooterminate.</span></span> <span data-ttu-id="8648b-172">JobManagerException é usado toowrap 'esperado' erros onde as informações de diagnóstico específicas podem ser fornecidas como parte do encerramento.</span><span class="sxs-lookup"><span data-stu-id="8648b-172">JobManagerException is used toowrap 'expected' errors where specific diagnostic information can be provided as part of termination.</span></span>
* <span data-ttu-id="8648b-173">`TaskSubmitter.cs`: Esta classe é responsável tooadding tarefas retornadas por um trabalho em lotes do hello trabalho divisor toohello.</span><span class="sxs-lookup"><span data-stu-id="8648b-173">`TaskSubmitter.cs`: This class is responsible tooadding tasks returned by hello job splitter toohello Batch job.</span></span> <span data-ttu-id="8648b-174">classe de JobManager Olá agrega sequência Olá das tarefas em lotes para o trabalho de toohello adição eficiente, mas em tempo hábil, em seguida, chama TaskSubmitter.SubmitTasks em um thread em segundo plano para cada lote.</span><span class="sxs-lookup"><span data-stu-id="8648b-174">hello JobManager class aggregates hello sequence of tasks into batches for efficient but timely addition toohello job, then calls TaskSubmitter.SubmitTasks on a background thread for each batch.</span></span>

<span data-ttu-id="8648b-175">**Divisor de trabalho**</span><span class="sxs-lookup"><span data-stu-id="8648b-175">**Job Splitter**</span></span>

<span data-ttu-id="8648b-176">`JobSplitter.cs`: Essa classe contém a lógica específica do aplicativo para dividir o trabalho de saudação em tarefas.</span><span class="sxs-lookup"><span data-stu-id="8648b-176">`JobSplitter.cs`: This class contains application-specific logic for splitting hello job into tasks.</span></span> <span data-ttu-id="8648b-177">estrutura Hello invoca Olá JobSplitter.Split método tooobtain uma sequência de tarefas, que adiciona trabalho toohello como método hello retorna-los.</span><span class="sxs-lookup"><span data-stu-id="8648b-177">hello framework invokes hello JobSplitter.Split method tooobtain a sequence of tasks, which it adds toohello job as hello method returns them.</span></span> <span data-ttu-id="8648b-178">Isso é classe Olá onde você será injetar lógica de saudação do seu trabalho.</span><span class="sxs-lookup"><span data-stu-id="8648b-178">This is hello class where you will inject hello logic of your job.</span></span> <span data-ttu-id="8648b-179">Implemente Olá divisão método tooreturn uma sequência de instâncias de CloudTask que representam tarefas Olá no qual você deseja que o trabalho de saudação toopartition.</span><span class="sxs-lookup"><span data-stu-id="8648b-179">Implement hello Split method tooreturn a sequence of CloudTask instances representing hello tasks into which you want toopartition hello job.</span></span>

<span data-ttu-id="8648b-180">**Arquivos de projeto de linha de comando .NET padrão**</span><span class="sxs-lookup"><span data-stu-id="8648b-180">**Standard .NET command line project files**</span></span>

* <span data-ttu-id="8648b-181">`App.config`: arquivo de configuração padrão de aplicativo .NET.</span><span class="sxs-lookup"><span data-stu-id="8648b-181">`App.config`: Standard .NET application configuration file.</span></span>
* <span data-ttu-id="8648b-182">`Packages.config`: arquivo de dependência padrão do pacote NuGet.</span><span class="sxs-lookup"><span data-stu-id="8648b-182">`Packages.config`: Standard NuGet package dependency file.</span></span>
* <span data-ttu-id="8648b-183">`Program.cs`: Contém o ponto de entrada de programa hello e manipulação de exceção de nível superior.</span><span class="sxs-lookup"><span data-stu-id="8648b-183">`Program.cs`: Contains hello program entry point and top-level exception handling.</span></span>

### <a name="implementing-hello-job-splitter"></a><span data-ttu-id="8648b-184">Implementando o divisor de trabalho Olá</span><span class="sxs-lookup"><span data-stu-id="8648b-184">Implementing hello job splitter</span></span>
<span data-ttu-id="8648b-185">Quando você abre um projeto de modelo do Gerenciador de trabalhos hello, o projeto Olá terá Olá JobSplitter.cs arquivo aberta por padrão.</span><span class="sxs-lookup"><span data-stu-id="8648b-185">When you open hello Job Manager template project, hello project will have hello JobSplitter.cs file open by default.</span></span> <span data-ttu-id="8648b-186">Você pode implementar Olá dividir lógica para tarefas de Olá na carga de trabalho usando mostrados do método split () Olá abaixo:</span><span class="sxs-lookup"><span data-stu-id="8648b-186">You can implement hello split logic for hello tasks in your workload by using hello Split() method show below:</span></span>

```csharp
/// <summary>
/// Gets hello tasks into which toosplit hello job. This is where you inject
/// your application-specific logic for decomposing hello job into tasks.
///
/// hello job manager framework invokes hello Split method for you; you need
/// only tooimplement it, not toocall it yourself. Typically, your
/// implementation should return tasks lazily, for example using a C#
/// iterator and hello "yield return" statement; this allows tasks toobe added
/// and toostart running while splitting is still in progress.
/// </summary>
/// <returns>hello tasks toobe added toohello job. Tasks are added automatically
/// by hello job manager framework as they are returned by this method.</returns>
public IEnumerable<CloudTask> Split()
{
    // Your code for hello split logic goes here.
    int startFrame = Convert.ToInt32(_parameters["StartFrame"]);
    int endFrame = Convert.ToInt32(_parameters["EndFrame"]);

    for (int i = startFrame; i <= endFrame; i++)
    {
        yield return new CloudTask("myTask" + i, "cmd /c dir");
    }
}
```

> [!NOTE]
> <span data-ttu-id="8648b-187">Olá anotado seção Olá `Split()` método é somente seção Olá Olá código de modelo do Gerenciador de trabalhos que é destinado para você toomodify adicionando Olá lógica toosplit seus trabalhos para tarefas diferentes.</span><span class="sxs-lookup"><span data-stu-id="8648b-187">hello annotated section in hello `Split()` method is hello only section of hello Job Manager template code that is intended for you toomodify by adding hello logic toosplit your jobs into different tasks.</span></span> <span data-ttu-id="8648b-188">Se você quiser toomodify uma seção diferente do modelo hello, verifique se você é trazido com como funciona o lote e experimentar algumas das Olá [exemplos de código do lote][github_samples].</span><span class="sxs-lookup"><span data-stu-id="8648b-188">If you want toomodify a different section of hello template, please ensure you are familiarized with how Batch works, and try out a few of hello [Batch code samples][github_samples].</span></span>
> 
> 

<span data-ttu-id="8648b-189">Sua implementação de Split() tem acesso a:</span><span class="sxs-lookup"><span data-stu-id="8648b-189">Your Split() implementation has access to:</span></span>

* <span data-ttu-id="8648b-190">Olá parâmetros do trabalho, via Olá `_parameters` campo.</span><span class="sxs-lookup"><span data-stu-id="8648b-190">hello job parameters, via hello `_parameters` field.</span></span>
* <span data-ttu-id="8648b-191">Olá CloudJob objeto representando trabalho hello, por meio de saudação `_job` campo.</span><span class="sxs-lookup"><span data-stu-id="8648b-191">hello CloudJob object representing hello job, via hello `_job` field.</span></span>
* <span data-ttu-id="8648b-192">Olá CloudTask objeto representando tarefa do Gerenciador de trabalho hello, por meio de saudação `_jobManagerTask` campo.</span><span class="sxs-lookup"><span data-stu-id="8648b-192">hello CloudTask object representing hello job manager task, via hello `_jobManagerTask` field.</span></span>

<span data-ttu-id="8648b-193">O `Split()` implementação não precisa de trabalho de toohello tooadd tarefas diretamente.</span><span class="sxs-lookup"><span data-stu-id="8648b-193">Your `Split()` implementation does not need tooadd tasks toohello job directly.</span></span> <span data-ttu-id="8648b-194">Em vez disso, seu código deve retornar uma sequência de objetos CloudTask, e eles serão adicionados toohello trabalho automaticamente pelas classes de framework Olá que invocam divisor de trabalho hello.</span><span class="sxs-lookup"><span data-stu-id="8648b-194">Instead, your code should return a sequence of CloudTask objects, and these will be added toohello job automatically by hello framework classes that invoke hello job splitter.</span></span> <span data-ttu-id="8648b-195">É comum iterador de toouse do # (`yield return`) tooimplement divisores de trabalho de recursos, como isso permite Olá toostart de tarefas em execução assim que possível em vez de aguardar toobe de todas as tarefas calculados.</span><span class="sxs-lookup"><span data-stu-id="8648b-195">It's common toouse C#'s iterator (`yield return`) feature tooimplement job splitters as this allows hello tasks toostart running as soon as possible rather than waiting for all tasks toobe calculated.</span></span>

<span data-ttu-id="8648b-196">**Falha do divisor de trabalho**</span><span class="sxs-lookup"><span data-stu-id="8648b-196">**Job splitter failure**</span></span>

<span data-ttu-id="8648b-197">Se o divisor de trabalho encontrar um erro, ele deverá:</span><span class="sxs-lookup"><span data-stu-id="8648b-197">If your job splitter encounters an error, it should either:</span></span>

* <span data-ttu-id="8648b-198">Encerrar a sequência de saudação usando Olá c# `yield break` instrução, em que o Gerenciador de trabalhos Olá caso será tratado com êxito; ou</span><span class="sxs-lookup"><span data-stu-id="8648b-198">Terminate hello sequence using hello C# `yield break` statement, in which case hello job manager will be treated as successful; or</span></span>
* <span data-ttu-id="8648b-199">Gera uma exceção, no qual o Gerenciador de trabalhos Olá caso será tratado como falha e pode ser repetido dependendo de como o cliente Olá tiver configurado).</span><span class="sxs-lookup"><span data-stu-id="8648b-199">Throw an exception, in which case hello job manager will be treated as failed and may be retried depending on how hello client has configured it).</span></span>

<span data-ttu-id="8648b-200">Em ambos os casos, todas as tarefas já retornado pelo separador de trabalho hello e trabalho em lotes de toohello adicionado será toorun qualificado.</span><span class="sxs-lookup"><span data-stu-id="8648b-200">In both cases, any tasks already returned by hello job splitter and added toohello Batch job will be eligible toorun.</span></span> <span data-ttu-id="8648b-201">Se não quiser que esta toohappen, em seguida, você pode:</span><span class="sxs-lookup"><span data-stu-id="8648b-201">If you don't want this toohappen, then you could:</span></span>

* <span data-ttu-id="8648b-202">Encerrar trabalho Olá antes de retornar de separador de trabalho Olá</span><span class="sxs-lookup"><span data-stu-id="8648b-202">Terminate hello job before returning from hello job splitter</span></span>
* <span data-ttu-id="8648b-203">Formular a coleção de tarefas inteira Olá antes de retorná-lo (ou seja, retornar um `ICollection<CloudTask>` ou `IList<CloudTask>` em vez de implementar o divisor de trabalho usando um iterador de c#)</span><span class="sxs-lookup"><span data-stu-id="8648b-203">Formulate hello entire task collection before returning it (that is, return an `ICollection<CloudTask>` or `IList<CloudTask>` instead of implementing your job splitter using a C# iterator)</span></span>
* <span data-ttu-id="8648b-204">Use a tarefa dependências toomake que dependem de todas as tarefas após a conclusão bem-sucedida do Gerenciador de trabalhos Olá Olá</span><span class="sxs-lookup"><span data-stu-id="8648b-204">Use task dependencies toomake all tasks depend on hello successful completion of hello job manager</span></span>

<span data-ttu-id="8648b-205">**Novas tentativas do Gerenciador de trabalho**</span><span class="sxs-lookup"><span data-stu-id="8648b-205">**Job manager retries**</span></span>

<span data-ttu-id="8648b-206">Se o Gerenciador de trabalhos Olá falhar, pode ser repetida pelo serviço de lote Olá dependendo das configurações de repetição de cliente hello.</span><span class="sxs-lookup"><span data-stu-id="8648b-206">If hello job manager fails, it may be retried by hello Batch service depending on hello client retry settings.</span></span> <span data-ttu-id="8648b-207">Em geral, isso é seguro, porque quando framework Olá adiciona o trabalho de toohello de tarefas, ele ignora as tarefas que já existem.</span><span class="sxs-lookup"><span data-stu-id="8648b-207">In general, this is safe, because when hello framework adds tasks toohello job, it ignores any tasks that already exist.</span></span> <span data-ttu-id="8648b-208">No entanto, se o cálculo de tarefas é cara, não poderá tooincur custo de saudação do recálculo tarefas que já foram adicionadas toohello trabalho; Por outro lado, se executar novamente a saudação é toogenerate não garantida Olá mesmas IDs de tarefa e o comportamento de 'Ignorar duplicatas' hello não será iniciada.</span><span class="sxs-lookup"><span data-stu-id="8648b-208">However, if calculating tasks is expensive, you may not wish tooincur hello cost of recalculating tasks that have already been added toohello job; conversely, if hello re-run is not guaranteed toogenerate hello same task IDs then hello 'ignore duplicates' behavior will not kick in.</span></span> <span data-ttu-id="8648b-209">Nesses casos, você deve projetar seu trabalho divisor toodetect Olá um trabalho que já foi feito e não repita, por exemplo, executando um CloudJob.ListTasks antes de iniciar tarefas tooyield.</span><span class="sxs-lookup"><span data-stu-id="8648b-209">In these cases you should design your job splitter toodetect hello work that has already been done and not repeat it, for example by performing a CloudJob.ListTasks before starting tooyield tasks.</span></span>

### <a name="exit-codes-and-exceptions-in-hello-job-manager-template"></a><span data-ttu-id="8648b-210">Códigos e exceções no modelo do Gerenciador de trabalhos de saudação de saída</span><span class="sxs-lookup"><span data-stu-id="8648b-210">Exit codes and exceptions in hello Job Manager template</span></span>
<span data-ttu-id="8648b-211">Códigos de saída e as exceções fornecem um resultado de saudação do toodetermine mecanismo de execução de um programa, e eles podem ajudar tooidentify quaisquer problemas com a execução de saudação do programa de saudação.</span><span class="sxs-lookup"><span data-stu-id="8648b-211">Exit codes and exceptions provide a mechanism toodetermine hello outcome of running a program, and they can help tooidentify any problems with hello execution of hello program.</span></span> <span data-ttu-id="8648b-212">modelo do Gerenciador de trabalhos Olá implementa os códigos de saída de hello e exceções descritas nesta seção.</span><span class="sxs-lookup"><span data-stu-id="8648b-212">hello Job Manager template implements hello exit codes and exceptions described in this section.</span></span>

<span data-ttu-id="8648b-213">Uma tarefa do Gerenciador de trabalho que é implementada com o modelo do Gerenciador de trabalhos Olá pode retornar três códigos de saída possíveis:</span><span class="sxs-lookup"><span data-stu-id="8648b-213">A job manager task that is implemented with hello Job Manager template can return three possible exit codes:</span></span>

| <span data-ttu-id="8648b-214">Código</span><span class="sxs-lookup"><span data-stu-id="8648b-214">Code</span></span> | <span data-ttu-id="8648b-215">Descrição</span><span class="sxs-lookup"><span data-stu-id="8648b-215">Description</span></span> |
| --- | --- |
| <span data-ttu-id="8648b-216">0</span><span class="sxs-lookup"><span data-stu-id="8648b-216">0</span></span> |<span data-ttu-id="8648b-217">Gerenciador de trabalhos Olá foi concluído com êxito.</span><span class="sxs-lookup"><span data-stu-id="8648b-217">hello job manager completed successfully.</span></span> <span data-ttu-id="8648b-218">O código do divisor de trabalho foi executado toocompletion e todas as tarefas foram adicionadas toohello trabalho.</span><span class="sxs-lookup"><span data-stu-id="8648b-218">Your job splitter code ran toocompletion, and all tasks were added toohello job.</span></span> |
| <span data-ttu-id="8648b-219">1</span><span class="sxs-lookup"><span data-stu-id="8648b-219">1</span></span> |<span data-ttu-id="8648b-220">tarefa do Gerenciador de trabalho Olá falhou com uma exceção em uma parte 'esperada' do programa de saudação.</span><span class="sxs-lookup"><span data-stu-id="8648b-220">hello job manager task failed with an exception in an 'expected' part of hello program.</span></span> <span data-ttu-id="8648b-221">exceção Olá foi traduzida tooa JobManagerException com informações de diagnóstico e, quando possível, sugestões para resolver Olá falha.</span><span class="sxs-lookup"><span data-stu-id="8648b-221">hello exception was translated tooa JobManagerException with diagnostic information and, where possible, suggestions for resolving hello failure.</span></span> |
| <span data-ttu-id="8648b-222">2</span><span class="sxs-lookup"><span data-stu-id="8648b-222">2</span></span> |<span data-ttu-id="8648b-223">tarefa do Gerenciador de trabalho Olá falhou com uma exceção 'inesperada'.</span><span class="sxs-lookup"><span data-stu-id="8648b-223">hello job manager task failed with an 'unexpected' exception.</span></span> <span data-ttu-id="8648b-224">exceção Hello era toostandard conectado de saída, mas o Gerenciador de trabalhos Olá tooadd não é possível quaisquer informações adicionais de diagnóstico ou correção.</span><span class="sxs-lookup"><span data-stu-id="8648b-224">hello exception was logged toostandard output, but hello job manager was unable tooadd any additional diagnostic or remediation information.</span></span> |

<span data-ttu-id="8648b-225">No caso de saudação de falha de tarefa do Gerenciador de trabalho, algumas tarefas podem ainda ter sido adicionadas toohello serviço antes de saudação erro.</span><span class="sxs-lookup"><span data-stu-id="8648b-225">In hello case of job manager task failure, some tasks may still have been added toohello service before hello error occurred.</span></span> <span data-ttu-id="8648b-226">Essas tarefas serão executadas normalmente.</span><span class="sxs-lookup"><span data-stu-id="8648b-226">These tasks will run as normal.</span></span> <span data-ttu-id="8648b-227">Consulte "Falha do divisor de trabalho" acima para conferir uma discussão desse caminho de código.</span><span class="sxs-lookup"><span data-stu-id="8648b-227">See "Job Splitter Failure" above for discussion of this code path.</span></span>

<span data-ttu-id="8648b-228">Todas as informações de saudação retornadas por exceções são gravadas em arquivos do stderr.txt e stdout.txt.</span><span class="sxs-lookup"><span data-stu-id="8648b-228">All hello information returned by exceptions is written into stdout.txt and stderr.txt files.</span></span> <span data-ttu-id="8648b-229">Para saber mais, confira [Manipulação de erro](batch-api-basics.md#error-handling).</span><span class="sxs-lookup"><span data-stu-id="8648b-229">For more information, see [Error Handling](batch-api-basics.md#error-handling).</span></span>

### <a name="client-considerations"></a><span data-ttu-id="8648b-230">Considerações do cliente</span><span class="sxs-lookup"><span data-stu-id="8648b-230">Client considerations</span></span>
<span data-ttu-id="8648b-231">Esta seção descreve alguns requisitos de implementação do cliente ao invocar um Gerenciador de trabalho com base nesse modelo.</span><span class="sxs-lookup"><span data-stu-id="8648b-231">This section describes some client implementation requirements when invoking a job manager based on this template.</span></span> <span data-ttu-id="8648b-232">Consulte [como toopass parâmetros e variáveis de ambiente Olá código do cliente](#pass-environment-settings) para obter detalhes sobre como passar parâmetros e configurações de ambiente.</span><span class="sxs-lookup"><span data-stu-id="8648b-232">See [How toopass parameters and environment variables from hello client code](#pass-environment-settings) for details on passing parameters and environment settings.</span></span>

<span data-ttu-id="8648b-233">**Credenciais obrigatórias**</span><span class="sxs-lookup"><span data-stu-id="8648b-233">**Mandatory credentials**</span></span>

<span data-ttu-id="8648b-234">Em ordem tooadd tarefas toohello do Azure Batch trabalho tarefa do Gerenciador de trabalho Olá requer a URL de conta de lote do Azure e a chave.</span><span class="sxs-lookup"><span data-stu-id="8648b-234">In order tooadd tasks toohello Azure Batch job, hello job manager task requires your Azure Batch account URL and key.</span></span> <span data-ttu-id="8648b-235">Você deve passá-la nas variáveis de ambiente chamadas YOUR_BATCH_URL e YOUR_BATCH_KEY.</span><span class="sxs-lookup"><span data-stu-id="8648b-235">You must pass these in environment variables named YOUR_BATCH_URL and YOUR_BATCH_KEY.</span></span> <span data-ttu-id="8648b-236">Você pode defini-los no hello Gerenciador de trabalho configurações de ambiente de tarefas.</span><span class="sxs-lookup"><span data-stu-id="8648b-236">You can set these in hello Job Manager task environment settings.</span></span> <span data-ttu-id="8648b-237">Por exemplo, em um cliente C#:</span><span class="sxs-lookup"><span data-stu-id="8648b-237">For example, in a C# client:</span></span>

```csharp
job.JobManagerTask.EnvironmentSettings = new [] {
    new EnvironmentSetting("YOUR_BATCH_URL", "https://account.region.batch.azure.com"),
    new EnvironmentSetting("YOUR_BATCH_KEY", "{your_base64_encoded_account_key}"),
};
```
<span data-ttu-id="8648b-238">**Credenciais de armazenamento**</span><span class="sxs-lookup"><span data-stu-id="8648b-238">**Storage credentials**</span></span>

<span data-ttu-id="8648b-239">Normalmente, Olá cliente não necessita de tooprovide Olá armazenamento vinculado conta credenciais toohello trabalho tarefa do Gerenciador de porque o (a) a maioria dos gerenciadores de trabalho não é necessário para a conta de armazenamento tooexplicitly acesso Olá vinculado e (b) hello conta de armazenamento vinculada geralmente é fornecida tooall tarefas como a configuração de ambiente comum de trabalho hello.</span><span class="sxs-lookup"><span data-stu-id="8648b-239">Typically, hello client does not need tooprovide hello linked storage account credentials toohello job manager task because (a) most job managers do not need tooexplicitly access hello linked storage account and (b) hello linked storage account is often provided tooall tasks as a common environment setting for hello job.</span></span> <span data-ttu-id="8648b-240">Se você não fornecer Olá vinculado a conta de armazenamento por meio de configurações comuns do ambiente Olá e o Gerenciador de trabalhos Olá requer acesso toolinked armazenamento, você deve fornecer as credenciais de armazenamento Olá vinculado da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="8648b-240">If you are not providing hello linked storage account via hello common environment settings, and hello job manager requires access toolinked storage, then you should supply hello linked storage credentials as follows:</span></span>

```csharp
job.JobManagerTask.EnvironmentSettings = new [] {
    /* other environment settings */
    new EnvironmentSetting("LINKED_STORAGE_ACCOUNT", "{storageAccountName}"),
    new EnvironmentSetting("LINKED_STORAGE_KEY", "{storageAccountKey}"),
};
```

<span data-ttu-id="8648b-241">**Configurações da tarefa do Gerenciador de trabalho**</span><span class="sxs-lookup"><span data-stu-id="8648b-241">**Job manager task settings**</span></span>

<span data-ttu-id="8648b-242">cliente Olá deve definir o Gerenciador de trabalhos Olá *killJobOnCompletion* sinalizador muito**false**.</span><span class="sxs-lookup"><span data-stu-id="8648b-242">hello client should set hello job manager *killJobOnCompletion* flag too**false**.</span></span>

<span data-ttu-id="8648b-243">Geralmente é seguro para Olá cliente tooset *runExclusive* muito**false**.</span><span class="sxs-lookup"><span data-stu-id="8648b-243">It is usually safe for hello client tooset *runExclusive* too**false**.</span></span>

<span data-ttu-id="8648b-244">cliente de saudação deve usar o hello *resourceFiles* ou *applicationPackageReferences* toohave Olá trabalho Gerenciador da coleção de executáveis (e suas DLLs necessárias) implantado toohello do nó de computação.</span><span class="sxs-lookup"><span data-stu-id="8648b-244">hello client should use hello *resourceFiles* or *applicationPackageReferences* collection toohave hello job manager executable (and its required DLLs) deployed toohello compute node.</span></span>

<span data-ttu-id="8648b-245">Por padrão, o Gerenciador de trabalhos Olá não será repetido se ele falhar.</span><span class="sxs-lookup"><span data-stu-id="8648b-245">By default, hello job manager will not be retried if it fails.</span></span> <span data-ttu-id="8648b-246">Dependendo de sua lógica de Gerenciador de trabalho, cliente Olá seja tooenable repetições via *restrições*/*maxTaskRetryCount*.</span><span class="sxs-lookup"><span data-stu-id="8648b-246">Depending on your job manager logic, hello client may want tooenable retries via *constraints*/*maxTaskRetryCount*.</span></span>

<span data-ttu-id="8648b-247">**Configurações do trabalho**</span><span class="sxs-lookup"><span data-stu-id="8648b-247">**Job settings**</span></span>

<span data-ttu-id="8648b-248">Se o divisor de trabalho Olá emite tarefas com dependências, o cliente de saudação deve definir tootrue de usesTaskDependencies do trabalho hello.</span><span class="sxs-lookup"><span data-stu-id="8648b-248">If hello job splitter emits tasks with dependencies, hello client must set hello job's usesTaskDependencies tootrue.</span></span>

<span data-ttu-id="8648b-249">No modelo de divisão de trabalho Olá, é incomum para clientes toowish tooadd tarefas toojobs além divisor de trabalho que Olá cria.</span><span class="sxs-lookup"><span data-stu-id="8648b-249">In hello job splitter model, it is unusual for clients toowish tooadd tasks toojobs over and above what hello job splitter creates.</span></span> <span data-ttu-id="8648b-250">cliente Hello, portanto, normalmente deve definir do trabalho Olá *onAllTasksComplete* muito**terminatejob**.</span><span class="sxs-lookup"><span data-stu-id="8648b-250">hello client should therefore normally set hello job's *onAllTasksComplete* too**terminatejob**.</span></span>

## <a name="task-processor-template"></a><span data-ttu-id="8648b-251">Modelo de Processador de tarefas</span><span class="sxs-lookup"><span data-stu-id="8648b-251">Task Processor template</span></span>
<span data-ttu-id="8648b-252">Um modelo de processador de tarefa ajuda tooimplement um processador de tarefa que pode executar Olá ações a seguir:</span><span class="sxs-lookup"><span data-stu-id="8648b-252">A Task Processor template helps you tooimplement a task processor that can perform hello following actions:</span></span>

* <span data-ttu-id="8648b-253">Configure informações de saudação exigidas por cada toorun de tarefa de lote.</span><span class="sxs-lookup"><span data-stu-id="8648b-253">Set up hello information required by each Batch task toorun.</span></span>
* <span data-ttu-id="8648b-254">Executar todas as ações exigidas por cada tarefa do Lote.</span><span class="sxs-lookup"><span data-stu-id="8648b-254">Run all actions required by each Batch task.</span></span>
* <span data-ttu-id="8648b-255">Salve as saídas de tarefa toopersistent armazenamento.</span><span class="sxs-lookup"><span data-stu-id="8648b-255">Save task outputs toopersistent storage.</span></span>

<span data-ttu-id="8648b-256">Embora um processador de tarefa não seja necessário toorun tarefas em lote, a vantagem de chave de saudação do uso de um processador de tarefa é que ele fornece um wrapper tooimplement todas as ações de execução de tarefas em um local.</span><span class="sxs-lookup"><span data-stu-id="8648b-256">Although a task processor is not required toorun tasks on Batch, hello key advantage of using a task processor is that it provides a wrapper tooimplement all task execution actions in one location.</span></span> <span data-ttu-id="8648b-257">Por exemplo, se você precisar toorun vários aplicativos no contexto de saudação de cada tarefa, ou se você precisar de armazenamento de toopersistent toocopy dados após a conclusão de cada tarefa.</span><span class="sxs-lookup"><span data-stu-id="8648b-257">For example, if you need toorun several applications in hello context of each task, or if you need toocopy data toopersistent storage after completing each task.</span></span>

<span data-ttu-id="8648b-258">ações de saudação executadas pelo processador de tarefa Olá podem ser como simples ou complexos e muitos ou poucos, conforme exigido por sua carga de trabalho.</span><span class="sxs-lookup"><span data-stu-id="8648b-258">hello actions performed by hello task processor can be as simple or complex, and as many or as few, as required by your workload.</span></span> <span data-ttu-id="8648b-259">Além disso, com a implementação de todas as ações de tarefas em um processador de tarefa, você pode prontamente atualizar ou adicionar ações com base nos requisitos de tooapplications ou carga de trabalho de alterações.</span><span class="sxs-lookup"><span data-stu-id="8648b-259">Additionally, by implementing all task actions into one task processor, you can readily update or add actions based on changes tooapplications or workload requirements.</span></span> <span data-ttu-id="8648b-260">No entanto, em alguns casos um processador de tarefa não pode ser Olá a solução ideal para sua implementação como ela pode adicionar complexidade desnecessária, por exemplo, ao executar trabalhos que podem ser iniciados rapidamente de uma linha de comando simple.</span><span class="sxs-lookup"><span data-stu-id="8648b-260">However, in some cases a task processor might not be hello optimal solution for your implementation as it can add unnecessary complexity, for example when running jobs that can be quickly started from a simple command line.</span></span>

### <a name="create-a-task-processor-using-hello-template"></a><span data-ttu-id="8648b-261">Criar um processador de tarefa usando o modelo de saudação</span><span class="sxs-lookup"><span data-stu-id="8648b-261">Create a Task Processor using hello template</span></span>
<span data-ttu-id="8648b-262">tooadd uma solução de toohello de processador da tarefa que você criou anteriormente, siga estas etapas:</span><span class="sxs-lookup"><span data-stu-id="8648b-262">tooadd a task processor toohello solution that you created earlier, follow these steps:</span></span>

1. <span data-ttu-id="8648b-263">Abra sua solução existente no Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="8648b-263">Open your existing solution in Visual Studio.</span></span>
2. <span data-ttu-id="8648b-264">No Gerenciador de soluções, solução de saudação com o botão direito, clique em **adicionar**e, em seguida, clique em **novo projeto**.</span><span class="sxs-lookup"><span data-stu-id="8648b-264">In Solution Explorer, right-click hello solution, click **Add**, and then click **New Project**.</span></span>
3. <span data-ttu-id="8648b-265">No **Visual C#**, clique em **Nuvem** e em **Processador de Tarefas do Lote do Azure**.</span><span class="sxs-lookup"><span data-stu-id="8648b-265">Under **Visual C#**, click **Cloud**, and then click **Azure Batch Task Processor**.</span></span>
4. <span data-ttu-id="8648b-266">Digite um nome que descreva o aplicativo e identifica este projeto como hello (por exemplo, o processador de tarefa "ProcessadorDeTarefasLitware").</span><span class="sxs-lookup"><span data-stu-id="8648b-266">Type a name that describes your application and identifies this project as hello task processor (e.g. "LitwareTaskProcessor").</span></span>
5. <span data-ttu-id="8648b-267">projeto de saudação toocreate, clique em **Okey**.</span><span class="sxs-lookup"><span data-stu-id="8648b-267">toocreate hello project, click **OK**.</span></span>
6. <span data-ttu-id="8648b-268">Finalmente, referenciado de compilação Olá projeto tooforce Visual Studio tooload todos os pacotes do NuGet e tooverify que Olá projeto é válido antes de começar a modificá-lo.</span><span class="sxs-lookup"><span data-stu-id="8648b-268">Finally, build hello project tooforce Visual Studio tooload all referenced NuGet packages and tooverify that hello project is valid before you start modifying it.</span></span>

### <a name="task-processor-template-files-and-their-purpose"></a><span data-ttu-id="8648b-269">Arquivos do modelo do Processador de tarefas e suas finalidades</span><span class="sxs-lookup"><span data-stu-id="8648b-269">Task Processor template files and their purpose</span></span>
<span data-ttu-id="8648b-270">Quando você cria um projeto usando o modelo de processador de tarefa hello, ele gera três grupos de arquivos de código:</span><span class="sxs-lookup"><span data-stu-id="8648b-270">When you create a project using hello task processor template, it generates three groups of code files:</span></span>

* <span data-ttu-id="8648b-271">arquivo de programa principal Hello (Program.cs).</span><span class="sxs-lookup"><span data-stu-id="8648b-271">hello main program file (Program.cs).</span></span> <span data-ttu-id="8648b-272">Ele contém o ponto de entrada de programa hello e manipulação de exceção de nível superior.</span><span class="sxs-lookup"><span data-stu-id="8648b-272">This contains hello program entry point and top-level exception handling.</span></span> <span data-ttu-id="8648b-273">Você normalmente não precisa toomodify isso.</span><span class="sxs-lookup"><span data-stu-id="8648b-273">You shouldn't normally need toomodify this.</span></span>
* <span data-ttu-id="8648b-274">diretório do Framework Hello.</span><span class="sxs-lookup"><span data-stu-id="8648b-274">hello Framework directory.</span></span> <span data-ttu-id="8648b-275">Isso contém arquivos de saudação responsáveis pelo trabalho 'padrão' hello pelo programa de Gerenciador de trabalho hello – desempacotar parâmetros, adicionando o trabalho de lote de toohello de tarefas, etc. Você normalmente não precisa toomodify esses arquivos.</span><span class="sxs-lookup"><span data-stu-id="8648b-275">This contains hello files responsible for hello 'boilerplate' work done by hello job manager program – unpacking parameters, adding tasks toohello Batch job, etc. You shouldn't normally need toomodify these files.</span></span>
* <span data-ttu-id="8648b-276">arquivo do processador de tarefa Hello (TaskProcessor.cs).</span><span class="sxs-lookup"><span data-stu-id="8648b-276">hello task processor file (TaskProcessor.cs).</span></span> <span data-ttu-id="8648b-277">Isso é onde você colocará sua lógica específica do aplicativo para executar uma tarefa (normalmente ao chamar executável existente tooan).</span><span class="sxs-lookup"><span data-stu-id="8648b-277">This is where you will put your application-specific logic for executing a task (typically by calling out tooan existing executable).</span></span> <span data-ttu-id="8648b-278">Código de pré e pós-processamento, como o download dos dados adicionais ou upload de arquivos de resultados, também é colocado nesse local.</span><span class="sxs-lookup"><span data-stu-id="8648b-278">Pre- and post-processing code, such as downloading additional data or uploading result files, also goes here.</span></span>

<span data-ttu-id="8648b-279">Obviamente você pode adicionar arquivos adicionais como toosupport necessário seu código de processador de tarefas, dependendo da complexidade de saudação do trabalho Olá divisão lógica.</span><span class="sxs-lookup"><span data-stu-id="8648b-279">Of course you can add additional files as required toosupport your task processor code, depending on hello complexity of hello job splitting logic.</span></span>

<span data-ttu-id="8648b-280">modelo de saudação também gera arquivos de projeto padrão do .NET como um arquivo. csproj App. config, Packages, etc.</span><span class="sxs-lookup"><span data-stu-id="8648b-280">hello template also generates standard .NET project files such as a .csproj file, app.config, packages.config, etc.</span></span>

<span data-ttu-id="8648b-281">restante Olá desta seção descreve Olá diferentes arquivos e sua estrutura de código e explica o que faz cada classe.</span><span class="sxs-lookup"><span data-stu-id="8648b-281">hello rest of this section describes hello different files and their code structure, and explains what each class does.</span></span>

![Visual Studio Gerenciador de soluções mostrando a solução de modelo de processador de tarefa Olá][solution_explorer02]

<span data-ttu-id="8648b-283">**Arquivos do Framework**</span><span class="sxs-lookup"><span data-stu-id="8648b-283">**Framework files**</span></span>

* <span data-ttu-id="8648b-284">`Configuration.cs`: Encapsula o carregamento de saudação de dados de configuração de trabalho, como detalhes da conta, as credenciais de conta de armazenamento vinculada, informações de trabalhos e tarefas e parâmetros do trabalho em lotes.</span><span class="sxs-lookup"><span data-stu-id="8648b-284">`Configuration.cs`: Encapsulates hello loading of job configuration data such as Batch account details, linked storage account credentials, job and task information, and job parameters.</span></span> <span data-ttu-id="8648b-285">Ele também fornece acesso definido tooBatch as variáveis de ambiente (consulte as configurações de ambiente para tarefas, na documentação do lote Olá) por meio da classe Configuration.EnvironmentVariable hello.</span><span class="sxs-lookup"><span data-stu-id="8648b-285">It also provides access tooBatch-defined environment variables (see Environment settings for tasks, in hello Batch documentation) via hello Configuration.EnvironmentVariable class.</span></span>
* <span data-ttu-id="8648b-286">`IConfiguration.cs`: Resumo Olá implementação de classe de configuração de hello, para que você possa de teste de unidade o divisor de trabalho usando um objeto de configuração falsas ou fictícias.</span><span class="sxs-lookup"><span data-stu-id="8648b-286">`IConfiguration.cs`: Abstracts hello implementation of hello Configuration class, so that you can unit test your job splitter using a fake or mock configuration object.</span></span>
* <span data-ttu-id="8648b-287">`TaskProcessorException.cs`Representa um erro que exige Olá tooterminate de Gerenciador de trabalho.</span><span class="sxs-lookup"><span data-stu-id="8648b-287">`TaskProcessorException.cs`: Represents an error that requires hello job manager tooterminate.</span></span> <span data-ttu-id="8648b-288">TaskProcessorException é usado toowrap 'esperado' erros onde as informações de diagnóstico específicas podem ser fornecidas como parte do encerramento.</span><span class="sxs-lookup"><span data-stu-id="8648b-288">TaskProcessorException is used toowrap 'expected' errors where specific diagnostic information can be provided as part of termination.</span></span>

<span data-ttu-id="8648b-289">**Processador de tarefas**</span><span class="sxs-lookup"><span data-stu-id="8648b-289">**Task Processor**</span></span>

* <span data-ttu-id="8648b-290">`TaskProcessor.cs`: Executa a tarefa de saudação.</span><span class="sxs-lookup"><span data-stu-id="8648b-290">`TaskProcessor.cs`: Runs hello task.</span></span> <span data-ttu-id="8648b-291">estrutura Olá invoca o método de TaskProcessor.Run de saudação.</span><span class="sxs-lookup"><span data-stu-id="8648b-291">hello framework invokes hello TaskProcessor.Run method.</span></span> <span data-ttu-id="8648b-292">Isso é a classe Olá onde você irá injetar a lógica de específicas do aplicativo hello da tarefa.</span><span class="sxs-lookup"><span data-stu-id="8648b-292">This is hello class where you will inject hello application-specific logic of your task.</span></span> <span data-ttu-id="8648b-293">Implemente o método de execução de saudação:</span><span class="sxs-lookup"><span data-stu-id="8648b-293">Implement hello Run method to:</span></span>
  * <span data-ttu-id="8648b-294">Analisar e validar qualquer parâmetro de tarefa</span><span class="sxs-lookup"><span data-stu-id="8648b-294">Parse and validate any task parameters</span></span>
  * <span data-ttu-id="8648b-295">Compor Olá linha de comando para qualquer programa externo, você deseja tooinvoke</span><span class="sxs-lookup"><span data-stu-id="8648b-295">Compose hello command line for any external program you want tooinvoke</span></span>
  * <span data-ttu-id="8648b-296">Registrar quaisquer informações de diagnóstico que você possa precisar para fins de depuração</span><span class="sxs-lookup"><span data-stu-id="8648b-296">Log any diagnostic information you may require for debugging purposes</span></span>
  * <span data-ttu-id="8648b-297">Iniciar um processo usando a linha de comando</span><span class="sxs-lookup"><span data-stu-id="8648b-297">Start a process using that command line</span></span>
  * <span data-ttu-id="8648b-298">Aguarde a saudação processo tooexit</span><span class="sxs-lookup"><span data-stu-id="8648b-298">Wait for hello process tooexit</span></span>
  * <span data-ttu-id="8648b-299">Capturar o código de saída de saudação do hello processo toodetermine se ela teve êxito ou falha</span><span class="sxs-lookup"><span data-stu-id="8648b-299">Capture hello exit code of hello process toodetermine if it succeeded or failed</span></span>
  * <span data-ttu-id="8648b-300">Salve os arquivos de saída que você deseja tookeep toopersistent armazenamento</span><span class="sxs-lookup"><span data-stu-id="8648b-300">Save any output files you want tookeep toopersistent storage</span></span>

<span data-ttu-id="8648b-301">**Arquivos de projeto de linha de comando .NET padrão**</span><span class="sxs-lookup"><span data-stu-id="8648b-301">**Standard .NET command line project files**</span></span>

* <span data-ttu-id="8648b-302">`App.config`: arquivo de configuração padrão de aplicativo .NET.</span><span class="sxs-lookup"><span data-stu-id="8648b-302">`App.config`: Standard .NET application configuration file.</span></span>
* <span data-ttu-id="8648b-303">`Packages.config`: arquivo de dependência padrão do pacote NuGet.</span><span class="sxs-lookup"><span data-stu-id="8648b-303">`Packages.config`: Standard NuGet package dependency file.</span></span>
* <span data-ttu-id="8648b-304">`Program.cs`: Contém o ponto de entrada de programa hello e manipulação de exceção de nível superior.</span><span class="sxs-lookup"><span data-stu-id="8648b-304">`Program.cs`: Contains hello program entry point and top-level exception handling.</span></span>

## <a name="implementing-hello-task-processor"></a><span data-ttu-id="8648b-305">Implementando o processador de tarefa Olá</span><span class="sxs-lookup"><span data-stu-id="8648b-305">Implementing hello task processor</span></span>
<span data-ttu-id="8648b-306">Quando você abre um projeto de modelo de processador de tarefa hello, o projeto Olá terá Olá TaskProcessor.cs arquivo aberta por padrão.</span><span class="sxs-lookup"><span data-stu-id="8648b-306">When you open hello Task Processor template project, hello project will have hello TaskProcessor.cs file open by default.</span></span> <span data-ttu-id="8648b-307">Você pode implementar lógica Olá executar tarefas de saudação na carga de trabalho, usando o método Run () de hello mostrado abaixo:</span><span class="sxs-lookup"><span data-stu-id="8648b-307">You can implement hello run logic for hello tasks in your workload by using hello Run() method shown below:</span></span>

```csharp
/// <summary>
/// Runs hello task processing logic. This is where you inject
/// your application-specific logic for decomposing hello job into tasks.
///
/// hello task processor framework invokes hello Run method for you; you need
/// only tooimplement it, not toocall it yourself. Typically, your
/// implementation will execute an external program (from resource files or
/// an application package), check hello exit code of that program and
/// save output files toopersistent storage.
/// </summary>
public async Task<int> Run()

{
    try
    {
        //Your code for hello task processor goes here.
        var command = $"compare {_parameters["Frame1"]} {_parameters["Frame2"]} compare.gif";
        using (var process = Process.Start($"cmd /c {command}"))
        {
            process.WaitForExit();
            var taskOutputStorage = new TaskOutputStorage(
            _configuration.StorageAccount,
            _configuration.JobId,
            _configuration.TaskId
            );
            await taskOutputStorage.SaveAsync(
            TaskOutputKind.TaskOutput,
            @"..\stdout.txt",
            @"stdout.txt"
            );
            return process.ExitCode;
        }
    }
    catch (Exception ex)
    {
        throw new TaskProcessorException(
        $"{ex.GetType().Name} exception in run task processor: {ex.Message}",
        ex
        );
    }
}
```
> [!NOTE]
> <span data-ttu-id="8648b-308">Hello anotada seção Olá método Run () é a seção apenas saudação do código de modelo de processador de tarefa Olá que é destinado para você toomodify adicionando lógica Olá executar tarefas Olá na carga de trabalho.</span><span class="sxs-lookup"><span data-stu-id="8648b-308">hello annotated section in hello Run() method is hello only section of hello Task Processor template code that is intended for you toomodify by adding hello run logic for hello tasks in your workload.</span></span> <span data-ttu-id="8648b-309">Se você quiser toomodify uma seção diferente do modelo hello,. primeiro estar familiarizado com como lote funciona por revisar a documentação de lote hello e experimentar alguns dos exemplos de código de lote de saudação.</span><span class="sxs-lookup"><span data-stu-id="8648b-309">If you want toomodify a different section of hello template, please first familiarize yourself with how Batch works by reviewing hello Batch documentation and trying out a few of hello Batch code samples.</span></span>
> 
> 

<span data-ttu-id="8648b-310">Olá método Run () é responsável por iniciando a linha de comando hello, iniciando um ou mais processos, aguardando todos os toocomplete de processo, salvar os resultados da saudação e finalmente retornar com um código de saída.</span><span class="sxs-lookup"><span data-stu-id="8648b-310">hello Run() method is responsible for launching hello command line, starting one or more processes, waiting for all process toocomplete, saving hello results, and finally returning with an exit code.</span></span> <span data-ttu-id="8648b-311">Olá método Run () é onde você pode implementar Olá lógica para suas tarefas de processamento.</span><span class="sxs-lookup"><span data-stu-id="8648b-311">hello Run() method is where you implement hello processing logic for your tasks.</span></span> <span data-ttu-id="8648b-312">a estrutura de processador tarefas Olá invoca o método de Run () do hello para você. não é necessário toocall-lo por conta própria.</span><span class="sxs-lookup"><span data-stu-id="8648b-312">hello task processor framework invokes hello Run() method for you; you do not need toocall it yourself.</span></span>

<span data-ttu-id="8648b-313">Sua implementação de Run() tem acesso a:</span><span class="sxs-lookup"><span data-stu-id="8648b-313">Your Run() implementation has access to:</span></span>

* <span data-ttu-id="8648b-314">Olá parâmetros da tarefa, por meio de saudação `_parameters` campo.</span><span class="sxs-lookup"><span data-stu-id="8648b-314">hello task parameters, via hello `_parameters` field.</span></span>
* <span data-ttu-id="8648b-315">Olá ids de trabalho e tarefa, por meio de saudação `_jobId` e `_taskId` campos.</span><span class="sxs-lookup"><span data-stu-id="8648b-315">hello job and task ids, via hello `_jobId` and `_taskId` fields.</span></span>
* <span data-ttu-id="8648b-316">configuração da tarefa Hello, por meio de saudação `_configuration` campo.</span><span class="sxs-lookup"><span data-stu-id="8648b-316">hello task configuration, via hello `_configuration` field.</span></span>

<span data-ttu-id="8648b-317">**Falha da tarefa**</span><span class="sxs-lookup"><span data-stu-id="8648b-317">**Task failure**</span></span>

<span data-ttu-id="8648b-318">Em caso de falha, será possível sair do método Run () de hello lançando uma exceção, mas isso deixa o manipulador de exceção de nível superior de saudação no controle do código de saída de tarefa hello.</span><span class="sxs-lookup"><span data-stu-id="8648b-318">In case of failure, you can exit hello Run() method by throwing an exception, but this leaves hello top level exception handler in control of hello task exit code.</span></span> <span data-ttu-id="8648b-319">Se precisar de código de saída de hello toocontrol para que você possa distinguir diferentes tipos de falha, por exemplo para fins de diagnóstico ou porque alguns modos de falha devem encerrar trabalho hello e outros não devem, você deve sair do método do hello Run (), retornando um código de saída diferente de zero.</span><span class="sxs-lookup"><span data-stu-id="8648b-319">If you need toocontrol hello exit code so that you can distinguish different types of failure, for example for diagnostic purposes or because some failure modes should terminate hello job and others should not, then you should exit hello Run() method by returning a non-zero exit code.</span></span> <span data-ttu-id="8648b-320">Isso torna-se o código de saída de tarefa hello.</span><span class="sxs-lookup"><span data-stu-id="8648b-320">This becomes hello task exit code.</span></span>

### <a name="exit-codes-and-exceptions-in-hello-task-processor-template"></a><span data-ttu-id="8648b-321">Sair de códigos e exceções no modelo de processador de tarefa Olá</span><span class="sxs-lookup"><span data-stu-id="8648b-321">Exit codes and exceptions in hello Task Processor template</span></span>
<span data-ttu-id="8648b-322">Códigos de saída e exceções fornecem um resultado de saudação do toodetermine mecanismo de execução de um programa, e eles ajudam a identificar problemas com a execução de saudação do programa de saudação.</span><span class="sxs-lookup"><span data-stu-id="8648b-322">Exit codes and exceptions provide a mechanism toodetermine hello outcome of running a program, and they can help identify any problems with hello execution of hello program.</span></span> <span data-ttu-id="8648b-323">modelo de processador de tarefa Olá implementa os códigos de saída de hello e exceções descritas nesta seção.</span><span class="sxs-lookup"><span data-stu-id="8648b-323">hello Task Processor template implements hello exit codes and exceptions described in this section.</span></span>

<span data-ttu-id="8648b-324">Uma tarefa de processador que é implementada com o modelo de processador de tarefa Olá pode retornar três códigos de saída possíveis:</span><span class="sxs-lookup"><span data-stu-id="8648b-324">A task processor task that is implemented with hello Task Processor template can return three possible exit codes:</span></span>

| <span data-ttu-id="8648b-325">Código</span><span class="sxs-lookup"><span data-stu-id="8648b-325">Code</span></span> | <span data-ttu-id="8648b-326">Descrição</span><span class="sxs-lookup"><span data-stu-id="8648b-326">Description</span></span> |
| --- | --- |
| <span data-ttu-id="8648b-327">[Process.ExitCode][process_exitcode]</span><span class="sxs-lookup"><span data-stu-id="8648b-327">[Process.ExitCode][process_exitcode]</span></span> |<span data-ttu-id="8648b-328">processador de tarefa de saudação ficou toocompletion.</span><span class="sxs-lookup"><span data-stu-id="8648b-328">hello task processor ran toocompletion.</span></span> <span data-ttu-id="8648b-329">Observe que isso não significa que você chamou o programa hello foi bem-sucedida – apenas esse processador de tarefa Olá invocou com êxito e executada de qualquer pós-processamento sem exceções.</span><span class="sxs-lookup"><span data-stu-id="8648b-329">Note that this does not imply that hello program you invoked was successful – only that hello task processor invoked it successfully and performed any post-processing without exceptions.</span></span> <span data-ttu-id="8648b-330">significado de saudação do código de saída de hello depende do programa de saudação invocado – normalmente código de saída 0 significa êxito do programa hello e significa que qualquer outro código de saída Olá programa falhou.</span><span class="sxs-lookup"><span data-stu-id="8648b-330">hello meaning of hello exit code depends on hello invoked program – typically exit code 0 means hello program succeeded and any other exit code means hello program failed.</span></span> |
| <span data-ttu-id="8648b-331">1</span><span class="sxs-lookup"><span data-stu-id="8648b-331">1</span></span> |<span data-ttu-id="8648b-332">processador de tarefa Olá falhou com uma exceção em uma parte 'esperada' do programa de saudação.</span><span class="sxs-lookup"><span data-stu-id="8648b-332">hello task processor failed with an exception in an 'expected' part of hello program.</span></span> <span data-ttu-id="8648b-333">exceção Hello foi traduzida tooa `TaskProcessorException` com informações de diagnóstico e, quando possível, sugestões para resolver Olá falha.</span><span class="sxs-lookup"><span data-stu-id="8648b-333">hello exception was translated tooa `TaskProcessorException` with diagnostic information and, where possible, suggestions for resolving hello failure.</span></span> |
| <span data-ttu-id="8648b-334">2</span><span class="sxs-lookup"><span data-stu-id="8648b-334">2</span></span> |<span data-ttu-id="8648b-335">processador de tarefa Olá falhou com uma exceção 'inesperada'.</span><span class="sxs-lookup"><span data-stu-id="8648b-335">hello task processor failed with an 'unexpected' exception.</span></span> <span data-ttu-id="8648b-336">exceção Hello era toostandard conectado de saída, mas processador de tarefa Olá tooadd não é possível quaisquer informações adicionais de diagnóstico ou correção.</span><span class="sxs-lookup"><span data-stu-id="8648b-336">hello exception was logged toostandard output, but hello task processor was unable tooadd any additional diagnostic or remediation information.</span></span> |

> [!NOTE]
> <span data-ttu-id="8648b-337">Se o programa hello que invocar usa modos de falha específico de tooindicate de códigos de 1 e 2 de saída, usando códigos de saída 1 e 2 para erros de processador da tarefa é ambíguo.</span><span class="sxs-lookup"><span data-stu-id="8648b-337">If hello program you invoke uses exit codes 1 and 2 tooindicate specific failure modes, then using exit codes 1 and 2 for task processor errors is ambiguous.</span></span> <span data-ttu-id="8648b-338">Você pode alterar esses códigos de saída de toodistinctive tarefa processador erro códigos editando os casos de exceção Olá no arquivo Program.cs de saudação.</span><span class="sxs-lookup"><span data-stu-id="8648b-338">You can change these task processor error codes toodistinctive exit codes by editing hello exception cases in hello Program.cs file.</span></span>
> 
> 

<span data-ttu-id="8648b-339">Todas as informações de saudação retornadas por exceções são gravadas em arquivos do stderr.txt e stdout.txt.</span><span class="sxs-lookup"><span data-stu-id="8648b-339">All hello information returned by exceptions is written into stdout.txt and stderr.txt files.</span></span> <span data-ttu-id="8648b-340">Para obter mais informações, consulte o tratamento de erros, Olá documentação do lote.</span><span class="sxs-lookup"><span data-stu-id="8648b-340">For more information, see Error Handling, in hello Batch documentation.</span></span>

### <a name="client-considerations"></a><span data-ttu-id="8648b-341">Considerações do cliente</span><span class="sxs-lookup"><span data-stu-id="8648b-341">Client considerations</span></span>
<span data-ttu-id="8648b-342">**Credenciais de armazenamento**</span><span class="sxs-lookup"><span data-stu-id="8648b-342">**Storage credentials**</span></span>

<span data-ttu-id="8648b-343">Se o processador de tarefa utiliza saídas toopersist de armazenamento de BLOBs do Azure, biblioteca auxiliar da saudação arquivo convenções, por exemplo, usando, em seguida, ele precisa acessar muito*ou* Olá credenciais de conta de armazenamento de nuvem *ou* uma URL de contêiner de blob que inclui uma assinatura de acesso compartilhado (SAS).</span><span class="sxs-lookup"><span data-stu-id="8648b-343">If your task processor uses Azure blob storage toopersist outputs, for example using hello file conventions helper library, then it needs access too*either* hello cloud storage account credentials *or* a blob container URL that includes a shared access signature (SAS).</span></span> <span data-ttu-id="8648b-344">modelo de saudação inclui suporte para fornecer as credenciais por meio de variáveis de ambiente comuns.</span><span class="sxs-lookup"><span data-stu-id="8648b-344">hello template includes support for providing credentials via common environment variables.</span></span> <span data-ttu-id="8648b-345">O cliente pode passar as credenciais de armazenamento de saudação da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="8648b-345">Your client can pass hello storage credentials as follows:</span></span>

```csharp
job.CommonEnvironmentSettings = new [] {
    new EnvironmentSetting("LINKED_STORAGE_ACCOUNT", "{storageAccountName}"),
    new EnvironmentSetting("LINKED_STORAGE_KEY", "{storageAccountKey}"),
};
```

<span data-ttu-id="8648b-346">conta de armazenamento Hello está disponível em Olá TaskProcessor classe via Olá `_configuration.StorageAccount` propriedade.</span><span class="sxs-lookup"><span data-stu-id="8648b-346">hello storage account is then available in hello TaskProcessor class via hello `_configuration.StorageAccount` property.</span></span>

<span data-ttu-id="8648b-347">Se você preferir toouse uma URL de contêiner com SAS, você também pode passar isso por meio de uma configuração de ambiente comum de trabalho, mas o modelo de processador Olá tarefas atualmente não incluem suporte interno para este.</span><span class="sxs-lookup"><span data-stu-id="8648b-347">If you prefer toouse a container URL with SAS, you can also pass this via an job common environment setting, but hello task processor template does not currently include built-in support for this.</span></span>

<span data-ttu-id="8648b-348">**Configuração de armazenamento**</span><span class="sxs-lookup"><span data-stu-id="8648b-348">**Storage setup**</span></span>

<span data-ttu-id="8648b-349">É recomendável que tarefa do Gerenciador de trabalho ou cliente Olá Crie qualquer contêiner exigido pelas tarefas antes de adicionar o trabalho de toohello tarefas hello.</span><span class="sxs-lookup"><span data-stu-id="8648b-349">It is recommended that hello client or job manager task create any containers required by tasks before adding hello tasks toohello job.</span></span> <span data-ttu-id="8648b-350">Isso é obrigatório que se você usar uma URL de contêiner com SAS, assim uma URL não inclui permissão toocreate Olá contêiner.</span><span class="sxs-lookup"><span data-stu-id="8648b-350">This is mandatory if you use a container URL with SAS, as such a URL does not include permission toocreate hello container.</span></span> <span data-ttu-id="8648b-351">É recomendável mesmo se você passar credenciais de conta de armazenamento, como ele salva todas as tarefas com toocall CloudBlobContainer.CreateIfNotExistsAsync no contêiner de saudação.</span><span class="sxs-lookup"><span data-stu-id="8648b-351">It is recommended even if you pass storage account credentials, as it saves every task having toocall CloudBlobContainer.CreateIfNotExistsAsync on hello container.</span></span>

## <a name="pass-parameters-and-environment-variables"></a><span data-ttu-id="8648b-352">Passar parâmetros e variáveis de ambiente</span><span class="sxs-lookup"><span data-stu-id="8648b-352">Pass parameters and environment variables</span></span>
### <a name="pass-environment-settings"></a><span data-ttu-id="8648b-353">Passar configurações de ambiente</span><span class="sxs-lookup"><span data-stu-id="8648b-353">Pass environment settings</span></span>
<span data-ttu-id="8648b-354">Um cliente pode passar a tarefa do Gerenciador de trabalho do informações toohello na forma de saudação de configurações de ambiente.</span><span class="sxs-lookup"><span data-stu-id="8648b-354">A client can pass information toohello job manager task in hello form of environment settings.</span></span> <span data-ttu-id="8648b-355">Essas informações podem, em seguida, usadas pela tarefa do Gerenciador de trabalho hello quando o trabalho de computação gerando Olá processador tarefas que serão executado como parte da saudação.</span><span class="sxs-lookup"><span data-stu-id="8648b-355">This information can then be used by hello job manager task when generating hello task processor tasks that will run as part of hello compute job.</span></span> <span data-ttu-id="8648b-356">Exemplos de informações de saudação que você pode passar como configurações de ambiente são:</span><span class="sxs-lookup"><span data-stu-id="8648b-356">Examples of hello information that you can pass as environment settings are:</span></span>

* <span data-ttu-id="8648b-357">Nome da conta de armazenamento e chaves da conta</span><span class="sxs-lookup"><span data-stu-id="8648b-357">Storage account name and account keys</span></span>
* <span data-ttu-id="8648b-358">URL da conta do Lote</span><span class="sxs-lookup"><span data-stu-id="8648b-358">Batch account URL</span></span>
* <span data-ttu-id="8648b-359">Chave da conta do Lote</span><span class="sxs-lookup"><span data-stu-id="8648b-359">Batch account key</span></span>

<span data-ttu-id="8648b-360">Olá serviço de lote tem uma tarefa de Gerenciador mecanismo simples toopass ambiente configurações tooa trabalho usando Olá `EnvironmentSettings` propriedade [Microsoft.Azure.Batch.JobManagerTask][net_jobmanagertask].</span><span class="sxs-lookup"><span data-stu-id="8648b-360">hello Batch service has a simple mechanism toopass environment settings tooa job manager task by using hello `EnvironmentSettings` property in [Microsoft.Azure.Batch.JobManagerTask][net_jobmanagertask].</span></span>

<span data-ttu-id="8648b-361">Por exemplo, tooget Olá `BatchClient` instância para uma conta de lote, você pode passar como variáveis de ambiente do cliente Olá código Olá URL e credenciais de chave para a conta do lote Olá compartilhadas.</span><span class="sxs-lookup"><span data-stu-id="8648b-361">For example, tooget hello `BatchClient` instance for a Batch account, you can pass as environment variables from hello client code hello URL and shared key credentials for hello Batch account.</span></span> <span data-ttu-id="8648b-362">Da mesma forma, conta de armazenamento do hello tooaccess é vinculada toohello conta de lote, você pode passar o nome de conta de armazenamento hello e chave de conta de armazenamento hello como variáveis de ambiente.</span><span class="sxs-lookup"><span data-stu-id="8648b-362">Likewise, tooaccess hello storage account that is linked toohello Batch account, you can pass hello storage account name and hello storage account key as environment variables.</span></span>

### <a name="pass-parameters-toohello-job-manager-template"></a><span data-ttu-id="8648b-363">Passar o modelo do Gerenciador de trabalho de toohello de parâmetros</span><span class="sxs-lookup"><span data-stu-id="8648b-363">Pass parameters toohello Job Manager template</span></span>
<span data-ttu-id="8648b-364">Em muitos casos, é útil toopass por trabalho parâmetros toohello trabalho tarefa do Gerenciador, o trabalho de saudação toocontrol dividindo o processo ou tarefas de saudação tooconfigure para Olá trabalho.</span><span class="sxs-lookup"><span data-stu-id="8648b-364">In many cases, it's useful toopass per-job parameters toohello job manager task, either toocontrol hello job splitting process or tooconfigure hello tasks for hello job.</span></span> <span data-ttu-id="8648b-365">Você pode fazer isso, carregando um arquivo JSON chamado parameters.json como um arquivo de recurso para a tarefa do Gerenciador de trabalho hello.</span><span class="sxs-lookup"><span data-stu-id="8648b-365">You can do this by uploading a JSON file named parameters.json as a resource file for hello job manager task.</span></span> <span data-ttu-id="8648b-366">Olá parâmetros, em seguida, podem se tornar disponíveis no hello `JobSplitter._parameters` campo no modelo do Gerenciador de trabalhos de saudação.</span><span class="sxs-lookup"><span data-stu-id="8648b-366">hello parameters can then become available in hello `JobSplitter._parameters` field in hello Job Manager template.</span></span>

> [!NOTE]
> <span data-ttu-id="8648b-367">manipulador de parâmetro internas Olá oferece suporte a apenas os dicionários de cadeia de caracteres de cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="8648b-367">hello built-in parameter handler supports only string-to-string dictionaries.</span></span> <span data-ttu-id="8648b-368">Se você quiser toopass valores complexos de JSON como valores de parâmetro, será necessário toopass como cadeias de caracteres e analisá-los no separador de trabalho hello ou modificar a estrutura de saudação `Configuration.GetJobParameters` método.</span><span class="sxs-lookup"><span data-stu-id="8648b-368">If you want toopass complex JSON values as parameter values, you will need toopass these as strings and parse them in hello job splitter, or modify hello framework's `Configuration.GetJobParameters` method.</span></span>
> 
> 

### <a name="pass-parameters-toohello-task-processor-template"></a><span data-ttu-id="8648b-369">Passar o modelo de processador de tarefa toohello parâmetros</span><span class="sxs-lookup"><span data-stu-id="8648b-369">Pass parameters toohello Task Processor template</span></span>
<span data-ttu-id="8648b-370">Você também pode passar parâmetros tooindividual tarefas implementada usando o modelo de processador de tarefa hello.</span><span class="sxs-lookup"><span data-stu-id="8648b-370">You can also pass parameters tooindividual tasks implemented using hello Task Processor template.</span></span> <span data-ttu-id="8648b-371">Assim como com o modelo do Gerenciador de trabalho hello, Olá tarefa processador modelo procura um arquivo de recurso denominado</span><span class="sxs-lookup"><span data-stu-id="8648b-371">Just as with hello job manager template, hello task processor template looks for a resource file named</span></span>

<span data-ttu-id="8648b-372">Parameters.JSON e se encontrado, ele carrega-os como dicionário de parâmetros de saudação.</span><span class="sxs-lookup"><span data-stu-id="8648b-372">parameters.json, and if found it loads it as hello parameters dictionary.</span></span> <span data-ttu-id="8648b-373">Há duas opções para como toopass parâmetros toohello tarefas do processador de tarefas:</span><span class="sxs-lookup"><span data-stu-id="8648b-373">There are a couple of options for how toopass parameters toohello task processor tasks:</span></span>

* <span data-ttu-id="8648b-374">Reutilize os parâmetros do trabalho Olá JSON.</span><span class="sxs-lookup"><span data-stu-id="8648b-374">Reuse hello job parameters JSON.</span></span> <span data-ttu-id="8648b-375">Isso funciona bem se apenas os parâmetros Olá são aqueles de todo o trabalho (por exemplo, uma renderização de altura e largura).</span><span class="sxs-lookup"><span data-stu-id="8648b-375">This works well if hello only parameters are job-wide ones (for example, a render height and width).</span></span> <span data-ttu-id="8648b-376">toodo isso, ao criar um CloudTask no separador de trabalho hello, adicionar um objeto de arquivo de recurso do referência toohello parameters.json de ResourceFiles da tarefa do Gerenciador trabalho hello (`JobSplitter._jobManagerTask.ResourceFiles`) coleta de ResourceFiles do toohello CloudTask.</span><span class="sxs-lookup"><span data-stu-id="8648b-376">toodo this, when creating a CloudTask in hello job splitter, add a reference toohello parameters.json resource file object from hello job manager task's ResourceFiles (`JobSplitter._jobManagerTask.ResourceFiles`) toohello CloudTask's ResourceFiles collection.</span></span>
* <span data-ttu-id="8648b-377">Gerar e carregar um documento de parameters.json específicos da tarefa como parte da execução do divisor de trabalho e fazer referência a esse blob na coleção de arquivos de recursos da tarefa de saudação.</span><span class="sxs-lookup"><span data-stu-id="8648b-377">Generate and upload a task-specific parameters.json document as part of job splitter execution, and reference that blob in hello task's resource files collection.</span></span> <span data-ttu-id="8648b-378">Isso é necessário se tarefas diferentes tiverem parâmetros diferentes.</span><span class="sxs-lookup"><span data-stu-id="8648b-378">This is necessary if different tasks have different parameters.</span></span> <span data-ttu-id="8648b-379">Um exemplo seria um cenário de renderização 3D onde o índice do quadro de saudação é passado toohello tarefa como um parâmetro.</span><span class="sxs-lookup"><span data-stu-id="8648b-379">An example might be a 3D rendering scenario where hello frame index is passed toohello task as a parameter.</span></span>

> [!NOTE]
> <span data-ttu-id="8648b-380">manipulador de parâmetro internas Olá oferece suporte a apenas os dicionários de cadeia de caracteres de cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="8648b-380">hello built-in parameter handler supports only string-to-string dictionaries.</span></span> <span data-ttu-id="8648b-381">Se você quiser toopass valores complexos de JSON como valores de parâmetro, será necessário toopass como cadeias de caracteres e analisá-los no processador de tarefa hello ou modificar a estrutura de saudação `Configuration.GetTaskParameters` método.</span><span class="sxs-lookup"><span data-stu-id="8648b-381">If you want toopass complex JSON values as parameter values, you will need toopass these as strings and parse them in hello task processor, or modify hello framework's `Configuration.GetTaskParameters` method.</span></span>
> 
> 

## <a name="next-steps"></a><span data-ttu-id="8648b-382">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="8648b-382">Next steps</span></span>
### <a name="persist-job-and-task-output-tooazure-storage"></a><span data-ttu-id="8648b-383">Manter o trabalho e saída tooAzure armazenamento de tarefas</span><span class="sxs-lookup"><span data-stu-id="8648b-383">Persist job and task output tooAzure Storage</span></span>
<span data-ttu-id="8648b-384">Outra ferramenta útil no desenvolvimento de soluções do Lote são as [Convenções de Arquivo do Lote do Azure][nuget_package].</span><span class="sxs-lookup"><span data-stu-id="8648b-384">Another helpful tool in Batch solution development is [Azure Batch File Conventions][nuget_package].</span></span> <span data-ttu-id="8648b-385">Use essa biblioteca de classes do .NET (atualmente na visualização) em seu repositório de tooeasily de aplicativos .NET em lotes e recuperar tooand de saídas de tarefa do armazenamento do Azure.</span><span class="sxs-lookup"><span data-stu-id="8648b-385">Use this .NET class library (currently in preview) in your Batch .NET applications tooeasily store and retrieve task outputs tooand from Azure Storage.</span></span> <span data-ttu-id="8648b-386">[Manter a saída de trabalho e tarefa de lote do Azure](batch-task-output.md) contém uma discussão completa sobre a biblioteca de saudação e seu uso.</span><span class="sxs-lookup"><span data-stu-id="8648b-386">[Persist Azure Batch job and task output](batch-task-output.md) contains a full discussion of hello library and its usage.</span></span>

### <a name="batch-forum"></a><span data-ttu-id="8648b-387">Fórum do Lote</span><span class="sxs-lookup"><span data-stu-id="8648b-387">Batch Forum</span></span>
<span data-ttu-id="8648b-388">Olá [Fórum do lote do Azure] [ forum] no MSDN é um ótimo colocar toodiscuss em lotes e fazer perguntas sobre o serviço de saudação.</span><span class="sxs-lookup"><span data-stu-id="8648b-388">hello [Azure Batch Forum][forum] on MSDN is a great place toodiscuss Batch and ask questions about hello service.</span></span> <span data-ttu-id="8648b-389">Acesse diretamente as postagens “fixas” úteis e poste suas dúvidas conforme elas surgirem enquanto você cria suas soluções do Lote.</span><span class="sxs-lookup"><span data-stu-id="8648b-389">Head on over for helpful "sticky" posts, and post your questions as they arise while you build your Batch solutions.</span></span>

[forum]: https://social.msdn.microsoft.com/forums/azure/en-US/home?forum=azurebatch
[net_jobmanagertask]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.jobmanagertask.aspx
[github_samples]: https://github.com/Azure/azure-batch-samples
[nuget_package]: https://www.nuget.org/packages/Microsoft.Azure.Batch.Conventions.Files
[process_exitcode]: https://msdn.microsoft.com/library/system.diagnostics.process.exitcode.aspx
[vs_gallery]: https://visualstudiogallery.msdn.microsoft.com/
[vs_gallery_templates]: https://go.microsoft.com/fwlink/?linkid=820714
[vs_find_use_ext]: https://msdn.microsoft.com/library/dd293638.aspx

[diagram01]: ./media/batch-visual-studio-templates/diagram01.png
[solution_explorer01]: ./media/batch-visual-studio-templates/solution_explorer01.png
[solution_explorer02]: ./media/batch-visual-studio-templates/solution_explorer02.png
