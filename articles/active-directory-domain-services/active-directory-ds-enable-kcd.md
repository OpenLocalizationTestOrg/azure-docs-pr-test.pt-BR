---
title: "Azure Active Directory Domain Services: Habilitar a delegação restrita de kerberos | Microsoft Docs"
description: "Habilitar a delegação restrita de kerberos nos domínios gerenciados do Azure Active Directory Domain Services"
services: active-directory-ds
documentationcenter: 
author: mahesh-unnikrishnan
manager: stevenpo
editor: curtand
ms.assetid: 938a5fbc-2dd1-4759-bcce-628a6e19ab9d
ms.service: active-directory-ds
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 03/06/2017
ms.author: maheshu
ms.openlocfilehash: d32547c8018dd1f99c992e95a01d2711d460a261
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="configure-kerberos-constrained-delegation-kcd-on-a-managed-domain"></a><span data-ttu-id="498d7-103">Configurar a KCD (delegação Restrita de Kerberos) em um domínio gerenciado</span><span class="sxs-lookup"><span data-stu-id="498d7-103">Configure kerberos constrained delegation (KCD) on a managed domain</span></span>
<span data-ttu-id="498d7-104">Muitos aplicativos precisam de recursos de tooaccess no contexto de saudação do usuário de saudação.</span><span class="sxs-lookup"><span data-stu-id="498d7-104">Many applications need tooaccess resources in hello context of hello user.</span></span> <span data-ttu-id="498d7-105">O Active Directory oferece suporte a um mecanismo chamado delegação de Kerberos, que permite que esse caso de uso.</span><span class="sxs-lookup"><span data-stu-id="498d7-105">Active Directory supports a mechanism called Kerberos delegation, which enables this use-case.</span></span> <span data-ttu-id="498d7-106">Além disso, você pode restringir a delegação para que somente os recursos específicos podem ser acessados no contexto de saudação do usuário de saudação.</span><span class="sxs-lookup"><span data-stu-id="498d7-106">Further, you can restrict delegation so that only specific resources can be accessed in hello context of hello user.</span></span> <span data-ttu-id="498d7-107">Os domínios gerenciados do Azure AD Domain Services são diferentes dos domínios tradicionais do Active Directory, pois estão bloqueados com mais segurança.</span><span class="sxs-lookup"><span data-stu-id="498d7-107">Azure AD Domain Services managed domains are different from traditional Active Directory domains since they are more securely locked down.</span></span>

<span data-ttu-id="498d7-108">Este artigo mostra como o kerberos tooconfigure restrita delegação em um domínio gerenciado do serviços de domínio do AD do Azure.</span><span class="sxs-lookup"><span data-stu-id="498d7-108">This article shows you how tooconfigure kerberos constrained delegation on an Azure AD Domain Services managed domain.</span></span>

## <a name="kerberos-constrained-delegation-kcd"></a><span data-ttu-id="498d7-109">KCD (delegação restrita de Kerberos)</span><span class="sxs-lookup"><span data-stu-id="498d7-109">Kerberos constrained delegation (KCD)</span></span>
<span data-ttu-id="498d7-110">Delegação Kerberos permite que uma conta tooimpersonate outro recursos de tooaccess principal (como um usuário) de segurança.</span><span class="sxs-lookup"><span data-stu-id="498d7-110">Kerberos delegation enables an account tooimpersonate another security principal (such as a user) tooaccess resources.</span></span> <span data-ttu-id="498d7-111">Considere um aplicativo web que acessa uma API da web de back-end no contexto de saudação do usuário.</span><span class="sxs-lookup"><span data-stu-id="498d7-111">Consider a web application that accesses a back-end web API in hello context of a user.</span></span> <span data-ttu-id="498d7-112">Neste exemplo, hello aplicativo web (em execução no contexto de saudação de uma conta de serviço ou uma conta de computador ou da máquina) representa Olá usuário ao acessar o recurso de saudação (back-end da web API).</span><span class="sxs-lookup"><span data-stu-id="498d7-112">In this example, hello web application (running in hello context of a service account or a computer/machine account) impersonates hello user when accessing hello resource (back-end web API).</span></span> <span data-ttu-id="498d7-113">A delegação Kerberos é insegura, pois não restringir Olá Olá recursos representando a conta pode acessar no contexto de saudação do usuário de saudação.</span><span class="sxs-lookup"><span data-stu-id="498d7-113">Kerberos delegation is insecure since it does not restrict hello resources hello impersonating account can access in hello context of hello user.</span></span>

<span data-ttu-id="498d7-114">Delegação restringido de Kerberos (KCD) restringe Olá serviços/recursos toowhich Olá determinado servidor pode agir em nome de saudação de um usuário.</span><span class="sxs-lookup"><span data-stu-id="498d7-114">Kerberos constrained delegation (KCD) restricts hello services/resources toowhich hello specified server can act on hello behalf of a user.</span></span> <span data-ttu-id="498d7-115">Tradicional KCD exige tooconfigure de privilégios de administrador de domínio uma conta de domínio para um serviço e restringe o domínio único do hello conta tooa.</span><span class="sxs-lookup"><span data-stu-id="498d7-115">Traditional KCD requires domain administrator privileges tooconfigure a domain account for a service and it restricts hello account tooa single domain.</span></span>

<span data-ttu-id="498d7-116">A KCD tradicional também tem alguns problemas associados.</span><span class="sxs-lookup"><span data-stu-id="498d7-116">Traditional KCD also has a few issues associated with it.</span></span> <span data-ttu-id="498d7-117">Em sistemas operacionais anteriores em que o administrador de domínio Olá configurado serviço hello, o administrador de serviços de saudação não tinha nenhum tooknow de maneira útil quais serviços front-end delegado toohello serviços de recurso que eles tinham.</span><span class="sxs-lookup"><span data-stu-id="498d7-117">In earlier operating systems where hello domain administrator configured hello service, hello service administrator had no useful way tooknow which front-end services delegated toohello resource services they owned.</span></span> <span data-ttu-id="498d7-118">E qualquer serviço front-end que pudesse ser delegado tooa serviço de recurso representava um ponto de ataque potencial.</span><span class="sxs-lookup"><span data-stu-id="498d7-118">And any front-end service that could delegate tooa resource service represented a potential attack point.</span></span> <span data-ttu-id="498d7-119">Se um servidor que hospedasse um serviço front-end fosse comprometido, e ele foi configurado toodelegate tooresource services, serviços de recurso de saudação também poderiam ser comprometidos.</span><span class="sxs-lookup"><span data-stu-id="498d7-119">If a server that hosted a front-end service was compromised, and it was configured toodelegate tooresource services, hello resource services could also be compromised.</span></span>

> [!NOTE]
> <span data-ttu-id="498d7-120">Em um domínio gerenciado do Azure AD Domain Services, você não tem privilégios de administrador de domínio.</span><span class="sxs-lookup"><span data-stu-id="498d7-120">On an Azure AD Domain Services managed domain, you do not have domain administrator privileges.</span></span> <span data-ttu-id="498d7-121">Portanto, **não é possível configurar uma KCD tradicional em um domínio gerenciado**.</span><span class="sxs-lookup"><span data-stu-id="498d7-121">Therefore, **traditional KCD cannot be configured on a managed domain**.</span></span> <span data-ttu-id="498d7-122">Use o KCD baseado em recursos conforme descrito neste artigo.</span><span class="sxs-lookup"><span data-stu-id="498d7-122">Use resource-based KCD as described in this article.</span></span> <span data-ttu-id="498d7-123">Esse mecanismo também é mais seguro.</span><span class="sxs-lookup"><span data-stu-id="498d7-123">This mechanism is also more secure.</span></span>
>
>

## <a name="resource-based-kerberos-constrained-delegation"></a><span data-ttu-id="498d7-124">Delegação restrita de kerberos baseada em recursos</span><span class="sxs-lookup"><span data-stu-id="498d7-124">Resource-based kerberos constrained delegation</span></span>
<span data-ttu-id="498d7-125">No Windows Server 2012 R2 e Windows Server 2012, a delegação Olá capacidade tooconfigure restringido para o serviço de saudação foi transferida do administrador de serviço toohello do administrador de domínio hello.</span><span class="sxs-lookup"><span data-stu-id="498d7-125">In Windows Server 2012 R2 and Windows Server 2012, hello ability tooconfigure constrained delegation for hello service has been transferred from hello domain administrator toohello service administrator.</span></span> <span data-ttu-id="498d7-126">Dessa forma, o administrador do serviço de back-end Olá pode permitir ou negar serviços front-end.</span><span class="sxs-lookup"><span data-stu-id="498d7-126">In this way, hello back-end service administrator can allow or deny front-end services.</span></span> <span data-ttu-id="498d7-127">Esse modelo é conhecido como **delegação restrita de kerberos baseada em recursos**.</span><span class="sxs-lookup"><span data-stu-id="498d7-127">This model is known as **resource-based kerberos constrained delegation**.</span></span>

<span data-ttu-id="498d7-128">A KCD Com base em recursos é configurado usando o PowerShell.</span><span class="sxs-lookup"><span data-stu-id="498d7-128">Resource-based KCD is configured using PowerShell.</span></span> <span data-ttu-id="498d7-129">Você usa Olá Set-ADComputer ou os cmdlets Set-ADUser, dependendo se o hello representando a conta é uma conta de computador ou uma conta de serviço/conta de usuário.</span><span class="sxs-lookup"><span data-stu-id="498d7-129">You use hello Set-ADComputer or Set-ADUser cmdlets, depending on whether hello impersonating account is a computer account or a user account/service account.</span></span>

### <a name="configure-resource-based-kcd-for-a-computer-account-on-a-managed-domain"></a><span data-ttu-id="498d7-130">Configurar a KCD baseada em recursos para uma conta de computador em um domínio gerenciado</span><span class="sxs-lookup"><span data-stu-id="498d7-130">Configure resource-based KCD for a computer account on a managed domain</span></span>
<span data-ttu-id="498d7-131">Suponha que você tenha um aplicativo web em execução no computador de saudação ' contoso100-webapp.contoso100.com'.</span><span class="sxs-lookup"><span data-stu-id="498d7-131">Assume you have a web app running on hello computer 'contoso100-webapp.contoso100.com'.</span></span> <span data-ttu-id="498d7-132">Precisa de recursos de saudação tooaccess (uma API da web em execução no ' contoso100-api.contoso100.com') no contexto de saudação de usuários do domínio.</span><span class="sxs-lookup"><span data-stu-id="498d7-132">It needs tooaccess hello resource (a web API running on 'contoso100-api.contoso100.com') in hello context of domain users.</span></span> <span data-ttu-id="498d7-133">Veja como você pode configurar a KCD baseada em recursos para esse cenário.</span><span class="sxs-lookup"><span data-stu-id="498d7-133">Here's how you would set up resource-based KCD for this scenario.</span></span>

```
$ImpersonatingAccount = Get-ADComputer -Identity contoso100-webapp.contoso100.com
Set-ADComputer contoso100-api.contoso100.com -PrincipalsAllowedToDelegateToAccount $ImpersonatingAccount
```

### <a name="configure-resource-based-kcd-for-a-user-account-on-a-managed-domain"></a><span data-ttu-id="498d7-134">Configurar a KCD baseada em recursos para uma conta de usuário em um domínio gerenciado</span><span class="sxs-lookup"><span data-stu-id="498d7-134">Configure resource-based KCD for a user account on a managed domain</span></span>
<span data-ttu-id="498d7-135">Suponha que você tiver um aplicativo web em execução como uma conta de serviço 'appsvc' e ele precisa de recurso de saudação tooaccess (uma API da web em execução como uma conta de serviço - 'backendsvc') no contexto de saudação de usuários do domínio.</span><span class="sxs-lookup"><span data-stu-id="498d7-135">Assume you have a web app running as a service account 'appsvc' and it needs tooaccess hello resource (a web API running as a service account - 'backendsvc') in hello context of domain users.</span></span> <span data-ttu-id="498d7-136">Veja como você pode configurar a KCD baseada em recursos para esse cenário.</span><span class="sxs-lookup"><span data-stu-id="498d7-136">Here's how you would set up resource-based KCD for this scenario.</span></span>

```
$ImpersonatingAccount = Get-ADUser -Identity appsvc
Set-ADUser backendsvc -PrincipalsAllowedToDelegateToAccount $ImpersonatingAccount
```

## <a name="related-content"></a><span data-ttu-id="498d7-137">Conteúdo relacionado</span><span class="sxs-lookup"><span data-stu-id="498d7-137">Related Content</span></span>
* [<span data-ttu-id="498d7-138">Serviços de Domínio do Azure AD - guia de Introdução</span><span class="sxs-lookup"><span data-stu-id="498d7-138">Azure AD Domain Services - Getting Started guide</span></span>](active-directory-ds-getting-started.md)
* [<span data-ttu-id="498d7-139">Visão geral da Delegação Restrita de Kerberos</span><span class="sxs-lookup"><span data-stu-id="498d7-139">Kerberos Constrained Delegation Overview</span></span>](https://technet.microsoft.com/library/jj553400.aspx)
