---
title: "Banco de Dados SQL - ajuste automático | Microsoft Docs"
description: "O Banco de Dados SQL analisa a consulta SQL e automaticamente se adapta à carga de trabalho do usuário."
services: sql-database
documentationcenter: 
author: jovanpop-msft
manager: jhubbard
editor: 
ms.assetid: 
ms.service: sql-database
ms.custom: monitor & tune
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 06/05/2017
ms.author: jovanpop
ms.openlocfilehash: f5552793db2d89542782b7d9e8f996314f62e429
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 07/11/2017
---
# <a name="automatic-tuning"></a><span data-ttu-id="15458-103">Ajuste automático</span><span class="sxs-lookup"><span data-stu-id="15458-103">Automatic tuning</span></span>

<span data-ttu-id="15458-104">O Banco de Dados SQL do Azure é um serviço de dados totalmente gerenciado que monitora as consultas que são executadas no banco de dados e pode melhorar automaticamente o desempenho da carga de trabalho.</span><span class="sxs-lookup"><span data-stu-id="15458-104">Azure SQL Database is a fully managed data service that monitors the queries that are executed on the database and can automatically improve performance of the workload.</span></span> <span data-ttu-id="15458-105">O Banco de Dados SQL do Azure tem um mecanismo de inteligência interno que pode ajustar e melhorar o desempenho de suas consultas adaptando dinamicamente o banco de dados para sua carga de trabalho automaticamente.</span><span class="sxs-lookup"><span data-stu-id="15458-105">Azure SQL Database has a built-in intelligence mechanism that can automatically tune and improve performance of your queries by dynamically adapting the database to your workload.</span></span> <span data-ttu-id="15458-106">O ajuste automático no Banco de Dados SQL do Azure talvez seja um dos recursos mais importantes que você pode habilitar no Banco de Dados SQL do Azure para otimizar o desempenho das suas consultas.</span><span class="sxs-lookup"><span data-stu-id="15458-106">Automatic tuning in Azure SQL Database might be one of the most important features that you can enable on Azure SQL Database to optimize performance of your queries.</span></span>

<span data-ttu-id="15458-107">Consulte este artigo para obter as etapas para [habilitar o ajuste automático](sql-database-automatic-tuning-enable.md) usando o portal do Azure.</span><span class="sxs-lookup"><span data-stu-id="15458-107">See this article for the steps to [enable automatic tuning](sql-database-automatic-tuning-enable.md) using the Azure portal.</span></span>

## <a name="why-automatic-tuning"></a><span data-ttu-id="15458-108">Por que usar o ajuste automático?</span><span class="sxs-lookup"><span data-stu-id="15458-108">Why automatic tuning?</span></span>

<span data-ttu-id="15458-109">Uma das principais tarefas de administração do banco de dados clássico é monitorar a carga de trabalho, identificando consultas SQL críticas, os índices que devem ser adicionados para melhorar o desempenho e os índices usados raramente.</span><span class="sxs-lookup"><span data-stu-id="15458-109">One of the main tasks in classic database administration is monitoring the workload, identifying critical SQL queries, indexes that should be added to improve performance, and rarely used indexes.</span></span> <span data-ttu-id="15458-110">O Banco de Dados SQL do Azure fornece informações detalhadas sobre as consultas e índices que você precisa monitorar.</span><span class="sxs-lookup"><span data-stu-id="15458-110">Azure SQL Database provides detailed insight into the queries and indexes that you need to monitor.</span></span> <span data-ttu-id="15458-111">No entanto, monitorar o banco de dados é uma tarefa difícil e entediante, especialmente ao lidar com muitos bancos de dados.</span><span class="sxs-lookup"><span data-stu-id="15458-111">However, constantly monitoring database is a hard and tedious task, especially when dealing with many databases.</span></span> <span data-ttu-id="15458-112">Gerenciar um grande número de bancos de dados pode ser impossível de se fazer com eficiência, mesmo com todas as ferramentas e relatórios disponíveis fornecidos pelo Banco de Dados SQL do Azure e pelo portal do Azure.</span><span class="sxs-lookup"><span data-stu-id="15458-112">Managing a huge number of databases might be impossible to do efficiently even with all available tools and reports that Azure SQL Database and Azure portal provide.</span></span> <span data-ttu-id="15458-113">Em vez de monitorar e ajustar o banco de dados manualmente, você pode considerar delegar algumas das ações de monitoramento e ajustes usando o recurso de ajuste automático do Banco de Dados SQL do Azure.</span><span class="sxs-lookup"><span data-stu-id="15458-113">Instead of monitoring and tuning your database manually, you might consider delegating some of the monitoring and tuning actions to Azure SQL Database using automatic tuning feature.</span></span> 


> [!VIDEO https://channel9.msdn.com/Blogs/Azure-in-the-Enterprise/Enabling-Azure-SQL-Database-Auto-Tuning-at-Scale-for-Microsoft-IT/player]
>

## <a name="how-does-automatic-tuning-work"></a><span data-ttu-id="15458-114">Como funciona o trabalho de ajuste automático?</span><span class="sxs-lookup"><span data-stu-id="15458-114">How does automatic tuning work?</span></span>

<span data-ttu-id="15458-115">O Banco de Dados SQL do Azure tem um processo de análise e monitoramento de desempenho contínuo que constantemente aprende sobre as características da sua carga de trabalho e identifica possíveis problemas e aprimoramentos.</span><span class="sxs-lookup"><span data-stu-id="15458-115">Azure SQL Database has a continuous performance monitoring and analysis process that constantly learns about the characteristic of your workload and identify potential issues and improvements.</span></span>

![Processo de ajuste automático](./media/sql-database-automatic-tuning/tuning-process.png)

<span data-ttu-id="15458-117">Esse processo permite que o Banco de Dados SQL do Azure adapte-se dinamicamente à sua carga de trabalho, localizando quais planos e índices podem melhorar o desempenho das cargas de trabalho e quais índices afetam suas cargas de trabalho.</span><span class="sxs-lookup"><span data-stu-id="15458-117">This process enables Azure SQL Database to dynamically adapt to your workload by finding what indexes and plans might improve performance of your workloads and what indexes affect your workloads.</span></span> <span data-ttu-id="15458-118">Com base nessas conclusões, o ajuste automático aplica ações de ajuste que melhoram o desempenho da carga de trabalho.</span><span class="sxs-lookup"><span data-stu-id="15458-118">Based on these findings, automatic tuning applies tuning actions that improve performance of your workload.</span></span> <span data-ttu-id="15458-119">Além disso, o Banco de Dados SQL do Azure monitora continuamente o desempenho após qualquer alteração feita pelo ajuste automático para garantir que ele melhora o desempenho da carga de trabalho.</span><span class="sxs-lookup"><span data-stu-id="15458-119">In addition, Azure SQL Database continuously monitors performance after any change made by automatic tuning to ensure that it improves performance of your workload.</span></span> <span data-ttu-id="15458-120">Qualquer ação que não melhorar o desempenho é revertida automaticamente.</span><span class="sxs-lookup"><span data-stu-id="15458-120">Any action that didn’t improve performance is automatically reverted.</span></span> <span data-ttu-id="15458-121">Esse processo de verificação é um recurso importante que garante que qualquer alteração feita pelo ajuste automático não diminua o desempenho da carga de trabalho.</span><span class="sxs-lookup"><span data-stu-id="15458-121">This verification process is a key feature that ensures that any change made by automatic tuning does not decrease the performance of your workload.</span></span>

<span data-ttu-id="15458-122">Há dois aspectos de ajuste automático que estão disponíveis no Banco de Dados SQL do Azure:</span><span class="sxs-lookup"><span data-stu-id="15458-122">There are two automatic tuning aspects that are available in Azure SQL Database:</span></span>

 -  <span data-ttu-id="15458-123">**Gerenciamento de índice automático** que identifica os índices que devem ser adicionados ao seu banco de dados e os índices que devem ser removidos.</span><span class="sxs-lookup"><span data-stu-id="15458-123">**Automatic index management** that identifies indexes that should be added in your database, and indexes that should be removed.</span></span>
 -  <span data-ttu-id="15458-124">**Correção automática de plano** (em breve; já está disponível no SQL Server 2017) que identifica planos problemáticos e corrige problemas de desempenho do plano SQL .</span><span class="sxs-lookup"><span data-stu-id="15458-124">**Automatic plan correction** (coming soon, already available in SQL Server 2017) that identifies problematic plans and fixes SQL plan performance problems.</span></span>

## <a name="automatic-index-management"></a><span data-ttu-id="15458-125">Gerenciamento de índice automático</span><span class="sxs-lookup"><span data-stu-id="15458-125">Automatic index management</span></span>

<span data-ttu-id="15458-126">No Banco de Dados SQL do Azure, o gerenciamento de índice é fácil porque o Banco de Dados SQL do Azure aprende sobre sua carga de trabalho e garante que seus dados são indexados sempre da melhor forma.</span><span class="sxs-lookup"><span data-stu-id="15458-126">In Azure SQL Database, index management is easy because Azure SQL Database learns about your workload and ensures that your data is always optimally indexed.</span></span> <span data-ttu-id="15458-127">Um design de índice apropriado é crucial para otimizar o desempenho da carga de trabalho e o gerenciamento de índice automático pode ajudar a otimizar seus índices.</span><span class="sxs-lookup"><span data-stu-id="15458-127">Proper index design is crucial for optimal performance of your workload, and automatic index management can help you optimize your indexes.</span></span> <span data-ttu-id="15458-128">O gerenciamento de índice automático pode corrigir problemas de desempenho em bancos de dados indexados incorretamente ou manter e aprimorar os índices no esquema de banco de dados existente.</span><span class="sxs-lookup"><span data-stu-id="15458-128">Automatic index management can either fix performance issues in incorrectly indexed databases, or maintain and improve indexes on the existing database schema.</span></span> 

### <a name="why-do-you-need-index-management"></a><span data-ttu-id="15458-129">Por que você precisa de gerenciamento de índice?</span><span class="sxs-lookup"><span data-stu-id="15458-129">Why do you need index management?</span></span>

<span data-ttu-id="15458-130">Os índices aceleram algumas de suas consultas de leitura de dados das tabelas; no entanto, eles podem retardar as consultas que atualizam dados.</span><span class="sxs-lookup"><span data-stu-id="15458-130">Indexes speed up some of your queries that read data from the tables; however, they can slow down the queries that update data.</span></span> <span data-ttu-id="15458-131">Você precisa analisar cuidadosamente quando criar um índice e quais colunas você precisa incluir no índice.</span><span class="sxs-lookup"><span data-stu-id="15458-131">You need to carefully analyze when to create an index and what columns you need to include in the index.</span></span> <span data-ttu-id="15458-132">Alguns índices podem não ser mais necessários após algum tempo.</span><span class="sxs-lookup"><span data-stu-id="15458-132">Some indexes might not be needed after some time.</span></span> <span data-ttu-id="15458-133">Portanto, você precisa identificar periodicamente e descartar os índices que não geram nenhum benefício.</span><span class="sxs-lookup"><span data-stu-id="15458-133">Therefore, you would need to periodically identify and drop the indexes that do not bring any benefits.</span></span> <span data-ttu-id="15458-134">Se você ignorar os índices não utilizados, o desempenho das consultas que atualizam dados será reduzido sem nenhum benefício nas consultas de leitura de dados.</span><span class="sxs-lookup"><span data-stu-id="15458-134">If you ignore the unused indexes, performance of the queries that update data would be decreased without any benefit on the queries that read data.</span></span> <span data-ttu-id="15458-135">Índices não utilizados também afetam o desempenho geral do sistema porque atualizações adicionais precisam do log desnecessário.</span><span class="sxs-lookup"><span data-stu-id="15458-135">Unused indexes also affect overall performance of the system because additional updates require unnecessary logging.</span></span>

<span data-ttu-id="15458-136">Descobrir o conjunto ideal de índices que melhoram o desempenho das consultas de leitura de dados das tabelas e que tenham um impacto mínimo sobre as atualizações pode exigir uma análise contínua e complexa.</span><span class="sxs-lookup"><span data-stu-id="15458-136">Finding the optimal set of indexes that improve performance of the queries that read data from your tables and have minimal impact on updates might require continuous and complex analysis.</span></span>

<span data-ttu-id="15458-137">O Banco de Dados SQL do Azure usa inteligência interna e regras avançadas para analisar suas consultas, identifique os índices que seriam ideais para suas cargas de trabalho atuais e os índices que podem ser removidos.</span><span class="sxs-lookup"><span data-stu-id="15458-137">Azure SQL Database uses built-in intelligence and advanced rules that analyze your queries, identify indexes that would be optimal for your current workloads, and the indexes might be removed.</span></span> <span data-ttu-id="15458-138">O Banco de Dados SQL do Azure garante que você tenha um conjunto mínimo necessário de índices que otimizam as consultas de leitura de dados, com o menor impacto sobre as outras consultas.</span><span class="sxs-lookup"><span data-stu-id="15458-138">Azure SQL Database ensures that you have a minimal necessary set of indexes that optimize the queries that read data, with the minimized impact on the other queries.</span></span>

### <a name="how-to-identify-indexes-that-need-to-be-changed-in-your-database"></a><span data-ttu-id="15458-139">Como identificar os índices que precisam ser alterados no seu banco de dados?</span><span class="sxs-lookup"><span data-stu-id="15458-139">How to identify indexes that need to be changed in your database?</span></span>

<span data-ttu-id="15458-140">O Banco de Dados SQL do Azure facilita o processo de gerenciamento de índice.</span><span class="sxs-lookup"><span data-stu-id="15458-140">Azure SQL Database makes index management process easy.</span></span> <span data-ttu-id="15458-141">Em vez do processo tedioso de análise e monitoramento manuais da carga de trabalho de índice, o Banco de Dados SQL do Azure analisa sua carga de trabalho, identifica as consultas que podem ser executadas mais rapidamente com um novo índice e identifica os índices duplicados ou não utilizados.</span><span class="sxs-lookup"><span data-stu-id="15458-141">Instead of the tedious process of manual workload analysis and index monitoring, Azure SQL Database analyzes your workload, identifies the queries that could be executed faster with a new index, and identifies unused or duplicated indexes.</span></span> <span data-ttu-id="15458-142">Encontre mais informações sobre a identificação de índices que devem ser alterados em [Encontrar recomendações de índice no portal do Azure](sql-database-advisor-portal.md).</span><span class="sxs-lookup"><span data-stu-id="15458-142">Find more information about identification of indexes that should be changed at [Find index recommendations in Azure portal](sql-database-advisor-portal.md).</span></span>

### <a name="automatic-index-management-considerations"></a><span data-ttu-id="15458-143">Considerações sobre o gerenciamento de índice automático</span><span class="sxs-lookup"><span data-stu-id="15458-143">Automatic index management considerations</span></span>

<span data-ttu-id="15458-144">Se você achar que as regras internas melhoram o desempenho do seu banco de dados, você pode permitir que Banco de Dados SQL do Azure gerenciar automaticamente seus índices.</span><span class="sxs-lookup"><span data-stu-id="15458-144">If you find that the built-in rules improve the performance of your database, you might let Azure SQL database automatically manage your indexes.</span></span>

<span data-ttu-id="15458-145">As ações necessárias para criar índices necessários em Bancos de Dados SQL do Azure podem consumir recursos e afetar o desempenho da carga de trabalho temporariamente.</span><span class="sxs-lookup"><span data-stu-id="15458-145">Actions required to create necessary indexes in Azure SQL Databases might consume resources and temporally affect workload performance.</span></span> <span data-ttu-id="15458-146">Para minimizar o impacto da criação de índice no desempenho da carga de trabalho, o Banco de Dados SQL do Azure localiza a janela de tempo apropriada para qualquer operação de gerenciamento de índice.</span><span class="sxs-lookup"><span data-stu-id="15458-146">To minimize the impact of index creation on workload performance, Azure SQL Database finds the appropriate time window for any index management operation.</span></span> <span data-ttu-id="15458-147">A ação de ajuste é adiada se o banco de dados precisa de recursos para executar sua carga de trabalho e iniciada quando o banco de dados tem uma quantidade suficiente de recursos não utilizados que podem ser usados para a tarefa de manutenção.</span><span class="sxs-lookup"><span data-stu-id="15458-147">Tuning action is postponed if the database needs resources to execute your workload, and started when the database has enough unused resources that can be used for the maintenance task.</span></span> <span data-ttu-id="15458-148">Um recurso importante no gerenciamento de índice automático é a verificação das ações.</span><span class="sxs-lookup"><span data-stu-id="15458-148">One important feature in automatic index management is a verification of the actions.</span></span> <span data-ttu-id="15458-149">Quando o Banco de Dados SQL do Azure cria ou descarta o índice, um processo de monitoramento analisa o desempenho da carga de trabalho para verificar se a ação melhorou o desempenho.</span><span class="sxs-lookup"><span data-stu-id="15458-149">When Azure SQL Database creates or drops index, a monitoring process analyzes performance of your workload to verify that the action improved the performance.</span></span> <span data-ttu-id="15458-150">Se essa ação não gerar uma melhoria significativa ela será revertida imediatamente.</span><span class="sxs-lookup"><span data-stu-id="15458-150">If it didn’t bring significant improvement – the action is immediately reverted.</span></span> <span data-ttu-id="15458-151">Dessa forma, o Banco de Dados SQL do Azure garante que as ações automáticas não afetam negativamente o desempenho da carga de trabalho.</span><span class="sxs-lookup"><span data-stu-id="15458-151">This way, Azure SQL Database ensures that automatic actions do not negatively impact performance of your workload.</span></span> <span data-ttu-id="15458-152">Os índices criados com o ajuste automático são transparentes para a operação de manutenção no esquema subjacente.</span><span class="sxs-lookup"><span data-stu-id="15458-152">Indexes created by automatic tuning are transparent for the maintenance operation on the underlying schema.</span></span> <span data-ttu-id="15458-153">Alterações de esquema como remover ou renomear colunas não são bloqueadas pela presença de índices criados automaticamente.</span><span class="sxs-lookup"><span data-stu-id="15458-153">Schema changes such as dropping or renaming columns are not blocked by the presence of automatically created indexes.</span></span> <span data-ttu-id="15458-154">Os índices criados automaticamente pelo Banco de Dados SQL do Azure são imediatamente descartados quando a tabela ou colunas relacionadas são descartadas.</span><span class="sxs-lookup"><span data-stu-id="15458-154">Indexes that are automatically created by Azure SQL Database are immediately dropped when related table or columns is dropped.</span></span>

## <a name="automatic-plan-choice-correction"></a><span data-ttu-id="15458-155">Correção automática de escolha do plano</span><span class="sxs-lookup"><span data-stu-id="15458-155">Automatic plan choice correction</span></span>

<span data-ttu-id="15458-156">A correção automática de plano é um novo recurso de ajuste automático adicionado no SQL Server 2017 CTP 2.0 que identifica os planos de SQL inadequados.</span><span class="sxs-lookup"><span data-stu-id="15458-156">Automatic plan correction is a new automatic tuning feature added in SQL Server 2017 CTP2.0 that identifies SQL plans that misbehave.</span></span> <span data-ttu-id="15458-157">Essa opção de ajuste automático estará disponível em breve no Banco de Dados SQL do Azure.</span><span class="sxs-lookup"><span data-stu-id="15458-157">This automatic tuning option is coming soon on Azure SQL Database.</span></span> <span data-ttu-id="15458-158">Veja mais informações em [Ajuste automático no SQL Server 2017](https://docs.microsoft.com/sql/relational-databases/automatic-tuning/automatic-tuning).</span><span class="sxs-lookup"><span data-stu-id="15458-158">Find more information at [Automatic tuning in SQL Server 2017](https://docs.microsoft.com/sql/relational-databases/automatic-tuning/automatic-tuning).</span></span>

## <a name="next-steps"></a><span data-ttu-id="15458-159">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="15458-159">Next steps</span></span>

- <span data-ttu-id="15458-160">Para habilitar o ajuste automático no Banco de Dados SQL do Azure e permitir que o recurso de ajuste automático gerencie a carga de trabalho por completo, consulte [Habilitar o ajuste automático](sql-database-automatic-tuning-enable.md).</span><span class="sxs-lookup"><span data-stu-id="15458-160">To enable automatic tuning in Azure SQL Database and let automatic tuning feature fully manage your workload, see [Enable automatic tuning](sql-database-automatic-tuning-enable.md).</span></span>
- <span data-ttu-id="15458-161">Para usar o ajuste manual, examine as [Recomendações de ajuste no portal do Azure](sql-database-advisor-portal.md) e aplique manualmente aquelas que melhoram o desempenho de suas consultas.</span><span class="sxs-lookup"><span data-stu-id="15458-161">To use manual tuning, you can review [Tuning recommendations in Azure portal](sql-database-advisor-portal.md) and manually apply the ones that improve performance of your queries.</span></span>
