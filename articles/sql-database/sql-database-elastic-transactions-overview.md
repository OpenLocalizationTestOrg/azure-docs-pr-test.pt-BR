---
title: "aaaDistributed transações entre bancos de dados de nuvem"
description: "Visão Geral das Transações de Banco de Dados Elástico com o Banco de Dados SQL do Azure"
services: sql-database
documentationcenter: 
author: torsteng
manager: jhubbard
editor: torsteng
ms.assetid: e14df7a3-7788-4cfb-bcd1-7ad6433ef1f9
ms.service: sql-database
ms.custom: scale out apps
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: sql-database
ms.date: 05/27/2016
ms.author: torsteng
ms.openlocfilehash: 9a18f2749108d337bf115b3dc21dd0c7828dd9c2
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="distributed-transactions-across-cloud-databases"></a><span data-ttu-id="2f855-103">Transações distribuídas entre bancos de dados na nuvem</span><span class="sxs-lookup"><span data-stu-id="2f855-103">Distributed transactions across cloud databases</span></span>
<span data-ttu-id="2f855-104">Transações de banco de dados Elástico de banco de dados do SQL do Azure (banco de dados SQL) permitem que você toorun transações que abrangem vários bancos de dados no banco de dados SQL.</span><span class="sxs-lookup"><span data-stu-id="2f855-104">Elastic database transactions for Azure SQL Database (SQL DB) allow you toorun transactions that span several databases in SQL DB.</span></span> <span data-ttu-id="2f855-105">Transações de banco de dados Elástico de banco de dados SQL estão disponíveis para aplicativos .NET usando o ADO .NET e integrar com experiência programação familiar hello usando Olá [Transaction](https://msdn.microsoft.com/library/system.transactions.aspx) classes.</span><span class="sxs-lookup"><span data-stu-id="2f855-105">Elastic database transactions for SQL DB are available for .NET applications using ADO .NET and integrate with hello familiar programming experience using hello [System.Transaction](https://msdn.microsoft.com/library/system.transactions.aspx) classes.</span></span> <span data-ttu-id="2f855-106">biblioteca de saudação tooget, consulte [do .NET Framework 4.6.1 (instalador da Web)](https://www.microsoft.com/download/details.aspx?id=49981).</span><span class="sxs-lookup"><span data-stu-id="2f855-106">tooget hello library, see [.NET Framework 4.6.1 (Web Installer)](https://www.microsoft.com/download/details.aspx?id=49981).</span></span>

<span data-ttu-id="2f855-107">No local, esse cenário normalmente exigiria a execução do recurso MSDTC (Coordenador de Transações Distribuídas da Microsoft).</span><span class="sxs-lookup"><span data-stu-id="2f855-107">On premises, such a scenario usually required running Microsoft Distributed Transaction Coordinator (MSDTC).</span></span> <span data-ttu-id="2f855-108">Desde que o MSDTC não está disponível para aplicativos de plataforma como um serviço no Azure, transações de toocoordinate distribuída capacidade Olá agora foi diretamente integrado ao banco de dados SQL.</span><span class="sxs-lookup"><span data-stu-id="2f855-108">Since MSDTC is not available for Platform-as-a-Service application in Azure, hello ability toocoordinate distributed transactions has now been directly integrated into SQL DB.</span></span> <span data-ttu-id="2f855-109">Aplicativos podem se conectar a tooany transações de toolaunch distribuído de banco de dados SQL e um dos bancos de dados de saudação transparentemente coordena transações Olá distribuída, conforme mostrado na figura a seguir de saudação.</span><span class="sxs-lookup"><span data-stu-id="2f855-109">Applications can connect tooany SQL Database toolaunch distributed transactions, and one of hello databases will transparently coordinate hello distributed transaction, as shown in hello following figure.</span></span> 

  ![<span data-ttu-id="2f855-110">Transações distribuídas com o Banco de Dados SQL do Azure usando transações de banco de dados elástico</span><span class="sxs-lookup"><span data-stu-id="2f855-110">Distributed transactions with Azure SQL Database using elastic database transactions</span></span> ][1]

## <a name="common-scenarios"></a><span data-ttu-id="2f855-111">Cenários comuns</span><span class="sxs-lookup"><span data-stu-id="2f855-111">Common scenarios</span></span>
<span data-ttu-id="2f855-112">Transações de banco de dados Elástico de banco de dados SQL habilitar aplicativos toomake mudanças atômicas toodata armazenado em vários bancos de dados diferentes do SQL.</span><span class="sxs-lookup"><span data-stu-id="2f855-112">Elastic database transactions for SQL DB enable applications toomake atomic changes toodata stored in several different SQL Databases.</span></span> <span data-ttu-id="2f855-113">visualização de saudação se concentra em experiências de desenvolvimento de cliente em c# e .NET.</span><span class="sxs-lookup"><span data-stu-id="2f855-113">hello preview focuses on client-side development experiences in C# and .NET.</span></span> <span data-ttu-id="2f855-114">Há planos para uma experiência do lado do servidor usando o T-SQL para um momento posterior.</span><span class="sxs-lookup"><span data-stu-id="2f855-114">A server-side experience using T-SQL is planned for a later time.</span></span>  
<span data-ttu-id="2f855-115">Saudação de destinos de transações de banco de dados Elástico os seguintes cenários:</span><span class="sxs-lookup"><span data-stu-id="2f855-115">Elastic database transactions targets hello following scenarios:</span></span>

* <span data-ttu-id="2f855-116">Aplicativos de vários bancos de dados no Azure: com esse cenário, os dados são particionados verticalmente em vários bancos de dados no BD SQL, de modo que os diferentes tipos de dados residam em bancos de dados diferentes.</span><span class="sxs-lookup"><span data-stu-id="2f855-116">Multi-database applications in Azure: With this scenario, data is vertically partitioned across several databases in SQL DB such that different kinds of data reside on different databases.</span></span> <span data-ttu-id="2f855-117">Algumas operações exigem toodata alterações que é mantido em duas ou mais bancos de dados.</span><span class="sxs-lookup"><span data-stu-id="2f855-117">Some operations require changes toodata which is kept in two or more databases.</span></span> <span data-ttu-id="2f855-118">aplicativo Hello usa as alterações do banco de dados Elástico transações toocoordinate Olá em bancos de dados e garantir a atomicidade.</span><span class="sxs-lookup"><span data-stu-id="2f855-118">hello application uses elastic database transactions toocoordinate hello changes across databases and ensure atomicity.</span></span>
* <span data-ttu-id="2f855-119">Aplicativos de banco de dados fragmentado no Azure: com esse cenário, a camada de dados de Olá usa Olá [biblioteca de cliente do banco de dados Elástico](sql-database-elastic-database-client-library.md) ou autofragmentação toohorizontally partição Olá dados em vários bancos de dados no banco de dados SQL.</span><span class="sxs-lookup"><span data-stu-id="2f855-119">Sharded database applications in Azure: With this scenario, hello data tier uses hello [Elastic Database client library](sql-database-elastic-database-client-library.md) or self-sharding toohorizontally partition hello data across many databases in SQL DB.</span></span> <span data-ttu-id="2f855-120">Um caso de uso proeminentes é mudanças atômicas do hello necessidade tooperform para um aplicativo multilocatário fragmentado quando alterações abrangem locatários.</span><span class="sxs-lookup"><span data-stu-id="2f855-120">One prominent use case is hello need tooperform atomic changes for a sharded multi-tenant application when changes span tenants.</span></span> <span data-ttu-id="2f855-121">Considere para a instância de uma transferência de um locatário tooanother, ambos os que residem em bancos de dados diferentes.</span><span class="sxs-lookup"><span data-stu-id="2f855-121">Think for instance of a transfer from one tenant tooanother, both residing on different databases.</span></span> <span data-ttu-id="2f855-122">Um segundo caso é fragmentação refinada tooaccommodate necessidades de capacidade para um locatário grande, que por sua vez, normalmente, implica que algumas toostretch de necessidades de operações atômicas em vários bancos de dados usados para Olá mesmo locatário.</span><span class="sxs-lookup"><span data-stu-id="2f855-122">A second case is fine-grained sharding tooaccommodate capacity needs for a large tenant which in turn typically implies that some atomic operations needs toostretch across several databases used for hello same tenant.</span></span> <span data-ttu-id="2f855-123">Um terceiro caso é atômica atualiza os dados de tooreference que são replicados em bancos de dados.</span><span class="sxs-lookup"><span data-stu-id="2f855-123">A third case is atomic updates tooreference data that are replicated across databases.</span></span> <span data-ttu-id="2f855-124">Operações atômicas transacionadas, essas linhas agora podem ser coordenadas entre vários bancos de dados usando a visualização de saudação.</span><span class="sxs-lookup"><span data-stu-id="2f855-124">Atomic, transacted, operations along these lines can now be coordinated across several databases using hello preview.</span></span>
  <span data-ttu-id="2f855-125">Transações de banco de dados Elástico usam atomicidade do protocolo 2PC tooensure transações entre bancos de dados.</span><span class="sxs-lookup"><span data-stu-id="2f855-125">Elastic database transactions use two-phase commit tooensure transaction atomicity across databases.</span></span> <span data-ttu-id="2f855-126">É uma boa opção para as transações que envolvem menos de 100 bancos de dados por vez em uma única transação.</span><span class="sxs-lookup"><span data-stu-id="2f855-126">It is a good fit for transactions that involve less than 100 databases at a time within a single transaction.</span></span> <span data-ttu-id="2f855-127">Esses limites não são impostos, mas um deve esperar o desempenho e taxas de sucesso para o banco de dados Elástico transações toosuffer ao exceder esses limites.</span><span class="sxs-lookup"><span data-stu-id="2f855-127">These limits are not enforced, but one should expect performance and success rates for elastic database transactions toosuffer when exceeding these limits.</span></span>

## <a name="installation-and-migration"></a><span data-ttu-id="2f855-128">Instalação e migração</span><span class="sxs-lookup"><span data-stu-id="2f855-128">Installation and migration</span></span>
<span data-ttu-id="2f855-129">recursos de saudação para transações de banco de dados Elástico no banco de dados SQL são fornecidos por meio de bibliotecas do .NET toohello de atualizações System.Data.dll e System.Transactions.dll.</span><span class="sxs-lookup"><span data-stu-id="2f855-129">hello capabilities for elastic database transactions in SQL DB are provided through updates toohello .NET libraries System.Data.dll and System.Transactions.dll.</span></span> <span data-ttu-id="2f855-130">Olá DLLs Certifique-se de confirmação de duas fases é usada quando necessário tooensure atomicidade.</span><span class="sxs-lookup"><span data-stu-id="2f855-130">hello DLLs ensure that two-phase commit is used where necessary tooensure atomicity.</span></span> <span data-ttu-id="2f855-131">instalar toostart desenvolver aplicativos usando transações de banco de dados Elástico [do .NET Framework 4.6.1](https://www.microsoft.com/download/details.aspx?id=49981) ou uma versão posterior.</span><span class="sxs-lookup"><span data-stu-id="2f855-131">toostart developing applications using elastic database transactions, install [.NET Framework 4.6.1](https://www.microsoft.com/download/details.aspx?id=49981) or a later version.</span></span> <span data-ttu-id="2f855-132">Quando executado em uma versão anterior do .NET framework do hello, haverá falha nas transações toopromote tooa distribuída transaction e será gerada uma exceção.</span><span class="sxs-lookup"><span data-stu-id="2f855-132">When running on an earlier version of hello .NET framework, transactions will fail toopromote tooa distributed transaction and an exception will be raised.</span></span>

<span data-ttu-id="2f855-133">Após a instalação, você pode usar transações distribuída de saudação APIs System. Transactions com conexões tooSQL banco de dados.</span><span class="sxs-lookup"><span data-stu-id="2f855-133">After installation, you can use hello distributed transaction APIs in System.Transactions with connections tooSQL DB.</span></span> <span data-ttu-id="2f855-134">Se você tiver aplicativos existentes do MSDTC usando essas APIs, simplesmente recriar seus aplicativos existentes para o .NET 4.6 depois de instalar o hello 4.6.1 Framework.</span><span class="sxs-lookup"><span data-stu-id="2f855-134">If you have existing MSDTC applications using these APIs, simply rebuild your existing applications for .NET 4.6 after installing hello 4.6.1 Framework.</span></span> <span data-ttu-id="2f855-135">Se seus projetos de destino do .NET 4.6, eles usarão automaticamente DLLs Olá atualizado da versão do Framework novo hello e chamadas de API de transação distribuída em combinação com conexões tooSQL que DB agora terá êxito.</span><span class="sxs-lookup"><span data-stu-id="2f855-135">If your projects target .NET 4.6, they will automatically use hello updated DLLs from hello new Framework version and distributed transaction API calls in combination with connections tooSQL DB will now succeed.</span></span>

<span data-ttu-id="2f855-136">Lembre-se de que as transações de banco de dados elástico não requerem a instalação do MSDTC.</span><span class="sxs-lookup"><span data-stu-id="2f855-136">Remember that elastic database transactions do not require installing MSDTC.</span></span> <span data-ttu-id="2f855-137">Em vez disso, as transações de banco de dados elástico são gerenciadas diretamente pelo BD SQL, dentro dele.</span><span class="sxs-lookup"><span data-stu-id="2f855-137">Instead, elastic database transactions are directly managed by and within SQL DB.</span></span> <span data-ttu-id="2f855-138">Isso simplifica significativamente a cenários de nuvem como uma implantação do MSDTC não é necessário toouse distribuída transações com o banco de dados SQL.</span><span class="sxs-lookup"><span data-stu-id="2f855-138">This significantly simplifies cloud scenarios since a deployment of MSDTC is not necessary toouse distributed transactions with SQL DB.</span></span> <span data-ttu-id="2f855-139">Seção 4 explica detalhadamente como hello e transações de banco de dados Elástico toodeploy necessária do .NET framework junto com seu tooAzure de aplicativos de nuvem.</span><span class="sxs-lookup"><span data-stu-id="2f855-139">Section 4 explains in more detail how toodeploy elastic database transactions and hello required .NET framework together with your cloud applications tooAzure.</span></span>

## <a name="development-experience"></a><span data-ttu-id="2f855-140">Experiência de desenvolvimento</span><span class="sxs-lookup"><span data-stu-id="2f855-140">Development experience</span></span>
### <a name="multi-database-applications"></a><span data-ttu-id="2f855-141">Aplicativos de vários bancos de dados</span><span class="sxs-lookup"><span data-stu-id="2f855-141">Multi-database applications</span></span>
<span data-ttu-id="2f855-142">Olá código a seguir usa experiência familiar de programação Olá com .NET System. Transactions.</span><span class="sxs-lookup"><span data-stu-id="2f855-142">hello following sample code uses hello familiar programming experience with .NET System.Transactions.</span></span> <span data-ttu-id="2f855-143">Olá classe TransactionScope estabelece uma transação de ambiente no .NET.</span><span class="sxs-lookup"><span data-stu-id="2f855-143">hello TransactionScope class establishes an ambient transaction in .NET.</span></span> <span data-ttu-id="2f855-144">(Uma "transação de ambiente" é um que reside no thread atual hello.) Todas as conexões abertas em Olá TransactionScope participarem de transações de saudação.</span><span class="sxs-lookup"><span data-stu-id="2f855-144">(An “ambient transaction” is one that lives in hello current thread.) All connections opened within hello TransactionScope participate in hello transaction.</span></span> <span data-ttu-id="2f855-145">Se participarem de bancos de dados diferentes, a transação de Olá é automaticamente elevada tooa distribuída transação.</span><span class="sxs-lookup"><span data-stu-id="2f855-145">If different databases participate, hello transaction is automatically elevated tooa distributed transaction.</span></span> <span data-ttu-id="2f855-146">resultado de saudação da transação de saudação é controlado pela configuração Olá escopo toocomplete tooindicate uma confirmação.</span><span class="sxs-lookup"><span data-stu-id="2f855-146">hello outcome of hello transaction is controlled by setting hello scope toocomplete tooindicate a commit.</span></span>

    using (var scope = new TransactionScope())
    {
        using (var conn1 = new SqlConnection(connStrDb1))
        {
            conn1.Open();
            SqlCommand cmd1 = conn1.CreateCommand();
            cmd1.CommandText = string.Format("insert into T1 values(1)");
            cmd1.ExecuteNonQuery();
        }

        using (var conn2 = new SqlConnection(connStrDb2))
        {
            conn2.Open();
            var cmd2 = conn2.CreateCommand();
            cmd2.CommandText = string.Format("insert into T2 values(2)");
            cmd2.ExecuteNonQuery();
        }

        scope.Complete();
    }

### <a name="sharded-database-applications"></a><span data-ttu-id="2f855-147">Aplicativos de banco de dados fragmentado</span><span class="sxs-lookup"><span data-stu-id="2f855-147">Sharded database applications</span></span>
<span data-ttu-id="2f855-148">Transações de banco de dados Elástico de banco de dados SQL também dão suporte a coordenação de transações distribuídas, onde você utiliza o método de OpenConnectionForKey Olá Olá Elástico de banco de dados biblioteca tooopen de conexões de cliente para uma expansão de dados camada.</span><span class="sxs-lookup"><span data-stu-id="2f855-148">Elastic database transactions for SQL DB also support coordinating distributed transactions where you use hello OpenConnectionForKey method of hello elastic database client library tooopen connections for a scaled out data tier.</span></span> <span data-ttu-id="2f855-149">Considere a possibilidade de casos onde você precisa consistência transacional tooguarantee para alterações em vários valores de chave de fragmentação diferente.</span><span class="sxs-lookup"><span data-stu-id="2f855-149">Consider cases where you need tooguarantee transactional consistency for changes across several different sharding key values.</span></span> <span data-ttu-id="2f855-150">Fragmentos de toohello conexões hospedagem valores de chave de fragmentação diferente de saudação são orientados usando OpenConnectionForKey.</span><span class="sxs-lookup"><span data-stu-id="2f855-150">Connections toohello shards hosting hello different sharding key values are brokered using OpenConnectionForKey.</span></span> <span data-ttu-id="2f855-151">No caso de geral hello, conexões Olá podem ser toodifferent fragmentos, de modo que garantir garantias transacionais requer uma transação distribuída.</span><span class="sxs-lookup"><span data-stu-id="2f855-151">In hello general case, hello connections can be toodifferent shards such that ensuring transactional guarantees requires a distributed transaction.</span></span> <span data-ttu-id="2f855-152">saudação de exemplo de código a seguir ilustra essa abordagem.</span><span class="sxs-lookup"><span data-stu-id="2f855-152">hello following code sample illustrates this approach.</span></span> <span data-ttu-id="2f855-153">Ele pressupõe que uma variável chamada shardmap é toorepresent usado um fragmento do mapa da biblioteca de cliente do banco de dados Elástico hello:</span><span class="sxs-lookup"><span data-stu-id="2f855-153">It assumes that a variable called shardmap is used toorepresent a shard map from hello elastic database client library:</span></span>

    using (var scope = new TransactionScope())
    {
        using (var conn1 = shardmap.OpenConnectionForKey(tenantId1, credentialsStr))
        {
            conn1.Open();
            SqlCommand cmd1 = conn1.CreateCommand();
            cmd1.CommandText = string.Format("insert into T1 values(1)");
            cmd1.ExecuteNonQuery();
        }

        using (var conn2 = shardmap.OpenConnectionForKey(tenantId2, credentialsStr))
        {
            conn2.Open();
            var cmd2 = conn2.CreateCommand();
            cmd2.CommandText = string.Format("insert into T1 values(2)");
            cmd2.ExecuteNonQuery();
        }

        scope.Complete();
    }


## <a name="net-installation-for-azure-cloud-services"></a><span data-ttu-id="2f855-154">Instalação do .NET para os Serviços de Nuvem do Azure</span><span class="sxs-lookup"><span data-stu-id="2f855-154">.NET installation for Azure Cloud Services</span></span>
<span data-ttu-id="2f855-155">O Azure fornece várias ofertas de aplicativos .NET de toohost.</span><span class="sxs-lookup"><span data-stu-id="2f855-155">Azure provides several offerings toohost .NET applications.</span></span> <span data-ttu-id="2f855-156">Uma comparação entre as diferentes ofertas hello está disponível em [comparação do serviço de aplicativo do Azure, serviços de nuvem e máquinas virtuais](../app-service-web/choose-web-site-cloud-service-vm.md).</span><span class="sxs-lookup"><span data-stu-id="2f855-156">A comparison of hello different offerings is available in [Azure App Service, Cloud Services, and Virtual Machines comparison](../app-service-web/choose-web-site-cloud-service-vm.md).</span></span> <span data-ttu-id="2f855-157">Se hello a sistema operacional convidado da oferta de saudação é menor do que o .NET 4.6.1 exigido para transações Elásticos, será necessário tooupgrade too4.6.1 de sistema operacional de convidado de saudação.</span><span class="sxs-lookup"><span data-stu-id="2f855-157">If hello guest OS of hello offering is smaller than .NET 4.6.1 required for elastic transactions, you need tooupgrade hello guest OS too4.6.1.</span></span> 

<span data-ttu-id="2f855-158">Para serviços de aplicativo do Azure, atualiza convidado toohello que SO não têm suporte no momento.</span><span class="sxs-lookup"><span data-stu-id="2f855-158">For Azure App Services, upgrades toohello guest OS are currently not supported.</span></span> <span data-ttu-id="2f855-159">Para máquinas de virtuais do Azure, basta fazer logon em Olá VM e executar o instalador de saudação do hello mais recente do .NET framework.</span><span class="sxs-lookup"><span data-stu-id="2f855-159">For Azure Virtual Machines, simply log into hello VM and run hello installer for hello latest .NET framework.</span></span> <span data-ttu-id="2f855-160">Para serviços de nuvem do Azure, você precisa de instalação de saudação tooinclude de uma versão mais recente do .NET em tarefas de inicialização de saudação da sua implantação.</span><span class="sxs-lookup"><span data-stu-id="2f855-160">For Azure Cloud Services, you need tooinclude hello installation of a newer .NET version into hello startup tasks of your deployment.</span></span> <span data-ttu-id="2f855-161">conceitos de saudação e as etapas documentadas no [instalar .NET em uma função de serviço de nuvem](../cloud-services/cloud-services-dotnet-install-dotnet.md).</span><span class="sxs-lookup"><span data-stu-id="2f855-161">hello concepts and steps are documented in [Install .NET on a Cloud Service Role](../cloud-services/cloud-services-dotnet-install-dotnet.md).</span></span>  

<span data-ttu-id="2f855-162">Observe que Olá instalador para o .NET 4.6.1 pode exigir mais armazenamento temporário durante a saudação inicializar processo nos serviços de nuvem do Azure que Olá instalador para o .NET 4.6.</span><span class="sxs-lookup"><span data-stu-id="2f855-162">Note that hello installer for .NET 4.6.1 may require more temporary storage during hello bootstrapping process on Azure cloud services than hello installer for .NET 4.6.</span></span> <span data-ttu-id="2f855-163">tooensure uma instalação bem-sucedida, é necessário armazenamento temporário tooincrease para seu serviço de nuvem do Azure em seu arquivo servicedefinition. Csdef na seção de LocalResources Olá Olá configurações do ambiente e de sua tarefa de inicialização, conforme mostrado na seguinte Olá exemplo:</span><span class="sxs-lookup"><span data-stu-id="2f855-163">tooensure a successful installation, you need tooincrease temporary storage for your Azure cloud service in your ServiceDefinition.csdef file in hello LocalResources section and hello environment settings of your startup task, as shown in hello following sample:</span></span>

    <LocalResources>
    ...
        <LocalStorage name="TEMP" sizeInMB="5000" cleanOnRoleRecycle="false" />
        <LocalStorage name="TMP" sizeInMB="5000" cleanOnRoleRecycle="false" />
    </LocalResources>
    <Startup>
        <Task commandLine="install.cmd" executionContext="elevated" taskType="simple">
            <Environment>
        ...
                <Variable name="TEMP">
                    <RoleInstanceValue xpath="/RoleEnvironment/CurrentInstance/LocalResources/LocalResource[@name='TEMP']/@path" />
                </Variable>
                <Variable name="TMP">
                    <RoleInstanceValue xpath="/RoleEnvironment/CurrentInstance/LocalResources/LocalResource[@name='TMP']/@path" />
                </Variable>
            </Environment>
        </Task>
    </Startup>

## <a name="transactions-across-multiple-servers"></a><span data-ttu-id="2f855-164">Transações entre vários servidores</span><span class="sxs-lookup"><span data-stu-id="2f855-164">Transactions across multiple servers</span></span>
<span data-ttu-id="2f855-165">Há suporte para transações de Banco de Dados Elástico entre diferentes servidores lógicos no Banco de Dados SQL do Azure.</span><span class="sxs-lookup"><span data-stu-id="2f855-165">Elastic database transactions are supported across different logical servers in Azure SQL Database.</span></span> <span data-ttu-id="2f855-166">Quando as transações cruzam os limites do servidor lógico, servidores participantes Olá primeiro necessário toobe inserido em uma relação de comunicação comum.</span><span class="sxs-lookup"><span data-stu-id="2f855-166">When transactions cross logical server boundaries, hello participating servers first need toobe entered into a mutual communication relationship.</span></span> <span data-ttu-id="2f855-167">Após o estabelecimento de relação de comunicação hello, qualquer banco de dados em qualquer um dos Olá dois servidores podem participar de transações Elásticos com bancos de dados de Olá outro servidor.</span><span class="sxs-lookup"><span data-stu-id="2f855-167">Once hello communication relationship has been established, any database in any of hello two servers can participate in elastic transactions with databases from hello other server.</span></span> <span data-ttu-id="2f855-168">Com mais de dois servidores lógicos a abrangência de transações, uma relação de comunicação deve toobe em vigor para qualquer par de servidores lógicos.</span><span class="sxs-lookup"><span data-stu-id="2f855-168">With transactions spanning more than two logical servers, a communication relationship needs toobe in place for any pair of logical servers.</span></span>

<span data-ttu-id="2f855-169">Use Olá relações de comunicação entre servidores de toomanage PowerShell cmdlets para transações de banco de dados Elástico a seguir:</span><span class="sxs-lookup"><span data-stu-id="2f855-169">Use hello following PowerShell cmdlets toomanage cross-server communication relationships for elastic database transactions:</span></span>

* <span data-ttu-id="2f855-170">**Novo AzureRmSqlServerCommunicationLink**: Use esse cmdlet toocreate uma nova relação de comunicação entre dois servidores lógicos no banco de dados de SQL do Azure.</span><span class="sxs-lookup"><span data-stu-id="2f855-170">**New-AzureRmSqlServerCommunicationLink**: Use this cmdlet toocreate a new communication relationship between two logical servers in Azure SQL DB.</span></span> <span data-ttu-id="2f855-171">relação de saudação for simétrica, que significa que ambos os servidores podem iniciar transações com hello outro servidor.</span><span class="sxs-lookup"><span data-stu-id="2f855-171">hello relationship is symmetric which means both servers can initiate transactions with hello other server.</span></span>
* <span data-ttu-id="2f855-172">**Get-AzureRmSqlServerCommunicationLink**: Use essa comunicação existente do cmdlet tooretrieve relações e suas propriedades.</span><span class="sxs-lookup"><span data-stu-id="2f855-172">**Get-AzureRmSqlServerCommunicationLink**: Use this cmdlet tooretrieve existing communication relationships and their properties.</span></span>
* <span data-ttu-id="2f855-173">**Remover AzureRmSqlServerCommunicationLink**: Use esse cmdlet tooremove uma relação de comunicação existente.</span><span class="sxs-lookup"><span data-stu-id="2f855-173">**Remove-AzureRmSqlServerCommunicationLink**: Use this cmdlet tooremove an existing communication relationship.</span></span> 

## <a name="monitoring-transaction-status"></a><span data-ttu-id="2f855-174">Monitorando o status da transação</span><span class="sxs-lookup"><span data-stu-id="2f855-174">Monitoring transaction status</span></span>
<span data-ttu-id="2f855-175">Use as exibições de gerenciamento dinâmico (DMVs) no banco de dados SQL toomonitor status e progresso das suas transações de banco de dados Elástico em andamento.</span><span class="sxs-lookup"><span data-stu-id="2f855-175">Use Dynamic Management Views (DMVs) in SQL DB toomonitor status and progress of your ongoing elastic database transactions.</span></span> <span data-ttu-id="2f855-176">Todos os tootransactions relacionados de DMVs são relevantes para transações distribuídas no banco de dados SQL.</span><span class="sxs-lookup"><span data-stu-id="2f855-176">All DMVs related tootransactions are relevant for distributed transactions in SQL DB.</span></span> <span data-ttu-id="2f855-177">Você pode encontrar hello lista correspondente DMVs aqui: [relacionados exibições de gerenciamento dinâmico transação e funções (Transact-SQL)](https://msdn.microsoft.com/library/ms178621.aspx).</span><span class="sxs-lookup"><span data-stu-id="2f855-177">You can find hello corresponding list of DMVs here: [Transaction Related Dynamic Management Views and Functions (Transact-SQL)](https://msdn.microsoft.com/library/ms178621.aspx).</span></span>

<span data-ttu-id="2f855-178">Estas DMVs são especialmente úteis:</span><span class="sxs-lookup"><span data-stu-id="2f855-178">These DMVs are particularly useful:</span></span>

* <span data-ttu-id="2f855-179">**sys.dm\_tran\_active\_transactions**: lista as transações atualmente ativas e seu status.</span><span class="sxs-lookup"><span data-stu-id="2f855-179">**sys.dm\_tran\_active\_transactions**: Lists currently active transactions and their status.</span></span> <span data-ttu-id="2f855-180">Olá coluna UOW (unidade de trabalho) pode identificar Olá filho diferentes transações que pertencem a toohello mesma transação distribuída.</span><span class="sxs-lookup"><span data-stu-id="2f855-180">hello UOW (Unit Of Work) column can identify hello different child transactions that belong toohello same distributed transaction.</span></span> <span data-ttu-id="2f855-181">Todas as transações dentro Olá mesma transação distribuída realizar Olá mesmo valor UOW.</span><span class="sxs-lookup"><span data-stu-id="2f855-181">All transactions within hello same distributed transaction carry hello same UOW value.</span></span> <span data-ttu-id="2f855-182">Consulte Olá [documentação DMV](https://msdn.microsoft.com/library/ms174302.aspx) para obter mais detalhes.</span><span class="sxs-lookup"><span data-stu-id="2f855-182">See hello [DMV documentation](https://msdn.microsoft.com/library/ms174302.aspx) for more details.</span></span>
* <span data-ttu-id="2f855-183">**sys.DM\_tran\_banco de dados\_transações**: fornece informações adicionais sobre transações, como o posicionamento de transação Olá no log de saudação.</span><span class="sxs-lookup"><span data-stu-id="2f855-183">**sys.dm\_tran\_database\_transactions**: Provides additional information about transactions, such as placement of hello transaction in hello log.</span></span> <span data-ttu-id="2f855-184">Consulte Olá [documentação DMV](https://msdn.microsoft.com/library/ms186957.aspx) para obter mais detalhes.</span><span class="sxs-lookup"><span data-stu-id="2f855-184">See hello [DMV documentation](https://msdn.microsoft.com/library/ms186957.aspx) for more details.</span></span>
* <span data-ttu-id="2f855-185">**sys.DM\_tran\_bloqueios**: fornece informações sobre bloqueios de saudação que são mantidos por transações em andamento.</span><span class="sxs-lookup"><span data-stu-id="2f855-185">**sys.dm\_tran\_locks**: Provides information about hello locks that are currently held by ongoing transactions.</span></span> <span data-ttu-id="2f855-186">Consulte Olá [documentação DMV](https://msdn.microsoft.com/library/ms190345.aspx) para obter mais detalhes.</span><span class="sxs-lookup"><span data-stu-id="2f855-186">See hello [DMV documentation](https://msdn.microsoft.com/library/ms190345.aspx) for more details.</span></span>

## <a name="limitations"></a><span data-ttu-id="2f855-187">Limitações</span><span class="sxs-lookup"><span data-stu-id="2f855-187">Limitations</span></span>
<span data-ttu-id="2f855-188">Olá seguintes limitações no momento se aplicam a tooelastic transações de banco de dados no banco de dados SQL:</span><span class="sxs-lookup"><span data-stu-id="2f855-188">hello following limitations currently apply tooelastic database transactions in SQL DB:</span></span>

* <span data-ttu-id="2f855-189">Há suporte somente para transações em bancos de dados no BD SQL.</span><span class="sxs-lookup"><span data-stu-id="2f855-189">Only transactions across databases in SQL DB are supported.</span></span> <span data-ttu-id="2f855-190">Outros provedores de recursos [X/Open XA](https://en.wikipedia.org/wiki/X/Open_XA) e bancos de dados fora do BD SQL não podem participar de transações de banco de dados elástico.</span><span class="sxs-lookup"><span data-stu-id="2f855-190">Other [X/Open XA](https://en.wikipedia.org/wiki/X/Open_XA) resource providers and databases outside of SQL DB cannot participate in elastic database transactions.</span></span> <span data-ttu-id="2f855-191">Isso significa que as transações de banco de dados elástico não podem se estender para o SQL Server e o Banco de Dados SQL do Azure no local.</span><span class="sxs-lookup"><span data-stu-id="2f855-191">That means that elastic database transactions cannot stretch across on premises SQL Server and Azure SQL Databases.</span></span> <span data-ttu-id="2f855-192">Para transações distribuídas no local, continue toouse MSDTC.</span><span class="sxs-lookup"><span data-stu-id="2f855-192">For distributed transactions on premises, continue toouse MSDTC.</span></span> 
* <span data-ttu-id="2f855-193">Há suporte somente para transações coordenadas pelo cliente a partir de um aplicativo .NET.</span><span class="sxs-lookup"><span data-stu-id="2f855-193">Only client-coordinated transactions from a .NET application are supported.</span></span> <span data-ttu-id="2f855-194">Há planos para suporte do lado do servidor para o T-SQL, como INICIAR TRANSAÇÃO DISTRIBUÍDA, mas ainda não está disponível.</span><span class="sxs-lookup"><span data-stu-id="2f855-194">Server-side support for T-SQL such as BEGIN DISTRIBUTED TRANSACTION is planned, but not yet available.</span></span> 
* <span data-ttu-id="2f855-195">Não há suporte para transações em serviços WCF.</span><span class="sxs-lookup"><span data-stu-id="2f855-195">Transactions across WCF services are not supported.</span></span> <span data-ttu-id="2f855-196">Por exemplo, você tem um método de serviço WCF que executa uma transação.</span><span class="sxs-lookup"><span data-stu-id="2f855-196">For example, you have a WCF service method that executes a transaction.</span></span> <span data-ttu-id="2f855-197">Olá chamada dentro de um escopo de transação de circunscrição falhará como um [System.ServiceModel.ProtocolException](https://msdn.microsoft.com/library/system.servicemodel.protocolexception).</span><span class="sxs-lookup"><span data-stu-id="2f855-197">Enclosing hello call within a transaction scope will fail as a [System.ServiceModel.ProtocolException](https://msdn.microsoft.com/library/system.servicemodel.protocolexception).</span></span>

## <a name="next-steps"></a><span data-ttu-id="2f855-198">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="2f855-198">Next steps</span></span>
<span data-ttu-id="2f855-199">Para dúvidas, entre em contato toous em Olá [Fórum do banco de dados SQL](http://social.msdn.microsoft.com/forums/azure/home?forum=ssdsgetstarted) e para solicitações de recurso, adicione-toohello [Fórum de comentários do banco de dados SQL](https://feedback.azure.com/forums/217321-sql-database/).</span><span class="sxs-lookup"><span data-stu-id="2f855-199">For questions, please reach out toous on hello [SQL Database forum](http://social.msdn.microsoft.com/forums/azure/home?forum=ssdsgetstarted) and for feature requests, please add them toohello [SQL Database feedback forum](https://feedback.azure.com/forums/217321-sql-database/).</span></span>

<!--Image references-->
[1]: ./media/sql-database-elastic-transactions-overview/distributed-transactions.png



