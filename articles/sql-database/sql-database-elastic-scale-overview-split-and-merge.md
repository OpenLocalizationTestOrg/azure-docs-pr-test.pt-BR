---
title: "aaaMoving dados entre bancos de dados de nuvem expansíveis | Microsoft Docs"
description: "Explica como fragmentos toomanipulate mover dados através de um serviço auto-hospedado usando elástica banco de dados e APIs."
services: sql-database
documentationcenter: 
manager: jhubbard
author: ddove
ms.assetid: 204fd902-0397-4185-985a-dea3ed7c7d9f
ms.service: sql-database
ms.custom: scale out apps
ms.workload: sql-database
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 10/24/2016
ms.author: ddove
ms.openlocfilehash: 629dee06e22609e9b61edf93ba5c38d997132d8c
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="moving-data-between-scaled-out-cloud-databases"></a><span data-ttu-id="42fda-103">Mover dados entre bancos de dados na nuvem escalados horizontalmente</span><span class="sxs-lookup"><span data-stu-id="42fda-103">Moving data between scaled-out cloud databases</span></span>
<span data-ttu-id="42fda-104">Se você é um Software como um desenvolvedor de serviço e, de repente, o aplicativo passa por demanda enorme, será necessário tooaccommodate crescimento de saudação.</span><span class="sxs-lookup"><span data-stu-id="42fda-104">If you are a Software as a Service developer, and suddenly your app undergoes tremendous demand, you need tooaccommodate hello growth.</span></span> <span data-ttu-id="42fda-105">Por isso você adiciona mais bancos de dados (fragmentos).</span><span class="sxs-lookup"><span data-stu-id="42fda-105">So you add more databases (shards).</span></span> <span data-ttu-id="42fda-106">Como você redistribuir Olá dados toohello novos bancos de dados sem afetar a integridade dos dados de Olá?</span><span class="sxs-lookup"><span data-stu-id="42fda-106">How do you redistribute hello data toohello new databases without disrupting hello data integrity?</span></span> <span data-ttu-id="42fda-107">Saudação de uso **ferramenta de mesclagem de divisão** dados toomove restrita toohello novos bancos de dados de bancos de dados.</span><span class="sxs-lookup"><span data-stu-id="42fda-107">Use hello **split-merge tool** toomove data from constrained databases toohello new databases.</span></span>  

<span data-ttu-id="42fda-108">ferramenta de mesclagem de divisão de saudação é executado como um serviço web do Azure.</span><span class="sxs-lookup"><span data-stu-id="42fda-108">hello split-merge tool runs as an Azure web service.</span></span> <span data-ttu-id="42fda-109">Um administrador ou desenvolvedor usa Olá ferramenta toomove shardlets (dados de um fragmento) entre diferentes bancos de dados (fragmentos).</span><span class="sxs-lookup"><span data-stu-id="42fda-109">An administrator or developer uses hello tool toomove shardlets (data from a shard) between different databases (shards).</span></span> <span data-ttu-id="42fda-110">ferramenta Olá usa fragmento mapa gerenciamento toomaintain Olá serviço metadados banco de dados e certifique-se de mapeamentos consistentes.</span><span class="sxs-lookup"><span data-stu-id="42fda-110">hello tool uses shard map management toomaintain hello service metadata database, and ensure consistent mappings.</span></span>

![Visão geral][1]

## <a name="download"></a><span data-ttu-id="42fda-112">Baixar</span><span class="sxs-lookup"><span data-stu-id="42fda-112">Download</span></span>
[<span data-ttu-id="42fda-113">Microsoft.Azure.SqlDatabase.ElasticScale.Service.SplitMerge</span><span class="sxs-lookup"><span data-stu-id="42fda-113">Microsoft.Azure.SqlDatabase.ElasticScale.Service.SplitMerge</span></span>](http://www.nuget.org/packages/Microsoft.Azure.SqlDatabase.ElasticScale.Service.SplitMerge/)

## <a name="documentation"></a><span data-ttu-id="42fda-114">Documentação</span><span class="sxs-lookup"><span data-stu-id="42fda-114">Documentation</span></span>
1. [<span data-ttu-id="42fda-115">Tutorial de ferramenta da Divisão de Mesclagem do banco de dados elástico</span><span class="sxs-lookup"><span data-stu-id="42fda-115">Elastic database Split-Merge tool tutorial</span></span>](sql-database-elastic-scale-configure-deploy-split-and-merge.md)
2. [<span data-ttu-id="42fda-116">Configuração de segurança da divisão e mesclagem</span><span class="sxs-lookup"><span data-stu-id="42fda-116">Split-Merge security configuration</span></span>](sql-database-elastic-scale-split-merge-security-configuration.md)
3. [<span data-ttu-id="42fda-117">Considerações de segurança de divisão/mesclagem</span><span class="sxs-lookup"><span data-stu-id="42fda-117">Split-merge security considerations</span></span>](sql-database-elastic-scale-split-merge-security-configuration.md)
4. [<span data-ttu-id="42fda-118">Gerenciamento de mapa de fragmentos</span><span class="sxs-lookup"><span data-stu-id="42fda-118">Shard map management</span></span>](sql-database-elastic-scale-shard-map-management.md)
5. [<span data-ttu-id="42fda-119">Migrar tooscale-out de bancos de dados existente</span><span class="sxs-lookup"><span data-stu-id="42fda-119">Migrate existing databases tooscale-out</span></span>](sql-database-elastic-convert-to-use-elastic-tools.md)
6. [<span data-ttu-id="42fda-120">Ferramentas de Banco de Dados Elástico</span><span class="sxs-lookup"><span data-stu-id="42fda-120">Elastic database tools</span></span>](sql-database-elastic-scale-introduction.md)
7. [<span data-ttu-id="42fda-121">Glossário de ferramentas do banco de dados elástico</span><span class="sxs-lookup"><span data-stu-id="42fda-121">Elastic Database tools glossary</span></span>](sql-database-elastic-scale-glossary.md)

## <a name="why-use-hello-split-merge-tool"></a><span data-ttu-id="42fda-122">Por que usar a ferramenta de mesclagem de divisão de Olá?</span><span class="sxs-lookup"><span data-stu-id="42fda-122">Why use hello split-merge tool?</span></span>
<span data-ttu-id="42fda-123">**Flexibilidade**</span><span class="sxs-lookup"><span data-stu-id="42fda-123">**Flexibility**</span></span>

<span data-ttu-id="42fda-124">Os aplicativos precisam toostretch flexibilidade além dos limites de saudação de um único banco de dados do banco de dados de SQL do Azure.</span><span class="sxs-lookup"><span data-stu-id="42fda-124">Applications need toostretch flexibly beyond hello limits of a single Azure SQL DB database.</span></span> <span data-ttu-id="42fda-125">Use dados de toomove de ferramenta do hello como bancos de dados necessários toonew enquanto mantém a integridade.</span><span class="sxs-lookup"><span data-stu-id="42fda-125">Use hello tool toomove data as needed toonew databases while retaining integrity.</span></span>

<span data-ttu-id="42fda-126">**Toogrow de divisão**</span><span class="sxs-lookup"><span data-stu-id="42fda-126">**Split toogrow**</span></span> 

<span data-ttu-id="42fda-127">Você precisa tooincrease geral crescimento explosivo de toohandle de capacidade.</span><span class="sxs-lookup"><span data-stu-id="42fda-127">You need tooincrease overall capacity toohandle explosive growth.</span></span> <span data-ttu-id="42fda-128">toodo assim, criar capacidade adicional por dados de saudação de fragmentação e distribuí-lo em bancos de dados incrementalmente mais até que sejam cumpridas as necessidades de capacidade.</span><span class="sxs-lookup"><span data-stu-id="42fda-128">toodo so, create additional capacity by sharding hello data and by distributing it across incrementally more databases until capacity needs are fulfilled.</span></span> <span data-ttu-id="42fda-129">Este é um exemplo principal do recurso de 'Dividir' hello.</span><span class="sxs-lookup"><span data-stu-id="42fda-129">This is a prime example of hello ‘split’ feature.</span></span> 

<span data-ttu-id="42fda-130">**Mesclar tooshrink**</span><span class="sxs-lookup"><span data-stu-id="42fda-130">**Merge tooshrink**</span></span>

<span data-ttu-id="42fda-131">Capacidade precisa reduzir devido a natureza sazonais toohello de uma empresa.</span><span class="sxs-lookup"><span data-stu-id="42fda-131">Capacity needs shrink due toohello seasonal nature of a business.</span></span> <span data-ttu-id="42fda-132">unidade de escala Olá ferramenta permite que você reduzir toofewer quando reduz a negócios.</span><span class="sxs-lookup"><span data-stu-id="42fda-132">hello tool lets you scale down toofewer scale units when business slows.</span></span> <span data-ttu-id="42fda-133">recurso de 'Mesclagem' Olá Olá escala elástica divisão mesclagem serviço abrange a esse requisito.</span><span class="sxs-lookup"><span data-stu-id="42fda-133">hello ‘merge’ feature in hello Elastic Scale split-merge Service covers this requirement.</span></span> 

<span data-ttu-id="42fda-134">**Gerenciar pontos de acesso movendo shardlets**</span><span class="sxs-lookup"><span data-stu-id="42fda-134">**Manage hotspots by moving shardlets**</span></span>

<span data-ttu-id="42fda-135">Com vários locatários por banco de dados, alocação de saudação de shardlets tooshards pode levar toocapacity afunilamentos em alguns fragmentos.</span><span class="sxs-lookup"><span data-stu-id="42fda-135">With multiple tenants per database, hello allocation of shardlets tooshards can lead toocapacity bottlenecks on some shards.</span></span> <span data-ttu-id="42fda-136">Isso exige a realocação shardlets ou mover shardlets ocupado toonew ou menos utilizadas em fragmentos.</span><span class="sxs-lookup"><span data-stu-id="42fda-136">This requires re-allocating shardlets or moving busy shardlets toonew or less utilized shards.</span></span> 

## <a name="concepts--key-features"></a><span data-ttu-id="42fda-137">Principais recursos e conceitos</span><span class="sxs-lookup"><span data-stu-id="42fda-137">Concepts & key features</span></span>
<span data-ttu-id="42fda-138">**Serviços hospedados no cliente**</span><span class="sxs-lookup"><span data-stu-id="42fda-138">**Customer-hosted services**</span></span>

<span data-ttu-id="42fda-139">mesclagem Olá divisão é entregue como um serviço hospedado pelo cliente.</span><span class="sxs-lookup"><span data-stu-id="42fda-139">hello split-merge is delivered as a customer-hosted service.</span></span> <span data-ttu-id="42fda-140">Você deve implantar e hospedar o serviço de saudação em sua assinatura do Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="42fda-140">You must deploy and host hello service in your Microsoft Azure subscription.</span></span> <span data-ttu-id="42fda-141">pacote de saudação que baixar do NuGet contém um toocomplete do modelo de configuração com informações de saudação para sua implantação específica.</span><span class="sxs-lookup"><span data-stu-id="42fda-141">hello package you download from NuGet contains a configuration template toocomplete with hello information for your specific deployment.</span></span> <span data-ttu-id="42fda-142">Consulte Olá [divisão mesclagem tutorial](sql-database-elastic-scale-configure-deploy-split-and-merge.md) para obter detalhes.</span><span class="sxs-lookup"><span data-stu-id="42fda-142">See hello [split-merge tutorial](sql-database-elastic-scale-configure-deploy-split-and-merge.md) for details.</span></span> <span data-ttu-id="42fda-143">Desde que o serviço de saudação é executado na sua assinatura do Azure, você pode controlar e configurar a maioria dos aspectos de segurança do serviço de hello.</span><span class="sxs-lookup"><span data-stu-id="42fda-143">Since hello service runs in your Azure subscription, you can control and configure most security aspects of hello service.</span></span> <span data-ttu-id="42fda-144">modelo de padrão de saudação inclui Olá opções tooconfigure SSL, a autenticação de cliente baseada em certificado, a criptografia para credenciais armazenadas, proteção DoS e restrições de IP.</span><span class="sxs-lookup"><span data-stu-id="42fda-144">hello default template includes hello options tooconfigure SSL, certificate-based client authentication, encryption for stored credentials, DoS guarding and IP restrictions.</span></span> <span data-ttu-id="42fda-145">Você pode encontrar mais informações sobre Olá aspectos de segurança em Olá documento a seguir [configuração de segurança de divisão mesclagem](sql-database-elastic-scale-split-merge-security-configuration.md).</span><span class="sxs-lookup"><span data-stu-id="42fda-145">You can find more information on hello security aspects in hello following document [split-merge security configuration](sql-database-elastic-scale-split-merge-security-configuration.md).</span></span>

<span data-ttu-id="42fda-146">padrão de saudação implantado o serviço é executado com um operador e uma função web.</span><span class="sxs-lookup"><span data-stu-id="42fda-146">hello default deployed service runs with one worker and one web role.</span></span> <span data-ttu-id="42fda-147">Cada uma usa o tamanho de VM A1 de saudação nos serviços de nuvem do Azure.</span><span class="sxs-lookup"><span data-stu-id="42fda-147">Each uses hello A1 VM size in Azure Cloud Services.</span></span> <span data-ttu-id="42fda-148">Enquanto você não pode modificar essas configurações durante a implantação de pacote hello, eles podem ser alterados depois de uma implantação bem-sucedida em Olá executando o serviço de nuvem (por meio de saudação portal do Azure).</span><span class="sxs-lookup"><span data-stu-id="42fda-148">While you cannot modify these settings when deploying hello package, you could change them after a successful deployment in hello running cloud service, (through hello Azure portal).</span></span> <span data-ttu-id="42fda-149">Observe a que essa função de trabalho Olá não deve ser configurada para mais de uma única instância por motivos técnicos.</span><span class="sxs-lookup"><span data-stu-id="42fda-149">Note that hello worker role must not be configured for more than a single instance for technical reasons.</span></span> 

<span data-ttu-id="42fda-150">**Integração de mapa de fragmentos**</span><span class="sxs-lookup"><span data-stu-id="42fda-150">**Shard map integration**</span></span>

<span data-ttu-id="42fda-151">serviço de divisão mesclagem Olá interage com o mapa de fragmentos de saudação do aplicativo hello.</span><span class="sxs-lookup"><span data-stu-id="42fda-151">hello split-merge service interacts with hello shard map of hello application.</span></span> <span data-ttu-id="42fda-152">Ao usar toosplit do serviço de divisão mesclagem hello ou intervalos de mesclagem ou toomove shardlets entre fragmentos, o serviço de saudação mantém automaticamente mapa do fragmento Olá backup toodate.</span><span class="sxs-lookup"><span data-stu-id="42fda-152">When using hello split-merge service toosplit or merge ranges or toomove shardlets between shards, hello service automatically keeps hello shard map up toodate.</span></span> <span data-ttu-id="42fda-153">toodo assim, o serviço de Olá conecta-se o banco de dados do toohello fragmento mapa Gerenciador do aplicativo hello e mantém os intervalos e mapeamentos como progresso de solicitações de divisão/mesclagem/mover.</span><span class="sxs-lookup"><span data-stu-id="42fda-153">toodo so, hello service connects toohello shard map manager database of hello application and maintains ranges and mappings as split/merge/move requests progress.</span></span> <span data-ttu-id="42fda-154">Isso garante que mapa do fragmento Olá sempre apresenta uma exibição atualizada quando operações de mesclagem de divisão estão.</span><span class="sxs-lookup"><span data-stu-id="42fda-154">This ensures that hello shard map always presents an up-to-date view when split-merge operations are going on.</span></span> <span data-ttu-id="42fda-155">Dividir, as operações de movimentação de mesclagem e shardlet são implementadas movendo um lote de shardlets de fragmento de destino Olá fonte fragmento toohello.</span><span class="sxs-lookup"><span data-stu-id="42fda-155">Split, merge and shardlet movement operations are implemented by moving a batch of shardlets from hello source shard toohello target shard.</span></span> <span data-ttu-id="42fda-156">Durante a saudação shardlet movimentação operação Olá shardlets assunto toohello lote atual são marcados como offline no mapa do fragmento hello e não estão disponíveis para conexões de roteamento dependente de dados usando Olá **OpenConnectionForKey** API.</span><span class="sxs-lookup"><span data-stu-id="42fda-156">During hello shardlet movement operation hello shardlets subject toohello current batch are marked as offline in hello shard map and are unavailable for data-dependent routing connections using hello **OpenConnectionForKey** API.</span></span> 

<span data-ttu-id="42fda-157">**Conexões consistentes de shardlet**</span><span class="sxs-lookup"><span data-stu-id="42fda-157">**Consistent shardlet connections**</span></span>

<span data-ttu-id="42fda-158">Quando a movimentação de dados é iniciado para um novo lote de shardlets, qualquer mapa de fragmento fornecido dependente de dados roteamento conexões toohello fragmento armazenando Olá shardlet são conexões eliminadas e subsequentes do mapa do fragmento Olá APIs toohello essas shardlets são bloqueados enquanto a movimentação de dados Hello está em andamento em inconsistências de tooavoid de ordem.</span><span class="sxs-lookup"><span data-stu-id="42fda-158">When data movement starts for a new batch of shardlets, any shard-map provided data-dependent routing connections toohello shard storing hello shardlet are killed and subsequent connections from hello shard map APIs toohello these shardlets are blocked while hello data movement is in progress in order tooavoid inconsistencies.</span></span> <span data-ttu-id="42fda-159">Conexões tooother shardlets em Olá mesmo fragmento também irá obter eliminado, mas terá êxito novamente imediatamente na próxima tentativa.</span><span class="sxs-lookup"><span data-stu-id="42fda-159">Connections tooother shardlets on hello same shard will also get killed, but will succeed again immediately on retry.</span></span> <span data-ttu-id="42fda-160">Depois que o lote Olá for movida, Olá shardlets são marcados online novamente para o fragmento de destino hello e dados de origem de saudação são removidos do fragmento de código-fonte hello.</span><span class="sxs-lookup"><span data-stu-id="42fda-160">Once hello batch is moved, hello shardlets are marked online again for hello target shard and hello source data is removed from hello source shard.</span></span> <span data-ttu-id="42fda-161">serviço de saudação passa por essas etapas para cada lote até que todos os shardlets foram movidos.</span><span class="sxs-lookup"><span data-stu-id="42fda-161">hello service goes through these steps for every batch until all shardlets have been moved.</span></span> <span data-ttu-id="42fda-162">Isso levará tooseveral operações de eliminação de conexão durante saudação de concluir a operação divisão/mesclagem/mover hello.</span><span class="sxs-lookup"><span data-stu-id="42fda-162">This will lead tooseveral connection kill operations during hello course of hello complete split/merge/move operation.</span></span>  

<span data-ttu-id="42fda-163">**Gerenciando a disponibilidade de shardlets**</span><span class="sxs-lookup"><span data-stu-id="42fda-163">**Managing shardlet availability**</span></span>

<span data-ttu-id="42fda-164">Limitar conexão Olá eliminando toohello o lote atual de shardlets como discutido acima restringe o escopo de saudação do lote de tooone indisponibilidade de shardlets por vez.</span><span class="sxs-lookup"><span data-stu-id="42fda-164">Limiting hello connection killing toohello current batch of shardlets as discussed above restricts hello scope of unavailability tooone batch of shardlets at a time.</span></span> <span data-ttu-id="42fda-165">Isso é preferível uma abordagem onde fragmento completa Olá permaneceria off-line para todos os seus shardlets durante saudação de uma operação de divisão ou mesclagem.</span><span class="sxs-lookup"><span data-stu-id="42fda-165">This is preferred over an approach where hello complete shard would remain offline for all its shardlets during hello course of a split or merge operation.</span></span> <span data-ttu-id="42fda-166">tamanho de saudação de um lote, definido como número de saudação de shardlets distintos toomove por vez, é um parâmetro de configuração.</span><span class="sxs-lookup"><span data-stu-id="42fda-166">hello size of a batch, defined as hello number of distinct shardlets toomove at a time, is a configuration parameter.</span></span> <span data-ttu-id="42fda-167">Ela pode ser definida para cada operação de divisão e mesclagem dependendo das necessidades de disponibilidade e o desempenho do aplicativo hello.</span><span class="sxs-lookup"><span data-stu-id="42fda-167">It can be defined for each split and merge operation depending on hello application’s availability and performance needs.</span></span> <span data-ttu-id="42fda-168">Observe que o intervalo de saudação que está sendo bloqueado no mapa do fragmento Olá pode ser maior do que o tamanho de lote de saudação especificado.</span><span class="sxs-lookup"><span data-stu-id="42fda-168">Note that hello range that is being locked in hello shard map may be larger than hello batch size specified.</span></span> <span data-ttu-id="42fda-169">Isso ocorre porque o serviço Olá escolhe o tamanho do intervalo de saudação, de modo que o número real de saudação de valores de chave de fragmentação em dados saudação corresponde aproximadamente tamanho de lote de saudação.</span><span class="sxs-lookup"><span data-stu-id="42fda-169">This is because hello service picks hello range size such that hello actual number of sharding key values in hello data approximately matches hello batch size.</span></span> <span data-ttu-id="42fda-170">Isso é importante tooremember em particular para as chaves de fragmentação de modo disperso preenchida.</span><span class="sxs-lookup"><span data-stu-id="42fda-170">This is important tooremember in particular for sparsely populated sharding keys.</span></span> 

<span data-ttu-id="42fda-171">**Armazenamento de metadados**</span><span class="sxs-lookup"><span data-stu-id="42fda-171">**Metadata storage**</span></span>

<span data-ttu-id="42fda-172">serviço de divisão mesclagem Olá usa um toomaintain de banco de dados, seu status e tookeep logs durante o processamento da solicitação.</span><span class="sxs-lookup"><span data-stu-id="42fda-172">hello split-merge service uses a database toomaintain its status and tookeep logs during request processing.</span></span> <span data-ttu-id="42fda-173">usuário Olá cria este banco de dados em sua assinatura e fornece a cadeia de caracteres de conexão Olá para ela no arquivo de configuração de saudação para implantação de serviço de saudação.</span><span class="sxs-lookup"><span data-stu-id="42fda-173">hello user creates this database in their subscription and provides hello connection string for it in hello configuration file for hello service deployment.</span></span> <span data-ttu-id="42fda-174">Os administradores de empresa saudação do usuário também podem se conectar toothis andamento tooreview banco de dados e tooinvestigate obter informações detalhadas sobre falhas potenciais.</span><span class="sxs-lookup"><span data-stu-id="42fda-174">Administrators from hello user’s organization can also connect toothis database tooreview request progress and tooinvestigate detailed information regarding potential failures.</span></span>

<span data-ttu-id="42fda-175">**Reconhecimento de fragmentação**</span><span class="sxs-lookup"><span data-stu-id="42fda-175">**Sharding-awareness**</span></span>

<span data-ttu-id="42fda-176">serviço de divisão mesclagem Olá faz distinção entre tabelas fragmentadas (1), as tabelas de referência (2) e tabelas (3) normais.</span><span class="sxs-lookup"><span data-stu-id="42fda-176">hello split-merge service differentiates between (1) sharded tables, (2) reference tables, and (3) normal tables.</span></span> <span data-ttu-id="42fda-177">semântica de saudação de uma operação de divisão/mesclagem/mover depende do tipo hello da tabela de saudação usada e é definida da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="42fda-177">hello semantics of a split/merge/move operation depend on hello type of hello table used and are defined as follows:</span></span> 

* <span data-ttu-id="42fda-178">**Tabelas fragmentadas**: Split, merge e operações de movimentação movem shardlets de fragmento de tootarget de origem.</span><span class="sxs-lookup"><span data-stu-id="42fda-178">**Sharded tables**: Split, merge, and move operations move shardlets from source tootarget shard.</span></span> <span data-ttu-id="42fda-179">Após a conclusão bem-sucedida da saudação solicitação geral, os shardlets não estão mais presentes na fonte de saudação.</span><span class="sxs-lookup"><span data-stu-id="42fda-179">After successful completion of hello overall request, those shardlets are no longer present on hello source.</span></span> <span data-ttu-id="42fda-180">Observe que as tabelas de destino de saudação necessário tooexist no fragmento de destino Olá e não devem conter dados no destino Olá tooprocessing anterior de intervalo da operação de saudação.</span><span class="sxs-lookup"><span data-stu-id="42fda-180">Note that hello target tables need tooexist on hello target shard and must not contain data in hello target range prior tooprocessing of hello operation.</span></span> 
* <span data-ttu-id="42fda-181">**Tabelas de referência**: para tabelas de referência, Olá split, merge e mover operações copiem dados de saudação de fragmento de destino Olá fonte toohello.</span><span class="sxs-lookup"><span data-stu-id="42fda-181">**Reference tables**: For reference tables, hello split, merge and move operations copy hello data from hello source toohello target shard.</span></span> <span data-ttu-id="42fda-182">No entanto, observe que nenhuma alteração ocorre no fragmento de destino Olá para uma determinada tabela se qualquer linha já está presente nesta tabela no destino hello.</span><span class="sxs-lookup"><span data-stu-id="42fda-182">Note, however, that no changes occur on hello target shard for a given table if any row is already present in this table on hello target.</span></span> <span data-ttu-id="42fda-183">tabela de saudação tem toobe vazia para qualquer tooget de operação de cópia do referência tabela processado.</span><span class="sxs-lookup"><span data-stu-id="42fda-183">hello table has toobe empty for any reference table copy operation tooget processed.</span></span>
* <span data-ttu-id="42fda-184">**Outras tabelas**: outras tabelas podem estar presentes na origem hello ou de destino de saudação de uma operação de divisão e mesclagem.</span><span class="sxs-lookup"><span data-stu-id="42fda-184">**Other Tables**: Other tables can be present on either hello source or hello target of a split and merge operation.</span></span> <span data-ttu-id="42fda-185">serviço de divisão mesclagem Olá ignora essas tabelas para qualquer movimentação de dados ou operações de cópia.</span><span class="sxs-lookup"><span data-stu-id="42fda-185">hello split-merge service disregards these tables for any data movement or copy operations.</span></span> <span data-ttu-id="42fda-186">No entanto, observe que elas podem interferir com essas operações no caso de restrições.</span><span class="sxs-lookup"><span data-stu-id="42fda-186">Note, however, that they can interfere with these operations in case of constraints.</span></span>

<span data-ttu-id="42fda-187">informações de saudação em referência versus tabelas fragmentadas são fornecidas pelo Olá **SchemaInfo** APIs no mapa do fragmento hello.</span><span class="sxs-lookup"><span data-stu-id="42fda-187">hello information on reference vs. sharded tables is provided by hello **SchemaInfo** APIs on hello shard map.</span></span> <span data-ttu-id="42fda-188">saudação de exemplo a seguir ilustra o uso de saudação dessas APIs em smm de objeto um fragmento determinado mapa manager:</span><span class="sxs-lookup"><span data-stu-id="42fda-188">hello following example illustrates hello use of these APIs on a given shard map manager object smm:</span></span> 

    // Create hello schema annotations 
    SchemaInfo schemaInfo = new SchemaInfo(); 

    // Reference tables 
    schemaInfo.Add(new ReferenceTableInfo("dbo", "region")); 
    schemaInfo.Add(new ReferenceTableInfo("dbo", "nation")); 

    // Sharded tables 
    schemaInfo.Add(new ShardedTableInfo("dbo", "customer", "C_CUSTKEY")); 
    schemaInfo.Add(new ShardedTableInfo("dbo", "orders", "O_CUSTKEY")); 

    // Publish 
    smm.GetSchemaInfoCollection().Add(Configuration.ShardMapName, schemaInfo); 

<span data-ttu-id="42fda-189">Olá tabelas 'region' e 'nação' são definidas como tabelas de referência e serão copiados com operações de divisão/mesclagem/mover.</span><span class="sxs-lookup"><span data-stu-id="42fda-189">hello tables ‘region’ and ‘nation’ are defined as reference tables and will be copied with split/merge/move operations.</span></span> <span data-ttu-id="42fda-190">Já “customer” e “order” por sua vez são definidos como tabelas fragmentadas.</span><span class="sxs-lookup"><span data-stu-id="42fda-190">‘customer’ and ‘orders’ in turn are defined as sharded tables.</span></span> <span data-ttu-id="42fda-191">C_CUSTKEY e O_CUSTKEY servem como chave de fragmentação hello.</span><span class="sxs-lookup"><span data-stu-id="42fda-191">C_CUSTKEY and O_CUSTKEY serve as hello sharding key.</span></span> 

<span data-ttu-id="42fda-192">**Integridade referencial**</span><span class="sxs-lookup"><span data-stu-id="42fda-192">**Referential Integrity**</span></span>

<span data-ttu-id="42fda-193">serviço de divisão mesclagem Olá analisa dependências entre as tabelas e usa relações de chave estrangeira de chave primária toostage Olá operações para mover as tabelas de referência e shardlets.</span><span class="sxs-lookup"><span data-stu-id="42fda-193">hello split-merge service analyzes dependencies between tables and uses foreign key-primary key relationships toostage hello operations for moving reference tables and shardlets.</span></span> <span data-ttu-id="42fda-194">Em geral, as tabelas de referência são copiadas primeiro em ordem de dependência, os shardlets são então copiados na ordem de suas dependências em cada lote.</span><span class="sxs-lookup"><span data-stu-id="42fda-194">In general, reference tables are copied first in dependency order, then shardlets are copied in order of their dependencies within each batch.</span></span> <span data-ttu-id="42fda-195">Isso é necessário para que as restrições de FK PK no fragmento de destino Olá são cumpridas Olá novos dados chegam.</span><span class="sxs-lookup"><span data-stu-id="42fda-195">This is necessary so that FK-PK constraints on hello target shard are honored as hello new data arrives.</span></span> 

<span data-ttu-id="42fda-196">**Consistência de mapa de fragmentos e eventual conclusão**</span><span class="sxs-lookup"><span data-stu-id="42fda-196">**Shard Map Consistency and Eventual Completion**</span></span>

<span data-ttu-id="42fda-197">Na presença de saudação de falhas, o serviço de divisão mesclagem de saudação retoma operações após qualquer interrupção e visa toocomplete qualquer em solicitações de andamento.</span><span class="sxs-lookup"><span data-stu-id="42fda-197">In hello presence of failures, hello split-merge service resumes operations after any outage and aims toocomplete any in progress requests.</span></span> <span data-ttu-id="42fda-198">No entanto, pode haver situações irrecuperáveis, por exemplo, quando o fragmento de destino Olá for perdido ou comprometido reparos.</span><span class="sxs-lookup"><span data-stu-id="42fda-198">However, there may be unrecoverable situations, e.g., when hello target shard is lost or compromised beyond repair.</span></span> <span data-ttu-id="42fda-199">Sob essas circunstâncias, alguns shardlets que deveria toobe movido pode continuar tooreside no fragmento de código-fonte hello.</span><span class="sxs-lookup"><span data-stu-id="42fda-199">Under those circumstances, some shardlets that were supposed toobe moved may continue tooreside on hello source shard.</span></span> <span data-ttu-id="42fda-200">serviço de Olá garante que mapeamentos de shardlet são atualizados somente depois que os dados necessários Olá foi destino toohello foram copiados com êxito.</span><span class="sxs-lookup"><span data-stu-id="42fda-200">hello service ensures that shardlet mappings are only updated after hello necessary data has been successfully copied toohello target.</span></span> <span data-ttu-id="42fda-201">Shardlets só são excluídos na fonte Olá depois que todos os seus dados foram copiados destino toohello e mapeamentos de saudação correspondentes foram atualizados com êxito.</span><span class="sxs-lookup"><span data-stu-id="42fda-201">Shardlets are only deleted on hello source once all their data has been copied toohello target and hello corresponding mappings have been updated successfully.</span></span> <span data-ttu-id="42fda-202">operação de exclusão de saudação acontece no plano de fundo Olá enquanto Olá intervalo já está on-line no fragmento de destino hello.</span><span class="sxs-lookup"><span data-stu-id="42fda-202">hello deletion operation happens in hello background while hello range is already online on hello target shard.</span></span> <span data-ttu-id="42fda-203">serviço de divisão mesclagem Olá sempre garante correção dos mapeamentos de saudação armazenado no mapa do fragmento hello.</span><span class="sxs-lookup"><span data-stu-id="42fda-203">hello split-merge service always ensures correctness of hello mappings stored in hello shard map.</span></span>

## <a name="hello-split-merge-user-interface"></a><span data-ttu-id="42fda-204">interface do usuário de divisão mesclagem Olá</span><span class="sxs-lookup"><span data-stu-id="42fda-204">hello split-merge user interface</span></span>
<span data-ttu-id="42fda-205">pacote de serviço de divisão mesclagem Olá inclui uma função de trabalho e uma função web.</span><span class="sxs-lookup"><span data-stu-id="42fda-205">hello split-merge service package includes a worker role and a web role.</span></span> <span data-ttu-id="42fda-206">função da web de saudação é solicitações de mesclagem de divisão de toosubmit usado de forma interativa.</span><span class="sxs-lookup"><span data-stu-id="42fda-206">hello web role is used toosubmit split-merge requests in an interactive way.</span></span> <span data-ttu-id="42fda-207">componentes principais do Olá Olá da interface do usuário são os seguintes:</span><span class="sxs-lookup"><span data-stu-id="42fda-207">hello main components of hello user interface are as follows:</span></span>

* <span data-ttu-id="42fda-208">Tipo de operação: o tipo de operação de saudação é um botão de opção que controla o tipo de saudação da operação executada pelo serviço Olá para esta solicitação.</span><span class="sxs-lookup"><span data-stu-id="42fda-208">Operation Type: hello operation type is a radio button that controls hello kind of operation performed by hello service for this request.</span></span> <span data-ttu-id="42fda-209">Você pode escolher entre Olá divisão, mesclar e mover cenários.</span><span class="sxs-lookup"><span data-stu-id="42fda-209">You can choose between hello split, merge and move scenarios.</span></span> <span data-ttu-id="42fda-210">Você também pode cancelar uma operação enviada anteriormente.</span><span class="sxs-lookup"><span data-stu-id="42fda-210">You can also cancel a previously submitted operation.</span></span> <span data-ttu-id="42fda-211">Você pode usar divisão, mesclagem e mover solicitações para mapas de fragmento de intervalo.</span><span class="sxs-lookup"><span data-stu-id="42fda-211">You can use split, merge and move requests for range shard maps.</span></span> <span data-ttu-id="42fda-212">Os mapas de fragmento da lista apenas oferecem suporte para as operações de movimentação.</span><span class="sxs-lookup"><span data-stu-id="42fda-212">List shard maps only support move operations.</span></span>
* <span data-ttu-id="42fda-213">Mapa do fragmento: Olá próxima seção de informações de cobertura de parâmetros de solicitação sobre o mapa do fragmento hello e Olá bancos de dados de seu mapa de fragmento.</span><span class="sxs-lookup"><span data-stu-id="42fda-213">Shard Map: hello next section of request parameters cover information about hello shard map and hello database hosting your shard map.</span></span> <span data-ttu-id="42fda-214">Em particular, você precisa tooprovide Olá nome do servidor de banco de dados SQL do hello e hospedagem Olá shardmap de banco de dados, fragmento de toohello tooconnect credenciais banco de dados do mapa e finalmente Olá nome do mapa do fragmento hello.</span><span class="sxs-lookup"><span data-stu-id="42fda-214">In particular, you need tooprovide hello name of hello Azure SQL Database server and database hosting hello shardmap, credentials tooconnect toohello shard map database, and finally hello name of hello shard map.</span></span> <span data-ttu-id="42fda-215">Atualmente, a operação Olá aceita apenas um único conjunto de credenciais.</span><span class="sxs-lookup"><span data-stu-id="42fda-215">Currently, hello operation only accepts a single set of credentials.</span></span> <span data-ttu-id="42fda-216">Essas credenciais precisam de permissões suficientes toohave tooperform altera o mapa do fragmento toohello, bem como dados de usuário de toohello em fragmentos hello.</span><span class="sxs-lookup"><span data-stu-id="42fda-216">These credentials need toohave sufficient permissions tooperform changes toohello shard map as well as toohello user data on hello shards.</span></span>
* <span data-ttu-id="42fda-217">Intervalo de origem (dividir e mesclar): uma operação de divisão e mesclagem processa um intervalo usando sua chave de baixa e alta.</span><span class="sxs-lookup"><span data-stu-id="42fda-217">Source Range (split and merge): A split and merge operation processes a range using its low and high key.</span></span> <span data-ttu-id="42fda-218">toospecify uma operação com um unbounded valor alto da chave, seleção hello "chave alta é max" caixa de seleção e deixe o campo de chave alta Olá vazio.</span><span class="sxs-lookup"><span data-stu-id="42fda-218">toospecify an operation with an unbounded high key value, check hello “High key is max” check box and leave hello high key field empty.</span></span> <span data-ttu-id="42fda-219">Olá principais valores de intervalo que você especificar fazem não correspondência de tooprecisely necessidade um mapeamento e seus limites em seu mapa de fragmento.</span><span class="sxs-lookup"><span data-stu-id="42fda-219">hello range key values that you specify do not need tooprecisely match a mapping and its boundaries in your shard map.</span></span> <span data-ttu-id="42fda-220">Se você não especificar nenhum limite de intervalo em todos os serviços Olá deduzirá intervalo mais próximo de saudação para você automaticamente.</span><span class="sxs-lookup"><span data-stu-id="42fda-220">If you do not specify any range boundaries at all hello service will infer hello closest range for you automatically.</span></span> <span data-ttu-id="42fda-221">Você pode usar o hello GetMappings.ps1 PowerShell tooretrieve Olá atual os mapeamentos de scripts em um mapa de fragmento especificado.</span><span class="sxs-lookup"><span data-stu-id="42fda-221">You can use hello GetMappings.ps1 PowerShell script tooretrieve hello current mappings in a given shard map.</span></span>
* <span data-ttu-id="42fda-222">Comportamento de origem dividido (split): para operações de divisão, definir intervalo de origem de Olá Olá toosplit ponto.</span><span class="sxs-lookup"><span data-stu-id="42fda-222">Split Source Behavior (split): For split operations, define hello point toosplit hello source range.</span></span> <span data-ttu-id="42fda-223">Para fazer isso, fornecendo a chave de fragmentação Olá onde você deseja Olá dividir toooccur.</span><span class="sxs-lookup"><span data-stu-id="42fda-223">You do this by providing hello sharding key where you want hello split toooccur.</span></span> <span data-ttu-id="42fda-224">Botão de opção usar Olá Especifique se deseja que a parte inferior Olá Olá toomove de intervalo (excluindo Olá dividir chave) ou se você quer Olá parte superior toomove (incluindo a chave de divisão de saudação).</span><span class="sxs-lookup"><span data-stu-id="42fda-224">Use hello radio button specify whether you want hello lower part of hello range (excluding hello split key) toomove, or whether you want hello upper part toomove (including hello split key).</span></span>
* <span data-ttu-id="42fda-225">Fonte de Shardlet (mover): mover operações são diferentes de divisão ou mesclagem operações que não precisam de uma fonte de saudação do intervalo toodescribe.</span><span class="sxs-lookup"><span data-stu-id="42fda-225">Source Shardlet (move): Move operations are different from split or merge operations as they do not require a range toodescribe hello source.</span></span> <span data-ttu-id="42fda-226">Uma fonte para a movimentação simplesmente é identificada pelo valor de chave de fragmentação de saudação que você planeje toomove.</span><span class="sxs-lookup"><span data-stu-id="42fda-226">A source for move is simply identified by hello sharding key value that you plan toomove.</span></span>
* <span data-ttu-id="42fda-227">Fragmento (divisão) de destino: depois que você forneceu informações de saudação na fonte de saudação da sua operação de divisão, será necessário toodefine onde você deseja Olá dados toobe copiados tooby fornecendo hello Azure SQL Db nomes do servidor e banco de dados de destino de saudação.</span><span class="sxs-lookup"><span data-stu-id="42fda-227">Target Shard (split): Once you have provided hello information on hello source of your split operation, you need toodefine where you want hello data toobe copied tooby providing hello Azure SQL Db server and database name for hello target.</span></span>
* <span data-ttu-id="42fda-228">O intervalo de destino (mesclagem): operações de mesclagem mover shardlets tooan existente fragmento.</span><span class="sxs-lookup"><span data-stu-id="42fda-228">Target Range (merge): Merge operations move shardlets tooan existing shard.</span></span> <span data-ttu-id="42fda-229">Identifique o fragmento existente hello, fornecendo os limites de intervalo de saudação do intervalo de saudação existente que você deseja toomerge com.</span><span class="sxs-lookup"><span data-stu-id="42fda-229">You identify hello existing shard by providing hello range boundaries of hello existing range that you want toomerge with.</span></span>
* <span data-ttu-id="42fda-230">Tamanho do lote: controles de tamanho de lote Olá Olá número de shardlets que entra offline por vez durante a movimentação de dados de saudação.</span><span class="sxs-lookup"><span data-stu-id="42fda-230">Batch Size: hello batch size controls hello number of shardlets that will go offline at a time during hello data movement.</span></span> <span data-ttu-id="42fda-231">Isso é um valor inteiro, onde você pode usar valores menores quando são confidenciais toolong períodos de tempo de inatividade para shardlets.</span><span class="sxs-lookup"><span data-stu-id="42fda-231">This is an integer value where you can use smaller values when you are sensitive toolong periods of downtime for shardlets.</span></span> <span data-ttu-id="42fda-232">Valores maiores aumentará o tempo de saudação que um determinado shardlet está offline mas podem melhorar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="42fda-232">Larger values will increase hello time that a given shardlet is offline but may improve performance.</span></span>
* <span data-ttu-id="42fda-233">Id da operação (Cancelar): Se você tiver uma operação em andamento que não é mais necessário, você pode cancelar a operação de saudação fornecendo sua ID de operação neste campo.</span><span class="sxs-lookup"><span data-stu-id="42fda-233">Operation Id (Cancel): If you have an ongoing operation that is no longer needed, you can cancel hello operation by providing its operation ID in this field.</span></span> <span data-ttu-id="42fda-234">Você pode recuperar a ID da operação de saudação da tabela de status de solicitação de saudação (consulte a seção 8.1) ou de saída de hello no navegador da web de saudação onde você enviou a solicitação de saudação.</span><span class="sxs-lookup"><span data-stu-id="42fda-234">You can retrieve hello operation ID from hello request status table (see Section 8.1) or from hello output in hello web browser where you submitted hello request.</span></span>

## <a name="requirements-and-limitations"></a><span data-ttu-id="42fda-235">Requisitos e limitações</span><span class="sxs-lookup"><span data-stu-id="42fda-235">Requirements and Limitations</span></span>
<span data-ttu-id="42fda-236">a implementação atual saudação do serviço de divisão mesclagem Olá é assunto toohello requisitos e limitações a seguir:</span><span class="sxs-lookup"><span data-stu-id="42fda-236">hello current implementation of hello split-merge service is subject toohello following requirements and limitations:</span></span> 

* <span data-ttu-id="42fda-237">fragmentos de saudação necessário tooexist e ser registrados no mapa do fragmento Olá antes de uma operação de mesclagem de divisão nesses fragmentos pode ser executada.</span><span class="sxs-lookup"><span data-stu-id="42fda-237">hello shards need tooexist and be registered in hello shard map before a split-merge operation on these shards can be performed.</span></span> 
* <span data-ttu-id="42fda-238">Olá service não cria tabelas ou quaisquer outros objetos de banco de dados automaticamente como parte de suas operações.</span><span class="sxs-lookup"><span data-stu-id="42fda-238">hello service does not create tables or any other database objects automatically as part of its operations.</span></span> <span data-ttu-id="42fda-239">Isso significa que tabelas de referência e Olá esquema para tabelas fragmentadas todos os necessário tooexist na operação de divisão/mesclagem/mover Olá destino fragmento tooany anterior.</span><span class="sxs-lookup"><span data-stu-id="42fda-239">This means that hello schema for all sharded tables and reference tables need tooexist on hello target shard prior tooany split/merge/move operation.</span></span> <span data-ttu-id="42fda-240">Tabelas fragmentadas em particular são necessário toobe vazio no intervalo de saudação onde novos shardlets são toobe adicionado por uma operação de divisão/mesclagem/mover.</span><span class="sxs-lookup"><span data-stu-id="42fda-240">Sharded tables in particular are required toobe empty in hello range where new shardlets are toobe added by a split/merge/move operation.</span></span> <span data-ttu-id="42fda-241">Caso contrário, a operação de saudação falhará verificação de consistência inicial de saudação no fragmento de destino hello.</span><span class="sxs-lookup"><span data-stu-id="42fda-241">Otherwise, hello operation will fail hello initial consistency check on hello target shard.</span></span> <span data-ttu-id="42fda-242">Também Observe que os dados de referência são copiados somente se a tabela de referência hello está vazia e se não há nenhum consistência garante com operações de gravação simultânea de tooother relação nas tabelas de referência de saudação.</span><span class="sxs-lookup"><span data-stu-id="42fda-242">Also note that reference data is only copied if hello reference table is empty and that there are no consistency guarantees with regard tooother concurrent write operations on hello reference tables.</span></span> <span data-ttu-id="42fda-243">Recomendamos isso: ao executar operações de divisão/mesclagem, nenhuma outra operação de gravação fazer alterações toohello tabelas de referência.</span><span class="sxs-lookup"><span data-stu-id="42fda-243">We recommend this: when running split/merge operations, no other write operations make changes toohello reference tables.</span></span>
* <span data-ttu-id="42fda-244">serviço Olá depende da identidade de linha estabelecida por um índice exclusivo ou chave que inclui o desempenho de tooimprove chave de fragmentação hello e confiabilidade para shardlets grande.</span><span class="sxs-lookup"><span data-stu-id="42fda-244">hello service relies on row identity established by a unique index or key that includes hello sharding key tooimprove performance and reliability for large shardlets.</span></span> <span data-ttu-id="42fda-245">Isso permite que os dados de toomove do serviço de saudação em uma granularidade maior mesmo que apenas Olá fragmentação valor de chave.</span><span class="sxs-lookup"><span data-stu-id="42fda-245">This allows hello service toomove data at an even finer granularity than just hello sharding key value.</span></span> <span data-ttu-id="42fda-246">Isso ajuda a tooreduce Olá máximo de espaço de log e bloqueios são necessários durante a operação de saudação.</span><span class="sxs-lookup"><span data-stu-id="42fda-246">This helps tooreduce hello maximum amount of log space and locks that are required during hello operation.</span></span> <span data-ttu-id="42fda-247">Considere criar um índice exclusivo ou uma chave primária, incluindo a chave de fragmentação de saudação em uma determinada tabela se você quiser toouse essa tabela com solicitações de divisão/mesclagem/mover.</span><span class="sxs-lookup"><span data-stu-id="42fda-247">Consider creating a unique index or a primary key including hello sharding key on a given table if you want toouse that table with split/merge/move requests.</span></span> <span data-ttu-id="42fda-248">Por motivos de desempenho, chave de fragmentação Olá deve ser a coluna à esquerda Olá na chave de saudação ou o índice de saudação.</span><span class="sxs-lookup"><span data-stu-id="42fda-248">For performance reasons, hello sharding key should be hello leading column in hello key or hello index.</span></span>
* <span data-ttu-id="42fda-249">Durante saudação de processamento de solicitação, alguns dados de shardlet podem estar presentes na origem hello e fragmentos de destino hello.</span><span class="sxs-lookup"><span data-stu-id="42fda-249">During hello course of request processing, some shardlet data may be present both on hello source and hello target shard.</span></span> <span data-ttu-id="42fda-250">Isso é necessário tooprotect contra falhas durante o movimento de shardlet hello.</span><span class="sxs-lookup"><span data-stu-id="42fda-250">This is necessary tooprotect against failures during hello shardlet movement.</span></span> <span data-ttu-id="42fda-251">Olá integração da divisão direta com o mapa do fragmento Olá garante que conexões usando Olá dados dependentes roteamento APIs Olá **OpenConnectionForKey** método no mapa do fragmento Olá não vir todos os estados intermediários inconsistente.</span><span class="sxs-lookup"><span data-stu-id="42fda-251">hello integration of split-merge with hello shard map ensures that connections through hello data dependent routing APIs using hello **OpenConnectionForKey** method on hello shard map do not see any inconsistent intermediate states.</span></span> <span data-ttu-id="42fda-252">No entanto, quando conexão de fonte de toohello ou hello destino fragmentos sem usar Olá **OpenConnectionForKey** método, estados intermediários inconsistentes podem estar visíveis quando as solicitações de divisão/mesclagem/mover estão acontecendo.</span><span class="sxs-lookup"><span data-stu-id="42fda-252">However, when connecting toohello source or hello target shards without using hello **OpenConnectionForKey** method, inconsistent intermediate states might be visible when split/merge/move requests are going on.</span></span> <span data-ttu-id="42fda-253">Essas conexões podem mostrar resultados parciais ou duplicados dependendo do tempo de saudação ou conexão de subjacente Olá Olá fragmento.</span><span class="sxs-lookup"><span data-stu-id="42fda-253">These connections may show partial or duplicate results depending on hello timing or hello shard underlying hello connection.</span></span> <span data-ttu-id="42fda-254">Essa limitação inclui atualmente conexões Olá feitas pelo Multi-Shard de escala elástica-consultas.</span><span class="sxs-lookup"><span data-stu-id="42fda-254">This limitation currently includes hello connections made by Elastic Scale Multi-Shard-Queries.</span></span>
* <span data-ttu-id="42fda-255">banco de dados de metadados de saudação para o serviço de divisão mesclagem Olá não deve ser compartilhado entre diferentes funções.</span><span class="sxs-lookup"><span data-stu-id="42fda-255">hello metadata database for hello split-merge service must not be shared between different roles.</span></span> <span data-ttu-id="42fda-256">Por exemplo, uma função do serviço de divisão mesclagem Olá em execução no banco de dados do necessidades toopoint tooa diferentes metadados de função de produção de hello de preparo.</span><span class="sxs-lookup"><span data-stu-id="42fda-256">For example, a role of hello split-merge service running in staging needs toopoint tooa different metadata database than hello production role.</span></span>

## <a name="billing"></a><span data-ttu-id="42fda-257">Cobrança</span><span class="sxs-lookup"><span data-stu-id="42fda-257">Billing</span></span>
<span data-ttu-id="42fda-258">serviço de divisão mesclagem Olá é executado como um serviço de nuvem em sua assinatura do Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="42fda-258">hello split-merge service runs as a cloud service in your Microsoft Azure subscription.</span></span> <span data-ttu-id="42fda-259">Portanto encargos para serviços de nuvem se aplicam a tooyour instância do serviço de saudação.</span><span class="sxs-lookup"><span data-stu-id="42fda-259">Therefore charges for cloud services apply tooyour instance of hello service.</span></span> <span data-ttu-id="42fda-260">A menos que você execute operações de divisão/mesclagem/movimentação com frequência, recomendamos que você exclua seu serviço de nuvem de divisão/mesclagem.</span><span class="sxs-lookup"><span data-stu-id="42fda-260">Unless you frequently perform split/merge/move operations, we recommend you delete your split-merge cloud service.</span></span> <span data-ttu-id="42fda-261">Isso reduz os custos de execução ou de instâncias de serviço de nuvem implantadas.</span><span class="sxs-lookup"><span data-stu-id="42fda-261">That saves costs for running or deployed cloud service instances.</span></span> <span data-ttu-id="42fda-262">Você pode implantar novamente e iniciar a configuração de prontamente executável sempre que for necessário tooperform dividir ou mesclar as operações.</span><span class="sxs-lookup"><span data-stu-id="42fda-262">You can re-deploy and start your readily runnable configuration whenever you need tooperform split or merge operations.</span></span> 

## <a name="monitoring"></a><span data-ttu-id="42fda-263">Monitoramento</span><span class="sxs-lookup"><span data-stu-id="42fda-263">Monitoring</span></span>
### <a name="status-tables"></a><span data-ttu-id="42fda-264">Tabelas de status</span><span class="sxs-lookup"><span data-stu-id="42fda-264">Status tables</span></span>
<span data-ttu-id="42fda-265">Serviço de divisão mesclagem Hello fornece Olá **RequestStatus** tabela no banco de dados do repositório de metadados de saudação para o monitoramento de solicitações em andamento e concluídas.</span><span class="sxs-lookup"><span data-stu-id="42fda-265">hello split-merge Service provides hello **RequestStatus** table in hello metadata store database for monitoring of completed and ongoing requests.</span></span> <span data-ttu-id="42fda-266">tabela de saudação lista uma linha para cada solicitação de mesclagem de divisão que tenha sido enviado toothis instância do serviço de divisão mesclagem hello.</span><span class="sxs-lookup"><span data-stu-id="42fda-266">hello table lists a row for each split-merge request that has been submitted toothis instance of hello split-merge service.</span></span> <span data-ttu-id="42fda-267">Ele oferece Olá informações para cada solicitação a seguir:</span><span class="sxs-lookup"><span data-stu-id="42fda-267">It gives hello following information for each request:</span></span>

* <span data-ttu-id="42fda-268">**Carimbo de hora**: Olá hora e data em que a solicitação de saudação foi iniciada.</span><span class="sxs-lookup"><span data-stu-id="42fda-268">**Timestamp**: hello time and date when hello request was started.</span></span>
* <span data-ttu-id="42fda-269">**ID da operação**: um GUID que identifica exclusivamente a solicitação de saudação.</span><span class="sxs-lookup"><span data-stu-id="42fda-269">**OperationId**: A GUID that uniquely identifies hello request.</span></span> <span data-ttu-id="42fda-270">Essa solicitação também pode ser usado toocancel Olá operação enquanto ele está ainda em andamento.</span><span class="sxs-lookup"><span data-stu-id="42fda-270">This request can also be used toocancel hello operation while it is still ongoing.</span></span>
* <span data-ttu-id="42fda-271">**Status**: Olá o estado atual da solicitação de saudação.</span><span class="sxs-lookup"><span data-stu-id="42fda-271">**Status**: hello current state of hello request.</span></span> <span data-ttu-id="42fda-272">Para solicitações em andamento, ela também lista Olá fase atual no qual Olá solicitação é.</span><span class="sxs-lookup"><span data-stu-id="42fda-272">For ongoing requests, it also lists hello current phase in which hello request is.</span></span>
* <span data-ttu-id="42fda-273">**CancelRequest**: um sinalizador que indica se a solicitação de saudação foi cancelada.</span><span class="sxs-lookup"><span data-stu-id="42fda-273">**CancelRequest**: A flag that indicates whether hello request has been cancelled.</span></span>
* <span data-ttu-id="42fda-274">**Andamento**: uma estimativa da porcentagem de conclusão de operação de saudação.</span><span class="sxs-lookup"><span data-stu-id="42fda-274">**Progress**: A percentage estimate of completion for hello operation.</span></span> <span data-ttu-id="42fda-275">Um valor de 50 indica que a operação de saudação é aproximadamente 50% concluída.</span><span class="sxs-lookup"><span data-stu-id="42fda-275">A value of 50 indicates that hello operation is approximately 50% complete.</span></span>
* <span data-ttu-id="42fda-276">**Detalhes**: um valor XML que fornece um relatório de andamento mais detalhado.</span><span class="sxs-lookup"><span data-stu-id="42fda-276">**Details**: An XML value that provides a more detailed progress report.</span></span> <span data-ttu-id="42fda-277">relatório de andamento de saudação é atualizado periodicamente como conjuntos de linhas são copiados da origem tootarget.</span><span class="sxs-lookup"><span data-stu-id="42fda-277">hello progress report is periodically updated as sets of rows are copied from source tootarget.</span></span> <span data-ttu-id="42fda-278">No caso de falhas ou exceções, essa coluna também inclui informações mais detalhadas sobre a falha de saudação.</span><span class="sxs-lookup"><span data-stu-id="42fda-278">In case of failures or exceptions, this column also includes more detailed information about hello failure.</span></span>

### <a name="azure-diagnostics"></a><span data-ttu-id="42fda-279">Diagnóstico do Azure</span><span class="sxs-lookup"><span data-stu-id="42fda-279">Azure Diagnostics</span></span>
<span data-ttu-id="42fda-280">serviço de divisão mesclagem Olá usa o diagnóstico do Azure com base no Azure SDK 2.5 para monitoramento e diagnóstico.</span><span class="sxs-lookup"><span data-stu-id="42fda-280">hello split-merge service uses Azure Diagnostics based on Azure SDK 2.5 for monitoring and diagnostics.</span></span> <span data-ttu-id="42fda-281">Você controla a configuração de diagnóstico de saudação conforme explicado aqui: [habilitando o diagnóstico nos serviços de nuvem do Azure e máquinas virtuais](../cloud-services/cloud-services-dotnet-diagnostics.md).</span><span class="sxs-lookup"><span data-stu-id="42fda-281">You control hello diagnostics configuration as explained here: [Enabling Diagnostics in Azure Cloud Services and Virtual Machines](../cloud-services/cloud-services-dotnet-diagnostics.md).</span></span> <span data-ttu-id="42fda-282">Olá, pacote de download inclui duas configurações de diagnóstico - um para função de web hello e outro para função de trabalho de saudação.</span><span class="sxs-lookup"><span data-stu-id="42fda-282">hello download package includes two diagnostics configurations - one for hello web role and one for hello worker role.</span></span> <span data-ttu-id="42fda-283">Essas configurações de diagnóstico para serviço hello, siga as diretrizes de saudação do [conceitos fundamentais do serviço de nuvem no Microsoft Azure](https://code.msdn.microsoft.com/windowsazure/Cloud-Service-Fundamentals-4ca72649).</span><span class="sxs-lookup"><span data-stu-id="42fda-283">These diagnostics configurations for hello service follow hello guidance from [Cloud Service Fundamentals in Microsoft Azure](https://code.msdn.microsoft.com/windowsazure/Cloud-Service-Fundamentals-4ca72649).</span></span> <span data-ttu-id="42fda-284">Ele inclui Olá definições toolog contadores de desempenho, logs do IIS, Logs de eventos do Windows e logs de eventos do aplicativo de divisão de mesclagem.</span><span class="sxs-lookup"><span data-stu-id="42fda-284">It includes hello definitions toolog Performance Counters, IIS logs, Windows Event Logs, and split-merge application event logs.</span></span> 

## <a name="deploy-diagnostics"></a><span data-ttu-id="42fda-285">Implantar Diagnósticos</span><span class="sxs-lookup"><span data-stu-id="42fda-285">Deploy Diagnostics</span></span>
<span data-ttu-id="42fda-286">tooenable monitoramento e diagnóstico usando a configuração de diagnóstico Olá para funções web e de trabalho Olá fornecidas pelo pacote de NuGet hello, executar Olá comandos usando o Azure PowerShell a seguir:</span><span class="sxs-lookup"><span data-stu-id="42fda-286">tooenable monitoring and diagnostics using hello diagnostic configuration for hello web and worker roles provided by hello NuGet package, run hello following commands using Azure PowerShell:</span></span> 

    $storage_name = "<YourAzureStorageAccount>" 

    $key = "<YourAzureStorageAccountKey" 

    $storageContext = New-AzureStorageContext -StorageAccountName $storage_name -StorageAccountKey $key  


    $config_path = "<YourFilePath>\SplitMergeWebContent.diagnostics.xml" 

    $service_name = "<YourCloudServiceName>" 

    Set-AzureServiceDiagnosticsExtension -StorageContext $storageContext -DiagnosticsConfigurationPath $config_path -ServiceName $service_name -Slot Production -Role "SplitMergeWeb" 


    $config_path = "<YourFilePath>\SplitMergeWorkerContent.diagnostics.xml" 

    $service_name = "<YourCloudServiceName>" 

    Set-AzureServiceDiagnosticsExtension -StorageContext $storageContext -DiagnosticsConfigurationPath $config_path -ServiceName $service_name -Slot Production -Role "SplitMergeWorker" 

<span data-ttu-id="42fda-287">Você pode encontrar mais informações sobre como tooconfigure e implantar as configurações de diagnóstico aqui: [habilitando o diagnóstico nos serviços de nuvem do Azure e máquinas virtuais](../cloud-services/cloud-services-dotnet-diagnostics.md).</span><span class="sxs-lookup"><span data-stu-id="42fda-287">You can find more information on how tooconfigure and deploy diagnostics settings here: [Enabling Diagnostics in Azure Cloud Services and Virtual Machines](../cloud-services/cloud-services-dotnet-diagnostics.md).</span></span> 

## <a name="retrieve-diagnostics"></a><span data-ttu-id="42fda-288">Recuperar diagnósticos</span><span class="sxs-lookup"><span data-stu-id="42fda-288">Retrieve diagnostics</span></span>
<span data-ttu-id="42fda-289">Você pode acessar facilmente os diagnósticos de saudação Visual Studio Server Explorer no hello Azure, parte da árvore do Gerenciador de servidores de saudação.</span><span class="sxs-lookup"><span data-stu-id="42fda-289">You can easily access your diagnostics from hello Visual Studio Server Explorer in hello Azure part of hello Server Explorer tree.</span></span> <span data-ttu-id="42fda-290">Abra uma instância do Visual Studio e, na barra de menus do hello, clique em modo de exibição e o Gerenciador de servidores.</span><span class="sxs-lookup"><span data-stu-id="42fda-290">Open a Visual Studio instance, and in hello menu bar click View, and Server Explorer.</span></span> <span data-ttu-id="42fda-291">Clique em Olá ícone do Azure tooconnect tooyour assinatura do Azure.</span><span class="sxs-lookup"><span data-stu-id="42fda-291">Click hello Azure icon tooconnect tooyour Azure subscription.</span></span> <span data-ttu-id="42fda-292">Em seguida, navegue tooAzure -> armazenamento -> <your storage account> -> tabelas -> WADLogsTable.</span><span class="sxs-lookup"><span data-stu-id="42fda-292">Then navigate tooAzure -> Storage -> <your storage account> -> Tables -> WADLogsTable.</span></span> <span data-ttu-id="42fda-293">Para saber mais, veja [Procurando recursos de armazenamento com o Gerenciador de Servidores](http://msdn.microsoft.com/library/azure/ff683677.aspx).</span><span class="sxs-lookup"><span data-stu-id="42fda-293">For more information, see [Browsing Storage Resources with Server Explorer](http://msdn.microsoft.com/library/azure/ff683677.aspx).</span></span> 

![WADLogsTable][2]

<span data-ttu-id="42fda-295">Olá WADLogsTable realçado na figura acima a saudação contém Olá eventos do log de aplicativo do serviço de divisão mesclagem Olá detalhados.</span><span class="sxs-lookup"><span data-stu-id="42fda-295">hello WADLogsTable highlighted in hello figure above contains hello detailed events from hello split-merge service’s application log.</span></span> <span data-ttu-id="42fda-296">Observe que saudação padrão a configuração de saudação baixada pacote é destinado a uma implantação de produção.</span><span class="sxs-lookup"><span data-stu-id="42fda-296">Note that hello default configuration of hello downloaded package is geared towards a production deployment.</span></span> <span data-ttu-id="42fda-297">Portanto o intervalo de saudação no qual logs e contadores são extraídos de instâncias de serviço Olá é grandes (5 minutos).</span><span class="sxs-lookup"><span data-stu-id="42fda-297">Therefore hello interval at which logs and counters are pulled from hello service instances is large (5 minutes).</span></span> <span data-ttu-id="42fda-298">Para teste e desenvolvimento, precisa de intervalo de saudação mais baixo ajustando as configurações de diagnóstico Olá Olá web ou Olá tooyour de função de trabalho.</span><span class="sxs-lookup"><span data-stu-id="42fda-298">For test and development, lower hello interval by adjusting hello diagnostics settings of hello web or hello worker role tooyour needs.</span></span> <span data-ttu-id="42fda-299">Com o botão direito na função hello em Olá Visual Studio Server Explorer (veja acima) e, em seguida, ajustar Olá período de transferência na caixa de diálogo Olá Olá diagnóstico as definições de configuração:</span><span class="sxs-lookup"><span data-stu-id="42fda-299">Right-click on hello role in hello Visual Studio Server Explorer (see above) and then adjust hello Transfer Period in hello dialog for hello Diagnostics configuration settings:</span></span> 

![Configuração][3]

## <a name="performance"></a><span data-ttu-id="42fda-301">Desempenho</span><span class="sxs-lookup"><span data-stu-id="42fda-301">Performance</span></span>
<span data-ttu-id="42fda-302">Em geral, o melhor desempenho é toobe esperado do hello maior, mais camadas de serviço de alto desempenho no banco de dados do SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="42fda-302">In general, better performance is toobe expected from hello higher, more performant service tiers in Azure SQL Database.</span></span> <span data-ttu-id="42fda-303">Alocações de e/s, CPU e memória maior para níveis de serviço superiores Olá se beneficiar de cópia em massa hello e excluir operações que Olá usa serviço de divisão de mesclagem.</span><span class="sxs-lookup"><span data-stu-id="42fda-303">Higher IO, CPU and memory allocations for hello higher service tiers benefit hello bulk copy and delete operations that hello split-merge service uses.</span></span> <span data-ttu-id="42fda-304">Por esse motivo, aumente a camada de serviço de saudação apenas para os bancos de dados por um período definido, limitado de tempo.</span><span class="sxs-lookup"><span data-stu-id="42fda-304">For that reason, increase hello service tier just for those databases for a defined, limited period of time.</span></span>

<span data-ttu-id="42fda-305">serviço de saudação também executa consultas de validação como parte de suas operações normais.</span><span class="sxs-lookup"><span data-stu-id="42fda-305">hello service also performs validation queries as part of its normal operations.</span></span> <span data-ttu-id="42fda-306">Essas consultas de validação Verificar presença inesperada de dados no intervalo de destino hello e certifique-se de que qualquer operação de divisão/mesclagem/mover começa em um estado consistente.</span><span class="sxs-lookup"><span data-stu-id="42fda-306">These validation queries check for unexpected presence of data in hello target range and ensure that any split/merge/move operation starts from a consistent state.</span></span> <span data-ttu-id="42fda-307">Essas consultas todos trabalha em intervalos de chave de fragmentação definidos por escopo Olá Olá da operação de e tamanho do lote Olá fornecido como parte da definição de solicitação de saudação.</span><span class="sxs-lookup"><span data-stu-id="42fda-307">These queries all work over sharding key ranges defined by hello scope of hello operation and hello batch size provided as part of hello request definition.</span></span> <span data-ttu-id="42fda-308">Essas consultas têm melhor desempenho quando um índice é apresentado com chave de fragmentação Olá Olá coluna à esquerda.</span><span class="sxs-lookup"><span data-stu-id="42fda-308">These queries perform best when an index is present that has hello sharding key as hello leading column.</span></span> 

<span data-ttu-id="42fda-309">Além disso, uma propriedade de exclusividade com chave de fragmentação hello como coluna à esquerda da saudação permitirá Olá serviço toouse uma abordagem otimizada que limita o consumo de recursos em termos de memória e espaço de log.</span><span class="sxs-lookup"><span data-stu-id="42fda-309">In addition, a uniqueness property with hello sharding key as hello leading column will allow hello service toouse an optimized approach that limits resource consumption in terms of log space and memory.</span></span> <span data-ttu-id="42fda-310">Esta propriedade de exclusividade é necessário toomove tamanhos de dados grandes (normalmente acima de 1GB).</span><span class="sxs-lookup"><span data-stu-id="42fda-310">This uniqueness property is required toomove large data sizes (typically above 1GB).</span></span> 

## <a name="how-tooupgrade"></a><span data-ttu-id="42fda-311">Como tooupgrade</span><span class="sxs-lookup"><span data-stu-id="42fda-311">How tooupgrade</span></span>
1. <span data-ttu-id="42fda-312">Siga as etapas de saudação em [implantar um serviço de divisão mesclagem](sql-database-elastic-scale-configure-deploy-split-and-merge.md).</span><span class="sxs-lookup"><span data-stu-id="42fda-312">Follow hello steps in [Deploy a split-merge service](sql-database-elastic-scale-configure-deploy-split-and-merge.md).</span></span>
2. <span data-ttu-id="42fda-313">Altere o arquivo de configuração do serviço de nuvem para sua implantação de divisão mesclagem tooreflect Olá novos parâmetros de configuração.</span><span class="sxs-lookup"><span data-stu-id="42fda-313">Change your cloud service configuration file for your split-merge deployment tooreflect hello new configuration parameters.</span></span> <span data-ttu-id="42fda-314">Um novo parâmetro obrigatório é informações Olá sobre Olá certificado usado para criptografia.</span><span class="sxs-lookup"><span data-stu-id="42fda-314">A new required parameter is hello information about hello certificate used for encryption.</span></span> <span data-ttu-id="42fda-315">Uma maneira fácil toodo trata toocompare Olá novo modelo arquivo de configuração de download de saudação em relação a sua configuração existente.</span><span class="sxs-lookup"><span data-stu-id="42fda-315">An easy way toodo this is toocompare hello new configuration template file from hello download against your existing configuration.</span></span> <span data-ttu-id="42fda-316">Certifique-se de que adicionar configurações hello "DataEncryptionPrimaryCertificateThumbprint" e "DataEncryptionPrimary" de Olá web e função de trabalho hello.</span><span class="sxs-lookup"><span data-stu-id="42fda-316">Make sure you add hello settings for “DataEncryptionPrimaryCertificateThumbprint” and “DataEncryptionPrimary” for both hello web and hello worker role.</span></span>
3. <span data-ttu-id="42fda-317">Antes de implantar Olá tooAzure de atualização, certifique-se de que todas as operações de mesclagem em execução no momento divisão terminar.</span><span class="sxs-lookup"><span data-stu-id="42fda-317">Before deploying hello update tooAzure, ensure that all currently running split-merge operations have finished.</span></span> <span data-ttu-id="42fda-318">Você pode fazer isso facilmente consultando tabelas RequestStatus e PendingWorkflows Olá Olá banco de dados de metadados de mesclagem de divisão para solicitações em andamento.</span><span class="sxs-lookup"><span data-stu-id="42fda-318">You can easily do this by querying hello RequestStatus and PendingWorkflows tables in hello split-merge metadata database for ongoing requests.</span></span>
4. <span data-ttu-id="42fda-319">Atualize a implantação do serviço de nuvem existente para mesclagem de divisão em sua assinatura do Azure com o novo pacote de saudação e seu arquivo de configuração de serviço atualizado.</span><span class="sxs-lookup"><span data-stu-id="42fda-319">Update your existing cloud service deployment for split-merge in your Azure subscription with hello new package and your updated service configuration file.</span></span>

<span data-ttu-id="42fda-320">Você não precisa tooprovision um novo banco de dados de metadados para tooupgrade de divisão de mesclagem.</span><span class="sxs-lookup"><span data-stu-id="42fda-320">You do not need tooprovision a new metadata database for split-merge tooupgrade.</span></span> <span data-ttu-id="42fda-321">nova versão de Hello atualizará automaticamente a existente metadados banco de dados toohello nova versão.</span><span class="sxs-lookup"><span data-stu-id="42fda-321">hello new version will automatically upgrade your existing metadata database toohello new version.</span></span> 

## <a name="best-practices--troubleshooting"></a><span data-ttu-id="42fda-322">Práticas recomendadas e solução de problemas</span><span class="sxs-lookup"><span data-stu-id="42fda-322">Best practices & troubleshooting</span></span>
* <span data-ttu-id="42fda-323">Definir um locatário de teste e use as operações de divisão/mesclagem/mover mais importantes com locatário de teste de saudação em vários fragmentos.</span><span class="sxs-lookup"><span data-stu-id="42fda-323">Define a test tenant and exercise your most important split/merge/move operations with hello test tenant across several shards.</span></span> <span data-ttu-id="42fda-324">Certifique-se de que todos os metadados está definido corretamente em seu mapa de fragmento e operações de saudação não violam restrições ou chaves estrangeiras.</span><span class="sxs-lookup"><span data-stu-id="42fda-324">Ensure that all metadata is defined correctly in your shard map and that hello operations do not violate constraints or foreign keys.</span></span>
* <span data-ttu-id="42fda-325">Tamanho dos dados manter Olá teste locatário acima Olá tamanho máximo de dados do seu locatário maior tooensure tamanho dos dados não estiver encontrando problemas relacionados.</span><span class="sxs-lookup"><span data-stu-id="42fda-325">Keep hello test tenant data size above hello maximum data size of your largest tenant tooensure you are not encountering data size related issues.</span></span> <span data-ttu-id="42fda-326">Isso ajuda você a avaliar um limite superior em Olá tempo toomove um único locatário ao redor.</span><span class="sxs-lookup"><span data-stu-id="42fda-326">This helps you assess an upper bound on hello time it takes toomove a single tenant around.</span></span> 
* <span data-ttu-id="42fda-327">Certifique-se de que seu esquema permita exclusões.</span><span class="sxs-lookup"><span data-stu-id="42fda-327">Make sure that your schema allows deletions.</span></span> <span data-ttu-id="42fda-328">serviço de divisão mesclagem Olá requer que Olá capacidade tooremove dados de fragmento de código-fonte hello quando dados saudação tem sido o destino toohello foram copiados com êxito.</span><span class="sxs-lookup"><span data-stu-id="42fda-328">hello split-merge service requires hello ability tooremove data from hello source shard once hello data has been successfully copied toohello target.</span></span> <span data-ttu-id="42fda-329">Por exemplo, **gatilho delete** pode impedir que o serviço de saudação excluindo Olá dados na fonte de saudação e pode causar toofail de operações.</span><span class="sxs-lookup"><span data-stu-id="42fda-329">For example, **delete triggers** can prevent hello service from deleting hello data on hello source and may cause operations toofail.</span></span>
* <span data-ttu-id="42fda-330">chave de fragmentação Olá deve ser coluna à esquerda da saudação em sua chave primária ou a definição de índice exclusivo.</span><span class="sxs-lookup"><span data-stu-id="42fda-330">hello sharding key should be hello leading column in your primary key or unique index definition.</span></span> <span data-ttu-id="42fda-331">Que garante o melhor desempenho Olá Olá consultas de validação de divisão ou mesclagem e Olá dados reais a movimentação e a exclusão operações que sempre operam em intervalos de chave de fragmentação.</span><span class="sxs-lookup"><span data-stu-id="42fda-331">That ensures hello best performance for hello split or merge validation queries, and for hello actual data movement and deletion operations which always operate on sharding key ranges.</span></span>
* <span data-ttu-id="42fda-332">Colocar seu serviço de divisão de mesclagem no Centro de dados e de região de saudação onde residem os bancos de dados.</span><span class="sxs-lookup"><span data-stu-id="42fda-332">Collocate your split-merge service in hello region and data center where your databases reside.</span></span> 

[!INCLUDE [elastic-scale-include](../../includes/elastic-scale-include.md)]

<!--Anchors-->
<!--Image references-->
[1]:./media/sql-database-elastic-scale-overview-split-and-merge/split-merge-overview.png
[2]:./media/sql-database-elastic-scale-overview-split-and-merge/diagnostics.png
[3]:./media/sql-database-elastic-scale-overview-split-and-merge/diagnostics-config.png

