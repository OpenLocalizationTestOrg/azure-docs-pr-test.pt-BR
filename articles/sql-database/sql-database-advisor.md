---
title: "recomendações de aaaPerformance - banco de dados do SQL Azure | Microsoft Docs"
description: "Olá banco de dados do SQL Azure fornece recomendações para bancos de dados SQL que pode melhorar o desempenho da consulta atual."
services: sql-database
documentationcenter: 
author: stevestein
manager: jhubbard
editor: monicar
ms.assetid: 1db441ff-58f5-45da-8d38-b54dc2aa6145
ms.service: sql-database
ms.custom: monitor & tune
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-management
ms.date: 07/05/2017
ms.author: sstein
ms.openlocfilehash: 77db338a0a395aec78c9e02849ae5ba4f2d01680
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="performance-recommendations"></a><span data-ttu-id="a2296-103">Recomendações do desempenho</span><span class="sxs-lookup"><span data-stu-id="a2296-103">Performance recommendations</span></span>

<span data-ttu-id="a2296-104">Banco de dados do SQL Azure aprende e se adapta ao seu aplicativo e fornece recomendações personalizadas, permitindo que você toomaximize desempenho de saudação de bancos de dados SQL.</span><span class="sxs-lookup"><span data-stu-id="a2296-104">Azure SQL Database learns and adapts with your application and provides customized recommendations enabling you toomaximize hello performance of your SQL databases.</span></span> <span data-ttu-id="a2296-105">O desempenho é avaliado continuamente analisando seu histórico de uso do Banco de Dados SQL.</span><span class="sxs-lookup"><span data-stu-id="a2296-105">Your performance is continuously assessed by analyzing your SQL Database usage history.</span></span> <span data-ttu-id="a2296-106">recomendações de saudação fornecidos baseiam-se em um padrão de carga de trabalho exclusivo do banco de dados e ajudam a melhorar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="a2296-106">hello recommendations that are provided are based on a database unique workload pattern and help improve its performance.</span></span>

> [!NOTE]
> <span data-ttu-id="a2296-107">A maneira recomendada de usar as recomendações é habilitar o 'Ajuste automático' no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="a2296-107">Recommended way of using recommendations is by enabling ‘Automatic tuning’ on your database.</span></span> <span data-ttu-id="a2296-108">Para obter detalhes, confira [Ajuste automático](sql-database-automatic-tuning.md).</span><span class="sxs-lookup"><span data-stu-id="a2296-108">For details, see [Automatic tuning](sql-database-automatic-tuning.md).</span></span>
>

## <a name="create-index-recommendations"></a><span data-ttu-id="a2296-109">Criar recomendações de índice</span><span class="sxs-lookup"><span data-stu-id="a2296-109">Create index recommendations</span></span>
<span data-ttu-id="a2296-110">Banco de dados SQL do Azure monitora consultas hello está sendo executadas continuamente e identifica os índices de saudação que podem melhorar o desempenho de saudação.</span><span class="sxs-lookup"><span data-stu-id="a2296-110">Azure SQL Database continuously monitors hello queries being executed and identifies hello indexes that could improve hello performance.</span></span> <span data-ttu-id="a2296-111">Após haver certeza suficiente de que determinado índice está ausente, uma nova recomendação **Criar índice** será criada.</span><span class="sxs-lookup"><span data-stu-id="a2296-111">Once enough confidence is built that a certain index is missing, a new **Create index** recommendation will be created.</span></span> <span data-ttu-id="a2296-112">Confiança de compilações de banco de dados SQL do Azure, calculando o índice de saudação do ganho de desempenho seria coloque através do tempo.</span><span class="sxs-lookup"><span data-stu-id="a2296-112">Azure SQL Database builds confidence by estimating performance gain hello index would bring through time.</span></span> <span data-ttu-id="a2296-113">Dependendo da saudação estimado de ganho de desempenho, as recomendações são categorizadas como alta, média ou baixa.</span><span class="sxs-lookup"><span data-stu-id="a2296-113">Depending on hello estimated performance gain, recommendations are categorized as High, Medium,  or Low.</span></span> 

<span data-ttu-id="a2296-114">Índices criados usando as recomendações sempre são sinalizados como índices auto_created.</span><span class="sxs-lookup"><span data-stu-id="a2296-114">Indexes created using recommendations are always flagged as auto_created indexes.</span></span> <span data-ttu-id="a2296-115">Você pode ver quais índices são auto_created examinando a exibição sys.indexes.</span><span class="sxs-lookup"><span data-stu-id="a2296-115">You can see which indexes are auto_created by looking at sys.indexes view.</span></span> <span data-ttu-id="a2296-116">Índices criados automaticamente não bloqueiam os comandos ALTER/RENAME.</span><span class="sxs-lookup"><span data-stu-id="a2296-116">Auto created indexes don’t block ALTER/RENAME commands.</span></span> <span data-ttu-id="a2296-117">Se você tentar toodrop coluna de saudação um automático que criou o índice por ele, Olá comando passa e automática Olá criada o índice é descartada com o comando Olá também.</span><span class="sxs-lookup"><span data-stu-id="a2296-117">If you try toodrop hello column that has an auto created index over it, hello command passes and hello auto created index is dropped with hello command as well.</span></span> <span data-ttu-id="a2296-118">Índices regulares bloquearia comando de alterar/RENOMEAR Olá em colunas que são indexados.</span><span class="sxs-lookup"><span data-stu-id="a2296-118">Regular indexes would block hello ALTER/RENAME command on columns that are indexed.</span></span>

<span data-ttu-id="a2296-119">Depois que criar hello recomendação de índice é aplicada, banco de dados do SQL Azure irá comparar o desempenho das consultas de saudação com desempenho de linha de base de saudação.</span><span class="sxs-lookup"><span data-stu-id="a2296-119">Once hello create index recommendation is applied, Azure SQL Database will compare performance of hello queries with hello baseline performance.</span></span> <span data-ttu-id="a2296-120">Se o novo índice colocado melhorias no desempenho hello, recomendação será sinalizada como bem-sucedida e relatório de impacto estarão disponível.</span><span class="sxs-lookup"><span data-stu-id="a2296-120">If new index brought improvements in hello performance, recommendation will be flagged as successful and impact report will be available.</span></span> <span data-ttu-id="a2296-121">No caso de índice Olá não trazem benefícios de hello, ele será revertido automaticamente.</span><span class="sxs-lookup"><span data-stu-id="a2296-121">In case hello index didn’t bring hello benefits, it will be automatically reverted.</span></span> <span data-ttu-id="a2296-122">Dessa forma, o banco de dados do Azure SQL garante que o uso de recomendações, apenas melhorar o desempenho de banco de dados de saudação.</span><span class="sxs-lookup"><span data-stu-id="a2296-122">This way Azure SQL Database ensures that using recommendations will only improve hello database performance.</span></span>

<span data-ttu-id="a2296-123">Qualquer **criar índice** recomendação tem uma política que não permite a aplicação de recomendação de saudação se o uso de DTU banco de dados ou o pool Olá estava acima de 80% em últimos 20 minutos ou se o armazenamento de saudação é acima de 90% de uso de retirada.</span><span class="sxs-lookup"><span data-stu-id="a2296-123">Any **Create index** recommendation has a back off policy that won’t allow applying hello recommendation if hello database or pool DTU usage was above 80% in last 20 minutes or if hello storage is above 90% of usage.</span></span> <span data-ttu-id="a2296-124">Nesse caso, recomendação Olá será adiada.</span><span class="sxs-lookup"><span data-stu-id="a2296-124">In this case, hello recommendation will be postponed.</span></span>

## <a name="drop-index-recommendations"></a><span data-ttu-id="a2296-125">Recomendações para Remover Índice</span><span class="sxs-lookup"><span data-stu-id="a2296-125">Drop index recommendations</span></span>
<span data-ttu-id="a2296-126">Além disso toodetecting um índice ausente, o banco de dados SQL continuamente analisa o desempenho de saudação de índices existentes.</span><span class="sxs-lookup"><span data-stu-id="a2296-126">In addition toodetecting a missing index, Azure SQL Database continuously analyzes hello performance of existing indexes.</span></span> <span data-ttu-id="a2296-127">Se o índice não for usado, o banco de dados do SQL Azure recomendará cancelá-lo.</span><span class="sxs-lookup"><span data-stu-id="a2296-127">If index is not used, Azure SQL Database will recommend dropping it.</span></span> <span data-ttu-id="a2296-128">Descartar um índice é recomendado em dois casos:</span><span class="sxs-lookup"><span data-stu-id="a2296-128">Dropping an index is recommended in two cases:</span></span>
* <span data-ttu-id="a2296-129">O índice é uma duplicata de outro índice (mesma coluna indexada e incluída, esquema de partição e filtros)</span><span class="sxs-lookup"><span data-stu-id="a2296-129">Index is a duplicate of another index (same indexed and included column, partition schema, and filters)</span></span>
* <span data-ttu-id="a2296-130">O índice é não utilizado por um período prolongado (93 dias)</span><span class="sxs-lookup"><span data-stu-id="a2296-130">Index is unused for a prolonged period (93 days)</span></span>

<span data-ttu-id="a2296-131">Descarte índice recomendações também passam por verificação de saudação depois da implementação.</span><span class="sxs-lookup"><span data-stu-id="a2296-131">Drop index recommendations also go through hello verification after implementation.</span></span> <span data-ttu-id="a2296-132">Se o hello desempenho é melhorado relatório de impacto de saudação estará disponível.</span><span class="sxs-lookup"><span data-stu-id="a2296-132">If hello performance is improved hello impact report will be available.</span></span> <span data-ttu-id="a2296-133">Caso uma degradação do desempenho seja detectada, a recomendação será revertida.</span><span class="sxs-lookup"><span data-stu-id="a2296-133">In case performance degradation is detected, recommendation will be reverted.</span></span>


## <a name="parameterize-queries-recommendations"></a><span data-ttu-id="a2296-134">Recomendações para parametrizar consultas</span><span class="sxs-lookup"><span data-stu-id="a2296-134">Parameterize queries recommendations</span></span>
<span data-ttu-id="a2296-135">**Parametrizar consultas** recomendações aparecem quando você tiver uma ou mais consultas que estão constantemente sendo recompiladas mas acabam com hello mesmo plano de execução de consulta.</span><span class="sxs-lookup"><span data-stu-id="a2296-135">**Parameterize queries** recommendations appear when you have one or more queries that are constantly being recompiled but end up with hello same query execution plan.</span></span> <span data-ttu-id="a2296-136">Essa condição abre uma tooapply oportunidade forçado parametrização, que permitirá que os planos de consulta toobe armazenado em cache e reutilizado em Olá futuro, melhorando o desempenho e reduzindo o uso de recursos.</span><span class="sxs-lookup"><span data-stu-id="a2296-136">This condition opens up an opportunity tooapply forced parameterization, which will allow query plans toobe cached and reused in hello future improving performance and reducing resource usage.</span></span> 

<span data-ttu-id="a2296-137">Cada consulta emitida para o SQL Server inicialmente precisa toogenerate toobe compilado de um plano de execução.</span><span class="sxs-lookup"><span data-stu-id="a2296-137">Every query issued against SQL Server initially needs toobe compiled toogenerate an execution plan.</span></span> <span data-ttu-id="a2296-138">Cada plano gerado é adicionado toohello cache de plano e as execuções subsequentes da saudação mesma consulta pode reutilizar esse plano do cache hello, eliminando a necessidade de saudação para compilação adicional.</span><span class="sxs-lookup"><span data-stu-id="a2296-138">Each generated plan is added toohello plan cache and subsequent executions of hello same query can reuse this plan from hello cache, eliminating hello need for additional compilation.</span></span> 

<span data-ttu-id="a2296-139">Aplicativos que enviam consultas que incluem valores sem parâmetros, podem levar tooa sobrecarga de desempenho, onde cada tal consulta com valores de parâmetros diferentes Olá execução plano é compilado novamente.</span><span class="sxs-lookup"><span data-stu-id="a2296-139">Applications that send queries, which include non-parameterized values, can lead tooa performance overhead, where for every such query with different parameter values hello execution plan is compiled again.</span></span> <span data-ttu-id="a2296-140">Em muitos Olá de casos mesmo consultas com parâmetros diferentes valores geram Olá mesmo planos de execução, mas esses planos ainda separadamente são adicionados toohello cache de plano.</span><span class="sxs-lookup"><span data-stu-id="a2296-140">In many cases hello same queries with different parameter values generate hello same execution plans, but these plans are still separately added toohello plan cache.</span></span> <span data-ttu-id="a2296-141">Planos de execução de recompilação usar recursos de banco de dados, aumentar Olá duração tempo e estouro Olá plano de consulta cache causando planos toobe removido do cache de saudação.</span><span class="sxs-lookup"><span data-stu-id="a2296-141">Recompiling execution plans use database resources, increase hello query duration time and overflow hello plan cache causing plans toobe evicted from hello cache.</span></span> <span data-ttu-id="a2296-142">Esse comportamento do SQL Server pode ser alterado definindo Olá forçado a opção parameterization no banco de dados de saudação.</span><span class="sxs-lookup"><span data-stu-id="a2296-142">This behavior of SQL Server can be altered by setting hello forced parameterization option on hello database.</span></span> 

<span data-ttu-id="a2296-143">toohelp estimar o impacto de saudação dessa recomendação, são fornecidos com uma comparação entre real de CPU Olá Olá e uso projetado uso da CPU (como se recomendação Olá foi aplicada).</span><span class="sxs-lookup"><span data-stu-id="a2296-143">toohelp you estimate hello impact of this recommendation, you are provided with a comparison between hello actual CPU usage and hello projected CPU usage (as if hello recommendation was applied).</span></span> <span data-ttu-id="a2296-144">Além disso tooCPU economia, a duração da consulta diminui para Olá tempo gasto na compilação.</span><span class="sxs-lookup"><span data-stu-id="a2296-144">In addition tooCPU savings, your query duration decreases for hello time spent in compilation.</span></span> <span data-ttu-id="a2296-145">Também haverá menos sobrecarga no cache de plano, permitindo que a maioria dos Olá toostay no cache de planos e ser reutilizado.</span><span class="sxs-lookup"><span data-stu-id="a2296-145">There will also be much less overhead on plan cache, allowing majority of hello plans toostay in cache and be reused.</span></span> <span data-ttu-id="a2296-146">Você pode aplicar essa recomendação rapidamente e facilmente clicando em Olá **aplicar** comando.</span><span class="sxs-lookup"><span data-stu-id="a2296-146">You can apply this recommendation quickly and easily by clicking on hello **Apply** command.</span></span> 

<span data-ttu-id="a2296-147">Depois que você aplicar essa recomendação, habilitar a parametrização forçada em minutos no banco de dados e começa Olá monitoramento de processo que dura cerca de 24 horas.</span><span class="sxs-lookup"><span data-stu-id="a2296-147">Once you apply this recommendation, it will enable forced parameterization within minutes on your database and it starts hello monitoring process which approximately lasts for 24 hours.</span></span> <span data-ttu-id="a2296-148">Após esse período, você vai ser capaz de toosee Olá validação relatório que mostra o uso da CPU do seu banco de dados 24 horas antes e depois de recomendação Olá foi aplicada.</span><span class="sxs-lookup"><span data-stu-id="a2296-148">After this period, you will be able toosee hello validation report that shows CPU usage of your database 24 hours before and after hello recommendation has been applied.</span></span> <span data-ttu-id="a2296-149">Orientador de banco de dados SQL tem um mecanismo de segurança que é revertida automaticamente recomendação Olá aplicado no caso de uma regressão de desempenho foi detectada.</span><span class="sxs-lookup"><span data-stu-id="a2296-149">SQL Database Advisor has a safety mechanism that automatically reverts hello applied recommendation in case a performance regression has been detected.</span></span>

## <a name="fix-schema-issues-recommendations"></a><span data-ttu-id="a2296-150">Recomendações para corrigir problemas do esquema</span><span class="sxs-lookup"><span data-stu-id="a2296-150">Fix schema issues recommendations</span></span>
<span data-ttu-id="a2296-151">**Corrigir problemas de esquema** recomendações aparecem quando hello serviço de banco de dados SQL observa uma anomalia no número de saudação relacionados ao esquema de erros do SQL está ocorrendo no banco de dados SQL do Azure.</span><span class="sxs-lookup"><span data-stu-id="a2296-151">**Fix schema issues** recommendations appear when hello SQL Database service notices an anomaly in hello number of schema-related SQL errors happening on your Azure SQL Database.</span></span> <span data-ttu-id="a2296-152">Essa recomendação normalmente aparece quando seu banco de dados encontra vários erros relacionados ao esquema (nome da coluna inválido, nome do objeto inválido etc.) no período de uma hora.</span><span class="sxs-lookup"><span data-stu-id="a2296-152">This recommendation typically appears when your database encounters multiple schema-related errors (invalid column name, invalid object name, etc.) within an hour.</span></span>

<span data-ttu-id="a2296-153">"Problemas de esquema" são uma classe de erros de sintaxe no SQL Server que ocorrem quando a definição de saudação de consulta do SQL hello e definição de saudação do esquema de banco de dados de saudação não estão alinhados.</span><span class="sxs-lookup"><span data-stu-id="a2296-153">“Schema issues” are a class of syntax errors in SQL Server that happen when hello definition of hello SQL query and hello definition of hello database schema are not aligned.</span></span> <span data-ttu-id="a2296-154">Por exemplo, uma das colunas Olá esperadas pela consulta Olá poderá faltar na tabela de destino hello, ou vice-versa.</span><span class="sxs-lookup"><span data-stu-id="a2296-154">For example, one of hello columns expected by hello query may be missing in hello target table, or vice versa.</span></span> 

<span data-ttu-id="a2296-155">Recomendação de "Corrigir o problema de esquema" é exibida quando o serviço do Azure SQL Database observa uma anomalia no número de saudação relacionados ao esquema de erros do SQL está ocorrendo no banco de dados SQL do Azure.</span><span class="sxs-lookup"><span data-stu-id="a2296-155">“Fix schema issue” recommendation appears when Azure SQL Database service notices an anomaly in hello number of schema-related SQL errors happening on your Azure SQL Database.</span></span> <span data-ttu-id="a2296-156">Olá tabela mostra Olá erros que são relacionadas tooschema problemas a seguir:</span><span class="sxs-lookup"><span data-stu-id="a2296-156">hello following table shows hello errors that are related tooschema issues:</span></span>

| <span data-ttu-id="a2296-157">Código do Erro SQL</span><span class="sxs-lookup"><span data-stu-id="a2296-157">SQL Error Code</span></span> | <span data-ttu-id="a2296-158">Mensagem</span><span class="sxs-lookup"><span data-stu-id="a2296-158">Message</span></span> |
| --- | --- |
| <span data-ttu-id="a2296-159">201</span><span class="sxs-lookup"><span data-stu-id="a2296-159">201</span></span> |<span data-ttu-id="a2296-160">Procedimento ou função '*' espera o parâmetro '*', que não foi fornecido.</span><span class="sxs-lookup"><span data-stu-id="a2296-160">Procedure or function '*' expects parameter '*', which was not supplied.</span></span> |
| <span data-ttu-id="a2296-161">207</span><span class="sxs-lookup"><span data-stu-id="a2296-161">207</span></span> |<span data-ttu-id="a2296-162">Nome de coluna inválido '*'.</span><span class="sxs-lookup"><span data-stu-id="a2296-162">Invalid column name '*'.</span></span> |
| <span data-ttu-id="a2296-163">208</span><span class="sxs-lookup"><span data-stu-id="a2296-163">208</span></span> |<span data-ttu-id="a2296-164">Nome de objeto inválido '*'.</span><span class="sxs-lookup"><span data-stu-id="a2296-164">Invalid object name '*'.</span></span> |
| <span data-ttu-id="a2296-165">213</span><span class="sxs-lookup"><span data-stu-id="a2296-165">213</span></span> |<span data-ttu-id="a2296-166">O nome da coluna ou o número de valores fornecidos não corresponde à definição da tabela.</span><span class="sxs-lookup"><span data-stu-id="a2296-166">Column name or number of supplied values does not match table definition.</span></span> |
| <span data-ttu-id="a2296-167">2812</span><span class="sxs-lookup"><span data-stu-id="a2296-167">2812</span></span> |<span data-ttu-id="a2296-168">Não foi possível encontrar o procedimento armazenado '*'.</span><span class="sxs-lookup"><span data-stu-id="a2296-168">Could not find stored procedure '*'.</span></span> |
| <span data-ttu-id="a2296-169">8144</span><span class="sxs-lookup"><span data-stu-id="a2296-169">8144</span></span> |<span data-ttu-id="a2296-170">Função ou procedimento * tem muitos argumentos especificados.</span><span class="sxs-lookup"><span data-stu-id="a2296-170">Procedure or function * has too many arguments specified.</span></span> |

## <a name="next-steps"></a><span data-ttu-id="a2296-171">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="a2296-171">Next steps</span></span>
<span data-ttu-id="a2296-172">Monitorar suas recomendações e continuar tooapply-los toorefine desempenho.</span><span class="sxs-lookup"><span data-stu-id="a2296-172">Monitor your recommendations and continue tooapply them toorefine performance.</span></span> <span data-ttu-id="a2296-173">Cargas de trabalho de banco de dados são dinâmicas e mudam continuamente.</span><span class="sxs-lookup"><span data-stu-id="a2296-173">Database workloads are dynamic and change continuously.</span></span> <span data-ttu-id="a2296-174">O Supervisor de banco de dados SQL continua toomonitor e fornecer recomendações potencialmente podem melhorar o desempenho de seu banco de dados.</span><span class="sxs-lookup"><span data-stu-id="a2296-174">SQL Database advisor continues toomonitor and provide recommendations that can potentially improve your database's performance.</span></span> 

* <span data-ttu-id="a2296-175">Consulte [recomendações de desempenho Olá portal do Azure](sql-database-advisor-portal.md) para obter etapas sobre como recomendações de desempenho toouse Olá portal do Azure.</span><span class="sxs-lookup"><span data-stu-id="a2296-175">See [Performance recommendations in hello Azure portal](sql-database-advisor-portal.md) for steps on how toouse performance recommendations in hello Azure portal.</span></span>
* <span data-ttu-id="a2296-176">Consulte [Query Performance Insight](sql-database-query-performance.md) toolearn sobre e exibição Olá impacto no desempenho de suas principais consultas.</span><span class="sxs-lookup"><span data-stu-id="a2296-176">See [Query Performance Insights](sql-database-query-performance.md) toolearn about and view hello performance impact of your top queries.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="a2296-177">Recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="a2296-177">Additional resources</span></span>
* [<span data-ttu-id="a2296-178">Repositório de Consultas</span><span class="sxs-lookup"><span data-stu-id="a2296-178">Query Store</span></span>](https://msdn.microsoft.com/library/dn817826.aspx)
* [<span data-ttu-id="a2296-179">CREATE INDEX</span><span class="sxs-lookup"><span data-stu-id="a2296-179">CREATE INDEX</span></span>](https://msdn.microsoft.com/library/ms188783.aspx)
* [<span data-ttu-id="a2296-180">Controle de acesso baseado em função</span><span class="sxs-lookup"><span data-stu-id="a2296-180">Role-based access control</span></span>](../active-directory/role-based-access-control-what-is.md)

