---
title: "esquema de banco de dados do Azure SQL aaaManage em um aplicativo multilocatário | Microsoft Docs"
description: "Gerenciar o esquema para vários locatários em um aplicativo multilocatário que usa o Banco de Dados SQL do Azure"
keywords: tutorial do banco de dados SQL
services: sql-database
documentationcenter: 
author: stevestein
manager: jhubbard
editor: 
ms.assetid: 
ms.service: sql-database
ms.custom: scale out apps
ms.workload: data-management
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/28/2017
ms.author: billgib; sstein
ms.openlocfilehash: ea946e556808dabd60dd39cb8173d0512d4bddec
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="manage-schema-for-multiple-tenants-in-hello-wingtip-saas-application"></a><span data-ttu-id="a98fa-104">Gerenciar o esquema para vários locatários em Olá aplicativo SaaS Wingtip</span><span class="sxs-lookup"><span data-stu-id="a98fa-104">Manage schema for multiple tenants in hello Wingtip SaaS application</span></span>

<span data-ttu-id="a98fa-105">Olá [primeiro tutorial Wingtip SaaS](sql-database-saas-tutorial.md) mostra como o aplicativo hello pode provisionar um banco de dados de locatário e registrá-lo no catálogo de saudação.</span><span class="sxs-lookup"><span data-stu-id="a98fa-105">hello [first Wingtip SaaS tutorial](sql-database-saas-tutorial.md) shows how hello app can provision a tenant database and register it in hello catalog.</span></span> <span data-ttu-id="a98fa-106">Assim como qualquer aplicativo, Olá aplicativo SaaS Wingtip evoluem ao longo do tempo e às vezes exigirá o banco de dados de toohello alterações.</span><span class="sxs-lookup"><span data-stu-id="a98fa-106">Like any application, hello Wingtip SaaS app will evolve over time, and at times will require changes toohello database.</span></span> <span data-ttu-id="a98fa-107">As alterações podem incluir nova ou alterada de esquema, dados de referência novos ou alterados e desempenho de aplicativo ideal tooensure do tarefas de manutenção de rotina do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="a98fa-107">Changes may include new or changed schema, new or changed reference data, and routine database maintenance tasks tooensure optimal app performance.</span></span> <span data-ttu-id="a98fa-108">Com um aplicativo SaaS, essas alterações necessitam toobe implantado de maneira coordenada em um fleet potencialmente grande de bancos de dados de locatário.</span><span class="sxs-lookup"><span data-stu-id="a98fa-108">With a SaaS application, these changes need toobe deployed in a coordinated manner across a potentially massive fleet of tenant databases.</span></span> <span data-ttu-id="a98fa-109">Para essas alterações toobe no futuro locatário bancos de dados, eles precisam toobe incorporada Olá processo de provisionamento.</span><span class="sxs-lookup"><span data-stu-id="a98fa-109">For these changes toobe in future tenant databases, they need toobe incorporated into hello provisioning process.</span></span>

<span data-ttu-id="a98fa-110">Este tutorial explora dois cenários - implantação de atualizações de dados de referência para todos os locatários, e reajuste um índice em Olá tabela contendo dados de referência de saudação.</span><span class="sxs-lookup"><span data-stu-id="a98fa-110">This tutorial explores two scenarios - deploying reference data updates for all tenants, and retuning an index on hello table containing hello reference data.</span></span> <span data-ttu-id="a98fa-111">Olá [trabalhos Elásticos](sql-database-elastic-jobs-overview.md) recurso é usado tooexecute essas operações em todos os locatários e hello *dourada* banco de dados de locatário que é usado como um modelo para novos bancos de dados.</span><span class="sxs-lookup"><span data-stu-id="a98fa-111">hello [Elastic jobs](sql-database-elastic-jobs-overview.md) feature is used tooexecute these operations across all tenants, and hello *golden* tenant database that is used as a template for new databases.</span></span>

<span data-ttu-id="a98fa-112">Neste tutorial, você aprenderá a:</span><span class="sxs-lookup"><span data-stu-id="a98fa-112">In this tutorial you learn how to:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="a98fa-113">Criar uma conta de trabalho</span><span class="sxs-lookup"><span data-stu-id="a98fa-113">Create a job account</span></span>
> * <span data-ttu-id="a98fa-114">Consultar vários locatários</span><span class="sxs-lookup"><span data-stu-id="a98fa-114">Query across multiple tenants</span></span>
> * <span data-ttu-id="a98fa-115">Atualizar dados em todos os bancos de dados de locatário</span><span class="sxs-lookup"><span data-stu-id="a98fa-115">Update data in all tenant databases</span></span>
> * <span data-ttu-id="a98fa-116">Criar um índice em uma tabela em todos os bancos de dados de locatário</span><span class="sxs-lookup"><span data-stu-id="a98fa-116">Create an index on a table in all tenant databases</span></span>


<span data-ttu-id="a98fa-117">toocomplete neste tutorial, verifique Olá se os pré-requisitos a seguir forem atendidas:</span><span class="sxs-lookup"><span data-stu-id="a98fa-117">toocomplete this tutorial, make sure hello following prerequisites are met:</span></span>

* <span data-ttu-id="a98fa-118">Olá Wingtip SaaS aplicativo é implantado.</span><span class="sxs-lookup"><span data-stu-id="a98fa-118">hello Wingtip SaaS app is deployed.</span></span> <span data-ttu-id="a98fa-119">toodeploy em menos de cinco minutos, consulte [implantar e explorar o aplicativo de SaaS Wingtip hello](sql-database-saas-tutorial.md)</span><span class="sxs-lookup"><span data-stu-id="a98fa-119">toodeploy in less than five minutes, see [Deploy and explore hello Wingtip SaaS application](sql-database-saas-tutorial.md)</span></span>
* <span data-ttu-id="a98fa-120">O Azure PowerShell está instalado.</span><span class="sxs-lookup"><span data-stu-id="a98fa-120">Azure PowerShell is installed.</span></span> <span data-ttu-id="a98fa-121">Para obter detalhes, consulte [Introdução ao Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps)</span><span class="sxs-lookup"><span data-stu-id="a98fa-121">For details, see [Getting started with Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps)</span></span>
* <span data-ttu-id="a98fa-122">versão mais recente de saudação do SQL Server Management Studio (SSMS) está instalado.</span><span class="sxs-lookup"><span data-stu-id="a98fa-122">hello latest version of SQL Server Management Studio (SSMS) is installed.</span></span> [<span data-ttu-id="a98fa-123">Baixar e Instalar o SSMS</span><span class="sxs-lookup"><span data-stu-id="a98fa-123">Download and Install SSMS</span></span>](https://docs.microsoft.com/sql/ssms/download-sql-server-management-studio-ssms)

<span data-ttu-id="a98fa-124">*Este tutorial usa recursos do hello serviço de banco de dados SQL que estão em uma visualização limitada (trabalhos do banco de dados Elástico). Se você quiser toodo neste tutorial, fornecer sua id de assinatura tooSaaSFeedback@microsoft.com com o assunto = Elástico visualização de trabalhos. Depois de receber a confirmação de que sua assinatura tiver sido habilitada, [baixar e instalar cmdlets de pré-lançamento trabalhos mais recentes Olá](https://github.com/jaredmoo/azure-powershell/releases). Esta é uma versão prévia limitada, então contate SaaSFeedback@microsoft.com para conferir perguntas relacionadas ou para obter suporte.*</span><span class="sxs-lookup"><span data-stu-id="a98fa-124">*This tutorial uses features of hello SQL Database service that are in a limited preview (Elastic Database jobs). If you wish toodo this tutorial, provide your subscription id tooSaaSFeedback@microsoft.com with subject=Elastic Jobs Preview. After you receive confirmation that your subscription has been enabled, [download and install hello latest pre-release jobs cmdlets](https://github.com/jaredmoo/azure-powershell/releases). This preview is limited, so contact SaaSFeedback@microsoft.com for related questions or support.*</span></span>


## <a name="introduction-toosaas-schema-management-patterns"></a><span data-ttu-id="a98fa-125">Introdução tooSaaS padrões de gerenciamento de esquema</span><span class="sxs-lookup"><span data-stu-id="a98fa-125">Introduction tooSaaS Schema Management patterns</span></span>

<span data-ttu-id="a98fa-126">Hello único locatário por banco de dados SaaS padrão benefícios em muitas maneiras de isolamento de dados Olá resultante, mas em Olá simultaneamente apresenta complexidade adicional Olá manter e gerenciar vários bancos de dados.</span><span class="sxs-lookup"><span data-stu-id="a98fa-126">hello single tenant per database SaaS pattern benefits in many ways from hello data isolation that results, but at hello same time introduces hello additional complexity of maintaining and managing many databases.</span></span> <span data-ttu-id="a98fa-127">[Trabalhos Elásticos](sql-database-elastic-jobs-overview.md) facilita a administração e gerenciamento da camada de dados do SQL hello.</span><span class="sxs-lookup"><span data-stu-id="a98fa-127">[Elastic Jobs](sql-database-elastic-jobs-overview.md) facilitates administration and management of hello SQL data tier.</span></span> <span data-ttu-id="a98fa-128">Trabalhos permitem que você toosecurely e confiável, execute tarefas (scripts T-SQL) independentes da interação do usuário ou de entrada, em relação a um grupo de bancos de dados.</span><span class="sxs-lookup"><span data-stu-id="a98fa-128">Jobs enable you toosecurely and reliably, run tasks (T-SQL scripts) independent of user interaction or input, against a group of databases.</span></span> <span data-ttu-id="a98fa-129">Esse método pode ser usado toodeploy esquema e alterações de dados de referência comuns em todos os locatários em um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a98fa-129">This method can be used toodeploy schema and common reference data changes across all tenants in an application.</span></span> <span data-ttu-id="a98fa-130">Elásticos trabalhos também podem ser usada toomaintain uma *dourada* cópia do banco de dados de saudação usada toocreate novos locatários, garantindo sempre tem hello mais recentes esquema e dados de referência.</span><span class="sxs-lookup"><span data-stu-id="a98fa-130">Elastic Jobs can also be used toomaintain a *golden* copy of hello database used toocreate new tenants, ensuring it always has hello latest schema and reference data.</span></span>

![tela](media/sql-database-saas-tutorial-schema-management/schema-management.png)


## <a name="elastic-jobs-limited-preview"></a><span data-ttu-id="a98fa-132">Versão prévia limitada dos Trabalhos Elásticos</span><span class="sxs-lookup"><span data-stu-id="a98fa-132">Elastic Jobs limited preview</span></span>

<span data-ttu-id="a98fa-133">Há uma nova versão dos Trabalhos Elásticos, que agora é um recurso integrado do Banco de Dados SQL do Azure (que não requer serviços ou componentes adicionais).</span><span class="sxs-lookup"><span data-stu-id="a98fa-133">There is a new version of Elastic Jobs that is now an integrated feature of Azure SQL Database (that requires no additional services or components).</span></span> <span data-ttu-id="a98fa-134">Essa nova versão dos Trabalhos Elásticos está em versão prévia limitada atualmente.</span><span class="sxs-lookup"><span data-stu-id="a98fa-134">This new version of Elastic Jobs is currently in limited preview.</span></span> <span data-ttu-id="a98fa-135">Essa visualização limitada atualmente oferece suporte a contas de trabalho do PowerShell toocreate e toocreate T-SQL e gerenciar trabalhos.</span><span class="sxs-lookup"><span data-stu-id="a98fa-135">This limited preview currently supports PowerShell toocreate job accounts, and T-SQL toocreate and manage jobs.</span></span>

> [!NOTE]
> <span data-ttu-id="a98fa-136">*Este tutorial usa recursos do hello serviço de banco de dados SQL que estão em uma visualização limitada (trabalhos do banco de dados Elástico). Se você quiser toodo neste tutorial, fornecer sua id de assinatura tooSaaSFeedback@microsoft.com com o assunto = Elástico visualização de trabalhos. Depois de receber a confirmação de que sua assinatura tiver sido habilitada, [baixar e instalar cmdlets de pré-lançamento trabalhos mais recentes Olá](https://github.com/jaredmoo/azure-powershell/releases). Esta é uma versão prévia limitada, então contate SaaSFeedback@microsoft.com para conferir perguntas relacionadas ou para obter suporte.*</span><span class="sxs-lookup"><span data-stu-id="a98fa-136">*This tutorial uses features of hello SQL Database service that are in a limited preview (Elastic Database jobs). If you wish toodo this tutorial, provide your subscription id tooSaaSFeedback@microsoft.com with subject=Elastic Jobs Preview. After you receive confirmation that your subscription has been enabled, [download and install hello latest pre-release jobs cmdlets](https://github.com/jaredmoo/azure-powershell/releases). This preview is limited, so contact SaaSFeedback@microsoft.com for related questions or support.*</span></span>

## <a name="get-hello-wingtip-application-scripts"></a><span data-ttu-id="a98fa-137">Obter scripts de aplicativo hello Wingtip</span><span class="sxs-lookup"><span data-stu-id="a98fa-137">Get hello Wingtip application scripts</span></span>

<span data-ttu-id="a98fa-138">Hello Wingtip SaaS scripts e código fonte do aplicativo estão disponíveis no hello [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS) repositório github.</span><span class="sxs-lookup"><span data-stu-id="a98fa-138">hello Wingtip SaaS scripts and application source code are available in hello [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS) github repo.</span></span> <span data-ttu-id="a98fa-139">[As etapas de scripts de SaaS Wingtip Olá toodownload](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span><span class="sxs-lookup"><span data-stu-id="a98fa-139">[Steps toodownload hello Wingtip SaaS scripts](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span></span>

## <a name="create-a-job-account-database-and-new-job-account"></a><span data-ttu-id="a98fa-140">Criar um banco de dados de conta de trabalho e uma nova conta de trabalho</span><span class="sxs-lookup"><span data-stu-id="a98fa-140">Create a job account database and new job account</span></span>

<span data-ttu-id="a98fa-141">Este tutorial requer que você usar o PowerShell toocreate Olá trabalho banco de dados e de trabalho da conta.</span><span class="sxs-lookup"><span data-stu-id="a98fa-141">This tutorial requires you use PowerShell toocreate hello job account database and job account.</span></span> <span data-ttu-id="a98fa-142">Como o MSDB e o SQL Agent, trabalhos Elástico usa um SQL Azure banco de dados toostore definições de trabalho, o status do trabalho e o histórico.</span><span class="sxs-lookup"><span data-stu-id="a98fa-142">Like MSDB and SQL Agent, Elastic Jobs uses an Azure SQL database toostore job definitions, job status, and history.</span></span> <span data-ttu-id="a98fa-143">Depois de criar conta de trabalho de saudação, você pode criar e monitorar trabalhos imediatamente.</span><span class="sxs-lookup"><span data-stu-id="a98fa-143">Once hello job account is created, you can create and monitor jobs immediately.</span></span>

1. <span data-ttu-id="a98fa-144">Abrir... \\Módulos de aprendizado\\esquema gerenciamento\\*demonstração SchemaManagement.ps1* em Olá **PowerShell ISE**.</span><span class="sxs-lookup"><span data-stu-id="a98fa-144">Open …\\Learning Modules\\Schema Management\\*Demo-SchemaManagement.ps1* in hello **PowerShell ISE**.</span></span>
1. <span data-ttu-id="a98fa-145">Pressione **F5** toorun script de saudação.</span><span class="sxs-lookup"><span data-stu-id="a98fa-145">Press **F5** toorun hello script.</span></span>

<span data-ttu-id="a98fa-146">Olá *demonstração SchemaManagement.ps1* script chamadas Olá *implantar SchemaManagement.ps1* script toocreate um *S2* banco de dados denominado **jobaccount** no servidor de catálogo hello.</span><span class="sxs-lookup"><span data-stu-id="a98fa-146">hello *Demo-SchemaManagement.ps1* script calls hello *Deploy-SchemaManagement.ps1* script toocreate an *S2* database named **jobaccount** on hello catalog server.</span></span> <span data-ttu-id="a98fa-147">Ele, em seguida, cria a conta de trabalho hello, passando o banco de dados do hello jobaccount como uma chamada de criação de conta do parâmetro toohello trabalho.</span><span class="sxs-lookup"><span data-stu-id="a98fa-147">It then creates hello job account, passing hello jobaccount database as a parameter toohello job account creation call.</span></span>

## <a name="create-a-job-toodeploy-new-reference-data-tooall-tenants"></a><span data-ttu-id="a98fa-148">Criar um trabalho de locatários do toodeploy nova referência dados tooall</span><span class="sxs-lookup"><span data-stu-id="a98fa-148">Create a job toodeploy new reference data tooall tenants</span></span>

<span data-ttu-id="a98fa-149">Cada banco de dados do locatário inclui um conjunto de tipos de local que definem o tipo de saudação de eventos que são hospedados em um local.</span><span class="sxs-lookup"><span data-stu-id="a98fa-149">Each tenant database includes a set of venue types that define hello kind of events that are hosted at a venue.</span></span> <span data-ttu-id="a98fa-150">Neste exercício, você implanta um tipos de local adicional atualização tooall Olá locatário bancos de dados tooadd dois: *moto corrida* e *nadasse sociedade*.</span><span class="sxs-lookup"><span data-stu-id="a98fa-150">In this exercise, you deploy an update tooall hello tenant databases tooadd two additional venue types: *Motorcycle Racing* and *Swimming Club*.</span></span> <span data-ttu-id="a98fa-151">Esses tipos de local correspondem a imagem de plano de fundo toohello que você vê no aplicativo de eventos de locatário hello.</span><span class="sxs-lookup"><span data-stu-id="a98fa-151">These venue types correspond toohello background image you see in hello tenant events app.</span></span>

<span data-ttu-id="a98fa-152">Clique em Olá foro menu suspenso tipo e validar que apenas 10 opções de tipo de local estão disponíveis e, especificamente que 'Moto corrida' e 'Nadasse sociedade' não são incluídos na lista de saudação.</span><span class="sxs-lookup"><span data-stu-id="a98fa-152">Click hello Venue Type drop down menu and validate that only 10 venue type options are available, and specifically that ‘Motorcycle Racing’ and ‘Swimming Club’ are not included in hello list.</span></span>

<span data-ttu-id="a98fa-153">Agora vamos criar uma saudação do trabalho tooupdate *VenueTypes* em todos os bancos de dados de locatário de saudação de tabela e adicionar novos tipos de local de saudação.</span><span class="sxs-lookup"><span data-stu-id="a98fa-153">Now let’s create a job tooupdate hello *VenueTypes* table in all hello tenant databases and add hello new venue types.</span></span>

<span data-ttu-id="a98fa-154">toocreate um novo trabalho, usamos um conjunto de trabalhos criados no banco de dados de jobaccount hello quando Olá conta de trabalho foi criada de procedimentos armazenados do sistema.</span><span class="sxs-lookup"><span data-stu-id="a98fa-154">toocreate a new job, we use a set of jobs system stored procedures created in hello jobaccount database when hello job account was created.</span></span>

1. <span data-ttu-id="a98fa-155">Abra o SSMS e conecte-se o servidor de catálogo toohello: catálogo -\<usuário\>. servidor t</span><span class="sxs-lookup"><span data-stu-id="a98fa-155">Open SSMS and connect toohello catalog server: catalog-\<user\>.database.windows.net server</span></span>
1. <span data-ttu-id="a98fa-156">Também se conectar o servidor de locatário toohello: tenants1 -\<usuário\>. t</span><span class="sxs-lookup"><span data-stu-id="a98fa-156">Also connect toohello tenant server: tenants1-\<user\>.database.windows.net</span></span>
1. <span data-ttu-id="a98fa-157">Procurar toohello *contosoconcerthall* banco de dados em Olá *tenants1* saudação do servidor e consulta *VenueTypes* tooconfirm de tabela que *moto corrida*  e *nadasse sociedade* **não são** na lista de resultados de saudação.</span><span class="sxs-lookup"><span data-stu-id="a98fa-157">Browse toohello *contosoconcerthall* database on hello *tenants1* server and query hello *VenueTypes* table tooconfirm that *Motorcycle Racing* and *Swimming Club* **are not** in hello results list.</span></span>
1. <span data-ttu-id="a98fa-158">Arquivo hello abrir... \\Módulos de aprendizado\\esquema gerenciamento\\DeployReferenceData.sql</span><span class="sxs-lookup"><span data-stu-id="a98fa-158">Open hello file …\\Learning Modules\\Schema Management\\DeployReferenceData.sql</span></span>
1. <span data-ttu-id="a98fa-159">Modificar instrução Olá: definir @wtpUser = &lt;usuário&gt; e substitua o valor de usuário Olá usado quando você implantou o aplicativo de Wingtip Olá</span><span class="sxs-lookup"><span data-stu-id="a98fa-159">Modify hello statement: SET @wtpUser = &lt;user&gt; and substitute hello User value used when you deployed hello Wingtip app</span></span>
1. <span data-ttu-id="a98fa-160">Certifique-se de que são o banco de dados conectado toohello jobaccount e pressione **F5** para executar o script hello</span><span class="sxs-lookup"><span data-stu-id="a98fa-160">Ensure you are connected toohello jobaccount database and press **F5** to run hello script</span></span>

* <span data-ttu-id="a98fa-161">**SP\_adicionar\_destino\_grupo** cria o nome do grupo de destino Olá DemoServerGroup, agora precisamos tooadd membros de destino.</span><span class="sxs-lookup"><span data-stu-id="a98fa-161">**sp\_add\_target\_group** creates hello target group name DemoServerGroup, now we need tooadd target members.</span></span>
* <span data-ttu-id="a98fa-162">**SP\_adicionar\_destino\_grupo\_membro** adiciona um *server* tipo de membro, o que considerar todos os bancos de dados nesse servidor (note que esta é a saudação tenants1-dedestino&lt; Usuário&gt; que contém os bancos de dados de locatário de saudação do servidor) em tempo de trabalho de execução deve ser incluída no trabalho hello, Olá segundo está adicionando um *banco de dados* tipo de membro de destino, especificamente hello (banco de dados 'final' basetenantdb) que reside no catálogo -&lt;usuário&gt; server e finalmente outro *banco de dados* destino grupo membro tipo tooinclude Olá adhocanalytics banco de dados que é usado em um tutorial posterior.</span><span class="sxs-lookup"><span data-stu-id="a98fa-162">**sp\_add\_target\_group\_member** adds a *server* target member type, which deems all databases within that server (note this is hello tenants1-&lt;User&gt; server containing hello tenant databases) at time of job execution should be included in hello job, hello second is adding a *database* target member type, specifically hello ‘golden’ database (basetenantdb) that resides on catalog-&lt;User&gt; server, and lastly another *database* target group member type tooinclude hello adhocanalytics database that is used in a later tutorial.</span></span>
* <span data-ttu-id="a98fa-163">**sp\_add\_job** cria um trabalho chamado “Reference Data Deployment”</span><span class="sxs-lookup"><span data-stu-id="a98fa-163">**sp\_add\_job** creates a job called “Reference Data Deployment”</span></span>
* <span data-ttu-id="a98fa-164">**SP\_adicionar\_jobstep** cria Olá etapa de trabalho que contém a tabela de referência Olá no tooupdate texto do T-SQL comando, VenueTypes</span><span class="sxs-lookup"><span data-stu-id="a98fa-164">**sp\_add\_jobstep** creates hello job step containing T-SQL command text tooupdate hello reference table, VenueTypes</span></span>
* <span data-ttu-id="a98fa-165">Olá restantes no script hello exibem existência de saudação de objetos hello e execução do trabalho de monitor.</span><span class="sxs-lookup"><span data-stu-id="a98fa-165">hello remaining views in hello script display hello existence of hello objects and monitor job execution.</span></span> <span data-ttu-id="a98fa-166">Usar o valor de status essas consultas tooreview Olá Olá **ciclo de vida** toodetermine coluna quando o trabalho de saudação foi concluído com êxito em todos os bancos de dados de locatário e Olá dois outros bancos de dados que contém a tabela de referência de saudação.</span><span class="sxs-lookup"><span data-stu-id="a98fa-166">Use these queries tooreview hello status value in hello **lifecycle** column toodetermine when hello job has successfully finished on all tenant databases and hello two additional databases containing hello reference table.</span></span>

1. <span data-ttu-id="a98fa-167">No SSMS, procurar toohello *contosoconcerthall* banco de dados em Olá *tenants1* saudação do servidor e consulta *VenueTypes* tooconfirm de tabela que *moto Corrida* e *nadasse sociedade* **são** agora na lista de resultados de saudação.</span><span class="sxs-lookup"><span data-stu-id="a98fa-167">In SSMS, browse toohello *contosoconcerthall* database on hello *tenants1* server and query hello *VenueTypes* table tooconfirm that *Motorcycle Racing* and *Swimming Club* **are** now in hello results list.</span></span>


## <a name="create-a-job-toomanage-hello-reference-table-index"></a><span data-ttu-id="a98fa-168">Criar um índice de tabela de referência do trabalho toomanage Olá</span><span class="sxs-lookup"><span data-stu-id="a98fa-168">Create a job toomanage hello reference table index</span></span>

<span data-ttu-id="a98fa-169">Semelhante toohello de exercício anterior, este exercício cria um índice de saudação do trabalho toorebuild na chave primária da tabela de referência de hello, uma operação de gerenciamento de banco de dados típico um administrador pode executar após um carregamento de dados grande em uma tabela.</span><span class="sxs-lookup"><span data-stu-id="a98fa-169">Similar toohello previous exercise, this exercise creates a job toorebuild hello index on hello reference table primary key, a typical database management operation an administrator might perform after a large data load into a table.</span></span>

<span data-ttu-id="a98fa-170">Criar um trabalho usando Olá mesmo trabalhos 'system' procedimentos armazenados.</span><span class="sxs-lookup"><span data-stu-id="a98fa-170">Create a job using hello same jobs 'system' stored procedures.</span></span>

1. <span data-ttu-id="a98fa-171">Abra o SSMS e conecte-se toohello catálogo -&lt;usuário&gt;. servidor t</span><span class="sxs-lookup"><span data-stu-id="a98fa-171">Open SSMS and connect toohello catalog-&lt;User&gt;.database.windows.net server</span></span>
1. <span data-ttu-id="a98fa-172">Arquivo hello abrir... \\Módulos de aprendizado\\esquema gerenciamento\\OnlineReindex.sql</span><span class="sxs-lookup"><span data-stu-id="a98fa-172">Open hello file …\\Learning Modules\\Schema Management\\OnlineReindex.sql</span></span>
1. <span data-ttu-id="a98fa-173">Clique com botão direito, selecione a Conexão e conectar-se toohello catálogo -&lt;usuário&gt;. t server, se ainda não estiver conectado</span><span class="sxs-lookup"><span data-stu-id="a98fa-173">Right click, select Connection, and connect toohello catalog-&lt;User&gt;.database.windows.net server, if not already connected</span></span>
1. <span data-ttu-id="a98fa-174">Certifique-se conectado toohello jobaccount no banco de dados e pressione F5 script de saudação de toorun</span><span class="sxs-lookup"><span data-stu-id="a98fa-174">Ensure you are connected toohello jobaccount database and press F5 toorun hello script</span></span>

* <span data-ttu-id="a98fa-175">sp\_add\_job cria um novo trabalho chamado “Online Reindex PK\_\_VenueTyp\_\_265E44FD7FD4C885”</span><span class="sxs-lookup"><span data-stu-id="a98fa-175">sp\_add\_job creates a new job called “Online Reindex PK\_\_VenueTyp\_\_265E44FD7FD4C885”</span></span>
* <span data-ttu-id="a98fa-176">SP\_adicionar\_jobstep cria a etapa de trabalho de saudação que contém o índice de saudação do T-SQL comando texto tooupdate</span><span class="sxs-lookup"><span data-stu-id="a98fa-176">sp\_add\_jobstep creates hello job step containing T-SQL command text tooupdate hello index</span></span>




## <a name="next-steps"></a><span data-ttu-id="a98fa-177">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="a98fa-177">Next steps</span></span>

<span data-ttu-id="a98fa-178">Neste tutorial, você aprendeu a:</span><span class="sxs-lookup"><span data-stu-id="a98fa-178">In this tutorial you learned how to:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="a98fa-179">Criar um tooquery de conta de trabalho por vários locatários</span><span class="sxs-lookup"><span data-stu-id="a98fa-179">Create a job account tooquery across multiple tenants</span></span>
> * <span data-ttu-id="a98fa-180">Atualizar dados em todos os bancos de dados de locatário</span><span class="sxs-lookup"><span data-stu-id="a98fa-180">Update data in all tenant databases</span></span>
> * <span data-ttu-id="a98fa-181">Criar um índice em uma tabela em todos os bancos de dados de locatário</span><span class="sxs-lookup"><span data-stu-id="a98fa-181">Create an index on a table in all tenant databases</span></span>

[<span data-ttu-id="a98fa-182">Tutorial de análise ad hoc</span><span class="sxs-lookup"><span data-stu-id="a98fa-182">Ad-hoc analytics tutorial</span></span>](sql-database-saas-tutorial-adhoc-analytics.md)


## <a name="additional-resources"></a><span data-ttu-id="a98fa-183">Recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="a98fa-183">Additional resources</span></span>

* [<span data-ttu-id="a98fa-184">Tutoriais adicionais que se baseiam na Olá implantação de aplicativos SaaS Wingtip</span><span class="sxs-lookup"><span data-stu-id="a98fa-184">Additional tutorials that build upon hello Wingtip SaaS application deployment</span></span>](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)
* [<span data-ttu-id="a98fa-185">Gerenciando bancos de dados de nuvem com escalonamento horizontal</span><span class="sxs-lookup"><span data-stu-id="a98fa-185">Managing scaled-out cloud databases</span></span>](sql-database-elastic-jobs-overview.md)
* [<span data-ttu-id="a98fa-186">Criar e gerenciar bancos de dados de nuvem com escalonamento horizontal</span><span class="sxs-lookup"><span data-stu-id="a98fa-186">Create and manage scaled-out cloud databases</span></span>](sql-database-elastic-jobs-create-and-manage.md)
