---
title: "Autenticação Multifator do Azure - SQL do Azure | Microsoft Docs"
description: Use o Multi-Factor Authentication com SSMS para Banco de Dados SQL e SQL Data Warehouse.
services: sql-database
documentationcenter: 
author: BYHAM
manager: jhubbard
editor: 
tags: 
ms.assetid: fbd6e644-0520-439c-8304-2e4fb6d6eb91
ms.service: sql-database
ms.custom: security
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-management
ms.date: 07/19/2017
ms.author: rickbyh
ms.openlocfilehash: 17c48626d85b833269bb7c4d1d34618cccffd03e
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/18/2017
---
# <a name="universal-authentication-with-sql-database-and-sql-data-warehouse-ssms-support-for-mfa"></a><span data-ttu-id="72f76-103">Autenticação Universal com o Banco de Dados SQL e SQL Data Warehouse (suporte SSMS para MFA)</span><span class="sxs-lookup"><span data-stu-id="72f76-103">Universal Authentication with SQL Database and SQL Data Warehouse (SSMS support for MFA)</span></span>
<span data-ttu-id="72f76-104">O Banco de Dados SQL do Azure e o SQL Data Warehouse do Azure dão suporte a conexões do SSMS (SQL Server Management Studio) usando a *Autenticação Universal do Active Directory*.</span><span class="sxs-lookup"><span data-stu-id="72f76-104">Azure SQL Database and Azure SQL Data Warehouse support connections from SQL Server Management Studio (SSMS) using *Active Directory Universal Authentication*.</span></span> 
<span data-ttu-id="72f76-105">**Baixar a última versão do SSMS** - No computador cliente, baixe a última versão do SSMS em [Baixar o SQL Server Management Studio (SSMS)](https://msdn.microsoft.com/library/mt238290.aspx).</span><span class="sxs-lookup"><span data-stu-id="72f76-105">**Download the latest SSMS** - On the client computer, download the latest version of SSMS, from [Download SQL Server Management Studio (SSMS)](https://msdn.microsoft.com/library/mt238290.aspx).</span></span> <span data-ttu-id="72f76-106">Para todos os recursos neste tópico, use pelo menos a versão 17.2 de julho de 2017.</span><span class="sxs-lookup"><span data-stu-id="72f76-106">For all the features in this topic, use at least July 2017, version 17.2.</span></span>  <span data-ttu-id="72f76-107">A caixa de diálogo de conexão mais recente, possui esta aparência: ![1mfa-universal-connect](./media/sql-database-ssms-mfa-auth/1mfa-universal-connect.png "Preenche a caixa de Nome de usuário.")</span><span class="sxs-lookup"><span data-stu-id="72f76-107">The most recent connection dialog box, looks like this: ![1mfa-universal-connect](./media/sql-database-ssms-mfa-auth/1mfa-universal-connect.png "Completes the User name box.")</span></span>  

## <a name="the-five-authentication-options"></a><span data-ttu-id="72f76-108">As cinco opções de autenticação</span><span class="sxs-lookup"><span data-stu-id="72f76-108">The five authentication options</span></span>  
- <span data-ttu-id="72f76-109">A Autenticação Universal do Active Directory dá suporte a dois métodos de autenticação não interativa (autenticação `Active Directory - Password` e autenticação `Active Directory - Integrated`).</span><span class="sxs-lookup"><span data-stu-id="72f76-109">Active Directory Universal Authentication supports the two non-interactive authentication methods (`Active Directory - Password` authentication and `Active Directory - Integrated` authentication).</span></span> <span data-ttu-id="72f76-110">Os métodos de Autenticação `Active Directory - Password` e `Active Directory - Integrated` não interativos podem ser usados em muitos aplicativos diferentes (ADO.NET, JDBC, ODBC, etc.).</span><span class="sxs-lookup"><span data-stu-id="72f76-110">Non-interactive `Active Directory - Password` and `Active Directory - Integrated` Authentication methods can be used in many different applications (ADO.NET, JDBC, ODBC, etc.).</span></span> <span data-ttu-id="72f76-111">Esses dois métodos nunca resultam em caixas de diálogo pop-up.</span><span class="sxs-lookup"><span data-stu-id="72f76-111">These two methods never result in pop-up dialog boxes.</span></span>

- <span data-ttu-id="72f76-112">A autenticação `Active Directory - Universal with MFA` é um método interativo que também é compatível com a *Autenticação Multifator do Azure* (MFA).</span><span class="sxs-lookup"><span data-stu-id="72f76-112">`Active Directory - Universal with MFA` authentication is an interactive method that also supports *Azure Multi-Factor Authentication* (MFA).</span></span> <span data-ttu-id="72f76-113">O Azure MFA ajuda a proteger o acesso a dados e aplicativos, ao mesmo tempo que atende à demanda dos usuários por um processo de entrada simples.</span><span class="sxs-lookup"><span data-stu-id="72f76-113">Azure MFA helps safeguard access to data and applications while meeting user demand for a simple sign-in process.</span></span> <span data-ttu-id="72f76-114">Ele fornece autenticação eficiente com uma variedade de opções de verificação fáceis, como chamada telefônica, mensagem de texto, cartões inteligentes com PIN ou notificação por aplicativos móveis, os quais permitem que os usuários escolham seu método de preferência.</span><span class="sxs-lookup"><span data-stu-id="72f76-114">It delivers strong authentication with a range of easy verification options (phone call, text message, smart cards with pin, or mobile app notification), allowing users to choose the method they prefer.</span></span> <span data-ttu-id="72f76-115">O MFA interativo com o Azure AD pode resultar em uma caixa de diálogo pop-up para validação.</span><span class="sxs-lookup"><span data-stu-id="72f76-115">Interactive MFA with Azure AD can result in a pop-up dialog box for validation.</span></span>

<span data-ttu-id="72f76-116">Para encontrar uma descrição do Multi-Factor Authentication, consulte [Multi-Factor Authentication](../multi-factor-authentication/multi-factor-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="72f76-116">For a description of Multi-Factor Authentication, see [Multi-Factor Authentication](../multi-factor-authentication/multi-factor-authentication.md).</span></span>
<span data-ttu-id="72f76-117">Para etapas de configuração, consulte [Configurar Autenticação Multifator do Banco de Dados SQL do Azure para o SQL Server Management Studio](sql-database-ssms-mfa-authentication-configure.md).</span><span class="sxs-lookup"><span data-stu-id="72f76-117">For configuration steps, see [Configure Azure SQL Database multi-factor authentication for SQL Server Management Studio](sql-database-ssms-mfa-authentication-configure.md).</span></span>

### <a name="azure-ad-domain-name-or-tenant-id-parameter"></a><span data-ttu-id="72f76-118">Parâmetro de ID do locatário ou nome de domínio do Azure AD</span><span class="sxs-lookup"><span data-stu-id="72f76-118">Azure AD domain name or tenant ID parameter</span></span>   

<span data-ttu-id="72f76-119">Começando com o [SSMS versão 17](https://docs.microsoft.com/sql/ssms/download-sql-server-management-studio-ssms), os usuários que são importados para o Active Directory atual de outros Azure Active Directories como usuários convidados, podem fornecer a ID de locatário ou nome de domínio do Azure AD quando eles se conectam.</span><span class="sxs-lookup"><span data-stu-id="72f76-119">Beginning with [SSMS version 17](https://docs.microsoft.com/sql/ssms/download-sql-server-management-studio-ssms), users that are imported into the current Active Directory from other Azure Active Directories as guest users, can provide the Azure AD domain name, or tenant ID when they connect.</span></span> <span data-ttu-id="72f76-120">Usuários convidados incluem usuários convidados de outros Azure ADs e contas Microsoft como outlook.com, hotmail.com, live.com ou outras contas como gmail.com. Essa informação, permite que o **Active Directory Universal com Autenticação MFA** identifique a autoridade de autenticação correta.</span><span class="sxs-lookup"><span data-stu-id="72f76-120">Guest users include users invited from other Azure ADs, Microsoft accounts such as outlook.com, hotmail.com, live.com, or other accounts like gmail.com. This information, allows **Active Directory Universal with MFA Authentication** to identify the correct authenticating authority.</span></span> <span data-ttu-id="72f76-121">Essa opção também é necessária para dar suporte a contas da Microsoft (MSA), como outlook.com, hotmail.com, live.com ou contas que não são MSA.</span><span class="sxs-lookup"><span data-stu-id="72f76-121">This option is also required to support Microsoft accounts (MSA) such as outlook.com, hotmail.com, live.com, or non-MSA accounts.</span></span> <span data-ttu-id="72f76-122">Todos esses usuários que desejam ser autenticados usando a autenticação Universal devem inserir sua ID de locatário ou nome de domínio do Azure AD.</span><span class="sxs-lookup"><span data-stu-id="72f76-122">All these users who want to be authenticated using Universal Authentication must enter their Azure AD domain name or tenant ID.</span></span> <span data-ttu-id="72f76-123">Esse parâmetro representa a ID de locatário/nome de domínio do Azure AD atual a que o Servidor do Azure está vinculado.</span><span class="sxs-lookup"><span data-stu-id="72f76-123">This parameter represents the current Azure AD domain name/tenant ID the Azure Server is linked with.</span></span> <span data-ttu-id="72f76-124">Por exemplo, se o servidor do Azure está associado com o domínio do Azure AD `contosotest.onmicrosoft.com` em que o usuário `joe@contosodev.onmicrosoft.com` está hospedado como um usuário importado do domínio do Azure AD `contosodev.onmicrosoft.com`, o nome de domínio necessário para autenticar esse usuário é `contosotest.onmicrosoft.com`.</span><span class="sxs-lookup"><span data-stu-id="72f76-124">For example, if Azure Server is associated with Azure AD domain `contosotest.onmicrosoft.com` where user `joe@contosodev.onmicrosoft.com` is hosted as an imported user from Azure AD domain `contosodev.onmicrosoft.com`, the domain name required to authenticate this user is `contosotest.onmicrosoft.com`.</span></span> <span data-ttu-id="72f76-125">Quando o usuário é um usuário nativo do Azure AD vinculado ao Servidor do Azure e não é uma conta MSA, nenhuma ID de locatário nem nome de domínio é necessário.</span><span class="sxs-lookup"><span data-stu-id="72f76-125">When the user is a native user of the Azure AD linked to Azure Server, and is not an MSA account, no domain name or tenant ID is required.</span></span> <span data-ttu-id="72f76-126">Para inserir o parâmetro (começando com o SSMS versão 17.2), na caixa de diálogo **Conectar-se ao banco de dados**, preencha a caixa de diálogo, selecionando a autenticação **Active Directory - Universal com MFA**, clique em **Opções**, preencha a caixa de **Nome de usuário** e, em seguida, clique na guia **Propriedades de conexão**. Marque a caixa **ID de locatário ou nome de domínio do AD** e forneça a autoridade de autenticação, como o nome de domínio (**contosotest.onmicrosoft.com**) ou o GUID da ID do locatário.</span><span class="sxs-lookup"><span data-stu-id="72f76-126">To enter the parameter (beginning with SSMS version 17.2), in the **Connect to Database** dialog box, complete the dialog box, selecting **Active Directory - Universal with MFA** authentication, click **Options**, complete the **User name** box, and then click the **Connection Properties** tab. Check the **AD domain name or tenant ID** box, and provide authenticating authority, such as the domain name (**contosotest.onmicrosoft.com**) or the GUID of the tenant ID.</span></span>  
   <span data-ttu-id="72f76-127">![mfa-tenant-ssms](./media/sql-database-ssms-mfa-auth/mfa-tenant-ssms.png)</span><span class="sxs-lookup"><span data-stu-id="72f76-127">![mfa-tenant-ssms](./media/sql-database-ssms-mfa-auth/mfa-tenant-ssms.png)</span></span>   

### <a name="azure-ad-business-to-business-support"></a><span data-ttu-id="72f76-128">Suporte entre empresas do Azure AD</span><span class="sxs-lookup"><span data-stu-id="72f76-128">Azure AD business to business support</span></span>   
<span data-ttu-id="72f76-129">Os usuários do Azure AD com suporte para cenários de B2B do Azure AD como usuários convidados (consulte [O que é colaboração B2B do Azure](../active-directory/active-directory-b2b-what-is-azure-ad-b2b.md)) podem se conectar ao Banco de Dados SQL e SQL Data Warehouse apenas como parte dos membros de um grupo criado no Azure AD atual e mapeados manualmente usando a instrução `CREATE USER` do Transact-SQL em um determinado banco de dados.</span><span class="sxs-lookup"><span data-stu-id="72f76-129">Azure AD users supported for Azure AD B2B scenarios as guest users (see [What is Azure B2B collaboration](../active-directory/active-directory-b2b-what-is-azure-ad-b2b.md)) can connect to SQL Database and SQL Data Warehouse only as part of members of a group created in current Azure AD and mapped manually using the Transact-SQL `CREATE USER` statement in a given database.</span></span> <span data-ttu-id="72f76-130">Por exemplo, se `steve@gmail.com` é convidado para o Azure AD `contosotest` (com o domínio do Azure Ad `contosotest.onmicrosoft.com`), um grupo do Azure AD, como `usergroup` deve ser criado no Azure AD que contém o membro `steve@gmail.com`.</span><span class="sxs-lookup"><span data-stu-id="72f76-130">For example, if `steve@gmail.com` is invited to Azure AD `contosotest` (with the Azure Ad domain `contosotest.onmicrosoft.com`), an Azure AD group, such as `usergroup` must be created in the Azure AD that contains the `steve@gmail.com` member.</span></span> <span data-ttu-id="72f76-131">Em seguida, esse grupo deve ser criado para um banco de dados específico (ou seja, MyDatabase) pelo administrador do SQL do Azure AD ou DBO do Azure AD executando uma instrução `CREATE USER [usergroup] FROM EXTERNAL PROVIDER` do Transact-SQL.</span><span class="sxs-lookup"><span data-stu-id="72f76-131">Then, this group must be created for a specific  database (i.e. MyDatabase) by Azure AD SQL admin or Azure AD DBO  by executing a Transact-SQL `CREATE USER [usergroup] FROM EXTERNAL PROVIDER` statement.</span></span> <span data-ttu-id="72f76-132">Depois que o usuário de banco de dados for criado o usuário `steve@gmail.com` pode fazer logon em `MyDatabase` usando a opção `Active Directory – Universal with MFA support` de autenticação do SSMS.</span><span class="sxs-lookup"><span data-stu-id="72f76-132">After the database user is created, then the user `steve@gmail.com` can login to `MyDatabase` using the SSMS authentication option `Active Directory – Universal with MFA support`.</span></span> <span data-ttu-id="72f76-133">O grupo de usuários, por padrão, possui somente a permissão de conexão e qualquer acesso a dados adicional precisará ser concedido da maneira normal.</span><span class="sxs-lookup"><span data-stu-id="72f76-133">The usergroup, by default, has only the connect permission and any further data access that will need to be granted in the normal way.</span></span> <span data-ttu-id="72f76-134">Observe que o usuário `steve@gmail.com` como um usuário convidado deve marcar a caixa e adicionar o nome de domínio do AD `contosotest.onmicrosoft.com` na caixa de diálogo **Propriedade de Conexão** do SSMS.</span><span class="sxs-lookup"><span data-stu-id="72f76-134">Please note that user `steve@gmail.com` as a guest user must check the box and add the AD domain name `contosotest.onmicrosoft.com` in the SSMS **Connection Property** dialog box.</span></span> <span data-ttu-id="72f76-135">A opção **ID de locatário ou nome de domínio do AD** tem suporte apenas para opções de conexão Universal com MFA, caso contrário, ela fica acinzentada.</span><span class="sxs-lookup"><span data-stu-id="72f76-135">The **AD domain name or tenant ID** option is only supported for the Universal with MFA connection options, otherwise it is greyed out.</span></span>

## <a name="universal-authentication-limitations-for-sql-database-and-sql-data-warehouse"></a><span data-ttu-id="72f76-136">Limitações da Autenticação Universal para o Banco de Dados SQL e SQL Data Warehouse</span><span class="sxs-lookup"><span data-stu-id="72f76-136">Universal Authentication limitations for SQL Database and SQL Data Warehouse</span></span>
* <span data-ttu-id="72f76-137">O SSMS e o SqlPackage.exe são as únicas ferramentas atualmente habilitadas para MFA por meio da Autenticação Universal do Active Directory.</span><span class="sxs-lookup"><span data-stu-id="72f76-137">SSMS and SqlPackage.exe are the only tools currently enabled for MFA through Active Directory Universal Authentication.</span></span>
* <span data-ttu-id="72f76-138">O SSMS versão 17.2, dá suporte a acesso simultâneo de vários usuário usando a Autenticação Universal com MFA.</span><span class="sxs-lookup"><span data-stu-id="72f76-138">SSMS version 17.2, supports multi-user concurrent access using Universal Authentication with MFA.</span></span> <span data-ttu-id="72f76-139">As versões 17.0 e 17.1 restringiam o logon para uma instância do SSMS usando Autenticação Universal a uma única conta do Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="72f76-139">Version 17.0 and 17.1, restricted a log in for an instance of SSMS using Universal Authentication to a single Azure Active Directory account.</span></span> <span data-ttu-id="72f76-140">Para fazer logon como outra conta do Azure AD, você deve usar outra instância do SSMS.</span><span class="sxs-lookup"><span data-stu-id="72f76-140">To log in as another Azure AD account, you must use another instance of SSMS.</span></span> <span data-ttu-id="72f76-141">(Essa restrição é limitada à Autenticação Universal do Active Directory, você pode fazer logon em diferentes servidores usando a Autenticação de Senha do Active Directory, a Autenticação Integrada do Active Directory ou a Autenticação do SQL Server).</span><span class="sxs-lookup"><span data-stu-id="72f76-141">(This restriction is limited to Active Directory Universal Authentication; you can log in to different servers using Active Directory Password Authentication, Active Directory Integrated Authentication, or SQL Server Authentication).</span></span>
* <span data-ttu-id="72f76-142">O SSMS dá suporte à Autenticação Universal do Active Directory para a visualização do Pesquisador de Objetos, do Editor de Consultas e do Repositório de Consultas.</span><span class="sxs-lookup"><span data-stu-id="72f76-142">SSMS supports Active Directory Universal Authentication for Object Explorer, Query Editor, and Query Store visualization.</span></span>
* <span data-ttu-id="72f76-143">O SSMS versão 17.2 fornece suporte ao Assistente de DacFx para Eportação/Extração/Implantação de Dados de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="72f76-143">SSMS version 17.2 provides DacFx Wizard support for Export/Extract/Deploy Data database.</span></span> <span data-ttu-id="72f76-144">Depois que um usuário específico é autenticado por meio da caixa de diálogo de autenticação inicial usando a Autenticação Universal, o Assistente de DacFx funciona da mesma maneira que faz para todos os outros métodos de autenticação.</span><span class="sxs-lookup"><span data-stu-id="72f76-144">Once a specific user is authenticated through the initial authentication dialog using Universal Authentication, the DacFx Wizard functions the same way it does for all other authentication methods.</span></span>
* <span data-ttu-id="72f76-145">O Designer de Tabela de SSMS não dá suporte à Autenticação Universal.</span><span class="sxs-lookup"><span data-stu-id="72f76-145">The SSMS Table Designer does not support Universal Authentication.</span></span>
* <span data-ttu-id="72f76-146">Não há nenhum requisito de software adicional para a Autenticação Universal do Active Directory, exceto que você deve usar uma versão do SSMS com suporte.</span><span class="sxs-lookup"><span data-stu-id="72f76-146">There are no additional software requirements for Active Directory Universal Authentication except that you must use a supported version of SSMS.</span></span>  
* <span data-ttu-id="72f76-147">A versão da Biblioteca de Autenticação do Active Directory (ADAL) para autenticação Universal foi atualizada para a última versão lançada disponível de ADAL.dll 3.13.9.</span><span class="sxs-lookup"><span data-stu-id="72f76-147">The Active Directory Authentication Library (ADAL) version for Universal authentication was updated to its latest ADAL.dll 3.13.9 available released version.</span></span> <span data-ttu-id="72f76-148">Consulte [Biblioteca de Autenticação do Active Directory 3.14.1](http://www.nuget.org/packages/Microsoft.IdentityModel.Clients.ActiveDirectory/).</span><span class="sxs-lookup"><span data-stu-id="72f76-148">See [Active Directory Authentication Library 3.14.1](http://www.nuget.org/packages/Microsoft.IdentityModel.Clients.ActiveDirectory/).</span></span>


## <a name="next-steps"></a><span data-ttu-id="72f76-149">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="72f76-149">Next steps</span></span>

- <span data-ttu-id="72f76-150">Para etapas de configuração, consulte [Configurar Autenticação Multifator do Banco de Dados SQL do Azure para o SQL Server Management Studio](sql-database-ssms-mfa-authentication-configure.md).</span><span class="sxs-lookup"><span data-stu-id="72f76-150">For configuration steps, see [Configure Azure SQL Database multi-factor authentication for SQL Server Management Studio](sql-database-ssms-mfa-authentication-configure.md).</span></span>
- <span data-ttu-id="72f76-151">Conceder acesso a outros a seu banco de dados: [Autenticação e Autorização do Banco de Dados SQL: Concessão de Acesso](sql-database-manage-logins.md)</span><span class="sxs-lookup"><span data-stu-id="72f76-151">Grant others access to your database: [SQL Database Authentication and Authorization: Granting Access](sql-database-manage-logins.md)</span></span>  
- <span data-ttu-id="72f76-152">Verifique se os outros podem se conectar pelo firewall: [Configurar uma regra de firewall no nível de servidor do Banco de Dados SQL do Azure usando o Portal do Azure](sql-database-configure-firewall-settings.md)</span><span class="sxs-lookup"><span data-stu-id="72f76-152">Make sure others can connect through the firewall: [Configure an Azure SQL Database server-level firewall rule using the Azure portal](sql-database-configure-firewall-settings.md)</span></span>  
- [<span data-ttu-id="72f76-153">Configurar e gerenciar o Azure Active Directory para autenticação com o Banco de Dados SQL ou o SQL Data Warehouse</span><span class="sxs-lookup"><span data-stu-id="72f76-153">Configure and manage Azure Active Directory authentication with SQL Database or SQL Data Warehouse</span></span>](sql-database-aad-authentication-configure.md)  
- [<span data-ttu-id="72f76-154">Microsoft SQL Server Data-Tier Application Framework (17.0.0 GA)</span><span class="sxs-lookup"><span data-stu-id="72f76-154">Microsoft SQL Server Data-Tier Application Framework (17.0.0 GA)</span></span>](https://www.microsoft.com/download/details.aspx?id=55088)  
- [<span data-ttu-id="72f76-155">SQLPackage.exe</span><span class="sxs-lookup"><span data-stu-id="72f76-155">SQLPackage.exe</span></span>](https://msdn.microsoft.com/library/hh550080.aspx)  
- [<span data-ttu-id="72f76-156">Importar um arquivo BACPAC para um novo Banco de Dados SQL do Azure</span><span class="sxs-lookup"><span data-stu-id="72f76-156">Import a BACPAC file to a new Azure SQL Database</span></span>](../sql-database/sql-database-import.md)  
- [<span data-ttu-id="72f76-157">Exportar um Banco de Dados SQL do Azure para um arquivo BACPAC</span><span class="sxs-lookup"><span data-stu-id="72f76-157">Export an Azure SQL database to a BACPAC file</span></span>](../sql-database/sql-database-export.md)  
- <span data-ttu-id="72f76-158">Interface C# [Interface IUniversalAuthProvider](https://msdn.microsoft.com/library/microsoft.sqlserver.dac.iuniversalauthprovider.aspx)</span><span class="sxs-lookup"><span data-stu-id="72f76-158">C# interface [IUniversalAuthProvider Interface](https://msdn.microsoft.com/library/microsoft.sqlserver.dac.iuniversalauthprovider.aspx)</span></span>  
