---
title: "Implantar e explorar um aplicativo SaaS do Wingtip multilicatário que usa o Banco de dados SQL do Azure | Microsoft Docs"
description: "Implantar e explore o aplicativo SaaS do Wingtip multilicatário, que demonstra os padrões SaaS usando o Banco de dados SQL do Azure."
keywords: tutorial do banco de dados SQL
services: sql-database
documentationcenter: 
author: stevestein
manager: jhubbard
editor: 
ms.assetid: 
ms.service: sql-database
ms.custom: scale out apps
ms.workload: data-management
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/26/2017
ms.author: sstein
ms.openlocfilehash: b09bfa8a5bc22a092e963f351e99c16d0e9a57ba
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/03/2017
---
# <a name="deploy-and-explore-a-multi-tenant-application-that-uses-azure-sql-database---wingtip-saas"></a><span data-ttu-id="f1b95-104">Implantar e explorar um aplicativo SaaS multilocatário que usa o Banco de dados SQL do Azure</span><span class="sxs-lookup"><span data-stu-id="f1b95-104">Deploy and explore a multi-tenant application that uses Azure SQL Database - Wingtip SaaS</span></span>

<span data-ttu-id="f1b95-105">Neste tutorial, você implanta e explora o aplicativo SaaS do Wingtip.</span><span class="sxs-lookup"><span data-stu-id="f1b95-105">In this tutorial, you deploy and explore the Wingtip SaaS application.</span></span> <span data-ttu-id="f1b95-106">O aplicativo usa um padrão de aplicativo SaaS de um banco de dados por locatário para atender a vários locatários.</span><span class="sxs-lookup"><span data-stu-id="f1b95-106">The application uses a database-per-tenant, SaaS application pattern, to service multiple tenants.</span></span> <span data-ttu-id="f1b95-107">O aplicativo foi projetado para demonstrar os recursos do Banco de dados SQL do Azure que habilitam de forma simples cenários SaaS.</span><span class="sxs-lookup"><span data-stu-id="f1b95-107">The application is designed to showcase features of Azure SQL Database that simplify enabling SaaS scenarios.</span></span>

<span data-ttu-id="f1b95-108">Cinco minutos depois de clicar no botão *Implantar no Azure* abaixo, você terá um aplicativo SaaS multilocatário, usando o Banco de Dados SQL, em funcionamento na nuvem.</span><span class="sxs-lookup"><span data-stu-id="f1b95-108">Five minutes after clicking the *Deploy to Azure* button below, you have a multi-tenant SaaS application, using SQL Database, up and running in the cloud.</span></span> <span data-ttu-id="f1b95-109">O aplicativo é implantado com três locatários de exemplo, cada um com seu próprio banco de dados, todos implantados em um pool elástico do SQL.</span><span class="sxs-lookup"><span data-stu-id="f1b95-109">The application is deployed with three sample tenants, each with its own database, all deployed into a SQL elastic pool.</span></span> <span data-ttu-id="f1b95-110">O aplicativo é implantado na sua assinatura do Azure, dando a você acesso completo para explorar e trabalhar com os componentes individuais do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f1b95-110">The app is deployed to your Azure subscription, giving you full access to explore and work with the individual application components.</span></span> <span data-ttu-id="f1b95-111">Os scripts de gerenciamento e o código-fonte do aplicativo estão disponíveis no repositório GitHub do WingtipSaaS.</span><span class="sxs-lookup"><span data-stu-id="f1b95-111">The application source code and management scripts are available in the WingtipSaaS GitHub repo.</span></span>


<span data-ttu-id="f1b95-112">Neste tutorial, você aprende:</span><span class="sxs-lookup"><span data-stu-id="f1b95-112">In this tutorial you learn:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="f1b95-113">Como implantar o aplicativo SaaS do Wingtip</span><span class="sxs-lookup"><span data-stu-id="f1b95-113">How to deploy the Wingtip SaaS application</span></span>
> * <span data-ttu-id="f1b95-114">Onde obter o código-fonte do aplicativo e scripts de gerenciamento</span><span class="sxs-lookup"><span data-stu-id="f1b95-114">Where to get the application source code, and management scripts</span></span>
> * <span data-ttu-id="f1b95-115">Sobre os servidores, pools e bancos de dados que constituem o aplicativo</span><span class="sxs-lookup"><span data-stu-id="f1b95-115">About the servers, pools, and databases that make up the app</span></span>
> * <span data-ttu-id="f1b95-116">Quantos locatários são mapeados para seus dados com o *catálogo*</span><span class="sxs-lookup"><span data-stu-id="f1b95-116">How tenants are mapped to their data with the *catalog*</span></span>
> * <span data-ttu-id="f1b95-117">Como provisionar um novo locatário</span><span class="sxs-lookup"><span data-stu-id="f1b95-117">How to provision a new tenant</span></span>
> * <span data-ttu-id="f1b95-118">Como monitorar a atividade de locatário no aplicativo</span><span class="sxs-lookup"><span data-stu-id="f1b95-118">How to monitor tenant activity in the app</span></span>

<span data-ttu-id="f1b95-119">Para explorar os vários padrões de design e gerenciamento de SaaS, uma [série de tutoriais relacionados](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials) que aproveita essa implantação inicial está disponível.</span><span class="sxs-lookup"><span data-stu-id="f1b95-119">To explore various SaaS design and management patterns, a [series of related tutorials](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials) is available that build upon this initial deployment.</span></span> <span data-ttu-id="f1b95-120">Ao percorrer os tutoriais, aprofunde-se nos scripts fornecidos e examine como os diferentes padrões de SaaS são implementados.</span><span class="sxs-lookup"><span data-stu-id="f1b95-120">While going through the tutorials, dive into the provided scripts, and examine how the different SaaS patterns are implemented.</span></span> <span data-ttu-id="f1b95-121">Percorra os scripts em cada tutorial para obter uma maior compreensão de como implementar os diversos recursos de Banco de Dados SQL que simplificam o desenvolvimento de aplicativos SaaS.</span><span class="sxs-lookup"><span data-stu-id="f1b95-121">Step through the scripts in each tutorial to gain a deeper understanding how to implement the many SQL Database features that simplify developing SaaS applications.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="f1b95-122">Pré-requisitos</span><span class="sxs-lookup"><span data-stu-id="f1b95-122">Prerequisites</span></span>

<span data-ttu-id="f1b95-123">Para concluir este tutorial, verifique se todos os pré-requisitos a seguir são atendidos:</span><span class="sxs-lookup"><span data-stu-id="f1b95-123">To complete this tutorial, make sure the following prerequisites are completed:</span></span>

* <span data-ttu-id="f1b95-124">O Azure PowerShell está instalado.</span><span class="sxs-lookup"><span data-stu-id="f1b95-124">Azure PowerShell is installed.</span></span> <span data-ttu-id="f1b95-125">Para obter detalhes, consulte [Introdução ao Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps)</span><span class="sxs-lookup"><span data-stu-id="f1b95-125">For details, see [Getting started with Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps)</span></span>

## <a name="deploy-the-wingtip-saas-application"></a><span data-ttu-id="f1b95-126">Implantar o aplicativo SaaS do Wingtip</span><span class="sxs-lookup"><span data-stu-id="f1b95-126">Deploy the Wingtip SaaS application</span></span>

<span data-ttu-id="f1b95-127">Implantar o aplicativo SaaS do Wingtip:</span><span class="sxs-lookup"><span data-stu-id="f1b95-127">Deploy the Wingtip SaaS app:</span></span>

1. <span data-ttu-id="f1b95-128">Clicar no botão **Implantar no Azure** abre o portal do Azure para o modelo de implantação SaaS do Wingtip.</span><span class="sxs-lookup"><span data-stu-id="f1b95-128">Clicking the **Deploy to Azure** button opens the Azure portal to the Wingtip SaaS deployment template.</span></span> <span data-ttu-id="f1b95-129">O modelo requer dois valores de parâmetros; um nome para um novo grupo de recursos e um nome de usuário que distingue esta implantação de outras implantações do aplicativo SaaS do Wingtip.</span><span class="sxs-lookup"><span data-stu-id="f1b95-129">The template requires two parameter values; a name for a new resource group, and a user name that distinguishes this deployment from other deployments of the Wingtip SaaS app.</span></span> <span data-ttu-id="f1b95-130">A próxima etapa fornece detalhes para definir esses valores.</span><span class="sxs-lookup"><span data-stu-id="f1b95-130">The next step provides details for setting these values.</span></span>

   <span data-ttu-id="f1b95-131">Certifique-se de observar os valores exatos que usa, pois você precisará inseri-los em um arquivo de configuração.</span><span class="sxs-lookup"><span data-stu-id="f1b95-131">Make sure to note the exact values that you use, because you will need to enter them into a configuration file later.</span></span>

   <a href="http://aka.ms/deploywtpapp" target="_blank"><img src="http://azuredeploy.net/deploybutton.png"/></a>

1. <span data-ttu-id="f1b95-132">Insira os valores de parâmetros necessários para a implantação:</span><span class="sxs-lookup"><span data-stu-id="f1b95-132">Enter required parameter values for the deployment:</span></span>

    > [!IMPORTANT]
    > <span data-ttu-id="f1b95-133">Algumas autenticações e firewalls de servidor estão intencionalmente desprotegidos para fins de demonstração.</span><span class="sxs-lookup"><span data-stu-id="f1b95-133">Some authentication, and server firewalls are intentionally unsecured for demonstration purposes.</span></span> <span data-ttu-id="f1b95-134">**Criar um novo grupo de recursos** e não usar grupos de recursos, servidores ou pools existentes.</span><span class="sxs-lookup"><span data-stu-id="f1b95-134">**Create a new resource group**, and do not use existing resource groups, servers, or pools.</span></span> <span data-ttu-id="f1b95-135">Não use este aplicativo ou todos os recursos que cria, para a produção.</span><span class="sxs-lookup"><span data-stu-id="f1b95-135">Do not use this application, or any resources it creates, for production.</span></span> <span data-ttu-id="f1b95-136">Exclua esse grupo de recursos quando tiver terminado com o aplicativo para interromper a cobrança relacionada.</span><span class="sxs-lookup"><span data-stu-id="f1b95-136">Delete this resource group when you are finished with the application to stop related billing.</span></span>

    * <span data-ttu-id="f1b95-137">**Grupo de recursos** – selecione **Criar novo** e forneça um **Nome** para o grupo de recursos.</span><span class="sxs-lookup"><span data-stu-id="f1b95-137">**Resource group** - Select **Create new** and provide a **Name** for the resource group.</span></span> <span data-ttu-id="f1b95-138">Selecione uma **Localização** na lista suspensa.</span><span class="sxs-lookup"><span data-stu-id="f1b95-138">Select a **Location** from the drop-down list.</span></span>
    * <span data-ttu-id="f1b95-139">**Usuário** - Alguns recursos exigem nomes que são globalmente exclusivos.</span><span class="sxs-lookup"><span data-stu-id="f1b95-139">**User** - Some resources require names that are globally unique.</span></span> <span data-ttu-id="f1b95-140">Para garantir a exclusividade, toda vez que você implanta, o aplicativo fornece um valor para diferenciar os recursos que você cria dos recursos criados por outros usuários que estão implantando o aplicativo Wingtip.</span><span class="sxs-lookup"><span data-stu-id="f1b95-140">To ensure uniqueness, each time you deploy the application provide a value to differentiate resources you create, from resources created by any other deployment of the Wingtip application.</span></span> <span data-ttu-id="f1b95-141">Recomenda-se usar um nome de **Usuário** curto, como suas iniciais com algum número (por exemplo, *bg1*) e, em seguida, usá-lo no nome do grupo de recursos (por exemplo, *wingtip-bg1*).</span><span class="sxs-lookup"><span data-stu-id="f1b95-141">It’s recommended to use a short **User** name, such as your initials plus a number (for example, *bg1*), and then use that in the resource group name (for example, *wingtip-bg1*).</span></span> <span data-ttu-id="f1b95-142">O parâmetro **Usuário** só pode conter letras, números e hifens (sem espaços).</span><span class="sxs-lookup"><span data-stu-id="f1b95-142">The **User** parameter can only contain letters, numbers, and hyphens (no spaces).</span></span> <span data-ttu-id="f1b95-143">O primeiro e último caracteres devem ser uma letra ou um número (recomenda-se todas em minúsculas).</span><span class="sxs-lookup"><span data-stu-id="f1b95-143">The first and last character must be a letter or a number (all lowercase is recommended).</span></span>


1. <span data-ttu-id="f1b95-144">**Implantar o aplicativo**.</span><span class="sxs-lookup"><span data-stu-id="f1b95-144">**Deploy the application**.</span></span>

    * <span data-ttu-id="f1b95-145">Clique se você concordar com os termos e condições.</span><span class="sxs-lookup"><span data-stu-id="f1b95-145">Click to agree to the terms and conditions.</span></span>
    * <span data-ttu-id="f1b95-146">Clique em **Comprar**.</span><span class="sxs-lookup"><span data-stu-id="f1b95-146">Click **Purchase**.</span></span>

1. <span data-ttu-id="f1b95-147">Monitore o status da implantação clicando em **Notificações** (o ícone de sino à direita da caixa de pesquisa).</span><span class="sxs-lookup"><span data-stu-id="f1b95-147">Monitor deployment status by clicking **Notifications** (the bell icon right of the search box).</span></span> <span data-ttu-id="f1b95-148">A implantação do aplicativo Wingtip SaaS leva aproximadamente cinco minutos.</span><span class="sxs-lookup"><span data-stu-id="f1b95-148">Deploying the Wingtip SaaS app takes approximately five minutes.</span></span>

   ![implantação bem-sucedida](media/sql-database-saas-tutorial/succeeded.png)

## <a name="download-and-unblock-the-wingtip-saas-scripts"></a><span data-ttu-id="f1b95-150">Baixar e desbloquear os scripts SaaS do Wingtip</span><span class="sxs-lookup"><span data-stu-id="f1b95-150">Download and unblock the Wingtip SaaS scripts</span></span>

<span data-ttu-id="f1b95-151">Enquanto o aplicativo for implantado, baixe os scripts de gerenciamento e de código-fonte.</span><span class="sxs-lookup"><span data-stu-id="f1b95-151">While the application is deploying, download the source code and management scripts.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="f1b95-152">Conteúdos executáveis (scripts, dlls) podem ser bloqueados pelo Windows quando arquivos zip são baixados de uma fonte externa e extraídos.</span><span class="sxs-lookup"><span data-stu-id="f1b95-152">Executable contents (scripts, dlls) may be blocked by Windows when zip files are downloaded from an external source and extracted.</span></span> <span data-ttu-id="f1b95-153">Ao extrair os scripts de um arquivo zip, siga as etapas abaixo para desbloquear o arquivo. zip antes da extração.</span><span class="sxs-lookup"><span data-stu-id="f1b95-153">When extracting the scripts from a zip file, follow the steps below to unblock the .zip file before extracting.</span></span> <span data-ttu-id="f1b95-154">Isso garante que os scripts podem ser executados.</span><span class="sxs-lookup"><span data-stu-id="f1b95-154">This ensures the scripts are allowed to run.</span></span>

1. <span data-ttu-id="f1b95-155">Navegue até [o repositório github SaaS do Wingtip](https://github.com/Microsoft/WingtipSaaS).</span><span class="sxs-lookup"><span data-stu-id="f1b95-155">Browse to [the Wingtip SaaS github repo](https://github.com/Microsoft/WingtipSaaS).</span></span>
1. <span data-ttu-id="f1b95-156">Clique em **Clonar ou baixar**.</span><span class="sxs-lookup"><span data-stu-id="f1b95-156">Click **Clone or download**.</span></span>
1. <span data-ttu-id="f1b95-157">Clique em **Baixar ZIP** e salve o arquivo.</span><span class="sxs-lookup"><span data-stu-id="f1b95-157">Click **Download ZIP** and save the file.</span></span>
1. <span data-ttu-id="f1b95-158">Clique com botão direito no arquivo **WingtipSaaS master.zip** e selecione **Propriedades**.</span><span class="sxs-lookup"><span data-stu-id="f1b95-158">Right-click the **WingtipSaaS-master.zip** file, and select **Properties**.</span></span>
1. <span data-ttu-id="f1b95-159">Na guia **Geral**, selecione **Desbloquear** e clique em **Aplicar**.</span><span class="sxs-lookup"><span data-stu-id="f1b95-159">On the **General** tab, select **Unblock**, and click **Apply**.</span></span>
1. <span data-ttu-id="f1b95-160">Clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="f1b95-160">Click **OK**.</span></span>
1. <span data-ttu-id="f1b95-161">Extraia os arquivos.</span><span class="sxs-lookup"><span data-stu-id="f1b95-161">Extract the files.</span></span>

<span data-ttu-id="f1b95-162">Os scripts estão localizados na pasta *... \\módulos de aprendizado\\WingtipSaaS mester*.</span><span class="sxs-lookup"><span data-stu-id="f1b95-162">Scripts are located in the *..\\WingtipSaaS-master\\Learning Modules* folder.</span></span>

## <a name="update-the-configuration-file-for-this-deployment"></a><span data-ttu-id="f1b95-163">Atualize o arquivo de configuração para sua implantação</span><span class="sxs-lookup"><span data-stu-id="f1b95-163">Update the configuration file for this deployment</span></span>

<span data-ttu-id="f1b95-164">Antes de executar os scripts, defina o *grupo de recursos* e valores de *usuário* em **UserConfig.psm1**.</span><span class="sxs-lookup"><span data-stu-id="f1b95-164">Before running any scripts, set the *resource group* and *user* values in **UserConfig.psm1**.</span></span> <span data-ttu-id="f1b95-165">Defina essas variáveis para os valores definidos durante a implantação.</span><span class="sxs-lookup"><span data-stu-id="f1b95-165">Set these variables to the values you set during deployment.</span></span>

1. <span data-ttu-id="f1b95-166">Abra ...\\Módulos de aprendizado\\*UserConfig.psm1* no *ISE do PowerShell*</span><span class="sxs-lookup"><span data-stu-id="f1b95-166">Open ...\\Learning Modules\\*UserConfig.psm1* in the *PowerShell ISE*</span></span>
1. <span data-ttu-id="f1b95-167">Atualize *ResourceGroupName* e *Nomeie* com os valores específicos para sua implantação (somente nas linhas 10 e 11).</span><span class="sxs-lookup"><span data-stu-id="f1b95-167">Update *ResourceGroupName* and *Name* with the specific values for your deployment (on lines 10 and 11 only).</span></span>
1. <span data-ttu-id="f1b95-168">Salve as alterações!</span><span class="sxs-lookup"><span data-stu-id="f1b95-168">Save the changes!</span></span>

<span data-ttu-id="f1b95-169">Definir esses valores aqui simplesmente impede que você precise atualizar esses valores específicos de implantação em cada script.</span><span class="sxs-lookup"><span data-stu-id="f1b95-169">Setting this here simply keeps you from having to update these deployment-specific values in every script.</span></span>

## <a name="run-the-application"></a><span data-ttu-id="f1b95-170">Executar o aplicativo</span><span class="sxs-lookup"><span data-stu-id="f1b95-170">Run the application</span></span>

<span data-ttu-id="f1b95-171">O aplicativo demonstra locais, como teatros, clubes de jazz, clubes esportivos, que hospedam eventos.</span><span class="sxs-lookup"><span data-stu-id="f1b95-171">The app showcases venues, such as concert halls, jazz clubs, sports clubs, that host events.</span></span> <span data-ttu-id="f1b95-172">Os locais se registram como os clientes (ou locatários) da plataforma Wingtip para uma maneira fácil de listar eventos e vender ingressos.</span><span class="sxs-lookup"><span data-stu-id="f1b95-172">Venues register as customers (or tenants) of the Wingtip platform, for an easy way to list events and sell tickets.</span></span> <span data-ttu-id="f1b95-173">Cada local obtém um aplicativo Web personalizado para gerenciar e listar seus eventos e vender ingressos, independente e isolado de outros locatários.</span><span class="sxs-lookup"><span data-stu-id="f1b95-173">Each venue gets a personalized web app to manage and list their events and sell tickets, independent and isolated from other tenants.</span></span> <span data-ttu-id="f1b95-174">Nos bastidores, cada locatário obtém um banco de dados SQL implantado em um pool elástico do SQL.</span><span class="sxs-lookup"><span data-stu-id="f1b95-174">Under the covers, each tenant gets a SQL database deployed into a SQL elastic pool.</span></span>

<span data-ttu-id="f1b95-175">Um **Hub de Eventos** central fornece uma lista de URLs de locatários específica da sua implantação.</span><span class="sxs-lookup"><span data-stu-id="f1b95-175">A central **Events Hub** provides a list of tenant URLs specific to your deployment.</span></span>

1. <span data-ttu-id="f1b95-176">Abra o _Hub de Eventos_ em seu navegador da Web: http://events.wtp.&lt;USER&gt;.trafficmanager.net (substitua pelo seu nome de usuário de implantação):</span><span class="sxs-lookup"><span data-stu-id="f1b95-176">Open the _Events Hub_ in your web browser: http://events.wtp.&lt;USER&gt;.trafficmanager.net (replace with your deployment's user name):</span></span>

    ![hub de eventos](media/sql-database-saas-tutorial/events-hub.png)

1. <span data-ttu-id="f1b95-178">Clique em **Fabrikam Jazz Club** no *Hub de Eventos*.</span><span class="sxs-lookup"><span data-stu-id="f1b95-178">Click **Fabrikam Jazz Club** in the *Events Hub*.</span></span>

   ![Eventos](./media/sql-database-saas-tutorial/fabrikam.png)


<span data-ttu-id="f1b95-180">Para controlar a distribuição das solicitações de entrada, o aplicativo usa o [*Gerenciador de Tráfego do Azure*](https://docs.microsoft.com/azure/traffic-manager/traffic-manager-overview).</span><span class="sxs-lookup"><span data-stu-id="f1b95-180">To control the distribution of incoming requests, the app uses [*Azure Traffic Manager*](https://docs.microsoft.com/azure/traffic-manager/traffic-manager-overview).</span></span> <span data-ttu-id="f1b95-181">As páginas de eventos, que são específicas do locatário, exigem que os nomes de locatário sejam incluídos nas URLs.</span><span class="sxs-lookup"><span data-stu-id="f1b95-181">The events pages, which are tenant-specific, require that tenant names are included in the URLs.</span></span> <span data-ttu-id="f1b95-182">Todas as URLs de locatário incluem o seu valor específico de *User* e seguem este formato: http://events.wtp.&lt;USER&gt;.trafficmanager.net/*fabrikamjazzclub*.</span><span class="sxs-lookup"><span data-stu-id="f1b95-182">All the tenant URLs include your specific *User* value and follow this format: http://events.wtp.&lt;USER&gt;.trafficmanager.net/*fabrikamjazzclub*.</span></span> <span data-ttu-id="f1b95-183">O aplicativo de eventos analisa o nome do locatário com base na URL e o utiliza para criar uma chave para acessar um catálogo usando o [*gerenciamento de mapa de fragmentos*](https://docs.microsoft.com/azure/sql-database/sql-database-elastic-scale-shard-map-management).</span><span class="sxs-lookup"><span data-stu-id="f1b95-183">The events app parses the tenant name from the URL and uses it to create a key to access a catalog using [*shard map management*](https://docs.microsoft.com/azure/sql-database/sql-database-elastic-scale-shard-map-management).</span></span> <span data-ttu-id="f1b95-184">O catálogo mapeia a chave para o local do banco de dados do locatário.</span><span class="sxs-lookup"><span data-stu-id="f1b95-184">The catalog maps the key to the tenant's database location.</span></span> <span data-ttu-id="f1b95-185">O **Hub de Eventos** usa metadados estendidos no catálogo para recuperar o nome do locatário associado a cada banco de dados para fornecer a lista de URLs.</span><span class="sxs-lookup"><span data-stu-id="f1b95-185">The **Events Hub** uses extended metadata in the catalog to retrieve the tenant’s name associated with each database to provide the list of URLs.</span></span>

<span data-ttu-id="f1b95-186">Em um ambiente de produção, você normalmente criaria um registro DNS CNAME para [*apontar um domínio de Internet da empresa*](https://docs.microsoft.com/azure/traffic-manager/traffic-manager-point-internet-domain) para o perfil do gerenciador de tráfego.</span><span class="sxs-lookup"><span data-stu-id="f1b95-186">In a production environment, you would typically create a CNAME DNS record to [*point a company internet domain*](https://docs.microsoft.com/azure/traffic-manager/traffic-manager-point-internet-domain) to the traffic manager profile.</span></span>

## <a name="start-generating-load-on-the-tenant-databases"></a><span data-ttu-id="f1b95-187">Iniciar a geração de carga nos bancos de dados de locatário</span><span class="sxs-lookup"><span data-stu-id="f1b95-187">Start generating load on the tenant databases</span></span>

<span data-ttu-id="f1b95-188">Agora que o aplicativo está implantado, vamos colocá-lo em funcionamento!</span><span class="sxs-lookup"><span data-stu-id="f1b95-188">Now that the app is deployed, let’s put it to work!</span></span> <span data-ttu-id="f1b95-189">O script do PowerShell *Demo-LoadGenerator* começa uma execução de carga de trabalho em todos os bancos de dados de locatário.</span><span class="sxs-lookup"><span data-stu-id="f1b95-189">The *Demo-LoadGenerator* PowerShell script starts a workload running against all tenant databases.</span></span> <span data-ttu-id="f1b95-190">A carga real em um aplicativo SaaS é normalmente esporádica e imprevisível.</span><span class="sxs-lookup"><span data-stu-id="f1b95-190">The real-world load on many SaaS apps is typically sporadic and unpredictable.</span></span> <span data-ttu-id="f1b95-191">Para simular esse tipo de carga, o gerador produz uma carga distribuída em todos os locatários com intermitências aleatórias em cada locatário, que ocorrem em intervalos aleatórios.</span><span class="sxs-lookup"><span data-stu-id="f1b95-191">To simulate this type of load, the generator produces a load distributed across all tenants, with randomized bursts on each tenant occurring at randomized intervals.</span></span> <span data-ttu-id="f1b95-192">Por isso, levará vários minutos para que o padrão de carga surja, portanto, é melhor permitir que o gerador seja executado por pelo menos três ou quatro minutos antes de monitorar a carga.</span><span class="sxs-lookup"><span data-stu-id="f1b95-192">Because of this it takes several minutes for the load pattern to emerge, so it’s best to let the generator run for at least three or four minutes before monitoring the load.</span></span>

1. <span data-ttu-id="f1b95-193">No *ISE do PowerShell*, abra o script ...\\Módulos de Aprendizado\\Utilitários\\*Demo-LoadGenerator.ps1*.</span><span class="sxs-lookup"><span data-stu-id="f1b95-193">In the *PowerShell ISE*, open the ...\\Learning Modules\\Utilities\\*Demo-LoadGenerator.ps1* script.</span></span>
1. <span data-ttu-id="f1b95-194">Pressione **F5** para executar o script e iniciar o gerador de carga (deixe os valores de parâmetro padrão por enquanto).</span><span class="sxs-lookup"><span data-stu-id="f1b95-194">Press **F5** to run the script and start the load generator (leave the default parameter values for now).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="f1b95-195">Para executar outros scripts, abra uma nova janela do ISE do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="f1b95-195">To run other scripts, open a new PowerShell ISE window.</span></span> <span data-ttu-id="f1b95-196">O gerador de carga está sendo executado como uma série de trabalhos em sua sessão local do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="f1b95-196">The load generator is running as a series of jobs in your local PowerShell session.</span></span> <span data-ttu-id="f1b95-197">O script *Demo-LoadGenerator.ps1* inicia o script do gerador de carga real, que é executado como uma tarefa em primeiro plano além de uma série de trabalhos de geração de cargas em segundo plano.</span><span class="sxs-lookup"><span data-stu-id="f1b95-197">The *Demo-LoadGenerator.ps1* script kicks off the actual load generator script, which runs as a foreground task plus a series of background load-generation jobs.</span></span> <span data-ttu-id="f1b95-198">Um trabalho do gerador de carga é chamado para cada banco de dados registrado no catálogo.</span><span class="sxs-lookup"><span data-stu-id="f1b95-198">A load-generator job is invoked for each database registered in the catalog.</span></span> <span data-ttu-id="f1b95-199">Os trabalhos estão em execução na sua sessão local do PowerShell, então fechar a sessão do PowerShell interrompe todos os trabalhos.</span><span class="sxs-lookup"><span data-stu-id="f1b95-199">The jobs are running in your local PowerShell session, so closing the PowerShell session stops all jobs.</span></span> <span data-ttu-id="f1b95-200">Se você suspender seu computador, a geração de carga será pausada e continuará quando você ativá-lo novamente.</span><span class="sxs-lookup"><span data-stu-id="f1b95-200">If you suspend your machine, load generation is paused and will resume when you wake up your machine.</span></span>

<span data-ttu-id="f1b95-201">Depois que o gerador de carga invoca os trabalhos de geração de carga para cada locatário, a tarefa em primeiro plano permanece em um estado de invocação de trabalho, onde ela inicia trabalhos de plano de fundo adicionais para quaisquer novos locatários que forem provisionados subsequentemente.</span><span class="sxs-lookup"><span data-stu-id="f1b95-201">Once the load generator invokes load-generation jobs for each tenant, the foreground task remains in a job-invoking state, where it starts additional background jobs for any new tenants that are subsequently provisioned.</span></span> <span data-ttu-id="f1b95-202">Você pode usar *Ctrl-C* ou pressionar o botão *Parar* para interromper a tarefa em primeiro plano, mas trabalhos em segundo plano existentes continuarão gerando carga em cada banco de dados.</span><span class="sxs-lookup"><span data-stu-id="f1b95-202">You can use *Ctrl-C* or press the *Stop* button to stop the foreground task, but existing background jobs will continue generating load on each database.</span></span> <span data-ttu-id="f1b95-203">Se você precisar monitorar e controlar os trabalhos em segundo plano, use *Get-Job*, *Receive-Job* e *Stop-Job*.</span><span class="sxs-lookup"><span data-stu-id="f1b95-203">If you need to monitor and control the background jobs, use *Get-Job*, *Receive-Job* and *Stop-Job*.</span></span> <span data-ttu-id="f1b95-204">Enquanto a tarefa em primeiro plano está em execução, não é possível usar a mesma sessão do PowerShell para executar outros scripts.</span><span class="sxs-lookup"><span data-stu-id="f1b95-204">While the foreground task is running you cannot use the same PowerShell session to execute other scripts.</span></span> <span data-ttu-id="f1b95-205">Para executar outros scripts, abra uma nova janela do ISE do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="f1b95-205">To run other scripts, open a new PowerShell ISE window.</span></span>

<span data-ttu-id="f1b95-206">Se deseja reiniciar a sessão do gerador de carga, por exemplo, com parâmetros diferentes, você pode interromper a tarefa em primeiro plano e, em seguida, executar novamente o script *Demo-LoadGenerator.ps1*.</span><span class="sxs-lookup"><span data-stu-id="f1b95-206">If you want to restart the load generator session, for example with different parameters, you can stop the foreground task and then re-run the *Demo-LoadGenerator.ps1* script.</span></span> <span data-ttu-id="f1b95-207">Executando novamente o *Demo-LoadGenerator.ps1*, primeiro ele para os trabalhos atualmente em execução e, em seguida, reinicia o gerador, que inicia um novo conjunto de trabalhos usando os parâmetros atuais.</span><span class="sxs-lookup"><span data-stu-id="f1b95-207">Re-running *Demo-LoadGenerator.ps1* first stops any currently running jobs, and then restarts the generator, which kicks off a new set of jobs using the current parameters.</span></span>

<span data-ttu-id="f1b95-208">Por enquanto, deixe o gerador de carga em execução no estado de invocação de trabalho.</span><span class="sxs-lookup"><span data-stu-id="f1b95-208">For now, leave the load generator running in the job-invoking state.</span></span>


## <a name="provision-a-new-tenant"></a><span data-ttu-id="f1b95-209">Provisionar um novo locatário</span><span class="sxs-lookup"><span data-stu-id="f1b95-209">Provision a new tenant</span></span>

<span data-ttu-id="f1b95-210">A implantação inicial cria três locatários de exemplo, mas vamos criar outro locatário para ver como isso afeta o aplicativo implantado.</span><span class="sxs-lookup"><span data-stu-id="f1b95-210">The initial deployment creates three sample tenants, but let’s create another tenant to see how this impacts the deployed application.</span></span> <span data-ttu-id="f1b95-211">O fluxo de trabalho de locatários de provisionamento SaaS do Wingtip é descrito em detalhes no [tutorial Provisionamento e catálogo](sql-database-saas-tutorial-provision-and-catalog.md).</span><span class="sxs-lookup"><span data-stu-id="f1b95-211">The Wingtip SaaS provisioning-tenants workflow is detailed in the [Provision and catalog tutorial](sql-database-saas-tutorial-provision-and-catalog.md).</span></span> <span data-ttu-id="f1b95-212">Nesta etapa, você cria rapidamente um novo locatário.</span><span class="sxs-lookup"><span data-stu-id="f1b95-212">In this step, you quickly create a new tenant.</span></span>

1. <span data-ttu-id="f1b95-213">Abra ...\\Módulos de aprendizado\Provisionar e catalogar\\*Demo-ProvisionAndCatalog.ps1* no *ISE do PowerShell*.</span><span class="sxs-lookup"><span data-stu-id="f1b95-213">Open ...\\Learning Modules\Provision and Catalog\\*Demo-ProvisionAndCatalog.ps1* in the *PowerShell ISE*.</span></span>
1. <span data-ttu-id="f1b95-214">Pressione **F5** para executar o script (mantenha os valores padrão por enquanto).</span><span class="sxs-lookup"><span data-stu-id="f1b95-214">Press **F5** to run the script (leave the default values for now).</span></span>

   > [!NOTE]
   > <span data-ttu-id="f1b95-215">Usam vários scripts SaaS Wingtip *$PSScriptRoot* para permitir a navegação pelas pastas para chamar funções em outros scripts.</span><span class="sxs-lookup"><span data-stu-id="f1b95-215">Many Wingtip SaaS scripts use *$PSScriptRoot* to allow navigating folders to call functions in other scripts.</span></span> <span data-ttu-id="f1b95-216">Essa variável é avaliada apenas quando o script é executado, pressionando **F5**.</span><span class="sxs-lookup"><span data-stu-id="f1b95-216">This variable is only evaluated when the script is executed by pressing **F5**.</span></span>  <span data-ttu-id="f1b95-217">Realçar e executar uma seleção (**F8**) pode resultar em erros, então pressione **F5** ao executar scripts.</span><span class="sxs-lookup"><span data-stu-id="f1b95-217">Highlighting and running a selection (**F8**) can result in errors, so press **F5** when running scripts.</span></span>

<span data-ttu-id="f1b95-218">O novo banco de dados de locatário é criado em um pool elástico do SQL, inicializado e registrado no catálogo.</span><span class="sxs-lookup"><span data-stu-id="f1b95-218">The new tenant database is created in a SQL elastic pool, initialized and registered in the catalog.</span></span> <span data-ttu-id="f1b95-219">Após o provisionamento bem-sucedido, o novo site de vendas de ingresso do locatário *Evento s*aparece no seu navegador:</span><span class="sxs-lookup"><span data-stu-id="f1b95-219">After successful provisioning, the new tenant's ticket-selling *Events* site appears in your browser:</span></span>

![Novo locatário](./media/sql-database-saas-tutorial/red-maple-racing.png)

<span data-ttu-id="f1b95-221">Atualize o *Hub de Eventos* e o novo locatário agora está na lista.</span><span class="sxs-lookup"><span data-stu-id="f1b95-221">Refresh the *Events Hub* and the new tenant now appears in the list.</span></span>


## <a name="explore-the-servers-pools-and-tenant-databases"></a><span data-ttu-id="f1b95-222">Explorar os servidores, os pools e os bancos de dados de locatário</span><span class="sxs-lookup"><span data-stu-id="f1b95-222">Explore the servers, pools, and tenant databases</span></span>

<span data-ttu-id="f1b95-223">Agora que você começou a executar uma carga na coleção de locatários, vamos analisar alguns dos recursos que foram implantados:</span><span class="sxs-lookup"><span data-stu-id="f1b95-223">Now that you've started running a load against the collection of tenants, let’s look at some of the resources that were deployed:</span></span>

1. <span data-ttu-id="f1b95-224">No [Portal do Azure](http://portal.azure.com), navegue até sua lista de servidores SQL e abra o servidor **catálogo-&lt;USER&gt;**.</span><span class="sxs-lookup"><span data-stu-id="f1b95-224">In the [Azure portal](http://portal.azure.com), browse to your list of SQL servers and open the **catalog-&lt;USER&gt;** server.</span></span> <span data-ttu-id="f1b95-225">O servidor de catálogo contém dois bancos de dados.</span><span class="sxs-lookup"><span data-stu-id="f1b95-225">The catalog server contains two databases.</span></span> <span data-ttu-id="f1b95-226">O **tenantcatalog** e o **basetenantdb** (um banco de dados de modelo ou *ouro* vazio que foi copiado para criar novos locatários).</span><span class="sxs-lookup"><span data-stu-id="f1b95-226">The **tenantcatalog**, and the **basetenantdb** (an empty *golden* or template database that is copied to create new tenants).</span></span>

   ![databases](./media/sql-database-saas-tutorial/databases.png)

1. <span data-ttu-id="f1b95-228">Volte para sua lista de servidores SQL e abra o servidor **tenants1-&lt;USER&gt;** que contém os bancos de dados de locatário.</span><span class="sxs-lookup"><span data-stu-id="f1b95-228">Go back to your list of SQL servers and open the **tenants1-&lt;USER&gt;** server that holds the tenant databases.</span></span> <span data-ttu-id="f1b95-229">Cada banco de dados de locatário é um banco de dados _elástico padrão_ em um pool padrão de 50 eDTU.</span><span class="sxs-lookup"><span data-stu-id="f1b95-229">Each tenant database is an _Elastic Standard_ database in a 50 eDTU standard pool.</span></span> <span data-ttu-id="f1b95-230">Observe também que há um banco de dados _Red Maple Racing_, o banco de dados de locatário que você provisionou anteriormente.</span><span class="sxs-lookup"><span data-stu-id="f1b95-230">Also notice there is a _Red Maple Racing_ database, the tenant database you provisioned previously.</span></span>

   ![Servidor](./media/sql-database-saas-tutorial/server.png)

## <a name="monitor-the-pool"></a><span data-ttu-id="f1b95-232">Monitorar o pool</span><span class="sxs-lookup"><span data-stu-id="f1b95-232">Monitor the pool</span></span>

<span data-ttu-id="f1b95-233">Se o gerador de carga estiver sendo executado por vários minutos, dados suficientes deverão estar disponíveis para começar a examinar alguns dos recursos de monitoramento incorporados em pools e bancos de dados.</span><span class="sxs-lookup"><span data-stu-id="f1b95-233">If the load generator has been running for several minutes, enough data should be available to start looking at some of the monitoring capabilities built into pools and databases.</span></span>

1. <span data-ttu-id="f1b95-234">Navegue até **tenants1 -&lt;USER&gt;** do servidor e clique em **Pool1** para exibir a utilização de recursos para o pool (o gerador de carga foi executado em uma hora nos gráficos a seguir):</span><span class="sxs-lookup"><span data-stu-id="f1b95-234">Browse to the server **tenants1-&lt;USER&gt;**, and click **Pool1** to view resource utilization for the pool (the load generator ran for an hour in the following charts):</span></span>

   ![monitorar pool](./media/sql-database-saas-tutorial/monitor-pool.png)

<span data-ttu-id="f1b95-236">O que esses dois gráficos bem ilustram, é como os pools elásticos e o Banco de Dados SQL são bem adequados para cargas de trabalho de aplicativos SaaS.</span><span class="sxs-lookup"><span data-stu-id="f1b95-236">What these two charts nicely illustrate, is how well suited elastic pools and SQL Database are for SaaS application workloads.</span></span> <span data-ttu-id="f1b95-237">Quatro bancos de dados que estão, cada um, atingindo picos de até 40 eDTUs tem suporte facilmente em um pool de 50 eDTU.</span><span class="sxs-lookup"><span data-stu-id="f1b95-237">Four databases that are each bursting to as much as 40 eDTUs are easily being supported in a 50 eDTU pool.</span></span> <span data-ttu-id="f1b95-238">Se eles foram provisionados como bancos de dados independentes, cada um deles precisa ser um S2 (50 DTU) para dar suporte a intermitências.</span><span class="sxs-lookup"><span data-stu-id="f1b95-238">If they were provisioned as standalone databases, they would each need to be an S2 (50 DTU) to support the bursts.</span></span> <span data-ttu-id="f1b95-239">O custo de 4 bancos de dados independentes S2 seria de quase 3 vezes o preço do pool e o pool ainda teria bastante espaço para muitos bancos de dados mais.</span><span class="sxs-lookup"><span data-stu-id="f1b95-239">The cost of 4 standalone S2 databases would be nearly 3 times the price of the pool, and the pool still has plenty of headroom for many more databases.</span></span> <span data-ttu-id="f1b95-240">Em situações reais, os clientes do Banco de dados SQL estão executando atualmente até 500 bancos de dados em 200 pools de eDTU.</span><span class="sxs-lookup"><span data-stu-id="f1b95-240">In real-world situations, SQL Database customers are currently running up to 500 databases in 200 eDTU pools.</span></span> <span data-ttu-id="f1b95-241">Para obter mais informações, consulte o [tutorial de monitoramento de desempenho](sql-database-saas-tutorial-performance-monitoring.md).</span><span class="sxs-lookup"><span data-stu-id="f1b95-241">For more information, see the [performance monitoring tutorial](sql-database-saas-tutorial-performance-monitoring.md).</span></span>


## <a name="next-steps"></a><span data-ttu-id="f1b95-242">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="f1b95-242">Next steps</span></span>

<span data-ttu-id="f1b95-243">Neste tutorial, você aprendeu:</span><span class="sxs-lookup"><span data-stu-id="f1b95-243">In this tutorial you learned:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="f1b95-244">Como implantar o aplicativo SaaS do Wingtip</span><span class="sxs-lookup"><span data-stu-id="f1b95-244">How to deploy the Wingtip SaaS application</span></span>
> * <span data-ttu-id="f1b95-245">Sobre os servidores, pools e bancos de dados que constituem o aplicativo</span><span class="sxs-lookup"><span data-stu-id="f1b95-245">About the servers, pools, and databases that make up the app</span></span>
> * <span data-ttu-id="f1b95-246">Que os locatários são mapeados para seus dados com o *catálogo*</span><span class="sxs-lookup"><span data-stu-id="f1b95-246">Tenants are mapped to their data with the *catalog*</span></span>
> * <span data-ttu-id="f1b95-247">Como provisionar novos locatários</span><span class="sxs-lookup"><span data-stu-id="f1b95-247">How to provision new tenants</span></span>
> * <span data-ttu-id="f1b95-248">Como exibir a utilização do pool para monitorar a atividade do locatário</span><span class="sxs-lookup"><span data-stu-id="f1b95-248">How to view pool utilization to monitor tenant activity</span></span>
> * <span data-ttu-id="f1b95-249">Como excluir recursos de exemplo para interromper a cobrança relacionada</span><span class="sxs-lookup"><span data-stu-id="f1b95-249">How to delete sample resources to stop related billing</span></span>

<span data-ttu-id="f1b95-250">Agora, tente fazer o [Tutorial para provisionar e catalogar](sql-database-saas-tutorial-provision-and-catalog.md)</span><span class="sxs-lookup"><span data-stu-id="f1b95-250">Now try the [Provision and catalog tutorial](sql-database-saas-tutorial-provision-and-catalog.md)</span></span>



## <a name="additional-resources"></a><span data-ttu-id="f1b95-251">Recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="f1b95-251">Additional resources</span></span>

* <span data-ttu-id="f1b95-252">[Tutoriais adicionais que aproveitam o aplicativo SaaS Wingtip](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)</span><span class="sxs-lookup"><span data-stu-id="f1b95-252">Additional [tutorials that build on the Wingtip SaaS application](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)</span></span>
* <span data-ttu-id="f1b95-253">Para saber mais sobre pools elásticos, consulte [*O que é um pool elástico do SQL do Azure*](https://docs.microsoft.com/azure/sql-database/sql-database-elastic-pool)</span><span class="sxs-lookup"><span data-stu-id="f1b95-253">To learn about elastic pools, see [*What is an Azure SQL elastic pool*](https://docs.microsoft.com/azure/sql-database/sql-database-elastic-pool)</span></span>
* <span data-ttu-id="f1b95-254">Para saber mais sobre os trabalhos elásticos, consulte [*Gerenciando bancos de dados de nuvem com escalonamento horizontal*](https://docs.microsoft.com/azure/sql-database/sql-database-elastic-jobs-overview)</span><span class="sxs-lookup"><span data-stu-id="f1b95-254">To learn about elastic jobs, see [*Managing scaled-out cloud databases*](https://docs.microsoft.com/azure/sql-database/sql-database-elastic-jobs-overview)</span></span>
* <span data-ttu-id="f1b95-255">Para saber mais sobre aplicativos SaaS multilocatários, consulte [*Padrões de design para aplicativos SaaS multilocatários*](https://docs.microsoft.com/azure/sql-database/sql-database-design-patterns-multi-tenancy-saas-applications)</span><span class="sxs-lookup"><span data-stu-id="f1b95-255">To learn about multi-tenant SaaS applications, see [*Design patterns for multi-tenant SaaS applications*](https://docs.microsoft.com/azure/sql-database/sql-database-design-patterns-multi-tenancy-saas-applications)</span></span>
