---
title: "desempenho aaaMonitor de muitos bancos de dados do SQL Azure em um aplicativo de SaaS multilocatário | Microsoft Docs"
description: "Monitorar e gerenciar o desempenho de bancos de dados e pools no aplicativo do Azure SQL Database Wingtip SaaS Olá"
keywords: tutorial do banco de dados SQL
services: sql-database
documentationcenter: 
author: stevestein
manager: craigg
editor: 
ms.assetid: 
ms.service: sql-database
ms.custom: scale out apps
ms.workload: data-management
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/26/2017
ms.author: sstein
ms.openlocfilehash: f0d7ba456c485b7de249a56abac3cf4be3857285
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="monitor-performance-of-hello-wingtip-saas-application"></a><span data-ttu-id="19efd-104">Monitorar o desempenho de saudação aplicativo SaaS Wingtip</span><span class="sxs-lookup"><span data-stu-id="19efd-104">Monitor performance of hello Wingtip SaaS application</span></span>

<span data-ttu-id="19efd-105">Neste tutorial, vários dos principais cenários de gerenciamento de desempenho usados em aplicativos SaaS são explorados.</span><span class="sxs-lookup"><span data-stu-id="19efd-105">In this tutorial, several key performance management scenarios used in SaaS applications are explored.</span></span> <span data-ttu-id="19efd-106">Usar uma atividade de toosimulate do gerador de carga em todos os bancos de dados de locatário, monitoramento interno do hello e recursos de alerta de banco de dados SQL e pools Elásticos são demonstrados.</span><span class="sxs-lookup"><span data-stu-id="19efd-106">Using a load generator toosimulate activity across all tenant databases, hello built-in monitoring and alerting features of SQL Database and elastic pools are demonstrated.</span></span>

<span data-ttu-id="19efd-107">Olá Wingtip SaaS aplicativo usa um modelo de dados de locatário único, onde cada local (Locatário) tem seu próprio banco de dados.</span><span class="sxs-lookup"><span data-stu-id="19efd-107">hello Wingtip SaaS app uses a single-tenant data model, where each venue (tenant) has their own database.</span></span> <span data-ttu-id="19efd-108">Como muitos aplicativos SaaS, Olá previsto padrão de carga de trabalho de locatário é imprevisível e esporádica.</span><span class="sxs-lookup"><span data-stu-id="19efd-108">Like many SaaS applications, hello anticipated tenant workload pattern is unpredictable and sporadic.</span></span> <span data-ttu-id="19efd-109">Em outras palavras, as vendas de ingressos podem ocorrer a qualquer momento.</span><span class="sxs-lookup"><span data-stu-id="19efd-109">In other words, ticket sales may occur at any time.</span></span> <span data-ttu-id="19efd-110">tootake vantagem desse padrão de uso típico do banco de dados, bancos de dados são implantados em pools de banco de dados Elástico de locatário.</span><span class="sxs-lookup"><span data-stu-id="19efd-110">tootake advantage of this typical database usage pattern, tenant databases are deployed into elastic database pools.</span></span> <span data-ttu-id="19efd-111">Pools Elásticos otimizam o custo de saudação de uma solução de compartilhamento de recursos em vários bancos de dados.</span><span class="sxs-lookup"><span data-stu-id="19efd-111">Elastic pools optimize hello cost of a solution by sharing resources across many databases.</span></span> <span data-ttu-id="19efd-112">Com esse tipo de padrão, é importante toomonitor banco de dados e tooensure de uso de recursos do pool que carrega razoavelmente são balanceados entre pools.</span><span class="sxs-lookup"><span data-stu-id="19efd-112">With this type of pattern, it's important toomonitor database and pool resource usage tooensure that loads are reasonably balanced across pools.</span></span> <span data-ttu-id="19efd-113">Você também precisa tooensure bancos de dados individuais têm recursos adequados e que os pools não estão atingindo sua [eDTU](sql-database-what-is-a-dtu.md) limites.</span><span class="sxs-lookup"><span data-stu-id="19efd-113">You also need tooensure that individual databases have adequate resources, and that pools are not hitting their [eDTU](sql-database-what-is-a-dtu.md) limits.</span></span> <span data-ttu-id="19efd-114">Este tutorial explora maneiras toomonitor e gerenciar bancos de dados e pools e como a ação corretiva tootake na resposta toovariations na carga de trabalho.</span><span class="sxs-lookup"><span data-stu-id="19efd-114">This tutorial explores ways toomonitor and manage databases and pools, and how tootake corrective action in response toovariations in workload.</span></span>

<span data-ttu-id="19efd-115">Neste tutorial, você aprenderá a:</span><span class="sxs-lookup"><span data-stu-id="19efd-115">In this tutorial you learn how to:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="19efd-116">Simule o uso em bancos de dados de locatário Olá executando um gerador de carga fornecido</span><span class="sxs-lookup"><span data-stu-id="19efd-116">Simulate usage on hello tenant databases by running a provided load generator</span></span>
> * <span data-ttu-id="19efd-117">Bancos de dados de locatário de saudação do monitor como eles respondem toohello aumento na carga</span><span class="sxs-lookup"><span data-stu-id="19efd-117">Monitor hello tenant databases as they respond toohello increase in load</span></span>
> * <span data-ttu-id="19efd-118">Dimensionar o hello pool Elástico em resposta toohello maior banco de dados de carga</span><span class="sxs-lookup"><span data-stu-id="19efd-118">Scale up hello Elastic pool in response toohello increased database load</span></span>
> * <span data-ttu-id="19efd-119">Provisionar uma segunda atividade de banco de dados de saldo de tooload pool Elástico</span><span class="sxs-lookup"><span data-stu-id="19efd-119">Provision a second Elastic pool tooload balance database activity</span></span>


<span data-ttu-id="19efd-120">toocomplete neste tutorial, verifique Olá se os pré-requisitos a seguir são concluídas:</span><span class="sxs-lookup"><span data-stu-id="19efd-120">toocomplete this tutorial, make sure hello following prerequisites are completed:</span></span>

* <span data-ttu-id="19efd-121">Olá Wingtip SaaS aplicativo é implantado.</span><span class="sxs-lookup"><span data-stu-id="19efd-121">hello Wingtip SaaS app is deployed.</span></span> <span data-ttu-id="19efd-122">toodeploy em menos de cinco minutos, consulte [implantar e explorar o aplicativo de SaaS Wingtip hello](sql-database-saas-tutorial.md)</span><span class="sxs-lookup"><span data-stu-id="19efd-122">toodeploy in less than five minutes, see [Deploy and explore hello Wingtip SaaS application](sql-database-saas-tutorial.md)</span></span>
* <span data-ttu-id="19efd-123">O Azure PowerShell está instalado.</span><span class="sxs-lookup"><span data-stu-id="19efd-123">Azure PowerShell is installed.</span></span> <span data-ttu-id="19efd-124">Para obter detalhes, consulte [Introdução ao Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps)</span><span class="sxs-lookup"><span data-stu-id="19efd-124">For details, see [Getting started with Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps)</span></span>

## <a name="introduction-toosaas-performance-management-patterns"></a><span data-ttu-id="19efd-125">Padrões de gerenciamento de desempenho de tooSaaS de Introdução</span><span class="sxs-lookup"><span data-stu-id="19efd-125">Introduction tooSaaS performance management patterns</span></span>

<span data-ttu-id="19efd-126">Gerenciando o desempenho do banco de dados consiste de compilação e analisando dados de desempenho e, em seguida, reagindo toothis dados ajustando parâmetros toomaintain um tempo de resposta aceitável para o seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="19efd-126">Managing database performance consists of compiling and analyzing performance data, and then reacting toothis data by adjusting parameters toomaintain an acceptable response time for your application.</span></span> <span data-ttu-id="19efd-127">Ao hospedar vários locatários, pools de banco de dados Elástico são uma maneira econômica tooprovide e gerenciar os recursos de um grupo de bancos de dados com cargas de trabalho imprevisíveis.</span><span class="sxs-lookup"><span data-stu-id="19efd-127">When hosting multiple tenants, Elastic database pools are a cost-effective way tooprovide and manage resources for a group of databases with unpredictable workloads.</span></span> <span data-ttu-id="19efd-128">Com determinados padrões carga de trabalho, não mais que dois bancos de dados S3 poderiam se beneficiar sendo gerenciados em um pool.</span><span class="sxs-lookup"><span data-stu-id="19efd-128">With certain workload patterns, as few as two S3 databases can benefit from being managed in a pool.</span></span>

![mídia](./media/sql-database-saas-tutorial-performance-monitoring/app-diagram.png)

<span data-ttu-id="19efd-130">Pools e bancos de dados de saudação em pools, devem ser monitorado tooensure permanecem dentro dos intervalos aceitáveis de desempenho.</span><span class="sxs-lookup"><span data-stu-id="19efd-130">Pools, and hello databases in pools, should be monitored tooensure they stay within acceptable ranges of performance.</span></span> <span data-ttu-id="19efd-131">Ajustar as necessidades de Olá Olá pool configuração toomeet de carga de trabalho agregado de todos os bancos de dados, garantindo que Olá eDTUs de pool apropriados para Olá Olá carga de trabalho geral.</span><span class="sxs-lookup"><span data-stu-id="19efd-131">Tune hello pool configuration toomeet hello needs of hello aggregate workload of all databases, ensuring that hello pool eDTUs are appropriate for hello overall workload.</span></span> <span data-ttu-id="19efd-132">Ajuste Olá por banco de dados por banco de dados e min eDTU máximo valores tooappropriate valores para seus requisitos de aplicativo específico.</span><span class="sxs-lookup"><span data-stu-id="19efd-132">Adjust hello per-database min and per-database max eDTU values tooappropriate values for your specific application requirements.</span></span>

### <a name="performance-management-strategies"></a><span data-ttu-id="19efd-133">Estratégias de gerenciamento de desempenho</span><span class="sxs-lookup"><span data-stu-id="19efd-133">Performance management strategies</span></span>

* <span data-ttu-id="19efd-134">tooavoid ter toomanually monitorar o desempenho, é mais eficiente muito**definir alertas disparam quando os bancos de dados ou os pools afastem fora dos intervalos normais**.</span><span class="sxs-lookup"><span data-stu-id="19efd-134">tooavoid having toomanually monitor performance, it’s most effective too**set alerts that trigger when databases or pools stray out of normal ranges**.</span></span>
* <span data-ttu-id="19efd-135">Olá flutuações de termo tooshort toorespond no nível de desempenho de agregação de saudação de um pool, **nível de eDTU do pool pode ser aumentado ou reduzidos**.</span><span class="sxs-lookup"><span data-stu-id="19efd-135">toorespond tooshort-term fluctuations in hello aggregate performance level of a pool, hello **pool eDTU level can be scaled up or down**.</span></span> <span data-ttu-id="19efd-136">Se este flutuação ocorre em uma base regular ou previsível, **dimensionamento pool Olá possível toooccur agendado automaticamente**.</span><span class="sxs-lookup"><span data-stu-id="19efd-136">If this fluctuation occurs on a regular or predictable basis, **scaling hello pool can be scheduled toooccur automatically**.</span></span> <span data-ttu-id="19efd-137">Por exemplo, reduzir verticalmente quando você souber que sua carga de trabalho é leve, talvez durante a noite ou durante os finais de semana.</span><span class="sxs-lookup"><span data-stu-id="19efd-137">For example, scale down when you know your workload is light, maybe overnight, or during weekends.</span></span>
* <span data-ttu-id="19efd-138">toorespond toolonger termo flutuações ou alterações em Olá número de bancos de dados, **bancos de dados individuais podem ser movidos para outros pools**.</span><span class="sxs-lookup"><span data-stu-id="19efd-138">toorespond toolonger-term fluctuations, or changes in hello number of databases, **individual databases can be moved into other pools**.</span></span>
* <span data-ttu-id="19efd-139">aumenta a toorespond tooshort termo *individuais* carregamento de banco de dados **bancos de dados individuais podem ser retirados de um pool e atribuídos a um nível de desempenho individuais**.</span><span class="sxs-lookup"><span data-stu-id="19efd-139">toorespond tooshort term increases in *individual* database load **individual databases can be taken out of a pool and assigned an individual performance level**.</span></span> <span data-ttu-id="19efd-140">Depois que a carga de saudação é reduzida, Olá banco de dados pode, em seguida, retornar toohello pool.</span><span class="sxs-lookup"><span data-stu-id="19efd-140">Once hello load is reduced, hello database can then be returned toohello pool.</span></span> <span data-ttu-id="19efd-141">Quando isso é conhecido com antecedência, bancos de dados podem ser movidos preventivamente banco de dados do tooensure Olá sempre tem recursos Olá necessárias e tooavoid impacto em outros bancos de dados no pool de saudação.</span><span class="sxs-lookup"><span data-stu-id="19efd-141">When this is known in advance, databases can be moved pre-emptively tooensure hello database always has hello resources it needs, and tooavoid impact on other databases in hello pool.</span></span> <span data-ttu-id="19efd-142">Se esse requisito é previsível, como um local com um surto de vendas de tíquete para um evento popular, esse comportamento de gerenciamento pode ser integrado em um aplicativo hello.</span><span class="sxs-lookup"><span data-stu-id="19efd-142">If this requirement is predictable, such as a venue experiencing a rush of ticket sales for a popular event, then this management behavior can be integrated into hello application.</span></span>

<span data-ttu-id="19efd-143">Olá [portal do Azure](https://portal.azure.com) fornece monitoramento e alertas na maioria dos recursos internos.</span><span class="sxs-lookup"><span data-stu-id="19efd-143">hello [Azure portal](https://portal.azure.com) provides built-in monitoring and alerting on most resources.</span></span> <span data-ttu-id="19efd-144">Para o Banco de Dados SQL, o monitoramento e o alerta estão disponíveis em bancos de dados e pools.</span><span class="sxs-lookup"><span data-stu-id="19efd-144">For SQL Database, monitoring and alerting is available on databases and pools.</span></span> <span data-ttu-id="19efd-145">Este interna de monitoramento e alertas é específicas do recurso, portanto, é conveniente toouse para pequenas quantidades de recursos, mas não é muito conveniente ao trabalhar com muitos recursos.</span><span class="sxs-lookup"><span data-stu-id="19efd-145">This built-in monitoring and alerting is resource-specific, so it's convenient toouse for small numbers of resources, but is not very convenient when working with many resources.</span></span>

<span data-ttu-id="19efd-146">Para cenários de alto volume em que você está trabalhando com muitos recursos, o [Log Analytics (OMS)](sql-database-saas-tutorial-log-analytics.md) pode ser usado.</span><span class="sxs-lookup"><span data-stu-id="19efd-146">For high-volume scenarios where you're working with many reources, [Log Analytics (OMS)](sql-database-saas-tutorial-log-analytics.md) can be used.</span></span> <span data-ttu-id="19efd-147">Esse é um serviço separado do Azure que fornece a análise de logs de diagnóstico emitidos e da telemetria coletada em um espaço de trabalho de análise de logs.</span><span class="sxs-lookup"><span data-stu-id="19efd-147">This is a separate Azure service that provides analytics over emitted diagnostic logs and telemetry gathered in a log analytics workspace.</span></span> <span data-ttu-id="19efd-148">Análise de log pode coletar telemetria dos muitos serviços e ser usado tooquery e definir alertas.</span><span class="sxs-lookup"><span data-stu-id="19efd-148">Log Analytics can collect telemetry from many services and be used tooquery and set alerts.</span></span>

## <a name="get-hello-wingtip-application-source-code-and-scripts"></a><span data-ttu-id="19efd-149">Obter o código-fonte Olá Wingtip aplicativos e scripts</span><span class="sxs-lookup"><span data-stu-id="19efd-149">Get hello Wingtip application source code and scripts</span></span>

<span data-ttu-id="19efd-150">Hello Wingtip SaaS scripts e código fonte do aplicativo estão disponíveis no hello [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS) repositório github.</span><span class="sxs-lookup"><span data-stu-id="19efd-150">hello Wingtip SaaS scripts and application source code are available in hello [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS) github repo.</span></span> <span data-ttu-id="19efd-151">[As etapas de scripts de SaaS Wingtip Olá toodownload](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span><span class="sxs-lookup"><span data-stu-id="19efd-151">[Steps toodownload hello Wingtip SaaS scripts](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span></span>

## <a name="provision-additional-tenants"></a><span data-ttu-id="19efd-152">Provisionar locatários adicionais</span><span class="sxs-lookup"><span data-stu-id="19efd-152">Provision additional tenants</span></span>

<span data-ttu-id="19efd-153">Enquanto os pools podem ser tão econômicos com apenas dois bancos de dados S3, Olá mais bancos de dados que estão em Olá Olá de pool mais econômico Olá média efeito torna-se.</span><span class="sxs-lookup"><span data-stu-id="19efd-153">While pools can be cost-effective with just two S3 databases, hello more databases that are in hello pool hello more cost-effective hello averaging effect becomes.</span></span> <span data-ttu-id="19efd-154">Para uma boa compreensão do funcionamento do monitoramento de desempenho e do gerenciamento em grande escala, este tutorial requer que você tenha pelo menos 20 bancos de dados implantados.</span><span class="sxs-lookup"><span data-stu-id="19efd-154">For a good understanding of how performance monitoring and management works at scale, this tutorial requires you have at least 20 databases deployed.</span></span>

<span data-ttu-id="19efd-155">Se você já provisionado um lote de locatários em um tutorial anterior, ignorar toohello [simular o uso em todos os bancos de dados de locatário](#simulate-usage-on-all-tenant-databases) seção.</span><span class="sxs-lookup"><span data-stu-id="19efd-155">If you already provisioned a batch of tenants in a prior tutorial, skip toohello [Simulate usage on all tenant databases](#simulate-usage-on-all-tenant-databases) section.</span></span>

1. <span data-ttu-id="19efd-156">Abrir... \\Módulos de aprendizado\\gerenciamento e monitoramento do desempenho de\\*demonstração PerformanceMonitoringAndManagement.ps1* em Olá *PowerShell ISE*.</span><span class="sxs-lookup"><span data-stu-id="19efd-156">Open …\\Learning Modules\\Performance Monitoring and Management\\*Demo-PerformanceMonitoringAndManagement.ps1* in hello *PowerShell ISE*.</span></span> <span data-ttu-id="19efd-157">Mantenha esse script aberto pois você executará vários cenários durante este tutorial.</span><span class="sxs-lookup"><span data-stu-id="19efd-157">Keep this script open as you'll run several scenarios during this tutorial.</span></span>
1. <span data-ttu-id="19efd-158">Defina **$DemoScenario** = **1**, **Provisionar um lote de locatários**</span><span class="sxs-lookup"><span data-stu-id="19efd-158">Set **$DemoScenario** = **1**, **Provision a batch of tenants**</span></span>
1. <span data-ttu-id="19efd-159">Pressione **F5** toorun script de saudação.</span><span class="sxs-lookup"><span data-stu-id="19efd-159">Press **F5** toorun hello script.</span></span>

<span data-ttu-id="19efd-160">script Hello implantará 17 locatários em menos de cinco minutos.</span><span class="sxs-lookup"><span data-stu-id="19efd-160">hello script will deploy 17 tenants in less than five minutes.</span></span>

<span data-ttu-id="19efd-161">Olá *New-TenantBatch* script usa um conjunto de aninhada ou vinculado [Gerenciador de recursos de](../azure-resource-manager/index.md) modelos criados por um lote de locatários, que, por padrão, copia o banco de dados de saudação **basetenantdb** Olá catálogo server toocreate Olá novo locatário bancos de dados, em seguida, registra esses no catálogo hello e finalmente inicializa-los com o tipo de nome e local do locatário hello.</span><span class="sxs-lookup"><span data-stu-id="19efd-161">hello *New-TenantBatch* script uses a nested or linked set of [Resource Manager](../azure-resource-manager/index.md) templates that create a batch of tenants, which by default copies hello database **basetenantdb** on hello catalog server toocreate hello new tenant databases, then registers these in hello catalog, and finally initializes them with hello tenant name and venue type.</span></span> <span data-ttu-id="19efd-162">Isso é consistente com a maneira Olá Olá aplicativo provisiona um novo locatário.</span><span class="sxs-lookup"><span data-stu-id="19efd-162">This is consistent with hello way hello app provisions a new tenant.</span></span> <span data-ttu-id="19efd-163">Todas as alterações feitas muito*basetenantdb* é aplicada tooany novos locatários provisionados depois disso.</span><span class="sxs-lookup"><span data-stu-id="19efd-163">Any changes made too*basetenantdb* are applied tooany new tenants provisioned thereafter.</span></span> <span data-ttu-id="19efd-164">Consulte Olá [tutorial de gerenciamento de esquema](sql-database-saas-tutorial-schema-management.md) toosee como toomake alterações de esquema muito*existente* locatário bancos de dados (incluindo Olá *basetenantdb* banco de dados).</span><span class="sxs-lookup"><span data-stu-id="19efd-164">See hello [Schema Management tutorial](sql-database-saas-tutorial-schema-management.md) toosee how toomake schema changes too*existing* tenant databases (including hello *basetenantdb* database).</span></span>

## <a name="simulate-usage-on-all-tenant-databases"></a><span data-ttu-id="19efd-165">Simular o uso em todos os bancos de dados de locatário</span><span class="sxs-lookup"><span data-stu-id="19efd-165">Simulate usage on all tenant databases</span></span>

<span data-ttu-id="19efd-166">Olá *PerformanceMonitoringAndManagement.ps1 demonstração* script é fornecido que simula uma carga de trabalho em execução em todos os bancos de dados de locatário.</span><span class="sxs-lookup"><span data-stu-id="19efd-166">hello *Demo-PerformanceMonitoringAndManagement.ps1* script is provided that simulates a workload running against all tenant databases.</span></span> <span data-ttu-id="19efd-167">carga de saudação é gerada usando um dos cenários de saudação de carga disponíveis:</span><span class="sxs-lookup"><span data-stu-id="19efd-167">hello load is generated using one of hello available load scenarios:</span></span>

| <span data-ttu-id="19efd-168">Demonstração</span><span class="sxs-lookup"><span data-stu-id="19efd-168">Demo</span></span> | <span data-ttu-id="19efd-169">Cenário</span><span class="sxs-lookup"><span data-stu-id="19efd-169">Scenario</span></span> |
|:--|:--|
| <span data-ttu-id="19efd-170">2</span><span class="sxs-lookup"><span data-stu-id="19efd-170">2</span></span> | <span data-ttu-id="19efd-171">Gerar carga de intensidade normal (aproximadamente 40 DTU)</span><span class="sxs-lookup"><span data-stu-id="19efd-171">Generate normal intensity load (approx. 40 DTU)</span></span> |
| <span data-ttu-id="19efd-172">3</span><span class="sxs-lookup"><span data-stu-id="19efd-172">3</span></span> | <span data-ttu-id="19efd-173">Gerar carga com picos mais longos e mais frequentes por banco de dados</span><span class="sxs-lookup"><span data-stu-id="19efd-173">Generate load with longer and more frequent bursts per database</span></span>|
| <span data-ttu-id="19efd-174">4</span><span class="sxs-lookup"><span data-stu-id="19efd-174">4</span></span> | <span data-ttu-id="19efd-175">Gerar carga com picos maiores de DTU por banco de dados (aprox. 80 DTU)</span><span class="sxs-lookup"><span data-stu-id="19efd-175">Generate load with higher DTU bursts per database (approx. 80 DTU)</span></span>|
| <span data-ttu-id="19efd-176">5</span><span class="sxs-lookup"><span data-stu-id="19efd-176">5</span></span> | <span data-ttu-id="19efd-177">Gerar uma carga normal e uma carga alta em um locatário único (aprox. 95 DTU)</span><span class="sxs-lookup"><span data-stu-id="19efd-177">Generate a normal load plus a high load on a single tenant (approx. 95 DTU)</span></span>|
| <span data-ttu-id="19efd-178">6</span><span class="sxs-lookup"><span data-stu-id="19efd-178">6</span></span> | <span data-ttu-id="19efd-179">Gerar carga desbalanceada entre vários pools</span><span class="sxs-lookup"><span data-stu-id="19efd-179">Generate unbalanced load across multiple pools</span></span>|

<span data-ttu-id="19efd-180">Gerador de carga Olá aplica-se um *sintético* banco de dados de locatário de tooevery carga de CPU.</span><span class="sxs-lookup"><span data-stu-id="19efd-180">hello load generator applies a *synthetic* CPU-only load tooevery tenant database.</span></span> <span data-ttu-id="19efd-181">Gerador de saudação inicia um trabalho para cada banco de dados de locatário, que chama um procedimento armazenado periodicamente que gera a carga de saudação.</span><span class="sxs-lookup"><span data-stu-id="19efd-181">hello generator starts a job for each tenant database, which calls a stored procedure periodically that generates hello load.</span></span> <span data-ttu-id="19efd-182">Olá carga níveis (eDTUs), a duração e os intervalos variam em todos os bancos de dados, simulando a atividade de locatário imprevisível.</span><span class="sxs-lookup"><span data-stu-id="19efd-182">hello load levels (in eDTUs), duration, and intervals are varied across all databases, simulating unpredictable tenant activity.</span></span>

1. <span data-ttu-id="19efd-183">Abrir... \\Módulos de aprendizado\\gerenciamento e monitoramento do desempenho de\\*demonstração PerformanceMonitoringAndManagement.ps1* em Olá *PowerShell ISE*.</span><span class="sxs-lookup"><span data-stu-id="19efd-183">Open …\\Learning Modules\\Performance Monitoring and Management\\*Demo-PerformanceMonitoringAndManagement.ps1* in hello *PowerShell ISE*.</span></span> <span data-ttu-id="19efd-184">Mantenha esse script aberto pois você executará vários cenários durante este tutorial.</span><span class="sxs-lookup"><span data-stu-id="19efd-184">Keep this script open as you'll run several scenarios during this tutorial.</span></span>
1. <span data-ttu-id="19efd-185">Defina **$DemoScenario** = **2**, *Gerar uma carga de intensidade normal*.</span><span class="sxs-lookup"><span data-stu-id="19efd-185">Set **$DemoScenario** = **2**, *Generate normal intensity load*.</span></span>
1. <span data-ttu-id="19efd-186">Pressione **F5** tooapply tooall uma carga de seus bancos de dados de locatário.</span><span class="sxs-lookup"><span data-stu-id="19efd-186">Press **F5** tooapply a load tooall your tenant databases.</span></span>

<span data-ttu-id="19efd-187">Wingtip é um aplicativo SaaS e carga do Olá mundo real em um aplicativo SaaS normalmente é esporádica e imprevisível.</span><span class="sxs-lookup"><span data-stu-id="19efd-187">Wingtip is a SaaS app, and hello real-world load on a SaaS app is typically sporadic and unpredictable.</span></span> <span data-ttu-id="19efd-188">toosimulate isso, Olá carga gerador produz uma carga aleatória distribuída em todos os locatários.</span><span class="sxs-lookup"><span data-stu-id="19efd-188">toosimulate this, hello load generator produces a randomized load distributed across all tenants.</span></span> <span data-ttu-id="19efd-189">Vários minutos são necessários para Olá carga padrão tooemerge, portanto, execute gerador de carga Olá por 3 a 5 minutos antes de tentar toomonitor Olá carga no hello seções a seguir.</span><span class="sxs-lookup"><span data-stu-id="19efd-189">Several minutes are needed for hello load pattern tooemerge, so run hello load generator for 3-5 minutes before attempting toomonitor hello load in hello following sections.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="19efd-190">Gerador de carga Hello está em execução como uma série de trabalhos na sessão do PowerShell local.</span><span class="sxs-lookup"><span data-stu-id="19efd-190">hello load generator is running as a series of jobs in your local PowerShell session.</span></span> <span data-ttu-id="19efd-191">Lembre-Olá *PerformanceMonitoringAndManagement.ps1 demonstração* guia Abrir!</span><span class="sxs-lookup"><span data-stu-id="19efd-191">Keep hello *Demo-PerformanceMonitoringAndManagement.ps1* tab open!</span></span> <span data-ttu-id="19efd-192">Se você fechar a guia hello, ou suspender sua máquina, gerador de carga hello interrompe.</span><span class="sxs-lookup"><span data-stu-id="19efd-192">If you close hello tab, or suspend your machine, hello load generator stops.</span></span> <span data-ttu-id="19efd-193">Gerador de carga Olá permanece em um *invocar trabalho* estado em que ele gera carga em quaisquer novos locatários que são provisionados depois do início do gerador de saudação.</span><span class="sxs-lookup"><span data-stu-id="19efd-193">hello load generator remains in a *job-invoking* state where it generates load on any new tenants that are provisioned after hello generator is started.</span></span> <span data-ttu-id="19efd-194">Use *Ctrl-C* toostop invocar novos trabalhos e saída Olá script.</span><span class="sxs-lookup"><span data-stu-id="19efd-194">Use *Ctrl-C* toostop invoking new jobs and exit hello script.</span></span> <span data-ttu-id="19efd-195">Gerador de carga Olá continuará toorun, mas apenas em locatários existentes.</span><span class="sxs-lookup"><span data-stu-id="19efd-195">hello load generator will continue toorun, but only on existing tenants.</span></span>

## <a name="monitor-resource-usage-using-hello-azure-portal"></a><span data-ttu-id="19efd-196">Monitorar o uso de recursos usando Olá portal do Azure</span><span class="sxs-lookup"><span data-stu-id="19efd-196">Monitor resource usage using hello Azure portal</span></span>

<span data-ttu-id="19efd-197">uso de recursos do hello toomonitor resultados da saudação carregar sendo aplicadas, abrir o pool de toohello portal de saudação que contém os bancos de dados de locatário de saudação:</span><span class="sxs-lookup"><span data-stu-id="19efd-197">toomonitor hello resource usage that results from hello load being applied, open hello portal toohello pool containing hello tenant databases:</span></span>

1. <span data-ttu-id="19efd-198">Olá abrir [portal do Azure](https://portal.azure.com) e procurar toohello *tenants1 -&lt;usuário&gt;*  server.</span><span class="sxs-lookup"><span data-stu-id="19efd-198">Open hello [Azure portal](https://portal.azure.com) and browse toohello *tenants1-&lt;USER&gt;* server.</span></span>
1. <span data-ttu-id="19efd-199">Role para baixo e localize os pools elásticos e clique em **Pool1**.</span><span class="sxs-lookup"><span data-stu-id="19efd-199">Scroll down and locate elastic pools and click **Pool1**.</span></span> <span data-ttu-id="19efd-200">Este pool contém todos os Olá locatário bancos de dados foi criados.</span><span class="sxs-lookup"><span data-stu-id="19efd-200">This pool contains all hello tenant databases created so far.</span></span>

<span data-ttu-id="19efd-201">Observar Olá **monitoramento de pool Elástico** e **monitoramento de banco de dados Elástico** gráficos.</span><span class="sxs-lookup"><span data-stu-id="19efd-201">Observe hello **Elastic pool monitoring** and **Elastic database monitoring** charts.</span></span>

<span data-ttu-id="19efd-202">Olá, utilização de recursos do pool é utilização do banco de dados de agregação Olá para todos os bancos de dados no pool de saudação.</span><span class="sxs-lookup"><span data-stu-id="19efd-202">hello pool's resource utilization is hello aggregate database utilization for all databases in hello pool.</span></span> <span data-ttu-id="19efd-203">gráfico de banco de dados de saudação mostra Olá cinco principais bancos de dados:</span><span class="sxs-lookup"><span data-stu-id="19efd-203">hello database chart shows hello five hottest databases:</span></span>

![](./media/sql-database-saas-tutorial-performance-monitoring/pool1.png)

<span data-ttu-id="19efd-204">Porque há bancos de dados adicionais no pool de saudação além Olá cinco principais, utilização do pool de saudação mostra a atividade que não será refletida no gráfico de cinco bancos de dados principais hello.</span><span class="sxs-lookup"><span data-stu-id="19efd-204">Because there are additional databases in hello pool beyond hello top five, hello pool utilization shows activity that is not reflected in hello top five databases chart.</span></span> <span data-ttu-id="19efd-205">Para obter mais detalhes, clique em **Utilização de Recursos do Banco de Dados**:</span><span class="sxs-lookup"><span data-stu-id="19efd-205">For additional details, click **Database Resource Utilization**:</span></span>

![](./media/sql-database-saas-tutorial-performance-monitoring/database-utilization.png)


## <a name="set-performance-alerts-on-hello-pool"></a><span data-ttu-id="19efd-206">Configurar alertas de desempenho de pool de saudação</span><span class="sxs-lookup"><span data-stu-id="19efd-206">Set performance alerts on hello pool</span></span>

<span data-ttu-id="19efd-207">Definir um alerta em pool Olá aciona em \>75% de utilização da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="19efd-207">Set an alert on hello pool that triggers on \>75% utilization as follows:</span></span>

1. <span data-ttu-id="19efd-208">Abra *Pool1* (em Olá *tenants1 -\<usuário\>*  servidor) no hello [portal do Azure](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="19efd-208">Open *Pool1* (on hello *tenants1-\<user\>* server) in hello [Azure portal](https://portal.azure.com).</span></span>
1. <span data-ttu-id="19efd-209">Clique em **Regras de Alerta** e, em seguida, clique em **+ Adicionar alerta**:</span><span class="sxs-lookup"><span data-stu-id="19efd-209">Click **Alert Rules**, and then click **+ Add alert**:</span></span>

   ![adicionar alerta](media/sql-database-saas-tutorial-performance-monitoring/add-alert.png)

1. <span data-ttu-id="19efd-211">Forneça um nome, como **Alto DTU**,</span><span class="sxs-lookup"><span data-stu-id="19efd-211">Provide a name, such as **High DTU**,</span></span>
1. <span data-ttu-id="19efd-212">Saudação de conjunto de valores a seguir:</span><span class="sxs-lookup"><span data-stu-id="19efd-212">Set hello following values:</span></span>
   * <span data-ttu-id="19efd-213">**Métrica = percentual de eDTU**</span><span class="sxs-lookup"><span data-stu-id="19efd-213">**Metric = eDTU percentage**</span></span>
   * <span data-ttu-id="19efd-214">**Condição = maior que**.</span><span class="sxs-lookup"><span data-stu-id="19efd-214">**Condition = greater than**.</span></span>
   * <span data-ttu-id="19efd-215">**Limite = 75**.</span><span class="sxs-lookup"><span data-stu-id="19efd-215">**Threshold = 75**.</span></span>
   * <span data-ttu-id="19efd-216">**Período = sobre Olá últimos 30 minutos**.</span><span class="sxs-lookup"><span data-stu-id="19efd-216">**Period = Over hello last 30 minutes**.</span></span>
1. <span data-ttu-id="19efd-217">Adicionar um toohello de endereço de email *administrador adicional email(s)* caixa e clique em **Okey**.</span><span class="sxs-lookup"><span data-stu-id="19efd-217">Add an email address toohello *Additional administrator email(s)* box and click **OK**.</span></span>

   ![definir alerta](media/sql-database-saas-tutorial-performance-monitoring/alert-rule.png)


## <a name="scale-up-a-busy-pool"></a><span data-ttu-id="19efd-219">Escalar verticalmente um pool ocupado</span><span class="sxs-lookup"><span data-stu-id="19efd-219">Scale up a busy pool</span></span>

<span data-ttu-id="19efd-220">Se o nível de carga de agregação de saudação aumenta em um ponto de toohello do pool que dá o máximo de pool hello e atingir 100% de uso de eDTU, desempenho de banco de dados individual é afetado, potencialmente reduzindo os tempos de resposta de consulta para todos os bancos de dados no pool de saudação.</span><span class="sxs-lookup"><span data-stu-id="19efd-220">If hello aggregate load level increases on a pool toohello point that it maxes out hello pool and reaches 100% eDTU usage, then individual database performance is affected, potentially slowing query response times for all databases in hello pool.</span></span>

<span data-ttu-id="19efd-221">**Curto prazo**, considere a possibilidade de dimensionar os recursos adicionais do hello pool tooprovide ou removendo bancos de dados do pool de saudação (movendo-os pools de tooother ou fora da camada de serviço autônoma Olá pool tooa).</span><span class="sxs-lookup"><span data-stu-id="19efd-221">**Short term**, consider scaling up hello pool tooprovide additional resources, or removing databases from hello pool (moving them tooother pools, or out of hello pool tooa stand-alone service tier).</span></span>

<span data-ttu-id="19efd-222">**Longo prazo**, considere otimizar consultas ou o índice de desempenho de banco de dados de tooimprove de uso.</span><span class="sxs-lookup"><span data-stu-id="19efd-222">**Longer term**, consider optimizing queries or index usage tooimprove database performance.</span></span> <span data-ttu-id="19efd-223">Dependendo da saudação tooperformance de sensibilidade do aplicativo emite seu tooscale de prática recomendada um pool de backup antes de atingir 100% de uso de eDTU.</span><span class="sxs-lookup"><span data-stu-id="19efd-223">Depending on hello application's sensitivity tooperformance issues its best practice tooscale a pool up before it reaches 100% eDTU usage.</span></span> <span data-ttu-id="19efd-224">Use um alerta toowarn você com antecedência.</span><span class="sxs-lookup"><span data-stu-id="19efd-224">Use an alert toowarn you in advance.</span></span>

<span data-ttu-id="19efd-225">Você pode simular um pool de ocupado pelo aumento da carga Olá produzido pelo gerador de saudação.</span><span class="sxs-lookup"><span data-stu-id="19efd-225">You can simulate a busy pool by increasing hello load produced by hello generator.</span></span> <span data-ttu-id="19efd-226">Causando Olá tooburst de bancos de dados com mais frequência e para carga de agregação hello mais longo, aumentando em pool Olá sem alterações de requisitos de saudação de bancos de dados individuais hello.</span><span class="sxs-lookup"><span data-stu-id="19efd-226">Causing hello databases tooburst more frequently, and for longer, increasing hello aggregate load on hello pool without changing hello requirements of hello individual databases.</span></span> <span data-ttu-id="19efd-227">Expansão do pool de saudação é feito facilmente no portal de saudação ou do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="19efd-227">Scaling up hello pool is easily done in hello portal or from PowerShell.</span></span> <span data-ttu-id="19efd-228">Este exercício usa o portal de saudação.</span><span class="sxs-lookup"><span data-stu-id="19efd-228">This exercise uses hello portal.</span></span>

1. <span data-ttu-id="19efd-229">Definir *$DemoScenario* = **3**, _gerar carga com intermitências mais e mais frequentes por banco de dados_ tooincrease intensidade de saudação de carga de agregação Olá no pool de saudação sem alterar a carga de pico Olá exigida por cada banco de dados.</span><span class="sxs-lookup"><span data-stu-id="19efd-229">Set *$DemoScenario* = **3**, _Generate load with longer and more frequent bursts per database_ tooincrease hello intensity of hello aggregate load on hello pool without changing hello peak load required by each database.</span></span>
1. <span data-ttu-id="19efd-230">Pressione **F5** tooapply tooall uma carga de seus bancos de dados de locatário.</span><span class="sxs-lookup"><span data-stu-id="19efd-230">Press **F5** tooapply a load tooall your tenant databases.</span></span>

1. <span data-ttu-id="19efd-231">Vá muito**Pool1** em Olá portal do Azure.</span><span class="sxs-lookup"><span data-stu-id="19efd-231">Go too**Pool1** in hello Azure portal.</span></span>

<span data-ttu-id="19efd-232">Olá monitor maior uso de eDTU do pool no gráfico superior hello.</span><span class="sxs-lookup"><span data-stu-id="19efd-232">Monitor hello increased pool eDTU usage on hello upper chart.</span></span> <span data-ttu-id="19efd-233">Leva alguns minutos para Olá novo maior carga tookick, mas você deve ver rapidamente pool Olá iniciar utilização máxima toohit e como carga Olá steadies no padrão de novos hello, rapidamente sobrecarrega pool hello.</span><span class="sxs-lookup"><span data-stu-id="19efd-233">It takes a few minutes for hello new higher load tookick in, but you should quickly see hello pool start toohit max utilization, and as hello load steadies into hello new pattern, it rapidly overloads hello pool.</span></span>

1. <span data-ttu-id="19efd-234">tooscale pool hello, clique em **configurar pool** na parte superior de saudação do hello **Pool1** página.</span><span class="sxs-lookup"><span data-stu-id="19efd-234">tooscale up hello pool, click **Configure pool** at hello top of hello **Pool1** page.</span></span>
1. <span data-ttu-id="19efd-235">Ajustar Olá **eDTU de Pool** configuração muito**100**.</span><span class="sxs-lookup"><span data-stu-id="19efd-235">Adjust hello **Pool eDTU** setting too**100**.</span></span> <span data-ttu-id="19efd-236">Alterar o eDTU do pool de saudação não alterar Olá por banco de dados (que ainda é 50 eDTU máximo por banco de dados).</span><span class="sxs-lookup"><span data-stu-id="19efd-236">Changing hello pool eDTU does not change hello per-database settings (which is still 50 eDTU max per database).</span></span> <span data-ttu-id="19efd-237">Ver configurações do hello por banco de dados no lado direito de saudação do hello **configurar pool** página.</span><span class="sxs-lookup"><span data-stu-id="19efd-237">You can see hello per-database settings on hello right side of hello **Configure pool** page.</span></span>
1. <span data-ttu-id="19efd-238">Clique em **salvar** pool de saudação do toosubmit Olá solicitação tooscale.</span><span class="sxs-lookup"><span data-stu-id="19efd-238">Click **Save** toosubmit hello request tooscale hello pool.</span></span>

<span data-ttu-id="19efd-239">Voltar muito**Pool1** > **visão geral** tooview Olá gráficos de monitoramento.</span><span class="sxs-lookup"><span data-stu-id="19efd-239">Go back too**Pool1** > **Overview** tooview hello monitoring charts.</span></span> <span data-ttu-id="19efd-240">Monitore o efeito de saudação do fornecimento de pool de saudação com mais recursos (embora com alguns bancos de dados e uma carga aleatória nem sempre é fácil toosee conclusivamente até que seja executado por algum tempo).</span><span class="sxs-lookup"><span data-stu-id="19efd-240">Monitor hello effect of providing hello pool with more resources (although with few databases and a randomized load it’s not always easy toosee conclusively until you run for some time).</span></span> <span data-ttu-id="19efd-241">Enquanto você está vendo hello gráficos tenha em mente que 100% em Olá superior agora o gráfico representa 100 eDTUs, enquanto no hello gráfico 100% inferior é ainda 50 eDTUs como Olá por banco de dados max ainda é 50 eDTUs.</span><span class="sxs-lookup"><span data-stu-id="19efd-241">While you are looking at hello charts bear in mind that 100% on hello upper chart now represents 100 eDTUs, while on hello lower chart 100% is still 50 eDTUs as hello per-database max is still 50 eDTUs.</span></span>

<span data-ttu-id="19efd-242">Bancos de dados permanecem online e totalmente disponível durante o processo de saudação.</span><span class="sxs-lookup"><span data-stu-id="19efd-242">Databases remain online and fully available throughout hello process.</span></span> <span data-ttu-id="19efd-243">Em Olá último momento como cada banco de dados está pronto toobe habilitado com hello novo eDTU do pool, qualquer conexão ativa foram interrompido.</span><span class="sxs-lookup"><span data-stu-id="19efd-243">At hello last moment as each database is ready toobe enabled with hello new pool eDTU, any active connections are broken.</span></span> <span data-ttu-id="19efd-244">Código do aplicativo deve sempre ser gravado conexões tooretry descartado e, portanto, reconectará toohello banco de dados no pool do hello expandidos.</span><span class="sxs-lookup"><span data-stu-id="19efd-244">Application code should always be written tooretry dropped connections, and so will reconnect toohello database in hello scaled-up pool.</span></span>

## <a name="load-balance-between-pools"></a><span data-ttu-id="19efd-245">Balancear carga entre pools</span><span class="sxs-lookup"><span data-stu-id="19efd-245">Load balance between pools</span></span>

<span data-ttu-id="19efd-246">Como uma alternativa tooscaling pool hello, crie um pool de segundo e mover bancos de dados para ela toobalance Olá carregar entre hello dois pools.</span><span class="sxs-lookup"><span data-stu-id="19efd-246">As an alternative tooscaling up hello pool, create a second pool and move databases into it toobalance hello load between hello two pools.</span></span> <span data-ttu-id="19efd-247">toodo este novo pool de saudação deve ser criado em Olá Olá mesmo servidor primeiro.</span><span class="sxs-lookup"><span data-stu-id="19efd-247">toodo this hello new pool must be created on hello same server as hello first.</span></span>

1. <span data-ttu-id="19efd-248">Em Olá [portal do Azure](https://portal.azure.com), abra Olá **tenants1 -&lt;usuário&gt;**  server.</span><span class="sxs-lookup"><span data-stu-id="19efd-248">In hello [Azure portal](https://portal.azure.com), open hello **tenants1-&lt;USER&gt;** server.</span></span>
1. <span data-ttu-id="19efd-249">Clique em **+ novo pool** toocreate um pool no servidor de saudação atual.</span><span class="sxs-lookup"><span data-stu-id="19efd-249">Click **+ New pool** toocreate a pool on hello current server.</span></span>
1. <span data-ttu-id="19efd-250">Em Olá **pool Elástico de banco de dados** modelo:</span><span class="sxs-lookup"><span data-stu-id="19efd-250">On hello **Elastic database pool** template:</span></span>

    1. <span data-ttu-id="19efd-251">Definir **nome** muito*Pool2*.</span><span class="sxs-lookup"><span data-stu-id="19efd-251">Set **Name** too*Pool2*.</span></span>
    1. <span data-ttu-id="19efd-252">Deixe Olá preço como **Pool padrão**.</span><span class="sxs-lookup"><span data-stu-id="19efd-252">Leave hello pricing tier as **Standard Pool**.</span></span>
    1. <span data-ttu-id="19efd-253">Clique em **Configurar pool**,</span><span class="sxs-lookup"><span data-stu-id="19efd-253">Click **Configure pool**,</span></span>
    1. <span data-ttu-id="19efd-254">Definir **eDTU de Pool** muito*eDTU 50*.</span><span class="sxs-lookup"><span data-stu-id="19efd-254">Set **Pool eDTU** too*50 eDTU*.</span></span>
    1. <span data-ttu-id="19efd-255">Clique em **adicionar bancos de dados** toosee uma lista de bancos de dados no servidor de saudação que podem ser adicionados muito*Pool2*.</span><span class="sxs-lookup"><span data-stu-id="19efd-255">Click **Add databases** toosee a list of databases on hello server that can be added too*Pool2*.</span></span>
    1. <span data-ttu-id="19efd-256">Selecione qualquer toomove 10 bancos de dados essas toohello novo pool e, em seguida, clique em **selecione**.</span><span class="sxs-lookup"><span data-stu-id="19efd-256">Select any 10 databases toomove these toohello new pool, and then click **Select**.</span></span> <span data-ttu-id="19efd-257">Se você executa o gerador de carga hello, serviço Olá já sabe que o perfil de desempenho exige um pool maior que tamanho de eDTU 50 saudação padrão e recomenda que você comece com uma configuração de eDTU 100.</span><span class="sxs-lookup"><span data-stu-id="19efd-257">If you've been running hello load generator, hello service already knows that your performance profile requires a larger pool than hello default 50 eDTU size and recommends starting with a 100 eDTU setting.</span></span>

    ![recomendação](media/sql-database-saas-tutorial-performance-monitoring/configure-pool.png)

    1. <span data-ttu-id="19efd-259">Para este tutorial, mantenha o padrão de saudação em 50 eDTUs e clique em **selecione** novamente.</span><span class="sxs-lookup"><span data-stu-id="19efd-259">For this tutorial, leave hello default at 50 eDTUs, and click **Select** again.</span></span>
    1. <span data-ttu-id="19efd-260">Selecione **Okey** toocreate Olá novo pool e toomove Olá bancos de dados selecionados para ele.</span><span class="sxs-lookup"><span data-stu-id="19efd-260">Select **OK** toocreate hello new pool and toomove hello selected databases into it.</span></span>

<span data-ttu-id="19efd-261">Criar pool de saudação e mover bancos de dados Olá leva alguns minutos.</span><span class="sxs-lookup"><span data-stu-id="19efd-261">Creating hello pool and moving hello databases takes a few minutes.</span></span> <span data-ttu-id="19efd-262">Como bancos de dados são movidos permaneçam online e acessível até o último momento de hello, no ponto em que todas as conexões abertas são fechadas.</span><span class="sxs-lookup"><span data-stu-id="19efd-262">As databases are moved they remain online and fully accessible until hello very last moment, at which point any open connections are closed.</span></span> <span data-ttu-id="19efd-263">Contanto que você tenha alguma lógica de repetição, clientes, em seguida, conectará toohello banco de dados no novo pool de saudação.</span><span class="sxs-lookup"><span data-stu-id="19efd-263">As long as you have some retry logic, clients will then connect toohello database in hello new pool.</span></span>

<span data-ttu-id="19efd-264">Procurar muito**Pool2** (em Olá *tenants1* server) tooopen Olá pool e monitorar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="19efd-264">Browse too**Pool2** (on hello *tenants1* server) tooopen hello pool and monitor its performance.</span></span> <span data-ttu-id="19efd-265">Se você não estiver visível, aguarde o provisionamento de saudação novo pool toocomplete.</span><span class="sxs-lookup"><span data-stu-id="19efd-265">If you don't see it, wait for provisioning of hello new pool toocomplete.</span></span>

<span data-ttu-id="19efd-266">Agora você vê que o uso de recursos do *Pool1* caiu e que o *Pool2* é carregado de maneira semelhante.</span><span class="sxs-lookup"><span data-stu-id="19efd-266">You now see that resource usage on *Pool1* has dropped and that *Pool2* is now similarly loaded.</span></span>

## <a name="manage-performance-of-a-single-database"></a><span data-ttu-id="19efd-267">Gerenciar o desempenho de um banco de dados individual</span><span class="sxs-lookup"><span data-stu-id="19efd-267">Manage performance of a single database</span></span>

<span data-ttu-id="19efd-268">Se um único banco de dados em um pool de apresentar uma alta carga sustentável, dependendo da configuração do pool de Olá, ele pode tendem a recursos de saudação toodominate no pool de saudação e afetar outros bancos de dados.</span><span class="sxs-lookup"><span data-stu-id="19efd-268">If a single database in a pool experiences a sustained high load, depending on hello pool configuration, it may tend toodominate hello resources in hello pool and impact other databases.</span></span> <span data-ttu-id="19efd-269">Se a atividade de saudação é provavelmente toocontinue por algum tempo, o banco de dados de saudação pode ser movido temporariamente fora do pool de saudação.</span><span class="sxs-lookup"><span data-stu-id="19efd-269">If hello activity is likely toocontinue for some time, hello database can be temporarily moved out of hello pool.</span></span> <span data-ttu-id="19efd-270">Isso permite Olá Olá de toohave do banco de dados de recursos extras necessárias e isola da saudação outros bancos de dados.</span><span class="sxs-lookup"><span data-stu-id="19efd-270">This allows hello database toohave hello extra resources it needs, and isolates it from hello other databases.</span></span>

<span data-ttu-id="19efd-271">Este exercício simula o efeito de saudação de Contoso conjunto Hall apresentando uma alta carga quando tíquetes de venda para um conjunto popular.</span><span class="sxs-lookup"><span data-stu-id="19efd-271">This exercise simulates hello effect of Contoso Concert Hall experiencing a high load when tickets go on sale for a popular concert.</span></span>

1. <span data-ttu-id="19efd-272">Olá abrir... \\ *Demonstração PerformanceMonitoringAndManagement.ps1* script.</span><span class="sxs-lookup"><span data-stu-id="19efd-272">Open hello …\\*Demo-PerformanceMonitoringAndManagement.ps1* script.</span></span>
1. <span data-ttu-id="19efd-273">Defina **$DemoScenario = 5, Gerar uma carga normal e uma carga alta em um locatário único (aprox. 95 DTU).**</span><span class="sxs-lookup"><span data-stu-id="19efd-273">Set **$DemoScenario = 5, Generate a normal load plus a high load on a single tenant (approx. 95 DTU).**</span></span>
1. <span data-ttu-id="19efd-274">Defina **$SingleTenantDatabaseName = contosoconcerthall**</span><span class="sxs-lookup"><span data-stu-id="19efd-274">Set **$SingleTenantDatabaseName = contosoconcerthall**</span></span>
1. <span data-ttu-id="19efd-275">Executar usando o script hello **F5**.</span><span class="sxs-lookup"><span data-stu-id="19efd-275">Execute hello script using **F5**.</span></span>


1. <span data-ttu-id="19efd-276">Em Olá [portal do Azure](https://portal.azure.com) abrir **Pool1**.</span><span class="sxs-lookup"><span data-stu-id="19efd-276">In hello [Azure portal](https://portal.azure.com) open **Pool1**.</span></span>
1. <span data-ttu-id="19efd-277">Inspecionar Olá **monitoramento de pool Elástico** do gráfico e procure Olá maior uso de eDTU do pool.</span><span class="sxs-lookup"><span data-stu-id="19efd-277">Inspect hello **Elastic pool monitoring** chart and look for hello increased pool eDTU usage.</span></span> <span data-ttu-id="19efd-278">Depois de um ou dois minutos, uma carga maior Olá deve começar tookick no, e você deverá ver rapidamente pool Olá atinge 100% de utilização.</span><span class="sxs-lookup"><span data-stu-id="19efd-278">After a minute or two, hello higher load should start tookick in, and you should quickly see that hello pool hits 100% utilization.</span></span>
1. <span data-ttu-id="19efd-279">Inspecionar Olá **monitoramento de banco de dados Elástico** exibição que mostra bancos de dados principais Olá Olá última hora.</span><span class="sxs-lookup"><span data-stu-id="19efd-279">Inspect hello **Elastic database monitoring** display which shows hello hottest databases in hello past hour.</span></span> <span data-ttu-id="19efd-280">Olá *contosoconcerthall* banco de dados em breve deve aparecer como um Olá cinco principais bancos de dados.</span><span class="sxs-lookup"><span data-stu-id="19efd-280">hello *contosoconcerthall* database should soon appear as one of hello five hottest databases.</span></span>
1. <span data-ttu-id="19efd-281">**Clique em monitoramento de banco de dados Elástico Olá** **gráfico** e ele abre Olá **utilização de recursos de banco de dados** página onde você pode monitorar qualquer um dos bancos de dados de saudação.</span><span class="sxs-lookup"><span data-stu-id="19efd-281">**Click on hello Elastic database monitoring** **chart** and it opens hello **Database Resource Utilization** page where you can monitor any of hello databases.</span></span> <span data-ttu-id="19efd-282">Isso lhe permite isolar exibição Olá para Olá *contosoconcerthall* banco de dados.</span><span class="sxs-lookup"><span data-stu-id="19efd-282">This lets you isolate hello display for hello *contosoconcerthall* database.</span></span>
1. <span data-ttu-id="19efd-283">Na lista de saudação de bancos de dados, clique em **contosoconcerthall**.</span><span class="sxs-lookup"><span data-stu-id="19efd-283">From hello list of databases, click **contosoconcerthall**.</span></span>
1. <span data-ttu-id="19efd-284">Clique em **preço (escala DTUs)** tooopen Olá **Configure desempenho** página onde você pode definir um nível de desempenho independente do banco de dados de saudação.</span><span class="sxs-lookup"><span data-stu-id="19efd-284">Click **Pricing Tier (scale DTUs)** tooopen hello **Configure performance** page where you can set a stand-alone performance level for hello database.</span></span>
1. <span data-ttu-id="19efd-285">Clique em Olá **padrão** guia Opções de escala de saudação tooopen na camada padrão hello.</span><span class="sxs-lookup"><span data-stu-id="19efd-285">Click on hello **Standard** tab tooopen hello scale options in hello Standard tier.</span></span>
1. <span data-ttu-id="19efd-286">Deslize Olá **controle deslizante DTU** tooright tooselect **100** DTUs.</span><span class="sxs-lookup"><span data-stu-id="19efd-286">Slide hello **DTU slider** tooright tooselect **100** DTUs.</span></span> <span data-ttu-id="19efd-287">Observe que isso corresponde toohello objetivo de serviço, **S3**.</span><span class="sxs-lookup"><span data-stu-id="19efd-287">Note this corresponds toohello service objective, **S3**.</span></span>
1. <span data-ttu-id="19efd-288">Clique em **aplicar** toomove Olá fora do pool de saudação do banco de dados e torná-lo um *Standard S3* banco de dados.</span><span class="sxs-lookup"><span data-stu-id="19efd-288">Click **Apply** toomove hello database out of hello pool and make it a *Standard S3* database.</span></span>
1. <span data-ttu-id="19efd-289">Depois que o dimensionamento é concluída, monitor Olá efeito no banco de dados do hello contosoconcerthall e Pool1 em folhas Elásticos Olá pool e o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="19efd-289">Once scaling is complete, monitor hello effect on hello contosoconcerthall database and Pool1 on hello elastic pool and database blades.</span></span>

<span data-ttu-id="19efd-290">Depois que a alta carga Olá no banco de dados de contosoconcerthall Olá diminuir devolva-toohello pool tooreduce seu custo.</span><span class="sxs-lookup"><span data-stu-id="19efd-290">Once hello high load on hello contosoconcerthall database subsides you should promptly return it toohello pool tooreduce its cost.</span></span> <span data-ttu-id="19efd-291">Se não está claro ao que acontece você pode definir um alerta no banco de dados de saudação que irá disparar quando o uso DTU está abaixo da saudação por banco de dados max em pool hello.</span><span class="sxs-lookup"><span data-stu-id="19efd-291">If it’s unclear when that will happen you could set an alert on hello database that will trigger when its DTU usage drops below hello per-database max on hello pool.</span></span> <span data-ttu-id="19efd-292">Mover um banco de dados para um pool é descrito no exercício 5.</span><span class="sxs-lookup"><span data-stu-id="19efd-292">Moving a database into a pool is described in exercise 5.</span></span>

## <a name="other-performance-management-patterns"></a><span data-ttu-id="19efd-293">Outros padrões de gerenciamento de desempenho</span><span class="sxs-lookup"><span data-stu-id="19efd-293">Other Performance Management Patterns</span></span>

<span data-ttu-id="19efd-294">**Dimensionamento preventivo** exercício Olá acima em que você usou como tooscale um banco de dados isolado, você sabia que toolook de banco de dados para.</span><span class="sxs-lookup"><span data-stu-id="19efd-294">**Pre-emptive scaling** In hello exercise above where you explored how tooscale an isolated database, you knew which database toolook for.</span></span> <span data-ttu-id="19efd-295">Se o gerenciamento de saudação do Contoso conjunto Hall tinha informado Wingtips de venda de tíquete iminente Olá, banco de dados de saudação pode ter sido movido fora do pool de saudação preventivamente.</span><span class="sxs-lookup"><span data-stu-id="19efd-295">If hello management of Contoso Concert Hall had informed Wingtips of hello impending ticket sale, hello database could have been moved out of hello pool pre-emptively.</span></span> <span data-ttu-id="19efd-296">Caso contrário, ele provavelmente exigiria um alerta no pool de saudação ou Olá toospot de banco de dados que estava acontecendo.</span><span class="sxs-lookup"><span data-stu-id="19efd-296">Otherwise, it would likely have required an alert on hello pool or hello database toospot what was happening.</span></span> <span data-ttu-id="19efd-297">Você não quer toolearn sobre isso da saudação outros locatários em Olá pool reclama degradação do desempenho.</span><span class="sxs-lookup"><span data-stu-id="19efd-297">You wouldn’t want toolearn about this from hello other tenants in hello pool complaining of degraded performance.</span></span> <span data-ttu-id="19efd-298">E se o locatário Olá pode prever quanto tempo eles precisarão recursos adicionais, você pode configurar uma automação do Azure runbook toomove Olá banco de dados fora do pool de saudação e, em seguida, volte outra vez em um agendamento definido.</span><span class="sxs-lookup"><span data-stu-id="19efd-298">And if hello tenant can predict how long they will need additional resources you can set up an Azure Automation runbook toomove hello database out of hello pool and then back in again on a defined schedule.</span></span>

<span data-ttu-id="19efd-299">**Dimensionamento de autoatendimento de locatário** como dimensionamento é uma tarefa chamada facilmente por meio da API de gerenciamento Olá, você pode facilmente criar bancos de dados de locatário tooscale de capacidade de saudação em seu aplicativo de voltada para o locatário e oferecê-lo como um recurso de seu serviço de SaaS.</span><span class="sxs-lookup"><span data-stu-id="19efd-299">**Tenant self-service scaling** Because scaling is a task easily called via hello management API, you can easily build hello ability tooscale tenant databases into your tenant-facing application, and offer it as a feature of your SaaS service.</span></span> <span data-ttu-id="19efd-300">Por exemplo, permitem que os locatários self-administer dimensionamento para cima e para baixo, talvez vinculados diretamente a cobrança tootheir!</span><span class="sxs-lookup"><span data-stu-id="19efd-300">For example, let tenants self-administer scaling up and down, perhaps linked directly tootheir billing!</span></span>

<span data-ttu-id="19efd-301">**Dimensionando um pool de cima para baixo nos padrões de uso de toomatch agenda**</span><span class="sxs-lookup"><span data-stu-id="19efd-301">**Scaling a pool up and down on a schedule toomatch usage patterns**</span></span>

<span data-ttu-id="19efd-302">Quando o uso de agregação locatário segue os padrões de uso previsível, você pode usar automação do Azure tooscale um pool para cima e para baixo em uma agenda.</span><span class="sxs-lookup"><span data-stu-id="19efd-302">Where aggregate tenant usage follows predictable usage patterns, you can use Azure Automation tooscale a pool up and down on a schedule.</span></span> <span data-ttu-id="19efd-303">Por exemplo, reduzir um pool verticalmente após as 18h e escalar verticalmente novamente antes das 6h em dias da semana nos quais você sabe que há uma queda nos requisitos de recursos.</span><span class="sxs-lookup"><span data-stu-id="19efd-303">For example, scale a pool down after 6pm and up again before 6am on weekdays when you know there is a drop in resource requirements.</span></span>



## <a name="next-steps"></a><span data-ttu-id="19efd-304">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="19efd-304">Next steps</span></span>

<span data-ttu-id="19efd-305">Neste tutorial, você aprenderá a:</span><span class="sxs-lookup"><span data-stu-id="19efd-305">In this tutorial you learn how to:</span></span>

> [!div class="checklist"]
> * <span data-ttu-id="19efd-306">Simule o uso em bancos de dados de locatário Olá executando um gerador de carga fornecido</span><span class="sxs-lookup"><span data-stu-id="19efd-306">Simulate usage on hello tenant databases by running a provided load generator</span></span>
> * <span data-ttu-id="19efd-307">Bancos de dados de locatário de saudação do monitor como eles respondem toohello aumento na carga</span><span class="sxs-lookup"><span data-stu-id="19efd-307">Monitor hello tenant databases as they respond toohello increase in load</span></span>
> * <span data-ttu-id="19efd-308">Dimensionar o hello pool Elástico em resposta toohello maior banco de dados de carga</span><span class="sxs-lookup"><span data-stu-id="19efd-308">Scale up hello Elastic pool in response toohello increased database load</span></span>
> * <span data-ttu-id="19efd-309">Provisionar uma segunda atividade de banco de dados do pool Elástico tooload saldo Olá</span><span class="sxs-lookup"><span data-stu-id="19efd-309">Provision a second Elastic pool tooload balance hello database activity</span></span>

[<span data-ttu-id="19efd-310">Tutorial para restaurar um locatário único</span><span class="sxs-lookup"><span data-stu-id="19efd-310">Restore a single tenant tutorial</span></span>](sql-database-saas-tutorial-restore-single-tenant.md)


## <a name="additional-resources"></a><span data-ttu-id="19efd-311">Recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="19efd-311">Additional resources</span></span>

* <span data-ttu-id="19efd-312">Adicionais [tutoriais que se baseiam na Olá implantação de aplicativos SaaS Wingtip](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)</span><span class="sxs-lookup"><span data-stu-id="19efd-312">Additional [tutorials that build upon hello Wingtip SaaS application deployment](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)</span></span>
* [<span data-ttu-id="19efd-313">Pools elásticos do SQL</span><span class="sxs-lookup"><span data-stu-id="19efd-313">SQL Elastic pools</span></span>](sql-database-elastic-pool.md)
* [<span data-ttu-id="19efd-314">Automação do Azure</span><span class="sxs-lookup"><span data-stu-id="19efd-314">Azure automation</span></span>](../automation/automation-intro.md)
* <span data-ttu-id="19efd-315">[Log Analytics](sql-database-saas-tutorial-log-analytics.md) – Tutorial de configuração e uso do Log Analytics</span><span class="sxs-lookup"><span data-stu-id="19efd-315">[Log Analytics](sql-database-saas-tutorial-log-analytics.md) - Setting up and using Log Analytics tutorial</span></span>
