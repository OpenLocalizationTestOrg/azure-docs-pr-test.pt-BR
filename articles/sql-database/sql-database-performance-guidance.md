---
title: Diretrizes de ajuste de desempenho do Banco de Dados SQL do Azure | Microsoft Docs
description: "Este artigo pode ajudar você a escolher a camada de serviço para seu aplicativo. Nele, também recomendamos formas de ajustar seu aplicativo para aproveitar ao máximo o Banco de Dados SQL do Azure."
services: sql-database
documentationcenter: na
author: CarlRabeler
manager: jhubbard
editor: 
ms.assetid: dd8d95fa-24b2-4233-b3f1-8e8952a7a22b
ms.service: sql-database
ms.custom: monitor & tune
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-management
ms.date: 02/09/2017
ms.author: carlrab
ms.openlocfilehash: dc0244f0e0949b172c391825057f5c14893a5158
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 07/11/2017
---
# <a name="tuning-performance-in-azure-sql-database"></a><span data-ttu-id="0c269-104">Ajustando o desempenho no Banco de Dados SQL do Azure</span><span class="sxs-lookup"><span data-stu-id="0c269-104">Tuning performance in Azure SQL Database</span></span>

<span data-ttu-id="0c269-105">O Banco de Dados SQL do Azure fornece [recomendações](sql-database-advisor.md) que podem ser usadas para melhorar o desempenho do banco de dados ou você pode permitir que o Banco de Dados SQL do Azure [adapte-se ao seu aplicativo automaticamente](sql-database-automatic-tuning.md) e aplique as alterações que melhorarão o desempenho da carga de trabalho.</span><span class="sxs-lookup"><span data-stu-id="0c269-105">Azure SQL Database provides [recommendations](sql-database-advisor.md) that you can use to improve performance of your database, or you can let Azure SQL Database [automatically adapt to your application](sql-database-automatic-tuning.md) and apply changes that will improve performance of your workload.</span></span>

<span data-ttu-id="0c269-106">Se você não tiver nenhuma recomendação aplicável e ainda tiver problemas de desempenho, poderá usar os seguintes métodos para melhorar o desempenho:</span><span class="sxs-lookup"><span data-stu-id="0c269-106">In you don't have any applicable recommendations, and you still have performance issues, you might use the following methods to improve performances:</span></span>
1. <span data-ttu-id="0c269-107">Aumentar as [camadas de serviço](sql-database-service-tiers.md) e fornecer mais recursos para o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="0c269-107">Increase [service tiers](sql-database-service-tiers.md) and provide more resources to your database.</span></span>
2. <span data-ttu-id="0c269-108">Ajustar o aplicativo e aplicar algumas melhores práticas que podem melhorar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="0c269-108">Tune your application and apply some best practices that can improve performance.</span></span> 
3. <span data-ttu-id="0c269-109">Ajustar o banco de dados alterando índices e consultas para trabalhar com os dados de forma mais eficiente.</span><span class="sxs-lookup"><span data-stu-id="0c269-109">Tune the database by changing indexes and queries to more efficiently work with data.</span></span>

<span data-ttu-id="0c269-110">Esses são métodos manuais, porque você precisa decidir quais [camadas de serviço](sql-database-service-tiers.md) serão escolhidas ou precisa reescrever o código do aplicativo ou do banco de dados e implantar as alterações.</span><span class="sxs-lookup"><span data-stu-id="0c269-110">These are manual methods because you need to decide what [service tiers](sql-database-service-tiers.md) you would choose or you would need to rewrite application or database code and deply the changes.</span></span>

## <a name="increasing-performance-tier-of-your-database"></a><span data-ttu-id="0c269-111">Aumentando o nível de desempenho do banco de dados</span><span class="sxs-lookup"><span data-stu-id="0c269-111">Increasing performance tier of your database</span></span>

<span data-ttu-id="0c269-112">O Banco de Dados SQL do Azure oferece quatro [camadas de serviço](sql-database-service-tiers.md) que estão à sua disposição: Básico, Standard, Premium e Premium RS (o desempenho é medido em unidades de produtividade do banco de dados ou [DTUs](sql-database-what-is-a-dtu.md).</span><span class="sxs-lookup"><span data-stu-id="0c269-112">Azure SQL Database offers four [service tiers](sql-database-service-tiers.md) that you can choose from: Basic, Standard, Premium, and Premium RS (performance is measured in database throughput units, or [DTUs](sql-database-what-is-a-dtu.md).</span></span> <span data-ttu-id="0c269-113">Cada camada de serviço isola os recursos que o banco de dados SQL pode usar e garante um desempenho previsível para o nível de serviço em questão.</span><span class="sxs-lookup"><span data-stu-id="0c269-113">Each service tier strictly isolates the resources that your SQL database can use, and guarantees predictable performance for that service level.</span></span> <span data-ttu-id="0c269-114">Neste artigo, oferecemos orientações que podem ajudá-lo a escolher a camada de serviço para seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="0c269-114">In this article, we offer guidance that can help you choose the service tier for your application.</span></span> <span data-ttu-id="0c269-115">Também abordamos de que formas você pode ajustar seu aplicativo para aproveitar ao máximo o Banco de Dados SQL do Azure.</span><span class="sxs-lookup"><span data-stu-id="0c269-115">We also discuss ways that you can tune your application to get the most from Azure SQL Database.</span></span>

> [!NOTE]
> <span data-ttu-id="0c269-116">Este artigo se concentra em fornecer orientações sobre o desempenho de bancos de dados únicos no Banco de Dados SQL do Azure.</span><span class="sxs-lookup"><span data-stu-id="0c269-116">This article focuses on performance guidance for single databases in Azure SQL Database.</span></span> <span data-ttu-id="0c269-117">Para obter as diretrizes de desempenho relacionadas aos pools elásticos, consulte [Considerações de preço e desempenho para pools elásticos](sql-database-elastic-pool-guidance.md).</span><span class="sxs-lookup"><span data-stu-id="0c269-117">For performance guidance related to elastic pools, see [Price and performance considerations for elastic pools](sql-database-elastic-pool-guidance.md).</span></span> <span data-ttu-id="0c269-118">No entanto, observe que você pode aplicar muitas das recomendações de ajuste neste artigo a bancos de dados em um pool elástico e obter benefícios de desempenho semelhantes.</span><span class="sxs-lookup"><span data-stu-id="0c269-118">Note, though, that you can apply many of the tuning recommendations in this article to databases in an elastic pool, and get similar performance benefits.</span></span>
> 

* <span data-ttu-id="0c269-119">**Básico**: a camada de serviço Básica oferece boa previsibilidade de desempenho para cada banco de dados, hora após hora.</span><span class="sxs-lookup"><span data-stu-id="0c269-119">**Basic**: The Basic service tier offers good performance predictability for each database, hour over hour.</span></span> <span data-ttu-id="0c269-120">Em um banco de dados Básico, recursos suficientes dão suporte ao bom desempenho em um banco de dados pequeno que não tem várias solicitações simultâneas.</span><span class="sxs-lookup"><span data-stu-id="0c269-120">In a Basic database, sufficient resources support good performance in a small database that doesn't have multiple concurrent requests.</span></span> <span data-ttu-id="0c269-121">Os casos de uso típicos em que você usará a camada de serviço Básica são:</span><span class="sxs-lookup"><span data-stu-id="0c269-121">Typical use cases when you would use Basic service tier are:</span></span>
  * <span data-ttu-id="0c269-122">**Você está apenas começando a usar o Banco de Dados SQL do Azure**.</span><span class="sxs-lookup"><span data-stu-id="0c269-122">**You're just getting started with Azure SQL Database**.</span></span> <span data-ttu-id="0c269-123">Aplicativos que estão em desenvolvimento normalmente não precisam de altos níveis de desempenho.</span><span class="sxs-lookup"><span data-stu-id="0c269-123">Applications that are in development often don't need high-performance levels.</span></span> <span data-ttu-id="0c269-124">Os bancos de dados Básicos são um ambiente ideal para o desenvolvimento ou teste de banco de dados, por uma faixa de preço reduzida.</span><span class="sxs-lookup"><span data-stu-id="0c269-124">Basic databases are an ideal environment for database development or testing, at a low price point.</span></span>
  * <span data-ttu-id="0c269-125">**Você tem um banco de dados com um único usuário**.</span><span class="sxs-lookup"><span data-stu-id="0c269-125">**You have a database with a single user**.</span></span> <span data-ttu-id="0c269-126">Aplicativos que associam um único usuário a um banco de dados normalmente não têm requisitos altos em termos de simultaneidade e desempenho.</span><span class="sxs-lookup"><span data-stu-id="0c269-126">Applications that associate a single user with a database typically don’t have high concurrency and performance requirements.</span></span> <span data-ttu-id="0c269-127">Esses aplicativos são candidatos à camada de serviço Básica.</span><span class="sxs-lookup"><span data-stu-id="0c269-127">These applications are candidates for the Basic service tier.</span></span>
* <span data-ttu-id="0c269-128">**Standard**: a camada de serviço Standard oferece melhor previsibilidade de desempenho e fornece bom desempenho para bancos de dados que têm várias solicitações simultâneas, como aplicativos Web e de grupo de trabalho.</span><span class="sxs-lookup"><span data-stu-id="0c269-128">**Standard**: The Standard service tier offers improved performance predictability and provides good performance for databases that have multiple concurrent requests, like workgroup and web applications.</span></span> <span data-ttu-id="0c269-129">Quando escolhe um banco de dados da camada de serviço Standard, você pode dimensionar seu aplicativo de banco de dados com base em um desempenho previsível, minuto a minuto.</span><span class="sxs-lookup"><span data-stu-id="0c269-129">When you choose a Standard service tier database, you can size your database application based on predictable performance, minute over minute.</span></span>
  * <span data-ttu-id="0c269-130">**Seu banco de dados tem várias solicitações simultâneas**.</span><span class="sxs-lookup"><span data-stu-id="0c269-130">**Your database has multiple concurrent requests**.</span></span> <span data-ttu-id="0c269-131">Aplicativos que atendem mais de um usuário por vez normalmente precisam de níveis de desempenho mais altos.</span><span class="sxs-lookup"><span data-stu-id="0c269-131">Applications that service more than one user at a time usually need higher performance levels.</span></span> <span data-ttu-id="0c269-132">Por exemplo, aplicativos Web ou de grupo de trabalho que têm requisitos de tráfego de E/S de baixo a médio e que dão suporte a várias consultas simultâneas são bons candidatos para a camada de serviço Standard.</span><span class="sxs-lookup"><span data-stu-id="0c269-132">For example, workgroup or web applications that have low to medium IO traffic requirements supporting multiple concurrent queries are good candidates for the Standard service tier.</span></span>
* <span data-ttu-id="0c269-133">**Premium**: a camada de serviço Premium fornece um desempenho previsível, segundo após segundo, para cada banco de dados Premium.</span><span class="sxs-lookup"><span data-stu-id="0c269-133">**Premium**: The Premium service tier provides predictable performance, second over second, for each Premium database.</span></span> <span data-ttu-id="0c269-134">Quando escolhe a camada de serviço Premium, você pode dimensionar seu aplicativo de banco de dados com base na carga de pico desse banco de dados.</span><span class="sxs-lookup"><span data-stu-id="0c269-134">When you choose the Premium service tier, you can size your database application based on the peak load for that database.</span></span> <span data-ttu-id="0c269-135">O plano remove casos em que a variação de desempenho pode fazer com que pequenas consultas demorem mais do que o esperado em operações sensíveis à latência.</span><span class="sxs-lookup"><span data-stu-id="0c269-135">The plan removes cases in which performance variance can cause small queries to take longer than expected in latency-sensitive operations.</span></span> <span data-ttu-id="0c269-136">Esse modelo pode simplificar muito os ciclos de desenvolvimento e de validação de produtos para aplicativos que precisam criar instruções fortes sobre as necessidades de recursos de pico, a variação de desempenho ou a latência da consulta.</span><span class="sxs-lookup"><span data-stu-id="0c269-136">This model can greatly simplify the development and product validation cycles for applications that need to make strong statements about peak resource needs, performance variance, or query latency.</span></span> <span data-ttu-id="0c269-137">A maioria dos casos de uso da camada de serviço Premium tem uma ou mais destas características:</span><span class="sxs-lookup"><span data-stu-id="0c269-137">Most Premium service tier use cases have one or more of these characteristics:</span></span>
  * <span data-ttu-id="0c269-138">**Alta carga de pico**.</span><span class="sxs-lookup"><span data-stu-id="0c269-138">**High peak load**.</span></span> <span data-ttu-id="0c269-139">Um aplicativo que exige muita CPU, memória ou entrada/saída (E/S) para concluir suas operações requer um nível de alto desempenho dedicado.</span><span class="sxs-lookup"><span data-stu-id="0c269-139">An application that requires substantial CPU, memory, or input/output (I/O) to complete its operations requires a dedicated, high-performance level.</span></span> <span data-ttu-id="0c269-140">Por exemplo, uma operação de banco de dados conhecida por consumir vários núcleos de CPU por um longo período é uma candidata para a camada de serviço Premium.</span><span class="sxs-lookup"><span data-stu-id="0c269-140">For example, a database operation known to consume several CPU cores for an extended time is a candidate for the Premium service tier.</span></span>
  * <span data-ttu-id="0c269-141">**Muitas solicitações simultâneas**.</span><span class="sxs-lookup"><span data-stu-id="0c269-141">**Many concurrent requests**.</span></span> <span data-ttu-id="0c269-142">Alguns aplicativos de banco de dados atendem muitas solicitações simultâneas, por exemplo, ao servir um site com alto volume de tráfego.</span><span class="sxs-lookup"><span data-stu-id="0c269-142">Some database applications service many concurrent requests, for example, when serving a website that has a high traffic volume.</span></span> <span data-ttu-id="0c269-143">As camadas de serviço Básica e Standard limitam a quantidade de solicitações simultâneas por banco de dados.</span><span class="sxs-lookup"><span data-stu-id="0c269-143">Basic and Standard service tiers limit the number of concurrent requests per database.</span></span> <span data-ttu-id="0c269-144">Aplicativos que exigem mais conexões precisariam escolher um tamanho de reserva apropriado para lidar com o número máximo de solicitações necessárias.</span><span class="sxs-lookup"><span data-stu-id="0c269-144">Applications that require more connections would need to choose an appropriate reservation size to handle the maximum number of needed requests.</span></span>
  * <span data-ttu-id="0c269-145">**Baixa latência**.</span><span class="sxs-lookup"><span data-stu-id="0c269-145">**Low latency**.</span></span> <span data-ttu-id="0c269-146">Alguns aplicativos precisam garantir uma resposta do banco de dados em tempo mínimo.</span><span class="sxs-lookup"><span data-stu-id="0c269-146">Some applications need to guarantee a response from the database in minimal time.</span></span> <span data-ttu-id="0c269-147">Se um procedimento armazenado específico for chamado como parte de uma operação de cliente mais ampla, poderá haver o requisito de ter um retorno daquela chamada em não mais do que 20 milissegundos, 99% do tempo.</span><span class="sxs-lookup"><span data-stu-id="0c269-147">If a specific stored procedure is called as part of a broader customer operation, you might have a requirement to have a return from that call in no more than 20 milliseconds, 99 percent of the time.</span></span> <span data-ttu-id="0c269-148">Esse tipo de aplicativo se beneficia da camada de serviço Premium para certificar-se de que a capacidade de computação exigida esteja disponível.</span><span class="sxs-lookup"><span data-stu-id="0c269-148">This type of application benefits from the Premium service tier, to make sure that the required computing power is available.</span></span>
* <span data-ttu-id="0c269-149">**Premium RS**: a camada Premium RS foi projetada para cargas de trabalho com uso intensivo de E/S que não exigem garantias da mais alta disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="0c269-149">**Premium RS**: The Premium RS tier is designed for IO-intensive workloads that do not require the highest availability guarantees.</span></span> <span data-ttu-id="0c269-150">Exemplos de cargas de trabalho de alto desempenho ou uma carga de trabalho analítica onde o banco de dados não é o sistema de registro.</span><span class="sxs-lookup"><span data-stu-id="0c269-150">Examples include testing high-performance workloads, or an analytical workload where the database is not the system of record.</span></span>

<span data-ttu-id="0c269-151">O nível de serviço necessário para seu banco de dados SQL depende dos requisitos de carga de pico para cada dimensão de recurso.</span><span class="sxs-lookup"><span data-stu-id="0c269-151">The service level that you need for your SQL database depends on the peak load requirements for each resource dimension.</span></span> <span data-ttu-id="0c269-152">Alguns aplicativos usam quantidades comuns de um recurso, mas têm requisitos significativos para outros recursos.</span><span class="sxs-lookup"><span data-stu-id="0c269-152">Some applications use a trivial amount of a single resource, but have significant requirements for other resources.</span></span>

### <a name="service-tier-capabilities-and-limits"></a><span data-ttu-id="0c269-153">Limites e recursos da camada de serviço</span><span class="sxs-lookup"><span data-stu-id="0c269-153">Service tier capabilities and limits</span></span>

<span data-ttu-id="0c269-154">Em cada camada de serviço, você define o nível de desempenho, de modo que você tem a flexibilidade de pagar apenas pela capacidade de que precisa.</span><span class="sxs-lookup"><span data-stu-id="0c269-154">At each service tier, you set the performance level, so you have the flexibility to pay only for the capacity you need.</span></span> <span data-ttu-id="0c269-155">Você pode [ajustar a capacidade](sql-database-service-tiers.md), aumentando ou reduzindo-a, conforme a carga de trabalho mudar.</span><span class="sxs-lookup"><span data-stu-id="0c269-155">You can [adjust capacity](sql-database-service-tiers.md), up or down, as workload changes.</span></span> <span data-ttu-id="0c269-156">Por exemplo, se a carga de trabalho do banco de dados for intensa durante a temporada de compras de volta às aulas, você poderá aumentar o nível de desempenho do banco de dados durante um período definido, de julho a setembro.</span><span class="sxs-lookup"><span data-stu-id="0c269-156">For example, if your database workload is high during the back-to-school shopping season, you might increase the performance level for the database for a set time, July through September.</span></span> <span data-ttu-id="0c269-157">Você pode reduzi-lo quando sua temporada de pico terminar.</span><span class="sxs-lookup"><span data-stu-id="0c269-157">You can reduce it when your peak season ends.</span></span> <span data-ttu-id="0c269-158">Você pode minimizar o que pagará otimizando seu ambiente de nuvem para a periodicidade dos seus negócios.</span><span class="sxs-lookup"><span data-stu-id="0c269-158">You can minimize what you pay by optimizing your cloud environment to the seasonality of your business.</span></span> <span data-ttu-id="0c269-159">Esse modelo também funciona bem para ciclos de lançamento de produto de software.</span><span class="sxs-lookup"><span data-stu-id="0c269-159">This model also works well for software product release cycles.</span></span> <span data-ttu-id="0c269-160">Uma equipe de teste pode alocar capacidade ao executar testes e liberar essa capacidade quando os testes forem concluídos.</span><span class="sxs-lookup"><span data-stu-id="0c269-160">A test team might allocate capacity while it does test runs, and then release that capacity when they finish testing.</span></span> <span data-ttu-id="0c269-161">Em um modelo de solicitação de capacidade, você paga pela capacidade conforme precisa dela e evita gastos com recursos dedicados que raramente são usados.</span><span class="sxs-lookup"><span data-stu-id="0c269-161">In a capacity request model, you pay for capacity as you need it, and avoid spending on dedicated resources that you might rarely use.</span></span>

### <a name="why-service-tiers"></a><span data-ttu-id="0c269-162">Por que usar camadas de serviço?</span><span class="sxs-lookup"><span data-stu-id="0c269-162">Why service tiers?</span></span>
<span data-ttu-id="0c269-163">Embora cada carga de trabalho de banco de dados possa ser diferente, a finalidade das camadas de serviço é fornecer previsibilidade de desempenho em vários níveis de desempenho.</span><span class="sxs-lookup"><span data-stu-id="0c269-163">Although each database workload can differ, the purpose of service tiers is to provide performance predictability at various performance levels.</span></span> <span data-ttu-id="0c269-164">Clientes com requisitos de recursos de bancos de dados de grande escala podem trabalhar em um ambiente de computação mais dedicado.</span><span class="sxs-lookup"><span data-stu-id="0c269-164">Customers with large-scale database resource requirements can work in a more dedicated computing environment.</span></span>

## <a name="tune-your-application"></a><span data-ttu-id="0c269-165">Ajustar seu aplicativo</span><span class="sxs-lookup"><span data-stu-id="0c269-165">Tune your application</span></span>
<span data-ttu-id="0c269-166">No SQL Server local tradicional, o processo de planejamento de capacidade inicial frequentemente é separado do processo de executar um aplicativo em produção.</span><span class="sxs-lookup"><span data-stu-id="0c269-166">In traditional on-premises SQL Server, the process of initial capacity planning often is separated from the process of running an application in production.</span></span> <span data-ttu-id="0c269-167">Hardwares e licenças de produtos são comprados primeiro e o ajuste de desempenho é feito posteriormente.</span><span class="sxs-lookup"><span data-stu-id="0c269-167">Hardware and product licenses are purchased first, and performance tuning is done afterward.</span></span> <span data-ttu-id="0c269-168">Quando você usa o Banco de Dados SQL do Azure, é uma boa ideia integrar o processo de execução de um aplicativo e de seu ajuste.</span><span class="sxs-lookup"><span data-stu-id="0c269-168">When you use Azure SQL Database, it's a good idea to interweave the process of running an application and tuning it.</span></span> <span data-ttu-id="0c269-169">Com o modelo de pagamento pela capacidade sob demanda, você pode ajustar seu aplicativo para usar os recursos mínimos necessários no momento, em vez de provisionar excessivamente o hardware com base em palpites sobre os planos de crescimento futuro de um aplicativo, que frequentemente estão incorretos.</span><span class="sxs-lookup"><span data-stu-id="0c269-169">With the model of paying for capacity on demand, you can tune your application to use the minimum resources needed now, instead of overprovisioning on hardware based on guesses of future growth plans for an application, which often are incorrect.</span></span> <span data-ttu-id="0c269-170">Alguns clientes podem optar por não ajustar o aplicativo e, em vez disso, provisionar excessivamente os recursos de hardware.</span><span class="sxs-lookup"><span data-stu-id="0c269-170">Some customers might choose not to tune an application, and instead choose to overprovision hardware resources.</span></span> <span data-ttu-id="0c269-171">Essa abordagem poderá ser uma boa ideia se você não quiser alterar um aplicativo importante durante um período movimentado.</span><span class="sxs-lookup"><span data-stu-id="0c269-171">This approach might be a good idea if you don't want to change a key application during a busy period.</span></span> <span data-ttu-id="0c269-172">Entretanto, ajustar o aplicativo pode minimizar os requisitos de recurso e diminuir as contas mensais quando você usar as camadas de serviço no Banco de Dados SQL do Azure.</span><span class="sxs-lookup"><span data-stu-id="0c269-172">But, tuning an application can minimize resource requirements and lower monthly bills when you use the service tiers in Azure SQL Database.</span></span>

### <a name="application-characteristics"></a><span data-ttu-id="0c269-173">Características do aplicativo</span><span class="sxs-lookup"><span data-stu-id="0c269-173">Application characteristics</span></span>
<span data-ttu-id="0c269-174">Embora as camadas de serviço do Banco de Dados SQL do Azure sejam projetadas para melhorar a estabilidade e a previsibilidade de desempenho de um aplicativo, algumas práticas recomendadas podem ajudá-lo a ajustar seu aplicativo para aproveitar melhor os recursos dentro de um nível de desempenho.</span><span class="sxs-lookup"><span data-stu-id="0c269-174">Although Azure SQL Database service tiers are designed to improve performance stability and predictability for an application, some best practices can help you tune your application to better take advantage of the resources at a performance level.</span></span> <span data-ttu-id="0c269-175">Embora vários aplicativos tenham ganhos de desempenho significativos simplesmente passando para um nível de desempenho e/ou camada de serviço superior, nem todos os aplicativos precisam de ajuste adicional para se beneficiar de um nível de serviço mais elevado.</span><span class="sxs-lookup"><span data-stu-id="0c269-175">Although many applications have significant performance gains simply by switching to a higher performance level or service tier, some applications need additional tuning to benefit from a higher level of service.</span></span> <span data-ttu-id="0c269-176">Para melhorar o desempenho, considere realizar ajustes adicionais em aplicativos que têm estas características:</span><span class="sxs-lookup"><span data-stu-id="0c269-176">For increased performance, consider additional application tuning for applications that have these characteristics:</span></span>

* <span data-ttu-id="0c269-177">**Aplicativos que têm desempenho lento devido a um comportamento "barulhento"**.</span><span class="sxs-lookup"><span data-stu-id="0c269-177">**Applications that have slow performance because of "chatty" behavior**.</span></span> <span data-ttu-id="0c269-178">Aplicativos barulhentos geram um excesso de operações de acesso a dados sensíveis à latência de rede.</span><span class="sxs-lookup"><span data-stu-id="0c269-178">Chatty applications make excessive data access operations that are sensitive to network latency.</span></span> <span data-ttu-id="0c269-179">Pode ser necessário modificar esses tipos de aplicativos para reduzir o número de operações de acesso a dados no banco de dados SQL.</span><span class="sxs-lookup"><span data-stu-id="0c269-179">You might need to modify these kinds of applications to reduce the number of data access operations to the SQL database.</span></span> <span data-ttu-id="0c269-180">Por exemplo, você pode melhorar o desempenho do aplicativo usando técnicas como o envio em lote de consultas ad hoc ou a movimentação das consultas em procedimentos armazenados.</span><span class="sxs-lookup"><span data-stu-id="0c269-180">For example, you might improve application performance by using techniques like batching ad-hoc queries or moving the queries to stored procedures.</span></span> <span data-ttu-id="0c269-181">Para obter mais informações, consulte [Consultas em lote](#batch-queries).</span><span class="sxs-lookup"><span data-stu-id="0c269-181">For more information, see [Batch queries](#batch-queries).</span></span>
* <span data-ttu-id="0c269-182">**Bancos de dados com uma carga de trabalho intensiva que não podem ter suporte de um único computador inteiro**.</span><span class="sxs-lookup"><span data-stu-id="0c269-182">**Databases with an intensive workload that can't be supported by an entire single machine**.</span></span> <span data-ttu-id="0c269-183">Bancos de dados que ultrapassam os recursos do nível mais alto de desempenho Premium podem se beneficiar de escalar horizontalmente a carga de trabalho.</span><span class="sxs-lookup"><span data-stu-id="0c269-183">Databases that exceed the resources of the highest Premium performance level might benefit from scaling out the workload.</span></span> <span data-ttu-id="0c269-184">Para obter mais informações, consulte [Fragmentação entre banco de dados](#cross-database-sharding) e [Particionamento funcional](#functional-partitioning).</span><span class="sxs-lookup"><span data-stu-id="0c269-184">For more information, see [Cross-database sharding](#cross-database-sharding) and [Functional partitioning](#functional-partitioning).</span></span>
* <span data-ttu-id="0c269-185">**Aplicativos com consultas de qualidade inferior**.</span><span class="sxs-lookup"><span data-stu-id="0c269-185">**Applications that have suboptimal queries**.</span></span> <span data-ttu-id="0c269-186">Aplicativos que têm consultas mal ajustadas, especialmente aqueles na camada de acesso a dados, podem não se beneficiar de um nível de desempenho superior.</span><span class="sxs-lookup"><span data-stu-id="0c269-186">Applications, especially those in the data access layer, that have poorly tuned queries might not benefit from a higher performance level.</span></span> <span data-ttu-id="0c269-187">Isso inclui consultas sem uma cláusula WHERE, com índices ausentes ou com estatísticas desatualizadas.</span><span class="sxs-lookup"><span data-stu-id="0c269-187">This includes queries that lack a WHERE clause, have missing indexes, or have outdated statistics.</span></span> <span data-ttu-id="0c269-188">Esses aplicativos se beneficiam de técnicas de ajuste de desempenho de consulta padrão.</span><span class="sxs-lookup"><span data-stu-id="0c269-188">These applications benefit from standard query performance-tuning techniques.</span></span> <span data-ttu-id="0c269-189">Para obter mais informações, consulte [Índices ausentes](#identifying-and-adding-missing-indexes) e [Ajuste e dicas de consulta](#query-tuning-and-hinting).</span><span class="sxs-lookup"><span data-stu-id="0c269-189">For more information, see [Missing indexes](#identifying-and-adding-missing-indexes) and [Query tuning and hinting](#query-tuning-and-hinting).</span></span>
* <span data-ttu-id="0c269-190">**Aplicativos com design de acesso a dados de qualidade inferior**.</span><span class="sxs-lookup"><span data-stu-id="0c269-190">**Applications that have suboptimal data access design**.</span></span> <span data-ttu-id="0c269-191">Aplicativos com problemas de simultaneidade de acesso a dados intrínsecos, por exemplo, deadlock, talvez não se beneficiem da seleção de um nível mais alto de desempenho.</span><span class="sxs-lookup"><span data-stu-id="0c269-191">Applications that have inherent data access concurrency issues, for example deadlocking, might not benefit from a higher performance level.</span></span> <span data-ttu-id="0c269-192">Considere reduzir as viagens de ida e volta ao Banco de Dados SQL do Azure armazenando em cache os dados no lado do cliente usando o serviço de Caching do Azure ou outras tecnologias de cache.</span><span class="sxs-lookup"><span data-stu-id="0c269-192">Consider reducing round trips against the Azure SQL Database by caching data on the client side with the Azure Caching service or another caching technology.</span></span> <span data-ttu-id="0c269-193">Consulte [Cache da camada de aplicativo](#application-tier-caching).</span><span class="sxs-lookup"><span data-stu-id="0c269-193">See [Application tier caching](#application-tier-caching).</span></span>

## <a name="tune-your-database"></a><span data-ttu-id="0c269-194">Ajustar o banco de dados</span><span class="sxs-lookup"><span data-stu-id="0c269-194">Tune your database</span></span>
<span data-ttu-id="0c269-195">Nesta seção, vemos algumas técnicas que você pode usar para ajustar o Banco de Dados SQL do Azure para obter o melhor desempenho do seu aplicativo e executá-lo no menor nível de desempenho possível.</span><span class="sxs-lookup"><span data-stu-id="0c269-195">In this section, we look at some techniques that you can use to tune Azure SQL Database to gain the best performance for your application and run it at the lowest possible performance level.</span></span> <span data-ttu-id="0c269-196">Algumas dessas técnicas correspondem às práticas recomendadas tradicionais de ajuste do SQL Server, mas outras são específicas ao Banco de Dados SQL do Azure.</span><span class="sxs-lookup"><span data-stu-id="0c269-196">Some of these techniques match traditional SQL Server tuning best practices, but others are specific to Azure SQL Database.</span></span> <span data-ttu-id="0c269-197">Em alguns casos, você pode examinar os recursos consumidos por um banco de dados para localizar áreas para ajustar ainda mais, bem como ampliar técnicas tradicionais do SQL Server para que elas funcionem no Banco de Dados SQL do Azure.</span><span class="sxs-lookup"><span data-stu-id="0c269-197">In some cases, you can examine the consumed resources for a database to find areas to further tune and extend traditional SQL Server techniques to work in Azure SQL Database.</span></span>

### <a name="identify-performance-issues-using-azure-portal"></a><span data-ttu-id="0c269-198">Identificar problemas de desempenho usando o portal do Azure</span><span class="sxs-lookup"><span data-stu-id="0c269-198">Identify performance issues using Azure portal</span></span>
<span data-ttu-id="0c269-199">As ferramentas a seguir no Portal do Azure podem ajudar você a analisar e corrigir problemas de desempenho com seu Banco de Dados SQL:</span><span class="sxs-lookup"><span data-stu-id="0c269-199">The following tools in the Azure portal can help you analyze and fix performance issues with your SQL database:</span></span>

* [<span data-ttu-id="0c269-200">Visão de Desempenho de Consulta</span><span class="sxs-lookup"><span data-stu-id="0c269-200">Query Performance Insight</span></span>](sql-database-query-performance.md)
* [<span data-ttu-id="0c269-201">Advisor do Banco de Dados SQL</span><span class="sxs-lookup"><span data-stu-id="0c269-201">SQL Database Advisor</span></span>](sql-database-advisor.md)

<span data-ttu-id="0c269-202">O portal do Azure tem mais informações sobre essas ferramentas e como usá-las.</span><span class="sxs-lookup"><span data-stu-id="0c269-202">The Azure portal has more information about both of these tools and how to use them.</span></span> <span data-ttu-id="0c269-203">Recomendamos que primeiro você experimente as ferramentas no portal do Azure a fim de diagnosticar e corrigir os problemas com mais eficiência.</span><span class="sxs-lookup"><span data-stu-id="0c269-203">To efficiently diagnose and correct problems, we recommend that you first try the tools in the Azure portal.</span></span> <span data-ttu-id="0c269-204">Recomendamos que você use as abordagens de ajuste que discutiremos a seguir, para índices ausentes e ajustes de consultas, em casos especiais.</span><span class="sxs-lookup"><span data-stu-id="0c269-204">We recommend that you use the manual tuning approaches that we discuss next, for missing indexes and query tuning, in special cases.</span></span>

<span data-ttu-id="0c269-205">Encontre mais informações sobre como identificar problemas no Banco de Dados SQL do Azure no artigo [Monitoramento de desempenho](sql-database-single-database-monitor.md).</span><span class="sxs-lookup"><span data-stu-id="0c269-205">Find more information about identifying issues in Azure SQL Database on [performance monitoring](sql-database-single-database-monitor.md) article.</span></span>

### <a name="identifying-and-adding-missing-indexes"></a><span data-ttu-id="0c269-206">Identificando e adicionando índices ausentes</span><span class="sxs-lookup"><span data-stu-id="0c269-206">Identifying and adding missing indexes</span></span>
<span data-ttu-id="0c269-207">Um problema comum no desempenho do banco de dados OLTP está relacionado ao design do banco de dados físico.</span><span class="sxs-lookup"><span data-stu-id="0c269-207">A common problem in OLTP database performance relates to the physical database design.</span></span> <span data-ttu-id="0c269-208">Com frequência, os esquemas de banco de dados são projetados e enviados sem testes em escala (seja na carga ou no volume de dados).</span><span class="sxs-lookup"><span data-stu-id="0c269-208">Often, database schemas are designed and shipped without testing at scale (either in load or in data volume).</span></span> <span data-ttu-id="0c269-209">Infelizmente, o desempenho de um plano de consulta pode ser aceitável em pequena escala, mas pode ser comprometido substancialmente diante de volumes de dados de nível de produção.</span><span class="sxs-lookup"><span data-stu-id="0c269-209">Unfortunately, the performance of a query plan might be acceptable on a small scale but degrade substantially under production-level data volumes.</span></span> <span data-ttu-id="0c269-210">A origem mais comum desse problema é a falta de índices apropriados para satisfazer filtros ou outras restrições em uma consulta.</span><span class="sxs-lookup"><span data-stu-id="0c269-210">The most common source of this issue is the lack of appropriate indexes to satisfy filters or other restrictions in a query.</span></span> <span data-ttu-id="0c269-211">Geralmente, os índices ausentes se manifestam como uma verificação de tabela quando uma busca de índice poderia bastar.</span><span class="sxs-lookup"><span data-stu-id="0c269-211">Often, missing indexes manifests as a table scan when an index seek could suffice.</span></span>

<span data-ttu-id="0c269-212">Neste exemplo, o plano de consulta selecionado usa uma verificação, quando uma pesquisa seria suficiente:</span><span class="sxs-lookup"><span data-stu-id="0c269-212">In this example, the selected query plan uses a scan when a seek would suffice:</span></span>

    DROP TABLE dbo.missingindex;
    CREATE TABLE dbo.missingindex (col1 INT IDENTITY PRIMARY KEY, col2 INT);
    DECLARE @a int = 0;
    SET NOCOUNT ON;
    BEGIN TRANSACTION
    WHILE @a < 20000
    BEGIN
        INSERT INTO dbo.missingindex(col2) VALUES (@a);
        SET @a += 1;
    END
    COMMIT TRANSACTION;
    GO
    SELECT m1.col1
    FROM dbo.missingindex m1 INNER JOIN dbo.missingindex m2 ON(m1.col1=m2.col1)
    WHERE m1.col2 = 4;

![Plano de consulta com índices ausentes](./media/sql-database-performance-guidance/query_plan_missing_indexes.png)

<span data-ttu-id="0c269-214">O Banco de Dados SQL do Azure pode ajudá-lo a localizar e corrigir condições comuns de índice ausente.</span><span class="sxs-lookup"><span data-stu-id="0c269-214">Azure SQL Database can help you find and fix common missing index conditions.</span></span> <span data-ttu-id="0c269-215">DMVs incorporadas ao Banco de Dados SQL do Azure examinam compilações de consulta em que um índice reduziria significativamente o custo estimado para executar uma consulta.</span><span class="sxs-lookup"><span data-stu-id="0c269-215">DMVs that are built into Azure SQL Database look at query compilations in which an index would significantly reduce the estimated cost to run a query.</span></span> <span data-ttu-id="0c269-216">Durante a execução da consulta, o Banco de Dados SQL monitora com que frequência cada plano de consulta é executado, bem como a lacuna estimada entre o plano de consulta em execução e o plano imaginado, em que esse índice existia.</span><span class="sxs-lookup"><span data-stu-id="0c269-216">During query execution, SQL Database tracks how often each query plan is executed, and tracks the estimated gap between the executing query plan and the imagined one where that index existed.</span></span> <span data-ttu-id="0c269-217">Você pode usar essas DMVs para adivinhar rapidamente quais alterações de design do banco de dados físico podem melhorar o custo da carga de trabalho geral para um banco de dados e sua carga de trabalho real.</span><span class="sxs-lookup"><span data-stu-id="0c269-217">You can use these DMVs to quickly guess which changes to your physical database design might improve overall workload cost for a database and its real workload.</span></span>

<span data-ttu-id="0c269-218">Você pode usar esta consulta para avaliar possíveis índices ausentes:</span><span class="sxs-lookup"><span data-stu-id="0c269-218">You can use this query to evaluate potential missing indexes:</span></span>

    SELECT CONVERT (varchar, getdate(), 126) AS runtime,
        mig.index_group_handle, mid.index_handle,
        CONVERT (decimal (28,1), migs.avg_total_user_cost * migs.avg_user_impact *
                (migs.user_seeks + migs.user_scans)) AS improvement_measure,
        'CREATE INDEX missing_index_' + CONVERT (varchar, mig.index_group_handle) + '_' +
                  CONVERT (varchar, mid.index_handle) + ' ON ' + mid.statement + '
                  (' + ISNULL (mid.equality_columns,'')
                  + CASE WHEN mid.equality_columns IS NOT NULL
                              AND mid.inequality_columns IS NOT NULL
                         THEN ',' ELSE '' END + ISNULL (mid.inequality_columns, '')
                  + ')'
                  + ISNULL (' INCLUDE (' + mid.included_columns + ')', '') AS create_index_statement,
        migs.*,
        mid.database_id,
        mid.[object_id]
    FROM sys.dm_db_missing_index_groups AS mig
    INNER JOIN sys.dm_db_missing_index_group_stats AS migs
        ON migs.group_handle = mig.index_group_handle
    INNER JOIN sys.dm_db_missing_index_details AS mid
        ON mig.index_handle = mid.index_handle
    ORDER BY migs.avg_total_user_cost * migs.avg_user_impact * (migs.user_seeks + migs.user_scans) DESC

<span data-ttu-id="0c269-219">Neste exemplo, a consulta resultou nesta sugestão:</span><span class="sxs-lookup"><span data-stu-id="0c269-219">In this example, the query resulted in this suggestion:</span></span>

    CREATE INDEX missing_index_5006_5005 ON [dbo].[missingindex] ([col2])  

<span data-ttu-id="0c269-220">Após a criação, a mesma instrução SELECT escolhe um plano diferente, que usa uma busca em vez de uma verificação e executa o plano de forma mais eficiente:</span><span class="sxs-lookup"><span data-stu-id="0c269-220">After it's created, that same SELECT statement picks a different plan, which uses a seek instead of a scan, and then executes the plan more efficiently:</span></span>

![Plano de consulta com índices corrigidos](./media/sql-database-performance-guidance/query_plan_corrected_indexes.png)

<span data-ttu-id="0c269-222">A ideia principal é que a capacidade de E/S de um sistema de mercadorias compartilhado é mais limitada do que a de um computador de servidor dedicado.</span><span class="sxs-lookup"><span data-stu-id="0c269-222">The key insight is that the I/O capacity of a shared, commodity system is more limited than that of a dedicated server machine.</span></span> <span data-ttu-id="0c269-223">Há o bônus de minimizar a E/S desnecessária e, assim, tirar o máximo proveito do sistema na DTU de cada nível de desempenho das camadas de serviço no Banco de Dados SQL do Azure.</span><span class="sxs-lookup"><span data-stu-id="0c269-223">There's a premium on minimizing unnecessary I/O to take maximum advantage of the system in the DTU of each performance level of the Azure SQL Database service tiers.</span></span> <span data-ttu-id="0c269-224">Opções adequadas de design de banco de dados físico podem melhorar significativamente a latência de consultas individuais, melhorar a produtividade de solicitações simultâneas tratadas por unidade de escala e minimizar os custos necessários para satisfazer a consulta.</span><span class="sxs-lookup"><span data-stu-id="0c269-224">Appropriate physical database design choices can significantly improve the latency for individual queries, improve the throughput of concurrent requests handled per scale unit, and minimize the costs required to satisfy the query.</span></span> <span data-ttu-id="0c269-225">Para obter mais informações sobre os DMVs de índice ausente, veja [sys.dm_db_missing_index_details](https://msdn.microsoft.com/library/ms345434.aspx).</span><span class="sxs-lookup"><span data-stu-id="0c269-225">For more information about the missing index DMVs, see [sys.dm_db_missing_index_details](https://msdn.microsoft.com/library/ms345434.aspx).</span></span>

### <a name="query-tuning-and-hinting"></a><span data-ttu-id="0c269-226">Ajuste e dicas de consulta</span><span class="sxs-lookup"><span data-stu-id="0c269-226">Query tuning and hinting</span></span>
<span data-ttu-id="0c269-227">O otimizador de consulta do Banco de Dados SQL do Azure é semelhante ao otimizador de consulta do SQL Server tradicional.</span><span class="sxs-lookup"><span data-stu-id="0c269-227">The query optimizer in Azure SQL Database is similar to the traditional SQL Server query optimizer.</span></span> <span data-ttu-id="0c269-228">A maioria das práticas recomendadas para o ajuste de consultas e a compreensão das limitações do modelo de raciocínio para o otimizador de consulta também se aplicam ao Banco de Dados SQL do Azure.</span><span class="sxs-lookup"><span data-stu-id="0c269-228">Most of the best practices for tuning queries and understanding the reasoning model limitations for the query optimizer also apply to Azure SQL Database.</span></span> <span data-ttu-id="0c269-229">Se ajustar consultas no Banco de Dados SQL, você poderá obter o benefício adicional de reduzir as demandas de recursos agregados.</span><span class="sxs-lookup"><span data-stu-id="0c269-229">If you tune queries in Azure SQL Database, you might get the additional benefit of reducing aggregate resource demands.</span></span> <span data-ttu-id="0c269-230">Seu aplicativo poderá ser executado com um custo menor do que um equivalente não ajustado, porque poderá ser executado em um nível de desempenho inferior.</span><span class="sxs-lookup"><span data-stu-id="0c269-230">Your application might be able to run at a lower cost than an untuned equivalent because it can run at a lower performance level.</span></span>

<span data-ttu-id="0c269-231">Um exemplo que é comum no SQL Server e que também se aplica ao Banco de Dados SQL do Azure é como o otimizador de consulta "detecta" parâmetros.</span><span class="sxs-lookup"><span data-stu-id="0c269-231">An example that is common in SQL Server and which also applies to Azure SQL Database is how the query optimizer "sniffs" parameters.</span></span> <span data-ttu-id="0c269-232">Durante a compilação, o otimizador de consulta avalia o valor atual de um parâmetro para determinar se ele pode gerar um plano de consulta melhor.</span><span class="sxs-lookup"><span data-stu-id="0c269-232">During compilation, the query optimizer evaluates the current value of a parameter to determine whether it can generate a more optimal query plan.</span></span> <span data-ttu-id="0c269-233">Embora muitas vezes essa estratégia possa levar a um plano de consulta significativamente mais rápido do que um plano compilado sem valores de parâmetro conhecidos, atualmente ele a funciona de modo imperfeito SQL Server e no Banco de Dados SQL do Azure.</span><span class="sxs-lookup"><span data-stu-id="0c269-233">Although this strategy often can lead to a query plan that is significantly faster than a plan compiled without known parameter values, currently it works imperfectly both in SQL Server and in Azure SQL Database.</span></span> <span data-ttu-id="0c269-234">Algumas vezes, o parâmetro não é detectado, e algumas vezes é detectado mas o plano gerado está abaixo do ideal para o conjunto completo de valores de parâmetro em uma carga de trabalho.</span><span class="sxs-lookup"><span data-stu-id="0c269-234">Sometimes the parameter is not sniffed, and sometimes the parameter is sniffed but the generated plan is suboptimal for the full set of parameter values in a workload.</span></span> <span data-ttu-id="0c269-235">A Microsoft inclui dicas (diretivas) de consulta para que você possa especificar a intenção mais deliberadamente e substituir o comportamento padrão da detecção de parâmetro.</span><span class="sxs-lookup"><span data-stu-id="0c269-235">Microsoft includes query hints (directives) so that you can specify intent more deliberately and override the default behavior of parameter sniffing.</span></span> <span data-ttu-id="0c269-236">Frequentemente, usando as dicas você consegue corrigir casos em que o comportamento padrão do Banco de Dados SQL do Azure ou do SQL Server é imperfeito para uma carga de trabalho específica do cliente.</span><span class="sxs-lookup"><span data-stu-id="0c269-236">Often, if you use hints, you can fix cases in which the default SQL Server or Azure SQL Database behavior is imperfect for a specific customer workload.</span></span>

<span data-ttu-id="0c269-237">O exemplo a seguir demonstra como o processador de consultas pode gerar um plano que está abaixo do ideal para os requisitos de desempenho e recursos.</span><span class="sxs-lookup"><span data-stu-id="0c269-237">The next example demonstrates how the query processor can generate a plan that is suboptimal both for performance and resource requirements.</span></span> <span data-ttu-id="0c269-238">Este exemplo também mostra que, se usar uma dica de consulta, você poderá reduzir requisitos de recursos e tempo de execução da consulta para o banco de dados SQL:</span><span class="sxs-lookup"><span data-stu-id="0c269-238">This example also shows that if you use a query hint, you can reduce query run time and resource requirements for your SQL database:</span></span>

    DROP TABLE psptest1;
    CREATE TABLE psptest1(col1 int primary key identity, col2 int, col3 binary(200));

    DECLARE @a int = 0;
    SET NOCOUNT ON;
    BEGIN TRANSACTION
    WHILE @a < 20000
    BEGIN
        INSERT INTO psptest1(col2) values (1);
        INSERT INTO psptest1(col2) values (@a);
        SET @a += 1;
    END
    COMMIT TRANSACTION
    CREATE INDEX i1 on psptest1(col2);
    GO

    CREATE PROCEDURE psp1 (@param1 int)
    AS
    BEGIN
        INSERT INTO t1 SELECT * FROM psptest1
        WHERE col2 = @param1
        ORDER BY col2;
    END
    GO

    CREATE PROCEDURE psp2 (@param2 int)
    AS
    BEGIN
        INSERT INTO t1 SELECT * FROM psptest1 WHERE col2 = @param2
        ORDER BY col2
        OPTION (OPTIMIZE FOR (@param2 UNKNOWN))
    END
    GO

    CREATE TABLE t1 (col1 int primary key, col2 int, col3 binary(200));
    GO

<span data-ttu-id="0c269-239">O código de configuração cria uma tabela que contém a distribuição de dados distorcida.</span><span class="sxs-lookup"><span data-stu-id="0c269-239">The setup code creates a table that has skewed data distribution.</span></span> <span data-ttu-id="0c269-240">O plano de consulta ideal varia dependendo do parâmetro selecionado.</span><span class="sxs-lookup"><span data-stu-id="0c269-240">The optimal query plan differs based on which parameter is selected.</span></span> <span data-ttu-id="0c269-241">Infelizmente, o comportamento do cache de plano nem sempre recompila a consulta com base no valor do parâmetro mais comum.</span><span class="sxs-lookup"><span data-stu-id="0c269-241">Unfortunately, the plan caching behavior doesn't always recompile the query based on the most common parameter value.</span></span> <span data-ttu-id="0c269-242">Portanto, é possível que um plano de qualidade inferior seja armazenado em cache e usado para vários valores, mesmo quando um plano diferente poderia ser uma opção melhor de modo geral.</span><span class="sxs-lookup"><span data-stu-id="0c269-242">So, it's possible for a suboptimal plan to be cached and used for many values, even when a different plan might be a better plan choice on average.</span></span> <span data-ttu-id="0c269-243">Em seguida, o plano de consulta cria dois procedimentos armazenados idênticos, com exceção de um que tem uma dica de consulta especial.</span><span class="sxs-lookup"><span data-stu-id="0c269-243">Then the query plan creates two stored procedures that are identical, except that one has a special query hint.</span></span>

<span data-ttu-id="0c269-244">**Exemplo, parte 1**</span><span class="sxs-lookup"><span data-stu-id="0c269-244">**Example, part 1**</span></span>

    -- Prime Procedure Cache with scan plan
    EXEC psp1 @param1=1;
    TRUNCATE TABLE t1;

    -- Iterate multiple times to show the performance difference
    DECLARE @i int = 0;
    WHILE @i < 1000
    BEGIN
        EXEC psp1 @param1=2;
        TRUNCATE TABLE t1;
        SET @i += 1;
    END

<span data-ttu-id="0c269-245">**Exemplo, parte 2**</span><span class="sxs-lookup"><span data-stu-id="0c269-245">**Example, part 2**</span></span>

<span data-ttu-id="0c269-246">(Recomendamos que você espere pelo menos 10 minutos antes de começar a parte 2 do exemplo, para que os resultados sejam diferentes nos dados de telemetria resultantes).</span><span class="sxs-lookup"><span data-stu-id="0c269-246">(We recommend that you wait at least 10 minutes before you begin part 2 of the example, so that the results are distinct in the resulting telemetry data.)</span></span>

    EXEC psp2 @param2=1;
    TRUNCATE TABLE t1;

    DECLARE @i int = 0;
    WHILE @i < 1000
    BEGIN
        EXEC psp2 @param2=2;
        TRUNCATE TABLE t1;
        SET @i += 1;
    END

<span data-ttu-id="0c269-247">Cada parte deste exemplo tenta executar uma instrução insert com parâmetros 1.000 vezes (para gerar uma carga suficiente para usar como um conjunto de dados de teste).</span><span class="sxs-lookup"><span data-stu-id="0c269-247">Each part of this example attempts to run a parameterized insert statement 1,000 times (to generate a sufficient load to use as a test data set).</span></span> <span data-ttu-id="0c269-248">Ao executar procedimentos armazenados, o processador de consultas examina o valor do parâmetro passado ao procedimento durante a primeira compilação ("detecção" de parâmetros).</span><span class="sxs-lookup"><span data-stu-id="0c269-248">When it executes stored procedures, the query processor examines the parameter value that is passed to the procedure during its first compilation (parameter "sniffing").</span></span> <span data-ttu-id="0c269-249">O processador armazena em cache o plano resultante e o usa para invocações posteriores, mesmo que o valor do parâmetro seja diferente.</span><span class="sxs-lookup"><span data-stu-id="0c269-249">The processor caches the resulting plan and uses it for later invocations, even if the parameter value is different.</span></span> <span data-ttu-id="0c269-250">É possível que o plano ideal não seja usado em todos os casos.</span><span class="sxs-lookup"><span data-stu-id="0c269-250">The optimal plan might not be used in all cases.</span></span> <span data-ttu-id="0c269-251">Às vezes, você precisa orientar o otimizador a escolher um plano que seja melhor para o caso médio em vez do caso específico de quando a consulta foi compilada pela primeira vez.</span><span class="sxs-lookup"><span data-stu-id="0c269-251">Sometimes you need to guide the optimizer to pick a plan that is better for the average case rather than the specific case from when the query was first compiled.</span></span> <span data-ttu-id="0c269-252">Neste exemplo, o plano inicial gera um plano de "verificação" que lê todas as linhas para localizar cada valor que corresponda ao parâmetro:</span><span class="sxs-lookup"><span data-stu-id="0c269-252">In this example, the initial plan generates a "scan" plan that reads all rows to find each value that matches the parameter:</span></span>

![Ajuste de consulta usando um plano de verificação](./media/sql-database-performance-guidance/query_tuning_1.png)

<span data-ttu-id="0c269-254">Como executamos o procedimento usando o valor 1, o plano resultante era ideal para o valor 1, mas de qualidade inferior para todos os outros valores da tabela.</span><span class="sxs-lookup"><span data-stu-id="0c269-254">Because we executed the procedure by using the value 1, the resulting plan was optimal for the value 1 but was suboptimal for all other values in the table.</span></span> <span data-ttu-id="0c269-255">O resultado provavelmente não é o que você desejaria se fosse escolher cada plano aleatoriamente, porque o plano é mais lento e usa mais recursos.</span><span class="sxs-lookup"><span data-stu-id="0c269-255">The result likely isn't what you would want if you were to pick each plan randomly, because the plan performs more slowly and uses more resources.</span></span>

<span data-ttu-id="0c269-256">Se você executar o teste com `SET STATISTICS IO` definido como `ON`, o trabalho de verificação lógica neste exemplo será feito em segundo plano.</span><span class="sxs-lookup"><span data-stu-id="0c269-256">If you run the test with `SET STATISTICS IO` set to `ON`, the logical scan work in this example is done behind the scenes.</span></span> <span data-ttu-id="0c269-257">Você pode ver que há 1.148 leituras feitas pelo plano (o que não será eficiente, se o caso médio retornar apenas uma linha):</span><span class="sxs-lookup"><span data-stu-id="0c269-257">You can see that there are 1,148 reads done by the plan (which is inefficient, if the average case is to return just one row):</span></span>

![Ajuste de consulta usando uma verificação lógica](./media/sql-database-performance-guidance/query_tuning_2.png)

<span data-ttu-id="0c269-259">A segunda parte do exemplo usa uma dica de consulta para dizer ao otimizador para usar um valor específico durante o processo de compilação.</span><span class="sxs-lookup"><span data-stu-id="0c269-259">The second part of the example uses a query hint to tell the optimizer to use a specific value during the compilation process.</span></span> <span data-ttu-id="0c269-260">Nesse caso, ele força o processador de consulta a ignorar o valor que é passado como parâmetro, e em vez disso pressupõe `UNKNOWN`.</span><span class="sxs-lookup"><span data-stu-id="0c269-260">In this case, it forces the query processor to ignore the value that is passed as the parameter, and instead to assume `UNKNOWN`.</span></span> <span data-ttu-id="0c269-261">Isso se refere a um valor que tem a frequência média na tabela (ignorando a distorção).</span><span class="sxs-lookup"><span data-stu-id="0c269-261">This refers to a value that has the average frequency in the table (ignoring skew).</span></span> <span data-ttu-id="0c269-262">O plano resultante é um plano baseado em busca que é mais rápido e usa menos recursos, em média, do que o plano da parte 1 do exemplo:</span><span class="sxs-lookup"><span data-stu-id="0c269-262">The resulting plan is a seek-based plan that is faster and uses fewer resources, on average, than the plan in part 1 of this example:</span></span>

![Ajuste de consulta usando uma dica de consulta](./media/sql-database-performance-guidance/query_tuning_3.png)

<span data-ttu-id="0c269-264">Você pode ver o efeito na tabela **sys.resource_stats** (há um atraso entre o momento em que você executa o teste e quando os dados populam a tabela).</span><span class="sxs-lookup"><span data-stu-id="0c269-264">You can see the effect in the **sys.resource_stats** table (there is a delay from the time that you execute the test and when the data populates the table).</span></span> <span data-ttu-id="0c269-265">Para este exemplo, a parte 1 foi executada durante a janela de tempo 22:25:00 e a parte 2 foi executada em 22:35:00.</span><span class="sxs-lookup"><span data-stu-id="0c269-265">For this example, part 1 executed during the 22:25:00 time window, and part 2 executed at 22:35:00.</span></span> <span data-ttu-id="0c269-266">A janela de tempo anterior usou mais recursos do que a mais recente (devido a melhorias na eficiência do plano).</span><span class="sxs-lookup"><span data-stu-id="0c269-266">The earlier time window used more resources in that time window than the later one (because of plan efficiency improvements).</span></span>

    SELECT TOP 1000 *
    FROM sys.resource_stats
    WHERE database_name = 'resource1'
    ORDER BY start_time DESC

![Exemplos de resultados de ajustes de consulta](./media/sql-database-performance-guidance/query_tuning_4.png)

> [!NOTE]
> <span data-ttu-id="0c269-268">Embora o volume neste exemplo seja propositalmente pequeno, o efeito de parâmetros de qualidade inferior pode ser significativo, especialmente em bancos de dados maiores.</span><span class="sxs-lookup"><span data-stu-id="0c269-268">Although the volume in this example is intentionally small, the effect of suboptimal parameters can be substantial, especially on larger databases.</span></span> <span data-ttu-id="0c269-269">A diferença, em casos extremos, pode ficar entre segundos, para casos rápidos, e horas, para casos lentos.</span><span class="sxs-lookup"><span data-stu-id="0c269-269">The difference, in extreme cases, can be between seconds for fast cases and hours for slow cases.</span></span>
> 
> 

<span data-ttu-id="0c269-270">Você pode examinar **sys.resource_stats** para determinar se o recurso para um teste usa mais ou menos recursos do que outro teste.</span><span class="sxs-lookup"><span data-stu-id="0c269-270">You can examine **sys.resource_stats** to determine whether the resource for a test uses more or fewer resources than another test.</span></span> <span data-ttu-id="0c269-271">Ao comparar dados, separe os testes por tempo de modo que eles não fiquem na mesma janela de tempo de 5 minutos na exibição **sys.resource_stats**.</span><span class="sxs-lookup"><span data-stu-id="0c269-271">When you compare data, separate the timing of tests so that they are not in the same 5-minute window in the **sys.resource_stats** view.</span></span> <span data-ttu-id="0c269-272">O objetivo deste exercício é minimizar a quantidade total de recursos usados, não minimizar os recursos de pico.</span><span class="sxs-lookup"><span data-stu-id="0c269-272">The goal of the exercise is to minimize the total amount of resources used, and not to minimize the peak resources.</span></span> <span data-ttu-id="0c269-273">Em geral, a otimização de uma parte do código de latência também reduz o consumo de recursos.</span><span class="sxs-lookup"><span data-stu-id="0c269-273">Generally, optimizing a piece of code for latency also reduces resource consumption.</span></span> <span data-ttu-id="0c269-274">Certifique-se de que as alterações feitas em um aplicativo sejam necessárias e de que elas não afetem negativamente a experiência do cliente para alguém que possa estar usando dicas de consulta no aplicativo.</span><span class="sxs-lookup"><span data-stu-id="0c269-274">Make sure that the changes you make to an application are necessary, and that the changes don't negatively affect the customer experience for someone who might be using query hints in the application.</span></span>

<span data-ttu-id="0c269-275">Se uma carga de trabalho tem um conjunto de consultas repetidas, normalmente faz sentido capturar e validar a natureza ideal dessas opções de plano, pois ela orienta a unidade de tamanho mínima de recursos necessária para hospedar o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="0c269-275">If a workload has a set of repeating queries, often it makes sense to capture and validate the optimality of your plan choices because it drives the minimum resource size unit required to host the database.</span></span> <span data-ttu-id="0c269-276">Depois de validar, volte a examinar os planos periodicamente para ter certeza de que eles não degradaram.</span><span class="sxs-lookup"><span data-stu-id="0c269-276">After you validate it, occasionally reexamine the plans to help you make sure that they have not degraded.</span></span> <span data-ttu-id="0c269-277">Saiba mais sobre [dicas de consulta (Transact-SQL)](https://msdn.microsoft.com/library/ms181714.aspx).</span><span class="sxs-lookup"><span data-stu-id="0c269-277">You can learn more about [query hints (Transact-SQL)](https://msdn.microsoft.com/library/ms181714.aspx).</span></span>

### <a name="cross-database-sharding"></a><span data-ttu-id="0c269-278">Fragmentação entre bancos de dados</span><span class="sxs-lookup"><span data-stu-id="0c269-278">Cross-database sharding</span></span>
<span data-ttu-id="0c269-279">Como o Banco de Dados SQL do Azure é executado no hardware de mercadoria, há limites inferiores de capacidade para um banco de dados individual em relação a uma instalação do SQL Server local tradicional.</span><span class="sxs-lookup"><span data-stu-id="0c269-279">Because Azure SQL Database runs on commodity hardware, the capacity limits for a single database are lower than for a traditional on-premises SQL Server installation.</span></span> <span data-ttu-id="0c269-280">Alguns clientes usam técnicas de fragmentação para distribuir operações de banco de dados por vários bancos de dados quando elas não se ajustarem aos limites de um banco de dados individual no Banco de Dados SQL do Azure.</span><span class="sxs-lookup"><span data-stu-id="0c269-280">Some customers use sharding techniques to spread database operations over multiple databases when the operations don't fit inside the limits of a single database in Azure SQL Database.</span></span> <span data-ttu-id="0c269-281">A maioria dos clientes que usam técnicas de fragmentação no Banco de Dados SQL do Azure divide seus dados em uma única dimensão entre vários bancos de dados.</span><span class="sxs-lookup"><span data-stu-id="0c269-281">Most customers who use sharding techniques in Azure SQL Database split their data on a single dimension across multiple databases.</span></span> <span data-ttu-id="0c269-282">Para esta abordagem, você precisa compreender que aplicativos OLTP executam com frequência transações que se aplicam somente a uma linha ou a um pequeno grupo de linhas no esquema.</span><span class="sxs-lookup"><span data-stu-id="0c269-282">For this approach, you need to understand that OLTP applications often perform transactions that apply to only one row or to a small group of rows in the schema.</span></span>

> [!NOTE]
> <span data-ttu-id="0c269-283">Agora, o Banco de Dados SQL fornece uma biblioteca para auxiliar com a fragmentação.</span><span class="sxs-lookup"><span data-stu-id="0c269-283">SQL Database now provides a library to assist with sharding.</span></span> <span data-ttu-id="0c269-284">Para saber mais, confira [Visão geral da biblioteca de cliente de Banco de Dados Elástico](sql-database-elastic-database-client-library.md).</span><span class="sxs-lookup"><span data-stu-id="0c269-284">For more information, see [Elastic Database client library overview](sql-database-elastic-database-client-library.md).</span></span>
> 
> 

<span data-ttu-id="0c269-285">Por exemplo, se um banco de dados contiver o nome do cliente, o pedido e os detalhes do pedido (como o exemplo tradicional da Northwind fornecido no SQL Server), você poderá dividir esses dados em vários bancos de dados agrupando um cliente com o pedido relacionado e as informações de detalhes do pedido.</span><span class="sxs-lookup"><span data-stu-id="0c269-285">For example, if a database has customer name, order, and order details (like the traditional example Northwind database that ships with SQL Server), you could split this data into multiple databases by grouping a customer with the related order and order detail information.</span></span> <span data-ttu-id="0c269-286">Você pode garantir que os dados do cliente permaneçam em um banco de dados individual.</span><span class="sxs-lookup"><span data-stu-id="0c269-286">You can guarantee that the customer's data stays in a single database.</span></span> <span data-ttu-id="0c269-287">O aplicativo dividiria clientes diferentes entre os bancos de dados, distribuindo efetivamente a carga entre vários bancos de dados.</span><span class="sxs-lookup"><span data-stu-id="0c269-287">The application would split different customers across databases, effectively spreading the load across multiple databases.</span></span> <span data-ttu-id="0c269-288">Com a fragmentação, não apenas os clientes podem evitar o limite de tamanho máximo do banco de dados, mas o Banco de Dados SQL do Azure também pode processar cargas de trabalho significativamente maiores do que os limites dos diferentes níveis de desempenho, desde que cada banco de dados individual se ajuste à sua DTU.</span><span class="sxs-lookup"><span data-stu-id="0c269-288">With sharding, customers not only can avoid the maximum database size limit, but Azure SQL Database also can process workloads that are significantly larger than the limits of the different performance levels, as long as each individual database fits into its DTU.</span></span>

<span data-ttu-id="0c269-289">Embora a fragmentação do banco de dados não reduza a capacidade agregada de recursos de uma solução, ela é altamente eficaz para dar suporte a soluções muito grandes que são distribuídas em vários bancos de dados.</span><span class="sxs-lookup"><span data-stu-id="0c269-289">Although database sharding doesn't reduce the aggregate resource capacity for a solution, it's highly effective at supporting very large solutions that are spread over multiple databases.</span></span> <span data-ttu-id="0c269-290">Cada banco de dados pode ser executado em um nível de desempenho diferente para dar suporte a bancos de dados "efetivos" muito grandes, com altos requisitos de recursos.</span><span class="sxs-lookup"><span data-stu-id="0c269-290">Each database can run at a different performance level to support very large, "effective" databases with high resource requirements.</span></span>

### <a name="functional-partitioning"></a><span data-ttu-id="0c269-291">Particionamento funcional</span><span class="sxs-lookup"><span data-stu-id="0c269-291">Functional partitioning</span></span>
<span data-ttu-id="0c269-292">Com frequência, os usuários do SQL Server combinam muitas funções um banco de dados individual.</span><span class="sxs-lookup"><span data-stu-id="0c269-292">SQL Server users often combine many functions in a single database.</span></span> <span data-ttu-id="0c269-293">Por exemplo, se um aplicativo tiver lógica para gerenciar o inventário de uma loja, esse banco de dados poderá ter lógica associada ao controle de inventário, acompanhamento de ordens de compra, procedimentos armazenados e exibições indexadas/materializadas que gerenciam os relatórios de final de mês.</span><span class="sxs-lookup"><span data-stu-id="0c269-293">For example, if an application has logic to manage inventory for a store, that database might have logic associated with inventory, tracking purchase orders, stored procedures, and indexed or materialized views that manage end-of-month reporting.</span></span> <span data-ttu-id="0c269-294">Essa técnica facilita a administração do banco de dados para operações como backup, mas também requer que você dimensione o hardware para lidar com a carga de pico em todas as funções de um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="0c269-294">This technique makes it easier to administer the database for operations like backup, but it also requires you to size the hardware to handle the peak load across all functions of an application.</span></span>

<span data-ttu-id="0c269-295">Se você usar uma arquitetura de escala horizontal no Banco de Dados SQL do Azure, será útil dividir funções diferentes de um aplicativo em bancos de dados diferentes.</span><span class="sxs-lookup"><span data-stu-id="0c269-295">If you use a scale-out architecture in Azure SQL Database, it's a good idea to split different functions of an application into different databases.</span></span> <span data-ttu-id="0c269-296">Usando essa técnica, cada aplicativo é dimensionado de forma independente.</span><span class="sxs-lookup"><span data-stu-id="0c269-296">By using this technique, each application scales independently.</span></span> <span data-ttu-id="0c269-297">À medida que um aplicativo se torna mais ocupado (e a carga no banco de dados aumenta), o administrador pode escolher níveis de desempenho independentes para cada função do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="0c269-297">As an application becomes busier (and the load on the database increases), the administrator can choose independent performance levels for each function in the application.</span></span> <span data-ttu-id="0c269-298">No limite, com essa arquitetura, um aplicativo pode ficar maior do que a capacidade de um único computador de mercadoria porque a carga está distribuída por várias máquinas.</span><span class="sxs-lookup"><span data-stu-id="0c269-298">At the limit, with this architecture, an application can be larger than a single commodity machine can handle because the load is spread across multiple machines.</span></span>

### <a name="batch-queries"></a><span data-ttu-id="0c269-299">Consultas em lote</span><span class="sxs-lookup"><span data-stu-id="0c269-299">Batch queries</span></span>
<span data-ttu-id="0c269-300">Para aplicativos que acessam dados usando consultas ad-hoc frequentes de alto volume, uma grande parte do tempo de resposta é gasto na comunicação de rede entre a camada do aplicativo e a camada do Banco de Dados SQL.</span><span class="sxs-lookup"><span data-stu-id="0c269-300">For applications that access data by using high-volume, frequent, ad hoc querying, a substantial amount of response time is spent on network communication between the application tier and the Azure SQL Database tier.</span></span> <span data-ttu-id="0c269-301">Mesmo quando o aplicativo e o Banco de Dados SQL do Azure estiverem no mesmo datacenter, a latência de rede entre os dois poderá ser aumentada por um grande número de operações de acesso a dados.</span><span class="sxs-lookup"><span data-stu-id="0c269-301">Even when both the application and Azure SQL Database are in the same data center, the network latency between the two might be magnified by a large number of data access operations.</span></span> <span data-ttu-id="0c269-302">Para reduzir as viagens de ida e volta da rede para as operações de acesso a dados, considere usar a opção de processar as consultas ad hoc em lote ou compilá-las como procedimentos armazenados.</span><span class="sxs-lookup"><span data-stu-id="0c269-302">To reduce the network round trips for the data access operations, consider using the option to either batch the ad hoc queries, or to compile them as stored procedures.</span></span> <span data-ttu-id="0c269-303">Se processar as consultas ad hoc, você poderá enviar várias consultas como um lote grande em uma única viagem ao Banco de Dados SQL do Azure.</span><span class="sxs-lookup"><span data-stu-id="0c269-303">If you batch the ad hoc queries, you can send multiple queries as one large batch in a single trip to Azure SQL Database.</span></span> <span data-ttu-id="0c269-304">Se compilar consultas ad hoc em um procedimento armazenado, você poderá alcançar o mesmo resultado que teria processando-as em lote.</span><span class="sxs-lookup"><span data-stu-id="0c269-304">If you compile ad hoc queries in a stored procedure, you could achieve the same result as if you batch them.</span></span> <span data-ttu-id="0c269-305">O uso de um procedimento armazenado também oferece o benefício de aumentar as chances de armazenar em cache os planos de consulta no Banco de Dados SQL do Azure para usar o procedimento armazenado novamente.</span><span class="sxs-lookup"><span data-stu-id="0c269-305">Using a stored procedure also gives you the benefit of increasing the chances of caching the query plans in Azure SQL Database so you can use the stored procedure again.</span></span>

<span data-ttu-id="0c269-306">Alguns aplicativos apresentam gravação intensa.</span><span class="sxs-lookup"><span data-stu-id="0c269-306">Some applications are write-intensive.</span></span> <span data-ttu-id="0c269-307">Às vezes, você pode reduzir a carga de E/S total em um banco de dados considerando como fazer as gravações em lote.</span><span class="sxs-lookup"><span data-stu-id="0c269-307">Sometimes you can reduce the total I/O load on a database by considering how to batch writes together.</span></span> <span data-ttu-id="0c269-308">Frequentemente, isso é tão simples quanto usar transações explícitas em vez de transações de confirmação automática em procedimentos armazenados e lotes ad hoc.</span><span class="sxs-lookup"><span data-stu-id="0c269-308">Often, this is as simple as using explicit transactions instead of auto-commit transactions in stored procedures and ad hoc batches.</span></span> <span data-ttu-id="0c269-309">Para ver uma avaliação das diferentes técnicas que você pode usar, consulte [Técnicas de envio em lote para aplicativos do Banco de Dados SQL no Azure](https://msdn.microsoft.com/library/windowsazure/dn132615.aspx).</span><span class="sxs-lookup"><span data-stu-id="0c269-309">For an evaluation of different techniques you can use, see [Batching techniques for SQL Database applications in Azure](https://msdn.microsoft.com/library/windowsazure/dn132615.aspx).</span></span> <span data-ttu-id="0c269-310">Teste sua própria carga de trabalho para encontrar o modelo certo para envio em lote.</span><span class="sxs-lookup"><span data-stu-id="0c269-310">Experiment with your own workload to find the right model for batching.</span></span> <span data-ttu-id="0c269-311">Tenha em mente que um modelo pode ter garantias de consistência transacional ligeiramente diferentes.</span><span class="sxs-lookup"><span data-stu-id="0c269-311">Be sure to understand that a model might have slightly different transactional consistency guarantees.</span></span> <span data-ttu-id="0c269-312">Para encontrar a carga de trabalho certa que minimiza o uso de recursos, é necessário encontrar a combinação certa de compensações de consistência e de desempenho.</span><span class="sxs-lookup"><span data-stu-id="0c269-312">Finding the right workload that minimizes resource use requires finding the right combination of consistency and performance trade-offs.</span></span>

### <a name="application-tier-caching"></a><span data-ttu-id="0c269-313">Cache de camada de aplicativo</span><span class="sxs-lookup"><span data-stu-id="0c269-313">Application-tier caching</span></span>
<span data-ttu-id="0c269-314">Alguns aplicativos de banco de dados têm cargas de trabalho de leitura pesada.</span><span class="sxs-lookup"><span data-stu-id="0c269-314">Some database applications have read-heavy workloads.</span></span> <span data-ttu-id="0c269-315">Camadas de cache podem reduzir a carga no banco de dados e, potencialmente, reduzir o nível de desempenho necessário para dar suporte a um banco de dados usando o Banco de Dados SQL do Azure.</span><span class="sxs-lookup"><span data-stu-id="0c269-315">Caching layers might reduce the load on the database and might potentially reduce the performance level required to support a database by using Azure SQL Database.</span></span> <span data-ttu-id="0c269-316">Com o [Cache Redis do Azure](https://azure.microsoft.com/services/cache/), se tiver uma carga de trabalho de leitura pesada, você poderá ler os dados de uma vez (ou talvez uma vez por computador da camada de aplicativo, dependendo de como estiver configurado) e armazenar esses dados fora do banco de dados SQL.</span><span class="sxs-lookup"><span data-stu-id="0c269-316">With [Azure Redis Cache](https://azure.microsoft.com/services/cache/), if you have a read-heavy workload, you can read the data once (or perhaps once per application-tier machine, depending on how it is configured), and then store that data outside your SQL database.</span></span> <span data-ttu-id="0c269-317">Esta é uma forma de reduzir a carga do banco de dados (CPU e E/S de leitura), mas há um impacto na consistência transacional, porque os dados lidos do cache podem estar fora de sincronia com os dados no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="0c269-317">This is a way to reduce database load (CPU and read I/O), but there is an effect on transactional consistency because the data being read from the cache might be out of sync with the data in the database.</span></span> <span data-ttu-id="0c269-318">Embora em muitos aplicativos algum nível de inconsistência seja aceitável, isso não vale para todas as cargas de trabalho.</span><span class="sxs-lookup"><span data-stu-id="0c269-318">Although in many applications some level of inconsistency is acceptable, that's not true for all workloads.</span></span> <span data-ttu-id="0c269-319">É necessário compreender totalmente todos os requisitos do aplicativo antes de implementar uma estratégia de cache da camada do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="0c269-319">You should fully understand any application requirements before you implement an application-tier caching strategy.</span></span>

## <a name="next-steps"></a><span data-ttu-id="0c269-320">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="0c269-320">Next steps</span></span>
* <span data-ttu-id="0c269-321">Para obter mais informações sobre as camadas de serviço, consulte [Opções e desempenho de Banco de Dados SQL](sql-database-service-tiers.md)</span><span class="sxs-lookup"><span data-stu-id="0c269-321">For more information about service tiers, see [SQL Database options and performance](sql-database-service-tiers.md)</span></span>
* <span data-ttu-id="0c269-322">Para saber mais sobre pools elásticos, consulte [O que é um pool elástico do Azure?](sql-database-elastic-pool.md)</span><span class="sxs-lookup"><span data-stu-id="0c269-322">For more information about elastic pools, see [What is an Azure elastic pool?](sql-database-elastic-pool.md)</span></span>
* <span data-ttu-id="0c269-323">Para obter informações sobre desempenho e pools elásticos, consulte [Quando considerar um pool elástico](sql-database-elastic-pool-guidance.md)</span><span class="sxs-lookup"><span data-stu-id="0c269-323">For information about performance and elastic pools, see [When to consider an elastic pool](sql-database-elastic-pool-guidance.md)</span></span>

