---
title: aaaCopy um banco de dados SQL do Azure | Microsoft Docs
description: "Criar uma cópia de um Banco de Dados SQL do Azure"
services: sql-database
documentationcenter: 
author: CarlRabeler
manager: jhubbard
editor: 
ms.assetid: 5aaf6bcd-3839-49b5-8c77-cbdf786e359b
ms.service: sql-database
ms.custom: load & move data
ms.devlang: NA
ms.date: 06/15/2017
ms.author: carlrab
ms.workload: data-management
ms.topic: article
ms.tgt_pltfrm: NA
ms.openlocfilehash: 64a297d819d6da89600fda60abe8394ae405abfe
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="copy-an-azure-sql-database"></a><span data-ttu-id="1cc87-103">Copiar um Banco de Dados SQL do Azure</span><span class="sxs-lookup"><span data-stu-id="1cc87-103">Copy an Azure SQL database</span></span>

<span data-ttu-id="1cc87-104">Banco de dados SQL do Azure fornece vários métodos para criar uma cópia transacionalmente consistente de um SQL Azure existentes do banco de dados em qualquer Olá mesmo servidor ou em um servidor diferente.</span><span class="sxs-lookup"><span data-stu-id="1cc87-104">Azure SQL Database provides several methods for creating a transactionally consistent copy of an existing Azure SQL database on either hello same server or a different server.</span></span> <span data-ttu-id="1cc87-105">Você pode copiar um banco de dados SQL usando o T-SQL, PowerShell ou Olá portal do Azure.</span><span class="sxs-lookup"><span data-stu-id="1cc87-105">You can copy a SQL database by using hello Azure portal, PowerShell, or T-SQL.</span></span> 

## <a name="overview"></a><span data-ttu-id="1cc87-106">Visão geral</span><span class="sxs-lookup"><span data-stu-id="1cc87-106">Overview</span></span>

<span data-ttu-id="1cc87-107">Uma cópia do banco de dados é um instantâneo do banco de dados de origem de hello a partir de tempo de saudação da solicitação de cópia de saudação.</span><span class="sxs-lookup"><span data-stu-id="1cc87-107">A database copy is a snapshot of hello source database as of hello time of hello copy request.</span></span> <span data-ttu-id="1cc87-108">Você pode selecionar Olá mesmo servidor ou um servidor diferente, seu nível de desempenho e da camada de serviço ou um nível de desempenho diferentes dentro de saudação mesma camada de serviço (edição).</span><span class="sxs-lookup"><span data-stu-id="1cc87-108">You can select hello same server or a different server, its service tier and performance level, or a different performance level within hello same service tier (edition).</span></span> <span data-ttu-id="1cc87-109">Após a conclusão da cópia hello, ele se torna um banco de dados totalmente funcional e independente.</span><span class="sxs-lookup"><span data-stu-id="1cc87-109">After hello copy is complete, it becomes a fully functional, independent database.</span></span> <span data-ttu-id="1cc87-110">Neste ponto, você pode atualizar ou fazer downgrade tooany edition.</span><span class="sxs-lookup"><span data-stu-id="1cc87-110">At this point, you can upgrade or downgrade it tooany edition.</span></span> <span data-ttu-id="1cc87-111">permissões, usuários e logons Olá podem ser gerenciadas independentemente.</span><span class="sxs-lookup"><span data-stu-id="1cc87-111">hello logins, users, and permissions can be managed independently.</span></span>  

## <a name="logins-in-hello-database-copy"></a><span data-ttu-id="1cc87-112">Logons na cópia do banco de dados de saudação</span><span class="sxs-lookup"><span data-stu-id="1cc87-112">Logins in hello database copy</span></span>

<span data-ttu-id="1cc87-113">Quando você copia um banco de dados toohello mesmo servidor lógico, Olá mesmos logons podem ser usados em ambos os bancos de dados.</span><span class="sxs-lookup"><span data-stu-id="1cc87-113">When you copy a database toohello same logical server, hello same logins can be used on both databases.</span></span> <span data-ttu-id="1cc87-114">segurança de Olá principal de que usar o banco de dados do toocopy Olá se torna o proprietário do banco de dados de saudação no novo banco de dados de saudação.</span><span class="sxs-lookup"><span data-stu-id="1cc87-114">hello security principal you use toocopy hello database becomes hello database owner on hello new database.</span></span> <span data-ttu-id="1cc87-115">Todos os usuários de banco de dados, suas permissões e a segurança de SIDs (identificadores) são copiados toohello cópia de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="1cc87-115">All database users, their permissions, and their security identifiers (SIDs) are copied toohello database copy.</span></span>  

<span data-ttu-id="1cc87-116">Quando você copia um servidor de lógico diferente do tooa banco de dados, segurança de Olá principal no novo servidor de saudação torna-se o proprietário do banco de dados de saudação no novo banco de dados de saudação.</span><span class="sxs-lookup"><span data-stu-id="1cc87-116">When you copy a database tooa different logical server, hello security principal on hello new server becomes hello database owner on hello new database.</span></span> <span data-ttu-id="1cc87-117">Se você usar [usuários de banco de dados independente](sql-database-manage-logins.md) para acesso a dados, verifique se ambos Olá primário e bancos de dados secundários sempre têm Olá mesmas credenciais de usuário, para que após a cópia de saudação concluir você podem acessar imediatamente com hello mesmo credenciais.</span><span class="sxs-lookup"><span data-stu-id="1cc87-117">If you use [contained database users](sql-database-manage-logins.md) for data access, ensure that both hello primary and secondary databases always have hello same user credentials, so that after hello copy is complete you can immediately access it with hello same credentials.</span></span> 

<span data-ttu-id="1cc87-118">Se você usar [Active Directory do Azure](../active-directory/active-directory-whatis.md), você pode eliminar completamente a necessidade de Olá para gerenciamento de credenciais na cópia de saudação.</span><span class="sxs-lookup"><span data-stu-id="1cc87-118">If you use [Azure Active Directory](../active-directory/active-directory-whatis.md), you can completely eliminate hello need for managing credentials in hello copy.</span></span> <span data-ttu-id="1cc87-119">No entanto, quando você copiar o novo servidor de saudação banco de dados tooa, acesso baseado em logon de saudação pode não funcionar, porque não existem logons de Olá no novo servidor de saudação.</span><span class="sxs-lookup"><span data-stu-id="1cc87-119">However, when you copy hello database tooa new server, hello login-based access might not work, because hello logins do not exist on hello new server.</span></span> <span data-ttu-id="1cc87-120">toolearn sobre como gerenciar logons quando você copiar um banco de dados tooa servidor lógico diferente, consulte [como toomanage SQL Azure segurança banco de dados após a recuperação de desastres](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="1cc87-120">toolearn about managing logins when you copy a database tooa different logical server, see [How toomanage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span> 

<span data-ttu-id="1cc87-121">Após Olá cópia bem-sucedida e antes de outros usuários sejam remapeados, somente hello logon que iniciou a saudação copiando, proprietário do banco de dados de hello, pode fazer logon no novo banco de dados de toohello.</span><span class="sxs-lookup"><span data-stu-id="1cc87-121">After hello copying succeeds and before other users are remapped, only hello login that initiated hello copying, hello database owner, can log in toohello new database.</span></span> <span data-ttu-id="1cc87-122">logons tooresolve depois Olá operação de cópia for concluído, consulte [resolver logons](#resolve-logins).</span><span class="sxs-lookup"><span data-stu-id="1cc87-122">tooresolve logins after hello copying operation is complete, see [Resolve logins](#resolve-logins).</span></span>

## <a name="copy-a-database-by-using-hello-azure-portal"></a><span data-ttu-id="1cc87-123">Copiar um banco de dados usando Olá portal do Azure</span><span class="sxs-lookup"><span data-stu-id="1cc87-123">Copy a database by using hello Azure portal</span></span>

<span data-ttu-id="1cc87-124">toocopy um banco de dados usando Olá portal do Azure, página Olá aberta para o banco de dados e, em seguida, clique em **cópia**.</span><span class="sxs-lookup"><span data-stu-id="1cc87-124">toocopy a database by using hello Azure portal, open hello page for your database, and then click **Copy**.</span></span> 

   ![Cópia do banco de dados](./media/sql-database-copy/database-copy.png)

## <a name="copy-a-database-by-using-powershell"></a><span data-ttu-id="1cc87-126">Cópia de banco de dados usando o PowerShell</span><span class="sxs-lookup"><span data-stu-id="1cc87-126">Copy a database by using PowerShell</span></span>

<span data-ttu-id="1cc87-127">toocopy um banco de dados usando o PowerShell, use Olá [AzureRmSqlDatabaseCopy novo](/powershell/module/azurerm.sql/new-azurermsqldatabasecopy) cmdlet.</span><span class="sxs-lookup"><span data-stu-id="1cc87-127">toocopy a database by using PowerShell, use hello [New-AzureRmSqlDatabaseCopy](/powershell/module/azurerm.sql/new-azurermsqldatabasecopy) cmdlet.</span></span> 

```PowerShell
New-AzureRmSqlDatabaseCopy -ResourceGroupName "myResourceGroup" `
    -ServerName $sourceserver `
    -DatabaseName "MySampleDatabase" `
    -CopyResourceGroupName "myResourceGroup" `
    -CopyServerName $targetserver `
    -CopyDatabaseName "CopyOfMySampleDatabase"
```

<span data-ttu-id="1cc87-128">Para um script de exemplo completo, consulte [copie um novo servidor de banco de dados tooa](scripts/sql-database-copy-database-to-new-server-powershell.md).</span><span class="sxs-lookup"><span data-stu-id="1cc87-128">For a complete sample script, see [Copy a database tooa new server](scripts/sql-database-copy-database-to-new-server-powershell.md).</span></span>

## <a name="copy-a-database-by-using-transact-sql"></a><span data-ttu-id="1cc87-129">Cópia de banco de dados usando o Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="1cc87-129">Copy a database by using Transact-SQL</span></span>

<span data-ttu-id="1cc87-130">Faça logon no mestre toohello banco de dados com logon principal no nível de servidor hello ou logon de Olá que criou o banco de dados de saudação desejado toocopy.</span><span class="sxs-lookup"><span data-stu-id="1cc87-130">Log in toohello master database with hello server-level principal login or hello login that created hello database you want toocopy.</span></span> <span data-ttu-id="1cc87-131">Para copiar toosucceed de banco de dados, logons que não são de entidade de nível de servidor de saudação devem ser membros da função dbmanager de saudação.</span><span class="sxs-lookup"><span data-stu-id="1cc87-131">For database copying toosucceed, logins that are not hello server-level principal must be members of hello dbmanager role.</span></span> <span data-ttu-id="1cc87-132">Para obter mais informações sobre logons e conectando o servidor toohello, consulte [gerenciar logons](sql-database-manage-logins.md).</span><span class="sxs-lookup"><span data-stu-id="1cc87-132">For more information about logins and connecting toohello server, see [Manage logins](sql-database-manage-logins.md).</span></span>

<span data-ttu-id="1cc87-133">Inicie a cópia do banco de dados de origem de saudação com hello [CREATE DATABASE](https://msdn.microsoft.com/library/ms176061.aspx) instrução.</span><span class="sxs-lookup"><span data-stu-id="1cc87-133">Start copying hello source database with hello [CREATE DATABASE](https://msdn.microsoft.com/library/ms176061.aspx) statement.</span></span> <span data-ttu-id="1cc87-134">Executar essa instrução inicia o processo de cópia de banco de dados do hello.</span><span class="sxs-lookup"><span data-stu-id="1cc87-134">Executing this statement initiates hello database copying process.</span></span> <span data-ttu-id="1cc87-135">Como copiar um banco de dados é um processo assíncrono, Olá instrução CREATE DATABASE retorna antes Olá cópia de banco de dados foi concluída.</span><span class="sxs-lookup"><span data-stu-id="1cc87-135">Because copying a database is an asynchronous process, hello CREATE DATABASE statement returns before hello database copying is complete.</span></span>

### <a name="copy-a-sql-database-toohello-same-server"></a><span data-ttu-id="1cc87-136">Copiar um toohello de banco de dados do SQL server mesmo</span><span class="sxs-lookup"><span data-stu-id="1cc87-136">Copy a SQL database toohello same server</span></span>
<span data-ttu-id="1cc87-137">Faça logon no mestre toohello banco de dados com logon principal no nível de servidor hello ou logon de Olá que criou o banco de dados de saudação desejado toocopy.</span><span class="sxs-lookup"><span data-stu-id="1cc87-137">Log in toohello master database with hello server-level principal login or hello login that created hello database you want toocopy.</span></span> <span data-ttu-id="1cc87-138">Para copiar toosucceed de banco de dados, logons que não são de entidade de nível de servidor de saudação devem ser membros da função dbmanager de saudação.</span><span class="sxs-lookup"><span data-stu-id="1cc87-138">For database copying toosucceed, logins that are not hello server-level principal must be members of hello dbmanager role.</span></span>

<span data-ttu-id="1cc87-139">Este comando copia Database1 tooa novo banco de dados denominado Database2 em Olá mesmo servidor.</span><span class="sxs-lookup"><span data-stu-id="1cc87-139">This command copies Database1 tooa new database named Database2 on hello same server.</span></span> <span data-ttu-id="1cc87-140">Dependendo do tamanho de saudação do banco de dados, Olá copiando operação pode levar algum tempo toocomplete.</span><span class="sxs-lookup"><span data-stu-id="1cc87-140">Depending on hello size of your database, hello copying operation might take some time toocomplete.</span></span>

    -- Execute on hello master database.
    -- Start copying.
    CREATE DATABASE Database1_copy AS COPY OF Database1;

### <a name="copy-a-sql-database-tooa-different-server"></a><span data-ttu-id="1cc87-141">Copiar um servidor diferente de tooa de banco de dados SQL</span><span class="sxs-lookup"><span data-stu-id="1cc87-141">Copy a SQL database tooa different server</span></span>

<span data-ttu-id="1cc87-142">Faça logon no mestre toohello banco de dados do servidor de destino hello, servidor de banco de dados SQL Olá onde o novo banco de dados de saudação é toobe criado.</span><span class="sxs-lookup"><span data-stu-id="1cc87-142">Log in toohello master database of hello destination server, hello SQL database server where hello new database is toobe created.</span></span> <span data-ttu-id="1cc87-143">Use um logon que tem Olá o mesmo nome e senha como proprietário do banco de dados de saudação do banco de dados de origem de saudação no servidor de banco de dados SQL de origem hello.</span><span class="sxs-lookup"><span data-stu-id="1cc87-143">Use a login that has hello same name and password as hello database owner of hello source database on hello source SQL database server.</span></span> <span data-ttu-id="1cc87-144">logon Olá no servidor de destino Olá também deve ser um membro da função dbmanager de saudação ou ser logon principal no nível de servidor hello.</span><span class="sxs-lookup"><span data-stu-id="1cc87-144">hello login on hello destination server must also be a member of hello dbmanager role or be hello server-level principal login.</span></span>

<span data-ttu-id="1cc87-145">Este comando copia Database1 no servidor1 tooa novo banco de dados chamado Database2 no Servidor2.</span><span class="sxs-lookup"><span data-stu-id="1cc87-145">This command copies Database1 on server1 tooa new database named Database2 on server2.</span></span> <span data-ttu-id="1cc87-146">Dependendo do tamanho de saudação do banco de dados, Olá copiando operação pode levar algum tempo toocomplete.</span><span class="sxs-lookup"><span data-stu-id="1cc87-146">Depending on hello size of your database, hello copying operation might take some time toocomplete.</span></span>

    -- Execute on hello master database of hello target server (server2)
    -- Start copying from Server1 tooServer2
    CREATE DATABASE Database1_copy AS COPY OF server1.Database1;


### <a name="monitor-hello-progress-of-hello-copying-operation"></a><span data-ttu-id="1cc87-147">Monitorar o progresso de saudação de saudação operação de cópia</span><span class="sxs-lookup"><span data-stu-id="1cc87-147">Monitor hello progress of hello copying operation</span></span>

<span data-ttu-id="1cc87-148">Monitorar o processo de cópia de saudação consultando exibições de sys. Databases e sys.DM database_copies hello.</span><span class="sxs-lookup"><span data-stu-id="1cc87-148">Monitor hello copying process by querying hello sys.databases and sys.dm_database_copies views.</span></span> <span data-ttu-id="1cc87-149">Enquanto a cópia de saudação está em andamento, Olá **state_desc** coluna da exibição de sys. Databases Olá para o novo banco de dados de saudação está definida muito**copiar**.</span><span class="sxs-lookup"><span data-stu-id="1cc87-149">While hello copying is in progress, hello **state_desc** column of hello sys.databases view for hello new database is set too**COPYING**.</span></span>

* <span data-ttu-id="1cc87-150">Se Olá cópia falhar, Olá **state_desc** coluna da exibição de sys. Databases Olá para o novo banco de dados de saudação está definida muito**SUSPEITAR**.</span><span class="sxs-lookup"><span data-stu-id="1cc87-150">If hello copying fails, hello **state_desc** column of hello sys.databases view for hello new database is set too**SUSPECT**.</span></span> <span data-ttu-id="1cc87-151">Execute Olá instrução DROP no novo banco de dados de saudação e tente novamente mais tarde.</span><span class="sxs-lookup"><span data-stu-id="1cc87-151">Execute hello DROP statement on hello new database, and try again later.</span></span>
* <span data-ttu-id="1cc87-152">Se Olá cópia for bem-sucedida, hello **state_desc** coluna da exibição de sys. Databases Olá para o novo banco de dados de saudação está definida muito**ONLINE**.</span><span class="sxs-lookup"><span data-stu-id="1cc87-152">If hello copying succeeds, hello **state_desc** column of hello sys.databases view for hello new database is set too**ONLINE**.</span></span> <span data-ttu-id="1cc87-153">Olá cópia foi concluída e Olá novo banco de dados for regulares que podem ser alteradas independente do banco de dados de origem de saudação.</span><span class="sxs-lookup"><span data-stu-id="1cc87-153">hello copying is complete, and hello new database is a regular database that can be changed independent of hello source database.</span></span>

> [!NOTE]
> <span data-ttu-id="1cc87-154">Se você decidir toocancel Olá copiando enquanto ele está em andamento, execute Olá [DROP DATABASE](https://msdn.microsoft.com/library/ms178613.aspx) declaração no novo banco de dados de saudação.</span><span class="sxs-lookup"><span data-stu-id="1cc87-154">If you decide toocancel hello copying while it is in progress, execute hello [DROP DATABASE](https://msdn.microsoft.com/library/ms178613.aspx) statement on hello new database.</span></span> <span data-ttu-id="1cc87-155">Como alternativa, executar a instrução de DROP DATABASE de saudação no banco de dados de origem de saudação também cancela Olá processo de cópia.</span><span class="sxs-lookup"><span data-stu-id="1cc87-155">Alternatively, executing hello DROP DATABASE statement on hello source database also cancels hello copying process.</span></span>
> 

## <a name="resolve-logins"></a><span data-ttu-id="1cc87-156">Resolver logons</span><span class="sxs-lookup"><span data-stu-id="1cc87-156">Resolve logins</span></span>

<span data-ttu-id="1cc87-157">Depois que o novo banco de dados de saudação está online no servidor de destino Olá, use Olá [ALTER USER](https://msdn.microsoft.com/library/ms176060.aspx) instrução tooremap Olá os usuários Olá novo banco de dados toologins no servidor de destino de saudação.</span><span class="sxs-lookup"><span data-stu-id="1cc87-157">After hello new database is online on hello destination server, use hello [ALTER USER](https://msdn.microsoft.com/library/ms176060.aspx) statement tooremap hello users from hello new database toologins on hello destination server.</span></span> <span data-ttu-id="1cc87-158">os usuários tooresolve órfãos, consulte [solucionar problemas de usuários órfãos](https://msdn.microsoft.com/library/ms175475.aspx).</span><span class="sxs-lookup"><span data-stu-id="1cc87-158">tooresolve orphaned users, see [Troubleshoot Orphaned Users](https://msdn.microsoft.com/library/ms175475.aspx).</span></span> <span data-ttu-id="1cc87-159">Consulte também [como toomanage SQL Azure segurança banco de dados após a recuperação de desastres](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="1cc87-159">See also [How toomanage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span>

<span data-ttu-id="1cc87-160">Todos os usuários no novo banco de dados de saudação reter permissões de saudação que eles tinham no banco de dados de origem de saudação.</span><span class="sxs-lookup"><span data-stu-id="1cc87-160">All users in hello new database retain hello permissions that they had in hello source database.</span></span> <span data-ttu-id="1cc87-161">usuário Olá que iniciou a cópia do banco de dados de saudação se torna o proprietário do banco de dados de saudação do novo banco de dados de saudação e é atribuído a um novo identificador de segurança (SID).</span><span class="sxs-lookup"><span data-stu-id="1cc87-161">hello user who initiated hello database copy becomes hello database owner of hello new database and is assigned a new security identifier (SID).</span></span> <span data-ttu-id="1cc87-162">Após Olá cópia bem-sucedida e antes de outros usuários sejam remapeados, somente hello logon que iniciou a saudação copiando, proprietário do banco de dados de hello, pode fazer logon no novo banco de dados de toohello.</span><span class="sxs-lookup"><span data-stu-id="1cc87-162">After hello copying succeeds and before other users are remapped, only hello login that initiated hello copying, hello database owner, can log in toohello new database.</span></span>

<span data-ttu-id="1cc87-163">toolearn sobre como gerenciar usuários e logons quando você copiar um banco de dados tooa servidor lógico diferente, consulte [como toomanage SQL Azure segurança banco de dados após a recuperação de desastres](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="1cc87-163">toolearn about managing users and logins when you copy a database tooa different logical server, see [How toomanage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="1cc87-164">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="1cc87-164">Next steps</span></span>

* <span data-ttu-id="1cc87-165">Para obter informações sobre logons, consulte [gerenciar logons](sql-database-manage-logins.md) e [como toomanage SQL Azure segurança banco de dados após a recuperação de desastres](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="1cc87-165">For information about logins, see [Manage logins](sql-database-manage-logins.md) and [How toomanage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span>
* <span data-ttu-id="1cc87-166">tooexport um banco de dados, consulte [Exportar banco de dados de saudação tooa BACPAC](sql-database-export.md).</span><span class="sxs-lookup"><span data-stu-id="1cc87-166">tooexport a database, see [Export hello database tooa BACPAC](sql-database-export.md).</span></span>
