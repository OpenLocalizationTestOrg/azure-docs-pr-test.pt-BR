---
title: "Gerenciar a política de caching da CDN do Azure nos Serviços de Mídia do Azure | Microsoft Docs"
description: "Saiba como gerenciar a política de caching da CDN do Azure nos Serviços de Mídia do Azure."
services: media-services,cdn
documentationcenter: .NET
author: juliako
manager: erikre
editor: 
ms.assetid: be33aecc-6dbe-43d7-a056-10ba911e0e94
ms.service: media-services
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 02/04/2017
ms.author: juliako
ms.openlocfilehash: 0c479a58f4158bb1a72dc43432507160f65d2791
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 07/11/2017
---
# <a name="manage-azure-cdn-caching-policy-in-azure-media-services"></a><span data-ttu-id="40baf-103">Gerenciar a política de caching da CDN do Azure nos Serviços de Mídia do Azure</span><span class="sxs-lookup"><span data-stu-id="40baf-103">Manage Azure CDN caching policy in Azure Media Services</span></span>
<span data-ttu-id="40baf-104">Os Serviços de Mídia do Azure fornecem streaming adaptável e download progressivo com base em HTTP.</span><span class="sxs-lookup"><span data-stu-id="40baf-104">Azure Media Services provides HTTP based Adaptive Streaming and progressive download.</span></span> <span data-ttu-id="40baf-105">Streaming com base em HTTP é altamente escalonável, com os benefícios do armazenamento em cache em camadas proxy e CDN, bem como armazenamento em cache no lado do cliente.</span><span class="sxs-lookup"><span data-stu-id="40baf-105">HTTP based streaming is highly scalable with benefits of caching in proxy and CDN layers as well as client side caching.</span></span> <span data-ttu-id="40baf-106">Pontos de extremidade de streaming fornecem recursos de streaming gerais e também a configuração de cabeçalhos de cache HTTP.</span><span class="sxs-lookup"><span data-stu-id="40baf-106">Streaming endpoints provides general streaming capabilities and also configuration for HTTP cache headers.</span></span> <span data-ttu-id="40baf-107">Pontos de extremidade de streaming definem o Controle de Cache HTTP: cabeçalhos idade máxima e Vencimento.</span><span class="sxs-lookup"><span data-stu-id="40baf-107">Streaming endpoints sets HTTP Cache-Control: max-age and Expires headers.</span></span> <span data-ttu-id="40baf-108">Saiba mais sobre os cabeçalhos de cache HTTP em [W3.org](http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html).</span><span class="sxs-lookup"><span data-stu-id="40baf-108">You can get more information for HTTP cache headers from [W3.org](http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html).</span></span>

## <a name="default-caching-headers"></a><span data-ttu-id="40baf-109">Cabeçalhos de armazenamento em cache padrão</span><span class="sxs-lookup"><span data-stu-id="40baf-109">Default Caching headers</span></span>
<span data-ttu-id="40baf-110">Por padrão, os pontos de extremidade de streaming aplicam cabeçalhos de cache de 3 dias para dados de streaming sob demanda (fragmentos/partes reais de mídia) e manifesto (lista de reprodução).</span><span class="sxs-lookup"><span data-stu-id="40baf-110">By default streaming-endpoints apply 3 day cache headers for on-demand streaming data (actual media fragments/chunks) and manifest(playlist).</span></span> <span data-ttu-id="40baf-111">Para transmissão ao vivo, os pontos de extremidade de streaming aplicam cabeçalhos de cache de 3 dias para solicitações de dados (fragmentos/partes reais de mídia) e cabeçalho de cache de 2 segundos para solicitações de manifesto (lista de reprodução).</span><span class="sxs-lookup"><span data-stu-id="40baf-111">For live streaming, streaming endpoints apply 3 day cache headers for data (actual media fragments/chunks) and 2 seconds cache header for manifest(playlist) requests.</span></span> <span data-ttu-id="40baf-112">Quando os programa ao vivo são transformados em sob demanda (arquivamento dinâmico) os cabeçalhos de cache de streaming sob demanda são aplicados.</span><span class="sxs-lookup"><span data-stu-id="40baf-112">When live program turns to on-demand (live archive) then on-demand streaming cache headers apply.</span></span>

## <a name="azure-cdn-integration"></a><span data-ttu-id="40baf-113">Integração da CDN com o Azure</span><span class="sxs-lookup"><span data-stu-id="40baf-113">Azure CDN integration</span></span>
<span data-ttu-id="40baf-114">Os Serviços de Mídia do Azure fornecem [CDN integrada](https://azure.microsoft.com/updates/azure-media-services-now-fully-integrated-with-azure-cdn/) para pontos de extremidade de streaming.</span><span class="sxs-lookup"><span data-stu-id="40baf-114">Azure Media Services provides [integrated CDN](https://azure.microsoft.com/updates/azure-media-services-now-fully-integrated-with-azure-cdn/) for streaming-endpoints.</span></span> <span data-ttu-id="40baf-115">Cabeçalhos do controle de cache são aplicados da mesma forma que os pontos de extremidade de streaming para pontos de extremidade de streaming habilitados para CDN.</span><span class="sxs-lookup"><span data-stu-id="40baf-115">Cache-control headers applies in the same way as streaming endpoints to CDN enabled streaming endpoints.</span></span> <span data-ttu-id="40baf-116">O Azure CDN usa os valores de cache configurados para o ponto de extremidade de streaming para definir o tempo de vida dos objetos armazenados internamente em cache e também usa esse valor para definir os cabeçalhos de cache de entrega.</span><span class="sxs-lookup"><span data-stu-id="40baf-116">Azure CDN uses streaming endpoint configured cache values to define the life time of the internally cached objects and also uses this value to set the delivery cache headers.</span></span> <span data-ttu-id="40baf-117">Ao usar os pontos de extremidades de streaming habilitados para CDN, não é recomendável definir valores pequenos para o cache.</span><span class="sxs-lookup"><span data-stu-id="40baf-117">When using CDN enabled streaming endpoints it is not recommended to set small cache values.</span></span> <span data-ttu-id="40baf-118">A definição de valores pequenos diminuirá o desempenho e reduzirá o benefício da CDN.</span><span class="sxs-lookup"><span data-stu-id="40baf-118">Setting small values will decrease the performance and reduce the benefit of CDN.</span></span> <span data-ttu-id="40baf-119">Não é permitido definir cabeçalhos de cache menores do que 600 segundos para pontos de extremidades de streaming habilitados para CDN.</span><span class="sxs-lookup"><span data-stu-id="40baf-119">It is not allowed to set cache headers smaller than 600 seconds for CDN enabled streaming endpoints.</span></span>

> [!IMPORTANT]
><span data-ttu-id="40baf-120">Os Serviços de Mídia do Azure têm integração completa com o Azure CDN.</span><span class="sxs-lookup"><span data-stu-id="40baf-120">Azure Media Services has complete integration with Azure CDN.</span></span> <span data-ttu-id="40baf-121">Com um único clique, você pode integrar todos os Azure CDN provedores disponíveis (Akamai e Verizon) para o ponto de extremidade de streaming incluindo produtos CDN Standard e Premium.</span><span class="sxs-lookup"><span data-stu-id="40baf-121">With a single click you can integrate all the available Azure CDN providers (Akamai and Verizon) to your streaming endpoint including CDN Standard and Premium products.</span></span> <span data-ttu-id="40baf-122">Para saber mais, veja este [anúncio](https://azure.microsoft.com/blog/standardstreamingendpoint/).</span><span class="sxs-lookup"><span data-stu-id="40baf-122">For more information, see this [announcement](https://azure.microsoft.com/blog/standardstreamingendpoint/).</span></span>
> 
> <span data-ttu-id="40baf-123">Encargos de dados de streaming de ponto de extremidade CDN somente obtém desabilitada se o CDN é habilitada pela extremidade APIs de streaming ou por meio da seção de ponto de extremidade de streaming do portal de gerenciamento do Azure.</span><span class="sxs-lookup"><span data-stu-id="40baf-123">Data charges from streaming endpoint to CDN only gets disabled if the CDN is enabled over streaming endpoint APIs or using Azure management portal's streaming endpoint section.</span></span> <span data-ttu-id="40baf-124">Integração manual ou diretamente a criação de um ponto de extremidade CDN usando APIs de CDN ou seção portal não desabilitará os encargos de dados.</span><span class="sxs-lookup"><span data-stu-id="40baf-124">Manual integration or directly creating a CDN endpoint using CDN APIs or portal section will not disable the data charges.</span></span>

## <a name="configuring-cache-headers-with-azure-media-services"></a><span data-ttu-id="40baf-125">Configurando os cabeçalhos de cache com os Serviços de Mídia do Azure</span><span class="sxs-lookup"><span data-stu-id="40baf-125">Configuring cache headers with Azure Media Services</span></span>
<span data-ttu-id="40baf-126">Você pode usar o Portal de Gerenciamento do Azure ou as APIs de Serviços de Mídia do Azure para configurar os valores de cabeçalho de cache.</span><span class="sxs-lookup"><span data-stu-id="40baf-126">You can use Azure Management portal or Azure Media Services APIs to configure cache header values.</span></span>

1. <span data-ttu-id="40baf-127">Para configurar cabeçalhos de cache usando o Portal de Gerenciamento, consulte [Como gerenciar pontos de extremidade de streaming](../media-services/media-services-portal-manage-streaming-endpoints.md) , seção Configurando o ponto de extremidade de streaming.</span><span class="sxs-lookup"><span data-stu-id="40baf-127">To configure cache headers using management portal please refer to [How to Manage Streaming Endpoints](../media-services/media-services-portal-manage-streaming-endpoints.md) section Configuring the Streaming Endpoint.</span></span>
2. <span data-ttu-id="40baf-128">API REST dos Serviços de Mídia do Azure, [StreamingEndpoint](https://msdn.microsoft.com/library/azure/dn783468.aspx#StreamingEndpointCacheControl).</span><span class="sxs-lookup"><span data-stu-id="40baf-128">Azure Media Services REST API, [StreamingEndpoint](https://msdn.microsoft.com/library/azure/dn783468.aspx#StreamingEndpointCacheControl).</span></span>
3. <span data-ttu-id="40baf-129">SDK do .NET dos Serviços de Mídia do Azure, [Propriedades de StreamingEndpointCacheControl](http://go.microsoft.com/fwlink/?LinkId=615302).</span><span class="sxs-lookup"><span data-stu-id="40baf-129">Azure Media Services .NET SDK, [StreamingEndpointCacheControl Properties](http://go.microsoft.com/fwlink/?LinkId=615302).</span></span>

## <a name="cache-configuration-precedence-order"></a><span data-ttu-id="40baf-130">Ordem de precedência de configuração do cache</span><span class="sxs-lookup"><span data-stu-id="40baf-130">Cache configuration precedence order</span></span>
1. <span data-ttu-id="40baf-131">O valor de cache configurado dos Serviços de Mídia do Azure substitui o valor padrão.</span><span class="sxs-lookup"><span data-stu-id="40baf-131">Azure Media Services configured cache value overrides default value.</span></span>
2. <span data-ttu-id="40baf-132">Se não houver configuração manual, os valores padrão serão aplicados.</span><span class="sxs-lookup"><span data-stu-id="40baf-132">If there is no manual configuration, default values applies.</span></span>
3. <span data-ttu-id="40baf-133">Por padrão, os cabeçalhos de cache de 2 segundos são aplicados ao manifesto (lista de reprodução) do streaming dinâmico, independentemente da configuração de Mídia do Azure ou do Armazenamento do Azure, e não é possível substituir esse valor.</span><span class="sxs-lookup"><span data-stu-id="40baf-133">By default 2 seconds cache headers applies to live streaming manifest(playlist) regardless of Azure Media or Azure Storage configuration and overriding of this value is not available.</span></span>

