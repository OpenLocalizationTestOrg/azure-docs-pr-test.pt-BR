---
title: "aaaUse de instantâneos incrementais para backup e recuperação de discos de VM do Azure não gerenciados | Microsoft Docs"
description: "Crie uma solução personalizada para backup e recuperação de seus discos de máquina virtual do Azure usando instantâneos incrementais."
services: storage
documentationcenter: na
author: aungoo-msft
manager: tadb
editor: tysonn
ms.assetid: 3524b987-bd65-4e35-83e7-fbc2136643e5
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/23/2017
ms.author: aungoo
ms.openlocfilehash: 6d3e6d78e953f77a1028ac35dcde1ef046dbc3bb
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="back-up-azure-unmanaged-vm-disks-with-incremental-snapshots"></a><span data-ttu-id="68925-103">Faça backup dos discos não gerenciados de VM do Azure com instantâneos incrementais</span><span class="sxs-lookup"><span data-stu-id="68925-103">Back up Azure unmanaged VM disks with incremental snapshots</span></span>
## <a name="overview"></a><span data-ttu-id="68925-104">Visão geral</span><span class="sxs-lookup"><span data-stu-id="68925-104">Overview</span></span>
<span data-ttu-id="68925-105">Armazenamento do Azure fornece a capacidade de saudação tootake instantâneos de blobs.</span><span class="sxs-lookup"><span data-stu-id="68925-105">Azure Storage provides hello capability tootake snapshots of blobs.</span></span> <span data-ttu-id="68925-106">Instantâneos de capturem o estado de blob Olá no momento.</span><span class="sxs-lookup"><span data-stu-id="68925-106">Snapshots capture hello blob state at that point in time.</span></span> <span data-ttu-id="68925-107">Neste artigo, descrevemos um cenário de como você pode manter backups dos discos de máquinas virtuais usando instantâneos.</span><span class="sxs-lookup"><span data-stu-id="68925-107">In this article, we will describe a scenario of how you can maintain backups of virtual machine disks using snapshots.</span></span> <span data-ttu-id="68925-108">Você pode usar essa metodologia quando você escolher não toouse Backup do Azure e o serviço de recuperação e desejos toocreate uma estratégia de backup personalizada para os discos de máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="68925-108">You can use this methodology when you choose not toouse Azure Backup and Recovery Service, and wish toocreate a custom backup strategy for your virtual machine disks.</span></span>

<span data-ttu-id="68925-109">Os discos de máquinas virtuais do Azure são armazenados como blobs de página no Armazenamento do Azure.</span><span class="sxs-lookup"><span data-stu-id="68925-109">Azure virtual machine disks are stored as page blobs in Azure Storage.</span></span> <span data-ttu-id="68925-110">Já que estamos falando de estratégia de backup para discos de máquina virtual neste artigo, vamos fará referência toosnapshots no contexto de saudação de blobs de página.</span><span class="sxs-lookup"><span data-stu-id="68925-110">Since we are talking about backup strategy for virtual machine disks in this article, we will be referring toosnapshots in hello context of page blobs.</span></span> <span data-ttu-id="68925-111">toolearn mais informações sobre instantâneos, consulte muito[criando um instantâneo de um Blob](https://msdn.microsoft.com/library/azure/hh488361.aspx).</span><span class="sxs-lookup"><span data-stu-id="68925-111">toolearn more about snapshots, refer too[Creating a Snapshot of a Blob](https://msdn.microsoft.com/library/azure/hh488361.aspx).</span></span>

## <a name="what-is-a-snapshot"></a><span data-ttu-id="68925-112">O que é um instantâneo?</span><span class="sxs-lookup"><span data-stu-id="68925-112">What is a snapshot?</span></span>
<span data-ttu-id="68925-113">Um instantâneo de blob é uma versão somente leitura de um blob capturada em um dado momento.</span><span class="sxs-lookup"><span data-stu-id="68925-113">A blob snapshot is a read-only version of a blob that is captured at a point in time.</span></span> <span data-ttu-id="68925-114">Quando um instantâneo tiver sido criado, ele pode ser lido, copiado ou excluído, mas não modificado.</span><span class="sxs-lookup"><span data-stu-id="68925-114">Once a snapshot has been created, it can be read, copied, or deleted, but not modified.</span></span> <span data-ttu-id="68925-115">Os instantâneos fornecem uma tooback de forma a um blob conforme ele aparece em um momento específico.</span><span class="sxs-lookup"><span data-stu-id="68925-115">Snapshots provide a way tooback up a blob as it appears at a moment in time.</span></span> <span data-ttu-id="68925-116">Até REST versão 2015-04-05, você precisava instantâneos completa da saudação capacidade toocopy.</span><span class="sxs-lookup"><span data-stu-id="68925-116">Until REST version 2015-04-05 you had hello ability toocopy full snapshots.</span></span> <span data-ttu-id="68925-117">Com hello REST versão 2015-07-08 e posterior, você também pode copiar instantâneos incrementais.</span><span class="sxs-lookup"><span data-stu-id="68925-117">With hello REST version 2015-07-08 and above, you can also copy incremental snapshots.</span></span>

## <a name="full-snapshot-copy"></a><span data-ttu-id="68925-118">Cópia de instantâneo completo</span><span class="sxs-lookup"><span data-stu-id="68925-118">Full snapshot copy</span></span>
<span data-ttu-id="68925-119">Instantâneos podem ser copiados tooanother conta de armazenamento como backups de tookeep um blob de blob de base de saudação.</span><span class="sxs-lookup"><span data-stu-id="68925-119">Snapshots can be copied tooanother storage account as a blob tookeep backups of hello base blob.</span></span> <span data-ttu-id="68925-120">Você também pode copiar um instantâneo sobre seu blob de base, que é similar à restauração Olá blob tooan versão anterior.</span><span class="sxs-lookup"><span data-stu-id="68925-120">You can also copy a snapshot over its base blob, which is like restoring hello blob tooan earlier version.</span></span> <span data-ttu-id="68925-121">Quando um instantâneo é copiado de um tooanother de conta de armazenamento, ele ocupará Olá mesmo espaço como blob de página de base de saudação.</span><span class="sxs-lookup"><span data-stu-id="68925-121">When a snapshot is copied from one storage account tooanother, it will occupy hello same space as hello base page blob.</span></span> <span data-ttu-id="68925-122">Portanto, copiando instantâneos inteiros de um tooanother de conta de armazenamento será lento e também irá consumir muito espaço na conta de armazenamento de destino hello.</span><span class="sxs-lookup"><span data-stu-id="68925-122">Therefore, copying whole snapshots from one storage account tooanother will be slow and will also consume lot of space in hello target storage account.</span></span>

> [!NOTE]
> <span data-ttu-id="68925-123">Se você copiar o destino de tooanother de blob de base hello, instantâneos de saudação do blob Olá não são copiados junto com ele.</span><span class="sxs-lookup"><span data-stu-id="68925-123">If you copy hello base blob tooanother destination, hello snapshots of hello blob are not copied along with it.</span></span> <span data-ttu-id="68925-124">Da mesma forma, se você substituir um blob de base com uma cópia, instantâneos associados Olá blob de base não são afetados e permanecem intactos sob o nome de blob de base.</span><span class="sxs-lookup"><span data-stu-id="68925-124">Similarly, if you overwrite a base blob with a copy, snapshots associated with hello base blob are not affected and stay intact under base blob name.</span></span>
> 
> 

### <a name="back-up-disks-using-snapshots"></a><span data-ttu-id="68925-125">Fazer backup de discos usando instantâneos</span><span class="sxs-lookup"><span data-stu-id="68925-125">Back up disks using snapshots</span></span>
<span data-ttu-id="68925-126">Como uma estratégia de backup para os discos de máquina virtual, você pode tirar instantâneos periódicos do blob de página ou disco hello e copiá-los usando ferramentas como de conta de armazenamento tooanother [cópia Blob](https://msdn.microsoft.com/library/azure/dd894037.aspx) operação ou [AzCopy](storage-use-azcopy.md).</span><span class="sxs-lookup"><span data-stu-id="68925-126">As a backup strategy for your virtual machine disks, you can take periodic snapshots of hello disk or page blob, and copy them tooanother storage account using tools like [Copy Blob](https://msdn.microsoft.com/library/azure/dd894037.aspx) operation or [AzCopy](storage-use-azcopy.md).</span></span> <span data-ttu-id="68925-127">Você pode copiar um blob de página de destino do instantâneo tooa com um nome diferente.</span><span class="sxs-lookup"><span data-stu-id="68925-127">You can copy a snapshot tooa destination page blob with a different name.</span></span> <span data-ttu-id="68925-128">blob de páginas de destino resultante Olá é um blob de página gravável e não um instantâneo.</span><span class="sxs-lookup"><span data-stu-id="68925-128">hello resulting destination page blob is a writeable page blob and not a snapshot.</span></span> <span data-ttu-id="68925-129">Neste artigo, descreveremos os backups de tootake etapas do uso de instantâneos de discos de máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="68925-129">Later in this article we will describe steps tootake backups of virtual machine disks using snapshots.</span></span>

### <a name="restore-disks-using-snapshots"></a><span data-ttu-id="68925-130">Restaurar discos usando instantâneos</span><span class="sxs-lookup"><span data-stu-id="68925-130">Restore disks using snapshots</span></span>
<span data-ttu-id="68925-131">Quando for hora toorestore seu disco tooa anterior a versão estável capturada em um dos instantâneos de backup hello, você pode copiar um instantâneo sobre o blob de página de base de saudação.</span><span class="sxs-lookup"><span data-stu-id="68925-131">When it is time toorestore your disk tooa previous stable version captured in one of hello backup snapshots, you can copy a snapshot over hello base page blob.</span></span> <span data-ttu-id="68925-132">Depois que o instantâneo de saudação é promovida toohello blob de página de base, Olá instantâneo permanece, mas sua origem é substituída por uma cópia que pode ser lida e gravada.</span><span class="sxs-lookup"><span data-stu-id="68925-132">After hello snapshot is promoted toohello base page blob, hello snapshot remains, but its source is overwritten with a copy that can be both read and written.</span></span> <span data-ttu-id="68925-133">Neste artigo, descreveremos etapas toorestore uma versão anterior do disco do seu instantâneo.</span><span class="sxs-lookup"><span data-stu-id="68925-133">Later in this article we will describe steps toorestore a previous version of your disk from its snapshot.</span></span>

### <a name="implementing-full-snapshot-copy"></a><span data-ttu-id="68925-134">Implementando uma cópia completa do instantâneo</span><span class="sxs-lookup"><span data-stu-id="68925-134">Implementing full snapshot copy</span></span>
<span data-ttu-id="68925-135">Você pode implementar uma cópia completa de instantâneo, fazendo o seguinte Olá,</span><span class="sxs-lookup"><span data-stu-id="68925-135">You can implement a full snapshot copy by doing hello following,</span></span>

* <span data-ttu-id="68925-136">Primeiro, tire um instantâneo de blob de base hello usando Olá [Blob de instantâneo](https://msdn.microsoft.com/library/azure/ee691971.aspx) operação.</span><span class="sxs-lookup"><span data-stu-id="68925-136">First, take a snapshot of hello base blob using hello [Snapshot Blob](https://msdn.microsoft.com/library/azure/ee691971.aspx) operation.</span></span>
* <span data-ttu-id="68925-137">Em seguida, copie Olá instantâneo tooa destino armazenamento conta usando [cópia Blob](https://msdn.microsoft.com/library/azure/dd894037.aspx).</span><span class="sxs-lookup"><span data-stu-id="68925-137">Then, copy hello snapshot tooa target storage account using [Copy Blob](https://msdn.microsoft.com/library/azure/dd894037.aspx).</span></span>
* <span data-ttu-id="68925-138">Repita este processo toomaintain cópias de backup o blob de base.</span><span class="sxs-lookup"><span data-stu-id="68925-138">Repeat this process toomaintain backup copies of your base blob.</span></span>

## <a name="incremental-snapshot-copy"></a><span data-ttu-id="68925-139">Cópia de instantâneo incremental</span><span class="sxs-lookup"><span data-stu-id="68925-139">Incremental snapshot copy</span></span>
<span data-ttu-id="68925-140">novo recurso de saudação do [GetPageRanges](https://msdn.microsoft.com/library/azure/ee691973.aspx) API fornece uma tooback de maneira muito melhor do backup de instantâneos de saudação do blobs de página ou discos.</span><span class="sxs-lookup"><span data-stu-id="68925-140">hello new feature in [GetPageRanges](https://msdn.microsoft.com/library/azure/ee691973.aspx) API provides a much better way tooback up hello snapshots of your page blobs or disks.</span></span> <span data-ttu-id="68925-141">Olá API retorna a lista de saudação de alterações entre o blob de base hello e instantâneos de saudação.</span><span class="sxs-lookup"><span data-stu-id="68925-141">hello API returns hello list of changes between hello base blob and hello snapshots.</span></span> <span data-ttu-id="68925-142">Isso reduz a quantidade de saudação do espaço de armazenamento usado na conta de backup hello.</span><span class="sxs-lookup"><span data-stu-id="68925-142">This reduces hello amount of storage space used on hello backup account.</span></span> <span data-ttu-id="68925-143">Olá API dá suporte a blobs de página no armazenamento Premium, bem como o armazenamento padrão.</span><span class="sxs-lookup"><span data-stu-id="68925-143">hello API supports page blobs on Premium Storage as well as Standard Storage.</span></span> <span data-ttu-id="68925-144">Com essa API, você pode criar soluções de backup mais rápidas e eficientes para VMs do Azure.</span><span class="sxs-lookup"><span data-stu-id="68925-144">Using this API, you can now build faster and efficient backup solutions for Azure VMs.</span></span> <span data-ttu-id="68925-145">Isso será disponível Olá REST versão 08 / 07 / 2015 e superior.</span><span class="sxs-lookup"><span data-stu-id="68925-145">This will be available with hello REST version 2015-07-08 and higher.</span></span>

<span data-ttu-id="68925-146">A cópia do instantâneo incremental permite que você toocopy de um armazenamento conta tooanother Olá diferença entre,</span><span class="sxs-lookup"><span data-stu-id="68925-146">Incremental Snapshot Copy allows you toocopy from one storage account tooanother hello difference between,</span></span>

* <span data-ttu-id="68925-147">o blob de base e seu instantâneo OU</span><span class="sxs-lookup"><span data-stu-id="68925-147">Base blob and its Snapshot OR</span></span>
* <span data-ttu-id="68925-148">Todos os dois instantâneos de blob de base Olá</span><span class="sxs-lookup"><span data-stu-id="68925-148">Any two snapshots of hello base blob</span></span>

<span data-ttu-id="68925-149">Olá fornecido seguintes condições forem atendidas,</span><span class="sxs-lookup"><span data-stu-id="68925-149">Provided hello following conditions are met,</span></span>

* <span data-ttu-id="68925-150">blob de saudação foi criada em 1 de janeiro de 2016 ou posterior.</span><span class="sxs-lookup"><span data-stu-id="68925-150">hello blob was created on Jan-1-2016 or later.</span></span>
* <span data-ttu-id="68925-151">blob de saudação não foi substituído com [PutPage](https://msdn.microsoft.com/library/azure/ee691975.aspx) ou [cópia Blob](https://msdn.microsoft.com/library/azure/dd894037.aspx) entre dois instantâneos.</span><span class="sxs-lookup"><span data-stu-id="68925-151">hello blob was not overwritten with [PutPage](https://msdn.microsoft.com/library/azure/ee691975.aspx) or [Copy Blob](https://msdn.microsoft.com/library/azure/dd894037.aspx) between two snapshots.</span></span>

<span data-ttu-id="68925-152">**Observação**: este recurso está disponível para os Blobs de Página do Azure Premium e Standard.</span><span class="sxs-lookup"><span data-stu-id="68925-152">**Note**: This feature is available for Premium and Standard Azure Page Blobs.</span></span>

<span data-ttu-id="68925-153">Quando você tem uma estratégia de backup personalizada que usa os instantâneos, copiando instantâneos de saudação de um tooanother de conta de armazenamento pode ser muito lento e consome muito espaço de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="68925-153">When you have a custom backup strategy that uses snapshots, copying hello snapshots from one storage account tooanother can be very slow and consumes a lot of storage space.</span></span> <span data-ttu-id="68925-154">Em vez de copiar a conta de armazenamento de backup em tooa Olá todo o instantâneo, você pode escrever diferença Olá entre blob de página backup tooa instantâneos consecutivos.</span><span class="sxs-lookup"><span data-stu-id="68925-154">Instead of copying hello entire snapshot tooa backup storage account, you can write hello difference between consecutive snapshots tooa backup page blob.</span></span> <span data-ttu-id="68925-155">Dessa forma, Olá tempo toocopy e espaço toostore backups é reduzido significativamente.</span><span class="sxs-lookup"><span data-stu-id="68925-155">This way, hello time toocopy and space toostore backups is substantially reduced.</span></span>

### <a name="implementing-incremental-snapshot-copy"></a><span data-ttu-id="68925-156">Implementando a Cópia de instantâneo incremental</span><span class="sxs-lookup"><span data-stu-id="68925-156">Implementing Incremental Snapshot Copy</span></span>
<span data-ttu-id="68925-157">Você pode implementar a cópia do instantâneo incremental, fazendo o seguinte Olá,</span><span class="sxs-lookup"><span data-stu-id="68925-157">You can implement incremental snapshot copy by doing hello following,</span></span>

* <span data-ttu-id="68925-158">Tirar um instantâneo do uso de blob de base Olá [Blob de instantâneo](https://msdn.microsoft.com/library/azure/ee691971.aspx).</span><span class="sxs-lookup"><span data-stu-id="68925-158">Take a snapshot of hello base blob using [Snapshot Blob](https://msdn.microsoft.com/library/azure/ee691971.aspx).</span></span>
* <span data-ttu-id="68925-159">Cópia Olá instantâneo toohello destino de armazenamento de backup conta usando [cópia Blob](https://msdn.microsoft.com/library/azure/dd894037.aspx).</span><span class="sxs-lookup"><span data-stu-id="68925-159">Copy hello snapshot toohello target backup storage account using [Copy Blob](https://msdn.microsoft.com/library/azure/dd894037.aspx).</span></span> <span data-ttu-id="68925-160">Esse será o blob de página backup hello.</span><span class="sxs-lookup"><span data-stu-id="68925-160">This will be hello backup page blob.</span></span> <span data-ttu-id="68925-161">Tire um instantâneo do blob de páginas backup e armazene na conta de backup.</span><span class="sxs-lookup"><span data-stu-id="68925-161">Take a snapshot of this backup page blob and store in backup account.</span></span>
* <span data-ttu-id="68925-162">Tire outro instantâneo do blob de base hello usando o Blob de instantâneo.</span><span class="sxs-lookup"><span data-stu-id="68925-162">Take another snapshot of hello base blob using Snapshot Blob.</span></span>
* <span data-ttu-id="68925-163">Obter a diferença de saudação entre o primeiro e segundo instantâneos de blob de base usando [GetPageRanges](https://msdn.microsoft.com/library/azure/ee691973.aspx).</span><span class="sxs-lookup"><span data-stu-id="68925-163">Get hello difference between first and second snapshots of base blob using  [GetPageRanges](https://msdn.microsoft.com/library/azure/ee691973.aspx).</span></span> <span data-ttu-id="68925-164">Usar o novo parâmetro de saudação **prevsnapshot** toospecify Olá Olá instantâneo de diferença de saudação tooget com valor DateTime.</span><span class="sxs-lookup"><span data-stu-id="68925-164">Use hello new parameter **prevsnapshot** toospecify hello DateTime value of hello snapshot you want tooget hello difference with.</span></span> <span data-ttu-id="68925-165">Quando esse parâmetro estiver presente, Olá resposta REST incluirá apenas as páginas de saudação que foram alteradas entre o instantâneo de destino e o instantâneo anterior, incluindo páginas claras.</span><span class="sxs-lookup"><span data-stu-id="68925-165">When this parameter is present, hello REST response will include only hello pages that were changed between target snapshot and previous snapshot including clear pages.</span></span>
* <span data-ttu-id="68925-166">Use [PutPage](https://msdn.microsoft.com/library/azure/ee691975.aspx) tooapply blob de página de backup de toohello essas alterações.</span><span class="sxs-lookup"><span data-stu-id="68925-166">Use [PutPage](https://msdn.microsoft.com/library/azure/ee691975.aspx) tooapply these changes toohello backup page blob.</span></span>
* <span data-ttu-id="68925-167">Finalmente, tire um instantâneo de blob de página backup hello e armazená-la na conta de armazenamento de backup hello.</span><span class="sxs-lookup"><span data-stu-id="68925-167">Finally, take a snapshot of hello backup page blob and store it in hello backup storage account.</span></span>

<span data-ttu-id="68925-168">Na próxima seção, Olá, descreveremos mais detalhadamente como você pode manter backups de discos usando a cópia do instantâneo Incremental</span><span class="sxs-lookup"><span data-stu-id="68925-168">In hello next section, we will describe in more detail how you can maintain backups of disks using Incremental Snapshot Copy</span></span>

## <a name="scenario"></a><span data-ttu-id="68925-169">Cenário</span><span class="sxs-lookup"><span data-stu-id="68925-169">Scenario</span></span>
<span data-ttu-id="68925-170">Nesta seção, descreveremos um cenário que envolve uma estratégia de backup personalizada para discos de máquina virtual usando instantâneos.</span><span class="sxs-lookup"><span data-stu-id="68925-170">In this section we will describe a scenario that involves a custom backup strategy for virtual machine disks using snapshots.</span></span>

<span data-ttu-id="68925-171">Considere uma VM do Azure da série DS com um disco P30 de armazenamento premium anexado.</span><span class="sxs-lookup"><span data-stu-id="68925-171">Consider a DS-series Azure VM with a premium storage P30 disk attached.</span></span> <span data-ttu-id="68925-172">disco Olá P30 chamado *mypremiumdisk* é armazenado em uma conta de armazenamento premium denominada *mypremiumaccount*.</span><span class="sxs-lookup"><span data-stu-id="68925-172">hello P30 disk called *mypremiumdisk* is stored in a premium storage account called *mypremiumaccount*.</span></span> <span data-ttu-id="68925-173">Uma conta de armazenamento padrão chamado *mybackupstdaccount* será usado para armazenar o backup de saudação do *mypremiumdisk*.</span><span class="sxs-lookup"><span data-stu-id="68925-173">A standard storage account called *mybackupstdaccount* will be used for storing hello backup of *mypremiumdisk*.</span></span> <span data-ttu-id="68925-174">Gostaríamos tookeep um instantâneo de *mypremiumdisk* cada 12 horas.</span><span class="sxs-lookup"><span data-stu-id="68925-174">We would like tookeep a snapshot of *mypremiumdisk* every 12 hours.</span></span>

<span data-ttu-id="68925-175">toolearn sobre a criação de conta de armazenamento e discos, consulte muito[contas de armazenamento do Azure sobre](storage-create-storage-account.md).</span><span class="sxs-lookup"><span data-stu-id="68925-175">toolearn about creating storage account and disks, refer too[About Azure storage accounts](storage-create-storage-account.md).</span></span>

<span data-ttu-id="68925-176">toolearn sobre como fazer backup de máquinas virtuais do Azure, consulte muito[backups de VM do Azure planejar](../backup/backup-azure-vms-introduction.md).</span><span class="sxs-lookup"><span data-stu-id="68925-176">toolearn about backing up Azure VMs, refer too[Plan Azure VM backups](../backup/backup-azure-vms-introduction.md).</span></span>

## <a name="steps-toomaintain-backups-of-a-disk-using-incremental-snapshots"></a><span data-ttu-id="68925-177">Backups de toomaintain de etapas de um disco usando instantâneos incrementais</span><span class="sxs-lookup"><span data-stu-id="68925-177">Steps toomaintain backups of a disk using incremental snapshots</span></span>
<span data-ttu-id="68925-178">Olá etapas descritas abaixo irá tirar instantâneos de *mypremiumdisk* e manter backups de saudação em *mybackupstdaccount*.</span><span class="sxs-lookup"><span data-stu-id="68925-178">hello steps described below will take snapshots of *mypremiumdisk* and maintain hello backups in *mybackupstdaccount*.</span></span> <span data-ttu-id="68925-179">Olá backup será um blob de página padrão chamado *mybackupstdpageblob*.</span><span class="sxs-lookup"><span data-stu-id="68925-179">hello backup will be a standard page blob called *mybackupstdpageblob*.</span></span> <span data-ttu-id="68925-180">Olá blob de página de backup sempre refletirá Olá mesmo estado como último instantâneo de saudação do *mypremiumdisk*.</span><span class="sxs-lookup"><span data-stu-id="68925-180">hello backup page blob will always reflect hello same state as hello last snapshot of *mypremiumdisk*.</span></span>

1. <span data-ttu-id="68925-181">Primeiro, crie o blob de página backup Olá para o disco de armazenamento premium.</span><span class="sxs-lookup"><span data-stu-id="68925-181">First, create hello backup page blob for your premium storage disk.</span></span> <span data-ttu-id="68925-182">toodo, tirar um instantâneo da *mypremiumdisk* chamado *mypremiumdisk_ss1*.</span><span class="sxs-lookup"><span data-stu-id="68925-182">toodo this, take a snapshot of *mypremiumdisk* called *mypremiumdisk_ss1*.</span></span>
2. <span data-ttu-id="68925-183">Copie esse Instantâneo toomybackupstdaccount como um blob de página chamado *mybackupstdpageblob*.</span><span class="sxs-lookup"><span data-stu-id="68925-183">Copy this snapshot toomybackupstdaccount as a page blob called *mybackupstdpageblob*.</span></span>
3. <span data-ttu-id="68925-184">Faça um instantâneo de *mybackupstdpageblob* chamado *mybackupstdpageblob_ss1* usando [Blob de Instantâneo](https://msdn.microsoft.com/library/azure/ee691971.aspx) e armazene-o em *mybackupstdaccount*.</span><span class="sxs-lookup"><span data-stu-id="68925-184">Take a snapshot of *mybackupstdpageblob* called *mybackupstdpageblob_ss1*, using [Snapshot Blob](https://msdn.microsoft.com/library/azure/ee691971.aspx) and store it in *mybackupstdaccount*.</span></span>
4. <span data-ttu-id="68925-185">Durante a janela de backup Olá, crie outro instantâneo do *mypremiumdisk*, digamos que *mypremiumdisk_ss2*e armazená-la na *mypremiumaccount*.</span><span class="sxs-lookup"><span data-stu-id="68925-185">During hello backup window, create another snapshot of *mypremiumdisk*, say *mypremiumdisk_ss2*, and store it in *mypremiumaccount*.</span></span>
5. <span data-ttu-id="68925-186">Obter alterações incrementais de saudação entre os instantâneos de saudação dois *mypremiumdisk_ss2* e *mypremiumdisk_ss1*usando [GetPageRanges](https://msdn.microsoft.com/library/azure/ee691973.aspx) em  *mypremiumdisk_ss2* com **prevsnapshot** parâmetro definido de carimbo de hora toohello *mypremiumdisk_ss1*.</span><span class="sxs-lookup"><span data-stu-id="68925-186">Get hello incremental changes between hello two snapshots, *mypremiumdisk_ss2* and *mypremiumdisk_ss1*, using [GetPageRanges](https://msdn.microsoft.com/library/azure/ee691973.aspx) on *mypremiumdisk_ss2* with **prevsnapshot** parameter set toohello timestamp of *mypremiumdisk_ss1*.</span></span> <span data-ttu-id="68925-187">Gravação de blob de página de backup de toohello essas alterações incrementais *mybackupstdpageblob* na *mybackupstdaccount*.</span><span class="sxs-lookup"><span data-stu-id="68925-187">Write these incremental changes toohello backup page blob *mybackupstdpageblob* in *mybackupstdaccount*.</span></span> <span data-ttu-id="68925-188">Se houver intervalos excluídos em alterações incrementais hello, deve ser limpo de blob de página backup hello.</span><span class="sxs-lookup"><span data-stu-id="68925-188">If there are deleted ranges in hello incremental changes, they must be cleared from hello backup page blob.</span></span> <span data-ttu-id="68925-189">Use [PutPage](https://msdn.microsoft.com/library/azure/ee691975.aspx) blob de página de backup de toohello toowrite alterações incrementais.</span><span class="sxs-lookup"><span data-stu-id="68925-189">Use [PutPage](https://msdn.microsoft.com/library/azure/ee691975.aspx) toowrite incremental changes toohello backup page blob.</span></span>
6. <span data-ttu-id="68925-190">Tirar um instantâneo de blob de página backup Olá *mybackupstdpageblob*, chamado *mybackupstdpageblob_ss2*.</span><span class="sxs-lookup"><span data-stu-id="68925-190">Take a snapshot of hello backup page blob *mybackupstdpageblob*, called *mybackupstdpageblob_ss2*.</span></span> <span data-ttu-id="68925-191">Excluir o instantâneo anterior Olá *mypremiumdisk_ss1* da conta de armazenamento premium.</span><span class="sxs-lookup"><span data-stu-id="68925-191">Delete hello previous snapshot *mypremiumdisk_ss1* from premium storage account.</span></span>
7. <span data-ttu-id="68925-192">Repita as etapas 4 a 6 em cada janela de backup.</span><span class="sxs-lookup"><span data-stu-id="68925-192">Repeat steps 4-6 every backup window.</span></span> <span data-ttu-id="68925-193">Dessa forma, você pode manter backups de *mypremiumdisk* em uma conta de armazenamento padrão.</span><span class="sxs-lookup"><span data-stu-id="68925-193">In this way, you can maintain backups of *mypremiumdisk* in a standard storage account.</span></span>

![Fazer backup de disco usando instantâneos incrementais](./media/storage-incremental-snapshots/storage-incremental-snapshots-1.png)

## <a name="steps-toorestore-a-disk-from-snapshots"></a><span data-ttu-id="68925-195">Etapas toorestore um disco de instantâneos</span><span class="sxs-lookup"><span data-stu-id="68925-195">Steps toorestore a disk from snapshots</span></span>
<span data-ttu-id="68925-196">Olá etapas descritas abaixo irá restaurar disco premium, *mypremiumdisk* tooan instantâneo anterior da conta de armazenamento de backup Olá *mybackupstdaccount*.</span><span class="sxs-lookup"><span data-stu-id="68925-196">hello steps described below will restore premium disk, *mypremiumdisk* tooan earlier snapshot from hello backup storage account *mybackupstdaccount*.</span></span>

1. <span data-ttu-id="68925-197">Identifica Olá ponto no tempo que você deseja que o disco de premium Olá toorestore para.</span><span class="sxs-lookup"><span data-stu-id="68925-197">Identify hello point in time you wish toorestore hello premium disk to.</span></span> <span data-ttu-id="68925-198">Digamos que é snapshot *mybackupstdpageblob_ss2*, que é armazenado na conta de armazenamento de backup Olá *mybackupstdaccount*.</span><span class="sxs-lookup"><span data-stu-id="68925-198">Let's say that is snapshot *mybackupstdpageblob_ss2*, which is stored in hello backup storage account *mybackupstdaccount*.</span></span>
2. <span data-ttu-id="68925-199">Em mybackupstdaccount, promover o instantâneo Olá *mybackupstdpageblob_ss2* como novo blob de página de base backup Olá *mybackupstdpageblobrestored*.</span><span class="sxs-lookup"><span data-stu-id="68925-199">In mybackupstdaccount, promote hello snapshot *mybackupstdpageblob_ss2* as hello new backup base page blob *mybackupstdpageblobrestored*.</span></span>
3. <span data-ttu-id="68925-200">Faça um instantâneo do blob de páginas de backup denominado *mybackupstdpageblobrestored_ss1*.</span><span class="sxs-lookup"><span data-stu-id="68925-200">Take a snapshot of this restored backup page blob, called *mybackupstdpageblobrestored_ss1*.</span></span>
4. <span data-ttu-id="68925-201">Cópia de blob de página de Olá restaurado *mybackupstdpageblobrestored* de *mybackupstdaccount* muito*mypremiumaccount* como o novo disco de premium Olá  *mypremiumdiskrestored*.</span><span class="sxs-lookup"><span data-stu-id="68925-201">Copy hello restored page blob *mybackupstdpageblobrestored* from *mybackupstdaccount* too*mypremiumaccount* as hello new premium disk *mypremiumdiskrestored*.</span></span>
5. <span data-ttu-id="68925-202">Tirar um instantâneo do *mypremiumdiskrestored*, chamado *mypremiumdiskrestored_ss1* para fazer backups incrementais futuros.</span><span class="sxs-lookup"><span data-stu-id="68925-202">Take a snapshot of *mypremiumdiskrestored*, called *mypremiumdiskrestored_ss1* for making future incremental backups.</span></span>
6. <span data-ttu-id="68925-203">Ponto de série Olá DS toohello restaurado o disco de VM *mypremiumdiskrestored* e desanexar Olá antigo *mypremiumdisk* de saudação VM.</span><span class="sxs-lookup"><span data-stu-id="68925-203">Point hello DS series VM toohello restored disk *mypremiumdiskrestored* and detach hello old *mypremiumdisk* from hello VM.</span></span>
7. <span data-ttu-id="68925-204">Iniciar processo de Backup Olá descrito na seção anterior para disco Olá restaurado *mypremiumdiskrestored*, usando Olá *mybackupstdpageblobrestored* como blob de página backup hello.</span><span class="sxs-lookup"><span data-stu-id="68925-204">Begin hello Backup process described in previous section for hello restored disk *mypremiumdiskrestored*, using hello *mybackupstdpageblobrestored* as hello backup page blob.</span></span>

![Restaurar disco por meio de instantâneos](./media/storage-incremental-snapshots/storage-incremental-snapshots-2.png)

## <a name="next-steps"></a><span data-ttu-id="68925-206">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="68925-206">Next Steps</span></span>
<span data-ttu-id="68925-207">Saiba mais sobre como criar instantâneos de um blob e planejar sua infraestrutura de backup de VM usando Olá links abaixo.</span><span class="sxs-lookup"><span data-stu-id="68925-207">Learn more about creating snapshots of a blob and planning your VM backup infrastructure using hello links below.</span></span>

* [<span data-ttu-id="68925-208">Criando um instantâneo de um Blob</span><span class="sxs-lookup"><span data-stu-id="68925-208">Creating a Snapshot of a Blob</span></span>](https://msdn.microsoft.com/library/azure/hh488361.aspx)
* [<span data-ttu-id="68925-209">Planejar sua Infraestrutura de backup de VM</span><span class="sxs-lookup"><span data-stu-id="68925-209">Plan your VM Backup Infrastructure</span></span>](../backup/backup-azure-vms-introduction.md)

