---
title: aaaUsing compartilhado (SAS) de assinaturas de acesso no armazenamento do Azure | Microsoft Docs
description: Saiba toouse compartilhado acesso assinaturas (SAS) toodelegate acesso tooAzure recursos de armazenamento, incluindo blobs, filas, tabelas e arquivos.
services: storage
documentationcenter: 
author: mmacy
manager: timlt
editor: tysonn
ms.assetid: 46fd99d7-36b3-4283-81e3-f214b29f1152
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 04/18/2017
ms.author: marsma
ms.openlocfilehash: 53e06c78fbfdaa5fd209add719995ef2a6bc8f61
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="using-shared-access-signatures-sas"></a><span data-ttu-id="51c2f-103">Usando SAS (Assinaturas de Acesso Compartilhado)</span><span class="sxs-lookup"><span data-stu-id="51c2f-103">Using shared access signatures (SAS)</span></span>

<span data-ttu-id="51c2f-104">Uma assinatura de acesso compartilhado (SAS) fornece um tooobjects de acesso do modo toogrant limitado em sua conta de armazenamento tooother clientes, sem expor sua chave de conta.</span><span class="sxs-lookup"><span data-stu-id="51c2f-104">A shared access signature (SAS) provides you with a way toogrant limited access tooobjects in your storage account tooother clients, without exposing your account key.</span></span> <span data-ttu-id="51c2f-105">Neste artigo, nós fornecem uma visão geral do modelo SAS hello, analisar as práticas recomendadas SAS e ver alguns exemplos.</span><span class="sxs-lookup"><span data-stu-id="51c2f-105">In this article, we provide an overview of hello SAS model, review SAS best practices, and look at some examples.</span></span>

<span data-ttu-id="51c2f-106">Para exemplos de código adicionais usando a SAS além daquelas apresentadas aqui, consulte [guia de Introdução ao armazenamento de BLOBs do Azure no .NET](https://azure.microsoft.com/documentation/samples/storage-blob-dotnet-getting-started/) e outros exemplos disponíveis em Olá [exemplos de código do Azure](https://azure.microsoft.com/documentation/samples/?service=storage) biblioteca.</span><span class="sxs-lookup"><span data-stu-id="51c2f-106">For additional code examples using SAS beyond those presented here, see [Getting Started with Azure Blob Storage in .NET](https://azure.microsoft.com/documentation/samples/storage-blob-dotnet-getting-started/) and other samples available in hello [Azure Code Samples](https://azure.microsoft.com/documentation/samples/?service=storage) library.</span></span> <span data-ttu-id="51c2f-107">Você pode baixar aplicativos de exemplo hello e executá-los ou procurar Olá código no GitHub.</span><span class="sxs-lookup"><span data-stu-id="51c2f-107">You can download hello sample applications and run them, or browse hello code on GitHub.</span></span>

## <a name="what-is-a-shared-access-signature"></a><span data-ttu-id="51c2f-108">O que é uma assinatura de acesso compartilhado?</span><span class="sxs-lookup"><span data-stu-id="51c2f-108">What is a shared access signature?</span></span>
<span data-ttu-id="51c2f-109">Uma assinatura de acesso compartilhado fornece acesso delegado tooresources na sua conta de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="51c2f-109">A shared access signature provides delegated access tooresources in your storage account.</span></span> <span data-ttu-id="51c2f-110">Com uma SAS, você pode conceder a clientes acessam tooresources na sua conta de armazenamento sem compartilhar suas chaves de conta.</span><span class="sxs-lookup"><span data-stu-id="51c2f-110">With a SAS, you can grant clients access tooresources in your storage account, without sharing your account keys.</span></span> <span data-ttu-id="51c2f-111">Este é o ponto-chave saudação do uso de assinaturas de acesso compartilhado em seus aplicativos – uma SAS é uma maneira segura tooshare seus recursos de armazenamento sem comprometer as chaves da conta.</span><span class="sxs-lookup"><span data-stu-id="51c2f-111">This is hello key point of using shared access signatures in your applications--a SAS is a secure way tooshare your storage resources without compromising your account keys.</span></span>

[!INCLUDE [storage-account-key-note-include](../../includes/storage-account-key-note-include.md)]

<span data-ttu-id="51c2f-112">Uma SAS fornece controle granular sobre o tipo de saudação do access que conceder tooclients com hello SAS, incluindo:</span><span class="sxs-lookup"><span data-stu-id="51c2f-112">A SAS gives you granular control over hello type of access you grant tooclients who have hello SAS, including:</span></span>

* <span data-ttu-id="51c2f-113">intervalo de saudação sobre quais Olá SAS é válido, incluindo hora de início do hello e tempo de expiração de saudação.</span><span class="sxs-lookup"><span data-stu-id="51c2f-113">hello interval over which hello SAS is valid, including hello start time and hello expiry time.</span></span>
* <span data-ttu-id="51c2f-114">Olá permissões por Olá SAS.</span><span class="sxs-lookup"><span data-stu-id="51c2f-114">hello permissions granted by hello SAS.</span></span> <span data-ttu-id="51c2f-115">Por exemplo, um SAS para um blob pode conceder ler e gravar permissões toothat blob, mas não excluir permissões.</span><span class="sxs-lookup"><span data-stu-id="51c2f-115">For example, a SAS for a blob might grant read and write permissions toothat blob, but not delete permissions.</span></span>
* <span data-ttu-id="51c2f-116">Um endereço IP opcional ou intervalo de endereços IP dos quais o armazenamento do Azure aceitará Olá SAS.</span><span class="sxs-lookup"><span data-stu-id="51c2f-116">An optional IP address or range of IP addresses from which Azure Storage will accept hello SAS.</span></span> <span data-ttu-id="51c2f-117">Por exemplo, você pode especificar um intervalo de endereços IP que pertencem a organização tooyour.</span><span class="sxs-lookup"><span data-stu-id="51c2f-117">For example, you might specify a range of IP addresses belonging tooyour organization.</span></span>
* <span data-ttu-id="51c2f-118">protocolo de saudação durante o qual o armazenamento do Azure aceitará Olá SAS.</span><span class="sxs-lookup"><span data-stu-id="51c2f-118">hello protocol over which Azure Storage will accept hello SAS.</span></span> <span data-ttu-id="51c2f-119">Você pode usar este parâmetro opcional toorestrict acesso tooclients que usando HTTPS.</span><span class="sxs-lookup"><span data-stu-id="51c2f-119">You can use this optional parameter toorestrict access tooclients using HTTPS.</span></span>

## <a name="when-should-you-use-a-shared-access-signature"></a><span data-ttu-id="51c2f-120">Quando você deve usar uma assinatura de acesso compartilhado?</span><span class="sxs-lookup"><span data-stu-id="51c2f-120">When should you use a shared access signature?</span></span>
<span data-ttu-id="51c2f-121">Você pode usar uma SAS quando desejar tooprovide acesso tooresources no seu cliente de tooany de conta de armazenamento que não possui chaves de acesso da sua conta de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="51c2f-121">You can use a SAS when you want tooprovide access tooresources in your storage account tooany client not possessing your storage account's access keys.</span></span> <span data-ttu-id="51c2f-122">Sua conta de armazenamento inclui tanto uma chave de acesso primária e secundária, que conceder a conta de acesso administrativo a tooyour e todos os recursos nele.</span><span class="sxs-lookup"><span data-stu-id="51c2f-122">Your storage account includes both a primary and secondary access key, both of which grant administrative access tooyour account, and all resources within it.</span></span> <span data-ttu-id="51c2f-123">Exposição de qualquer uma dessas chaves abre sua possibilidade de toohello de conta de uso mal-intencionado ou negligente.</span><span class="sxs-lookup"><span data-stu-id="51c2f-123">Exposing either of these keys opens your account toohello possibility of malicious or negligent use.</span></span> <span data-ttu-id="51c2f-124">Assinaturas de acesso compartilhado fornecem uma alternativa segura que permite que os clientes tooread, gravação e exclusão de dados em sua conta de armazenamento de acordo com as permissões de toohello concedido explicitamente e sem necessidade de uma chave de conta.</span><span class="sxs-lookup"><span data-stu-id="51c2f-124">Shared access signatures provide a safe alternative that allows clients tooread, write, and delete data in your storage account according toohello permissions you've explicitly granted, and without need for an account key.</span></span>

<span data-ttu-id="51c2f-125">Um cenário comum em que uma SAS é útil é um serviço em que os usuários ler e gravar sua própria conta de armazenamento do tooyour de dados.</span><span class="sxs-lookup"><span data-stu-id="51c2f-125">A common scenario where a SAS is useful is a service where users read and write their own data tooyour storage account.</span></span> <span data-ttu-id="51c2f-126">Em um cenário em que uma conta de armazenamento armazena dados do usuário, há dois padrões de design comuns:</span><span class="sxs-lookup"><span data-stu-id="51c2f-126">In a scenario where a storage account stores user data, there are two typical design patterns:</span></span>

1. <span data-ttu-id="51c2f-127">Os clientes carregam e baixam dados por meio de um serviço de proxy front-end, que executa a autenticação.</span><span class="sxs-lookup"><span data-stu-id="51c2f-127">Clients upload and download data via a front-end proxy service, which performs authentication.</span></span> <span data-ttu-id="51c2f-128">Esse serviço de proxy de front-end tem a vantagem de saudação de permitir que a validação de regras de negócio, mas para grandes quantidades de dados ou alto volume de transações, criando um serviço que pode ser dimensionado toomatch demanda pode ser difícil ou cara.</span><span class="sxs-lookup"><span data-stu-id="51c2f-128">This front-end proxy service has hello advantage of allowing validation of business rules, but for large amounts of data or high-volume transactions, creating a service that can scale toomatch demand may be expensive or difficult.</span></span>

  ![Diagrama do cenário: serviço de proxy front-end][sas-storage-fe-proxy-service]

1. <span data-ttu-id="51c2f-130">Um serviço simples autentica o cliente Olá conforme necessário e, em seguida, gera um SAS.</span><span class="sxs-lookup"><span data-stu-id="51c2f-130">A lightweight service authenticates hello client as needed and then generates a SAS.</span></span> <span data-ttu-id="51c2f-131">Depois que o cliente Olá recebe Olá SAS, eles podem acessar recursos da conta de armazenamento diretamente com permissões de saudação definidas por Olá SAS e para o intervalo de saudação permitido pelo Olá SAS.</span><span class="sxs-lookup"><span data-stu-id="51c2f-131">Once hello client receives hello SAS, they can access storage account resources directly with hello permissions defined by hello SAS and for hello interval allowed by hello SAS.</span></span> <span data-ttu-id="51c2f-132">Olá SAS reduz a necessidade de saudação para roteamento de todos os dados por meio do serviço de proxy de front-end de saudação.</span><span class="sxs-lookup"><span data-stu-id="51c2f-132">hello SAS mitigates hello need for routing all data through hello front-end proxy service.</span></span>

  ![Diagrama do cenário: serviço do provedor de SAS][sas-storage-provider-service]

<span data-ttu-id="51c2f-134">Muitos serviços reais podem usar uma combinação dessas duas abordagens.</span><span class="sxs-lookup"><span data-stu-id="51c2f-134">Many real-world services may use a hybrid of these two approaches.</span></span> <span data-ttu-id="51c2f-135">Por exemplo, alguns dados podem processados e validados por meio do proxy de front-end hello, enquanto outros dados é salvo e/ou ler diretamente usando a SAS.</span><span class="sxs-lookup"><span data-stu-id="51c2f-135">For example, some data might be processed and validated via hello front-end proxy, while other data is saved and/or read directly using SAS.</span></span>

<span data-ttu-id="51c2f-136">Além disso, você precisará toouse um objeto de fonte de saudação tooauthenticate SAS em uma operação de cópia em determinados cenários:</span><span class="sxs-lookup"><span data-stu-id="51c2f-136">Additionally, you will need toouse a SAS tooauthenticate hello source object in a copy operation in certain scenarios:</span></span>

* <span data-ttu-id="51c2f-137">Quando você copia um blob de tooanother de blob que reside em uma conta de armazenamento diferente, você deve usar um blob de origem SAS tooauthenticate hello.</span><span class="sxs-lookup"><span data-stu-id="51c2f-137">When you copy a blob tooanother blob that resides in a different storage account, you must use a SAS tooauthenticate hello source blob.</span></span> <span data-ttu-id="51c2f-138">Opcionalmente, você pode usar um SAS tooauthenticate Olá blob de destino também.</span><span class="sxs-lookup"><span data-stu-id="51c2f-138">You can optionally use a SAS tooauthenticate hello destination blob as well.</span></span>
* <span data-ttu-id="51c2f-139">Quando você copia um arquivo de tooanother que reside em uma conta de armazenamento diferente, você deve usar um arquivo de origem do SAS tooauthenticate hello.</span><span class="sxs-lookup"><span data-stu-id="51c2f-139">When you copy a file tooanother file that resides in a different storage account, you must use a SAS tooauthenticate hello source file.</span></span> <span data-ttu-id="51c2f-140">Opcionalmente, você pode usar um SAS tooauthenticate Olá arquivo de destino também.</span><span class="sxs-lookup"><span data-stu-id="51c2f-140">You can optionally use a SAS tooauthenticate hello destination file as well.</span></span>
* <span data-ttu-id="51c2f-141">Quando você copia um arquivo de blob tooa ou um blob de tooa de arquivo, você deve usar um objeto de origem do SAS tooauthenticate hello, mesmo se os objetos de origem e destino Olá residem dentro de saudação mesma conta de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="51c2f-141">When you copy a blob tooa file, or a file tooa blob, you must use a SAS tooauthenticate hello source object, even if hello source and destination objects reside within hello same storage account.</span></span>

## <a name="types-of-shared-access-signatures"></a><span data-ttu-id="51c2f-142">Tipos de assinaturas de Acesso compartilhado.</span><span class="sxs-lookup"><span data-stu-id="51c2f-142">Types of shared access signatures</span></span>
<span data-ttu-id="51c2f-143">É possível criar dois tipos de assinaturas de acesso compartilhado:</span><span class="sxs-lookup"><span data-stu-id="51c2f-143">You can create two types of shared access signatures:</span></span>

* <span data-ttu-id="51c2f-144">**SAS de Serviço.**</span><span class="sxs-lookup"><span data-stu-id="51c2f-144">**Service SAS.**</span></span> <span data-ttu-id="51c2f-145">delegados SAS do serviço Olá acessam o recurso de tooa em apenas um dos serviços de armazenamento Olá: Olá serviço Blob, fila, tabela ou arquivo.</span><span class="sxs-lookup"><span data-stu-id="51c2f-145">hello service SAS delegates access tooa resource in just one of hello storage services: hello Blob, Queue, Table, or File service.</span></span> <span data-ttu-id="51c2f-146">Consulte [construindo uma SAS do serviço](https://msdn.microsoft.com/library/dn140255.aspx) e [exemplos de SAS do serviço](https://msdn.microsoft.com/library/dn140256.aspx) para obter informações detalhadas sobre como construir o token SAS do serviço de saudação.</span><span class="sxs-lookup"><span data-stu-id="51c2f-146">See [Constructing a Service SAS](https://msdn.microsoft.com/library/dn140255.aspx) and [Service SAS Examples](https://msdn.microsoft.com/library/dn140256.aspx) for in-depth information about constructing hello service SAS token.</span></span>
* <span data-ttu-id="51c2f-147">**SAS de Conta.**</span><span class="sxs-lookup"><span data-stu-id="51c2f-147">**Account SAS.**</span></span> <span data-ttu-id="51c2f-148">delegados de SAS conta Olá acessar tooresources em um ou mais dos serviços de armazenamento de saudação.</span><span class="sxs-lookup"><span data-stu-id="51c2f-148">hello account SAS delegates access tooresources in one or more of hello storage services.</span></span> <span data-ttu-id="51c2f-149">Todas as operações de saudação disponíveis por meio de um serviço SAS também estão disponíveis por meio de uma conta de SAS.</span><span class="sxs-lookup"><span data-stu-id="51c2f-149">All of hello operations available via a service SAS are also available via an account SAS.</span></span> <span data-ttu-id="51c2f-150">Além disso, com a conta de saudação SAS, você pode delegar acesso toooperations que se aplicam a tooa fornecido como o serviço, **propriedades do serviço de Get/Set** e **obter status do serviço**. Você também pode delegar acesso tooread, gravação e operações de exclusão em contêineres de blob, tabelas, filas e compartilhamentos de arquivos que não são permitidos com um serviço de SAS.</span><span class="sxs-lookup"><span data-stu-id="51c2f-150">Additionally, with hello account SAS, you can delegate access toooperations that apply tooa given service, such as **Get/Set Service Properties** and **Get Service Stats**. You can also delegate access tooread, write, and delete operations on blob containers, tables, queues, and file shares that are not permitted with a service SAS.</span></span> <span data-ttu-id="51c2f-151">Consulte [construindo uma SAS da conta](https://msdn.microsoft.com/library/mt584140.aspx) para obter informações detalhadas sobre como construir o token SAS Olá conta.</span><span class="sxs-lookup"><span data-stu-id="51c2f-151">See [Constructing an Account SAS](https://msdn.microsoft.com/library/mt584140.aspx) for in-depth information about constructing hello account SAS token.</span></span>

## <a name="how-a-shared-access-signature-works"></a><span data-ttu-id="51c2f-152">Como funciona uma assinatura de acesso compartilhado</span><span class="sxs-lookup"><span data-stu-id="51c2f-152">How a shared access signature works</span></span>
<span data-ttu-id="51c2f-153">Uma assinatura de acesso compartilhado é um URI assinado que aponta tooone ou mais recursos de armazenamento e inclui um token que contém um conjunto especial de parâmetros de consulta.</span><span class="sxs-lookup"><span data-stu-id="51c2f-153">A shared access signature is a signed URI that points tooone or more storage resources and includes a token that contains a special set of query parameters.</span></span> <span data-ttu-id="51c2f-154">token de saudação indica como os recursos de saudação podem ser acessados pelo cliente hello.</span><span class="sxs-lookup"><span data-stu-id="51c2f-154">hello token indicates how hello resources may be accessed by hello client.</span></span> <span data-ttu-id="51c2f-155">Um dos parâmetros de consulta hello, Olá assinatura, é construído a partir de parâmetros de SAS hello e assinado com a chave da conta hello.</span><span class="sxs-lookup"><span data-stu-id="51c2f-155">One of hello query parameters, hello signature, is constructed from hello SAS parameters and signed with hello account key.</span></span> <span data-ttu-id="51c2f-156">Esta assinatura é usada pelo Olá tooauthenticate de armazenamento do Azure SAS.</span><span class="sxs-lookup"><span data-stu-id="51c2f-156">This signature is used by Azure Storage tooauthenticate hello SAS.</span></span>

<span data-ttu-id="51c2f-157">Aqui está um exemplo de um URI de SAS, URI de recurso Olá mostrando e token SAS hello:</span><span class="sxs-lookup"><span data-stu-id="51c2f-157">Here's an example of a SAS URI, showing hello resource URI and hello SAS token:</span></span>

![Componentes de um URI de SAS][sas-storage-uri]

<span data-ttu-id="51c2f-159">Olá, token SAS é uma cadeia de caracteres que você gera Olá *cliente* lado (consulte Olá [exemplos SAS](#sas-examples) seção para obter exemplos de código).</span><span class="sxs-lookup"><span data-stu-id="51c2f-159">hello SAS token is a string you generate on hello *client* side (see hello [SAS examples](#sas-examples) section for code examples).</span></span> <span data-ttu-id="51c2f-160">Um token SAS que gerar com biblioteca de cliente de armazenamento hello, por exemplo, não será controlado pelo armazenamento do Azure de qualquer forma.</span><span class="sxs-lookup"><span data-stu-id="51c2f-160">A SAS token you generate with hello storage client library, for example, is not tracked by Azure Storage in any way.</span></span> <span data-ttu-id="51c2f-161">Você pode criar um número ilimitado de tokens SAS no lado do cliente de saudação.</span><span class="sxs-lookup"><span data-stu-id="51c2f-161">You can create an unlimited number of SAS tokens on hello client side.</span></span>

<span data-ttu-id="51c2f-162">Quando um cliente fornece um tooAzure URI SAS armazenamento como parte de uma solicitação, o serviço de saudação verifica parâmetros de SAS hello e tooverify de assinatura é válida para autenticar a solicitação de saudação.</span><span class="sxs-lookup"><span data-stu-id="51c2f-162">When a client provides a SAS URI tooAzure Storage as part of a request, hello service checks hello SAS parameters and signature tooverify that it is valid for authenticating hello request.</span></span> <span data-ttu-id="51c2f-163">Se o serviço Olá verifica a que assinatura Olá é válida, solicitação de saudação é autenticada.</span><span class="sxs-lookup"><span data-stu-id="51c2f-163">If hello service verifies that hello signature is valid, then hello request is authenticated.</span></span> <span data-ttu-id="51c2f-164">Caso contrário, a solicitação de saudação é recusada com o código de erro 403 (proibido).</span><span class="sxs-lookup"><span data-stu-id="51c2f-164">Otherwise, hello request is declined with error code 403 (Forbidden).</span></span>

## <a name="shared-access-signature-parameters"></a><span data-ttu-id="51c2f-165">Parâmetros de assinatura de acesso compartilhado</span><span class="sxs-lookup"><span data-stu-id="51c2f-165">Shared access signature parameters</span></span>
<span data-ttu-id="51c2f-166">conta Olá SAS e tokens SAS do serviço incluem alguns parâmetros comuns e também levar alguns parâmetros que são diferentes.</span><span class="sxs-lookup"><span data-stu-id="51c2f-166">hello account SAS and service SAS tokens include some common parameters, and also take a few parameters that that are different.</span></span>

### <a name="parameters-common-tooaccount-sas-and-service-sas-tokens"></a><span data-ttu-id="51c2f-167">Parâmetros comuns tooaccount SAS e tokens SAS do serviço</span><span class="sxs-lookup"><span data-stu-id="51c2f-167">Parameters common tooaccount SAS and service SAS tokens</span></span>
* <span data-ttu-id="51c2f-168">**Versão da API** um parâmetro opcional que especifica a solicitação de Olá Olá armazenamento serviço versão toouse tooexecute.</span><span class="sxs-lookup"><span data-stu-id="51c2f-168">**Api version** An optional parameter that specifies hello storage service version toouse tooexecute hello request.</span></span>
* <span data-ttu-id="51c2f-169">**Versão do serviço** um parâmetro obrigatório que especifica a solicitação de Olá Olá armazenamento serviço versão toouse tooauthenticate.</span><span class="sxs-lookup"><span data-stu-id="51c2f-169">**Service version** A required parameter that specifies hello storage service version toouse tooauthenticate hello request.</span></span>
* <span data-ttu-id="51c2f-170">**Hora de início.**</span><span class="sxs-lookup"><span data-stu-id="51c2f-170">**Start time.**</span></span> <span data-ttu-id="51c2f-171">Este é o tempo de saudação na qual Olá SAS se torna válida.</span><span class="sxs-lookup"><span data-stu-id="51c2f-171">This is hello time at which hello SAS becomes valid.</span></span> <span data-ttu-id="51c2f-172">hora de início de saudação para uma assinatura de acesso compartilhado é opcional.</span><span class="sxs-lookup"><span data-stu-id="51c2f-172">hello start time for a shared access signature is optional.</span></span> <span data-ttu-id="51c2f-173">Se uma hora de início for omitida, Olá SAS é imediatamente efetivada.</span><span class="sxs-lookup"><span data-stu-id="51c2f-173">If a start time is omitted, hello SAS is effective immediately.</span></span> <span data-ttu-id="51c2f-174">Olá hora de início deve ser expressa em UTC (Universal Coordenado), com um designador de UTC especial ("Z"), por exemplo `1994-11-05T13:15:30Z`.</span><span class="sxs-lookup"><span data-stu-id="51c2f-174">hello start time must be expressed in UTC (Coordinated Universal Time), with a special UTC designator ("Z"), for example `1994-11-05T13:15:30Z`.</span></span>
* <span data-ttu-id="51c2f-175">**Hora de expiração.**</span><span class="sxs-lookup"><span data-stu-id="51c2f-175">**Expiry time.**</span></span> <span data-ttu-id="51c2f-176">Este é Olá tempo após o qual hello SAS não é mais válido.</span><span class="sxs-lookup"><span data-stu-id="51c2f-176">This is hello time after which hello SAS is no longer valid.</span></span> <span data-ttu-id="51c2f-177">As melhores práticas sugerem que você especifique uma hora de expiração para uma SAS ou associe-a a uma política de acesso armazenada.</span><span class="sxs-lookup"><span data-stu-id="51c2f-177">Best practices recommend that you either specify an expiry time for a SAS, or associate it with a stored access policy.</span></span> <span data-ttu-id="51c2f-178">Olá tempo de expiração deve ser expressa em UTC (Universal Coordenado), com um designador de UTC especial ("Z"), por exemplo `1994-11-05T13:15:30Z` (consulte mais abaixo).</span><span class="sxs-lookup"><span data-stu-id="51c2f-178">hello expiry time must be expressed in UTC (Coordinated Universal Time), with a special UTC designator ("Z"), for example `1994-11-05T13:15:30Z` (see more below).</span></span>
* <span data-ttu-id="51c2f-179">**Permissões.**</span><span class="sxs-lookup"><span data-stu-id="51c2f-179">**Permissions.**</span></span> <span data-ttu-id="51c2f-180">permissões de saudação especificadas em Olá SAS indicam quais operações cliente Olá pode executar em relação a recurso de armazenamento hello usando Olá SAS.</span><span class="sxs-lookup"><span data-stu-id="51c2f-180">hello permissions specified on hello SAS indicate what operations hello client can perform against hello storage resource using hello SAS.</span></span> <span data-ttu-id="51c2f-181">As permissões disponíveis são diferentes entre SAS de conta e de serviço.</span><span class="sxs-lookup"><span data-stu-id="51c2f-181">Available permissions differ for an account SAS and a service SAS.</span></span>
* <span data-ttu-id="51c2f-182">**IP.**</span><span class="sxs-lookup"><span data-stu-id="51c2f-182">**IP.**</span></span> <span data-ttu-id="51c2f-183">Um parâmetro opcional que especifica um endereço IP ou um intervalo de endereços IP fora do Azure (consulte a seção Olá [estado de configuração de sessão de roteamento](../expressroute/expressroute-workflows.md#routing-session-configuration-state) de rota expressa) do que as solicitações tooaccept.</span><span class="sxs-lookup"><span data-stu-id="51c2f-183">An optional parameter that specifies an IP address or a range of IP addresses outside of Azure (see hello section [Routing session configuration state](../expressroute/expressroute-workflows.md#routing-session-configuration-state) for Express Route) from which tooaccept requests.</span></span>
* <span data-ttu-id="51c2f-184">**Protocolo.**</span><span class="sxs-lookup"><span data-stu-id="51c2f-184">**Protocol.**</span></span> <span data-ttu-id="51c2f-185">Um parâmetro opcional que especifica o protocolo de saudação permitido para uma solicitação.</span><span class="sxs-lookup"><span data-stu-id="51c2f-185">An optional parameter that specifies hello protocol permitted for a request.</span></span> <span data-ttu-id="51c2f-186">Os valores possíveis são HTTP e HTTPS (`https,http`), que é valor padrão de hello, ou HTTPS apenas (`https`).</span><span class="sxs-lookup"><span data-stu-id="51c2f-186">Possible values are both HTTPS and HTTP (`https,http`), which is hello default value, or HTTPS only (`https`).</span></span> <span data-ttu-id="51c2f-187">Observe que somente HTTP não é um valor permitido.</span><span class="sxs-lookup"><span data-stu-id="51c2f-187">Note that HTTP only is not a permitted value.</span></span>
* <span data-ttu-id="51c2f-188">**Assinatura.**</span><span class="sxs-lookup"><span data-stu-id="51c2f-188">**Signature.**</span></span> <span data-ttu-id="51c2f-189">Olá assinatura é construída de saudação outros parâmetros especificados como parte de token e, em seguida, criptografado.</span><span class="sxs-lookup"><span data-stu-id="51c2f-189">hello signature is constructed from hello other parameters specified as part token and then encrypted.</span></span> <span data-ttu-id="51c2f-190">Ele usou tooauthenticate Olá SAS.</span><span class="sxs-lookup"><span data-stu-id="51c2f-190">It's used tooauthenticate hello SAS.</span></span>

### <a name="parameters-for-a-service-sas-token"></a><span data-ttu-id="51c2f-191">Parâmetros para um token SAS de serviço</span><span class="sxs-lookup"><span data-stu-id="51c2f-191">Parameters for a service SAS token</span></span>
* <span data-ttu-id="51c2f-192">**Recurso de armazenamento.**</span><span class="sxs-lookup"><span data-stu-id="51c2f-192">**Storage resource.**</span></span> <span data-ttu-id="51c2f-193">Os recursos de armazenamento para os quais é possível delegar acesso com SAS de serviço incluem:</span><span class="sxs-lookup"><span data-stu-id="51c2f-193">Storage resources for which you can delegate access with a service SAS include:</span></span>
  * <span data-ttu-id="51c2f-194">Contêineres e blobs</span><span class="sxs-lookup"><span data-stu-id="51c2f-194">Containers and blobs</span></span>
  * <span data-ttu-id="51c2f-195">Compartilhamentos de arquivos e arquivos</span><span class="sxs-lookup"><span data-stu-id="51c2f-195">File shares and files</span></span>
  * <span data-ttu-id="51c2f-196">Filas</span><span class="sxs-lookup"><span data-stu-id="51c2f-196">Queues</span></span>
  * <span data-ttu-id="51c2f-197">Tabelas e intervalos de entidades de tabela.</span><span class="sxs-lookup"><span data-stu-id="51c2f-197">Tables and ranges of table entities.</span></span>

### <a name="parameters-for-an-account-sas-token"></a><span data-ttu-id="51c2f-198">Parâmetros para um token SAS de conta</span><span class="sxs-lookup"><span data-stu-id="51c2f-198">Parameters for an account SAS token</span></span>
* <span data-ttu-id="51c2f-199">**Serviço ou serviços.**</span><span class="sxs-lookup"><span data-stu-id="51c2f-199">**Service or services.**</span></span> <span data-ttu-id="51c2f-200">Uma conta SAS pode delegar acesso tooone ou mais dos serviços de armazenamento de saudação.</span><span class="sxs-lookup"><span data-stu-id="51c2f-200">An account SAS can delegate access tooone or more of hello storage services.</span></span> <span data-ttu-id="51c2f-201">Por exemplo, você pode criar uma conta SAS delegados acessar toohello serviço de Blob e o arquivo.</span><span class="sxs-lookup"><span data-stu-id="51c2f-201">For example, you can create an account SAS that delegates access toohello Blob and File service.</span></span> <span data-ttu-id="51c2f-202">Ou você pode criar uma SAS delegados acessar tooall quatro serviços (Blob, fila, tabela e arquivo).</span><span class="sxs-lookup"><span data-stu-id="51c2f-202">Or you can create a SAS that delegates access tooall four services (Blob, Queue, Table, and File).</span></span>
* <span data-ttu-id="51c2f-203">**Tipos de recurso de armazenamento.**</span><span class="sxs-lookup"><span data-stu-id="51c2f-203">**Storage resource types.**</span></span> <span data-ttu-id="51c2f-204">Aplica-se uma conta SAS tooone ou mais classes de recursos de armazenamento, em vez de um recurso específico.</span><span class="sxs-lookup"><span data-stu-id="51c2f-204">An account SAS applies tooone or more classes of storage resources, rather than a specific resource.</span></span> <span data-ttu-id="51c2f-205">Você pode criar uma conta SAS toodelegate acesso a:</span><span class="sxs-lookup"><span data-stu-id="51c2f-205">You can create an account SAS toodelegate access to:</span></span>
  * <span data-ttu-id="51c2f-206">APIs de nível de serviço, que são chamados no recurso de conta de armazenamento hello.</span><span class="sxs-lookup"><span data-stu-id="51c2f-206">Service-level APIs, which are called against hello storage account resource.</span></span> <span data-ttu-id="51c2f-207">Os exemplos incluem **Obter/Definir Propriedades do Serviço**, **Obter Estatísticas do Serviço** e **Listar Contêineres/Filas/Tabelas/Compartilhamentos**.</span><span class="sxs-lookup"><span data-stu-id="51c2f-207">Examples include **Get/Set Service Properties**, **Get Service Stats**, and **List Containers/Queues/Tables/Shares**.</span></span>
  * <span data-ttu-id="51c2f-208">APIs de nível de contêiner, que são chamados em objetos de contêiner de saudação para cada serviço: tabelas, filas, contêineres de blob e compartilhamentos de arquivos.</span><span class="sxs-lookup"><span data-stu-id="51c2f-208">Container-level APIs, which are called against hello container objects for each service: blob containers, queues, tables, and file shares.</span></span> <span data-ttu-id="51c2f-209">Os exemplos incluem **Criar/Excluir Contêiner**, **Criar/Excluir Fila**, **Criar/Excluir Tabela**, **Criar/Excluir Compartilhamento** e **Listar Blobs/Arquivos e Diretórios**.</span><span class="sxs-lookup"><span data-stu-id="51c2f-209">Examples include **Create/Delete Container**, **Create/Delete Queue**, **Create/Delete Table**, **Create/Delete Share**, and **List Blobs/Files and Directories**.</span></span>
  * <span data-ttu-id="51c2f-210">APIs de nível de objeto, que são chamadas em relação a blobs, mensagens de fila, entidades de tabela e arquivos.</span><span class="sxs-lookup"><span data-stu-id="51c2f-210">Object-level APIs, which are called against blobs, queue messages, table entities, and files.</span></span> <span data-ttu-id="51c2f-211">Por exemplo, **Colocar Blob**, **Consultar Entidade**, **Obter Mensagens** e **Criar Arquivo**.</span><span class="sxs-lookup"><span data-stu-id="51c2f-211">For example, **Put Blob**, **Query Entity**, **Get Messages**, and **Create File**.</span></span>

## <a name="examples-of-sas-uris"></a><span data-ttu-id="51c2f-212">Exemplos de URIs de SAS</span><span class="sxs-lookup"><span data-stu-id="51c2f-212">Examples of SAS URIs</span></span>

### <a name="service-sas-uri-example"></a><span data-ttu-id="51c2f-213">Exemplo de URI de SAS de serviço</span><span class="sxs-lookup"><span data-stu-id="51c2f-213">Service SAS URI example</span></span>

<span data-ttu-id="51c2f-214">Aqui está um exemplo de um serviço de URI de SAS que fornece de leitura e gravação de blob de tooa de permissões.</span><span class="sxs-lookup"><span data-stu-id="51c2f-214">Here is an example of a service SAS URI that provides read and write permissions tooa blob.</span></span> <span data-ttu-id="51c2f-215">tabela Olá divide cada parte da saudação URI toounderstand como contribui toohello SAS:</span><span class="sxs-lookup"><span data-stu-id="51c2f-215">hello table breaks down each part of hello URI toounderstand how it contributes toohello SAS:</span></span>

```
https://myaccount.blob.core.windows.net/sascontainer/sasblob.txt?sv=2015-04-05&st=2015-04-29T22%3A18%3A26Z&se=2015-04-30T02%3A23%3A26Z&sr=b&sp=rw&sip=168.1.5.60-168.1.5.70&spr=https&sig=Z%2FRHIX5Xcg0Mq2rqI3OlWTjEg2tYkboXr1P9ZUXDtkk%3D
```

| <span data-ttu-id="51c2f-216">Nome</span><span class="sxs-lookup"><span data-stu-id="51c2f-216">Name</span></span> | <span data-ttu-id="51c2f-217">Parte SAS</span><span class="sxs-lookup"><span data-stu-id="51c2f-217">SAS portion</span></span> | <span data-ttu-id="51c2f-218">Descrição</span><span class="sxs-lookup"><span data-stu-id="51c2f-218">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="51c2f-219">URI do blob</span><span class="sxs-lookup"><span data-stu-id="51c2f-219">Blob URI</span></span> |`https://myaccount.blob.core.windows.net/sascontainer/sasblob.txt` |<span data-ttu-id="51c2f-220">endereço de saudação do blob hello.</span><span class="sxs-lookup"><span data-stu-id="51c2f-220">hello address of hello blob.</span></span> <span data-ttu-id="51c2f-221">Observe que o uso de HTTPS é altamente recomendável.</span><span class="sxs-lookup"><span data-stu-id="51c2f-221">Note that using HTTPS is highly recommended.</span></span> |
| <span data-ttu-id="51c2f-222">Versão dos serviços de armazenamento</span><span class="sxs-lookup"><span data-stu-id="51c2f-222">Storage services version</span></span> |`sv=2015-04-05` |<span data-ttu-id="51c2f-223">Para serviços de armazenamento versão 2012-02-12 e mais tarde, esse parâmetro indica Olá versão toouse.</span><span class="sxs-lookup"><span data-stu-id="51c2f-223">For storage services version 2012-02-12 and later, this parameter indicates hello version toouse.</span></span> |
| <span data-ttu-id="51c2f-224">Hora de início</span><span class="sxs-lookup"><span data-stu-id="51c2f-224">Start time</span></span> |`st=2015-04-29T22%3A18%3A26Z` |<span data-ttu-id="51c2f-225">Especificado no horário UTC.</span><span class="sxs-lookup"><span data-stu-id="51c2f-225">Specified in UTC time.</span></span> <span data-ttu-id="51c2f-226">Se você quiser Olá SAS toobe válido imediatamente, omita a hora de início da saudação.</span><span class="sxs-lookup"><span data-stu-id="51c2f-226">If you want hello SAS toobe valid immediately, omit hello start time.</span></span> |
| <span data-ttu-id="51c2f-227">Hora de expiração</span><span class="sxs-lookup"><span data-stu-id="51c2f-227">Expiry time</span></span> |`se=2015-04-30T02%3A23%3A26Z` |<span data-ttu-id="51c2f-228">Especificado no horário UTC.</span><span class="sxs-lookup"><span data-stu-id="51c2f-228">Specified in UTC time.</span></span> |
| <span data-ttu-id="51c2f-229">Recurso</span><span class="sxs-lookup"><span data-stu-id="51c2f-229">Resource</span></span> |`sr=b` |<span data-ttu-id="51c2f-230">recurso de saudação é um blob.</span><span class="sxs-lookup"><span data-stu-id="51c2f-230">hello resource is a blob.</span></span> |
| <span data-ttu-id="51c2f-231">Permissões</span><span class="sxs-lookup"><span data-stu-id="51c2f-231">Permissions</span></span> |`sp=rw` |<span data-ttu-id="51c2f-232">permissões de saudação concedidas por Olá SAS incluem Read (r) e gravação (w).</span><span class="sxs-lookup"><span data-stu-id="51c2f-232">hello permissions granted by hello SAS include Read (r) and Write (w).</span></span> |
| <span data-ttu-id="51c2f-233">Intervalo IP</span><span class="sxs-lookup"><span data-stu-id="51c2f-233">IP range</span></span> |`sip=168.1.5.60-168.1.5.70` |<span data-ttu-id="51c2f-234">Olá intervalo de endereços IP do qual uma solicitação será aceita.</span><span class="sxs-lookup"><span data-stu-id="51c2f-234">hello range of IP addresses from which a request will be accepted.</span></span> |
| <span data-ttu-id="51c2f-235">Protocolo</span><span class="sxs-lookup"><span data-stu-id="51c2f-235">Protocol</span></span> |`spr=https` |<span data-ttu-id="51c2f-236">São permitidas somente solicitações usando HTTPS.</span><span class="sxs-lookup"><span data-stu-id="51c2f-236">Only requests using HTTPS are permitted.</span></span> |
| <span data-ttu-id="51c2f-237">Signature</span><span class="sxs-lookup"><span data-stu-id="51c2f-237">Signature</span></span> |`sig=Z%2FRHIX5Xcg0Mq2rqI3OlWTjEg2tYkboXr1P9ZUXDtkk%3D` |<span data-ttu-id="51c2f-238">Usado tooauthenticate blob de toohello de acesso.</span><span class="sxs-lookup"><span data-stu-id="51c2f-238">Used tooauthenticate access toohello blob.</span></span> <span data-ttu-id="51c2f-239">assinatura de saudação é um HMAC computado em uma cadeia de caracteres de entrada e uma chave usando o algoritmo SHA256 de saudação e, em seguida, codificados usando a codificação de Base64.</span><span class="sxs-lookup"><span data-stu-id="51c2f-239">hello signature is an HMAC computed over a string-to-sign and key using hello SHA256 algorithm, and then encoded using Base64 encoding.</span></span> |

### <a name="account-sas-uri-example"></a><span data-ttu-id="51c2f-240">Exemplo de URI de SAS de conta</span><span class="sxs-lookup"><span data-stu-id="51c2f-240">Account SAS URI example</span></span>

<span data-ttu-id="51c2f-241">Aqui está um exemplo de uma conta de SAS que usa Olá mesmo parâmetros comuns no token de saudação.</span><span class="sxs-lookup"><span data-stu-id="51c2f-241">Here is an example of an account SAS that uses hello same common parameters on hello token.</span></span> <span data-ttu-id="51c2f-242">Como esses parâmetros estão descritos acima, eles não serão descritos aqui.</span><span class="sxs-lookup"><span data-stu-id="51c2f-242">Since these parameters are described above, they are not described here.</span></span> <span data-ttu-id="51c2f-243">Apenas os parâmetros de saudação que são específico tooaccount que SAs são descritos na tabela de saudação abaixo.</span><span class="sxs-lookup"><span data-stu-id="51c2f-243">Only hello parameters that are specific tooaccount SAS are described in hello table below.</span></span>

```
https://myaccount.blob.core.windows.net/?restype=service&comp=properties&sv=2015-04-05&ss=bf&srt=s&st=2015-04-29T22%3A18%3A26Z&se=2015-04-30T02%3A23%3A26Z&sr=b&sp=rw&sip=168.1.5.60-168.1.5.70&spr=https&sig=F%6GRVAZ5Cdj2Pw4tgU7IlSTkWgn7bUkkAg8P6HESXwmf%4B
```

| <span data-ttu-id="51c2f-244">Nome</span><span class="sxs-lookup"><span data-stu-id="51c2f-244">Name</span></span> | <span data-ttu-id="51c2f-245">Parte SAS</span><span class="sxs-lookup"><span data-stu-id="51c2f-245">SAS portion</span></span> | <span data-ttu-id="51c2f-246">Descrição</span><span class="sxs-lookup"><span data-stu-id="51c2f-246">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="51c2f-247">URI de recurso</span><span class="sxs-lookup"><span data-stu-id="51c2f-247">Resource URI</span></span> |`https://myaccount.blob.core.windows.net/?restype=service&comp=properties` |<span data-ttu-id="51c2f-248">Olá serviço ponto de extremidade Blob, com parâmetros para obter as propriedades de serviço (quando chamado com GET) ou definindo propriedades de serviço (quando chamado com conjunto).</span><span class="sxs-lookup"><span data-stu-id="51c2f-248">hello Blob service endpoint, with parameters for getting service properties (when called with GET) or setting service properties (when called with SET).</span></span> |
| <span data-ttu-id="51c2f-249">Serviços</span><span class="sxs-lookup"><span data-stu-id="51c2f-249">Services</span></span> |`ss=bf` |<span data-ttu-id="51c2f-250">Olá SAS aplica toohello Blob e serviços de arquivo</span><span class="sxs-lookup"><span data-stu-id="51c2f-250">hello SAS applies toohello Blob and File services</span></span> |
| <span data-ttu-id="51c2f-251">Tipos de recurso</span><span class="sxs-lookup"><span data-stu-id="51c2f-251">Resource types</span></span> |`srt=s` |<span data-ttu-id="51c2f-252">Olá SAS se aplica a operações de tooservice.</span><span class="sxs-lookup"><span data-stu-id="51c2f-252">hello SAS applies tooservice-level operations.</span></span> |
| <span data-ttu-id="51c2f-253">Permissões</span><span class="sxs-lookup"><span data-stu-id="51c2f-253">Permissions</span></span> |`sp=rw` |<span data-ttu-id="51c2f-254">permissões de saudação conceder acesso tooread e operações de gravação.</span><span class="sxs-lookup"><span data-stu-id="51c2f-254">hello permissions grant access tooread and write operations.</span></span> |

<span data-ttu-id="51c2f-255">Considerando que as permissões são restritas toohello de nível de serviço, operações acessíveis com esse SAS são **obter propriedades do serviço Blob** (leitura) e **definir propriedades do serviço Blob** (gravação).</span><span class="sxs-lookup"><span data-stu-id="51c2f-255">Given that permissions are restricted toohello service level, accessible operations with this SAS are **Get Blob Service Properties** (read) and **Set Blob Service Properties** (write).</span></span> <span data-ttu-id="51c2f-256">No entanto, com um URI de recurso diferente, hello mesmo token SAS também pode ser usado toodelegate acesso muito**obter status do serviço Blob** (leitura).</span><span class="sxs-lookup"><span data-stu-id="51c2f-256">However, with a different resource URI, hello same SAS token could also be used toodelegate access too**Get Blob Service Stats** (read).</span></span>

## <a name="controlling-a-sas-with-a-stored-access-policy"></a><span data-ttu-id="51c2f-257">Controlando uma SAS com uma política de acesso armazenada</span><span class="sxs-lookup"><span data-stu-id="51c2f-257">Controlling a SAS with a stored access policy</span></span>
<span data-ttu-id="51c2f-258">Uma assinatura de acesso compartilhado pode assumir uma destas duas formas:</span><span class="sxs-lookup"><span data-stu-id="51c2f-258">A shared access signature can take one of two forms:</span></span>

* <span data-ttu-id="51c2f-259">**SAS ad hoc:** quando você criar um SAS ad hoc, a hora de início de saudação, o tempo de expiração e permissões para Olá SAS são especificadas no hello URI SAS (ou implícita, no caso de Olá onde a hora de início é omitida).</span><span class="sxs-lookup"><span data-stu-id="51c2f-259">**Ad hoc SAS:** When you create an ad hoc SAS, hello start time, expiry time, and permissions for hello SAS are all specified in hello SAS URI (or implied, in hello case where start time is omitted).</span></span> <span data-ttu-id="51c2f-260">Esse tipo de SAS pode ser criada como uma SAS de conta ou de serviço.</span><span class="sxs-lookup"><span data-stu-id="51c2f-260">This type of SAS can be created as an account SAS or a service SAS.</span></span>
* <span data-ttu-id="51c2f-261">**SAS com a política de acesso armazenada:** uma política de acesso armazenada é definido em um contêiner de recursos – um contêiner de blob, tabela, fila, ou arquivo compartilhamento – e pode ser usado toomanage restrições para uma ou mais assinaturas de acesso compartilhado.</span><span class="sxs-lookup"><span data-stu-id="51c2f-261">**SAS with stored access policy:** A stored access policy is defined on a resource container--a blob container, table, queue, or file share--and can be used toomanage constraints for one or more shared access signatures.</span></span> <span data-ttu-id="51c2f-262">Quando você associa uma SAS com uma política de acesso armazenada, Olá SAS herda restrições hello – hora de início da saudação, tempo de expiração e permissões – definidas para a política de acesso Olá armazenado.</span><span class="sxs-lookup"><span data-stu-id="51c2f-262">When you associate a SAS with a stored access policy, hello SAS inherits hello constraints--hello start time, expiry time, and permissions--defined for hello stored access policy.</span></span>

> [!NOTE]
> <span data-ttu-id="51c2f-263">Atualmente, uma SAS de conta deve ser uma SAS ad hoc.</span><span class="sxs-lookup"><span data-stu-id="51c2f-263">Currently, an account SAS must be an ad hoc SAS.</span></span> <span data-ttu-id="51c2f-264">As SAS de conta ainda não dão suporte a políticas de acesso armazenadas.</span><span class="sxs-lookup"><span data-stu-id="51c2f-264">Stored access policies are not yet supported for account SAS.</span></span>

<span data-ttu-id="51c2f-265">Olá diferença entre formulários Olá dois é importante para um cenário de chave: revogação.</span><span class="sxs-lookup"><span data-stu-id="51c2f-265">hello difference between hello two forms is important for one key scenario: revocation.</span></span> <span data-ttu-id="51c2f-266">Como um URI de SAS é uma URL, qualquer pessoa que obtém Olá SAS pode usá-lo, independentemente de quem o criou originalmente.</span><span class="sxs-lookup"><span data-stu-id="51c2f-266">Because a SAS URI is a URL, anyone that obtains hello SAS can use it, regardless of who originally created it.</span></span> <span data-ttu-id="51c2f-267">Se uma SAS é publicada publicamente, ele pode ser usado por qualquer pessoa no Olá, mundo.</span><span class="sxs-lookup"><span data-stu-id="51c2f-267">If a SAS is published publicly, it can be used by anyone in hello world.</span></span> <span data-ttu-id="51c2f-268">Uma SAS concede acesso tooresources tooanyone que possui-lo até que uma das quatro situações ocorra:</span><span class="sxs-lookup"><span data-stu-id="51c2f-268">A SAS grants access tooresources tooanyone possessing it until one of four things happens:</span></span>

1. <span data-ttu-id="51c2f-269">tempo de expiração de saudação especificado em Olá que SAS é atingido.</span><span class="sxs-lookup"><span data-stu-id="51c2f-269">hello expiry time specified on hello SAS is reached.</span></span>
2. <span data-ttu-id="51c2f-270">tempo de expiração de saudação especificado na política de acesso de saudação armazenada referenciada por Olá que SAS é atingido (se uma política de acesso armazenada for referenciada e se ela especifica uma hora de expiração).</span><span class="sxs-lookup"><span data-stu-id="51c2f-270">hello expiry time specified on hello stored access policy referenced by hello SAS is reached (if a stored access policy is referenced, and if it specifies an expiry time).</span></span> <span data-ttu-id="51c2f-271">Isso pode ocorrer porque o intervalo de saudação expira, ou porque você modificou a política de acesso de saudação armazenada com um tempo de expiração em Olá anterior, que é uma maneira toorevoke hello SAS.</span><span class="sxs-lookup"><span data-stu-id="51c2f-271">This can occur either because hello interval elapses, or because you've modified hello stored access policy with an expiry time in hello past, which is one way toorevoke hello SAS.</span></span>
3. <span data-ttu-id="51c2f-272">Olá armazenado referenciada por Olá que SAS é excluído, que é Olá toorevoke de outra maneira SAS de política de acesso.</span><span class="sxs-lookup"><span data-stu-id="51c2f-272">hello stored access policy referenced by hello SAS is deleted, which is another way toorevoke hello SAS.</span></span> <span data-ttu-id="51c2f-273">Observe que se você recriar a política de acesso de saudação armazenada com exatamente Olá SAS existentes de mesmo nome os tokens serão novamente ser válido acordo toohello permissões associadas a essa política de acesso armazenada (supondo que essa hora de expiração Olá em Olá SAS não passou).</span><span class="sxs-lookup"><span data-stu-id="51c2f-273">Note that if you recreate hello stored access policy with exactly hello same name, all existing SAS tokens will again be valid according toohello permissions associated with that stored access policy (assuming that hello expiry time on hello SAS has not passed).</span></span> <span data-ttu-id="51c2f-274">Se você estiver pretendendo toorevoke Olá SAS, ser toouse se um nome diferente se você recriar a política de acesso de saudação com um tempo de expiração em Olá futuras.</span><span class="sxs-lookup"><span data-stu-id="51c2f-274">If you are intending toorevoke hello SAS, be sure toouse a different name if you recreate hello access policy with an expiry time in hello future.</span></span>
4. <span data-ttu-id="51c2f-275">Olá a chave de conta que foi usado toocreate Olá SAS é regenerada.</span><span class="sxs-lookup"><span data-stu-id="51c2f-275">hello account key that was used toocreate hello SAS is regenerated.</span></span> <span data-ttu-id="51c2f-276">Regenerar uma chave de conta fará com que todos os componentes de aplicativo usando essa chave toofail tooauthenticate até que sejam atualizados toouse hello ou outra tecla de conta válida ou Olá conta acabou de ser gerada.</span><span class="sxs-lookup"><span data-stu-id="51c2f-276">Regenerating an account key will cause all application components using that key toofail tooauthenticate until they're updated toouse either hello other valid account key or hello newly regenerated account key.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="51c2f-277">Um URI de assinatura de acesso compartilhado é associado à assinatura de Olá Olá conta chave toocreate usado e Olá associados a política de acesso armazenada (se houver).</span><span class="sxs-lookup"><span data-stu-id="51c2f-277">A shared access signature URI is associated with hello account key used toocreate hello signature, and hello associated stored access policy (if any).</span></span> <span data-ttu-id="51c2f-278">Se nenhuma política de acesso armazenada for especificada, hello toorevoke de maneira somente uma assinatura de acesso compartilhado é toochange Olá conta chave.</span><span class="sxs-lookup"><span data-stu-id="51c2f-278">If no stored access policy is specified, hello only way toorevoke a shared access signature is toochange hello account key.</span></span>

## <a name="authenticating-from-a-client-application-with-a-sas"></a><span data-ttu-id="51c2f-279">Autenticação de um aplicativo cliente com uma SAS</span><span class="sxs-lookup"><span data-stu-id="51c2f-279">Authenticating from a client application with a SAS</span></span>
<span data-ttu-id="51c2f-280">Um cliente que está em posse de um SAS pode usar Olá SAS tooauthenticate uma solicitação em relação a uma conta de armazenamento para o qual não possuem chaves de conta hello.</span><span class="sxs-lookup"><span data-stu-id="51c2f-280">A client who is in possession of a SAS can use hello SAS tooauthenticate a request against a storage account for which they do not possess hello account keys.</span></span> <span data-ttu-id="51c2f-281">Uma SAS pode ser incluída em uma cadeia de conexão ou usada diretamente do construtor apropriado hello ou método.</span><span class="sxs-lookup"><span data-stu-id="51c2f-281">A SAS can be included in a connection string, or used directly from hello appropriate constructor or method.</span></span>

### <a name="using-a-sas-in-a-connection-string"></a><span data-ttu-id="51c2f-282">Usando uma SAS em uma cadeia de conexão</span><span class="sxs-lookup"><span data-stu-id="51c2f-282">Using a SAS in a connection string</span></span>
[!INCLUDE [storage-use-sas-in-connection-string-include](../../includes/storage-use-sas-in-connection-string-include.md)]

### <a name="using-a-sas-in-a-constructor-or-method"></a><span data-ttu-id="51c2f-283">Usar uma SAS em um construtor ou método</span><span class="sxs-lookup"><span data-stu-id="51c2f-283">Using a SAS in a constructor or method</span></span>
<span data-ttu-id="51c2f-284">Vários construtores de biblioteca de cliente de armazenamento do Azure e as sobrecargas do método oferecem um parâmetro SAS, para que você possa autenticar uma solicitação de serviço toohello com uma SAS.</span><span class="sxs-lookup"><span data-stu-id="51c2f-284">Several Azure Storage client library constructors and method overloads offer a SAS parameter, so that you can authenticate a request toohello service with a SAS.</span></span>

<span data-ttu-id="51c2f-285">Por exemplo, aqui um URI de SAS é usado toocreate um blob de blocos de tooa de referência.</span><span class="sxs-lookup"><span data-stu-id="51c2f-285">For example, here a SAS URI is used toocreate a reference tooa block blob.</span></span> <span data-ttu-id="51c2f-286">Olá SAS fornece credenciais de somente Olá necessárias para a solicitação de saudação.</span><span class="sxs-lookup"><span data-stu-id="51c2f-286">hello SAS provides hello only credentials needed for hello request.</span></span> <span data-ttu-id="51c2f-287">referência de blob de bloco Hello, em seguida, é usada para uma operação de gravação:</span><span class="sxs-lookup"><span data-stu-id="51c2f-287">hello block blob reference is then used for a write operation:</span></span>

```csharp
string sasUri = "https://storagesample.blob.core.windows.net/sample-container/" +
    "sampleBlob.txt?sv=2015-07-08&sr=b&sig=39Up9JzHkxhUIhFEjEH9594DJxe7w6cIRCg0V6lCGSo%3D" +
    "&se=2016-10-18T21%3A51%3A37Z&sp=rcw";

CloudBlockBlob blob = new CloudBlockBlob(new Uri(sasUri));

// Create operation: Upload a blob with hello specified name toohello container.
// If hello blob does not exist, it will be created. If it does exist, it will be overwritten.
try
{
    MemoryStream msWrite = new MemoryStream(Encoding.UTF8.GetBytes(blobContent));
    msWrite.Position = 0;
    using (msWrite)
    {
        await blob.UploadFromStreamAsync(msWrite);
    }

    Console.WriteLine("Create operation succeeded for SAS {0}", sasUri);
    Console.WriteLine();
}
catch (StorageException e)
{
    if (e.RequestInformation.HttpStatusCode == 403)
    {
        Console.WriteLine("Create operation failed for SAS {0}", sasUri);
        Console.WriteLine("Additional error information: " + e.Message);
        Console.WriteLine();
    }
    else
    {
        Console.WriteLine(e.Message);
        Console.ReadLine();
        throw;
    }
}

```

## <a name="best-practices-when-using-sas"></a><span data-ttu-id="51c2f-288">Práticas recomendadas ao usar SAS</span><span class="sxs-lookup"><span data-stu-id="51c2f-288">Best practices when using SAS</span></span>
<span data-ttu-id="51c2f-289">Quando você usar assinaturas de acesso compartilhado em seus aplicativos, você precisa toobe ciente dos riscos potenciais dois:</span><span class="sxs-lookup"><span data-stu-id="51c2f-289">When you use shared access signatures in your applications, you need toobe aware of two potential risks:</span></span>

* <span data-ttu-id="51c2f-290">Se ocorrer perda de uma SAS, ela poderá ser usada por qualquer pessoa que a obtiver, o que poderá comprometer a sua conta de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="51c2f-290">If a SAS is leaked, it can be used by anyone who obtains it, which can potentially compromise your storage account.</span></span>
* <span data-ttu-id="51c2f-291">Se uma SAS fornecido expira tooa aplicativo de cliente e aplicativo hello é tooretrieve não é possível uma nova SAS do seu serviço, a funcionalidade do aplicativo hello pode ser prejudicada.</span><span class="sxs-lookup"><span data-stu-id="51c2f-291">If a SAS provided tooa client application expires and hello application is unable tooretrieve a new SAS from your service, then hello application's functionality may be hindered.</span></span>

<span data-ttu-id="51c2f-292">Olá seguintes recomendações para usar assinaturas de acesso compartilhado podem ajudar a reduzir esses riscos:</span><span class="sxs-lookup"><span data-stu-id="51c2f-292">hello following recommendations for using shared access signatures can help mitigate these risks:</span></span>

1. <span data-ttu-id="51c2f-293">**Sempre usar HTTPS** toocreate ou distribua uma SAS.</span><span class="sxs-lookup"><span data-stu-id="51c2f-293">**Always use HTTPS** toocreate or distribute a SAS.</span></span> <span data-ttu-id="51c2f-294">Se uma SAS é passada sobre HTTP e interceptada, um invasor executando um ataque man-in-the-middle é capaz de tooread hello SAS e, em seguida, usá-lo como Olá destinada a usuário poderia ter comprometer potencialmente a dados confidenciais ou permitindo a corrupção de dados por Olá usuário mal-intencionado.</span><span class="sxs-lookup"><span data-stu-id="51c2f-294">If a SAS is passed over HTTP and intercepted, an attacker performing a man-in-the-middle attack is able tooread hello SAS and then use it just as hello intended user could have, potentially compromising sensitive data or allowing for data corruption by hello malicious user.</span></span>
2. <span data-ttu-id="51c2f-295">**Faça referência às políticas de acesso armazenadas sempre que possível.**</span><span class="sxs-lookup"><span data-stu-id="51c2f-295">**Reference stored access policies where possible.**</span></span> <span data-ttu-id="51c2f-296">Armazenado acesso políticas fornecem Olá permissões de toorevoke opção sem ter chaves de conta de armazenamento tooregenerate hello.</span><span class="sxs-lookup"><span data-stu-id="51c2f-296">Stored access policies give you hello option toorevoke permissions without having tooregenerate hello storage account keys.</span></span> <span data-ttu-id="51c2f-297">Definir a expiração de saudação no hello muito distante futura (ou infinita) e verifique se ela foi atualizada regularmente toomove muito em Olá futuras.</span><span class="sxs-lookup"><span data-stu-id="51c2f-297">Set hello expiration on these very far in hello future (or infinite) and make sure it's regularly updated toomove it farther into hello future.</span></span>
3. <span data-ttu-id="51c2f-298">**Use horas de expiração de curto prazo em uma SAS ad hoc.**</span><span class="sxs-lookup"><span data-stu-id="51c2f-298">**Use near-term expiration times on an ad hoc SAS.**</span></span> <span data-ttu-id="51c2f-299">Dessa forma, mesmo se uma SAS for comprometida, ela será válida apenas por um breve período.</span><span class="sxs-lookup"><span data-stu-id="51c2f-299">In this way, even if a SAS is compromised, it's valid only for a short time.</span></span> <span data-ttu-id="51c2f-300">Esta prática será especialmente importante se você não puder fazer referência a uma política de acesso armazenada.</span><span class="sxs-lookup"><span data-stu-id="51c2f-300">This practice is especially important if you cannot reference a stored access policy.</span></span> <span data-ttu-id="51c2f-301">Tempos de expiração curto prazo também limitam a quantidade de saudação de dados que podem ser gravados tooa blob limitando Olá tempo disponível tooupload tooit.</span><span class="sxs-lookup"><span data-stu-id="51c2f-301">Near-term expiration times also limit hello amount of data that can be written tooa blob by limiting hello time available tooupload tooit.</span></span>
4. <span data-ttu-id="51c2f-302">**Ter clientes renovar automaticamente Olá SAS, se necessário.**</span><span class="sxs-lookup"><span data-stu-id="51c2f-302">**Have clients automatically renew hello SAS if necessary.**</span></span> <span data-ttu-id="51c2f-303">Os clientes devem renovar Olá SAS bem antes do vencimento do hello, no tempo de tooallow de ordem de tentativas se o serviço Olá fornecendo Olá SAS não está disponível.</span><span class="sxs-lookup"><span data-stu-id="51c2f-303">Clients should renew hello SAS well before hello expiration, in order tooallow time for retries if hello service providing hello SAS is unavailable.</span></span> <span data-ttu-id="51c2f-304">Se seu SAS deve toobe usado para um número pequeno de imediato, operações de curta duração que são esperados toobe concluída dentro do período de validade Olá, isso pode ser desnecessário Olá que SAS não é esperado toobe renovado.</span><span class="sxs-lookup"><span data-stu-id="51c2f-304">If your SAS is meant toobe used for a small number of immediate, short-lived operations that are expected toobe completed within hello expiration period, then this may be unnecessary as hello SAS is not expected toobe renewed.</span></span> <span data-ttu-id="51c2f-305">No entanto, se você tiver o cliente que normalmente está fazendo solicitações por meio de SAS, possibilidade de saudação de expiração entra em cena.</span><span class="sxs-lookup"><span data-stu-id="51c2f-305">However, if you have client that is routinely making requests via SAS, then hello possibility of expiration comes into play.</span></span> <span data-ttu-id="51c2f-306">Olá consideração importante é toobalance Olá necessidade para Olá SAS toobe curta duração (mencionado anteriormente) com hello necessidade tooensure que Olá cliente está solicitando a renovação antecipada suficiente (interrupção tooavoid devido a renovação toohello SAS expirando toosuccessful anterior).</span><span class="sxs-lookup"><span data-stu-id="51c2f-306">hello key consideration is toobalance hello need for hello SAS toobe short-lived (as previously stated) with hello need tooensure that hello client is requesting renewal early enough (tooavoid disruption due toohello SAS expiring prior toosuccessful renewal).</span></span>
5. <span data-ttu-id="51c2f-307">**Tenha cuidado com a hora de início da SAS.**</span><span class="sxs-lookup"><span data-stu-id="51c2f-307">**Be careful with SAS start time.**</span></span> <span data-ttu-id="51c2f-308">Se você definir a hora de início Olá um SAS muito**agora**, em seguida, devido a distorção tooclock (as diferenças na hora atual de acordo com o toodifferent máquinas), falhas podem ser observadas intermitentemente para Olá primeiro alguns minutos.</span><span class="sxs-lookup"><span data-stu-id="51c2f-308">If you set hello start time for a SAS too**now**, then due tooclock skew (differences in current time according toodifferent machines), failures may be observed intermittently for hello first few minutes.</span></span> <span data-ttu-id="51c2f-309">Em geral, defina Olá toobe de hora de início pelo menos 15 minutos no hello anterior.</span><span class="sxs-lookup"><span data-stu-id="51c2f-309">In general, set hello start time toobe at least 15 minutes in hello past.</span></span> <span data-ttu-id="51c2f-310">Ou então, simplesmente não a defina, o que a tornará imediatamente válida em todos os casos.</span><span class="sxs-lookup"><span data-stu-id="51c2f-310">Or, don't set it at all, which will make it valid immediately in all cases.</span></span> <span data-ttu-id="51c2f-311">Olá mesmo geralmente se aplica a tempo tooexpiry também - Lembre-se de que você pode observar o too15 minutos do relógio distorção em ambas as direções em qualquer solicitação.</span><span class="sxs-lookup"><span data-stu-id="51c2f-311">hello same generally applies tooexpiry time as well--remember that you may observe up too15 minutes of clock skew in either direction on any request.</span></span> <span data-ttu-id="51c2f-312">Para clientes usando um REST versão anterior too2012-02-12, a duração máxima Olá uma SAS que não faz referência a uma política de acesso armazenada é 1 hora e as políticas de especificação de longo prazo que o que irá falhar.</span><span class="sxs-lookup"><span data-stu-id="51c2f-312">For clients using a REST version prior too2012-02-12, hello maximum duration for a SAS that does not reference a stored access policy is 1 hour, and any policies specifying longer term than that will fail.</span></span>
6. <span data-ttu-id="51c2f-313">**Ser específico com hello toobe de recurso acessado.**</span><span class="sxs-lookup"><span data-stu-id="51c2f-313">**Be specific with hello resource toobe accessed.**</span></span> <span data-ttu-id="51c2f-314">Uma prática recomendada de segurança é tooprovide um usuário com privilégios necessários mínimos de saudação.</span><span class="sxs-lookup"><span data-stu-id="51c2f-314">A security best practice is tooprovide a user with hello minimum required privileges.</span></span> <span data-ttu-id="51c2f-315">Se um usuário só precisa de acesso de leitura tooa única entidade, em seguida, conceda a eles acesso de leitura toothat única entidade e acesso não leitura/gravação/exclusão tooall entidades.</span><span class="sxs-lookup"><span data-stu-id="51c2f-315">If a user only needs read access tooa single entity, then grant them read access toothat single entity, and not read/write/delete access tooall entities.</span></span> <span data-ttu-id="51c2f-316">Isso também ajuda a reduzir danos Olá se uma SAS estiver comprometida porque Olá SAS tem menos energia nas mãos de saudação do invasor.</span><span class="sxs-lookup"><span data-stu-id="51c2f-316">This also helps lessen hello damage if a SAS is compromised because hello SAS has less power in hello hands of an attacker.</span></span>
7. <span data-ttu-id="51c2f-317">**É importante que você entenda que a sua conta será cobrada por qualquer uso, incluindo o realizado com a SAS.**</span><span class="sxs-lookup"><span data-stu-id="51c2f-317">**Understand that your account will be billed for any usage, including that done with SAS.**</span></span> <span data-ttu-id="51c2f-318">Se você fornecer acesso de gravação tooa blob, um usuário pode escolher tooupload um blob de 200GB.</span><span class="sxs-lookup"><span data-stu-id="51c2f-318">If you provide write access tooa blob, a user may choose tooupload a 200GB blob.</span></span> <span data-ttu-id="51c2f-319">Se você fornecer acesso de leitura, eles podem escolher toodownload 10 vezes, gera 2 TB em saída custa para você.</span><span class="sxs-lookup"><span data-stu-id="51c2f-319">If you've given them read access as well, they may choose toodownload it 10 times, incurring 2 TB in egress costs for you.</span></span> <span data-ttu-id="51c2f-320">Novamente, forneça permissões limitadas toohelp reduzir possíveis ações Olá de usuários mal-intencionados.</span><span class="sxs-lookup"><span data-stu-id="51c2f-320">Again, provide limited permissions toohelp mitigate hello potential actions of malicious users.</span></span> <span data-ttu-id="51c2f-321">Use essa ameaça de curta duração tooreduce SAS (mas lembre-se do relógio distorção na hora de término hello).</span><span class="sxs-lookup"><span data-stu-id="51c2f-321">Use short-lived SAS tooreduce this threat (but be mindful of clock skew on hello end time).</span></span>
8. <span data-ttu-id="51c2f-322">**Valide os dados gravados com a SAS.**</span><span class="sxs-lookup"><span data-stu-id="51c2f-322">**Validate data written using SAS.**</span></span> <span data-ttu-id="51c2f-323">Quando um aplicativo cliente grava a conta de armazenamento tooyour dados, tenha em mente que pode haver problemas com esses dados.</span><span class="sxs-lookup"><span data-stu-id="51c2f-323">When a client application writes data tooyour storage account, keep in mind that there can be problems with that data.</span></span> <span data-ttu-id="51c2f-324">Se seu aplicativo requer que esses dados ser validados ou autorizados antes de ser toouse pronto, você deve executar essa validação após a gravação de dados de saudação e antes de ser usada pelo seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="51c2f-324">If your application requires that that data be validated or authorized before it is ready toouse, you should perform this validation after hello data is written and before it is used by your application.</span></span> <span data-ttu-id="51c2f-325">Essa prática também protege contra dados corrompidos ou mal-intencionado gravados tooyour conta, por um usuário que adquiriu corretamente Olá SAS ou por um usuário explorando uma SAS vazou.</span><span class="sxs-lookup"><span data-stu-id="51c2f-325">This practice also protects against corrupt or malicious data being written tooyour account, either by a user who properly acquired hello SAS, or by a user exploiting a leaked SAS.</span></span>
9. <span data-ttu-id="51c2f-326">**Não use sempre SAS.**</span><span class="sxs-lookup"><span data-stu-id="51c2f-326">**Don't always use SAS.**</span></span> <span data-ttu-id="51c2f-327">Às vezes, o riscos de saudação associados a uma determinada operação em sua conta de armazenamento superam os benefícios de saudação da SAS.</span><span class="sxs-lookup"><span data-stu-id="51c2f-327">Sometimes hello risks associated with a particular operation against your storage account outweigh hello benefits of SAS.</span></span> <span data-ttu-id="51c2f-328">Para essas operações, criar um serviço de camada intermediária que grava tooyour conta de armazenamento após a realização de negócios de regras de validação, autenticação e auditoria.</span><span class="sxs-lookup"><span data-stu-id="51c2f-328">For such operations, create a middle-tier service that writes tooyour storage account after performing business rule validation, authentication, and auditing.</span></span> <span data-ttu-id="51c2f-329">Além disso, às vezes é mais simples acesso toomanage de outras maneiras.</span><span class="sxs-lookup"><span data-stu-id="51c2f-329">Also, sometimes it's simpler toomanage access in other ways.</span></span> <span data-ttu-id="51c2f-330">Por exemplo, se você quiser o toomake todos os blobs em um contêiner podem ser lidos publicamente, você pode fazer Olá contêiner público, em vez de fornecer um cliente de tooevery SAS para acesso.</span><span class="sxs-lookup"><span data-stu-id="51c2f-330">For example, if you want toomake all blobs in a container publically readable, you can make hello container Public, rather than providing a SAS tooevery client for access.</span></span>
10. <span data-ttu-id="51c2f-331">**Use a análise de armazenamento toomonitor seu aplicativo.**</span><span class="sxs-lookup"><span data-stu-id="51c2f-331">**Use Storage Analytics toomonitor your application.**</span></span> <span data-ttu-id="51c2f-332">Você pode usar o registro em log e métricas tooobserve qualquer um pico em falhas de autenticação devido a interrupção tooan seu SAS provedor serviço ou toohello inadvertida remoção de uma política de acesso armazenada.</span><span class="sxs-lookup"><span data-stu-id="51c2f-332">You can use logging and metrics tooobserve any spike in authentication failures due tooan outage in your SAS provider service or toohello inadvertent removal of a stored access policy.</span></span> <span data-ttu-id="51c2f-333">Consulte Olá [Blog da equipe do armazenamento do Azure](http://blogs.msdn.com/b/windowsazurestorage/archive/2011/08/03/windows-azure-storage-logging-using-logs-to-track-storage-requests.aspx) para obter informações adicionais.</span><span class="sxs-lookup"><span data-stu-id="51c2f-333">See hello [Azure Storage Team Blog](http://blogs.msdn.com/b/windowsazurestorage/archive/2011/08/03/windows-azure-storage-logging-using-logs-to-track-storage-requests.aspx) for additional information.</span></span>

## <a name="sas-examples"></a><span data-ttu-id="51c2f-334">Exemplos de SAS</span><span class="sxs-lookup"><span data-stu-id="51c2f-334">SAS examples</span></span>
<span data-ttu-id="51c2f-335">Abaixo estão alguns exemplos de ambos os tipos de assinatura de acesso compartilhado: SAS de conta e SAS de serviço.</span><span class="sxs-lookup"><span data-stu-id="51c2f-335">Below are some examples of both types of shared access signatures, account SAS and service SAS.</span></span>

<span data-ttu-id="51c2f-336">toorun esses exemplos de c#, você precisa tooreference Olá pacotes do NuGet em seu projeto a seguir:</span><span class="sxs-lookup"><span data-stu-id="51c2f-336">toorun these C# examples, you need tooreference hello following NuGet packages in your project:</span></span>

* <span data-ttu-id="51c2f-337">[Biblioteca de cliente de armazenamento do Azure para .NET](http://www.nuget.org/packages/WindowsAzure.Storage), versão 6. x ou posterior (toouse conta SAS).</span><span class="sxs-lookup"><span data-stu-id="51c2f-337">[Azure Storage Client Library for .NET](http://www.nuget.org/packages/WindowsAzure.Storage), version 6.x or later (toouse account SAS).</span></span>
* [<span data-ttu-id="51c2f-338">Azure Configuration Manager</span><span class="sxs-lookup"><span data-stu-id="51c2f-338">Azure Configuration Manager</span></span>](http://www.nuget.org/packages/Microsoft.WindowsAzure.ConfigurationManager)

<span data-ttu-id="51c2f-339">Para obter exemplos adicionais que mostram como toocreate e teste uma SAS, consulte [exemplos de código do Azure para armazenamento](https://azure.microsoft.com/documentation/samples/?service=storage).</span><span class="sxs-lookup"><span data-stu-id="51c2f-339">For additional examples that show how toocreate and test a SAS, see [Azure Code Samples for Storage](https://azure.microsoft.com/documentation/samples/?service=storage).</span></span>

### <a name="example-create-and-use-an-account-sas"></a><span data-ttu-id="51c2f-340">Exemplo: Criar e usar uma conta de SAS</span><span class="sxs-lookup"><span data-stu-id="51c2f-340">Example: Create and use an account SAS</span></span>
<span data-ttu-id="51c2f-341">Olá, exemplo de código a seguir cria uma conta de SAS que é válido para hello Blob e serviços de arquivo e fornece Olá permissões de cliente de leitura, gravação e as permissões de lista tooaccess nível de serviço APIs.</span><span class="sxs-lookup"><span data-stu-id="51c2f-341">hello following code example creates an account SAS that is valid for hello Blob and File services, and gives hello client permissions read, write, and list permissions tooaccess service-level APIs.</span></span> <span data-ttu-id="51c2f-342">conta Olá SAS restringe Olá protocolo tooHTTPS, para a solicitação de saudação deve ser feita com HTTPS.</span><span class="sxs-lookup"><span data-stu-id="51c2f-342">hello account SAS restricts hello protocol tooHTTPS, so hello request must be made with HTTPS.</span></span>

```csharp
static string GetAccountSASToken()
{
    // toocreate hello account SAS, you need toouse your shared key credentials. Modify for your account.
    const string ConnectionString = "DefaultEndpointsProtocol=https;AccountName=account-name;AccountKey=account-key";
    CloudStorageAccount storageAccount = CloudStorageAccount.Parse(ConnectionString);

    // Create a new access policy for hello account.
    SharedAccessAccountPolicy policy = new SharedAccessAccountPolicy()
        {
            Permissions = SharedAccessAccountPermissions.Read | SharedAccessAccountPermissions.Write | SharedAccessAccountPermissions.List,
            Services = SharedAccessAccountServices.Blob | SharedAccessAccountServices.File,
            ResourceTypes = SharedAccessAccountResourceTypes.Service,
            SharedAccessExpiryTime = DateTime.UtcNow.AddHours(24),
            Protocols = SharedAccessProtocol.HttpsOnly
        };

    // Return hello SAS token.
    return storageAccount.GetSharedAccessSignature(policy);
}
```

<span data-ttu-id="51c2f-343">toouse Olá conta SAS tooaccess APIs de nível de serviço para o serviço de Blob hello, construir um objeto de cliente de Blob usando Olá SAS e Olá ponto de extremidade de armazenamento de Blob para sua conta de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="51c2f-343">toouse hello account SAS tooaccess service-level APIs for hello Blob service, construct a Blob client object using hello SAS and hello Blob storage endpoint for your storage account.</span></span>

```csharp
static void UseAccountSAS(string sasToken)
{
    // Create new storage credentials using hello SAS token.
    StorageCredentials accountSAS = new StorageCredentials(sasToken);
    // Use these credentials and hello account name toocreate a Blob service client.
    CloudStorageAccount accountWithSAS = new CloudStorageAccount(accountSAS, "account-name", endpointSuffix: null, useHttps: true);
    CloudBlobClient blobClientWithSAS = accountWithSAS.CreateCloudBlobClient();

    // Now set hello service properties for hello Blob client created with hello SAS.
    blobClientWithSAS.SetServiceProperties(new ServiceProperties()
    {
        HourMetrics = new MetricsProperties()
        {
            MetricsLevel = MetricsLevel.ServiceAndApi,
            RetentionDays = 7,
            Version = "1.0"
        },
        MinuteMetrics = new MetricsProperties()
        {
            MetricsLevel = MetricsLevel.ServiceAndApi,
            RetentionDays = 7,
            Version = "1.0"
        },
        Logging = new LoggingProperties()
        {
            LoggingOperations = LoggingOperations.All,
            RetentionDays = 14,
            Version = "1.0"
        }
    });

    // hello permissions granted by hello account SAS also permit you tooretrieve service properties.
    ServiceProperties serviceProperties = blobClientWithSAS.GetServiceProperties();
    Console.WriteLine(serviceProperties.HourMetrics.MetricsLevel);
    Console.WriteLine(serviceProperties.HourMetrics.RetentionDays);
    Console.WriteLine(serviceProperties.HourMetrics.Version);
}
```

### <a name="example-create-a-stored-access-policy"></a><span data-ttu-id="51c2f-344">Exemplo: Criar uma política de acesso armazenada</span><span class="sxs-lookup"><span data-stu-id="51c2f-344">Example: Create a stored access policy</span></span>
<span data-ttu-id="51c2f-345">Olá código a seguir cria uma política de acesso armazenada em um contêiner.</span><span class="sxs-lookup"><span data-stu-id="51c2f-345">hello following code creates a stored access policy on a container.</span></span> <span data-ttu-id="51c2f-346">Você pode usar restrições de toospecify de política de acesso de saudação para um serviço de SAS no contêiner de saudação ou seus blobs.</span><span class="sxs-lookup"><span data-stu-id="51c2f-346">You can use hello access policy toospecify constraints for a service SAS on hello container or its blobs.</span></span>

```csharp
private static async Task CreateSharedAccessPolicyAsync(CloudBlobContainer container, string policyName)
{
    // Create a new shared access policy and define its constraints.
    // hello access policy provides create, write, read, list, and delete permissions.
    SharedAccessBlobPolicy sharedPolicy = new SharedAccessBlobPolicy()
    {
        // When hello start time for hello SAS is omitted, hello start time is assumed toobe hello time when hello storage service receives hello request.
        // Omitting hello start time for a SAS that is effective immediately helps tooavoid clock skew.
        SharedAccessExpiryTime = DateTime.UtcNow.AddHours(24),
        Permissions = SharedAccessBlobPermissions.Read | SharedAccessBlobPermissions.List |
            SharedAccessBlobPermissions.Write | SharedAccessBlobPermissions.Create | SharedAccessBlobPermissions.Delete
    };

    // Get hello container's existing permissions.
    BlobContainerPermissions permissions = await container.GetPermissionsAsync();

    // Add hello new policy toohello container's permissions, and set hello container's permissions.
    permissions.SharedAccessPolicies.Add(policyName, sharedPolicy);
    await container.SetPermissionsAsync(permissions);
}
```

### <a name="example-create-a-service-sas-on-a-container"></a><span data-ttu-id="51c2f-347">Exemplo: Criar um serviço SAS em um contêiner</span><span class="sxs-lookup"><span data-stu-id="51c2f-347">Example: Create a service SAS on a container</span></span>
<span data-ttu-id="51c2f-348">saudação de código a seguir cria uma SAS em um contêiner.</span><span class="sxs-lookup"><span data-stu-id="51c2f-348">hello following code creates a SAS on a container.</span></span> <span data-ttu-id="51c2f-349">Se o nome de saudação de uma política de acesso armazenada existente é fornecido, essa política está associada a Olá SAS.</span><span class="sxs-lookup"><span data-stu-id="51c2f-349">If hello name of an existing stored access policy is provided, that policy is associated with hello SAS.</span></span> <span data-ttu-id="51c2f-350">Se nenhuma política de acesso armazenada for fornecida, o código de saudação cria um SAS ad hoc no contêiner de saudação.</span><span class="sxs-lookup"><span data-stu-id="51c2f-350">If no stored access policy is provided, then hello code creates an ad-hoc SAS on hello container.</span></span>

```csharp
private static string GetContainerSasUri(CloudBlobContainer container, string storedPolicyName = null)
{
    string sasContainerToken;

    // If no stored policy is specified, create a new access policy and define its constraints.
    if (storedPolicyName == null)
    {
        // Note that hello SharedAccessBlobPolicy class is used both toodefine hello parameters of an ad-hoc SAS, and
        // tooconstruct a shared access policy that is saved toohello container's shared access policies.
        SharedAccessBlobPolicy adHocPolicy = new SharedAccessBlobPolicy()
        {
            // When hello start time for hello SAS is omitted, hello start time is assumed toobe hello time when hello storage service receives hello request.
            // Omitting hello start time for a SAS that is effective immediately helps tooavoid clock skew.
            SharedAccessExpiryTime = DateTime.UtcNow.AddHours(24),
            Permissions = SharedAccessBlobPermissions.Write | SharedAccessBlobPermissions.List
        };

        // Generate hello shared access signature on hello container, setting hello constraints directly on hello signature.
        sasContainerToken = container.GetSharedAccessSignature(adHocPolicy, null);

        Console.WriteLine("SAS for blob container (ad hoc): {0}", sasContainerToken);
        Console.WriteLine();
    }
    else
    {
        // Generate hello shared access signature on hello container. In this case, all of hello constraints for the
        // shared access signature are specified on hello stored access policy, which is provided by name.
        // It is also possible toospecify some constraints on an ad-hoc SAS and others on hello stored access policy.
        sasContainerToken = container.GetSharedAccessSignature(null, storedPolicyName);

        Console.WriteLine("SAS for blob container (stored access policy): {0}", sasContainerToken);
        Console.WriteLine();
    }

    // Return hello URI string for hello container, including hello SAS token.
    return container.Uri + sasContainerToken;
}
```

### <a name="example-create-a-service-sas-on-a-blob"></a><span data-ttu-id="51c2f-351">Exemplo: Criar um serviço SAS em um blob</span><span class="sxs-lookup"><span data-stu-id="51c2f-351">Example: Create a service SAS on a blob</span></span>
<span data-ttu-id="51c2f-352">saudação de código a seguir cria uma SAS em um blob.</span><span class="sxs-lookup"><span data-stu-id="51c2f-352">hello following code creates a SAS on a blob.</span></span> <span data-ttu-id="51c2f-353">Se o nome de saudação de uma política de acesso armazenada existente é fornecido, essa política está associada a Olá SAS.</span><span class="sxs-lookup"><span data-stu-id="51c2f-353">If hello name of an existing stored access policy is provided, that policy is associated with hello SAS.</span></span> <span data-ttu-id="51c2f-354">Se nenhuma política de acesso armazenada for fornecida, o código de saudação cria um SAS ad hoc no blob de saudação.</span><span class="sxs-lookup"><span data-stu-id="51c2f-354">If no stored access policy is provided, then hello code creates an ad-hoc SAS on hello blob.</span></span>

```csharp
private static string GetBlobSasUri(CloudBlobContainer container, string blobName, string policyName = null)
{
    string sasBlobToken;

    // Get a reference tooa blob within hello container.
    // Note that hello blob may not exist yet, but a SAS can still be created for it.
    CloudBlockBlob blob = container.GetBlockBlobReference(blobName);

    if (policyName == null)
    {
        // Create a new access policy and define its constraints.
        // Note that hello SharedAccessBlobPolicy class is used both toodefine hello parameters of an ad-hoc SAS, and
        // tooconstruct a shared access policy that is saved toohello container's shared access policies.
        SharedAccessBlobPolicy adHocSAS = new SharedAccessBlobPolicy()
        {
            // When hello start time for hello SAS is omitted, hello start time is assumed toobe hello time when hello storage service receives hello request.
            // Omitting hello start time for a SAS that is effective immediately helps tooavoid clock skew.
            SharedAccessExpiryTime = DateTime.UtcNow.AddHours(24),
            Permissions = SharedAccessBlobPermissions.Read | SharedAccessBlobPermissions.Write | SharedAccessBlobPermissions.Create
        };

        // Generate hello shared access signature on hello blob, setting hello constraints directly on hello signature.
        sasBlobToken = blob.GetSharedAccessSignature(adHocSAS);

        Console.WriteLine("SAS for blob (ad hoc): {0}", sasBlobToken);
        Console.WriteLine();
    }
    else
    {
        // Generate hello shared access signature on hello blob. In this case, all of hello constraints for the
        // shared access signature are specified on hello container's stored access policy.
        sasBlobToken = blob.GetSharedAccessSignature(null, policyName);

        Console.WriteLine("SAS for blob (stored access policy): {0}", sasBlobToken);
        Console.WriteLine();
    }

    // Return hello URI string for hello container, including hello SAS token.
    return blob.Uri + sasBlobToken;
}
```

## <a name="conclusion"></a><span data-ttu-id="51c2f-355">Conclusão</span><span class="sxs-lookup"><span data-stu-id="51c2f-355">Conclusion</span></span>
<span data-ttu-id="51c2f-356">Assinaturas de acesso compartilhado são úteis para fornecer permissões limitadas tooyour tooclients de conta de armazenamento que não deve ter a chave da conta hello.</span><span class="sxs-lookup"><span data-stu-id="51c2f-356">Shared access signatures are useful for providing limited permissions tooyour storage account tooclients that should not have hello account key.</span></span> <span data-ttu-id="51c2f-357">Assim, eles são uma parte essencial do modelo de segurança Olá para qualquer aplicativo usando o armazenamento do Azure.</span><span class="sxs-lookup"><span data-stu-id="51c2f-357">As such, they are a vital part of hello security model for any application using Azure Storage.</span></span> <span data-ttu-id="51c2f-358">Se você seguir as práticas recomendadas de saudação listadas aqui, você pode usar a SAS tooprovide maior flexibilidade de tooresources de acesso em sua conta de armazenamento, sem comprometer a segurança de saudação do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="51c2f-358">If you follow hello best practices listed here, you can use SAS tooprovide greater flexibility of access tooresources in your storage account, without compromising hello security of your application.</span></span>

## <a name="next-steps"></a><span data-ttu-id="51c2f-359">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="51c2f-359">Next Steps</span></span>
* [<span data-ttu-id="51c2f-360">Gerenciar blobs e acesso de leitura anônimo toocontainers</span><span class="sxs-lookup"><span data-stu-id="51c2f-360">Manage anonymous read access toocontainers and blobs</span></span>](storage-manage-access-to-resources.md)
* [<span data-ttu-id="51c2f-361">Delegando acesso com uma assinatura de acesso compartilhado</span><span class="sxs-lookup"><span data-stu-id="51c2f-361">Delegating Access with a Shared Access Signature</span></span>](http://msdn.microsoft.com/library/azure/ee395415.aspx)
* [<span data-ttu-id="51c2f-362">Introdução à Tabela e à Fila SAS</span><span class="sxs-lookup"><span data-stu-id="51c2f-362">Introducing Table and Queue SAS</span></span>](http://blogs.msdn.com/b/windowsazurestorage/archive/2012/06/12/introducing-table-sas-shared-access-signature-queue-sas-and-update-to-blob-sas.aspx)

[sas-storage-fe-proxy-service]: ./media/storage-dotnet-shared-access-signature-part-1/sas-storage-fe-proxy-service.png
[sas-storage-provider-service]: ./media/storage-dotnet-shared-access-signature-part-1/sas-storage-provider-service.png
[sas-storage-uri]: ./media/storage-dotnet-shared-access-signature-part-1/sas-storage-uri.png
