---
title: "Solucionando problemas do Armazenamento do Azure com Analisador de Mensagem e Diagnóstico | Microsoft Docs"
description: "Um tutorial que demonstra a solução de problemas ponta a ponta com Análise de Armazenamento do Azure, AzCopy e Analisador de Mensagem da Microsoft"
services: storage
documentationcenter: dotnet
author: robinsh
manager: timlt
ms.assetid: 6b23cba5-0d53-439e-870b-de8e406107d8
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 01/23/2017
ms.author: robinsh
ms.openlocfilehash: ca8c91ce4fe213d89c5bd10e86d5794be44f914b
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 07/11/2017
---
# <a name="end-to-end-troubleshooting-using-azure-storage-metrics-and-logging-azcopy-and-message-analyzer"></a><span data-ttu-id="8f5d6-103">Solução de problemas ponta a ponta usando métricas de Armazenamento do Azure e registro em log, AzCopy e Analisador de Mensagem</span><span class="sxs-lookup"><span data-stu-id="8f5d6-103">End-to-End Troubleshooting using Azure Storage metrics and logging, AzCopy, and Message Analyzer</span></span>
[!INCLUDE [storage-selector-portal-e2e-troubleshooting](../../includes/storage-selector-portal-e2e-troubleshooting.md)]

## <a name="overview"></a><span data-ttu-id="8f5d6-104">Visão geral</span><span class="sxs-lookup"><span data-stu-id="8f5d6-104">Overview</span></span>
<span data-ttu-id="8f5d6-105">Diagnóstico e solução de problemas são habilidades chaves para a criação e o suporte a aplicativos de clientes com o Armazenamento do Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-105">Diagnosing and troubleshooting is a key skill for building and supporting client applications with Microsoft Azure Storage.</span></span> <span data-ttu-id="8f5d6-106">Devido à natureza distribuída de um aplicativo do Azure, diagnosticar e solucionar problemas de desempenho e erros pode ser mais complexo do que em ambientes tradicionais.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-106">Due to the distributed nature of an Azure application, diagnosing and troubleshooting errors and performance issues may be more complex than in traditional environments.</span></span>

<span data-ttu-id="8f5d6-107">Neste tutorial, demonstraremos como identificar certos erros do cliente que podem afetar o desempenho e solucionar esses erros de ponta a ponta usando as ferramentas fornecidas pela Microsoft e o Armazenamento do Azure para otimizar o aplicativo cliente.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-107">In this tutorial, we will demonstrate how to identify client certain errors that may affect performance, and troubleshoot those errors from end-to-end using tools provided by Microsoft and Azure Storage, in order to optimize the client application.</span></span>

<span data-ttu-id="8f5d6-108">Este tutorial fornece uma exploração prática de um cenário de solução de problemas de ponta a ponta.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-108">This tutorial provides a hands-on exploration of an end-to-end troubleshooting scenario.</span></span> <span data-ttu-id="8f5d6-109">Para obter um guia conceitual detalhado para solucionar problemas dos aplicativos de armazenamento do Azure, consulte [Monitorar, diagnosticar e solucionar problemas de Armazenamento do Microsoft Azure](storage-monitoring-diagnosing-troubleshooting.md).</span><span class="sxs-lookup"><span data-stu-id="8f5d6-109">For an in-depth conceptual guide to troubleshooting Azure storage applications, see [Monitor, diagnose, and troubleshoot Microsoft Azure Storage](storage-monitoring-diagnosing-troubleshooting.md).</span></span>

## <a name="tools-for-troubleshooting-azure-storage-applications"></a><span data-ttu-id="8f5d6-110">Ferramentas para solucionar problemas de aplicativos de armazenamento do Azure</span><span class="sxs-lookup"><span data-stu-id="8f5d6-110">Tools for troubleshooting Azure Storage applications</span></span>
<span data-ttu-id="8f5d6-111">Para solucionar problemas de aplicativos cliente que usam o armazenamento do Microsoft Azure, você pode usar uma combinação de ferramentas para determinar quando um problema ocorreu e o que pode ser a causa do problema.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-111">To troubleshoot client applications using Microsoft Azure Storage, you can use a combination of tools to determine when an issue has occurred and what the cause of the problem may be.</span></span> <span data-ttu-id="8f5d6-112">Essas ferramentas incluem:</span><span class="sxs-lookup"><span data-stu-id="8f5d6-112">These tools include:</span></span>

* <span data-ttu-id="8f5d6-113">**Análise de Armazenamento do Azure**.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-113">**Azure Storage Analytics**.</span></span> <span data-ttu-id="8f5d6-114">[A Análise de Armazenamento do Azure](http://msdn.microsoft.com/library/azure/hh343270.aspx) fornece métricas e registro em log para o Armazenamento do Azure.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-114">[Azure Storage Analytics](http://msdn.microsoft.com/library/azure/hh343270.aspx) provides metrics and logging for Azure Storage.</span></span>

  * <span data-ttu-id="8f5d6-115">**A métrica de armazenamento** controla as métricas de transação e as métricas de capacidade para sua conta de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-115">**Storage metrics** tracks transaction metrics and capacity metrics for your storage account.</span></span> <span data-ttu-id="8f5d6-116">Usando métricas, você pode determinar o desempenho do seu aplicativo de acordo com uma variedade de medidas diferentes.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-116">Using metrics, you can determine how your application is performing according to a variety of different measures.</span></span> <span data-ttu-id="8f5d6-117">Consulte o [Esquema da Tabela de Métricas de Análise do Armazenamento](http://msdn.microsoft.com/library/azure/hh343264.aspx) para obter mais informações sobre os tipos de métricas controladas pela Análise de Armazenamento.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-117">See [Storage Analytics Metrics Table Schema](http://msdn.microsoft.com/library/azure/hh343264.aspx) for more information about the types of metrics tracked by Storage Analytics.</span></span>
  * <span data-ttu-id="8f5d6-118">**O log de armazenamento** registra cada solicitação dos serviços de Armazenamento do Azure em um log do servidor.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-118">**Storage logging** logs each request to the Azure Storage services to a server-side log.</span></span> <span data-ttu-id="8f5d6-119">O log registra dados detalhados para cada solicitação, incluindo a operação executada, o status da operação e informações de latência.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-119">The log tracks detailed data for each request, including the operation performed, the status of the operation, and latency information.</span></span> <span data-ttu-id="8f5d6-120">Consulte o [Formato do Log de Análise de Armazenamento](http://msdn.microsoft.com/library/azure/hh343259.aspx) para obter mais informações sobre os dados de solicitação e resposta gravados nos logs pela Análise de Armazenamento.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-120">See [Storage Analytics Log Format](http://msdn.microsoft.com/library/azure/hh343259.aspx) for more information about the request and response data that is written to the logs by Storage Analytics.</span></span>

> [!NOTE]
> <span data-ttu-id="8f5d6-121">As contas de armazenamento com um tipo de replicação de armazenamento com redundância de zona (ZRS) não têm métricas ou funcionalidade de log habilitadas no momento.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-121">Storage accounts with a replication type of Zone-Redundant Storage (ZRS) do not have the metrics or logging capability enabled at this time.</span></span>
>
>

* <span data-ttu-id="8f5d6-122">**Portal Clássico do Azure**.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-122">**Azure Classic Portal**.</span></span> <span data-ttu-id="8f5d6-123">Você pode configurar log e métricas para sua conta de armazenamento no [Portal Clássico do Azure](https://manage.windowsazure.com).</span><span class="sxs-lookup"><span data-stu-id="8f5d6-123">You can configure metrics and logging for your storage account in the [Azure Classic Portal](https://manage.windowsazure.com).</span></span> <span data-ttu-id="8f5d6-124">Você também pode exibir gráficos que mostram o desempenho do seu aplicativo ao longo do tempo e configurar alertas para notificá-lo se seu aplicativo for executado de forma diferente do esperado para uma métrica especificada.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-124">You can also view charts and graphs that show how your application is performing over time, and configure alerts to notify you if your application performs differently than expected for a specified metric.</span></span>

    <span data-ttu-id="8f5d6-125">Confira [Monitor a storage account in the Azure Portal](storage-monitor-storage-account.md) (Monitorar uma conta de armazenamento no Portal do Azure) para obter informações sobre como configurar o monitoramento no Portal Clássico do Azure.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-125">See [Monitor a storage account in the Azure Portal](storage-monitor-storage-account.md) for information about configuring monitoring in the Azure Classic Portal.</span></span>
* <span data-ttu-id="8f5d6-126">**AzCopy**.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-126">**AzCopy**.</span></span> <span data-ttu-id="8f5d6-127">Os logs do servidor do Armazenamento do Azure são armazenados como blobs, então você pode usar o AzCopy para copiar os blobs de log para um diretório local para análise usando o Analisador de Mensagem da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-127">Server logs for Azure Storage are stored as blobs, so you can use AzCopy to copy the log blobs to a local directory for analysis using Microsoft Message Analyzer.</span></span> <span data-ttu-id="8f5d6-128">Confira [Transferir dados com o Utilitário de Linha de Comando AzCopy](storage-use-azcopy.md) para obter mais informações sobre o AzCopy.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-128">See [Transfer data with the AzCopy Command-Line Utility](storage-use-azcopy.md) for more information about AzCopy.</span></span>
* <span data-ttu-id="8f5d6-129">**Analisador de Mensagem da Microsoft**.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-129">**Microsoft Message Analyzer**.</span></span> <span data-ttu-id="8f5d6-130">O Analisador de Mensagem é uma ferramenta que consome os arquivos de log e exibe dados de log em um formato visual que torna mais fácil a filtragem, pesquisa e agrupamento de dados de log em conjuntos úteis que você pode usar para analisar erros e problemas de desempenho.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-130">Message Analyzer is a tool that consumes log files and displays log data in a visual format that makes it easy to filter, search, and group log data into useful sets that you can use to analyze errors and performance issues.</span></span> <span data-ttu-id="8f5d6-131">Consulte o [Guia Operacional do Analisador de Mensagem da Microsoft](http://technet.microsoft.com/library/jj649776.aspx) para obter mais informações sobre o Analisador de Mensagem.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-131">See [Microsoft Message Analyzer Operating Guide](http://technet.microsoft.com/library/jj649776.aspx) for more information about Message Analyzer.</span></span>

## <a name="about-the-sample-scenario"></a><span data-ttu-id="8f5d6-132">Sobre o cenário de exemplo</span><span class="sxs-lookup"><span data-stu-id="8f5d6-132">About the sample scenario</span></span>
<span data-ttu-id="8f5d6-133">Para este tutorial, vamos examinar um cenário onde as métricas de armazenamento do Azure indicam uma taxa de sucesso de porcentagem baixa de um aplicativo que chama o armazenamento do Azure.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-133">For this tutorial, we'll examine a scenario where Azure Storage metrics indicates a low percent success rate for an application that calls Azure storage.</span></span> <span data-ttu-id="8f5d6-134">A métrica da taxa de sucesso de porcentagem baixa (mostrada como **PercentSuccess** no Portal Clássico do Azure e nas tabelas de métricas) controla as operações com êxito, mas que retornam um código de status HTTP maior que 299.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-134">The low percent success rate metric (shown as **PercentSuccess** in the Azure Classic Portal and in the metrics tables) tracks operations that succeed, but that return an HTTP status code that is greater than 299.</span></span> <span data-ttu-id="8f5d6-135">Nos arquivos de log do lado do servidor, essas operações são registradas com um status de transação de **ClientOtherErrors**.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-135">In the server-side storage log files, these operations are recorded with a transaction status of **ClientOtherErrors**.</span></span> <span data-ttu-id="8f5d6-136">Para obter mais detalhes sobre a métrica de sucesso de porcentagem baixa, consulte [As métricas mostram o PercentSuccess baixo ou as entradas do log de análise têm operações com status de transação de ClientOtherErrors](storage-monitoring-diagnosing-troubleshooting.md#metrics-show-low-percent-success).</span><span class="sxs-lookup"><span data-stu-id="8f5d6-136">For more details about the low percent success metric, see [Metrics show low PercentSuccess or analytics log entries have operations with transaction status of ClientOtherErrors](storage-monitoring-diagnosing-troubleshooting.md#metrics-show-low-percent-success).</span></span>

<span data-ttu-id="8f5d6-137">Operações de armazenamento do Azure podem retornar códigos de status HTTP maior 299 como parte de sua funcionalidade normal.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-137">Azure Storage operations may return HTTP status codes greater than 299 as part of their normal functionality.</span></span> <span data-ttu-id="8f5d6-138">Porém esses erros em alguns casos indicam que você poderá otimizar o aplicativo cliente para melhorar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-138">But these errors in some cases indicate that you may be able to optimize your client application for improved performance.</span></span>

<span data-ttu-id="8f5d6-139">Nesse cenário, vejamos uma taxa de sucesso de porcentagem baixa que seja algo abaixo de 100%.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-139">In this scenario, we'll consider a low percent success rate to be anything below 100%.</span></span> <span data-ttu-id="8f5d6-140">Você pode escolher um nível diferente de métrica, no entanto, de acordo com suas necessidades.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-140">You can choose a different metric level, however, according to your needs.</span></span> <span data-ttu-id="8f5d6-141">É recomendável que, durante o teste do seu aplicativo, você estabeleça uma tolerância de linha de base para suas principais métricas de desempenho.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-141">We recommend that during testing of your application, you establish a baseline tolerance for your key performance metrics.</span></span> <span data-ttu-id="8f5d6-142">Por exemplo, você pode determinar, com base nos testes, que seu aplicativo deve ter uma taxa de porcentagem de êxitos consistente de 90% ou 85%.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-142">For example, you might determine, based on testing, that your application should have a consistent percent success rate of 90%, or 85%.</span></span> <span data-ttu-id="8f5d6-143">Se seus dados de métricas mostram que o aplicativo desviam-se desse número, você pode investigar o que está causando o aumento.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-143">If your metrics data shows that the application is deviating from that number, then you can investigate what may be causing the increase.</span></span>

<span data-ttu-id="8f5d6-144">Em nosso cenário de exemplo, depois que estabelecemos que a métrica de taxa de porcentagem de êxitos está abaixo de 100%, vamos examinar os logs para localizar os erros que correlacionam as métricas e usá-las para descobrir o que está causando a taxa inferior de sucesso de porcentagem.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-144">For our sample scenario, once we've established that the percent success rate metric is below 100%, we will examine the logs to find the errors that correlate to the metrics, and use them to figure out what is causing the lower percent success rate.</span></span> <span data-ttu-id="8f5d6-145">Vamos examinar especificamente erros no intervalo de 400.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-145">We'll look specifically at errors in the 400 range.</span></span> <span data-ttu-id="8f5d6-146">Em seguida, examinaremos com mais detalhes os erros 404 (não encontrado).</span><span class="sxs-lookup"><span data-stu-id="8f5d6-146">Then we'll more closely investigate 404 (Not Found) errors.</span></span>

### <a name="some-causes-of-400-range-errors"></a><span data-ttu-id="8f5d6-147">Algumas causas de erros no intervalo 400</span><span class="sxs-lookup"><span data-stu-id="8f5d6-147">Some causes of 400-range errors</span></span>
<span data-ttu-id="8f5d6-148">Os exemplos a seguir mostram uma amostra de alguns erros de intervalo 400 para solicitações do Armazenamento de Blob do Azure e suas possíveis causas.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-148">The examples below shows a sampling of some 400-range errors for requests against Azure Blob Storage, and their possible causes.</span></span> <span data-ttu-id="8f5d6-149">Qualquer um desses erros, bem como erros no intervalo 300 e 500, podem contribuir para uma taxa de sucesso de porcentagem baixa.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-149">Any of these errors, as well as errors in the 300 range and the 500 range, can contribute to a low percent success rate.</span></span>

<span data-ttu-id="8f5d6-150">Observe que as listas abaixo estão longe de serem completas.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-150">Note that the lists below are far from complete.</span></span> <span data-ttu-id="8f5d6-151">Confira [Status e códigos de erro](http://msdn.microsoft.com/library/azure/dd179382.aspx) para obter detalhes sobre os erros gerais de Armazenamento do Azure e sobre os erros específicos de cada um dos serviços de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-151">See [Status and Error Codes](http://msdn.microsoft.com/library/azure/dd179382.aspx) for details about general Azure Storage errors and about errors specific to each of the storage services.</span></span>

<span data-ttu-id="8f5d6-152">**Exemplos do Código de Status 404 (Não Encontrado)**</span><span class="sxs-lookup"><span data-stu-id="8f5d6-152">**Status Code 404 (Not Found) Examples**</span></span>

<span data-ttu-id="8f5d6-153">Ocorre quando uma operação de leitura em um contêiner ou blob falha porque o contêiner ou blob não foi encontrado.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-153">Occurs when a read operation against a container or blob fails because the blob or container is not found.</span></span>

* <span data-ttu-id="8f5d6-154">Ocorre se um contêiner ou blob tiver sido excluído por outro cliente antes desta solicitação.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-154">Occurs if a container or blob has been deleted by another client before this request.</span></span>
* <span data-ttu-id="8f5d6-155">Ocorre se você estiver usando uma chamada à API que cria o contêiner ou blob depois de verificar se ele existe.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-155">Occurs if you are using an API call that creates the container or blob after checking whether it exists.</span></span> <span data-ttu-id="8f5d6-156">As APIs CreateIfNotExists realizam uma chamada HEAD para verificar a existência do contêiner ou blob. Se ele não existir, será retornado um erro 404 e, em seguida, uma segunda chamada PUT é feita para gravar o contêiner ou blob.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-156">The CreateIfNotExists APIs make a HEAD call first to check for the existence of the container or blob; if it does not exist, a 404 error is returned, and then a second PUT call is made to write the container or blob.</span></span>

<span data-ttu-id="8f5d6-157">**Exemplos do Código de Status 409 (Conflito)**</span><span class="sxs-lookup"><span data-stu-id="8f5d6-157">**Status Code 409 (Conflict) Examples**</span></span>

* <span data-ttu-id="8f5d6-158">Ocorre se você usar uma API para criar um novo contêiner ou blob sem verificar primeiro a existência e se um contêiner ou blob com esse nome já existe.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-158">Occurs if you use a Create API to create a new container or blob, without checking for existence first, and a container or blob with that name already exists.</span></span>
* <span data-ttu-id="8f5d6-159">Ocorre se um contêiner está sendo excluído e você tentar criar um novo contêiner com o mesmo nome antes da operação de exclusão ser concluída.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-159">Occurs if a container is being deleted, and you attempt to create a new container with the same name before the deletion operation is complete.</span></span>
* <span data-ttu-id="8f5d6-160">Ocorre se você especificar uma concessão em um contêiner ou blob e já houver uma concessão presente.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-160">Occurs if you specify a lease on a container or blob, and there is already a lease present.</span></span>

<span data-ttu-id="8f5d6-161">**Exemplos do Código de Status 412 (Falha na Pré-condição)**</span><span class="sxs-lookup"><span data-stu-id="8f5d6-161">**Status Code 412 (Precondition Failed) Examples**</span></span>

* <span data-ttu-id="8f5d6-162">Ocorre quando a condição especificada por um cabeçalho condicional não foi atendida.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-162">Occurs when the condition specified by a conditional header has not been met.</span></span>
* <span data-ttu-id="8f5d6-163">Ocorre quando a ID de concessão especificada não coincide com a ID de concessão no contêiner ou blob.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-163">Occurs when the lease ID specified does not match the lease ID on the container or blob.</span></span>

## <a name="generate-log-files-for-analysis"></a><span data-ttu-id="8f5d6-164">Gerar arquivos de log para análise</span><span class="sxs-lookup"><span data-stu-id="8f5d6-164">Generate log files for analysis</span></span>
<span data-ttu-id="8f5d6-165">Neste tutorial, usaremos o Analisador de Mensagem para trabalhar com três tipos diferentes de arquivos de log, embora você possa optar por trabalhar com qualquer um desses:</span><span class="sxs-lookup"><span data-stu-id="8f5d6-165">In this tutorial, we'll use Message Analyzer to work with three different types of log files, although you could choose to work with any one of these:</span></span>

* <span data-ttu-id="8f5d6-166">O **log do servidor**que é criado quando você habilita o log de armazenamento do Azure.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-166">The **server log**, which is created when you enable Azure Storage logging.</span></span> <span data-ttu-id="8f5d6-167">O log do servidor contém dados sobre cada operação de chamada com um dos serviços de armazenamento do Azure: blob, fila, tabela e arquivo.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-167">The server log contains data about each operation called against one of the Azure Storage services - blob, queue, table, and file.</span></span> <span data-ttu-id="8f5d6-168">O log do servidor indica qual operação foi chamada e o código de status retornado, bem como outros detalhes sobre a solicitação e resposta.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-168">The server log indicates which operation was called and what status code was returned, as well as other details about the request and response.</span></span>
* <span data-ttu-id="8f5d6-169">O **log do cliente .NET**que é criado quando você habilita o log de cliente de dentro de seu aplicativo .NET.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-169">The **.NET client log**, which is created when you enable client-side logging from within your .NET application.</span></span> <span data-ttu-id="8f5d6-170">O log de cliente inclui informações detalhadas sobre como o cliente prepara a solicitação e recebe e processa a resposta.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-170">The client log includes detailed information about how the client prepares the request and receives and processes the response.</span></span>
* <span data-ttu-id="8f5d6-171">O **log de rastreamento de rede HTTP**que coleta dados nos dados de solicitação e resposta HTTP/HTTPS, inclusive para as operações no Armazenamento do Azure.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-171">The **HTTP network trace log**, which collects data on HTTP/HTTPS request and response data, including for operations against Azure Storage.</span></span> <span data-ttu-id="8f5d6-172">Neste tutorial, vamos gerar o rastreamento de rede por meio do Analisador de Mensagem.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-172">In this tutorial, we'll generate the network trace via Message Analyzer.</span></span>

### <a name="configure-server-side-logging-and-metrics"></a><span data-ttu-id="8f5d6-173">Configurar o log de servidor e métricas</span><span class="sxs-lookup"><span data-stu-id="8f5d6-173">Configure server-side logging and metrics</span></span>
<span data-ttu-id="8f5d6-174">Primeiro, precisaremos configurar o log de armazenamento do Azure e suas métricas, para que tenhamos dados do aplicativo cliente para analisar.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-174">First, we'll need to configure Azure Storage logging and metrics, so that we have data from the client application to analyze.</span></span> <span data-ttu-id="8f5d6-175">Você pode configurar o registro em log e métricas de diversas maneiras, por meio do [Portal Clássico do Azure](https://manage.windowsazure.com), usando o PowerShell ou com programação.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-175">You can configure logging and metrics in a variety of ways - via the [Azure Classic Portal](https://manage.windowsazure.com), by using PowerShell, or programmatically.</span></span> <span data-ttu-id="8f5d6-176">Consulte [Habilitando Métricas de Armazenamento e Exibindo os Dados da Métrica](http://msdn.microsoft.com/library/azure/dn782843.aspx) e [Habilitando o Log de Armazenamento e Acessando os Dados de Log](http://msdn.microsoft.com/library/azure/dn782840.aspx) para obter detalhes sobre como configurar o registro em log e as métricas.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-176">See [Enabling Storage Metrics and Viewing Metrics Data](http://msdn.microsoft.com/library/azure/dn782843.aspx) and [Enabling Storage Logging and Accessing Log Data](http://msdn.microsoft.com/library/azure/dn782840.aspx) for details about configuring logging and metrics.</span></span>

<span data-ttu-id="8f5d6-177">**Através do Portal Clássico do Azure**</span><span class="sxs-lookup"><span data-stu-id="8f5d6-177">**Via the Azure Classic Portal**</span></span>

<span data-ttu-id="8f5d6-178">Para configurar o registro em log e as métricas para sua conta de armazenamento usando o portal, siga as instruções em [Monitor a storage account in the Azure Portal](storage-monitor-storage-account.md)(Monitorar uma conta de armazenamento no Portal do Azure).</span><span class="sxs-lookup"><span data-stu-id="8f5d6-178">To configure logging and metrics for your storage account using the portal, follow the instructions at [Monitor a storage account in the Azure Portal](storage-monitor-storage-account.md).</span></span>

> [!NOTE]
> <span data-ttu-id="8f5d6-179">Não é possível definir a métrica de minutos usando o Portal Clássico do Azure.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-179">It's not possible to set minute metrics using the Azure Classic Portal.</span></span> <span data-ttu-id="8f5d6-180">No entanto, é recomendável que você a defina para os fins deste tutorial e para investigar problemas de desempenho com seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-180">However, we recommend that you do set them for the purposes of this tutorial, and for investigating performance issues with your application.</span></span> <span data-ttu-id="8f5d6-181">Você pode definir a métrica de minutos usando o PowerShell como mostrado abaixo, com programação ou por meio do Portal Clássico do Azure.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-181">You can set minute metrics using PowerShell as shown below, or programmatically, or via the Azure Classic Portal.</span></span>
>
> <span data-ttu-id="8f5d6-182">Observe que o Portal Clássico do Azure não consegue exibir métricas por minuto, apenas as métricas por hora.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-182">Note that the Azure Classic Portal cannot display minute metrics, only hourly metrics.</span></span>
>
>

<span data-ttu-id="8f5d6-183">**Por meio do PowerShell**</span><span class="sxs-lookup"><span data-stu-id="8f5d6-183">**Via PowerShell**</span></span>

<span data-ttu-id="8f5d6-184">Para começar com o PowerShell do Azure, consulte [Como instalar e configurar o Azure PowerShell](/powershell/azure/overview).</span><span class="sxs-lookup"><span data-stu-id="8f5d6-184">To get started with PowerShell for Azure, see [How to install and configure Azure PowerShell](/powershell/azure/overview).</span></span>

1. <span data-ttu-id="8f5d6-185">Use o cmdlet [Add-AzureAccount](/powershell/module/azure/add-azureaccount?view=azuresmps-3.7.0) para adicionar sua conta de usuário do Azure à janela do PowerShell:</span><span class="sxs-lookup"><span data-stu-id="8f5d6-185">Use the [Add-AzureAccount](/powershell/module/azure/add-azureaccount?view=azuresmps-3.7.0) cmdlet to add your Azure user account to the PowerShell window:</span></span>

    ```powershell
     Add-AzureAccount
    ```

2. <span data-ttu-id="8f5d6-186">Na janela **Entrar no Microsoft Azure** , digite o endereço de email e a senha associados à sua conta.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-186">In the **Sign in to Microsoft Azure** window, type the email address and password associated with your account.</span></span> <span data-ttu-id="8f5d6-187">O Azure autentica e salva as informações de credenciais e, em seguida, fecha a janela.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-187">Azure authenticates and saves the credential information, and then closes the window.</span></span>
3. <span data-ttu-id="8f5d6-188">Defina a conta de armazenamento padrão para a conta de armazenamento que você está usando para o tutorial executar estes comandos na janela do PowerShell:</span><span class="sxs-lookup"><span data-stu-id="8f5d6-188">Set the default storage account to the storage account you are using for the tutorial by executing these commands in the PowerShell window:</span></span>

    ```powershell
    $SubscriptionName = 'Your subscription name'
    $StorageAccountName = 'yourstorageaccount'
    Set-AzureSubscription -CurrentStorageAccountName $StorageAccountName -SubscriptionName $SubscriptionName
    ```

4. <span data-ttu-id="8f5d6-189">Habilite log de armazenamento para o serviço Blob:</span><span class="sxs-lookup"><span data-stu-id="8f5d6-189">Enable storage logging for the Blob service:</span></span>

    ```powershell
    Set-AzureStorageServiceLoggingProperty -ServiceType Blob -LoggingOperations Read,Write,Delete -PassThru -RetentionDays 7 -Version 1.0
    ```

5. <span data-ttu-id="8f5d6-190">Habilite as métricas do armazenamento para o serviço Blob, definindo **-MetricsType** para `Minute`:</span><span class="sxs-lookup"><span data-stu-id="8f5d6-190">Enable storage metrics for the Blob service, making sure to set **-MetricsType** to `Minute`:</span></span>

    ```powershell
    Set-AzureStorageServiceMetricsProperty -ServiceType Blob -MetricsType Minute -MetricsLevel ServiceAndApi -PassThru -RetentionDays 7 -Version 1.0
    ```

### <a name="configure-net-client-side-logging"></a><span data-ttu-id="8f5d6-191">Configurar o log de cliente .NET</span><span class="sxs-lookup"><span data-stu-id="8f5d6-191">Configure .NET client-side logging</span></span>
<span data-ttu-id="8f5d6-192">Para configurar o log do cliente de um aplicativo .NET, habilite o diagnóstico do .NET no arquivo de configuração do aplicativo (Web.config ou App.config).</span><span class="sxs-lookup"><span data-stu-id="8f5d6-192">To configure client-side logging for a .NET application, enable .NET diagnostics in the application's configuration file (web.config or app.config).</span></span> <span data-ttu-id="8f5d6-193">Consulte [Log do lado do cliente com a Biblioteca do Cliente de Armazenamento .NET](http://msdn.microsoft.com/library/azure/dn782839.aspx) e [Log do lado do cliente com o Microsoft Azure Storage SDK para Java](http://msdn.microsoft.com/library/azure/dn782844.aspx) para obter detalhes.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-193">See [Client-side Logging with the .NET Storage Client Library](http://msdn.microsoft.com/library/azure/dn782839.aspx) and [Client-side Logging with the Microsoft Azure Storage SDK for Java](http://msdn.microsoft.com/library/azure/dn782844.aspx) for details.</span></span>

<span data-ttu-id="8f5d6-194">O log do lado do cliente inclui informações detalhadas sobre como o cliente prepara a solicitação e recebe e processa a resposta.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-194">The client-side log includes detailed information about how the client prepares the request and receives and processes the response.</span></span>

<span data-ttu-id="8f5d6-195">A biblioteca de cliente de armazenamento armazena dados de log do cliente no local especificado no arquivo de configuração do aplicativo (Web.config ou App.config).</span><span class="sxs-lookup"><span data-stu-id="8f5d6-195">The Storage Client Library stores client-side log data in the location specified in the application's configuration file (web.config or app.config).</span></span>

### <a name="collect-a-network-trace"></a><span data-ttu-id="8f5d6-196">Coletar um rastreamento de rede</span><span class="sxs-lookup"><span data-stu-id="8f5d6-196">Collect a network trace</span></span>
<span data-ttu-id="8f5d6-197">Você pode usar o Analisador de Mensagem para coletar um rastreamento de rede HTTP/HTTPS, enquanto o aplicativo cliente está em execução.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-197">You can use Message Analyzer to collect an HTTP/HTTPS network trace while your client application is running.</span></span> <span data-ttu-id="8f5d6-198">O Analisador de Mensagem usa o [Fiddler](http://www.telerik.com/fiddler) no back-end.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-198">Message Analyzer uses [Fiddler](http://www.telerik.com/fiddler) on the back end.</span></span> <span data-ttu-id="8f5d6-199">Antes de você coletar o rastreamento de rede, recomendamos que você configure o Fiddler para registrar o tráfego HTTPS não criptografado:</span><span class="sxs-lookup"><span data-stu-id="8f5d6-199">Before you collect the network trace, we recommend that you configure Fiddler to record unencrypted HTTPS traffic:</span></span>

1. <span data-ttu-id="8f5d6-200">Instale o [Fiddler](http://www.telerik.com/download/fiddler).</span><span class="sxs-lookup"><span data-stu-id="8f5d6-200">Install [Fiddler](http://www.telerik.com/download/fiddler).</span></span>
2. <span data-ttu-id="8f5d6-201">Inicie o Fiddler.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-201">Launch Fiddler.</span></span>
3. <span data-ttu-id="8f5d6-202">Selecione **Ferramentas| Opções do Fiddler**.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-202">Select **Tools | Fiddler Options**.</span></span>
4. <span data-ttu-id="8f5d6-203">Na caixa de diálogo Opções, verifique se **Capturar CONEXÕES HTTPS** e **Descriptografar Tráfego HTTPS** estão selecionadas, conforme mostrado abaixo.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-203">In the Options dialog, ensure that **Capture HTTPS CONNECTs** and **Decrypt HTTPS Traffic** are both selected, as shown below.</span></span>

![Configurar Opções do Fiddler](./media/storage-e2e-troubleshooting-classic-portal/fiddler-options-1.png)

<span data-ttu-id="8f5d6-205">Para o tutorial, colete e salve um rastreamento de rede pela primeira vez no Analisador de Mensagem e crie uma sessão de análise para analisar os logs e o rastreamento.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-205">For the tutorial, collect and save a network trace first in Message Analyzer, then create an analysis session to analyze the trace and the logs.</span></span> <span data-ttu-id="8f5d6-206">Para coletar um rastreamento de rede no Analisador de Mensagem:</span><span class="sxs-lookup"><span data-stu-id="8f5d6-206">To collect a network trace in Message Analyzer:</span></span>

1. <span data-ttu-id="8f5d6-207">No Analisador de Mensagem, selecione **Arquivo | Rastreamento Rápido | HTTPS Sem Criptografia**.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-207">In Message Analyzer, select **File | Quick Trace | Unencrypted HTTPS**.</span></span>
2. <span data-ttu-id="8f5d6-208">O rastreamento será iniciado imediatamente.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-208">The trace will begin immediately.</span></span> <span data-ttu-id="8f5d6-209">Selecione **Parar** para parar o rastreamento para que possamos configurá-lo para rastrear apenas o tráfego de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-209">Select **Stop** to stop the trace so that we can configure it to trace storage traffic only.</span></span>
3. <span data-ttu-id="8f5d6-210">Selecione **Editar** para editar a sessão de rastreamento.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-210">Select **Edit** to edit the tracing session.</span></span>
4. <span data-ttu-id="8f5d6-211">Selecione o link **Configurar** à direita do provedor ETW **Microsoft-Pef-WebProxy** .</span><span class="sxs-lookup"><span data-stu-id="8f5d6-211">Select the **Configure** link to the right of the **Microsoft-Pef-WebProxy** ETW provider.</span></span>
5. <span data-ttu-id="8f5d6-212">Na caixa de diálogo **Configurações Avançadas**, clique na guia **Provedor**.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-212">In the **Advanced Settings** dialog, click the **Provider** tab.</span></span>
6. <span data-ttu-id="8f5d6-213">No campo **Filtro do Nome de Host** , especifique os pontos de extremidade do armazenamento, separados por espaços.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-213">In the **Hostname Filter** field, specify your storage endpoints, separated by spaces.</span></span> <span data-ttu-id="8f5d6-214">Por exemplo, você pode especificar os pontos de extremidade como se segue; altere `storagesample` para o nome da sua conta de armazenamento:</span><span class="sxs-lookup"><span data-stu-id="8f5d6-214">For example, you can specify your endpoints as follows; change `storagesample` to the name of your storage account:</span></span>

    ```   
    storagesample.blob.core.windows.net storagesample.queue.core.windows.net storagesample.table.core.windows.net
    ```

7. <span data-ttu-id="8f5d6-215">Saia da caixa de diálogo e clique em **Reiniciar** para começar a coleta do rastreamento com o filtro do nome de host no local, para que somente o tráfego da rede de armazenamento do Azure seja incluído no rastreamento.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-215">Exit the dialog, and click **Restart** to begin collecting the trace with the hostname filter in place, so that only Azure Storage network traffic is included in the trace.</span></span>

> [!NOTE]
> <span data-ttu-id="8f5d6-216">Após coletar o rastreamento de rede, é altamente recomendável que você reverta as configurações que possa ter alterado no Fiddler para descriptografar o tráfego HTTPS.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-216">After you have finished collecting your network trace, we strongly recommend that you revert the settings that you may have changed in Fiddler to decrypt HTTPS traffic.</span></span> <span data-ttu-id="8f5d6-217">Na caixa de diálogo Opções do Fiddler, desmarque as caixas de seleção **Capturar CONEXÕES HTTPS** e **Descriptografar Tráfego HTTPS**.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-217">In the Fiddler Options dialog, deselect the **Capture HTTPS CONNECTs** and **Decrypt HTTPS Traffic** checkboxes.</span></span>
>
>

<span data-ttu-id="8f5d6-218">Consulte [Usando os Recursos de Rastreamento de Rede](http://technet.microsoft.com/library/jj674819.aspx) no Technet para obter mais detalhes.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-218">See [Using the Network Tracing Features](http://technet.microsoft.com/library/jj674819.aspx) on Technet for more details.</span></span>

## <a name="review-metrics-data-in-the-azure-classic-portal"></a><span data-ttu-id="8f5d6-219">Analisar dados de métricas no Portal Clássico do Azure</span><span class="sxs-lookup"><span data-stu-id="8f5d6-219">Review metrics data in the Azure Classic Portal</span></span>
<span data-ttu-id="8f5d6-220">Quando seu aplicativo já estiver sendo executado por algum tempo, você pode revisar os gráficos de métricas que aparecem no Portal Clássico do Azure para observar o desempenho do seu serviço.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-220">Once your application has been running for a period of time, you can review the metrics charts that appear in the Azure Classic Portal to observe how your service has been performing.</span></span> <span data-ttu-id="8f5d6-221">Primeiro, iremos adicionar a métrica **Porcentagem de Êxitos** à página de Monitoramento:</span><span class="sxs-lookup"><span data-stu-id="8f5d6-221">First, we'll add the **Success Percentage** metric to the Monitoring page:</span></span>

1. <span data-ttu-id="8f5d6-222">Navegue até o painel da sua conta de armazenamento no [Portal Clássico do Azure](https://manage.windowsazure.com)e selecione o **Monitor** para exibir a página de monitoramento.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-222">Navigate to the Dashboard for your storage account in the [Azure Classic Portal](https://manage.windowsazure.com), then select **Monitor** to view the monitoring page.</span></span>
2. <span data-ttu-id="8f5d6-223">Clique em **Adicionar Métricas** para exibir a caixa de diálogo **Escolher Métricas**.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-223">Click **Add Metrics** to display the **Choose Metrics** dialog.</span></span>
3. <span data-ttu-id="8f5d6-224">Role para baixo até encontrar o grupo **Porcentagem de Êxitos**, expanda-o e selecione **Agregar**, conforme mostrado na figura abaixo.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-224">Scroll down to find the **Success Percentage** group, expand it, then select **Aggregate**, as shown in the picture below.</span></span> <span data-ttu-id="8f5d6-225">Essa métrica agrega dados de percentual de êxito de todas as operações de Blob.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-225">This metric aggregates success percentage data from all Blob operations.</span></span>

![Escolher Métricas](./media/storage-e2e-troubleshooting-classic-portal/choose-metrics-portal-1.png)

<span data-ttu-id="8f5d6-227">No Portal Clássico do Azure, você verá agora a **Porcentagem de Êxitos** no gráfico de monitoramento, junto com quaisquer outras métricas adicionadas (até seis podem ser exibidas no gráfico de uma vez).</span><span class="sxs-lookup"><span data-stu-id="8f5d6-227">In the Azure Classic Portal, you'll now see **Success Percentage** in the monitoring chart, along with any other metrics you may have added (up to six can be displayed on the chart at once).</span></span> <span data-ttu-id="8f5d6-228">Na imagem abaixo, você pode ver que a taxa de sucesso em porcentagem é um pouco abaixo de 100%, que é o cenário que examinaremos em seguida, analisando os logs no Analisador de Mensagem:</span><span class="sxs-lookup"><span data-stu-id="8f5d6-228">In the picture below, you can see that the percent success rate is somewhat below 100%, which is the scenario we'll investigate next by analyzing the logs in Message Analyzer:</span></span>

![Gráfico de métricas no portal](./media/storage-e2e-troubleshooting-classic-portal/portal-metrics-chart-1.png)

<span data-ttu-id="8f5d6-230">Para obter mais detalhes sobre como adicionar métricas à página de Monitoramento, consulte [Como: adicionar métricas à tabela de métricas](storage-monitor-storage-account.md#add-metrics-charts-to-the-portal-dashboard).</span><span class="sxs-lookup"><span data-stu-id="8f5d6-230">For more details on adding metrics to the Monitoring page, see [How to: Add metrics to the metrics table](storage-monitor-storage-account.md#add-metrics-charts-to-the-portal-dashboard).</span></span>

> [!NOTE]
> <span data-ttu-id="8f5d6-231">Pode levar algum tempo para que seus dados de métricas apareçam no Portal Clássico do Azure depois que você habilitar a métrica de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-231">It may take some time for your metrics data to appear in the Azure Classic Portal after you enable storage metrics.</span></span> <span data-ttu-id="8f5d6-232">Isso ocorre porque as métricas por hora da hora anterior não são exibidas no Portal Clássico do Azure até que a hora atual tenha decorrido.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-232">This is because hourly metrics for the previous hour are not displayed in the Azure Classic Portal until the current hour has elapsed.</span></span> <span data-ttu-id="8f5d6-233">Além disso, métricas de minuto não são exibidas no Portal Clássico do Azure.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-233">Also, minute metrics are not displayed in the Azure Classic Portal.</span></span> <span data-ttu-id="8f5d6-234">Dessa forma, dependendo de quando você habilitar a métrica, pode levar até duas horas para ver os dados dela.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-234">So depending on when you enable metrics, it may take up to two hours to see metrics data.</span></span>
>
>

## <a name="use-azcopy-to-copy-server-logs-to-a-local-directory"></a><span data-ttu-id="8f5d6-235">Use AzCopy para copiar logs do servidor para um diretório local</span><span class="sxs-lookup"><span data-stu-id="8f5d6-235">Use AzCopy to copy server logs to a local directory</span></span>
<span data-ttu-id="8f5d6-236">O Armazenamento do Azure grava os dados de log do servidor para blobs, enquanto as métricas são gravadas em tabelas.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-236">Azure Storage writes server log data to blobs, while metrics are written to tables.</span></span> <span data-ttu-id="8f5d6-237">Os blobs de log estão disponíveis no contêiner `$logs` conhecido para sua conta de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-237">Log blobs are available in the well-known `$logs` container for your storage account.</span></span> <span data-ttu-id="8f5d6-238">Blobs de log são nomeados hierarquicamente por ano, mês, dia e hora, para que você possa localizar facilmente o intervalo de tempo que deseja investigar.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-238">Log blobs are named hierarchically by year, month, day, and hour, so that you can easily locate the range of time you wish to investigate.</span></span> <span data-ttu-id="8f5d6-239">Por exemplo, na conta `storagesample`, o contêiner para os blobs de log para 02/01/2015, de 8:00-9:00, é `https://storagesample.blob.core.windows.net/$logs/blob/2015/01/08/0800`.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-239">For example, in the `storagesample` account, the container for the log blobs for 01/02/2015, from 8-9 am, is `https://storagesample.blob.core.windows.net/$logs/blob/2015/01/08/0800`.</span></span> <span data-ttu-id="8f5d6-240">Os blobs individuais nesse contêiner são nomeados em sequência, começando com `000000.log`.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-240">The individual blobs in this container are named sequentially, beginning with `000000.log`.</span></span>

<span data-ttu-id="8f5d6-241">Você pode usar a ferramenta de linha de comando AzCopy para baixar esses arquivos de log do servidor para um local de sua escolha no computador local.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-241">You can use the AzCopy command-line tool to download these server-side log files to a location of your choice on your local machine.</span></span> <span data-ttu-id="8f5d6-242">Por exemplo, você pode usar o comando a seguir para baixar os arquivos de log para as operações de blob que ocorreram no dia 2 de janeiro de 2015 para a pasta `C:\Temp\Logs\Server`; substitua `<storageaccountname>` pelo nome de sua conta de armazenamento e `<storageaccountkey>` pela chave de acesso da conta:</span><span class="sxs-lookup"><span data-stu-id="8f5d6-242">For example, you can use the following command to download the log files for blob operations that took place on January 2, 2015 to the folder `C:\Temp\Logs\Server`; replace `<storageaccountname>` with the name of your storage account, and `<storageaccountkey>` with your account access key:</span></span>

```azcopy
AzCopy.exe /Source:http://<storageaccountname>.blob.core.windows.net/$logs /Dest:C:\Temp\Logs\Server /Pattern:"blob/2015/01/02" /SourceKey:<storageaccountkey> /S /V
```

<span data-ttu-id="8f5d6-243">O AzCopy está disponível para download na página [Downloads do Azure](https://azure.microsoft.com/downloads/) .</span><span class="sxs-lookup"><span data-stu-id="8f5d6-243">AzCopy is available for download on the [Azure Downloads](https://azure.microsoft.com/downloads/) page.</span></span> <span data-ttu-id="8f5d6-244">Para obter detalhes sobre como usar o AzCopy, confira [Transferir dados com o Utilitário de Linha de Comando AzCopy](storage-use-azcopy.md).</span><span class="sxs-lookup"><span data-stu-id="8f5d6-244">For details about using AzCopy, see [Transfer data with the AzCopy Command-Line Utility](storage-use-azcopy.md).</span></span>

<span data-ttu-id="8f5d6-245">Para obter informações adicionais sobre como baixar os logs do servidor, confira [Downloading Storage Logging log data](http://msdn.microsoft.com/library/azure/dn782840.aspx#DownloadingStorageLogginglogdata)(Baixando dados de log do Log de Armazenamento).</span><span class="sxs-lookup"><span data-stu-id="8f5d6-245">For additional information about downloading server-side logs, see [Downloading Storage Logging log data](http://msdn.microsoft.com/library/azure/dn782840.aspx#DownloadingStorageLogginglogdata).</span></span>

## <a name="use-microsoft-message-analyzer-to-analyze-log-data"></a><span data-ttu-id="8f5d6-246">Usar o Analisador de Mensagem da Microsoft para analisar dados de log</span><span class="sxs-lookup"><span data-stu-id="8f5d6-246">Use Microsoft Message Analyzer to analyze log data</span></span>
<span data-ttu-id="8f5d6-247">O Analisador de Mensagem da Microsoft é uma ferramenta para capturar, exibir e analisar o tráfego, eventos e outras mensagens de sistema ou aplicativo em cenários de diagnóstico e solução de problemas de mensagens de protocolo.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-247">Microsoft Message Analyzer is a tool for capturing, displaying, and analyzing protocol messaging traffic, events, and other system or application messages in troubleshooting and diagnostic scenarios.</span></span> <span data-ttu-id="8f5d6-248">O Analisador de Mensagem também permite carregar, agregar e analisar dados de log e arquivos de rastreamento salvos.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-248">Message Analyzer also enables you to load, aggregate, and analyze data from log and saved trace files.</span></span> <span data-ttu-id="8f5d6-249">Para obter mais informações sobre o Analisador de Mensagem, consulte [Guia Operacional do Analisador de Mensagem da Microsoft](http://technet.microsoft.com/library/jj649776.aspx).</span><span class="sxs-lookup"><span data-stu-id="8f5d6-249">For more information about Message Analyzer, see [Microsoft Message Analyzer Operating Guide](http://technet.microsoft.com/library/jj649776.aspx).</span></span>

<span data-ttu-id="8f5d6-250">O Analisador de Mensagem inclui ativos para o Armazenamento do Azure que ajudam você a analisar logs de rede, cliente e servidor.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-250">Message Analyzer includes assets for Azure Storage that help you to analyze server, client, and network logs.</span></span> <span data-ttu-id="8f5d6-251">Nesta seção, abordaremos como usar essas ferramentas para resolver o problema de baixa porcentagem de êxitos nos logs de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-251">In this section, we'll discuss how to use those tools to address the issue of low percent success in the storage logs.</span></span>

### <a name="download-and-install-message-analyzer-and-the-azure-storage-assets"></a><span data-ttu-id="8f5d6-252">Baixe e instale o Analisador de Mensagem e os ativos de Armazenamento do Azure</span><span class="sxs-lookup"><span data-stu-id="8f5d6-252">Download and install Message Analyzer and the Azure Storage Assets</span></span>
1. <span data-ttu-id="8f5d6-253">Baixe o [Analisador de Mensagem](http://www.microsoft.com/download/details.aspx?id=44226) no Centro de Download da Microsoft e execute o instalador.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-253">Download [Message Analyzer](http://www.microsoft.com/download/details.aspx?id=44226) from the Microsoft Download Center, and run the installer.</span></span>
2. <span data-ttu-id="8f5d6-254">Inicie o Analisador de Mensagem.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-254">Launch Message Analyzer.</span></span>
3. <span data-ttu-id="8f5d6-255">No menu **Ferramentas**, selecione **Gerenciador de Ativos**.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-255">From the **Tools** menu, select **Asset Manager**.</span></span> <span data-ttu-id="8f5d6-256">Na caixa de diálogo **Gerenciador de Ativos**, escolha **Downloads** e filtre por **Armazenamento do Azure**.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-256">In the **Asset Manager** dialog, select **Downloads**, then filter on **Azure Storage**.</span></span> <span data-ttu-id="8f5d6-257">Você verá os ativos de Armazenamento do Azure, conforme mostrado na figura abaixo.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-257">You will see the Azure Storage Assets, as shown in the picture below.</span></span>
4. <span data-ttu-id="8f5d6-258">Clique em **Sincronizar Todos os Itens Exibidos** para instalar os Ativos de Armazenamento do Azure.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-258">Click **Sync All Displayed Items** to install the Azure Storage Assets.</span></span> <span data-ttu-id="8f5d6-259">Os ativos disponíveis incluem:</span><span class="sxs-lookup"><span data-stu-id="8f5d6-259">The available assets include:</span></span>
   * <span data-ttu-id="8f5d6-260">**Regras de Cores do Armazenamento do Azure:** as regras de cores do Armazenamento do Azure permitem que você defina filtros especiais que usam estilos de fonte, texto e cor para realçar as mensagens que contêm informações específicas em um rastreamento.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-260">**Azure Storage Color Rules:** Azure Storage color rules enable you to define special filters that use color, text, and font styles to highlight messages that contain specific information in a trace.</span></span>
   * <span data-ttu-id="8f5d6-261">**Gráficos de Armazenamento do Azure:** os gráficos de Armazenamento do Azure são gráficos predefinidos que representam os dados de log do servidor.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-261">**Azure Storage Charts:** Azure Storage charts are predefined charts that graph server log data.</span></span> <span data-ttu-id="8f5d6-262">Observe que para usar os gráficos de Armazenamento do Azure no momento, você pode carregar apenas o log do servidor na Grade de Análise.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-262">Note that to use Azure Storage charts at this time, you may only load the server log into the Analysis Grid.</span></span>
   * <span data-ttu-id="8f5d6-263">**Analisadores de Armazenamento do Azure:** os analisadores de Armazenamento do Azure analisam os logs HTTP, do servidor e do cliente de Armazenamento do Azure para exibí-los na Grade de Análise.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-263">**Azure Storage Parsers:** The Azure Storage parsers parse the Azure Storage client, server, and HTTP logs in order to display them in the Analysis Grid.</span></span>
   * <span data-ttu-id="8f5d6-264">**Filtros de Armazenamento do Azure:** os filtros de Armazenamento do Azure são critérios predefinidos que você pode usar para consultar os dados na Grade de Análise.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-264">**Azure Storage Filters:** Azure Storage filters are predefined criteria that you can use to query your data in the Analysis Grid.</span></span>
   * <span data-ttu-id="8f5d6-265">**Layouts de Exibição do Armazenamento do Azure:** os layouts de exibição do Armazenamento do Azure são layouts de coluna predefinidos e agrupamentos na Grade de Análise.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-265">**Azure Storage View Layouts:** Azure Storage view layouts are predefined column layouts and groupings in the Analysis Grid.</span></span>
5. <span data-ttu-id="8f5d6-266">Reinicie o Analisador de Mensagem depois de instalar os ativos.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-266">Restart Message Analyzer after you've installed the assets.</span></span>

![Gerenciador de Ativos do Analisador de Mensagem](./media/storage-e2e-troubleshooting-classic-portal/mma-start-page-1.png)

> [!NOTE]
> <span data-ttu-id="8f5d6-268">Instale todos os ativos de Armazenamento do Azure mostrados para os fins deste tutorial.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-268">Install all of the Azure Storage assets shown for the purposes of this tutorial.</span></span>
>
>

### <a name="import-your-log-files-into-message-analyzer"></a><span data-ttu-id="8f5d6-269">Importar os arquivos de log para o Analisador de Mensagem</span><span class="sxs-lookup"><span data-stu-id="8f5d6-269">Import your log files into Message Analyzer</span></span>
<span data-ttu-id="8f5d6-270">Você pode importar todos os arquivos de log salvos (do servidor, cliente e rede) para uma única sessão do Analisador de Mensagem da Microsoft para análise.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-270">You can import all of your saved log files (server-side, client-side, and network) into a single session in Microsoft Message Analyzer for analysis.</span></span>

1. <span data-ttu-id="8f5d6-271">No menu **Arquivo** no Analisador de Mensagem da Microsoft, clique em **Nova Sessão**, em seguida, clique em **Sessão em Branco**.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-271">On the **File** menu in Microsoft Message Analyzer, click **New Session**, and then click **Blank Session**.</span></span> <span data-ttu-id="8f5d6-272">Na caixa de diálogo **Nova Sessão** , digite um nome para a sessão de análise.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-272">In the **New Session** dialog, enter a name for your analysis session.</span></span> <span data-ttu-id="8f5d6-273">No painel **Detalhes da Sessão**, clique no botão **Arquivos**.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-273">In the **Session Details** panel, click on the **Files** button.</span></span>
2. <span data-ttu-id="8f5d6-274">Para carregar os dados de rastreamento de rede gerados pelo Analisador de Mensagem, clique em **Adicionar Arquivos**, navegue até o local onde você salvou o arquivo .matp da sua sessão de rastreamento da Web, selecione o arquivo .matp e clique em **Abrir**.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-274">To load the network trace data generated by Message Analyzer, click on **Add Files**, browse to the location where you saved your .matp file from your web tracing session, select the .matp file, and click **Open**.</span></span>
3. <span data-ttu-id="8f5d6-275">Para carregar os dados de log do servidor, clique em **Adicionar Arquivos**, navegue até o local onde você baixou os logs do servidor, selecione os arquivos de log para o intervalo de tempo que deseja analisar e clique em **Abrir**.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-275">To load the server-side log data, click on **Add Files**, browse to the location where you downloaded your server-side logs, select the log files for the time range you want to analyze, and click **Open**.</span></span> <span data-ttu-id="8f5d6-276">Em seguida, no painel **Detalhes da Sessão**, defina a lista suspensa **Configuração do Log de Texto** de cada arquivo de log do servidor para **AzureStorageLog** para garantir que o Analisador de Mensagem da Microsoft possa analisar corretamente o arquivo de log.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-276">Then, in the **Session Details** panel, set the **Text Log Configuration** drop-down for each server-side log file to **AzureStorageLog** to ensure that Microsoft Message Analyzer can parse the log file correctly.</span></span>
4. <span data-ttu-id="8f5d6-277">Para carregar os dados de log do cliente, clique em **Adicionar Arquivos**, navegue até o local onde você salvou os logs do cliente, selecione os arquivos de log que deseja analisar e clique em **Abrir**.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-277">To load the client-side log data, click on **Add Files**, browse to the location where you saved your client-side logs, select the log files you want to analyze, and click **Open**.</span></span> <span data-ttu-id="8f5d6-278">Em seguida, no painel **Detalhes da Sessão**, defina a lista suspensa **Configuração do Log de Texto** de cada arquivo de log do cliente para **AzureStorageClientDotNetV4** para garantir que o Analisador de Mensagem da Microsoft possa analisar corretamente o arquivo de log.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-278">Then, in the **Session Details** panel, set the **Text Log Configuration** drop-down for each client-side log file to **AzureStorageClientDotNetV4** to ensure that Microsoft Message Analyzer can parse the log file correctly.</span></span>
5. <span data-ttu-id="8f5d6-279">Clique em **Iniciar** na caixa de diálogo **Nova Sessão** para carregar e analisar os dados do log.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-279">Click **Start** in the **New Session** dialog to load and parse the log data.</span></span> <span data-ttu-id="8f5d6-280">Os dados de log são exibidos na grade de análise do Analisador de Mensagem.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-280">The log data displays in the Message Analyzer Analysis Grid.</span></span>

<span data-ttu-id="8f5d6-281">A figura abaixo mostra uma sessão de exemplo configurada com o servidor, cliente e arquivos de log de rastreamento de rede.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-281">The picture below shows an example session configured with server, client, and network trace log files.</span></span>

![Configurar Sessão do Analisador de Mensagem](./media/storage-e2e-troubleshooting-classic-portal/configure-mma-session-1.png)

<span data-ttu-id="8f5d6-283">Observe que o Analisador de Mensagem carrega arquivos de log na memória.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-283">Note that Message Analyzer loads log files into memory.</span></span> <span data-ttu-id="8f5d6-284">Se você tiver um grande conjunto de dados de log, é recomendável filtrá-los para obter o melhor desempenho do Analisador de Mensagem.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-284">If you have a large set of log data, you will want to filter it in order to get the best performance from Message Analyzer.</span></span>

<span data-ttu-id="8f5d6-285">Primeiro, determine o intervalo de tempo que você está interessado em analisar e mantenha esse período o mais breve possível.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-285">First, determine the time frame that you are interested in reviewing, and keep this time frame as small as possible.</span></span> <span data-ttu-id="8f5d6-286">Em muitos casos, é recomendável examinar um período de minutos ou horas, no máximo.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-286">In many cases you will want to review a period of minutes or hours at most.</span></span> <span data-ttu-id="8f5d6-287">Importe o menor conjunto de registros que pode atender às suas necessidades.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-287">Import the smallest set of logs that can meet your needs.</span></span>

<span data-ttu-id="8f5d6-288">Se você ainda tiver uma grande quantidade de dados de log, convém especificar uma sessão de filtro para filtrar os dados do log antes de carregá-los.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-288">If you still have a large amount of log data, then you may want to specify a session filter to filter your log data before you load it.</span></span> <span data-ttu-id="8f5d6-289">Na caixa **Filtro da Sessão**, selecione o botão **Biblioteca** para escolher um filtro predefinido. Por exemplo, escolha **Filtro de Hora Global I** nos filtros do Armazenamento do Azure para filtrar em um intervalo de tempo.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-289">In the **Session Filter** box, select the **Library** button to choose a predefined filter; for example, choose **Global Time Filter I** from the Azure Storage filters to filter on a time interval.</span></span> <span data-ttu-id="8f5d6-290">Você pode editar os critérios de filtro para especificar os carimbos de data/hora inicial e final para o intervalo que você deseja ver.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-290">You can then edit the filter criteria to specify the starting and ending timestamp for the interval you want to see.</span></span> <span data-ttu-id="8f5d6-291">Você também pode filtrar um código de status específico. Por exemplo, você pode optar por carregar apenas entradas de log em que o código de status é 404.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-291">You can also filter on a particular status code; for example, you can choose to load only log entries where the status code is 404.</span></span>

<span data-ttu-id="8f5d6-292">Para obter mais informações sobre como importar os dados de log para o Analisador de Mensagem da Microsoft, consulte [Recuperar Dados da Mensagem](http://technet.microsoft.com/library/dn772437.aspx) no TechNet.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-292">For more information about importing log data into Microsoft Message Analyzer, see [Retrieving Message Data](http://technet.microsoft.com/library/dn772437.aspx) on TechNet.</span></span>

### <a name="use-the-client-request-id-to-correlate-log-file-data"></a><span data-ttu-id="8f5d6-293">Use a ID de solicitação do cliente para correlacionar dados do arquivo de log</span><span class="sxs-lookup"><span data-stu-id="8f5d6-293">Use the client request ID to correlate log file data</span></span>
<span data-ttu-id="8f5d6-294">A biblioteca de cliente de armazenamento gera automaticamente uma única ID de solicitação do cliente para cada solicitação.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-294">The Azure Storage Client Library automatically generates a unique client request ID for every request.</span></span> <span data-ttu-id="8f5d6-295">Esse valor é gravado no log do cliente, o log do servidor e o rastreamento de rede, para que possa ser usado para correlacionar dados em todos os três logs no Analisador de Mensagem.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-295">This value is written to the client log, the server log, and the network trace, so you can use it to correlate data across all three logs within Message Analyzer.</span></span> <span data-ttu-id="8f5d6-296">Consulte [ID de solicitação do cliente](storage-monitoring-diagnosing-troubleshooting.md#client-request-id) para obter informações adicionais sobre a ID de solicitação do cliente.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-296">See [Client request ID](storage-monitoring-diagnosing-troubleshooting.md#client-request-id) for additional information about the client request ID.</span></span>

<span data-ttu-id="8f5d6-297">As seções a seguir descrevem como usar os modos de exibição de layout pré-configurados e personalizados para correlacionar e agrupar dados com base na ID de solicitação do cliente.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-297">The sections below describe how to use pre-configured and custom layout views to correlate and group data based on the client request ID.</span></span>

### <a name="select-a-view-layout-to-display-in-the-analysis-grid"></a><span data-ttu-id="8f5d6-298">Selecione um layout de exibição para exibir na grade de análise</span><span class="sxs-lookup"><span data-stu-id="8f5d6-298">Select a view layout to display in the Analysis Grid</span></span>
<span data-ttu-id="8f5d6-299">Os ativos de armazenamento para o Analisador de Mensagem incluem Layouts de exibição do Armazenamento do Azure, que são exibições pré-configuradas que você pode usar para exibir seus dados com agrupamentos úteis e colunas para cenários diferentes.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-299">The Storage Assets for Message Analyzer include Azure Storage View Layouts, which are pre-configured views that you can use to display your data with useful groupings and columns for different scenarios.</span></span> <span data-ttu-id="8f5d6-300">Você também pode criar layouts de modo de exibição personalizado e salvá-los para reutilização.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-300">You can also create custom view layouts and save them for reuse.</span></span>

<span data-ttu-id="8f5d6-301">A figura abaixo mostra o menu **Layout de Exibição**, disponível selecionando **Layout de Exibição** na faixa de opções da barra de ferramentas.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-301">The picture below shows the **View Layout** menu, available by selecting **View Layout** from the toolbar ribbon.</span></span> <span data-ttu-id="8f5d6-302">Os layouts de exibição do Armazenamento do Azure estão agrupados sob o nó **Armazenamento do Azure** no menu.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-302">The view layouts for Azure Storage are grouped under the **Azure Storage** node in the menu.</span></span> <span data-ttu-id="8f5d6-303">Você pode pesquisar `Azure Storage` na caixa de pesquisa para filtrar apenas os layouts de exibição do Armazenamento do Azure.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-303">You can search for `Azure Storage` in the search box to filter on Azure Storage view layouts only.</span></span> <span data-ttu-id="8f5d6-304">Você também pode selecionar a estrela ao lado de um layout de exibição para torná-lo um favorito e exibi-lo na parte superior do menu.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-304">You can also select the star next to a view layout to make it a favorite and display it at the top of the menu.</span></span>

![Menu Layout de Exibição](./media/storage-e2e-troubleshooting-classic-portal/view-layout-menu.png)

<span data-ttu-id="8f5d6-306">Para começar, selecione **Agrupados por Módulo e ClientRequestID**.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-306">To begin with, select **Grouped by ClientRequestID and Module**.</span></span> <span data-ttu-id="8f5d6-307">Esse layout de exibição agrupa os dados de log de todos os três logs, primeiro pela ID de solicitação do cliente, depois pelo arquivo de log de origem (ou **Módulo** no Analisador de Mensagem).</span><span class="sxs-lookup"><span data-stu-id="8f5d6-307">This view layout groups log data from all three logs first by client request ID, then by source log file (or **Module** in Message Analyzer).</span></span> <span data-ttu-id="8f5d6-308">Nesta exibição, você pode fazer uma busca detalhada em uma ID de solicitação de cliente específico e ver os dados de todos os três arquivos de log para essa ID de solicitação de cliente.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-308">With this view, you can drill down into a particular client request ID, and see data from all three log files for that client request ID.</span></span>

<span data-ttu-id="8f5d6-309">A figura abaixo mostra esse modo de exibição de layout aplicado a dados de log de exemplo, com um subconjunto de colunas exibidas.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-309">The picture below shows this layout view applied to the sample log data, with a subset of columns displayed.</span></span> <span data-ttu-id="8f5d6-310">Você pode ver que, para uma ID de solicitação de cliente específico, a grade de análise exibe os dados do log do cliente, o log do servidor e o rastreamento de rede.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-310">You can see that for a particular client request ID, the Analysis Grid displays data from the client log, server log, and network trace.</span></span>

![Layout de Exibição do Armazenamento do Azure](./media/storage-e2e-troubleshooting-classic-portal/view-layout-client-request-id-module.png)

> [!NOTE]
> <span data-ttu-id="8f5d6-312">Arquivos de log diferentes têm colunas diferentes, portanto, quando dados de vários arquivos de log são exibidos na grade de análise, algumas colunas podem não conter nenhum dado para uma determinada linha.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-312">Different log files have different columns, so when data from multiple log files is displayed in the Analysis Grid, some columns may not contain any data for a given row.</span></span> <span data-ttu-id="8f5d6-313">Por exemplo, na figura acima, as linhas de log do cliente não mostram dados para as colunas **Carimbo de data/hora**, **Tempo Decorrido**, **Origem**e **Destino** porque essas colunas não existem no log do cliente, mas existem no rastreamento de rede.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-313">For example, in the picture above, the client log rows do not show any data for the **Timestamp**, **TimeElapsed**, **Source**, and **Destination** columns, because these columns do not exist in the client log, but do exist in the network trace.</span></span> <span data-ttu-id="8f5d6-314">Da mesma forma, a coluna **Carimbo de data/hora** exibe os dados do carimbo de data/hora do log do servidor, mas ão há dados exibidos para as colunas **Tempo Decorrido**, **Origem** e **Destino**, que não fazem parte do log do servidor.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-314">Similarly, the **Timestamp** column displays timestamp data from the server log, but no data is displayed for the **TimeElapsed**, **Source**, and **Destination** columns, which are not part of the server log.</span></span>
>
>

<span data-ttu-id="8f5d6-315">Além de usar os layouts do modo de Armazenamento do Azure, você também pode definir e salvar seus próprios layouts de exibição.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-315">In addition to using the Azure Storage view layouts, you can also define and save your own view layouts.</span></span> <span data-ttu-id="8f5d6-316">Você também pode selecionar outros campos desejados para o agrupamento de dados e salvar o agrupamento como parte do seu layout personalizado.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-316">You can select other desired fields for grouping data and save the grouping as part of your custom layout as well.</span></span>

### <a name="apply-color-rules-to-the-analysis-grid"></a><span data-ttu-id="8f5d6-317">Aplicar regras de cores à grade de análise</span><span class="sxs-lookup"><span data-stu-id="8f5d6-317">Apply color rules to the Analysis Grid</span></span>
<span data-ttu-id="8f5d6-318">Os ativos de armazenamento também incluem regras de cores, que oferecem uma maneira visual de identificar os diferentes tipos de erros na grade de análise.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-318">The Storage Assets also include color rules, which offer a visual means to identify different types of errors in the Analysis Grid.</span></span> <span data-ttu-id="8f5d6-319">As regras de cores predefinidas aplicam-se aos erros HTTP, por isso elas aparecem somente para o rastreamento de rede e de log do servidor.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-319">The predefined color rules apply to HTTP errors, so they appear only for the server log and network trace.</span></span>

<span data-ttu-id="8f5d6-320">Para aplicar as regras da cor, selecione **Regras da Cor** na faixa de opções da barra de ferramentas.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-320">To apply color rules, select **Color Rules** from the toolbar ribbon.</span></span> <span data-ttu-id="8f5d6-321">Você verá as regras de cores do Armazenamento do Azure no menu.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-321">You'll see the Azure Storage color rules in the menu.</span></span> <span data-ttu-id="8f5d6-322">Para o tutorial, selecione **Erros do Cliente (StatusCode entre 400 e 499)**, conforme mostrado na figura abaixo.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-322">For the tutorial, select **Client Errors (StatusCode between 400 and 499)**, as shown in the picture below.</span></span>

![Layout de Exibição do Armazenamento do Azure](./media/storage-e2e-troubleshooting-classic-portal/color-rules-menu.png)

<span data-ttu-id="8f5d6-324">Além de usar as regras de cores de Armazenamento do Azure, você também pode definir e salvar suas próprias regras de cores.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-324">In addition to using the Azure Storage color rules, you can also define and save your own color rules.</span></span>

### <a name="group-and-filter-log-data-to-find-400-range-errors"></a><span data-ttu-id="8f5d6-325">Agrupar e filtrar os dados de log para localizar erros de intervalo de 400</span><span class="sxs-lookup"><span data-stu-id="8f5d6-325">Group and filter log data to find 400-range errors</span></span>
<span data-ttu-id="8f5d6-326">Em seguida, vamos agrupar e filtrar os dados de log para localizar todos os erros no intervalo de 400.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-326">Next, we'll group and filter the log data to find all errors in the 400 range.</span></span>

1. <span data-ttu-id="8f5d6-327">Localize a coluna **StatusCode** na Grade de Análise, clique com o botão direito no cabeçalho da coluna e selecione **Agrupar**.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-327">Locate the **StatusCode** column in the Analysis Grid, right-click the column heading, and select **Group**.</span></span>
2. <span data-ttu-id="8f5d6-328">Em seguida, agrupe a coluna **ClientRequestId** .</span><span class="sxs-lookup"><span data-stu-id="8f5d6-328">Next, group on the **ClientRequestId** column.</span></span> <span data-ttu-id="8f5d6-329">Você verá que os dados na grade de análise agora estão organizados por código de status e por ID de solicitação do cliente.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-329">You'll see that the data in the Analysis Grid is now organized by status code and by client request ID.</span></span>
3. <span data-ttu-id="8f5d6-330">Exiba a janela de ferramentas Filtro de exibição se ela já não estiver exibida.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-330">Display the View Filter tool window if it is not already displayed.</span></span> <span data-ttu-id="8f5d6-331">Na faixa de opções da barra de ferramentas, selecione **Janelas de Ferramenta** e **Filtro de Exibição**.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-331">On the toolbar ribbon, select **Tool Windows**, then **View Filter**.</span></span>
4. <span data-ttu-id="8f5d6-332">Para filtrar os dados de log para exibir apenas os erros do intervalo 400, adicione os seguintes critérios de filtro à janela **Filtro de Exibição** e clique em **Aplicar**:</span><span class="sxs-lookup"><span data-stu-id="8f5d6-332">To filter the log data to display only 400-range errors, add the following filter criteria to the **View Filter** window, and click **Apply**:</span></span>

    ```   
    (AzureStorageLog.StatusCode >= 400 && AzureStorageLog.StatusCode <=499) || (HTTP.StatusCode >= 400 && HTTP.StatusCode <= 499)
    ```

<span data-ttu-id="8f5d6-333">A figura a seguir mostra os resultados desse agrupamento e filtro.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-333">The picture below shows the results of this grouping and filter.</span></span> <span data-ttu-id="8f5d6-334">Expandir o campo **ClientRequestID** abaixo do agrupamento para o código de status 409, por exemplo, mostra uma operação que resultou nesse código de status.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-334">Expanding the **ClientRequestID** field beneath the grouping for status code 409, for example, shows an operation that resulted in that status code.</span></span>

![Layout de Exibição do Armazenamento do Azure](./media/storage-e2e-troubleshooting-classic-portal/400-range-errors1.png)

<span data-ttu-id="8f5d6-336">Depois de aplicar esse filtro, você verá que são excluídas linhas do log do cliente, pois o log do cliente não inclui uma coluna **StatusCode** .</span><span class="sxs-lookup"><span data-stu-id="8f5d6-336">After applying this filter, you'll see that rows from the client log are excluded, as the client log does not include a **StatusCode** column.</span></span> <span data-ttu-id="8f5d6-337">Para começar, vamos examinar o servidor e os logs de rastreamento de rede para localizar os erros 404 e vamos voltar para o log de cliente para examinar as operações de cliente que levou a eles.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-337">To begin with, we'll review the server and network trace logs to locate 404 errors, and then we'll return to the client log to examine the client operations that led to them.</span></span>

> [!NOTE]
> <span data-ttu-id="8f5d6-338">Você poderá filtrar na coluna **StatusCode** e ainda exibir os dados de todos os três logs, incluindo o log do cliente, se adicionar uma expressão ao filtro que inclui entradas de log nas quais o código de status é nulo.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-338">You can filter on the **StatusCode** column and still display data from all three logs, including the client log, if you add an expression to the filter that includes log entries where the status code is null.</span></span> <span data-ttu-id="8f5d6-339">Para criar esta expressão de filtro, use:</span><span class="sxs-lookup"><span data-stu-id="8f5d6-339">To construct this filter expression, use:</span></span>
>
> <code>&#42;StatusCode >= 400 or !&#42;StatusCode</code>
>
> <span data-ttu-id="8f5d6-340">Esse filtro retorna todas as linhas de log do cliente e apenas as linhas de log do servidor e log HTTP em que o código de status é maior que 400.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-340">This filter returns all rows from the client log and only rows from the server log and HTTP log where the status code is greater than 400.</span></span> <span data-ttu-id="8f5d6-341">Se você aplicá-lo ao layout do modo de exibição agrupado por ID de solicitação do cliente e do módulo, poderá pesquisar ou percorrer as entradas de log para encontrar aqueles em que todos os três logs são representados.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-341">If you apply it to the view layout grouped by client request ID and module, you can search or scroll through the log entries to find ones where all three logs are represented.</span></span>   
>
>

### <a name="filter-log-data-to-find-404-errors"></a><span data-ttu-id="8f5d6-342">Filtrar dados de log para localizar erros 404</span><span class="sxs-lookup"><span data-stu-id="8f5d6-342">Filter log data to find 404 errors</span></span>
<span data-ttu-id="8f5d6-343">Os ativos de armazenamento incluem filtros predefinidos que você pode usar para restringir os dados de log para localizar os erros ou tendências que você está procurando.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-343">The Storage Assets include predefined filters that you can use to narrow log data to find the errors or trends you are looking for.</span></span> <span data-ttu-id="8f5d6-344">Em seguida, vamos aplicar dois filtros predefinidos: um que filtra o servidor e os logs de rastreamento de rede para erros 404 e outro que filtra os dados em um intervalo de tempo especificado.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-344">Next, we'll apply two predefined filters: one that filters the server and network trace logs for 404 errors, and one that filters the data on a specified time range.</span></span>

1. <span data-ttu-id="8f5d6-345">Exiba a janela de ferramentas Filtro de exibição se ela já não estiver exibida.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-345">Display the View Filter tool window if it is not already displayed.</span></span> <span data-ttu-id="8f5d6-346">Na faixa de opções da barra de ferramentas, selecione **Janelas de Ferramenta** e **Filtro de Exibição**.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-346">On the toolbar ribbon, select **Tool Windows**, then **View Filter**.</span></span>
2. <span data-ttu-id="8f5d6-347">Na janela Filtro de Exibição, selecione **Biblioteca** e pesquise `Azure Storage` para encontrar os filtros do Armazenamento do Azure.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-347">In the View Filter window, select **Library**, and search on `Azure Storage` to find the Azure Storage filters.</span></span> <span data-ttu-id="8f5d6-348">Selecione o filtro para as mensagens **404 (Não Encontrado) em todos os logs**.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-348">Select the filter for **404 (Not Found) messages in all logs**.</span></span>
3. <span data-ttu-id="8f5d6-349">Exiba o menu **Biblioteca** novamente, localize e selecione o **Filtro de Hora Global**.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-349">Display the **Library** menu again, and locate and select the **Global Time Filter**.</span></span>
4. <span data-ttu-id="8f5d6-350">Edite os carimbos de hora mostrados no filtro para o intervalo que você deseja exibir.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-350">Edit the timestamps shown in the filter to the range you wish to view.</span></span> <span data-ttu-id="8f5d6-351">Isso ajudará a limitar o intervalo de dados a serem analisados.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-351">This will help to narrow the range of data to analyze.</span></span>
5. <span data-ttu-id="8f5d6-352">Seu filtro deve ser semelhante ao exemplo a seguir.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-352">Your filter should appear similar to the example below.</span></span> <span data-ttu-id="8f5d6-353">Clique em **Aplicar** para aplicar o filtro à Grade de Análise.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-353">Click **Apply** to apply the filter to the Analysis Grid.</span></span>

    ```   
    ((AzureStorageLog.StatusCode == 404 || HTTP.StatusCode == 404)) And
    (#Timestamp >= 2014-10-20T16:36:38 and #Timestamp <= 2014-10-20T16:36:39)
    ```

![Layout de Exibição do Armazenamento do Azure](./media/storage-e2e-troubleshooting-classic-portal/404-filtered-errors1.png)

### <a name="analyze-your-log-data"></a><span data-ttu-id="8f5d6-355">Analisar os dados de log</span><span class="sxs-lookup"><span data-stu-id="8f5d6-355">Analyze your log data</span></span>
<span data-ttu-id="8f5d6-356">Agora que você já agrupou e filtrou os dados, poderá examinar os detalhes de solicitações individuais que geraram erros 404.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-356">Now that you have grouped and filtered your data, you can examine the details of individual requests that generated 404 errors.</span></span> <span data-ttu-id="8f5d6-357">No layout do modo de exibição atual, os dados são agrupados por ID de solicitação de cliente e, em seguida, pela origem de log.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-357">In the current view layout, the data is grouped by client request ID, then by log source.</span></span> <span data-ttu-id="8f5d6-358">Uma vez que estamos filtrando solicitações onde o campo StatusCode contém 404, veremos apenas o servidor e os dados de rastreamento de rede, não os dados de log do cliente.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-358">Since we are filtering on requests where the StatusCode field contains 404, we'll see only the server and network trace data, not the client log data.</span></span>

<span data-ttu-id="8f5d6-359">A figura a seguir mostra uma solicitação específica em que uma operação Get Blob gerou um 404 porque o blob não existe.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-359">The picture below shows a specific request where a Get Blob operation yielded a 404 because the blob did not exist.</span></span> <span data-ttu-id="8f5d6-360">Observe que algumas colunas foram removidas do modo de exibição padrão para exibir os dados relevantes.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-360">Note that some columns have been removed from the standard view in order to display the relevant data.</span></span>

![Logs de Rastreamento Filtrados do Servidor e da Rede](./media/storage-e2e-troubleshooting-classic-portal/server-filtered-404-error.png)

<span data-ttu-id="8f5d6-362">Em seguida, correlacionamos essa ID de solicitação do cliente com os dados de log do cliente para ver as ações que o cliente tomou quando o erro ocorreu.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-362">Next, we'll correlate this client request ID with the client log data to see what actions the client was taking when the error happened.</span></span> <span data-ttu-id="8f5d6-363">Você pode exibir uma nova exibição de grade de análise para essa sessão para exibir os dados de log do cliente, que é aberto em uma segunda guia:</span><span class="sxs-lookup"><span data-stu-id="8f5d6-363">You can display a new Analysis Grid view for this session to view the client log data, which opens in a second tab:</span></span>

1. <span data-ttu-id="8f5d6-364">Primeiro, copie o valor do campo **ClientRequestId** para a área de transferência.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-364">First, copy the value of the **ClientRequestId** field to the clipboard.</span></span> <span data-ttu-id="8f5d6-365">Você pode fazer isso selecionando qualquer linha, localizando o campo **ClientRequestId**, clicando com o botão direito no valor dos dados e escolhendo **Copiar 'ClientRequestId'**.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-365">You can do this by selecting either row, locating the **ClientRequestId** field, right-clicking on the data value, and choosing **Copy 'ClientRequestId'**.</span></span>
2. <span data-ttu-id="8f5d6-366">Na faixa de opções da barra de ferramentas, selecione **Novo Visualizador** e **Grade de Análise** para abrir uma nova guia.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-366">On the toolbar ribbon, select **New Viewer**, then select **Analysis Grid** to open a new tab.</span></span> <span data-ttu-id="8f5d6-367">A nova guia mostra todos os dados em seus arquivos de log, sem agrupamento, filtragem ou regras de cores.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-367">The new tab shows all data in your log files, without grouping, filtering, or color rules.</span></span>
3. <span data-ttu-id="8f5d6-368">Na faixa de opções da barra de ferramentas, selecione **Layout de Exibição** e **Todas as Colunas do Cliente .NET** na seção **Armazenamento do Azure**.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-368">On the toolbar ribbon, select **View Layout**, then select **All .NET Client Columns** under the **Azure Storage** section.</span></span> <span data-ttu-id="8f5d6-369">Esse layout do modo de exibição mostra dados do log do cliente, bem como os logs de rastreamento de servidor e rede.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-369">This view layout shows data from the client log as well as the server and network trace logs.</span></span> <span data-ttu-id="8f5d6-370">Por padrão, ele é classificado pela coluna **MessageNumber** .</span><span class="sxs-lookup"><span data-stu-id="8f5d6-370">By default it is sorted on the **MessageNumber** column.</span></span>
4. <span data-ttu-id="8f5d6-371">Em seguida, pesquise o log do cliente para a ID de solicitação do cliente.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-371">Next, search the client log for the client request ID.</span></span> <span data-ttu-id="8f5d6-372">Na faixa de opções da barra de ferramentas, selecione **Localizar Mensagens** e especifique um filtro personalizado na ID de solicitação do cliente no campo **Localizar**.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-372">On the toolbar ribbon, select **Find Messages**, then specify a custom filter on the client request ID in the **Find** field.</span></span> <span data-ttu-id="8f5d6-373">Use esta sintaxe para o filtro, especificando sua própria ID de solicitação de cliente:</span><span class="sxs-lookup"><span data-stu-id="8f5d6-373">Use this syntax for the filter, specifying your own client request ID:</span></span>

    ```  
    *ClientRequestId == "398bac41-7725-484b-8a69-2a9e48fc669a"
    ```

<span data-ttu-id="8f5d6-374">O Analisador de Mensagem localiza e seleciona a primeira entrada de log em que os critérios de pesquisa correspondem à ID da solicitação de cliente.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-374">Message Analyzer locates and selects the first log entry where the search criteria matches the client request ID.</span></span> <span data-ttu-id="8f5d6-375">No log do cliente, existem várias entradas para cada ID de solicitação do cliente, portanto, você pode agrupá-las no campo **ClientRequestId** para facilitar vê-las juntas.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-375">In the client log, there are several entries for each client request ID, so you may want to group them on the **ClientRequestId** field to make it easier to see them all together.</span></span> <span data-ttu-id="8f5d6-376">A figura abaixo mostra todas as mensagens no log do cliente para a ID de solicitação do cliente especificada.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-376">The picture below shows all of the messages in the client log for the specified client request ID.</span></span>

![Log do cliente mostrando erros 404](./media/storage-e2e-troubleshooting-classic-portal/client-log-analysis-grid1.png)

<span data-ttu-id="8f5d6-378">Usando os dados mostrados em layouts de exibição nessas duas guias, você pode analisar os dados da solicitação para determinar o que pode ter causado o erro.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-378">Using the data shown in the view layouts in these two tabs, you can analyze the request data to determine what may have caused the error.</span></span> <span data-ttu-id="8f5d6-379">Você também pode examinar solicitações que precedem esta para ver se um evento anterior pode ter levado ao erro 404.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-379">You can also look at requests that preceded this one to see if a previous event may have led to the 404 error.</span></span> <span data-ttu-id="8f5d6-380">Por exemplo, você pode revisar as entradas de log do cliente anteriores a essa ID de solicitação do cliente para determinar se o blob pode ter sido excluído ou se o erro ocorreu devido à aplicação do cliente chamar uma API CreateIfNotExists em um contêiner ou blob.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-380">For example, you can review the client log entries preceding this client request ID to determine whether the blob may have been deleted, or if the error was due to the client application calling a CreateIfNotExists API on a container or blob.</span></span> <span data-ttu-id="8f5d6-381">No log do cliente, você pode encontrar o endereço do blob no campo **Descrição**. Nos logs do servidor e de rastreamento de rede, essas informações são exibidas no campo **Resumo**.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-381">In the client log, you can find the blob's address in the **Description** field; in the server and network trace logs, this information appears in the **Summary** field.</span></span>

<span data-ttu-id="8f5d6-382">Se você souber o endereço do blob que gerou o erro 404, poderá investigar ainda mais.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-382">Once you know the address of the blob that yielded the 404 error, you can investigate further.</span></span> <span data-ttu-id="8f5d6-383">Se você pesquisar as entradas de log para outras mensagens associadas às operações no mesmo blob, poderá verificar se o cliente já foi excluído da entidade.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-383">If you search the log entries for other messages associated with operations on the same blob, you can check whether the client previously deleted the entity.</span></span>

## <a name="analyze-other-types-of-storage-errors"></a><span data-ttu-id="8f5d6-384">Analisar outros tipos de erros de armazenamento</span><span class="sxs-lookup"><span data-stu-id="8f5d6-384">Analyze other types of storage errors</span></span>
<span data-ttu-id="8f5d6-385">Agora que você está familiarizado com o uso do Analisador de Mensagem para analisar os dados de log, poderá analisar outros tipos de erros usando a exibição de layouts, regras de cores e pesquisa/filtragem.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-385">Now that you are familiar with using Message Analyzer to analyze your log data, you can analyze other types of errors using view layouts, color rules, and searching/filtering.</span></span> <span data-ttu-id="8f5d6-386">As tabelas a seguir listam alguns problemas possíveis e os critérios de filtro que você pode usar para localizá-los.</span><span class="sxs-lookup"><span data-stu-id="8f5d6-386">The tables below lists some issues you may encounter and the filter criteria you can use to locate them.</span></span> <span data-ttu-id="8f5d6-387">Para obter mais informações sobre como construir filtros e a linguagem de filtragem do Analisador de Mensagem, consulte [Filtrando Dados de Mensagem](http://technet.microsoft.com/library/jj819365.aspx).</span><span class="sxs-lookup"><span data-stu-id="8f5d6-387">For more information on constructing filters and the Message Analyzer filtering language, see [Filtering Message Data](http://technet.microsoft.com/library/jj819365.aspx).</span></span>

| <span data-ttu-id="8f5d6-388">Para Investigar...</span><span class="sxs-lookup"><span data-stu-id="8f5d6-388">To Investigate…</span></span> | <span data-ttu-id="8f5d6-389">Use a Expressão do Filtro...</span><span class="sxs-lookup"><span data-stu-id="8f5d6-389">Use Filter Expression…</span></span> | <span data-ttu-id="8f5d6-390">A expressão se Aplica ao Log (Cliente, Servidor, Rede, Todos)</span><span class="sxs-lookup"><span data-stu-id="8f5d6-390">Expression Applies to Log (Client, Server,   Network, All)</span></span> |
| --- | --- | --- |
| <span data-ttu-id="8f5d6-391">Atrasos inesperados na entrega de mensagens em uma fila</span><span class="sxs-lookup"><span data-stu-id="8f5d6-391">Unexpected delays in message delivery on a queue</span></span> |<span data-ttu-id="8f5d6-392">AzureStorageClientDotNetV4.Description contém "Repetindo a operação que falhou".</span><span class="sxs-lookup"><span data-stu-id="8f5d6-392">AzureStorageClientDotNetV4.Description   contains "Retrying failed operation."</span></span> |<span data-ttu-id="8f5d6-393">Cliente</span><span class="sxs-lookup"><span data-stu-id="8f5d6-393">Client</span></span> |
| <span data-ttu-id="8f5d6-394">Aumento de HTTP no PercentThrottlingError</span><span class="sxs-lookup"><span data-stu-id="8f5d6-394">HTTP Increase in PercentThrottlingError</span></span> |<span data-ttu-id="8f5d6-395">HTTP.Response.StatusCode   == 500 &#124;&#124; HTTP.Response.StatusCode == 503</span><span class="sxs-lookup"><span data-stu-id="8f5d6-395">HTTP.Response.StatusCode   == 500 &#124;&#124; HTTP.Response.StatusCode == 503</span></span> |<span data-ttu-id="8f5d6-396">Rede</span><span class="sxs-lookup"><span data-stu-id="8f5d6-396">Network</span></span> |
| <span data-ttu-id="8f5d6-397">Aumento em PercentTimeoutError</span><span class="sxs-lookup"><span data-stu-id="8f5d6-397">Increase in PercentTimeoutError</span></span> |<span data-ttu-id="8f5d6-398">HTTP.Response.StatusCode   == 500</span><span class="sxs-lookup"><span data-stu-id="8f5d6-398">HTTP.Response.StatusCode   == 500</span></span> |<span data-ttu-id="8f5d6-399">Rede</span><span class="sxs-lookup"><span data-stu-id="8f5d6-399">Network</span></span> |
| <span data-ttu-id="8f5d6-400">Aumento em PercentTimeoutError (todos)</span><span class="sxs-lookup"><span data-stu-id="8f5d6-400">Increase in PercentTimeoutError (all)</span></span> |<span data-ttu-id="8f5d6-401">*StatusCode   == 500</span><span class="sxs-lookup"><span data-stu-id="8f5d6-401">*StatusCode   == 500</span></span> |<span data-ttu-id="8f5d6-402">Todos</span><span class="sxs-lookup"><span data-stu-id="8f5d6-402">All</span></span> |
| <span data-ttu-id="8f5d6-403">Aumento em PercentNetworkError</span><span class="sxs-lookup"><span data-stu-id="8f5d6-403">Increase in PercentNetworkError</span></span> |<span data-ttu-id="8f5d6-404">AzureStorageClientDotNetV4.EventLogEntry.Level   < 2</span><span class="sxs-lookup"><span data-stu-id="8f5d6-404">AzureStorageClientDotNetV4.EventLogEntry.Level   < 2</span></span> |<span data-ttu-id="8f5d6-405">Cliente</span><span class="sxs-lookup"><span data-stu-id="8f5d6-405">Client</span></span> |
| <span data-ttu-id="8f5d6-406">Mensagens HTTP 403 (Proibido)</span><span class="sxs-lookup"><span data-stu-id="8f5d6-406">HTTP 403 (Forbidden) messages</span></span> |<span data-ttu-id="8f5d6-407">HTTP.Response.StatusCode   == 403</span><span class="sxs-lookup"><span data-stu-id="8f5d6-407">HTTP.Response.StatusCode   == 403</span></span> |<span data-ttu-id="8f5d6-408">Rede</span><span class="sxs-lookup"><span data-stu-id="8f5d6-408">Network</span></span> |
| <span data-ttu-id="8f5d6-409">Mensagens HTTP 404 (Não encontrado)</span><span class="sxs-lookup"><span data-stu-id="8f5d6-409">HTTP 404 (Not found) messages</span></span> |<span data-ttu-id="8f5d6-410">HTTP.Response.StatusCode   == 404</span><span class="sxs-lookup"><span data-stu-id="8f5d6-410">HTTP.Response.StatusCode   == 404</span></span> |<span data-ttu-id="8f5d6-411">Rede</span><span class="sxs-lookup"><span data-stu-id="8f5d6-411">Network</span></span> |
| <span data-ttu-id="8f5d6-412">404 (todos)</span><span class="sxs-lookup"><span data-stu-id="8f5d6-412">404 (all)</span></span> |<span data-ttu-id="8f5d6-413">*StatusCode   == 404</span><span class="sxs-lookup"><span data-stu-id="8f5d6-413">*StatusCode   == 404</span></span> |<span data-ttu-id="8f5d6-414">Todos</span><span class="sxs-lookup"><span data-stu-id="8f5d6-414">All</span></span> |
| <span data-ttu-id="8f5d6-415">Problema de autorização de SAS (Assinatura de Acesso Compartilhado)</span><span class="sxs-lookup"><span data-stu-id="8f5d6-415">Shared Access Signature (SAS) authorization issue</span></span> |<span data-ttu-id="8f5d6-416">AzureStorageLog.RequestStatus ==  "SASAuthorizationError"</span><span class="sxs-lookup"><span data-stu-id="8f5d6-416">AzureStorageLog.RequestStatus ==  "SASAuthorizationError"</span></span> |<span data-ttu-id="8f5d6-417">Rede</span><span class="sxs-lookup"><span data-stu-id="8f5d6-417">Network</span></span> |
| <span data-ttu-id="8f5d6-418">Mensagens HTTP 409 (Conflito)</span><span class="sxs-lookup"><span data-stu-id="8f5d6-418">HTTP 409 (Conflict) messages</span></span> |<span data-ttu-id="8f5d6-419">HTTP.Response.StatusCode   == 409</span><span class="sxs-lookup"><span data-stu-id="8f5d6-419">HTTP.Response.StatusCode   == 409</span></span> |<span data-ttu-id="8f5d6-420">Rede</span><span class="sxs-lookup"><span data-stu-id="8f5d6-420">Network</span></span> |
| <span data-ttu-id="8f5d6-421">409 (todos)</span><span class="sxs-lookup"><span data-stu-id="8f5d6-421">409 (all)</span></span> |<span data-ttu-id="8f5d6-422">*StatusCode   == 409</span><span class="sxs-lookup"><span data-stu-id="8f5d6-422">*StatusCode   == 409</span></span> |<span data-ttu-id="8f5d6-423">Todos</span><span class="sxs-lookup"><span data-stu-id="8f5d6-423">All</span></span> |
| <span data-ttu-id="8f5d6-424">Baixo PercentSuccess ou as entradas de log analíticas têm operações com status de transação de ClientOtherErrors</span><span class="sxs-lookup"><span data-stu-id="8f5d6-424">Low PercentSuccess or analytics log entries have   operations with transaction status of ClientOtherErrors</span></span> |<span data-ttu-id="8f5d6-425">AzureStorageLog.RequestStatus ==   "ClientOtherError"</span><span class="sxs-lookup"><span data-stu-id="8f5d6-425">AzureStorageLog.RequestStatus ==   "ClientOtherError"</span></span> |<span data-ttu-id="8f5d6-426">Servidor</span><span class="sxs-lookup"><span data-stu-id="8f5d6-426">Server</span></span> |
| <span data-ttu-id="8f5d6-427">Aviso Nagle</span><span class="sxs-lookup"><span data-stu-id="8f5d6-427">Nagle   Warning</span></span> |<span data-ttu-id="8f5d6-428">((AzureStorageLog.EndToEndLatencyMS   - AzureStorageLog.ServerLatencyMS) > (AzureStorageLog.ServerLatencyMS *   1.5)) and (AzureStorageLog.RequestPacketSize <1460) and (AzureStorageLog.EndToEndLatencyMS -   AzureStorageLog.ServerLatencyMS >= 200)</span><span class="sxs-lookup"><span data-stu-id="8f5d6-428">((AzureStorageLog.EndToEndLatencyMS   - AzureStorageLog.ServerLatencyMS) > (AzureStorageLog.ServerLatencyMS *   1.5)) and (AzureStorageLog.RequestPacketSize <1460) and (AzureStorageLog.EndToEndLatencyMS -   AzureStorageLog.ServerLatencyMS >= 200)</span></span> |<span data-ttu-id="8f5d6-429">Servidor</span><span class="sxs-lookup"><span data-stu-id="8f5d6-429">Server</span></span> |
| <span data-ttu-id="8f5d6-430">Intervalo de horas nos logs de Servidor e Rede</span><span class="sxs-lookup"><span data-stu-id="8f5d6-430">Range of   time in Server and Network logs</span></span> |<span data-ttu-id="8f5d6-431">#Timestamp   >= 2014-10-20T16:36:38 e #Timestamp <= 2014-10-20T16:36:39</span><span class="sxs-lookup"><span data-stu-id="8f5d6-431">#Timestamp   >= 2014-10-20T16:36:38 and #Timestamp <= 2014-10-20T16:36:39</span></span> |<span data-ttu-id="8f5d6-432">Servidor, Rede</span><span class="sxs-lookup"><span data-stu-id="8f5d6-432">Server, Network</span></span> |
| <span data-ttu-id="8f5d6-433">Intervalo de horas nos logs de Servidor</span><span class="sxs-lookup"><span data-stu-id="8f5d6-433">Range of   time in Server logs</span></span> |<span data-ttu-id="8f5d6-434">AzureStorageLog.Timestamp   >= 2014-10-20T16:36:38 e AzureStorageLog.Timestamp <=   2014-10-20T16:36:39</span><span class="sxs-lookup"><span data-stu-id="8f5d6-434">AzureStorageLog.Timestamp   >= 2014-10-20T16:36:38 and AzureStorageLog.Timestamp <=   2014-10-20T16:36:39</span></span> |<span data-ttu-id="8f5d6-435">Servidor</span><span class="sxs-lookup"><span data-stu-id="8f5d6-435">Server</span></span> |

## <a name="next-steps"></a><span data-ttu-id="8f5d6-436">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="8f5d6-436">Next steps</span></span>
<span data-ttu-id="8f5d6-437">Para obter mais informações sobre cenários de ponta a ponta para solução de problemas no Armazenamento do Azure, consulte estes recursos:</span><span class="sxs-lookup"><span data-stu-id="8f5d6-437">For more information about troubleshooting end-to-end scenarios in Azure Storage, see these resources:</span></span>

* [<span data-ttu-id="8f5d6-438">Monitoramento, diagnóstico e solução de problemas de Armazenamento do Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="8f5d6-438">Monitor, diagnose, and troubleshoot Microsoft Azure Storage</span></span>](storage-monitoring-diagnosing-troubleshooting.md)
* [<span data-ttu-id="8f5d6-439">Análise de Armazenamento</span><span class="sxs-lookup"><span data-stu-id="8f5d6-439">Storage Analytics</span></span>](http://msdn.microsoft.com/library/azure/hh343270.aspx)
* [<span data-ttu-id="8f5d6-440">Monitorar uma conta de armazenamento no Portal do Azure</span><span class="sxs-lookup"><span data-stu-id="8f5d6-440">Monitor a storage account in the Azure Portal</span></span>](storage-monitor-storage-account.md)
* [<span data-ttu-id="8f5d6-441">Transferir dados com o utilitário de linha de comando AzCopy</span><span class="sxs-lookup"><span data-stu-id="8f5d6-441">Transfer data with the AzCopy command-line utility</span></span>](storage-use-azcopy.md)
* [<span data-ttu-id="8f5d6-442">Guia Operacional do Analisador de Mensagem da Microsoft</span><span class="sxs-lookup"><span data-stu-id="8f5d6-442">Microsoft Message Analyzer Operating Guide</span></span>](http://technet.microsoft.com/library/jj649776.aspx)
