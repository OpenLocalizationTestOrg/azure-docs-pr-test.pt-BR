---
title: "aaaBackup e recuperação de desastres para os discos do Azure IaaS | Microsoft Docs"
description: "Neste artigo, explicaremos como tooplan para Backup e recuperação de desastres (DR) de máquinas virtuais (VMs) e discos no Azure. Este documento aborda Discos Gerenciados e Discos Não Gerenciados"
services: storage
cloud: Azure
documentationcenter: na
author: luywang
manager: kavithag
ms.assetid: 
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/19/2017
ms.author: luywang
ms.openlocfilehash: 17c697bc411fb47c4b7483b59829af1c40732ac1
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="backup-and-disaster-recovery-for-azure-iaas-disks"></a><span data-ttu-id="53e22-104">Backup e recuperação de desastre de discos de IaaS do Azure</span><span class="sxs-lookup"><span data-stu-id="53e22-104">Backup and disaster recovery for Azure IaaS disks</span></span>

<span data-ttu-id="53e22-105">Neste artigo, explicaremos como tooplan para Backup e recuperação de desastres (DR) de máquinas virtuais (VMs) e discos no Azure.</span><span class="sxs-lookup"><span data-stu-id="53e22-105">In this article, we will explain how tooplan for Backup and Disaster Recovery (DR) of IaaS virtual machines (VMs) and Disks in Azure.</span></span> <span data-ttu-id="53e22-106">Este documento aborda Discos Gerenciados e Discos Não Gerenciados.</span><span class="sxs-lookup"><span data-stu-id="53e22-106">This document covers both Managed and Unmanaged Disks.</span></span>

<span data-ttu-id="53e22-107">Primeiro, falaremos sobre Olá falhas incorporada tolerância recursos em Olá plataforma Windows Azure que ajudam a proteger contra falhas locais.</span><span class="sxs-lookup"><span data-stu-id="53e22-107">We’ll first talk about hello built-in fault tolerance capabilities in hello Azure platform which help guard against local failures.</span></span> <span data-ttu-id="53e22-108">Em seguida, discutiremos os cenários de desastre Olá não totalmente cobertos pelo recursos internos de saudação, que é o tópico principal Olá, resolvido por este documento.</span><span class="sxs-lookup"><span data-stu-id="53e22-108">We’ll then discuss hello disaster scenarios not fully covered by hello built-in capabilities, which is hello main topic addressed by this document.</span></span> <span data-ttu-id="53e22-109">Também mostraremos vários exemplos de cenários de carga de trabalho nos quais diferentes considerações de Backup e DR podem se aplicar.</span><span class="sxs-lookup"><span data-stu-id="53e22-109">We’ll also show several examples of workload scenarios where different Backup and DR considerations may apply.</span></span> <span data-ttu-id="53e22-110">Depois, examinaremos possíveis soluções para DR de discos de IaaS.</span><span class="sxs-lookup"><span data-stu-id="53e22-110">We’ll then review possible solutions for DR of IaaS Disks.</span></span> 

## <a name="introduction"></a><span data-ttu-id="53e22-111">Introdução</span><span class="sxs-lookup"><span data-stu-id="53e22-111">Introduction</span></span>

<span data-ttu-id="53e22-112">Olá plataforma Windows Azure usa vários métodos para redundância e toohelp de tolerância a falhas proteger os clientes contra falhas de hardware localizadas que podem ocorrer.</span><span class="sxs-lookup"><span data-stu-id="53e22-112">hello Azure platform uses various methods for redundancy and fault tolerance toohelp protect customers from localized hardware failures that can occur.</span></span> <span data-ttu-id="53e22-113">Falhas locais podem incluir problemas com um computador de servidor de armazenamento do Azure que armazena a parte dos dados de saudação para um disco virtual ou falhas de um SSD ou HDD nesse servidor.</span><span class="sxs-lookup"><span data-stu-id="53e22-113">Local failures may include problems with an Azure storage server machine that stores part of hello data for a virtual disk or failures of an SSD or HDD on that server.</span></span> <span data-ttu-id="53e22-114">Essas falhas de componente de hardware isoladas podem ocorrer durante as operações normais e plataforma de saudação é projetado toobe toothese resiliente falhas.</span><span class="sxs-lookup"><span data-stu-id="53e22-114">Such isolated hardware component failures can happen during normal operations and hello platform is designed toobe resilient toothese failures.</span></span> <span data-ttu-id="53e22-115">Desastres graves podem resultar em falhas ou na incapacidade de acesso de um grande número de servidores de armazenamento ou de um datacenter inteiro.</span><span class="sxs-lookup"><span data-stu-id="53e22-115">Major disasters can result in failures or inaccessibility of a large numbers of storage servers or a whole datacenter.</span></span> <span data-ttu-id="53e22-116">Enquanto a suas máquinas virtuais e discos normalmente são protegidos contra falhas localizadas, etapas adicionais são necessária tooprotect sua carga de trabalho de toda a região de falhas catastróficas (por exemplo, um grande desastre) que pode afetar sua VM e discos.</span><span class="sxs-lookup"><span data-stu-id="53e22-116">While your VMs and disks are normally protected from localized failures, additional steps are necessary tooprotect your workload from region-wide catastrophic failures (such as a major disaster) that can affect your VM and disks.</span></span>

<span data-ttu-id="53e22-117">Além disso toohello a possibilidade de falhas de plataforma, com dados ou aplicativo de cliente hello podem ocorrer problemas.</span><span class="sxs-lookup"><span data-stu-id="53e22-117">In addition toohello possibility of platform failures, problems with hello customer application or data can occur.</span></span> <span data-ttu-id="53e22-118">Por exemplo, uma nova versão do seu aplicativo pode inadvertidamente tornar uma separação toohello dados de alteração.</span><span class="sxs-lookup"><span data-stu-id="53e22-118">For example, a new version of your application may inadvertently make a breaking change toohello data.</span></span> <span data-ttu-id="53e22-119">Nesse caso, convém aplicativo hello de toorevert e Olá dados tooa versão anterior contendo Olá último estado bom conhecido.</span><span class="sxs-lookup"><span data-stu-id="53e22-119">In that case, you may want toorevert hello application and hello data tooa prior version containing hello last known good state.</span></span> <span data-ttu-id="53e22-120">Isso exige a manutenção de backups regulares.</span><span class="sxs-lookup"><span data-stu-id="53e22-120">This requires maintaining regular backups.</span></span>

<span data-ttu-id="53e22-121">Para a recuperação de desastre regional, você deve fazer o backup de sua região do IaaS VM discos tooa diferente.</span><span class="sxs-lookup"><span data-stu-id="53e22-121">For regional disaster recovery, you must backup your IaaS VM disks tooa different region.</span></span> 

<span data-ttu-id="53e22-122">Antes de examinarmos as opções de Backup e DR, vamos recapitular alguns métodos disponíveis para o tratamento de falhas localizadas.</span><span class="sxs-lookup"><span data-stu-id="53e22-122">Before we look at Backup and DR options, let’s recap a few methods available for handling localized failures.</span></span>

### <a name="azure-iaas-resiliency"></a><span data-ttu-id="53e22-123">Resiliência de IaaS do Azure</span><span class="sxs-lookup"><span data-stu-id="53e22-123">Azure IaaS Resiliency</span></span>

<span data-ttu-id="53e22-124">*Resiliência* refere-se a toohello tolerância a falhas normais que ocorrem nos componentes de hardware.</span><span class="sxs-lookup"><span data-stu-id="53e22-124">*Resiliency* refers toohello tolerance for normal failures that occur in hardware components.</span></span> <span data-ttu-id="53e22-125">Resiliência é Olá toorecover de capacidade de falhas e continuar toofunction.</span><span class="sxs-lookup"><span data-stu-id="53e22-125">Resiliency is hello ability toorecover from failures and continue toofunction.</span></span> <span data-ttu-id="53e22-126">Não é sobre como evitar falhas, mas respondendo toofailures de uma maneira que evita o tempo de inatividade ou perda de dados.</span><span class="sxs-lookup"><span data-stu-id="53e22-126">It's not about avoiding failures, but responding toofailures in a way that avoids downtime or data loss.</span></span> <span data-ttu-id="53e22-127">meta de saudação de resiliência é tooreturn Olá tooa funcionando completamente o estado do aplicativo após uma falha.</span><span class="sxs-lookup"><span data-stu-id="53e22-127">hello goal of resiliency is tooreturn hello application tooa fully functioning state following a failure.</span></span> <span data-ttu-id="53e22-128">Máquinas virtuais do Azure e os discos são falhas de hardware projetado toobe toocommon resiliente.</span><span class="sxs-lookup"><span data-stu-id="53e22-128">Azure Virtual Machines and Disks are designed toobe resilient toocommon hardware faults.</span></span> <span data-ttu-id="53e22-129">Vamos dar uma olhada em como plataforma de IaaS do Azure Olá fornece essa capacidade de recuperação.</span><span class="sxs-lookup"><span data-stu-id="53e22-129">Let us look at how hello Azure IaaS platform provides this resiliency.</span></span>

<span data-ttu-id="53e22-130">Uma máquina virtual consiste principalmente em duas partes: (1) um servidor e discos persistentes hello (2) de computação.</span><span class="sxs-lookup"><span data-stu-id="53e22-130">A virtual machine consists mainly of two parts: (1) A compute server, and (2) hello persistent disks.</span></span> <span data-ttu-id="53e22-131">Ambos afetam a tolerância a falhas de saudação de uma máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="53e22-131">Both affect hello fault tolerance of a virtual machine.</span></span>

<span data-ttu-id="53e22-132">Se o servidor de host de computação do Azure Olá que hospeda a VM passa por uma falha de hardware (que é rara), o Azure é projetado tooautomatically restauração Olá VM em outro servidor.</span><span class="sxs-lookup"><span data-stu-id="53e22-132">If hello Azure compute host server that houses your VM experiences a hardware failure (which is rare), Azure is designed tooautomatically restore hello VM on another server.</span></span> <span data-ttu-id="53e22-133">Se isso acontecer, você terá uma reinicialização e Olá VM será feito backup após algum tempo.</span><span class="sxs-lookup"><span data-stu-id="53e22-133">If this happens, you will experience a reboot, and hello VM will be back up after some time.</span></span> <span data-ttu-id="53e22-134">Azure automaticamente detecta essas falhas de hardware e executa recuperações toohelp garantir cliente Olá VM estarão disponível assim que possível.</span><span class="sxs-lookup"><span data-stu-id="53e22-134">Azure automatically detects such hardware failures and executes recoveries toohelp ensure hello customer VM will be available as soon as possible.</span></span>

<span data-ttu-id="53e22-135">Em relação aos discos de IaaS, é fundamental para a plataforma de armazenamento persistente Olá durabilidade dos dados.</span><span class="sxs-lookup"><span data-stu-id="53e22-135">Regarding IaaS disks, durability of data is critical for hello persistent storage platform.</span></span> <span data-ttu-id="53e22-136">Clientes do Azure têm aplicativos de negócios importantes em execução em IaaS e eles dependem de persistência de saudação de dados de saudação.</span><span class="sxs-lookup"><span data-stu-id="53e22-136">Azure customers have important business applications running on IaaS and they depend on hello persistence of hello data.</span></span> <span data-ttu-id="53e22-137">O Azure projeta a proteção para esses discos de IaaS com três cópias redundantes dos dados armazenados localmente, fornecendo alta durabilidade contra falhas locais.</span><span class="sxs-lookup"><span data-stu-id="53e22-137">Azure designs protection for these IaaS disks with three redundant copies of data stored locally, providing high durability against local failures.</span></span> <span data-ttu-id="53e22-138">Se um dos componentes de hardware de saudação que contém o disco falhar, a VM não é afetada porque há duas cópias adicionais toosupport disco solicitações.</span><span class="sxs-lookup"><span data-stu-id="53e22-138">If one of hello hardware components that holds your disk fails, your VM is not impacted because there are two additional copies toosupport disk requests.</span></span> <span data-ttu-id="53e22-139">Ele funciona corretamente mesmo se dois componentes de hardware diferente, dando suporte a um disco falharem em Olá mesmo tempo (o que seria muito raro).</span><span class="sxs-lookup"><span data-stu-id="53e22-139">It works fine even if two different hardware components supporting a disk fail at hello same time (which would be very rare).</span></span> <span data-ttu-id="53e22-140">Verifique se toohelp sempre mantemos três réplicas, o serviço de armazenamento do Azure hello gera automaticamente uma nova cópia dos dados no plano de fundo de saudação se um dos três cópias de saudação ficar indisponível.</span><span class="sxs-lookup"><span data-stu-id="53e22-140">toohelp ensure we always maintain three replicas, hello Azure Storage service automatically spawns a new copy of data in hello background if one of hello three copies becomes unavailable.</span></span> <span data-ttu-id="53e22-141">Portanto, não deve ser necessário toouse RAID com discos do Azure para tolerância a falhas.</span><span class="sxs-lookup"><span data-stu-id="53e22-141">Therefore, it should not be necessary toouse RAID with Azure disks for fault tolerance.</span></span> <span data-ttu-id="53e22-142">Um simples de RAID 0 configuração deve ser suficiente para distribuição discos Olá se volumes maiores toocreate necessário.</span><span class="sxs-lookup"><span data-stu-id="53e22-142">A simple RAID 0 configuration should be sufficient for striping hello disks if necessary toocreate larger volumes.</span></span>

<span data-ttu-id="53e22-143">Devido a essa arquitetura, o **Azure proporcionou durabilidade de nível empresarial de modo consistente para discos de IaaS, com uma [Taxa de Falha Anualizada](https://en.wikipedia.org/wiki/Annualized_failure_rate) líder do setor de 0%.**</span><span class="sxs-lookup"><span data-stu-id="53e22-143">Because of this architecture, **Azure has consistently delivered enterprise-grade durability for IaaS disks, with an industry-leading ZERO % [Annualized Failure Rate](https://en.wikipedia.org/wiki/Annualized_failure_rate).**</span></span>

<span data-ttu-id="53e22-144">Falhas de hardware localizadas na saudação de computação de host ou no armazenamento de saudação plataforma às vezes pode resultar na indisponibilidade temporária para Olá VM que é coberto por Olá [SLA do Azure](https://azure.microsoft.com/support/legal/sla/virtual-machines/) para disponibilidade de VM.</span><span class="sxs-lookup"><span data-stu-id="53e22-144">Localized hardware faults on hello compute host or in hello storage platform can sometimes result in temporary unavailability for hello VM which is covered by hello [Azure SLA](https://azure.microsoft.com/support/legal/sla/virtual-machines/) for VM Availability.</span></span> <span data-ttu-id="53e22-145">O Azure também fornece um SLA líder do setor para instâncias de VM individuais que usam discos do Armazenamento Premium.</span><span class="sxs-lookup"><span data-stu-id="53e22-145">Azure also provides an industry-leading SLA for single VM instances that use Premium Storage disks.</span></span>

<span data-ttu-id="53e22-146">toosafeguard cargas de trabalho de aplicativo de tempo de inatividade devido a indisponibilidade temporária de um disco ou a VM toohello, os clientes podem aproveitar [conjuntos de disponibilidade](../virtual-machines/windows/manage-availability.md).</span><span class="sxs-lookup"><span data-stu-id="53e22-146">toosafeguard application workloads from downtime due toohello temporary unavailability of a disk or VM, customers can leverage [Availability Sets](../virtual-machines/windows/manage-availability.md).</span></span> <span data-ttu-id="53e22-147">Dois ou mais máquinas virtuais em um conjunto de disponibilidade fornece redundância para o aplicativo hello.</span><span class="sxs-lookup"><span data-stu-id="53e22-147">Two or more virtual machines in an availability set provides redundancy for hello application.</span></span> <span data-ttu-id="53e22-148">Em seguida, o Azure cria essas VMs e esses discos em domínios de falha separados com diferentes componentes de energia, rede e servidor.</span><span class="sxs-lookup"><span data-stu-id="53e22-148">Azure then creates these VMs and disks in separate fault domains with different power, network, and server components.</span></span> <span data-ttu-id="53e22-149">Assim, falhas de hardware localizadas geralmente não afetam várias VMs em Olá definido no hello simultaneamente, fornecendo alta disponibilidade para seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="53e22-149">Thus, localized hardware failures typically do not affect multiple VMs in hello set at hello same time, providing high availability for your application.</span></span> <span data-ttu-id="53e22-150">Ele é considerado que uma disponibilidade de uma boa prática toouse define quando a alta disponibilidade é necessária.</span><span class="sxs-lookup"><span data-stu-id="53e22-150">It is considered a good practice toouse availability sets when high availability is required.</span></span> <span data-ttu-id="53e22-151">Para obter mais informações, consulte aspectos de recuperação de desastres Olá detalhados abaixo.</span><span class="sxs-lookup"><span data-stu-id="53e22-151">For more information, see hello Disaster Recovery aspects detailed below.</span></span>

### <a name="backup-and-disaster-recovery"></a><span data-ttu-id="53e22-152">Backup e recuperação de desastre</span><span class="sxs-lookup"><span data-stu-id="53e22-152">Backup and Disaster Recovery</span></span>

<span data-ttu-id="53e22-153">Recuperação de desastres (DR) é Olá toorecover de capacidade de incidentes raras mas principais: falhas não transitório, de larga escala, como interrupções de serviço que afeta toda a região.</span><span class="sxs-lookup"><span data-stu-id="53e22-153">Disaster recovery (DR) is hello ability toorecover from rare but major incidents: non-transient, wide-scale failures, such as service disruption that affects an entire region.</span></span> <span data-ttu-id="53e22-154">A recuperação de desastre inclui backup e arquivamento de dados e pode incluir a intervenção manual, como a restauração um banco de dados com base em um backup.</span><span class="sxs-lookup"><span data-stu-id="53e22-154">Disaster recovery includes data backup and archiving, and may include manual intervention, such as restoring a database from backup.</span></span>

<span data-ttu-id="53e22-155">Hello a proteção interna da plataforma Azure contra falhas localizadas pode não proteger totalmente Olá VMs/discos no caso de saudação de grandes desastres que pode causar interrupções em larga escala.</span><span class="sxs-lookup"><span data-stu-id="53e22-155">hello Azure platform’s built-in protection against localized failures may not fully protect hello VMs/disks in hello case of major disasters which can cause large-scale outages.</span></span> <span data-ttu-id="53e22-156">Isso inclui eventos catastróficos, como um data center atingido por um furacão, terremoto, incêndio ou falhas de unidade de hardware em grande escala.</span><span class="sxs-lookup"><span data-stu-id="53e22-156">This includes catastrophic events such as a data center being hit by a hurricane, earthquake, fire, or large scale hardware unit failures.</span></span> <span data-ttu-id="53e22-157">Além disso, você pode encontrar falhas devido a problemas de tooapplication ou dados.</span><span class="sxs-lookup"><span data-stu-id="53e22-157">In addition, you may encounter failures due tooapplication or data issues.</span></span>

<span data-ttu-id="53e22-158">toohelp proteger suas cargas de trabalho de IaaS de interrupções, você deve planejar a recuperação de tooenable redundância e backups.</span><span class="sxs-lookup"><span data-stu-id="53e22-158">toohelp protect your IaaS workloads from outages, you should plan for redundancy and backups tooenable recovery.</span></span> <span data-ttu-id="53e22-159">Recuperação de desastres, você deve planejar backup em um local geográfico diferente para fora do site primário hello e redundância.</span><span class="sxs-lookup"><span data-stu-id="53e22-159">For disaster recovery, you should plan redundancy and backup in a different geographic location away from hello primary site.</span></span> <span data-ttu-id="53e22-160">Isso ajuda a garantir que o backup não é afetado por Olá mesmo evento que originalmente afetados Olá VM ou os discos.</span><span class="sxs-lookup"><span data-stu-id="53e22-160">This helps ensure your backup is not affected by hello same event that originally impacted hello VM or disks.</span></span> <span data-ttu-id="53e22-161">Para obter mais informações, consulte [Recuperação de desastre para aplicativos criados no Azure](https://docs.microsoft.com/azure/architecture/resiliency/disaster-recovery-azure-applications).</span><span class="sxs-lookup"><span data-stu-id="53e22-161">For more information, see [Disaster Recovery for Applications built on Azure](https://docs.microsoft.com/azure/architecture/resiliency/disaster-recovery-azure-applications).</span></span>

<span data-ttu-id="53e22-162">Suas considerações de recuperação de desastres podem incluir Olá aspectos a seguir:</span><span class="sxs-lookup"><span data-stu-id="53e22-162">Your DR considerations may include hello following aspects:</span></span>

1. <span data-ttu-id="53e22-163">Alta disponibilidade (HA) é a capacidade Olá Olá toocontinue de aplicativo em execução em um estado íntegro, sem tempo de inatividade significativo.</span><span class="sxs-lookup"><span data-stu-id="53e22-163">High Availability (HA) is hello ability of hello application toocontinue running in a healthy state, without significant downtime.</span></span> <span data-ttu-id="53e22-164">Por "estado de integridade", queremos dizer aplicativo hello está respondendo, e os usuários podem conectar-se o aplicativo toohello e interagir com ele.</span><span class="sxs-lookup"><span data-stu-id="53e22-164">By "healthy state," we mean hello application is responsive, and users can connect toohello application and interact with it.</span></span> <span data-ttu-id="53e22-165">Determinados aplicativos de missão crítica e bancos de dados podem ser necessário toobe disponível sempre, mesmo quando há falhas na plataforma de saudação.</span><span class="sxs-lookup"><span data-stu-id="53e22-165">Certain mission-critical applications and databases may be required toobe available always, even when there are failures in hello platform.</span></span> <span data-ttu-id="53e22-166">Para essas cargas de trabalho, talvez seja necessário tooplan redundância para o aplicativo hello, bem como dados de saudação.</span><span class="sxs-lookup"><span data-stu-id="53e22-166">For these workloads, you may need tooplan redundancy for hello application as well as hello data.</span></span>

2. <span data-ttu-id="53e22-167">Durabilidade de dados: Em alguns casos, consideração principal de saudação é garantir que dados saudação são preservados no caso de saudação de um desastre.</span><span class="sxs-lookup"><span data-stu-id="53e22-167">Data Durability: In some cases, hello main consideration is ensuring hello data is preserved in hello case of a disaster.</span></span> <span data-ttu-id="53e22-168">Portanto, talvez seja necessário fazer um backup dos dados em outro site.</span><span class="sxs-lookup"><span data-stu-id="53e22-168">Therefore, you may need a backup of your data in a different site.</span></span> <span data-ttu-id="53e22-169">Para essas cargas de trabalho, talvez não seja necessário redundância total para o aplicativo hello, mas um backup regular de discos de saudação.</span><span class="sxs-lookup"><span data-stu-id="53e22-169">For such workloads, you may not need full redundancy for hello application, but a regular backup of hello disks.</span></span>

## <a name="backup-and-dr-scenarios"></a><span data-ttu-id="53e22-170">Cenários de backup e DR</span><span class="sxs-lookup"><span data-stu-id="53e22-170">Backup and DR Scenarios</span></span>

<span data-ttu-id="53e22-171">Vamos examinar alguns exemplos comuns de cenários de carga de trabalho do aplicativo e considerações de saudação para o planejamento de recuperação de desastres.</span><span class="sxs-lookup"><span data-stu-id="53e22-171">Let’s look at a few typical examples of application workload scenarios and hello considerations for planning Disaster Recovery.</span></span>

### <a name="scenario-1-major-database-solutions"></a><span data-ttu-id="53e22-172">Cenário 1: principais soluções de banco de dados</span><span class="sxs-lookup"><span data-stu-id="53e22-172">Scenario 1: Major Database Solutions</span></span>

<span data-ttu-id="53e22-173">Considere um servidor de banco de dados de produção como o SQL Server ou o Oracle que pode dar suporte à Alta Disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="53e22-173">Consider a production database server like SQL Server or Oracle that can support High Availability.</span></span> <span data-ttu-id="53e22-174">Usuários e aplicativos de produção críticos dependem desse banco de dados.</span><span class="sxs-lookup"><span data-stu-id="53e22-174">Critical production applications and users depend on this database.</span></span> <span data-ttu-id="53e22-175">plano de recuperação de desastres Olá para este sistema talvez seja necessário Olá toosupport requisitos a seguir:</span><span class="sxs-lookup"><span data-stu-id="53e22-175">hello Disaster Recovery plan for this system may need toosupport hello following requirements:</span></span>

1. <span data-ttu-id="53e22-176">Os dados devem ser protegidos e recuperáveis.</span><span class="sxs-lookup"><span data-stu-id="53e22-176">Data must be protected and recoverable.</span></span>
2.  <span data-ttu-id="53e22-177">O servidor deve estar disponível para uso.</span><span class="sxs-lookup"><span data-stu-id="53e22-177">Server must be available for use.</span></span>

<span data-ttu-id="53e22-178">Isso pode exigir a manutenção de uma réplica de banco de dados de saudação em uma região diferente, como um backup.</span><span class="sxs-lookup"><span data-stu-id="53e22-178">This may require maintaining a replica of hello database in a different region as a backup.</span></span> <span data-ttu-id="53e22-179">Dependendo dos requisitos de saudação para recuperação de dados e a disponibilidade do servidor, a solução Olá poderia variar de um ativo ou ativo-passivo réplica site tooperiodic backups offline de dados de saudação.</span><span class="sxs-lookup"><span data-stu-id="53e22-179">Depending on hello requirements for server availability and data recovery, hello solution could range from an Active-Active or Active-Passive replica site tooperiodic offline backups of hello data.</span></span> <span data-ttu-id="53e22-180">Bancos de dados relacionais, como o SQL Server e o Oracle, fornecem várias opções de replicação.</span><span class="sxs-lookup"><span data-stu-id="53e22-180">Relational databases such as SQL Server and Oracle provide various options for replication.</span></span> <span data-ttu-id="53e22-181">Para o SQL Server, [Grupos de Disponibilidade AlwaysOn do SQL Server](https://msdn.microsoft.com/library/hh510230.aspx) podem ser usados para alta disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="53e22-181">For SQL Server, [SQL Server Always On Availability Groups](https://msdn.microsoft.com/library/hh510230.aspx) can be used for high availability.</span></span>

<span data-ttu-id="53e22-182">Bancos de dados NoSQL como o MongoDB também dão suporte a [réplicas](https://docs.mongodb.com/manual/replication/) para redundância.</span><span class="sxs-lookup"><span data-stu-id="53e22-182">NoSQL databases like MongoDB also support [replicas](https://docs.mongodb.com/manual/replication/) for redundancy.</span></span> <span data-ttu-id="53e22-183">réplicas Olá para alta disponibilidade podem ser usadas.</span><span class="sxs-lookup"><span data-stu-id="53e22-183">hello replicas for high availability can be used.</span></span>

### <a name="scenario-2-a-cluster-of-redundant-vms"></a><span data-ttu-id="53e22-184">Cenário 2: um cluster de VMs redundantes</span><span class="sxs-lookup"><span data-stu-id="53e22-184">Scenario 2: A cluster of redundant VMs</span></span>

<span data-ttu-id="53e22-185">Considere uma carga de trabalho manipulada por um cluster de VMs que fornece redundância e balanceamento de carga.</span><span class="sxs-lookup"><span data-stu-id="53e22-185">Consider a workload handled by a cluster of VMs that provide redundancy and load balancing.</span></span> <span data-ttu-id="53e22-186">Um exemplo seria um cluster do Cassandra implantado em uma região.</span><span class="sxs-lookup"><span data-stu-id="53e22-186">One example would be a Cassandra cluster deployed in a region.</span></span> <span data-ttu-id="53e22-187">Esse tipo de arquitetura já fornece um alto nível de redundância nessa região.</span><span class="sxs-lookup"><span data-stu-id="53e22-187">This type of architecture already provides a high level of redundancy within that region.</span></span> <span data-ttu-id="53e22-188">No entanto, tooprotect carga de trabalho de saudação de uma falha de nível regional, você deve considerar se espalhando cluster Olá em duas regiões ou tornar backups periódicos tooanother região.</span><span class="sxs-lookup"><span data-stu-id="53e22-188">However, tooprotect hello workload from a regional level failure, you should consider spreading hello cluster across two regions or making periodic backups tooanother region.</span></span>

### <a name="scenario-3-iaas-application-workload"></a><span data-ttu-id="53e22-189">Cenário 3: carga de trabalho de aplicativos IaaS</span><span class="sxs-lookup"><span data-stu-id="53e22-189">Scenario 3: IaaS Application Workload</span></span>

<span data-ttu-id="53e22-190">Isso pode ser uma carga de trabalho de produção típica em execução em uma VM do Azure.</span><span class="sxs-lookup"><span data-stu-id="53e22-190">This could be a typical production workload running on an Azure VM.</span></span> <span data-ttu-id="53e22-191">Por exemplo, poderia ser um servidor web ou servidor de arquivo contém conteúdo hello e outros recursos de um site.</span><span class="sxs-lookup"><span data-stu-id="53e22-191">For example, it could be a web server or file server holding hello content and other resources of a site.</span></span> <span data-ttu-id="53e22-192">Ele também pode ser um aplicativo de negócios personalizados executados em uma VM que armazenados seus dados, recursos e o estado do aplicativo em discos VM hello.</span><span class="sxs-lookup"><span data-stu-id="53e22-192">It could also be a custom-built business application running on a VM that stored its data, resources, and application state on hello VM disks.</span></span> <span data-ttu-id="53e22-193">Nesse caso, é importante toomake-se de que você faça backups regularmente.</span><span class="sxs-lookup"><span data-stu-id="53e22-193">In this case, it is important toomake sure you take backups on a regular basis.</span></span> <span data-ttu-id="53e22-194">Frequência de backup deve ser baseada na natureza de saudação de carga de trabalho VM hello.</span><span class="sxs-lookup"><span data-stu-id="53e22-194">Backup frequency should be based on hello nature of hello VM workload.</span></span> <span data-ttu-id="53e22-195">Por exemplo, se o aplicativo hello é executada diariamente e modifica dados, em seguida, backup Olá cuidado a cada hora.</span><span class="sxs-lookup"><span data-stu-id="53e22-195">For example, if hello application runs every day and modifies data, then hello backup should be taken every hour.</span></span>

<span data-ttu-id="53e22-196">Outro exemplo é um servidor de relatórios que efetua pull de dados de outras fontes e gera relatórios agregados.</span><span class="sxs-lookup"><span data-stu-id="53e22-196">Another example is a reporting server that pull data from other sources and generates aggregated reports.</span></span> <span data-ttu-id="53e22-197">Perda dessa VM ou discos levará toohello perda de saudação relatórios.</span><span class="sxs-lookup"><span data-stu-id="53e22-197">Loss of this VM or disks will lead toohello loss of hello reports.</span></span> <span data-ttu-id="53e22-198">No entanto, pode ser toorerun possíveis Olá relatórios de processo e a saída de hello regenerar.</span><span class="sxs-lookup"><span data-stu-id="53e22-198">However, it may be possible toorerun hello reporting process and regenerate hello output.</span></span> <span data-ttu-id="53e22-199">Nesse caso, você realmente não tem uma perda de dados, mesmo se o servidor de relatórios de saudação é atingido com um desastre, portanto você pode ter um nível mais alto de tolerância da perda de parte de dados Olá Olá reporting server.</span><span class="sxs-lookup"><span data-stu-id="53e22-199">In that case, you don’t really have a loss of data even if hello reporting server is hit with a disaster, so you could have a higher level of tolerance for losing part of hello data on hello reporting server.</span></span> <span data-ttu-id="53e22-200">Nesse caso, menos frequentes backups é um custo de saudação tooreduce opção.</span><span class="sxs-lookup"><span data-stu-id="53e22-200">In that case, less frequent backups is an option tooreduce hello cost.</span></span>

### <a name="scenario-4-iaas-application-data-issues"></a><span data-ttu-id="53e22-201">Cenário 4: problemas de dados de aplicativos IaaS</span><span class="sxs-lookup"><span data-stu-id="53e22-201">Scenario 4: IaaS Application data issues</span></span>

<span data-ttu-id="53e22-202">Você tem um aplicativo que calcula, mantém e fornece dados comerciais críticos, como informações sobre preços.</span><span class="sxs-lookup"><span data-stu-id="53e22-202">You have an application that computes, maintains, and serves critical commercial data such as pricing information.</span></span> <span data-ttu-id="53e22-203">Uma nova versão do seu aplicativo tinha um bug do software que incorretamente computada Olá preços e Olá existente commerce dados servidos por plataforma Olá corrompidos.</span><span class="sxs-lookup"><span data-stu-id="53e22-203">A new version of your application had a software bug which incorrectly computed hello pricing and corrupted hello existing commerce data served by hello platform.</span></span> <span data-ttu-id="53e22-204">Aqui, melhor o curso de ação Olá seria toorevert toohello versão anterior do aplicativo hello e dados saudação primeiro.</span><span class="sxs-lookup"><span data-stu-id="53e22-204">Here, hello best course of action would be toorevert toohello earlier version of hello application and hello data first.</span></span> <span data-ttu-id="53e22-205">tooenable, backups periódicos de tirar do seu sistema.</span><span class="sxs-lookup"><span data-stu-id="53e22-205">tooenable this, take periodic backups of your system.</span></span>

## <a name="disaster-recovery-solution-azure-backup-service"></a><span data-ttu-id="53e22-206">Solução de Recuperação de Desastre: Serviço de Backup do Azure</span><span class="sxs-lookup"><span data-stu-id="53e22-206">Disaster Recovery Solution: Azure Backup Service</span></span>

<span data-ttu-id="53e22-207">O [Serviço de Backup do Azure](https://azure.microsoft.com/services/backup/) pode ser usado para Backup e DR e funciona com [Managed Disks](storage-managed-disks-overview.md), bem como com [Discos Não Gerenciados](storage-about-disks-and-vhds-windows.md#unmanaged-disks).</span><span class="sxs-lookup"><span data-stu-id="53e22-207">[Azure Backup Service](https://azure.microsoft.com/services/backup/) is can be used for Backup and DR, and it works with [Managed Disks](storage-managed-disks-overview.md) as well as [Unmanaged Disks](storage-about-disks-and-vhds-windows.md#unmanaged-disks).</span></span> <span data-ttu-id="53e22-208">Crie um trabalho de backup com backups baseados em tempo, fácil restauração de VM e políticas de retenção de backup.</span><span class="sxs-lookup"><span data-stu-id="53e22-208">You can create a backup job with time-based backups, easy VM restoration and backup retention policies.</span></span> 

<span data-ttu-id="53e22-209">Se você usar [discos de armazenamento Premium](storage-premium-storage.md), [discos gerenciados](storage-managed-disks-overview.md), ou outros tipos de disco com hello [armazenamento localmente redundante (LRS)](storage-redundancy.md#locally-redundant-storage) opção é especialmente importante tooleverage backups periódicos de recuperação de desastres.</span><span class="sxs-lookup"><span data-stu-id="53e22-209">If you use [Premium Storage disks](storage-premium-storage.md), [Managed Disks](storage-managed-disks-overview.md), or other disk types with hello [locally redundant storage (LRS)](storage-redundancy.md#locally-redundant-storage) option, it is especially important tooleverage periodic DR backups.</span></span> <span data-ttu-id="53e22-210">Backup do Azure armazena dados saudação em seu Cofre de serviços de recuperação para retenção de longo prazo.</span><span class="sxs-lookup"><span data-stu-id="53e22-210">Azure Backup stores hello data in your Recovery Services vault for long term retention.</span></span> <span data-ttu-id="53e22-211">Escolha Olá [armazenamento com redundância geográfica (GRS)](storage-redundancy.md#geo-redundant-storage) opção Olá serviços de recuperação de Backup do cofre.</span><span class="sxs-lookup"><span data-stu-id="53e22-211">Choose hello [Geo-redundant storage (GRS)](storage-redundancy.md#geo-redundant-storage) option for hello Backup Recovery Services vault.</span></span> <span data-ttu-id="53e22-212">Isso vai garantir que os backups são replicados tooa outra região do Azure para proteger contra desastres regionais.</span><span class="sxs-lookup"><span data-stu-id="53e22-212">That will ensure backups are replicated tooa different Azure region for safeguarding from regional disasters.</span></span>

<span data-ttu-id="53e22-213">Para [discos não gerenciado](storage-about-disks-and-vhds-windows.md#unmanaged-disks), você pode usar o tipo de armazenamento LRS Olá para discos de IaaS, mas certifique-se de que o Backup do Azure está habilitado com hello opção GRS Olá Cofre de serviços de recuperação.</span><span class="sxs-lookup"><span data-stu-id="53e22-213">For [Unmanaged Disks](storage-about-disks-and-vhds-windows.md#unmanaged-disks), you can use hello LRS storage type for IaaS disks, but ensure that Azure Backup is enabled with hello GRS option for hello Recovery Services Vault.</span></span>

<span data-ttu-id="53e22-214">**Se você usar o hello [GRS](storage-redundancy.md#geo-redundant-storage)/[RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage) opção para os discos não gerenciado, você ainda precisa de instantâneos consistentes para Backup e recuperação de desastres.**</span><span class="sxs-lookup"><span data-stu-id="53e22-214">**If you use hello [GRS](storage-redundancy.md#geo-redundant-storage)/[RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage) option for your Unmanaged Disks, you still need consistent snapshots for Backup and DR.**</span></span> <span data-ttu-id="53e22-215">Use o [Serviço de Backup do Azure](https://azure.microsoft.com/services/backup/) ou [instantâneos consistentes](#alternative-solution-consistent-snapshots).</span><span class="sxs-lookup"><span data-stu-id="53e22-215">You must use either [Azure Backup Service](https://azure.microsoft.com/services/backup/) or [consistent snapshots](#alternative-solution-consistent-snapshots).</span></span>

<span data-ttu-id="53e22-216">a seguir Olá é um resumo das soluções para recuperação de desastres.</span><span class="sxs-lookup"><span data-stu-id="53e22-216">hello following is a summary of solutions for DR.</span></span>

| <span data-ttu-id="53e22-217">Cenário</span><span class="sxs-lookup"><span data-stu-id="53e22-217">Scenario</span></span> | <span data-ttu-id="53e22-218">Replicação automática</span><span class="sxs-lookup"><span data-stu-id="53e22-218">Automatic Replication</span></span> | <span data-ttu-id="53e22-219">Solução de DR</span><span class="sxs-lookup"><span data-stu-id="53e22-219">DR Solution</span></span> |
| --- | --- | --- |
| <span data-ttu-id="53e22-220">*Discos do Armazenamento Premium*</span><span class="sxs-lookup"><span data-stu-id="53e22-220">*Premium Storage Disks*</span></span> | <span data-ttu-id="53e22-221">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="53e22-221">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span></span> | [<span data-ttu-id="53e22-222">Serviço de Backup do Azure</span><span class="sxs-lookup"><span data-stu-id="53e22-222">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/) |
| <span data-ttu-id="53e22-223">*Managed Disks*</span><span class="sxs-lookup"><span data-stu-id="53e22-223">*Managed Disks*</span></span> | <span data-ttu-id="53e22-224">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="53e22-224">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span></span> | [<span data-ttu-id="53e22-225">Serviço de Backup do Azure</span><span class="sxs-lookup"><span data-stu-id="53e22-225">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/) |
| <span data-ttu-id="53e22-226">*Discos LRS Não Gerenciados*</span><span class="sxs-lookup"><span data-stu-id="53e22-226">*Unmanaged LRS Disks*</span></span> | <span data-ttu-id="53e22-227">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="53e22-227">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span></span> | [<span data-ttu-id="53e22-228">Serviço de Backup do Azure</span><span class="sxs-lookup"><span data-stu-id="53e22-228">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/) |
| <span data-ttu-id="53e22-229">*Discos GRS Não Gerenciados*</span><span class="sxs-lookup"><span data-stu-id="53e22-229">*Unmanaged GRS Disks*</span></span> | <span data-ttu-id="53e22-230">Várias regiões ([GRS](storage-redundancy.md#geo-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="53e22-230">Cross region ([GRS](storage-redundancy.md#geo-redundant-storage))</span></span> | [<span data-ttu-id="53e22-231">Serviço de Backup do Azure</span><span class="sxs-lookup"><span data-stu-id="53e22-231">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/)<br/>[<span data-ttu-id="53e22-232">Instantâneos consistentes</span><span class="sxs-lookup"><span data-stu-id="53e22-232">Consistent snapshots</span></span>](#alternative-solution-consistent-snapshots) |
| <span data-ttu-id="53e22-233">*Discos RA-GRS Não Gerenciados*</span><span class="sxs-lookup"><span data-stu-id="53e22-233">*Unmanaged RA-GRS Disks*</span></span> | <span data-ttu-id="53e22-234">Várias regiões ([RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="53e22-234">Cross region ([RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage))</span></span> | [<span data-ttu-id="53e22-235">Serviço de Backup do Azure</span><span class="sxs-lookup"><span data-stu-id="53e22-235">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/)<br/>[<span data-ttu-id="53e22-236">Instantâneos consistentes</span><span class="sxs-lookup"><span data-stu-id="53e22-236">Consistent snapshots</span></span>](#alternative-solution-consistent-snapshots) |

<span data-ttu-id="53e22-237">Alta disponibilidade por melhor pode atendido por meio do uso de saudação de discos gerenciado em um conjunto de disponibilidade junto com o Backup do Azure.</span><span class="sxs-lookup"><span data-stu-id="53e22-237">High availability can best by met through hello use of Managed Disks in an Availability Set along with Azure Backup.</span></span> <span data-ttu-id="53e22-238">Se você estiver usando Discos Não Gerenciados, ainda poderá usar o Backup do Azure para DR.</span><span class="sxs-lookup"><span data-stu-id="53e22-238">If you are using Unmanaged Disks, you can still  use Azure Backup for DR.</span></span> <span data-ttu-id="53e22-239">Se você não é possível toouse Backup do Azure, tirar [instantâneos consistentes](#alternative-solution-consistent-snapshots) conforme descrito em uma seção posterior é uma solução alternativa para Backup e recuperação de desastres.</span><span class="sxs-lookup"><span data-stu-id="53e22-239">If you are unable toouse Azure Backup, then taking [consistent snapshots](#alternative-solution-consistent-snapshots) as described in a later section is an alternative solution for Backup and DR.</span></span>

<span data-ttu-id="53e22-240">Suas escolhas de alta disponibilidade, backup e DR nos níveis do Aplicativo ou da Infraestrutura podem ser representadas conforme mostrado abaixo:</span><span class="sxs-lookup"><span data-stu-id="53e22-240">Your choices for high availability, backup and DR at Application or Infrastructure levels can be represented as below:</span></span>

| <span data-ttu-id="53e22-241">*Level*</span><span class="sxs-lookup"><span data-stu-id="53e22-241">*Level*</span></span> | <span data-ttu-id="53e22-242">Alta disponibilidade</span><span class="sxs-lookup"><span data-stu-id="53e22-242">High Availability</span></span>   | <span data-ttu-id="53e22-243">Backup/DR</span><span class="sxs-lookup"><span data-stu-id="53e22-243">Backup / DR</span></span> |
| --- | --- | --- |
| <span data-ttu-id="53e22-244">*Aplicativo*</span><span class="sxs-lookup"><span data-stu-id="53e22-244">*Application*</span></span> | <span data-ttu-id="53e22-245">SQL AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="53e22-245">SQL Always On</span></span> | <span data-ttu-id="53e22-246">Serviço de Backup do Azure</span><span class="sxs-lookup"><span data-stu-id="53e22-246">Azure Backup</span></span> |
| <span data-ttu-id="53e22-247">*Infraestrutura*</span><span class="sxs-lookup"><span data-stu-id="53e22-247">*Infrastructure*</span></span>  | <span data-ttu-id="53e22-248">Conjunto de disponibilidade</span><span class="sxs-lookup"><span data-stu-id="53e22-248">Availability Set</span></span>  | <span data-ttu-id="53e22-249">GRS com instantâneos consistentes</span><span class="sxs-lookup"><span data-stu-id="53e22-249">GRS with consistent snapshots</span></span> |

### <a name="using-hello-azure-backup-service"></a><span data-ttu-id="53e22-250">Usando hello Azure Backup Service</span><span class="sxs-lookup"><span data-stu-id="53e22-250">Using hello Azure Backup Service</span></span>

<span data-ttu-id="53e22-251">[O Backup do Azure](../backup/backup-azure-vms-introduction.md) pode fazer backup de suas VMs executando o Windows ou Linux toohello Cofre de serviços de recuperação do Azure.</span><span class="sxs-lookup"><span data-stu-id="53e22-251">[Azure Backup](../backup/backup-azure-vms-introduction.md) can backup your VMs running Windows or Linux toohello Azure Recovery Services Vault.</span></span> <span data-ttu-id="53e22-252">Fazendo backup e restaurando dados críticos de negócios é complicada pelo fato de saudação dados críticos de negócios devem ser feitos enquanto os aplicativos de saudação que produzem Olá dados estão em execução.</span><span class="sxs-lookup"><span data-stu-id="53e22-252">Backing up and restoring business-critical data is complicated by hello fact that business-critical data must be backed up while hello applications that produce hello data are running.</span></span> <span data-ttu-id="53e22-253">tooaddress, Backup do Azure fornece backups consistentes com o aplicativo para cargas de trabalho da Microsoft usando tooensure de serviço de sombra de Volume (VSS) do hello que dados sejam gravados corretamente toostorage.</span><span class="sxs-lookup"><span data-stu-id="53e22-253">tooaddress this, Azure Backup provides application-consistent backups for Microsoft workloads by using hello Volume Shadow Service (VSS) tooensure that data is written correctly toostorage.</span></span> <span data-ttu-id="53e22-254">Para VMs do Linux, apenas os backups consistentes de arquivos são possíveis, como Linux não tem tooVSS de funcionalidade equivalente.</span><span class="sxs-lookup"><span data-stu-id="53e22-254">For Linux VMs, only file-consistent backups are possible, since Linux does not have functionality equivalent tooVSS.</span></span>

![][1]

<span data-ttu-id="53e22-255">Quando o Backup do Azure inicia um trabalho de backup no tempo de saudação agendado, ela aciona extensão de backup Olá instalado na VM tootake um instantâneo point-in-time de saudação.</span><span class="sxs-lookup"><span data-stu-id="53e22-255">When Azure Backup initiates a backup job at hello scheduled time, it triggers hello backup extension installed in hello VM tootake a point-in-time snapshot.</span></span> <span data-ttu-id="53e22-256">Um instantâneo é tirado em coordenação com VSS tooget um instantâneo consistente de discos Olá na máquina virtual de saudação sem ter que tooshut-para baixo.</span><span class="sxs-lookup"><span data-stu-id="53e22-256">A snapshot is taken in coordination with VSS tooget a consistent snapshot of hello disks in hello virtual machine without having tooshut it down.</span></span> <span data-ttu-id="53e22-257">extensão de backup Olá no hello VM libera todas as gravações antes de tirar um instantâneo consistente de saudação de todos os discos de saudação.</span><span class="sxs-lookup"><span data-stu-id="53e22-257">hello backup extension in hello VM flushes all writes before taking hello consistent snapshot of all hello disks.</span></span> <span data-ttu-id="53e22-258">Depois de saudação instantâneo é tirado, dados de saudação são transferidos por Cofre de backup do Azure Backup toohello.</span><span class="sxs-lookup"><span data-stu-id="53e22-258">After hello snapshot is taken, hello data is transferred by Azure Backup toohello backup vault.</span></span> <span data-ttu-id="53e22-259">toomake Olá processo de backup mais eficiente, serviço Olá identifica e transfere apenas os blocos de dados que foram alterados desde o último backup de Olá Olá.</span><span class="sxs-lookup"><span data-stu-id="53e22-259">toomake hello backup process more efficient, hello service identifies and transfers only hello blocks of data that have changed since hello last backup.</span></span>


<span data-ttu-id="53e22-260">toorestore, você pode exibir os backups disponíveis por meio do Backup do Azure hello e, em seguida, inicie uma restauração.</span><span class="sxs-lookup"><span data-stu-id="53e22-260">toorestore, you can view hello available backups through Azure Backup and then initiate a restore.</span></span> <span data-ttu-id="53e22-261">Você pode criar e restaurar backups do Azure por meio de saudação [portal do Azure](https://portal.azure.com/), [usando o PowerShell](../backup/backup-azure-vms-automation.md ), ou usando Olá [CLI do Azure](https://docs.microsoft.com/azure/xplat-cli-install).</span><span class="sxs-lookup"><span data-stu-id="53e22-261">You can create and restore Azure backups through hello [Azure portal](https://portal.azure.com/), [using PowerShell](../backup/backup-azure-vms-automation.md ), or using hello [Azure CLI](https://docs.microsoft.com/azure/xplat-cli-install).</span></span> <span data-ttu-id="53e22-262">Para obter mais informações, consulte Backup do Azure.</span><span class="sxs-lookup"><span data-stu-id="53e22-262">For more information, see Azure Backup.</span></span>

### <a name="steps-tooenable-backup"></a><span data-ttu-id="53e22-263">Etapas tooEnable Backup</span><span class="sxs-lookup"><span data-stu-id="53e22-263">Steps tooEnable Backup</span></span>

<span data-ttu-id="53e22-264">Olá, etapas a seguir são tooenable geralmente usados backups de suas VMs usando Olá [Portal do Azure](https://portal.azure.com/).</span><span class="sxs-lookup"><span data-stu-id="53e22-264">hello following steps are typically used tooenable backups of your VMs using hello [Azure Portal](https://portal.azure.com/).</span></span> <span data-ttu-id="53e22-265">Haverá algumas variações dependendo do cenário exato.</span><span class="sxs-lookup"><span data-stu-id="53e22-265">There will be some variations depending on your exact scenario.</span></span> <span data-ttu-id="53e22-266">Consulte toohello [Backup do Azure](../backup/backup-azure-vms-introduction.md) documentação para obter detalhes completos.</span><span class="sxs-lookup"><span data-stu-id="53e22-266">Refer toohello [Azure Backup](../backup/backup-azure-vms-introduction.md) documentation for full details.</span></span> <span data-ttu-id="53e22-267">O Backup do Azure também [dá suporte a VMs com o Managed Disks](https://azure.microsoft.com/blog/azure-managed-disk-backup/).</span><span class="sxs-lookup"><span data-stu-id="53e22-267">Azure Backup also [supports VMs with Managed Disks](https://azure.microsoft.com/blog/azure-managed-disk-backup/).</span></span>

1.  <span data-ttu-id="53e22-268">Crie um cofre de serviços de recuperação para uma VM usando Olá etapas a seguir:</span><span class="sxs-lookup"><span data-stu-id="53e22-268">Create a recovery services vault for a VM using hello following steps:</span></span>

    <span data-ttu-id="53e22-269">a.</span><span class="sxs-lookup"><span data-stu-id="53e22-269">a.</span></span>  <span data-ttu-id="53e22-270">Usando Olá [portal do Azure](https://portal.azure.com/), procurar todos os recursos e localizar "Cofres de serviços de recuperação".</span><span class="sxs-lookup"><span data-stu-id="53e22-270">Using hello [Azure portal](https://portal.azure.com/), browse all resources and find “Recovery Services vaults”.</span></span>

    <span data-ttu-id="53e22-271">b.</span><span class="sxs-lookup"><span data-stu-id="53e22-271">b.</span></span>  <span data-ttu-id="53e22-272">Em Olá menu os cofres de serviços de recuperação, clique em Adicionar e siga Olá etapas toocreate um novo cofre em Olá Olá VM mesma região.</span><span class="sxs-lookup"><span data-stu-id="53e22-272">On hello Recovery Services vaults menu, click Add and follow hello steps toocreate a new vault in hello same region as hello VM.</span></span> <span data-ttu-id="53e22-273">Por exemplo, se a VM estiver na região Oeste dos EUA, escolha Oeste dos EUA para o cofre hello.</span><span class="sxs-lookup"><span data-stu-id="53e22-273">For example, if your VM is in West US region, pick West US for hello vault.</span></span>

2.  <span data-ttu-id="53e22-274">Verifique se a replicação de armazenamento Olá para Olá recém-criado cofre.</span><span class="sxs-lookup"><span data-stu-id="53e22-274">Verify hello Storage replication for hello newly created vault.</span></span> <span data-ttu-id="53e22-275">toodo, acesso Olá Cofre de saudação dos serviços de recuperação cofres folha e ir toohello configurações/Backup configuração.</span><span class="sxs-lookup"><span data-stu-id="53e22-275">toodo this, access hello vault from hello Recovery Services vaults blade and go toohello settings/Backup Configuration.</span></span> <span data-ttu-id="53e22-276">Certifique-se de saudação opção GRS é selecionada por padrão.</span><span class="sxs-lookup"><span data-stu-id="53e22-276">Ensure hello GRS option is selected by default.</span></span> <span data-ttu-id="53e22-277">Isso irá garantir que seu cofre é automaticamente replicados tooa data center secundário.</span><span class="sxs-lookup"><span data-stu-id="53e22-277">This will ensure that your vault is automatically replicated tooa secondary data center.</span></span> <span data-ttu-id="53e22-278">Por exemplo, o cofre no Oeste dos EUA será replicada automaticamente tooEast dos EUA.</span><span class="sxs-lookup"><span data-stu-id="53e22-278">For example, your vault in West US will be automatically replicated tooEast US.</span></span>

3.  <span data-ttu-id="53e22-279">Configurar a política de backup hello e selecione Olá VM da saudação mesma interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="53e22-279">Configure hello backup policy and select hello VM from hello same UI.</span></span>

4.  <span data-ttu-id="53e22-280">Verifique se Olá que backup Agent está instalado na VM de saudação.</span><span class="sxs-lookup"><span data-stu-id="53e22-280">Make sure hello Backup Agent is installed on hello VM.</span></span> <span data-ttu-id="53e22-281">Se a VM é criada usando uma imagem da Galeria do Azure, o agente de Backup Olá já está instalado.</span><span class="sxs-lookup"><span data-stu-id="53e22-281">If your VM is created using an Azure gallery image, then hello Backup agent is already installed.</span></span> <span data-ttu-id="53e22-282">Caso contrário (ou seja, se você estiver usando uma imagem personalizada), use instruções muito[Olá instalar agente de VM na máquina virtual de saudação](../backup/backup-azure-arm-vms-prepare.md#install-the-vm-agent-on-the-virtual-machine).</span><span class="sxs-lookup"><span data-stu-id="53e22-282">Otherwise (that is, if you are using a custom image), use instructions too[Install hello VM Agent on hello virtual machine](../backup/backup-azure-arm-vms-prepare.md#install-the-vm-agent-on-the-virtual-machine).</span></span>

5.  <span data-ttu-id="53e22-283">Certifique-se de que Olá VM permite que a conectividade de rede para Olá toofunction de serviço de backup.</span><span class="sxs-lookup"><span data-stu-id="53e22-283">Make sure that hello VM allows network connectivity for hello backup service toofunction.</span></span> <span data-ttu-id="53e22-284">Siga estas instruções para a [Conectividade de rede](../backup/backup-azure-arm-vms-prepare.md#network-connectivity).</span><span class="sxs-lookup"><span data-stu-id="53e22-284">Follow these instructions for [Network connectivity](../backup/backup-azure-arm-vms-prepare.md#network-connectivity).</span></span>

6.  <span data-ttu-id="53e22-285">Depois que Olá acima etapas forem concluídas, o backup de Olá será executado em intervalos regulares, conforme especificado na política de backup hello.</span><span class="sxs-lookup"><span data-stu-id="53e22-285">Once hello above steps are completed, hello backup will run at regular intervals as specified in hello backup policy.</span></span> <span data-ttu-id="53e22-286">Se necessário, você pode disparar o primeiro backup Olá manualmente do painel do cofre Olá em Olá portal do Azure.</span><span class="sxs-lookup"><span data-stu-id="53e22-286">If necessary, you can trigger hello first backup manually from hello vault dashboard on hello Azure portal.</span></span>

<span data-ttu-id="53e22-287">Para automatizar o Backup do Azure usando scripts, consulte muito[cmdlets do PowerShell para backup de VM](../backup/backup-azure-vms-automation.md).</span><span class="sxs-lookup"><span data-stu-id="53e22-287">For automating Azure Backup using scripts, please refer too[PowerShell cmdlets for VM backup](../backup/backup-azure-vms-automation.md).</span></span>

### <a name="steps-for-recovery"></a><span data-ttu-id="53e22-288">Etapas de recuperação</span><span class="sxs-lookup"><span data-stu-id="53e22-288">Steps for Recovery</span></span>

<span data-ttu-id="53e22-289">Se você precisa toorepair ou recriar uma VM, você pode restaurar Olá VM de qualquer um dos pontos de recuperação de backup Olá no cofre hello.</span><span class="sxs-lookup"><span data-stu-id="53e22-289">If you need toorepair or rebuild a VM, you can restore hello VM from any of hello backup recovery points in hello vault.</span></span> <span data-ttu-id="53e22-290">Há duas opções diferentes para executar recuperação hello:</span><span class="sxs-lookup"><span data-stu-id="53e22-290">There are a couple of different options for performing hello recovery:</span></span>

1.  <span data-ttu-id="53e22-291">Você pode criar uma nova VM como uma representação pontual da VM copiada em backup.</span><span class="sxs-lookup"><span data-stu-id="53e22-291">You can create a new VM as a point-in-time representation of your backed-up VM.</span></span>

2.  <span data-ttu-id="53e22-292">Você pode restaurar Olá discos e, em seguida, use o modelo de saudação para Olá VM toocustomize e Olá de reconstrução restaurado VM.</span><span class="sxs-lookup"><span data-stu-id="53e22-292">You can restore hello disks and then use hello template for hello VM toocustomize and rebuild hello restored VM.</span></span> 

<span data-ttu-id="53e22-293">Consulte as instruções muito[máquinas de virtuais do Azure Use toorestore portal](../backup/backup-azure-arm-restore-vms.md#restoring-a-vm-during-azure-datacenter-disaster).</span><span class="sxs-lookup"><span data-stu-id="53e22-293">See instructions too[Use Azure portal toorestore virtual machines](../backup/backup-azure-arm-restore-vms.md#restoring-a-vm-during-azure-datacenter-disaster).</span></span> <span data-ttu-id="53e22-294">documento Hello também explica as etapas específicas de Olá para restaurar o backup VMs toohello emparelhados data center usando o Cofre de backup com redundância geográfica no caso de saudação de um desastre no Centro de dados primário hello.</span><span class="sxs-lookup"><span data-stu-id="53e22-294">hello document also explains hello specific steps for restoring backed-up VMs toohello paired data center using your geo-redundant backup vault in hello case of a disaster at hello primary data center.</span></span> <span data-ttu-id="53e22-295">Nesse caso, o Backup do Azure usa o serviço de computação de saudação da máquina virtual do hello região secundária toocreate Olá restaurado.</span><span class="sxs-lookup"><span data-stu-id="53e22-295">In that case, Azure Backup uses hello Compute service from hello secondary region toocreate hello restored virtual machine.</span></span>

<span data-ttu-id="53e22-296">Use também o PowerShell para [restaurar uma VM](../backup/backup-azure-vms-automation.md#restore-an-azure-vm) ou [criar uma nova VM com base em discos restaurados](../backup/backup-azure-vms-automation.md#create-a-vm-from-restored-disks).</span><span class="sxs-lookup"><span data-stu-id="53e22-296">You can also use PowerShell for [restoring a VM](../backup/backup-azure-vms-automation.md#restore-an-azure-vm) or for [creating a new VM from restored disks](../backup/backup-azure-vms-automation.md#create-a-vm-from-restored-disks).</span></span>

## <a name="alternative-solution-consistent-snapshots"></a><span data-ttu-id="53e22-297">Solução alternativa: instantâneos consistentes</span><span class="sxs-lookup"><span data-stu-id="53e22-297">Alternative Solution: Consistent Snapshots</span></span>

<span data-ttu-id="53e22-298">Se você não é possível toouse Olá serviço Backup do Azure, você pode implementar seu próprio mecanismo de backup usando os instantâneos.</span><span class="sxs-lookup"><span data-stu-id="53e22-298">If you are unable toouse hello Azure Backup Service, you can implement your own backup mechanism using snapshots.</span></span> <span data-ttu-id="53e22-299">É complicado toocreate instantâneos consistentes para todos os discos usados por uma máquina virtual e, em seguida, replicar esses região tooanother de instantâneos.</span><span class="sxs-lookup"><span data-stu-id="53e22-299">It is complicated toocreate consistent snapshots for all disks used by a VM and then replicate those snapshots tooanother region.</span></span> <span data-ttu-id="53e22-300">Por esse motivo, o Azure considera Olá aproveitando o serviço de Backup uma opção melhor do que a criação de uma solução personalizada.</span><span class="sxs-lookup"><span data-stu-id="53e22-300">For this reason, Azure considers leveraging hello Backup Service a better option than building a custom solution.</span></span> <span data-ttu-id="53e22-301">Se você usar o armazenamento de RA-GRS/GRS para discos, os instantâneos são replicados automaticamente tooa data center secundário.</span><span class="sxs-lookup"><span data-stu-id="53e22-301">If you use RA-GRS/GRS storage for disks, snapshots are automatically replicated tooa secondary data center.</span></span> <span data-ttu-id="53e22-302">Se você usar o armazenamento LRS para discos, você precisará tooreplicate Olá dados por conta própria.</span><span class="sxs-lookup"><span data-stu-id="53e22-302">If you use LRS storage for disks, you will need tooreplicate hello data yourself.</span></span> <span data-ttu-id="53e22-303">Para obter mais informações, consulte [Fazer backup de discos não gerenciados de VM do Azure com instantâneos incrementais](storage-incremental-snapshots.md).</span><span class="sxs-lookup"><span data-stu-id="53e22-303">For more information, see [Back up Azure unmanaged VM disks with incremental snapshots](storage-incremental-snapshots.md).</span></span>

<span data-ttu-id="53e22-304">Um instantâneo é uma representação de um objeto em um ponto específico no tempo.</span><span class="sxs-lookup"><span data-stu-id="53e22-304">A snapshot is a representation of an object at a specific point in time.</span></span> <span data-ttu-id="53e22-305">Um instantâneo incorrerá em cobrança para tamanho de Olá incremental de dados Olá ele mantém.</span><span class="sxs-lookup"><span data-stu-id="53e22-305">A snapshot will incur billing for hello incremental size of hello data it holds.</span></span> <span data-ttu-id="53e22-306">Para obter mais informações, consulte [Criar um instantâneo de blob](storage-blob-snapshots.md).</span><span class="sxs-lookup"><span data-stu-id="53e22-306">For more information, see [Create a blob snapshot](storage-blob-snapshots.md).</span></span>

### <a name="creating-snapshots-while-hello-vm-is-running"></a><span data-ttu-id="53e22-307">Criação de instantâneos durante a saudação VM está em execução</span><span class="sxs-lookup"><span data-stu-id="53e22-307">Creating snapshots while hello VM is running</span></span>

<span data-ttu-id="53e22-308">Enquanto você pode fazer um instantâneo a qualquer momento, se hello VM estiver em execução, ainda está sendo transmitidos toohello discos de dados e instantâneos Olá podem conter operações parciais que estavam em trânsito.</span><span class="sxs-lookup"><span data-stu-id="53e22-308">While you can take a snapshot at any time, if hello VM is running, there is still data being streamed toohello disks, and hello snapshots may contain partial operations that were in flight.</span></span> <span data-ttu-id="53e22-309">Além disso, se houver vários discos envolvidos, instantâneos de saudação de discos diferentes podem ter ocorrido em momentos diferentes, que significa que esses instantâneos podem não ser coordenados.</span><span class="sxs-lookup"><span data-stu-id="53e22-309">Also, if there are several disks involved, hello snapshots of different disks may have occurred at different times, which means these snapshots may not be coordinated.</span></span> <span data-ttu-id="53e22-310">Isso é especialmente problemático para volumes distribuídos cujos arquivos podem ser corrompidos se alterações estavam sendo feitas durante o backup.</span><span class="sxs-lookup"><span data-stu-id="53e22-310">This is especially problematic for striped volumes whose files can be corrupted if changes were being made during backup.</span></span>

<span data-ttu-id="53e22-311">tooavoid nessa situação, o processo de backup Olá deve implementar Olá etapas a seguir:</span><span class="sxs-lookup"><span data-stu-id="53e22-311">tooavoid this situation, hello backup process must implement hello following steps:</span></span>

1.  <span data-ttu-id="53e22-312">Congelar todos os discos de saudação</span><span class="sxs-lookup"><span data-stu-id="53e22-312">Freeze all hello disks</span></span>

2.  <span data-ttu-id="53e22-313">Liberar Olá todas as gravações pendentes</span><span class="sxs-lookup"><span data-stu-id="53e22-313">Flush all hello pending writes</span></span>

3.  <span data-ttu-id="53e22-314">Em seguida, [criar um instantâneo de blob](storage-blob-snapshots.md) para todos os discos de Olá</span><span class="sxs-lookup"><span data-stu-id="53e22-314">Then, [create a blob snapshot](storage-blob-snapshots.md) for all hello disks</span></span>

<span data-ttu-id="53e22-315">Alguns aplicativos do Windows como o SQL Server fornecem um mecanismo de backup coordenado por meio de backups consistentes com aplicativos do VSS toocreate.</span><span class="sxs-lookup"><span data-stu-id="53e22-315">Some Windows applications like SQL Server provide a coordinated backup mechanism via VSS toocreate application-consistent backups.</span></span> <span data-ttu-id="53e22-316">No Linux, você pode usar uma ferramenta como fsfreeze para coordenar discos hello, que fornecerão backups consistentes de arquivos, mas não consistentes com aplicativos instantâneos.</span><span class="sxs-lookup"><span data-stu-id="53e22-316">On Linux, you can use a tool like fsfreeze for coordinating hello disks, which will provide file-consistent backups, but not application-consistent snapshots.</span></span> <span data-ttu-id="53e22-317">Esse processo é complicado; portanto, considere o uso de [Backup do Azure](../backup/backup-azure-vms-introduction.md) ou de uma solução de backup de terceiros que já implementa isso.</span><span class="sxs-lookup"><span data-stu-id="53e22-317">This process is complicated, so and you should consider using [Azure Backup](../backup/backup-azure-vms-introduction.md) or a third-party backup solution which already implement this.</span></span>

<span data-ttu-id="53e22-318">Olá acima processo resulta em uma coleção de instantâneos coordenados para todos os discos VM hello, representando uma exibição point-in-time específica de saudação VM.</span><span class="sxs-lookup"><span data-stu-id="53e22-318">hello above process will result in a collection of coordinated snapshots for all hello VM disks, representing a specific point-in-time view of hello VM.</span></span> <span data-ttu-id="53e22-319">Isso é um ponto de restauração de backup para Olá VM.</span><span class="sxs-lookup"><span data-stu-id="53e22-319">This is a backup restore point for hello VM.</span></span> <span data-ttu-id="53e22-320">Você pode repetir o processo de saudação em backups periódicos do toocreate intervalos agendados.</span><span class="sxs-lookup"><span data-stu-id="53e22-320">You can repeat hello process at scheduled intervals toocreate periodic backups.</span></span> <span data-ttu-id="53e22-321">Consulte abaixo para obter as etapas Olá muito[região do cópia Olá backups tooanother](#copy-the-snapshots-to-another-region) para recuperação de desastres.</span><span class="sxs-lookup"><span data-stu-id="53e22-321">See below for hello steps too[copy hello backups tooanother region](#copy-the-snapshots-to-another-region) for DR.</span></span>

### <a name="creating-snapshots-while-hello-vm-is-offline"></a><span data-ttu-id="53e22-322">Criação de instantâneos durante a saudação a VM está offline</span><span class="sxs-lookup"><span data-stu-id="53e22-322">Creating snapshots while hello VM is offline</span></span>

<span data-ttu-id="53e22-323">Backups consistentes do outra opção toocreate está sendo desligado hello VM e obter blob instantâneos de cada disco.</span><span class="sxs-lookup"><span data-stu-id="53e22-323">Another option toocreate consistent backups is shutting down hello VM and taking blob snapshots of each disk.</span></span> <span data-ttu-id="53e22-324">Isso é mais fácil do que coordenar instantâneos de uma VM em execução, mas exige alguns minutos de inatividade.</span><span class="sxs-lookup"><span data-stu-id="53e22-324">This is easier than coordinating snapshots of a running VM, but it requires a few minutes of downtime.</span></span> <span data-ttu-id="53e22-325">Para esse processo, siga estas etapas:</span><span class="sxs-lookup"><span data-stu-id="53e22-325">For this process, follow these steps:</span></span>

1. <span data-ttu-id="53e22-326">Desligar Olá VM.</span><span class="sxs-lookup"><span data-stu-id="53e22-326">Shut down hello VM.</span></span>

2. <span data-ttu-id="53e22-327">Crie um instantâneo de cada blob do VHD, o que leva apenas alguns segundos.</span><span class="sxs-lookup"><span data-stu-id="53e22-327">Create a snapshot of each VHD blob, which only takes a few seconds.</span></span>

    <span data-ttu-id="53e22-328">toocreate um instantâneo, você pode usar [PowerShell](storage-powershell-guide-full.md#how-to-manage-azure-blob-snapshots), Olá [API de Rest do armazenamento do Azure](https://msdn.microsoft.com/library/azure/ee691971.aspx), [CLI do Azure](https://docs.microsoft.com/azure/xplat-cli-install), ou uma saudação bibliotecas de cliente de armazenamento do Azure, como [ biblioteca de cliente de armazenamento Olá para .NET](https://msdn.microsoft.com/library/azure/hh488361.aspx).</span><span class="sxs-lookup"><span data-stu-id="53e22-328">toocreate a snapshot, you can use [PowerShell](storage-powershell-guide-full.md#how-to-manage-azure-blob-snapshots), hello [Azure Storage Rest API](https://msdn.microsoft.com/library/azure/ee691971.aspx), [Azure CLI](https://docs.microsoft.com/azure/xplat-cli-install), or one of hello Azure Storage Client Libraries such as [hello Storage client library for .NET](https://msdn.microsoft.com/library/azure/hh488361.aspx).</span></span>

3. <span data-ttu-id="53e22-329">Olá iniciar VM, que termina o tempo de inatividade de saudação.</span><span class="sxs-lookup"><span data-stu-id="53e22-329">Start hello VM, which ends hello downtime.</span></span> <span data-ttu-id="53e22-330">Normalmente, todo o processo de saudação é concluída em alguns minutos.</span><span class="sxs-lookup"><span data-stu-id="53e22-330">Typically hello entire process completes within a few minutes.</span></span>

<span data-ttu-id="53e22-331">Esse processo resulta em uma coleção de instantâneos consistentes para todos os discos hello, fornecendo um ponto de restauração de backup para Olá VM.</span><span class="sxs-lookup"><span data-stu-id="53e22-331">This process yields a collection of consistent snapshots for all hello disks, providing a backup restore point for hello VM.</span></span> <span data-ttu-id="53e22-332">Consulte abaixo para região tooanother instantâneos de saudação do hello etapas toocopy para recuperação de desastres.</span><span class="sxs-lookup"><span data-stu-id="53e22-332">See below for hello steps toocopy hello snapshots tooanother region for DR.</span></span>

### <a name="copy-hello-snapshots-tooanother-region"></a><span data-ttu-id="53e22-333">Região de tooanother cópia Olá instantâneos</span><span class="sxs-lookup"><span data-stu-id="53e22-333">Copy hello snapshots tooanother region</span></span>

<span data-ttu-id="53e22-334">Criação de instantâneos de saudação somente pode não ser suficiente para recuperação de desastres.</span><span class="sxs-lookup"><span data-stu-id="53e22-334">Creation of hello snapshots alone may not be sufficient for DR.</span></span> <span data-ttu-id="53e22-335">Região de tooanother de backups de instantâneo Olá também devem ser replicados.</span><span class="sxs-lookup"><span data-stu-id="53e22-335">You must also replicate hello snapshot backups tooanother region.</span></span>

<span data-ttu-id="53e22-336">Se você estiver usando o GRS ou RA-GRS para os discos, instantâneos de saudação são região secundária toohello replicados automaticamente.</span><span class="sxs-lookup"><span data-stu-id="53e22-336">If you are using GRS or RA-GRS for your disks, then hello snapshots are replicated toohello secondary region automatically.</span></span> <span data-ttu-id="53e22-337">Pode haver alguns minutos de retardo antes da replicação hello e se Olá data center primário ficar inativo antes de instantâneos Olá concluir a replicação, você não poderá ser tooaccess capaz de instantâneos de saudação do hello data center secundário.</span><span class="sxs-lookup"><span data-stu-id="53e22-337">There can be a few minutes of lag before hello replication, and if hello primary data center goes down before hello snapshots finish replicating, you will not be able tooaccess hello snapshots from hello secondary data center.</span></span> <span data-ttu-id="53e22-338">probabilidade de saudação deste é pequena.</span><span class="sxs-lookup"><span data-stu-id="53e22-338">hello likelihood of this is small.</span></span>

> [!Note] 
> <span data-ttu-id="53e22-339">Tendo apenas discos de saudação em uma conta GRS ou RA-GRS não protege Olá VM de desastres.</span><span class="sxs-lookup"><span data-stu-id="53e22-339">Only having hello disks in a GRS or RA-GRS account does not protect hello VM from disasters.</span></span> <span data-ttu-id="53e22-340">Também é necessário criar instantâneos coordenados ou usar o Backup do Azure.</span><span class="sxs-lookup"><span data-stu-id="53e22-340">You must also create coordinated snapshots or use Azure Backup.</span></span> <span data-ttu-id="53e22-341">Isso é necessário toorecover um estado consistente de tooa VM.</span><span class="sxs-lookup"><span data-stu-id="53e22-341">This is required toorecover a VM tooa consistent state.</span></span>

<span data-ttu-id="53e22-342">Se você estiver usando LRS, você deve copiar Olá instantâneos tooa outra conta de armazenamento imediatamente após a criação do instantâneo de saudação.</span><span class="sxs-lookup"><span data-stu-id="53e22-342">If you are using LRS, you must copy hello snapshots tooa different storage account immediately after creating hello snapshot.</span></span> <span data-ttu-id="53e22-343">o destino de cópia Olá pode ser uma conta de armazenamento LRS em uma região diferente, resultando na cópia de saudação em uma região remota.</span><span class="sxs-lookup"><span data-stu-id="53e22-343">hello copy target could be an LRS storage account in a different region, resulting in hello copy being in a remote region.</span></span> <span data-ttu-id="53e22-344">Você também pode copiar a conta de armazenamento Olá instantâneo tooan RA-GRS em Olá mesma região.</span><span class="sxs-lookup"><span data-stu-id="53e22-344">You can also copy hello snapshot tooan RA-GRS storage account in hello same region.</span></span> <span data-ttu-id="53e22-345">Nesse caso, instantâneo Olá será região secundária do remoto toohello lentamente replicado.</span><span class="sxs-lookup"><span data-stu-id="53e22-345">In this case, hello snapshot will be lazily replicated toohello remote secondary region.</span></span> <span data-ttu-id="53e22-346">O backup é protegido após um desastre no site primário hello quando Olá cópia e replicação for concluída.</span><span class="sxs-lookup"><span data-stu-id="53e22-346">Your backup is protected from disasters at hello primary site once hello copying and replication is complete.</span></span>

<span data-ttu-id="53e22-347">toocopy seus instantâneos incrementais para recuperação de desastres com eficiência, examine instruções Olá [backup de discos VM não gerenciados do Azure com instantâneos incrementais](storage-incremental-snapshots.md).</span><span class="sxs-lookup"><span data-stu-id="53e22-347">toocopy your incremental snapshots for DR efficiently, review hello instructions in [Back up Azure unmanaged VM disks with incremental snapshots](storage-incremental-snapshots.md).</span></span>

![][2]

### <a name="recovery-from-snapshots"></a><span data-ttu-id="53e22-348">Recuperação com base em instantâneos</span><span class="sxs-lookup"><span data-stu-id="53e22-348">Recovery from Snapshots</span></span>

<span data-ttu-id="53e22-349">tooretrieve um instantâneo, copie-o toomake um novo blob.</span><span class="sxs-lookup"><span data-stu-id="53e22-349">tooretrieve a snapshot, copy it toomake a new blob.</span></span> <span data-ttu-id="53e22-350">Se você estiver copiando instantâneo Olá da conta primária hello, você pode copiar Olá instantâneo sobre toohello blob de base de instantâneo hello, assim, revertendo Olá disco toohello instantâneo; Isso é conhecido como promover um instantâneo de saudação.</span><span class="sxs-lookup"><span data-stu-id="53e22-350">If you are copying hello snapshot from hello primary account, you can copy hello snapshot over toohello base blob of hello snapshot, thus reverting hello disk toohello snapshot; this is known as promoting hello snapshot.</span></span> <span data-ttu-id="53e22-351">Se você estiver copiando o backup de instantâneo de saudação de uma conta secundária (no caso de saudação de RA-GRS), ele deve ser copiado tooa primário da conta.</span><span class="sxs-lookup"><span data-stu-id="53e22-351">If you are copying hello snapshot backup from a secondary account (in hello case of RA-GRS), it must be copied tooa primary account.</span></span> <span data-ttu-id="53e22-352">Você pode copiar um instantâneo [usando o PowerShell](storage-powershell-guide-full.md#how-to-copy-a-snapshot-of-a-blob) ou usando o utilitário AzCopy de saudação.</span><span class="sxs-lookup"><span data-stu-id="53e22-352">You can copy a snapshot [using PowerShell](storage-powershell-guide-full.md#how-to-copy-a-snapshot-of-a-blob) or using hello AzCopy utility.</span></span> <span data-ttu-id="53e22-353">Para obter mais informações, consulte [transferir dados com o utilitário de linha de comando AzCopy de hello](storage-use-azcopy.md).</span><span class="sxs-lookup"><span data-stu-id="53e22-353">For more information, see [Transfer data with hello AzCopy Command-Line Utility](storage-use-azcopy.md).</span></span>

<span data-ttu-id="53e22-354">No caso de saudação de VMs com vários discos, você deve copiar todos os instantâneos Olá que fazem parte da saudação mesmas coordenadas de ponto de restauração.</span><span class="sxs-lookup"><span data-stu-id="53e22-354">In hello case of VMs with multiple disks, you must copy all hello snapshots that are part of hello same coordinated restore point.</span></span> <span data-ttu-id="53e22-355">Quando você copia Olá instantâneos toowritable VHD blobs, você pode usar Olá blobs toorecreate sua VM usando o modelo de saudação para Olá VM.</span><span class="sxs-lookup"><span data-stu-id="53e22-355">Once you copy hello snapshots toowritable VHD blobs, you can use hello blobs toorecreate your VM using hello template for hello VM.</span></span>

## <a name="other-options"></a><span data-ttu-id="53e22-356">Outras opções</span><span class="sxs-lookup"><span data-stu-id="53e22-356">Other options</span></span>

### <a name="sql-server"></a><span data-ttu-id="53e22-357">SQL Server</span><span class="sxs-lookup"><span data-stu-id="53e22-357">SQL Server</span></span>

<span data-ttu-id="53e22-358">SQL Server em execução em uma VM tem seu próprio toobackup recursos internos seu tooAzure de banco de dados do SQL Server o armazenamento de Blob ou em um compartilhamento de arquivo.</span><span class="sxs-lookup"><span data-stu-id="53e22-358">SQL Server running in a VM has its own built-in capabilities toobackup your SQL Server database tooAzure Blob storage or a file share.</span></span> <span data-ttu-id="53e22-359">Se a conta de armazenamento de saudação é GRS ou RA-GRS, você pode acessar esses backups no Centro de dados secundários da conta de armazenamento Olá no evento de saudação de um desastre, com hello mesmas restrições, como discutido anteriormente.</span><span class="sxs-lookup"><span data-stu-id="53e22-359">If hello storage account is GRS or RA-GRS, you can access those backups in hello storage account’s secondary data center in hello event of a disaster, with hello same restrictions as discussed previously.</span></span> <span data-ttu-id="53e22-360">Para obter mais informações, consulte [Backup e Restauração para SQL Server em Máquinas Virtuais do Azure](../virtual-machines/windows/sql/virtual-machines-windows-sql-backup-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="53e22-360">For more information, see [Backup and Restore for SQL Server in Azure Virtual Machines](../virtual-machines/windows/sql/virtual-machines-windows-sql-backup-recovery.md).</span></span> <span data-ttu-id="53e22-361">Em adição toobackup e restauração, [SQL Server AlwaysOn em grupos de disponibilidade](../virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr.md) pode manter réplicas secundárias de bancos de dados toogreatly reduzem o tempo de recuperação de desastres de saudação.</span><span class="sxs-lookup"><span data-stu-id="53e22-361">In addition toobackup and restore, [SQL Server Always On Availability Groups](../virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr.md) can maintain secondary replicas of databases toogreatly reduce hello disaster recovery time.</span></span>

## <a name="other-considerations"></a><span data-ttu-id="53e22-362">Outras considerações</span><span class="sxs-lookup"><span data-stu-id="53e22-362">Other considerations</span></span>

<span data-ttu-id="53e22-363">Este artigo discutiu como toobackup ou tirar instantâneos de suas VMs e recuperação de desastres do toosupport seus discos e como toouse esses toorecover.</span><span class="sxs-lookup"><span data-stu-id="53e22-363">This article has discussed how toobackup or take snapshots of your VMs and their disks toosupport disaster recovery, and how toouse those toorecover.</span></span> <span data-ttu-id="53e22-364">Com o modelo do Azure Resource Manager hello, muitas pessoas usam modelos toocreate suas VMs e outra infraestrutura no Azure.</span><span class="sxs-lookup"><span data-stu-id="53e22-364">With hello Azure Resource Manager model, many people use templates toocreate their VMs and other infrastructure in Azure.</span></span> <span data-ttu-id="53e22-365">Você pode usar um modelo toocreate uma VM que tenha Olá mesma configuração de cada vez.</span><span class="sxs-lookup"><span data-stu-id="53e22-365">You can use a template toocreate a VM that has hello same configuration every time.</span></span> <span data-ttu-id="53e22-366">Se você usar imagens personalizadas para criar suas VMs, você também deve verificar se as imagens são protegidas usando um toostore de conta de RA-GRS-los.</span><span class="sxs-lookup"><span data-stu-id="53e22-366">If you use custom images for creating your VMs, you must also make sure your images are protected by using an RA-GRS account toostore them.</span></span>

<span data-ttu-id="53e22-367">Consequentemente, o processo de backup pode ser uma combinação de duas coisas:</span><span class="sxs-lookup"><span data-stu-id="53e22-367">Consequently, your backup process may be a combination of two things:</span></span>

1. <span data-ttu-id="53e22-368">Dados de backup de saudação (discos)</span><span class="sxs-lookup"><span data-stu-id="53e22-368">Backup hello data (disks)</span></span>
2. <span data-ttu-id="53e22-369">Configuração de backup hello (modelos, imagens personalizadas)</span><span class="sxs-lookup"><span data-stu-id="53e22-369">Backup hello configuration (templates, custom images)</span></span>

<span data-ttu-id="53e22-370">Dependendo da opção de backup Olá que você escolher, você pode ter backup Olá toohandle dados saudação e configuração de saudação ou serviço de backup Olá pode lidar com tudo isso para você.</span><span class="sxs-lookup"><span data-stu-id="53e22-370">Depending on hello backup option you choose, you may have toohandle hello backup of both hello data and hello configuration, or hello backup service may handle all of that for you.</span></span>

## <a name="appendix---understanding-hello-impact-of-lrs-grs-and-ra-grs"></a><span data-ttu-id="53e22-371">Apêndice a-Noções básicas sobre o impacto de saudação do LRS, GRS e RA-GRS</span><span class="sxs-lookup"><span data-stu-id="53e22-371">Appendix - Understanding hello impact of LRS, GRS, and RA-GRS</span></span>

<span data-ttu-id="53e22-372">Para contas de armazenamento no Azure, há três tipos de redundância de dados que devem ser considerados em relação à recuperação de desastre – LRS (redundância local), GRS (redundância geográfica) ou RA-GRS (redundância geográfica com acesso de leitura).</span><span class="sxs-lookup"><span data-stu-id="53e22-372">For storage accounts in Azure, there are three types of data redundancy that you should consider regarding disaster recovery – locally redundant (LRS), geo-redundant (GRS), or geo-redundant with read access (RA-GRS).</span></span> 

<span data-ttu-id="53e22-373">Localmente o armazenamento redundante (LRS) mantém três cópias de dados Olá Olá mesmo data center.</span><span class="sxs-lookup"><span data-stu-id="53e22-373">Locally Redundant Storage (LRS) retains three copies of hello data in hello same data center.</span></span> <span data-ttu-id="53e22-374">Ao gravar dados hello, todos os três cópias são atualizadas antes do sucesso será retornado toohello chamador, para que você saiba que eles são idênticos.</span><span class="sxs-lookup"><span data-stu-id="53e22-374">When writing hello data, all three copies are updated before success is returned toohello caller, so you know they are identical.</span></span> <span data-ttu-id="53e22-375">O disco está protegido contra falhas locais, pois é muito improvável que todos os três cópias seriam afetadas em Olá simultaneamente.</span><span class="sxs-lookup"><span data-stu-id="53e22-375">Your disk is protected from local failures, since it is extremely unlikely that all three copies would be impacted at hello same time.</span></span> <span data-ttu-id="53e22-376">No caso de saudação de LRS, não há nenhuma redundância geográfica e disco Olá não está protegido contra falhas catastróficas que podem afetar uma unidade de todo o data center ou armazenamento.</span><span class="sxs-lookup"><span data-stu-id="53e22-376">In hello case of LRS, there is no geo-redundancy, so hello disk is not protected from catastrophic failures that can impact an entire data center or storage unit.</span></span>

<span data-ttu-id="53e22-377">Com o GRS e RA-GRS, três cópias de seus dados são mantidas na região primária do hello (selecionado por você) e três cópias mais de seus dados são mantidas em uma região secundária correspondente (definida pelo Azure).</span><span class="sxs-lookup"><span data-stu-id="53e22-377">With GRS and RA-GRS, three copies of your data are retained in hello primary region (selected by you), and three more copies of your data are retained in a corresponding secondary region (set by Azure).</span></span> <span data-ttu-id="53e22-378">Por exemplo, se você armazenar dados no Oeste dos EUA, dados de saudação serão replicada tooEast dos EUA.</span><span class="sxs-lookup"><span data-stu-id="53e22-378">For example, if you store data in West US, hello data will be replicated tooEast US.</span></span> <span data-ttu-id="53e22-379">Isso é feito de forma assíncrona, e há um pequeno atraso entre as atualizações toohello primário e secundário.</span><span class="sxs-lookup"><span data-stu-id="53e22-379">This is done asynchronously, and there is a small delay between updates toohello primary and secondary.</span></span> <span data-ttu-id="53e22-380">Réplicas de discos Olá no site secundário Olá estão consistentes em uma base por disco (com atraso Olá), mas réplicas de vários discos ativos podem não estar sincronizadas **uns com os outros**.</span><span class="sxs-lookup"><span data-stu-id="53e22-380">Replicas of hello disks on hello secondary site are consistent on a per-disk basis (with hello delay), but replicas of multiple active disks may not be in sync **with each other**.</span></span> <span data-ttu-id="53e22-381">réplicas consistente em vários discos, instantâneos consistentes de toohave são necessários.</span><span class="sxs-lookup"><span data-stu-id="53e22-381">toohave consistent replicas across multiple disks, consistent snapshots are needed.</span></span>

<span data-ttu-id="53e22-382">Olá principal diferença entre GRS e RA-GRS é que, com RA-GRS, você pode ler cópia secundária Olá a qualquer momento.</span><span class="sxs-lookup"><span data-stu-id="53e22-382">hello main difference between GRS and RA-GRS is that with RA-GRS, you can read hello secondary copy at any time.</span></span> <span data-ttu-id="53e22-383">Se houver um problema que processa os dados de saudação na região primária Olá inacessível, Olá, equipe do Azure tornará cada acesso toorestore de esforço.</span><span class="sxs-lookup"><span data-stu-id="53e22-383">If there is a problem that renders hello data in hello primary region inaccessible, hello Azure team will make every effort toorestore access.</span></span> <span data-ttu-id="53e22-384">Enquanto Olá primário estiver inativo, se você tiver RA-GRS habilitado, você pode acessar dados Olá Olá data center secundário.</span><span class="sxs-lookup"><span data-stu-id="53e22-384">While hello primary is down, if you have RA-GRS enabled, you can access hello data in hello secondary data center.</span></span> <span data-ttu-id="53e22-385">Portanto, se você planejar tooread da réplica Olá enquanto Olá primário estiver inacessível, em seguida, RA-GRS deve ser considerada.</span><span class="sxs-lookup"><span data-stu-id="53e22-385">Therefore, if you plan tooread from hello replica while hello primary is inaccessible, then RA-GRS should be considered.</span></span>

<span data-ttu-id="53e22-386">Se acontece toobe uma interrupção significativa Olá, equipe do Azure pode disparar um failover geográfico e altere o armazenamento Olá primário DNS entradas toopoint toosecondary.</span><span class="sxs-lookup"><span data-stu-id="53e22-386">If it turns out toobe a significant outage, hello Azure team may trigger a geo-failover and change hello primary DNS entries toopoint toosecondary storage.</span></span> <span data-ttu-id="53e22-387">Neste ponto, se você tiver o GRS ou RA-GRS habilitado, você pode acessar dados de saudação na região Olá usados toobe Olá secundário.</span><span class="sxs-lookup"><span data-stu-id="53e22-387">At this point, if you have either GRS or RA-GRS enabled, you can access hello data in hello region that used toobe hello secondary.</span></span> <span data-ttu-id="53e22-388">Em outras palavras, se sua conta de armazenamento é GRS e há um problema, você pode acessar o armazenamento secundário Olá somente se houver um failover geográfico.</span><span class="sxs-lookup"><span data-stu-id="53e22-388">In other words, if your storage account is GRS and there is a problem, you can access hello secondary storage only if there is a geo-failover.</span></span>

<span data-ttu-id="53e22-389">Para obter mais informações, consulte [que toodo se ocorrer uma interrupção de armazenamento do Azure](storage-disaster-recovery-guidance.md).</span><span class="sxs-lookup"><span data-stu-id="53e22-389">For more information, see [What toodo if an Azure Storage outage occurs](storage-disaster-recovery-guidance.md).</span></span> 

<span data-ttu-id="53e22-390">Observe que a Microsoft controla a ocorrência de um failover.</span><span class="sxs-lookup"><span data-stu-id="53e22-390">Note that Microsoft controls whether a failover occurs.</span></span> <span data-ttu-id="53e22-391">O failover não é controlado por conta de armazenamento e, portanto, isso não é decidido por clientes individuais.</span><span class="sxs-lookup"><span data-stu-id="53e22-391">Failover is not controlled per storage account, therefore it is not decided by individual customers.</span></span> <span data-ttu-id="53e22-392">tooimplement a recuperação de desastres para contas de armazenamento específico ou discos de máquina virtual, você deve usar técnicas de saudação descritas anteriormente neste artigo.</span><span class="sxs-lookup"><span data-stu-id="53e22-392">tooimplement Disaster Recovery for specific storage accounts or virtual machine disks, you must use hello techniques described previously in this article.</span></span>



[1]: ./media/storage-backup-and-disaster-recovery-for-azure-iaas-disks/backup-and-disaster-recovery-for-azure-iaas-disks-1.png
[2]: ./media/storage-backup-and-disaster-recovery-for-azure-iaas-disks/backup-and-disaster-recovery-for-azure-iaas-disks-2.png