---
title: "grupos de segurança aaaNetwork no Azure | Microsoft Docs"
description: "Saiba como tráfego tooisolate e controle de fluxo em suas redes virtuais usando o firewall do hello distribuído no Azure usando grupos de segurança de rede."
services: virtual-network
documentationcenter: na
author: jimdial
manager: timlt
editor: tysonn
ms.assetid: 20e850fc-6456-4b5f-9a3f-a8379b052bc9
ms.service: virtual-network
ms.devlang: na
ms.topic: get-started-article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 02/11/2016
ms.author: jdial
ms.openlocfilehash: 3528ce833dab17977327c3c9ae0e78316e5e6a05
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="filter-network-traffic-with-network-security-groups"></a><span data-ttu-id="24c9d-103">Filtrar o tráfego de rede com grupos de segurança de rede</span><span class="sxs-lookup"><span data-stu-id="24c9d-103">Filter network traffic with network security groups</span></span>

<span data-ttu-id="24c9d-104">Um grupo de segurança de rede (NSG) contém uma lista de regras de segurança que permitem ou negam tooresources de tráfego de rede conectados a redes virtuais do tooAzure (VNet).</span><span class="sxs-lookup"><span data-stu-id="24c9d-104">A network security group (NSG) contains a list of security rules that allow or deny network traffic tooresources connected tooAzure Virtual Networks (VNet).</span></span> <span data-ttu-id="24c9d-105">Os NSGs podem ser associados toosubnets, VMs individuais (clássico) ou interfaces de rede individuais (NIC) anexado tooVMs (Gerenciador de recursos).</span><span class="sxs-lookup"><span data-stu-id="24c9d-105">NSGs can be associated toosubnets, individual VMs (classic), or individual network interfaces (NIC) attached tooVMs (Resource Manager).</span></span> <span data-ttu-id="24c9d-106">Quando um NSG está associado tooa sub-rede, regras de saudação aplicam tooall recursos toohello conectado sub-rede.</span><span class="sxs-lookup"><span data-stu-id="24c9d-106">When an NSG is associated tooa subnet, hello rules apply tooall resources connected toohello subnet.</span></span> <span data-ttu-id="24c9d-107">O tráfego pode ser restringido ainda mais associando também tooa um NSG VM ou NIC.</span><span class="sxs-lookup"><span data-stu-id="24c9d-107">Traffic can further be restricted by also associating an NSG tooa VM or NIC.</span></span>

> [!NOTE]
> <span data-ttu-id="24c9d-108">O Azure tem dois modelos de implantação diferentes para criar e trabalhar com recursos: [Gerenciador de Recursos e clássico](../resource-manager-deployment-model.md).</span><span class="sxs-lookup"><span data-stu-id="24c9d-108">Azure has two different deployment models for creating and working with resources:  [Resource Manager and classic](../resource-manager-deployment-model.md).</span></span> <span data-ttu-id="24c9d-109">Este artigo aborda o uso de ambos os modelos, mas a Microsoft recomenda que mais novas implantações de usam o modelo do Gerenciador de recursos de saudação.</span><span class="sxs-lookup"><span data-stu-id="24c9d-109">This article covers using both models, but Microsoft recommends that most new deployments use hello Resource Manager model.</span></span>

## <a name="nsg-resource"></a><span data-ttu-id="24c9d-110">Recurso NSG</span><span class="sxs-lookup"><span data-stu-id="24c9d-110">NSG resource</span></span>
<span data-ttu-id="24c9d-111">Os NSGs contenham Olá propriedades a seguir:</span><span class="sxs-lookup"><span data-stu-id="24c9d-111">NSGs contain hello following properties:</span></span>

| <span data-ttu-id="24c9d-112">Propriedade</span><span class="sxs-lookup"><span data-stu-id="24c9d-112">Property</span></span> | <span data-ttu-id="24c9d-113">Descrição</span><span class="sxs-lookup"><span data-stu-id="24c9d-113">Description</span></span> | <span data-ttu-id="24c9d-114">Restrições</span><span class="sxs-lookup"><span data-stu-id="24c9d-114">Constraints</span></span> | <span data-ttu-id="24c9d-115">Considerações</span><span class="sxs-lookup"><span data-stu-id="24c9d-115">Considerations</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="24c9d-116">Nome</span><span class="sxs-lookup"><span data-stu-id="24c9d-116">Name</span></span> |<span data-ttu-id="24c9d-117">Nome para Olá NSG</span><span class="sxs-lookup"><span data-stu-id="24c9d-117">Name for hello NSG</span></span> |<span data-ttu-id="24c9d-118">Deve ser exclusivo dentro da região de saudação.</span><span class="sxs-lookup"><span data-stu-id="24c9d-118">Must be unique within hello region.</span></span><br/><span data-ttu-id="24c9d-119">Pode conter letras, números, sublinhados, pontos e hifens.</span><span class="sxs-lookup"><span data-stu-id="24c9d-119">Can contain letters, numbers, underscores, periods, and hyphens.</span></span><br/><span data-ttu-id="24c9d-120">Deve começar com uma letra ou número.</span><span class="sxs-lookup"><span data-stu-id="24c9d-120">Must start with a letter or number.</span></span><br/><span data-ttu-id="24c9d-121">Deve terminar com uma letra, número ou sublinhado.</span><span class="sxs-lookup"><span data-stu-id="24c9d-121">Must end with a letter, number, or underscore.</span></span><br/><span data-ttu-id="24c9d-122">Não pode exceder 80 caracteres.</span><span class="sxs-lookup"><span data-stu-id="24c9d-122">Cannot exceed 80 characters.</span></span> |<span data-ttu-id="24c9d-123">Como talvez seja necessário toocreate NSGs vários, verifique se que você tem uma convenção de nomenclatura que torna mais fácil tooidentify função de saudação de seus NSGs.</span><span class="sxs-lookup"><span data-stu-id="24c9d-123">Since you may need toocreate several NSGs, make sure you have a naming convention that makes it easy tooidentify hello function of your NSGs.</span></span> |
| <span data-ttu-id="24c9d-124">Região</span><span class="sxs-lookup"><span data-stu-id="24c9d-124">Region</span></span> |<span data-ttu-id="24c9d-125">Azure [região](https://azure.microsoft.com/regions) onde hello NSG é criado.</span><span class="sxs-lookup"><span data-stu-id="24c9d-125">Azure [region](https://azure.microsoft.com/regions) where hello NSG is created.</span></span> |<span data-ttu-id="24c9d-126">Os NSGs só podem ser associado tooresources dentro Olá Olá NSG mesma região.</span><span class="sxs-lookup"><span data-stu-id="24c9d-126">NSGs can only be associated tooresources within hello same region as hello NSG.</span></span> |<span data-ttu-id="24c9d-127">toolearn sobre quantas NSGs que você pode ter por região, ler Olá [Azure limita](../azure-subscription-service-limits.md#virtual-networking-limits-classic) artigo.</span><span class="sxs-lookup"><span data-stu-id="24c9d-127">toolearn about how many NSGs you can have per region, read hello [Azure limits](../azure-subscription-service-limits.md#virtual-networking-limits-classic) article.</span></span>|
| <span data-ttu-id="24c9d-128">Grupo de recursos</span><span class="sxs-lookup"><span data-stu-id="24c9d-128">Resource group</span></span> |<span data-ttu-id="24c9d-129">Olá [grupo de recursos](../azure-resource-manager/resource-group-overview.md#resource-groups) Olá NSG existe.</span><span class="sxs-lookup"><span data-stu-id="24c9d-129">hello [resource group](../azure-resource-manager/resource-group-overview.md#resource-groups) hello NSG exists in.</span></span> |<span data-ttu-id="24c9d-130">Embora um NSG existe em um grupo de recursos, pode ser associado tooresources em qualquer grupo de recursos, como recursos Olá faz parte da saudação mesma região do Azure Olá NSG.</span><span class="sxs-lookup"><span data-stu-id="24c9d-130">Although an NSG exists in a resource group, it can be associated tooresources in any resource group, as long as hello resource is part of hello same Azure region as hello NSG.</span></span> |<span data-ttu-id="24c9d-131">Grupos de recursos é toomanage usado juntos, como uma unidade de implantação de vários recursos.</span><span class="sxs-lookup"><span data-stu-id="24c9d-131">Resource groups are used toomanage multiple resources together, as a deployment unit.</span></span><br/><span data-ttu-id="24c9d-132">Você pode considerar o agrupamento Olá NSG com recursos que ela está associada.</span><span class="sxs-lookup"><span data-stu-id="24c9d-132">You may consider grouping hello NSG with resources it is associated to.</span></span> |
| <span data-ttu-id="24c9d-133">Regras</span><span class="sxs-lookup"><span data-stu-id="24c9d-133">Rules</span></span> |<span data-ttu-id="24c9d-134">Regras de entrada ou saída que definem o tráfego que é permitido ou negado.</span><span class="sxs-lookup"><span data-stu-id="24c9d-134">Inbound or outbound rules that define what traffic is allowed or denied.</span></span> | |<span data-ttu-id="24c9d-135">Consulte Olá [regras NSG](#Nsg-rules) deste artigo.</span><span class="sxs-lookup"><span data-stu-id="24c9d-135">See hello [NSG rules](#Nsg-rules) section of this article.</span></span> |

> [!NOTE]
> <span data-ttu-id="24c9d-136">ACLs baseadas em ponto de extremidade e segurança de rede grupos não têm suporte em Olá a mesma instância VM.</span><span class="sxs-lookup"><span data-stu-id="24c9d-136">Endpoint-based ACLs and network security groups are not supported on hello same VM instance.</span></span> <span data-ttu-id="24c9d-137">Se você quiser toouse um NSG e já tiver um ponto de extremidade ACL em vigor, primeiro remova o ponto de extremidade de saudação ACL.</span><span class="sxs-lookup"><span data-stu-id="24c9d-137">If you want toouse an NSG and have an endpoint ACL already in place, first remove hello endpoint ACL.</span></span> <span data-ttu-id="24c9d-138">toolearn como tooremove uma ACL, ler Olá [Gerenciando controle listas de acesso (ACLs) para pontos de extremidade usando o PowerShell](virtual-networks-acl-powershell.md) artigo.</span><span class="sxs-lookup"><span data-stu-id="24c9d-138">toolearn how tooremove an ACL, read hello [Managing Access Control Lists (ACLs) for Endpoints by using PowerShell](virtual-networks-acl-powershell.md) article.</span></span>
> 

### <a name="nsg-rules"></a><span data-ttu-id="24c9d-139">Regras NSG</span><span class="sxs-lookup"><span data-stu-id="24c9d-139">NSG rules</span></span>
<span data-ttu-id="24c9d-140">Regras NSG contenham Olá propriedades a seguir:</span><span class="sxs-lookup"><span data-stu-id="24c9d-140">NSG rules contain hello following properties:</span></span>

| <span data-ttu-id="24c9d-141">Propriedade</span><span class="sxs-lookup"><span data-stu-id="24c9d-141">Property</span></span> | <span data-ttu-id="24c9d-142">Descrição</span><span class="sxs-lookup"><span data-stu-id="24c9d-142">Description</span></span> | <span data-ttu-id="24c9d-143">Restrições</span><span class="sxs-lookup"><span data-stu-id="24c9d-143">Constraints</span></span> | <span data-ttu-id="24c9d-144">Considerações</span><span class="sxs-lookup"><span data-stu-id="24c9d-144">Considerations</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="24c9d-145">**Nome**</span><span class="sxs-lookup"><span data-stu-id="24c9d-145">**Name**</span></span> |<span data-ttu-id="24c9d-146">Nome de regra de saudação.</span><span class="sxs-lookup"><span data-stu-id="24c9d-146">Name for hello rule.</span></span> |<span data-ttu-id="24c9d-147">Deve ser exclusivo dentro da região de saudação.</span><span class="sxs-lookup"><span data-stu-id="24c9d-147">Must be unique within hello region.</span></span><br/><span data-ttu-id="24c9d-148">Pode conter letras, números, sublinhados, pontos e hifens.</span><span class="sxs-lookup"><span data-stu-id="24c9d-148">Can contain letters, numbers, underscores, periods, and hyphens.</span></span><br/><span data-ttu-id="24c9d-149">Deve começar com uma letra ou número.</span><span class="sxs-lookup"><span data-stu-id="24c9d-149">Must start with a letter or number.</span></span><br/><span data-ttu-id="24c9d-150">Deve terminar com uma letra, número ou sublinhado.</span><span class="sxs-lookup"><span data-stu-id="24c9d-150">Must end with a letter, number, or underscore.</span></span><br/><span data-ttu-id="24c9d-151">Não pode exceder 80 caracteres.</span><span class="sxs-lookup"><span data-stu-id="24c9d-151">Cannot exceed 80 characters.</span></span> |<span data-ttu-id="24c9d-152">Você pode ter várias regras dentro de um NSG, então certifique-se de que seguir uma convenção de nomenclatura que permite que você tooidentify função de saudação da sua regra.</span><span class="sxs-lookup"><span data-stu-id="24c9d-152">You may have several rules within an NSG, so make sure you follow a naming convention that allows you tooidentify hello function of your rule.</span></span> |
| <span data-ttu-id="24c9d-153">**Protocolo**</span><span class="sxs-lookup"><span data-stu-id="24c9d-153">**Protocol**</span></span> |<span data-ttu-id="24c9d-154">Toomatch de protocolo para a regra de saudação.</span><span class="sxs-lookup"><span data-stu-id="24c9d-154">Protocol toomatch for hello rule.</span></span> |<span data-ttu-id="24c9d-155">TCP, UDP ou *</span><span class="sxs-lookup"><span data-stu-id="24c9d-155">TCP, UDP, or *</span></span> |<span data-ttu-id="24c9d-156">Usando * como um protocolo inclui ICMP (somente o tráfego Leste e Oeste), como TCP e UDP e pode reduzir o número de saudação de regras que você precisa.</span><span class="sxs-lookup"><span data-stu-id="24c9d-156">Using * as a protocol includes ICMP (East-West traffic only), as well as UDP and TCP, and may reduce hello number of rules you need.</span></span><br/><span data-ttu-id="24c9d-157">AT Olá mesmo tempo, usando * pode ser uma abordagem muito ampla, portanto, é recomendável que você use * somente quando necessário.</span><span class="sxs-lookup"><span data-stu-id="24c9d-157">At hello same time, using * might be too broad an approach, so it's recommended that you use * only when necessary.</span></span> |
| <span data-ttu-id="24c9d-158">**Intervalo de portas de origem**</span><span class="sxs-lookup"><span data-stu-id="24c9d-158">**Source port range**</span></span> |<span data-ttu-id="24c9d-159">Toomatch de intervalo de porta de fonte para regra de saudação.</span><span class="sxs-lookup"><span data-stu-id="24c9d-159">Source port range toomatch for hello rule.</span></span> |<span data-ttu-id="24c9d-160">Um único número de porta de 1 too65535, intervalo de portas (exemplo: 1-65535), ou * (para todas as portas).</span><span class="sxs-lookup"><span data-stu-id="24c9d-160">Single port number from 1 too65535, port range (example: 1-65535), or * (for all ports).</span></span> |<span data-ttu-id="24c9d-161">As portas de origem pode ser efêmeras.</span><span class="sxs-lookup"><span data-stu-id="24c9d-161">Source ports could be ephemeral.</span></span> <span data-ttu-id="24c9d-162">A menos que seu programa cliente esteja usando uma porta específica, use * na maioria dos casos.</span><span class="sxs-lookup"><span data-stu-id="24c9d-162">Unless your client program is using a specific port, use * in most cases.</span></span><br/><span data-ttu-id="24c9d-163">Tente intervalos de porta toouse conforme a necessidade de saudação tooavoid possíveis para várias regras.</span><span class="sxs-lookup"><span data-stu-id="24c9d-163">Try toouse port ranges as much as possible tooavoid hello need for multiple rules.</span></span><br/><span data-ttu-id="24c9d-164">Várias portas ou intervalos de portas não podem ser agrupados por uma vírgula.</span><span class="sxs-lookup"><span data-stu-id="24c9d-164">Multiple ports or port ranges cannot be grouped by a comma.</span></span> |
| <span data-ttu-id="24c9d-165">**Intervalo de portas de destino**</span><span class="sxs-lookup"><span data-stu-id="24c9d-165">**Destination port range**</span></span> |<span data-ttu-id="24c9d-166">Toomatch de intervalo de porta de destino para a regra de saudação.</span><span class="sxs-lookup"><span data-stu-id="24c9d-166">Destination port range toomatch for hello rule.</span></span> |<span data-ttu-id="24c9d-167">Um único número de porta de 1 too65535, intervalo de portas (exemplo: 1-65535), ou \* (para todas as portas).</span><span class="sxs-lookup"><span data-stu-id="24c9d-167">Single port number from 1 too65535, port range (example: 1-65535), or \* (for all ports).</span></span> |<span data-ttu-id="24c9d-168">Tente intervalos de porta toouse conforme a necessidade de saudação tooavoid possíveis para várias regras.</span><span class="sxs-lookup"><span data-stu-id="24c9d-168">Try toouse port ranges as much as possible tooavoid hello need for multiple rules.</span></span><br/><span data-ttu-id="24c9d-169">Várias portas ou intervalos de portas não podem ser agrupados por uma vírgula.</span><span class="sxs-lookup"><span data-stu-id="24c9d-169">Multiple ports or port ranges cannot be grouped by a comma.</span></span> |
| <span data-ttu-id="24c9d-170">**Prefixo de endereço de origem**</span><span class="sxs-lookup"><span data-stu-id="24c9d-170">**Source address prefix**</span></span> |<span data-ttu-id="24c9d-171">Origem endereço prefixo ou marca toomatch para regra de saudação.</span><span class="sxs-lookup"><span data-stu-id="24c9d-171">Source address prefix or tag toomatch for hello rule.</span></span> |<span data-ttu-id="24c9d-172">Um único endereço IP (exemplo: 10.10.10.10), sub-rede de IP (exemplo: 192.168.1.0/24), [marca padrão](#default-tags) ou * (para todos os endereços).</span><span class="sxs-lookup"><span data-stu-id="24c9d-172">Single IP address (example: 10.10.10.10), IP subnet (example: 192.168.1.0/24), [default tag](#default-tags), or * (for all addresses).</span></span> |<span data-ttu-id="24c9d-173">Considere o uso de intervalos, marcas de formatação padrão, e * número de saudação tooreduce de regras.</span><span class="sxs-lookup"><span data-stu-id="24c9d-173">Consider using ranges, default tags, and * tooreduce hello number of rules.</span></span> |
| <span data-ttu-id="24c9d-174">**Prefixo de endereço de destino**</span><span class="sxs-lookup"><span data-stu-id="24c9d-174">**Destination address prefix**</span></span> |<span data-ttu-id="24c9d-175">Destino endereço prefixo ou marca toomatch para regra de saudação.</span><span class="sxs-lookup"><span data-stu-id="24c9d-175">Destination address prefix or tag toomatch for hello rule.</span></span> | <span data-ttu-id="24c9d-176">Um único endereço IP (exemplo: 10.10.10.10), sub-rede de IP (exemplo: 192.168.1.0/24), [marca padrão](#default-tags) ou * (para todos os endereços).</span><span class="sxs-lookup"><span data-stu-id="24c9d-176">Single IP address (example: 10.10.10.10), IP subnet (example: 192.168.1.0/24), [default tag](#default-tags), or * (for all addresses).</span></span> |<span data-ttu-id="24c9d-177">Considere o uso de intervalos, marcas de formatação padrão, e * número de saudação tooreduce de regras.</span><span class="sxs-lookup"><span data-stu-id="24c9d-177">Consider using ranges, default tags, and * tooreduce hello number of rules.</span></span> |
| <span data-ttu-id="24c9d-178">**Direção**</span><span class="sxs-lookup"><span data-stu-id="24c9d-178">**Direction**</span></span> |<span data-ttu-id="24c9d-179">Direção do tráfego toomatch para regra de saudação.</span><span class="sxs-lookup"><span data-stu-id="24c9d-179">Direction of traffic toomatch for hello rule.</span></span> |<span data-ttu-id="24c9d-180">Entrada ou saída.</span><span class="sxs-lookup"><span data-stu-id="24c9d-180">Inbound or outbound.</span></span> |<span data-ttu-id="24c9d-181">Regras de entrada e saída são processadas separadamente, com base na direção.</span><span class="sxs-lookup"><span data-stu-id="24c9d-181">Inbound and outbound rules are processed separately, based on direction.</span></span> |
| <span data-ttu-id="24c9d-182">**Prioridade**</span><span class="sxs-lookup"><span data-stu-id="24c9d-182">**Priority**</span></span> |<span data-ttu-id="24c9d-183">As regras são verificadas em ordem de saudação de prioridade.</span><span class="sxs-lookup"><span data-stu-id="24c9d-183">Rules are checked in hello order of priority.</span></span> <span data-ttu-id="24c9d-184">Depois que uma regra se aplica, outras regras não são testadas quanto à correspondência.</span><span class="sxs-lookup"><span data-stu-id="24c9d-184">Once a rule applies, no more rules are tested for matching.</span></span> | <span data-ttu-id="24c9d-185">Número entre 100 e 4096.</span><span class="sxs-lookup"><span data-stu-id="24c9d-185">Number between 100 and 4096.</span></span> | <span data-ttu-id="24c9d-186">Considere a criação de regras saltando prioridades por 100 para cada espaço de tooleave regra para as novas regras que você pode criar no hello futuras.</span><span class="sxs-lookup"><span data-stu-id="24c9d-186">Consider creating rules jumping priorities by 100 for each rule tooleave space for new rules you might create in hello future.</span></span> |
| <span data-ttu-id="24c9d-187">**Access**</span><span class="sxs-lookup"><span data-stu-id="24c9d-187">**Access**</span></span> |<span data-ttu-id="24c9d-188">Tipo de acesso tooapply se Olá regra corresponde.</span><span class="sxs-lookup"><span data-stu-id="24c9d-188">Type of access tooapply if hello rule matches.</span></span> | <span data-ttu-id="24c9d-189">Permitir ou negar.</span><span class="sxs-lookup"><span data-stu-id="24c9d-189">Allow or deny.</span></span> | <span data-ttu-id="24c9d-190">Tenha em mente que, se uma regra de permissão não for encontrada para um pacote, pacote de saudação é descartado.</span><span class="sxs-lookup"><span data-stu-id="24c9d-190">Keep in mind that if an allow rule is not found for a packet, hello packet is dropped.</span></span> |

<span data-ttu-id="24c9d-191">Os NSGs contêm dois conjuntos de regras: entrada e saída.</span><span class="sxs-lookup"><span data-stu-id="24c9d-191">NSGs contain two sets of rules: Inbound and outbound.</span></span> <span data-ttu-id="24c9d-192">prioridade de saudação para uma regra deve ser exclusiva em cada conjunto.</span><span class="sxs-lookup"><span data-stu-id="24c9d-192">hello priority for a rule must be unique within each set.</span></span> 

![Processamento de regras do NSG](./media/virtual-network-nsg-overview/figure3.png) 

<span data-ttu-id="24c9d-194">imagem anterior Olá mostra como as regras NSG são processadas.</span><span class="sxs-lookup"><span data-stu-id="24c9d-194">hello previous picture shows how NSG rules are processed.</span></span>

### <a name="default-tags"></a><span data-ttu-id="24c9d-195">Marcas padrão</span><span class="sxs-lookup"><span data-stu-id="24c9d-195">Default Tags</span></span>
<span data-ttu-id="24c9d-196">Marcas padrão são identificadores fornecidos pelo sistema tooaddress uma categoria de endereços IP.</span><span class="sxs-lookup"><span data-stu-id="24c9d-196">Default tags are system-provided identifiers tooaddress a category of IP addresses.</span></span> <span data-ttu-id="24c9d-197">Você pode usar marcas de formatação padrão na Olá **prefixo de endereço de origem** e **prefixo de endereço de destino** propriedades de qualquer regra.</span><span class="sxs-lookup"><span data-stu-id="24c9d-197">You can use default tags in hello **source address prefix** and **destination address prefix** properties of any rule.</span></span> <span data-ttu-id="24c9d-198">Há três marcas padrão que você pode usar:</span><span class="sxs-lookup"><span data-stu-id="24c9d-198">There are three default tags you can use:</span></span>

* <span data-ttu-id="24c9d-199">**VirtualNetwork** (Gerenciador de recursos) (**VIRTUAL_NETWORK** para clássico): essa marca inclui o espaço de endereço de rede virtual hello (intervalos CIDR definidos no Azure), todas conectadas espaços de endereço local e conectam VNets do Azure (redes locais).</span><span class="sxs-lookup"><span data-stu-id="24c9d-199">**VirtualNetwork** (Resource Manager) (**VIRTUAL_NETWORK** for classic): This tag includes hello virtual network address space (CIDR ranges defined in Azure), all connected on-premises address spaces, and connected Azure VNets (local networks).</span></span>
* <span data-ttu-id="24c9d-200">**AzureLoadBalancer** (Resource Manager) (**AZURE_LOADBALANCER** para clássico): essa marca denota o balanceador de carga de infraestrutura do Azure.</span><span class="sxs-lookup"><span data-stu-id="24c9d-200">**AzureLoadBalancer** (Resource Manager) (**AZURE_LOADBALANCER** for classic): This tag denotes Azure’s infrastructure load balancer.</span></span> <span data-ttu-id="24c9d-201">marca de saudação converte tooan proveniente de IP de datacenter do Azure onde sondas de integridade do Azure.</span><span class="sxs-lookup"><span data-stu-id="24c9d-201">hello tag translates tooan Azure datacenter IP where Azure’s health probes originate.</span></span>
* <span data-ttu-id="24c9d-202">**Internet** (Gerenciador de recursos) (**INTERNET** para clássico): esta marca denota o espaço de endereço IP de saudação que está fora da rede virtual hello e acessível pela Internet pública.</span><span class="sxs-lookup"><span data-stu-id="24c9d-202">**Internet** (Resource Manager) (**INTERNET** for classic): This tag denotes hello IP address space that is outside hello virtual network and reachable by public Internet.</span></span> <span data-ttu-id="24c9d-203">intervalo de saudação inclui Olá [Azure espaço IP próprio público](https://www.microsoft.com/download/details.aspx?id=41653).</span><span class="sxs-lookup"><span data-stu-id="24c9d-203">hello range includes hello [Azure owned public IP space](https://www.microsoft.com/download/details.aspx?id=41653).</span></span>

### <a name="default-rules"></a><span data-ttu-id="24c9d-204">Regras padrão</span><span class="sxs-lookup"><span data-stu-id="24c9d-204">Default rules</span></span>
<span data-ttu-id="24c9d-205">Todos os NSGs contêm um conjunto de regras padrão.</span><span class="sxs-lookup"><span data-stu-id="24c9d-205">All NSGs contain a set of default rules.</span></span> <span data-ttu-id="24c9d-206">as regras de saudação padrão não podem ser excluídas, mas porque eles recebem a prioridade mais baixa hello, elas podem ser substituídas pelas regras de saudação que você criar.</span><span class="sxs-lookup"><span data-stu-id="24c9d-206">hello default rules cannot be deleted, but because they are assigned hello lowest priority, they can be overridden by hello rules that you create.</span></span> 

<span data-ttu-id="24c9d-207">as regras padrão Olá permitem e impedir que o tráfego da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="24c9d-207">hello default rules allow and disallow traffic as follows:</span></span>
- <span data-ttu-id="24c9d-208">**Rede virtual:** o tráfego que começa e termina em uma rede virtual é permitido nas direções de entrada e saída.</span><span class="sxs-lookup"><span data-stu-id="24c9d-208">**Virtual network:** Traffic originating and ending in a virtual network is allowed both in inbound and outbound directions.</span></span>
- <span data-ttu-id="24c9d-209">**Internet:** o tráfego de saída é permitido, mas o tráfego de entrada é bloqueado.</span><span class="sxs-lookup"><span data-stu-id="24c9d-209">**Internet:** Outbound traffic is allowed, but inbound traffic is blocked.</span></span>
- <span data-ttu-id="24c9d-210">**Balanceador de carga:** integridade do Azure carga balanceador tooprobe Olá permitir de suas máquinas virtuais e instâncias de função.</span><span class="sxs-lookup"><span data-stu-id="24c9d-210">**Load balancer:** Allow Azure’s load balancer tooprobe hello health of your VMs and role instances.</span></span> <span data-ttu-id="24c9d-211">Se não estiver usando um conjunto de balanceamento de carga, você poderá substituir essa regra.</span><span class="sxs-lookup"><span data-stu-id="24c9d-211">If you are not using a load balanced set you can override this rule.</span></span>

<span data-ttu-id="24c9d-212">**Regras de entrada padrão**</span><span class="sxs-lookup"><span data-stu-id="24c9d-212">**Inbound default rules**</span></span>

| <span data-ttu-id="24c9d-213">Nome</span><span class="sxs-lookup"><span data-stu-id="24c9d-213">Name</span></span> | <span data-ttu-id="24c9d-214">Prioridade</span><span class="sxs-lookup"><span data-stu-id="24c9d-214">Priority</span></span> | <span data-ttu-id="24c9d-215">IP de origem</span><span class="sxs-lookup"><span data-stu-id="24c9d-215">Source IP</span></span> | <span data-ttu-id="24c9d-216">Porta de origem</span><span class="sxs-lookup"><span data-stu-id="24c9d-216">Source Port</span></span> | <span data-ttu-id="24c9d-217">IP de destino</span><span class="sxs-lookup"><span data-stu-id="24c9d-217">Destination IP</span></span> | <span data-ttu-id="24c9d-218">Porta de destino</span><span class="sxs-lookup"><span data-stu-id="24c9d-218">Destination Port</span></span> | <span data-ttu-id="24c9d-219">Protocolo</span><span class="sxs-lookup"><span data-stu-id="24c9d-219">Protocol</span></span> | <span data-ttu-id="24c9d-220">Access</span><span class="sxs-lookup"><span data-stu-id="24c9d-220">Access</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="24c9d-221">AllowVNetInBound</span><span class="sxs-lookup"><span data-stu-id="24c9d-221">AllowVNetInBound</span></span> |<span data-ttu-id="24c9d-222">65000</span><span class="sxs-lookup"><span data-stu-id="24c9d-222">65000</span></span> | <span data-ttu-id="24c9d-223">VirtualNetwork</span><span class="sxs-lookup"><span data-stu-id="24c9d-223">VirtualNetwork</span></span> | * | <span data-ttu-id="24c9d-224">VirtualNetwork</span><span class="sxs-lookup"><span data-stu-id="24c9d-224">VirtualNetwork</span></span> | * | * | <span data-ttu-id="24c9d-225">PERMITIR</span><span class="sxs-lookup"><span data-stu-id="24c9d-225">Allow</span></span> |
| <span data-ttu-id="24c9d-226">AllowAzureLoadBalancerInBound</span><span class="sxs-lookup"><span data-stu-id="24c9d-226">AllowAzureLoadBalancerInBound</span></span> | <span data-ttu-id="24c9d-227">65001</span><span class="sxs-lookup"><span data-stu-id="24c9d-227">65001</span></span> | <span data-ttu-id="24c9d-228">AzureLoadBalancer</span><span class="sxs-lookup"><span data-stu-id="24c9d-228">AzureLoadBalancer</span></span> | * | * | * | * | <span data-ttu-id="24c9d-229">PERMITIR</span><span class="sxs-lookup"><span data-stu-id="24c9d-229">Allow</span></span> |
| <span data-ttu-id="24c9d-230">DenyAllInBound</span><span class="sxs-lookup"><span data-stu-id="24c9d-230">DenyAllInBound</span></span> |<span data-ttu-id="24c9d-231">65500</span><span class="sxs-lookup"><span data-stu-id="24c9d-231">65500</span></span> | * | * | * | * | * | <span data-ttu-id="24c9d-232">NEGAR</span><span class="sxs-lookup"><span data-stu-id="24c9d-232">Deny</span></span> |

<span data-ttu-id="24c9d-233">**Regras de saída padrão**</span><span class="sxs-lookup"><span data-stu-id="24c9d-233">**Outbound default rules**</span></span>

| <span data-ttu-id="24c9d-234">Nome</span><span class="sxs-lookup"><span data-stu-id="24c9d-234">Name</span></span> | <span data-ttu-id="24c9d-235">Prioridade</span><span class="sxs-lookup"><span data-stu-id="24c9d-235">Priority</span></span> | <span data-ttu-id="24c9d-236">IP de origem</span><span class="sxs-lookup"><span data-stu-id="24c9d-236">Source IP</span></span> | <span data-ttu-id="24c9d-237">Porta de origem</span><span class="sxs-lookup"><span data-stu-id="24c9d-237">Source Port</span></span> | <span data-ttu-id="24c9d-238">IP de destino</span><span class="sxs-lookup"><span data-stu-id="24c9d-238">Destination IP</span></span> | <span data-ttu-id="24c9d-239">Porta de destino</span><span class="sxs-lookup"><span data-stu-id="24c9d-239">Destination Port</span></span> | <span data-ttu-id="24c9d-240">Protocolo</span><span class="sxs-lookup"><span data-stu-id="24c9d-240">Protocol</span></span> | <span data-ttu-id="24c9d-241">Access</span><span class="sxs-lookup"><span data-stu-id="24c9d-241">Access</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="24c9d-242">AllowVnetOutBound</span><span class="sxs-lookup"><span data-stu-id="24c9d-242">AllowVnetOutBound</span></span> | <span data-ttu-id="24c9d-243">65000</span><span class="sxs-lookup"><span data-stu-id="24c9d-243">65000</span></span> | <span data-ttu-id="24c9d-244">VirtualNetwork</span><span class="sxs-lookup"><span data-stu-id="24c9d-244">VirtualNetwork</span></span> | * | <span data-ttu-id="24c9d-245">VirtualNetwork</span><span class="sxs-lookup"><span data-stu-id="24c9d-245">VirtualNetwork</span></span> | * | * | <span data-ttu-id="24c9d-246">PERMITIR</span><span class="sxs-lookup"><span data-stu-id="24c9d-246">Allow</span></span> |
| <span data-ttu-id="24c9d-247">AllowInternetOutBound</span><span class="sxs-lookup"><span data-stu-id="24c9d-247">AllowInternetOutBound</span></span> | <span data-ttu-id="24c9d-248">65001</span><span class="sxs-lookup"><span data-stu-id="24c9d-248">65001</span></span> | * | * | <span data-ttu-id="24c9d-249">Internet</span><span class="sxs-lookup"><span data-stu-id="24c9d-249">Internet</span></span> | * | * | <span data-ttu-id="24c9d-250">PERMITIR</span><span class="sxs-lookup"><span data-stu-id="24c9d-250">Allow</span></span> |
| <span data-ttu-id="24c9d-251">DenyAllOutBound</span><span class="sxs-lookup"><span data-stu-id="24c9d-251">DenyAllOutBound</span></span> | <span data-ttu-id="24c9d-252">65500</span><span class="sxs-lookup"><span data-stu-id="24c9d-252">65500</span></span> | * | * | * | * | * | <span data-ttu-id="24c9d-253">NEGAR</span><span class="sxs-lookup"><span data-stu-id="24c9d-253">Deny</span></span> |

## <a name="associating-nsgs"></a><span data-ttu-id="24c9d-254">Associando NSGs</span><span class="sxs-lookup"><span data-stu-id="24c9d-254">Associating NSGs</span></span>
<span data-ttu-id="24c9d-255">Você pode associar um NSG tooVMs, NICs e sub-redes, dependendo do modelo de implantação de saudação que você está usando, da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="24c9d-255">You can associate an NSG tooVMs, NICs, and subnets, depending on hello deployment model you are using, as follows:</span></span>

* <span data-ttu-id="24c9d-256">**VM (clássico):** regras de segurança são aplicadas tooall tráfego na Olá VM.</span><span class="sxs-lookup"><span data-stu-id="24c9d-256">**VM (classic only):** Security rules are applied tooall traffic to/from hello VM.</span></span> 
* <span data-ttu-id="24c9d-257">**NIC (somente no Gerenciador de recursos):** regras de segurança são aplicadas tooall tráfego na Olá Olá NIC NSG está associado.</span><span class="sxs-lookup"><span data-stu-id="24c9d-257">**NIC (Resource Manager only):** Security rules are applied tooall traffic to/from hello NIC hello NSG is associated to.</span></span> <span data-ttu-id="24c9d-258">Em uma VM multi-NIC, você pode aplicar diferentes (ou Olá mesmo) NSG tooeach NIC individualmente.</span><span class="sxs-lookup"><span data-stu-id="24c9d-258">In a multi-NIC VM, you can apply different (or hello same) NSG tooeach NIC individually.</span></span> 
* <span data-ttu-id="24c9d-259">**Subrede (Gerenciador de recursos e clássico):** regras de segurança são aplicadas tooany tráfego para/de todos os recursos conectados toohello VNet.</span><span class="sxs-lookup"><span data-stu-id="24c9d-259">**Subnet (Resource Manager and classic):** Security rules are applied tooany traffic to/from any resources connected toohello VNet.</span></span>

<span data-ttu-id="24c9d-260">Você pode associar diferentes NSGs tooa VM (ou NIC, dependendo do modelo de implantação de saudação) e Olá uma VM ou NIC conectado à sub-rede.</span><span class="sxs-lookup"><span data-stu-id="24c9d-260">You can associate different NSGs tooa VM (or NIC, depending on hello deployment model) and hello subnet that a NIC or VM is connected to.</span></span> <span data-ttu-id="24c9d-261">As regras de segurança de tráfego toohello aplicadas, por prioridade, em cada NSG, em Olá a seguir ordem:</span><span class="sxs-lookup"><span data-stu-id="24c9d-261">Security rules are applied toohello traffic, by priority, in each NSG, in hello following order:</span></span>

- <span data-ttu-id="24c9d-262">**Tráfego de entrada**</span><span class="sxs-lookup"><span data-stu-id="24c9d-262">**Inbound traffic**</span></span>

  1. <span data-ttu-id="24c9d-263">**Toosubnet NSG aplicado:** se uma sub-rede NSG tiver um tráfego de toodeny regra de correspondência, o pacote de saudação é descartado.</span><span class="sxs-lookup"><span data-stu-id="24c9d-263">**NSG applied toosubnet:** If a subnet NSG has a matching rule toodeny traffic, hello packet is dropped.</span></span>

  2. <span data-ttu-id="24c9d-264">**NSG aplicada tooNIC** (Gerenciador de recursos) ou VM (clássico): NSG de VM\NIC se tem uma regra de correspondência que nega o tráfego, os pacotes são descartados em Olá VM\NIC, mesmo se uma sub-rede NSG tem uma regra de correspondência que permita o tráfego.</span><span class="sxs-lookup"><span data-stu-id="24c9d-264">**NSG applied tooNIC** (Resource Manager) or VM (classic): If VM\NIC NSG has a matching rule that denies traffic, packets are dropped at hello VM\NIC, even if a subnet NSG has a matching rule that allows traffic.</span></span>

- <span data-ttu-id="24c9d-265">**Tráfego de saída**</span><span class="sxs-lookup"><span data-stu-id="24c9d-265">**Outbound traffic**</span></span>

  1. <span data-ttu-id="24c9d-266">**NSG aplicada tooNIC** (Gerenciador de recursos) ou VM (clássico): se um NSG VM\NIC tem uma regra de correspondência que nega o tráfego, os pacotes são descartados.</span><span class="sxs-lookup"><span data-stu-id="24c9d-266">**NSG applied tooNIC** (Resource Manager) or VM (classic): If a VM\NIC NSG has a matching rule that denies traffic, packets are dropped.</span></span>

  2. <span data-ttu-id="24c9d-267">**Toosubnet NSG aplicado:** se uma sub-rede NSG tem uma regra de correspondência que nega o tráfego, pacotes sejam descartados, mesmo se um NSG VM\NIC tem uma regra de correspondência que permita o tráfego.</span><span class="sxs-lookup"><span data-stu-id="24c9d-267">**NSG applied toosubnet:** If a subnet NSG has a matching rule that denies traffic, packets are dropped, even if a VM\NIC NSG has a matching rule that allows traffic.</span></span>

> [!NOTE]
> <span data-ttu-id="24c9d-268">Embora você só pode associar uma única NSG tooa sub-rede, VM ou NIC; Você pode associar Olá mesmo tooas NSG muitos recursos que você desejar.</span><span class="sxs-lookup"><span data-stu-id="24c9d-268">Although you can only associate a single NSG tooa subnet, VM, or NIC; you can associate hello same NSG tooas many resources as you want.</span></span>
>

## <a name="implementation"></a><span data-ttu-id="24c9d-269">Implementação</span><span class="sxs-lookup"><span data-stu-id="24c9d-269">Implementation</span></span>
<span data-ttu-id="24c9d-270">Você pode implementar NSGs em Olá Gerenciador de recursos ou modelos de implantação clássico usando Olá ferramentas a seguir:</span><span class="sxs-lookup"><span data-stu-id="24c9d-270">You can implement NSGs in hello Resource Manager or classic deployment models using hello following tools:</span></span>

| <span data-ttu-id="24c9d-271">Ferramenta de implantação</span><span class="sxs-lookup"><span data-stu-id="24c9d-271">Deployment tool</span></span> | <span data-ttu-id="24c9d-272">Clássico</span><span class="sxs-lookup"><span data-stu-id="24c9d-272">Classic</span></span> | <span data-ttu-id="24c9d-273">Gerenciador de Recursos</span><span class="sxs-lookup"><span data-stu-id="24c9d-273">Resource Manager</span></span> |
| --- | --- | --- |
| <span data-ttu-id="24c9d-274">Portal do Azure</span><span class="sxs-lookup"><span data-stu-id="24c9d-274">Azure portal</span></span>   | <span data-ttu-id="24c9d-275">Sim</span><span class="sxs-lookup"><span data-stu-id="24c9d-275">Yes</span></span> | [<span data-ttu-id="24c9d-276">Sim</span><span class="sxs-lookup"><span data-stu-id="24c9d-276">Yes</span></span>](virtual-networks-create-nsg-arm-pportal.md) |
| <span data-ttu-id="24c9d-277">PowerShell</span><span class="sxs-lookup"><span data-stu-id="24c9d-277">PowerShell</span></span>     | [<span data-ttu-id="24c9d-278">Sim</span><span class="sxs-lookup"><span data-stu-id="24c9d-278">Yes</span></span>](virtual-networks-create-nsg-classic-ps.md) | [<span data-ttu-id="24c9d-279">Sim</span><span class="sxs-lookup"><span data-stu-id="24c9d-279">Yes</span></span>](virtual-networks-create-nsg-arm-ps.md) |
| <span data-ttu-id="24c9d-280">CLI do Azure **V1**</span><span class="sxs-lookup"><span data-stu-id="24c9d-280">Azure CLI **V1**</span></span>   | [<span data-ttu-id="24c9d-281">Sim</span><span class="sxs-lookup"><span data-stu-id="24c9d-281">Yes</span></span>](virtual-networks-create-nsg-classic-cli.md) | [<span data-ttu-id="24c9d-282">Sim</span><span class="sxs-lookup"><span data-stu-id="24c9d-282">Yes</span></span>](virtual-networks-create-nsg-cli-nodejs.md) |
| <span data-ttu-id="24c9d-283">CLI do Azure **V2**</span><span class="sxs-lookup"><span data-stu-id="24c9d-283">Azure CLI **V2**</span></span>   | <span data-ttu-id="24c9d-284">Não</span><span class="sxs-lookup"><span data-stu-id="24c9d-284">No</span></span> | [<span data-ttu-id="24c9d-285">Sim</span><span class="sxs-lookup"><span data-stu-id="24c9d-285">Yes</span></span>](virtual-networks-create-nsg-arm-cli.md) |
| <span data-ttu-id="24c9d-286">Modelo do Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="24c9d-286">Azure Resource Manager template</span></span>   | <span data-ttu-id="24c9d-287">Não</span><span class="sxs-lookup"><span data-stu-id="24c9d-287">No</span></span>  | [<span data-ttu-id="24c9d-288">Sim</span><span class="sxs-lookup"><span data-stu-id="24c9d-288">Yes</span></span>](virtual-networks-create-nsg-arm-template.md) |

## <a name="planning"></a><span data-ttu-id="24c9d-289">Planejamento</span><span class="sxs-lookup"><span data-stu-id="24c9d-289">Planning</span></span>
<span data-ttu-id="24c9d-290">Antes de implementar os NSGs, é necessário tooanswer Olá perguntas a seguir:</span><span class="sxs-lookup"><span data-stu-id="24c9d-290">Before implementing NSGs, you need tooanswer hello following questions:</span></span>

1. <span data-ttu-id="24c9d-291">Os tipos de recursos você deseja toofilter tooor de tráfego de?</span><span class="sxs-lookup"><span data-stu-id="24c9d-291">What types of resources do you want toofilter traffic tooor from?</span></span> <span data-ttu-id="24c9d-292">Você pode se conectar a recursos, como NICs (Resource Manager), máquinas virtuais (clássico), serviços de nuvem, ambientes de serviço de aplicativos e Conjuntos de Dimensionamento de VMs.</span><span class="sxs-lookup"><span data-stu-id="24c9d-292">You can connect resources such as NICs (Resource Manager), VMs (classic), Cloud Services, Application Service Environments, and VM Scale Sets.</span></span> 
2. <span data-ttu-id="24c9d-293">São Olá recursos você deseja que o tráfego de toofilter de toosubnets conectado em VNets existentes?</span><span class="sxs-lookup"><span data-stu-id="24c9d-293">Are hello resources you want toofilter traffic to/from connected toosubnets in existing VNets?</span></span>

<span data-ttu-id="24c9d-294">Para obter mais informações sobre planejamento de segurança de rede no Azure, leia Olá [serviços de nuvem e segurança de rede](../best-practices-network-security.md) artigo.</span><span class="sxs-lookup"><span data-stu-id="24c9d-294">For more information on planning for network security in Azure, read hello [Cloud services and network security](../best-practices-network-security.md) article.</span></span> 

## <a name="design-considerations"></a><span data-ttu-id="24c9d-295">Considerações sobre o design</span><span class="sxs-lookup"><span data-stu-id="24c9d-295">Design considerations</span></span>
<span data-ttu-id="24c9d-296">Depois que você souber respostas Olá perguntas toohello Olá [planejamento](#Planning) seção, examine Olá seções a seguir antes de definir seus NSGs:</span><span class="sxs-lookup"><span data-stu-id="24c9d-296">Once you know hello answers toohello questions in hello [Planning](#Planning) section, review hello following sections before defining your NSGs:</span></span>

### <a name="limits"></a><span data-ttu-id="24c9d-297">limites</span><span class="sxs-lookup"><span data-stu-id="24c9d-297">Limits</span></span>
<span data-ttu-id="24c9d-298">Há limites de número de toohello de NSGs que em uma assinatura e o número de regras por NSG.</span><span class="sxs-lookup"><span data-stu-id="24c9d-298">There are limits toohello number of NSGs you can have in a subscription and number of rules per NSG.</span></span> <span data-ttu-id="24c9d-299">mais sobre os limites de Olá Olá de leitura de toolearn [Azure limita](../azure-subscription-service-limits.md#networking-limits) artigo.</span><span class="sxs-lookup"><span data-stu-id="24c9d-299">toolearn more about hello limits, read hello [Azure limits](../azure-subscription-service-limits.md#networking-limits) article.</span></span>

### <a name="vnet-and-subnet-design"></a><span data-ttu-id="24c9d-300">Design da rede virtual e da sub-rede</span><span class="sxs-lookup"><span data-stu-id="24c9d-300">VNet and subnet design</span></span>
<span data-ttu-id="24c9d-301">Como os NSGs podem ser aplicadas toosubnets, você pode minimizar o número de saudação do NSGs agrupando os recursos de sub-rede e aplicando os NSGs toosubnets.</span><span class="sxs-lookup"><span data-stu-id="24c9d-301">Since NSGs can be applied toosubnets, you can minimize hello number of NSGs by grouping your resources by subnet, and applying NSGs toosubnets.</span></span>  <span data-ttu-id="24c9d-302">Se você decidir tooapply NSGs toosubnets, você pode achar que VNets existentes e sub-redes que não foram definidas com os NSGs em mente.</span><span class="sxs-lookup"><span data-stu-id="24c9d-302">If you decide tooapply NSGs toosubnets, you may find that existing VNets and subnets you have were not defined with NSGs in mind.</span></span> <span data-ttu-id="24c9d-303">Você pode precisar toodefine novas VNets e sub-redes toosupport seu design NSG e implantar novas sub-redes de tooyour seus recursos novos.</span><span class="sxs-lookup"><span data-stu-id="24c9d-303">You may need toodefine new VNets and subnets toosupport your NSG design and deploy your new resources tooyour new subnets.</span></span> <span data-ttu-id="24c9d-304">Em seguida, você pode definir um toomove de estratégia de migração existente novas sub-redes de toohello de recursos.</span><span class="sxs-lookup"><span data-stu-id="24c9d-304">You could then define a migration strategy toomove existing resources toohello new subnets.</span></span> 

### <a name="special-rules"></a><span data-ttu-id="24c9d-305">Regras especiais</span><span class="sxs-lookup"><span data-stu-id="24c9d-305">Special rules</span></span>
<span data-ttu-id="24c9d-306">Se você bloquear o tráfego permitido pelo Olá regras a seguir, sua infraestrutura não pode se comunicar com os serviços do Azure essenciais:</span><span class="sxs-lookup"><span data-stu-id="24c9d-306">If you block traffic allowed by hello following rules, your infrastructure can't communicate with essential Azure services:</span></span>

* <span data-ttu-id="24c9d-307">**IP virtual do nó de host Olá:** serviços de infraestrutura básica como DHCP, DNS e monitoramento de integridade são fornecidos por meio de host virtualizado Olá endereço IP 168.63.129.16.</span><span class="sxs-lookup"><span data-stu-id="24c9d-307">**Virtual IP of hello host node:** Basic infrastructure services such as DHCP, DNS, and health monitoring are provided through hello virtualized host IP address 168.63.129.16.</span></span> <span data-ttu-id="24c9d-308">Este endereço IP público pertence tooMicrosoft e é Olá único endereço IP virtualizado usado em todas as regiões para essa finalidade.</span><span class="sxs-lookup"><span data-stu-id="24c9d-308">This public IP address belongs tooMicrosoft and is hello only virtualized IP address used in all regions for this purpose.</span></span> <span data-ttu-id="24c9d-309">Esse endereço IP mapeia toohello endereço IP físico da máquina do servidor de saudação (nó de host) hospeda Olá VM.</span><span class="sxs-lookup"><span data-stu-id="24c9d-309">This IP address maps toohello physical IP address of hello server machine (host node) hosting hello VM.</span></span> <span data-ttu-id="24c9d-310">nó de host Olá atua como retransmissão DHCP hello, resolvedor de DNS recursivo hello e fonte investigação Olá Olá carga sonda do balanceador de integridade e investigação de integridade do computador hello.</span><span class="sxs-lookup"><span data-stu-id="24c9d-310">hello host node acts as hello DHCP relay, hello DNS recursive resolver, and hello probe source for hello load balancer health probe and hello machine health probe.</span></span> <span data-ttu-id="24c9d-311">Endereço IP de toothis de comunicação não é um ataque.</span><span class="sxs-lookup"><span data-stu-id="24c9d-311">Communication toothis IP address is not an attack.</span></span>
* <span data-ttu-id="24c9d-312">**Licenciamento (serviço de gerenciamento de chaves):** imagens do Windows em execução em VMs devem ser licenciadas.</span><span class="sxs-lookup"><span data-stu-id="24c9d-312">**Licensing (Key Management Service):** Windows images running in VMs must be licensed.</span></span> <span data-ttu-id="24c9d-313">tooensure licenciamento, uma solicitação é enviada toohello servidores de host de serviço de gerenciamento de chaves que lidam com essas consultas.</span><span class="sxs-lookup"><span data-stu-id="24c9d-313">tooensure licensing, a request is sent toohello Key Management Service host servers that handle such queries.</span></span> <span data-ttu-id="24c9d-314">solicitação de saudação é feita saída pela porta 1688.</span><span class="sxs-lookup"><span data-stu-id="24c9d-314">hello request is made outbound through port 1688.</span></span>

### <a name="icmp-traffic"></a><span data-ttu-id="24c9d-315">Tráfego ICMP</span><span class="sxs-lookup"><span data-stu-id="24c9d-315">ICMP traffic</span></span>
<span data-ttu-id="24c9d-316">as regras NSG atuais Olá permitem apenas protocolos *TCP* ou *UDP*.</span><span class="sxs-lookup"><span data-stu-id="24c9d-316">hello current NSG rules only allow for protocols *TCP* or *UDP*.</span></span> <span data-ttu-id="24c9d-317">Não há uma marca específica para o *ICMP*.</span><span class="sxs-lookup"><span data-stu-id="24c9d-317">There is not a specific tag for *ICMP*.</span></span> <span data-ttu-id="24c9d-318">No entanto, o tráfego ICMP é permitido dentro de uma rede virtual por regra padrão AllowVNetInBound hello, que permite tooand de tráfego de qualquer porta e protocolo dentro Olá VNet.</span><span class="sxs-lookup"><span data-stu-id="24c9d-318">However, ICMP traffic is allowed within a VNet by hello AllowVNetInBound default rule, that allows traffic tooand from any port and protocol within hello VNet.</span></span>

### <a name="subnets"></a><span data-ttu-id="24c9d-319">Sub-redes</span><span class="sxs-lookup"><span data-stu-id="24c9d-319">Subnets</span></span>
* <span data-ttu-id="24c9d-320">Considere o número de saudação de camadas que requer sua carga de trabalho.</span><span class="sxs-lookup"><span data-stu-id="24c9d-320">Consider hello number of tiers your workload requires.</span></span> <span data-ttu-id="24c9d-321">Cada camada pode ser isolada por meio de uma sub-rede, com uma sub-rede de toohello NSG aplicado.</span><span class="sxs-lookup"><span data-stu-id="24c9d-321">Each tier can be isolated by using a subnet, with an NSG applied toohello subnet.</span></span> 
* <span data-ttu-id="24c9d-322">Se você precisar tooimplement uma sub-rede de gateway de VPN ou circuito de rota expressa, **não** se aplicam a uma sub-rede de toothat NSG.</span><span class="sxs-lookup"><span data-stu-id="24c9d-322">If you need tooimplement a subnet for a VPN gateway, or ExpressRoute circuit, do **not** apply an NSG toothat subnet.</span></span> <span data-ttu-id="24c9d-323">Se você fizer isso, a conectividade entre VNet ou entre locais poderá falhar.</span><span class="sxs-lookup"><span data-stu-id="24c9d-323">If you do so, cross-VNet or cross-premises connectivity may fail.</span></span> 
* <span data-ttu-id="24c9d-324">Se você precisar tooimplement um dispositivo de rede virtual NVA (), conecte-se Olá NVA tooits próprio subrede e criar rotas definidas pelo usuário (UDR) tooand de saudação NVA.</span><span class="sxs-lookup"><span data-stu-id="24c9d-324">If you need tooimplement a network virtual appliance (NVA), connect hello NVA tooits own subnet and create user-defined routes (UDR) tooand from hello NVA.</span></span> <span data-ttu-id="24c9d-325">Você pode implementar um nível de sub-rede tráfego de toofilter NSG dentro e fora nesta sub-rede.</span><span class="sxs-lookup"><span data-stu-id="24c9d-325">You can implement a subnet level NSG toofilter traffic in and out of this subnet.</span></span> <span data-ttu-id="24c9d-326">toolearn mais sobre UDRs, ler Olá [rotas definidas pelo usuário](virtual-networks-udr-overview.md) artigo.</span><span class="sxs-lookup"><span data-stu-id="24c9d-326">toolearn more about UDRs, read hello [User-defined routes](virtual-networks-udr-overview.md) article.</span></span>

### <a name="load-balancers"></a><span data-ttu-id="24c9d-327">Balanceadores de carga</span><span class="sxs-lookup"><span data-stu-id="24c9d-327">Load balancers</span></span>
* <span data-ttu-id="24c9d-328">Considere o endereço de rede e balanceamento de carga de saudação regras NAT (conversão) para cada balanceador de carga usada por cada uma das suas cargas de trabalho.</span><span class="sxs-lookup"><span data-stu-id="24c9d-328">Consider hello load balancing and network address translation (NAT) rules for each load balancer used by each of your workloads.</span></span> <span data-ttu-id="24c9d-329">Regras NAT são associados tooa pool de back-end que contém instâncias de função de serviços de nuvem/VMs (clássico) ou NICs (Gerenciador de recursos).</span><span class="sxs-lookup"><span data-stu-id="24c9d-329">NAT rules are bound tooa back-end pool that contains NICs (Resource Manager) or VMs/Cloud Services role instances (classic).</span></span> <span data-ttu-id="24c9d-330">Considere a criação de um NSG para cada pool de back-end, permitindo que somente o tráfego mapeado por meio de regras de saudação implementadas em balanceadores de carga de saudação.</span><span class="sxs-lookup"><span data-stu-id="24c9d-330">Consider creating an NSG for each back-end pool, allowing only traffic mapped through hello rules implemented in hello load balancers.</span></span> <span data-ttu-id="24c9d-331">Criar um NSG para cada pool de back-end, você garante que o tráfego proveniente de pool de back-end toohello diretamente (em vez de por meio do balanceador de carga de saudação), também é filtrada.</span><span class="sxs-lookup"><span data-stu-id="24c9d-331">Creating an NSG for each back-end pool guarantees that traffic coming toohello back-end pool directly (rather than through hello load balancer), is also filtered.</span></span>
* <span data-ttu-id="24c9d-332">Em implantações clássicas, você deve criar pontos de extremidade que mapeiam portas em um tooports do balanceador de carga em suas VMs ou instâncias de função.</span><span class="sxs-lookup"><span data-stu-id="24c9d-332">In classic deployments, you create endpoints that map ports on a load balancer tooports on your VMs or role instances.</span></span> <span data-ttu-id="24c9d-333">Você também pode criar seu próprio balanceador de carga público individual por meio do Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="24c9d-333">You can also create your own individual public-facing load balancer through Resource Manager.</span></span> <span data-ttu-id="24c9d-334">porta de destino Olá para tráfego de entrada é porta real Olá Olá VM ou instância de função, não porta Olá exposta por um balanceador de carga.</span><span class="sxs-lookup"><span data-stu-id="24c9d-334">hello destination port for incoming traffic is hello actual port in hello VM or role instance, not hello port exposed by a load balancer.</span></span> <span data-ttu-id="24c9d-335">porta de origem Hello e o endereço de saudação conexão toohello em que VM é uma porta e endereço Olá Olá Internet computador remoto, não porta hello e o endereço de expostos pelo Balanceador de carga de saudação.</span><span class="sxs-lookup"><span data-stu-id="24c9d-335">hello source port and address for hello connection toohello VM is a port and address on hello remote computer in hello Internet, not hello port and address exposed by hello load balancer.</span></span>
* <span data-ttu-id="24c9d-336">Quando você cria os NSGs toofilter tráfego recebidas por meio de um balanceador de carga interno (ILB), produtos de intervalo de porta e endereço de origem Olá aplicado são de saudação computador, não o balanceador de carga Olá de origem.</span><span class="sxs-lookup"><span data-stu-id="24c9d-336">When you create NSGs toofilter traffic coming through an internal load balancer (ILB), hello source port and address range applied are  from hello originating computer, not hello load balancer.</span></span> <span data-ttu-id="24c9d-337">intervalo de porta e endereço de destino de saudação são aqueles do computador de destino hello, não o balanceador de carga hello.</span><span class="sxs-lookup"><span data-stu-id="24c9d-337">hello destination port and address range are those of hello destination computer, not hello load balancer.</span></span>

### <a name="other"></a><span data-ttu-id="24c9d-338">outro</span><span class="sxs-lookup"><span data-stu-id="24c9d-338">Other</span></span>
* <span data-ttu-id="24c9d-339">Listas de controle de acesso baseado em ponto de extremidade (ACL) e os NSGs não têm suporte em Olá mesma instância VM.</span><span class="sxs-lookup"><span data-stu-id="24c9d-339">Endpoint-based access control lists (ACL) and NSGs are not supported on hello same VM instance.</span></span> <span data-ttu-id="24c9d-340">Se você quiser toouse um NSG e já tiver um ponto de extremidade ACL em vigor, primeiro remova o ponto de extremidade de saudação ACL.</span><span class="sxs-lookup"><span data-stu-id="24c9d-340">If you want toouse an NSG and have an endpoint ACL already in place, first remove hello endpoint ACL.</span></span> <span data-ttu-id="24c9d-341">Para obter informações sobre como tooremove um ponto de extremidade ACL, consulte Olá [gerenciar ACLs de ponto de extremidade](virtual-networks-acl-powershell.md) artigo.</span><span class="sxs-lookup"><span data-stu-id="24c9d-341">For information about how tooremove an endpoint ACL, see hello [Manage endpoint ACLs](virtual-networks-acl-powershell.md) article.</span></span>
* <span data-ttu-id="24c9d-342">No Gerenciador de recursos, você pode usar um tooa NSG associado NIC para VMs com o gerenciamento de tooenable várias NICs (acesso remoto) em uma base por NIC.</span><span class="sxs-lookup"><span data-stu-id="24c9d-342">In Resource Manager, you can use an NSG associated tooa NIC for VMs with multiple NICs tooenable management (remote access) on a per NIC basis.</span></span> <span data-ttu-id="24c9d-343">Associar exclusivo NSGs tooeach NIC permite a separação dos tipos de tráfego entre NICs.</span><span class="sxs-lookup"><span data-stu-id="24c9d-343">Associating unique NSGs tooeach NIC enables separation of traffic types across NICs.</span></span>
* <span data-ttu-id="24c9d-344">Use toohello semelhante de balanceadores de carga, ao filtrar o tráfego de outras VNets, você deve usar o intervalo de endereço de origem de saudação do computador remoto hello, não gateway Olá conectando Olá VNets.</span><span class="sxs-lookup"><span data-stu-id="24c9d-344">Similar toohello use of load balancers, when filtering traffic from other VNets, you must use hello source address range of hello remote computer, not hello gateway connecting hello VNets.</span></span>
* <span data-ttu-id="24c9d-345">Muitos serviços do Azure não podem ser tooVNets conectado.</span><span class="sxs-lookup"><span data-stu-id="24c9d-345">Many Azure services cannot be connected tooVNets.</span></span> <span data-ttu-id="24c9d-346">Se um recurso do Azure não estiver conectado tooa VNet, você não pode usar um recurso de toohello NSG toofilter tráfego.</span><span class="sxs-lookup"><span data-stu-id="24c9d-346">If an Azure resource is not connected tooa VNet, you cannot use an NSG toofilter traffic toohello resource.</span></span>  <span data-ttu-id="24c9d-347">Leia a documentação Olá para serviços Olá você usar toodetermine se serviço Olá pode ser conectado tooa VNet.</span><span class="sxs-lookup"><span data-stu-id="24c9d-347">Read hello documentation for hello services you use toodetermine whether hello service can be connected tooa VNet.</span></span>

## <a name="sample-deployment"></a><span data-ttu-id="24c9d-348">Exemplo de implantação</span><span class="sxs-lookup"><span data-stu-id="24c9d-348">Sample deployment</span></span>
<span data-ttu-id="24c9d-349">aplicativo de hello tooillustrate de informações de saudação neste artigo, considere um cenário comum de um aplicativo de duas camadas mostrado na figura abaixo de saudação:</span><span class="sxs-lookup"><span data-stu-id="24c9d-349">tooillustrate hello application of hello information in this article, consider a common scenario of a two tier application shown in hello following picture:</span></span>

![NSGs](./media/virtual-network-nsg-overview/figure1.png)

<span data-ttu-id="24c9d-351">Conforme mostrado no diagrama hello, Olá *Web1* e *Web2* as VMs são conectado toohello *front-end* sub-rede e hello *DB1* e *DB2* as VMs são conectado toohello *back-end* sub-rede.</span><span class="sxs-lookup"><span data-stu-id="24c9d-351">As shown in hello diagram, hello *Web1* and *Web2* VMs are connected toohello *FrontEnd* subnet, and hello *DB1* and *DB2* VMs are connected toohello *BackEnd* subnet.</span></span>  <span data-ttu-id="24c9d-352">Ambas as sub-redes são parte da saudação *TestVNet* VNet.</span><span class="sxs-lookup"><span data-stu-id="24c9d-352">Both subnets are part of hello *TestVNet* VNet.</span></span> <span data-ttu-id="24c9d-353">Olá componentes de aplicativos cada executado em tooa uma VM do Azure conectado VNet.</span><span class="sxs-lookup"><span data-stu-id="24c9d-353">hello application components each run within an Azure VM connected tooa VNet.</span></span> <span data-ttu-id="24c9d-354">cenário de saudação tem Olá requisitos a seguir:</span><span class="sxs-lookup"><span data-stu-id="24c9d-354">hello scenario has hello following requirements:</span></span>

1. <span data-ttu-id="24c9d-355">Separação do tráfego entre Olá WEB e servidores de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="24c9d-355">Separation of traffic between hello WEB and DB servers.</span></span>
2. <span data-ttu-id="24c9d-356">Encaminhar o tráfego de servidores de web hello carga balanceador tooall na porta 80 regras de balanceamento de carga.</span><span class="sxs-lookup"><span data-stu-id="24c9d-356">Load balancing rules forward traffic from hello load balancer tooall web servers on port 80.</span></span>
3. <span data-ttu-id="24c9d-357">Carregar balanceador NAT regras encaminhar o tráfego entra no balanceador de carga de saudação em tooport 50001 porta 3389 no hello WEB1 VM.</span><span class="sxs-lookup"><span data-stu-id="24c9d-357">Load balancer NAT rules forward traffic coming into hello load balancer on port 50001 tooport 3389 on hello WEB1 VM.</span></span>
4. <span data-ttu-id="24c9d-358">Nenhum acesso toohello VMs front-end ou back-end de saudação da Internet, exceto os requisitos de 2 e 3.</span><span class="sxs-lookup"><span data-stu-id="24c9d-358">No access toohello front-end or back-end VMs from hello Internet, except requirements 2 and 3.</span></span>
5. <span data-ttu-id="24c9d-359">Nenhum acesso de saída da Internet dos servidores WEB ou de banco de dados de saudação.</span><span class="sxs-lookup"><span data-stu-id="24c9d-359">No outbound Internet access from hello WEB or DB servers.</span></span>
6. <span data-ttu-id="24c9d-360">Acesso de sub-rede de front-end de saudação é permitido tooport 3389 de qualquer servidor web.</span><span class="sxs-lookup"><span data-stu-id="24c9d-360">Access from hello FrontEnd subnet is allowed tooport 3389 of any web server.</span></span>
7. <span data-ttu-id="24c9d-361">Acesso de sub-rede de front-end de saudação é permitido tooport 3389 de qualquer servidor de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="24c9d-361">Access from hello FrontEnd subnet is allowed tooport 3389 of any DB server.</span></span>
8. <span data-ttu-id="24c9d-362">Acesso de sub-rede de front-end de saudação é permitido tooport 1433 de todos os servidores de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="24c9d-362">Access from hello FrontEnd subnet is allowed tooport 1433 of all DB servers.</span></span>
9. <span data-ttu-id="24c9d-363">Separação do tráfego de gerenciamento (porta 3389) e do tráfego de banco de dados (1433) nas diferentes NICs de servidores DB.</span><span class="sxs-lookup"><span data-stu-id="24c9d-363">Separation of management traffic (port 3389) and database traffic (1433) on different NICs in DB servers.</span></span>

<span data-ttu-id="24c9d-364">Requisitos de 1 a 6 (exceto requisitos 3 e 4) são todos os espaços de toosubnet restrita.</span><span class="sxs-lookup"><span data-stu-id="24c9d-364">Requirements 1-6 (except requirements 3 and 4) are all confined toosubnet spaces.</span></span> <span data-ttu-id="24c9d-365">Olá NSGs seguintes requisitos Olá anterior, minimizando o número de saudação de NSGs necessário:</span><span class="sxs-lookup"><span data-stu-id="24c9d-365">hello following NSGs meet hello previous requirements, while minimizing hello number of NSGs required:</span></span>

### <a name="frontend"></a><span data-ttu-id="24c9d-366">FrontEnd</span><span class="sxs-lookup"><span data-stu-id="24c9d-366">FrontEnd</span></span>
<span data-ttu-id="24c9d-367">**Regras de entrada**</span><span class="sxs-lookup"><span data-stu-id="24c9d-367">**Inbound rules**</span></span>

| <span data-ttu-id="24c9d-368">Regra</span><span class="sxs-lookup"><span data-stu-id="24c9d-368">Rule</span></span> | <span data-ttu-id="24c9d-369">Access</span><span class="sxs-lookup"><span data-stu-id="24c9d-369">Access</span></span> | <span data-ttu-id="24c9d-370">Prioridade</span><span class="sxs-lookup"><span data-stu-id="24c9d-370">Priority</span></span> | <span data-ttu-id="24c9d-371">Intervalo de endereços de origem</span><span class="sxs-lookup"><span data-stu-id="24c9d-371">Source address range</span></span> | <span data-ttu-id="24c9d-372">Porta de origem</span><span class="sxs-lookup"><span data-stu-id="24c9d-372">Source port</span></span> | <span data-ttu-id="24c9d-373">Intervalo de endereços de destino</span><span class="sxs-lookup"><span data-stu-id="24c9d-373">Destination address range</span></span> | <span data-ttu-id="24c9d-374">Porta de destino</span><span class="sxs-lookup"><span data-stu-id="24c9d-374">Destination port</span></span> | <span data-ttu-id="24c9d-375">Protocolo</span><span class="sxs-lookup"><span data-stu-id="24c9d-375">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="24c9d-376">Allow-Inbound-HTTP-Internet</span><span class="sxs-lookup"><span data-stu-id="24c9d-376">Allow-Inbound-HTTP-Internet</span></span> | <span data-ttu-id="24c9d-377">PERMITIR</span><span class="sxs-lookup"><span data-stu-id="24c9d-377">Allow</span></span> | <span data-ttu-id="24c9d-378">100</span><span class="sxs-lookup"><span data-stu-id="24c9d-378">100</span></span> | <span data-ttu-id="24c9d-379">Internet</span><span class="sxs-lookup"><span data-stu-id="24c9d-379">Internet</span></span> | * | * | <span data-ttu-id="24c9d-380">80</span><span class="sxs-lookup"><span data-stu-id="24c9d-380">80</span></span> | <span data-ttu-id="24c9d-381">TCP</span><span class="sxs-lookup"><span data-stu-id="24c9d-381">TCP</span></span> |
| <span data-ttu-id="24c9d-382">Allow-Inbound-RDP-Internet</span><span class="sxs-lookup"><span data-stu-id="24c9d-382">Allow-Inbound-RDP-Internet</span></span> | <span data-ttu-id="24c9d-383">PERMITIR</span><span class="sxs-lookup"><span data-stu-id="24c9d-383">Allow</span></span> | <span data-ttu-id="24c9d-384">200</span><span class="sxs-lookup"><span data-stu-id="24c9d-384">200</span></span> | <span data-ttu-id="24c9d-385">Internet</span><span class="sxs-lookup"><span data-stu-id="24c9d-385">Internet</span></span> | * | * | <span data-ttu-id="24c9d-386">3389</span><span class="sxs-lookup"><span data-stu-id="24c9d-386">3389</span></span> | <span data-ttu-id="24c9d-387">TCP</span><span class="sxs-lookup"><span data-stu-id="24c9d-387">TCP</span></span> |
| <span data-ttu-id="24c9d-388">Deny-Inbound-All</span><span class="sxs-lookup"><span data-stu-id="24c9d-388">Deny-Inbound-All</span></span> | <span data-ttu-id="24c9d-389">NEGAR</span><span class="sxs-lookup"><span data-stu-id="24c9d-389">Deny</span></span> | <span data-ttu-id="24c9d-390">300</span><span class="sxs-lookup"><span data-stu-id="24c9d-390">300</span></span> | <span data-ttu-id="24c9d-391">Internet</span><span class="sxs-lookup"><span data-stu-id="24c9d-391">Internet</span></span> | * | * | * | <span data-ttu-id="24c9d-392">TCP</span><span class="sxs-lookup"><span data-stu-id="24c9d-392">TCP</span></span> |

<span data-ttu-id="24c9d-393">**Regras de saída**</span><span class="sxs-lookup"><span data-stu-id="24c9d-393">**Outbound rules**</span></span>

| <span data-ttu-id="24c9d-394">Regra</span><span class="sxs-lookup"><span data-stu-id="24c9d-394">Rule</span></span> | <span data-ttu-id="24c9d-395">Access</span><span class="sxs-lookup"><span data-stu-id="24c9d-395">Access</span></span> | <span data-ttu-id="24c9d-396">Prioridade</span><span class="sxs-lookup"><span data-stu-id="24c9d-396">Priority</span></span> | <span data-ttu-id="24c9d-397">Intervalo de endereços de origem</span><span class="sxs-lookup"><span data-stu-id="24c9d-397">Source address range</span></span> | <span data-ttu-id="24c9d-398">Porta de origem</span><span class="sxs-lookup"><span data-stu-id="24c9d-398">Source port</span></span> | <span data-ttu-id="24c9d-399">Intervalo de endereços de destino</span><span class="sxs-lookup"><span data-stu-id="24c9d-399">Destination address range</span></span> | <span data-ttu-id="24c9d-400">Porta de destino</span><span class="sxs-lookup"><span data-stu-id="24c9d-400">Destination port</span></span> | <span data-ttu-id="24c9d-401">Protocolo</span><span class="sxs-lookup"><span data-stu-id="24c9d-401">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="24c9d-402">Deny-Internet-All</span><span class="sxs-lookup"><span data-stu-id="24c9d-402">Deny-Internet-All</span></span> |<span data-ttu-id="24c9d-403">NEGAR</span><span class="sxs-lookup"><span data-stu-id="24c9d-403">Deny</span></span> |<span data-ttu-id="24c9d-404">100</span><span class="sxs-lookup"><span data-stu-id="24c9d-404">100</span></span> | * | * | <span data-ttu-id="24c9d-405">Internet</span><span class="sxs-lookup"><span data-stu-id="24c9d-405">Internet</span></span> | * | * |

### <a name="backend"></a><span data-ttu-id="24c9d-406">BackEnd</span><span class="sxs-lookup"><span data-stu-id="24c9d-406">BackEnd</span></span>
<span data-ttu-id="24c9d-407">**Regras de entrada**</span><span class="sxs-lookup"><span data-stu-id="24c9d-407">**Inbound rules**</span></span>

| <span data-ttu-id="24c9d-408">Regra</span><span class="sxs-lookup"><span data-stu-id="24c9d-408">Rule</span></span> | <span data-ttu-id="24c9d-409">Access</span><span class="sxs-lookup"><span data-stu-id="24c9d-409">Access</span></span> | <span data-ttu-id="24c9d-410">Prioridade</span><span class="sxs-lookup"><span data-stu-id="24c9d-410">Priority</span></span> | <span data-ttu-id="24c9d-411">Intervalo de endereços de origem</span><span class="sxs-lookup"><span data-stu-id="24c9d-411">Source address range</span></span> | <span data-ttu-id="24c9d-412">Porta de origem</span><span class="sxs-lookup"><span data-stu-id="24c9d-412">Source port</span></span> | <span data-ttu-id="24c9d-413">Intervalo de endereços de destino</span><span class="sxs-lookup"><span data-stu-id="24c9d-413">Destination address range</span></span> | <span data-ttu-id="24c9d-414">Porta de destino</span><span class="sxs-lookup"><span data-stu-id="24c9d-414">Destination port</span></span> | <span data-ttu-id="24c9d-415">Protocolo</span><span class="sxs-lookup"><span data-stu-id="24c9d-415">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="24c9d-416">Deny-Internet-All</span><span class="sxs-lookup"><span data-stu-id="24c9d-416">Deny-Internet-All</span></span> | <span data-ttu-id="24c9d-417">NEGAR</span><span class="sxs-lookup"><span data-stu-id="24c9d-417">Deny</span></span> | <span data-ttu-id="24c9d-418">100</span><span class="sxs-lookup"><span data-stu-id="24c9d-418">100</span></span> | <span data-ttu-id="24c9d-419">Internet</span><span class="sxs-lookup"><span data-stu-id="24c9d-419">Internet</span></span> | * | * | * | * |

<span data-ttu-id="24c9d-420">**Regras de saída**</span><span class="sxs-lookup"><span data-stu-id="24c9d-420">**Outbound rules**</span></span>

| <span data-ttu-id="24c9d-421">Regra</span><span class="sxs-lookup"><span data-stu-id="24c9d-421">Rule</span></span> | <span data-ttu-id="24c9d-422">Access</span><span class="sxs-lookup"><span data-stu-id="24c9d-422">Access</span></span> | <span data-ttu-id="24c9d-423">Prioridade</span><span class="sxs-lookup"><span data-stu-id="24c9d-423">Priority</span></span> | <span data-ttu-id="24c9d-424">Intervalo de endereços de origem</span><span class="sxs-lookup"><span data-stu-id="24c9d-424">Source address range</span></span> | <span data-ttu-id="24c9d-425">Porta de origem</span><span class="sxs-lookup"><span data-stu-id="24c9d-425">Source port</span></span> | <span data-ttu-id="24c9d-426">Intervalo de endereços de destino</span><span class="sxs-lookup"><span data-stu-id="24c9d-426">Destination address range</span></span> | <span data-ttu-id="24c9d-427">Porta de destino</span><span class="sxs-lookup"><span data-stu-id="24c9d-427">Destination port</span></span> | <span data-ttu-id="24c9d-428">Protocolo</span><span class="sxs-lookup"><span data-stu-id="24c9d-428">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="24c9d-429">Deny-Internet-All</span><span class="sxs-lookup"><span data-stu-id="24c9d-429">Deny-Internet-All</span></span> | <span data-ttu-id="24c9d-430">NEGAR</span><span class="sxs-lookup"><span data-stu-id="24c9d-430">Deny</span></span> | <span data-ttu-id="24c9d-431">100</span><span class="sxs-lookup"><span data-stu-id="24c9d-431">100</span></span> | * | * | <span data-ttu-id="24c9d-432">Internet</span><span class="sxs-lookup"><span data-stu-id="24c9d-432">Internet</span></span> | * | * |

<span data-ttu-id="24c9d-433">Olá NSGs seguintes são criados e associadas tooNICs em Olá máquinas virtuais a seguir:</span><span class="sxs-lookup"><span data-stu-id="24c9d-433">hello following NSGs are created and associated tooNICs in hello following VMs:</span></span>

### <a name="web1"></a><span data-ttu-id="24c9d-434">WEB1</span><span class="sxs-lookup"><span data-stu-id="24c9d-434">WEB1</span></span>
<span data-ttu-id="24c9d-435">**Regras de entrada**</span><span class="sxs-lookup"><span data-stu-id="24c9d-435">**Inbound rules**</span></span>

| <span data-ttu-id="24c9d-436">Regra</span><span class="sxs-lookup"><span data-stu-id="24c9d-436">Rule</span></span> | <span data-ttu-id="24c9d-437">Access</span><span class="sxs-lookup"><span data-stu-id="24c9d-437">Access</span></span> | <span data-ttu-id="24c9d-438">Prioridade</span><span class="sxs-lookup"><span data-stu-id="24c9d-438">Priority</span></span> | <span data-ttu-id="24c9d-439">Intervalo de endereços de origem</span><span class="sxs-lookup"><span data-stu-id="24c9d-439">Source address range</span></span> | <span data-ttu-id="24c9d-440">Porta de origem</span><span class="sxs-lookup"><span data-stu-id="24c9d-440">Source port</span></span> | <span data-ttu-id="24c9d-441">Intervalo de endereços de destino</span><span class="sxs-lookup"><span data-stu-id="24c9d-441">Destination address range</span></span> | <span data-ttu-id="24c9d-442">Porta de destino</span><span class="sxs-lookup"><span data-stu-id="24c9d-442">Destination port</span></span> | <span data-ttu-id="24c9d-443">Protocolo</span><span class="sxs-lookup"><span data-stu-id="24c9d-443">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="24c9d-444">Allow-Inbound-RDP-Internet</span><span class="sxs-lookup"><span data-stu-id="24c9d-444">Allow-Inbound-RDP-Internet</span></span> | <span data-ttu-id="24c9d-445">PERMITIR</span><span class="sxs-lookup"><span data-stu-id="24c9d-445">Allow</span></span> | <span data-ttu-id="24c9d-446">100</span><span class="sxs-lookup"><span data-stu-id="24c9d-446">100</span></span> | <span data-ttu-id="24c9d-447">Internet</span><span class="sxs-lookup"><span data-stu-id="24c9d-447">Internet</span></span> | * | * | <span data-ttu-id="24c9d-448">3389</span><span class="sxs-lookup"><span data-stu-id="24c9d-448">3389</span></span> | <span data-ttu-id="24c9d-449">TCP</span><span class="sxs-lookup"><span data-stu-id="24c9d-449">TCP</span></span> |
| <span data-ttu-id="24c9d-450">Allow-Inbound-HTTP-Internet</span><span class="sxs-lookup"><span data-stu-id="24c9d-450">Allow-Inbound-HTTP-Internet</span></span> | <span data-ttu-id="24c9d-451">PERMITIR</span><span class="sxs-lookup"><span data-stu-id="24c9d-451">Allow</span></span> | <span data-ttu-id="24c9d-452">200</span><span class="sxs-lookup"><span data-stu-id="24c9d-452">200</span></span> | <span data-ttu-id="24c9d-453">Internet</span><span class="sxs-lookup"><span data-stu-id="24c9d-453">Internet</span></span> | * | * | <span data-ttu-id="24c9d-454">80</span><span class="sxs-lookup"><span data-stu-id="24c9d-454">80</span></span> | <span data-ttu-id="24c9d-455">TCP</span><span class="sxs-lookup"><span data-stu-id="24c9d-455">TCP</span></span> |

> [!NOTE]
> <span data-ttu-id="24c9d-456">intervalo de endereço de origem Olá para regras anteriores Olá é **Internet**, Olá não o endereço IP virtual da saudação balanceador de carga.</span><span class="sxs-lookup"><span data-stu-id="24c9d-456">hello source address range for hello previous rules is **Internet**, not hello virtual IP address of for hello load balancer.</span></span> <span data-ttu-id="24c9d-457">porta de origem Olá é *, não 500001.</span><span class="sxs-lookup"><span data-stu-id="24c9d-457">hello source port is *, not 500001.</span></span> <span data-ttu-id="24c9d-458">Regras NAT para balanceadores de carga não são Olá mesmo que as regras de segurança do NSG.</span><span class="sxs-lookup"><span data-stu-id="24c9d-458">NAT rules for load balancers are not hello same as NSG security rules.</span></span> <span data-ttu-id="24c9d-459">Regras de segurança do NSG são sempre toohello relacionados de origem e destino final de tráfego, **não** balanceador de carga de saudação entre hello dois.</span><span class="sxs-lookup"><span data-stu-id="24c9d-459">NSG security rules are always related toohello original source and final destination of traffic, **not** hello load balancer between hello two.</span></span> 
> 
> 

### <a name="web2"></a><span data-ttu-id="24c9d-460">WEB2</span><span class="sxs-lookup"><span data-stu-id="24c9d-460">WEB2</span></span>
<span data-ttu-id="24c9d-461">**Regras de entrada**</span><span class="sxs-lookup"><span data-stu-id="24c9d-461">**Inbound rules**</span></span>

| <span data-ttu-id="24c9d-462">Regra</span><span class="sxs-lookup"><span data-stu-id="24c9d-462">Rule</span></span> | <span data-ttu-id="24c9d-463">Access</span><span class="sxs-lookup"><span data-stu-id="24c9d-463">Access</span></span> | <span data-ttu-id="24c9d-464">Prioridade</span><span class="sxs-lookup"><span data-stu-id="24c9d-464">Priority</span></span> | <span data-ttu-id="24c9d-465">Intervalo de endereços de origem</span><span class="sxs-lookup"><span data-stu-id="24c9d-465">Source address range</span></span> | <span data-ttu-id="24c9d-466">Porta de origem</span><span class="sxs-lookup"><span data-stu-id="24c9d-466">Source port</span></span> | <span data-ttu-id="24c9d-467">Intervalo de endereços de destino</span><span class="sxs-lookup"><span data-stu-id="24c9d-467">Destination address range</span></span> | <span data-ttu-id="24c9d-468">Porta de destino</span><span class="sxs-lookup"><span data-stu-id="24c9d-468">Destination port</span></span> | <span data-ttu-id="24c9d-469">Protocolo</span><span class="sxs-lookup"><span data-stu-id="24c9d-469">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="24c9d-470">Deny-Inbound-RDP-Internet</span><span class="sxs-lookup"><span data-stu-id="24c9d-470">Deny-Inbound-RDP-Internet</span></span> | <span data-ttu-id="24c9d-471">NEGAR</span><span class="sxs-lookup"><span data-stu-id="24c9d-471">Deny</span></span> | <span data-ttu-id="24c9d-472">100</span><span class="sxs-lookup"><span data-stu-id="24c9d-472">100</span></span> | <span data-ttu-id="24c9d-473">Internet</span><span class="sxs-lookup"><span data-stu-id="24c9d-473">Internet</span></span> | * | * | <span data-ttu-id="24c9d-474">3389</span><span class="sxs-lookup"><span data-stu-id="24c9d-474">3389</span></span> | <span data-ttu-id="24c9d-475">TCP</span><span class="sxs-lookup"><span data-stu-id="24c9d-475">TCP</span></span> |
| <span data-ttu-id="24c9d-476">Allow-Inbound-HTTP-Internet</span><span class="sxs-lookup"><span data-stu-id="24c9d-476">Allow-Inbound-HTTP-Internet</span></span> | <span data-ttu-id="24c9d-477">PERMITIR</span><span class="sxs-lookup"><span data-stu-id="24c9d-477">Allow</span></span> | <span data-ttu-id="24c9d-478">200</span><span class="sxs-lookup"><span data-stu-id="24c9d-478">200</span></span> | <span data-ttu-id="24c9d-479">Internet</span><span class="sxs-lookup"><span data-stu-id="24c9d-479">Internet</span></span> | * | * | <span data-ttu-id="24c9d-480">80</span><span class="sxs-lookup"><span data-stu-id="24c9d-480">80</span></span> | <span data-ttu-id="24c9d-481">TCP</span><span class="sxs-lookup"><span data-stu-id="24c9d-481">TCP</span></span> |

### <a name="db-servers-management-nic"></a><span data-ttu-id="24c9d-482">Servidores DB (NIC de gerenciamento)</span><span class="sxs-lookup"><span data-stu-id="24c9d-482">DB servers (Management NIC)</span></span>
<span data-ttu-id="24c9d-483">**Regras de entrada**</span><span class="sxs-lookup"><span data-stu-id="24c9d-483">**Inbound rules**</span></span>

| <span data-ttu-id="24c9d-484">Regra</span><span class="sxs-lookup"><span data-stu-id="24c9d-484">Rule</span></span> | <span data-ttu-id="24c9d-485">Access</span><span class="sxs-lookup"><span data-stu-id="24c9d-485">Access</span></span> | <span data-ttu-id="24c9d-486">Prioridade</span><span class="sxs-lookup"><span data-stu-id="24c9d-486">Priority</span></span> | <span data-ttu-id="24c9d-487">Intervalo de endereços de origem</span><span class="sxs-lookup"><span data-stu-id="24c9d-487">Source address range</span></span> | <span data-ttu-id="24c9d-488">Porta de origem</span><span class="sxs-lookup"><span data-stu-id="24c9d-488">Source port</span></span> | <span data-ttu-id="24c9d-489">Intervalo de endereços de destino</span><span class="sxs-lookup"><span data-stu-id="24c9d-489">Destination address range</span></span> | <span data-ttu-id="24c9d-490">Porta de destino</span><span class="sxs-lookup"><span data-stu-id="24c9d-490">Destination port</span></span> | <span data-ttu-id="24c9d-491">Protocolo</span><span class="sxs-lookup"><span data-stu-id="24c9d-491">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="24c9d-492">Allow-Inbound-RDP-Front-end</span><span class="sxs-lookup"><span data-stu-id="24c9d-492">Allow-Inbound-RDP-Front-end</span></span> | <span data-ttu-id="24c9d-493">PERMITIR</span><span class="sxs-lookup"><span data-stu-id="24c9d-493">Allow</span></span> | <span data-ttu-id="24c9d-494">100</span><span class="sxs-lookup"><span data-stu-id="24c9d-494">100</span></span> | <span data-ttu-id="24c9d-495">192.168.1.0/24</span><span class="sxs-lookup"><span data-stu-id="24c9d-495">192.168.1.0/24</span></span> | * | * | <span data-ttu-id="24c9d-496">3389</span><span class="sxs-lookup"><span data-stu-id="24c9d-496">3389</span></span> | <span data-ttu-id="24c9d-497">TCP</span><span class="sxs-lookup"><span data-stu-id="24c9d-497">TCP</span></span> |

### <a name="db-servers-database-traffic-nic"></a><span data-ttu-id="24c9d-498">Servidores DB (tráfego NIC do banco de dados)</span><span class="sxs-lookup"><span data-stu-id="24c9d-498">DB servers (Database traffic NIC)</span></span>
<span data-ttu-id="24c9d-499">**Regras de entrada**</span><span class="sxs-lookup"><span data-stu-id="24c9d-499">**Inbound rules**</span></span>

| <span data-ttu-id="24c9d-500">Regra</span><span class="sxs-lookup"><span data-stu-id="24c9d-500">Rule</span></span> | <span data-ttu-id="24c9d-501">Access</span><span class="sxs-lookup"><span data-stu-id="24c9d-501">Access</span></span> | <span data-ttu-id="24c9d-502">Prioridade</span><span class="sxs-lookup"><span data-stu-id="24c9d-502">Priority</span></span> | <span data-ttu-id="24c9d-503">Intervalo de endereços de origem</span><span class="sxs-lookup"><span data-stu-id="24c9d-503">Source address range</span></span> | <span data-ttu-id="24c9d-504">Porta de origem</span><span class="sxs-lookup"><span data-stu-id="24c9d-504">Source port</span></span> | <span data-ttu-id="24c9d-505">Intervalo de endereços de destino</span><span class="sxs-lookup"><span data-stu-id="24c9d-505">Destination address range</span></span> | <span data-ttu-id="24c9d-506">Porta de destino</span><span class="sxs-lookup"><span data-stu-id="24c9d-506">Destination port</span></span> | <span data-ttu-id="24c9d-507">Protocolo</span><span class="sxs-lookup"><span data-stu-id="24c9d-507">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="24c9d-508">Allow-Inbound-SQL-Front-end</span><span class="sxs-lookup"><span data-stu-id="24c9d-508">Allow-Inbound-SQL-Front-end</span></span> | <span data-ttu-id="24c9d-509">PERMITIR</span><span class="sxs-lookup"><span data-stu-id="24c9d-509">Allow</span></span> | <span data-ttu-id="24c9d-510">100</span><span class="sxs-lookup"><span data-stu-id="24c9d-510">100</span></span> | <span data-ttu-id="24c9d-511">192.168.1.0/24</span><span class="sxs-lookup"><span data-stu-id="24c9d-511">192.168.1.0/24</span></span> | * | * | <span data-ttu-id="24c9d-512">1433</span><span class="sxs-lookup"><span data-stu-id="24c9d-512">1433</span></span> | <span data-ttu-id="24c9d-513">TCP</span><span class="sxs-lookup"><span data-stu-id="24c9d-513">TCP</span></span> |

<span data-ttu-id="24c9d-514">Como algumas Olá NSGs são associado tooindividual NICs, regras de saudação são para os recursos implantados por meio do Gerenciador de recursos.</span><span class="sxs-lookup"><span data-stu-id="24c9d-514">Since some of hello NSGs are associated tooindividual NICs, hello rules are for resources deployed through Resource Manager.</span></span> <span data-ttu-id="24c9d-515">As regras são combinadas para sub-rede e NIC, dependendo de como estão associados.</span><span class="sxs-lookup"><span data-stu-id="24c9d-515">Rules are combined for subnet and NIC, depending on how they are associated.</span></span> 

## <a name="next-steps"></a><span data-ttu-id="24c9d-516">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="24c9d-516">Next steps</span></span>
* <span data-ttu-id="24c9d-517">[Implantar NSGs (Gerenciador de Recursos)](virtual-networks-create-nsg-arm-pportal.md).</span><span class="sxs-lookup"><span data-stu-id="24c9d-517">[Deploy NSGs (Resource Manager)](virtual-networks-create-nsg-arm-pportal.md).</span></span>
* <span data-ttu-id="24c9d-518">[Implantar NSGs (clássico)](virtual-networks-create-nsg-classic-ps.md).</span><span class="sxs-lookup"><span data-stu-id="24c9d-518">[Deploy NSGs (classic)](virtual-networks-create-nsg-classic-ps.md).</span></span>
* <span data-ttu-id="24c9d-519">[Gerenciar logs do NSG](virtual-network-nsg-manage-log.md).</span><span class="sxs-lookup"><span data-stu-id="24c9d-519">[Manage NSG logs](virtual-network-nsg-manage-log.md).</span></span>
* <span data-ttu-id="24c9d-520">[Solucionar problemas de NSGs] (virtual-network-nsg-troubleshoot-portal.md)</span><span class="sxs-lookup"><span data-stu-id="24c9d-520">[Troubleshoot NSGs] (virtual-network-nsg-troubleshoot-portal.md)</span></span>
