---
title: "aaaError tratamento em runbooks gráficos de automação do Azure | Microsoft Docs"
description: "Este artigo descreve como lógica em runbooks de automação do Azure gráficas de tratamento de erro de tooimplement."
services: automation
documentationcenter: 
author: mgoedtel
manager: jwhit
editor: tysonn
ms.assetid: 
ms.service: automation
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 12/26/2016
ms.author: magoedte
ms.openlocfilehash: b9ff01361d2ebd9c0174b074a7a290b1cc2fd1c8
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="error-handling-in-azure-automation-graphical-runbooks"></a><span data-ttu-id="10044-103">Tratamento de erros em runbooks gráficos na Automação do Azure</span><span class="sxs-lookup"><span data-stu-id="10044-103">Error handling in Azure Automation graphical runbooks</span></span>

<span data-ttu-id="10044-104">Um tooconsider principal de design do runbook chave é identificar problemas diferentes que pode ter um runbook.</span><span class="sxs-lookup"><span data-stu-id="10044-104">A key runbook design principal tooconsider is identifying different issues that a runbook might experience.</span></span> <span data-ttu-id="10044-105">Esses problemas podem incluir sucesso, estados de erro esperado e as condições de erro inesperado.</span><span class="sxs-lookup"><span data-stu-id="10044-105">These issues can include success, expected error states, and unexpected error conditions.</span></span>

<span data-ttu-id="10044-106">Runbooks deve incluir o tratamento de erros.</span><span class="sxs-lookup"><span data-stu-id="10044-106">Runbooks should include error handling.</span></span> <span data-ttu-id="10044-107">toovalidate Olá a saída de uma atividade ou manipular um erro com runbooks gráficos, use uma atividade de código do Windows PowerShell, defina a lógica condicional no link de saída de saudação da atividade de saudação ou aplicar outro método.</span><span class="sxs-lookup"><span data-stu-id="10044-107">toovalidate hello output of an activity or handle an error with graphical runbooks, you could use a Windows PowerShell code activity, define conditional logic on hello output link of hello activity, or apply another method.</span></span>          

<span data-ttu-id="10044-108">Geralmente, se houver um erro não fatal que ocorre com uma atividade de runbook, qualquer atividade que segue é processada, independentemente de erro de saudação.</span><span class="sxs-lookup"><span data-stu-id="10044-108">Often, if there is a non-terminating error that occurs with a runbook activity, any activity that follows is processed regardless of hello error.</span></span> <span data-ttu-id="10044-109">Erro de saudação é provavelmente toogenerate uma exceção, mas próxima atividade de saudação ainda é permitida toorun.</span><span class="sxs-lookup"><span data-stu-id="10044-109">hello error is likely toogenerate an exception, but hello next activity is still allowed toorun.</span></span> <span data-ttu-id="10044-110">Essa é maneira Olá PowerShell é projetado toohandle erros.</span><span class="sxs-lookup"><span data-stu-id="10044-110">This is hello way that PowerShell is designed toohandle errors.</span></span>    

<span data-ttu-id="10044-111">tipos de saudação do PowerShell erros que podem ocorrer durante a execução são finalizando ou não fatal.</span><span class="sxs-lookup"><span data-stu-id="10044-111">hello types of PowerShell errors that can occur during execution are terminating or non-terminating.</span></span> <span data-ttu-id="10044-112">diferenças de Olá entre os erros de finalização e finalização não são da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="10044-112">hello differences between terminating and non-terminating errors are as follows:</span></span>

* <span data-ttu-id="10044-113">**Erro fatal**: um erro grave durante a execução é interrompida comando hello (ou a execução do script) completamente.</span><span class="sxs-lookup"><span data-stu-id="10044-113">**Terminating error**: A serious error during execution that halts hello command (or script execution) completely.</span></span> <span data-ttu-id="10044-114">Os exemplos incluem cmdlets inexistentes, erros de sintaxe que impedem a execução de um cmdlet ou outros erros fatais.</span><span class="sxs-lookup"><span data-stu-id="10044-114">Examples include non-existent cmdlets, syntax errors that prevent a cmdlet from running, or other fatal errors.</span></span>

* <span data-ttu-id="10044-115">**Erro não fatal**: um erro não grave que permite a execução toocontinue apesar da falha de saudação.</span><span class="sxs-lookup"><span data-stu-id="10044-115">**Non-terminating error**: A non-serious error that allows execution toocontinue despite hello failure.</span></span> <span data-ttu-id="10044-116">Os exemplos incluem erros operacionais como erros de arquivo não encontrado e problemas de permissões.</span><span class="sxs-lookup"><span data-stu-id="10044-116">Examples include operational errors such as file not found errors and permissions problems.</span></span>

<span data-ttu-id="10044-117">Runbooks gráficos foram aprimorados com tratamento de erros de tooinclude Olá recurso de automação do Azure.</span><span class="sxs-lookup"><span data-stu-id="10044-117">Azure Automation graphical runbooks have been improved with hello capability tooinclude error handling.</span></span> <span data-ttu-id="10044-118">Agora você pode ativar exceções em erros de não finalização e criar links de erro entre atividades.</span><span class="sxs-lookup"><span data-stu-id="10044-118">You can now turn exceptions into non-terminating errors and create error links between activities.</span></span> <span data-ttu-id="10044-119">Esse processo permite que um autor de runbook toocatch erros e gerencie as condições realizadas ou inesperadas.</span><span class="sxs-lookup"><span data-stu-id="10044-119">This process allows a runbook author toocatch errors and manage realized or unexpected conditions.</span></span>  

## <a name="when-toouse-error-handling"></a><span data-ttu-id="10044-120">Quando o tratamento de erros toouse</span><span class="sxs-lookup"><span data-stu-id="10044-120">When toouse error handling</span></span>

<span data-ttu-id="10044-121">Sempre que houver uma atividade crítica que gera um erro ou exceção, é importante tooprevent Olá próxima atividade no runbook de erro de saudação do processamento e toohandle adequadamente.</span><span class="sxs-lookup"><span data-stu-id="10044-121">Whenever there is a critical activity that throws an error or exception, it's important tooprevent hello next activity in your runbook from processing and toohandle hello error appropriately.</span></span> <span data-ttu-id="10044-122">Isso é particularmente crítico quando seus runbooks dão suporte a uma empresa ou a um processo de operações de serviço.</span><span class="sxs-lookup"><span data-stu-id="10044-122">This is especially critical when your runbooks are supporting a business or service operations process.</span></span>

<span data-ttu-id="10044-123">Para cada atividade que pode gerar um erro, o autor de runbook Olá pode adicionar um link de erro apontando tooany outra atividade.</span><span class="sxs-lookup"><span data-stu-id="10044-123">For each activity that can produce an error, hello runbook author can add an error link pointing tooany other activity.</span></span>  <span data-ttu-id="10044-124">atividade de destino Olá pode ser de qualquer tipo, incluindo atividades de código, chamar um cmdlet, chamar outro runbook e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="10044-124">hello destination activity can be of any type, including code activities, invoking a cmdlet, invoking another runbook, and so on.</span></span>

<span data-ttu-id="10044-125">Além disso, a atividade de destino Olá também pode ter links de saída.</span><span class="sxs-lookup"><span data-stu-id="10044-125">In addition, hello destination activity can also have outgoing links.</span></span> <span data-ttu-id="10044-126">Esses links são links regulares ou erro.</span><span class="sxs-lookup"><span data-stu-id="10044-126">These links can be regular links or error links.</span></span> <span data-ttu-id="10044-127">Isso significa que o autor de runbook Olá pode implementar lógica complexa de tratamento de erros sem recorrer tooa atividade de código.</span><span class="sxs-lookup"><span data-stu-id="10044-127">This means hello runbook author can implement complex error-handling logic without resorting tooa code activity.</span></span> <span data-ttu-id="10044-128">Olá recomendado prática é toocreate um runbook dedicado de tratamento de erros com funcionalidade comum, mas não é obrigatório.</span><span class="sxs-lookup"><span data-stu-id="10044-128">hello recommended practice is toocreate a dedicated error-handling runbook with common functionality, but it's not mandatory.</span></span> <span data-ttu-id="10044-129">Lógica de tratamento de erros em uma atividade de código do PowerShell não é Olá apenas a opção.</span><span class="sxs-lookup"><span data-stu-id="10044-129">Error-handling logic in a PowerShell code activity it isn't hello only option.</span></span>  

<span data-ttu-id="10044-130">Por exemplo, considere um runbook que tenta toostart uma VM e instalar um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="10044-130">For example, consider a runbook that tries toostart a VM and install an application on it.</span></span> <span data-ttu-id="10044-131">Se hello VM não iniciar corretamente, ele executa duas ações:</span><span class="sxs-lookup"><span data-stu-id="10044-131">If hello VM doesn't start correctly, it performs two actions:</span></span>

1. <span data-ttu-id="10044-132">Ele envia uma notificação sobre esse problema.</span><span class="sxs-lookup"><span data-stu-id="10044-132">It sends a notification about this problem.</span></span>
2. <span data-ttu-id="10044-133">Ele inicia outro runbook que provisiona automaticamente uma nova VM em vez disso.</span><span class="sxs-lookup"><span data-stu-id="10044-133">It starts another runbook that automatically provisions a new VM instead.</span></span>

<span data-ttu-id="10044-134">Uma solução é toohave um link de erro apontando atividade tooan que identificadores etapa um.</span><span class="sxs-lookup"><span data-stu-id="10044-134">One solution is toohave an error link pointing tooan activity that handles step one.</span></span> <span data-ttu-id="10044-135">Por exemplo, você pode conectar Olá **Write-Warning** cmdlet tooan atividade para a etapa dois, como Olá **AzureRmAutomationRunbook início** cmdlet.</span><span class="sxs-lookup"><span data-stu-id="10044-135">For example, you could connect hello **Write-Warning** cmdlet tooan activity for step two, such as hello **Start-AzureRmAutomationRunbook** cmdlet.</span></span>

<span data-ttu-id="10044-136">Você também pode generalizar esse comportamento para uso em runbooks muitos colocando essas duas atividades em um runbook de tratamento de erro separada e a seguinte orientação Olá sugerido anteriormente.</span><span class="sxs-lookup"><span data-stu-id="10044-136">You could also generalize this behavior for use in many runbooks by putting these two activities in a separate error handling runbook and following hello guidance suggested earlier.</span></span> <span data-ttu-id="10044-137">Antes de chamar esse runbook de tratamento de erros, você pode construir uma mensagem personalizada de dados Olá no runbook original hello e passá-lo como um runbook de tratamento de erros do parâmetro toohello.</span><span class="sxs-lookup"><span data-stu-id="10044-137">Before calling this error-handling runbook, you could construct a custom message from hello data in hello original runbook, and then pass it as a parameter toohello error-handling runbook.</span></span>

## <a name="how-toouse-error-handling"></a><span data-ttu-id="10044-138">Como o tratamento de erros toouse</span><span class="sxs-lookup"><span data-stu-id="10044-138">How toouse error handling</span></span>

<span data-ttu-id="10044-139">Cada atividade tem um parâmetro de configuração que transforma exceções em erros de não finalização.</span><span class="sxs-lookup"><span data-stu-id="10044-139">Each activity has a configuration setting that turns exceptions into non-terminating errors.</span></span> <span data-ttu-id="10044-140">Por padrão, essa configuração é desabilitada.</span><span class="sxs-lookup"><span data-stu-id="10044-140">By default, this setting is disabled.</span></span> <span data-ttu-id="10044-141">É recomendável que você habilite essa configuração em qualquer atividade onde você deseja toohandle erros.</span><span class="sxs-lookup"><span data-stu-id="10044-141">We recommend that you enable this setting on any activity where you want toohandle errors.</span></span>  

<span data-ttu-id="10044-142">Ao habilitar essa configuração, você está garantindo que erros de não finalização e finalização na atividade de saudação são tratados como erros de não finalização e podem ser tratados com um link de erro.</span><span class="sxs-lookup"><span data-stu-id="10044-142">By enabling this configuration, you are assuring that both terminating and non-terminating errors in hello activity are handled as non-terminating errors, and can be handled with an error link.</span></span>  

<span data-ttu-id="10044-143">Depois de configurar essa configuração, você cria uma atividade que trata o erro hello.</span><span class="sxs-lookup"><span data-stu-id="10044-143">After configuring this setting, you create an activity that handles hello error.</span></span> <span data-ttu-id="10044-144">Se uma atividade produz um erro, Olá, em seguida, a saída de erro links são seguidos e links regulares Olá não são, mesmo se a atividade de saudação produz saída regular também.</span><span class="sxs-lookup"><span data-stu-id="10044-144">If an activity produces any error, then hello outgoing error links are followed, and hello regular links are not, even if hello activity produces regular output as well.</span></span><br><br> ![Exemplo de link de erro de runbook de automação](media/automation-runbook-graphical-error-handling/error-link-example.png)

<span data-ttu-id="10044-146">Saudação de exemplo a seguir, um runbook recupera uma variável que contém o nome do computador de saudação de uma máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="10044-146">In hello following example, a runbook retrieves a variable that contains hello computer name of a virtual machine.</span></span> <span data-ttu-id="10044-147">Ele tentará toostart Olá VM com a próxima atividade de saudação.</span><span class="sxs-lookup"><span data-stu-id="10044-147">It then attempts toostart hello virtual machine with hello next activity.</span></span><br><br> ![Exemplo de tratamento de erro de runbook de automação](media/automation-runbook-graphical-error-handling/runbook-example-error-handling.png)<br><br>      

<span data-ttu-id="10044-149">Olá **Get-AutomationVariable** atividade e **AzureRmVm início** serão configurado tooconvert tooerrors de exceções.</span><span class="sxs-lookup"><span data-stu-id="10044-149">hello **Get-AutomationVariable** activity and **Start-AzureRmVm** are configured tooconvert exceptions tooerrors.</span></span>  <span data-ttu-id="10044-150">Se houver problemas ao fazer a saudação inicial ou variável Olá VM e erros são gerados.</span><span class="sxs-lookup"><span data-stu-id="10044-150">If there are problems getting hello variable or starting hello VM, then errors are generated.</span></span><br><br> <span data-ttu-id="10044-151">![Configurações de atividade de tratamento de erros de runbook de automação](media/automation-runbook-graphical-error-handling/activity-blade-convertexception-option.png)</span><span class="sxs-lookup"><span data-stu-id="10044-151">![Automation runbook error-handling activity settings](media/automation-runbook-graphical-error-handling/activity-blade-convertexception-option.png)</span></span>

<span data-ttu-id="10044-152">Links de erro de fluxo desses tooa atividades único **gerenciamento erro** atividade (uma atividade de código).</span><span class="sxs-lookup"><span data-stu-id="10044-152">Error links flow from these activities tooa single **error management** activity (a code activity).</span></span> <span data-ttu-id="10044-153">Esta atividade é configurada com uma expressão simple do PowerShell que usa Olá *gerar* toostop de palavra-chave processamento, juntamente com *$Error.Exception.Message* tooget mensagem de saudação que descreve Olá exceção atual.</span><span class="sxs-lookup"><span data-stu-id="10044-153">This activity is configured with a simple PowerShell expression that uses hello *Throw* keyword toostop processing, along with *$Error.Exception.Message* tooget hello message that describes hello current exception.</span></span><br><br> <span data-ttu-id="10044-154">![Exemplo de código de tratamento de erros de runbook de automação](media/automation-runbook-graphical-error-handling/runbook-example-error-handling-code.png)</span><span class="sxs-lookup"><span data-stu-id="10044-154">![Automation runbook error-handling code example](media/automation-runbook-graphical-error-handling/runbook-example-error-handling-code.png)</span></span>


## <a name="next-steps"></a><span data-ttu-id="10044-155">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="10044-155">Next steps</span></span>

* <span data-ttu-id="10044-156">toolearn mais sobre links e tipos de link runbooks gráficos, consulte [criação gráfica na automação do Azure](automation-graphical-authoring-intro.md#links-and-workflow).</span><span class="sxs-lookup"><span data-stu-id="10044-156">toolearn more about links and link types in graphical runbooks, see [Graphical authoring in Azure Automation](automation-graphical-authoring-intro.md#links-and-workflow).</span></span>

* <span data-ttu-id="10044-157">toolearn mais sobre a execução do runbook, como trabalhos de runbook toomonitor e outros detalhes técnicos, consulte [acompanhar um trabalho de runbook](automation-runbook-execution.md).</span><span class="sxs-lookup"><span data-stu-id="10044-157">toolearn more about runbook execution, how toomonitor runbook jobs, and other technical details, see [Track a runbook job](automation-runbook-execution.md).</span></span>
