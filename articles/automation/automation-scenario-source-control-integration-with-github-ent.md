---
title: "Integração de controle de origem da Automação do Azure com o GitHub Enterprise | Microsoft Docs"
description: "Descreve os detalhes de como configurar a integração com o GitHub Enterprise para controle de origem de runbooks da Automação."
services: automation
documentationCenter: 
authors: mgoedtel
manager: jwhit
editor: 
ms.assetid: e01d817c-7d38-421c-adf5-647a4b526eb4
ms.service: automation
ms.workload: infrastructure-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/26/2017
ms.author: magoedte
ms.openlocfilehash: 62793dcdbbf4c83161e95d1c165d5c231245f7c6
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/03/2017
---
# <a name="azure-automation-scenario---automation-source-control-integration-with-github-enterprise"></a><span data-ttu-id="f93f9-103">Cenário da Automação do Azure - Integração de controle de origem da Automação com o GitHub Enterprise</span><span class="sxs-lookup"><span data-stu-id="f93f9-103">Azure Automation scenario - Automation source control integration with GitHub Enterprise</span></span>

<span data-ttu-id="f93f9-104">No momento, a Automação oferece suporte à integração de controle de origem, o que permite que você associe runbooks em sua conta de Automação a um repositório de controle de origem do GitHub.</span><span class="sxs-lookup"><span data-stu-id="f93f9-104">Automation currently supports source control integration, which allows you to associate runbooks in your Automation account to a GitHub source control repository.</span></span>  <span data-ttu-id="f93f9-105">No entanto, os clientes que implantaram o [GitHub Enterprise](https://enterprise.github.com/home) para dar suporte a suas práticas de DevOps também querem usá-lo para gerenciar o ciclo de vida de runbooks que são desenvolvidos para automatizar processos de negócios e operações de gerenciamento de serviço.</span><span class="sxs-lookup"><span data-stu-id="f93f9-105">However, customers who have deployed [GitHub Enterprise](https://enterprise.github.com/home) to support their DevOps practices, also want to use it to manage the lifecycle of runbooks that are developed to automate business processes and service management operations.</span></span>  

<span data-ttu-id="f93f9-106">Nesse cenário, você terá um computador com Windows em seu data center configurado como um Hybrid Runbook Worker com os módulos do Azure Resource Manager e as ferramentas Git instalados.</span><span class="sxs-lookup"><span data-stu-id="f93f9-106">In this scenario, you have a Windows computer in your data center configured as a Hybrid Runbook Worker with the Azure Resource Manager modules and Git tools installed.</span></span>  <span data-ttu-id="f93f9-107">O computador Hybrid Worker possui um clone do repositório Git local.</span><span class="sxs-lookup"><span data-stu-id="f93f9-107">The Hybrid worker machine has a clone of the local Git repository.</span></span>  <span data-ttu-id="f93f9-108">Quando o runbook for executado no Hybrid Worker, o diretório do Git será sincronizado e o conteúdo do arquivo de runbook será importado para a conta de Automação.</span><span class="sxs-lookup"><span data-stu-id="f93f9-108">When the runbook is run on the hybrid worker, the Git directory is synchronized and the runbook file contents are imported into the Automation account.</span></span>

<span data-ttu-id="f93f9-109">Este artigo descreve como definir essa configuração em seu ambiente de Automação do Azure.</span><span class="sxs-lookup"><span data-stu-id="f93f9-109">This article describes how to set up this configuration in your Azure Automation environment.</span></span> <span data-ttu-id="f93f9-110">Começaremos configurando a Automação com as credenciais de segurança, com os runbooks necessários para oferecer suporte a esse cenário e com a implantação de um Hybrid Runbook Worker em seu data center, a fim de executar runbooks e acessar seu repositório do GitHub Enterprise para sincronizar runbooks com sua conta de Automação.</span><span class="sxs-lookup"><span data-stu-id="f93f9-110">We start by configuring Automation with the security credentials, runbooks required to support this scenario, and deployment of a Hybrid Runbook Worker in your data center to run the runbooks and access your GitHub Enterprise repository to synchronize runbooks with your Automation account.</span></span>  


## <a name="getting-the-scenario"></a><span data-ttu-id="f93f9-111">Obtendo o cenário</span><span class="sxs-lookup"><span data-stu-id="f93f9-111">Getting the scenario</span></span>

<span data-ttu-id="f93f9-112">Este cenário é composto por dois runbooks do PowerShell que você pode importar diretamente da [Galeria de Runbooks](automation-runbook-gallery.md) no Portal do Azure, ou baixar da [Galeria do PowerShell](https://www.powershellgallery.com).</span><span class="sxs-lookup"><span data-stu-id="f93f9-112">This scenario consists of two PowerShell runbooks that you can import directly from the [Runbook Gallery](automation-runbook-gallery.md) in the Azure portal or download from the [PowerShell Gallery](https://www.powershellgallery.com).</span></span>

### <a name="runbooks"></a><span data-ttu-id="f93f9-113">Runbooks</span><span class="sxs-lookup"><span data-stu-id="f93f9-113">Runbooks</span></span>

<span data-ttu-id="f93f9-114">Runbook</span><span class="sxs-lookup"><span data-stu-id="f93f9-114">Runbook</span></span> | <span data-ttu-id="f93f9-115">Descrição</span><span class="sxs-lookup"><span data-stu-id="f93f9-115">Description</span></span>| 
--------|------------|
<span data-ttu-id="f93f9-116">Export-RunAsCertificateToHybridWorker</span><span class="sxs-lookup"><span data-stu-id="f93f9-116">Export-RunAsCertificateToHybridWorker</span></span> | <span data-ttu-id="f93f9-117">O Runbook exporta um certificado RunAs de uma conta de Automação para um Hybrid Worker, de modo que os runbooks no worker possam autenticar com Azure a fim de importar runbooks para a conta de Automação.</span><span class="sxs-lookup"><span data-stu-id="f93f9-117">Runbook exports a RunAs certificate from an Automation account to a hybrid worker so that runbooks on the worker can authenticate with Azure in order to import runbooks into the Automation account.</span></span>| 
<span data-ttu-id="f93f9-118">Sync-LocalGitFolderToAutomationAccount</span><span class="sxs-lookup"><span data-stu-id="f93f9-118">Sync-LocalGitFolderToAutomationAccount</span></span> | <span data-ttu-id="f93f9-119">O Runbook sincroniza a pasta Git local no computador híbrido e, em seguida, importa os arquivos de runbook (*.ps1) para a conta de Automação.</span><span class="sxs-lookup"><span data-stu-id="f93f9-119">Runbook syncs the local Git folder on the hybrid machine and then import the runbook files (*.ps1) into the Automation account.</span></span>|

### <a name="credentials"></a><span data-ttu-id="f93f9-120">Credenciais</span><span class="sxs-lookup"><span data-stu-id="f93f9-120">Credentials</span></span>

<span data-ttu-id="f93f9-121">Credencial</span><span class="sxs-lookup"><span data-stu-id="f93f9-121">Credential</span></span> | <span data-ttu-id="f93f9-122">Descrição</span><span class="sxs-lookup"><span data-stu-id="f93f9-122">Description</span></span>|
-----------|------------|
<span data-ttu-id="f93f9-123">GitHRWCredential</span><span class="sxs-lookup"><span data-stu-id="f93f9-123">GitHRWCredential</span></span> | <span data-ttu-id="f93f9-124">Ativo de credencial que você cria contendo o nome de usuário e a senha para um usuário com permissões no Hybrid Worker.</span><span class="sxs-lookup"><span data-stu-id="f93f9-124">Credential asset you create to contain the username and password for a user with permissions to the hybrid worker.</span></span>|

## <a name="installing-and-configuring-this-scenario"></a><span data-ttu-id="f93f9-125">Instalando e configurando esse cenário</span><span class="sxs-lookup"><span data-stu-id="f93f9-125">Installing and configuring this scenario</span></span>

### <a name="prerequisites"></a><span data-ttu-id="f93f9-126">Pré-requisitos</span><span class="sxs-lookup"><span data-stu-id="f93f9-126">Prerequisites</span></span>

1. <span data-ttu-id="f93f9-127">O runbook Sync-LocalGitFolderToAutomationAccount autentica usando a conta [Executar como do Azure](automation-sec-configure-azure-runas-account.md).</span><span class="sxs-lookup"><span data-stu-id="f93f9-127">The Sync-LocalGitFolderToAutomationAccount runbook authenticates using the [Azure Run As account](automation-sec-configure-azure-runas-account.md).</span></span> 

2. <span data-ttu-id="f93f9-128">Também é necessário ter um espaço de trabalho do Microsoft OMS (Operations Management Suite) com a solução de Automação do Azure habilitada e configurada.</span><span class="sxs-lookup"><span data-stu-id="f93f9-128">A Microsoft Operations Management Suite (OMS) workspace with the Azure Automation solution enabled and configured is also required.</span></span>  <span data-ttu-id="f93f9-129">Se você não tiver um associado à conta de Automação usada para instalar e configurar esse cenário, ele é criado e configurado para você durante a execução do script **New-OnPremiseHybridWorker.ps1** no Hybrid Runbook Worker.</span><span class="sxs-lookup"><span data-stu-id="f93f9-129">If you do not have one that is associated with the Automation account used to install and configure this scenario, it is created and configured for you when you execute the **New-OnPremiseHybridWorker.ps1** script from the hybrid runbook worker.</span></span>        

    > [!NOTE]
    > <span data-ttu-id="f93f9-130">Atualmente, as regiões a seguir apenas oferecem suporte para integração de automação com OMS: **Sudeste da Austrália**, **Leste dos EUA 2**, **Sudeste Asiático** e **Europa Ocidental**.</span><span class="sxs-lookup"><span data-stu-id="f93f9-130">Currently the following regions only support Automation integration with OMS - **Australia Southeast**, **East US 2**, **Southeast Asia**, and **West Europe**.</span></span> 

3. <span data-ttu-id="f93f9-131">Um computador que pode servir como um Hybrid Runbook Worker dedicado e que também hospedará o software do GitHub e manterá os arquivos de runbook (*runbook*.ps1) em um diretório de origem no sistema de arquivos para sincronização entre o GitHub e sua conta de Automação.</span><span class="sxs-lookup"><span data-stu-id="f93f9-131">A computer that can serve as a dedicated Hybrid Runbook Worker that will also host the GitHub software and maintain the runbook files (*runbook*.ps1) in a source directory on the file system to synchronize between GitHub and your Automation account.</span></span>

### <a name="import-and-publish-the-runbooks"></a><span data-ttu-id="f93f9-132">Importar e publicar os runbooks</span><span class="sxs-lookup"><span data-stu-id="f93f9-132">Import and publish the runbooks</span></span>

<span data-ttu-id="f93f9-133">Para importar os runbooks *Export-RunAsCertificateToHybridWorker* e *Sync-LocalGitFolderToAutomationAccount* da Galeria de Runbooks de sua conta de Automação no Portal do Azure, siga os procedimentos em [Importar runbook da Galeria de Runbooks](automation-runbook-gallery.md#to-import-a-runbook-from-the-runbook-gallery-with-the-azure-portal).</span><span class="sxs-lookup"><span data-stu-id="f93f9-133">To import the *Export-RunAsCertificateToHybridWorker* and *Sync-LocalGitFolderToAutomationAccount* runbooks from the Runbook Gallery from your Automation account in the Azure portal, follow the procedures in [Import Runbook from the Runbook Gallery](automation-runbook-gallery.md#to-import-a-runbook-from-the-runbook-gallery-with-the-azure-portal).</span></span> <span data-ttu-id="f93f9-134">Publique os runbooks depois que eles forem importados com êxito em sua conta de Automação.</span><span class="sxs-lookup"><span data-stu-id="f93f9-134">Publish the runbooks after they have been successfully imported into your Automation account.</span></span>

### <a name="deploy-and-configure-hybrid-runbook-worker"></a><span data-ttu-id="f93f9-135">Implantar e configurar o Hybrid Runbook Worker</span><span class="sxs-lookup"><span data-stu-id="f93f9-135">Deploy and Configure Hybrid Runbook Worker</span></span>

<span data-ttu-id="f93f9-136">Se você ainda não tiver um Hybrid Runbook Worker já implantado em seu data center, revise os requisitos e siga as etapas de instalação automatizada usando o procedimento em [Hybrid Runbook Worker da Automação do Azure - Automatizar a instalação e a configuração](automation-hybrid-runbook-worker.md#automated-deployment).</span><span class="sxs-lookup"><span data-stu-id="f93f9-136">If you do not have a Hybrid Runbook Worker already deployed in your data center, you should review the requirements and follow the automated installation steps using the procedure in [Azure Automation Hybrid Runbook Workers - Automate Install and Configuration](automation-hybrid-runbook-worker.md#automated-deployment).</span></span>  <span data-ttu-id="f93f9-137">Após a instalação bem-sucedida do Hybrid Worker em um computador, execute as etapas a seguir para concluir a configuração do suporte a esse cenário.</span><span class="sxs-lookup"><span data-stu-id="f93f9-137">Once you have successfully installed the hybrid worker on a computer, perform the following steps to complete its configuration to support this scenario.</span></span>

1. <span data-ttu-id="f93f9-138">Entre no computador que hospeda a função Hybrid Runbook Worker com uma conta que tenha direitos administrativos locais e crie um diretório para armazenar os arquivos de runbook do Git.</span><span class="sxs-lookup"><span data-stu-id="f93f9-138">Sign on to the computer hosting the Hybrid Runbook Worker role with an account that has local administrative rights and create a directory to hold the Git runbook files.</span></span>  <span data-ttu-id="f93f9-139">Clone o repositório Git interno no diretório.</span><span class="sxs-lookup"><span data-stu-id="f93f9-139">Clone  the internal Git repository to the directory.</span></span>
2. <span data-ttu-id="f93f9-140">Se você ainda não tiver uma conta de Executar como, ou se quiser criar uma nova dedicada a essa finalidade, no Portal do Azure navegue até as contas de Automação, selecione sua conta de Automação e crie um [ativo de credencial](automation-credentials.md) contendo o nome de usuário e a senha de um usuário com permissões para o Hybrid Worker.</span><span class="sxs-lookup"><span data-stu-id="f93f9-140">If you do not already have a RunAs account created or you want to create a new one dedicated for this purpose, from the Azure portal navigate to Automation accounts, select your Automation account and create a [credential asset](automation-credentials.md) that contains the username and password for a user with permissions to the hybrid worker.</span></span>  
3. <span data-ttu-id="f93f9-141">Em sua conta de Automação, [edite o runbook](automation-edit-textual-runbook.md) **Export-RunAsCertificateToHybridWorker** e modifique o valor da variável *$Password* com uma senha forte.</span><span class="sxs-lookup"><span data-stu-id="f93f9-141">From your Automation account, [edit the runbook](automation-edit-textual-runbook.md)  **Export-RunAsCertificateToHybridWorker** and modify the value for the variable *$Password* with a strong password.</span></span>  <span data-ttu-id="f93f9-142">Depois de modificar o valor, clique em **Publicar** para publicar a versão de rascunho do runbook.</span><span class="sxs-lookup"><span data-stu-id="f93f9-142">After you modify the value, click **Publish** to have the draft version of the runbook published.</span></span> 
5. <span data-ttu-id="f93f9-143">Inicie o runbook **Export-RunAsCertificateToHybridWorker** e, na folha **Iniciar Runbook**, sob a opção **Configurações de execução**, selecione a opção **Hybrid Worker** e, na lista suspensa, selecione o grupo do Hybrid Worker criado anteriormente para esse cenário.</span><span class="sxs-lookup"><span data-stu-id="f93f9-143">Start the runbook **Export-RunAsCertificateToHybridWorker**, and in the **Start Runbook** blade, under the option **Run settings** select the option **Hybrid Worker** and in the drop-down list select the Hybrid worker group you created earlier for this scenario.</span></span>  

    <span data-ttu-id="f93f9-144">Esse procedimento exporta um certificado para o Hybrid Worker para que os runbooks no worker possam autenticar com o Azure usando a conexão Executar como a fim de gerenciar recursos do Azure (particularmente para esse cenário - importar runbooks para a conta de Automação).</span><span class="sxs-lookup"><span data-stu-id="f93f9-144">This exports a certificate to the hybrid worker so that runbooks on the worker can authenticate with Azure using the Run As connection in order to manage Azure resources (in particular for this scenario - import runbooks to the Automation account).</span></span>

4. <span data-ttu-id="f93f9-145">Em sua conta de Automação, selecione o grupo do Hybrid Worker criado anteriormente e [especifique uma conta Executar como](automation-hrw-run-runbooks.md#runas-account) para o grupo de Hybrid Worker e escolha o ativo de credencial criado.</span><span class="sxs-lookup"><span data-stu-id="f93f9-145">From your Automation account, select the Hybrid worker group created earlier and [specify a RunAs account](automation-hrw-run-runbooks.md#runas-account) for the Hybrid worker group, and chose the credential asset you just or already have created.</span></span>  <span data-ttu-id="f93f9-146">Isso garante que o runbook de sincronização possa executar comandos Git.</span><span class="sxs-lookup"><span data-stu-id="f93f9-146">This assures that the Sync runbook can run Git commands.</span></span> 
5. <span data-ttu-id="f93f9-147">Inicie o runbook **Sync-LocalGitFolderToAutomationAccount**, forneça os seguintes valores de parâmetro de entrada necessários e na folha **Iniciar Runbook**, sob a opção **Configurações de execução**, selecione a opção **Hybrid Worker** e, na lista suspensa, selecione o grupo do Hybrid Worker criado anteriormente para esse cenário:</span><span class="sxs-lookup"><span data-stu-id="f93f9-147">Start the runbook **Sync-LocalGitFolderToAutomationAccount**, provide the following required input parameter values and in the **Start Runbook** blade, under the option **Run settings** select the option **Hybrid Worker** and in the drop-down list select the Hybrid worker group you created earlier for this scenario:</span></span>
    * <span data-ttu-id="f93f9-148">*ResourceGroup* ‑ o nome do grupo de recursos associado à conta de Automação</span><span class="sxs-lookup"><span data-stu-id="f93f9-148">*ResourceGroup* - the name of your resource group associated with your Automation account</span></span>
    * <span data-ttu-id="f93f9-149">*AutomationAccountName* - o nome de sua conta de Automação</span><span class="sxs-lookup"><span data-stu-id="f93f9-149">*AutomationAccountName* - the name of your Automation account</span></span>
    * <span data-ttu-id="f93f9-150">*GitPath* - a pasta ou arquivo local no Hybrid Runbook Worker no qual o Git está configurado para buscar as alterações mais recentes</span><span class="sxs-lookup"><span data-stu-id="f93f9-150">*GitPath* - The local folder or file on the Hybrid Runbook Worker where Git is set up to pull latest changes into</span></span>

    <span data-ttu-id="f93f9-151">Isso sincronizará a pasta local do Git no computador do Hybrid Worker e importará os arquivos .ps1 do diretório de origem para a conta de Automação.</span><span class="sxs-lookup"><span data-stu-id="f93f9-151">This will sync the local Git folder on the hybrid worker computer and then import the .ps1 files from the source directory to the Automation account.</span></span>

    ![Inicie Sync-LocalGitFolderToAutomationAccount Runbook](media/automation-scenario-source-control-integration-with-github-ent/start-runbook-synclocalgitfoldertoautoacct.png)<br>

7. <span data-ttu-id="f93f9-153">Exiba detalhes de resumo do trabalho para o runbook selecionando-o na folha **Runbooks** de sua conta de Automação e depois selecione o bloco **Trabalhos**.</span><span class="sxs-lookup"><span data-stu-id="f93f9-153">View job summary details for the runbook by selecting it from the **Runbooks** blade in your Automation account, and then select the **Jobs** tile.</span></span>  <span data-ttu-id="f93f9-154">Confirme a conclusão bem-sucedida selecionando o bloco **Todos os logs** e examinando o fluxo de logs detalhado.</span><span class="sxs-lookup"><span data-stu-id="f93f9-154">Confirm it completed successfully by selecting the **All logs** tile and reviewing the detailed log stream.</span></span>  

## <a name="next-steps"></a><span data-ttu-id="f93f9-155">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="f93f9-155">Next steps</span></span>

-  <span data-ttu-id="f93f9-156">Para saber mais sobre os tipos de runbook, suas vantagens e limitações, veja [Tipos de runbook da Automação do Azure](automation-runbook-types.md)</span><span class="sxs-lookup"><span data-stu-id="f93f9-156">To know more about runbook types, their advantages and limitations, see [Azure Automation runbook types](automation-runbook-types.md)</span></span>
-  <span data-ttu-id="f93f9-157">Para saber mais sobre o recurso de suporte de script do PowerShell, veja [Native PowerShell script support in Azure Automation (Suporte a scripts nativos do PowerShell na Automação do Azure)](https://azure.microsoft.com/blog/announcing-powershell-script-support-azure-automation-2/)</span><span class="sxs-lookup"><span data-stu-id="f93f9-157">For more information on PowerShell script support feature, see [Native PowerShell script support in Azure Automation](https://azure.microsoft.com/blog/announcing-powershell-script-support-azure-automation-2/)</span></span>
