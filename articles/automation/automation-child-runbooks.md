---
title: "aaaChild runbooks na automação do Azure | Microsoft Docs"
description: "Descreve métodos diferentes de saudação para iniciando um runbook na automação do Azure a partir de outro runbook e compartilhar informações entre eles."
services: automation
documentationcenter: 
author: mgoedtel
manager: jwhit
editor: tysonn
ms.assetid: 919887b9-43e2-4c16-883c-f81807fe37db
ms.service: automation
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 02/02/2017
ms.author: magoedte;bwren
ms.openlocfilehash: d3d06818d344b565d53cc4f4705b41dcfcf9a376
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="child-runbooks-in-azure-automation"></a><span data-ttu-id="41d57-103">Runbooks filhos na Automação do Azure</span><span class="sxs-lookup"><span data-stu-id="41d57-103">Child runbooks in Azure Automation</span></span>
<span data-ttu-id="41d57-104">É uma prática recomendada no Azure toowrite reutilizáveis e modulares, os runbooks de automação com uma função discreta que pode ser usado por outros runbooks.</span><span class="sxs-lookup"><span data-stu-id="41d57-104">It is a best practice in Azure Automation toowrite reusable, modular runbooks with a discrete function that can be used by other runbooks.</span></span> <span data-ttu-id="41d57-105">Um runbook pai geralmente chamará um ou mais runbooks filho funcionalidade tooperform necessário.</span><span class="sxs-lookup"><span data-stu-id="41d57-105">A parent runbook will often call one or more child runbooks tooperform required functionality.</span></span> <span data-ttu-id="41d57-106">Há dois toocall de maneiras um runbook filho e cada uma tem diferenças marcantes que você deve compreender para que você possa determinar qual será a melhor para seus diferentes cenários.</span><span class="sxs-lookup"><span data-stu-id="41d57-106">There are two ways toocall a child runbook, and each has distinct differences that you should understand so that you can determine which will be best for your different scenarios.</span></span>

## <a name="invoking-a-child-runbook-using-inline-execution"></a><span data-ttu-id="41d57-107">Invocar um runbook filho usando a execução embutida</span><span class="sxs-lookup"><span data-stu-id="41d57-107">Invoking a child runbook using inline execution</span></span>
<span data-ttu-id="41d57-108">tooinvoke um runbook embutido de outro runbook, use nome Olá Olá runbook e forneça valores para os parâmetros exatamente como você usaria uma atividade ou cmdlet.</span><span class="sxs-lookup"><span data-stu-id="41d57-108">tooinvoke a runbook inline from another runbook, you use hello name of hello runbook and provide values for its parameters exactly like you would use an activity or cmdlet.</span></span>  <span data-ttu-id="41d57-109">Olá a todos os runbooks na mesma conta de automação está disponível tooall outros toobe usados dessa maneira.</span><span class="sxs-lookup"><span data-stu-id="41d57-109">All runbooks in hello same Automation account are available tooall others toobe used in this manner.</span></span> <span data-ttu-id="41d57-110">Olá o runbook pai aguardará Olá filho runbook toocomplete antes de mover toohello próxima linha e nenhuma saída é retornada diretamente toohello pai.</span><span class="sxs-lookup"><span data-stu-id="41d57-110">hello parent runbook will wait for hello child runbook toocomplete before moving toohello next line, and any output is returned directly toohello parent.</span></span>

<span data-ttu-id="41d57-111">Quando você invoca um runbook embutido, ele é executado no hello mesmo trabalho como Olá o runbook pai.</span><span class="sxs-lookup"><span data-stu-id="41d57-111">When you invoke a runbook inline, it runs in hello same job as hello parent runbook.</span></span> <span data-ttu-id="41d57-112">Não haverá nenhuma indicação no histórico do trabalho de saudação do runbook filho Olá que ele foi executado.</span><span class="sxs-lookup"><span data-stu-id="41d57-112">There will be no indication in hello job history of hello child runbook that it ran.</span></span> <span data-ttu-id="41d57-113">Todas as exceções e qualquer fluxo de saída do runbook filho de saudação será associados ao pai de saudação.</span><span class="sxs-lookup"><span data-stu-id="41d57-113">Any exceptions and any stream output from hello child runbook will be associated with hello parent.</span></span> <span data-ttu-id="41d57-114">Isso resulta em menos trabalhos e torna mais fácil tootrack e tootroubleshoot desde as exceções geradas pelo runbook filho de saudação e qualquer uma das suas saídas de fluxo são associadas com hello pai trabalho.</span><span class="sxs-lookup"><span data-stu-id="41d57-114">This results in fewer jobs and makes them easier tootrack and tootroubleshoot since any exceptions thrown by hello child runbook and any of its stream output are associated with hello parent job.</span></span>

<span data-ttu-id="41d57-115">Quando um runbook é publicado, todos os runbooks filhos que ele chamar já devem ter sido publicados.</span><span class="sxs-lookup"><span data-stu-id="41d57-115">When a runbook is published, any child runbooks that it calls must already be published.</span></span> <span data-ttu-id="41d57-116">Isso ocorre porque a Automação do Azure cria uma associação com os runbooks filhos quando um runbook é compilado.</span><span class="sxs-lookup"><span data-stu-id="41d57-116">This is because Azure Automation builds an association with any child runbooks when a runbook is compiled.</span></span> <span data-ttu-id="41d57-117">Se não forem, o runbook pai Olá aparecerá toopublish corretamente, mas gerará uma exceção quando ele for iniciado.</span><span class="sxs-lookup"><span data-stu-id="41d57-117">If they aren’t, hello parent runbook will appear toopublish properly, but will generate an exception when it’s started.</span></span> <span data-ttu-id="41d57-118">Se isso acontecer, poderá republicar o runbook pai Olá em ordem tooproperly Referência Olá filho runbooks.</span><span class="sxs-lookup"><span data-stu-id="41d57-118">If this happens, you can republish hello parent runbook in order tooproperly reference hello child runbooks.</span></span> <span data-ttu-id="41d57-119">Não é necessário o runbook pai toorepublish Olá se qualquer Olá eventuais runbooks filho forem alterados, porque associação Olá já terá sido criada.</span><span class="sxs-lookup"><span data-stu-id="41d57-119">You do not need toorepublish hello parent runbook if any of hello child runbooks are changed because hello association will have already been created.</span></span>

<span data-ttu-id="41d57-120">parâmetros de saudação de um runbook filho chamado embutido podem ser qualquer tipo de dados, incluindo objetos complexos e não há nenhum [serialização JSON](automation-starting-a-runbook.md#runbook-parameters) que haja ao iniciar o runbook hello usando Olá Portal de gerenciamento ou com hello Cmdlet Start-AzureRmAutomationRunbook.</span><span class="sxs-lookup"><span data-stu-id="41d57-120">hello parameters of a child runbook called inline can be any data type including complex objects, and there is no [JSON serialization](automation-starting-a-runbook.md#runbook-parameters) as there is when you start hello runbook using hello Azure Management Portal or with hello Start-AzureRmAutomationRunbook cmdlet.</span></span>

### <a name="runbook-types"></a><span data-ttu-id="41d57-121">Tipos de runbook</span><span class="sxs-lookup"><span data-stu-id="41d57-121">Runbook types</span></span>
<span data-ttu-id="41d57-122">Quais tipos podem chamar um ao outro:</span><span class="sxs-lookup"><span data-stu-id="41d57-122">Which types can call each other:</span></span>

* <span data-ttu-id="41d57-123">Um [runbook do PowerShell ](automation-runbook-types.md#powershell-runbooks) e os [runbooks gráficos](automation-runbook-types.md#graphical-runbooks) podem chamar uns aos outros em linha (ambos são baseados no PowerShell).</span><span class="sxs-lookup"><span data-stu-id="41d57-123">A [PowerShell runbook](automation-runbook-types.md#powershell-runbooks) and [Graphical runbooks](automation-runbook-types.md#graphical-runbooks) can call each other inline (both are PowerShell based).</span></span>
* <span data-ttu-id="41d57-124">Um [runbook do Fluxo de Trabalho do PowerShell](automation-runbook-types.md#powershell-workflow-runbooks) e runbooks gráficos do Fluxo de Trabalho do PowerShell podem chamar uns aos outros de forma embutida (ambos são baseados no Fluxo de Trabalho do PowerShell)</span><span class="sxs-lookup"><span data-stu-id="41d57-124">A [PowerShell Workflow runbook](automation-runbook-types.md#powershell-workflow-runbooks) and Graphical PowerShell Workflow runbooks can call each other inline (both are PowerShell Workflow based)</span></span>
* <span data-ttu-id="41d57-125">Olá PowerShell tipos e Olá que tipos de fluxo de trabalho do PowerShell não é possível chamar embutido entre si e deve usar AzureRmAutomationRunbook de início.</span><span class="sxs-lookup"><span data-stu-id="41d57-125">hello PowerShell types and hello PowerShell Workflow types can’t call each other inline, and must use Start-AzureRmAutomationRunbook.</span></span>

<span data-ttu-id="41d57-126">Quando a ordem de publicação é importante:</span><span class="sxs-lookup"><span data-stu-id="41d57-126">When does publish order matter:</span></span>

* <span data-ttu-id="41d57-127">Olá publicar ordem de assuntos somente runbooks para runbooks do fluxo de trabalho do PowerShell gráfica e de fluxo de trabalho do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="41d57-127">hello publish order of runbooks only matters for PowerShell Workflow and Graphical PowerShell Workflow runbooks.</span></span>

<span data-ttu-id="41d57-128">Quando você chamar um runbook filho do gráfico ou fluxo de trabalho do PowerShell usando a execução embutida, você apenas usar nome de saudação do runbook hello.</span><span class="sxs-lookup"><span data-stu-id="41d57-128">When you call a Graphical or PowerShell Workflow child runbook using inline execution, you just use hello name of hello runbook.</span></span>  <span data-ttu-id="41d57-129">Quando você chamar um runbook filho do PowerShell, você deve precedido seu nome com *.\\*  toospecify que Olá script está localizado no diretório local de saudação.</span><span class="sxs-lookup"><span data-stu-id="41d57-129">When you call a PowerShell child runbook, you must preceded its name with *.\\* toospecify that hello script is located in hello local directory.</span></span> 

### <a name="example"></a><span data-ttu-id="41d57-130">Exemplo</span><span class="sxs-lookup"><span data-stu-id="41d57-130">Example</span></span>
<span data-ttu-id="41d57-131">saudação de exemplo a seguir invoca um runbook filho de teste que aceita três parâmetros, um objeto complexo, um número inteiro e um valor booleano.</span><span class="sxs-lookup"><span data-stu-id="41d57-131">hello following example invokes a test child runbook that accepts three parameters, a complex object, an integer, and a boolean.</span></span> <span data-ttu-id="41d57-132">saída de saudação do runbook filho de saudação é atribuída tooa variável.</span><span class="sxs-lookup"><span data-stu-id="41d57-132">hello output of hello child runbook is assigned tooa variable.</span></span>  <span data-ttu-id="41d57-133">Nesse caso, o runbook filho Olá é um runbook de fluxo de trabalho do PowerShell</span><span class="sxs-lookup"><span data-stu-id="41d57-133">In this case, hello child runbook is a PowerShell Workflow runbook</span></span>

    $vm = Get-AzureRmVM –ResourceGroupName "LabRG" –Name "MyVM"
    $output = PSWF-ChildRunbook –VM $vm –RepeatCount 2 –Restart $true

<span data-ttu-id="41d57-134">A seguir é hello mesmo exemplo usando um runbook do PowerShell como filho de saudação.</span><span class="sxs-lookup"><span data-stu-id="41d57-134">Following is hello same example using a PowerShell runbook as hello child.</span></span>

    $vm = Get-AzureRmVM –ResourceGroupName "LabRG" –Name "MyVM"
    $output = .\PS-ChildRunbook.ps1 –VM $vm –RepeatCount 2 –Restart $true


## <a name="starting-a-child-runbook-using-cmdlet"></a><span data-ttu-id="41d57-135">Iniciar um runbook filho usando cmdlet</span><span class="sxs-lookup"><span data-stu-id="41d57-135">Starting a child runbook using cmdlet</span></span>
<span data-ttu-id="41d57-136">Você pode usar o hello [início AzureRmAutomationRunbook](https://msdn.microsoft.com/library/mt603661.aspx) toostart cmdlet um runbook, conforme descrito em [toostart um runbook com o Windows PowerShell](automation-starting-a-runbook.md#starting-a-runbook-with-windows-powershell).</span><span class="sxs-lookup"><span data-stu-id="41d57-136">You can use hello [Start-AzureRmAutomationRunbook](https://msdn.microsoft.com/library/mt603661.aspx) cmdlet toostart a runbook as described in [toostart a runbook with Windows PowerShell](automation-starting-a-runbook.md#starting-a-runbook-with-windows-powershell).</span></span> <span data-ttu-id="41d57-137">Há dois modos de uso para esse cmdlet.</span><span class="sxs-lookup"><span data-stu-id="41d57-137">There are two modes of use for this cmdlet.</span></span>  <span data-ttu-id="41d57-138">No modo, Olá cmdlet retorna id do trabalho Olá assim que o trabalho de filho Olá é criado para o runbook filho hello.</span><span class="sxs-lookup"><span data-stu-id="41d57-138">In one mode, hello cmdlet returns hello job id as soon as hello child job is created for hello child runbook.</span></span>  <span data-ttu-id="41d57-139">Em Olá outro modo, que permitem especificando Olá **-Aguarde** parâmetro, aguarda até que filho Olá Olá cmdlet trabalho concluído e retornará a saída de saudação do runbook filho de saudação.</span><span class="sxs-lookup"><span data-stu-id="41d57-139">In hello other mode, which you enable by specifying hello **-wait** parameter, hello cmdlet will wait until hello child job finishes and will return hello output from hello child runbook.</span></span>

<span data-ttu-id="41d57-140">trabalho de saudação de um runbook filho iniciado com um cmdlet será executado em um trabalho separado de saudação o runbook pai.</span><span class="sxs-lookup"><span data-stu-id="41d57-140">hello job from a child runbook started with a cmdlet will run in a separate job from hello parent runbook.</span></span> <span data-ttu-id="41d57-141">Isso resulta em mais trabalhos do que chamar hello runbook embutido e torna mais difícil tootrack.</span><span class="sxs-lookup"><span data-stu-id="41d57-141">This results in more jobs than invoking hello runbook inline and makes them more difficult tootrack.</span></span> <span data-ttu-id="41d57-142">pai de saudação pode iniciar vários runbooks filho assíncrona sem esperar que cada toocomplete.</span><span class="sxs-lookup"><span data-stu-id="41d57-142">hello parent can start multiple child runbooks asynchronously without waiting for each toocomplete.</span></span> <span data-ttu-id="41d57-143">Para esse mesmo tipo de execução paralela chamando os runbooks do hello filho embutido, Olá o runbook pai precisaria Olá toouse [palavra-chave paralela](automation-powershell-workflow.md#parallel-processing).</span><span class="sxs-lookup"><span data-stu-id="41d57-143">For that same kind of parallel execution calling hello child runbooks inline, hello parent runbook would need toouse hello [parallel keyword](automation-powershell-workflow.md#parallel-processing).</span></span>

<span data-ttu-id="41d57-144">Parâmetros de um runbook filho iniciados com um cmdlet são fornecidos como uma tabela de hash, conforme descrito em [Parâmetros de Runbook](automation-starting-a-runbook.md#runbook-parameters).</span><span class="sxs-lookup"><span data-stu-id="41d57-144">Parameters for a child runbook started with a cmdlet are provided as a hashtable as described in [Runbook Parameters](automation-starting-a-runbook.md#runbook-parameters).</span></span> <span data-ttu-id="41d57-145">Somente tipos de dados simples podem ser usados.</span><span class="sxs-lookup"><span data-stu-id="41d57-145">Only simple data types can be used.</span></span> <span data-ttu-id="41d57-146">Se o runbook Olá tem um parâmetro com um tipo de dados complexos, em seguida, ele deve ser chamado embutido.</span><span class="sxs-lookup"><span data-stu-id="41d57-146">If hello runbook has a parameter with a complex data type, then it must be called inline.</span></span>

### <a name="example"></a><span data-ttu-id="41d57-147">Exemplo</span><span class="sxs-lookup"><span data-stu-id="41d57-147">Example</span></span>
<span data-ttu-id="41d57-148">Olá exemplo a seguir inicia um runbook filho com parâmetros e, em seguida, aguarda para ele toocomplete usando Olá AzureRmAutomationRunbook início-espera o parâmetro.</span><span class="sxs-lookup"><span data-stu-id="41d57-148">hello following example starts a child runbook with parameters and then waits for it toocomplete using hello Start-AzureRmAutomationRunbook -wait parameter.</span></span> <span data-ttu-id="41d57-149">Depois de concluído, a saída é coletada do runbook filho de saudação.</span><span class="sxs-lookup"><span data-stu-id="41d57-149">Once completed, its output is collected from hello child runbook.</span></span>

    $params = @{"VMName"="MyVM";"RepeatCount"=2;"Restart"=$true} 
    $joboutput = Start-AzureRmAutomationRunbook –AutomationAccountName "MyAutomationAccount" –Name "Test-ChildRunbook" -ResourceGroupName "LabRG" –Parameters $params –wait


## <a name="comparison-of-methods-for-calling-a-child-runbook"></a><span data-ttu-id="41d57-150">Comparação de métodos para chamar um runbook filho</span><span class="sxs-lookup"><span data-stu-id="41d57-150">Comparison of methods for calling a child runbook</span></span>
<span data-ttu-id="41d57-151">Olá tabela a seguir resume as diferenças de saudação entre Olá dois métodos para chamar um runbook de outro runbook.</span><span class="sxs-lookup"><span data-stu-id="41d57-151">hello following table summarizes hello differences between hello two methods for calling a runbook from another runbook.</span></span>

|  | <span data-ttu-id="41d57-152">Embutido</span><span class="sxs-lookup"><span data-stu-id="41d57-152">Inline</span></span> | <span data-ttu-id="41d57-153">Cmdlet</span><span class="sxs-lookup"><span data-stu-id="41d57-153">Cmdlet</span></span> |
|:--- |:--- |:--- |
| <span data-ttu-id="41d57-154">Trabalho</span><span class="sxs-lookup"><span data-stu-id="41d57-154">Job</span></span> |<span data-ttu-id="41d57-155">Runbooks filho são executados em hello como pai de saudação do mesmo trabalho.</span><span class="sxs-lookup"><span data-stu-id="41d57-155">Child runbooks run in hello same job as hello parent.</span></span> |<span data-ttu-id="41d57-156">Um trabalho separado é criado para o runbook filho hello.</span><span class="sxs-lookup"><span data-stu-id="41d57-156">A separate job is created for hello child runbook.</span></span> |
| <span data-ttu-id="41d57-157">Execução</span><span class="sxs-lookup"><span data-stu-id="41d57-157">Execution</span></span> |<span data-ttu-id="41d57-158">Runbook pai aguarda Olá filho runbook toocomplete antes de continuar.</span><span class="sxs-lookup"><span data-stu-id="41d57-158">Parent runbook waits for hello child runbook toocomplete before continuing.</span></span> |<span data-ttu-id="41d57-159">Runbook pai continua imediatamente após o runbook filho ser iniciado *ou* runbook pai aguarda Olá toofinish de trabalho de filho.</span><span class="sxs-lookup"><span data-stu-id="41d57-159">Parent runbook continues immediately after child runbook is started *or* parent runbook waits for hello child job toofinish.</span></span> |
| <span data-ttu-id="41d57-160">Saída</span><span class="sxs-lookup"><span data-stu-id="41d57-160">Output</span></span> |<span data-ttu-id="41d57-161">O runbook pai pode obter saída diretamente do runbook filho.</span><span class="sxs-lookup"><span data-stu-id="41d57-161">Parent runbook can directly get output from child runbook.</span></span> |<span data-ttu-id="41d57-162">O runbook pai deve recuperar a saída do trabalho do runbook filho *ou* o runbook pai pode obter a saída diretamente do runbook filho.</span><span class="sxs-lookup"><span data-stu-id="41d57-162">Parent runbook must retrieve output from child runbook job *or* parent runbook can directly get output from child runbook.</span></span> |
| <span data-ttu-id="41d57-163">parâmetros</span><span class="sxs-lookup"><span data-stu-id="41d57-163">Parameters</span></span> |<span data-ttu-id="41d57-164">Valores para parâmetros de runbook Olá filho são especificados separadamente e podem usar qualquer tipo de dados.</span><span class="sxs-lookup"><span data-stu-id="41d57-164">Values for hello child runbook parameters are specified separately and can use any data type.</span></span> |<span data-ttu-id="41d57-165">Valores para o runbook filho Olá parâmetros devem ser combinados em uma única tabela de hash e só podem incluir simples, de matriz e tipos de dados que aproveitam a serialização JSON do objeto.</span><span class="sxs-lookup"><span data-stu-id="41d57-165">Values for hello child runbook parameters must be combined into a single hashtable and can only include simple, array, and object data types that leverage JSON serialization.</span></span> |
| <span data-ttu-id="41d57-166">Conta de Automação</span><span class="sxs-lookup"><span data-stu-id="41d57-166">Automation Account</span></span> |<span data-ttu-id="41d57-167">Runbook pai só pode usar o runbook filho Olá mesma conta de automação.</span><span class="sxs-lookup"><span data-stu-id="41d57-167">Parent runbook can only use child runbook in hello same automation account.</span></span> |<span data-ttu-id="41d57-168">Runbook pai pode usar o runbook filho de qualquer conta de automação de saudação mesma assinatura do Azure e até mesmo uma assinatura diferente se você tiver um tooit de conexão.</span><span class="sxs-lookup"><span data-stu-id="41d57-168">Parent runbook can use child runbook from any automation account from hello same Azure subscription and even a different subscription if you have a connection tooit.</span></span> |
| <span data-ttu-id="41d57-169">Publicação</span><span class="sxs-lookup"><span data-stu-id="41d57-169">Publishing</span></span> |<span data-ttu-id="41d57-170">O runbook filho deve ser publicado antes da publicação do runbook pai.</span><span class="sxs-lookup"><span data-stu-id="41d57-170">Child runbook must be published before parent runbook is published.</span></span> |<span data-ttu-id="41d57-171">O runbook filho deve ser publicado antes da inicialização do runbook pai.</span><span class="sxs-lookup"><span data-stu-id="41d57-171">Child runbook must be published any time before parent runbook is started.</span></span> |

## <a name="next-steps"></a><span data-ttu-id="41d57-172">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="41d57-172">Next steps</span></span>
* [<span data-ttu-id="41d57-173">Como iniciar um Runbook na Automação do Azure</span><span class="sxs-lookup"><span data-stu-id="41d57-173">Starting a runbook in Azure Automation</span></span>](automation-starting-a-runbook.md)
* [<span data-ttu-id="41d57-174">Saída de runbook e mensagens na Automação do Azure</span><span class="sxs-lookup"><span data-stu-id="41d57-174">Runbook output and messages in Azure Automation</span></span>](automation-runbook-output-and-messages.md)

