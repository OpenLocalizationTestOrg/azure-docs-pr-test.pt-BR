---
title: "Autenticação IIS e Servidor de MFA do Azure | Microsoft Docs"
description: "Esta é a página do Azure Multi-Factor Authentication que o auxiliará na implantação de autenticação IIS e do servidor Azure Multi-Factor Authentication."
services: multi-factor-authentication
documentationcenter: 
author: kgremban
manager: femila
ms.assetid: d1bf1c8a-2c10-4ae6-9f4b-75f0c3df43eb
ms.service: multi-factor-authentication
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 06/16/2017
ms.author: kgremban
ms.reviewer: yossib
ms.custom: H1Hack27Feb2017,it-pro
ms.openlocfilehash: ab6f9110dccd3cfc15092f535650e8d8cb1af13c
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 07/11/2017
---
# <a name="configure-azure-multi-factor-authentication-server-for-iis-web-apps"></a><span data-ttu-id="93073-103">Configurar o Servidor de Autenticação Multifator do Azure para aplicativos Web do IIS</span><span class="sxs-lookup"><span data-stu-id="93073-103">Configure Azure Multi-Factor Authentication Server for IIS web apps</span></span>

<span data-ttu-id="93073-104">Usar a seção Autenticação IIS do Servidor de MFA (Autenticação Multifator) do Azure para habilitar e configurar a autenticação IIS para integração com aplicativos Web do IIS da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="93073-104">Use the IIS Authentication section of the Azure Multi-Factor Authentication (MFA) Server to enable and configure IIS authentication for integration with Microsoft IIS web applications.</span></span> <span data-ttu-id="93073-105">O Servidor de MFA do Azure instala um plug-in que pode filtrar solicitações feitas ao servidor Web do IIS para adicionar a Autenticação Multifator do Azure.</span><span class="sxs-lookup"><span data-stu-id="93073-105">The Azure MFA Server installs a plug-in that can filter requests being made to the IIS web server to add Azure Multi-Factor Authentication.</span></span> <span data-ttu-id="93073-106">O plug-in do IIS dá suporte para autenticação baseada em formulário e para autenticação integrada do Windows HTTP.</span><span class="sxs-lookup"><span data-stu-id="93073-106">The IIS plug-in provides support for Form-Based Authentication and Integrated Windows HTTP Authentication.</span></span> <span data-ttu-id="93073-107">As IPs confiáveis também podem ser configuradas para isentar os endereços IP de autenticação de dois fatores.</span><span class="sxs-lookup"><span data-stu-id="93073-107">Trusted IPs can also be configured to exempt internal IP addresses from two-factor authentication.</span></span>

![Autenticação IIS](./media/multi-factor-authentication-get-started-server-iis/iis.png)

## <a name="using-form-based-iis-authentication-with-azure-multi-factor-authentication-server"></a><span data-ttu-id="93073-109">Usando a autenticação ISS baseada em formulário com o servidor Azure Multi-Factor Authentication</span><span class="sxs-lookup"><span data-stu-id="93073-109">Using Form-Based IIS Authentication with Azure Multi-Factor Authentication Server</span></span>
<span data-ttu-id="93073-110">Para proteger um aplicativo Web do IIS que usa autenticação baseada em formulário, instale o Servidor de Autenticação Multifator do Azure no servidor Web do IIS e configure o Servidor de acordo com o procedimento a seguir:</span><span class="sxs-lookup"><span data-stu-id="93073-110">To secure an IIS web application that uses form-based authentication, install the Azure Multi-Factor Authentication Server on the IIS web server and configure the Server per the following procedure:</span></span>

1. <span data-ttu-id="93073-111">No Servidor de Autenticação Multifator do Azure, clique no ícone de Autenticação do IIS no menu esquerdo.</span><span class="sxs-lookup"><span data-stu-id="93073-111">In the Azure Multi-Factor Authentication Server, click the IIS Authentication icon in the left menu.</span></span>
2. <span data-ttu-id="93073-112">Clique na guia **Baseado em Formulário**.</span><span class="sxs-lookup"><span data-stu-id="93073-112">Click the **Form-Based** tab.</span></span>
3. <span data-ttu-id="93073-113">Clique em **Adicionar**.</span><span class="sxs-lookup"><span data-stu-id="93073-113">Click **Add**.</span></span>
4. <span data-ttu-id="93073-114">Para detectar o nome do usuário, a senha e as variáveis de domínio automaticamente, insira a URL de Logon (como, https://localhost/contoso/auth/login.aspx) na caixa de diálogo Configurar Automaticamente Site Baseado em Formulário e clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="93073-114">To detect username, password and domain variables automatically, enter the Login URL (like https://localhost/contoso/auth/login.aspx) within the Auto-Configure Form-Based Website dialog box and click **OK**.</span></span>
5. <span data-ttu-id="93073-115">Marque a caixa **Exigir correspondência do usuário da Autenticação Multifator** se todos os usuários foram ou vierem a ser importados para o Servidor e estiverem sujeitos à autenticação multifator.</span><span class="sxs-lookup"><span data-stu-id="93073-115">Check the **Require Multi-Factor Authentication user match** box if all users have been or will be imported into the Server and subject to multi-factor authentication.</span></span> <span data-ttu-id="93073-116">Se um número significativo de usuários ainda não tiver sido importado no Servidor e/ou for isentado da autenticação multifator, deixe a caixa desmarcada.</span><span class="sxs-lookup"><span data-stu-id="93073-116">If a significant number of users have not yet been imported into the Server and/or will be exempt from multi-factor authentication, leave the box unchecked.</span></span>
6. <span data-ttu-id="93073-117">Se as variáveis de página não puderem ser detectadas automaticamente, clique em **Especificar Manualmente** na caixa de diálogo Configurar Automaticamente Site Baseado em Formulário.</span><span class="sxs-lookup"><span data-stu-id="93073-117">If the page variables cannot be detected automatically, click **Specify Manually** in the Auto-Configure Form-Based Website dialog box.</span></span>
7. <span data-ttu-id="93073-118">Na caixa de diálogo Adicionar Site Baseado em Formulário, digite a URL para a página de logon no campo URL de envio e digite um nome de aplicativo (opcional).</span><span class="sxs-lookup"><span data-stu-id="93073-118">In the Add Form-Based Website dialog box, enter the URL to the login page in the Submit URL field and enter an Application name (optional).</span></span> <span data-ttu-id="93073-119">O nome do aplicativo aparece nos relatórios do Azure Multi-Factor Authentication e pode ser exibido nas mensagens de autenticação por SMS ou Aplicativo Móvel.</span><span class="sxs-lookup"><span data-stu-id="93073-119">The Application name appears in Azure Multi-Factor Authentication reports and may be displayed within SMS or Mobile App authentication messages.</span></span>
8. <span data-ttu-id="93073-120">Selecione o formato correto da solicitação.</span><span class="sxs-lookup"><span data-stu-id="93073-120">Select the correct Request format.</span></span> <span data-ttu-id="93073-121">Isso é definido como **POST ou GET** para a maioria dos aplicativos Web.</span><span class="sxs-lookup"><span data-stu-id="93073-121">This is set to **POST or GET** for most web applications.</span></span>
9. <span data-ttu-id="93073-122">Insira a variável de Nome de usuário, a variável de Senha e a variável de Domínio (se aparecer na página de logon).</span><span class="sxs-lookup"><span data-stu-id="93073-122">Enter the Username variable, Password variable, and Domain variable (if it appears on the login page).</span></span> <span data-ttu-id="93073-123">Para localizar os nomes das caixas de entrada navegue até a página de logon em um navegador da Web, clique com o botão direito do mouse na página e selecione **Exibir Fonte**.</span><span class="sxs-lookup"><span data-stu-id="93073-123">To find the names of the input boxes, navigate to the login page in a web browser, right-click on the page, and select **View Source**.</span></span>
10. <span data-ttu-id="93073-124">Marque a caixa **Exigir correspondência do usuário da Autenticação Multifator do Azure** se todos os usuários foram ou vierem a ser importados para o Servidor e estiverem sujeitos à autenticação multifator.</span><span class="sxs-lookup"><span data-stu-id="93073-124">Check the **Require Azure Multi-Factor Authentication user match** box if all users have been or will be imported into the Server and subject to multi-factor authentication.</span></span> <span data-ttu-id="93073-125">Se um número significativo de usuários ainda não tiver sido importado no Servidor e/ou for isentado da autenticação multifator, deixe a caixa desmarcada.</span><span class="sxs-lookup"><span data-stu-id="93073-125">If a significant number of users have not yet been imported into the Server and/or will be exempt from multi-factor authentication, leave the box unchecked.</span></span>
11. <span data-ttu-id="93073-126">Clique em **Avançado** para examinar as configurações avançadas, incluindo:</span><span class="sxs-lookup"><span data-stu-id="93073-126">Click **Advanced** to review advanced settings, including:</span></span>

  - <span data-ttu-id="93073-127">Selecionar um arquivo de página de negação personalizado</span><span class="sxs-lookup"><span data-stu-id="93073-127">Select a custom denial page file</span></span>
  - <span data-ttu-id="93073-128">Armazenar em cache as autenticações bem-sucedidas no site, durante um período de tempo, usando cookies</span><span class="sxs-lookup"><span data-stu-id="93073-128">Cache successful authentications to the website for a period of time using cookies</span></span>
  - <span data-ttu-id="93073-129">Selecione se deseja autenticar as credenciais primárias em um Domínio do Windows, diretório LDAP.</span><span class="sxs-lookup"><span data-stu-id="93073-129">Select whether to authenticate the primary credentials against a Windows Domain, LDAP directory.</span></span> <span data-ttu-id="93073-130">ou servidor RADIUS.</span><span class="sxs-lookup"><span data-stu-id="93073-130">or RADIUS server.</span></span>

12. <span data-ttu-id="93073-131">Clique em **OK** para retornar à caixa de diálogo Adicionar Site Baseado em Formulário.</span><span class="sxs-lookup"><span data-stu-id="93073-131">Click **OK** to return to the Add Form-Based Website dialog box.</span></span>
13. <span data-ttu-id="93073-132">Clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="93073-132">Click **OK**.</span></span>
14. <span data-ttu-id="93073-133">Depois que as variáveis de URL e página forem detectadas ou inseridas, os dados do site serão exibidos no painel Baseado em Formulário.</span><span class="sxs-lookup"><span data-stu-id="93073-133">Once the URL and page variables have been detected or entered, the website data displays in the Form-Based panel.</span></span>

## <a name="using-integrated-windows-authentication-with-azure-multi-factor-authentication-server"></a><span data-ttu-id="93073-134">Usando a autenticação integrada do Windows com o servidor Azure Multi-Factor Authentication</span><span class="sxs-lookup"><span data-stu-id="93073-134">Using Integrated Windows Authentication with Azure Multi-Factor Authentication Server</span></span>
<span data-ttu-id="93073-135">Para proteger um aplicativo Web do IIS que usa a autenticação HTTP integrada do Windows, instale o Servidor de MFA do Azure no servidor Web do IIS e, em seguida, configure o Servidor com as seguintes etapas:</span><span class="sxs-lookup"><span data-stu-id="93073-135">To secure an IIS web application that uses Integrated Windows HTTP authentication, install the Azure MFA Server on the IIS web server, then configure the Server with the following steps:</span></span>

1. <span data-ttu-id="93073-136">No Servidor de Autenticação Multifator do Azure, clique no ícone de Autenticação do IIS no menu esquerdo.</span><span class="sxs-lookup"><span data-stu-id="93073-136">In the Azure Multi-Factor Authentication Server, click the IIS Authentication icon in the left menu.</span></span>
2. <span data-ttu-id="93073-137">Clique na guia **HTTP**.</span><span class="sxs-lookup"><span data-stu-id="93073-137">Click the **HTTP** tab.</span></span>
3. <span data-ttu-id="93073-138">Clique em **Adicionar**.</span><span class="sxs-lookup"><span data-stu-id="93073-138">Click **Add**.</span></span>
4. <span data-ttu-id="93073-139">Na caixa de diálogo Adicionar URL Base, insira a URL para o site em que a autenticação HTTP é realizada (como http://localhost/owa) e forneça um Nome de aplicativo (opcional).</span><span class="sxs-lookup"><span data-stu-id="93073-139">In the Add Base URL dialogue box, enter the URL for the website where HTTP authentication is performed (like http://localhost/owa) and provide an Application name (optional).</span></span> <span data-ttu-id="93073-140">O nome do aplicativo aparece nos relatórios do Azure Multi-Factor Authentication e pode ser exibido nas mensagens de autenticação por SMS ou Aplicativo Móvel.</span><span class="sxs-lookup"><span data-stu-id="93073-140">The Application name appears in Azure Multi-Factor Authentication reports and may be displayed within SMS or Mobile App authentication messages.</span></span>
5. <span data-ttu-id="93073-141">Ajuste o tempo limite de ociosidade e o tempo máximo de sessão se o padrão não for suficiente.</span><span class="sxs-lookup"><span data-stu-id="93073-141">Adjust the Idle timeout and Maximum session times if the default is not sufficient.</span></span>
6. <span data-ttu-id="93073-142">Marque a caixa **Exigir correspondência do usuário da Autenticação Multifator** se todos os usuários foram ou vierem a ser importados para o Servidor e estiverem sujeitos à autenticação multifator.</span><span class="sxs-lookup"><span data-stu-id="93073-142">Check the **Require Multi-Factor Authentication user match** box if all users have been or will be imported into the Server and subject to multi-factor authentication.</span></span> <span data-ttu-id="93073-143">Se um número significativo de usuários ainda não tiver sido importado no Servidor e/ou for isentado da autenticação multifator, deixe a caixa desmarcada.</span><span class="sxs-lookup"><span data-stu-id="93073-143">If a significant number of users have not yet been imported into the Server and/or will be exempt from multi-factor authentication, leave the box unchecked.</span></span>
7. <span data-ttu-id="93073-144">Marque a caixa de **Cache de cookie**, se desejado.</span><span class="sxs-lookup"><span data-stu-id="93073-144">Check the **Cookie cache** box if desired.</span></span>
8. <span data-ttu-id="93073-145">Clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="93073-145">Click **OK**.</span></span>

## <a name="enable-iis-plug-ins-for-azure-multi-factor-authentication-server"></a><span data-ttu-id="93073-146">Habilitar Plug-ins IIS para servidor Azure Multi-Factor Authentication</span><span class="sxs-lookup"><span data-stu-id="93073-146">Enable IIS Plug-ins for Azure Multi-Factor Authentication Server</span></span>
<span data-ttu-id="93073-147">Depois de configurar as URLs e configurações da autenticação de HTTP ou da autenticação Baseada em Formulário, selecione os locais nos quais os plug-ins IIS da Autenticação Multifator do Azure devem ser carregados e habilitados no IIS.</span><span class="sxs-lookup"><span data-stu-id="93073-147">After configuring the Form-Based or HTTP authentication URLs and settings, select the locations where the Azure Multi-Factor Authentication IIS plug-ins should be loaded and enabled in IIS.</span></span> <span data-ttu-id="93073-148">Use este procedimento:</span><span class="sxs-lookup"><span data-stu-id="93073-148">Use the following procedure:</span></span>

1. <span data-ttu-id="93073-149">Se estiver executado no IIS 6, clique na guia **ISAPI**.</span><span class="sxs-lookup"><span data-stu-id="93073-149">If running on IIS 6, click the **ISAPI** tab.</span></span> <span data-ttu-id="93073-150">Selecione o site em que o aplicativo Web está sendo executado (por exemplo, Site Padrão) para habilitar o plug-in de filtro ISAPI da Autenticação Multifator do Azure para aquele site.</span><span class="sxs-lookup"><span data-stu-id="93073-150">Select the website that the web application is running under (e.g. Default Web Site) to enable the Azure Multi-Factor Authentication ISAPI filter plug-in for that site.</span></span>
2. <span data-ttu-id="93073-151">Se estiver executando no IIS 7 ou superior, clique na guia **Módulo Nativo**.</span><span class="sxs-lookup"><span data-stu-id="93073-151">If running on IIS 7 or higher, click the **Native Module** tab.</span></span> <span data-ttu-id="93073-152">Selecione o servidor, os sites ou os aplicativos para habilitar o plug-in do IIS nos níveis desejados.</span><span class="sxs-lookup"><span data-stu-id="93073-152">Select the server, websites, or applications to enable the IIS plug-in at the desired levels.</span></span>
3. <span data-ttu-id="93073-153">Clique na caixa **Habilitar autenticação do IIS** na parte superior da tela.</span><span class="sxs-lookup"><span data-stu-id="93073-153">Click the **Enable IIS authentication** box at the top of the screen.</span></span> <span data-ttu-id="93073-154">O Azure Multi-Factor Authentication agora está protegendo o aplicativo IIS selecionado.</span><span class="sxs-lookup"><span data-stu-id="93073-154">Azure Multi-Factor Authentication is now securing the selected IIS application.</span></span> <span data-ttu-id="93073-155">Verifique se os usuários foram importados para o servidor.</span><span class="sxs-lookup"><span data-stu-id="93073-155">Ensure that users have been imported into the Server.</span></span>

## <a name="trusted-ips"></a><span data-ttu-id="93073-156">IPs confiáveis</span><span class="sxs-lookup"><span data-stu-id="93073-156">Trusted IPs</span></span>
<span data-ttu-id="93073-157">Os IPs Confiáveis permitem que os usuários ignorem o Azure Multi-Factor Authentication para solicitações de site que se originam de sub-redes ou endereços IP específicos.</span><span class="sxs-lookup"><span data-stu-id="93073-157">The Trusted IPs allows users to bypass Azure Multi-Factor Authentication for website requests originating from specific IP addresses or subnets.</span></span> <span data-ttu-id="93073-158">Por exemplo, convém isentar os usuários do Azure Multi-Factor Authentication durante o logon feito no escritório.</span><span class="sxs-lookup"><span data-stu-id="93073-158">For example, you may want to exempt users from Azure Multi-Factor Authentication while logging in from the office.</span></span> <span data-ttu-id="93073-159">Para isso, você especifica a sub-rede do escritório como uma entrada de IPs Confiáveis.</span><span class="sxs-lookup"><span data-stu-id="93073-159">For this, you would specify the office subnet as a Trusted IPs entry.</span></span> <span data-ttu-id="93073-160">Para configurar IPs confiáveis, use o seguinte procedimento:</span><span class="sxs-lookup"><span data-stu-id="93073-160">To configure Trusted IPs, use the following procedure:</span></span>

1. <span data-ttu-id="93073-161">Na seção Autenticação IIS, clique na guia **IPs Confiáveis**.</span><span class="sxs-lookup"><span data-stu-id="93073-161">In the IIS Authentication section, click the **Trusted IPs** tab.</span></span>
2. <span data-ttu-id="93073-162">Clique em **Adicionar**.</span><span class="sxs-lookup"><span data-stu-id="93073-162">Click **Add**.</span></span>
3. <span data-ttu-id="93073-163">Quando a caixa de diálogo Adicionar IPs Confiáveis aparecer, selecione o botão de opção **IP Único**, **Intervalo de IP** ou **Sub-rede**.</span><span class="sxs-lookup"><span data-stu-id="93073-163">When the Add Trusted IPs dialog box appears, select the **Single IP**, **IP range**, or **Subnet** radio button.</span></span>
4. <span data-ttu-id="93073-164">Insira o endereço IP, o intervalo dos endereços IP ou a sub-rede que devem ser colocados na lista branca.</span><span class="sxs-lookup"><span data-stu-id="93073-164">Enter the IP address, range of IP addresses or subnet that should be whitelisted.</span></span> <span data-ttu-id="93073-165">Se for inserir uma sub-rede, selecione a Máscara de Rede apropriada e clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="93073-165">If entering a subnet, select the appropriate Netmask and click **OK**.</span></span> <span data-ttu-id="93073-166">A lista de autorizados agora foi adicionada.</span><span class="sxs-lookup"><span data-stu-id="93073-166">The whitelist has now been added.</span></span>
