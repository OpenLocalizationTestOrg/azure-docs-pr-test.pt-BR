---
title: "Olá aaaConfigure extensão do Azure MFA NPS | Microsoft Docs"
description: "Depois de instalar a extensão NPS hello, siga estas etapas para configuração avançada como lista branca IP e a substituição de UPN."
services: multi-factor-authentication
documentationcenter: 
author: kgremban
manager: femila
ms.assetid: 
ms.service: multi-factor-authentication
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/14/2017
ms.author: kgremban
ms.reviewer: yossib
ms.custom: it-pro
ms.openlocfilehash: c3aed077b23c95f874861eb00c8e6dca668329c1
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="advanced-configuration-options-for-hello-nps-extension-for-multi-factor-authentication"></a><span data-ttu-id="42b1e-103">Opções de configuração para Olá extensão NPS para autenticação multifator avançada</span><span class="sxs-lookup"><span data-stu-id="42b1e-103">Advanced configuration options for hello NPS extension for Multi-Factor Authentication</span></span>

<span data-ttu-id="42b1e-104">Olá extensão do servidor de diretivas de rede (NPS) estende os recursos de autenticação multifator do Azure baseado em nuvem para sua infraestrutura local.</span><span class="sxs-lookup"><span data-stu-id="42b1e-104">hello Network Policy Server (NPS) extension extends your cloud-based Azure Multi-Factor Authentication features into your on-premises infrastructure.</span></span> <span data-ttu-id="42b1e-105">Este artigo pressupõe que você já tiver instalado de extensão de saudação e agora deseja tooknow como extensão de saudação toocustomize para que você precisa.</span><span class="sxs-lookup"><span data-stu-id="42b1e-105">This article assumes that you already have hello extension installed, and now want tooknow how toocustomize hello extension for you needs.</span></span> 

## <a name="alternate-login-id"></a><span data-ttu-id="42b1e-106">ID de logon alternativa</span><span class="sxs-lookup"><span data-stu-id="42b1e-106">Alternate login ID</span></span>

<span data-ttu-id="42b1e-107">Como Olá extensão NPS conecta tooboth seu local e nuvem diretórios, você pode encontrar um problema onde o seu local nomes UPN (UPNs) não correspondem aos nomes de Olá na nuvem hello.</span><span class="sxs-lookup"><span data-stu-id="42b1e-107">Since hello NPS extension connects tooboth your on-premises and cloud directories, you might encounter an issue where your on-premises user principal names (UPNs) don't match hello names in hello cloud.</span></span> <span data-ttu-id="42b1e-108">toosolve esse problema, o uso de IDs de logon alternativo.</span><span class="sxs-lookup"><span data-stu-id="42b1e-108">toosolve this problem, use alternate login IDs.</span></span> 

<span data-ttu-id="42b1e-109">Dentro de Olá extensão do NPS, você pode designar um toobe de atributo do Active Directory usado no lugar de saudação UPN para o Azure multi-Factor Authentication.</span><span class="sxs-lookup"><span data-stu-id="42b1e-109">Within hello NPS extension, you can designate an Active Directory attribute toobe used in place of hello UPN for Azure Multi-Factor Authentication.</span></span> <span data-ttu-id="42b1e-110">Isso permite que você tooprotect seus recursos locais com a verificacao sem modificar seu UPNs locais.</span><span class="sxs-lookup"><span data-stu-id="42b1e-110">This enables you tooprotect your on-premises resources with two-step verification without modifying your on-premises UPNs.</span></span> 

<span data-ttu-id="42b1e-111">tooconfigure de logon alternativo IDs, ir muito`HKLM\SOFTWARE\Microsoft\AzureMfa` e editar Olá valores do registro a seguir:</span><span class="sxs-lookup"><span data-stu-id="42b1e-111">tooconfigure alternate login IDs, go too`HKLM\SOFTWARE\Microsoft\AzureMfa` and edit hello following registry values:</span></span>

| <span data-ttu-id="42b1e-112">Nome</span><span class="sxs-lookup"><span data-stu-id="42b1e-112">Name</span></span> | <span data-ttu-id="42b1e-113">Tipo</span><span class="sxs-lookup"><span data-stu-id="42b1e-113">Type</span></span> | <span data-ttu-id="42b1e-114">Valor padrão</span><span class="sxs-lookup"><span data-stu-id="42b1e-114">Default value</span></span> | <span data-ttu-id="42b1e-115">Descrição</span><span class="sxs-lookup"><span data-stu-id="42b1e-115">Description</span></span> |
| ---- | ---- | ------------- | ----------- |
| <span data-ttu-id="42b1e-116">LDAP_ALTERNATE_LOGINID_ATTRIBUTE</span><span class="sxs-lookup"><span data-stu-id="42b1e-116">LDAP_ALTERNATE_LOGINID_ATTRIBUTE</span></span> | <span data-ttu-id="42b1e-117">string</span><span class="sxs-lookup"><span data-stu-id="42b1e-117">string</span></span> | <span data-ttu-id="42b1e-118">Vazio</span><span class="sxs-lookup"><span data-stu-id="42b1e-118">Empty</span></span> | <span data-ttu-id="42b1e-119">Designe um nome de saudação do atributo do Active Directory que você deseja toouse em vez da saudação UPN.</span><span class="sxs-lookup"><span data-stu-id="42b1e-119">Designate hello name of Active Directory attribute that you want toouse instead of hello UPN.</span></span> <span data-ttu-id="42b1e-120">Este atributo é usado como atributo de AlternateLoginId hello.</span><span class="sxs-lookup"><span data-stu-id="42b1e-120">This attribute is used as hello AlternateLoginId attribute.</span></span> <span data-ttu-id="42b1e-121">Se esse valor do registro é definida tooa [atributo válido do Active Directory](https://msdn.microsoft.com/library/ms675090.aspx) (por exemplo, email ou displayName), em seguida, Olá valor do atributo é usado no lugar de UPN do usuário Olá para autenticação.</span><span class="sxs-lookup"><span data-stu-id="42b1e-121">If this registry value is set tooa [valid Active Directory attribute](https://msdn.microsoft.com/library/ms675090.aspx) (for example, mail or displayName), then hello attribute's value is used in place of hello user's UPN for authentication.</span></span> <span data-ttu-id="42b1e-122">Se esse valor do registro está vazio ou não configurado, então AlternateLoginId está desabilitado e UPN saudação do usuário é usado para autenticação.</span><span class="sxs-lookup"><span data-stu-id="42b1e-122">If this registry value is empty or not configured, then AlternateLoginId is disabled and hello user's UPN is used for authentication.</span></span> |
| <span data-ttu-id="42b1e-123">LDAP_FORCE_GLOBAL_CATALOG</span><span class="sxs-lookup"><span data-stu-id="42b1e-123">LDAP_FORCE_GLOBAL_CATALOG</span></span> | <span data-ttu-id="42b1e-124">Booliano</span><span class="sxs-lookup"><span data-stu-id="42b1e-124">boolean</span></span> | <span data-ttu-id="42b1e-125">Falso</span><span class="sxs-lookup"><span data-stu-id="42b1e-125">False</span></span> | <span data-ttu-id="42b1e-126">Use este sinalizador tooforce saudação do Catálogo Global para pesquisas LDAP ao procurar AlternateLoginId.</span><span class="sxs-lookup"><span data-stu-id="42b1e-126">Use this flag tooforce hello use of Global Catalog for LDAP searches when looking up AlternateLoginId.</span></span> <span data-ttu-id="42b1e-127">Configurar um controlador de domínio como um Catálogo Global, adicione Olá AlternateLoginId atributo toohello Catálogo Global e, em seguida, habilite esse sinalizador.</span><span class="sxs-lookup"><span data-stu-id="42b1e-127">Configure a domain controller as a Global Catalog, add hello AlternateLoginId attribute toohello Global Catalog, and then enable this flag.</span></span> <br><br> <span data-ttu-id="42b1e-128">Se LDAP_LOOKUP_FORESTS estiver configurado (não estiver vazia), **esse sinalizador é imposto como true**, independentemente do valor de saudação da configuração de registro de saudação.</span><span class="sxs-lookup"><span data-stu-id="42b1e-128">If LDAP_LOOKUP_FORESTS is configured (not empty), **this flag is enforced as true**, regardless of hello value of hello registry setting.</span></span> <span data-ttu-id="42b1e-129">Nesse caso, Olá extensão NPS requer Olá toobe de Catálogo Global configurado com o atributo de AlternateLoginId Olá para cada floresta.</span><span class="sxs-lookup"><span data-stu-id="42b1e-129">In this case, hello NPS extension requires hello Global Catalog toobe configured with hello AlternateLoginId attribute for each forest.</span></span> |
| <span data-ttu-id="42b1e-130">LDAP_LOOKUP_FORESTS</span><span class="sxs-lookup"><span data-stu-id="42b1e-130">LDAP_LOOKUP_FORESTS</span></span> | <span data-ttu-id="42b1e-131">string</span><span class="sxs-lookup"><span data-stu-id="42b1e-131">string</span></span> | <span data-ttu-id="42b1e-132">Vazio</span><span class="sxs-lookup"><span data-stu-id="42b1e-132">Empty</span></span> | <span data-ttu-id="42b1e-133">Forneça uma lista de ponto e vírgula separada de florestas toosearch.</span><span class="sxs-lookup"><span data-stu-id="42b1e-133">Provide a semi-colon separated list of forests toosearch.</span></span> <span data-ttu-id="42b1e-134">Por exemplo, *contoso.com;foobar.com*. Se esse valor do registro estiver configurado, Olá extensão NPS iterativamente pesquisa todas as florestas de saudação na ordem de saudação em que foram listados e retorna o primeiro valor de AlternateLoginId bem-sucedida hello.</span><span class="sxs-lookup"><span data-stu-id="42b1e-134">For example, *contoso.com;foobar.com*. If this registry value is configured, hello NPS extension iteratively searches all hello forests in hello order in which they were listed, and returns hello first successful AlternateLoginId value.</span></span> <span data-ttu-id="42b1e-135">Se esse valor do registro não estiver configurado, pesquisa de AlternateLoginId Olá é domínio atual toohello restrita.</span><span class="sxs-lookup"><span data-stu-id="42b1e-135">If this registry value is not configured, hello AlternateLoginId lookup is confined toohello current domain.</span></span>|

<span data-ttu-id="42b1e-136">Olá recomendado etapas para usar o tootroubleshoot problemas com IDs de logon alternativo [alternativa erros de ID de logon](multi-factor-authentication-nps-errors.md#alternate-login-id-errors).</span><span class="sxs-lookup"><span data-stu-id="42b1e-136">tootroubleshoot problems with alternate login IDs, use hello recommended steps for [Alternate login ID errors](multi-factor-authentication-nps-errors.md#alternate-login-id-errors).</span></span>

## <a name="ip-exceptions"></a><span data-ttu-id="42b1e-137">Exceções de IP</span><span class="sxs-lookup"><span data-stu-id="42b1e-137">IP exceptions</span></span>

<span data-ttu-id="42b1e-138">Se você precisar de disponibilidade do servidor toomonitor, como se a balanceadores de carga verifique se os servidores que estão executando antes do envio de cargas de trabalho, você não quer essas toobe verificações bloqueada por solicitações de verificação.</span><span class="sxs-lookup"><span data-stu-id="42b1e-138">If you need toomonitor server availability, like if load balancers verify which servers are running before sending workloads, you don't want these checks toobe blocked by verification requests.</span></span> <span data-ttu-id="42b1e-139">Em vez disso, crie uma lista de endereços IP que você saiba que são usados por contas de serviço e desabilite os requisitos de Autenticação Multifator para essa lista.</span><span class="sxs-lookup"><span data-stu-id="42b1e-139">Instead, create a list of IP addresses that you know are used by service accounts, and disable Multi-Factor Authentication requirements for that list.</span></span> 

<span data-ttu-id="42b1e-140">tooconfigure uma lista de permissões de IP, vá muito`HKLM\SOFTWARE\Microsoft\AzureMfa` e configurar Olá valor do registro a seguir:</span><span class="sxs-lookup"><span data-stu-id="42b1e-140">tooconfigure an IP whitelist, go too`HKLM\SOFTWARE\Microsoft\AzureMfa` and configure hello following registry value:</span></span> 

| <span data-ttu-id="42b1e-141">Nome</span><span class="sxs-lookup"><span data-stu-id="42b1e-141">Name</span></span> | <span data-ttu-id="42b1e-142">Tipo</span><span class="sxs-lookup"><span data-stu-id="42b1e-142">Type</span></span> | <span data-ttu-id="42b1e-143">Valor padrão</span><span class="sxs-lookup"><span data-stu-id="42b1e-143">Default value</span></span> | <span data-ttu-id="42b1e-144">Descrição</span><span class="sxs-lookup"><span data-stu-id="42b1e-144">Description</span></span> |
| ---- | ---- | ------------- | ----------- |
| <span data-ttu-id="42b1e-145">IP_WHITELIST</span><span class="sxs-lookup"><span data-stu-id="42b1e-145">IP_WHITELIST</span></span> | <span data-ttu-id="42b1e-146">string</span><span class="sxs-lookup"><span data-stu-id="42b1e-146">string</span></span> | <span data-ttu-id="42b1e-147">Vazio</span><span class="sxs-lookup"><span data-stu-id="42b1e-147">Empty</span></span> | <span data-ttu-id="42b1e-148">Forneça uma lista separada por ponto e vírgula de endereços IP.</span><span class="sxs-lookup"><span data-stu-id="42b1e-148">Provide a semi-colon separated list of IP addresses.</span></span> <span data-ttu-id="42b1e-149">Inclua Olá endereços IP de máquinas de solicitações de serviço de origem, como Olá servidor NAS/VPN.</span><span class="sxs-lookup"><span data-stu-id="42b1e-149">Include hello IP addresses of machines where service requests originate, like hello NAS/VPN server.</span></span> <span data-ttu-id="42b1e-150">Os intervalos IP que são sub-redes não têm suporte.</span><span class="sxs-lookup"><span data-stu-id="42b1e-150">IP ranges are subnets are not supported.</span></span> <br><br> <span data-ttu-id="42b1e-151">Por exemplo, *10.0.0.1;10.0.0.2;10.0.0.3*.</span><span class="sxs-lookup"><span data-stu-id="42b1e-151">For example, *10.0.0.1;10.0.0.2;10.0.0.3*.</span></span>

<span data-ttu-id="42b1e-152">Quando uma solicitação chega de um endereço IP que existe na lista branca de hello, verificação em duas etapas é ignorada.</span><span class="sxs-lookup"><span data-stu-id="42b1e-152">When a request comes in from an IP address that exists in hello whitelist, two-step verification is skipped.</span></span> <span data-ttu-id="42b1e-153">Olá, lista branca de IPS é toohello em comparação com o endereço IP que é fornecido no hello *ratNASIPAddress* atributo de solicitação do RADIUS hello.</span><span class="sxs-lookup"><span data-stu-id="42b1e-153">hello IP whitelist is compared toohello IP address that is provided in hello *ratNASIPAddress* attribute of hello RADIUS request.</span></span> <span data-ttu-id="42b1e-154">Se uma solicitação RADIUS chega sem atributo de ratNASIPAddress hello, Olá aviso a seguir será registrado: "Lista branca de P_WHITE_LIST_WARNING::IP está sendo ignorada como o IP de origem está ausente na solicitação do RADIUS no atributo NasIpAddress."</span><span class="sxs-lookup"><span data-stu-id="42b1e-154">If a RADIUS request comes in without hello ratNASIPAddress attribute, hello following warning is logged: "P_WHITE_LIST_WARNING::IP Whitelist is being ignored as source IP is missing in RADIUS request in NasIpAddress attribute."</span></span>

## <a name="next-steps"></a><span data-ttu-id="42b1e-155">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="42b1e-155">Next steps</span></span>

[<span data-ttu-id="42b1e-156">Resolver mensagens de erro de saudação extensão NPS para o Azure multi-Factor Authentication</span><span class="sxs-lookup"><span data-stu-id="42b1e-156">Resolve error messages from hello NPS extension for Azure Multi-Factor Authentication</span></span>](multi-factor-authentication-nps-errors.md)
