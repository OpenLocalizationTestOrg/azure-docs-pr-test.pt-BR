---
title: aaaCopy atividade guia de desempenho e ajuste | Microsoft Docs
description: "Saiba mais sobre os principais fatores que afetam o desempenho de saudação da movimentação dos dados no Azure Data Factory quando você usa a atividade de cópia."
services: data-factory
documentationcenter: 
author: linda33wj
manager: jhubbard
editor: monicar
ms.assetid: 4b9a6a4f-8cf5-4e0a-a06f-8133a2b7bc58
ms.service: data-factory
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/10/2017
ms.author: jingwang
ms.openlocfilehash: b0fb5a76c34752d07e8ddfffbb799a05fb5d6be6
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="copy-activity-performance-and-tuning-guide"></a><span data-ttu-id="42aff-103">Guia Desempenho e ajuste da Atividade de Cópia</span><span class="sxs-lookup"><span data-stu-id="42aff-103">Copy Activity performance and tuning guide</span></span>
<span data-ttu-id="42aff-104">A Atividade de cópia do Azure Data Factory fornece uma solução de dados excelente, segura, confiável e de alto desempenho.</span><span class="sxs-lookup"><span data-stu-id="42aff-104">Azure Data Factory Copy Activity delivers a first-class secure, reliable, and high-performance data loading solution.</span></span> <span data-ttu-id="42aff-105">Ele permite que você toocopy dezenas de terabytes de dados de cada dia em uma grande variedade de nuvem e repositórios de dados local.</span><span class="sxs-lookup"><span data-stu-id="42aff-105">It enables you toocopy tens of terabytes of data every day across a rich variety of cloud and on-premises data stores.</span></span> <span data-ttu-id="42aff-106">Desempenho de carregamento de dados de rápido são tooensure chave, você pode focalizar o problema de "big data" core Olá: Criando soluções de análise avançada e obter um aprofundamento de todos esses dados.</span><span class="sxs-lookup"><span data-stu-id="42aff-106">Blazing-fast data loading performance is key tooensure you can focus on hello core “big data” problem: building advanced analytics solutions and getting deep insights from all that data.</span></span>

<span data-ttu-id="42aff-107">O Azure fornece um conjunto de nível empresarial soluções de depósito de dados e armazenamento de dados e atividade de cópia oferece um experiência que é fácil tooconfigure e configure de carregamento de dados altamente otimizados.</span><span class="sxs-lookup"><span data-stu-id="42aff-107">Azure provides a set of enterprise-grade data storage and data warehouse solutions, and Copy Activity offers a highly optimized data loading experience that is easy tooconfigure and set up.</span></span> <span data-ttu-id="42aff-108">Com apenas uma atividade de cópia única, você pode obter:</span><span class="sxs-lookup"><span data-stu-id="42aff-108">With just a single copy activity, you can achieve:</span></span>

* <span data-ttu-id="42aff-109">Carregar dados no **SQL Data Warehouse do Azure** a **1,2 GBps**.</span><span class="sxs-lookup"><span data-stu-id="42aff-109">Loading data into **Azure SQL Data Warehouse** at **1.2 GBps**.</span></span> <span data-ttu-id="42aff-110">Para ver um passo a passo com um caso de uso, veja [Load 1 TB into Azure SQL Data Warehouse under 15 minutes with Azure Data Factory](data-factory-load-sql-data-warehouse.md) (Carregar 1 TB no SQL Data Warehouse do Azure em menos de 15 minutos com o Azure Data Factory).</span><span class="sxs-lookup"><span data-stu-id="42aff-110">For a walkthrough with a use case, see [Load 1 TB into Azure SQL Data Warehouse under 15 minutes with Azure Data Factory](data-factory-load-sql-data-warehouse.md).</span></span>
* <span data-ttu-id="42aff-111">O carregamento de dados no **Armazenamento de Blobs do Azure** a **1,0 GBps**</span><span class="sxs-lookup"><span data-stu-id="42aff-111">Loading data into **Azure Blob storage** at **1.0 GBps**</span></span>
* <span data-ttu-id="42aff-112">O carregamento de dados no **Azure Data Lake Store** a **1,0 GBps**</span><span class="sxs-lookup"><span data-stu-id="42aff-112">Loading data into **Azure Data Lake Store** at **1.0 GBps**</span></span>

<span data-ttu-id="42aff-113">Este artigo descreve:</span><span class="sxs-lookup"><span data-stu-id="42aff-113">This article describes:</span></span>

* <span data-ttu-id="42aff-114">[Números de referência de desempenho](#performance-reference) para toohelp de repositórios de dados com suporte de origem e do coletor planejar seu projeto.</span><span class="sxs-lookup"><span data-stu-id="42aff-114">[Performance reference numbers](#performance-reference) for supported source and sink data stores toohelp you plan your project;</span></span>
* <span data-ttu-id="42aff-115">Recursos que podem aumentar Olá taxa de transferência de cópia em diferentes cenários, incluindo [unidades de movimentação de dados em nuvem](#cloud-data-movement-units), [paralelo cópia](#parallel-copy), e [preparados cópia](#staged-copy);</span><span class="sxs-lookup"><span data-stu-id="42aff-115">Features that can boost hello copy throughput in different scenarios, including [cloud data movement units](#cloud-data-movement-units), [parallel copy](#parallel-copy), and [staged Copy](#staged-copy);</span></span>
* <span data-ttu-id="42aff-116">[Orientação de ajuste de desempenho](#performance-tuning-steps) em como tootune Olá Olá e desempenho fatores principais que podem afetar o desempenho de cópia.</span><span class="sxs-lookup"><span data-stu-id="42aff-116">[Performance tuning guidance](#performance-tuning-steps) on how tootune hello performance and hello key factors that can impact copy performance.</span></span>

> [!NOTE]
> <span data-ttu-id="42aff-117">Se você não estiver familiarizado com a Atividade de Cópia em geral, consulte [Mover dados usando a Atividade de Cópia](data-factory-data-movement-activities.md) antes de ler este artigo.</span><span class="sxs-lookup"><span data-stu-id="42aff-117">If you are not familiar with Copy Activity in general, see [Move data by using Copy Activity](data-factory-data-movement-activities.md) before reading this article.</span></span>
>

## <a name="performance-reference"></a><span data-ttu-id="42aff-118">Referência de desempenho</span><span class="sxs-lookup"><span data-stu-id="42aff-118">Performance reference</span></span>

<span data-ttu-id="42aff-119">Como uma referência de tabela abaixo mostra o número de taxa de transferência de cópia Olá em MBps para Olá fornecido com base em testes internos de pares de origem e do coletor.</span><span class="sxs-lookup"><span data-stu-id="42aff-119">As a reference, below table shows hello copy throughput number in MBps for hello given source and sink pairs based on in-house testing.</span></span> <span data-ttu-id="42aff-120">Para comparação, ela também demonstra como as diferentes configurações das [unidades de movimentação de dados na nuvem](#cloud-data-movement-units) ou da [escalabilidade do Gateway de Gerenciamento de Dados](data-factory-data-management-gateway-high-availability-scalability.md) (vários nós de gateway) podem ajudar no desempenho da cópia.</span><span class="sxs-lookup"><span data-stu-id="42aff-120">For comparison, it also demonstrates how different settings of [cloud data movement units](#cloud-data-movement-units) or [Data Management Gateway scalability](data-factory-data-management-gateway-high-availability-scalability.md) (multiple gateway nodes) can help on copy performance.</span></span>

![Matriz de desempenho](./media/data-factory-copy-activity-performance/CopyPerfRef.png)


<span data-ttu-id="42aff-122">**Toonote pontos:**</span><span class="sxs-lookup"><span data-stu-id="42aff-122">**Points toonote:**</span></span>
* <span data-ttu-id="42aff-123">Taxa de transferência é calculada usando Olá seguinte fórmula: [tamanho dos dados lidos na origem] / [atividade de cópia duração da execução].</span><span class="sxs-lookup"><span data-stu-id="42aff-123">Throughput is calculated by using hello following formula: [size of data read from source]/[Copy Activity run duration].</span></span>
* <span data-ttu-id="42aff-124">Olá números de referência de desempenho na tabela de saudação foram medidos usando [TPC-H](http://www.tpc.org/tpch/) conjunto de dados em uma atividade de cópia única execução.</span><span class="sxs-lookup"><span data-stu-id="42aff-124">hello performance reference numbers in hello table were measured using [TPC-H](http://www.tpc.org/tpch/) data set in a single copy activity run.</span></span>
* <span data-ttu-id="42aff-125">Em repositórios de dados do Azure, Olá origem e do coletor estão em Olá mesma região do Azure.</span><span class="sxs-lookup"><span data-stu-id="42aff-125">In Azure data stores, hello source and sink are in hello same Azure region.</span></span>
* <span data-ttu-id="42aff-126">Para a cópia híbrida entre local e nuvem armazenamentos de dados, cada nó do gateway foi executado em uma máquina que foi separada do armazenamento de dados de local Olá com abaixo especificação.</span><span class="sxs-lookup"><span data-stu-id="42aff-126">For hybrid copy between on-premises and cloud data stores, each gateway node was running on a machine that was separate from hello on-premises data store with below specification.</span></span> <span data-ttu-id="42aff-127">Quando uma única atividade foi executada no gateway, operação de cópia Olá consumido apenas uma pequena parte da CPU, memória ou largura de banda de rede da máquina de teste hello.</span><span class="sxs-lookup"><span data-stu-id="42aff-127">When a single activity was running on gateway, hello copy operation consumed only a small portion of hello test machine's CPU, memory, or network bandwidth.</span></span> <span data-ttu-id="42aff-128">Saiba mais em [Considerações do Gateway de Gerenciamento de Dados](#considerations-for-data-management-gateway).</span><span class="sxs-lookup"><span data-stu-id="42aff-128">Learn more from [consideration for Data Management Gateway](#considerations-for-data-management-gateway).</span></span>
    <table>
    <tr>
        <td><span data-ttu-id="42aff-129">CPU</span><span class="sxs-lookup"><span data-stu-id="42aff-129">CPU</span></span></td>
        <td><span data-ttu-id="42aff-130">32 núcleos, Intel Xeon E5-2660 v2 de 2.20 GHz</span><span class="sxs-lookup"><span data-stu-id="42aff-130">32 cores 2.20 GHz Intel Xeon E5-2660 v2</span></span></td>
    </tr>
    <tr>
        <td><span data-ttu-id="42aff-131">Memória</span><span class="sxs-lookup"><span data-stu-id="42aff-131">Memory</span></span></td>
        <td><span data-ttu-id="42aff-132">128 GB</span><span class="sxs-lookup"><span data-stu-id="42aff-132">128 GB</span></span></td>
    </tr>
    <tr>
        <td><span data-ttu-id="42aff-133">Rede</span><span class="sxs-lookup"><span data-stu-id="42aff-133">Network</span></span></td>
        <td><span data-ttu-id="42aff-134">Interface da Internet: 10 Gbps; Interface da intranet: 40 Gbps</span><span class="sxs-lookup"><span data-stu-id="42aff-134">Internet interface: 10 Gbps; intranet interface: 40 Gbps</span></span></td>
    </tr>
    </table>


> [!TIP]
> <span data-ttu-id="42aff-135">Você pode obter maior taxa de transferência utilizando mais unidades de movimentação de dados (DMUs) que saudação padrão DMUs máximo, que é 32 para executar uma atividade de cópia de nuvem para a nuvem.</span><span class="sxs-lookup"><span data-stu-id="42aff-135">You can achieve higher throughput by leveraging more data movement units (DMUs) than hello default maximum DMUs, which is 32 for a cloud-to-cloud copy activity run.</span></span> <span data-ttu-id="42aff-136">Por exemplo, com 100 DMUs, é possível copiar dados do Blob do Azure para o Azure Data Lake Store a **1 GBps**.</span><span class="sxs-lookup"><span data-stu-id="42aff-136">For example, with 100 DMUs, you can achieve copying data from Azure Blob into Azure Data Lake Store at **1.0GBps**.</span></span> <span data-ttu-id="42aff-137">Consulte Olá [unidades de movimentação de dados em nuvem](#cloud-data-movement-units) seção para obter detalhes sobre esse recurso e a saudação de cenário com suporte.</span><span class="sxs-lookup"><span data-stu-id="42aff-137">See hello [Cloud data movement units](#cloud-data-movement-units) section for details about this feature and hello supported scenario.</span></span> <span data-ttu-id="42aff-138">Entre em contato com [suporte do Azure](https://azure.microsoft.com/support/) toorequest DMUs mais.</span><span class="sxs-lookup"><span data-stu-id="42aff-138">Contact [Azure support](https://azure.microsoft.com/support/) toorequest more DMUs.</span></span>

## <a name="parallel-copy"></a><span data-ttu-id="42aff-139">Cópia paralela</span><span class="sxs-lookup"><span data-stu-id="42aff-139">Parallel copy</span></span>
<span data-ttu-id="42aff-140">Você pode ler a fonte de dados de saudação ou gravar o destino de toohello dados **em paralelo dentro de uma atividade de cópia executar**.</span><span class="sxs-lookup"><span data-stu-id="42aff-140">You can read data from hello source or write data toohello destination **in parallel within a Copy Activity run**.</span></span> <span data-ttu-id="42aff-141">Esse recurso melhora a taxa de transferência de saudação de uma operação de cópia e reduz o tempo de saudação demora toomove dados.</span><span class="sxs-lookup"><span data-stu-id="42aff-141">This feature enhances hello throughput of a copy operation and reduces hello time it takes toomove data.</span></span>

<span data-ttu-id="42aff-142">Essa configuração é diferente da saudação **simultaneidade** propriedade na definição de atividade de saudação.</span><span class="sxs-lookup"><span data-stu-id="42aff-142">This setting is different from hello **concurrency** property in hello activity definition.</span></span> <span data-ttu-id="42aff-143">Olá **simultaneidade** propriedade determina o número de saudação do **executa atividades simultâneas de cópia** tooprocess dados do windows diferente de atividade (1 too2 de AM AM, estou too3 de AM 2, 3 too4 de AM, e assim por diante).</span><span class="sxs-lookup"><span data-stu-id="42aff-143">hello **concurrency** property determines hello number of **concurrent Copy Activity runs** tooprocess data from different activity windows (1 AM too2 AM, 2 AM too3 AM, 3 AM too4 AM, and so on).</span></span> <span data-ttu-id="42aff-144">Esse recurso é útil quando você executa um carregamento histórico.</span><span class="sxs-lookup"><span data-stu-id="42aff-144">This capability is helpful when you perform a historical load.</span></span> <span data-ttu-id="42aff-145">capacidade de cópia paralela Olá aplica tooa **única de execução da atividade**.</span><span class="sxs-lookup"><span data-stu-id="42aff-145">hello parallel copy capability applies tooa **single activity run**.</span></span>

<span data-ttu-id="42aff-146">Vejamos um cenário de exemplo.</span><span class="sxs-lookup"><span data-stu-id="42aff-146">Let's look at a sample scenario.</span></span> <span data-ttu-id="42aff-147">Olá exemplo a seguir, várias fatias de saudação últimos necessário toobe processado.</span><span class="sxs-lookup"><span data-stu-id="42aff-147">In hello following example, multiple slices from hello past need toobe processed.</span></span> <span data-ttu-id="42aff-148">O Data Factory executa uma instância da Atividade de Cópia (uma execução da atividade) para cada fatia:</span><span class="sxs-lookup"><span data-stu-id="42aff-148">Data Factory runs an instance of Copy Activity (an activity run) for each slice:</span></span>

* <span data-ttu-id="42aff-149">a fatia de dados Olá da primeira janela de atividade hello (estou too2 de AM 1) = = > atividade executada 1</span><span class="sxs-lookup"><span data-stu-id="42aff-149">hello data slice from hello first activity window (1 AM too2 AM) ==> Activity run 1</span></span>
* <span data-ttu-id="42aff-150">a fatia de dados Olá da segunda janela de atividade hello (estou too3 de AM 2) = = > atividade executada 2</span><span class="sxs-lookup"><span data-stu-id="42aff-150">hello data slice from hello second activity window (2 AM too3 AM) ==> Activity run 2</span></span>
* <span data-ttu-id="42aff-151">a fatia de dados Olá da segunda janela de atividade hello (estou 3 too4 de AM) = = > atividade executada 3</span><span class="sxs-lookup"><span data-stu-id="42aff-151">hello data slice from hello second activity window (3 AM too4 AM) ==> Activity run 3</span></span>

<span data-ttu-id="42aff-152">E assim por diante.</span><span class="sxs-lookup"><span data-stu-id="42aff-152">And so on.</span></span>

<span data-ttu-id="42aff-153">Neste exemplo, quando hello **simultaneidade** valor é definido como too2, **atividade executada 1** e **atividade executada 2** copiar dados de duas janelas de atividade **simultaneamente**  tooimprove desempenho de movimento de dados.</span><span class="sxs-lookup"><span data-stu-id="42aff-153">In this example, when hello **concurrency** value is set too2, **Activity run 1** and **Activity run 2** copy data from two activity windows **concurrently** tooimprove data movement performance.</span></span> <span data-ttu-id="42aff-154">No entanto, se vários arquivos estão associados com 1 de execução da atividade, o serviço de movimentação de dados Olá copia arquivos de Olá fonte toohello destino um arquivo por vez.</span><span class="sxs-lookup"><span data-stu-id="42aff-154">However, if multiple files are associated with Activity run 1, hello data movement service copies files from hello source toohello destination one file at a time.</span></span>

### <a name="cloud-data-movement-units"></a><span data-ttu-id="42aff-155">Unidades de movimentação de dados de nuvem</span><span class="sxs-lookup"><span data-stu-id="42aff-155">Cloud data movement units</span></span>
<span data-ttu-id="42aff-156">Um **unidade de movimentação de dados de nuvem (DMU —)** é uma medida que representa a potência de saudação (uma combinação de CPU, memória e alocação de recursos de rede) de uma única unidade na fábrica de dados.</span><span class="sxs-lookup"><span data-stu-id="42aff-156">A **cloud data movement unit (DMU)** is a measure that represents hello power (a combination of CPU, memory, and network resource allocation) of a single unit in Data Factory.</span></span> <span data-ttu-id="42aff-157">Uma DMU pode ser usada em uma operação de cópia de nuvem para nuvem, mas não em uma cópia híbrida.</span><span class="sxs-lookup"><span data-stu-id="42aff-157">A DMU might be used in a cloud-to-cloud copy operation, but not in a hybrid copy.</span></span>

<span data-ttu-id="42aff-158">Por padrão, a fábrica de dados usa tooperform de DMU — uma única nuvem uma única atividade de cópia executados.</span><span class="sxs-lookup"><span data-stu-id="42aff-158">By default, Data Factory uses a single cloud DMU tooperform a single Copy Activity run.</span></span> <span data-ttu-id="42aff-159">toooverride esse padrão, especifique um valor para Olá **cloudDataMovementUnits** propriedade da seguinte maneira.</span><span class="sxs-lookup"><span data-stu-id="42aff-159">toooverride this default, specify a value for hello **cloudDataMovementUnits** property as follows.</span></span> <span data-ttu-id="42aff-160">Para obter informações sobre nível de saudação de ganho de desempenho que você pode obter ao configurar unidades de mais de uma origem de cópia específica e do coletor, consulte Olá [referência desempenho](#performance-reference).</span><span class="sxs-lookup"><span data-stu-id="42aff-160">For information about hello level of performance gain you might get when you configure more units for a specific copy source and sink, see hello [performance reference](#performance-reference).</span></span>

```json
"activities":[  
    {
        "name": "Sample copy activity",
        "description": "",
        "type": "Copy",
        "inputs": [{ "name": "InputDataset" }],
        "outputs": [{ "name": "OutputDataset" }],
        "typeProperties": {
            "source": {
                "type": "BlobSource",
            },
            "sink": {
                "type": "AzureDataLakeStoreSink"
            },
            "cloudDataMovementUnits": 32
        }
    }
]
```
<span data-ttu-id="42aff-161">Olá **valores permitidos** para Olá **cloudDataMovementUnits** propriedade são 1 (padrão), 2, 4, 8, 16, 32.</span><span class="sxs-lookup"><span data-stu-id="42aff-161">hello **allowed values** for hello **cloudDataMovementUnits** property are 1 (default), 2, 4, 8, 16, 32.</span></span> <span data-ttu-id="42aff-162">Olá **número real de nuvem DMUs** que a operação de cópia Olá usa em tempo de execução é igual tooor menor do que valor de saudação configurada, dependendo de seu padrão de dados.</span><span class="sxs-lookup"><span data-stu-id="42aff-162">hello **actual number of cloud DMUs** that hello copy operation uses at run time is equal tooor less than hello configured value, depending on your data pattern.</span></span>

> [!NOTE]
> <span data-ttu-id="42aff-163">Se precisar de mais DMUs de nuvem para uma taxa de transferência maior, entre em contato com o [suporte do Azure](https://azure.microsoft.com/support/).</span><span class="sxs-lookup"><span data-stu-id="42aff-163">If you need more cloud DMUs for a higher throughput, contact [Azure support](https://azure.microsoft.com/support/).</span></span> <span data-ttu-id="42aff-164">Configuração de 8 e superior atualmente só funcionam quando você **copiar vários arquivos de Blob repositório Data Lake/armazenamento/Amazon S3/nuvem FTP/nuvem SFTP tooBlob armazenamento repositório Data Lake/do Azure/banco de dados SQL**.</span><span class="sxs-lookup"><span data-stu-id="42aff-164">Setting of 8 and above currently works only when you **copy multiple files from Blob storage/Data Lake Store/Amazon S3/cloud FTP/cloud SFTP tooBlob storage/Data Lake Store/Azure SQL Database**.</span></span>
>

### <a name="parallelcopies"></a><span data-ttu-id="42aff-165">parallelCopies</span><span class="sxs-lookup"><span data-stu-id="42aff-165">parallelCopies</span></span>
<span data-ttu-id="42aff-166">Você pode usar o hello **parallelCopies** paralelismo de saudação tooindicate de propriedade que você deseja toouse de atividade de cópia.</span><span class="sxs-lookup"><span data-stu-id="42aff-166">You can use hello **parallelCopies** property tooindicate hello parallelism that you want Copy Activity toouse.</span></span> <span data-ttu-id="42aff-167">Você pode pensar essa propriedade como o número máximo de saudação de threads na atividade de cópia que pode ler sua fonte ou gravar armazenamentos de dados do coletor tooyour em paralelo.</span><span class="sxs-lookup"><span data-stu-id="42aff-167">You can think of this property as hello maximum number of threads within Copy Activity that can read from your source or write tooyour sink data stores in parallel.</span></span>

<span data-ttu-id="42aff-168">Para cada atividade de cópia executados, a fábrica de dados determina Olá número de paralelo cópias toouse toocopy dados do repositório de dados de origem hello e repositório de dados de destino toohello.</span><span class="sxs-lookup"><span data-stu-id="42aff-168">For each Copy Activity run, Data Factory determines hello number of parallel copies toouse toocopy data from hello source data store and toohello destination data store.</span></span> <span data-ttu-id="42aff-169">número padrão de saudação do cópias paralelas que ele usa depende do tipo hello de origem e do coletor que você está usando.</span><span class="sxs-lookup"><span data-stu-id="42aff-169">hello default number of parallel copies that it uses depends on hello type of source and sink that you are using.</span></span>  

| <span data-ttu-id="42aff-170">Fonte e coletor</span><span class="sxs-lookup"><span data-stu-id="42aff-170">Source and sink</span></span> | <span data-ttu-id="42aff-171">Contagem de cópia paralela padrão determinada pelo serviço</span><span class="sxs-lookup"><span data-stu-id="42aff-171">Default parallel copy count determined by service</span></span> |
| --- | --- |
| <span data-ttu-id="42aff-172">Copiar dados entre os armazenamentos baseados em arquivo (armazenamento de Blobs; Data Lake Store; Amazon S3; sistema de arquivos local; HDFS (Sistema de Arquivos Distribuído Hadoop) local)</span><span class="sxs-lookup"><span data-stu-id="42aff-172">Copy data between file-based stores (Blob storage; Data Lake Store; Amazon S3; an on-premises file system; an on-premises HDFS)</span></span> |<span data-ttu-id="42aff-173">Entre 1 e 32.</span><span class="sxs-lookup"><span data-stu-id="42aff-173">Between 1 and 32.</span></span> <span data-ttu-id="42aff-174">Depende do tamanho de saudação dos arquivos de saudação e número de saudação de unidades de movimentação de dados de nuvem (DMUs) toocopy usados dados entre dois armazenamentos de dados de nuvem ou Olá de configuração física de saudação do computador do Gateway usado para uma cópia híbrida (toocopy dados tooor de um repositório de dados local ).</span><span class="sxs-lookup"><span data-stu-id="42aff-174">Depends on hello size of hello files and hello number of cloud data movement units (DMUs) used toocopy data between two cloud data stores, or hello physical configuration of hello Gateway machine used for a hybrid copy (toocopy data tooor from an on-premises data store).</span></span> |
| <span data-ttu-id="42aff-175">Copiar dados de **tooAzure o armazenamento de tabela de armazenamento de qualquer fonte de dados**</span><span class="sxs-lookup"><span data-stu-id="42aff-175">Copy data from **any source data store tooAzure Table storage**</span></span> |<span data-ttu-id="42aff-176">4</span><span class="sxs-lookup"><span data-stu-id="42aff-176">4</span></span> |
| <span data-ttu-id="42aff-177">Todos os outros pares de origem e coletor</span><span class="sxs-lookup"><span data-stu-id="42aff-177">All other source and sink pairs</span></span> |<span data-ttu-id="42aff-178">1</span><span class="sxs-lookup"><span data-stu-id="42aff-178">1</span></span> |

<span data-ttu-id="42aff-179">Geralmente, comportamento padrão de saudação deve fornecer melhor taxa de transferência de saudação.</span><span class="sxs-lookup"><span data-stu-id="42aff-179">Usually, hello default behavior should give you hello best throughput.</span></span> <span data-ttu-id="42aff-180">No entanto, Olá toocontrol de carga em computadores que hospedam seus armazenamentos de dados ou de desempenho de cópia tootune, você pode escolher o valor de padrão de saudação toooverride e especifique um valor para hello **parallelCopies** propriedade.</span><span class="sxs-lookup"><span data-stu-id="42aff-180">However, toocontrol hello load on machines that host your data stores, or tootune copy performance, you may choose toooverride hello default value and specify a value for hello **parallelCopies** property.</span></span> <span data-ttu-id="42aff-181">Olá valor deve ser entre 1 e 32 (ambos incluídos).</span><span class="sxs-lookup"><span data-stu-id="42aff-181">hello value must be between 1 and 32 (both inclusive).</span></span> <span data-ttu-id="42aff-182">Em tempo de execução para um melhor desempenho hello, atividade de cópia usa um valor que seja menor ou igual valor toohello definido.</span><span class="sxs-lookup"><span data-stu-id="42aff-182">At run time, for hello best performance, Copy Activity uses a value that is less than or equal toohello value that you set.</span></span>

```json
"activities":[  
    {
        "name": "Sample copy activity",
        "description": "",
        "type": "Copy",
        "inputs": [{ "name": "InputDataset" }],
        "outputs": [{ "name": "OutputDataset" }],
        "typeProperties": {
            "source": {
                "type": "BlobSource",
            },
            "sink": {
                "type": "AzureDataLakeStoreSink"
            },
            "parallelCopies": 8
        }
    }
]
```
<span data-ttu-id="42aff-183">Toonote pontos:</span><span class="sxs-lookup"><span data-stu-id="42aff-183">Points toonote:</span></span>

* <span data-ttu-id="42aff-184">Quando você copiar dados entre armazenamentos baseada em arquivo, Olá **parallelCopies** determinar paralelismo Olá no nível de arquivo hello.</span><span class="sxs-lookup"><span data-stu-id="42aff-184">When you copy data between file-based stores, hello **parallelCopies** determine hello parallelism at hello file level.</span></span> <span data-ttu-id="42aff-185">saudação de agrupamento em um único arquivo aconteceria sob automática e transparente e foi projetada toouse Olá melhor adequado tamanho da parte de um repositório de dados de origem digite dados tooload em paralelo e ortogonal tooparallelCopies.</span><span class="sxs-lookup"><span data-stu-id="42aff-185">hello chunking within a single file would happen underneath automatically and transparently, and it's designed toouse hello best suitable chunk size for a given source data store type tooload data in parallel and orthogonal tooparallelCopies.</span></span> <span data-ttu-id="42aff-186">número real de saudação de cópias paralelas Olá movimentação de dados serviço usa para a operação de cópia de saudação em tempo de execução é não mais do que o número de saudação de arquivos que você tem.</span><span class="sxs-lookup"><span data-stu-id="42aff-186">hello actual number of parallel copies hello data movement service uses for hello copy operation at run time is no more than hello number of files you have.</span></span> <span data-ttu-id="42aff-187">Se o comportamento de cópia de saudação é **mergeFile**, atividade de cópia não pode tirar proveito de paralelismo de nível de arquivo.</span><span class="sxs-lookup"><span data-stu-id="42aff-187">If hello copy behavior is **mergeFile**, Copy Activity cannot take advantage of file-level parallelism.</span></span>
* <span data-ttu-id="42aff-188">Quando você especificar um valor para Olá **parallelCopies** propriedade, considere a possibilidade de aumento de carga Olá seus repositórios de dados de origem e do coletor e toogateway se ela é uma cópia híbrida.</span><span class="sxs-lookup"><span data-stu-id="42aff-188">When you specify a value for hello **parallelCopies** property, consider hello load increase on your source and sink data stores, and toogateway if it is a hybrid copy.</span></span> <span data-ttu-id="42aff-189">Isso acontece especialmente quando você tem várias atividades ou execuções simultâneas do hello mesmo atividades executadas em Olá mesmo repositório de dados.</span><span class="sxs-lookup"><span data-stu-id="42aff-189">This happens especially when you have multiple activities or concurrent runs of hello same activities that run against hello same data store.</span></span> <span data-ttu-id="42aff-190">Se você notar que o repositório de dados hello ou Gateway é sobrecarregado com carga hello, diminuir Olá **parallelCopies** carga de saudação do valor toorelieve.</span><span class="sxs-lookup"><span data-stu-id="42aff-190">If you notice that either hello data store or Gateway is overwhelmed with hello load, decrease hello **parallelCopies** value toorelieve hello load.</span></span>
* <span data-ttu-id="42aff-191">Quando você copia dados de armazenamentos que não são toostores baseados em arquivo que são baseados em arquivo, o serviço de movimentação de dados de saudação ignora Olá **parallelCopies** propriedade.</span><span class="sxs-lookup"><span data-stu-id="42aff-191">When you copy data from stores that are not file-based toostores that are file-based, hello data movement service ignores hello **parallelCopies** property.</span></span> <span data-ttu-id="42aff-192">Mesmo se o paralelismo for especificado, ele não será aplicado neste caso.</span><span class="sxs-lookup"><span data-stu-id="42aff-192">Even if parallelism is specified, it's not applied in this case.</span></span>

> [!NOTE]
> <span data-ttu-id="42aff-193">Você deve usar saudação de toouse 1.11 ou mais recente do Gateway de gerenciamento de dados versão **parallelCopies** recurso quando você faz uma cópia híbrida.</span><span class="sxs-lookup"><span data-stu-id="42aff-193">You must use Data Management Gateway version 1.11 or later toouse hello **parallelCopies** feature when you do a hybrid copy.</span></span>
>
>

<span data-ttu-id="42aff-194">toobetter usar essas duas propriedades e tooenhance a taxa de transferência de movimentação de dados, consulte Olá [casos de uso de exemplo](#case-study-use-parallel-copy).</span><span class="sxs-lookup"><span data-stu-id="42aff-194">toobetter use these two properties, and tooenhance your data movement throughput, see hello [sample use cases](#case-study-use-parallel-copy).</span></span> <span data-ttu-id="42aff-195">Você não precisa tooconfigure **parallelCopies** tootake vantagem do comportamento padrão de saudação.</span><span class="sxs-lookup"><span data-stu-id="42aff-195">You don't need tooconfigure **parallelCopies** tootake advantage of hello default behavior.</span></span> <span data-ttu-id="42aff-196">Se você configurar e **parallelCopies** for muito pequeno, várias DMUs de nuvem poderão não ser totalmente utilizadas.</span><span class="sxs-lookup"><span data-stu-id="42aff-196">If you do configure and **parallelCopies** is too small, multiple cloud DMUs might not be fully utilized.</span></span>  

### <a name="billing-impact"></a><span data-ttu-id="42aff-197">Impacto de cobrança</span><span class="sxs-lookup"><span data-stu-id="42aff-197">Billing impact</span></span>
<span data-ttu-id="42aff-198">Ele tem **importante** tooremember que você é cobrado com base no tempo total de saudação da operação de cópia de saudação.</span><span class="sxs-lookup"><span data-stu-id="42aff-198">It's **important** tooremember that you are charged based on hello total time of hello copy operation.</span></span> <span data-ttu-id="42aff-199">Se um trabalho de cópia usado tootake uma hora com a unidade de uma nuvem e agora ele entra em 15 minutos com quatro unidades de nuvem, hello permanece geral de cobrança quase Olá mesmo.</span><span class="sxs-lookup"><span data-stu-id="42aff-199">If a copy job used tootake one hour with one cloud unit and now it takes 15 minutes with four cloud units, hello overall bill remains almost hello same.</span></span> <span data-ttu-id="42aff-200">Por exemplo, você usa quatro unidades de nuvem.</span><span class="sxs-lookup"><span data-stu-id="42aff-200">For example, you use four cloud units.</span></span> <span data-ttu-id="42aff-201">primeira unidade de nuvem Olá gasta 10 minutos, hello um segundo, 10 minutos, Olá um terceiro, 5 minutos e Olá uma quarta, 5 minutos, tudo em uma atividade de cópia executados.</span><span class="sxs-lookup"><span data-stu-id="42aff-201">hello first cloud unit spends 10 minutes, hello second one, 10 minutes, hello third one, 5 minutes, and hello fourth one, 5 minutes, all in one Copy Activity run.</span></span> <span data-ttu-id="42aff-202">Você é cobrado para Olá cópia total (movimentação de dados) tempo, o que é 10 + 10 + 5 + 5 = 30 minutos.</span><span class="sxs-lookup"><span data-stu-id="42aff-202">You are charged for hello total copy (data movement) time, which is 10 + 10 + 5 + 5 = 30 minutes.</span></span> <span data-ttu-id="42aff-203">Usar **parallelCopies** não afeta a cobrança.</span><span class="sxs-lookup"><span data-stu-id="42aff-203">Using **parallelCopies** does not affect billing.</span></span>

## <a name="staged-copy"></a><span data-ttu-id="42aff-204">Cópia em etapas</span><span class="sxs-lookup"><span data-stu-id="42aff-204">Staged copy</span></span>
<span data-ttu-id="42aff-205">Quando você copiar dados de um repositório de dados do coletor do repositório tooa do fonte dados, você pode escolher toouse armazenamento de Blob como um armazenamento de preparo intermediários.</span><span class="sxs-lookup"><span data-stu-id="42aff-205">When you copy data from a source data store tooa sink data store, you might choose toouse Blob storage as an interim staging store.</span></span> <span data-ttu-id="42aff-206">Preparação é especialmente útil em Olá casos a seguir:</span><span class="sxs-lookup"><span data-stu-id="42aff-206">Staging is especially useful in hello following cases:</span></span>

1. <span data-ttu-id="42aff-207">**Você deseja tooingest dados de várias fontes de dados no SQL Data Warehouse por meio de PolyBase**.</span><span class="sxs-lookup"><span data-stu-id="42aff-207">**You want tooingest data from various data stores into SQL Data Warehouse via PolyBase**.</span></span> <span data-ttu-id="42aff-208">SQL Data Warehouse usa PolyBase como tooload um mecanismo de alta taxa de transferência uma grande quantidade de dados no SQL Data Warehouse.</span><span class="sxs-lookup"><span data-stu-id="42aff-208">SQL Data Warehouse uses PolyBase as a high-throughput mechanism tooload a large amount of data into SQL Data Warehouse.</span></span> <span data-ttu-id="42aff-209">No entanto, os dados de origem Olá devem estar no armazenamento de Blob, e ela deve atender aos critérios adicionais.</span><span class="sxs-lookup"><span data-stu-id="42aff-209">However, hello source data must be in Blob storage, and it must meet additional criteria.</span></span> <span data-ttu-id="42aff-210">Quando você carrega dados de um armazenamento de dados diferente do armazenamento de Blobs, pode ativar a cópia dos dados por meio do armazenamento de Blobs de preparo intermediário.</span><span class="sxs-lookup"><span data-stu-id="42aff-210">When you load data from a data store other than Blob storage, you can activate data copying via interim staging Blob storage.</span></span> <span data-ttu-id="42aff-211">Nesse caso, a fábrica de dados executa Olá necessário tooensure de transformações de dados se ele atende aos requisitos de saudação do PolyBase.</span><span class="sxs-lookup"><span data-stu-id="42aff-211">In that case, Data Factory performs hello required data transformations tooensure that it meets hello requirements of PolyBase.</span></span> <span data-ttu-id="42aff-212">Em seguida, ele usa dados tooload no SQL Data Warehouse.</span><span class="sxs-lookup"><span data-stu-id="42aff-212">Then it uses PolyBase tooload data into SQL Data Warehouse.</span></span> <span data-ttu-id="42aff-213">Para obter mais detalhes, consulte [Use tooload dados no Azure SQL Data Warehouse](data-factory-azure-sql-data-warehouse-connector.md#use-polybase-to-load-data-into-azure-sql-data-warehouse).</span><span class="sxs-lookup"><span data-stu-id="42aff-213">For more details, see [Use PolyBase tooload data into Azure SQL Data Warehouse](data-factory-azure-sql-data-warehouse-connector.md#use-polybase-to-load-data-into-azure-sql-data-warehouse).</span></span> <span data-ttu-id="42aff-214">Para ver um passo a passo com um caso de uso, veja [Load 1 TB into Azure SQL Data Warehouse under 15 minutes with Azure Data Factory](data-factory-load-sql-data-warehouse.md) (Carregar 1 TB no SQL Data Warehouse do Azure em menos de 15 minutos com o Azure Data Factory).</span><span class="sxs-lookup"><span data-stu-id="42aff-214">For a walkthrough with a use case, see [Load 1 TB into Azure SQL Data Warehouse under 15 minutes with Azure Data Factory](data-factory-load-sql-data-warehouse.md).</span></span>
2. <span data-ttu-id="42aff-215">**Às vezes, leva algum tempo tooperform uma movimentação de dados híbrido (ou seja, toocopy entre um repositório de dados local e um repositório de dados de nuvem) em uma conexão de rede lenta**.</span><span class="sxs-lookup"><span data-stu-id="42aff-215">**Sometimes it takes a while tooperform a hybrid data movement (that is, toocopy between an on-premises data store and a cloud data store) over a slow network connection**.</span></span> <span data-ttu-id="42aff-216">tooimprove desempenho, é possível compactar Olá dados no local para que ele leva menos tempo do repositório de dados de preparo do toomove dados toohello na nuvem de saudação.</span><span class="sxs-lookup"><span data-stu-id="42aff-216">tooimprove performance, you can compress hello data on-premises so that it takes less time toomove data toohello staging data store in hello cloud.</span></span> <span data-ttu-id="42aff-217">Em seguida, poderá descompactar dados Olá Olá repositório de preparo antes de carregá-lo no armazenamento de dados de destino hello.</span><span class="sxs-lookup"><span data-stu-id="42aff-217">Then you can decompress hello data in hello staging store before you load it into hello destination data store.</span></span>
3. <span data-ttu-id="42aff-218">**Você não quiser tooopen portas que a porta 80 e a porta 443 em seu firewall, devido a políticas de TI corporativas**.</span><span class="sxs-lookup"><span data-stu-id="42aff-218">**You don't want tooopen ports other than port 80 and port 443 in your firewall, because of corporate IT policies**.</span></span> <span data-ttu-id="42aff-219">Por exemplo, quando você copiar dados de um coletor de banco de dados SQL local dados repositório tooan ou um coletor do Azure SQL Data Warehouse, você precisa tooactivate comunicação de saída TCP na porta 1433 para o firewall do Windows hello e do firewall corporativo.</span><span class="sxs-lookup"><span data-stu-id="42aff-219">For example, when you copy data from an on-premises data store tooan Azure SQL Database sink or an Azure SQL Data Warehouse sink, you need tooactivate outbound TCP communication on port 1433 for both hello Windows firewall and your corporate firewall.</span></span> <span data-ttu-id="42aff-220">Nesse cenário, aproveita Olá gateway toofirst cópia tooa Blob storage preparo instância dados via HTTP ou HTTPS na porta 443.</span><span class="sxs-lookup"><span data-stu-id="42aff-220">In this scenario, take advantage of hello gateway toofirst copy data tooa Blob storage staging instance over HTTP or HTTPS on port 443.</span></span> <span data-ttu-id="42aff-221">Em seguida, carrega dados saudação no banco de dados SQL ou SQL Data Warehouse de preparo do armazenamento de Blob.</span><span class="sxs-lookup"><span data-stu-id="42aff-221">Then, load hello data into SQL Database or SQL Data Warehouse from Blob storage staging.</span></span> <span data-ttu-id="42aff-222">Nesse fluxo, você não precisa tooenable porta 1433.</span><span class="sxs-lookup"><span data-stu-id="42aff-222">In this flow, you don't need tooenable port 1433.</span></span>

### <a name="how-staged-copy-works"></a><span data-ttu-id="42aff-223">Como funciona a cópia em etapas</span><span class="sxs-lookup"><span data-stu-id="42aff-223">How staged copy works</span></span>
<span data-ttu-id="42aff-224">Quando você ativa o hello recurso de preparo, primeiro dados de saudação são copiados do hello fonte dados repositório toohello repositório de dados de preparo (traga seu próprio).</span><span class="sxs-lookup"><span data-stu-id="42aff-224">When you activate hello staging feature, first hello data is copied from hello source data store toohello staging data store (bring your own).</span></span> <span data-ttu-id="42aff-225">Em seguida, os dados de saudação são copiados do hello armazenar toohello coletor dados armazenamento de dados de preparo.</span><span class="sxs-lookup"><span data-stu-id="42aff-225">Next, hello data is copied from hello staging data store toohello sink data store.</span></span> <span data-ttu-id="42aff-226">Fábrica de dados gerencia automaticamente o fluxo de dois estágios Olá para você.</span><span class="sxs-lookup"><span data-stu-id="42aff-226">Data Factory automatically manages hello two-stage flow for you.</span></span> <span data-ttu-id="42aff-227">Fábrica de dados também limpa os dados temporários de saudação preparo armazenamento após a conclusão da movimentação de dados de saudação.</span><span class="sxs-lookup"><span data-stu-id="42aff-227">Data Factory also cleans up temporary data from hello staging storage after hello data movement is complete.</span></span>

<span data-ttu-id="42aff-228">No cenário de cópia de nuvem hello (origem e o coletor de dados repositórios estão na nuvem Olá), o gateway não é usado.</span><span class="sxs-lookup"><span data-stu-id="42aff-228">In hello cloud copy scenario (both source and sink data stores are in hello cloud), gateway is not used.</span></span> <span data-ttu-id="42aff-229">Olá serviço da fábrica de dados executa operações de cópia de saudação.</span><span class="sxs-lookup"><span data-stu-id="42aff-229">hello Data Factory service performs hello copy operations.</span></span>

![Cópia em etapas: cenário de nuvem](media/data-factory-copy-activity-performance/staged-copy-cloud-scenario.png)

<span data-ttu-id="42aff-231">No cenário de cópia híbrida hello (origem no local e coletor está na nuvem Olá), gateway Olá move tooa repositório de dados de preparo do repositório de dados dos dados de origem de saudação.</span><span class="sxs-lookup"><span data-stu-id="42aff-231">In hello hybrid copy scenario (source is on-premises and sink is in hello cloud), hello gateway moves data from hello source data store tooa staging data store.</span></span> <span data-ttu-id="42aff-232">Serviço de fábrica de dados move toohello repositório de coletor de dados do repositório de dados de saudação dados de teste.</span><span class="sxs-lookup"><span data-stu-id="42aff-232">Data Factory service moves data from hello staging data store toohello sink data store.</span></span> <span data-ttu-id="42aff-233">Copiando dados de um tooan de repositório de dados de nuvem local do repositório de dados por meio de preparo também é suportado com fluxo Olá revertida.</span><span class="sxs-lookup"><span data-stu-id="42aff-233">Copying data from a cloud data store tooan on-premises data store via staging also is supported with hello reversed flow.</span></span>

![Cópia em etapas: cenário híbrido](media/data-factory-copy-activity-performance/staged-copy-hybrid-scenario.png)

<span data-ttu-id="42aff-235">Quando você ativa a movimentação de dados por meio de um repositório de preparo, você pode especificar se deseja Olá dados toobe compactado antes de mover dados de origem de saudação dados armazenam tooan provisória ou armazenamento de dados de preparo e, em seguida, descompactado antes de mover dados de um provisório ou repositório de dados do coletor toohello do repositório de dados de preparo.</span><span class="sxs-lookup"><span data-stu-id="42aff-235">When you activate data movement by using a staging store, you can specify whether you want hello data toobe compressed before moving data from hello source data store tooan interim or staging data store, and then decompressed before moving data from an interim or staging data store toohello sink data store.</span></span>

<span data-ttu-id="42aff-236">Atualmente, não é possível copiar dados entre dois armazenamentos de dados locais usando um armazenamento de preparo.</span><span class="sxs-lookup"><span data-stu-id="42aff-236">Currently, you can't copy data between two on-premises data stores by using a staging store.</span></span> <span data-ttu-id="42aff-237">Esperamos que este toobe opção disponível em breve.</span><span class="sxs-lookup"><span data-stu-id="42aff-237">We expect this option toobe available soon.</span></span>

### <a name="configuration"></a><span data-ttu-id="42aff-238">Configuração</span><span class="sxs-lookup"><span data-stu-id="42aff-238">Configuration</span></span>
<span data-ttu-id="42aff-239">Configurar Olá **enableStaging** configuração na atividade de cópia toospecify se desejar Olá dados toobe testado no armazenamento de Blob antes de carregá-los em um repositório de dados de destino.</span><span class="sxs-lookup"><span data-stu-id="42aff-239">Configure hello **enableStaging** setting in Copy Activity toospecify whether you want hello data toobe staged in Blob storage before you load it into a destination data store.</span></span> <span data-ttu-id="42aff-240">Quando você define **enableStaging** tooTRUE, especificar propriedades adicionais de saudação listadas na tabela seguinte hello.</span><span class="sxs-lookup"><span data-stu-id="42aff-240">When you set **enableStaging** tooTRUE, specify hello additional properties listed in hello next table.</span></span> <span data-ttu-id="42aff-241">Se você não tiver um, você também precisa toocreate um armazenamento do Azure ou serviço vinculado a assinatura de acesso para a preparação do armazenamento compartilhado.</span><span class="sxs-lookup"><span data-stu-id="42aff-241">If you don’t have one, you also need toocreate an Azure Storage or Storage shared access signature-linked service for staging.</span></span>

| <span data-ttu-id="42aff-242">Propriedade</span><span class="sxs-lookup"><span data-stu-id="42aff-242">Property</span></span> | <span data-ttu-id="42aff-243">Descrição</span><span class="sxs-lookup"><span data-stu-id="42aff-243">Description</span></span> | <span data-ttu-id="42aff-244">Valor padrão</span><span class="sxs-lookup"><span data-stu-id="42aff-244">Default value</span></span> | <span data-ttu-id="42aff-245">Obrigatório</span><span class="sxs-lookup"><span data-stu-id="42aff-245">Required</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="42aff-246">**enableStaging**</span><span class="sxs-lookup"><span data-stu-id="42aff-246">**enableStaging**</span></span> |<span data-ttu-id="42aff-247">Especifique se deseja toocopy dados por meio de um provisório repositório de preparo.</span><span class="sxs-lookup"><span data-stu-id="42aff-247">Specify whether you want toocopy data via an interim staging store.</span></span> |<span data-ttu-id="42aff-248">Falso</span><span class="sxs-lookup"><span data-stu-id="42aff-248">False</span></span> |<span data-ttu-id="42aff-249">Não</span><span class="sxs-lookup"><span data-stu-id="42aff-249">No</span></span> |
| <span data-ttu-id="42aff-250">**linkedServiceName**</span><span class="sxs-lookup"><span data-stu-id="42aff-250">**linkedServiceName**</span></span> |<span data-ttu-id="42aff-251">Especificar nome de saudação de um [AzureStorage](data-factory-azure-blob-connector.md#azure-storage-linked-service) ou [o AzureStorageSas](data-factory-azure-blob-connector.md#azure-storage-sas-linked-service) serviço, que se refere a instância de toohello de armazenamento que você pode usar como um repositório de preparo provisório vinculado.</span><span class="sxs-lookup"><span data-stu-id="42aff-251">Specify hello name of an [AzureStorage](data-factory-azure-blob-connector.md#azure-storage-linked-service) or [AzureStorageSas](data-factory-azure-blob-connector.md#azure-storage-sas-linked-service) linked service, which refers toohello instance of Storage that you use as an interim staging store.</span></span> <br/><br/> <span data-ttu-id="42aff-252">Você não pode usar o armazenamento com um dado de tooload de assinatura de acesso compartilhado no SQL Data Warehouse por meio do PolyBase.</span><span class="sxs-lookup"><span data-stu-id="42aff-252">You cannot use Storage with a shared access signature tooload data into SQL Data Warehouse via PolyBase.</span></span> <span data-ttu-id="42aff-253">Pode usar em todos os outros cenários.</span><span class="sxs-lookup"><span data-stu-id="42aff-253">You can use it in all other scenarios.</span></span> |<span data-ttu-id="42aff-254">N/D</span><span class="sxs-lookup"><span data-stu-id="42aff-254">N/A</span></span> |<span data-ttu-id="42aff-255">Sim, quando **enableStaging** é definido tooTRUE</span><span class="sxs-lookup"><span data-stu-id="42aff-255">Yes, when **enableStaging** is set tooTRUE</span></span> |
| <span data-ttu-id="42aff-256">**path**</span><span class="sxs-lookup"><span data-stu-id="42aff-256">**path**</span></span> |<span data-ttu-id="42aff-257">Especifique o caminho de armazenamento de Blob Olá que deseja que os dados de preparação de saudação toocontain.</span><span class="sxs-lookup"><span data-stu-id="42aff-257">Specify hello Blob storage path that you want toocontain hello staged data.</span></span> <span data-ttu-id="42aff-258">Se você não fornecer um caminho, o serviço de saudação cria um contêiner toostore os dados temporários.</span><span class="sxs-lookup"><span data-stu-id="42aff-258">If you do not provide a path, hello service creates a container toostore temporary data.</span></span> <br/><br/> <span data-ttu-id="42aff-259">Especifique um caminho apenas se você usar o armazenamento com uma assinatura de acesso compartilhado ou exigir toobe dados temporários em um local específico.</span><span class="sxs-lookup"><span data-stu-id="42aff-259">Specify a path only if you use Storage with a shared access signature, or you require temporary data toobe in a specific location.</span></span> |<span data-ttu-id="42aff-260">N/D</span><span class="sxs-lookup"><span data-stu-id="42aff-260">N/A</span></span> |<span data-ttu-id="42aff-261">Não</span><span class="sxs-lookup"><span data-stu-id="42aff-261">No</span></span> |
| <span data-ttu-id="42aff-262">**enableCompression**</span><span class="sxs-lookup"><span data-stu-id="42aff-262">**enableCompression**</span></span> |<span data-ttu-id="42aff-263">Especifica se os dados devem ser compactados antes de ser copiado toohello destino.</span><span class="sxs-lookup"><span data-stu-id="42aff-263">Specifies whether data should be compressed before it is copied toohello destination.</span></span> <span data-ttu-id="42aff-264">Essa configuração reduz o volume de saudação de dados sendo transferidos.</span><span class="sxs-lookup"><span data-stu-id="42aff-264">This setting reduces hello volume of data being transferred.</span></span> |<span data-ttu-id="42aff-265">Falso</span><span class="sxs-lookup"><span data-stu-id="42aff-265">False</span></span> |<span data-ttu-id="42aff-266">Não</span><span class="sxs-lookup"><span data-stu-id="42aff-266">No</span></span> |

<span data-ttu-id="42aff-267">Aqui está um exemplo de definição de atividade de cópia com propriedades Olá descritas Olá anterior da tabela:</span><span class="sxs-lookup"><span data-stu-id="42aff-267">Here's a sample definition of Copy Activity with hello properties that are described in hello preceding table:</span></span>

```json
"activities":[  
{
    "name": "Sample copy activity",
    "type": "Copy",
    "inputs": [{ "name": "OnpremisesSQLServerInput" }],
    "outputs": [{ "name": "AzureSQLDBOutput" }],
    "typeProperties": {
        "source": {
            "type": "SqlSource",
        },
        "sink": {
            "type": "SqlSink"
        },
        "enableStaging": true,
        "stagingSettings": {
            "linkedServiceName": "MyStagingBlob",
            "path": "stagingcontainer/path",
            "enableCompression": true
        }
    }
}
]
```

### <a name="billing-impact"></a><span data-ttu-id="42aff-268">Impacto de cobrança</span><span class="sxs-lookup"><span data-stu-id="42aff-268">Billing impact</span></span>
<span data-ttu-id="42aff-269">Você é cobrado com base em duas etapas: duração da cópia e tipo de cópia.</span><span class="sxs-lookup"><span data-stu-id="42aff-269">You are charged based on two steps: copy duration and copy type.</span></span>

* <span data-ttu-id="42aff-270">Ao usar o preparo durante uma cópia de nuvem (copiar dados de um repositório de dados de nuvem nuvem dados repositório tooanother), você é cobrado Olá [soma da duração de cópia de etapas 1 e 2] x [preço de unidade de cópia de nuvem].</span><span class="sxs-lookup"><span data-stu-id="42aff-270">When you use staging during a cloud copy (copying data from a cloud data store tooanother cloud data store), you are charged hello [sum of copy duration for step 1 and step 2] x [cloud copy unit price].</span></span>
* <span data-ttu-id="42aff-271">Ao usar o preparo durante uma cópia híbrida (copiar dados de um repositório de dados local dados repositório tooa nuvem), você será cobrado por [duração da cópia híbrida] x [híbrida cópia unitário] + [duração de cópia de nuvem] x [preço de unidade de cópia de nuvem].</span><span class="sxs-lookup"><span data-stu-id="42aff-271">When you use staging during a hybrid copy (copying data from an on-premises data store tooa cloud data store), you are charged for [hybrid copy duration] x [hybrid copy unit price] + [cloud copy duration] x [cloud copy unit price].</span></span>

## <a name="performance-tuning-steps"></a><span data-ttu-id="42aff-272">Etapas de ajuste do desempenho</span><span class="sxs-lookup"><span data-stu-id="42aff-272">Performance tuning steps</span></span>
<span data-ttu-id="42aff-273">Sugerimos que você siga essas etapas tootune desempenho de saudação do seu serviço de fábrica de dados com a atividade de cópia:</span><span class="sxs-lookup"><span data-stu-id="42aff-273">We suggest that you take these steps tootune hello performance of your Data Factory service with Copy Activity:</span></span>

1. <span data-ttu-id="42aff-274">**Estabelecer uma linha de base**.</span><span class="sxs-lookup"><span data-stu-id="42aff-274">**Establish a baseline**.</span></span> <span data-ttu-id="42aff-275">Durante a fase de desenvolvimento hello, teste seu pipeline usando a atividade de cópia em uma amostra representativa de dados.</span><span class="sxs-lookup"><span data-stu-id="42aff-275">During hello development phase, test your pipeline by using Copy Activity against a representative data sample.</span></span> <span data-ttu-id="42aff-276">Você pode usar o hello fábrica de dados [divisão modelo](data-factory-scheduling-and-execution.md) toolimit quantidade de saudação de dados que você trabalha com.</span><span class="sxs-lookup"><span data-stu-id="42aff-276">You can use hello Data Factory [slicing model](data-factory-scheduling-and-execution.md) toolimit hello amount of data you work with.</span></span>

   <span data-ttu-id="42aff-277">Coletar o tempo de execução e as características de desempenho usando Olá **monitoramento e gerenciamento de aplicativo**.</span><span class="sxs-lookup"><span data-stu-id="42aff-277">Collect execution time and performance characteristics by using hello **Monitoring and Management App**.</span></span> <span data-ttu-id="42aff-278">Escolha **Monitorar e Gerenciar** na página inicial do Data Factory.</span><span class="sxs-lookup"><span data-stu-id="42aff-278">Choose **Monitor & Manage** on your Data Factory home page.</span></span> <span data-ttu-id="42aff-279">Na exibição de árvore de saudação, escolha Olá **conjunto de dados de saída**.</span><span class="sxs-lookup"><span data-stu-id="42aff-279">In hello tree view, choose hello **output dataset**.</span></span> <span data-ttu-id="42aff-280">Em Olá **atividade Windows** , escolha a saudação de execução da atividade de cópia.</span><span class="sxs-lookup"><span data-stu-id="42aff-280">In hello **Activity Windows** list, choose hello Copy Activity run.</span></span> <span data-ttu-id="42aff-281">**Atividade Windows** lista duração da atividade de cópia hello e tamanho de saudação dos dados de saudação que são copiados.</span><span class="sxs-lookup"><span data-stu-id="42aff-281">**Activity Windows** lists hello Copy Activity duration and hello size of hello data that's copied.</span></span> <span data-ttu-id="42aff-282">taxa de transferência de saudação é listada em **Pesquisador de objetos de janela de atividade**.</span><span class="sxs-lookup"><span data-stu-id="42aff-282">hello throughput is listed in **Activity Window Explorer**.</span></span> <span data-ttu-id="42aff-283">toolearn mais sobre o aplicativo hello, consulte [monitorar e gerenciar os pipelines de fábrica de dados do Azure usando Olá monitoramento e gerenciamento de aplicativo](data-factory-monitor-manage-app.md).</span><span class="sxs-lookup"><span data-stu-id="42aff-283">toolearn more about hello app, see [Monitor and manage Azure Data Factory pipelines by using hello Monitoring and Management App](data-factory-monitor-manage-app.md).</span></span>

   ![Detalhes da execução da atividade](./media/data-factory-copy-activity-performance/mmapp-activity-run-details.png)

   <span data-ttu-id="42aff-285">Artigo hello, você pode comparar o desempenho de saudação e a configuração do seu cenário tooCopy atividade [referência desempenho](#performance-reference) de nossos testes.</span><span class="sxs-lookup"><span data-stu-id="42aff-285">Later in hello article, you can compare hello performance and configuration of your scenario tooCopy Activity’s [performance reference](#performance-reference) from our tests.</span></span>
2. <span data-ttu-id="42aff-286">**Diagnosticar e otimizar o desempenho**.</span><span class="sxs-lookup"><span data-stu-id="42aff-286">**Diagnose and optimize performance**.</span></span> <span data-ttu-id="42aff-287">Se você observar de desempenho de saudação não atende às suas expectativas, será necessário tooidentify afunilamentos de desempenho.</span><span class="sxs-lookup"><span data-stu-id="42aff-287">If hello performance you observe doesn't meet your expectations, you need tooidentify performance bottlenecks.</span></span> <span data-ttu-id="42aff-288">Em seguida, otimizar o desempenho tooremove ou reduzir o efeito de saudação de afunilamentos.</span><span class="sxs-lookup"><span data-stu-id="42aff-288">Then, optimize performance tooremove or reduce hello effect of bottlenecks.</span></span> <span data-ttu-id="42aff-289">Uma descrição completa de diagnóstico de desempenho está além do escopo deste artigo hello, mas aqui estão algumas considerações comuns:</span><span class="sxs-lookup"><span data-stu-id="42aff-289">A full description of performance diagnosis is beyond hello scope of this article, but here are some common considerations:</span></span>

   * <span data-ttu-id="42aff-290">Recursos de desempenho:</span><span class="sxs-lookup"><span data-stu-id="42aff-290">Performance features:</span></span>
     * [<span data-ttu-id="42aff-291">Cópia paralela</span><span class="sxs-lookup"><span data-stu-id="42aff-291">Parallel copy</span></span>](#parallel-copy)
     * [<span data-ttu-id="42aff-292">Unidades de movimentação de dados de nuvem</span><span class="sxs-lookup"><span data-stu-id="42aff-292">Cloud data movement units</span></span>](#cloud-data-movement-units)
     * [<span data-ttu-id="42aff-293">Cópia em etapas</span><span class="sxs-lookup"><span data-stu-id="42aff-293">Staged copy</span></span>](#staged-copy)
     * [<span data-ttu-id="42aff-294">Escalabilidade do Gateway de Gerenciamento de Dados</span><span class="sxs-lookup"><span data-stu-id="42aff-294">Data Management Gateway scalability</span></span>](data-factory-data-management-gateway-high-availability-scalability.md)
   * [<span data-ttu-id="42aff-295">Gateway de gerenciamento de dados</span><span class="sxs-lookup"><span data-stu-id="42aff-295">Data Management Gateway</span></span>](#considerations-for-data-management-gateway)
   * [<span data-ttu-id="42aff-296">Fonte</span><span class="sxs-lookup"><span data-stu-id="42aff-296">Source</span></span>](#considerations-for-the-source)
   * [<span data-ttu-id="42aff-297">Coletor</span><span class="sxs-lookup"><span data-stu-id="42aff-297">Sink</span></span>](#considerations-for-the-sink)
   * [<span data-ttu-id="42aff-298">Serialização e desserialização</span><span class="sxs-lookup"><span data-stu-id="42aff-298">Serialization and deserialization</span></span>](#considerations-for-serialization-and-deserialization)
   * [<span data-ttu-id="42aff-299">Compactação</span><span class="sxs-lookup"><span data-stu-id="42aff-299">Compression</span></span>](#considerations-for-compression)
   * [<span data-ttu-id="42aff-300">Mapeamento de coluna</span><span class="sxs-lookup"><span data-stu-id="42aff-300">Column mapping</span></span>](#considerations-for-column-mapping)
   * [<span data-ttu-id="42aff-301">Outras considerações</span><span class="sxs-lookup"><span data-stu-id="42aff-301">Other considerations</span></span>](#other-considerations)
3. <span data-ttu-id="42aff-302">**Expanda o conjunto de dados inteiro do hello configuração tooyour**.</span><span class="sxs-lookup"><span data-stu-id="42aff-302">**Expand hello configuration tooyour entire data set**.</span></span> <span data-ttu-id="42aff-303">Quando estiver satisfeito com o desempenho e os resultados da execução de hello, você pode expandir a definição de saudação e pipeline toocover período ativo de todo o conjunto de dados.</span><span class="sxs-lookup"><span data-stu-id="42aff-303">When you're satisfied with hello execution results and performance, you can expand hello definition and pipeline active period toocover your entire data set.</span></span>

## <a name="considerations-for-data-management-gateway"></a><span data-ttu-id="42aff-304">Considerações do Gateway de Gerenciamento de Dados</span><span class="sxs-lookup"><span data-stu-id="42aff-304">Considerations for Data Management Gateway</span></span>
<span data-ttu-id="42aff-305">**Instalação do gateway**: Recomendamos que você use um toohost máquina dedicada Gateway de gerenciamento de dados.</span><span class="sxs-lookup"><span data-stu-id="42aff-305">**Gateway setup**: We recommend that you use a dedicated machine toohost Data Management Gateway.</span></span> <span data-ttu-id="42aff-306">Confira [Considerações para o uso do Gateway de Gerenciamento de Dados](data-factory-data-management-gateway.md#considerations-for-using-gateway).</span><span class="sxs-lookup"><span data-stu-id="42aff-306">See [Considerations for using Data Management Gateway](data-factory-data-management-gateway.md#considerations-for-using-gateway).</span></span>  

<span data-ttu-id="42aff-307">**Monitoramento de gateway e backup/expansão**: um único gateway lógico com um ou mais nós de gateway pode atender vários atividade de cópia é executado no Olá a mesma hora simultaneamente.</span><span class="sxs-lookup"><span data-stu-id="42aff-307">**Gateway monitoring and scale-up/out**: A single logical gateway with one or more gateway nodes can serve multiple Copy Activity runs at hello same time concurrently.</span></span> <span data-ttu-id="42aff-308">Você pode exibir um instantâneo de quase em tempo real de utilização de recursos (CPU, memória, network(in/out), etc.) em uma máquina de gateway, assim como o número de saudação de trabalhos simultâneos em execução em vez de limite em Olá portal do Azure, consulte [gateway Monitor no portal de saudação](data-factory-data-management-gateway.md#monitor-gateway-in-the-portal).</span><span class="sxs-lookup"><span data-stu-id="42aff-308">You can view near-real time snapshot of resource utilization (CPU, memory, network(in/out), etc.) on a gateway machine as well as hello number of concurrent jobs running versus limit in hello Azure portal, see [Monitor gateway in hello portal](data-factory-data-management-gateway.md#monitor-gateway-in-the-portal).</span></span> <span data-ttu-id="42aff-309">Se você precisar pesada na movimentação de dados híbrido com grande número de execuções de atividade de cópia simultânea ou com grande volume de dados toocopy, considere muito[aumentar ou expandir gateway](data-factory-data-management-gateway-high-availability-scalability.md#scale-considerations) assim como toobetter utilizam o recurso ou Copiar do tooprovision mais tooempower de recursos.</span><span class="sxs-lookup"><span data-stu-id="42aff-309">If you have heavy need on hybrid data movement either with large number of concurrent copy activity runs or with large volume of data toocopy, consider too[scale up or scale out gateway](data-factory-data-management-gateway-high-availability-scalability.md#scale-considerations) so as toobetter utilize your resource or tooprovision more resource tooempower copy.</span></span> 

## <a name="considerations-for-hello-source"></a><span data-ttu-id="42aff-310">Considerações sobre a origem de saudação</span><span class="sxs-lookup"><span data-stu-id="42aff-310">Considerations for hello source</span></span>
### <a name="general"></a><span data-ttu-id="42aff-311">Geral</span><span class="sxs-lookup"><span data-stu-id="42aff-311">General</span></span>
<span data-ttu-id="42aff-312">Certifique-se de que Olá subjacente de repositório de dados não está sobrecarregado com outras cargas de trabalho que estão executando em ou em relação a ela.</span><span class="sxs-lookup"><span data-stu-id="42aff-312">Be sure that hello underlying data store is not overwhelmed by other workloads that are running on or against it.</span></span>

<span data-ttu-id="42aff-313">Para repositórios de dados da Microsoft, consulte [monitoramento e ajuste tópicos](#performance-reference) que são específicos toodata repositórios e ajudam você a compreender dados armazenam características de desempenho, minimizar tempos de resposta e maximizar a taxa de transferência.</span><span class="sxs-lookup"><span data-stu-id="42aff-313">For Microsoft data stores, see [monitoring and tuning topics](#performance-reference) that are specific toodata stores, and help you understand data store performance characteristics, minimize response times, and maximize throughput.</span></span>

<span data-ttu-id="42aff-314">Se você copiar dados de armazenamento de Blob tooSQL Data Warehouse, considere o uso de **PolyBase** tooboost desempenho.</span><span class="sxs-lookup"><span data-stu-id="42aff-314">If you copy data from Blob storage tooSQL Data Warehouse, consider using **PolyBase** tooboost performance.</span></span> <span data-ttu-id="42aff-315">Consulte [Use tooload dados no Azure SQL Data Warehouse](data-factory-azure-sql-data-warehouse-connector.md#use-polybase-to-load-data-into-azure-sql-data-warehouse) para obter detalhes.</span><span class="sxs-lookup"><span data-stu-id="42aff-315">See [Use PolyBase tooload data into Azure SQL Data Warehouse](data-factory-azure-sql-data-warehouse-connector.md#use-polybase-to-load-data-into-azure-sql-data-warehouse) for details.</span></span> <span data-ttu-id="42aff-316">Para ver um passo a passo com um caso de uso, veja [Load 1 TB into Azure SQL Data Warehouse under 15 minutes with Azure Data Factory](data-factory-load-sql-data-warehouse.md) (Carregar 1 TB no SQL Data Warehouse do Azure em menos de 15 minutos com o Azure Data Factory).</span><span class="sxs-lookup"><span data-stu-id="42aff-316">For a walkthrough with a use case, see [Load 1 TB into Azure SQL Data Warehouse under 15 minutes with Azure Data Factory](data-factory-load-sql-data-warehouse.md).</span></span>

### <a name="file-based-data-stores"></a><span data-ttu-id="42aff-317">Armazenamentos de dados baseado em arquivo</span><span class="sxs-lookup"><span data-stu-id="42aff-317">File-based data stores</span></span>
<span data-ttu-id="42aff-318">*(Inclui o armazenamento de Blobs, Data Lake Store, Amazon S3, sistemas de arquivos locais e HDFS local)*</span><span class="sxs-lookup"><span data-stu-id="42aff-318">*(Includes Blob storage, Data Lake Store, Amazon S3, on-premises file systems, and on-premises HDFS)*</span></span>

* <span data-ttu-id="42aff-319">**Média de tamanho do arquivo e contagem de arquivos**: a Atividade de Cópia transfere os dados um arquivo por vez.</span><span class="sxs-lookup"><span data-stu-id="42aff-319">**Average file size and file count**: Copy Activity transfers data one file at a time.</span></span> <span data-ttu-id="42aff-320">Com hello movida da mesma quantidade de dados toobe, hello produtividade geral é menor se dados saudação consistem em vários pequenos arquivos em vez de alguns arquivos grandes devido a fase de inicialização toohello para cada arquivo.</span><span class="sxs-lookup"><span data-stu-id="42aff-320">With hello same amount of data toobe moved, hello overall throughput is lower if hello data consists of many small files rather than a few large files due toohello bootstrap phase for each file.</span></span> <span data-ttu-id="42aff-321">Portanto, se possível, combine pequenos arquivos em maior arquivos toogain maior taxa de transferência.</span><span class="sxs-lookup"><span data-stu-id="42aff-321">Therefore, if possible, combine small files into larger files toogain higher throughput.</span></span>
* <span data-ttu-id="42aff-322">**Compactação e o formato de arquivo**: de maneiras tooimprove desempenho, consulte Olá [considerações para serialização e desserialização](#considerations-for-serialization-and-deserialization) e [considerações para compactação](#considerations-for-compression) seções.</span><span class="sxs-lookup"><span data-stu-id="42aff-322">**File format and compression**: For more ways tooimprove performance, see hello [Considerations for serialization and deserialization](#considerations-for-serialization-and-deserialization) and [Considerations for compression](#considerations-for-compression) sections.</span></span>
* <span data-ttu-id="42aff-323">Para Olá **sistema de arquivos local** cenário no qual **Data Management Gateway** é obrigatório, consulte Olá [considerações para o Gateway de gerenciamento de dados](#considerations-for-data-management-gateway) seção.</span><span class="sxs-lookup"><span data-stu-id="42aff-323">For hello **on-premises file system** scenario, in which **Data Management Gateway** is required, see hello [Considerations for Data Management Gateway](#considerations-for-data-management-gateway) section.</span></span>

### <a name="relational-data-stores"></a><span data-ttu-id="42aff-324">Armazenamentos de dados relacionais</span><span class="sxs-lookup"><span data-stu-id="42aff-324">Relational data stores</span></span>
<span data-ttu-id="42aff-325">*(Inclui o Banco de Dados SQL, SQL Data Warehouse, Amazon Redshift, bancos de dados do SQL Server e bancos de dados Oracle, MySQL, DB2, Teradata, Sybase e PostgreSQL, etc.)*</span><span class="sxs-lookup"><span data-stu-id="42aff-325">*(Includes SQL Database; SQL Data Warehouse; Amazon Redshift; SQL Server databases; and Oracle, MySQL, DB2, Teradata, Sybase, and PostgreSQL databases, etc.)*</span></span>

* <span data-ttu-id="42aff-326">**Padrão de dados**: o esquema da tabela afeta a taxa de transferência de cópia.</span><span class="sxs-lookup"><span data-stu-id="42aff-326">**Data pattern**: Your table schema affects copy throughput.</span></span> <span data-ttu-id="42aff-327">Um tamanho de linha grande oferece um desempenho melhor do que o tamanho da linha pequeno, toocopy Olá a mesma quantidade de dados.</span><span class="sxs-lookup"><span data-stu-id="42aff-327">A large row size gives you a better performance than small row size, toocopy hello same amount of data.</span></span> <span data-ttu-id="42aff-328">motivo de saudação é que banco de dados Olá pode recuperar com mais eficiência menos lotes de dados que contêm menos linhas.</span><span class="sxs-lookup"><span data-stu-id="42aff-328">hello reason is that hello database can more efficiently retrieve fewer batches of data that contain fewer rows.</span></span>
* <span data-ttu-id="42aff-329">**Consulta ou procedimento armazenado**: otimizar a lógica de saudação de consulta de saudação ou procedimento armazenado que você especificar hello atividade de cópia dados de origem toofetch com mais eficiência.</span><span class="sxs-lookup"><span data-stu-id="42aff-329">**Query or stored procedure**: Optimize hello logic of hello query or stored procedure you specify in hello Copy Activity source toofetch data more efficiently.</span></span>
* <span data-ttu-id="42aff-330">Para **bancos de dados relacionais locais**, como o SQL Server e Oracle, o que exige o uso de saudação do **Data Management Gateway**, consulte Olá [considerações para o Gateway de gerenciamento de dados](#considerations-on-data-management-gateway) seção.</span><span class="sxs-lookup"><span data-stu-id="42aff-330">For **on-premises relational databases**, such as SQL Server and Oracle, which require hello use of **Data Management Gateway**, see hello [Considerations for Data Management Gateway](#considerations-on-data-management-gateway) section.</span></span>

## <a name="considerations-for-hello-sink"></a><span data-ttu-id="42aff-331">Considerações para o coletor de saudação</span><span class="sxs-lookup"><span data-stu-id="42aff-331">Considerations for hello sink</span></span>
### <a name="general"></a><span data-ttu-id="42aff-332">Geral</span><span class="sxs-lookup"><span data-stu-id="42aff-332">General</span></span>
<span data-ttu-id="42aff-333">Certifique-se de que Olá subjacente de repositório de dados não está sobrecarregado com outras cargas de trabalho que estão executando em ou em relação a ela.</span><span class="sxs-lookup"><span data-stu-id="42aff-333">Be sure that hello underlying data store is not overwhelmed by other workloads that are running on or against it.</span></span>

<span data-ttu-id="42aff-334">Para repositórios de dados da Microsoft, consulte muito[monitoramento e ajuste tópicos](#performance-reference) que são lojas de toodata específico.</span><span class="sxs-lookup"><span data-stu-id="42aff-334">For Microsoft data stores, refer too[monitoring and tuning topics](#performance-reference) that are specific toodata stores.</span></span> <span data-ttu-id="42aff-335">Esses tópicos podem ajudá-lo a entender as características de desempenho do armazenamento de dados e como os tempos de resposta de toominimize e maximizar a taxa de transferência.</span><span class="sxs-lookup"><span data-stu-id="42aff-335">These topics can help you understand data store performance characteristics and how toominimize response times and maximize throughput.</span></span>

<span data-ttu-id="42aff-336">Se você estiver copiando dados de **armazenamento de Blob** muito**SQL Data Warehouse**, considere o uso de **PolyBase** tooboost desempenho.</span><span class="sxs-lookup"><span data-stu-id="42aff-336">If you are copying data from **Blob storage** too**SQL Data Warehouse**, consider using **PolyBase** tooboost performance.</span></span> <span data-ttu-id="42aff-337">Consulte [Use tooload dados no Azure SQL Data Warehouse](data-factory-azure-sql-data-warehouse-connector.md#use-polybase-to-load-data-into-azure-sql-data-warehouse) para obter detalhes.</span><span class="sxs-lookup"><span data-stu-id="42aff-337">See [Use PolyBase tooload data into Azure SQL Data Warehouse](data-factory-azure-sql-data-warehouse-connector.md#use-polybase-to-load-data-into-azure-sql-data-warehouse) for details.</span></span> <span data-ttu-id="42aff-338">Para ver um passo a passo com um caso de uso, veja [Load 1 TB into Azure SQL Data Warehouse under 15 minutes with Azure Data Factory](data-factory-load-sql-data-warehouse.md) (Carregar 1 TB no SQL Data Warehouse do Azure em menos de 15 minutos com o Azure Data Factory).</span><span class="sxs-lookup"><span data-stu-id="42aff-338">For a walkthrough with a use case, see [Load 1 TB into Azure SQL Data Warehouse under 15 minutes with Azure Data Factory](data-factory-load-sql-data-warehouse.md).</span></span>

### <a name="file-based-data-stores"></a><span data-ttu-id="42aff-339">Armazenamentos de dados baseado em arquivo</span><span class="sxs-lookup"><span data-stu-id="42aff-339">File-based data stores</span></span>
<span data-ttu-id="42aff-340">*(Inclui o armazenamento de Blobs, Data Lake Store, Amazon S3, sistemas de arquivos locais e HDFS local)*</span><span class="sxs-lookup"><span data-stu-id="42aff-340">*(Includes Blob storage, Data Lake Store, Amazon S3, on-premises file systems, and on-premises HDFS)*</span></span>

* <span data-ttu-id="42aff-341">**Copie o comportamento**: se você copiar dados de um repositório de dados diferentes com base em arquivo, atividade de cópia tem três opções via Olá **copyBehavior** propriedade.</span><span class="sxs-lookup"><span data-stu-id="42aff-341">**Copy behavior**: If you copy data from a different file-based data store, Copy Activity has three options via hello **copyBehavior** property.</span></span> <span data-ttu-id="42aff-342">Preserva a hierarquia, nivela a hierarquia ou mescla os arquivos.</span><span class="sxs-lookup"><span data-stu-id="42aff-342">It preserves hierarchy, flattens hierarchy, or merges files.</span></span> <span data-ttu-id="42aff-343">Preservando tanto a simplificação de hierarquia tem pouca ou nenhuma sobrecarga de desempenho, mas mesclar arquivos causa tooincrease de sobrecarga de desempenho.</span><span class="sxs-lookup"><span data-stu-id="42aff-343">Either preserving or flattening hierarchy has little or no performance overhead, but merging files causes performance overhead tooincrease.</span></span>
* <span data-ttu-id="42aff-344">**Compactação e o formato de arquivo**: consulte Olá [considerações para serialização e desserialização](#considerations-for-serialization-and-deserialization) e [considerações para compactação](#considerations-for-compression) seções de desempenho tooimprove maneiras .</span><span class="sxs-lookup"><span data-stu-id="42aff-344">**File format and compression**: See hello [Considerations for serialization and deserialization](#considerations-for-serialization-and-deserialization) and [Considerations for compression](#considerations-for-compression) sections for more ways tooimprove performance.</span></span>
* <span data-ttu-id="42aff-345">**Armazenamento de Blobs**: atualmente, o armazenamento de Blobs apenas suporta os blobs de blocos da transferência de dados otimizada e da taxa de transferência.</span><span class="sxs-lookup"><span data-stu-id="42aff-345">**Blob storage**: Currently, Blob storage supports only block blobs for optimized data transfer and throughput.</span></span>
* <span data-ttu-id="42aff-346">Para **sistemas de arquivos local** cenários que exigem o uso de saudação do **Data Management Gateway**, consulte Olá [considerações para o Gateway de gerenciamento de dados](#considerations-for-data-management-gateway) seção.</span><span class="sxs-lookup"><span data-stu-id="42aff-346">For **on-premises file systems** scenarios that require hello use of **Data Management Gateway**, see hello [Considerations for Data Management Gateway](#considerations-for-data-management-gateway) section.</span></span>

### <a name="relational-data-stores"></a><span data-ttu-id="42aff-347">Armazenamentos de dados relacionais</span><span class="sxs-lookup"><span data-stu-id="42aff-347">Relational data stores</span></span>
<span data-ttu-id="42aff-348">*(Inclui o Banco de Dados SQL, SQL Data Warehouse, bancos de dados do SQL Server e bancos de dados Oracle)*</span><span class="sxs-lookup"><span data-stu-id="42aff-348">*(Includes SQL Database, SQL Data Warehouse, SQL Server databases, and Oracle databases)*</span></span>

* <span data-ttu-id="42aff-349">**Copie o comportamento**: dependendo definidas para as propriedades Olá **sqlSink**, atividade de cópia grava o banco de dados de destino de toohello dados de maneiras diferentes.</span><span class="sxs-lookup"><span data-stu-id="42aff-349">**Copy behavior**: Depending on hello properties you've set for **sqlSink**, Copy Activity writes data toohello destination database in different ways.</span></span>
  * <span data-ttu-id="42aff-350">Por padrão, Olá dados movimentação serviço usa dados de tooinsert Olá API de cópia em massa em Acrescentar modo, que fornece Olá melhor desempenho.</span><span class="sxs-lookup"><span data-stu-id="42aff-350">By default, hello data movement service uses hello Bulk Copy API tooinsert data in append mode, which provides hello best performance.</span></span>
  * <span data-ttu-id="42aff-351">Se você configurar um procedimento armazenado no coletor hello, o banco de dados de saudação aplica-se uma linha de dados de saudação em um horário em vez de um carregamento em massa.</span><span class="sxs-lookup"><span data-stu-id="42aff-351">If you configure a stored procedure in hello sink, hello database applies hello data one row at a time instead of as a bulk load.</span></span> <span data-ttu-id="42aff-352">O desempenho cai significativamente.</span><span class="sxs-lookup"><span data-stu-id="42aff-352">Performance drops significantly.</span></span> <span data-ttu-id="42aff-353">Se seu conjunto de dados for grande, quando aplicável, considere a possibilidade de saudação toousing **sqlWriterCleanupScript** propriedade.</span><span class="sxs-lookup"><span data-stu-id="42aff-353">If your data set is large, when applicable, consider switching toousing hello **sqlWriterCleanupScript** property.</span></span>
  * <span data-ttu-id="42aff-354">Se você configurar Olá **sqlWriterCleanupScript** executar de propriedade para cada atividade de cópia, disparadores do serviço de Olá Olá script e, em seguida, você usar dados de saudação do hello API de cópia em massa tooinsert.</span><span class="sxs-lookup"><span data-stu-id="42aff-354">If you configure hello **sqlWriterCleanupScript** property for each Copy Activity run, hello service triggers hello script, and then you use hello Bulk Copy API tooinsert hello data.</span></span> <span data-ttu-id="42aff-355">Por exemplo, toooverwrite Olá toda a tabela com dados mais recentes do hello, você pode especificar um script toofirst excluir todos os registros antes de novos dados de saudação de carregamento em massa da fonte de hello.</span><span class="sxs-lookup"><span data-stu-id="42aff-355">For example, toooverwrite hello entire table with hello latest data, you can specify a script toofirst delete all records before bulk-loading hello new data from hello source.</span></span>
* <span data-ttu-id="42aff-356">**Padrão de dados e tamanho do lote**:</span><span class="sxs-lookup"><span data-stu-id="42aff-356">**Data pattern and batch size**:</span></span>
  * <span data-ttu-id="42aff-357">O esquema da tabela afeta a taxa de transferência da cópia.</span><span class="sxs-lookup"><span data-stu-id="42aff-357">Your table schema affects copy throughput.</span></span> <span data-ttu-id="42aff-358">toocopy Olá a mesma quantidade de dados, um tamanho de linha grande fornece desempenho melhor do que um tamanho de linha pequeno porque o banco de dados de saudação pode ser confirmada menos lotes de dados com mais eficiência.</span><span class="sxs-lookup"><span data-stu-id="42aff-358">toocopy hello same amount of data, a large row size gives you better performance than a small row size because hello database can more efficiently commit fewer batches of data.</span></span>
  * <span data-ttu-id="42aff-359">A Atividade de Cópia insere dados em uma série de lotes.</span><span class="sxs-lookup"><span data-stu-id="42aff-359">Copy Activity inserts data in a series of batches.</span></span> <span data-ttu-id="42aff-360">Você pode definir o número de saudação de linhas em um lote usando Olá **writeBatchSize** propriedade.</span><span class="sxs-lookup"><span data-stu-id="42aff-360">You can set hello number of rows in a batch by using hello **writeBatchSize** property.</span></span> <span data-ttu-id="42aff-361">Se os dados tiverem linhas pequenas, você pode definir Olá **writeBatchSize** propriedade com um toobenefit de valor mais alto de sobrecarga de lote menor e maior taxa de transferência.</span><span class="sxs-lookup"><span data-stu-id="42aff-361">If your data has small rows, you can set hello **writeBatchSize** property with a higher value toobenefit from lower batch overhead and higher throughput.</span></span> <span data-ttu-id="42aff-362">Se o tamanho de linha de saudação dos dados for grande, tenha cuidado ao aumentar **writeBatchSize**.</span><span class="sxs-lookup"><span data-stu-id="42aff-362">If hello row size of your data is large, be careful when you increase **writeBatchSize**.</span></span> <span data-ttu-id="42aff-363">Um valor alto pode causar falha de cópia tooa devida à sobrecarga de banco de dados de saudação.</span><span class="sxs-lookup"><span data-stu-id="42aff-363">A high value might lead tooa copy failure caused by overloading hello database.</span></span>
* <span data-ttu-id="42aff-364">Para **bancos de dados relacionais locais** como o SQL Server e Oracle, o que exige o uso de saudação do **Data Management Gateway**, consulte Olá [considerações para o Gateway de gerenciamento de dados](#considerations-for-data-management-gateway) seção.</span><span class="sxs-lookup"><span data-stu-id="42aff-364">For **on-premises relational databases** like SQL Server and Oracle, which require hello use of **Data Management Gateway**, see hello [Considerations for Data Management Gateway](#considerations-for-data-management-gateway) section.</span></span>

### <a name="nosql-stores"></a><span data-ttu-id="42aff-365">Repositórios NoSQL</span><span class="sxs-lookup"><span data-stu-id="42aff-365">NoSQL stores</span></span>
<span data-ttu-id="42aff-366">*(Inclui o Armazenamento de tabelas e o Azure Cosmos DB)*</span><span class="sxs-lookup"><span data-stu-id="42aff-366">*(Includes Table storage and Azure Cosmos DB )*</span></span>

* <span data-ttu-id="42aff-367">Para o **Armazenamento de Tabelas**:</span><span class="sxs-lookup"><span data-stu-id="42aff-367">For **Table storage**:</span></span>
  * <span data-ttu-id="42aff-368">**Partição**: gravar as partições de dados toointerleaved drasticamente degrada o desempenho.</span><span class="sxs-lookup"><span data-stu-id="42aff-368">**Partition**: Writing data toointerleaved partitions dramatically degrades performance.</span></span> <span data-ttu-id="42aff-369">Classifique os dados de origem por chave de partição, de forma que dados saudação são inseridos com eficiência em uma partição após o outro, ou ajuste Olá lógica toowrite Olá tooa única partição de dados.</span><span class="sxs-lookup"><span data-stu-id="42aff-369">Sort your source data by partition key so that hello data is inserted efficiently into one partition after another, or adjust hello logic toowrite hello data tooa single partition.</span></span>
* <span data-ttu-id="42aff-370">Para o **Azure Cosmos DB**:</span><span class="sxs-lookup"><span data-stu-id="42aff-370">For **Azure Cosmos DB**:</span></span>
  * <span data-ttu-id="42aff-371">**Tamanho do lote**: Olá **writeBatchSize** propriedade define o número de saudação de solicitações em paralelo toohello documentos de toocreate do serviço de banco de dados do Azure Cosmos.</span><span class="sxs-lookup"><span data-stu-id="42aff-371">**Batch size**: hello **writeBatchSize** property sets hello number of parallel requests toohello Azure Cosmos DB service toocreate documents.</span></span> <span data-ttu-id="42aff-372">Você pode esperar um desempenho melhor quando você aumenta **writeBatchSize** como mais solicitações paralelas são enviadas tooAzure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="42aff-372">You can expect better performance when you increase **writeBatchSize** because more parallel requests are sent tooAzure Cosmos DB.</span></span> <span data-ttu-id="42aff-373">No entanto, observe limitação quando você escreve tooAzure Cosmos DB (mensagem de saudação do erro é "Solicitar a taxa é grande").</span><span class="sxs-lookup"><span data-stu-id="42aff-373">However, watch for throttling when you write tooAzure Cosmos DB (hello error message is "Request rate is large").</span></span> <span data-ttu-id="42aff-374">Vários fatores podem causar limitação, incluindo o tamanho do documento, número de saudação de termos em documentos Olá e Olá política de indexação da coleção de destino.</span><span class="sxs-lookup"><span data-stu-id="42aff-374">Various factors can cause throttling, including document size, hello number of terms in hello documents, and hello target collection's indexing policy.</span></span> <span data-ttu-id="42aff-375">tooachieve maior throughput de cópia, considere o uso de uma coleção melhor, por exemplo, S3.</span><span class="sxs-lookup"><span data-stu-id="42aff-375">tooachieve higher copy throughput, consider using a better collection, for example, S3.</span></span>

## <a name="considerations-for-serialization-and-deserialization"></a><span data-ttu-id="42aff-376">Considerações da serialização e desserialização</span><span class="sxs-lookup"><span data-stu-id="42aff-376">Considerations for serialization and deserialization</span></span>
<span data-ttu-id="42aff-377">A serialização e desserialização podem acontecer quando o conjunto de dados de entrada ou saída é um arquivo.</span><span class="sxs-lookup"><span data-stu-id="42aff-377">Serialization and deserialization can occur when your input data set or output data set is a file.</span></span> <span data-ttu-id="42aff-378">Consulte [Formatos de arquivo e compactação com suporte](data-factory-supported-file-and-compression-formats.md) para obter detalhes sobre os formatos de arquivo com suporte na Atividade de Cópia.</span><span class="sxs-lookup"><span data-stu-id="42aff-378">See [Supported file and compression formats](data-factory-supported-file-and-compression-formats.md) with details on supported file formats by Copy Activity.</span></span>

<span data-ttu-id="42aff-379">**Comportamento da cópia**:</span><span class="sxs-lookup"><span data-stu-id="42aff-379">**Copy behavior**:</span></span>

* <span data-ttu-id="42aff-380">Copiar arquivos entre os armazenamentos de dados baseados em arquivos:</span><span class="sxs-lookup"><span data-stu-id="42aff-380">Copying files between file-based data stores:</span></span>
  * <span data-ttu-id="42aff-381">Quando os conjuntos de dados de entrada e saídos têm Olá mesmo ou não as configurações de formato de arquivo, o serviço de movimentação de dados Olá executa uma cópia do binária sem serialização ou desserialização.</span><span class="sxs-lookup"><span data-stu-id="42aff-381">When input and output data sets both have hello same or no file format settings, hello data movement service executes a binary copy without any serialization or deserialization.</span></span> <span data-ttu-id="42aff-382">Você verá um cenário de toohello comparado de taxa de transferência maior, na qual Olá configurações de formato de arquivo de origem e o coletor são diferentes uns dos outros.</span><span class="sxs-lookup"><span data-stu-id="42aff-382">You see a higher throughput compared toohello scenario, in which hello source and sink file format settings are different from each other.</span></span>
  * <span data-ttu-id="42aff-383">Quando a entrada e saída conjuntos de dados os dois são no formato de texto e a codificação de saudação somente tipo é diferente, o serviço de movimentação de dados Olá só faz a conversão de codificação.</span><span class="sxs-lookup"><span data-stu-id="42aff-383">When input and output data sets both are in text format and only hello encoding type is different, hello data movement service only does encoding conversion.</span></span> <span data-ttu-id="42aff-384">Ela não faz qualquer serialização e desserialização, o que faz com que alguns sobrecarga de desempenho em comparação com cópia de tooa binário.</span><span class="sxs-lookup"><span data-stu-id="42aff-384">It doesn't do any serialization and deserialization, which causes some performance overhead compared tooa binary copy.</span></span>
  * <span data-ttu-id="42aff-385">Quando a entrada e saídos conjuntos de dados ambos têm diferentes formatos de arquivos ou configurações diferentes, como delimitadores, Olá serviço de movimentação de dados desserializa toostream de dados de origem, transformação e, em seguida, serializá-lo no formato de saída de hello indicado.</span><span class="sxs-lookup"><span data-stu-id="42aff-385">When input and output data sets both have different file formats or different configurations, like delimiters, hello data movement service deserializes source data toostream, transform, and then serialize it into hello output format you indicated.</span></span> <span data-ttu-id="42aff-386">Essa operação resulta em uma sobrecarga muito mais significativos de desempenho em comparação com tooother cenários.</span><span class="sxs-lookup"><span data-stu-id="42aff-386">This operation results in a much more significant performance overhead compared tooother scenarios.</span></span>
* <span data-ttu-id="42aff-387">Quando você copia arquivos para/de um repositório de dados que não seja baseado em arquivo (por exemplo, de um armazenamento baseado em arquivo tooa repositório relacional), a etapa de serialização ou desserialização de saudação é necessária.</span><span class="sxs-lookup"><span data-stu-id="42aff-387">When you copy files to/from a data store that is not file-based (for example, from a file-based store tooa relational store), hello serialization or deserialization step is required.</span></span> <span data-ttu-id="42aff-388">Essa etapa resulta em uma sobrecarga significativa do desempenho.</span><span class="sxs-lookup"><span data-stu-id="42aff-388">This step results in significant performance overhead.</span></span>

<span data-ttu-id="42aff-389">**Formato de arquivo**: formato de arquivo hello escolhido pode afetar o desempenho de cópia.</span><span class="sxs-lookup"><span data-stu-id="42aff-389">**File format**: hello file format you choose might affect copy performance.</span></span> <span data-ttu-id="42aff-390">Por exemplo, Avro é um formato binário compacto que armazena metadados com dados.</span><span class="sxs-lookup"><span data-stu-id="42aff-390">For example, Avro is a compact binary format that stores metadata with data.</span></span> <span data-ttu-id="42aff-391">Ele tem suporte amplo ecossistema de Hadoop Olá para processamento e consulta.</span><span class="sxs-lookup"><span data-stu-id="42aff-391">It has broad support in hello Hadoop ecosystem for processing and querying.</span></span> <span data-ttu-id="42aff-392">No entanto, Avro é mais caro para serialização e desserialização, o que resulta em menor taxa de transferência de cópia em comparação com o formato de tootext.</span><span class="sxs-lookup"><span data-stu-id="42aff-392">However, Avro is more expensive for serialization and deserialization, which results in lower copy throughput compared tootext format.</span></span> <span data-ttu-id="42aff-393">Verifique o formato de arquivo durante a saudação todo o fluxo de processamento de sua escolha.</span><span class="sxs-lookup"><span data-stu-id="42aff-393">Make your choice of file format throughout hello processing flow holistically.</span></span> <span data-ttu-id="42aff-394">Começar com os dados de saudação do formulário são armazenados no, repositórios de dados ou toobe extraídos dos sistemas externos; de origem melhor formato Olá para armazenamento, processamento analítico e consulta; e, em que formato dados saudação devem ser exportados em armazéns de dados para as ferramentas de relatório e visualização.</span><span class="sxs-lookup"><span data-stu-id="42aff-394">Start with what form hello data is stored in, source data stores or toobe extracted from external systems; hello best format for storage, analytical processing, and querying; and in what format hello data should be exported into data marts for reporting and visualization tools.</span></span> <span data-ttu-id="42aff-395">Às vezes, de um formato de arquivo que está abaixo do ideal para leitura e gravação de desempenho pode ser uma boa opção quando você considera Olá geral analíticos processo.</span><span class="sxs-lookup"><span data-stu-id="42aff-395">Sometimes a file format that is suboptimal for read and write performance might be a good choice when you consider hello overall analytical process.</span></span>

## <a name="considerations-for-compression"></a><span data-ttu-id="42aff-396">Considerações da compactação</span><span class="sxs-lookup"><span data-stu-id="42aff-396">Considerations for compression</span></span>
<span data-ttu-id="42aff-397">Quando o conjunto de dados de entrada ou saído é um arquivo, você pode definir atividade de cópia tooperform compactação ou descompactação conforme ele grava o destino de toohello de dados.</span><span class="sxs-lookup"><span data-stu-id="42aff-397">When your input or output data set is a file, you can set Copy Activity tooperform compression or decompression as it writes data toohello destination.</span></span> <span data-ttu-id="42aff-398">Quando você escolher a compactação, faça uma compensação entre a entrada/saída (E/S) e a CPU.</span><span class="sxs-lookup"><span data-stu-id="42aff-398">When you choose compression, you make a tradeoff between input/output (I/O) and CPU.</span></span> <span data-ttu-id="42aff-399">A compactação de dados Olá custos extras em recursos de computação.</span><span class="sxs-lookup"><span data-stu-id="42aff-399">Compressing hello data costs extra in compute resources.</span></span> <span data-ttu-id="42aff-400">Mas, por sua vez, reduz a E/S da rede e o armazenamento.</span><span class="sxs-lookup"><span data-stu-id="42aff-400">But in return, it reduces network I/O and storage.</span></span> <span data-ttu-id="42aff-401">Dependendo de seus dados, você poderá ver um aumento na taxa de transferência geral da cópia.</span><span class="sxs-lookup"><span data-stu-id="42aff-401">Depending on your data, you may see a boost in overall copy throughput.</span></span>

<span data-ttu-id="42aff-402">**Codec**: a atividade de cópia suporta gzip, bzip2 e os tipos de compactação Deflate.</span><span class="sxs-lookup"><span data-stu-id="42aff-402">**Codec**: Copy Activity supports gzip, bzip2, and Deflate compression types.</span></span> <span data-ttu-id="42aff-403">O Azure HDInsight pode consumir todos os três tipos de processamento.</span><span class="sxs-lookup"><span data-stu-id="42aff-403">Azure HDInsight can consume all three types for processing.</span></span> <span data-ttu-id="42aff-404">Cada codec de compactação tem suas vantagens.</span><span class="sxs-lookup"><span data-stu-id="42aff-404">Each compression codec has advantages.</span></span> <span data-ttu-id="42aff-405">Por exemplo, bzip2 tem a taxa de transferência de cópia de menor hello, mas obter Olá melhor Hive desempenho de consulta com bzip2 porque você pode dividi-lo para processamento.</span><span class="sxs-lookup"><span data-stu-id="42aff-405">For example, bzip2 has hello lowest copy throughput, but you get hello best Hive query performance with bzip2 because you can split it for processing.</span></span> <span data-ttu-id="42aff-406">Gzip é a opção de hello mais balanceada e ele é usado com mais frequência hello.</span><span class="sxs-lookup"><span data-stu-id="42aff-406">Gzip is hello most balanced option, and it is used hello most often.</span></span> <span data-ttu-id="42aff-407">Escolha o codec hello mais adequada para seu cenário de ponta a ponta.</span><span class="sxs-lookup"><span data-stu-id="42aff-407">Choose hello codec that best suits your end-to-end scenario.</span></span>

<span data-ttu-id="42aff-408">**Nível**: você pode escolher entre duas opções para cada codec de compactação: compactado mais rápido e compactado ideal.</span><span class="sxs-lookup"><span data-stu-id="42aff-408">**Level**: You can choose from two options for each compression codec: fastest compressed and optimally compressed.</span></span> <span data-ttu-id="42aff-409">Hello mais rápida compactada opção compacta dados saudação assim que possível, mesmo se o arquivo resultante Olá ideal não é compactado.</span><span class="sxs-lookup"><span data-stu-id="42aff-409">hello fastest compressed option compresses hello data as quickly as possible, even if hello resulting file is not optimally compressed.</span></span> <span data-ttu-id="42aff-410">Hello opção ideal compactada gasta mais tempo na compactação e produz uma quantidade mínima de dados.</span><span class="sxs-lookup"><span data-stu-id="42aff-410">hello optimally compressed option spends more time on compression and yields a minimal amount of data.</span></span> <span data-ttu-id="42aff-411">Você pode testar toosee ambas as opções que fornece melhor desempenho no seu caso.</span><span class="sxs-lookup"><span data-stu-id="42aff-411">You can test both options toosee which provides better overall performance in your case.</span></span>

<span data-ttu-id="42aff-412">**Uma consideração**: toocopy uma grande quantidade de dados entre um repositório local e nuvem hello, considere o uso de armazenamento de blob provisório com a compactação.</span><span class="sxs-lookup"><span data-stu-id="42aff-412">**A consideration**: toocopy a large amount of data between an on-premises store and hello cloud, consider using interim blob storage with compression.</span></span> <span data-ttu-id="42aff-413">Usando o armazenamento provisório é útil quando a largura de banda de saudação de sua rede corporativa e os serviços do Azure é o fator limitante Olá e desejar que o conjunto de dados de entrada hello e ambas as toobe do conjunto de dados de saída em formato descompactado.</span><span class="sxs-lookup"><span data-stu-id="42aff-413">Using interim storage is helpful when hello bandwidth of your corporate network and your Azure services is hello limiting factor, and you want hello input data set and output data set both toobe in uncompressed form.</span></span> <span data-ttu-id="42aff-414">Mais especificamente, é possível dividir uma atividade de cópia única em duas atividades de cópia.</span><span class="sxs-lookup"><span data-stu-id="42aff-414">More specifically, you can break a single copy activity into two copy activities.</span></span> <span data-ttu-id="42aff-415">Olá primeiro copiar atividade copia da provisória do hello fonte tooan ou preparo blob em formato compactado.</span><span class="sxs-lookup"><span data-stu-id="42aff-415">hello first copy activity copies from hello source tooan interim or staging blob in compressed form.</span></span> <span data-ttu-id="42aff-416">atividade de cópia segundo Olá copia dados compactado de saudação do preparo e descompacta enquanto grava toohello coletor.</span><span class="sxs-lookup"><span data-stu-id="42aff-416">hello second copy activity copies hello compressed data from staging, and then decompresses while it writes toohello sink.</span></span>

## <a name="considerations-for-column-mapping"></a><span data-ttu-id="42aff-417">Considerações do mapeamento de coluna</span><span class="sxs-lookup"><span data-stu-id="42aff-417">Considerations for column mapping</span></span>
<span data-ttu-id="42aff-418">Você pode definir Olá **columnMappings** propriedade na atividade de cópia toomap todos ou um subconjunto de saudação colunas de saída toohello colunas de entrada.</span><span class="sxs-lookup"><span data-stu-id="42aff-418">You can set hello **columnMappings** property in Copy Activity toomap all or a subset of hello input columns toohello output columns.</span></span> <span data-ttu-id="42aff-419">Depois que o serviço de movimentação de dados Olá lê dados de saudação de fonte de hello, ele precisa tooperform mapeamento de coluna nos dados de saudação antes de gravar Olá dados toohello coletor.</span><span class="sxs-lookup"><span data-stu-id="42aff-419">After hello data movement service reads hello data from hello source, it needs tooperform column mapping on hello data before it writes hello data toohello sink.</span></span> <span data-ttu-id="42aff-420">Esse processamento extra reduz a taxa de transferência de cópia.</span><span class="sxs-lookup"><span data-stu-id="42aff-420">This extra processing reduces copy throughput.</span></span>

<span data-ttu-id="42aff-421">Se o repositório de dados de origem é passível de consulta, por exemplo, se é um repositório relacional, como banco de dados SQL ou SQL Server, ou se é um repositório NoSQL, como o armazenamento de tabela ou banco de dados do Azure Cosmos, considerar enviar por push Olá filtragem de coluna e reordenação lógica toohello **consulta**  propriedade em vez de usar o mapeamento de coluna.</span><span class="sxs-lookup"><span data-stu-id="42aff-421">If your source data store is queryable, for example, if it's a relational store like SQL Database or SQL Server, or if it's a NoSQL store like Table storage or Azure Cosmos DB, consider pushing hello column filtering and reordering logic toohello **query** property instead of using column mapping.</span></span> <span data-ttu-id="42aff-422">Dessa forma, a projeção de saudação ocorre enquanto o serviço de movimentação de dados Olá lê dos dados de origem de saudação do repositório de dados, onde ele é muito mais eficiente.</span><span class="sxs-lookup"><span data-stu-id="42aff-422">This way, hello projection occurs while hello data movement service reads data from hello source data store, where it is much more efficient.</span></span>

## <a name="other-considerations"></a><span data-ttu-id="42aff-423">Outras considerações</span><span class="sxs-lookup"><span data-stu-id="42aff-423">Other considerations</span></span>
<span data-ttu-id="42aff-424">Se hello tamanho dos dados que você deseja toocopy é grande, você pode ajustar sua toofurther partição Olá dados de lógica comercial usando Olá dividindo o mecanismo de fábrica de dados.</span><span class="sxs-lookup"><span data-stu-id="42aff-424">If hello size of data you want toocopy is large, you can adjust your business logic toofurther partition hello data using hello slicing mechanism in Data Factory.</span></span> <span data-ttu-id="42aff-425">Em seguida, agende atividade de cópia toorun com mais frequência do tamanho dos dados tooreduce Olá para cada atividade de cópia é executado.</span><span class="sxs-lookup"><span data-stu-id="42aff-425">Then, schedule Copy Activity toorun more frequently tooreduce hello data size for each Copy Activity run.</span></span>

<span data-ttu-id="42aff-426">Seja cuidadoso ao número de saudação de conjuntos de dados e atividades de cópia que exigem a fábrica de dados tooconnector toohello mesmo repositório de dados em Olá mesmo tempo.</span><span class="sxs-lookup"><span data-stu-id="42aff-426">Be cautious about hello number of data sets and copy activities requiring Data Factory tooconnector toohello same data store at hello same time.</span></span> <span data-ttu-id="42aff-427">Número de trabalhos de cópia simultânea pode limitar um repositório de dados e levar toodegraded desempenho, copie as repetições internas do trabalho e, em alguns casos, falhas de execução.</span><span class="sxs-lookup"><span data-stu-id="42aff-427">Many concurrent copy jobs might throttle a data store and lead toodegraded performance, copy job internal retries, and in some cases, execution failures.</span></span>

## <a name="sample-scenario-copy-from-an-on-premises-sql-server-tooblob-storage"></a><span data-ttu-id="42aff-428">Exemplo de cenário: cópia de um armazenamento de tooBlob do SQL Server local</span><span class="sxs-lookup"><span data-stu-id="42aff-428">Sample scenario: Copy from an on-premises SQL Server tooBlob storage</span></span>
<span data-ttu-id="42aff-429">**Cenário**: um pipeline é criado toocopy dados de um armazenamento de tooBlob do SQL Server local no formato CSV.</span><span class="sxs-lookup"><span data-stu-id="42aff-429">**Scenario**: A pipeline is built toocopy data from an on-premises SQL Server tooBlob storage in CSV format.</span></span> <span data-ttu-id="42aff-430">toomake Olá o trabalho de cópia mais rapidamente, os arquivos CSV Olá devem ser compactados no formato bzip2.</span><span class="sxs-lookup"><span data-stu-id="42aff-430">toomake hello copy job faster, hello CSV files should be compressed into bzip2 format.</span></span>

<span data-ttu-id="42aff-431">**Teste e análise**: taxa de transferência de saudação de atividade de cópia é menor que 2 MBps, que é muito mais lento do que o parâmetro de comparação de desempenho de saudação.</span><span class="sxs-lookup"><span data-stu-id="42aff-431">**Test and analysis**: hello throughput of Copy Activity is less than 2 MBps, which is much slower than hello performance benchmark.</span></span>

<span data-ttu-id="42aff-432">**Análise de desempenho e ajuste**: tootroubleshoot Olá problema de desempenho, vamos dar uma olhada em como os dados de saudação forem processados e movidos.</span><span class="sxs-lookup"><span data-stu-id="42aff-432">**Performance analysis and tuning**: tootroubleshoot hello performance issue, let’s look at how hello data is processed and moved.</span></span>

1. <span data-ttu-id="42aff-433">**Ler dados**: Gateway abre uma conexão tooSQL servidor e envia Olá consulta.</span><span class="sxs-lookup"><span data-stu-id="42aff-433">**Read data**: Gateway opens a connection tooSQL Server and sends hello query.</span></span> <span data-ttu-id="42aff-434">SQL Server responde enviando Olá tooGateway de fluxo de dados via intranet hello.</span><span class="sxs-lookup"><span data-stu-id="42aff-434">SQL Server responds by sending hello data stream tooGateway via hello intranet.</span></span>
2. <span data-ttu-id="42aff-435">**Serializar e compactar dados**: Gateway serializa o formato de tooCSV de fluxo de dados hello e compacta Olá bzip2 de tooa TDS.</span><span class="sxs-lookup"><span data-stu-id="42aff-435">**Serialize and compress data**: Gateway serializes hello data stream tooCSV format, and compresses hello data tooa bzip2 stream.</span></span>
3. <span data-ttu-id="42aff-436">**Gravar dados**: Gateway carrega o armazenamento de tooBlob de fluxo Olá bzip2 via Olá da Internet.</span><span class="sxs-lookup"><span data-stu-id="42aff-436">**Write data**: Gateway uploads hello bzip2 stream tooBlob storage via hello Internet.</span></span>

<span data-ttu-id="42aff-437">Como você pode ver, dados de saudação estão sendo processados e movidos de maneira sequencial streaming: SQL Server > LAN > Gateway > WAN > armazenamento de Blob.</span><span class="sxs-lookup"><span data-stu-id="42aff-437">As you can see, hello data is being processed and moved in a streaming sequential manner: SQL Server > LAN > Gateway > WAN > Blob storage.</span></span> <span data-ttu-id="42aff-438">**Olá desempenho geral é retido por taxa de transferência mínima Olá em pipeline Olá**.</span><span class="sxs-lookup"><span data-stu-id="42aff-438">**hello overall performance is gated by hello minimum throughput across hello pipeline**.</span></span>

![Fluxo de dados](./media/data-factory-copy-activity-performance/case-study-pic-1.png)

<span data-ttu-id="42aff-440">Um ou mais dos Olá fatores a seguir podem causar o afunilamento de desempenho hello:</span><span class="sxs-lookup"><span data-stu-id="42aff-440">One or more of hello following factors might cause hello performance bottleneck:</span></span>

* <span data-ttu-id="42aff-441">**Origem:**o próprio SQL Server tem uma baixa taxa de transferência devido às cargas pesadas.</span><span class="sxs-lookup"><span data-stu-id="42aff-441">**Source**: SQL Server itself has low throughput because of heavy loads.</span></span>
* <span data-ttu-id="42aff-442">**Gateway de Gerenciamento de Dados**:</span><span class="sxs-lookup"><span data-stu-id="42aff-442">**Data Management Gateway**:</span></span>
  * <span data-ttu-id="42aff-443">**LAN**: Gateway está localizado distantes de máquina do SQL Server hello e tem uma conexão de baixa largura de banda.</span><span class="sxs-lookup"><span data-stu-id="42aff-443">**LAN**: Gateway is located far from hello SQL Server machine and has a low-bandwidth connection.</span></span>
  * <span data-ttu-id="42aff-444">**Gateway**: Gateway atingiu seu Olá de tooperform carga limitações seguintes operações:</span><span class="sxs-lookup"><span data-stu-id="42aff-444">**Gateway**: Gateway has reached its load limitations tooperform hello following operations:</span></span>
    * <span data-ttu-id="42aff-445">**Serialização**: Olá tooCSV de fluxo de dados de serialização formato tem taxa de transferência lenta.</span><span class="sxs-lookup"><span data-stu-id="42aff-445">**Serialization**: Serializing hello data stream tooCSV format has slow throughput.</span></span>
    * <span data-ttu-id="42aff-446">**Compactação**: você escolheu um codec de compactação lenta (por exemplo, bzip2, que é 2.8 MBps com Core i7).</span><span class="sxs-lookup"><span data-stu-id="42aff-446">**Compression**: You chose a slow compression codec (for example, bzip2, which is 2.8 MBps with Core i7).</span></span>
  * <span data-ttu-id="42aff-447">**WAN**: largura de banda de saudação entre a rede corporativa hello e os serviços do Azure é baixa (por exemplo, T1 = 1,544 kbps; T2 = 6,312 kbps).</span><span class="sxs-lookup"><span data-stu-id="42aff-447">**WAN**: hello bandwidth between hello corporate network and your Azure services is low (for example, T1 = 1,544 kbps; T2 = 6,312 kbps).</span></span>
* <span data-ttu-id="42aff-448">**Coletor**: o armazenamento de Blobs tem baixa taxa de transferência.</span><span class="sxs-lookup"><span data-stu-id="42aff-448">**Sink**: Blob storage has low throughput.</span></span> <span data-ttu-id="42aff-449">(Esse cenário é improvável porque seu SLA garante um mínimo de 60 MBps.)</span><span class="sxs-lookup"><span data-stu-id="42aff-449">(This scenario is unlikely because its SLA guarantees a minimum of 60 MBps.)</span></span>

<span data-ttu-id="42aff-450">Nesse caso, bzip2 compactação de dados pode ser lento pipeline toda hello.</span><span class="sxs-lookup"><span data-stu-id="42aff-450">In this case, bzip2 data compression might be slowing down hello entire pipeline.</span></span> <span data-ttu-id="42aff-451">Alternância de codec de compactação gzip tooa pode facilitar esse afunilamento.</span><span class="sxs-lookup"><span data-stu-id="42aff-451">Switching tooa gzip compression codec might ease this bottleneck.</span></span>

## <a name="sample-scenarios-use-parallel-copy"></a><span data-ttu-id="42aff-452">Cenários de exemplo: usar cópia paralela</span><span class="sxs-lookup"><span data-stu-id="42aff-452">Sample scenarios: Use parallel copy</span></span>
<span data-ttu-id="42aff-453">**Cenário i:** copiar 1.000 arquivos de 1 MB de armazenamento tooBlob de sistema de arquivos do Olá local.</span><span class="sxs-lookup"><span data-stu-id="42aff-453">**Scenario I:** Copy 1,000 1-MB files from hello on-premises file system tooBlob storage.</span></span>

<span data-ttu-id="42aff-454">**Análise e ajuste de desempenho**: por exemplo, se você tiver instalado o gateway em um computador quad-core, fábrica de dados usa 16 cópias paralelas toomove arquivos de armazenamento de tooBlob do sistema de arquivo hello simultaneamente.</span><span class="sxs-lookup"><span data-stu-id="42aff-454">**Analysis and performance tuning**: For an example, if you have installed gateway on a quad core machine, Data Factory uses 16 parallel copies toomove files from hello file system tooBlob storage concurrently.</span></span> <span data-ttu-id="42aff-455">Essa execução paralela deve resultar em alta taxa de transferência.</span><span class="sxs-lookup"><span data-stu-id="42aff-455">This parallel execution should result in high throughput.</span></span> <span data-ttu-id="42aff-456">Você também pode especificar explicitamente Olá contagem de cópias paralelas.</span><span class="sxs-lookup"><span data-stu-id="42aff-456">You also can explicitly specify hello parallel copies count.</span></span> <span data-ttu-id="42aff-457">Ao copiar muitos arquivos pequenos, as cópias paralelas ajudam muito a taxa de transferência usando os recursos com mais eficiência.</span><span class="sxs-lookup"><span data-stu-id="42aff-457">When you copy many small files, parallel copies dramatically help throughput by using resources more effectively.</span></span>

![Cenário 1](./media/data-factory-copy-activity-performance/scenario-1.png)

<span data-ttu-id="42aff-459">**Cenário II**: copiar 20 blobs de 500 MB de armazenamento de Blob tooData Lake análise de armazenamento e, em seguida, ajustar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="42aff-459">**Scenario II**: Copy 20 blobs of 500 MB each from Blob storage tooData Lake Store Analytics, and then tune performance.</span></span>

<span data-ttu-id="42aff-460">**Análise e ajuste de desempenho**: nesse cenário, fábrica de dados copia dados de saudação do repositório do Blob storage tooData Lake usando cópia única (**parallelCopies** definir too1) e unidades de movimentação de dados de nuvem único.</span><span class="sxs-lookup"><span data-stu-id="42aff-460">**Analysis and performance tuning**: In this scenario, Data Factory copies hello data from Blob storage tooData Lake Store by using single-copy (**parallelCopies** set too1) and single-cloud data movement units.</span></span> <span data-ttu-id="42aff-461">Olá taxa de transferência você observar vai ser fechar toothat descrito em hello [seção de referência de desempenho](#performance-reference).</span><span class="sxs-lookup"><span data-stu-id="42aff-461">hello throughput you observe will be close toothat described in hello [performance reference section](#performance-reference).</span></span>   

![Cenário 2](./media/data-factory-copy-activity-performance/scenario-2.png)

<span data-ttu-id="42aff-463">**Cenário III**: o tamanho de arquivo Individual é maior que dezenas de MBs e o volume total é grande.</span><span class="sxs-lookup"><span data-stu-id="42aff-463">**Scenario III**: Individual file size is greater than dozens of MBs and total volume is large.</span></span>

<span data-ttu-id="42aff-464">**Análise e ajuste de desempenho**: aumentando **parallelCopies** não resulta em um melhor desempenho de cópia devido a limitações de recursos de saudação do DMU de — única nuvem.</span><span class="sxs-lookup"><span data-stu-id="42aff-464">**Analysis and performance turning**: Increasing **parallelCopies** doesn't result in better copy performance because of hello resource limitations of a single-cloud DMU.</span></span> <span data-ttu-id="42aff-465">Em vez disso, você deve especificar mais nuvem DMUs tooget mais recursos tooperform Olá a movimentação de dados.</span><span class="sxs-lookup"><span data-stu-id="42aff-465">Instead, you should specify more cloud DMUs tooget more resources tooperform hello data movement.</span></span> <span data-ttu-id="42aff-466">Não especifique um valor para Olá **parallelCopies** propriedade.</span><span class="sxs-lookup"><span data-stu-id="42aff-466">Do not specify a value for hello **parallelCopies** property.</span></span> <span data-ttu-id="42aff-467">Fábrica de dados controla o paralelismo Olá para você.</span><span class="sxs-lookup"><span data-stu-id="42aff-467">Data Factory handles hello parallelism for you.</span></span> <span data-ttu-id="42aff-468">Nesse caso, se você definir **cloudDataMovementUnits** too4, uma taxa de transferência sobre quatro vezes ocorre.</span><span class="sxs-lookup"><span data-stu-id="42aff-468">In this case, if you set **cloudDataMovementUnits** too4, a throughput of about four times occurs.</span></span>

![Cenário 3](./media/data-factory-copy-activity-performance/scenario-3.png)

## <a name="reference"></a><span data-ttu-id="42aff-470">Referência</span><span class="sxs-lookup"><span data-stu-id="42aff-470">Reference</span></span>
<span data-ttu-id="42aff-471">Aqui estão monitoramento de desempenho e ajuste as referências para alguns armazenamentos de dados de saudação com suporte:</span><span class="sxs-lookup"><span data-stu-id="42aff-471">Here are performance monitoring and tuning references for some of hello supported data stores:</span></span>

* <span data-ttu-id="42aff-472">Armazenamento do Azure (incluindo o armazenamento de Blobs e o armazenamento de Tabelas): [metas de escalabilidade do Armazenamento do Azure](../storage/common/storage-scalability-targets.md) e [Lista de verificação de escalabilidade e desempenho do Armazenamento do Azure](../storage/common/storage-performance-checklist.md)</span><span class="sxs-lookup"><span data-stu-id="42aff-472">Azure Storage (including Blob storage and Table storage): [Azure Storage scalability targets](../storage/common/storage-scalability-targets.md) and [Azure Storage performance and scalability checklist](../storage/common/storage-performance-checklist.md)</span></span>
* <span data-ttu-id="42aff-473">Banco de dados SQL do Azure: Você pode [monitorar o desempenho de saudação](../sql-database/sql-database-single-database-monitor.md) e verifica a porcentagem DTU (unidade) de transação de banco de dados de saudação</span><span class="sxs-lookup"><span data-stu-id="42aff-473">Azure SQL Database: You can [monitor hello performance](../sql-database/sql-database-single-database-monitor.md) and check hello database transaction unit (DTU) percentage</span></span>
* <span data-ttu-id="42aff-474">SQL Data Warehouse do Azure: Sua capacidade é medida em unidades de data warehouse (DWUs); consulte [Gerenciar poder de computação no SQL Data Warehouse do Azure (Visão Geral)](../sql-data-warehouse/sql-data-warehouse-manage-compute-overview.md)</span><span class="sxs-lookup"><span data-stu-id="42aff-474">Azure SQL Data Warehouse: Its capability is measured in data warehouse units (DWUs); see [Manage compute power in Azure SQL Data Warehouse (Overview)](../sql-data-warehouse/sql-data-warehouse-manage-compute-overview.md)</span></span>
* <span data-ttu-id="42aff-475">Azure Cosmos DB: [níveis de desempenho no Azure Cosmos DB](../documentdb/documentdb-performance-levels.md)</span><span class="sxs-lookup"><span data-stu-id="42aff-475">Azure Cosmos DB: [Performance levels in Azure Cosmos DB](../documentdb/documentdb-performance-levels.md)</span></span>
* <span data-ttu-id="42aff-476">SQL Server local: [monitoramento e ajuste do desempenho](https://msdn.microsoft.com/library/ms189081.aspx)</span><span class="sxs-lookup"><span data-stu-id="42aff-476">On-premises SQL Server: [Monitor and tune for performance](https://msdn.microsoft.com/library/ms189081.aspx)</span></span>
* <span data-ttu-id="42aff-477">Servidor de arquivos local: [ajuste de desempenho para servidores de arquivos](https://msdn.microsoft.com/library/dn567661.aspx)</span><span class="sxs-lookup"><span data-stu-id="42aff-477">On-premises file server: [Performance tuning for file servers](https://msdn.microsoft.com/library/dn567661.aspx)</span></span>
