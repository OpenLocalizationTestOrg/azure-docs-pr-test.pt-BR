---
title: "Roteamento assimétrico | Microsoft Docs"
description: "Este artigo aborda os problemas que um cliente pode enfrentar no roteamento assimétrico em uma rede que tem vários links para um destino."
documentationcenter: na
services: expressroute
author: osamazia
manager: carmonm
editor: 
ms.assetid: a754bff9-95c9-44b5-9796-377fc21e8322
ms.service: expressroute
ms.devlang: na
ms.topic: get-started-article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 10/10/2016
ms.author: osamam
ms.openlocfilehash: 8568c13d2834a0643e15ab1814a35c92123837d1
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 07/11/2017
---
# <a name="asymmetric-routing-with-multiple-network-paths"></a><span data-ttu-id="6be0d-103">Roteamento assimétrico com vários caminhos de rede</span><span class="sxs-lookup"><span data-stu-id="6be0d-103">Asymmetric routing with multiple network paths</span></span>
<span data-ttu-id="6be0d-104">Este artigo explica como o encaminhamento e o retorno do tráfego de rede podem adotar rotas diferentes quando há vários caminhos disponíveis entre a origem e o destino da rede.</span><span class="sxs-lookup"><span data-stu-id="6be0d-104">This article explains how forward and return network traffic might take different routes when multiple paths are available between network source and destination.</span></span>

<span data-ttu-id="6be0d-105">É importante entender os dois conceitos para compreender o roteamento assimétrico.</span><span class="sxs-lookup"><span data-stu-id="6be0d-105">It's important to understand two concepts to understand asymmetric routing.</span></span> <span data-ttu-id="6be0d-106">Um deles é o efeito de vários caminhos de rede.</span><span class="sxs-lookup"><span data-stu-id="6be0d-106">One is the effect of multiple network paths.</span></span> <span data-ttu-id="6be0d-107">O outro é como os dispositivos, como um firewall, mantêm o estado.</span><span class="sxs-lookup"><span data-stu-id="6be0d-107">The other is how devices, like a firewall, keep state.</span></span> <span data-ttu-id="6be0d-108">Esses tipos de dispositivos são chamados de dispositivos com estado.</span><span class="sxs-lookup"><span data-stu-id="6be0d-108">These types of devices are called stateful devices.</span></span> <span data-ttu-id="6be0d-109">Uma combinação desses dois fatores cria cenários nos quais o tráfego da rede é descartado por um dispositivo com estado porque tal dispositivo não detectou que o tráfego originou-se no próprio dispositivo.</span><span class="sxs-lookup"><span data-stu-id="6be0d-109">A combination of these two factors creates scenarios in which network traffic is dropped by a stateful device because the stateful device didn't detect that traffic originated with the device itself.</span></span>

## <a name="multiple-network-paths"></a><span data-ttu-id="6be0d-110">Vários caminhos de rede</span><span class="sxs-lookup"><span data-stu-id="6be0d-110">Multiple network paths</span></span>
<span data-ttu-id="6be0d-111">Quando uma rede corporativa tem apenas um link com a Internet através de seu provedor de serviços de Internet, todo o tráfego para e da Internet percorre o mesmo caminho.</span><span class="sxs-lookup"><span data-stu-id="6be0d-111">When an enterprise network has only one link to the Internet through their Internet service provider, all traffic to and from the Internet travels the same path.</span></span> <span data-ttu-id="6be0d-112">Geralmente, as empresas adquirem vários circuitos, como caminhos redundantes, para melhorar o tempo de atividade de rede.</span><span class="sxs-lookup"><span data-stu-id="6be0d-112">Often, companies purchase multiple circuits, as redundant paths, to improve network uptime.</span></span> <span data-ttu-id="6be0d-113">Nesses casos, é possível que o tráfego que vai para fora da rede, em direção à Internet, passe por um link, enquanto o tráfego de retorno passa por um link diferente.</span><span class="sxs-lookup"><span data-stu-id="6be0d-113">When this happens, it's possible that traffic that goes outside of the network, to the Internet, goes through one link, and the return traffic goes through a different link.</span></span> <span data-ttu-id="6be0d-114">Isso é conhecido como roteamento assimétrico.</span><span class="sxs-lookup"><span data-stu-id="6be0d-114">This is commonly known as asymmetric routing.</span></span> <span data-ttu-id="6be0d-115">No roteamento assimétrico, tráfego de rede inversa pega um caminho diferente do fluxo original.</span><span class="sxs-lookup"><span data-stu-id="6be0d-115">In asymmetric routing, reverse network traffic takes a different path from the original flow.</span></span>

![Rede com vários caminhos](./media/expressroute-asymmetric-routing/AsymmetricRouting3.png)

<span data-ttu-id="6be0d-117">Embora ocorra principalmente na Internet, o roteamento assimétrico também se aplica a outras combinações de vários caminhos.</span><span class="sxs-lookup"><span data-stu-id="6be0d-117">Although it primarily occurs on the Internet, asymmetric routing also applies to other combinations of multiple paths.</span></span> <span data-ttu-id="6be0d-118">Por exemplo, ele se aplica a um caminho da Internet e a um caminho privado que vai para o mesmo destino, e a vários caminhos privados para vão para o mesmo destino.</span><span class="sxs-lookup"><span data-stu-id="6be0d-118">It applies, for example, both to an Internet path and a private path that go to the same destination, and to multiple private paths that go to the same destination.</span></span>

<span data-ttu-id="6be0d-119">Cada roteador no caminho, da origem ao destino, calcula o melhor caminho para alcançar um destino.</span><span class="sxs-lookup"><span data-stu-id="6be0d-119">Each router along the way, from source to destination, computes the best path to reach a destination.</span></span> <span data-ttu-id="6be0d-120">A determinação do roteador para o melhor caminho possível baseia-se em dois fatores principais:</span><span class="sxs-lookup"><span data-stu-id="6be0d-120">The router's determination of best possible path is based on two main factors:</span></span>

* <span data-ttu-id="6be0d-121">O roteamento entre as redes externas é baseado em um protocolo de roteamento, BGP (Border Gateway Protocol).</span><span class="sxs-lookup"><span data-stu-id="6be0d-121">Routing between external networks is based on a routing protocol, Border Gateway Protocol (BGP).</span></span> <span data-ttu-id="6be0d-122">O BGP obtém os anúncios dos vizinhos e executa-os com várias etapas para determinar o melhor caminho para o destino pretendido.</span><span class="sxs-lookup"><span data-stu-id="6be0d-122">BGP takes advertisements from neighbors and runs them through a series of steps to determine the best path to the intended destination.</span></span> <span data-ttu-id="6be0d-123">Ele armazena o melhor caminho em sua tabela de roteamento.</span><span class="sxs-lookup"><span data-stu-id="6be0d-123">It stores the best path in its routing table.</span></span>
* <span data-ttu-id="6be0d-124">O comprimento de uma máscara da sub-rede associada a uma rota influencia os caminhos de roteamento.</span><span class="sxs-lookup"><span data-stu-id="6be0d-124">The length of a subnet mask associated with a route influences routing paths.</span></span> <span data-ttu-id="6be0d-125">Se um roteador receber vários anúncios para o mesmo endereço IP, mas com máscaras de sub-rede diferentes, o roteador irá preferir o anúncio com uma máscara de sub-rede maior, pois é considerada uma rota mais específica.</span><span class="sxs-lookup"><span data-stu-id="6be0d-125">If a router receives multiple advertisements for the same IP address but with different subnet masks, the router prefers the advertisement with a longer subnet mask because it's considered a more specific route.</span></span>

## <a name="stateful-devices"></a><span data-ttu-id="6be0d-126">Dispositivos com estado</span><span class="sxs-lookup"><span data-stu-id="6be0d-126">Stateful devices</span></span>
<span data-ttu-id="6be0d-127">Os roteadores examinam o cabeçalho IP de um pacote para fazer o roteamento.</span><span class="sxs-lookup"><span data-stu-id="6be0d-127">Routers look at the IP header of a packet for routing purposes.</span></span> <span data-ttu-id="6be0d-128">Alguns dispositivos verificam ainda mais dentro do pacote.</span><span class="sxs-lookup"><span data-stu-id="6be0d-128">Some devices look even deeper inside the packet.</span></span> <span data-ttu-id="6be0d-129">Normalmente, esses dispositivos examinam os cabeçalhos da Camada4 (Protocolo de Controle de Transmissão - TCP; User Datagram Protocol - UDP) ou até mesmo da Camada7.</span><span class="sxs-lookup"><span data-stu-id="6be0d-129">Typically, these devices look at Layer4 (Transmission Control Protocol, or TCP; or User Datagram Protocol, or UDP), or even Layer7 (Application Layer) headers.</span></span> <span data-ttu-id="6be0d-130">Esses tipos de dispositivos são dispositivos de otimização da largura de banda ou dispositivos de segurança.</span><span class="sxs-lookup"><span data-stu-id="6be0d-130">These kinds of devices are either security devices or bandwidth-optimization devices.</span></span> 

<span data-ttu-id="6be0d-131">O firewall é um exemplo comum de dispositivo com estado.</span><span class="sxs-lookup"><span data-stu-id="6be0d-131">A firewall is a common example of a stateful device.</span></span> <span data-ttu-id="6be0d-132">O firewall permite ou nega a passagem de um pacote nas interfaces com base em vários campos, como protocolo, porta TCP/UDP e cabeçalhos de URL.</span><span class="sxs-lookup"><span data-stu-id="6be0d-132">A firewall allows or denies a packet to pass through its interfaces based on various fields such as protocol, TCP/UDP port, and URL headers.</span></span> <span data-ttu-id="6be0d-133">Esse nível de inspeção de pacotes coloca uma pesada carga de processamento no dispositivo.</span><span class="sxs-lookup"><span data-stu-id="6be0d-133">This level of packet inspection puts a heavy processing load on the device.</span></span> <span data-ttu-id="6be0d-134">Para melhorar o desempenho, o firewall inspeciona o primeiro pacote de um fluxo.</span><span class="sxs-lookup"><span data-stu-id="6be0d-134">To improve performance, the firewall inspects the first packet of a flow.</span></span> <span data-ttu-id="6be0d-135">Se ele permitir que o pacote prossiga, manterá as informações de fluxo em sua tabela de estado.</span><span class="sxs-lookup"><span data-stu-id="6be0d-135">If it allows the packet to proceed, it keeps the flow information in its state table.</span></span> <span data-ttu-id="6be0d-136">Todos os pacotes subsequentes relacionados a esse fluxo serão permitidos com base na determinação inicial.</span><span class="sxs-lookup"><span data-stu-id="6be0d-136">All subsequent packets related to this flow are allowed based on the initial determination.</span></span> <span data-ttu-id="6be0d-137">Um pacote que faz parte de um fluxo existente pode chegar no firewall.</span><span class="sxs-lookup"><span data-stu-id="6be0d-137">A packet that is part of an existing flow might arrive at the firewall.</span></span> <span data-ttu-id="6be0d-138">Se o firewall não tiver nenhuma informação do estado anterior sobre ele, irá descartar o pacote.</span><span class="sxs-lookup"><span data-stu-id="6be0d-138">If the firewall has no prior state information about it, the firewall drops the packet.</span></span>

## <a name="asymmetric-routing-with-expressroute"></a><span data-ttu-id="6be0d-139">Roteamento assimétrico com o ExpressRoute</span><span class="sxs-lookup"><span data-stu-id="6be0d-139">Asymmetric routing with ExpressRoute</span></span>
<span data-ttu-id="6be0d-140">Quando você conecta a Microsoft por meio do ExpressRoute do Azure, sua rede muda da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="6be0d-140">When you connect to Microsoft through Azure ExpressRoute, your network changes like this:</span></span>

* <span data-ttu-id="6be0d-141">Você tem vários links para a Microsoft.</span><span class="sxs-lookup"><span data-stu-id="6be0d-141">You have multiple links to Microsoft.</span></span> <span data-ttu-id="6be0d-142">Um link é sua conexão com a Internet existente e o outro é via ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="6be0d-142">One link is your existing Internet connection, and the other is via ExpressRoute.</span></span> <span data-ttu-id="6be0d-143">Parte do tráfego para a Microsoft pode passar pela Internet, mas voltar por meio do ExpressRoute ou vice-versa.</span><span class="sxs-lookup"><span data-stu-id="6be0d-143">Some traffic to Microsoft might go through the Internet but come back via ExpressRoute, or vice versa.</span></span>
* <span data-ttu-id="6be0d-144">Você recebe endereços IP mais específicos por meio do ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="6be0d-144">You receive more specific IP addresses via ExpressRoute.</span></span> <span data-ttu-id="6be0d-145">Portanto, o tráfego da rede para a Microsoft, para os serviços oferecidos por meio do ExpressRoute, sempre prefere o ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="6be0d-145">So, for traffic from your network to Microsoft for services offered via ExpressRoute, routers always prefer ExpressRoute.</span></span>

<span data-ttu-id="6be0d-146">Para entender o efeito que essas duas alterações têm em uma rede, iremos considerar alguns cenários.</span><span class="sxs-lookup"><span data-stu-id="6be0d-146">To understand the effect these two changes have on a network, let’s consider some scenarios.</span></span> <span data-ttu-id="6be0d-147">Como exemplo, você tem apenas um circuito para a Internet e consome todos os serviços da Microsoft via Internet.</span><span class="sxs-lookup"><span data-stu-id="6be0d-147">As an example, you have only one circuit to the Internet and you consume all Microsoft services via the Internet.</span></span> <span data-ttu-id="6be0d-148">O tráfego de ida e volta de sua rede para a Microsoft atravessa o mesmo link da Internet e passa pelo firewall.</span><span class="sxs-lookup"><span data-stu-id="6be0d-148">The traffic from your network to Microsoft and back traverses the same Internet link and passes through the firewall.</span></span> <span data-ttu-id="6be0d-149">O firewall registra o fluxo ao ver o primeiro pacote e os pacotes de retorno são permitidos porque existe fluxo na tabela de estados.</span><span class="sxs-lookup"><span data-stu-id="6be0d-149">The firewall records the flow as it sees the first packet and return packets are allowed because the flow exists in the state table.</span></span>

![Roteamento assimétrico com o ExpressRoute](./media/expressroute-asymmetric-routing/AsymmetricRouting1.png)

<span data-ttu-id="6be0d-151">Então, você ativa o ExpressRoute e consome os serviços oferecidos pela Microsoft por meio do ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="6be0d-151">Then, you turn on ExpressRoute and consume services offered by Microsoft over ExpressRoute.</span></span> <span data-ttu-id="6be0d-152">Todos os outros serviços da Microsoft são consumidos por meio da Internet.</span><span class="sxs-lookup"><span data-stu-id="6be0d-152">All other services from Microsoft are consumed over the Internet.</span></span> <span data-ttu-id="6be0d-153">Você pode implantar um firewall separado em sua borda conectada à ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="6be0d-153">You deploy a separate firewall at your edge that is connected to ExpressRoute.</span></span> <span data-ttu-id="6be0d-154">A Microsoft anuncia os prefixos mais específicos para sua rede por meio do ExpressRoute dos serviços específicos.</span><span class="sxs-lookup"><span data-stu-id="6be0d-154">Microsoft advertises more specific prefixes to your network over ExpressRoute for specific services.</span></span> <span data-ttu-id="6be0d-155">Sua infraestrutura de roteamento escolhe o ExpressRoute como o caminho preferido desses prefixos.</span><span class="sxs-lookup"><span data-stu-id="6be0d-155">Your routing infrastructure chooses ExpressRoute as the preferred path for those prefixes.</span></span> <span data-ttu-id="6be0d-156">Se você não estiver anunciando seus endereços IP públicos para a Microsoft no ExpressRoute, a Microsoft se comunicará com seus endereços IP públicos por meio da Internet.</span><span class="sxs-lookup"><span data-stu-id="6be0d-156">If you are not advertising your public IP addresses to Microsoft over ExpressRoute, Microsoft communicates with your public IP addresses via the Internet.</span></span> <span data-ttu-id="6be0d-157">O tráfego de encaminhamento de sua rede para a Microsoft usa o ExpressRoute, enquanto o tráfego inverso da Microsoft usa a Internet.</span><span class="sxs-lookup"><span data-stu-id="6be0d-157">Forward traffic from your network to Microsoft uses ExpressRoute, and reverse traffic from Microsoft uses the Internet.</span></span> <span data-ttu-id="6be0d-158">Quando o firewall na borda vir um pacote de resposta para um fluxo não encontrado na tabela de estados, ele descartará o tráfego de retorno.</span><span class="sxs-lookup"><span data-stu-id="6be0d-158">When the firewall at the edge sees a response packet for a flow that it does not find in the state table, it drops the return traffic.</span></span>

<span data-ttu-id="6be0d-159">Se você optar por usar o mesmo pool NAT (Conversão de Endereços de Rede) do ExpressRoute e da Internet, verá problemas semelhantes com os clientes nos endereços IP privados em sua rede.</span><span class="sxs-lookup"><span data-stu-id="6be0d-159">If you choose to use the same network address translation (NAT) pool for ExpressRoute and for the Internet, you'll see similar issues with the clients in your network on private IP addresses.</span></span> <span data-ttu-id="6be0d-160">As solicitações dos serviços como o Windows Update passam pela Internet, pois os endereços IP para esses serviços não são divulgados via ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="6be0d-160">Requests for services like Windows Update go via the Internet because IP addresses for these services are not advertised via ExpressRoute.</span></span> <span data-ttu-id="6be0d-161">No entanto, o tráfego de retorno volta via ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="6be0d-161">However, the return traffic comes back via ExpressRoute.</span></span> <span data-ttu-id="6be0d-162">Se a Microsoft receber um endereço IP com a mesma máscara de sub-rede da Internet e do ExpressRoute, preferirá o ExpressRoute na Internet.</span><span class="sxs-lookup"><span data-stu-id="6be0d-162">If Microsoft receives an IP address with the same subnet mask from the Internet and ExpressRoute, it prefers ExpressRoute over the Internet.</span></span> <span data-ttu-id="6be0d-163">Se um firewall ou outro dispositivo com estado na borda da rede, voltado para o ExpressRoute, não tiver informações anteriores sobre o fluxo, descartará os pacotes que pertencem ao fluxo.</span><span class="sxs-lookup"><span data-stu-id="6be0d-163">If a firewall or another stateful device that is on your network edge and facing ExpressRoute has no prior information about the flow, it drops the packets that belong to that flow.</span></span>

## <a name="asymmetric-routing-solutions"></a><span data-ttu-id="6be0d-164">Soluções do roteamento assimétrico</span><span class="sxs-lookup"><span data-stu-id="6be0d-164">Asymmetric routing solutions</span></span>
<span data-ttu-id="6be0d-165">Você tem duas opções principais para resolver o problema do roteamento assimétrico.</span><span class="sxs-lookup"><span data-stu-id="6be0d-165">You have two main options to solve the problem of asymmetric routing.</span></span> <span data-ttu-id="6be0d-166">Uma é por meio do roteamento e a outra é usando a NAT com base na origem (SNAT).</span><span class="sxs-lookup"><span data-stu-id="6be0d-166">One is through routing, and the other is by using source-based NAT (SNAT).</span></span>

### <a name="routing"></a><span data-ttu-id="6be0d-167">Roteamento</span><span class="sxs-lookup"><span data-stu-id="6be0d-167">Routing</span></span>
<span data-ttu-id="6be0d-168">Verifique se seus endereços IP públicos são anunciados para os devidos links WAN.</span><span class="sxs-lookup"><span data-stu-id="6be0d-168">Ensure that your public IP addresses are advertised to appropriate wide area network (WAN) links.</span></span> <span data-ttu-id="6be0d-169">Por exemplo, se você quiser usar a Internet para o tráfego de autenticação e o ExpressRoute para o tráfego de email, não deverá anunciar seus endereços IP públicos dos Serviços de Federação do Active Directory (AD FS) no ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="6be0d-169">For example, if you want to use the Internet for authentication traffic and ExpressRoute for your mail traffic, you should not advertise your Active Directory Federation Services (AD FS) public IP addresses over ExpressRoute.</span></span> <span data-ttu-id="6be0d-170">Da mesma forma, não exponha um servidor AD FS local para os endereços IP que o roteador recebe no ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="6be0d-170">Similarly, be sure not to expose an on-premises AD FS server to IP addresses that the router receives over ExpressRoute.</span></span> <span data-ttu-id="6be0d-171">As rotas recebidas no ExpressRoute são mais específicas, portanto, tornarão o ExpressRoute o caminho preferido do tráfego de autenticação para a Microsoft.</span><span class="sxs-lookup"><span data-stu-id="6be0d-171">Routes received over ExpressRoute are more specific so they make ExpressRoute the preferred path for authentication traffic to Microsoft.</span></span> <span data-ttu-id="6be0d-172">Isso causa o roteamento assimétrico.</span><span class="sxs-lookup"><span data-stu-id="6be0d-172">This causes asymmetric routing.</span></span>

<span data-ttu-id="6be0d-173">Se você quiser usar o ExpressRoute para a autenticação, verifique se está anunciando os endereços IP públicos do AD FS no ExpressRoute sem a NAT.</span><span class="sxs-lookup"><span data-stu-id="6be0d-173">If you want to use ExpressRoute for authentication, make sure that you are advertising AD FS public IP addresses over ExpressRoute without NAT.</span></span> <span data-ttu-id="6be0d-174">Dessa forma, o tráfego que se origina na Microsoft e vai para um servidor AD FS local passa pelo ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="6be0d-174">This way, traffic that originates from Microsoft and goes to an on-premises AD FS server goes over ExpressRoute.</span></span> <span data-ttu-id="6be0d-175">O tráfego de retorno do cliente para a Microsoft usa o ExpressRoute porque é a rota preferida na Internet.</span><span class="sxs-lookup"><span data-stu-id="6be0d-175">Return traffic from customer to Microsoft uses ExpressRoute because it's the preferred route over the Internet.</span></span>

### <a name="source-based-nat"></a><span data-ttu-id="6be0d-176">NAT com base em origem</span><span class="sxs-lookup"><span data-stu-id="6be0d-176">Source-based NAT</span></span>
<span data-ttu-id="6be0d-177">Outra maneira de solucionar os problemas do roteamento assimétrico é usando a SNAT.</span><span class="sxs-lookup"><span data-stu-id="6be0d-177">Another way of solving asymmetric routing issues is by using SNAT.</span></span> <span data-ttu-id="6be0d-178">Por exemplo, você não anunciou o endereço IP público de um servidor SMTP (Simple Mail Transfer Protocol) local no ExpressRoute porque pretende usar a Internet para esse tipo de comunicação.</span><span class="sxs-lookup"><span data-stu-id="6be0d-178">For example, you have not advertised the public IP address of an on-premises Simple Mail Transfer Protocol (SMTP) server over ExpressRoute because you intend to use the Internet for this type of communication.</span></span> <span data-ttu-id="6be0d-179">Uma solicitação que se origina na Microsoft e vai para o servidor SMTP local atravessa a Internet.</span><span class="sxs-lookup"><span data-stu-id="6be0d-179">A request that originates with Microsoft and then goes to your on-premises SMTP server traverses the Internet.</span></span> <span data-ttu-id="6be0d-180">Você usa a SNAT na solicitação de entrada para um endereço IP interno.</span><span class="sxs-lookup"><span data-stu-id="6be0d-180">You SNAT the incoming request to an internal IP address.</span></span> <span data-ttu-id="6be0d-181">O tráfego reverso do servidor SMTP vai para o firewall da borda (que você usa para a NAT), em vez de passar pelo ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="6be0d-181">Reverse traffic from the SMTP server goes to the edge firewall (which you use for NAT) instead of through ExpressRoute.</span></span> <span data-ttu-id="6be0d-182">O tráfego de retorno volta via Internet.</span><span class="sxs-lookup"><span data-stu-id="6be0d-182">The return traffic goes back via the Internet.</span></span>

![Configuração de rede da NAT com base na origem](./media/expressroute-asymmetric-routing/AsymmetricRouting2.png)

## <a name="asymmetric-routing-detection"></a><span data-ttu-id="6be0d-184">Detecção de roteamento assimétrico</span><span class="sxs-lookup"><span data-stu-id="6be0d-184">Asymmetric routing detection</span></span>
<span data-ttu-id="6be0d-185">O rastreamento de rotas é a melhor maneira de garantir que o tráfego de rede está atravessando o caminho esperado.</span><span class="sxs-lookup"><span data-stu-id="6be0d-185">Traceroute is the best way to make sure that your network traffic is traversing the expected path.</span></span> <span data-ttu-id="6be0d-186">Se você espera que o tráfego do servidor SMTP local para a Microsoft tome o caminho da Internet, o rastreamento de rotas esperado é do servidor SMTP para o Office 365.</span><span class="sxs-lookup"><span data-stu-id="6be0d-186">If you expect traffic from your on-premises SMTP server to Microsoft to take the Internet path, the expected traceroute is from the SMTP server to Office 365.</span></span> <span data-ttu-id="6be0d-187">O resultado valida que o tráfego realmente sai de sua rede para a Internet, não na direção do ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="6be0d-187">The result validates that traffic is indeed leaving your network toward the Internet and not toward ExpressRoute.</span></span>

