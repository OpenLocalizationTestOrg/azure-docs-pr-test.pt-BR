---
title: "aaaDesign Azure modelos para soluções complexas | Microsoft Docs"
description: "Mostra as práticas recomendadas para criação de modelos do Azure Resource Manager para cenários complexos"
services: azure-resource-manager
documentationcenter: 
author: tfitzmac
manager: timlt
editor: tysonn
ms.assetid: ce1141d6-ece7-4976-acea-1db1f775409e
ms.service: azure-resource-manager
ms.workload: multiple
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 12/19/2016
ms.author: tomfitz
ms.openlocfilehash: aa45e9a46d79a6336b696cff8fd37f65fa449f11
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="design-patterns-for-azure-resource-manager-templates-when-deploying-complex-solutions"></a><span data-ttu-id="83a98-103">Padrões de design para modelos do Azure Resource Manager ao implantar soluções complexas</span><span class="sxs-lookup"><span data-stu-id="83a98-103">Design patterns for Azure Resource Manager templates when deploying complex solutions</span></span>
<span data-ttu-id="83a98-104">Usando uma abordagem flexível com base em modelos do Azure Resource Manager, você pode implantar topologias complexas de forma rápida e consistente.</span><span class="sxs-lookup"><span data-stu-id="83a98-104">Using a flexible approach based on Azure Resource Manager templates, you can deploy complex topologies quickly and consistently.</span></span> <span data-ttu-id="83a98-105">Você pode adaptar essas implantações facilmente como principais ofertas evoluem ou tooaccommodate variantes para cenários de exceção ou clientes.</span><span class="sxs-lookup"><span data-stu-id="83a98-105">You can adapt these deployments easily as core offerings evolve or tooaccommodate variants for outlier scenarios or customers.</span></span>

<span data-ttu-id="83a98-106">Este tópico faz parte de um whitepaper mais amplo.</span><span class="sxs-lookup"><span data-stu-id="83a98-106">This topic is part of a larger whitepaper.</span></span> <span data-ttu-id="83a98-107">baixar tooread Olá completo papel, [World classe Azure Resource Manager modelos considerações e práticas comprovadas](http://download.microsoft.com/download/8/E/1/8E1DBEFA-CECE-4DC9-A813-93520A5D7CFE/World Class ARM Templates - Considerations and Proven Practices.pdf).</span><span class="sxs-lookup"><span data-stu-id="83a98-107">tooread hello full paper, download [World Class Azure Resource Manager Templates Considerations and Proven Practices](http://download.microsoft.com/download/8/E/1/8E1DBEFA-CECE-4DC9-A813-93520A5D7CFE/World Class ARM Templates - Considerations and Proven Practices.pdf).</span></span>

<span data-ttu-id="83a98-108">Modelos de combinam benefícios Olá Olá subjacente do Azure Resource Manager com capacidade de adaptação hello e facilitar a leitura do objeto notação JSON (JavaScript).</span><span class="sxs-lookup"><span data-stu-id="83a98-108">Templates combine hello benefits of hello underlying Azure Resource Manager with hello adaptability and readability of JavaScript Object Notation (JSON).</span></span> <span data-ttu-id="83a98-109">Usando modelos, você pode:</span><span class="sxs-lookup"><span data-stu-id="83a98-109">Using templates, you can:</span></span>

* <span data-ttu-id="83a98-110">Implantar consistentemente topologias e suas cargas de trabalho.</span><span class="sxs-lookup"><span data-stu-id="83a98-110">Deploy topologies and their workloads consistently.</span></span>
* <span data-ttu-id="83a98-111">Gerencie todos os seus recursos em um aplicativo coletivamente usando grupos de recursos.</span><span class="sxs-lookup"><span data-stu-id="83a98-111">Manage all your resources in an application together using resource groups.</span></span>
* <span data-ttu-id="83a98-112">Aplica serviços, grupos e acesso baseado em função (RBAC) controle toogrant acesso apropriado toousers.</span><span class="sxs-lookup"><span data-stu-id="83a98-112">Apply role-based access control (RBAC) toogrant appropriate access toousers, groups, and services.</span></span>
* <span data-ttu-id="83a98-113">Use tarefas de toostreamline associações marcação, como pacotes cumulativos de cobrança.</span><span class="sxs-lookup"><span data-stu-id="83a98-113">Use tagging associations toostreamline tasks such as billing rollups.</span></span>

<span data-ttu-id="83a98-114">Este artigo fornece detalhes sobre cenários de consumo, arquitetura e padrões de implementação identificados durante nossas sessões de design e implementações de modelos do mundo real com os clientes da AzureCAT (Azure Customer Advisory Team).</span><span class="sxs-lookup"><span data-stu-id="83a98-114">This article provides details on consumption scenarios, architecture, and implementation patterns identified during our design sessions and real-world template implementations with Azure Customer Advisory Team (AzureCAT) customers.</span></span> <span data-ttu-id="83a98-115">Distantes acadêmica, essas abordagens são práticas comprovadas, informadas por desenvolvimento Olá dos modelos de 12 das tecnologias principais sistemas operacionais baseados em Linux de hello, incluindo: Kafka Apache, Apache Spark, Cloudera, Couchbase, Hortonworks HDP, Enterprise DataStax da plataforma Apache Cassandra, Elasticsearch, Jenkins, MongoDB, PostgreSQL, Redis e Nagios.</span><span class="sxs-lookup"><span data-stu-id="83a98-115">Far from academic, these approaches are proven practices informed by hello development of templates for 12 of hello top Linux-based OSS technologies, including: Apache Kafka, Apache Spark, Cloudera, Couchbase, Hortonworks HDP, DataStax Enterprise powered by Apache Cassandra, Elasticsearch, Jenkins, MongoDB, PostgreSQL, Redis, and Nagios.</span></span> 

<span data-ttu-id="83a98-116">Este artigo compartilha essas toohelp práticas comprovadas projetar modelos de Gerenciador de recursos do Azure de classe mundial.</span><span class="sxs-lookup"><span data-stu-id="83a98-116">This article shares these proven practices toohelp you architect world class Azure Resource Manager templates.</span></span>  

<span data-ttu-id="83a98-117">Em nosso trabalho com clientes, identificamos várias experiências de consumo de modelos do Resource Manager entre empresas, SIs (integradores de sistemas) e CSVs (fornecedores de serviço de nuvem).</span><span class="sxs-lookup"><span data-stu-id="83a98-117">In our work with customers, we have identified several Resource Manager template consumption experiences across enterprises, System Integrators (SI)s, and CSVs.</span></span> <span data-ttu-id="83a98-118">Olá seções a seguir fornecem uma visão geral de cenários e padrões comuns para diferentes tipos de clientes.</span><span class="sxs-lookup"><span data-stu-id="83a98-118">hello following sections provide a high-level overview of common scenarios and patterns for different customer types.</span></span>

## <a name="enterprises-and-system-integrators"></a><span data-ttu-id="83a98-119">Empresas e integradores de sistemas</span><span class="sxs-lookup"><span data-stu-id="83a98-119">Enterprises and system integrators</span></span>
<span data-ttu-id="83a98-120">Em grandes organizações, normalmente observamos dois consumidores de modelos do Azure Resource Manager: as equipes de desenvolvimento interno de software e o TI empresarial.</span><span class="sxs-lookup"><span data-stu-id="83a98-120">Within large organizations, we commonly see two consumers of Resource Manager templates: internal software development teams and corporate IT.</span></span> <span data-ttu-id="83a98-121">Descobrimos que os cenários de saudação do Olá SIs mapeiam toohello cenários para empresas, portanto Olá mesmas considerações se aplicam.</span><span class="sxs-lookup"><span data-stu-id="83a98-121">We've found that hello scenarios for hello SIs map toohello scenarios for Enterprises, so hello same considerations apply.</span></span>

### <a name="internal-software-development-teams"></a><span data-ttu-id="83a98-122">Equipes de desenvolvimento interno de software</span><span class="sxs-lookup"><span data-stu-id="83a98-122">Internal software development teams</span></span>
<span data-ttu-id="83a98-123">Se sua equipe desenvolve software toosupport seu negócio, modelos fornecem uma maneira fácil tooquickly implantar tecnologias para uso em soluções comerciais específicas.</span><span class="sxs-lookup"><span data-stu-id="83a98-123">If your team develops software toosupport your business, templates provide an easy way tooquickly deploy technologies for use in business-specific solutions.</span></span> <span data-ttu-id="83a98-124">Você também pode usar modelos toorapidly criar ambientes de treinamento que habilitam as habilidades necessárias de toogain de membros de equipe.</span><span class="sxs-lookup"><span data-stu-id="83a98-124">You can also use templates toorapidly create training environments that enable team members toogain necessary skills.</span></span>

<span data-ttu-id="83a98-125">Você pode usar modelos como-é estender ou integrá-las tooaccommodate suas necessidades.</span><span class="sxs-lookup"><span data-stu-id="83a98-125">You can use templates as-is or extend or compose them tooaccommodate your needs.</span></span> <span data-ttu-id="83a98-126">Usando marcação nos modelos, você pode fornecer um resumo de cobrança com várias exibições, como equipe, projeto, indivíduo e educação.</span><span class="sxs-lookup"><span data-stu-id="83a98-126">Using tagging within templates, you can provide a billing summary with various views such as team, project, individual, and education.</span></span>

<span data-ttu-id="83a98-127">As empresas geralmente deseja equipes de desenvolvimento de software toocreate um modelo de implantação consistente de uma solução.</span><span class="sxs-lookup"><span data-stu-id="83a98-127">Businesses often want software development teams toocreate a template for consistent deployment of a solution.</span></span> <span data-ttu-id="83a98-128">modelo de saudação facilita restrições para que determinados itens dentro desse ambiente permanecem fixos e não podem ser substituídos.</span><span class="sxs-lookup"><span data-stu-id="83a98-128">hello template facilitates constraints so certain items within that environment remain fixed and can't be overridden.</span></span> <span data-ttu-id="83a98-129">Por exemplo, um banco pode exigir um modelo tooinclude RBAC para um programador não é possível revisar uma solução toosend conta de armazenamento pessoal de tooa de dados.</span><span class="sxs-lookup"><span data-stu-id="83a98-129">For example, a bank might require a template tooinclude RBAC so a programmer can’t revise a banking solution toosend data tooa personal storage account.</span></span>

### <a name="corporate-it"></a><span data-ttu-id="83a98-130">TI Empresarial</span><span class="sxs-lookup"><span data-stu-id="83a98-130">Corporate IT</span></span>
<span data-ttu-id="83a98-131">As organizações de TI empresarial normalmente usam modelos para fornecer capacidade de nuvem e recursos hospedados na nuvem.</span><span class="sxs-lookup"><span data-stu-id="83a98-131">Corporate IT organizations typically use templates for delivering cloud capacity and cloud-hosted capabilities.</span></span>

#### <a name="cloud-capacity"></a><span data-ttu-id="83a98-132">Capacidade de nuvem</span><span class="sxs-lookup"><span data-stu-id="83a98-132">Cloud capacity</span></span>
<span data-ttu-id="83a98-133">É uma maneira comum para corporativa IT grupos tooprovide capacidade da nuvem para equipes com "tamanhos camisa", que são padrão oferta tamanhos como pequeno, médio e grande.</span><span class="sxs-lookup"><span data-stu-id="83a98-133">A common way for corporate IT groups tooprovide cloud capacity for teams is with "t-shirt sizes", which are standard offering sizes such as small, medium, and large.</span></span> <span data-ttu-id="83a98-134">ofertas de camisa dimensionado Olá podem misturar tipos diferentes de recursos e quantidades oferecendo um nível de padronização que torna possível toouse modelos.</span><span class="sxs-lookup"><span data-stu-id="83a98-134">hello t-shirt sized offerings can mix different resource types and quantities while providing a level of standardization that makes it possible toouse templates.</span></span> <span data-ttu-id="83a98-135">modelos de saudação oferecem a capacidade de uma maneira consistente que impõe políticas corporativas e usa a marcação tooprovide estorno tooconsuming organizações.</span><span class="sxs-lookup"><span data-stu-id="83a98-135">hello templates deliver capacity in a consistent way that enforces corporate policies and uses tagging tooprovide chargeback tooconsuming organizations.</span></span>

<span data-ttu-id="83a98-136">Por exemplo, talvez seja necessário tooprovide desenvolvimento, teste ou ambientes de produção no qual Olá equipes de desenvolvimento de software podem implantar suas soluções.</span><span class="sxs-lookup"><span data-stu-id="83a98-136">For example, you may need tooprovide development, test, or production environments within which hello software development teams can deploy their solutions.</span></span> <span data-ttu-id="83a98-137">ambiente Olá com uma topologia de rede predefinidas e elementos que Olá equipes de desenvolvimento de software não é possível alterar, como regras que regem o acesso toohello públicos na internet e pacote inspeção.</span><span class="sxs-lookup"><span data-stu-id="83a98-137">hello environment has a predefined network topology and elements that hello software development teams cannot change, such as rules governing access toohello public internet and packet inspection.</span></span> <span data-ttu-id="83a98-138">Você também pode ter funções específicas da organização para esses ambientes com direitos de acesso distintos para o ambiente de saudação.</span><span class="sxs-lookup"><span data-stu-id="83a98-138">You may also have organization-specific roles for these environments with distinct access rights for hello environment.</span></span>

#### <a name="cloud-hosted-capabilities"></a><span data-ttu-id="83a98-139">Recursos hospedados na nuvem</span><span class="sxs-lookup"><span data-stu-id="83a98-139">Cloud-hosted capabilities</span></span>
<span data-ttu-id="83a98-140">Você pode usar modelos toosupport hospedados em nuvem recursos, incluindo pacotes de software individuais ou ofertas compostas que são oferecidas toointernal linhas de negócios.</span><span class="sxs-lookup"><span data-stu-id="83a98-140">You can use templates toosupport cloud-hosted capabilities, including individual software packages or composite offerings that are offered toointernal lines of business.</span></span> <span data-ttu-id="83a98-141">Um exemplo de uma oferta composta seria análise como serviço - análise, visualização e outras tecnologias - entregue em uma configuração otimizada e conectada, em uma topologia de rede predefinida.</span><span class="sxs-lookup"><span data-stu-id="83a98-141">An example of a composite offering would be analytics-as-a-service—analytics, visualization, and other technologies—delivered in an optimized, connected configuration on a predefined network topology.</span></span>

<span data-ttu-id="83a98-142">Recursos hospedados em nuvem são afetados por Olá função considerações sobre segurança e estabelecido pela capacidade da nuvem Olá oferta em que sejam criados.</span><span class="sxs-lookup"><span data-stu-id="83a98-142">Cloud-hosted capabilities are affected by hello security and role considerations established by hello cloud capacity offering on which they’re built.</span></span> <span data-ttu-id="83a98-143">Esses recursos são oferecidos como são ou como um serviço gerenciado.</span><span class="sxs-lookup"><span data-stu-id="83a98-143">These capabilities are offered as is or as a managed service.</span></span> <span data-ttu-id="83a98-144">Olá último, funções de restrição de acesso são obrigatórias acesso tooenable no ambiente de saudação para fins de gerenciamento.</span><span class="sxs-lookup"><span data-stu-id="83a98-144">For hello latter, access-constrained roles are required tooenable access into hello environment for management purposes.</span></span>

## <a name="cloud-service-vendors"></a><span data-ttu-id="83a98-145">Fornecedores de serviço de nuvem</span><span class="sxs-lookup"><span data-stu-id="83a98-145">Cloud service vendors</span></span>
<span data-ttu-id="83a98-146">Depois de falar toomany CSVs, identificamos várias abordagens que você pode executar serviços toodeploy para seus clientes e os requisitos associados.</span><span class="sxs-lookup"><span data-stu-id="83a98-146">After talking toomany CSVs, we identified multiple approaches you can take toodeploy services for your customers and associated requirements.</span></span>

### <a name="csv-hosted-offering"></a><span data-ttu-id="83a98-147">Oferta hospedada em CSV</span><span class="sxs-lookup"><span data-stu-id="83a98-147">CSV-hosted offering</span></span>
<span data-ttu-id="83a98-148">Se você hospeda sua oferta em sua própria assinatura do Azure, há duas abordagens de hospedagem comuns: uma implantação distinta para cada cliente ou então a implantação de unidades de escala, que são a base de uma infraestrutura compartilhada usada para todos os clientes.</span><span class="sxs-lookup"><span data-stu-id="83a98-148">If you host your offering in your own Azure subscription, two hosting approaches are common: deploying a distinct deployment for every customer or deploying scale units that underpin a shared infrastructure used for all customers.</span></span>

* <span data-ttu-id="83a98-149">**Implantações distintas para cada cliente.**</span><span class="sxs-lookup"><span data-stu-id="83a98-149">**Distinct deployments for each customer.**</span></span> <span data-ttu-id="83a98-150">Implantações distintas para cada cliente exigem topologias fixas de diferentes configurações conhecidas.</span><span class="sxs-lookup"><span data-stu-id="83a98-150">Distinct deployments per customer require fixed topologies of different known configurations.</span></span> <span data-ttu-id="83a98-151">Essas implantações podem ter diferentes tamanhos de VM (máquina virtual), números variados de nós e quantidades diferentes de armazenamento associado.</span><span class="sxs-lookup"><span data-stu-id="83a98-151">These deployments may have different virtual machine (VM) sizes, varying numbers of nodes, and different amounts of associated storage.</span></span> <span data-ttu-id="83a98-152">A marcação de implantações é usada para cobrança de valores acumulados de cada cliente.</span><span class="sxs-lookup"><span data-stu-id="83a98-152">Tagging of deployments is used for roll-up billing of each customer.</span></span> <span data-ttu-id="83a98-153">RBAC pode ser habilitado tooallow clientes acesso tooaspects do ambiente de nuvem.</span><span class="sxs-lookup"><span data-stu-id="83a98-153">RBAC may be enabled tooallow customers access tooaspects of their cloud environment.</span></span>
* <span data-ttu-id="83a98-154">**Unidades de escala em ambientes multilocatário compartilhados.**</span><span class="sxs-lookup"><span data-stu-id="83a98-154">**Scale units in shared multi-tenant environments.**</span></span> <span data-ttu-id="83a98-155">Um modelo pode representar uma unidade de escala para ambientes multilocatário.</span><span class="sxs-lookup"><span data-stu-id="83a98-155">A template can represent a scale unit for multi-tenant environments.</span></span> <span data-ttu-id="83a98-156">Nesse caso, Olá mesma infraestrutura é toosupport usado em todos os clientes.</span><span class="sxs-lookup"><span data-stu-id="83a98-156">In this case, hello same infrastructure is used toosupport all customers.</span></span> <span data-ttu-id="83a98-157">implantações de saudação representam um grupo de recursos que fornecem um nível de capacidade para Olá hospedado oferta, como o número de usuários e o número de transações.</span><span class="sxs-lookup"><span data-stu-id="83a98-157">hello deployments represent a group of resources that deliver a level of capacity for hello hosted offering, such as number of users and number of transactions.</span></span> <span data-ttu-id="83a98-158">Essas unidades de escala são aumentadas ou reduzidas conforme a demanda.</span><span class="sxs-lookup"><span data-stu-id="83a98-158">These scale units are increased or decreased as demand requires.</span></span>

### <a name="csv-offering-injected-into-customer-subscription"></a><span data-ttu-id="83a98-159">Oferta de CSV introduzida na assinatura do cliente</span><span class="sxs-lookup"><span data-stu-id="83a98-159">CSV offering injected into customer subscription</span></span>
<span data-ttu-id="83a98-160">Talvez você queira toodeploy o software em assinaturas pertencentes a clientes finais.</span><span class="sxs-lookup"><span data-stu-id="83a98-160">You may want toodeploy your software into subscriptions owned by end customers.</span></span> <span data-ttu-id="83a98-161">Você pode usar implantações distintas do toodeploy modelos em uma conta de cliente do Azure.</span><span class="sxs-lookup"><span data-stu-id="83a98-161">You can use templates toodeploy distinct deployments into a customer’s Azure account.</span></span>

<span data-ttu-id="83a98-162">Essas implantações usam RBAC, portanto, você pode atualizar e gerenciar a implantação de saudação em conta saudação do cliente.</span><span class="sxs-lookup"><span data-stu-id="83a98-162">These deployments use RBAC so you can update and manage hello deployment within hello customer’s account.</span></span>

### <a name="azure-marketplace"></a><span data-ttu-id="83a98-163">Azure Marketplace</span><span class="sxs-lookup"><span data-stu-id="83a98-163">Azure Marketplace</span></span>
<span data-ttu-id="83a98-164">tooadvertise e vender suas ofertas por meio de um mercado, como o Azure Marketplace, você pode desenvolver modelos toodeliver diferentes tipos de implantações que são executados em uma conta de cliente do Azure.</span><span class="sxs-lookup"><span data-stu-id="83a98-164">tooadvertise and sell your offerings through a marketplace, such as Azure Marketplace, you can develop templates toodeliver distinct types of deployments that run in a customer’s Azure account.</span></span> <span data-ttu-id="83a98-165">Essas implantações distintas normalmente podem ser descritas como um tamanho de camiseta (pequeno, médio, grande), tipo de produto/público (community, developer, enterprise) ou tipo de recurso (básico, de alta disponibilidade).</span><span class="sxs-lookup"><span data-stu-id="83a98-165">These distinct deployments can be typically described as a t-shirt size (small, medium, large), product/audience type (community, developer, enterprise), or feature type (basic, high availability).</span></span>  <span data-ttu-id="83a98-166">Em alguns casos, esses tipos permitem que você toospecify determinados atributos de implantação de saudação, como tipo VM ou o número de discos.</span><span class="sxs-lookup"><span data-stu-id="83a98-166">In some cases, these types allow you toospecify certain attributes of hello deployment, such as VM type or number of disks.</span></span>

## <a name="oss-projects"></a><span data-ttu-id="83a98-167">Projetos de software livre</span><span class="sxs-lookup"><span data-stu-id="83a98-167">OSS projects</span></span>
<span data-ttu-id="83a98-168">Dentro de projetos de código-fonte aberto, modelos do Gerenciador de recursos permitem uma comunidade toodeploy uma solução rapidamente usando práticas comprovadas.</span><span class="sxs-lookup"><span data-stu-id="83a98-168">Within open source projects, Resource Manager templates enable a community toodeploy a solution quickly using proven practices.</span></span> <span data-ttu-id="83a98-169">Você pode armazenar modelos em um repositório do GitHub para que comunidade Olá poderá revisá-los ao longo do tempo.</span><span class="sxs-lookup"><span data-stu-id="83a98-169">You can store templates in a GitHub repository so hello community can revise them over time.</span></span> <span data-ttu-id="83a98-170">Os usuários implantam esses modelos em suas próprias assinaturas do Azure.</span><span class="sxs-lookup"><span data-stu-id="83a98-170">Users deploy these templates in their own Azure subscriptions.</span></span>

<span data-ttu-id="83a98-171">Olá seções a seguir identificam coisas Olá precisar tooconsider antes de projetar sua solução.</span><span class="sxs-lookup"><span data-stu-id="83a98-171">hello following sections identify hello things you need tooconsider before designing your solution.</span></span>

## <a name="identifying-what-is-outside-and-inside-a-vm"></a><span data-ttu-id="83a98-172">Identificando o que está fora e o que está dentro de uma VM</span><span class="sxs-lookup"><span data-stu-id="83a98-172">Identifying what is outside and inside a VM</span></span>
<span data-ttu-id="83a98-173">Como criar seu modelo, é útil toolook requisitos Olá em termos de novidades externas e internas Olá máquinas de virtuais (VMs):</span><span class="sxs-lookup"><span data-stu-id="83a98-173">As you design your template, it’s helpful toolook at hello requirements in terms of what's outside and inside hello virtual machines (VMs):</span></span>

* <span data-ttu-id="83a98-174">Fora significa Olá VMs e outros recursos de sua implantação, como a topologia de rede hello, marcação, os segredos da certificados referências toohello e controle de acesso baseado em função.</span><span class="sxs-lookup"><span data-stu-id="83a98-174">Outside means hello VMs and other resources of your deployment, such as hello network topology, tagging, references toohello certs/secrets, and role-based access control.</span></span> <span data-ttu-id="83a98-175">Todos esses recursos fazem parte do seu modelo.</span><span class="sxs-lookup"><span data-stu-id="83a98-175">All these resources are part of your template.</span></span>
* <span data-ttu-id="83a98-176">Configuração de estado significa dentro hello software instalado e geral desejado.</span><span class="sxs-lookup"><span data-stu-id="83a98-176">Inside means hello installed software and overall desired state configuration.</span></span> <span data-ttu-id="83a98-177">Outros mecanismos, como scripts ou extensões de VM, são usados no todo ou em parte.</span><span class="sxs-lookup"><span data-stu-id="83a98-177">Other mechanisms, such as VM extensions or scripts, are used in whole or in part.</span></span> <span data-ttu-id="83a98-178">Esses mecanismos podem ser identificados e executados pelo modelo hello, mas não nele.</span><span class="sxs-lookup"><span data-stu-id="83a98-178">These mechanisms may be identified and executed by hello template but aren’t in it.</span></span>

<span data-ttu-id="83a98-179">Exemplos comuns de atividades "dentro da caixa hello" inclua-</span><span class="sxs-lookup"><span data-stu-id="83a98-179">Common examples of activities you would do “inside hello box” include -</span></span>  

* <span data-ttu-id="83a98-180">Instalar ou remover recursos e funções de servidor</span><span class="sxs-lookup"><span data-stu-id="83a98-180">Install or remove server roles and features</span></span>
* <span data-ttu-id="83a98-181">Instalar e configurar o software no nível de cluster ou nó de saudação</span><span class="sxs-lookup"><span data-stu-id="83a98-181">Install and configure software at hello node or cluster level</span></span>
* <span data-ttu-id="83a98-182">Implantar sites em um servidor Web</span><span class="sxs-lookup"><span data-stu-id="83a98-182">Deploy websites on a web server</span></span>
* <span data-ttu-id="83a98-183">Implantar esquemas de banco de dados</span><span class="sxs-lookup"><span data-stu-id="83a98-183">Deploy database schemas</span></span>
* <span data-ttu-id="83a98-184">Gerenciar o Registro ou outros tipos de configurações</span><span class="sxs-lookup"><span data-stu-id="83a98-184">Manage registry or other types of configuration settings</span></span>
* <span data-ttu-id="83a98-185">Gerenciar arquivos e diretórios</span><span class="sxs-lookup"><span data-stu-id="83a98-185">Manage files and directories</span></span>
* <span data-ttu-id="83a98-186">Iniciar, parar e gerenciar processos e serviços</span><span class="sxs-lookup"><span data-stu-id="83a98-186">Start, stop, and manage processes and services</span></span>
* <span data-ttu-id="83a98-187">Gerenciar contas de usuário e grupos locais</span><span class="sxs-lookup"><span data-stu-id="83a98-187">Manage local groups and user accounts</span></span>
* <span data-ttu-id="83a98-188">Instalar e gerenciar pacotes (. msi, .exe, yum, etc.)</span><span class="sxs-lookup"><span data-stu-id="83a98-188">Install and manage packages (.msi, .exe, yum, etc.)</span></span>
* <span data-ttu-id="83a98-189">Gerenciar variáveis de ambiente</span><span class="sxs-lookup"><span data-stu-id="83a98-189">Manage environment variables</span></span>
* <span data-ttu-id="83a98-190">Executar scripts nativos (Windows PowerShell, bash, etc.)</span><span class="sxs-lookup"><span data-stu-id="83a98-190">Run native scripts (Windows PowerShell, bash, etc.)</span></span>

### <a name="desired-state-configuration-dsc"></a><span data-ttu-id="83a98-191">Configuração de estado desejado (DSC)</span><span class="sxs-lookup"><span data-stu-id="83a98-191">Desired state configuration (DSC)</span></span>
<span data-ttu-id="83a98-192">Pensar sobre o estado interno de saudação de suas VMs além da implantação, você deseja toomake-se de que essa implantação não "descompasso" da configuração de saudação que você definiu e verificados no controle de origem.</span><span class="sxs-lookup"><span data-stu-id="83a98-192">Thinking about hello internal state of your VMs beyond deployment, you want toomake sure this deployment doesn’t "drift" from hello configuration that you have defined and checked into source control.</span></span> <span data-ttu-id="83a98-193">Essa abordagem garante que os desenvolvedores ou equipe de operações não faça o ambiente de tooan de alterações ad hoc que não são verificadas, testado ou registrados no controle de origem.</span><span class="sxs-lookup"><span data-stu-id="83a98-193">This approach ensures your developers or operations staff don’t make ad-hoc changes tooan environment that are not vetted, tested, or recorded in source control.</span></span> <span data-ttu-id="83a98-194">Esse controle é importante, porque alterações manuais Olá não estão no controle de origem.</span><span class="sxs-lookup"><span data-stu-id="83a98-194">This control is important, because hello manual changes are not in source control.</span></span> <span data-ttu-id="83a98-195">Eles também não são parte da implantação padrão da saudação e terá impacto sobre futuras implantações automatizadas de software hello.</span><span class="sxs-lookup"><span data-stu-id="83a98-195">They are also not part of hello standard deployment and will impact future automated deployments of hello software.</span></span>

<span data-ttu-id="83a98-196">Além de seus funcionários internos, a configuração de estado desejado também é importante segundo uma perspectiva de segurança.</span><span class="sxs-lookup"><span data-stu-id="83a98-196">Beyond your internal employees, desired state configuration is also important from a security perspective.</span></span> <span data-ttu-id="83a98-197">Hackers regularmente estão tentando toocompromise e exploram os sistemas de software.</span><span class="sxs-lookup"><span data-stu-id="83a98-197">Hackers are regularly trying toocompromise and exploit software systems.</span></span> <span data-ttu-id="83a98-198">Quando obtiver êxito, ele é arquivos tooinstall comuns e alterar estado de saudação de um sistema comprometido.</span><span class="sxs-lookup"><span data-stu-id="83a98-198">When successful, it's common tooinstall files and otherwise change hello state of a compromised system.</span></span> <span data-ttu-id="83a98-199">Usando a configuração de estado desejado, você pode identificar deltas entre hello desejado e o estado real e restaurar uma configuração conhecida.</span><span class="sxs-lookup"><span data-stu-id="83a98-199">Using desired state configuration, you can identify deltas between hello desired and actual state and restore a known configuration.</span></span>

<span data-ttu-id="83a98-200">Existem extensões de recurso hello mais populares mecanismos para DSC - PowerShell DSC, Chef e Puppet.</span><span class="sxs-lookup"><span data-stu-id="83a98-200">There are resource extensions for hello most popular mechanisms for DSC - PowerShell DSC, Chef, and Puppet.</span></span> <span data-ttu-id="83a98-201">Cada uma dessas extensões pode implantar o estado inicial de saudação da VM e também ser usada toomake se Olá desejado de estado é mantido.</span><span class="sxs-lookup"><span data-stu-id="83a98-201">Each of these extensions can deploy hello initial state of your VM and also be used toomake sure hello desired state is maintained.</span></span>

## <a name="common-template-scopes"></a><span data-ttu-id="83a98-202">Escopos de modelo comuns</span><span class="sxs-lookup"><span data-stu-id="83a98-202">Common template scopes</span></span>
<span data-ttu-id="83a98-203">Em nossa experiência, vimos três escopos principais de modelos de solução surgirem.</span><span class="sxs-lookup"><span data-stu-id="83a98-203">In our experience, we’ve seen three key solution templates scopes emerge.</span></span> <span data-ttu-id="83a98-204">Esses três escopos – capacidade, a funcionalidade e solução de ponta a ponta – são descritos na Olá seções a seguir.</span><span class="sxs-lookup"><span data-stu-id="83a98-204">These three scopes – capacity, capability, and end-to-end solution – are described in hello following sections.</span></span>

### <a name="capacity-scope"></a><span data-ttu-id="83a98-205">Escopo de capacidade</span><span class="sxs-lookup"><span data-stu-id="83a98-205">Capacity scope</span></span>
<span data-ttu-id="83a98-206">Um escopo de capacidade fornece um conjunto de recursos em uma topologia padrão que é pré-configurado toobe em conformidade com regulamentos e políticas.</span><span class="sxs-lookup"><span data-stu-id="83a98-206">A capacity scope delivers a set of resources in a standard topology that is pre-configured toobe in compliance with regulations and policies.</span></span> <span data-ttu-id="83a98-207">exemplo mais comum de saudação está implantando um ambiente de desenvolvimento padrão em um cenário de TI da empresa ou SI.</span><span class="sxs-lookup"><span data-stu-id="83a98-207">hello most common example is deploying a standard development environment in an Enterprise IT or SI scenario.</span></span>

### <a name="capability-scope"></a><span data-ttu-id="83a98-208">Escopo de funcionalidade</span><span class="sxs-lookup"><span data-stu-id="83a98-208">Capability scope</span></span>
<span data-ttu-id="83a98-209">Um escopo de funcionalidade concentra-se em como implantar e configurar uma topologia para uma determinada tecnologia.</span><span class="sxs-lookup"><span data-stu-id="83a98-209">A capability scope is focused on deploying and configuring a topology for a given technology.</span></span> <span data-ttu-id="83a98-210">Cenários comuns, incluindo tecnologias como SQL Server, Cassandra, Hadoop.</span><span class="sxs-lookup"><span data-stu-id="83a98-210">Common scenarios including technologies such as SQL Server, Cassandra, Hadoop.</span></span>

### <a name="end-to-end-solution-scope"></a><span data-ttu-id="83a98-211">Escopo da solução de ponta a ponta</span><span class="sxs-lookup"><span data-stu-id="83a98-211">End-to-end solution scope</span></span>
<span data-ttu-id="83a98-212">Um escopo de solução de ponta a ponta é direcionado além de um único recurso e em vez disso, orientado para fornecer uma solução de tooend final composta de vários recursos.</span><span class="sxs-lookup"><span data-stu-id="83a98-212">An End-to-End Solution Scope is targeted beyond a single capability, and instead focused on delivering an end tooend solution comprised of multiple capabilities.</span></span>  

<span data-ttu-id="83a98-213">Um escopo de modelo com escopo de solução se manifesta como um conjunto de um ou mais modelos com escopo de funcionalidade com recursos, lógica e estado desejado específicos da solução.</span><span class="sxs-lookup"><span data-stu-id="83a98-213">A solution-scoped template scope manifests itself as a set of one or more capability-scoped templates with solution-specific resources, logic, and desired state.</span></span> <span data-ttu-id="83a98-214">Um exemplo de um modelo no escopo de solução é um modelo de solução final tooend dados pipeline.</span><span class="sxs-lookup"><span data-stu-id="83a98-214">An example of a solution-scoped template is an end tooend data pipeline solution template.</span></span> <span data-ttu-id="83a98-215">modelo Olá pode misturar topologia de solução específica e estado com vários modelos de solução no escopo do recurso como Kafka, tempestade e Hadoop.</span><span class="sxs-lookup"><span data-stu-id="83a98-215">hello template might mix solution-specific topology and state with multiple capability-scoped solution templates such as Kafka, Storm, and Hadoop.</span></span>

## <a name="choosing-free-form-vs-known-configurations"></a><span data-ttu-id="83a98-216">Escolhendo entre configurações de forma livre e configurações conhecidas</span><span class="sxs-lookup"><span data-stu-id="83a98-216">Choosing free-form vs. known configurations</span></span>
<span data-ttu-id="83a98-217">Você pode pensar inicialmente um modelo deve fornecer aos clientes flexibilidade máxima hello, mas muitas considerações afetam a opção de saudação de configurações de forma livre toouse versus configurações conhecidas.</span><span class="sxs-lookup"><span data-stu-id="83a98-217">You might initially think a template should give consumers hello utmost flexibility, but many considerations affect hello choice of whether toouse free-form configurations vs. known configurations.</span></span> <span data-ttu-id="83a98-218">Esta seção identifica Olá principais necessidades do cliente e considerações técnicas que formatada abordagem Olá compartilhada neste documento.</span><span class="sxs-lookup"><span data-stu-id="83a98-218">This section identifies hello key customer requirements and technical considerations that shaped hello approach shared in this document.</span></span>

### <a name="free-form-configurations"></a><span data-ttu-id="83a98-219">Configurações de forma livre</span><span class="sxs-lookup"><span data-stu-id="83a98-219">Free-form configurations</span></span>
<span data-ttu-id="83a98-220">Na superfície de hello, configurações de forma livre de som ideais.</span><span class="sxs-lookup"><span data-stu-id="83a98-220">On hello surface, free-form configurations sound ideal.</span></span> <span data-ttu-id="83a98-221">Eles permitem tooselect um tipo VM e fornecer um número arbitrário de nós e discos para os nós conectados — e fazê-lo como modelo de tooa de parâmetros.</span><span class="sxs-lookup"><span data-stu-id="83a98-221">They allow you tooselect a VM type and provide an arbitrary number of nodes and attached disks for those nodes — and do so as parameters tooa template.</span></span> <span data-ttu-id="83a98-222">No entanto, essa abordagem não é ideal para alguns cenários.</span><span class="sxs-lookup"><span data-stu-id="83a98-222">However, this approach is not ideal for some scenarios.</span></span>

<span data-ttu-id="83a98-223">Em [tamanhos das máquinas virtuais](../virtual-machines/windows/sizes.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json), Olá diferentes tipos VM e tamanhos disponíveis são identificados, e cada número de saudação do durável discos (2, 4, 8, 16 ou 32) que podem ser anexados.</span><span class="sxs-lookup"><span data-stu-id="83a98-223">In [Sizes for virtual machines](../virtual-machines/windows/sizes.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json), hello different VM types and available sizes are identified, and each of hello number of durable disks (2, 4, 8, 16, or 32) that can be attached.</span></span> <span data-ttu-id="83a98-224">Cada disco conectado fornece 500 IOPS e múltiplos desses discos podem ser agrupados (pooling) para se obter um multiplicador desse número de IOPS.</span><span class="sxs-lookup"><span data-stu-id="83a98-224">Each attached disk provides 500 IOPS and multiples of these disks can be pooled for a multiplier of that number of IOPS.</span></span> <span data-ttu-id="83a98-225">Por exemplo, 16 discos pode ser agrupada tooprovide 8.000 IOPS.</span><span class="sxs-lookup"><span data-stu-id="83a98-225">For example, 16 disks can be pooled tooprovide 8,000 IOPS.</span></span> <span data-ttu-id="83a98-226">O pool é feito com a configuração no sistema de operacional hello, usando espaços de armazenamento do Microsoft Windows ou matriz redundante de discos independentes (RAID) no Linux.</span><span class="sxs-lookup"><span data-stu-id="83a98-226">Pooling is done with configuration in hello operating system, using Microsoft Windows Storage Spaces or redundant array of inexpensive disks (RAID) in Linux.</span></span>

<span data-ttu-id="83a98-227">Uma configuração de forma livre permite Olá seleção várias instâncias VM, VM vários tipos e tamanhos para essas instâncias, vários discos para Olá tipo VM, e um ou mais scripts tooconfigure conteúdo VM de saudação.</span><span class="sxs-lookup"><span data-stu-id="83a98-227">A free-form configuration enables hello selection several VM instances, various VM types and sizes for those instances, various disks for hello VM type, and one or more scripts tooconfigure hello VM contents.</span></span>

<span data-ttu-id="83a98-228">É comum que uma implantação tenha vários tipos de nós, como nós mestres e de dados; portanto, essa flexibilidade geralmente é fornecida para todos os tipos de nó.</span><span class="sxs-lookup"><span data-stu-id="83a98-228">It is common that a deployment may have multiple types of nodes, such as master and data nodes, so this flexibility is often provided for every node type.</span></span>

<span data-ttu-id="83a98-229">Conforme você começa a clusters toodeploy qualquer significativo, começar toowork com esses cenários complexos.</span><span class="sxs-lookup"><span data-stu-id="83a98-229">As you start toodeploy clusters of any significance, you begin toowork with these complex scenarios.</span></span> <span data-ttu-id="83a98-230">Se você foram Implantando um cluster Hadoop, por exemplo, com 8 nós mestres e nós de 200 dados e em pool 4 discos anexados em cada nó mestre e em pool 16 discos anexados por nó de dados, você teria 208 VMs e 3,232 discos toomanage.</span><span class="sxs-lookup"><span data-stu-id="83a98-230">If you were deploying a Hadoop cluster, for example, with 8 master nodes and 200 data nodes, and pooled 4 attached disks on each master node and pooled 16 attached disks per data node, you would have 208 VMs and 3,232 disks toomanage.</span></span>

<span data-ttu-id="83a98-231">Uma conta de armazenamento será acelerador solicitações acima que seu 20.000 identificado transações/segundo limite, para que você deve examinar o particionamento de conta de armazenamento e usar cálculos número apropriado de saudação de toodetermine de armazenamento contas tooaccommodate esta topologia.</span><span class="sxs-lookup"><span data-stu-id="83a98-231">A storage account will throttle requests above its identified 20,000 transactions/second limit, so you should look at storage account partitioning and use calculations toodetermine hello appropriate number of storage accounts tooaccommodate this topology.</span></span> <span data-ttu-id="83a98-232">Considerando várias Olá combinações com suporte pela abordagem de forma livre hello, cálculos dinâmicos são toodetermine necessário Olá particionamento apropriadas.</span><span class="sxs-lookup"><span data-stu-id="83a98-232">Given hello multitude of combinations supported by hello free-form approach, dynamic calculations are required toodetermine hello appropriate partitioning.</span></span> <span data-ttu-id="83a98-233">saudação de linguagem de modelo do Gerenciador de recursos do Azure não oferece atualmente funções matemáticas, portanto, você deve executar esses cálculos no código, gerar um modelo exclusivo, codificada com detalhes apropriados hello.</span><span class="sxs-lookup"><span data-stu-id="83a98-233">hello Azure Resource Manager Template Language does not presently provide mathematical functions, so you must perform these calculations in code, generating a unique, hard-coded template with hello appropriate details.</span></span>

<span data-ttu-id="83a98-234">Em cenários de SI e TI empresarial, alguém deve manter Olá modelos e suporte a topologias Olá implantado para organizações de um ou mais.</span><span class="sxs-lookup"><span data-stu-id="83a98-234">In enterprise IT and SI scenarios, someone must maintain hello templates and support hello deployed topologies for one or more organizations.</span></span> <span data-ttu-id="83a98-235">Essa sobrecarga adicional - diferentes configurações e modelos para cada cliente - está longe de ser desejável.</span><span class="sxs-lookup"><span data-stu-id="83a98-235">This additional overhead — different configurations and templates for each customer — is far from desirable.</span></span>

<span data-ttu-id="83a98-236">Você pode usar esses ambientes de toodeploy modelos na assinatura do Azure do cliente, mas as equipes de TI corporativos e CSVs normalmente implantação-los em suas próprias assinaturas, usando um toobill de função de estorno seus clientes.</span><span class="sxs-lookup"><span data-stu-id="83a98-236">You can use these templates toodeploy environments in your customer’s Azure subscription, but both corporate IT teams and CSVs typically deploy them into their own subscriptions, using a chargeback function toobill their customers.</span></span> <span data-ttu-id="83a98-237">Nesses cenários, o objetivo de saudação é toodeploy capacidade para vários clientes em um pool de assinaturas e implantações de manter densamente populadas no hello assinaturas toominimize assinatura proliferação — ou seja, mais toomanage de assinaturas.</span><span class="sxs-lookup"><span data-stu-id="83a98-237">In these scenarios, hello goal is toodeploy capacity for multiple customers across a pool of subscriptions and keep deployments densely populated into hello subscriptions toominimize subscription sprawl—that is, more subscriptions toomanage.</span></span> <span data-ttu-id="83a98-238">Com tamanhos de implantação verdadeiramente dinâmico para alcançar esse tipo de densidade requer um planejamento cuidadoso e desenvolvimento adicional para o trabalho de estrutura em nome da organização hello.</span><span class="sxs-lookup"><span data-stu-id="83a98-238">With truly dynamic deployment sizes, achieving this type of density requires careful planning and additional development for scaffolding work on behalf of hello organization.</span></span>

<span data-ttu-id="83a98-239">Além disso, você não pode criar assinaturas por meio de uma chamada de API, mas deve fazê-lo manualmente por meio do portal hello.</span><span class="sxs-lookup"><span data-stu-id="83a98-239">In addition, you can’t create subscriptions via an API call but must do so manually through hello portal.</span></span> <span data-ttu-id="83a98-240">Conforme aumenta o número Olá de assinaturas, qualquer acúmulo assinatura resultante requer intervenção humana, ele não pode ser automatizado.</span><span class="sxs-lookup"><span data-stu-id="83a98-240">As hello number of subscriptions increases, any resulting subscription sprawl requires human intervention—it can’t be automated.</span></span> <span data-ttu-id="83a98-241">Com grande variabilidade em tamanhos de saudação de implantações, você teria toopre provisionar um número de assinaturas manualmente tooensure assinaturas estão disponíveis.</span><span class="sxs-lookup"><span data-stu-id="83a98-241">With so much variability in hello sizes of deployments, you would have toopre-provision a number of subscriptions manually tooensure subscriptions are available.</span></span>

<span data-ttu-id="83a98-242">Considerando todos esses fatores, uma configuração de forma verdadeiramente livre é menos atraente do que parece à primeira vista.</span><span class="sxs-lookup"><span data-stu-id="83a98-242">Considering all these factors, a truly free-form configuration is less appealing than at first blush.</span></span>

### <a name="known-configurations--hello-t-shirt-sizing-approach"></a><span data-ttu-id="83a98-243">Conhecido configurações — Olá abordagem de dimensionamento de camisa</span><span class="sxs-lookup"><span data-stu-id="83a98-243">Known configurations — hello t-shirt sizing approach</span></span>
<span data-ttu-id="83a98-244">Em vez disso, que oferecem um modelo que oferece total flexibilidade e inúmeras variações, em nossa experiência um padrão comum é tooprovide Olá capacidade tooselect conhecido configurações — em vigor, os tamanhos de camisa padrão como área restrita, pequena, média e grande.</span><span class="sxs-lookup"><span data-stu-id="83a98-244">Rather than offer a template that provides total flexibility and countless variations, in our experience a common pattern is tooprovide hello ability tooselect known configurations — in effect, standard t-shirt sizes such as sandbox, small, medium, and large.</span></span> <span data-ttu-id="83a98-245">Outros exemplos de tamanhos de camiseta são ofertas de produtos, como community edition ou enterprise edition.</span><span class="sxs-lookup"><span data-stu-id="83a98-245">Other examples of t-shirt sizes are product offerings, such as community edition or enterprise edition.</span></span>  <span data-ttu-id="83a98-246">Em outros casos, podem se tratar de configurações de uma tecnologia específicas para uma determinada carga de trabalho - como mapear/reduzir ou no SQL.</span><span class="sxs-lookup"><span data-stu-id="83a98-246">In other cases, it may be workload-specific configurations of a technology – such as map reduce or no sql.</span></span>

<span data-ttu-id="83a98-247">Muitas organizações de TI empresarial, fornecedores de software livre e SIs disponibilizam hoje suas ofertas dessa maneira em ambientes virtualizados (empresas) locais ou como ofertas de SaaS (software como serviço) - CSVs e OSVs.</span><span class="sxs-lookup"><span data-stu-id="83a98-247">Many enterprise IT organizations, OSS vendors, and SIs make their offerings available today in this way in on-premises, virtualized environments (enterprises) or as software-as-a-service (SaaS) offerings (CSVs and OSVs).</span></span>

<span data-ttu-id="83a98-248">Essa abordagem fornece boas configurações conhecidas, de tamanhos variados que são pré-configurados para os clientes.</span><span class="sxs-lookup"><span data-stu-id="83a98-248">This approach provides good, known configurations of varying sizes that are preconfigured for customers.</span></span> <span data-ttu-id="83a98-249">Sem configurações conhecidas, clientes finais devem determinar dimensionamento do cluster por conta própria, leve em restrições de recursos de plataforma e faça a matemática tooidentify Olá resultante de contas de armazenamento e outros recursos (vencimento toocluster tamanho e o recurso de particionamento restrições).</span><span class="sxs-lookup"><span data-stu-id="83a98-249">Without known configurations, end customers must determine cluster sizing on their own, factor in platform resource constraints, and do math tooidentify hello resulting partitioning of storage accounts and other resources (due toocluster size and resource constraints).</span></span> <span data-ttu-id="83a98-250">Conhecido configurações Habilitar tamanho Olá selecione camisa certo tooeasily clientes — ou seja, uma determinada implantação.</span><span class="sxs-lookup"><span data-stu-id="83a98-250">Known configurations enable customers tooeasily select hello right t-shirt size—that is, a given deployment.</span></span> <span data-ttu-id="83a98-251">Além disso toomaking uma melhor experiência de cliente Olá, um pequeno número de configurações conhecidas é mais fácil toosupport e pode ajudar a fornecer um nível mais alto de densidade.</span><span class="sxs-lookup"><span data-stu-id="83a98-251">In addition toomaking a better experience for hello customer, a small number of known configurations is easier toosupport and can help you deliver a higher level of density.</span></span>

<span data-ttu-id="83a98-252">Uma abordagem de configuração conhecida voltada para tamanhos de camiseta também pode ter um número variável de nós em um determinado tamanho.</span><span class="sxs-lookup"><span data-stu-id="83a98-252">A known configuration approach focused on t-shirt sizes may also have varying number of nodes within a size.</span></span> <span data-ttu-id="83a98-253">Por exemplo, um tamanho de camiseta pequeno pode ter entre 3 e 10 nós.</span><span class="sxs-lookup"><span data-stu-id="83a98-253">For example, a small t-shirt size may be between 3 and 10 nodes.</span></span>  <span data-ttu-id="83a98-254">tamanho de camisa Olá seria projetado tooaccommodate backup too10 nós e fornecer Olá seleções de forma livre de toomake consumidor Olá capacidade toohello tamanho máximo identificado.</span><span class="sxs-lookup"><span data-stu-id="83a98-254">hello t-shirt size would be designed tooaccommodate up too10 nodes and provide hello consumer hello ability toomake free form selections up toohello maximum size identified.</span></span>  

<span data-ttu-id="83a98-255">Um tamanho de camisa com base no tipo de carga de trabalho, pode ser mais forma livre por natureza em termos de número de saudação de nós que podem ser implantados, mas terá o tamanho de nó distintos de carga de trabalho e a configuração do software Olá nó hello.</span><span class="sxs-lookup"><span data-stu-id="83a98-255">A t-shirt size based on workload type, may be more free form in nature in terms of hello number of nodes that can be deployed but will have workload distinct node size and configuration of hello software on hello node.</span></span>

<span data-ttu-id="83a98-256">Tamanhos de roupa com base em ofertas de produtos, como comunidade ou Enterprise, pode ter tipos distintos de recursos e o número máximo de nós que podem ser implantados, tipicamente ligados toolicensing considerações ou disponibilidade de recursos entre as diferentes ofertas hello.</span><span class="sxs-lookup"><span data-stu-id="83a98-256">T-shirt sizes based on product offerings, such as community or Enterprise, may have distinct resource types and maximum number of nodes that can be deployed, typically tied toolicensing considerations or feature availability across hello different offerings.</span></span>

<span data-ttu-id="83a98-257">Você também pode acomodar clientes com variantes exclusivos usando modelos de saudação com base em JSON.</span><span class="sxs-lookup"><span data-stu-id="83a98-257">You can also accommodate customers with unique variants using hello JSON-based templates.</span></span> <span data-ttu-id="83a98-258">Ao lidar com exceções, você pode incorporar o planejamento adequado hello e considerações para o desenvolvimento, suporte e custos.</span><span class="sxs-lookup"><span data-stu-id="83a98-258">When dealing with outliers, you can incorporate hello appropriate planning and considerations for development, support, and costing.</span></span>

<span data-ttu-id="83a98-259">Com base em requisitos identificados no início de saudação deste documento e cenários de consumo de modelo de cliente de saudação, identificamos um padrão de Decomposição de modelo.</span><span class="sxs-lookup"><span data-stu-id="83a98-259">Based on hello customer template consumption scenarios, and requirements identified at hello start of this document, we identified a pattern for template decomposition.</span></span>

## <a name="capacity-and-capability-scoped-solution-templates"></a><span data-ttu-id="83a98-260">Modelos de solução no escopo de capacidade e funcionalidade</span><span class="sxs-lookup"><span data-stu-id="83a98-260">Capacity and capability-scoped solution templates</span></span>
<span data-ttu-id="83a98-261">Decomposição fornece desenvolvimento de tootemplate uma abordagem modular que dá suporte à reutilização de extensibilidade, teste e ferramentas.</span><span class="sxs-lookup"><span data-stu-id="83a98-261">Decomposition provides a modular approach tootemplate development that supports reuse, extensibility, testing, and tooling.</span></span> <span data-ttu-id="83a98-262">Esta seção fornece detalhes sobre como uma abordagem de Decomposição pode ser aplicadas tootemplates com um escopo de capacidade ou recursos.</span><span class="sxs-lookup"><span data-stu-id="83a98-262">This section provides detail on how a decomposition approach can be applied tootemplates with a Capacity or Capability scope.</span></span>

<span data-ttu-id="83a98-263">Nessa abordagem, um modelo principal recebe valores de parâmetro de um consumidor de modelo, em seguida, vincula tooseveral tipos de modelos e scripts de downstream, conforme mostrado abaixo.</span><span class="sxs-lookup"><span data-stu-id="83a98-263">In this approach, a main template receives parameter values from a template consumer, then links tooseveral types of templates and scripts downstream as shown below.</span></span> <span data-ttu-id="83a98-264">Parâmetros, variáveis estáticas e gerados variáveis são valores de tooprovide usado dentro e fora de modelos de saudação vinculado.</span><span class="sxs-lookup"><span data-stu-id="83a98-264">Parameters, static variables, and generated variables are used tooprovide values in and out of hello linked templates.</span></span>

![Parâmetros de modelo](./media/best-practices-resource-manager-design-templates/template-parameters.png)

<span data-ttu-id="83a98-266">**Os parâmetros são passados modelo principal tooa e modelos de toolinked**</span><span class="sxs-lookup"><span data-stu-id="83a98-266">**Parameters are passed tooa main template then toolinked templates**</span></span>

<span data-ttu-id="83a98-267">Olá foco seções a seguir em tipos de saudação de modelos e scripts que um único modelo é decomposto em.</span><span class="sxs-lookup"><span data-stu-id="83a98-267">hello following sections focus on hello types of templates and scripts that a single template is decomposed into.</span></span> <span data-ttu-id="83a98-268">seções de saudação apresentam abordagens para transmitir informações de estado entre modelos de saudação.</span><span class="sxs-lookup"><span data-stu-id="83a98-268">hello sections present approaches for passing state information among hello templates.</span></span> <span data-ttu-id="83a98-269">Cada modelo e hello tipos de script na imagem de saudação são descritos junto com exemplos.</span><span class="sxs-lookup"><span data-stu-id="83a98-269">Each template and hello script types in hello image are described along with examples.</span></span> <span data-ttu-id="83a98-270">Para obter um exemplo contextual, consulte "Juntando as peças: um exemplo de implementação", mais adiante neste documento.</span><span class="sxs-lookup"><span data-stu-id="83a98-270">For a contextual example, see "Putting it together: a sample implementation" later in this document.</span></span>

### <a name="template-metadata"></a><span data-ttu-id="83a98-271">Metadados de modelo</span><span class="sxs-lookup"><span data-stu-id="83a98-271">Template metadata</span></span>
<span data-ttu-id="83a98-272">Metadados de modelo (arquivo de metadata.json Olá) contém pares chave/valor que descrevem um modelo em JSON, que pode ser lido por humanos e sistemas de software.</span><span class="sxs-lookup"><span data-stu-id="83a98-272">Template metadata (hello metadata.json file) contains key/value pairs that describe a template in JSON, which can be read by humans and software systems.</span></span>

![Metadados de modelo](./media/best-practices-resource-manager-design-templates/template-metadata.png)

<span data-ttu-id="83a98-274">**Metadados do modelo é descrito no arquivo de metadata.json de saudação**</span><span class="sxs-lookup"><span data-stu-id="83a98-274">**Template metadata is described in hello metadata.json file**</span></span>

<span data-ttu-id="83a98-275">Os agentes do software podem recuperar Olá metadata.json arquivo e publicar informações de saudação e um modelo de toohello link em uma página da web ou o diretório.</span><span class="sxs-lookup"><span data-stu-id="83a98-275">Software agents can retrieve hello metadata.json file and publish hello information and a link toohello template in a web page or directory.</span></span> <span data-ttu-id="83a98-276">Os elementos incluem *itemDisplayName*, *description*, *summary*, *githubUsername* e *dateUpdated*.</span><span class="sxs-lookup"><span data-stu-id="83a98-276">Elements include *itemDisplayName*, *description*, *summary*, *githubUsername*, and *dateUpdated*.</span></span>

<span data-ttu-id="83a98-277">Um exemplo de arquivo é mostrado abaixo em sua totalidade.</span><span class="sxs-lookup"><span data-stu-id="83a98-277">An example file is shown below in its entirety.</span></span>

    {
        "itemDisplayName": "PostgreSQL 9.3 on Ubuntu VMs",
        "description": "This template creates a PostgreSQL streaming-replication between a master and one or more slave servers each with 2 striped data disks. hello database servers are deployed into a private-only subnet with one publicly accessible jumpbox VM in a DMZ subnet with public IP.",
        "summary": "PostgreSQL stream-replication with multiple slave servers and a publicly accessible jumpbox VM",
        "githubUsername": "arsenvlad",
        "dateUpdated": "2015-04-24"
    }

### <a name="main-template"></a><span data-ttu-id="83a98-278">Modelo principal</span><span class="sxs-lookup"><span data-stu-id="83a98-278">Main template</span></span>
<span data-ttu-id="83a98-279">modelo principal Olá recebe parâmetros de um usuário, usa variáveis informações toopopulate objeto complexo e executa modelos Olá vinculado.</span><span class="sxs-lookup"><span data-stu-id="83a98-279">hello main template receives parameters from a user, uses that information toopopulate complex object variables, and executes hello linked templates.</span></span>

![Modelo principal](./media/best-practices-resource-manager-design-templates/main-template.png)

<span data-ttu-id="83a98-281">**modelo principal Olá recebe parâmetros de um usuário**</span><span class="sxs-lookup"><span data-stu-id="83a98-281">**hello main template receives parameters from a user**</span></span>

<span data-ttu-id="83a98-282">Um parâmetro que é fornecido é um tipo de configuração também conhecido como Olá camisa parâmetro de tamanho devido a seus valores padronizados como pequeno, médio ou grande.</span><span class="sxs-lookup"><span data-stu-id="83a98-282">One parameter that is provided is a known configuration type also known as hello t-shirt size parameter because of its standardized values such as small, medium, or large.</span></span> <span data-ttu-id="83a98-283">Na prática, você pode usar esse parâmetro de várias maneiras.</span><span class="sxs-lookup"><span data-stu-id="83a98-283">In practice, you can use this parameter in multiple ways.</span></span> <span data-ttu-id="83a98-284">Para obter detalhes, consulte "Modelo de recursos de configuração conhecida", posteriormente neste documento.</span><span class="sxs-lookup"><span data-stu-id="83a98-284">For details, see "Known configuration resources template" later in this document.</span></span>

<span data-ttu-id="83a98-285">Alguns recursos são implantados, independentemente da configuração de saudação especificada pelo parâmetro de um usuário.</span><span class="sxs-lookup"><span data-stu-id="83a98-285">Some resources are deployed regardless of hello known configuration specified by a user parameter.</span></span> <span data-ttu-id="83a98-286">Esses recursos são provisionados usando um modelo de recurso compartilhado único e são compartilhados com outros modelos, portanto, modelo de recurso compartilhado Olá é executado primeiro.</span><span class="sxs-lookup"><span data-stu-id="83a98-286">These resources are provisioned using a single shared resource template and are shared by other templates, so hello shared resource template is run first.</span></span>

<span data-ttu-id="83a98-287">Alguns recursos são implantados opcionalmente, independentemente da configuração especificada de conhecidos hello.</span><span class="sxs-lookup"><span data-stu-id="83a98-287">Some resources are deployed optionally regardless of hello specified known configuration.</span></span>

### <a name="shared-resources-template"></a><span data-ttu-id="83a98-288">Modelo de recursos compartilhados</span><span class="sxs-lookup"><span data-stu-id="83a98-288">Shared resources template</span></span>
<span data-ttu-id="83a98-289">Esse modelo fornece recursos que são comuns a todas as configurações conhecidas.</span><span class="sxs-lookup"><span data-stu-id="83a98-289">This template delivers resources that are common across all known configurations.</span></span> <span data-ttu-id="83a98-290">Ele contém a rede virtual hello, conjuntos de disponibilidade e outros recursos que são necessários, independentemente do modelo de configuração de saudação que é implantado.</span><span class="sxs-lookup"><span data-stu-id="83a98-290">It contains hello virtual network, availability sets, and other resources that are required regardless of hello known configuration template that is deployed.</span></span>

![Recursos de modelo](./media/best-practices-resource-manager-design-templates/template-resources.png)

<span data-ttu-id="83a98-292">**Modelo de recursos compartilhados**</span><span class="sxs-lookup"><span data-stu-id="83a98-292">**Shared resources template**</span></span>

<span data-ttu-id="83a98-293">Nomes de recursos, como nome de rede virtual Olá baseiam-se no modelo principal hello.</span><span class="sxs-lookup"><span data-stu-id="83a98-293">Resource names, such as hello virtual network name, are based on hello main template.</span></span> <span data-ttu-id="83a98-294">Você pode especificá-los como uma variável no modelo ou recebê-los como um parâmetro de usuário hello, conforme exigido por sua organização.</span><span class="sxs-lookup"><span data-stu-id="83a98-294">You can specify them as a variable within that template or receive them as a parameter from hello user, as required by your organization.</span></span>

### <a name="optional-resources-template"></a><span data-ttu-id="83a98-295">Modelo de recursos opcionais</span><span class="sxs-lookup"><span data-stu-id="83a98-295">Optional resources template</span></span>
<span data-ttu-id="83a98-296">modelo de recursos opcionais de saudação contém recursos que são implantados por meio de programação com base no valor de saudação de um parâmetro ou variável.</span><span class="sxs-lookup"><span data-stu-id="83a98-296">hello optional resources template contains resources that are programmatically deployed based on hello value of a parameter or variable.</span></span>

![Recursos opcionais](./media/best-practices-resource-manager-design-templates/optional-resources.png)

<span data-ttu-id="83a98-298">**Modelo de recursos opcionais**</span><span class="sxs-lookup"><span data-stu-id="83a98-298">**Optional resources template**</span></span>

<span data-ttu-id="83a98-299">Por exemplo, você pode usar um modelo de recursos opcionais tooconfigure um jumpbox que permite acesso indireto tooa implantado ambiente da saudação Internet pública.</span><span class="sxs-lookup"><span data-stu-id="83a98-299">For example, you can use an optional resources template tooconfigure a jumpbox that enables indirect access tooa deployed environment from hello public Internet.</span></span> <span data-ttu-id="83a98-300">Você usaria um parâmetro ou variável tooidentify se Olá jumpbox deve ser habilitada e hello *concat* função como o nome de destino toobuild Olá para hello, *jumpbox_enabled.json*.</span><span class="sxs-lookup"><span data-stu-id="83a98-300">You would use a parameter or variable tooidentify whether hello jumpbox should be enabled and hello *concat* function toobuild hello target name for hello template, such as *jumpbox_enabled.json*.</span></span> <span data-ttu-id="83a98-301">Modelo de vinculação usaria Olá resultante tooinstall variável Olá jumpbox.</span><span class="sxs-lookup"><span data-stu-id="83a98-301">Template linking would use hello resulting variable tooinstall hello jumpbox.</span></span>

<span data-ttu-id="83a98-302">Você pode vincular o modelo de recursos opcionais de saudação de vários locais:</span><span class="sxs-lookup"><span data-stu-id="83a98-302">You can link hello optional resources template from multiple places:</span></span>

* <span data-ttu-id="83a98-303">Quando aplicável tooevery implantação, criar um link orientado por parâmetros de modelo de recursos compartilhados hello.</span><span class="sxs-lookup"><span data-stu-id="83a98-303">When applicable tooevery deployment, create a parameter-driven link from hello shared resources template.</span></span>
* <span data-ttu-id="83a98-304">Quando aplicável tooselect conhecido configurações — por exemplo, instalar somente em grandes implantações — criar um link orientado por parâmetros ou orientado a variável de modelo de configuração de saudação.</span><span class="sxs-lookup"><span data-stu-id="83a98-304">When applicable tooselect known configurations—for example, only install on large deployments—create a parameter-driven or variable-driven link from hello known configuration template.</span></span>

<span data-ttu-id="83a98-305">Se um determinado recurso é opcional pode não ser controlada pelo consumidor de modelo Olá mas pelo provedor de modelos de saudação.</span><span class="sxs-lookup"><span data-stu-id="83a98-305">Whether a given resource is optional may not be driven by hello template consumer but instead by hello template provider.</span></span> <span data-ttu-id="83a98-306">Por exemplo, talvez seja necessário toosatisfy um requisito de produto específico ou complemento do produto (comum para CSVs) ou políticas tooenforce (comuns para SIs e a TI empresarial grupos).</span><span class="sxs-lookup"><span data-stu-id="83a98-306">For example, you may need toosatisfy a particular product requirement or product add-on (common for CSVs) or tooenforce policies (common for SIs and enterprise IT groups).</span></span> <span data-ttu-id="83a98-307">Nesses casos, você pode usar uma variável tooidentify se o recurso de saudação deve ser implantado.</span><span class="sxs-lookup"><span data-stu-id="83a98-307">In these cases, you can use a variable tooidentify whether hello resource should be deployed.</span></span>

### <a name="known-configuration-resources-template"></a><span data-ttu-id="83a98-308">Modelo de recursos de configuração conhecida</span><span class="sxs-lookup"><span data-stu-id="83a98-308">Known configuration resources template</span></span>
<span data-ttu-id="83a98-309">No modelo principal de saudação, um parâmetro pode ser exposto tooallow Olá modelo consumidor toospecify toodeploy uma configuração desejada.</span><span class="sxs-lookup"><span data-stu-id="83a98-309">In hello main template, a parameter can be exposed tooallow hello template consumer toospecify a desired known configuration toodeploy.</span></span> <span data-ttu-id="83a98-310">Muitas vezes, essa configuração usa uma abordagem de tamanho de camiseta com um conjunto de tamanhos de configuração fixa, como área restrita, pequeno, médio e grande.</span><span class="sxs-lookup"><span data-stu-id="83a98-310">Often, this known configuration uses a t-shirt size approach with a set of fixed configuration sizes such as sandbox, small, medium, and large.</span></span>

![Recursos de configuração conhecida](./media/best-practices-resource-manager-design-templates/known-config.png)

<span data-ttu-id="83a98-312">**Modelo de recursos de configuração conhecida**</span><span class="sxs-lookup"><span data-stu-id="83a98-312">**Known configuration resources template**</span></span>

<span data-ttu-id="83a98-313">abordagem de tamanho de camisa Olá é comumente usada, mas os parâmetros de saudação podem representar qualquer conjunto de configurações conhecidas.</span><span class="sxs-lookup"><span data-stu-id="83a98-313">hello t-shirt size approach is commonly used, but hello parameters can represent any set of known configurations.</span></span> <span data-ttu-id="83a98-314">Por exemplo, você pode especificar um conjunto de ambientes para um aplicativo empresarial como Development, Test e Product.</span><span class="sxs-lookup"><span data-stu-id="83a98-314">For example, you can specify a set of environments for an enterprise application such as Development, Test, and Product.</span></span> <span data-ttu-id="83a98-315">Ou você pode usá-lo para um toorepresent de serviço de nuvem diferente dimensionar unidades, versões ou configurações de produto como comunidade, Developer ou Enterprise.</span><span class="sxs-lookup"><span data-stu-id="83a98-315">Or you could use it for a cloud service toorepresent different scale units, product versions, or product configurations such as Community, Developer, or Enterprise.</span></span>

<span data-ttu-id="83a98-316">Como com o modelo de recurso compartilhado hello, variáveis são passadas toohello modelo de configurações conhecidas do:</span><span class="sxs-lookup"><span data-stu-id="83a98-316">As with hello shared resource template, variables are passed toohello known configurations template from either:</span></span>

* <span data-ttu-id="83a98-317">Um usuário final – ou seja, os parâmetros de saudação enviados modelo principal toohello.</span><span class="sxs-lookup"><span data-stu-id="83a98-317">An end user—that is, hello parameters sent toohello main template.</span></span>
* <span data-ttu-id="83a98-318">Uma organização — ou seja, Olá variáveis no modelo principal Olá que representam requisitos internos ou políticas.</span><span class="sxs-lookup"><span data-stu-id="83a98-318">An organization—that is, hello variables in hello main template that represent internal requirements or policies.</span></span>

### <a name="member-resources-template"></a><span data-ttu-id="83a98-319">Modelo de recursos de membro</span><span class="sxs-lookup"><span data-stu-id="83a98-319">Member resources template</span></span>
<span data-ttu-id="83a98-320">Em uma configuração conhecida, um ou mais tipos de nó de membro costumam ser incluídos.</span><span class="sxs-lookup"><span data-stu-id="83a98-320">Within a known configuration, one or more member node types are often included.</span></span> <span data-ttu-id="83a98-321">Por exemplo, com o Hadoop, você tem nós mestres e nós de dados.</span><span class="sxs-lookup"><span data-stu-id="83a98-321">For example, with Hadoop you have master nodes and data nodes.</span></span> <span data-ttu-id="83a98-322">Se estiver instalando o MongoDB, você terá nós de dados e um arbitrador.</span><span class="sxs-lookup"><span data-stu-id="83a98-322">If you are installing MongoDB, you have data nodes and an arbiter.</span></span> <span data-ttu-id="83a98-323">Se está implantando o DataStax, você tem nós de dados e uma máquina virtual com OpsCenter instalado.</span><span class="sxs-lookup"><span data-stu-id="83a98-323">If you are deploying DataStax, you have data nodes and a VM with OpsCenter installed.</span></span>

![Recursos de membros](./media/best-practices-resource-manager-design-templates/member-resources.png)

<span data-ttu-id="83a98-325">**Modelo de recursos de membro**</span><span class="sxs-lookup"><span data-stu-id="83a98-325">**Member resources template**</span></span>

<span data-ttu-id="83a98-326">Cada tipo de nós pode ter diferentes tamanhos de máquinas virtuais, número de discos anexados, scripts tooinstall e configurar nós hello, configurações de porta para Olá VMs, número de instâncias e outros detalhes.</span><span class="sxs-lookup"><span data-stu-id="83a98-326">Each type of nodes can have different sizes of VMs, numbers of attached disks, scripts tooinstall and set up hello nodes, port configurations for hello VMs, number of instances, and other details.</span></span> <span data-ttu-id="83a98-327">Para que cada tipo de nó obtém seu próprio modelo de recursos de membro, que contém a saudação detalhes para implantar e configurar uma infraestrutura, bem como executar scripts toodeploy e configurar o software em Olá VM.</span><span class="sxs-lookup"><span data-stu-id="83a98-327">So each node type gets its own member resource template, which contains hello details for deploying and configuring an infrastructure as well as executing scripts toodeploy and configure software within hello VM.</span></span>

<span data-ttu-id="83a98-328">Para VMs, geralmente dois tipos de scripts são utilizados: os amplamente reutilizáveis e os personalizados.</span><span class="sxs-lookup"><span data-stu-id="83a98-328">For VMs, typically two types of scripts are used, widely reusable and custom scripts.</span></span>

### <a name="widely-reusable-scripts"></a><span data-ttu-id="83a98-329">Scripts amplamente reutilizáveis</span><span class="sxs-lookup"><span data-stu-id="83a98-329">Widely reusable scripts</span></span>
<span data-ttu-id="83a98-330">Scripts amplamente reutilizáveis podem ser usados em vários tipos de modelos.</span><span class="sxs-lookup"><span data-stu-id="83a98-330">Widely reusable scripts can be used across multiple types of templates.</span></span> <span data-ttu-id="83a98-331">Um dos exemplos de melhor Olá desses scripts reutilizáveis amplamente configura RAID em Linux toopool discos e obter um maior número de IOPS.</span><span class="sxs-lookup"><span data-stu-id="83a98-331">One of hello better examples of these widely reusable scripts sets up RAID on Linux toopool disks and gain a greater number of IOPS.</span></span> <span data-ttu-id="83a98-332">Independentemente do software Olá sendo instalado na VM de hello, o script fornece reutilização das práticas comprovadas para cenários comuns.</span><span class="sxs-lookup"><span data-stu-id="83a98-332">Regardless of hello software being installed in hello VM, this script provides reuse of proven practices for common scenarios.</span></span>

![Scripts reutilizáveis](./media/best-practices-resource-manager-design-templates/reusable-scripts.png)

<span data-ttu-id="83a98-334">**Modelos de recursos de membro podem chamar scripts amplamente reutilizáveis**</span><span class="sxs-lookup"><span data-stu-id="83a98-334">**Member resources templates can call widely reusable scripts**</span></span>

### <a name="custom-scripts"></a><span data-ttu-id="83a98-335">Scripts personalizados</span><span class="sxs-lookup"><span data-stu-id="83a98-335">Custom scripts</span></span>
<span data-ttu-id="83a98-336">Modelos normalmente chamam um ou mais scripts que instalam e configuram software em máquinas virtuais.</span><span class="sxs-lookup"><span data-stu-id="83a98-336">Templates commonly call one or more scripts that install and configure software within VMs.</span></span> <span data-ttu-id="83a98-337">Um padrão comum é visto com grandes topologias em que várias instâncias de um ou mais tipos de membro são implantadas.</span><span class="sxs-lookup"><span data-stu-id="83a98-337">A common pattern is seen with large topologies where multiple instances of one or more member types are deployed.</span></span> <span data-ttu-id="83a98-338">Um script de instalação é iniciado para cada VM que pode ser executada em paralelo, seguido por um script de instalação que é chamado depois que todas as máquinas virtuais (ou todas as máquinas virtuais de um determinado tipo de membro) são implantadas.</span><span class="sxs-lookup"><span data-stu-id="83a98-338">An installation script is initiated for every VM that can be run in parallel, followed by a setup script that is called after all VMs (or all VMs of a given member type) are deployed.</span></span>

![Scripts personalizados](./media/best-practices-resource-manager-design-templates/custom-scripts.png)

<span data-ttu-id="83a98-340">**Modelos de recursos de membro podem chamar scripts para uma finalidade específica, como a configuração da VM**</span><span class="sxs-lookup"><span data-stu-id="83a98-340">**Member resources templates can call scripts for a specific purpose such as VM configuration**</span></span>

## <a name="capability-scoped-solution-template-example---redis"></a><span data-ttu-id="83a98-341">Exemplo de modelo de solução no escopo de funcionalidade - Redis</span><span class="sxs-lookup"><span data-stu-id="83a98-341">Capability-scoped solution template example - Redis</span></span>
<span data-ttu-id="83a98-342">tooshow como uma implementação pode funcionar, vamos examinar um exemplo prático de como criar um modelo que facilita a implantação de saudação e configuração do Redis em tamanhos de roupa padrão.</span><span class="sxs-lookup"><span data-stu-id="83a98-342">tooshow how an implementation might work, let's look at a practical example of building a template that facilitates hello deployment and configuration of Redis in standard t-shirt sizes.</span></span>  

<span data-ttu-id="83a98-343">Para implantação de hello, há um conjunto de recursos compartilhados (rede virtual, conta de armazenamento, conjuntos de disponibilidade) e um recurso opcional (jumpbox).</span><span class="sxs-lookup"><span data-stu-id="83a98-343">For hello deployment, there are a set of shared resources (virtual network, storage account, availability sets) and an optional resource (jumpbox).</span></span> <span data-ttu-id="83a98-344">Há várias configurações conhecidas representadas como tamanhos de camiseta (pequeno, médio, grande), mas cada uma com um único tipo de nó.</span><span class="sxs-lookup"><span data-stu-id="83a98-344">There are multiple known configurations represented as t-shirt sizes (small, medium, large) but each with a single node type.</span></span> <span data-ttu-id="83a98-345">Há também dois scripts específicos para a finalidade (instalação, configuração).</span><span class="sxs-lookup"><span data-stu-id="83a98-345">There are also two purpose-specific scripts (installation, configuration).</span></span>

### <a name="creating-hello-template-files"></a><span data-ttu-id="83a98-346">Criando arquivos de modelo de saudação</span><span class="sxs-lookup"><span data-stu-id="83a98-346">Creating hello template files</span></span>
<span data-ttu-id="83a98-347">Você cria um modelo principal chamado azuredeploy.json.</span><span class="sxs-lookup"><span data-stu-id="83a98-347">You would create a Main Template named azuredeploy.json.</span></span>

<span data-ttu-id="83a98-348">Você cria um modelo de recursos compartilhados chamado shared-resources.json</span><span class="sxs-lookup"><span data-stu-id="83a98-348">You create Shared Resources Template named shared-resources.json</span></span>

<span data-ttu-id="83a98-349">Criar um modelo de recurso opcional tooenable Olá de implantação um jumpbox, denominado jumpbox_enabled.json</span><span class="sxs-lookup"><span data-stu-id="83a98-349">You create an Optional Resource Template tooenable hello deployment of a jumpbox, named jumpbox_enabled.json</span></span>

<span data-ttu-id="83a98-350">O Redis usa apenas um tipo de nó, portanto, você cria um modelo único de recurso de membro chamado node-resources.json.</span><span class="sxs-lookup"><span data-stu-id="83a98-350">Redis uses just a single node type, so you create a single Member Resource Template named node-resources.json.</span></span>

<span data-ttu-id="83a98-351">Com Redis, você deseja tooinstall cada nó individual e, em seguida, configurar o cluster de saudação.</span><span class="sxs-lookup"><span data-stu-id="83a98-351">With Redis, you want tooinstall each individual node, and then set up hello cluster.</span></span>  <span data-ttu-id="83a98-352">Tem scripts tooaccommodate Olá instalação e configurar, install.sh de cluster de redis e setup.sh de cluster de redis.</span><span class="sxs-lookup"><span data-stu-id="83a98-352">You have scripts tooaccommodate hello installation and set up, redis-cluster-install.sh and redis-cluster-setup.sh.</span></span>

### <a name="linking-hello-templates"></a><span data-ttu-id="83a98-353">Modelos de saudação de vinculação</span><span class="sxs-lookup"><span data-stu-id="83a98-353">Linking hello templates</span></span>
<span data-ttu-id="83a98-354">Usando vinculação de modelo, modelo principal Olá vincula modelo de recursos compartilhados toohello, que estabelece a rede virtual hello.</span><span class="sxs-lookup"><span data-stu-id="83a98-354">Using template linking, hello main template links out toohello shared resources template, which establishes hello virtual network.</span></span>

<span data-ttu-id="83a98-355">Lógica é adicionada em consumidores de tooenable Olá modelo principal de saudação modelo toospecify se um jumpbox deve ser implantado.</span><span class="sxs-lookup"><span data-stu-id="83a98-355">Logic is added within hello main template tooenable consumers of hello template toospecify whether a jumpbox should be deployed.</span></span> <span data-ttu-id="83a98-356">Um *habilitado* valor Olá *EnableJumpbox* parâmetro indica que esse cliente Olá quer toodeploy um jumpbox.</span><span class="sxs-lookup"><span data-stu-id="83a98-356">An *enabled* value for hello *EnableJumpbox* parameter indicates that hello customer wants toodeploy a jumpbox.</span></span> <span data-ttu-id="83a98-357">Quando esse valor é fornecido, o modelo de saudação concatena *_enabled* como um nome de modelo base tooa sufixo para o recurso de jumpbox hello.</span><span class="sxs-lookup"><span data-stu-id="83a98-357">When this value is provided, hello template concatenates *_enabled* as a suffix tooa base template name for hello jumpbox capability.</span></span>

<span data-ttu-id="83a98-358">modelo principal Olá aplica Olá *grande* valor de parâmetro como um nome de modelo base tooa sufixo para tamanhos de roupa e, em seguida, usa esse valor em um link de modelo out muito*technology_on_os_large.json*.</span><span class="sxs-lookup"><span data-stu-id="83a98-358">hello main template applies hello *large* parameter value as a suffix tooa base template name for t-shirt sizes, and then uses that value in a template link out too*technology_on_os_large.json*.</span></span>

<span data-ttu-id="83a98-359">topologia de saudação seria semelhante a esta ilustração.</span><span class="sxs-lookup"><span data-stu-id="83a98-359">hello topology would resemble this illustration.</span></span>

![Modelo de Redis](./media/best-practices-resource-manager-design-templates/redis-template.png)

<span data-ttu-id="83a98-361">**Estrutura de modelo para um modelo de Redis**</span><span class="sxs-lookup"><span data-stu-id="83a98-361">**Template structure for a Redis template**</span></span>

### <a name="configuring-state"></a><span data-ttu-id="83a98-362">Configurando o estado</span><span class="sxs-lookup"><span data-stu-id="83a98-362">Configuring state</span></span>
<span data-ttu-id="83a98-363">Para nós de saudação em cluster Olá, há duas etapas tooconfiguring estado de hello, representadas por Scripts de finalidade específica.</span><span class="sxs-lookup"><span data-stu-id="83a98-363">For hello nodes in hello cluster, there are two steps tooconfiguring hello state, both represented by Purpose Specific Scripts.</span></span>  <span data-ttu-id="83a98-364">Redis instala "install.sh de cluster redis" e "setup.sh de cluster redis" configura o cluster hello.</span><span class="sxs-lookup"><span data-stu-id="83a98-364">"redis-cluster-install.sh" installs Redis and "redis-cluster-setup.sh" sets up hello cluster.</span></span>

### <a name="supporting-different-size-deployments"></a><span data-ttu-id="83a98-365">Suporte a implantações de tamanho diferente</span><span class="sxs-lookup"><span data-stu-id="83a98-365">Supporting Different Size Deployments</span></span>
<span data-ttu-id="83a98-366">Dentro de variáveis de modelo de tamanho de camisa Olá Especifica o número de saudação de nós de cada tipo de tamanho especificado de toodeploy para hello (*grande*).</span><span class="sxs-lookup"><span data-stu-id="83a98-366">Inside variables, hello t-shirt size template specifies hello number of nodes of each type toodeploy for hello specified size (*large*).</span></span> <span data-ttu-id="83a98-367">Em seguida, implanta esse número de instâncias VM usando loops de recursos, fornecendo tooresources nomes exclusivos, acrescentando o nome do nó com um número de sequência numérica de *copyIndex()*.</span><span class="sxs-lookup"><span data-stu-id="83a98-367">It then deploys that number of VM instances using resource loops, providing unique names tooresources by appending a node name with a numeric sequence number from *copyIndex()*.</span></span> <span data-ttu-id="83a98-368">Ele faz essas etapas para ambas as VMs de zona e a quente, conforme definido no modelo de nome de camisa Olá</span><span class="sxs-lookup"><span data-stu-id="83a98-368">It does these steps for both hot and warm zone VMs, as defined in hello t-shirt name template</span></span>

## <a name="decomposition-and-end-to-end-solution-scoped-templates"></a><span data-ttu-id="83a98-369">Modelos com escopo de solução de ponta a ponta e decomposição</span><span class="sxs-lookup"><span data-stu-id="83a98-369">Decomposition and end-to-end solution scoped templates</span></span>
<span data-ttu-id="83a98-370">Um modelo de solução com um escopo de solução de ponta a ponta se concentra em fornecer uma solução desse tipo.</span><span class="sxs-lookup"><span data-stu-id="83a98-370">A solution template with an end-to-end solution scope is focused on delivering an end-to-end solution.</span></span>  <span data-ttu-id="83a98-371">Normalmente, essa abordagem é uma composição de vários modelos com escopo de funcionalidade com recursos, lógica e estado adicionais.</span><span class="sxs-lookup"><span data-stu-id="83a98-371">This approach is typically a composition of multiple capability-scoped templates with additional resources, logic, and state.</span></span>

<span data-ttu-id="83a98-372">Conforme realçado na imagem de saudação abaixo, hello mesmo modelo usado para modelos de recurso com escopo é estendido para modelos com um escopo de solução de ponta a ponta.</span><span class="sxs-lookup"><span data-stu-id="83a98-372">As highlighted in hello image below, hello same model used for capability scoped templates is extended for templates with an End-to-End Solution Scope.</span></span>

<span data-ttu-id="83a98-373">Um modelo de recursos compartilhados e os modelos de recursos opcionais servem Olá a mesma função, como a capacidade de saudação no escopo do modelo abordagens, mas têm o escopo para solução de tooend Olá final.</span><span class="sxs-lookup"><span data-stu-id="83a98-373">A Shared Resources Template and Optional Resources Templates serve hello same function as in hello capacity and capability scoped template approaches, but are scoped for hello end tooend solution.</span></span>

<span data-ttu-id="83a98-374">Como o escopo da solução tooend modelos também podem normalmente têm tamanhos de roupa, modelo de recursos de configuração conhecido Olá reflete o que é necessário para uma determinada configuração conhecida de solução de saudação.</span><span class="sxs-lookup"><span data-stu-id="83a98-374">As end tooend solution scoped templates also can typically have t-shirt sizes, hello Known Configuration Resources template reflects what is required for a given known configuration of hello solution.</span></span>

<span data-ttu-id="83a98-375">Olá tooone de links de modelo de recursos de configuração conhecido ou mais capacidade de escopo modelos de solução solução tooend toohello relevantes, bem como Olá modelos de recursos de membro que são necessários para a solução tooend hello.</span><span class="sxs-lookup"><span data-stu-id="83a98-375">hello Known Configuration Resources Template links tooone or more capability scoped solution templates that are relevant toohello end tooend solution as well as hello Member Resource Templates that are required for hello end tooend solution.</span></span>

<span data-ttu-id="83a98-376">Como tamanho de camisa Olá de solução de saudação pode ser diferente de modelo de escopo do recurso de saudação individuais, variáveis em Olá conhecido modelo de configuração de recursos são tooprovide usado Olá os valores apropriados para a solução capacidade downstream no escopo modelos toodeploy Olá camisa tamanho apropriado.</span><span class="sxs-lookup"><span data-stu-id="83a98-376">As hello t-shirt size of hello solution may be different than hello individual capability-scoped template, variables within hello Known Configuration Resources Template are used tooprovide hello appropriate values for downstream capability scoped solution templates toodeploy hello appropriate t-shirt size.</span></span>

![Ponta a ponta](./media/best-practices-resource-manager-design-templates/end-to-end.png)

<span data-ttu-id="83a98-378">**modelo de saudação usado para a capacidade ou modelos de solução de recurso com escopo podem ser estendidos para escopos de modelo de solução final tooend prontamente**</span><span class="sxs-lookup"><span data-stu-id="83a98-378">**hello model used for capacity or capability scoped solution templates can be readily extended for end tooend solution template scopes**</span></span>

## <a name="preparing-templates-for-hello-marketplace"></a><span data-ttu-id="83a98-379">Preparando modelos para Olá Marketplace</span><span class="sxs-lookup"><span data-stu-id="83a98-379">Preparing templates for hello Marketplace</span></span>
<span data-ttu-id="83a98-380">Olá anterior abordagem prontamente acomoda cenários onde empresas, SIs e CSVs tooeither de deseja implantar modelos Olá sozinhos ou habilitar toodeploy seus clientes por conta própria.</span><span class="sxs-lookup"><span data-stu-id="83a98-380">hello preceding approach readily accommodates scenarios where Enterprises, SIs, and CSVs want tooeither deploy hello templates themselves or enable their customers toodeploy on their own.</span></span>

<span data-ttu-id="83a98-381">Outro cenário desejado está implantando um modelo por meio do marketplace hello.</span><span class="sxs-lookup"><span data-stu-id="83a98-381">Another desired scenario is deploying a template via hello marketplace.</span></span>  <span data-ttu-id="83a98-382">Essa abordagem de Decomposição funciona para o marketplace de hello, com algumas pequenas alterações.</span><span class="sxs-lookup"><span data-stu-id="83a98-382">This decomposition approach works for hello marketplace as well, with some minor changes.</span></span>

<span data-ttu-id="83a98-383">Conforme mencionado anteriormente, os modelos podem ser tipos de implantação distintas de toooffer usado para venda no mercado de saudação.</span><span class="sxs-lookup"><span data-stu-id="83a98-383">As mentioned previously, templates can be used toooffer distinct deployment types for sale in hello marketplace.</span></span> <span data-ttu-id="83a98-384">Tipos distintos de implantação podem ser tamanhos de camiseta (pequeno, médio, grande), tipo de produto/público (community, developer, enterprise) ou tipo de recurso (básico, de alta disponibilidade).</span><span class="sxs-lookup"><span data-stu-id="83a98-384">Distinct deployment types may be t-shirt sizes (small, medium, large), product/audience type (community, developer, enterprise), or feature type (basic, high availability).</span></span>

<span data-ttu-id="83a98-385">Como mostrado abaixo, Olá existente final tooend solução ou a funcionalidade de modelos de escopo podem ser prontamente utilizado toolist Olá diferentes configurações conhecidas no marketplace de saudação.</span><span class="sxs-lookup"><span data-stu-id="83a98-385">As shown below, hello existing end tooend solution or capability scoped templates can be readily utilized toolist hello different known configurations in hello marketplace.</span></span>

<span data-ttu-id="83a98-386">Olá parâmetros toohello principal são primeiro modificado tooremove Olá parâmetro de entrada denominado tshirtSize.</span><span class="sxs-lookup"><span data-stu-id="83a98-386">hello parameters toohello main template are first modified tooremove hello inbound parameter named tshirtSize.</span></span>

<span data-ttu-id="83a98-387">Enquanto a tipos de implantação distintas de saudação mapeiam toohello conhecido modelo de configuração de recursos, eles também precisam recursos comuns de saudação e configuração encontrada no hello modelo de recursos compartilhados e potencialmente os modelos de recursos opcionais.</span><span class="sxs-lookup"><span data-stu-id="83a98-387">While hello distinct deployment types map toohello Known Configuration Resources Template, they also need hello common resources and configuration found in hello Shared Resources Template and potentially those in Optional Resource Templates.</span></span>

<span data-ttu-id="83a98-388">Se você quiser toopublish marketplace de toohello seu modelo, você pode estabelecer cópias diferentes do seu modelo principal que substitui Olá anteriormente disponível parâmetro de entrada da variável de tooa tshirtSize inserido no modelo de saudação.</span><span class="sxs-lookup"><span data-stu-id="83a98-388">If you want toopublish your template toohello marketplace, you establish distinct copies of your Main template that replaces hello previously available inbound parameter of tshirtSize tooa variable embedded within hello template.</span></span>

![Marketplace](./media/best-practices-resource-manager-design-templates/marketplace.png)

<span data-ttu-id="83a98-390">**Adaptar uma solução no escopo do modelo para o marketplace Olá**</span><span class="sxs-lookup"><span data-stu-id="83a98-390">**Adapting a solution scoped template for hello marketplace**</span></span>

## <a name="next-steps"></a><span data-ttu-id="83a98-391">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="83a98-391">Next steps</span></span>
* <span data-ttu-id="83a98-392">toolearn sobre como compartilhar o estado dentro e fora de modelos, consulte [compartilhamento de estado em modelos do Azure Resource Manager](best-practices-resource-manager-state.md).</span><span class="sxs-lookup"><span data-stu-id="83a98-392">toolearn about sharing state into and out of templates, see [Sharing state in Azure Resource Manager templates](best-practices-resource-manager-state.md).</span></span>
* <span data-ttu-id="83a98-393">Para obter diretrizes sobre como as empresas podem usar o Gerenciador de recursos tooeffectively gerenciar assinaturas, consulte [scaffold enterprise do Azure - controle de assinatura prescritivas](resource-manager-subscription-governance.md).</span><span class="sxs-lookup"><span data-stu-id="83a98-393">For guidance on how enterprises can use Resource Manager tooeffectively manage subscriptions, see [Azure enterprise scaffold - prescriptive subscription governance](resource-manager-subscription-governance.md).</span></span>

