---
title: "aaaHow tooupdate um serviço de nuvem | Microsoft Docs"
description: "Saiba como os serviços de nuvem tooupdate no Azure. Saiba como uma atualização em um serviço de nuvem continuará tooensure disponibilidade."
services: cloud-services
documentationcenter: 
author: Thraka
manager: timlt
editor: 
ms.assetid: c6a8b5e6-5c99-454c-9911-5c7ae8d1af63
ms.service: cloud-services
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 04/19/2017
ms.author: adegeo
ms.openlocfilehash: 7e4c8bd46e51a555b4309ea8927d120e8efcf0ea
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="how-tooupdate-a-cloud-service"></a><span data-ttu-id="3896d-104">Como tooupdate um serviço de nuvem</span><span class="sxs-lookup"><span data-stu-id="3896d-104">How tooupdate a cloud service</span></span>

<span data-ttu-id="3896d-105">A atualização de um serviço de nuvem, incluindo suas funções e o SO convidado, é um processo que envolve três etapas.</span><span class="sxs-lookup"><span data-stu-id="3896d-105">Updating a cloud service, including both its roles and guest OS, is a three step process.</span></span> <span data-ttu-id="3896d-106">Primeiro, os binários de saudação e arquivos de configuração para Olá novo serviço de nuvem ou versão do sistema operacional deve ser carregado.</span><span class="sxs-lookup"><span data-stu-id="3896d-106">First, hello binaries and configuration files for hello new cloud service or OS version must be uploaded.</span></span> <span data-ttu-id="3896d-107">Em seguida, o Azure reservará recursos de computação e rede para o serviço de nuvem Olá com base nos requisitos de saudação da nova versão de serviço de nuvem hello.</span><span class="sxs-lookup"><span data-stu-id="3896d-107">Next, Azure reserves compute and network resources for hello cloud service based on hello requirements of hello new cloud service version.</span></span> <span data-ttu-id="3896d-108">Por fim, o Azure executa um sem interrupção tooincrementally atualização Olá locatário toohello nova versão de atualização ou o SO, enquanto preserva sua disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="3896d-108">Finally, Azure performs a rolling upgrade tooincrementally update hello tenant toohello new version or guest OS, while preserving your availability.</span></span> <span data-ttu-id="3896d-109">Este artigo aborda os detalhes de saudação nesta última etapa – Olá atualização sem interrupção.</span><span class="sxs-lookup"><span data-stu-id="3896d-109">This article discusses hello details of this last step – hello rolling upgrade.</span></span>

## <a name="update-an-azure-service"></a><span data-ttu-id="3896d-110">Atualizar um serviço do Azure</span><span class="sxs-lookup"><span data-stu-id="3896d-110">Update an Azure Service</span></span>
<span data-ttu-id="3896d-111">O Azure organiza suas instâncias de função em agrupamentos lógicos chamados de domínios de atualização (UD).</span><span class="sxs-lookup"><span data-stu-id="3896d-111">Azure organizes your role instances into logical groupings called upgrade domains (UD).</span></span> <span data-ttu-id="3896d-112">Os domínios de atualização (UD) são conjuntos lógicos de instâncias de função que são atualizados como um grupo.</span><span class="sxs-lookup"><span data-stu-id="3896d-112">Upgrade domains (UD) are logical sets of role instances that are updated as a group.</span></span>  <span data-ttu-id="3896d-113">Atualizações do Azure, uma nuvem de serviço um UD por vez, que permite que as instâncias em outros toocontinue UDs que serve o tráfego.</span><span class="sxs-lookup"><span data-stu-id="3896d-113">Azure updates a cloud service one UD at a time, which allows instances in other UDs toocontinue serving traffic.</span></span>

<span data-ttu-id="3896d-114">saudação padrão número de domínios de atualização é 5.</span><span class="sxs-lookup"><span data-stu-id="3896d-114">hello default number of upgrade domains is 5.</span></span> <span data-ttu-id="3896d-115">Você pode especificar um número diferente de domínios de atualização, incluindo o atributo de upgradeDomainCount Olá no arquivo de definição do serviço da saudação (. csdef).</span><span class="sxs-lookup"><span data-stu-id="3896d-115">You can specify a different number of upgrade domains by including hello upgradeDomainCount attribute in hello service’s definition file (.csdef).</span></span> <span data-ttu-id="3896d-116">Para obter mais informações sobre o atributo de upgradeDomainCount hello, consulte [esquema WebRole](https://msdn.microsoft.com/library/azure/gg557553.aspx) ou [esquema WorkerRole](https://msdn.microsoft.com/library/azure/gg557552.aspx).</span><span class="sxs-lookup"><span data-stu-id="3896d-116">For more information about hello upgradeDomainCount attribute, see [WebRole Schema](https://msdn.microsoft.com/library/azure/gg557553.aspx) or [WorkerRole Schema](https://msdn.microsoft.com/library/azure/gg557552.aspx).</span></span>

<span data-ttu-id="3896d-117">Quando você executa uma atualização in-loco de uma ou mais funções em seu serviço, o Azure atualiza conjuntos de instâncias de função de acordo com o toowhich de domínio de atualização toohello pertencem.</span><span class="sxs-lookup"><span data-stu-id="3896d-117">When you perform an in-place update of one or more roles in your service, Azure updates sets of role instances according toohello upgrade domain toowhich they belong.</span></span> <span data-ttu-id="3896d-118">Atualizações do Azure, todas as instâncias de saudação em um determinado domínio de atualização, interrompendo-as, atualizando-os, colocando-os online novamente, em seguida, move para o próximo domínio de saudação.</span><span class="sxs-lookup"><span data-stu-id="3896d-118">Azure updates all of hello instances in a given upgrade domain – stopping them, updating them, bringing them back on-line – then moves onto hello next domain.</span></span> <span data-ttu-id="3896d-119">Parando somente instâncias de saudação em execução em Olá atual domínio de atualização, o Azure garante que uma atualização ocorra com hello mínimo possível impacto toohello executando o serviço.</span><span class="sxs-lookup"><span data-stu-id="3896d-119">By stopping only hello instances running in hello current upgrade domain, Azure makes sure that an update occurs with hello least possible impact toohello running service.</span></span> <span data-ttu-id="3896d-120">Para obter mais informações, consulte [como atualização Olá continua](#howanupgradeproceeds) posteriormente neste artigo.</span><span class="sxs-lookup"><span data-stu-id="3896d-120">For more information, see [How hello update proceeds](#howanupgradeproceeds) later in this article.</span></span>

> [!NOTE]
> <span data-ttu-id="3896d-121">Embora os termos de saudação **atualizar** e **atualizar** tenham significados levemente diferentes no contexto de saudação do Azure, eles podem ser usados alternadamente para processos de saudação e descrições dos recursos de saudação neste documento.</span><span class="sxs-lookup"><span data-stu-id="3896d-121">While hello terms **update** and **upgrade** have slightly different meaning in hello context Azure, they can be used interchangeably for hello processes and descriptions of hello features in this document.</span></span>
>
>

<span data-ttu-id="3896d-122">O serviço deve definir pelo menos duas instâncias de uma função para essa função toobe atualizada in-loco sem tempo de inatividade.</span><span class="sxs-lookup"><span data-stu-id="3896d-122">Your service must define at least two instances of a role for that role toobe updated in-place without downtime.</span></span> <span data-ttu-id="3896d-123">Se o serviço Olá consiste em apenas uma instância de uma função, seu serviço estará disponível até que hello atualização in-loco seja concluída.</span><span class="sxs-lookup"><span data-stu-id="3896d-123">If hello service consists of only one instance of one role, your service will be unavailable until hello in-place update has finished.</span></span>

<span data-ttu-id="3896d-124">Este tópico aborda Olá informações sobre atualizações do Azure a seguir:</span><span class="sxs-lookup"><span data-stu-id="3896d-124">This topic covers hello following information about Azure updates:</span></span>

* [<span data-ttu-id="3896d-125">Alterações permitidas no serviço durante uma atualização</span><span class="sxs-lookup"><span data-stu-id="3896d-125">Allowed service changes during an update</span></span>](#AllowedChanges)
* [<span data-ttu-id="3896d-126">Como uma atualização é realizada</span><span class="sxs-lookup"><span data-stu-id="3896d-126">How an upgrade proceeds</span></span>](#howanupgradeproceeds)
* [<span data-ttu-id="3896d-127">Reversão de uma atualização</span><span class="sxs-lookup"><span data-stu-id="3896d-127">Rollback of an update</span></span>](#RollbackofanUpdate)
* [<span data-ttu-id="3896d-128">Inicialização de várias operações de mutação em uma implantação em andamento</span><span class="sxs-lookup"><span data-stu-id="3896d-128">Initiating multiple mutating operations on an ongoing deployment</span></span>](#multiplemutatingoperations)
* [<span data-ttu-id="3896d-129">Distribuição de funções em domínios de atualização</span><span class="sxs-lookup"><span data-stu-id="3896d-129">Distribution of roles across upgrade domains</span></span>](#distributiondfroles)

<a name="AllowedChanges"></a>

## <a name="allowed-service-changes-during-an-update"></a><span data-ttu-id="3896d-130">Alterações permitidas no serviço durante uma atualização</span><span class="sxs-lookup"><span data-stu-id="3896d-130">Allowed service changes during an update</span></span>
<span data-ttu-id="3896d-131">Olá tabela a seguir mostra Olá permitidas alterações tooa serviço durante uma atualização:</span><span class="sxs-lookup"><span data-stu-id="3896d-131">hello following table shows hello allowed changes tooa service during an update:</span></span>

| <span data-ttu-id="3896d-132">Alterações permitidas toohosting, serviços e funções</span><span class="sxs-lookup"><span data-stu-id="3896d-132">Changes permitted toohosting, services, and roles</span></span> | <span data-ttu-id="3896d-133">Atualização in-loco</span><span class="sxs-lookup"><span data-stu-id="3896d-133">In-place update</span></span> | <span data-ttu-id="3896d-134">Em estágios (permuta de VIP)</span><span class="sxs-lookup"><span data-stu-id="3896d-134">Staged (VIP swap)</span></span> | <span data-ttu-id="3896d-135">Excluir e reimplantar</span><span class="sxs-lookup"><span data-stu-id="3896d-135">Delete and re-deploy</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="3896d-136">Versão do sistema operacional</span><span class="sxs-lookup"><span data-stu-id="3896d-136">Operating system version</span></span> |<span data-ttu-id="3896d-137">Sim</span><span class="sxs-lookup"><span data-stu-id="3896d-137">Yes</span></span> |<span data-ttu-id="3896d-138">Sim</span><span class="sxs-lookup"><span data-stu-id="3896d-138">Yes</span></span> |<span data-ttu-id="3896d-139">Sim</span><span class="sxs-lookup"><span data-stu-id="3896d-139">Yes</span></span> |
| <span data-ttu-id="3896d-140">Nível de confiança do .NET</span><span class="sxs-lookup"><span data-stu-id="3896d-140">.NET trust level</span></span> |<span data-ttu-id="3896d-141">Sim</span><span class="sxs-lookup"><span data-stu-id="3896d-141">Yes</span></span> |<span data-ttu-id="3896d-142">Sim</span><span class="sxs-lookup"><span data-stu-id="3896d-142">Yes</span></span> |<span data-ttu-id="3896d-143">Sim</span><span class="sxs-lookup"><span data-stu-id="3896d-143">Yes</span></span> |
| <span data-ttu-id="3896d-144">Tamanho da máquina virtual<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="3896d-144">Virtual machine size<sup>1</sup></span></span> |<span data-ttu-id="3896d-145">Sim<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="3896d-145">Yes<sup>2</sup></span></span> |<span data-ttu-id="3896d-146">Sim</span><span class="sxs-lookup"><span data-stu-id="3896d-146">Yes</span></span> |<span data-ttu-id="3896d-147">Sim</span><span class="sxs-lookup"><span data-stu-id="3896d-147">Yes</span></span> |
| <span data-ttu-id="3896d-148">Configurações de armazenamento local</span><span class="sxs-lookup"><span data-stu-id="3896d-148">Local storage settings</span></span> |<span data-ttu-id="3896d-149">Apenas aumento<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="3896d-149">Increase only<sup>2</sup></span></span> |<span data-ttu-id="3896d-150">Sim</span><span class="sxs-lookup"><span data-stu-id="3896d-150">Yes</span></span> |<span data-ttu-id="3896d-151">Sim</span><span class="sxs-lookup"><span data-stu-id="3896d-151">Yes</span></span> |
| <span data-ttu-id="3896d-152">Adicionar ou remover funções em um serviço</span><span class="sxs-lookup"><span data-stu-id="3896d-152">Add or remove roles in a service</span></span> |<span data-ttu-id="3896d-153">Sim</span><span class="sxs-lookup"><span data-stu-id="3896d-153">Yes</span></span> |<span data-ttu-id="3896d-154">Sim</span><span class="sxs-lookup"><span data-stu-id="3896d-154">Yes</span></span> |<span data-ttu-id="3896d-155">Sim</span><span class="sxs-lookup"><span data-stu-id="3896d-155">Yes</span></span> |
| <span data-ttu-id="3896d-156">Número de instâncias de uma função específica</span><span class="sxs-lookup"><span data-stu-id="3896d-156">Number of instances of a particular role</span></span> |<span data-ttu-id="3896d-157">Sim</span><span class="sxs-lookup"><span data-stu-id="3896d-157">Yes</span></span> |<span data-ttu-id="3896d-158">Sim</span><span class="sxs-lookup"><span data-stu-id="3896d-158">Yes</span></span> |<span data-ttu-id="3896d-159">Sim</span><span class="sxs-lookup"><span data-stu-id="3896d-159">Yes</span></span> |
| <span data-ttu-id="3896d-160">Número ou tipo de pontos de extremidade de um serviço</span><span class="sxs-lookup"><span data-stu-id="3896d-160">Number or type of endpoints for a service</span></span> |<span data-ttu-id="3896d-161">Sim<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="3896d-161">Yes<sup>2</sup></span></span> |<span data-ttu-id="3896d-162">Não</span><span class="sxs-lookup"><span data-stu-id="3896d-162">No</span></span> |<span data-ttu-id="3896d-163">Sim</span><span class="sxs-lookup"><span data-stu-id="3896d-163">Yes</span></span> |
| <span data-ttu-id="3896d-164">Nomes e valores dos parâmetros de configuração</span><span class="sxs-lookup"><span data-stu-id="3896d-164">Names and values of configuration settings</span></span> |<span data-ttu-id="3896d-165">Sim</span><span class="sxs-lookup"><span data-stu-id="3896d-165">Yes</span></span> |<span data-ttu-id="3896d-166">Sim</span><span class="sxs-lookup"><span data-stu-id="3896d-166">Yes</span></span> |<span data-ttu-id="3896d-167">Sim</span><span class="sxs-lookup"><span data-stu-id="3896d-167">Yes</span></span> |
| <span data-ttu-id="3896d-168">Valores (mas não nomes) dos parâmetros de configuração</span><span class="sxs-lookup"><span data-stu-id="3896d-168">Values (but not names) of configuration settings</span></span> |<span data-ttu-id="3896d-169">Sim</span><span class="sxs-lookup"><span data-stu-id="3896d-169">Yes</span></span> |<span data-ttu-id="3896d-170">Sim</span><span class="sxs-lookup"><span data-stu-id="3896d-170">Yes</span></span> |<span data-ttu-id="3896d-171">Sim</span><span class="sxs-lookup"><span data-stu-id="3896d-171">Yes</span></span> |
| <span data-ttu-id="3896d-172">Adicionar novos certificados</span><span class="sxs-lookup"><span data-stu-id="3896d-172">Add new certificates</span></span> |<span data-ttu-id="3896d-173">Sim</span><span class="sxs-lookup"><span data-stu-id="3896d-173">Yes</span></span> |<span data-ttu-id="3896d-174">Sim</span><span class="sxs-lookup"><span data-stu-id="3896d-174">Yes</span></span> |<span data-ttu-id="3896d-175">Sim</span><span class="sxs-lookup"><span data-stu-id="3896d-175">Yes</span></span> |
| <span data-ttu-id="3896d-176">Alterar certificados existentes</span><span class="sxs-lookup"><span data-stu-id="3896d-176">Change existing certificates</span></span> |<span data-ttu-id="3896d-177">Sim</span><span class="sxs-lookup"><span data-stu-id="3896d-177">Yes</span></span> |<span data-ttu-id="3896d-178">Sim</span><span class="sxs-lookup"><span data-stu-id="3896d-178">Yes</span></span> |<span data-ttu-id="3896d-179">Sim</span><span class="sxs-lookup"><span data-stu-id="3896d-179">Yes</span></span> |
| <span data-ttu-id="3896d-180">Implantar novo código</span><span class="sxs-lookup"><span data-stu-id="3896d-180">Deploy new code</span></span> |<span data-ttu-id="3896d-181">Sim</span><span class="sxs-lookup"><span data-stu-id="3896d-181">Yes</span></span> |<span data-ttu-id="3896d-182">Sim</span><span class="sxs-lookup"><span data-stu-id="3896d-182">Yes</span></span> |<span data-ttu-id="3896d-183">Sim</span><span class="sxs-lookup"><span data-stu-id="3896d-183">Yes</span></span> |

<span data-ttu-id="3896d-184"><sup>1</sup> alterações de tamanho limitado toohello subconjunto de tamanhos disponíveis para o serviço de nuvem hello.</span><span class="sxs-lookup"><span data-stu-id="3896d-184"><sup>1</sup> Size change limited toohello subset of sizes available for hello cloud service.</span></span>

<span data-ttu-id="3896d-185"><sup>2</sup> Exige o Azure SDK 1.5 ou versões posteriores.</span><span class="sxs-lookup"><span data-stu-id="3896d-185"><sup>2</sup> Requires Azure SDK 1.5 or later versions.</span></span>

> [!WARNING]
> <span data-ttu-id="3896d-186">Alterar o tamanho da máquina virtual Olá destruirá os dados locais.</span><span class="sxs-lookup"><span data-stu-id="3896d-186">Changing hello virtual machine size will destroy local data.</span></span>
>
>

<span data-ttu-id="3896d-187">Olá itens a seguir não têm suporte durante uma atualização:</span><span class="sxs-lookup"><span data-stu-id="3896d-187">hello following items are not supported during an update:</span></span>

* <span data-ttu-id="3896d-188">Alterando o nome de saudação de uma função.</span><span class="sxs-lookup"><span data-stu-id="3896d-188">Changing hello name of a role.</span></span> <span data-ttu-id="3896d-189">Remova e adicione a função hello com novo nome de saudação.</span><span class="sxs-lookup"><span data-stu-id="3896d-189">Remove and then add hello role with hello new name.</span></span>
* <span data-ttu-id="3896d-190">Alteração da saudação contagem de atualização do domínio.</span><span class="sxs-lookup"><span data-stu-id="3896d-190">Changing of hello Upgrade Domain count.</span></span>
* <span data-ttu-id="3896d-191">Diminuindo o tamanho de saudação dos recursos locais hello.</span><span class="sxs-lookup"><span data-stu-id="3896d-191">Decreasing hello size of hello local resources.</span></span>

<span data-ttu-id="3896d-192">Se você estiver fazendo outras atualizações de definição do serviço tooyour, como a redução do tamanho de saudação do recurso local, você deve executar uma atualização de permuta de VIP em vez disso.</span><span class="sxs-lookup"><span data-stu-id="3896d-192">If you are making other updates tooyour service's definition, such as decreasing hello size of local resource, you must perform a VIP swap update instead.</span></span> <span data-ttu-id="3896d-193">Para saber mais, consulte, consulte [Implantação de permuta](https://msdn.microsoft.com/library/azure/ee460814.aspx).</span><span class="sxs-lookup"><span data-stu-id="3896d-193">For more information, see [Swap Deployment](https://msdn.microsoft.com/library/azure/ee460814.aspx).</span></span>

<a name="howanupgradeproceeds"></a>

## <a name="how-an-upgrade-proceeds"></a><span data-ttu-id="3896d-194">Como uma atualização é realizada</span><span class="sxs-lookup"><span data-stu-id="3896d-194">How an upgrade proceeds</span></span>
<span data-ttu-id="3896d-195">Você pode decidir se deseja tooupdate todas as funções hello em seu serviço ou uma única função no serviço de saudação.</span><span class="sxs-lookup"><span data-stu-id="3896d-195">You can decide whether you want tooupdate all of hello roles in your service or a single role in hello service.</span></span> <span data-ttu-id="3896d-196">Em ambos os casos, todas as instâncias de cada função que está sendo atualizado e pertencem toohello primeiro domínio de atualização são interrompidas, atualizadas e volte a ficar online.</span><span class="sxs-lookup"><span data-stu-id="3896d-196">In either case, all instances of each role that is being upgraded and belong toohello first upgrade domain are stopped, upgraded, and brought back online.</span></span> <span data-ttu-id="3896d-197">Quando eles estiverem online novamente, hello instâncias no segundo domínio de atualização de saudação são interrompidas, atualizadas e volte a ficar online.</span><span class="sxs-lookup"><span data-stu-id="3896d-197">Once they are back online, hello instances in hello second upgrade domain are stopped, upgraded, and brought back online.</span></span> <span data-ttu-id="3896d-198">Um serviço de nuvem pode ter no máximo uma atualização ativa por vez.</span><span class="sxs-lookup"><span data-stu-id="3896d-198">A cloud service can have at most one upgrade active at a time.</span></span> <span data-ttu-id="3896d-199">atualização de saudação sempre é executada em relação à versão mais recente do Olá Olá do serviço de nuvem.</span><span class="sxs-lookup"><span data-stu-id="3896d-199">hello upgrade is always performed against hello latest version of hello cloud service.</span></span>

<span data-ttu-id="3896d-200">Olá diagrama a seguir ilustra como atualização Olá ocorre se você estiver atualizando todas as funções hello no serviço de saudação de:</span><span class="sxs-lookup"><span data-stu-id="3896d-200">hello following diagram illustrates how hello upgrade proceeds if you are upgrading all of hello roles in hello service:</span></span>

<span data-ttu-id="3896d-201">![Atualizar serviço](media/cloud-services-update-azure-service/IC345879.png "Atualizar serviço")</span><span class="sxs-lookup"><span data-stu-id="3896d-201">![Upgrade service](media/cloud-services-update-azure-service/IC345879.png "Upgrade service")</span></span>

<span data-ttu-id="3896d-202">Este próximo diagrama ilustra como atualização Olá continua se você estiver atualizando somente uma única função:</span><span class="sxs-lookup"><span data-stu-id="3896d-202">This next diagram illustrates how hello update proceeds if you are upgrading only a single role:</span></span>

<span data-ttu-id="3896d-203">![Atualizar função](media/cloud-services-update-azure-service/IC345880.png "Atualizar função")</span><span class="sxs-lookup"><span data-stu-id="3896d-203">![Upgrade role](media/cloud-services-update-azure-service/IC345880.png "Upgrade role")</span></span>  

<span data-ttu-id="3896d-204">Durante uma atualização automática, o Olá controlador de malha do Azure avalia periodicamente a integridade Olá de toodetermine de serviço de nuvem hello quando sua segurança toowalk Olá UD Avançar.</span><span class="sxs-lookup"><span data-stu-id="3896d-204">During an automatic update, hello Azure Fabric Controller periodically evaluates hello health of hello cloud service toodetermine when it’s safe toowalk hello next UD.</span></span> <span data-ttu-id="3896d-205">A avaliação de integridade é executada em uma base por função e considera apenas as instâncias na versão mais recente da saudação (ou seja, instâncias de UDs já tem sido movimentadas).</span><span class="sxs-lookup"><span data-stu-id="3896d-205">This health evaluation is performed on a per-role basis and considers only instances in hello latest version (i.e. instances from UDs that have already been walked).</span></span> <span data-ttu-id="3896d-206">Ela verifica se um número mínimo de instâncias de função, para cada função, atingiu um estado de terminal satisfatório.</span><span class="sxs-lookup"><span data-stu-id="3896d-206">It verifies that a minimum number of role instances, for each role, have achieved a satisfactory terminal state.</span></span>

### <a name="role-instance-start-timeout"></a><span data-ttu-id="3896d-207">Tempo limite de inicialização de instância de função</span><span class="sxs-lookup"><span data-stu-id="3896d-207">Role Instance Start Timeout</span></span>
<span data-ttu-id="3896d-208">Olá controlador de malha aguardará 30 minutos para cada instância de função tooreach um estado iniciado.</span><span class="sxs-lookup"><span data-stu-id="3896d-208">hello Fabric Controller will wait 30 minutes for each role instance tooreach a Started state.</span></span> <span data-ttu-id="3896d-209">Se a duração do tempo limite de saudação expira, Olá controlador de malha continuará percorrer toohello próxima instância de função.</span><span class="sxs-lookup"><span data-stu-id="3896d-209">If hello timeout duration elapses, hello Fabric Controller will continue walking toohello next role instance.</span></span>

### <a name="impact-toodrive-data-during-cloud-service-upgrades"></a><span data-ttu-id="3896d-210">Dados de toodrive impacto durante as atualizações de serviço de nuvem</span><span class="sxs-lookup"><span data-stu-id="3896d-210">Impact toodrive data during Cloud Service upgrades</span></span>

<span data-ttu-id="3896d-211">Ao atualizar um serviço de instâncias de toomultiple uma única instância seu serviço será interrompido enquanto Olá atualização é executada devido a maneira toohello Azure atualiza os serviços.</span><span class="sxs-lookup"><span data-stu-id="3896d-211">When upgrading a service from a single instance toomultiple instances your service will be brought down while hello upgrade is performed due toohello way Azure upgrades services.</span></span> <span data-ttu-id="3896d-212">Olá serviço contrato de nível garante disponibilidade do serviço se aplica somente a tooservices que são implantados com mais de uma instância.</span><span class="sxs-lookup"><span data-stu-id="3896d-212">hello service level agreement guaranteeing service availability only applies tooservices that are deployed with more than one instance.</span></span> <span data-ttu-id="3896d-213">Olá lista a seguir descreve como os dados de saudação em cada unidade são afetados por cada cenário de atualização de serviço do Azure:</span><span class="sxs-lookup"><span data-stu-id="3896d-213">hello following list describes how hello data on each drive is affected by each Azure service upgrade scenario:</span></span>

|<span data-ttu-id="3896d-214">Cenário</span><span class="sxs-lookup"><span data-stu-id="3896d-214">Scenario</span></span>|<span data-ttu-id="3896d-215">Unidade C</span><span class="sxs-lookup"><span data-stu-id="3896d-215">C Drive</span></span>|<span data-ttu-id="3896d-216">Unidade D</span><span class="sxs-lookup"><span data-stu-id="3896d-216">D Drive</span></span>|<span data-ttu-id="3896d-217">Unidade E</span><span class="sxs-lookup"><span data-stu-id="3896d-217">E Drive</span></span>|
|--------|-------|-------|-------|
|<span data-ttu-id="3896d-218">Reinicialização da VM</span><span class="sxs-lookup"><span data-stu-id="3896d-218">VM reboot</span></span>|<span data-ttu-id="3896d-219">Preservado</span><span class="sxs-lookup"><span data-stu-id="3896d-219">Preserved</span></span>|<span data-ttu-id="3896d-220">Preservado</span><span class="sxs-lookup"><span data-stu-id="3896d-220">Preserved</span></span>|<span data-ttu-id="3896d-221">Preservado</span><span class="sxs-lookup"><span data-stu-id="3896d-221">Preserved</span></span>|
|<span data-ttu-id="3896d-222">Reinicialização do portal</span><span class="sxs-lookup"><span data-stu-id="3896d-222">Portal reboot</span></span>|<span data-ttu-id="3896d-223">Preservado</span><span class="sxs-lookup"><span data-stu-id="3896d-223">Preserved</span></span>|<span data-ttu-id="3896d-224">Preservado</span><span class="sxs-lookup"><span data-stu-id="3896d-224">Preserved</span></span>|<span data-ttu-id="3896d-225">Destruído</span><span class="sxs-lookup"><span data-stu-id="3896d-225">Destroyed</span></span>|
|<span data-ttu-id="3896d-226">Nova imagem do Portal</span><span class="sxs-lookup"><span data-stu-id="3896d-226">Portal reimage</span></span>|<span data-ttu-id="3896d-227">Preservado</span><span class="sxs-lookup"><span data-stu-id="3896d-227">Preserved</span></span>|<span data-ttu-id="3896d-228">Destruído</span><span class="sxs-lookup"><span data-stu-id="3896d-228">Destroyed</span></span>|<span data-ttu-id="3896d-229">Destruído</span><span class="sxs-lookup"><span data-stu-id="3896d-229">Destroyed</span></span>|
|<span data-ttu-id="3896d-230">Atualização in-loco</span><span class="sxs-lookup"><span data-stu-id="3896d-230">In-Place Upgrade</span></span>|<span data-ttu-id="3896d-231">Preservado</span><span class="sxs-lookup"><span data-stu-id="3896d-231">Preserved</span></span>|<span data-ttu-id="3896d-232">Preservado</span><span class="sxs-lookup"><span data-stu-id="3896d-232">Preserved</span></span>|<span data-ttu-id="3896d-233">Destruído</span><span class="sxs-lookup"><span data-stu-id="3896d-233">Destroyed</span></span>|
|<span data-ttu-id="3896d-234">Migração de nó</span><span class="sxs-lookup"><span data-stu-id="3896d-234">Node migration</span></span>|<span data-ttu-id="3896d-235">Destruído</span><span class="sxs-lookup"><span data-stu-id="3896d-235">Destroyed</span></span>|<span data-ttu-id="3896d-236">Destruído</span><span class="sxs-lookup"><span data-stu-id="3896d-236">Destroyed</span></span>|<span data-ttu-id="3896d-237">Destruído</span><span class="sxs-lookup"><span data-stu-id="3896d-237">Destroyed</span></span>|

<span data-ttu-id="3896d-238">Observe que, em Olá acima da lista, Olá unidade e: representa a unidade raiz da função hello e não deve ser inserido no código.</span><span class="sxs-lookup"><span data-stu-id="3896d-238">Note that, in hello above list, hello E: drive represents hello role’s root drive, and should not be hard-coded.</span></span> <span data-ttu-id="3896d-239">Em vez disso, use Olá **% RoleRoot %** unidade de saudação do toorepresent variável de ambiente.</span><span class="sxs-lookup"><span data-stu-id="3896d-239">Instead, use hello **%RoleRoot%** environment variable toorepresent hello drive.</span></span>

<span data-ttu-id="3896d-240">toominimize Olá tempo de inatividade ao atualizar um serviço de instância única, implantar um nova multi-instância serviço toohello servidor de preparo e executar uma permuta de VIP.</span><span class="sxs-lookup"><span data-stu-id="3896d-240">toominimize hello downtime when upgrading a single-instance service, deploy a new multi-instance service toohello staging server and perform a VIP swap.</span></span>

<a name="RollbackofanUpdate"></a>

## <a name="rollback-of-an-update"></a><span data-ttu-id="3896d-241">Reversão de uma atualização</span><span class="sxs-lookup"><span data-stu-id="3896d-241">Rollback of an update</span></span>
<span data-ttu-id="3896d-242">O Azure fornece flexibilidade no gerenciamento de serviços durante uma atualização, permitindo que você inicie operações adicionais em um serviço, após a saudação inicial atualizar a solicitação é aceita pelo Olá controlador de malha do Azure.</span><span class="sxs-lookup"><span data-stu-id="3896d-242">Azure provides flexibility in managing services during an update by letting you initiate additional operations on a service, after hello initial update request is accepted by hello Azure Fabric Controller.</span></span> <span data-ttu-id="3896d-243">Uma reversão só pode ser executada quando uma atualização (alteração de configuração) ou atualização está em Olá **em andamento** estado na implantação de saudação.</span><span class="sxs-lookup"><span data-stu-id="3896d-243">A rollback can only be performed when an update (configuration change) or upgrade is in hello **in progress** state on hello deployment.</span></span> <span data-ttu-id="3896d-244">Uma atualização ou upgrade é considerada toobe em andamento, desde que exista pelo menos uma instância do serviço de saudação que ainda não foram atualizados toohello nova versão.</span><span class="sxs-lookup"><span data-stu-id="3896d-244">An update or upgrade is considered toobe in-progress as long as there is at least one instance of hello service which has not yet been updated toohello new version.</span></span> <span data-ttu-id="3896d-245">tootest se uma reversão é permitida, verifique o valor de saudação do sinalizador de RollbackAllowed hello, retornado por [obter a implantação](https://msdn.microsoft.com/library/azure/ee460804.aspx) e [obter propriedades do serviço de nuvem](https://msdn.microsoft.com/library/azure/ee460806.aspx) operações, é definir tootrue.</span><span class="sxs-lookup"><span data-stu-id="3896d-245">tootest whether a rollback is allowed, check hello value of hello RollbackAllowed flag, returned by [Get Deployment](https://msdn.microsoft.com/library/azure/ee460804.aspx) and [Get Cloud Service Properties](https://msdn.microsoft.com/library/azure/ee460806.aspx) operations, is set tootrue.</span></span>

> [!NOTE]
> <span data-ttu-id="3896d-246">Só faz sentido toocall Rollback em uma **in-loco** atualização ou upgrade pois as atualizações de permuta de VIP envolvem a substituição de uma instância em execução inteira de seu serviço com outra.</span><span class="sxs-lookup"><span data-stu-id="3896d-246">It only makes sense toocall Rollback on an **in-place** update or upgrade because VIP swap upgrades involve replacing one entire running instance of your service with another.</span></span>
>
>

<span data-ttu-id="3896d-247">Reversão de uma atualização em andamento tem Olá efeitos na implantação Olá a seguir:</span><span class="sxs-lookup"><span data-stu-id="3896d-247">Rollback of an in-progress update has hello following effects on hello deployment:</span></span>

* <span data-ttu-id="3896d-248">Quaisquer instâncias de função que ainda não tiveram sido atualizada ou atualizados toohello nova versão não são atualizadas ou atualizadas, porque essas instâncias já estiver executando a versão de destino de saudação do serviço de saudação.</span><span class="sxs-lookup"><span data-stu-id="3896d-248">Any role instances which had not yet been updated or upgraded toohello new version are not updated or upgraded, because those instances are already running hello target version of hello service.</span></span>
* <span data-ttu-id="3896d-249">Instâncias de qualquer função que já tinha sido atualizado ou atualizado toohello nova versão do pacote de serviço hello (\*. cspkg) hello ou arquivo de configuração de serviço (\*. cscfg) arquivo (ou ambos) estão na versão de pré-atualização toohello revertido de Esses arquivos.</span><span class="sxs-lookup"><span data-stu-id="3896d-249">Any role instances which had already been updated or upgraded toohello new version of hello service package (\*.cspkg) file or hello service configuration (\*.cscfg) file (or both files) are reverted toohello pre-upgrade version of these files.</span></span>

<span data-ttu-id="3896d-250">Essa funcionalidade é fornecida pelo Olá recursos a seguir:</span><span class="sxs-lookup"><span data-stu-id="3896d-250">This functionally is provided by hello following features:</span></span>

* <span data-ttu-id="3896d-251">Olá [reversão de atualização ou atualizar](https://msdn.microsoft.com/library/azure/hh403977.aspx) operação, que pode ser chamada em uma atualização de configuração (disparada pela chamada [alterar configuração de implantação](https://msdn.microsoft.com/library/azure/ee460809.aspx)) ou uma atualização (disparado pela chamada [ Implantação de atualização](https://msdn.microsoft.com/library/azure/ee460793.aspx)) como há pelo menos uma instância no serviço de saudação que ainda não foi atualizado toohello nova versão.</span><span class="sxs-lookup"><span data-stu-id="3896d-251">hello [Rollback Update Or Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx) operation, which can be called on a configuration update (triggered by calling [Change Deployment Configuration](https://msdn.microsoft.com/library/azure/ee460809.aspx)) or an upgrade (triggered by calling [Upgrade Deployment](https://msdn.microsoft.com/library/azure/ee460793.aspx)) as long as there is at least one instance in hello service which has not yet been updated toohello new version.</span></span>
* <span data-ttu-id="3896d-252">Olá elemento bloqueado e elemento de RollbackAllowed hello, que são retornados como parte do corpo de resposta de saudação do hello [obter a implantação](https://msdn.microsoft.com/library/azure/ee460804.aspx) e [obter propriedades do serviço de nuvem](https://msdn.microsoft.com/library/azure/ee460806.aspx) operações:</span><span class="sxs-lookup"><span data-stu-id="3896d-252">hello Locked element and hello RollbackAllowed element, which are returned as part of hello response body of hello [Get Deployment](https://msdn.microsoft.com/library/azure/ee460804.aspx) and [Get Cloud Service Properties](https://msdn.microsoft.com/library/azure/ee460806.aspx) operations:</span></span>

  1. <span data-ttu-id="3896d-253">Olá bloqueado elemento permite que você toodetect quando uma operação de mutação pode ser chamada em uma determinada implantação.</span><span class="sxs-lookup"><span data-stu-id="3896d-253">hello Locked element allows you toodetect when a mutating operation can be invoked on a given deployment.</span></span>
  2. <span data-ttu-id="3896d-254">Olá RollbackAllowed elemento permite que você toodetect quando hello [reversão atualização ou atualizar](https://msdn.microsoft.com/library/azure/hh403977.aspx) operação pode ser chamada em uma determinada implantação.</span><span class="sxs-lookup"><span data-stu-id="3896d-254">hello RollbackAllowed element allows you toodetect when hello [Rollback Update Or Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx) operation can be called on a given deployment.</span></span>

  <span data-ttu-id="3896d-255">Em ordem tooperform uma reversão, você não tem toocheck Olá bloqueado tanto Olá elementos RollbackAllowed.</span><span class="sxs-lookup"><span data-stu-id="3896d-255">In order tooperform a rollback, you do not have toocheck both hello Locked and hello RollbackAllowed elements.</span></span> <span data-ttu-id="3896d-256">Basta tooconfirm que RollbackAllowed está definida tootrue.</span><span class="sxs-lookup"><span data-stu-id="3896d-256">It suffices tooconfirm that RollbackAllowed is set tootrue.</span></span> <span data-ttu-id="3896d-257">Esses elementos são retornados apenas se esses métodos são chamados usando o cabeçalho da solicitação Olá definido muito "x-ms-version: 2011-10-01" ou uma versão posterior.</span><span class="sxs-lookup"><span data-stu-id="3896d-257">These elements are only returned if these methods are invoked by using hello request header set too“x-ms-version: 2011-10-01” or a later version.</span></span> <span data-ttu-id="3896d-258">Para saber mais sobre os cabeçalhos de controle de versão, consulte [Controle de versão do serviço de gerenciamento](https://msdn.microsoft.com/library/azure/gg592580.aspx).</span><span class="sxs-lookup"><span data-stu-id="3896d-258">For more information about versioning headers, see [Service Management Versioning](https://msdn.microsoft.com/library/azure/gg592580.aspx).</span></span>

<span data-ttu-id="3896d-259">Há algumas situações nas quais não há suporte para uma reversão de uma atualização ou upgrade, entre elas:</span><span class="sxs-lookup"><span data-stu-id="3896d-259">There are some situations where a rollback of an update or upgrade is not supported, these are as follows:</span></span>

* <span data-ttu-id="3896d-260">Redução em recursos locais - se Olá atualização aumenta Olá recursos locais para uma função hello plataforma Windows Azure não permitirá a reversão.</span><span class="sxs-lookup"><span data-stu-id="3896d-260">Reduction in local resources - If hello update increases hello local resources for a role hello Azure platform does not allow rolling back.</span></span>
* <span data-ttu-id="3896d-261">Limitações de cota - se a atualização da saudação foi uma escala para baixo de operação, você pode não ter operação de reversão do suficientes computação cota toocomplete hello.</span><span class="sxs-lookup"><span data-stu-id="3896d-261">Quota limitations - If hello update was a scale down operation you may no longer have sufficient compute quota toocomplete hello rollback operation.</span></span> <span data-ttu-id="3896d-262">Cada assinatura do Azure tem uma cota associada que especifica o número máximo de saudação de núcleos que podem ser consumidos por todos os serviços hospedados que pertencem a assinatura de toothat.</span><span class="sxs-lookup"><span data-stu-id="3896d-262">Each Azure subscription has a quota associated with it that specifies hello maximum number of cores which can be consumed by all hosted services that belong toothat subscription.</span></span> <span data-ttu-id="3896d-263">Se a execução de uma reversão de uma determinada atualização colocar sua assinatura acima da cota, a reversão não será habilitada.</span><span class="sxs-lookup"><span data-stu-id="3896d-263">If performing a rollback of a given update would put your subscription over quota then that a rollback will not be enabled.</span></span>
* <span data-ttu-id="3896d-264">Condição de corrida - se a atualização de saudação inicial foi concluída, uma reversão não é possível.</span><span class="sxs-lookup"><span data-stu-id="3896d-264">Race condition - If hello initial update has completed, a rollback is not possible.</span></span>

<span data-ttu-id="3896d-265">Um exemplo de quando a reversão de saudação de uma atualização pode ser útil é se você estiver usando Olá [implantação de atualização](https://msdn.microsoft.com/library/azure/ee460793.aspx) operação na taxa de saudação toocontrol de modo manual no qual o serviço hospedado um principal tooyour de atualização in-loco do Azure é distribuída.</span><span class="sxs-lookup"><span data-stu-id="3896d-265">An example of when hello rollback of an update might be useful is if you are using hello [Upgrade Deployment](https://msdn.microsoft.com/library/azure/ee460793.aspx) operation in manual mode toocontrol hello rate at which a major in-place upgrade tooyour Azure hosted service is rolled out.</span></span>

<span data-ttu-id="3896d-266">Durante a distribuição de saudação da atualização Olá chamar [implantação de atualização](https://msdn.microsoft.com/library/azure/ee460793.aspx) no modo manual e começar toowalk domínios de atualização.</span><span class="sxs-lookup"><span data-stu-id="3896d-266">During hello rollout of hello upgrade you call [Upgrade Deployment](https://msdn.microsoft.com/library/azure/ee460793.aspx) in manual mode and begin toowalk upgrade domains.</span></span> <span data-ttu-id="3896d-267">Se em algum momento, como monitorar atualização hello, você observar algumas instâncias de função em Olá primeiro domínios de atualização que examina se tornaram sem resposta, você pode chamar hello [reversão atualização ou atualizar](https://msdn.microsoft.com/library/azure/hh403977.aspx) operação na implantação de saudação que deixará instâncias Olá inalterados que ainda não foram atualizadas e reverterá as instâncias que foram atualizados toohello pacote de serviço anterior e a configuração.</span><span class="sxs-lookup"><span data-stu-id="3896d-267">If at some point, as you monitor hello upgrade, you note some role instances in hello first upgrade domains that you examine have become unresponsive, you can call hello [Rollback Update Or Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx) operation on hello deployment, which will leave untouched hello instances which had not yet been upgraded and rollback instances which had been upgraded toohello previous service package and configuration.</span></span>

<a name="multiplemutatingoperations"></a>

## <a name="initiating-multiple-mutating-operations-on-an-ongoing-deployment"></a><span data-ttu-id="3896d-268">Inicialização de várias operações de mutação em uma implantação em andamento</span><span class="sxs-lookup"><span data-stu-id="3896d-268">Initiating multiple mutating operations on an ongoing deployment</span></span>
<span data-ttu-id="3896d-269">Em alguns casos pode ser tooinitiate várias operações de mutação simultâneas em uma implantação em andamento.</span><span class="sxs-lookup"><span data-stu-id="3896d-269">In some cases you may want tooinitiate multiple simultaneous mutating operations on an ongoing deployment.</span></span> <span data-ttu-id="3896d-270">Por exemplo, você pode executar uma atualização de serviço e, enquanto que a atualização está sendo revertida no seu serviço, você deseja toomake alguma alteração, por exemplo, tooroll Olá atualização, aplicar outra atualização ou até mesmo excluir a implantação de saudação.</span><span class="sxs-lookup"><span data-stu-id="3896d-270">For example, you may perform a service update and, while that update is being rolled out across your service, you want toomake some change, e.g. tooroll hello update back, apply a different update, or even delete hello deployment.</span></span> <span data-ttu-id="3896d-271">Um caso em que isso pode ser necessário é se uma atualização de serviço contém um código com bug que faz com que uma falha de toorepeatedly de instância de função atualizada.</span><span class="sxs-lookup"><span data-stu-id="3896d-271">A case in which this might be necessary is if a service upgrade contains buggy code which causes an upgraded role instance toorepeatedly crash.</span></span> <span data-ttu-id="3896d-272">Nesse caso, a saudação controlador de malha do Azure não será toomake capaz de progresso na aplicação dessa atualização porque um número insuficiente de instâncias no domínio atualizado Olá está íntegro.</span><span class="sxs-lookup"><span data-stu-id="3896d-272">In this case, hello Azure Fabric Controller will not be able toomake progress in applying that upgrade because an insufficient number of instances in hello upgraded domain are healthy.</span></span> <span data-ttu-id="3896d-273">Esse estado é chamado tooas um *implantação paralisada*.</span><span class="sxs-lookup"><span data-stu-id="3896d-273">This state is referred tooas a *stuck deployment*.</span></span> <span data-ttu-id="3896d-274">Você pode resolver implantação Olá reversão Olá atualização ou aplicando uma atualização recente pela parte superior da saudação falhando um.</span><span class="sxs-lookup"><span data-stu-id="3896d-274">You can unstick hello deployment by rolling back hello update or applying a fresh update over top of hello failing one.</span></span>

<span data-ttu-id="3896d-275">Depois que o serviço de Olá Olá solicitação inicial tooupdate ou atualização foi recebido pelo Olá controlador de malha do Azure, você pode iniciar operações de mutação subsequentes.</span><span class="sxs-lookup"><span data-stu-id="3896d-275">Once hello initial request tooupdate or upgrade hello service has been received by hello Azure Fabric Controller, you can start subsequent mutating operations.</span></span> <span data-ttu-id="3896d-276">Ou seja, você não tem toowait para saudação inicial operação toocomplete antes de iniciar outra operação de mutação.</span><span class="sxs-lookup"><span data-stu-id="3896d-276">That is, you do not have toowait for hello initial operation toocomplete before you can start another mutating operation.</span></span>

<span data-ttu-id="3896d-277">Iniciar uma segunda operação de atualização enquanto Olá primeira atualização está em andamento, você executará a operação de reversão toohello semelhante.</span><span class="sxs-lookup"><span data-stu-id="3896d-277">Initiating a second update operation while hello first update is ongoing will perform similar toohello rollback operation.</span></span> <span data-ttu-id="3896d-278">Se Olá segunda atualização estiver em modo automático, Olá primeiro domínio de atualização serão atualizado imediatamente, possivelmente fazendo tooinstances de vários domínios de atualização fiquem offline no hello mesmo ponto no tempo.</span><span class="sxs-lookup"><span data-stu-id="3896d-278">If hello second update is in automatic mode, hello first upgrade domain will be upgraded immediately, possibly leading tooinstances from multiple upgrade domains being offline at hello same point in time.</span></span>

<span data-ttu-id="3896d-279">Olá operações de mutação são as seguintes: [alterar configuração de implantação](https://msdn.microsoft.com/library/azure/ee460809.aspx), [implantação de atualização](https://msdn.microsoft.com/library/azure/ee460793.aspx), [Status de implantação de atualização](https://msdn.microsoft.com/library/azure/ee460808.aspx), [excluir Implantação](https://msdn.microsoft.com/library/azure/ee460815.aspx), e [atualização de reversão](https://msdn.microsoft.com/library/azure/hh403977.aspx).</span><span class="sxs-lookup"><span data-stu-id="3896d-279">hello mutating operations are as follows: [Change Deployment Configuration](https://msdn.microsoft.com/library/azure/ee460809.aspx), [Upgrade Deployment](https://msdn.microsoft.com/library/azure/ee460793.aspx), [Update Deployment Status](https://msdn.microsoft.com/library/azure/ee460808.aspx), [Delete Deployment](https://msdn.microsoft.com/library/azure/ee460815.aspx), and [Rollback Update Or Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx).</span></span>

<span data-ttu-id="3896d-280">Duas operações, [obter a implantação](https://msdn.microsoft.com/library/azure/ee460804.aspx) e [obter propriedades do serviço de nuvem](https://msdn.microsoft.com/library/azure/ee460806.aspx), retornam o sinalizador de bloqueado Olá que pode ser examinada toodetermine se uma operação de mutação pode ser chamada em uma determinada implantação.</span><span class="sxs-lookup"><span data-stu-id="3896d-280">Two operations, [Get Deployment](https://msdn.microsoft.com/library/azure/ee460804.aspx) and [Get Cloud Service Properties](https://msdn.microsoft.com/library/azure/ee460806.aspx), return hello Locked flag which can be examined toodetermine whether a mutating operation can be invoked on a given deployment.</span></span>

<span data-ttu-id="3896d-281">Ordem toocall Olá versão desses métodos que retorna o sinalizador de bloqueado hello, você deve definir o cabeçalho de solicitação muito "x-ms-version: 2011-10-01" ou posterior.</span><span class="sxs-lookup"><span data-stu-id="3896d-281">In order toocall hello version of these methods which returns hello Locked flag, you must set request header too“x-ms-version: 2011-10-01” or a later.</span></span> <span data-ttu-id="3896d-282">Para saber mais sobre os cabeçalhos de controle de versão, consulte [Controle de versão do serviço de gerenciamento](https://msdn.microsoft.com/library/azure/gg592580.aspx).</span><span class="sxs-lookup"><span data-stu-id="3896d-282">For more information about versioning headers, see [Service Management Versioning](https://msdn.microsoft.com/library/azure/gg592580.aspx).</span></span>

<a name="distributiondfroles"></a>

## <a name="distribution-of-roles-across-upgrade-domains"></a><span data-ttu-id="3896d-283">Distribuição de funções em domínios de atualização</span><span class="sxs-lookup"><span data-stu-id="3896d-283">Distribution of roles across upgrade domains</span></span>
<span data-ttu-id="3896d-284">O Azure distribui instâncias de uma função uniformemente em um número definido de domínios de atualização, que pode ser configurado como parte do arquivo de definição (. csdef) do serviço de saudação.</span><span class="sxs-lookup"><span data-stu-id="3896d-284">Azure distributes instances of a role evenly across a set number of upgrade domains, which can be configured as part of hello service definition (.csdef) file.</span></span> <span data-ttu-id="3896d-285">Olá o número máximo de domínios de atualização é 20 e saudação padrão é 5.</span><span class="sxs-lookup"><span data-stu-id="3896d-285">hello max number of upgrade domains is 20 and hello default is 5.</span></span> <span data-ttu-id="3896d-286">Para obter mais informações sobre como toomodify Olá arquivo de definição de serviço, consulte [esquema de definição de serviço do Azure (arquivo. csdef)](cloud-services-model-and-package.md#csdef).</span><span class="sxs-lookup"><span data-stu-id="3896d-286">For more information about how toomodify hello service definition file, see [Azure Service Definition Schema (.csdef File)](cloud-services-model-and-package.md#csdef).</span></span>

<span data-ttu-id="3896d-287">Por exemplo, se a sua função tiver dez instâncias, por padrão cada domínio de atualização conterá duas instâncias.</span><span class="sxs-lookup"><span data-stu-id="3896d-287">For example, if your role has ten instances, by default each upgrade domain contains two instances.</span></span> <span data-ttu-id="3896d-288">Se sua função tiver 14 instâncias, quatro dos domínios de atualização Olá contêm três instâncias, e um quinto domínio conterá duas.</span><span class="sxs-lookup"><span data-stu-id="3896d-288">If your role has 14 instances, then four of hello upgrade domains contain three instances, and a fifth domain contains two.</span></span>

<span data-ttu-id="3896d-289">Domínios de atualização são identificados com um índice de base zero: Olá primeiro domínio de atualização tem uma ID de 0 e o segundo domínio de atualização Olá tem uma ID de 1 e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="3896d-289">Upgrade domains are identified with a zero-based index: hello first upgrade domain has an ID of 0, and hello second upgrade domain has an ID of 1, and so on.</span></span>

<span data-ttu-id="3896d-290">Olá diagrama a seguir ilustra como um serviço que contém duas funções são distribuídas ao serviço Olá define dois domínios de atualização.</span><span class="sxs-lookup"><span data-stu-id="3896d-290">hello following diagram illustrates how a service than contains two roles are distributed when hello service defines two upgrade domains.</span></span> <span data-ttu-id="3896d-291">serviço de saudação está executando oito instâncias de função da web de saudação e nove instâncias da função de trabalho hello.</span><span class="sxs-lookup"><span data-stu-id="3896d-291">hello service is running eight instances of hello web role and nine instances of hello worker role.</span></span>

<span data-ttu-id="3896d-292">![Distribuição de domínios de atualização](media/cloud-services-update-azure-service/IC345533.png "Distribuição de domínios de atualização")</span><span class="sxs-lookup"><span data-stu-id="3896d-292">![Distribution of Upgrade Domains](media/cloud-services-update-azure-service/IC345533.png "Distribution of Upgrade Domains")</span></span>

> [!NOTE]
> <span data-ttu-id="3896d-293">Observe que o Azure controla como as instâncias são alocadas nos domínios de atualização.</span><span class="sxs-lookup"><span data-stu-id="3896d-293">Note that Azure controls how instances are allocated across upgrade domains.</span></span> <span data-ttu-id="3896d-294">Não é possível toospecify quais instâncias são alocadas toowhich domínio.</span><span class="sxs-lookup"><span data-stu-id="3896d-294">It's not possible toospecify which instances are allocated toowhich domain.</span></span>
>
>

## <a name="next-steps"></a><span data-ttu-id="3896d-295">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="3896d-295">Next steps</span></span>
[<span data-ttu-id="3896d-296">Como os serviços de nuvem tooManage</span><span class="sxs-lookup"><span data-stu-id="3896d-296">How tooManage Cloud Services</span></span>](cloud-services-how-to-manage.md)  
[<span data-ttu-id="3896d-297">Como os serviços de nuvem tooMonitor</span><span class="sxs-lookup"><span data-stu-id="3896d-297">How tooMonitor Cloud Services</span></span>](cloud-services-how-to-monitor.md)  
[<span data-ttu-id="3896d-298">Como os serviços de nuvem tooConfigure</span><span class="sxs-lookup"><span data-stu-id="3896d-298">How tooConfigure Cloud Services</span></span>](cloud-services-how-to-configure.md)  
