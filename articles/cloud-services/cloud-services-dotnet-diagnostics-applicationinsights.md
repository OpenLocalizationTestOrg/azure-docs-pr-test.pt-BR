---
title: "aaaTroubleshoot serviços de nuvem usando o Application Insights | Microsoft Docs"
description: "Saiba como o serviço de nuvem tootroubleshoot emite usando dados do Application Insights tooprocess do diagnóstico do Azure."
services: cloud-services
documentationcenter: .net
author: sbtron
manager: timlt
editor: tysonn
ms.assetid: e93f387b-ef29-4731-ae41-0676722accb6
ms.service: cloud-services
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 05/23/2017
ms.author: saurabh
ms.openlocfilehash: 972924d9e6d1fe33d5c19b006d482de52ffb0ef7
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="troubleshoot-cloud-services-using-application-insights"></a><span data-ttu-id="1be0f-103">Solucionar problemas de Serviços de Nuvem usando o Application Insights</span><span class="sxs-lookup"><span data-stu-id="1be0f-103">Troubleshoot Cloud Services using Application Insights</span></span>
<span data-ttu-id="1be0f-104">Com [Azure SDK 2.8](https://azure.microsoft.com/downloads/) e extensão de diagnóstico do Azure 1.5, você pode enviar dados de diagnóstico do Azure para seu serviço de nuvem diretamente tooApplication Insights.</span><span class="sxs-lookup"><span data-stu-id="1be0f-104">With [Azure SDK 2.8](https://azure.microsoft.com/downloads/) and Azure diagnostics extension 1.5, you can send Azure Diagnostics data for your Cloud Service directly tooApplication Insights.</span></span> <span data-ttu-id="1be0f-105">Olá logs coletados pelo diagnóstico do Azure&mdash;incluindo logs de aplicativo, Logs de eventos do Windows, os Logs do ETW e contadores de desempenho&mdash;podem ser enviados tooApplication Insights.</span><span class="sxs-lookup"><span data-stu-id="1be0f-105">hello logs collected by Azure Diagnostics&mdash;including application logs, Windows Event Logs, ETW Logs, and performance counters&mdash;can be sent tooApplication Insights.</span></span> <span data-ttu-id="1be0f-106">Em seguida, você pode visualizar essas informações no portal do Application Insights Olá da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="1be0f-106">You can then visualize this information in hello Application Insights portal UI.</span></span> <span data-ttu-id="1be0f-107">Em seguida, você pode usar o hello SDK do Application Insights tooget panorama de métricas e os logs que vêm de seu aplicativo, bem como sistema hello e dados de nível de infraestrutura que vêm do diagnóstico do Azure.</span><span class="sxs-lookup"><span data-stu-id="1be0f-107">You can then use hello Application Insights SDK tooget insights into metrics and logs that come from your application, as well as hello system and infrastructure-level data that comes from Azure Diagnostics.</span></span>

## <a name="configure-azure-diagnostics-toosend-data-tooapplication-insights"></a><span data-ttu-id="1be0f-108">Configurar o diagnóstico do Azure toosend dados tooApplication Insights</span><span class="sxs-lookup"><span data-stu-id="1be0f-108">Configure Azure Diagnostics toosend data tooApplication Insights</span></span>
<span data-ttu-id="1be0f-109">Siga essas tooset etapas a sua nuvem serviço projeto toosend diagnóstico do Azure dados tooApplication Insights.</span><span class="sxs-lookup"><span data-stu-id="1be0f-109">Follow these steps tooset up your cloud service project toosend Azure Diagnostics data tooApplication Insights.</span></span>

1. <span data-ttu-id="1be0f-110">No Gerenciador de soluções do Visual Studio, clique em uma função e selecione **propriedades** designer de função tooopen hello.</span><span class="sxs-lookup"><span data-stu-id="1be0f-110">In Visual Studio Solution Explorer, right-click a role and select **Properties** tooopen hello Role designer.</span></span>

    ![Propriedades da função Gerenciador de Soluções][1]

2. <span data-ttu-id="1be0f-112">Em Olá **diagnóstico** seção saudação do designer de função, selecione Olá **enviar dados de diagnóstico tooApplication Insights** opção.</span><span class="sxs-lookup"><span data-stu-id="1be0f-112">In hello **Diagnostics** section of hello Role designer, select hello **Send diagnostics data tooApplication Insights** option.</span></span>

    ![Designer de função enviar informações de tooapplication de dados de diagnósticos][2]

3. <span data-ttu-id="1be0f-114">Na caixa de diálogo de Olá pop-up, selecione o recurso do Application Insights Olá que dados de diagnóstico do Azure Olá toosend devem.</span><span class="sxs-lookup"><span data-stu-id="1be0f-114">In hello dialog box that pops up, select hello Application Insights resource that you want toosend hello Azure diagnostics data to.</span></span> <span data-ttu-id="1be0f-115">caixa de diálogo Olá permite tooselect um recurso existente do Application Insights de sua assinatura ou toomanually especificar uma chave de instrumentação para um recurso do Application Insights.</span><span class="sxs-lookup"><span data-stu-id="1be0f-115">hello dialog box allows you tooselect an existing Application Insights resource from your subscription or toomanually specify an instrumentation key for an Application Insights resource.</span></span> <span data-ttu-id="1be0f-116">Para saber mais sobre como criar um recurso do Application Insights, confira [Criar um novo recurso do Application Insights](../application-insights/app-insights-create-new-resource.md).</span><span class="sxs-lookup"><span data-stu-id="1be0f-116">For more information on creating an Application Insights resource, see [Create a new Application Insights resource](../application-insights/app-insights-create-new-resource.md).</span></span>

    ![selecionar recurso do application insights][3]

    <span data-ttu-id="1be0f-118">Depois que você adicionou o recurso do Application Insights hello, chave de instrumentação Olá para esse recurso é armazenada como uma configuração de serviço com o nome da saudação **APPINSIGHTS_INSTRUMENTATIONKEY**.</span><span class="sxs-lookup"><span data-stu-id="1be0f-118">Once you have added hello Application Insights resource, hello instrumentation key for that resource is stored as a service configuration setting with hello name **APPINSIGHTS_INSTRUMENTATIONKEY**.</span></span> <span data-ttu-id="1be0f-119">Você pode alterar essa configuração para cada ambiente ou configuração de serviço.</span><span class="sxs-lookup"><span data-stu-id="1be0f-119">You can change this configuration setting for each service configuration or environment.</span></span> <span data-ttu-id="1be0f-120">toodo portanto, selecione uma configuração diferente de saudação **configuração do serviço** lista e especifique uma nova chave de instrumentação para essa configuração.</span><span class="sxs-lookup"><span data-stu-id="1be0f-120">toodo so, select a different configuration from hello **Service Configuration** list and specify a new instrumentation key for that configuration.</span></span>

    ![selecionar configuração de serviço][4]

    <span data-ttu-id="1be0f-122">Olá **APPINSIGHTS_INSTRUMENTATIONKEY** configuração será usada pela extensão de diagnóstico do Visual Studio tooconfigure Olá com hello apropriado do Application Insights informações sobre o recurso durante a publicação.</span><span class="sxs-lookup"><span data-stu-id="1be0f-122">hello **APPINSIGHTS_INSTRUMENTATIONKEY** configuration setting is used by Visual Studio tooconfigure hello diagnostics extension with hello appropriate Application Insights resource information during publishing.</span></span> <span data-ttu-id="1be0f-123">configuração de saudação é uma maneira conveniente de definir chaves de instrumentação diferentes para configurações de serviço diferentes.</span><span class="sxs-lookup"><span data-stu-id="1be0f-123">hello configuration setting is a convenient way of defining different instrumentation keys for different service configurations.</span></span> <span data-ttu-id="1be0f-124">O Visual Studio converter essa configuração e inseri-lo na configuração da extensão pública do diagnóstico Olá durante a saudação processo de publicação.</span><span class="sxs-lookup"><span data-stu-id="1be0f-124">Visual Studio will translate that setting and insert it into hello diagnostics extension public configuration during hello publish process.</span></span> <span data-ttu-id="1be0f-125">processo de saudação toosimplify de configuração de extensão de diagnóstico Olá com o PowerShell, saída do pacote de saudação do Visual Studio também contém Olá pública XML de configuração com a chave de instrumentação do Application Insights apropriado hello.</span><span class="sxs-lookup"><span data-stu-id="1be0f-125">toosimplify hello process of configuring hello diagnostics extension with PowerShell, hello package output from Visual Studio also contains hello public configuration XML with hello appropriate Application Insights instrumentation key.</span></span> <span data-ttu-id="1be0f-126">arquivos de configuração pública Olá são criados na pasta de extensões hello e seguem o padrão de saudação *PaaSDiagnostics.&lt; RoleName&gt;. PubConfig.xml*.</span><span class="sxs-lookup"><span data-stu-id="1be0f-126">hello public config files are created in hello Extensions folder and follow hello pattern *PaaSDiagnostics.&lt;RoleName&gt;.PubConfig.xml*.</span></span> <span data-ttu-id="1be0f-127">Todas as implantações com base em PowerShell podem usar este padrão toomap cada função tooa de configuração.</span><span class="sxs-lookup"><span data-stu-id="1be0f-127">Any PowerShell-based deployments can use this pattern toomap each configuration tooa role.</span></span>

4) <span data-ttu-id="1be0f-128">toosend de diagnóstico do Azure tooconfigure todos os contadores de desempenho e logs de nível de erro coletados pelo tooApplication de agente de diagnóstico do Azure Olá Insights, habilitar Olá **enviar dados de diagnóstico tooApplication Insights** opção.</span><span class="sxs-lookup"><span data-stu-id="1be0f-128">tooconfigure Azure diagnostics toosend all performance counters and error-level logs collected by hello Azure diagnostics agent tooApplication Insights, enable hello **Send diagnostics data tooApplication Insights** option.</span></span> 

    <span data-ttu-id="1be0f-129">Se você quiser toofurther configurar quais dados são enviados tooApplication Insights, você deve editar manualmente Olá *wadcfgx* arquivo para cada função.</span><span class="sxs-lookup"><span data-stu-id="1be0f-129">If you want toofurther configure what data is sent tooApplication Insights, you must manually edit hello *diagnostics.wadcfgx* file for each role.</span></span> <span data-ttu-id="1be0f-130">Consulte [tooApplication de dados toosend de configurar o diagnóstico do Azure Insights](#configure-azure-diagnostics-to-send-data-to-application-insights) toolearn mais sobre como atualizar manualmente a configuração de saudação.</span><span class="sxs-lookup"><span data-stu-id="1be0f-130">See [Configure Azure Diagnostics toosend data tooApplication Insights](#configure-azure-diagnostics-to-send-data-to-application-insights) toolearn more about manually updating hello configuration.</span></span>

<span data-ttu-id="1be0f-131">Quando o serviço de nuvem de saudação configurado toosend informações de tooapplication de dados de diagnóstico do Azure, você pode implantá-lo tooAzure normalmente, certificando-se de saudação extensão de diagnóstico do Azure está habilitada.</span><span class="sxs-lookup"><span data-stu-id="1be0f-131">When hello cloud service is configured toosend Azure diagnostics data tooapplication insights, you can deploy it tooAzure normally, making sure hello Azure diagnostics extension is enabled.</span></span> <span data-ttu-id="1be0f-132">Para saber mais, confira [Como publicar um serviço de nuvem usando o Visual Studio](../vs-azure-tools-publishing-a-cloud-service.md).</span><span class="sxs-lookup"><span data-stu-id="1be0f-132">For more information, see  [Publishing a Cloud Service using Visual Studio](../vs-azure-tools-publishing-a-cloud-service.md).</span></span>  

## <a name="viewing-azure-diagnostics-data-in-application-insights"></a><span data-ttu-id="1be0f-133">Exibindo dados do Diagnóstico do Azure no Application Insights</span><span class="sxs-lookup"><span data-stu-id="1be0f-133">Viewing Azure diagnostics data in Application Insights</span></span>
<span data-ttu-id="1be0f-134">Olá telemetria de diagnóstica do Azure aparece na Olá Application Insights recurso configurado para o serviço de nuvem.</span><span class="sxs-lookup"><span data-stu-id="1be0f-134">hello Azure diagnostic telemetry shows up in hello Application Insights resource configured for your cloud service.</span></span>

<span data-ttu-id="1be0f-135">Tipos de log de diagnóstico do Azure mapeiam tooApplication conceitos de informações das seguintes maneiras:</span><span class="sxs-lookup"><span data-stu-id="1be0f-135">Azure diagnostics log types map tooApplication Insights concepts in these ways:</span></span>

* <span data-ttu-id="1be0f-136">Contadores de desempenho são exibidos como Métricas Personalizadas no Application Insights.</span><span class="sxs-lookup"><span data-stu-id="1be0f-136">Performance counters are displayed as Custom Metrics in Application Insights.</span></span>
* <span data-ttu-id="1be0f-137">Logs de Eventos do Windows são mostrados como Rastreamentos e Eventos Personalizados no Application Insights.</span><span class="sxs-lookup"><span data-stu-id="1be0f-137">Windows Event Logs are shown as Traces and Custom Events in Application Insights.</span></span>
* <span data-ttu-id="1be0f-138">Logs de Aplicativo, logs de ETW e logs de Infraestrutura de Diagnóstico são mostrados como Rastreamentos no Application Insights.</span><span class="sxs-lookup"><span data-stu-id="1be0f-138">Application logs, ETW logs, and any Diagnostics Infrastructure logs are shown as Traces in Application Insights.</span></span>

<span data-ttu-id="1be0f-139">tooview dados de diagnóstico do Azure no Application Insights, siga um destes procedimentos Olá:</span><span class="sxs-lookup"><span data-stu-id="1be0f-139">tooview Azure diagnostics data in Application Insights, do one of hello following:</span></span>

* <span data-ttu-id="1be0f-140">Use [do Metrics explorer](../application-insights/app-insights-metrics-explorer.md) toovisualize qualquer personalizado contadores de desempenho ou contagens de diferentes tipos de eventos de Log de eventos do Windows.</span><span class="sxs-lookup"><span data-stu-id="1be0f-140">Use [Metrics explorer](../application-insights/app-insights-metrics-explorer.md) toovisualize any custom performance counters or counts of different types of Windows Event Log events.</span></span>

    ![Métricas personalizadas no Metrics Explorer][5]

* <span data-ttu-id="1be0f-142">Use [pesquisa](../application-insights/app-insights-diagnostic-search.md) toosearch em logs de rastreamento de saudação enviadas pelo diagnóstico do Azure.</span><span class="sxs-lookup"><span data-stu-id="1be0f-142">Use [Search](../application-insights/app-insights-diagnostic-search.md) toosearch across hello  trace logs sent by Azure Diagnostics.</span></span> <span data-ttu-id="1be0f-143">Por exemplo, se uma exceção não tratada causou Olá função toocrash e reciclagem, informações sobre a exceção de saudação aparece na Olá *aplicativo* canal de *Log de eventos do Windows*.</span><span class="sxs-lookup"><span data-stu-id="1be0f-143">For example, if an unhandled exception has caused hello role toocrash and recycle, information about hello exception shows up in hello *Application* channel of *Windows Event Log*.</span></span> <span data-ttu-id="1be0f-144">Você pode usar pesquisa toolook em Olá erro de Log de eventos do Windows e obter o rastreamento de pilha completa de saudação para Olá exceção toohelp localizar Olá causa Olá problema.</span><span class="sxs-lookup"><span data-stu-id="1be0f-144">You can use search toolook at hello Windows Event Log error and get hello full stack trace for hello exception toohelp find hello cause of hello issue.</span></span>

    ![Pesquisar rastreamentos][6]

## <a name="next-steps"></a><span data-ttu-id="1be0f-146">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="1be0f-146">Next Steps</span></span>
* <span data-ttu-id="1be0f-147">[Adicionar serviço de nuvem Olá SDK do Application Insights tooyour](../application-insights/app-insights-cloudservices.md) toosend dados sobre solicitações, exceções, dependências e qualquer telemetria personalizada de seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="1be0f-147">[Add hello Application Insights SDK tooyour cloud service](../application-insights/app-insights-cloudservices.md) toosend data about requests, exceptions, dependencies, and any custom telemetry from your application.</span></span> <span data-ttu-id="1be0f-148">Quando combinado com dados de diagnóstico do Azure hello, essas informações você pode obter uma visão completa do seu aplicativo e do sistema, todos na Olá mesmo recurso do Application Insight.</span><span class="sxs-lookup"><span data-stu-id="1be0f-148">When combined with hello Azure Diagnostics data, this information you can get a complete view of your application and system, all in hello same Application Insight resource.</span></span>  

<!--Image references-->
[1]: ./media/cloud-services-dotnet-diagnostics-applicationinsights/solution-explorer-properties.png
[2]: ./media/cloud-services-dotnet-diagnostics-applicationinsights/role-designer-sendtoappinsights.png
[3]: ./media/cloud-services-dotnet-diagnostics-applicationinsights/select-appinsights-resource.png
[4]: ./media/cloud-services-dotnet-diagnostics-applicationinsights/role-designer-appinsights-serviceconfig.png
[5]: ./media/cloud-services-dotnet-diagnostics-applicationinsights/metrics-explorer-custom-metrics.png
[6]: ./media/cloud-services-dotnet-diagnostics-applicationinsights/search-windowseventlog-error.png
