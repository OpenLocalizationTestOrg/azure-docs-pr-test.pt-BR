---
title: "Gerenciar a carga de microsserviço do Azure usando métricas | Microsoft Docs"
description: "Saiba mais sobre como configurar e usar métricas no Service Fabric para gerenciar o consumo de recursos de serviço."
services: service-fabric
documentationcenter: .net
author: masnider
manager: timlt
editor: 
ms.assetid: 0d622ea6-a7c7-4bef-886b-06e6b85a97fb
ms.service: Service-Fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 08/18/2017
ms.author: masnider
ms.openlocfilehash: 7e020bb6c02c80127e4225ba695017dff9b5a168
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/18/2017
---
# <a name="managing-resource-consumption-and-load-in-service-fabric-with-metrics"></a><span data-ttu-id="20fcd-103">Gerenciando o consumo e a carga de recursos no Service Fabric com métricas</span><span class="sxs-lookup"><span data-stu-id="20fcd-103">Managing resource consumption and load in Service Fabric with metrics</span></span>
<span data-ttu-id="20fcd-104">*Métricas* são os recursos que são importantes para seus serviços e que são fornecidas pelos nós no cluster.</span><span class="sxs-lookup"><span data-stu-id="20fcd-104">*Metrics* are the resources that your services care about and which are provided by the nodes in the cluster.</span></span> <span data-ttu-id="20fcd-105">Uma métrica é tudo o que você deseja gerenciar para melhorar ou monitorar o desempenho de seus serviços.</span><span class="sxs-lookup"><span data-stu-id="20fcd-105">A metric is anything that you want to manage in order to improve or monitor the performance of your services.</span></span> <span data-ttu-id="20fcd-106">Por exemplo, você pode observar o consumo de memória para saber se o serviço está sobrecarregado.</span><span class="sxs-lookup"><span data-stu-id="20fcd-106">For example, you might watch memory consumption to know if your service is overloaded.</span></span> <span data-ttu-id="20fcd-107">Outro uso é para descobrir se o serviço pode ser movido para outro lugar onde a memória seja menos restrita para obter um melhor desempenho.</span><span class="sxs-lookup"><span data-stu-id="20fcd-107">Another use is to figure out whether the service could move elsewhere where memory is less constrained in order to get better performance.</span></span>

<span data-ttu-id="20fcd-108">Itens como Memória, Disco e Uso de CPU são exemplos de métricas.</span><span class="sxs-lookup"><span data-stu-id="20fcd-108">Things like Memory, Disk, and CPU usage are examples of metrics.</span></span> <span data-ttu-id="20fcd-109">Essas métricas são métricas físicas, recursos que correspondem aos recursos físicos no nó que precisam ser gerenciados.</span><span class="sxs-lookup"><span data-stu-id="20fcd-109">These metrics are physical metrics, resources that correspond to physical resources on the node that need to be managed.</span></span> <span data-ttu-id="20fcd-110">As métricas também podem ser (e normalmente são) métricas lógicas.</span><span class="sxs-lookup"><span data-stu-id="20fcd-110">Metrics can also be (and commonly are) logical metrics.</span></span> <span data-ttu-id="20fcd-111">Métricas lógicas são itens como "MyWorkQueueDepth", "MessagesToProcess" ou "TotalRecords".</span><span class="sxs-lookup"><span data-stu-id="20fcd-111">Logical metrics are things like “MyWorkQueueDepth” or "MessagesToProcess" or "TotalRecords".</span></span> <span data-ttu-id="20fcd-112">Métricas lógicas são definidas pelo aplicativo e indiretamente correspondem a algum consumo de recursos físicos.</span><span class="sxs-lookup"><span data-stu-id="20fcd-112">Logical metrics are application-defined and indirectly correspond to some physical resource consumption.</span></span> <span data-ttu-id="20fcd-113">Métricas lógicas são comuns, pois pode ser difícil medir e relatar o consumo de recursos físicos por serviço.</span><span class="sxs-lookup"><span data-stu-id="20fcd-113">Logical metrics are common because it can be hard to measure and report consumption of physical resources on a per-service basis.</span></span> <span data-ttu-id="20fcd-114">A complexidade de medir e relatar suas próprias métricas também é o motivo pelo qual o Service Fabric fornece algumas métricas padrão prontas.</span><span class="sxs-lookup"><span data-stu-id="20fcd-114">The complexity of measuring and reporting your own physical metrics is also why Service Fabric provides some default metrics.</span></span>

## <a name="default-metrics"></a><span data-ttu-id="20fcd-115">Métricas padrão</span><span class="sxs-lookup"><span data-stu-id="20fcd-115">Default metrics</span></span>
<span data-ttu-id="20fcd-116">Digamos que você deseja começar a escrever e implantar seu serviço.</span><span class="sxs-lookup"><span data-stu-id="20fcd-116">Let’s say that you want to get started writing and deploying your service.</span></span> <span data-ttu-id="20fcd-117">Neste ponto, você não sabe quais recursos físicos ou lógicos serão consumidos.</span><span class="sxs-lookup"><span data-stu-id="20fcd-117">At this point you don’t know what physical or logical resources it consumes.</span></span> <span data-ttu-id="20fcd-118">Sem problemas!</span><span class="sxs-lookup"><span data-stu-id="20fcd-118">That’s fine!</span></span> <span data-ttu-id="20fcd-119">O Gerenciador de Recursos de Cluster do Service Fabric usa algumas métricas padrão quando não há nenhuma outra métrica especificadas.</span><span class="sxs-lookup"><span data-stu-id="20fcd-119">The Service Fabric Cluster Resource Manager uses some default metrics when no other metrics are specified.</span></span> <span data-ttu-id="20fcd-120">Eles são:</span><span class="sxs-lookup"><span data-stu-id="20fcd-120">They are:</span></span>

  - <span data-ttu-id="20fcd-121">PrimaryCount - contagem de réplicas Primárias no nó</span><span class="sxs-lookup"><span data-stu-id="20fcd-121">PrimaryCount - count of Primary replicas on the node</span></span> 
  - <span data-ttu-id="20fcd-122">ReplicaCount - contagem total de réplicas com estado do nó</span><span class="sxs-lookup"><span data-stu-id="20fcd-122">ReplicaCount - count of total stateful replicas on the node</span></span>
  - <span data-ttu-id="20fcd-123">Count - contagem de todos os objetos de serviço (com e sem estado) no nó</span><span class="sxs-lookup"><span data-stu-id="20fcd-123">Count - count of all service objects (stateless and stateful) on the node</span></span>

| <span data-ttu-id="20fcd-124">Métrica</span><span class="sxs-lookup"><span data-stu-id="20fcd-124">Metric</span></span> | <span data-ttu-id="20fcd-125">Carga de Instância Sem Estado</span><span class="sxs-lookup"><span data-stu-id="20fcd-125">Stateless Instance Load</span></span> | <span data-ttu-id="20fcd-126">Carga Secundária com Estado</span><span class="sxs-lookup"><span data-stu-id="20fcd-126">Stateful Secondary Load</span></span> | <span data-ttu-id="20fcd-127">Carga Primária com Estado</span><span class="sxs-lookup"><span data-stu-id="20fcd-127">Stateful Primary Load</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="20fcd-128">PrimaryCount</span><span class="sxs-lookup"><span data-stu-id="20fcd-128">PrimaryCount</span></span> |<span data-ttu-id="20fcd-129">0</span><span class="sxs-lookup"><span data-stu-id="20fcd-129">0</span></span> |<span data-ttu-id="20fcd-130">0</span><span class="sxs-lookup"><span data-stu-id="20fcd-130">0</span></span> |<span data-ttu-id="20fcd-131">1</span><span class="sxs-lookup"><span data-stu-id="20fcd-131">1</span></span> |
| <span data-ttu-id="20fcd-132">ReplicaCount</span><span class="sxs-lookup"><span data-stu-id="20fcd-132">ReplicaCount</span></span> |<span data-ttu-id="20fcd-133">0</span><span class="sxs-lookup"><span data-stu-id="20fcd-133">0</span></span> |<span data-ttu-id="20fcd-134">1</span><span class="sxs-lookup"><span data-stu-id="20fcd-134">1</span></span> |<span data-ttu-id="20fcd-135">1</span><span class="sxs-lookup"><span data-stu-id="20fcd-135">1</span></span> |
| <span data-ttu-id="20fcd-136">Contagem</span><span class="sxs-lookup"><span data-stu-id="20fcd-136">Count</span></span> |<span data-ttu-id="20fcd-137">1</span><span class="sxs-lookup"><span data-stu-id="20fcd-137">1</span></span> |<span data-ttu-id="20fcd-138">1</span><span class="sxs-lookup"><span data-stu-id="20fcd-138">1</span></span> |<span data-ttu-id="20fcd-139">1</span><span class="sxs-lookup"><span data-stu-id="20fcd-139">1</span></span> |

<span data-ttu-id="20fcd-140">Para cargas de trabalho básicas, as métricas padrão fornecem uma distribuição razoável de trabalho no cluster.</span><span class="sxs-lookup"><span data-stu-id="20fcd-140">For basic workloads, the default metrics provide a decent distribution of work in the cluster.</span></span> <span data-ttu-id="20fcd-141">No exemplo a seguir, vamos ver o que acontece quando criamos dois serviços e dependemos das métricas padrão para balanceamento.</span><span class="sxs-lookup"><span data-stu-id="20fcd-141">In the following example, let’s see what happens when we create two services and rely on the default metrics for balancing.</span></span> <span data-ttu-id="20fcd-142">O primeiro serviço é um serviço com estado com três partições e um tamanho de conjunto de réplicas de destino de três.</span><span class="sxs-lookup"><span data-stu-id="20fcd-142">The first service is a stateful service with three partitions and a target replica set size of three.</span></span> <span data-ttu-id="20fcd-143">O segundo serviço é um serviço sem estado com uma partição e uma contagem de instâncias de três.</span><span class="sxs-lookup"><span data-stu-id="20fcd-143">The second service is a stateless service with one partition and an instance count of three.</span></span>

<span data-ttu-id="20fcd-144">Veja o acontece:</span><span class="sxs-lookup"><span data-stu-id="20fcd-144">Here's what you get:</span></span>

<span data-ttu-id="20fcd-145"><center>
![Layout de cluster com métricas padrão][Image1]
</center></span><span class="sxs-lookup"><span data-stu-id="20fcd-145"><center>
![Cluster Layout with Default Metrics][Image1]
</center></span></span>

<span data-ttu-id="20fcd-146">Algumas coisas que devem ser observadas:</span><span class="sxs-lookup"><span data-stu-id="20fcd-146">Some things to note:</span></span>
  - <span data-ttu-id="20fcd-147">As réplicas primárias para o serviço com estado são distribuídas por vários nós</span><span class="sxs-lookup"><span data-stu-id="20fcd-147">Primary replicas for the stateful service are distributed across several nodes</span></span>
  - <span data-ttu-id="20fcd-148">As réplicas da mesma partição estão em nós diferentes</span><span class="sxs-lookup"><span data-stu-id="20fcd-148">Replicas for the same partition are on different nodes</span></span>
  - <span data-ttu-id="20fcd-149">O número total de primários e de secundários é distribuído no cluster</span><span class="sxs-lookup"><span data-stu-id="20fcd-149">The total number of primaries and secondaries is distributed in the cluster</span></span>
  - <span data-ttu-id="20fcd-150">O número total de objetos de serviço é alocado uniformemente em cada nó</span><span class="sxs-lookup"><span data-stu-id="20fcd-150">The total number of service objects are evenly allocated on each node</span></span>

<span data-ttu-id="20fcd-151">Ótimo!</span><span class="sxs-lookup"><span data-stu-id="20fcd-151">Good!</span></span>

<span data-ttu-id="20fcd-152">As métricas padrão funcionam muito bem como ponto de partida.</span><span class="sxs-lookup"><span data-stu-id="20fcd-152">The default metrics work great as a start.</span></span> <span data-ttu-id="20fcd-153">No entanto, as métricas padrão só serão úteis até certo ponto.</span><span class="sxs-lookup"><span data-stu-id="20fcd-153">However, the default metrics will only carry you so far.</span></span> <span data-ttu-id="20fcd-154">Por exemplo: Qual é a probabilidade de que o esquema de particionamento que você escolheu resulte na utilização perfeitamente uniforme por todas as partições?</span><span class="sxs-lookup"><span data-stu-id="20fcd-154">For example: What's the likelihood that the partitioning scheme you picked results in perfectly even utilization by all partitions?</span></span> <span data-ttu-id="20fcd-155">Qual é a chance de que a carga de determinado serviço seja constante ao longo do tempo ou que seja uniforme entre várias partições neste momento?</span><span class="sxs-lookup"><span data-stu-id="20fcd-155">What’s the chance that the load for a given service is constant over time, or even just the same across multiple partitions right now?</span></span>

<span data-ttu-id="20fcd-156">Você pode executar somente com as métricas padrão.</span><span class="sxs-lookup"><span data-stu-id="20fcd-156">You could run with just the default metrics.</span></span> <span data-ttu-id="20fcd-157">No entanto, isso geralmente significa que a utilização do cluster é menor e mais irregular que o desejado.</span><span class="sxs-lookup"><span data-stu-id="20fcd-157">However, doing so usually means that your cluster utilization is lower and more uneven than you’d like.</span></span> <span data-ttu-id="20fcd-158">Isso ocorre porque as métricas padrão não são adaptáveis e presumem que tudo seja equivalente.</span><span class="sxs-lookup"><span data-stu-id="20fcd-158">This is because the default metrics aren't adaptive and presume everything is equivalent.</span></span> <span data-ttu-id="20fcd-159">Por exemplo, uma réplica Primária está ocupada e uma que não está contribuem ambas com "1" para a métrica de PrimaryCount.</span><span class="sxs-lookup"><span data-stu-id="20fcd-159">For example, a Primary that is busy and one that is not both contribute "1" to the PrimaryCount metric.</span></span> <span data-ttu-id="20fcd-160">Na pior das hipóteses, usar apenas as métricas padrão também pode resultar em nós com agendamento excessivo, causando problemas de desempenho.</span><span class="sxs-lookup"><span data-stu-id="20fcd-160">In the worst case, using only the default metrics can also result in overscheduled nodes resulting in performance issues.</span></span> <span data-ttu-id="20fcd-161">Se você está interessado em obter o máximo de seu cluster e evitar problemas de desempenho, você precisa usar as métricas personalizadas e o relatório de carga dinâmico.</span><span class="sxs-lookup"><span data-stu-id="20fcd-161">If you're interested in getting the most out of your cluster and avoiding performance issues, you need to use custom metrics and dynamic load reporting.</span></span>

## <a name="custom-metrics"></a><span data-ttu-id="20fcd-162">Métricas personalizadas</span><span class="sxs-lookup"><span data-stu-id="20fcd-162">Custom metrics</span></span>
<span data-ttu-id="20fcd-163">As métricas são configuradas por instância de serviço nomeado ao criar o serviço.</span><span class="sxs-lookup"><span data-stu-id="20fcd-163">Metrics are configured on a per-named-service-instance basis when you’re creating the service.</span></span>

<span data-ttu-id="20fcd-164">Qualquer métrica possui propriedades que a descrevem: um nome, um peso e uma carga padrão.</span><span class="sxs-lookup"><span data-stu-id="20fcd-164">Any metric has some properties that describe it: a name, a weight, and a default load.</span></span>

* <span data-ttu-id="20fcd-165">Nome da Métrica: o nome da métrica.</span><span class="sxs-lookup"><span data-stu-id="20fcd-165">Metric Name: The name of the metric.</span></span> <span data-ttu-id="20fcd-166">O nome da métrica é um identificador exclusivo para a métrica do cluster da perspectiva do Gerenciador de Recursos.</span><span class="sxs-lookup"><span data-stu-id="20fcd-166">The metric name is a unique identifier for the metric within the cluster from the Resource Manager’s perspective.</span></span>
* <span data-ttu-id="20fcd-167">Peso: o peso da métrica define o quanto ela é importante em relação as outras métricas para esse serviço.</span><span class="sxs-lookup"><span data-stu-id="20fcd-167">Weight: Metric weight defines how important this metric is relative to the other metrics for this service.</span></span>
* <span data-ttu-id="20fcd-168">Default Load: A carga padrão é representada de maneira diferente dependendo se o serviço está com ou sem estado.</span><span class="sxs-lookup"><span data-stu-id="20fcd-168">Default Load: The default load is represented differently depending on whether the service is stateless or stateful.</span></span>
  * <span data-ttu-id="20fcd-169">Para serviços sem estado cada métrica tem uma propriedade única chamada DeafultLoad</span><span class="sxs-lookup"><span data-stu-id="20fcd-169">For stateless services, each metric has a single property named DefaultLoad</span></span>
  * <span data-ttu-id="20fcd-170">Para serviços com estado, você define:</span><span class="sxs-lookup"><span data-stu-id="20fcd-170">For stateful services you define:</span></span>
    * <span data-ttu-id="20fcd-171">PrimaryDefaultLoad: o valor padrão dessa métrica que esse serviço consome quando é primário</span><span class="sxs-lookup"><span data-stu-id="20fcd-171">PrimaryDefaultLoad: The default amount of this metric this service consumes when it is a Primary</span></span>
    * <span data-ttu-id="20fcd-172">SecondaryDefaultLoad: o valor padrão dessa métrica que esse serviço consome quando é secundário</span><span class="sxs-lookup"><span data-stu-id="20fcd-172">SecondaryDefaultLoad: The default amount of this metric this service consumes when it is a Secondary</span></span>

> [!NOTE]
> <span data-ttu-id="20fcd-173">Se definir métricas personalizadas e _também_ desejar usar as métricas padrão, você precisa adicionar _explicitamente_ as métricas padrão e definir os pesos e valores para elas.</span><span class="sxs-lookup"><span data-stu-id="20fcd-173">If you define custom metrics and you want to _also_ use the default metrics, you need to _explicitly_ add the default metrics back and define weights and values for them.</span></span> <span data-ttu-id="20fcd-174">Isso ocorre porque você deve definir a relação entre as métricas padrão e as métricas personalizadas.</span><span class="sxs-lookup"><span data-stu-id="20fcd-174">This is because you must define the relationship between the default metrics and your custom metrics.</span></span> <span data-ttu-id="20fcd-175">Por exemplo, talvez você se preocupe mais com ConnectionCount ou WorkQueueDepth do que com a distribuição Principal.</span><span class="sxs-lookup"><span data-stu-id="20fcd-175">For example, maybe you care about ConnectionCount or WorkQueueDepth more than Primary distribution.</span></span> <span data-ttu-id="20fcd-176">Por padrão o peso da métrica PrimaryCount é Alto, portanto, você deseja reduzi-lo para Médio, quando você adiciona as outras métricas para garantir que eles tenham precedência.</span><span class="sxs-lookup"><span data-stu-id="20fcd-176">By default the weight of the PrimaryCount metric is High, so you want to reduce it to Medium when you add your other metrics to ensure they take precedence.</span></span>
>

### <a name="defining-metrics-for-your-service---an-example"></a><span data-ttu-id="20fcd-177">Definindo métricas para seu serviço - um exemplo</span><span class="sxs-lookup"><span data-stu-id="20fcd-177">Defining metrics for your service - an example</span></span>
<span data-ttu-id="20fcd-178">Digamos que você deseja a configuração a seguir:</span><span class="sxs-lookup"><span data-stu-id="20fcd-178">Let’s say you want the following configuration:</span></span>

  - <span data-ttu-id="20fcd-179">O serviço relata uma métrica denominada “ConnectionCount”</span><span class="sxs-lookup"><span data-stu-id="20fcd-179">Your service reports a metric named "ConnectionCount”</span></span>
  - <span data-ttu-id="20fcd-180">Você também deseja usar as métricas padrão</span><span class="sxs-lookup"><span data-stu-id="20fcd-180">You also want to use the default metrics</span></span> 
  - <span data-ttu-id="20fcd-181">Você fez algumas medições e sabe que normalmente uma réplica Primária desse serviço requer 20 unidades de “ConnectionCount”</span><span class="sxs-lookup"><span data-stu-id="20fcd-181">You’ve done some measurements and know that normally a Primary replica of that service takes up 20 units of "ConnectionCount"</span></span>
  - <span data-ttu-id="20fcd-182">As secundárias usam 5 unidades de "ConnectionCount"</span><span class="sxs-lookup"><span data-stu-id="20fcd-182">Secondaries use 5 units of "ConnectionCount"</span></span>
  - <span data-ttu-id="20fcd-183">Você sabe que a memória é a métrica mais importante em termos de gerenciamento de desempenho desse serviço específico</span><span class="sxs-lookup"><span data-stu-id="20fcd-183">You know that "ConnectionCount" is the most important metric in terms of managing the performance of this particular service</span></span>
  - <span data-ttu-id="20fcd-184">Você ainda deseja que as réplicas Principais sejam balanceadas.</span><span class="sxs-lookup"><span data-stu-id="20fcd-184">You still want Primary replicas balanced.</span></span> <span data-ttu-id="20fcd-185">Balancear réplicas primárias geralmente é uma boa ideia.</span><span class="sxs-lookup"><span data-stu-id="20fcd-185">Balancing primary replicas is generally a good idea no matter what.</span></span> <span data-ttu-id="20fcd-186">Isso ajuda a evitar que a perda de algum nó ou domínio de falha afete a maioria das réplicas primárias.</span><span class="sxs-lookup"><span data-stu-id="20fcd-186">This helps prevent the loss of some node or fault domain from impacting a majority of primary replicas along with it.</span></span> 
  - <span data-ttu-id="20fcd-187">Caso contrário, as métricas padrão não representam um problema</span><span class="sxs-lookup"><span data-stu-id="20fcd-187">Otherwise, the default metrics are fine</span></span>

<span data-ttu-id="20fcd-188">Aqui está o código que você escreveria para criar um serviço com essa configuração de métrica:</span><span class="sxs-lookup"><span data-stu-id="20fcd-188">Here’s the code that you would write to create a service with that metric configuration:</span></span>

<span data-ttu-id="20fcd-189">Código:</span><span class="sxs-lookup"><span data-stu-id="20fcd-189">Code:</span></span>

```csharp
StatefulServiceDescription serviceDescription = new StatefulServiceDescription();
StatefulServiceLoadMetricDescription connectionMetric = new StatefulServiceLoadMetricDescription();
connectionMetric.Name = "ConnectionCount";
connectionMetric.PrimaryDefaultLoad = 20;
connectionMetric.SecondaryDefaultLoad = 5;
connectionMetric.Weight = ServiceLoadMetricWeight.High;

StatefulServiceLoadMetricDescription primaryCountMetric = new StatefulServiceLoadMetricDescription();
primaryCountMetric.Name = "PrimaryCount";
primaryCountMetric.PrimaryDefaultLoad = 1;
primaryCountMetric.SecondaryDefaultLoad = 0;
primaryCountMetric.Weight = ServiceLoadMetricWeight.Medium;

StatefulServiceLoadMetricDescription replicaCountMetric = new StatefulServiceLoadMetricDescription();
replicaCountMetric.Name = "ReplicaCount";
replicaCountMetric.PrimaryDefaultLoad = 1;
replicaCountMetric.SecondaryDefaultLoad = 1;
replicaCountMetric.Weight = ServiceLoadMetricWeight.Low;

StatefulServiceLoadMetricDescription totalCountMetric = new StatefulServiceLoadMetricDescription();
totalCountMetric.Name = "Count";
totalCountMetric.PrimaryDefaultLoad = 1;
totalCountMetric.SecondaryDefaultLoad = 1;
totalCountMetric.Weight = ServiceLoadMetricWeight.Low;

serviceDescription.Metrics.Add(connectionMetric);
serviceDescription.Metrics.Add(primaryCountMetric);
serviceDescription.Metrics.Add(replicaCountMetric);
serviceDescription.Metrics.Add(totalCountMetric);

await fabricClient.ServiceManager.CreateServiceAsync(serviceDescription);
```

<span data-ttu-id="20fcd-190">Powershell:</span><span class="sxs-lookup"><span data-stu-id="20fcd-190">Powershell:</span></span>

```posh
New-ServiceFabricService -ApplicationName $applicationName -ServiceName $serviceName -ServiceTypeName $serviceTypeName –Stateful -MinReplicaSetSize 3 -TargetReplicaSetSize 3 -PartitionSchemeSingleton –Metric @("ConnectionCount,High,20,5”,"PrimaryCount,Medium,1,0”,"ReplicaCount,Low,1,1”,"Count,Low,1,1”)
```

> [!NOTE]
> <span data-ttu-id="20fcd-191">Os exemplos anteriores e o restante deste documento descrevem as métricas de gerenciamento por serviço nomeado.</span><span class="sxs-lookup"><span data-stu-id="20fcd-191">The above examples and the rest of this document describe managing metrics on a per-named-service basis.</span></span> <span data-ttu-id="20fcd-192">Também é possível definir as métricas para os serviços no nível do _tipo_ de serviço.</span><span class="sxs-lookup"><span data-stu-id="20fcd-192">It is also possible to define metrics for your services at the service _type_ level.</span></span> <span data-ttu-id="20fcd-193">Isso é feito especificando-as em seus manifestos de serviço.</span><span class="sxs-lookup"><span data-stu-id="20fcd-193">This is accomplished by specifying them in your service manifests.</span></span> <span data-ttu-id="20fcd-194">Não é recomendável definir as métricas do nível de tipo por vários motivos.</span><span class="sxs-lookup"><span data-stu-id="20fcd-194">Defining type level metrics is not recommended for several reasons.</span></span> <span data-ttu-id="20fcd-195">O primeiro motivo é que os nomes de métrica são frequentemente específicos do ambiente.</span><span class="sxs-lookup"><span data-stu-id="20fcd-195">The first reason is that metric names are frequently environment-specific.</span></span> <span data-ttu-id="20fcd-196">A menos que haja um contrato sólido em vigor, você não pode ter certeza que a métrica "Núcleos" em um ambiente não é "MiliNúcelos" ou "NúClEoS" em outros.</span><span class="sxs-lookup"><span data-stu-id="20fcd-196">Unless there is a firm contract in place, you cannot be sure that the metric "Cores" in one environment isn't "MiliCores" or "CoReS" in others.</span></span> <span data-ttu-id="20fcd-197">Se suas métricas são definidas em seu manifesto, você precisa criar novos manifestos por ambiente.</span><span class="sxs-lookup"><span data-stu-id="20fcd-197">If your metrics are defined in your manifest you need to create new manifests per environment.</span></span> <span data-ttu-id="20fcd-198">Isso geralmente resulta em uma proliferação de manifestos diferentes com apenas algumas pequenas diferenças, que podem levar a problemas de gerenciamento.</span><span class="sxs-lookup"><span data-stu-id="20fcd-198">This usually leads to a proliferation of different manifests with only minor differences, which can lead to management difficulties.</span></span>  
>
> <span data-ttu-id="20fcd-199">Cargas de métricas normalmente são atribuídas por instância de serviço nomeada.</span><span class="sxs-lookup"><span data-stu-id="20fcd-199">Metric loads are commonly assigned on a per-named-service-instance basis.</span></span> <span data-ttu-id="20fcd-200">Por exemplo, digamos que você crie uma instância do serviço para ClienteA que planeja usá-lo pouco.</span><span class="sxs-lookup"><span data-stu-id="20fcd-200">For example, let's say you create one instance of the service for CustomerA who plans to use it only lightly.</span></span> <span data-ttu-id="20fcd-201">Digamos que você também crie outra para ClienteB que tem uma carga de trabalho maior.</span><span class="sxs-lookup"><span data-stu-id="20fcd-201">Let's also say you create another for CustomerB who has a larger workload.</span></span> <span data-ttu-id="20fcd-202">Nesse caso, você provavelmente iria querer ajustar as cargas padrão para esses serviços.</span><span class="sxs-lookup"><span data-stu-id="20fcd-202">In this case, you'd probably want to tweak the default loads for those services.</span></span> <span data-ttu-id="20fcd-203">Se você tiver as métricas e as cargas definidas por meio de manifestos e você deseja oferecer suporte a esse cenário, é necessário diferentes aplicativos e tipos de serviço para cada cliente.</span><span class="sxs-lookup"><span data-stu-id="20fcd-203">If you have metrics and loads defined via manifests and you want to support this scenario, it requires different application and service types for each customer.</span></span> <span data-ttu-id="20fcd-204">Os valores definidos no momento da criação de serviço substituem aqueles definidos no manifesto, para que você possa usá-los para definir os padrões específicos.</span><span class="sxs-lookup"><span data-stu-id="20fcd-204">The values defined at service creation time override those defined in the manifest, so you could use that to set the specific defaults.</span></span> <span data-ttu-id="20fcd-205">No entanto, isso faz com que os valores declarados nos manifestos não coincidam aqueles onde o serviço é realmente executado.</span><span class="sxs-lookup"><span data-stu-id="20fcd-205">However, doing that causes the values declared in the manifests to not match those the service actually runs with.</span></span> <span data-ttu-id="20fcd-206">Isso pode causar confusão.</span><span class="sxs-lookup"><span data-stu-id="20fcd-206">This can lead to confusion.</span></span> 
>

<span data-ttu-id="20fcd-207">Lembre-se: se você quiser usar as métricas padrão, não precisará sequer encostar na coleção de métricas ou fazer algo especial ao criar o seu serviço.</span><span class="sxs-lookup"><span data-stu-id="20fcd-207">As a reminder: if you just want to use the default metrics, you don’t need to touch the metrics collection at all or do anything special when creating your service.</span></span> <span data-ttu-id="20fcd-208">As métricas padrão são usadas automaticamente quando nenhuma outra métrica é definida.</span><span class="sxs-lookup"><span data-stu-id="20fcd-208">The default metrics get used automatically when no others are defined.</span></span> 

<span data-ttu-id="20fcd-209">Agora, vamos percorrer cada uma dessas configurações mais detalhadamente e falar sobre o comportamento que ela influencia.</span><span class="sxs-lookup"><span data-stu-id="20fcd-209">Now, let's go through each of these settings in more detail and talk about the behavior that it influences.</span></span>

## <a name="load"></a><span data-ttu-id="20fcd-210">Carregar</span><span class="sxs-lookup"><span data-stu-id="20fcd-210">Load</span></span>
<span data-ttu-id="20fcd-211">O objetivo da definição de métricas é representar alguma carga.</span><span class="sxs-lookup"><span data-stu-id="20fcd-211">The whole point of defining metrics is to represent some load.</span></span> <span data-ttu-id="20fcd-212">*Carga* é a quantidade de determinada métrica consumida por alguma instância de serviço ou réplica em determinado nó.</span><span class="sxs-lookup"><span data-stu-id="20fcd-212">*Load* is how much of a given metric is consumed by some service instance or replica on a given node.</span></span> <span data-ttu-id="20fcd-213">A carga pode ser configurada em praticamente qualquer ponto.</span><span class="sxs-lookup"><span data-stu-id="20fcd-213">Load can be configured at almost any point.</span></span> <span data-ttu-id="20fcd-214">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="20fcd-214">For example:</span></span>

  - <span data-ttu-id="20fcd-215">A carga pode ser definida quando um serviço é criado.</span><span class="sxs-lookup"><span data-stu-id="20fcd-215">Load can be defined when a service is created.</span></span> <span data-ttu-id="20fcd-216">Isso é chamado de _carga padrão_.</span><span class="sxs-lookup"><span data-stu-id="20fcd-216">This is called _default load_.</span></span>
  - <span data-ttu-id="20fcd-217">As informações de métrica, inclusive as cargas padrão, para um serviço podem ser atualizadas depois que o serviço é criado.</span><span class="sxs-lookup"><span data-stu-id="20fcd-217">The metric information, including default loads, for a service can updated after the service is created.</span></span> <span data-ttu-id="20fcd-218">Isso é chamado de _atualização de um serviço_.</span><span class="sxs-lookup"><span data-stu-id="20fcd-218">This is called _updating a service_.</span></span> 
  - <span data-ttu-id="20fcd-219">As cargas de uma determinada partição podem ser redefinidas com os valores padrão para o serviço.</span><span class="sxs-lookup"><span data-stu-id="20fcd-219">The loads for a given partition can be reset to the default values for that service.</span></span> <span data-ttu-id="20fcd-220">Isso é chamado de _redefinição da carga de partição_.</span><span class="sxs-lookup"><span data-stu-id="20fcd-220">This is called _resetting partition load_.</span></span>
  - <span data-ttu-id="20fcd-221">A carga pode ser relatada por objeto de serviço dinamicamente em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="20fcd-221">Load can be reported on a per service object basis dynamically during runtime.</span></span> <span data-ttu-id="20fcd-222">Isso é chamado de _relatório de carga_.</span><span class="sxs-lookup"><span data-stu-id="20fcd-222">This is called _reporting load_.</span></span> 
  
<span data-ttu-id="20fcd-223">Todas essas estratégias podem ser usadas dentro do mesmo serviço durante o seu tempo de vida.</span><span class="sxs-lookup"><span data-stu-id="20fcd-223">All of these strategies can be used within the same service over its lifetime.</span></span> 

## <a name="default-load"></a><span data-ttu-id="20fcd-224">Carga padrão</span><span class="sxs-lookup"><span data-stu-id="20fcd-224">Default load</span></span>
<span data-ttu-id="20fcd-225">*Carga padrão* é o quanto de métrica cada objeto de serviço (instância sem estado ou réplica com estado) desse serviço consome.</span><span class="sxs-lookup"><span data-stu-id="20fcd-225">*Default load* is how much of the metric each service object (stateless instance or stateful replica) of this service consumes.</span></span> <span data-ttu-id="20fcd-226">O Gerenciador de Recursos de Cluster usa esse número para a carga do objeto do serviço até receber outra informação, como um relatório de carga dinâmico.</span><span class="sxs-lookup"><span data-stu-id="20fcd-226">The Cluster Resource Manager uses this number for the load of the service object until it receives other information, such as a dynamic load report.</span></span> <span data-ttu-id="20fcd-227">Para serviços mais simples, a carga padrão é uma definição estática.</span><span class="sxs-lookup"><span data-stu-id="20fcd-227">For simpler services, the default load is a static definition.</span></span> <span data-ttu-id="20fcd-228">A carga padrão nunca é atualizada e é usada ao longo de todo o tempo de vida do serviço.</span><span class="sxs-lookup"><span data-stu-id="20fcd-228">The default load is never updated and is used for the lifetime of the service.</span></span> <span data-ttu-id="20fcd-229">A carga padrão funciona muito bem para cenários de planejamento de capacidade simples em que certos valores de recursos são dedicados para diferentes cargas de trabalho e não são alterados.</span><span class="sxs-lookup"><span data-stu-id="20fcd-229">Default loads works great for simple capacity planning scenarios where certain amounts of resources are dedicated to different workloads and do not change.</span></span>

> [!NOTE]
> <span data-ttu-id="20fcd-230">Para obter mais informações sobre o gerenciamento de capacidade e definição de capacidades para os nós no cluster, consulte [este artigo](service-fabric-cluster-resource-manager-cluster-description.md#capacity).</span><span class="sxs-lookup"><span data-stu-id="20fcd-230">For more information on capacity management and defining capacities for the nodes in your cluster, please see [this article](service-fabric-cluster-resource-manager-cluster-description.md#capacity).</span></span>
> 

<span data-ttu-id="20fcd-231">O Gerenciador de Recursos de Cluster permite que os serviços com monitoração de estado especifiquem uma carga padrão diferente para cargas Primárias e Secundárias.</span><span class="sxs-lookup"><span data-stu-id="20fcd-231">The Cluster Resource Manager allows stateful services to specify a different default load for their Primaries and Secondaries.</span></span> <span data-ttu-id="20fcd-232">Serviços sem estado só podem especificar um valor que se aplica a todas as instâncias.</span><span class="sxs-lookup"><span data-stu-id="20fcd-232">Stateless services can only specify one value that applies to all instances.</span></span> <span data-ttu-id="20fcd-233">Para serviços com monitoração de estado, a carga padrão para réplicas Primárias e Secundárias normalmente é diferente, pois as réplicas realizam diferentes tipos de trabalho em cada função.</span><span class="sxs-lookup"><span data-stu-id="20fcd-233">For stateful services, the default load for Primary and Secondary replicas are typically different since replicas do different kinds of work in each role.</span></span> <span data-ttu-id="20fcd-234">Por exemplo, as Primárias normalmente lidam com leituras e gravações, e a maior parte da carga computacional, enquanto as secundárias não o fazem.</span><span class="sxs-lookup"><span data-stu-id="20fcd-234">For example, Primaries usually serve both reads and writes, and handle most of the computational burden, while secondaries do not.</span></span> <span data-ttu-id="20fcd-235">Normalmente, a carga padrão para uma réplica primária é maior que a carga padrão para réplicas secundárias.</span><span class="sxs-lookup"><span data-stu-id="20fcd-235">Usually the default load for a primary replica is higher than the default load for secondary replicas.</span></span> <span data-ttu-id="20fcd-236">Os números reais dependem de suas próprias medidas.</span><span class="sxs-lookup"><span data-stu-id="20fcd-236">The real numbers should depend on your own measurements.</span></span>

## <a name="dynamic-load"></a><span data-ttu-id="20fcd-237">Carga dinâmica</span><span class="sxs-lookup"><span data-stu-id="20fcd-237">Dynamic load</span></span>
<span data-ttu-id="20fcd-238">Digamos que você esteja executando o serviço há algum tempo.</span><span class="sxs-lookup"><span data-stu-id="20fcd-238">Let’s say that you’ve been running your service for a while.</span></span> <span data-ttu-id="20fcd-239">Com o monitoramento, você observou que:</span><span class="sxs-lookup"><span data-stu-id="20fcd-239">With some monitoring, you’ve noticed that:</span></span>

1. <span data-ttu-id="20fcd-240">Algumas partições ou instâncias de determinado serviço consomem mais recursos do que outras</span><span class="sxs-lookup"><span data-stu-id="20fcd-240">Some partitions or instances of a given service consume more resources than others</span></span>
2. <span data-ttu-id="20fcd-241">Alguns serviços têm carga que varia ao longo do tempo.</span><span class="sxs-lookup"><span data-stu-id="20fcd-241">Some services have load that varies over time.</span></span>

<span data-ttu-id="20fcd-242">Há muitos itens que podem causar esses tipos de flutuações de carga.</span><span class="sxs-lookup"><span data-stu-id="20fcd-242">There's lots of things that could cause these types of load fluctuations.</span></span> <span data-ttu-id="20fcd-243">Por exemplo, serviços ou partições diferentes estão associadas com diferentes clientes com diferentes requisitos.</span><span class="sxs-lookup"><span data-stu-id="20fcd-243">For example, different services or partitions are associated with different customers with different requirements.</span></span> <span data-ttu-id="20fcd-244">A carga também pode alterar porque a quantidade de trabalho do serviço varia ao longo do dia.</span><span class="sxs-lookup"><span data-stu-id="20fcd-244">Load could also change because the amount of work the service does varies over the course of the day.</span></span> <span data-ttu-id="20fcd-245">Independentemente do motivo, há um número único que você pode usar para a carga padrão.</span><span class="sxs-lookup"><span data-stu-id="20fcd-245">Regardless of the reason, there’s usually no single number that you can use for default.</span></span> <span data-ttu-id="20fcd-246">Isso é especialmente verdadeiro se você deseja utilizar ao máximo o cluster.</span><span class="sxs-lookup"><span data-stu-id="20fcd-246">This is especially true if you want to get the most utilization out of the cluster.</span></span> <span data-ttu-id="20fcd-247">Qualquer valor que você escolher para a carga padrão estará errado durante parte do tempo.</span><span class="sxs-lookup"><span data-stu-id="20fcd-247">Any value you pick for default load is wrong some of the time.</span></span> <span data-ttu-id="20fcd-248">Cargas padrão incorretas fazem com que o Gerenciador de Recursos de Cluster aloque recursos a mais ou a menos.</span><span class="sxs-lookup"><span data-stu-id="20fcd-248">Incorrect default loads result in the Cluster Resource Manager either over or under allocating resources.</span></span> <span data-ttu-id="20fcd-249">Como resultado, você tem nós com utilização acima ou abaixo do esperado, mesmo que o Gerenciador de Recursos de Cluster pense que o cluster está equilibrado.</span><span class="sxs-lookup"><span data-stu-id="20fcd-249">As a result, you have nodes that are over or under utilized even though the Cluster Resource Manager thinks the cluster is balanced.</span></span> <span data-ttu-id="20fcd-250">As cargas padrão ainda são válidas, pois fornecem algumas informações para o posicionamento inicial, mas não dão a visão completa das cargas de trabalho reais.</span><span class="sxs-lookup"><span data-stu-id="20fcd-250">Default loads are still good since they provide some information for initial placement, but they're not a complete story for real workloads.</span></span> <span data-ttu-id="20fcd-251">Para capturar com precisão a alteração dos requisitos do recurso o Gerenciador de Recursos de Cluster permite que cada objeto de serviço atualize sua própria carga em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="20fcd-251">To accurately capture changing resource requirements, the Cluster Resource Manager allows each service object to update its own load during runtime.</span></span> <span data-ttu-id="20fcd-252">Isso é chamado de relatório dinâmico de carga.</span><span class="sxs-lookup"><span data-stu-id="20fcd-252">This is called dynamic load reporting.</span></span>

<span data-ttu-id="20fcd-253">Relatórios de carga dinâmicos permitem que réplicas ou instâncias ajustem sua carga de métricas de alocação/relatadas durante o ciclo de vida.</span><span class="sxs-lookup"><span data-stu-id="20fcd-253">Dynamic load reports allow replicas or instances to adjust their allocation/reported load of metrics over their lifetime.</span></span> <span data-ttu-id="20fcd-254">Uma réplica de serviço ou uma instância inoperante e que não realizasse trabalho normalmente informaria que estava usando valores baixos de determinada métrica.</span><span class="sxs-lookup"><span data-stu-id="20fcd-254">A service replica or instance that was cold and not doing any work would usually report that it was using low amounts of a given metric.</span></span> <span data-ttu-id="20fcd-255">Uma réplica ou instância ocupada relataria que está usando mais.</span><span class="sxs-lookup"><span data-stu-id="20fcd-255">A busy replica or instance would report that they are using more.</span></span>

<span data-ttu-id="20fcd-256">Os relatórios por réplica ou instância permitem que o Gerenciador de Recursos de Cluster reorganize os objetos de serviço individuais no cluster.</span><span class="sxs-lookup"><span data-stu-id="20fcd-256">Reporting load per replica or instance allows the Cluster Resource Manager to reorganize the individual service objects in the cluster.</span></span> <span data-ttu-id="20fcd-257">Reorganizar os serviços ajuda a garantir que eles obtenham os recursos que exigem.</span><span class="sxs-lookup"><span data-stu-id="20fcd-257">Reorganizing the services helps ensure that they get the resources they require.</span></span> <span data-ttu-id="20fcd-258">Serviços ocupados efetivamente podem "recuperar" recursos de outras réplicas ou instâncias que estão atualmente inoperantes ou executando menos trabalho.</span><span class="sxs-lookup"><span data-stu-id="20fcd-258">Busy services effectively get to "reclaim" resources from other replicas or instances that are currently cold or doing less work.</span></span>

<span data-ttu-id="20fcd-259">No Reliable Services, o código para relatar a carga dinamicamente teria esta aparência:</span><span class="sxs-lookup"><span data-stu-id="20fcd-259">Within Reliable Services, the code to report load dynamically looks like this:</span></span>

<span data-ttu-id="20fcd-260">Código:</span><span class="sxs-lookup"><span data-stu-id="20fcd-260">Code:</span></span>

```csharp
this.Partition.ReportLoad(new List<LoadMetric> { new LoadMetric("CurrentConnectionCount", 1234), new LoadMetric("metric1", 42) });
```

<span data-ttu-id="20fcd-261">Um serviço pode relatar qualquer uma das métricas definidas para ela no momento da criação.</span><span class="sxs-lookup"><span data-stu-id="20fcd-261">A service can report on any of the metrics defined for it at creation time.</span></span> <span data-ttu-id="20fcd-262">Se um serviço relatar uma carga para uma métrica que ele não está configurado para usar, o Service Fabric ignora esse relatório.</span><span class="sxs-lookup"><span data-stu-id="20fcd-262">If a service reports load for a metric that it is not configured to use, Service Fabric ignores that report.</span></span> <span data-ttu-id="20fcd-263">Se houver outras métricas relatadas ao mesmo tempo que sejam válidas, esses relatórios serão aceitos.</span><span class="sxs-lookup"><span data-stu-id="20fcd-263">If there are other metrics reported at the same time that are valid, those reports are accepted.</span></span> <span data-ttu-id="20fcd-264">O código do serviço pode medir e relatar todas as métricas que ele sabe relatar, e os operadores podem especificar a configuração de métrica para uso sem ter que alterar o código do serviço.</span><span class="sxs-lookup"><span data-stu-id="20fcd-264">Service code can measure and report all the metrics it knows how to, and operators can specify the metric configuration to use without having to change the service code.</span></span> 

### <a name="updating-a-services-metric-configuration"></a><span data-ttu-id="20fcd-265">Atualizando a configuração da métrica do serviço</span><span class="sxs-lookup"><span data-stu-id="20fcd-265">Updating a service's metric configuration</span></span>
<span data-ttu-id="20fcd-266">A lista de métricas associadas ao serviço e as propriedades dessas métricas podem ser atualizadas dinamicamente enquanto o serviço está ativo.</span><span class="sxs-lookup"><span data-stu-id="20fcd-266">The list of metrics associated with the service, and the properties of those metrics can be updated dynamically while the service is live.</span></span> <span data-ttu-id="20fcd-267">Isso permite flexibilidade e a oportunidade de fazer experimentos.</span><span class="sxs-lookup"><span data-stu-id="20fcd-267">This allows for experimentation and flexibility.</span></span> <span data-ttu-id="20fcd-268">Alguns exemplos de quando isso é útil são:</span><span class="sxs-lookup"><span data-stu-id="20fcd-268">Some examples of when this is useful are:</span></span>

  - <span data-ttu-id="20fcd-269">ao desabilitar uma métrica com um relatório com bugs para um serviço específico</span><span class="sxs-lookup"><span data-stu-id="20fcd-269">disabling a metric with a buggy report for a particular service</span></span>
  - <span data-ttu-id="20fcd-270">ao reconfigurar os pesos de métricas com base no comportamento desejado</span><span class="sxs-lookup"><span data-stu-id="20fcd-270">reconfiguring the weights of metrics based on desired behavior</span></span>
  - <span data-ttu-id="20fcd-271">ao habilitar uma métrica nova somente depois que o código já foi implantado e validado por meio de outros mecanismos</span><span class="sxs-lookup"><span data-stu-id="20fcd-271">enabling a new metric only after the code has already been deployed and validated via other mechanisms</span></span>
  - <span data-ttu-id="20fcd-272">ao alterar a carga padrão para um serviço com base no consumo e comportamento observado</span><span class="sxs-lookup"><span data-stu-id="20fcd-272">changing the default load for a service based on observed behavior and consumption</span></span>

<span data-ttu-id="20fcd-273">As principais APIs para alterar a configuração de métrica são `FabricClient.ServiceManagementClient.UpdateServiceAsync` em C# e `Update-ServiceFabricService` no PowerShell.</span><span class="sxs-lookup"><span data-stu-id="20fcd-273">The main APIs for changing metric configuration are `FabricClient.ServiceManagementClient.UpdateServiceAsync` in C# and `Update-ServiceFabricService` in PowerShell.</span></span> <span data-ttu-id="20fcd-274">Quaisquer informações que você especificar com essas APIs substituem as informações existentes de métrica para o serviço imediatamente.</span><span class="sxs-lookup"><span data-stu-id="20fcd-274">Whatever information you specify with these APIs replaces the existing metric information for the service immediately.</span></span> 

## <a name="mixing-default-load-values-and-dynamic-load-reports"></a><span data-ttu-id="20fcd-275">Combinando valores de carga padrão e relatórios de carga dinâmica</span><span class="sxs-lookup"><span data-stu-id="20fcd-275">Mixing default load values and dynamic load reports</span></span>
<span data-ttu-id="20fcd-276">Carga padrão e cargas dinâmicas podem ser usadas para o mesmo serviço.</span><span class="sxs-lookup"><span data-stu-id="20fcd-276">Default load and dynamic loads can be used for the same service.</span></span> <span data-ttu-id="20fcd-277">Quando o serviço utiliza os relatórios de carga padrão e carga dinâmica carga padrão serve como uma estimativa até os relatórios dinâmicos serem gerados.</span><span class="sxs-lookup"><span data-stu-id="20fcd-277">When a service utilizes both default load and dynamic load reports, default load serves as an estimate until dynamic reports show up.</span></span> <span data-ttu-id="20fcd-278">A carga padrão é boa porque fornece ao Gerenciador de Recursos de Cluster algo com o qual trabalhar.</span><span class="sxs-lookup"><span data-stu-id="20fcd-278">Default load is good because it gives the Cluster Resource Manager something to work with.</span></span> <span data-ttu-id="20fcd-279">A carga padrão permite que o Gerenciador de Recursos de Cluster coloque os objetos de serviço em locais adequados quando eles são criados.</span><span class="sxs-lookup"><span data-stu-id="20fcd-279">The default load allows the Cluster Resource Manager to place the service objects in good locations when they are created.</span></span> <span data-ttu-id="20fcd-280">Se nenhuma informação de carga padrão for fornecida, o posicionamento dos serviços será efetivamente aleatório.</span><span class="sxs-lookup"><span data-stu-id="20fcd-280">If no default load information is provided, placement of services is effectively random.</span></span> <span data-ttu-id="20fcd-281">Quando os relatórios de carga chegam mais tarde o posicionamento aleatório inicial geralmente é incorreto e o Gerenciador de Recursos de Cluster precisará mover serviços.</span><span class="sxs-lookup"><span data-stu-id="20fcd-281">When load reports arrive later the initial random placement is often wrong and the Cluster Resource Manager has to move services.</span></span>

<span data-ttu-id="20fcd-282">Vamos conferir nosso exemplo anterior e ver o que acontece quando adicionamos algumas métricas personalizadas e relatórios dinâmicos de carga.</span><span class="sxs-lookup"><span data-stu-id="20fcd-282">Let’s take our previous example and see what happens when we add some custom metrics and dynamic load reporting.</span></span> <span data-ttu-id="20fcd-283">Neste exemplo, usamos "MemoryInMb" como uma métrica de exemplo.</span><span class="sxs-lookup"><span data-stu-id="20fcd-283">In this example, we use “MemoryInMb” as an example metric.</span></span>

> [!NOTE]
> <span data-ttu-id="20fcd-284">Memória é uma das métricas de sistema a qual o Service Fabric pode [controlar os recursos](service-fabric-resource-governance.md), e relatá-las você mesmo normalmente é difícil.</span><span class="sxs-lookup"><span data-stu-id="20fcd-284">Memory is one of the system metrics that Service Fabric can [resource govern](service-fabric-resource-governance.md), and reporting it yourself is typically difficult.</span></span> <span data-ttu-id="20fcd-285">Não esperamos que você gere relatórios de consumo de Memória; a Memória é usada como um auxílio para saber mais sobre os recursos do Gerenciador de Recursos de Cluster.</span><span class="sxs-lookup"><span data-stu-id="20fcd-285">We don't actually expect you to report on Memory consumption; Memory is used here as an aid to learning about the capabilities of the Cluster Resource Manager.</span></span>
>

<span data-ttu-id="20fcd-286">Vamos pressupor que tenhamos criado inicialmente o serviço com estado com o seguinte comando:</span><span class="sxs-lookup"><span data-stu-id="20fcd-286">Let’s presume that we initially created the stateful service with the following command:</span></span>

<span data-ttu-id="20fcd-287">Powershell:</span><span class="sxs-lookup"><span data-stu-id="20fcd-287">Powershell:</span></span>

```posh
New-ServiceFabricService -ApplicationName $applicationName -ServiceName $serviceName -ServiceTypeName $serviceTypeName –Stateful -MinReplicaSetSize 3 -TargetReplicaSetSize 3 -PartitionSchemeSingleton –Metric @("MemoryInMb,High,21,11”,"PrimaryCount,Medium,1,0”,"ReplicaCount,Low,1,1”,"Count,Low,1,1”)
```

<span data-ttu-id="20fcd-288">Como lembrete, essa sintaxe é ("MetricName, MetricWeight, PrimaryDefaultLoad, SecondaryDefaultLoad").</span><span class="sxs-lookup"><span data-stu-id="20fcd-288">As a reminder, this syntax is ("MetricName, MetricWeight, PrimaryDefaultLoad, SecondaryDefaultLoad").</span></span>

<span data-ttu-id="20fcd-289">Vamos ver qual poderia ser a aparência de um layout de cluster:</span><span class="sxs-lookup"><span data-stu-id="20fcd-289">Let's see what one possible cluster layout could look like:</span></span>

<span data-ttu-id="20fcd-290"><center>
![Cluster equilibrado com métricas padrão e personalizadas][Image2]
</center></span><span class="sxs-lookup"><span data-stu-id="20fcd-290"><center>
![Cluster Balanced with both Default and Custom metrics][Image2]
</center></span></span>

<span data-ttu-id="20fcd-291">Algumas coisas que vale a pena observar:</span><span class="sxs-lookup"><span data-stu-id="20fcd-291">Some things that are worth noting:</span></span>

* <span data-ttu-id="20fcd-292">As réplicas secundárias dentro de uma partição podem ter cada uma a sua própria carga</span><span class="sxs-lookup"><span data-stu-id="20fcd-292">Secondary replicas within a partition can each have their own load</span></span>
* <span data-ttu-id="20fcd-293">Em geral, as métricas parecem equilibradas.</span><span class="sxs-lookup"><span data-stu-id="20fcd-293">Overall the metrics look balanced.</span></span> <span data-ttu-id="20fcd-294">Para a Memória, a proporção entre a carga máxima e a mínima é de 1,75 (o nó com o máximo de carga é N3, o que tem o mínimo é N2 e 28/16 = 1,75).</span><span class="sxs-lookup"><span data-stu-id="20fcd-294">For Memory, the ratio between the maximum and minimum load is 1.75 (the node with the most load is N3, the least is N2, and 28/16 = 1.75).</span></span>

<span data-ttu-id="20fcd-295">Há alguns itens que precisamos explicar:</span><span class="sxs-lookup"><span data-stu-id="20fcd-295">There are some things that we still need to explain:</span></span>

* <span data-ttu-id="20fcd-296">O que determinou se uma taxa de 1,75 é razoável ou não?</span><span class="sxs-lookup"><span data-stu-id="20fcd-296">What determined whether a ratio of 1.75 was reasonable or not?</span></span> <span data-ttu-id="20fcd-297">Como o Gerenciador de Recursos de Cluster sabe se isso é bom o suficiente ou se há mais trabalho a fazer?</span><span class="sxs-lookup"><span data-stu-id="20fcd-297">How does the Cluster Resource Manager know if that’s good enough or if there is more work to do?</span></span>
* <span data-ttu-id="20fcd-298">Quando o balanceamento acontece?</span><span class="sxs-lookup"><span data-stu-id="20fcd-298">When does balancing happen?</span></span>
* <span data-ttu-id="20fcd-299">O que significa que a memória foi ponderada como "Alta"?</span><span class="sxs-lookup"><span data-stu-id="20fcd-299">What does it mean that Memory was weighted “High”?</span></span>

## <a name="metric-weights"></a><span data-ttu-id="20fcd-300">Pesos de métrica</span><span class="sxs-lookup"><span data-stu-id="20fcd-300">Metric weights</span></span>
<span data-ttu-id="20fcd-301">Controlar as mesmas métricas em serviços diferentes é importante.</span><span class="sxs-lookup"><span data-stu-id="20fcd-301">Tracking the same metrics across different services is important.</span></span> <span data-ttu-id="20fcd-302">Essa exibição global é o que permite que o Gerenciador de Recursos de Cluster rastreie o consumo do cluster, equilibre o consumo entre os nós e garanta que os nós não ultrapassem a capacidade.</span><span class="sxs-lookup"><span data-stu-id="20fcd-302">That global view is what allows the Cluster Resource Manager to track consumption in the cluster, balance consumption across nodes, and ensure that nodes don’t go over capacity.</span></span> <span data-ttu-id="20fcd-303">No entanto, os serviços podem ter diferentes opiniões sobre a importância da mesma métrica.</span><span class="sxs-lookup"><span data-stu-id="20fcd-303">However, services may have different views as to the importance of the same metric.</span></span> <span data-ttu-id="20fcd-304">Além disso, em um cluster com várias métricas e muitos serviços, talvez não existam soluções perfeitamente equilibradas para todas as métricas.</span><span class="sxs-lookup"><span data-stu-id="20fcd-304">Also, in a cluster with many metrics and lots of services, perfectly balanced solutions may not exist for all metrics.</span></span> <span data-ttu-id="20fcd-305">Como o Gerenciador de Recursos de Cluster deve lidar com essas situações?</span><span class="sxs-lookup"><span data-stu-id="20fcd-305">How should the Cluster Resource Manager handle these situations?</span></span>

<span data-ttu-id="20fcd-306">Os pesos das métricas permitem que o Gerenciador de Recursos de Cluster decida como equilibrar o cluster quando não houver uma resposta perfeita.</span><span class="sxs-lookup"><span data-stu-id="20fcd-306">Metric weights allow the Cluster Resource Manager to decide how to balance the cluster when there’s no perfect answer.</span></span> <span data-ttu-id="20fcd-307">Os pesos das métricas também permitem que o Gerenciador de Recursos de Cluster equilibre serviços específicos de maneira diferente.</span><span class="sxs-lookup"><span data-stu-id="20fcd-307">Metric weights also allow the Cluster Resource Manager to balance specific services differently.</span></span> <span data-ttu-id="20fcd-308">As métricas podem ter quatro níveis de peso diferente: zero, baixa, média e alta.</span><span class="sxs-lookup"><span data-stu-id="20fcd-308">Metrics can have four different weight levels: Zero, Low, Medium, and High.</span></span> <span data-ttu-id="20fcd-309">Uma métrica com um peso Zero não contribui em nada ao considerar se as coisas estão balanceadas ou não.</span><span class="sxs-lookup"><span data-stu-id="20fcd-309">A metric with a weight of Zero contributes nothing when considering whether things are balanced or not.</span></span> <span data-ttu-id="20fcd-310">No entanto, sua carga ainda contribui para o gerenciamento da capacidade.</span><span class="sxs-lookup"><span data-stu-id="20fcd-310">However, its load does still contribute to capacity management.</span></span> <span data-ttu-id="20fcd-311">Métricas com peso Zero ainda são úteis e costumam ser usadas como parte do monitoramento de desempenho e do comportamento de serviço.</span><span class="sxs-lookup"><span data-stu-id="20fcd-311">Metrics with Zero weight are still useful and are frequently used as a part of service behavior and performance monitoring.</span></span> <span data-ttu-id="20fcd-312">[Este artigo](service-fabric-diagnostics-event-generation-infra.md) fornece mais informações sobre o uso de métricas para monitoramento e diagnóstico dos seus serviços.</span><span class="sxs-lookup"><span data-stu-id="20fcd-312">[This article](service-fabric-diagnostics-event-generation-infra.md) provides more information on the use of metrics for monitoring and diagnostics of your services.</span></span> 

<span data-ttu-id="20fcd-313">O impacto real de pesos de métricas diferentes no cluster é que o Gerenciador de Recursos de Cluster gera diferentes soluções.</span><span class="sxs-lookup"><span data-stu-id="20fcd-313">The real impact of different metric weights in the cluster is that the Cluster Resource Manager generates different solutions.</span></span> <span data-ttu-id="20fcd-314">Os pesos das métricas informam ao Gerenciador de Recursos de Cluster que determinadas métricas são mais importantes do que outras.</span><span class="sxs-lookup"><span data-stu-id="20fcd-314">Metric weights tell the Cluster Resource Manager that certain metrics are more important than others.</span></span> <span data-ttu-id="20fcd-315">Quando não há uma solução perfeita, o Gerenciador de Recursos de Cluster pode preferir soluções que equilibrem melhor as métricas ponderadas mais elevadas.</span><span class="sxs-lookup"><span data-stu-id="20fcd-315">When there's no perfect solution the Cluster Resource Manager can prefer solutions which balance the higher weighted metrics better.</span></span> <span data-ttu-id="20fcd-316">Se um serviço achar que uma métrica específica não é importante, ele poderá considerar seu uso dessa métrica desequilibrado.</span><span class="sxs-lookup"><span data-stu-id="20fcd-316">If a service thinks a particular metric is unimportant, it may find their use of that metric imbalanced.</span></span> <span data-ttu-id="20fcd-317">Isso permite que outro serviço obtenha uma distribuição uniforme de alguma métrica que seja importante para ele.</span><span class="sxs-lookup"><span data-stu-id="20fcd-317">This allows another service to get an even distribution of some metric that is important to it.</span></span>

<span data-ttu-id="20fcd-318">Vamos conferir um exemplo de alguns relatórios de carga para ver como os pesos de métrica diferentes resultam em alocações diferentes no cluster.</span><span class="sxs-lookup"><span data-stu-id="20fcd-318">Let’s look at an example of some load reports and how different metric weights results in different allocations in the cluster.</span></span> <span data-ttu-id="20fcd-319">Neste exemplo, podemos ver que alternar o peso relativo das métricas faz com que o Gerenciador de Recursos de Cluster crie diferentes disposições de serviços.</span><span class="sxs-lookup"><span data-stu-id="20fcd-319">In this example, we see that switching the relative weight of the metrics causes the Cluster Resource Manager to create different arrangements of services.</span></span>

<span data-ttu-id="20fcd-320"><center>
![Exemplo de ponderação da métrica e seu impacto sobre as soluções de balanceamento][Image3]
</center></span><span class="sxs-lookup"><span data-stu-id="20fcd-320"><center>
![Metric Weight Example and Its Impact on Balancing Solutions][Image3]
</center></span></span>

<span data-ttu-id="20fcd-321">Neste exemplo, há quatro serviços diferentes, todos relatando diferentes valores para duas métricas diferentes, Métrica A e Métrica B.</span><span class="sxs-lookup"><span data-stu-id="20fcd-321">In this example, there are four different services, all reporting different values for two different metrics, MetricA and MetricB.</span></span> <span data-ttu-id="20fcd-322">Em um caso, todos os serviços definem a Métrica A como a mais importante (Peso = Alto) e a Métrica B como não importante (Peso = Baixo).</span><span class="sxs-lookup"><span data-stu-id="20fcd-322">In one case, all the services define MetricA is the most important one (Weight = High) and MetricB as unimportant (Weight = Low).</span></span> <span data-ttu-id="20fcd-323">Nesse caso, vemos que o Gerenciador de Recursos de Cluster dispõe os serviços para que a Métrica A seja mais equilibrada que a Métrica B.</span><span class="sxs-lookup"><span data-stu-id="20fcd-323">As a result, we see that the Cluster Resource Manager places the services so that MetricA is better balanced than MetricB.</span></span> <span data-ttu-id="20fcd-324">"Melhor equilibrada" significa que a Métrica A tem um desvio padrão menor que a Métrica B.</span><span class="sxs-lookup"><span data-stu-id="20fcd-324">"Better balanced" means that MetricA has a lower has a lower standard deviation than MetricB.</span></span> <span data-ttu-id="20fcd-325">No segundo caso, invertemos os pesos de métrica.</span><span class="sxs-lookup"><span data-stu-id="20fcd-325">In the second case, we reverse the metric weights.</span></span> <span data-ttu-id="20fcd-326">Como resultado, o Gerenciador de Recursos de Cluster troca os serviços A e B para propor uma alocação em que a Métrica B seja mais equilibrada do que a Métrica A.</span><span class="sxs-lookup"><span data-stu-id="20fcd-326">As a result, the Cluster Resource Manager swaps services A and B to come up with an allocation where MetricB is better balanced than MetricA.</span></span>

> [!NOTE]
> <span data-ttu-id="20fcd-327">Os pesos das métricas determinam como o Gerenciador de recursos de Cluster deve fazer o balanceamento, mas não quando este balanceamento deve ocorrer.</span><span class="sxs-lookup"><span data-stu-id="20fcd-327">Metric weights determine how the Cluster Resource Manager should balance, but not when balancing should happen.</span></span> <span data-ttu-id="20fcd-328">Para saber mais sobre balanceamento, leia [este artigo](service-fabric-cluster-resource-manager-balancing.md)</span><span class="sxs-lookup"><span data-stu-id="20fcd-328">For more information on balancing, check out [this article](service-fabric-cluster-resource-manager-balancing.md)</span></span>
>

### <a name="global-metric-weights"></a><span data-ttu-id="20fcd-329">Pesos de métrica global</span><span class="sxs-lookup"><span data-stu-id="20fcd-329">Global metric weights</span></span>
<span data-ttu-id="20fcd-330">Digamos que o Serviço A define a Métrica A com peso Alto e o Serviço B define o peso para a Métrica A como Baixo ou Zero.</span><span class="sxs-lookup"><span data-stu-id="20fcd-330">Let's say ServiceA defines MetricA as weight High, and ServiceB sets the weight for MetricA to Low or Zero.</span></span> <span data-ttu-id="20fcd-331">O que é o peso real que acaba sendo usado?</span><span class="sxs-lookup"><span data-stu-id="20fcd-331">What’s the actual weight that ends up getting used?</span></span>

<span data-ttu-id="20fcd-332">Há vários pesos que são rastreados para cada métrica.</span><span class="sxs-lookup"><span data-stu-id="20fcd-332">There are multiple weights that are tracked for every metric.</span></span> <span data-ttu-id="20fcd-333">O primeiro peso é definido para a métrica quando o serviço é criado.</span><span class="sxs-lookup"><span data-stu-id="20fcd-333">The first weight is the one defined for the metric when the service is created.</span></span> <span data-ttu-id="20fcd-334">O outro peso é um peso global, que é calculado automaticamente.</span><span class="sxs-lookup"><span data-stu-id="20fcd-334">The other weight is a global weight, which is computed automatically.</span></span> <span data-ttu-id="20fcd-335">O Gerenciador de Recursos de Cluster usa ambos os pesos para a pontuação de soluções.</span><span class="sxs-lookup"><span data-stu-id="20fcd-335">The Cluster Resource Manager uses both these weights when scoring solutions.</span></span> <span data-ttu-id="20fcd-336">Considerar ambos os pesos é importante.</span><span class="sxs-lookup"><span data-stu-id="20fcd-336">Taking both weights into account is important.</span></span> <span data-ttu-id="20fcd-337">Isso permite que o Gerenciador de Recursos de Cluster possa equilibrar cada serviço de acordo com suas próprias prioridades e também garante que o cluster como um todo seja alocado corretamente.</span><span class="sxs-lookup"><span data-stu-id="20fcd-337">This allows the Cluster Resource Manager to balance each service according to its own priorities, and also ensure that the cluster as a whole is allocated correctly.</span></span>

<span data-ttu-id="20fcd-338">O que aconteceria se o Gerenciador de Recursos de Cluster não se importasse com o balanceamento global e local?</span><span class="sxs-lookup"><span data-stu-id="20fcd-338">What would happen if the Cluster Resource Manager didn’t care about both global and local balance?</span></span> <span data-ttu-id="20fcd-339">Bem, é fácil criar soluções que são balanceadas globalmente, mas que resultam em um balanceamento de recursos inadequado para serviços individuais.</span><span class="sxs-lookup"><span data-stu-id="20fcd-339">Well, it’s easy to construct solutions that are globally balanced, but which result in poor resource balance for individual services.</span></span> <span data-ttu-id="20fcd-340">No exemplo a seguir, vamos examinar um serviço configurado somente com as métricas padrão e ver o que acontece quando apenas o balanceamento global é considerado:</span><span class="sxs-lookup"><span data-stu-id="20fcd-340">In the following example, let’s look at a service configured with just the default metrics, and see what happens when only global balance is considered:</span></span>

<span data-ttu-id="20fcd-341"><center>
![O impacto de uma única solução global][Image4]
</center></span><span class="sxs-lookup"><span data-stu-id="20fcd-341"><center>
![The Impact of a Global Only Solution][Image4]
</center></span></span>

<span data-ttu-id="20fcd-342">No exemplo acima, baseado somente em balanceamento global, o cluster como um todo é realmente balanceado.</span><span class="sxs-lookup"><span data-stu-id="20fcd-342">In the top example based only on global balance, the cluster as a whole is indeed balanced.</span></span> <span data-ttu-id="20fcd-343">Todos os nós têm a mesma contagem de primárias e o mesmo número total de réplicas.</span><span class="sxs-lookup"><span data-stu-id="20fcd-343">All nodes have the same count of primaries and the same number total replicas.</span></span> <span data-ttu-id="20fcd-344">Entretanto, se você examinar o impacto real dessa alocação, isso não é tão bom: a perda de qualquer nó afeta uma determinada carga de trabalho desproporcionalmente, já que leva todos seus primários.</span><span class="sxs-lookup"><span data-stu-id="20fcd-344">However, if you look at the actual impact of this allocation it’s not so good: the loss of any node impacts a particular workload disproportionately, because it takes out all of its primaries.</span></span> <span data-ttu-id="20fcd-345">Por exemplo, se o primeiro nó falhasse, as três primárias para as três partições diferentes do serviço Círculo seriam todas perdidas.</span><span class="sxs-lookup"><span data-stu-id="20fcd-345">For example, if the first node fails the three primaries for the three different partitions of the Circle service would all be lost.</span></span> <span data-ttu-id="20fcd-346">Por outro lado, as partições dos serviços Triangle e Hexagon perdem uma réplica.</span><span class="sxs-lookup"><span data-stu-id="20fcd-346">Conversely, the Triangle and Hexagon services have their partitions lose a replica.</span></span> <span data-ttu-id="20fcd-347">Isso não causa uma interrupção, só é necessário recuperar a réplica que foi derrubada.</span><span class="sxs-lookup"><span data-stu-id="20fcd-347">This causes no disruption, other than having to recover the down replica.</span></span>

<span data-ttu-id="20fcd-348">No exemplo inferior, o Gerenciador de Recursos de Cluster distribuiu as réplicas com base no balanceamento global e por serviço.</span><span class="sxs-lookup"><span data-stu-id="20fcd-348">In the bottom example, the Cluster Resource Manager has distributed the replicas based on both the global and per-service balance.</span></span> <span data-ttu-id="20fcd-349">Ao calcular a pontuação da solução, ele fornece a maioria do peso para a solução global e uma parte (configurável) para serviços individuais.</span><span class="sxs-lookup"><span data-stu-id="20fcd-349">When calculating the score of the solution it gives most of the weight to the global solution, and a (configurable) portion to individual services.</span></span> <span data-ttu-id="20fcd-350">O balanceamento global é calculado com base na média dos pesos das métricas definidos para cada serviço.</span><span class="sxs-lookup"><span data-stu-id="20fcd-350">Global balance for a metric is calculated based on the average of the metric weights from each service.</span></span> <span data-ttu-id="20fcd-351">Cada serviço é balanceado de acordo com seus próprios pesos de métricas definidos.</span><span class="sxs-lookup"><span data-stu-id="20fcd-351">Each service is balanced according to its own defined metric weights.</span></span> <span data-ttu-id="20fcd-352">Isso garante que os serviços sejam balanceados em si mesmos de acordo com suas próprias necessidades.</span><span class="sxs-lookup"><span data-stu-id="20fcd-352">This ensures that the services are balanced within themselves according to their own needs.</span></span> <span data-ttu-id="20fcd-353">Como resultado, se o mesmo primeiro nó falhar, a falha é distribuída entre todas as partições de todos os serviços.</span><span class="sxs-lookup"><span data-stu-id="20fcd-353">As a result, if the same first node fails the failure is distributed across all partitions of all services.</span></span> <span data-ttu-id="20fcd-354">O impacto para cada um é igual.</span><span class="sxs-lookup"><span data-stu-id="20fcd-354">The impact to each is the same.</span></span>

## <a name="next-steps"></a><span data-ttu-id="20fcd-355">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="20fcd-355">Next steps</span></span>
- <span data-ttu-id="20fcd-356">Para obter mais informações sobre a configuração de serviços, [Saiba mais sobre como configurar serviços](service-fabric-cluster-resource-manager-configure-services.md)(service-fabric-cluster-resource-manager-configure-services.md)</span><span class="sxs-lookup"><span data-stu-id="20fcd-356">For more information on configuring services, [Learn about configuring Services](service-fabric-cluster-resource-manager-configure-services.md)(service-fabric-cluster-resource-manager-configure-services.md)</span></span>
- <span data-ttu-id="20fcd-357">Definir as Métricas de Desfragmentação é uma forma de consolidar a carga em nós, em vez de distribuí-la. Para saber como configurar a desfragmentação, leia [este artigo](service-fabric-cluster-resource-manager-defragmentation-metrics.md)</span><span class="sxs-lookup"><span data-stu-id="20fcd-357">Defining Defragmentation Metrics is one way to consolidate load on nodes instead of spreading it out. To learn how to configure defragmentation, refer to [this article](service-fabric-cluster-resource-manager-defragmentation-metrics.md)</span></span>
- <span data-ttu-id="20fcd-358">Para descobrir como o Gerenciador de Recursos de Cluster gerencia e balanceia carga no cluster, confira o artigo sobre [como balancear carga](service-fabric-cluster-resource-manager-balancing.md)</span><span class="sxs-lookup"><span data-stu-id="20fcd-358">To find out about how the Cluster Resource Manager manages and balances load in the cluster, check out the article on [balancing load](service-fabric-cluster-resource-manager-balancing.md)</span></span>
- <span data-ttu-id="20fcd-359">Comece do princípio e [veja uma introdução ao Resource Manager de Cluster do Service Fabric](service-fabric-cluster-resource-manager-introduction.md)</span><span class="sxs-lookup"><span data-stu-id="20fcd-359">Start from the beginning and [get an Introduction to the Service Fabric Cluster Resource Manager](service-fabric-cluster-resource-manager-introduction.md)</span></span>
- <span data-ttu-id="20fcd-360">O Custo de Movimento é uma forma de sinalizar para o Gerenciador de Recursos de Cluster que a movimentação de determinados serviços é mais cara do que para outros.</span><span class="sxs-lookup"><span data-stu-id="20fcd-360">Movement Cost is one way of signaling to the Cluster Resource Manager that certain services are more expensive to move than others.</span></span> <span data-ttu-id="20fcd-361">Para saber mais sobre o custo de movimento, consulte [este artigo](service-fabric-cluster-resource-manager-movement-cost.md)</span><span class="sxs-lookup"><span data-stu-id="20fcd-361">To learn more about movement cost, refer to [this article](service-fabric-cluster-resource-manager-movement-cost.md)</span></span>

[Image1]:./media/service-fabric-cluster-resource-manager-metrics/cluster-resource-manager-cluster-layout-with-default-metrics.png
[Image2]:./media/service-fabric-cluster-resource-manager-metrics/Service-Fabric-Resource-Manager-Dynamic-Load-Reports.png
[Image3]:./media/service-fabric-cluster-resource-manager-metrics/cluster-resource-manager-metric-weights-impact.png
[Image4]:./media/service-fabric-cluster-resource-manager-metrics/cluster-resource-manager-global-vs-local-balancing.png
