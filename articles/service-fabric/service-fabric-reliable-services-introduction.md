---
title: "Visão geral do modelo de programação de Reliable Service do Service Fabric | Microsoft Docs"
description: "Saiba mais sobre o modelo de programação dos Serviços Confiáveis da Malha de Serviços e comece a desenvolver seus próprios serviços."
services: Service-Fabric
documentationcenter: .net
author: masnider
manager: timlt
editor: vturecek; mani-ramaswamy
ms.assetid: 0c88a533-73f8-4ae1-a939-67d17456ac06
ms.service: Service-Fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 8/9/2017
ms.author: masnider;
ms.openlocfilehash: 601b1c7713c9785d949c1c72000ec7f3f63dd682
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/18/2017
---
# <a name="reliable-services-overview"></a><span data-ttu-id="e9c04-103">Visão geral dos Reliable Services</span><span class="sxs-lookup"><span data-stu-id="e9c04-103">Reliable Services overview</span></span>
<span data-ttu-id="e9c04-104">O Azure Service Fabric simplifica o desenvolvimento e o gerenciamento de Reliable Services com e sem estado.</span><span class="sxs-lookup"><span data-stu-id="e9c04-104">Azure Service Fabric simplifies writing and managing stateless and stateful Reliable Services.</span></span> <span data-ttu-id="e9c04-105">Este tópico aborda:</span><span class="sxs-lookup"><span data-stu-id="e9c04-105">This topic covers:</span></span>

* <span data-ttu-id="e9c04-106">O modelo de programação do Reliable Services para serviços com e sem estado.</span><span class="sxs-lookup"><span data-stu-id="e9c04-106">The Reliable Services programming model for stateless and stateful services.</span></span>
* <span data-ttu-id="e9c04-107">As decisões que você precisa tomar ao desenvolver um Reliable Service.</span><span class="sxs-lookup"><span data-stu-id="e9c04-107">The choices you have to make when writing a Reliable Service.</span></span>
* <span data-ttu-id="e9c04-108">Alguns cenários e exemplos de quando você usaria Reliable Services e como eles são desenvolvidos.</span><span class="sxs-lookup"><span data-stu-id="e9c04-108">Some scenarios and examples of when to use Reliable Services and how they are written.</span></span>

<span data-ttu-id="e9c04-109">Os Serviços Confiáveis são um dos modelos de programação disponíveis na Malha de Serviços.</span><span class="sxs-lookup"><span data-stu-id="e9c04-109">Reliable Services is one of the programming models available on Service Fabric.</span></span> <span data-ttu-id="e9c04-110">O outro é o modelo de programação Reliable Actor, que fornece um modelo de programação Actor virtual sobre o modelo do Reliable Services.</span><span class="sxs-lookup"><span data-stu-id="e9c04-110">The other is the Reliable Actor programming model, which provides a virtual Actor programming model on top of the Reliable Services model.</span></span> <span data-ttu-id="e9c04-111">Para saber mais sobre o modelo de programação de Reliable Actors, confira [Introdução aos Reliable Actors do Service Fabric](service-fabric-reliable-actors-introduction.md).</span><span class="sxs-lookup"><span data-stu-id="e9c04-111">For more information on the Reliable Actors programming model, see [Introduction to Service Fabric Reliable Actors](service-fabric-reliable-actors-introduction.md).</span></span>

<span data-ttu-id="e9c04-112">O Service Fabric gerencia a vida útil dos serviços, desde o provisionamento e da implantação até a atualização e a exclusão, por meio do [gerenciamento de aplicativos do Service Fabric](service-fabric-deploy-remove-applications.md).</span><span class="sxs-lookup"><span data-stu-id="e9c04-112">Service Fabric manages the lifetime of services, from provisioning and deployment through upgrade and deletion, via [Service Fabric application management](service-fabric-deploy-remove-applications.md).</span></span>

## <a name="what-are-reliable-services"></a><span data-ttu-id="e9c04-113">O que são os Reliable Services?</span><span class="sxs-lookup"><span data-stu-id="e9c04-113">What are Reliable Services?</span></span>
<span data-ttu-id="e9c04-114">Os Reliable Services fornecem um modelo de programação simples, potente e de nível superior que ajuda você a demonstrar o que é importante para seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="e9c04-114">Reliable Services gives you a simple, powerful, top-level programming model to help you express what is important to your application.</span></span> <span data-ttu-id="e9c04-115">Com o modelo de programação dos Reliable Services, você obtém:</span><span class="sxs-lookup"><span data-stu-id="e9c04-115">With the Reliable Services programming model, you get:</span></span>

* <span data-ttu-id="e9c04-116">Acesso ao restante das APIs de programação do Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="e9c04-116">Access to the rest of the Service Fabric programming APIs.</span></span> <span data-ttu-id="e9c04-117">Ao contrário dos serviços do Service Fabric modelados como [Executáveis de Convidado](service-fabric-deploy-existing-app.md), os Reliable Services usam o restante das APIs do Service Fabric diretamente.</span><span class="sxs-lookup"><span data-stu-id="e9c04-117">Unlike Service Fabric Services modeled as [Guest Executables](service-fabric-deploy-existing-app.md), Reliable Services get to use the rest of the Service Fabric APIs directly.</span></span> <span data-ttu-id="e9c04-118">Isso permite que os serviços:</span><span class="sxs-lookup"><span data-stu-id="e9c04-118">This allows services to:</span></span>
  * <span data-ttu-id="e9c04-119">consultar o sistema</span><span class="sxs-lookup"><span data-stu-id="e9c04-119">query the system</span></span>
  * <span data-ttu-id="e9c04-120">relatar integridade de entidades no cluster</span><span class="sxs-lookup"><span data-stu-id="e9c04-120">report health about entities in the cluster</span></span>
  * <span data-ttu-id="e9c04-121">receber notificações sobre alterações de configuração e código</span><span class="sxs-lookup"><span data-stu-id="e9c04-121">receive notifications about configuration and code changes</span></span>
  * <span data-ttu-id="e9c04-122">localizar e comunicar-se com outros serviços,</span><span class="sxs-lookup"><span data-stu-id="e9c04-122">find and communicate with other services,</span></span>
  * <span data-ttu-id="e9c04-123">(opcionalmente) usar o [Reliable Collections](service-fabric-reliable-services-reliable-collections.md)</span><span class="sxs-lookup"><span data-stu-id="e9c04-123">(optionally) use the [Reliable Collections](service-fabric-reliable-services-reliable-collections.md)</span></span>
  * <span data-ttu-id="e9c04-124">…e concedendo-lhes acesso aos vários outros recursos, tudo de um modelo de programação de primeira classe em várias linguagens de programação.</span><span class="sxs-lookup"><span data-stu-id="e9c04-124">...and giving them access to many other capabilities, all from a first class programming model in several programming languages.</span></span>
* <span data-ttu-id="e9c04-125">Um modelo simples para execução de seu próprio código que parece com os modelos de programação com os quais você está acostumado.</span><span class="sxs-lookup"><span data-stu-id="e9c04-125">A simple model for running your own code that looks like programming models you are used to.</span></span> <span data-ttu-id="e9c04-126">Seu código tem um ponto de entrada bem definido e um ciclo de vida fácil de gerenciar.</span><span class="sxs-lookup"><span data-stu-id="e9c04-126">Your code has a well-defined entry point and easily managed lifecycle.</span></span>
* <span data-ttu-id="e9c04-127">Um modelo de comunicação conectável.</span><span class="sxs-lookup"><span data-stu-id="e9c04-127">A pluggable communication model.</span></span> <span data-ttu-id="e9c04-128">Use o transporte de sua escolha, como HTTP com a [API Web](service-fabric-reliable-services-communication-webapi.md), WebSockets, protocolos TCP personalizados ou qualquer outro.</span><span class="sxs-lookup"><span data-stu-id="e9c04-128">Use the transport of your choice, such as HTTP with [Web API](service-fabric-reliable-services-communication-webapi.md), WebSockets, custom TCP protocols, or anything else.</span></span> <span data-ttu-id="e9c04-129">O Reliable Services oferece excelentes opções de utilização ou permite que você forneça suas próprias.</span><span class="sxs-lookup"><span data-stu-id="e9c04-129">Reliable Services provide some great out-of-the-box options you can use, or you can provide your own.</span></span>
* <span data-ttu-id="e9c04-130">Para serviços com estado, o modelo de programação dos Reliable Services permite que você armazene de forma consistente e confiável o seu estado diretamente de seu serviço usando o [Reliable Collections](service-fabric-reliable-services-reliable-collections.md).</span><span class="sxs-lookup"><span data-stu-id="e9c04-130">For stateful services, the Reliable Services programming model allows you to consistently and reliably store your state right inside your service by using [Reliable Collections](service-fabric-reliable-services-reliable-collections.md).</span></span> <span data-ttu-id="e9c04-131">O Reliable Collections é um conjunto simples de classes de coleção confiável altamente disponíveis que serão familiares para todos aqueles que já usaram coleções C#.</span><span class="sxs-lookup"><span data-stu-id="e9c04-131">Reliable Collections are a simple set of highly available and reliable collection classes that will be familiar to anyone who has used C# collections.</span></span> <span data-ttu-id="e9c04-132">Tradicionalmente, os serviços precisavam de sistemas externos para um gerenciamento de estado confiável.</span><span class="sxs-lookup"><span data-stu-id="e9c04-132">Traditionally, services needed external systems for Reliable state management.</span></span> <span data-ttu-id="e9c04-133">Com os Reliable Collections, você pode armazenar o estado próximo à computação com a mesma alta disponibilidade e confiabilidade esperada de repositórios externos altamente disponíveis.</span><span class="sxs-lookup"><span data-stu-id="e9c04-133">With Reliable Collections, you can store your state next to your compute with the same high availability and reliability you've come to expect from highly available external stores.</span></span> <span data-ttu-id="e9c04-134">Esse modelo também melhora a latência, pois você está localizando a computação e o estado de funcionamento conjuntamente.</span><span class="sxs-lookup"><span data-stu-id="e9c04-134">This model also improves latency because you are co-locating the compute and state it needs to function.</span></span>

<span data-ttu-id="e9c04-135">Assista a este vídeo da Microsoft Virtual Academy para ter uma visão geral dos Reliable Services: <center>
<a target="_blank" href="https://mva.microsoft.com/en-US/training-courses/building-microservices-applications-on-azure-service-fabric-16747?l=HhD9566yC_4106218965">
<img src="./media/service-fabric-reliable-services-introduction/ReliableServicesVid.png" WIDTH="360" HEIGHT="244" />
</a>
</center></span><span class="sxs-lookup"><span data-stu-id="e9c04-135">Watch this Microsoft Virtual Academy video for an overview of Reliable services: <center>
<a target="_blank" href="https://mva.microsoft.com/en-US/training-courses/building-microservices-applications-on-azure-service-fabric-16747?l=HhD9566yC_4106218965">
<img src="./media/service-fabric-reliable-services-introduction/ReliableServicesVid.png" WIDTH="360" HEIGHT="244" />
</a>
</center></span></span>

## <a name="what-makes-reliable-services-different"></a><span data-ttu-id="e9c04-136">O que torna o Reliable Services diferente?</span><span class="sxs-lookup"><span data-stu-id="e9c04-136">What makes Reliable Services different?</span></span>
<span data-ttu-id="e9c04-137">Os Serviços Confiáveis na Malha de Serviços são diferentes dos serviços que você já desenvolveu anteriormente.</span><span class="sxs-lookup"><span data-stu-id="e9c04-137">Reliable Services in Service Fabric are different from services you may have written before.</span></span> <span data-ttu-id="e9c04-138">A Malha de Serviços fornece confiabilidade, disponibilidade, consistência e escalabilidade.</span><span class="sxs-lookup"><span data-stu-id="e9c04-138">Service Fabric provides reliability, availability, consistency, and scalability.</span></span>

* <span data-ttu-id="e9c04-139">**Confiabilidade** – Seu serviço permanece o mesmo em ambientes não confiáveis em que suas máquinas falham, apresentam problemas de rede ou em casos em que os próprios serviços encontram erros ou falham.</span><span class="sxs-lookup"><span data-stu-id="e9c04-139">**Reliability** - Your service stays up even in unreliable environments where your machines fail or hit network issues, or in cases where the services themselves encounter errors and crash or fail.</span></span> <span data-ttu-id="e9c04-140">Para serviços com estado, este é preservado mesmo na presença de falhas de rede ou outras falhas.</span><span class="sxs-lookup"><span data-stu-id="e9c04-140">For stateful services, your state is preserved even in the presence of network or other failures.</span></span>
* <span data-ttu-id="e9c04-141">**Disponibilidade** – Seu serviço estará acessível e responderá rapidamente.</span><span class="sxs-lookup"><span data-stu-id="e9c04-141">**Availability** - Your service is reachable and responsive.</span></span> <span data-ttu-id="e9c04-142">O Service Fabric mantém o número desejado de cópias de execução.</span><span class="sxs-lookup"><span data-stu-id="e9c04-142">Service Fabric maintains your desired number of running copies.</span></span>
* <span data-ttu-id="e9c04-143">**Escalabilidade** – Os serviços são separados do hardware específico e podem ser aumentados ou reduzidos conforme necessário por meio da adição ou da remoção de hardware ou outros recursos.</span><span class="sxs-lookup"><span data-stu-id="e9c04-143">**Scalability** - Services are decoupled from specific hardware, and they can grow or shrink as necessary through the addition or removal of hardware or other resources.</span></span> <span data-ttu-id="e9c04-144">Os serviços são particionados com facilidade (especialmente no caso dos serviços com estado) para garantir que ele possa escalar e responder a falhas parciais.</span><span class="sxs-lookup"><span data-stu-id="e9c04-144">Services are easily partitioned (especially in the stateful case) to ensure that the service can scale and handle partial failures.</span></span> <span data-ttu-id="e9c04-145">Os serviços podem ser criados e excluídos dinamicamente por meio de código, permitindo a criação de mais instâncias do que o necessário, como em resposta às solicitações do cliente, por exemplo.</span><span class="sxs-lookup"><span data-stu-id="e9c04-145">Services can be created and deleted dynamically via code, enabling more instances to be spun up as necessary, say in response to customer requests.</span></span> <span data-ttu-id="e9c04-146">Por fim, o Service Fabric incentiva os serviços a serem leves.</span><span class="sxs-lookup"><span data-stu-id="e9c04-146">Finally, Service Fabric encourages services to be lightweight.</span></span> <span data-ttu-id="e9c04-147">O Service Fabric permite que milhares de serviços sejam provisionados em um único processo, em vez de exigir ou dedicar instâncias ou processos inteiros do sistema operacional para uma única instância de um serviço.</span><span class="sxs-lookup"><span data-stu-id="e9c04-147">Service Fabric allows thousands of services to be provisioned within a single process, rather than requiring or dedicating entire OS instances or processes to a single instance of a service.</span></span>
* <span data-ttu-id="e9c04-148">**Consistência** – É possível garantir a consistência de todas as informações armazenadas nesse serviço.</span><span class="sxs-lookup"><span data-stu-id="e9c04-148">**Consistency** - Any information stored in this service can be guaranteed to be consistent.</span></span> <span data-ttu-id="e9c04-149">Isso é verdadeiro mesmo entre várias coleções confiáveis dentro de um serviço.</span><span class="sxs-lookup"><span data-stu-id="e9c04-149">This is true even across multiple reliable collections within a service.</span></span> <span data-ttu-id="e9c04-150">Alterações nas coleções dentro de um serviço podem ser feitas de forma transacional atômica.</span><span class="sxs-lookup"><span data-stu-id="e9c04-150">Changes across collections within a service can be made in a transactionally atomic manner.</span></span>

## <a name="service-lifecycle"></a><span data-ttu-id="e9c04-151">Ciclo de vida do serviço</span><span class="sxs-lookup"><span data-stu-id="e9c04-151">Service lifecycle</span></span>
<span data-ttu-id="e9c04-152">Independentemente de seu serviço ser com ou sem estado, o Reliable Services fornece um ciclo de vida simples que permite conectar rapidamente seu código e começar.</span><span class="sxs-lookup"><span data-stu-id="e9c04-152">Whether your service is stateful or stateless, Reliable Services provide a simple lifecycle that lets you quickly plug in your code and get started.</span></span>  <span data-ttu-id="e9c04-153">Há apenas um ou dois métodos que você precisa implementar para colocar o serviço em funcionamento.</span><span class="sxs-lookup"><span data-stu-id="e9c04-153">There are just one or two methods that you need to implement to get your service up and running.</span></span>

* <span data-ttu-id="e9c04-154">**CreateServiceReplicaListeners/CreateServiceInstanceListeners** – Esse método é onde o serviço define as pilhas de comunicações que deseja usar.</span><span class="sxs-lookup"><span data-stu-id="e9c04-154">**CreateServiceReplicaListeners/CreateServiceInstanceListeners** - This method is where the service defines the communication stack(s) that it wants to use.</span></span> <span data-ttu-id="e9c04-155">A pilha de comunicações, tal como a [API Web](service-fabric-reliable-services-communication-webapi.md), é o que define o ponto de extremidade de escuta ou os pontos de extremidade do serviço (como os clientes o alcançarão).</span><span class="sxs-lookup"><span data-stu-id="e9c04-155">The communication stack, such as [Web API](service-fabric-reliable-services-communication-webapi.md), is what defines the listening endpoint or endpoints for the service (how clients reach the service).</span></span> <span data-ttu-id="e9c04-156">Ele também define como as mensagens que aparecem interagem com o restante do código do serviço.</span><span class="sxs-lookup"><span data-stu-id="e9c04-156">It also defines how the messages that appear interact with the rest of the service code.</span></span>
* <span data-ttu-id="e9c04-157">**RunAsync** – Esse método é no qual o seu serviço executa sua lógica de negócios e no qual ele seria iniciaria as tarefas em segundo plano que devem ser executado durante o tempo de vida do serviço.</span><span class="sxs-lookup"><span data-stu-id="e9c04-157">**RunAsync** - This method is where your service runs its business logic, and where it would kick off any background tasks that should run for the lifetime of the service.</span></span> <span data-ttu-id="e9c04-158">O token de cancelamento fornecido é um sinal de quando esse trabalho deve parar.</span><span class="sxs-lookup"><span data-stu-id="e9c04-158">The cancellation token that is provided is a signal for when that work should stop.</span></span> <span data-ttu-id="e9c04-159">Por exemplo, se o serviço precisar extrair mensagens de um Reliable Queue e processá-las, é ali esse trabalho ocorrerá.</span><span class="sxs-lookup"><span data-stu-id="e9c04-159">For example, if the service needs to pull messages out of a Reliable Queue and process them, this is where that work happens.</span></span>

<span data-ttu-id="e9c04-160">Se você estiver aprendendo sobre Reliable Services pela primeira vez, continue lendo!</span><span class="sxs-lookup"><span data-stu-id="e9c04-160">If you're learning about reliable services for the first time, read on!</span></span> <span data-ttu-id="e9c04-161">Se estiver procurando um passo a passo detalhado sobre o ciclo de vida dos Reliable Services, visite [este artigo](service-fabric-reliable-services-lifecycle.md).</span><span class="sxs-lookup"><span data-stu-id="e9c04-161">If you're looking for a detailed walkthrough of the lifecycle of reliable services, you can head over to [this article](service-fabric-reliable-services-lifecycle.md).</span></span>

## <a name="example-services"></a><span data-ttu-id="e9c04-162">Exemplo de serviços</span><span class="sxs-lookup"><span data-stu-id="e9c04-162">Example services</span></span>
<span data-ttu-id="e9c04-163">Conhecendo este modelo de programação, vamos dar uma olhada em dois serviços diferentes para ver como essas peças se encaixam.</span><span class="sxs-lookup"><span data-stu-id="e9c04-163">Knowing this programming model, let's take a quick look at two different services to see how these pieces fit together.</span></span>

### <a name="stateless-reliable-services"></a><span data-ttu-id="e9c04-164">Serviços Confiáveis sem estado</span><span class="sxs-lookup"><span data-stu-id="e9c04-164">Stateless Reliable Services</span></span>
<span data-ttu-id="e9c04-165">Um serviço sem estado é aquele em que não há nenhum estado mantido dentro do serviço entre as chamadas.</span><span class="sxs-lookup"><span data-stu-id="e9c04-165">A stateless service is one where there is no state maintained within the service across calls.</span></span> <span data-ttu-id="e9c04-166">Qualquer estado presente é totalmente descartável e não requer sincronização, replicação, persistência ou alta disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="e9c04-166">Any state that is present is entirely disposable and doesn't require synchronization, replication, persistence, or high availability.</span></span>

<span data-ttu-id="e9c04-167">Por exemplo, considere uma calculadora que não tenha memória e que receba todos os termos e operações para serem executados ao mesmo tempo.</span><span class="sxs-lookup"><span data-stu-id="e9c04-167">For example, consider a calculator that has no memory and receives all terms and operations to perform at once.</span></span>

<span data-ttu-id="e9c04-168">Nesse caso, o `RunAsync()` (C#) ou `runAsync()` (Java) do serviço pode estar vazio, pois não há processamentos de tarefas em segundo plano que o serviço precisa executar.</span><span class="sxs-lookup"><span data-stu-id="e9c04-168">In this case, the `RunAsync()` (C#) or `runAsync()` (Java) of the service can be empty, since there is no background task-processing that the service needs to do.</span></span> <span data-ttu-id="e9c04-169">Quando o serviço da calculadora for criado, ele retornará um `ICommunicationListener` (C#) ou `CommunicationListener` (Java) (por exemplo, [API Web](service-fabric-reliable-services-communication-webapi.md)) que abre um ponto de extremidade de escuta em alguma porta.</span><span class="sxs-lookup"><span data-stu-id="e9c04-169">When the calculator service is created, it returns an `ICommunicationListener` (C#) or `CommunicationListener` (Java) (for example [Web API](service-fabric-reliable-services-communication-webapi.md)) that opens up a listening endpoint on some port.</span></span> <span data-ttu-id="e9c04-170">Esse ponto de extremidade de escuta se conectará aos diferentes métodos de cálculo (por exemplo: "Add(n1, n2)") que definem a API pública da calculadora.</span><span class="sxs-lookup"><span data-stu-id="e9c04-170">This listening endpoint hooks up to the different calculation methods (example: "Add(n1, n2)") that define the calculator's public API.</span></span>

<span data-ttu-id="e9c04-171">Quando é feita uma chamada de um cliente, o método apropriado é invocado e o serviço da calculadora executa as operações nos dados fornecidos e retorna o resultado.</span><span class="sxs-lookup"><span data-stu-id="e9c04-171">When a call is made from a client, the appropriate method is invoked, and the calculator service performs the operations on the data provided and returns the result.</span></span> <span data-ttu-id="e9c04-172">O estado não é armazenado.</span><span class="sxs-lookup"><span data-stu-id="e9c04-172">It doesn't store any state.</span></span>

<span data-ttu-id="e9c04-173">Não armazenar nenhum estado interno torna este exemplo de calculadora muito simples.</span><span class="sxs-lookup"><span data-stu-id="e9c04-173">Not storing any internal state makes this example calculator simple.</span></span> <span data-ttu-id="e9c04-174">Mas a maioria dos serviços não é realmente sem estado.</span><span class="sxs-lookup"><span data-stu-id="e9c04-174">But most services aren't truly stateless.</span></span> <span data-ttu-id="e9c04-175">Em vez disso, eles externalizam o estado para algum outro repositório.</span><span class="sxs-lookup"><span data-stu-id="e9c04-175">Instead, they externalize their state to some other store.</span></span> <span data-ttu-id="e9c04-176">(Por exemplo, qualquer aplicativo Web que depende da manutenção do estado de sessão em um repositório de backup ou do cache não é sem estado.)</span><span class="sxs-lookup"><span data-stu-id="e9c04-176">(For example, any web app that relies on keeping session state in a backing store or cache is not stateless.)</span></span>

<span data-ttu-id="e9c04-177">Um exemplo comum de como serviços sem estado são usados na Malha de Serviços é um front-end que expõe a API voltada ao público para um aplicativo Web.</span><span class="sxs-lookup"><span data-stu-id="e9c04-177">A common example of how stateless services are used in Service Fabric is as a front-end that exposes the public-facing API for a web application.</span></span> <span data-ttu-id="e9c04-178">O serviço front-end se comunica com serviços com estado para concluir a solicitação de um usuário.</span><span class="sxs-lookup"><span data-stu-id="e9c04-178">The front-end service then talks to stateful services to complete a user request.</span></span> <span data-ttu-id="e9c04-179">Nesse caso, chamadas de clientes são direcionadas para uma porta conhecida, por exemplo, a 80, na qual o serviço sem estado está escutando.</span><span class="sxs-lookup"><span data-stu-id="e9c04-179">In this case, calls from clients are directed to a known port, such as 80, where the stateless service is listening.</span></span> <span data-ttu-id="e9c04-180">Esse serviço sem estado recebe a chamada e determina se ela é de uma parte confiável, bem como o serviço ao qual ela se destina.</span><span class="sxs-lookup"><span data-stu-id="e9c04-180">This stateless service receives the call and determines whether the call is from a trusted party and which service it's destined for.</span></span>  <span data-ttu-id="e9c04-181">Em seguida, o serviço sem estado encaminha a chamada para a partição correta do serviço com estado e aguarda uma resposta.</span><span class="sxs-lookup"><span data-stu-id="e9c04-181">Then, the stateless service forwards the call to the correct partition of the stateful service and waits for a response.</span></span> <span data-ttu-id="e9c04-182">Quando o serviço sem estado recebe uma resposta, ele responde ao cliente original.</span><span class="sxs-lookup"><span data-stu-id="e9c04-182">When the stateless service receives a response, it replies to the original client.</span></span> <span data-ttu-id="e9c04-183">Veja um exemplo de um serviço como esse em nossas amostras de [C#](https://github.com/Azure-Samples/service-fabric-dotnet-getting-started) / [Java](https://github.com/Azure-Samples/service-fabric-java-getting-started/tree/master/Actors/VisualObjectActor/VisualObjectWebService).</span><span class="sxs-lookup"><span data-stu-id="e9c04-183">An example of such a service is in our samples [C#](https://github.com/Azure-Samples/service-fabric-dotnet-getting-started) / [Java](https://github.com/Azure-Samples/service-fabric-java-getting-started/tree/master/Actors/VisualObjectActor/VisualObjectWebService).</span></span> <span data-ttu-id="e9c04-184">Esse é apenas um exemplo desse padrão nos exemplos, também existem outros nos demais exemplos.</span><span class="sxs-lookup"><span data-stu-id="e9c04-184">This is only one example of this pattern in the samples, there are others in other samples as well.</span></span>

### <a name="stateful-reliable-services"></a><span data-ttu-id="e9c04-185">Serviços Confiáveis com estado</span><span class="sxs-lookup"><span data-stu-id="e9c04-185">Stateful Reliable Services</span></span>
<span data-ttu-id="e9c04-186">Um serviço com estado deve ter alguma parte do estado consistente e presente para que o serviço funcione.</span><span class="sxs-lookup"><span data-stu-id="e9c04-186">A stateful service is one that must have some portion of state kept consistent and present in order for the service to function.</span></span> <span data-ttu-id="e9c04-187">Considere um serviço que calcula constantemente uma média móvel de algum valor com base em atualizações que recebe.</span><span class="sxs-lookup"><span data-stu-id="e9c04-187">Consider a service that constantly computes a rolling average of some value based on updates it receives.</span></span> <span data-ttu-id="e9c04-188">Para fazer isso, é necessário ter o conjunto atual de solicitações de entrada que precisam ser processados e a média atual.</span><span class="sxs-lookup"><span data-stu-id="e9c04-188">To do this, it must have the current set of incoming requests it needs to process and the current average.</span></span> <span data-ttu-id="e9c04-189">Qualquer serviço que recupera, processa e armazena informações em um repositório externo (como um repositório de tabelas ou blob do Azure) é um serviço com estado.</span><span class="sxs-lookup"><span data-stu-id="e9c04-189">Any service that retrieves, processes, and stores information in an external store (such as an Azure blob or table store today) is stateful.</span></span> <span data-ttu-id="e9c04-190">Ele simplesmente mantém seu estado no repositório de estado externo.</span><span class="sxs-lookup"><span data-stu-id="e9c04-190">It just keeps its state in the external state store.</span></span>

<span data-ttu-id="e9c04-191">A maioria dos serviços atuais armazena seu estado externamente, pois o repositório externo é o que fornece confiabilidade, disponibilidade, escalabilidade e consistência para esse estado.</span><span class="sxs-lookup"><span data-stu-id="e9c04-191">Most services today store their state externally, since the external store is what provides reliability, availability, scalability, and consistency for that state.</span></span> <span data-ttu-id="e9c04-192">No Service Fabric, os serviços não são necessários para armazenar seu estado externamente.</span><span class="sxs-lookup"><span data-stu-id="e9c04-192">In Service Fabric, services aren't required to store their state externally.</span></span> <span data-ttu-id="e9c04-193">O Service Fabric cuida desses requisitos para o código e o estado do serviço.</span><span class="sxs-lookup"><span data-stu-id="e9c04-193">Service Fabric takes care of these requirements for both the service code and the service state.</span></span>

> [!NOTE]
> <span data-ttu-id="e9c04-194">O suporte para Reliable Services com estado ainda não está disponível no Linux (para C# ou Java).</span><span class="sxs-lookup"><span data-stu-id="e9c04-194">Support for Stateful Reliable Services is not available on Linux yet (for C# or Java).</span></span>
>

<span data-ttu-id="e9c04-195">Digamos que desejamos criar um serviço que processa imagens.</span><span class="sxs-lookup"><span data-stu-id="e9c04-195">Let's say we want to write a service that processes images.</span></span> <span data-ttu-id="e9c04-196">Para fazer isso, o serviço obtém uma imagem e a série de conversões a serem executadas na imagem.</span><span class="sxs-lookup"><span data-stu-id="e9c04-196">To do this, the service takes in an image and the series of conversions to perform on that image.</span></span> <span data-ttu-id="e9c04-197">Este serviço retorna um ouvinte de comunicação (suponhamos que é uma WebAPI) que expõe uma API como `ConvertImage(Image i, IList<Conversion> conversions)`.</span><span class="sxs-lookup"><span data-stu-id="e9c04-197">This service returns a communication listener (let's suppose it's a WebAPI) that exposes an API like `ConvertImage(Image i, IList<Conversion> conversions)`.</span></span> <span data-ttu-id="e9c04-198">Quando ele recebe uma solicitação, o serviço a armazena em um `IReliableQueue` e retorna uma ID para o cliente para que ele possa rastrear a solicitação.</span><span class="sxs-lookup"><span data-stu-id="e9c04-198">When it receives a request, the service stores it in a `IReliableQueue`, and returns some id to the client so it can track the request.</span></span>

<span data-ttu-id="e9c04-199">Nesse serviço, `RunAsync()` poderia ser mais complexo.</span><span class="sxs-lookup"><span data-stu-id="e9c04-199">In this service, `RunAsync()` could be more complex.</span></span> <span data-ttu-id="e9c04-200">O serviço tem um loop dentro de seu `RunAsync()` que recebe solicitações de `IReliableQueue` e executa as conversões solicitadas.</span><span class="sxs-lookup"><span data-stu-id="e9c04-200">The service has a loop inside its `RunAsync()` that pulls requests out of `IReliableQueue` and performs the conversions requested.</span></span> <span data-ttu-id="e9c04-201">Os resultados são armazenados em um `IReliableDictionary` para que, quando o cliente voltar, ele possa obter suas imagens convertidas.</span><span class="sxs-lookup"><span data-stu-id="e9c04-201">The results get stored in an `IReliableDictionary` so that when the client comes back they can get their converted images.</span></span> <span data-ttu-id="e9c04-202">Para garantir que a imagem não seja perdida mesmo se algo der errado, esse Reliable Service sairia da fila, executaria as conversões e armazenaria o resultado em uma transação.</span><span class="sxs-lookup"><span data-stu-id="e9c04-202">To ensure that even if something fails the image isn't lost, this Reliable Service would pull out of the queue, perform the conversions, and store the result all in a single transaction.</span></span> <span data-ttu-id="e9c04-203">Nesse caso, a mensagem é removida da fila e os resultados são armazenados no dicionário de resultados após a conclusão das conversões.</span><span class="sxs-lookup"><span data-stu-id="e9c04-203">In this case, the message is removed from the queue and the results are stored in the result dictionary only when the conversions are complete.</span></span> <span data-ttu-id="e9c04-204">Como alternativa, o serviço poderia extrair a imagem da fila e armazená-la imediatamente em um repositório remoto.</span><span class="sxs-lookup"><span data-stu-id="e9c04-204">Alternatively, the service could pull the image out of the queue and immediately store it in a remote store.</span></span> <span data-ttu-id="e9c04-205">Isso reduz a quantidade de estado que do serviço precisa gerenciar, porém aumenta a complexidade, visto que o serviço deve manter os metadados necessários para gerenciar o repositório remoto.</span><span class="sxs-lookup"><span data-stu-id="e9c04-205">This reduces the amount of state the service has to manage, but increases complexity since the service has to keep the necessary metadata to manage the remote store.</span></span> <span data-ttu-id="e9c04-206">Com essa abordagem, se algo falhar no meio a solicitação, esta permanecerá na fila aguardando para ser processada.</span><span class="sxs-lookup"><span data-stu-id="e9c04-206">With either approach, if something failed in the middle the request remains in the queue waiting to be processed.</span></span>

<span data-ttu-id="e9c04-207">Um ponto a ser observado sobre esse serviço é que ele se parece um serviço .NET normal.</span><span class="sxs-lookup"><span data-stu-id="e9c04-207">One thing to note about this service is that it sounds like a normal .NET service!</span></span> <span data-ttu-id="e9c04-208">A única diferença é que as estruturas de dados que estão sendo usadas (`IReliableQueue` e `IReliableDictionary`) são fornecidas pelo Service Fabric e, portanto, são altamente confiáveis, disponíveis e consistentes.</span><span class="sxs-lookup"><span data-stu-id="e9c04-208">The only difference is that the data structures being used (`IReliableQueue` and `IReliableDictionary`) are provided by Service Fabric, and are highly reliable, available, and consistent.</span></span>

## <a name="when-to-use-reliable-services-apis"></a><span data-ttu-id="e9c04-209">Quando usar APIs de Reliable Services</span><span class="sxs-lookup"><span data-stu-id="e9c04-209">When to use Reliable Services APIs</span></span>
<span data-ttu-id="e9c04-210">Se um dos itens a seguir caracterizar as necessidades de serviço do aplicativo, considere as APIs de Reliable Services:</span><span class="sxs-lookup"><span data-stu-id="e9c04-210">If any of the following characterize your application service needs, then you should consider Reliable Services APIs:</span></span>

* <span data-ttu-id="e9c04-211">O ideal é que o código do serviço (e opcionalmente, o estado) seja altamente disponível e confiável</span><span class="sxs-lookup"><span data-stu-id="e9c04-211">You want your service's code (and optionally state) to be highly available and reliable</span></span>
* <span data-ttu-id="e9c04-212">Você precisa de garantias transacionais entre várias unidades de estado (por exemplo, pedidos e itens de linha do pedido).</span><span class="sxs-lookup"><span data-stu-id="e9c04-212">You need transactional guarantees across multiple units of state (for example, orders and order line items).</span></span>
* <span data-ttu-id="e9c04-213">O estado do aplicativo pode ser modelado naturalmente como Filas e Dicionários Confiáveis.</span><span class="sxs-lookup"><span data-stu-id="e9c04-213">Your application’s state can be naturally modeled as Reliable Dictionaries and Queues.</span></span>
* <span data-ttu-id="e9c04-214">Seu código ou o estado dos aplicativos precisam ser altamente disponíveis com baixa latência em leituras e gravações.</span><span class="sxs-lookup"><span data-stu-id="e9c04-214">Your applications code or state needs to be highly available with low latency reads and writes.</span></span>
* <span data-ttu-id="e9c04-215">Seu aplicativo precisa controlar a simultaneidade ou a granularidade das operações realizadas em uma ou mais Reliable Collections.</span><span class="sxs-lookup"><span data-stu-id="e9c04-215">Your application needs to control the concurrency or granularity of transacted operations across one or more Reliable Collections.</span></span>
* <span data-ttu-id="e9c04-216">Você deseja gerenciar as comunicações e controlar o esquema de particionamento do seu serviço.</span><span class="sxs-lookup"><span data-stu-id="e9c04-216">You want to manage the communications or control the partitioning scheme for your service.</span></span>
* <span data-ttu-id="e9c04-217">Seu código precisa de um ambiente de tempo de execução de thread livre.</span><span class="sxs-lookup"><span data-stu-id="e9c04-217">Your code needs a free-threaded runtime environment.</span></span>
* <span data-ttu-id="e9c04-218">Seu aplicativo precisa criar ou destruir Reliable Dictionaries, Queues ou Services completos no tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="e9c04-218">Your application needs to dynamically create or destroy Reliable Dictionaries or Queues or whole Services at runtime.</span></span>
* <span data-ttu-id="e9c04-219">Você precisa controlar os recursos de backup e restauração fornecidos pelo Service Fabric por meio de programação para o estado do seu serviço.</span><span class="sxs-lookup"><span data-stu-id="e9c04-219">You need to programmatically control Service Fabric-provided backup and restore features for your service’s state.</span></span>
* <span data-ttu-id="e9c04-220">Seu aplicativo precisa manter um histórico de alterações para suas unidades de estado.</span><span class="sxs-lookup"><span data-stu-id="e9c04-220">Your application needs to maintain change history for its units of state.</span></span>
* <span data-ttu-id="e9c04-221">Você deseja desenvolver ou consumir provedores de estado personalizados desenvolvidos por terceiros.</span><span class="sxs-lookup"><span data-stu-id="e9c04-221">You want to develop or consume third-party-developed, custom state providers.</span></span>

## <a name="next-steps"></a><span data-ttu-id="e9c04-222">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="e9c04-222">Next steps</span></span>
* [<span data-ttu-id="e9c04-223">Início Rápido dos Serviços Confiáveis</span><span class="sxs-lookup"><span data-stu-id="e9c04-223">Reliable Services quick start</span></span>](service-fabric-reliable-services-quick-start.md)
* [<span data-ttu-id="e9c04-224">Uso avançado de Reliable Services</span><span class="sxs-lookup"><span data-stu-id="e9c04-224">Reliable Services advanced usage</span></span>](service-fabric-reliable-services-advanced-usage.md)
* [<span data-ttu-id="e9c04-225">O modelo de programação de Reliable Actors</span><span class="sxs-lookup"><span data-stu-id="e9c04-225">The Reliable Actors programming model</span></span>](service-fabric-reliable-actors-introduction.md)
