---
title: "Descrição do recurso Gerenciador de Cluster de aaaCluster | Microsoft Docs"
description: "Que descreve um cluster do Service Fabric especificando domínios de falha, domínios de atualização, as propriedades de nó e as capacidades de nó para Olá Gerenciador de recursos de Cluster."
services: service-fabric
documentationcenter: .net
author: masnider
manager: timlt
editor: 
ms.assetid: 55f8ab37-9399-4c9a-9e6c-d2d859de6766
ms.service: Service-Fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 08/18/2017
ms.author: masnider
ms.openlocfilehash: f2822075976bd54402af5ad56991b5b360dfb1d8
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="describing-a-service-fabric-cluster"></a><span data-ttu-id="89a89-103">Descrevendo um cluster do Service Fabric</span><span class="sxs-lookup"><span data-stu-id="89a89-103">Describing a service fabric cluster</span></span>
<span data-ttu-id="89a89-104">Olá Gerenciador de recursos de Cluster do serviço de malha fornece vários mecanismos para descrever um cluster.</span><span class="sxs-lookup"><span data-stu-id="89a89-104">hello Service Fabric Cluster Resource Manager provides several mechanisms for describing a cluster.</span></span> <span data-ttu-id="89a89-105">Durante a execução, Olá Gerenciador de recursos de Cluster usa essa informações tooensure alta disponibilidade de serviços de saudação em execução no cluster de saudação.</span><span class="sxs-lookup"><span data-stu-id="89a89-105">During runtime, hello Cluster Resource Manager uses this information tooensure high availability of hello services running in hello cluster.</span></span> <span data-ttu-id="89a89-106">Ao impor essas regras importantes, ele também tenta toooptimize consumo de recursos de saudação em cluster hello.</span><span class="sxs-lookup"><span data-stu-id="89a89-106">While enforcing these important rules, it also attempts toooptimize hello resource consumption within hello cluster.</span></span>

## <a name="key-concepts"></a><span data-ttu-id="89a89-107">Principais conceitos</span><span class="sxs-lookup"><span data-stu-id="89a89-107">Key concepts</span></span>
<span data-ttu-id="89a89-108">Olá Gerenciador de recursos de Cluster dá suporte a vários recursos que descrevem um cluster:</span><span class="sxs-lookup"><span data-stu-id="89a89-108">hello Cluster Resource Manager supports several features that describe a cluster:</span></span>

* <span data-ttu-id="89a89-109">Domínios de falha</span><span class="sxs-lookup"><span data-stu-id="89a89-109">Fault Domains</span></span>
* <span data-ttu-id="89a89-110">Domínios de atualização</span><span class="sxs-lookup"><span data-stu-id="89a89-110">Upgrade Domains</span></span>
* <span data-ttu-id="89a89-111">Propriedades de nó</span><span class="sxs-lookup"><span data-stu-id="89a89-111">Node Properties</span></span>
* <span data-ttu-id="89a89-112">Capacidades de nó</span><span class="sxs-lookup"><span data-stu-id="89a89-112">Node Capacities</span></span>

## <a name="fault-domains"></a><span data-ttu-id="89a89-113">Domínios de falha</span><span class="sxs-lookup"><span data-stu-id="89a89-113">Fault domains</span></span>
<span data-ttu-id="89a89-114">Um domínio de falha é qualquer área da falha coordenada.</span><span class="sxs-lookup"><span data-stu-id="89a89-114">A Fault Domain is any area of coordinated failure.</span></span> <span data-ttu-id="89a89-115">Um único computador é um domínio de falha (desde que ele pode falhar em seus próprio para vários motivos, de firmware NIC toobad de falhas toodrive de falhas fonte de energia).</span><span class="sxs-lookup"><span data-stu-id="89a89-115">A single machine is a Fault Domain (since it can fail on its own for various reasons, from power supply failures toodrive failures toobad NIC firmware).</span></span> <span data-ttu-id="89a89-116">Computadores conectado toohello mesmo comutador Ethernet estão em Olá mesmo domínio de falha, como são computadores que compartilham uma única fonte de energia ou em um único local.</span><span class="sxs-lookup"><span data-stu-id="89a89-116">Machines connected toohello same Ethernet switch are in hello same Fault Domain, as are machines sharing a single source of power or in a single location.</span></span> <span data-ttu-id="89a89-117">Como é natural para toooverlap de falhas de hardware, os domínios de falha são inerentemente hierárquicos e são representados como URIs na malha do serviço.</span><span class="sxs-lookup"><span data-stu-id="89a89-117">Since it's natural for hardware faults toooverlap, Fault Domains are inherently hierarchal and are represented as URIs in Service Fabric.</span></span>

<span data-ttu-id="89a89-118">É importante que domínios de falha são definidos corretamente como o Service Fabric usa os serviços de informações toosafely local.</span><span class="sxs-lookup"><span data-stu-id="89a89-118">It is important that Fault Domains are set up correctly since Service Fabric uses this information toosafely place services.</span></span> <span data-ttu-id="89a89-119">Serviço de malha não quer tooplace serviços, de forma que a perda de saudação de um domínio de falha (causado por falha de saudação de algum componente) faz com que um serviço toogo para baixo.</span><span class="sxs-lookup"><span data-stu-id="89a89-119">Service Fabric doesn't want tooplace services such that hello loss of a Fault Domain (caused by hello failure of some component) causes a service toogo down.</span></span> <span data-ttu-id="89a89-120">Olá ambiente do Azure Service Fabric usa informações de domínio de falha de saudação fornecidas pelo Olá ambiente toocorrectly configure nós Olá cluster Olá em seu nome.</span><span class="sxs-lookup"><span data-stu-id="89a89-120">In hello Azure environment Service Fabric uses hello Fault Domain information provided by hello environment toocorrectly configure hello nodes in hello cluster on your behalf.</span></span> <span data-ttu-id="89a89-121">Para Service Fabric autônomo, domínios de falha são definidas em tempo de saudação cluster hello está configurado</span><span class="sxs-lookup"><span data-stu-id="89a89-121">For Service Fabric Standalone, Fault Domains are defined at hello time that hello cluster is set up</span></span> 

> [!WARNING]
> <span data-ttu-id="89a89-122">É importante que as informações de domínio de falha de saudação fornecido tooService malha está correta.</span><span class="sxs-lookup"><span data-stu-id="89a89-122">It is important that hello Fault Domain information provided tooService Fabric is accurate.</span></span> <span data-ttu-id="89a89-123">Por exemplo, digamos que nós do cluster do Service Fabric estejam em execução dentro de dez máquinas virtuais que são executadas em cinco hosts físicos.</span><span class="sxs-lookup"><span data-stu-id="89a89-123">For example, let's say that your Service Fabric cluster's nodes are running inside 10 virtual machines, running on five physical hosts.</span></span> <span data-ttu-id="89a89-124">Nesse caso, mesmo que haja dez máquinas virtuais, há apenas cinco domínios de falha (de nível superior) diferentes.</span><span class="sxs-lookup"><span data-stu-id="89a89-124">In this case, even though there are 10 virtual machines, there's only 5 different (top level) fault domains.</span></span> <span data-ttu-id="89a89-125">Compartilhamento Olá faz com que o mesmo host físico tooshare VMs Olá mesmo domínio de falha de raiz, pois Olá experiência de VMs coordenada falha se o host físico falhar.</span><span class="sxs-lookup"><span data-stu-id="89a89-125">Sharing hello same physical host causes VMs tooshare hello same root fault domain, since hello VMs experience coordinated failure if their physical host fails.</span></span>  
>
> <span data-ttu-id="89a89-126">Como a espera do Service Fabric Olá domínio de falha de um nó não toochange.</span><span class="sxs-lookup"><span data-stu-id="89a89-126">Since Service Fabric expects hello Fault Domain of a node not toochange.</span></span> <span data-ttu-id="89a89-127">Outros mecanismos de garantir a alta disponibilidade do hello VMs, como [HA VMs](https://technet.microsoft.com/en-us/library/cc967323.aspx), use a migração transparente de VMs de um host tooanother.</span><span class="sxs-lookup"><span data-stu-id="89a89-127">Other mechanisms of ensuring high availability of hello VMs, such as [HA-VMs](https://technet.microsoft.com/en-us/library/cc967323.aspx), use transparent migration of VMs from one host tooanother.</span></span> <span data-ttu-id="89a89-128">Esses mecanismos não reconfigurar ou notificar Olá executando código dentro Olá VM.</span><span class="sxs-lookup"><span data-stu-id="89a89-128">These mechanisms do not reconfigure or notify hello running code inside hello VM.</span></span> <span data-ttu-id="89a89-129">Sendo assim, eles **não têm suporte** como ambientes para executar clusters do Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="89a89-129">As such, they are **not supported** as environments for running Service Fabric clusters.</span></span> <span data-ttu-id="89a89-130">Malha do serviço deve ser tecnologia de alta disponibilidade só Olá empregada.</span><span class="sxs-lookup"><span data-stu-id="89a89-130">Service Fabric should be hello only high-availability technology employed.</span></span> <span data-ttu-id="89a89-131">Mecanismos como migração dinâmica de VMs e SANs, entre outros, não são necessários.</span><span class="sxs-lookup"><span data-stu-id="89a89-131">Mechanisms like live VM migration, SANs, or others are not necessary.</span></span> <span data-ttu-id="89a89-132">Se usados em conjunto com o Service Fabric, esses mecanismos _reduzem_ a confiabilidade e a disponibilidade dos aplicativos, pois eles introduzem complexidade adicional, adicionam fontes de falha centralizadas e utilizam estratégias de disponibilidade e confiabilidade que entram em conflito com aquelas em vigor no Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="89a89-132">If used in conjunction with Service Fabric, these mechanisms _reduce_ application availability and reliability because they introduce additional complexity, add centralized sources of failure, and utilize reliability and availability strategies that conflict with those in Service Fabric.</span></span> 
>
>

<span data-ttu-id="89a89-133">No gráfico de saudação abaixo é cores de todas as entidades de saudação que contribuem tooFault domínios e lista que todos os diferentes domínios de falha que resultam de hello.</span><span class="sxs-lookup"><span data-stu-id="89a89-133">In hello graphic below we color all hello entities that contribute tooFault Domains and list all hello different Fault Domains that result.</span></span> <span data-ttu-id="89a89-134">Neste exemplo, temos datacenters (“DC”), racks (“R”) e folhas (“B”).</span><span class="sxs-lookup"><span data-stu-id="89a89-134">In this example, we have datacenters ("DC"), racks ("R"), and blades ("B").</span></span> <span data-ttu-id="89a89-135">Em termos conceituais, se cada folha contém mais de uma máquina virtual, pode haver outra camada na hierarquia de domínio de falha de saudação.</span><span class="sxs-lookup"><span data-stu-id="89a89-135">Conceivably, if each blade holds more than one virtual machine, there could be another layer in hello Fault Domain hierarchy.</span></span>

<span data-ttu-id="89a89-136"><center>
![Nós organizados por meio de domínios de falha][Image1]
</center></span><span class="sxs-lookup"><span data-stu-id="89a89-136"><center>
![Nodes organized via Fault Domains][Image1]
</center></span></span>

<span data-ttu-id="89a89-137">Durante a execução, Olá Gerenciador de recursos de Cluster do serviço de malha considera Olá domínios de falha no cluster hello e planos de layouts.</span><span class="sxs-lookup"><span data-stu-id="89a89-137">During runtime, hello Service Fabric Cluster Resource Manager considers hello Fault Domains in hello cluster and plans layouts.</span></span> <span data-ttu-id="89a89-138">Olá réplicas com monitoração de estado ou instâncias sem monitoração de estado de um serviço específico são distribuídas para que fiquem em domínios de falha separados.</span><span class="sxs-lookup"><span data-stu-id="89a89-138">hello stateful replicas or stateless instances for a given service are distributed so they are in separate Fault Domains.</span></span> <span data-ttu-id="89a89-139">Distribuir o serviço de saudação em domínios de falha garante a disponibilidade de saudação do serviço de saudação não seja comprometida quando um domínio de falha falhar em qualquer nível da hierarquia de saudação.</span><span class="sxs-lookup"><span data-stu-id="89a89-139">Distributing hello service across fault domains ensures hello availability of hello service is not compromised when a Fault Domain fails at any level of hello hierarchy.</span></span>

<span data-ttu-id="89a89-140">Gerenciador de recursos de Cluster do Service Fabric não importa quantas camadas na hierarquia de domínio de falha de saudação.</span><span class="sxs-lookup"><span data-stu-id="89a89-140">Service Fabric’s Cluster Resource Manager doesn’t care how many layers there are in hello Fault Domain hierarchy.</span></span> <span data-ttu-id="89a89-141">No entanto, ele tenta tooensure perda de saudação de qualquer parte de uma hierarquia Olá não afeta os serviços em execução.</span><span class="sxs-lookup"><span data-stu-id="89a89-141">However, it tries tooensure that hello loss of any one portion of hello hierarchy doesn’t impact services running in it.</span></span> 

<span data-ttu-id="89a89-142">É melhor se houver Olá o mesmo número de nós em cada nível de profundidade na hierarquia de domínio de falha de saudação.</span><span class="sxs-lookup"><span data-stu-id="89a89-142">It is best if there are hello same number of nodes at each level of depth in hello Fault Domain hierarchy.</span></span> <span data-ttu-id="89a89-143">Se hello "árvore" de domínios de falha está faltando em seu cluster, dificulta para Olá toofigure do Gerenciador de recursos de Cluster de limite de alocação de saudação recomendada dos serviços.</span><span class="sxs-lookup"><span data-stu-id="89a89-143">If hello “tree” of Fault Domains is unbalanced in your cluster, it makes it harder for hello Cluster Resource Manager toofigure out hello best allocation of services.</span></span> <span data-ttu-id="89a89-144">Layouts de domínios de falha desequilibrados significam essa perda de saudação de alguns domínios disponibilidade de saudação do impacto de serviços mais do que outros domínios.</span><span class="sxs-lookup"><span data-stu-id="89a89-144">Imbalanced Fault Domains layouts mean that hello loss of some domains impact hello availability of services more than other domains.</span></span> <span data-ttu-id="89a89-145">Como resultado, Olá Gerenciador de recursos de Cluster é interrompida entre as duas metas: ele deseja máquinas de saudação toouse no domínio "pesada" colocando serviços neles e desejar tooplace serviços em outros domínios para que a perda de saudação de um domínio não causa problemas.</span><span class="sxs-lookup"><span data-stu-id="89a89-145">As a result, hello Cluster Resource Manager is torn between two goals: It wants toouse hello machines in that “heavy” domain by placing services on them, and it wants tooplace services in other domains so that hello loss of a domain doesn’t cause problems.</span></span> 

<span data-ttu-id="89a89-146">Qual é a aparência de um domínio desequilibrado?</span><span class="sxs-lookup"><span data-stu-id="89a89-146">What do imbalanced domains look like?</span></span> <span data-ttu-id="89a89-147">No diagrama de saudação seguir, mostramos dois layouts de cluster diferente.</span><span class="sxs-lookup"><span data-stu-id="89a89-147">In hello diagram below, we show two different cluster layouts.</span></span> <span data-ttu-id="89a89-148">No primeiro exemplo de hello, nós de saudação são distribuídos uniformemente por Olá domínios de falha.</span><span class="sxs-lookup"><span data-stu-id="89a89-148">In hello first example, hello nodes are distributed evenly across hello Fault Domains.</span></span> <span data-ttu-id="89a89-149">No segundo exemplo de hello, um domínio de falha tem mais nós do que Olá outros domínios de falha.</span><span class="sxs-lookup"><span data-stu-id="89a89-149">In hello second example, one Fault Domain has many more nodes than hello other Fault Domains.</span></span> 

<span data-ttu-id="89a89-150"><center>
![Dois layouts de cluster diferentes][Image2]
</center></span><span class="sxs-lookup"><span data-stu-id="89a89-150"><center>
![Two different cluster layouts][Image2]
</center></span></span>

<span data-ttu-id="89a89-151">No Azure, a opção de saudação do qual o domínio de falha contém um nó é gerenciada por você.</span><span class="sxs-lookup"><span data-stu-id="89a89-151">In Azure, hello choice of which Fault Domain contains a node is managed for you.</span></span> <span data-ttu-id="89a89-152">No entanto, dependendo do número de saudação de nós que você provisionar você ainda poderá acabar com domínios de falha com mais nós neles que outros.</span><span class="sxs-lookup"><span data-stu-id="89a89-152">However, depending on hello number of nodes that you provision you can still end up with Fault Domains with more nodes in them than others.</span></span> <span data-ttu-id="89a89-153">Por exemplo, digamos que você tem cinco domínios de falha no cluster Olá mas provisiona sete nós para um determinado tipo.</span><span class="sxs-lookup"><span data-stu-id="89a89-153">For example, say you have five Fault Domains in hello cluster but provision seven nodes for a given NodeType.</span></span> <span data-ttu-id="89a89-154">Nesse caso, hello primeiro dois domínios de falha acabar com mais nós.</span><span class="sxs-lookup"><span data-stu-id="89a89-154">In this case, hello first two Fault Domains end up with more nodes.</span></span> <span data-ttu-id="89a89-155">Se você continuar toodeploy mais NodeTypes com apenas algumas instâncias, o problema de saudação é pior.</span><span class="sxs-lookup"><span data-stu-id="89a89-155">If you continue toodeploy more NodeTypes with only a couple instances, hello problem gets worse.</span></span> <span data-ttu-id="89a89-156">Por esse motivo, que é recomendável que Olá o número de nós em cada tipo de nó é um múltiplo do número de saudação de domínios de falha.</span><span class="sxs-lookup"><span data-stu-id="89a89-156">For this reason it's recommended that hello number of nodes in each node type is a multiple of hello number of Fault Domains.</span></span>

## <a name="upgrade-domains"></a><span data-ttu-id="89a89-157">Domínios de atualização</span><span class="sxs-lookup"><span data-stu-id="89a89-157">Upgrade domains</span></span>
<span data-ttu-id="89a89-158">Domínios de atualização são outro recurso que ajuda a Olá Gerenciador de recursos de Cluster do serviço de malha entender o layout de saudação do cluster hello.</span><span class="sxs-lookup"><span data-stu-id="89a89-158">Upgrade Domains are another feature that helps hello Service Fabric Cluster Resource Manager understand hello layout of hello cluster.</span></span> <span data-ttu-id="89a89-159">Domínios de atualização definam conjuntos de nós que são atualizados ao Olá simultaneamente.</span><span class="sxs-lookup"><span data-stu-id="89a89-159">Upgrade Domains define sets of nodes that are upgraded at hello same time.</span></span> <span data-ttu-id="89a89-160">Saudação de Ajuda do Gerenciador de recursos de Cluster de entender e coordenar operações de gerenciamento, como atualizações de domínios de atualização.</span><span class="sxs-lookup"><span data-stu-id="89a89-160">Upgrade Domains help hello Cluster Resource Manager understand and orchestrate management operations like upgrades.</span></span>

<span data-ttu-id="89a89-161">Os Domínios de Atualização são muito semelhantes aos Domínios de Falha, mas com algumas diferenças importantes.</span><span class="sxs-lookup"><span data-stu-id="89a89-161">Upgrade Domains are a lot like Fault Domains, but with a couple key differences.</span></span> <span data-ttu-id="89a89-162">Primeiro, as áreas de falhas de hardware coordenadas definem os domínios de falha.</span><span class="sxs-lookup"><span data-stu-id="89a89-162">First, areas of coordinated hardware failures define Fault Domains.</span></span> <span data-ttu-id="89a89-163">Domínios de atualização, na Olá outro lado, são definidas pela política.</span><span class="sxs-lookup"><span data-stu-id="89a89-163">Upgrade Domains, on hello other hand, are defined by policy.</span></span> <span data-ttu-id="89a89-164">Você obtém toodecide quantos desejar, em vez de ele seja ditada pelo ambiente de saudação.</span><span class="sxs-lookup"><span data-stu-id="89a89-164">You get toodecide how many you want, rather than it being dictated by hello environment.</span></span> <span data-ttu-id="89a89-165">Você pode ter tantos domínios de atualização quantos forem o número de nós.</span><span class="sxs-lookup"><span data-stu-id="89a89-165">You could have as many Upgrade Domains as you do nodes.</span></span> <span data-ttu-id="89a89-166">Outra diferença entre domínios de falha e domínios de atualização é que os domínios de atualização não são hierárquicos.</span><span class="sxs-lookup"><span data-stu-id="89a89-166">Another difference between Fault Domains and Upgrade Domains is that Upgrade Domains are not hierarchical.</span></span> <span data-ttu-id="89a89-167">Em vez disso, eles são mais parecidos com uma marca simples.</span><span class="sxs-lookup"><span data-stu-id="89a89-167">Instead, they are more like a simple tag.</span></span> 

<span data-ttu-id="89a89-168">Olá diagrama a seguir mostra três que domínios de atualização são distribuídos em três domínios de falha.</span><span class="sxs-lookup"><span data-stu-id="89a89-168">hello following diagram shows three Upgrade Domains are striped across three Fault Domains.</span></span> <span data-ttu-id="89a89-169">Ele também mostra um possível posicionamento para três réplicas diferentes de um serviço com estado, em que cada um fica em domínios de atualização e de falha diferentes.</span><span class="sxs-lookup"><span data-stu-id="89a89-169">It also shows one possible placement for three different replicas of a stateful service, where each ends up in different Fault and Upgrade Domains.</span></span> <span data-ttu-id="89a89-170">Esse posicionamento permite perda de saudação de um domínio de falha enquanto estiver no meio de saudação de uma atualização de serviço e ainda ter uma cópia de dados e código de saudação.</span><span class="sxs-lookup"><span data-stu-id="89a89-170">This placement allows hello loss of a Fault Domain while in hello middle of a service upgrade and still have one copy of hello code and data.</span></span>  

<span data-ttu-id="89a89-171"><center>
![Posicionamento com domínios de falha e atualização][Image3]
</center></span><span class="sxs-lookup"><span data-stu-id="89a89-171"><center>
![Placement With Fault and Upgrade Domains][Image3]
</center></span></span>

<span data-ttu-id="89a89-172">Há vantagens e desvantagens toohaving grande número de domínios de atualização.</span><span class="sxs-lookup"><span data-stu-id="89a89-172">There are pros and cons toohaving large numbers of Upgrade Domains.</span></span> <span data-ttu-id="89a89-173">Domínios de atualização mais significa que cada etapa de atualização de hello mais granular e, portanto, afeta um número menor de nós ou serviços.</span><span class="sxs-lookup"><span data-stu-id="89a89-173">More Upgrade Domains means each step of hello upgrade is more granular and therefore affects a smaller number of nodes or services.</span></span> <span data-ttu-id="89a89-174">Como resultado, serviços menos tem toomove ao mesmo tempo, apresentando menos variação no sistema de saudação.</span><span class="sxs-lookup"><span data-stu-id="89a89-174">As a result, fewer services have toomove at a time, introducing less churn into hello system.</span></span> <span data-ttu-id="89a89-175">Isso tende a tooimprove confiabilidade, desde que a menor do serviço de saudação é afetado por qualquer problema introduzido durante a atualização de saudação.</span><span class="sxs-lookup"><span data-stu-id="89a89-175">This tends tooimprove reliability, since less of hello service is impacted by any issue introduced during hello upgrade.</span></span> <span data-ttu-id="89a89-176">Domínios de atualização mais também significa que você precisa de menos buffer disponível em outros impacto nós toohandle Olá Olá atualize.</span><span class="sxs-lookup"><span data-stu-id="89a89-176">More Upgrade Domains also means that you need less available buffer on other nodes toohandle hello impact of hello upgrade.</span></span> <span data-ttu-id="89a89-177">Por exemplo, se você tiver cinco domínios de atualização, nós de saudação em cada lidar com aproximadamente 20% do tráfego.</span><span class="sxs-lookup"><span data-stu-id="89a89-177">For example, if you have five Upgrade Domains, hello nodes in each are handling roughly 20% of your traffic.</span></span> <span data-ttu-id="89a89-178">Se você precisar tootake para baixo desse domínio de atualização para uma atualização, o que a carga geralmente precisa toogo em algum lugar.</span><span class="sxs-lookup"><span data-stu-id="89a89-178">If you need tootake down that Upgrade Domain for an upgrade, that load usually needs toogo somewhere.</span></span> <span data-ttu-id="89a89-179">Como você tem quatro domínios de atualização restantes, cada um deve ter espaço para aproximadamente 5% do total de tráfego hello.</span><span class="sxs-lookup"><span data-stu-id="89a89-179">Since you have four remaining Upgrade Domains, each must have room for about 5% of hello total traffic.</span></span> <span data-ttu-id="89a89-180">Domínios de atualização mais significa que você precise de menos buffer em nós Olá cluster hello.</span><span class="sxs-lookup"><span data-stu-id="89a89-180">More Upgrade Domains means you need less buffer on hello nodes in hello cluster.</span></span> <span data-ttu-id="89a89-181">Por exemplo, imagine que você tivesse 10 domínios de atualização.</span><span class="sxs-lookup"><span data-stu-id="89a89-181">For example, consider if you had 10 Upgrade Domains instead.</span></span> <span data-ttu-id="89a89-182">Nesse caso, cada UD apenas manipula cerca de 10% do total do tráfego de saudação.</span><span class="sxs-lookup"><span data-stu-id="89a89-182">In that case, each UD would only be handling about 10% of hello total traffic.</span></span> <span data-ttu-id="89a89-183">Quando uma atualização percorre cluster hello, cada domínio apenas necessário espaço toohave 1.1 cerca de % do total de tráfego hello.</span><span class="sxs-lookup"><span data-stu-id="89a89-183">When an upgrade steps through hello cluster, each domain would only need toohave room for about 1.1% of hello total traffic.</span></span> <span data-ttu-id="89a89-184">Domínios de atualização mais geralmente permitem toorun seus nós em maior utilização, desde que você precisa de capacidade menor reservada.</span><span class="sxs-lookup"><span data-stu-id="89a89-184">More Upgrade Domains generally allow you toorun your nodes at higher utilization, since you need less reserved capacity.</span></span> <span data-ttu-id="89a89-185">Olá mesmo é verdadeiro para domínios de falha.</span><span class="sxs-lookup"><span data-stu-id="89a89-185">hello same is true for Fault Domains.</span></span>  

<span data-ttu-id="89a89-186">desvantagem de saudação de ter vários domínios de atualização é que atualizações tendem tootake mais.</span><span class="sxs-lookup"><span data-stu-id="89a89-186">hello downside of having many Upgrade Domains is that upgrades tend tootake longer.</span></span> <span data-ttu-id="89a89-187">Malha do serviço espera um curto período de tempo depois de um domínio de atualização é concluído e executa verificações antes de iniciar tooupgrade Olá próximo.</span><span class="sxs-lookup"><span data-stu-id="89a89-187">Service Fabric waits a short period of time after an Upgrade Domain is completed and performs checks before starting tooupgrade hello next one.</span></span> <span data-ttu-id="89a89-188">Esses atrasos habilitar detectando problemas introduzidos pela atualização Olá antes Olá atualização continua.</span><span class="sxs-lookup"><span data-stu-id="89a89-188">These delays enable detecting issues introduced by hello upgrade before hello upgrade proceeds.</span></span> <span data-ttu-id="89a89-189">compensação de saudação é aceitável, porque evita que as alterações incorretas afetar muito do serviço de saudação de cada vez.</span><span class="sxs-lookup"><span data-stu-id="89a89-189">hello tradeoff is acceptable because it prevents bad changes from affecting too much of hello service at a time.</span></span>

<span data-ttu-id="89a89-190">Ter um número muito reduzido de domínios de atualização tem muitos efeitos negativos – enquanto cada domínio de atualização individual fica inoperante e é atualizado, uma grande parte de sua capacidade geral fica indisponível.</span><span class="sxs-lookup"><span data-stu-id="89a89-190">Too few Upgrade Domains has many negative side effects – while each individual Upgrade Domain is down and being upgraded a large portion of your overall capacity is unavailable.</span></span> <span data-ttu-id="89a89-191">Por exemplo, se tiver apenas três domínios de atualização, você desativará cerca de um terço de sua capacidade geral de serviço ou de cluster de uma vez.</span><span class="sxs-lookup"><span data-stu-id="89a89-191">For example, if you only have three Upgrade Domains you are taking down about 1/3 of your overall service or cluster capacity at a time.</span></span> <span data-ttu-id="89a89-192">Ter grande parte do seu serviço para baixo de uma vez não é desejável, desde que você tem capacidade suficiente toohave restante de saudação da sua carga de trabalho do cluster toohandle hello.</span><span class="sxs-lookup"><span data-stu-id="89a89-192">Having so much of your service down at once isn’t desirable since you have toohave enough capacity in hello rest of your cluster toohandle hello workload.</span></span> <span data-ttu-id="89a89-193">Manter esse buffer significa que, durante a operação normal, esses nós ficam menos carregados do que ficariam em caso contrário.</span><span class="sxs-lookup"><span data-stu-id="89a89-193">Maintaining that buffer means that during normal operation those nodes are less loaded than they would be otherwise.</span></span> <span data-ttu-id="89a89-194">Isso aumenta o custo de saudação da execução do seu serviço.</span><span class="sxs-lookup"><span data-stu-id="89a89-194">This increases hello cost of running your service.</span></span>

<span data-ttu-id="89a89-195">Não há nenhum limite real toohello número total de falhas ou domínios de atualização em um ambiente ou restrições em como eles se sobrepõem.</span><span class="sxs-lookup"><span data-stu-id="89a89-195">There’s no real limit toohello total number of fault or Upgrade Domains in an environment, or constraints on how they overlap.</span></span> <span data-ttu-id="89a89-196">Dito isso, há vários padrões comuns:</span><span class="sxs-lookup"><span data-stu-id="89a89-196">That said, there are several common patterns:</span></span>

- <span data-ttu-id="89a89-197">Domínios de falha e domínios de atualização mapeados 1:1</span><span class="sxs-lookup"><span data-stu-id="89a89-197">Fault Domains and Upgrade Domains mapped 1:1</span></span>
- <span data-ttu-id="89a89-198">Um domínio de atualização por nó (instância de sistema operacional física ou virtual)</span><span class="sxs-lookup"><span data-stu-id="89a89-198">One Upgrade Domain per Node (physical or virtual OS instance)</span></span>
- <span data-ttu-id="89a89-199">Um modelo de "distribuído" ou "matriz" onde Olá domínios de falha e domínios de atualização formam uma matriz com máquinas geralmente executar diagonais Olá</span><span class="sxs-lookup"><span data-stu-id="89a89-199">A “striped” or “matrix” model where hello Fault Domains and Upgrade Domains form a matrix with machines usually running down hello diagonals</span></span>

<span data-ttu-id="89a89-200"><center>
![Layouts de domínios de falha e de atualização][Image4]
</center></span><span class="sxs-lookup"><span data-stu-id="89a89-200"><center>
![Fault and Upgrade Domain Layouts][Image4]
</center></span></span>

<span data-ttu-id="89a89-201">Não há que nenhum melhor responder qual toochoose de layout, cada um tem algumas vantagens e desvantagens.</span><span class="sxs-lookup"><span data-stu-id="89a89-201">There’s no best answer which layout toochoose, each has some pros and cons.</span></span> <span data-ttu-id="89a89-202">Por exemplo, o modelo de 1FD:1UD de saudação é simple tooset backup.</span><span class="sxs-lookup"><span data-stu-id="89a89-202">For example, hello 1FD:1UD model is simple tooset up.</span></span> <span data-ttu-id="89a89-203">Olá, domínio de atualização 1 por modelo de nó é mais parecida com o que as pessoas são usadas para.</span><span class="sxs-lookup"><span data-stu-id="89a89-203">hello 1 Upgrade Domain per Node model is most like what people are used to.</span></span> <span data-ttu-id="89a89-204">Durante atualizações, cada nó é atualizado de forma independente.</span><span class="sxs-lookup"><span data-stu-id="89a89-204">During upgrades each node is updated independently.</span></span> <span data-ttu-id="89a89-205">Isso é semelhante toohow pequenos conjuntos de máquinas foram atualizados manualmente no hello anterior.</span><span class="sxs-lookup"><span data-stu-id="89a89-205">This is similar toohow small sets of machines were upgraded manually in hello past.</span></span> 

<span data-ttu-id="89a89-206">modelo mais comum de saudação é matriz Olá FD/UD onde hello FDs e UDs formam uma tabela e nós são colocados ao longo Olá diagonal.</span><span class="sxs-lookup"><span data-stu-id="89a89-206">hello most common model is hello FD/UD matrix, where hello FDs and UDs form a table and nodes are placed starting along hello diagonal.</span></span> <span data-ttu-id="89a89-207">Este é o modelo de saudação usado por padrão em clusters de malha do serviço no Azure.</span><span class="sxs-lookup"><span data-stu-id="89a89-207">This is hello model used by default in Service Fabric clusters in Azure.</span></span> <span data-ttu-id="89a89-208">Para clusters com vários nós, tudo o que acaba parecida Olá matriz densa padrão acima.</span><span class="sxs-lookup"><span data-stu-id="89a89-208">For clusters with many nodes everything ends up looking like hello dense matrix pattern above.</span></span>

## <a name="fault-and-upgrade-domain-constraints-and-resulting-behavior"></a><span data-ttu-id="89a89-209">Restrições de domínio de falha e de atualização e o comportamento resultante</span><span class="sxs-lookup"><span data-stu-id="89a89-209">Fault and Upgrade Domain constraints and resulting behavior</span></span>
<span data-ttu-id="89a89-210">Olá Gerenciador de recursos do Cluster trata desejo Olá tookeep um serviço balanceado em domínios de falha e atualização como uma restrição.</span><span class="sxs-lookup"><span data-stu-id="89a89-210">hello Cluster Resource Manager treats hello desire tookeep a service balanced across fault and Upgrade Domains as a constraint.</span></span> <span data-ttu-id="89a89-211">Você pode encontrar mais informações sobre restrições [neste artigo](service-fabric-cluster-resource-manager-management-integration.md).</span><span class="sxs-lookup"><span data-stu-id="89a89-211">You can find out more about constraints in [this article](service-fabric-cluster-resource-manager-management-integration.md).</span></span> <span data-ttu-id="89a89-212">Olá estado de restrições de falha e atualização do domínio: "para uma partição de determinado serviço nunca deverá haver uma diferença *maior do que um* no número de saudação de objetos de serviço (instâncias de serviço sem monitoração de estado ou réplicas com monitoração de estado do serviço) entre dois domínios."</span><span class="sxs-lookup"><span data-stu-id="89a89-212">hello Fault and Upgrade Domain constraints state: "For a given service partition there should never be a difference *greater than one* in hello number of service objects (stateless service instances or stateful service replicas) between two domains."</span></span> <span data-ttu-id="89a89-213">Isso impede determinados movimentos ou disposições que violam essa restrição.</span><span class="sxs-lookup"><span data-stu-id="89a89-213">This prevents certain moves or arrangements that violate this constraint.</span></span>

<span data-ttu-id="89a89-214">Vejamos um exemplo.</span><span class="sxs-lookup"><span data-stu-id="89a89-214">Let's look at one example.</span></span> <span data-ttu-id="89a89-215">Digamos que temos um cluster com seis nós, configurados com cinco domínios de falha e cinco domínios de atualização.</span><span class="sxs-lookup"><span data-stu-id="89a89-215">Let's say that we have a cluster with six nodes, configured with five Fault Domains and five Upgrade Domains.</span></span>

|  | <span data-ttu-id="89a89-216">FD0</span><span class="sxs-lookup"><span data-stu-id="89a89-216">FD0</span></span> | <span data-ttu-id="89a89-217">FD1</span><span class="sxs-lookup"><span data-stu-id="89a89-217">FD1</span></span> | <span data-ttu-id="89a89-218">FD2</span><span class="sxs-lookup"><span data-stu-id="89a89-218">FD2</span></span> | <span data-ttu-id="89a89-219">FD3</span><span class="sxs-lookup"><span data-stu-id="89a89-219">FD3</span></span> | <span data-ttu-id="89a89-220">FD4</span><span class="sxs-lookup"><span data-stu-id="89a89-220">FD4</span></span> |
| --- |:---:|:---:|:---:|:---:|:---:|
| <span data-ttu-id="89a89-221">**UD0**</span><span class="sxs-lookup"><span data-stu-id="89a89-221">**UD0**</span></span> |<span data-ttu-id="89a89-222">N1</span><span class="sxs-lookup"><span data-stu-id="89a89-222">N1</span></span> | | | | |
| <span data-ttu-id="89a89-223">**UD1**</span><span class="sxs-lookup"><span data-stu-id="89a89-223">**UD1**</span></span> |<span data-ttu-id="89a89-224">N6</span><span class="sxs-lookup"><span data-stu-id="89a89-224">N6</span></span> |<span data-ttu-id="89a89-225">N2</span><span class="sxs-lookup"><span data-stu-id="89a89-225">N2</span></span> | | | |
| <span data-ttu-id="89a89-226">**UD2**</span><span class="sxs-lookup"><span data-stu-id="89a89-226">**UD2**</span></span> | | |<span data-ttu-id="89a89-227">N3</span><span class="sxs-lookup"><span data-stu-id="89a89-227">N3</span></span> | | |
| <span data-ttu-id="89a89-228">**UD3**</span><span class="sxs-lookup"><span data-stu-id="89a89-228">**UD3**</span></span> | | | |<span data-ttu-id="89a89-229">N4</span><span class="sxs-lookup"><span data-stu-id="89a89-229">N4</span></span> | |
| <span data-ttu-id="89a89-230">**UD4**</span><span class="sxs-lookup"><span data-stu-id="89a89-230">**UD4**</span></span> | | | | |<span data-ttu-id="89a89-231">N5</span><span class="sxs-lookup"><span data-stu-id="89a89-231">N5</span></span> |

<span data-ttu-id="89a89-232">Agora, digamos que nós criemos um serviço com um TargetReplicaSetSize (ou, para um serviço sem estado, um InstanceCount) igual a cinco.</span><span class="sxs-lookup"><span data-stu-id="89a89-232">Now let's say that we create a service with a TargetReplicaSetSize (or, for a stateless service an InstanceCount) of five.</span></span> <span data-ttu-id="89a89-233">réplicas Olá parar em N1 N5.</span><span class="sxs-lookup"><span data-stu-id="89a89-233">hello replicas land on N1-N5.</span></span> <span data-ttu-id="89a89-234">Na verdade, N6 nunca será usado, independentemente de quantos serviços como este você criar.</span><span class="sxs-lookup"><span data-stu-id="89a89-234">In fact, N6 is never used no matter how many services like this you create.</span></span> <span data-ttu-id="89a89-235">Mas por quê?</span><span class="sxs-lookup"><span data-stu-id="89a89-235">But why?</span></span> <span data-ttu-id="89a89-236">Vamos examinar a diferença de saudação entre layout atual hello e o que aconteceria se N6 for escolhida.</span><span class="sxs-lookup"><span data-stu-id="89a89-236">Let's look at hello difference between hello current layout and what would happen if N6 is chosen.</span></span>

<span data-ttu-id="89a89-237">Aqui está o layout de saudação nós temos e Olá número total de réplicas por falha e atualização do domínio:</span><span class="sxs-lookup"><span data-stu-id="89a89-237">Here's hello layout we got and hello total number of replicas per Fault and Upgrade Domain:</span></span>

|  | <span data-ttu-id="89a89-238">FD0</span><span class="sxs-lookup"><span data-stu-id="89a89-238">FD0</span></span> | <span data-ttu-id="89a89-239">FD1</span><span class="sxs-lookup"><span data-stu-id="89a89-239">FD1</span></span> | <span data-ttu-id="89a89-240">FD2</span><span class="sxs-lookup"><span data-stu-id="89a89-240">FD2</span></span> | <span data-ttu-id="89a89-241">FD3</span><span class="sxs-lookup"><span data-stu-id="89a89-241">FD3</span></span> | <span data-ttu-id="89a89-242">FD4</span><span class="sxs-lookup"><span data-stu-id="89a89-242">FD4</span></span> | <span data-ttu-id="89a89-243">UDTotal</span><span class="sxs-lookup"><span data-stu-id="89a89-243">UDTotal</span></span> |
| --- |:---:|:---:|:---:|:---:|:---:|:---:|
| <span data-ttu-id="89a89-244">**UD0**</span><span class="sxs-lookup"><span data-stu-id="89a89-244">**UD0**</span></span> |<span data-ttu-id="89a89-245">R1</span><span class="sxs-lookup"><span data-stu-id="89a89-245">R1</span></span> | | | | |<span data-ttu-id="89a89-246">1</span><span class="sxs-lookup"><span data-stu-id="89a89-246">1</span></span> |
| <span data-ttu-id="89a89-247">**UD1**</span><span class="sxs-lookup"><span data-stu-id="89a89-247">**UD1**</span></span> | |<span data-ttu-id="89a89-248">R2</span><span class="sxs-lookup"><span data-stu-id="89a89-248">R2</span></span> | | | |<span data-ttu-id="89a89-249">1</span><span class="sxs-lookup"><span data-stu-id="89a89-249">1</span></span> |
| <span data-ttu-id="89a89-250">**UD2**</span><span class="sxs-lookup"><span data-stu-id="89a89-250">**UD2**</span></span> | | |<span data-ttu-id="89a89-251">R3</span><span class="sxs-lookup"><span data-stu-id="89a89-251">R3</span></span> | | |<span data-ttu-id="89a89-252">1</span><span class="sxs-lookup"><span data-stu-id="89a89-252">1</span></span> |
| <span data-ttu-id="89a89-253">**UD3**</span><span class="sxs-lookup"><span data-stu-id="89a89-253">**UD3**</span></span> | | | |<span data-ttu-id="89a89-254">R4</span><span class="sxs-lookup"><span data-stu-id="89a89-254">R4</span></span> | |<span data-ttu-id="89a89-255">1</span><span class="sxs-lookup"><span data-stu-id="89a89-255">1</span></span> |
| <span data-ttu-id="89a89-256">**UD4**</span><span class="sxs-lookup"><span data-stu-id="89a89-256">**UD4**</span></span> | | | | |<span data-ttu-id="89a89-257">R5</span><span class="sxs-lookup"><span data-stu-id="89a89-257">R5</span></span> |<span data-ttu-id="89a89-258">1</span><span class="sxs-lookup"><span data-stu-id="89a89-258">1</span></span> |
| <span data-ttu-id="89a89-259">**FDTotal**</span><span class="sxs-lookup"><span data-stu-id="89a89-259">**FDTotal**</span></span> |<span data-ttu-id="89a89-260">1</span><span class="sxs-lookup"><span data-stu-id="89a89-260">1</span></span> |<span data-ttu-id="89a89-261">1</span><span class="sxs-lookup"><span data-stu-id="89a89-261">1</span></span> |<span data-ttu-id="89a89-262">1</span><span class="sxs-lookup"><span data-stu-id="89a89-262">1</span></span> |<span data-ttu-id="89a89-263">1</span><span class="sxs-lookup"><span data-stu-id="89a89-263">1</span></span> |<span data-ttu-id="89a89-264">1</span><span class="sxs-lookup"><span data-stu-id="89a89-264">1</span></span> |- |

<span data-ttu-id="89a89-265">Este layout é balanceado em termos de nós por domínio de falha e domínio de atualização.</span><span class="sxs-lookup"><span data-stu-id="89a89-265">This layout is balanced in terms of nodes per Fault Domain and Upgrade Domain.</span></span> <span data-ttu-id="89a89-266">Ele também é equilibrado em termos de número de saudação de réplicas por falha e atualização do domínio.</span><span class="sxs-lookup"><span data-stu-id="89a89-266">It is also balanced in terms of hello number of replicas per Fault and Upgrade Domain.</span></span> <span data-ttu-id="89a89-267">Cada domínio tem Olá o mesmo número de nós e Olá o mesmo número de réplicas.</span><span class="sxs-lookup"><span data-stu-id="89a89-267">Each domain has hello same number of nodes and hello same number of replicas.</span></span>

<span data-ttu-id="89a89-268">Agora, vamos ver o que aconteceria se tivéssemos usado N6 em vez de N2.</span><span class="sxs-lookup"><span data-stu-id="89a89-268">Now, let's look at what would happen if we'd used N6 instead of N2.</span></span> <span data-ttu-id="89a89-269">Como seriam réplicas Olá ser distribuídas em seguida?</span><span class="sxs-lookup"><span data-stu-id="89a89-269">How would hello replicas be distributed then?</span></span>

|  | <span data-ttu-id="89a89-270">FD0</span><span class="sxs-lookup"><span data-stu-id="89a89-270">FD0</span></span> | <span data-ttu-id="89a89-271">FD1</span><span class="sxs-lookup"><span data-stu-id="89a89-271">FD1</span></span> | <span data-ttu-id="89a89-272">FD2</span><span class="sxs-lookup"><span data-stu-id="89a89-272">FD2</span></span> | <span data-ttu-id="89a89-273">FD3</span><span class="sxs-lookup"><span data-stu-id="89a89-273">FD3</span></span> | <span data-ttu-id="89a89-274">FD4</span><span class="sxs-lookup"><span data-stu-id="89a89-274">FD4</span></span> | <span data-ttu-id="89a89-275">UDTotal</span><span class="sxs-lookup"><span data-stu-id="89a89-275">UDTotal</span></span> |
| --- |:---:|:---:|:---:|:---:|:---:|:---:|
| <span data-ttu-id="89a89-276">**UD0**</span><span class="sxs-lookup"><span data-stu-id="89a89-276">**UD0**</span></span> |<span data-ttu-id="89a89-277">R1</span><span class="sxs-lookup"><span data-stu-id="89a89-277">R1</span></span> | | | | |<span data-ttu-id="89a89-278">1</span><span class="sxs-lookup"><span data-stu-id="89a89-278">1</span></span> |
| <span data-ttu-id="89a89-279">**UD1**</span><span class="sxs-lookup"><span data-stu-id="89a89-279">**UD1**</span></span> |<span data-ttu-id="89a89-280">R5</span><span class="sxs-lookup"><span data-stu-id="89a89-280">R5</span></span> | | | | |<span data-ttu-id="89a89-281">1</span><span class="sxs-lookup"><span data-stu-id="89a89-281">1</span></span> |
| <span data-ttu-id="89a89-282">**UD2**</span><span class="sxs-lookup"><span data-stu-id="89a89-282">**UD2**</span></span> | | |<span data-ttu-id="89a89-283">R2</span><span class="sxs-lookup"><span data-stu-id="89a89-283">R2</span></span> | | |<span data-ttu-id="89a89-284">1</span><span class="sxs-lookup"><span data-stu-id="89a89-284">1</span></span> |
| <span data-ttu-id="89a89-285">**UD3**</span><span class="sxs-lookup"><span data-stu-id="89a89-285">**UD3**</span></span> | | | |<span data-ttu-id="89a89-286">R3</span><span class="sxs-lookup"><span data-stu-id="89a89-286">R3</span></span> | |<span data-ttu-id="89a89-287">1</span><span class="sxs-lookup"><span data-stu-id="89a89-287">1</span></span> |
| <span data-ttu-id="89a89-288">**UD4**</span><span class="sxs-lookup"><span data-stu-id="89a89-288">**UD4**</span></span> | | | | |<span data-ttu-id="89a89-289">R4</span><span class="sxs-lookup"><span data-stu-id="89a89-289">R4</span></span> |<span data-ttu-id="89a89-290">1</span><span class="sxs-lookup"><span data-stu-id="89a89-290">1</span></span> |
| <span data-ttu-id="89a89-291">**FDTotal**</span><span class="sxs-lookup"><span data-stu-id="89a89-291">**FDTotal**</span></span> |<span data-ttu-id="89a89-292">2</span><span class="sxs-lookup"><span data-stu-id="89a89-292">2</span></span> |<span data-ttu-id="89a89-293">0</span><span class="sxs-lookup"><span data-stu-id="89a89-293">0</span></span> |<span data-ttu-id="89a89-294">1</span><span class="sxs-lookup"><span data-stu-id="89a89-294">1</span></span> |<span data-ttu-id="89a89-295">1</span><span class="sxs-lookup"><span data-stu-id="89a89-295">1</span></span> |<span data-ttu-id="89a89-296">1</span><span class="sxs-lookup"><span data-stu-id="89a89-296">1</span></span> |- |

<span data-ttu-id="89a89-297">Esse layout viola a nossa definição de restrição de domínio de falha de saudação.</span><span class="sxs-lookup"><span data-stu-id="89a89-297">This layout violates our definition for hello Fault Domain constraint.</span></span> <span data-ttu-id="89a89-298">FD0 tem duas réplicas, enquanto FD1 tem zero, fazer diferença Olá entre FD0 e FD1 um total de dois.</span><span class="sxs-lookup"><span data-stu-id="89a89-298">FD0 has two replicas, while FD1 has zero, making hello difference between FD0 and FD1 a total of two.</span></span> <span data-ttu-id="89a89-299">Olá Gerenciador de recursos de Cluster não permite essa organização.</span><span class="sxs-lookup"><span data-stu-id="89a89-299">hello Cluster Resource Manager does not allow this arrangement.</span></span> <span data-ttu-id="89a89-300">Da mesma forma, se escolhêssemos N2 e N6 (em vez de N1 e N2), teríamos:</span><span class="sxs-lookup"><span data-stu-id="89a89-300">Similarly if we picked N2 and N6 (instead of N1 and N2) we'd get:</span></span>

|  | <span data-ttu-id="89a89-301">FD0</span><span class="sxs-lookup"><span data-stu-id="89a89-301">FD0</span></span> | <span data-ttu-id="89a89-302">FD1</span><span class="sxs-lookup"><span data-stu-id="89a89-302">FD1</span></span> | <span data-ttu-id="89a89-303">FD2</span><span class="sxs-lookup"><span data-stu-id="89a89-303">FD2</span></span> | <span data-ttu-id="89a89-304">FD3</span><span class="sxs-lookup"><span data-stu-id="89a89-304">FD3</span></span> | <span data-ttu-id="89a89-305">FD4</span><span class="sxs-lookup"><span data-stu-id="89a89-305">FD4</span></span> | <span data-ttu-id="89a89-306">UDTotal</span><span class="sxs-lookup"><span data-stu-id="89a89-306">UDTotal</span></span> |
| --- |:---:|:---:|:---:|:---:|:---:|:---:|
| <span data-ttu-id="89a89-307">**UD0**</span><span class="sxs-lookup"><span data-stu-id="89a89-307">**UD0**</span></span> | | | | | |<span data-ttu-id="89a89-308">0</span><span class="sxs-lookup"><span data-stu-id="89a89-308">0</span></span> |
| <span data-ttu-id="89a89-309">**UD1**</span><span class="sxs-lookup"><span data-stu-id="89a89-309">**UD1**</span></span> |<span data-ttu-id="89a89-310">R5</span><span class="sxs-lookup"><span data-stu-id="89a89-310">R5</span></span> |<span data-ttu-id="89a89-311">R1</span><span class="sxs-lookup"><span data-stu-id="89a89-311">R1</span></span> | | | |<span data-ttu-id="89a89-312">2</span><span class="sxs-lookup"><span data-stu-id="89a89-312">2</span></span> |
| <span data-ttu-id="89a89-313">**UD2**</span><span class="sxs-lookup"><span data-stu-id="89a89-313">**UD2**</span></span> | | |<span data-ttu-id="89a89-314">R2</span><span class="sxs-lookup"><span data-stu-id="89a89-314">R2</span></span> | | |<span data-ttu-id="89a89-315">1</span><span class="sxs-lookup"><span data-stu-id="89a89-315">1</span></span> |
| <span data-ttu-id="89a89-316">**UD3**</span><span class="sxs-lookup"><span data-stu-id="89a89-316">**UD3**</span></span> | | | |<span data-ttu-id="89a89-317">R3</span><span class="sxs-lookup"><span data-stu-id="89a89-317">R3</span></span> | |<span data-ttu-id="89a89-318">1</span><span class="sxs-lookup"><span data-stu-id="89a89-318">1</span></span> |
| <span data-ttu-id="89a89-319">**UD4**</span><span class="sxs-lookup"><span data-stu-id="89a89-319">**UD4**</span></span> | | | | |<span data-ttu-id="89a89-320">R4</span><span class="sxs-lookup"><span data-stu-id="89a89-320">R4</span></span> |<span data-ttu-id="89a89-321">1</span><span class="sxs-lookup"><span data-stu-id="89a89-321">1</span></span> |
| <span data-ttu-id="89a89-322">**FDTotal**</span><span class="sxs-lookup"><span data-stu-id="89a89-322">**FDTotal**</span></span> |<span data-ttu-id="89a89-323">1</span><span class="sxs-lookup"><span data-stu-id="89a89-323">1</span></span> |<span data-ttu-id="89a89-324">1</span><span class="sxs-lookup"><span data-stu-id="89a89-324">1</span></span> |<span data-ttu-id="89a89-325">1</span><span class="sxs-lookup"><span data-stu-id="89a89-325">1</span></span> |<span data-ttu-id="89a89-326">1</span><span class="sxs-lookup"><span data-stu-id="89a89-326">1</span></span> |<span data-ttu-id="89a89-327">1</span><span class="sxs-lookup"><span data-stu-id="89a89-327">1</span></span> |- |

<span data-ttu-id="89a89-328">Este layout é equilibrado em termos de domínios de falha.</span><span class="sxs-lookup"><span data-stu-id="89a89-328">This layout is balanced in terms of Fault Domains.</span></span> <span data-ttu-id="89a89-329">No entanto, agora ele está violando restrição de domínio de atualização de saudação.</span><span class="sxs-lookup"><span data-stu-id="89a89-329">However, now it's violating hello Upgrade Domain constraint.</span></span> <span data-ttu-id="89a89-330">Isso acontece porque UD0 tem zero réplicas, enquanto UD1 tem cinco.</span><span class="sxs-lookup"><span data-stu-id="89a89-330">This is because UD0 has zero replicas while UD1 has two.</span></span> <span data-ttu-id="89a89-331">Portanto, este layout também é inválido e não ser separado por Olá Gerenciador de recursos de Cluster.</span><span class="sxs-lookup"><span data-stu-id="89a89-331">Therefore, this layout is also invalid and won't be picked by hello Cluster Resource Manager.</span></span> 

## <a name="configuring-fault-and-upgrade-domains"></a><span data-ttu-id="89a89-332">Configurando domínios de falha e atualização</span><span class="sxs-lookup"><span data-stu-id="89a89-332">Configuring fault and Upgrade Domains</span></span>
<span data-ttu-id="89a89-333">A definição de domínios de falha e domínios de atualização é feita automaticamente em implantações hospedadas do Azure Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="89a89-333">Defining Fault Domains and Upgrade Domains is done automatically in Azure hosted Service Fabric deployments.</span></span> <span data-ttu-id="89a89-334">Service Fabric seleciona e usa as informações de ambiente de saudação do Azure.</span><span class="sxs-lookup"><span data-stu-id="89a89-334">Service Fabric picks up and uses hello environment information from Azure.</span></span>

<span data-ttu-id="89a89-335">Se você estiver criando seu próprio cluster (ou toorun uma topologia específica em desenvolvimento), você pode fornecer informações de domínio de falha e atualização do domínio Olá por conta própria.</span><span class="sxs-lookup"><span data-stu-id="89a89-335">If you’re creating your own cluster (or want toorun a particular topology in development), you can provide hello Fault Domain and Upgrade Domain information yourself.</span></span> <span data-ttu-id="89a89-336">Neste exemplo, definimos um cluster de desenvolvimento local de nove nós que abrange três "datacenters" (cada um com três racks).</span><span class="sxs-lookup"><span data-stu-id="89a89-336">In this example, we define a nine node local development cluster that spans three “datacenters” (each with three racks).</span></span> <span data-ttu-id="89a89-337">Este cluster também tem três domínios de atualização distribuídos entre esses três datacenters.</span><span class="sxs-lookup"><span data-stu-id="89a89-337">This cluster also has three Upgrade Domains striped across those three datacenters.</span></span> <span data-ttu-id="89a89-338">Um exemplo de configuração de saudação está abaixo:</span><span class="sxs-lookup"><span data-stu-id="89a89-338">An example of hello configuration is below:</span></span> 

<span data-ttu-id="89a89-339">ClusterManifest.xml</span><span class="sxs-lookup"><span data-stu-id="89a89-339">ClusterManifest.xml</span></span>

```xml
  <Infrastructure>
    <!-- IsScaleMin indicates that this cluster runs on one-box /one single server -->
    <WindowsServer IsScaleMin="true">
      <NodeList>
        <Node NodeName="Node01" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType01" FaultDomain="fd:/DC01/Rack01" UpgradeDomain="UpgradeDomain1" IsSeedNode="true" />
        <Node NodeName="Node02" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType02" FaultDomain="fd:/DC01/Rack02" UpgradeDomain="UpgradeDomain2" IsSeedNode="true" />
        <Node NodeName="Node03" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType03" FaultDomain="fd:/DC01/Rack03" UpgradeDomain="UpgradeDomain3" IsSeedNode="true" />
        <Node NodeName="Node04" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType04" FaultDomain="fd:/DC02/Rack01" UpgradeDomain="UpgradeDomain1" IsSeedNode="true" />
        <Node NodeName="Node05" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType05" FaultDomain="fd:/DC02/Rack02" UpgradeDomain="UpgradeDomain2" IsSeedNode="true" />
        <Node NodeName="Node06" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType06" FaultDomain="fd:/DC02/Rack03" UpgradeDomain="UpgradeDomain3" IsSeedNode="true" />
        <Node NodeName="Node07" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType07" FaultDomain="fd:/DC03/Rack01" UpgradeDomain="UpgradeDomain1" IsSeedNode="true" />
        <Node NodeName="Node08" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType08" FaultDomain="fd:/DC03/Rack02" UpgradeDomain="UpgradeDomain2" IsSeedNode="true" />
        <Node NodeName="Node09" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType09" FaultDomain="fd:/DC03/Rack03" UpgradeDomain="UpgradeDomain3" IsSeedNode="true" />
      </NodeList>
    </WindowsServer>
  </Infrastructure>
```

<span data-ttu-id="89a89-340">por meio de ClusterConfig.json para implantações autônomas</span><span class="sxs-lookup"><span data-stu-id="89a89-340">via ClusterConfig.json for Standalone deployments</span></span>

```json
"nodes": [
  {
    "nodeName": "vm1",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc1/r0",
    "upgradeDomain": "UD1"
  },
  {
    "nodeName": "vm2",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc1/r0",
    "upgradeDomain": "UD2"
  },
  {
    "nodeName": "vm3",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc1/r0",
    "upgradeDomain": "UD3"
  },
  {
    "nodeName": "vm4",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc2/r0",
    "upgradeDomain": "UD1"
  },
  {
    "nodeName": "vm5",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc2/r0",
    "upgradeDomain": "UD2"
  },
  {
    "nodeName": "vm6",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc2/r0",
    "upgradeDomain": "UD3"
  },
  {
    "nodeName": "vm7",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc3/r0",
    "upgradeDomain": "UD1"
  },
  {
    "nodeName": "vm8",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc3/r0",
    "upgradeDomain": "UD2"
  },
  {
    "nodeName": "vm9",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc3/r0",
    "upgradeDomain": "UD3"
  }
],
```

> [!NOTE]
> <span data-ttu-id="89a89-341">Ao definir clusters por meio do Azure Resource Manager, domínios de falha e domínios de atualização são atribuídos pelo Azure.</span><span class="sxs-lookup"><span data-stu-id="89a89-341">When defining clusters via Azure Resource Manager, Fault Domains and Upgrade Domains are assigned by Azure.</span></span> <span data-ttu-id="89a89-342">Portanto, a definição de saudação de seus tipos de nós e os conjuntos de escala de máquina Virtual no modelo do Azure Resource Manager não incluir informações de atualização do domínio ou domínio de falha.</span><span class="sxs-lookup"><span data-stu-id="89a89-342">Therefore, hello definition of your Node Types and Virtual Machine Scale Sets in your Azure Resource Manager template does not include Fault Domain or Upgrade Domain information.</span></span>
>

## <a name="node-properties-and-placement-constraints"></a><span data-ttu-id="89a89-343">Restrições de posicionamento e propriedades do nó</span><span class="sxs-lookup"><span data-stu-id="89a89-343">Node properties and placement constraints</span></span>
<span data-ttu-id="89a89-344">Às vezes (na verdade, a maioria do tempo de saudação), você vai tooensure toowant determinadas cargas de trabalho executados somente em determinados tipos de nós no cluster de saudação.</span><span class="sxs-lookup"><span data-stu-id="89a89-344">Sometimes (in fact, most of hello time) you’re going toowant tooensure that certain workloads run only on certain types of nodes in hello cluster.</span></span> <span data-ttu-id="89a89-345">Por exemplo, algumas cargas de trabalho podem exigir GPUs ou SSDs, enquanto outras, não.</span><span class="sxs-lookup"><span data-stu-id="89a89-345">For example, some workload may require GPUs or SSDs while others may not.</span></span> <span data-ttu-id="89a89-346">Um ótimo exemplo de direcionamento de cargas de trabalho do hardware tooparticular é quase todos os arquitetura de n camadas lá.</span><span class="sxs-lookup"><span data-stu-id="89a89-346">A great example of targeting hardware tooparticular workloads is almost every n-tier architecture out there.</span></span> <span data-ttu-id="89a89-347">Alguns computadores servem como Olá front-end ou a API que atende ao lado do aplicativo hello e são expostos toohello clientes ou Olá internet.</span><span class="sxs-lookup"><span data-stu-id="89a89-347">Certain machines serve as hello front end or API serving side of hello application and are exposed toohello clients or hello internet.</span></span> <span data-ttu-id="89a89-348">Diferentes máquinas, geralmente com recursos de hardware diferente, tratar o trabalho de saudação de camadas de computação ou armazenamento hello.</span><span class="sxs-lookup"><span data-stu-id="89a89-348">Different machines, often with different hardware resources, handle hello work of hello compute or storage layers.</span></span> <span data-ttu-id="89a89-349">Esses são normalmente _não_ diretamente expostos tooclients ou Olá da internet.</span><span class="sxs-lookup"><span data-stu-id="89a89-349">These are usually _not_ directly exposed tooclients or hello internet.</span></span> <span data-ttu-id="89a89-350">Serviço de malha espera que há casos em que as cargas de trabalho específicas necessário toorun em configurações de hardware específica.</span><span class="sxs-lookup"><span data-stu-id="89a89-350">Service Fabric expects that there are cases where particular workloads need toorun on particular hardware configurations.</span></span> <span data-ttu-id="89a89-351">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="89a89-351">For example:</span></span>

* <span data-ttu-id="89a89-352">um aplicativo de n camadas existente foi "transferido e posicionado" em um ambiente do Service Fabric</span><span class="sxs-lookup"><span data-stu-id="89a89-352">an existing n-tier application has been “lifted and shifted” into a Service Fabric environment</span></span>
* <span data-ttu-id="89a89-353">uma carga de trabalho quer toorun em hardware específico por motivos de isolamento de segurança, de desempenho ou de escala</span><span class="sxs-lookup"><span data-stu-id="89a89-353">a workload wants toorun on specific hardware for performance, scale, or security isolation reasons</span></span>
* <span data-ttu-id="89a89-354">Uma carga de trabalho deve ser isolada de outras cargas de trabalho por motivos de política ou consumo de recursos</span><span class="sxs-lookup"><span data-stu-id="89a89-354">A workload should be isolated from other workloads for policy or resource consumption reasons</span></span>

<span data-ttu-id="89a89-355">Esses tipos de configurações, de toosupport serviço malha tem uma noção de primeira classe marcas que podem ser aplicadas toonodes.</span><span class="sxs-lookup"><span data-stu-id="89a89-355">toosupport these sorts of configurations, Service Fabric has a first class notion of tags that can be applied toonodes.</span></span> <span data-ttu-id="89a89-356">Essas marcas são chamadas de **propriedades de nó**.</span><span class="sxs-lookup"><span data-stu-id="89a89-356">These tags are called **node properties**.</span></span> <span data-ttu-id="89a89-357">**Restrições de posicionamento** são instruções Olá anexado tooindividual serviços selecionados para uma ou mais propriedades de nó.</span><span class="sxs-lookup"><span data-stu-id="89a89-357">**Placement constraints** are hello statements attached tooindividual services that select for one or more node properties.</span></span> <span data-ttu-id="89a89-358">Restrições de posicionamento definem onde os serviços devem ser executados.</span><span class="sxs-lookup"><span data-stu-id="89a89-358">Placement constraints define where services should run.</span></span> <span data-ttu-id="89a89-359">conjunto de saudação de restrições é extensível - qualquer par chave/valor pode funcionar.</span><span class="sxs-lookup"><span data-stu-id="89a89-359">hello set of constraints is extensible - any key/value pair can work.</span></span> 

<span data-ttu-id="89a89-360"><center>
![Cargas de trabalho diferentes do layout do cluster][Image5]
</center></span><span class="sxs-lookup"><span data-stu-id="89a89-360"><center>
![Cluster Layout Different Workloads][Image5]
</center></span></span>

### <a name="built-in-node-properties"></a><span data-ttu-id="89a89-361">Propriedades de nó internas</span><span class="sxs-lookup"><span data-stu-id="89a89-361">Built in node properties</span></span>
<span data-ttu-id="89a89-362">Malha do serviço define algumas propriedades de nó padrão que podem ser usadas, automaticamente, sem ter que toodefine do usuário Olá-los.</span><span class="sxs-lookup"><span data-stu-id="89a89-362">Service Fabric defines some default node properties that can be used automatically without hello user having toodefine them.</span></span> <span data-ttu-id="89a89-363">Propriedades de padrão de saudação definidas em cada nó são Olá **NodeType** e hello **NodeName**.</span><span class="sxs-lookup"><span data-stu-id="89a89-363">hello default properties defined at each node are hello **NodeType** and hello **NodeName**.</span></span> <span data-ttu-id="89a89-364">Por exemplo, você poderia escrever uma restrição de posicionamento como `"(NodeType == NodeType03)"`.</span><span class="sxs-lookup"><span data-stu-id="89a89-364">So for example you could write a placement constraint as `"(NodeType == NodeType03)"`.</span></span> <span data-ttu-id="89a89-365">Geralmente encontramos NodeType toobe uma das propriedades hello mais comumente usada.</span><span class="sxs-lookup"><span data-stu-id="89a89-365">Generally we have found NodeType toobe one of hello most commonly used properties.</span></span> <span data-ttu-id="89a89-366">Ela é útil porque corresponde individualmente a um tipo de um computador.</span><span class="sxs-lookup"><span data-stu-id="89a89-366">It is useful since it corresponds 1:1 with a type of a machine.</span></span> <span data-ttu-id="89a89-367">Cada tipo de computador corresponde tooa tipo de carga de trabalho em um aplicativo de n camadas tradicional.</span><span class="sxs-lookup"><span data-stu-id="89a89-367">Each type of machine corresponds tooa type of workload in a traditional n-tier application.</span></span>

<span data-ttu-id="89a89-368"><center>
![Restrições de posicionamento e propriedades do nó][Image6]
</center></span><span class="sxs-lookup"><span data-stu-id="89a89-368"><center>
![Placement Constraints and Node Properties][Image6]
</center></span></span>

## <a name="placement-constraint-and-node-property-syntax"></a><span data-ttu-id="89a89-369">Sintaxe de restrição de posicionamento e propriedades do nó</span><span class="sxs-lookup"><span data-stu-id="89a89-369">Placement Constraint and Node Property Syntax</span></span> 
<span data-ttu-id="89a89-370">valor de saudação especificado na propriedade do nó Olá pode ser uma cadeia de caracteres, bool, ou assinado longa.</span><span class="sxs-lookup"><span data-stu-id="89a89-370">hello value specified in hello node property can be a string, bool, or signed long.</span></span> <span data-ttu-id="89a89-371">instrução Olá no serviço de saudação é chamada um posicionamento *restrição* desde que ela restringe onde Olá serviço pode ser executado no cluster de saudação.</span><span class="sxs-lookup"><span data-stu-id="89a89-371">hello statement at hello service is called a placement *constraint* since it constrains where hello service can run in hello cluster.</span></span> <span data-ttu-id="89a89-372">restrição de saudação pode ser qualquer instrução Boolean que opera em Propriedades de nó diferente de saudação em cluster hello.</span><span class="sxs-lookup"><span data-stu-id="89a89-372">hello constraint can be any Boolean statement that operates on hello different node properties in hello cluster.</span></span> <span data-ttu-id="89a89-373">seletores de válido Olá nessas instruções boolean são:</span><span class="sxs-lookup"><span data-stu-id="89a89-373">hello valid selectors in these boolean statements are:</span></span>

1) <span data-ttu-id="89a89-374">verificações condicionais para a criação de instruções</span><span class="sxs-lookup"><span data-stu-id="89a89-374">conditional checks for creating particular statements</span></span>

| <span data-ttu-id="89a89-375">Instrução</span><span class="sxs-lookup"><span data-stu-id="89a89-375">Statement</span></span> | <span data-ttu-id="89a89-376">Sintaxe</span><span class="sxs-lookup"><span data-stu-id="89a89-376">Syntax</span></span> |
| --- |:---:|
| <span data-ttu-id="89a89-377">"igual a"</span><span class="sxs-lookup"><span data-stu-id="89a89-377">"equal to"</span></span> | <span data-ttu-id="89a89-378">"=="</span><span class="sxs-lookup"><span data-stu-id="89a89-378">"=="</span></span> |
| <span data-ttu-id="89a89-379">"diferente de"</span><span class="sxs-lookup"><span data-stu-id="89a89-379">"not equal to"</span></span> | <span data-ttu-id="89a89-380">"!="</span><span class="sxs-lookup"><span data-stu-id="89a89-380">"!="</span></span> |
| <span data-ttu-id="89a89-381">"maior que"</span><span class="sxs-lookup"><span data-stu-id="89a89-381">"greater than"</span></span> | <span data-ttu-id="89a89-382">">"</span><span class="sxs-lookup"><span data-stu-id="89a89-382">">"</span></span> |
| <span data-ttu-id="89a89-383">"maior ou igual a"</span><span class="sxs-lookup"><span data-stu-id="89a89-383">"greater than or equal to"</span></span> | <span data-ttu-id="89a89-384">">="</span><span class="sxs-lookup"><span data-stu-id="89a89-384">">="</span></span> |
| <span data-ttu-id="89a89-385">"menor que"</span><span class="sxs-lookup"><span data-stu-id="89a89-385">"less than"</span></span> | <span data-ttu-id="89a89-386">"<"</span><span class="sxs-lookup"><span data-stu-id="89a89-386">"<"</span></span> |
| <span data-ttu-id="89a89-387">"menor ou igual a"</span><span class="sxs-lookup"><span data-stu-id="89a89-387">"less than or equal to"</span></span> | <span data-ttu-id="89a89-388">"<="</span><span class="sxs-lookup"><span data-stu-id="89a89-388">"<="</span></span> |

2) <span data-ttu-id="89a89-389">instruções boolianas para operações de agrupamento e lógicas</span><span class="sxs-lookup"><span data-stu-id="89a89-389">boolean statements for grouping and logical operations</span></span>

| <span data-ttu-id="89a89-390">Instrução</span><span class="sxs-lookup"><span data-stu-id="89a89-390">Statement</span></span> | <span data-ttu-id="89a89-391">Sintaxe</span><span class="sxs-lookup"><span data-stu-id="89a89-391">Syntax</span></span> |
| --- |:---:|
| <span data-ttu-id="89a89-392">"e"</span><span class="sxs-lookup"><span data-stu-id="89a89-392">"and"</span></span> | <span data-ttu-id="89a89-393">"&&"</span><span class="sxs-lookup"><span data-stu-id="89a89-393">"&&"</span></span> |
| <span data-ttu-id="89a89-394">"ou"</span><span class="sxs-lookup"><span data-stu-id="89a89-394">"or"</span></span> | <span data-ttu-id="89a89-395">"&#124;&#124;"</span><span class="sxs-lookup"><span data-stu-id="89a89-395">"&#124;&#124;"</span></span> |
| <span data-ttu-id="89a89-396">"não"</span><span class="sxs-lookup"><span data-stu-id="89a89-396">"not"</span></span> | <span data-ttu-id="89a89-397">"!"</span><span class="sxs-lookup"><span data-stu-id="89a89-397">"!"</span></span> |
| <span data-ttu-id="89a89-398">"agrupar como instrução única"</span><span class="sxs-lookup"><span data-stu-id="89a89-398">"group as single statement"</span></span> | <span data-ttu-id="89a89-399">"()"</span><span class="sxs-lookup"><span data-stu-id="89a89-399">"()"</span></span> |

<span data-ttu-id="89a89-400">Aqui estão alguns exemplos de instruções de restrição básicas.</span><span class="sxs-lookup"><span data-stu-id="89a89-400">Here are some examples of basic constraint statements.</span></span>

  * `"Value >= 5"`
  * `"NodeColor != green"`
  * `"((OneProperty < 100) || ((AnotherProperty == false) && (OneProperty >= 100)))"`

<span data-ttu-id="89a89-401">Apenas nós onde hello geral instrução de restrição de posicionamento avalia muito "True" podem ter serviço Olá colocado nela.</span><span class="sxs-lookup"><span data-stu-id="89a89-401">Only nodes where hello overall placement constraint statement evaluates too“True” can have hello service placed on it.</span></span> <span data-ttu-id="89a89-402">Os nós que não têm uma propriedade definida não correspondem a nenhuma restrição de posicionamento que contém essa propriedade.</span><span class="sxs-lookup"><span data-stu-id="89a89-402">Nodes that do not have a property defined do not match any placement constraint containing that property.</span></span>

<span data-ttu-id="89a89-403">Digamos que Olá nó propriedades foram definidas para um tipo de nó a seguir:</span><span class="sxs-lookup"><span data-stu-id="89a89-403">Let’s say that hello following node properties were defined for a given node type:</span></span>

<span data-ttu-id="89a89-404">ClusterManifest.xml</span><span class="sxs-lookup"><span data-stu-id="89a89-404">ClusterManifest.xml</span></span>

```xml
    <NodeType Name="NodeType01">
      <PlacementProperties>
        <Property Name="HasSSD" Value="true"/>
        <Property Name="NodeColor" Value="green"/>
        <Property Name="SomeProperty" Value="5"/>
      </PlacementProperties>
    </NodeType>
```

<span data-ttu-id="89a89-405">via ClusterConfig.json para implantações Autônomas ou Template.json para clusters hospedados pelo Azure.</span><span class="sxs-lookup"><span data-stu-id="89a89-405">via ClusterConfig.json for Standalone deployments or Template.json for Azure hosted clusters.</span></span> 

> [!NOTE]
> <span data-ttu-id="89a89-406">No nó do Azure Resource Manager modelo Olá tipo geralmente é parametrizado.</span><span class="sxs-lookup"><span data-stu-id="89a89-406">In your Azure Resource Manager template hello node type is usually parameterized.</span></span> <span data-ttu-id="89a89-407">Ele seria semelhante a "[parameters('vmNodeType1Name')]", em vez de "NodeType01".</span><span class="sxs-lookup"><span data-stu-id="89a89-407">It would look like "[parameters('vmNodeType1Name')]" rather than "NodeType01".</span></span>
>

```json
"nodeTypes": [
    {
        "name": "NodeType01",
        "placementProperties": {
            "HasSSD": "true",
            "NodeColor": "green",
            "SomeProperty": "5"
        },
    }
],
```

<span data-ttu-id="89a89-408">Você pode criar *restrições* de posicionamento de serviço para um serviço da seguinte forma:</span><span class="sxs-lookup"><span data-stu-id="89a89-408">You can create service placement *constraints* for a service like as follows:</span></span>

<span data-ttu-id="89a89-409">C#</span><span class="sxs-lookup"><span data-stu-id="89a89-409">C#</span></span>

```csharp
FabricClient fabricClient = new FabricClient();
StatefulServiceDescription serviceDescription = new StatefulServiceDescription();
serviceDescription.PlacementConstraints = "(HasSSD == true && SomeProperty >= 4)";
// add other required servicedescription fields
//...
await fabricClient.ServiceManager.CreateServiceAsync(serviceDescription);
```

<span data-ttu-id="89a89-410">Powershell:</span><span class="sxs-lookup"><span data-stu-id="89a89-410">Powershell:</span></span>

```posh
New-ServiceFabricService -ApplicationName $applicationName -ServiceName $serviceName -ServiceTypeName $serviceType -Stateful -MinReplicaSetSize 3 -TargetReplicaSetSize 3 -PartitionSchemeSingleton -PlacementConstraint "HasSSD == true && SomeProperty >= 4"
```

<span data-ttu-id="89a89-411">Se todos os nós do NodeType01 forem válidos, você também pode selecionar esse tipo de nó com restrição Olá "(NodeType == NodeType01)".</span><span class="sxs-lookup"><span data-stu-id="89a89-411">If all nodes of NodeType01 are valid, you can also select that node type with hello constraint "(NodeType == NodeType01)".</span></span>

<span data-ttu-id="89a89-412">Uma das coisas legais que Olá sobre restrições de posicionamento do serviço é que eles podem ser atualizados dinamicamente em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="89a89-412">One of hello cool things about a service’s placement constraints is that they can be updated dynamically during runtime.</span></span> <span data-ttu-id="89a89-413">Então se você precisar, você pode mover um serviço em cluster hello, adicionar e remover requisitos, etc. Serviço de malha cuida de assegurar que o serviço de saudação permanece e disponível mesmo quando esses tipos de alterações são feitos.</span><span class="sxs-lookup"><span data-stu-id="89a89-413">So if you need to, you can move a service around in hello cluster, add and remove requirements, etc. Service Fabric takes care of ensuring that hello service stays up and available even when these types of changes are made.</span></span>

<span data-ttu-id="89a89-414">C#:</span><span class="sxs-lookup"><span data-stu-id="89a89-414">C#:</span></span>

```csharp
StatefulServiceUpdateDescription updateDescription = new StatefulServiceUpdateDescription();
updateDescription.PlacementConstraints = "NodeType == NodeType01";
await fabricClient.ServiceManager.UpdateServiceAsync(new Uri("fabric:/app/service"), updateDescription);
```

<span data-ttu-id="89a89-415">Powershell:</span><span class="sxs-lookup"><span data-stu-id="89a89-415">Powershell:</span></span>

```posh
Update-ServiceFabricService -Stateful -ServiceName $serviceName -PlacementConstraints "NodeType == NodeType01"
```

<span data-ttu-id="89a89-416">Restrições de posicionamento são especificadas para cada instância de serviço nomeada diferente.</span><span class="sxs-lookup"><span data-stu-id="89a89-416">Placement constraints are specified for every different named service instance.</span></span> <span data-ttu-id="89a89-417">Atualizações sempre substituir saudação (substituir) que foi especificado anteriormente.</span><span class="sxs-lookup"><span data-stu-id="89a89-417">Updates always take hello place of (overwrite) what was previously specified.</span></span>

<span data-ttu-id="89a89-418">definição de cluster Olá define propriedades de saudação em um nó.</span><span class="sxs-lookup"><span data-stu-id="89a89-418">hello cluster definition defines hello properties on a node.</span></span> <span data-ttu-id="89a89-419">Alterar as propriedades de um nó requer uma atualização de configuração do cluster.</span><span class="sxs-lookup"><span data-stu-id="89a89-419">Changing a node's properties requires a cluster configuration upgrade.</span></span> <span data-ttu-id="89a89-420">Atualizar propriedades do nó requer tooreport de toorestart cada nó afetado suas propriedades de novo.</span><span class="sxs-lookup"><span data-stu-id="89a89-420">Upgrading a node's properties requires each affected node toorestart tooreport its new properties.</span></span> <span data-ttu-id="89a89-421">Essas atualizações sem interrupção são gerenciadas pelo Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="89a89-421">These rolling upgrades are managed by Service Fabric.</span></span>

## <a name="describing-and-managing-cluster-resources"></a><span data-ttu-id="89a89-422">Descrever e gerenciar Recursos de Cluster</span><span class="sxs-lookup"><span data-stu-id="89a89-422">Describing and Managing Cluster Resources</span></span>
<span data-ttu-id="89a89-423">Um dos mais importantes de trabalhos de qualquer orchestrator é toohelp de saudação gerenciar o consumo de recursos em cluster hello.</span><span class="sxs-lookup"><span data-stu-id="89a89-423">One of hello most important jobs of any orchestrator is toohelp manage resource consumption in hello cluster.</span></span> <span data-ttu-id="89a89-424">Gerenciar recursos de cluster pode significar algumas coisas diferentes.</span><span class="sxs-lookup"><span data-stu-id="89a89-424">Managing cluster resources can mean a couple of different things.</span></span> <span data-ttu-id="89a89-425">Primeiro, é necessário garantir que os computadores não sejam sobrecarregados.</span><span class="sxs-lookup"><span data-stu-id="89a89-425">First, there's ensuring that machines are not overloaded.</span></span> <span data-ttu-id="89a89-426">Isso significa garantir que eles não executem mais serviços do que conseguem tratar.</span><span class="sxs-lookup"><span data-stu-id="89a89-426">This means making sure that machines aren't running more services than they can handle.</span></span> <span data-ttu-id="89a89-427">Em segundo lugar, há balanceamento e otimização que é crítico toorunning serviços com eficiência.</span><span class="sxs-lookup"><span data-stu-id="89a89-427">Second, there's balancing and optimization which is critical toorunning services efficiently.</span></span> <span data-ttu-id="89a89-428">Custo efetivo ou desempenho confidenciais serviços não podem permitir toobe alguns nós hot enquanto outras são frios.</span><span class="sxs-lookup"><span data-stu-id="89a89-428">Cost effective or performance sensitive service offerings can't allow some nodes toobe hot while others are cold.</span></span> <span data-ttu-id="89a89-429">Nós hot levam tooresource contenção e baixo desempenho e nós frios representam desperdiçada de recursos e aumento dos custos.</span><span class="sxs-lookup"><span data-stu-id="89a89-429">Hot nodes lead tooresource contention and poor performance, and cold nodes represent wasted resources and increased costs.</span></span> 

<span data-ttu-id="89a89-430">O Service Fabric representa recursos como `Metrics`.</span><span class="sxs-lookup"><span data-stu-id="89a89-430">Service Fabric represents resources as `Metrics`.</span></span> <span data-ttu-id="89a89-431">Métricas são qualquer recurso lógico ou físico que você deseja toodescribe tooService malha.</span><span class="sxs-lookup"><span data-stu-id="89a89-431">Metrics are any logical or physical resource that you want toodescribe tooService Fabric.</span></span> <span data-ttu-id="89a89-432">Exemplos de métricas são itens como "WorkQueueDepth" ou "MemoryInMb".</span><span class="sxs-lookup"><span data-stu-id="89a89-432">Examples of metrics are things like “WorkQueueDepth” or “MemoryInMb”.</span></span> <span data-ttu-id="89a89-433">Para obter informações sobre recursos físicos de saudação que controlam a malha do serviço em nós, consulte [governança de recursos](service-fabric-resource-governance.md).</span><span class="sxs-lookup"><span data-stu-id="89a89-433">For information about hello physical resources that Service Fabric can govern on nodes, see [resource governance](service-fabric-resource-governance.md).</span></span> <span data-ttu-id="89a89-434">Para obter informações sobre como configurar métricas personalizadas e seus usos, consulte [este artigo](service-fabric-cluster-resource-manager-metrics.md)</span><span class="sxs-lookup"><span data-stu-id="89a89-434">For information on configuring custom metrics and their uses, see [this article](service-fabric-cluster-resource-manager-metrics.md)</span></span>

<span data-ttu-id="89a89-435">As métricas são diferentes das restrições de posicionamento e das propriedades de nó.</span><span class="sxs-lookup"><span data-stu-id="89a89-435">Metrics are different from placements constraints and node properties.</span></span> <span data-ttu-id="89a89-436">Propriedades de nó são descritores estáticos de nós Olá propriamente ditos.</span><span class="sxs-lookup"><span data-stu-id="89a89-436">Node properties are static descriptors of hello nodes themselves.</span></span> <span data-ttu-id="89a89-437">As métricas descrevem os recursos que os nós têm e que os serviços consomem quando são executados em um nó.</span><span class="sxs-lookup"><span data-stu-id="89a89-437">Metrics describe resources that nodes have and that services consume when they are run on a node.</span></span> <span data-ttu-id="89a89-438">Uma propriedade do nó poderia ser "HasSSD" e pode ser definida tootrue ou false.</span><span class="sxs-lookup"><span data-stu-id="89a89-438">A node property could be "HasSSD" and could be set tootrue or false.</span></span> <span data-ttu-id="89a89-439">quantidade de saudação de espaço disponível em que SSD e a quantidade é consumida pelos serviços seria uma métrica como "DriveSpaceInMb".</span><span class="sxs-lookup"><span data-stu-id="89a89-439">hello amount of space available on that SSD and how much is consumed by services would be a metric like “DriveSpaceInMb”.</span></span> 

<span data-ttu-id="89a89-440">É importante toonote que assim como para restrições de posicionamento e as propriedades de nó, Olá Gerenciador de recursos de Cluster do serviço de malha não entende quais nomes de saudação da média de métricas de saudação.</span><span class="sxs-lookup"><span data-stu-id="89a89-440">It is important toonote that just like for placement constraints and node properties, hello Service Fabric Cluster Resource Manager doesn't understand what hello names of hello metrics mean.</span></span> <span data-ttu-id="89a89-441">Os nomes de métrica são apenas cadeias de caracteres.</span><span class="sxs-lookup"><span data-stu-id="89a89-441">Metric names are just strings.</span></span> <span data-ttu-id="89a89-442">É unidades de toodeclare uma boa prática como parte de nomes de métrica Olá criado quando é ambíguo.</span><span class="sxs-lookup"><span data-stu-id="89a89-442">It is a good practice toodeclare units as a part of hello metric names that you create when it could be ambiguous.</span></span>

## <a name="capacity"></a><span data-ttu-id="89a89-443">Capacity</span><span class="sxs-lookup"><span data-stu-id="89a89-443">Capacity</span></span>
<span data-ttu-id="89a89-444">Se você desativasse todo o *balanceamento* de recursos, o Gerenciador de Recursos de Cluster do Service Fabric ainda garantiria que nenhum nó ficasse acima de sua capacidade.</span><span class="sxs-lookup"><span data-stu-id="89a89-444">If you turned off all resource *balancing*, Service Fabric’s Cluster Resource Manager would still ensure that no node ended up over its capacity.</span></span> <span data-ttu-id="89a89-445">É possível saturações de capacidade de gerenciamento, a menos que o cluster de hello está muito cheio ou carga de trabalho de saudação é maior do que qualquer nó.</span><span class="sxs-lookup"><span data-stu-id="89a89-445">Managing capacity overruns is possible unless hello cluster is too full or hello workload is larger than any node.</span></span> <span data-ttu-id="89a89-446">A capacidade é outro *restrição* que Olá Gerenciador de recursos de Cluster usa toounderstand como quanto de um recurso de um nó.</span><span class="sxs-lookup"><span data-stu-id="89a89-446">Capacity is another *constraint* that hello Cluster Resource Manager uses toounderstand how much of a resource a node has.</span></span> <span data-ttu-id="89a89-447">Capacidade restante também é controlada para cluster hello como um todo.</span><span class="sxs-lookup"><span data-stu-id="89a89-447">Remaining capacity is also tracked for hello cluster as a whole.</span></span> <span data-ttu-id="89a89-448">Capacidade de saudação e consumo de saudação no nível de serviço de saudação são expressos em termos de métricas.</span><span class="sxs-lookup"><span data-stu-id="89a89-448">Both hello capacity and hello consumption at hello service level are expressed in terms of metrics.</span></span> <span data-ttu-id="89a89-449">Por exemplo, a métrica de saudação pode ser "ClientConnections" e um nó pode ter a capacidade para "ClientConnections" de 32768.</span><span class="sxs-lookup"><span data-stu-id="89a89-449">So for example, hello metric might be "ClientConnections" and a given Node may have a capacity for "ClientConnections" of 32768.</span></span> <span data-ttu-id="89a89-450">Outros nós podem ter outros limites de algum serviço em execução em que possa nó significa que ele está consumindo atualmente 32256 da métrica hello "ClientConnections".</span><span class="sxs-lookup"><span data-stu-id="89a89-450">Other nodes can have other limits Some service running on that node can say it is currently consuming 32256 of hello metric "ClientConnections".</span></span>

<span data-ttu-id="89a89-451">Durante a execução, Olá Gerenciador de recursos de Cluster controla a capacidade restante no cluster hello e em nós.</span><span class="sxs-lookup"><span data-stu-id="89a89-451">During runtime, hello Cluster Resource Manager tracks remaining capacity in hello cluster and on nodes.</span></span> <span data-ttu-id="89a89-452">Em ordem tootrack Olá capacidade Gerenciador de recursos de Cluster subtrai o uso de cada serviço de capacidade do nó onde Olá serviço é executado.</span><span class="sxs-lookup"><span data-stu-id="89a89-452">In order tootrack capacity hello Cluster Resource Manager subtracts each service's usage from node's capacity where hello service runs.</span></span> <span data-ttu-id="89a89-453">Com essas informações, Olá Gerenciador de recursos de Cluster do serviço de malha pode decidir onde tooplace ou mover réplicas para que nós não passam pela capacidade.</span><span class="sxs-lookup"><span data-stu-id="89a89-453">With this information, hello Service Fabric Cluster Resource Manager can figure out where tooplace or move replicas so that nodes don’t go over capacity.</span></span>

<span data-ttu-id="89a89-454"><center>
![Capacidade e nós de cluster][Image7]
</center></span><span class="sxs-lookup"><span data-stu-id="89a89-454"><center>
![Cluster nodes and capacity][Image7]
</center></span></span>

<span data-ttu-id="89a89-455">C#:</span><span class="sxs-lookup"><span data-stu-id="89a89-455">C#:</span></span>

```csharp
StatefulServiceDescription serviceDescription = new StatefulServiceDescription();
ServiceLoadMetricDescription metric = new ServiceLoadMetricDescription();
metric.Name = "ClientConnections";
metric.PrimaryDefaultLoad = 1024;
metric.SecondaryDefaultLoad = 0;
metric.Weight = ServiceLoadMetricWeight.High;
serviceDescription.Metrics.Add(metric);
await fabricClient.ServiceManager.CreateServiceAsync(serviceDescription);
```

<span data-ttu-id="89a89-456">Powershell:</span><span class="sxs-lookup"><span data-stu-id="89a89-456">Powershell:</span></span>

```posh
New-ServiceFabricService -ApplicationName $applicationName -ServiceName $serviceName -ServiceTypeName $serviceTypeName –Stateful -MinReplicaSetSize 3 -TargetReplicaSetSize 3 -PartitionSchemeSingleton –Metric @("ClientConnections,High,1024,0)
```

<span data-ttu-id="89a89-457">Você pode ver as capacidades definidas no manifesto do cluster Olá:</span><span class="sxs-lookup"><span data-stu-id="89a89-457">You can see capacities defined in hello cluster manifest:</span></span>

<span data-ttu-id="89a89-458">ClusterManifest.xml</span><span class="sxs-lookup"><span data-stu-id="89a89-458">ClusterManifest.xml</span></span>

```xml
    <NodeType Name="NodeType03">
      <Capacities>
        <Capacity Name="ClientConnections" Value="65536"/>
      </Capacities>
    </NodeType>
```

<span data-ttu-id="89a89-459">via ClusterConfig.json para implantações Autônomas ou Template.json para clusters hospedados pelo Azure.</span><span class="sxs-lookup"><span data-stu-id="89a89-459">via ClusterConfig.json for Standalone deployments or Template.json for Azure hosted clusters.</span></span> 

```json
"nodeTypes": [
    {
        "name": "NodeType03",
        "capacities": {
            "ClientConnections": "65536",
        }
    }
],
```

<span data-ttu-id="89a89-460">Normalmente, a carga de um serviço é alterada dinamicamente.</span><span class="sxs-lookup"><span data-stu-id="89a89-460">Commonly a service’s load changes dynamically.</span></span> <span data-ttu-id="89a89-461">Digamos que a carga da réplica de "ClientConnections" alterado de 1024 too2048, mas o nó Olá ele estava em execução no e tinha apenas a capacidade restante de métrica de 512.</span><span class="sxs-lookup"><span data-stu-id="89a89-461">Say that a replica's load of "ClientConnections" changed from 1024 too2048, but hello node it was running on then only had 512 capacity remaining for that metric.</span></span> <span data-ttu-id="89a89-462">Agora essa réplica ou posicionamento da instância é inválido, pois não há espaço suficiente no nó.</span><span class="sxs-lookup"><span data-stu-id="89a89-462">Now that replica or instance's placement is invalid, since there's not enough room on that node.</span></span> <span data-ttu-id="89a89-463">Olá Gerenciador de recursos de Cluster tem tookick no e obter nó Olá abaixo de capacidade.</span><span class="sxs-lookup"><span data-stu-id="89a89-463">hello Cluster Resource Manager has tookick in and get hello node back below capacity.</span></span> <span data-ttu-id="89a89-464">Ela reduz a carga no nó de saudação que está acima da capacidade, movendo um ou mais réplicas de saudação ou instâncias de nós de tooother esse nó.</span><span class="sxs-lookup"><span data-stu-id="89a89-464">It reduces load on hello node that is over capacity by moving one or more of hello replicas or instances from that node tooother nodes.</span></span> <span data-ttu-id="89a89-465">Ao mover réplicas, Olá Gerenciador de recursos de Cluster tenta toominimize custo Olá essas movimentações.</span><span class="sxs-lookup"><span data-stu-id="89a89-465">When moving replicas, hello Cluster Resource Manager tries toominimize hello cost of those movements.</span></span> <span data-ttu-id="89a89-466">O custo de movimento é abordado em [neste artigo](service-fabric-cluster-resource-manager-movement-cost.md) e mais sobre Olá Gerenciador de recursos de Cluster do rebalanceamento estratégias e regras é descrito [aqui](service-fabric-cluster-resource-manager-metrics.md).</span><span class="sxs-lookup"><span data-stu-id="89a89-466">Movement cost is discussed in [this article](service-fabric-cluster-resource-manager-movement-cost.md) and more about hello Cluster Resource Manager's rebalancing strategies and rules is described [here](service-fabric-cluster-resource-manager-metrics.md).</span></span>

## <a name="cluster-capacity"></a><span data-ttu-id="89a89-467">Capacidade do cluster</span><span class="sxs-lookup"><span data-stu-id="89a89-467">Cluster capacity</span></span>
<span data-ttu-id="89a89-468">Como hello geral do Gerenciador de recursos de Cluster do Service Fabric manter Olá cluster sejam muito cheio?</span><span class="sxs-lookup"><span data-stu-id="89a89-468">So how does hello Service Fabric Cluster Resource Manager keep hello overall cluster from being too full?</span></span> <span data-ttu-id="89a89-469">Bem, com a carga dinâmica, não há muito que ele possa fazer.</span><span class="sxs-lookup"><span data-stu-id="89a89-469">Well, with dynamic load there’s not a lot it can do.</span></span> <span data-ttu-id="89a89-470">Serviços podem ter o pico de carga independentemente das ações tomadas pelo Olá Gerenciador de recursos de Cluster.</span><span class="sxs-lookup"><span data-stu-id="89a89-470">Services can have their load spike independently of actions taken by hello Cluster Resource Manager.</span></span> <span data-ttu-id="89a89-471">Como resultado, o cluster com bastante reserva dinâmica hoje pode não ter espaço suficiente quando você ficar famoso amanhã.</span><span class="sxs-lookup"><span data-stu-id="89a89-471">As a result, your cluster with plenty of headroom today may be underpowered when you become famous tomorrow.</span></span> <span data-ttu-id="89a89-472">Dito isso, há alguns controles que são baked tooprevent problemas.</span><span class="sxs-lookup"><span data-stu-id="89a89-472">That said, there are some controls that are baked in tooprevent problems.</span></span> <span data-ttu-id="89a89-473">primeira coisa Olá que podemos fazer é impedir a criação de saudação de novas cargas de trabalho que levariam Olá cluster toobecome completo.</span><span class="sxs-lookup"><span data-stu-id="89a89-473">hello first thing we can do is prevent hello creation of new workloads that would cause hello cluster toobecome full.</span></span>

<span data-ttu-id="89a89-474">Digamos que você crie um serviço sem estado e que haja alguma carga associada a ele.</span><span class="sxs-lookup"><span data-stu-id="89a89-474">Say that you create a stateless service and it has some load associated with it.</span></span> <span data-ttu-id="89a89-475">Digamos que o serviço de saudação se preocupa com métrica de "DiskSpaceInMb" hello.</span><span class="sxs-lookup"><span data-stu-id="89a89-475">Let’s say that hello service cares about hello "DiskSpaceInMb" metric.</span></span> <span data-ttu-id="89a89-476">Digamos que também que é contínuo tooconsume cinco unidades do "DiskSpaceInMb" para cada instância do serviço de saudação.</span><span class="sxs-lookup"><span data-stu-id="89a89-476">Let's also say that it is going tooconsume five units of "DiskSpaceInMb" for every instance of hello service.</span></span> <span data-ttu-id="89a89-477">Você deseja toocreate três instâncias do serviço de saudação.</span><span class="sxs-lookup"><span data-stu-id="89a89-477">You want toocreate three instances of hello service.</span></span> <span data-ttu-id="89a89-478">Ótimo!</span><span class="sxs-lookup"><span data-stu-id="89a89-478">Great!</span></span> <span data-ttu-id="89a89-479">Para que significa que precisamos 15 unidades de "DiskSpaceInMb" toobe apresenta em cluster para que possamos Olá tooeven ser capaz de toocreate essas instâncias de serviço.</span><span class="sxs-lookup"><span data-stu-id="89a89-479">So that means that we need 15 units of "DiskSpaceInMb" toobe present in hello cluster in order for us tooeven be able toocreate these service instances.</span></span> <span data-ttu-id="89a89-480">Olá Gerenciador de recursos de Cluster continuamente calcula capacidade hello e consumo de cada métrica para que ele possa determinar capacidade restante de saudação em cluster hello.</span><span class="sxs-lookup"><span data-stu-id="89a89-480">hello Cluster Resource Manager continually calculates hello capacity and consumption of each metric so it can determine hello remaining capacity in hello cluster.</span></span> <span data-ttu-id="89a89-481">Se não houver espaço suficiente, Olá Olá do Gerenciador de recursos de Cluster rejeita criar chamada de serviço.</span><span class="sxs-lookup"><span data-stu-id="89a89-481">If there isn't enough space, hello Cluster Resource Manager rejects hello create service call.</span></span>

<span data-ttu-id="89a89-482">Desde que o requisito Olá existe somente que ser 15 unidades disponíveis, esse espaço pôde ser alocado muitas maneiras diferentes.</span><span class="sxs-lookup"><span data-stu-id="89a89-482">Since hello requirement is only that there be 15 units available, this space could be allocated many different ways.</span></span> <span data-ttu-id="89a89-483">Por exemplo, poderia haver uma unidade restante de capacidade em 15 nós diferentes ou três unidades restantes de capacidade em cinco nós diferente.</span><span class="sxs-lookup"><span data-stu-id="89a89-483">For example, there could be one remaining unit of capacity on 15 different nodes, or three remaining units of capacity on five different nodes.</span></span> <span data-ttu-id="89a89-484">Se Olá Gerenciador de recursos de Cluster pode reorganizar coisas, portanto, há cinco unidades disponíveis em três nós, coloca o serviço de saudação.</span><span class="sxs-lookup"><span data-stu-id="89a89-484">If hello Cluster Resource Manager can rearrange things so there's five units available on three nodes, it places hello service.</span></span> <span data-ttu-id="89a89-485">Cluster de saudação reorganizando é geralmente possível, a menos que o cluster hello está quase cheio ou os serviços existentes Olá não podem ser consolidados por algum motivo.</span><span class="sxs-lookup"><span data-stu-id="89a89-485">Rearranging hello cluster is usually possible unless hello cluster is almost full or hello existing services can't be consolidated for some reason.</span></span>

## <a name="buffered-capacity"></a><span data-ttu-id="89a89-486">Capacidade de buffer</span><span class="sxs-lookup"><span data-stu-id="89a89-486">Buffered Capacity</span></span>
<span data-ttu-id="89a89-487">Capacidade de buffer é outro recurso de saudação Gerenciador de recursos de Cluster.</span><span class="sxs-lookup"><span data-stu-id="89a89-487">Buffered capacity is another feature of hello Cluster Resource Manager.</span></span> <span data-ttu-id="89a89-488">Ele permite que a reserva de alguma parte do hello capacidade total do nó.</span><span class="sxs-lookup"><span data-stu-id="89a89-488">It allows reservation of some portion of hello overall node capacity.</span></span> <span data-ttu-id="89a89-489">Esse buffer de capacidade é serviços tooplace usado somente durante falhas de nó e as atualizações.</span><span class="sxs-lookup"><span data-stu-id="89a89-489">This capacity buffer is only used tooplace services during upgrades and node failures.</span></span> <span data-ttu-id="89a89-490">A capacidade em buffer é especificada globalmente por métrica para todos os nós.</span><span class="sxs-lookup"><span data-stu-id="89a89-490">Buffered Capacity is specified globally per metric for all nodes.</span></span> <span data-ttu-id="89a89-491">valor de saudação que você escolher para a capacidade de saudação reservada é uma função do número de saudação de domínios de falha e atualização ter no cluster hello.</span><span class="sxs-lookup"><span data-stu-id="89a89-491">hello value you pick for hello reserved capacity is a function of hello number of Fault and Upgrade Domains you have in hello cluster.</span></span> <span data-ttu-id="89a89-492">Mais domínios de falha e de atualização significa que você pode escolher um número menor para a capacidade em buffer.</span><span class="sxs-lookup"><span data-stu-id="89a89-492">More Fault and Upgrade Domains means that you can pick a lower number for your buffered capacity.</span></span> <span data-ttu-id="89a89-493">Se você tiver mais de domínios, você pode esperar pequenas quantidades de toobe seu cluster não está disponível durante falhas e as atualizações.</span><span class="sxs-lookup"><span data-stu-id="89a89-493">If you have more domains, you can expect smaller amounts of your cluster toobe unavailable during upgrades and failures.</span></span> <span data-ttu-id="89a89-494">Especificação de capacidade em buffer só faz sentido, se você também tiver capacidade do nó Olá especificado para uma métrica.</span><span class="sxs-lookup"><span data-stu-id="89a89-494">Specifying Buffered Capacity only makes sense if you have also specified hello node capacity for a metric.</span></span>

<span data-ttu-id="89a89-495">Aqui está um exemplo de como toospecify buffer capacidade:</span><span class="sxs-lookup"><span data-stu-id="89a89-495">Here's an example of how toospecify buffered capacity:</span></span>

<span data-ttu-id="89a89-496">ClusterManifest.xml</span><span class="sxs-lookup"><span data-stu-id="89a89-496">ClusterManifest.xml</span></span>

```xml
        <Section Name="NodeBufferPercentage">
            <Parameter Name="SomeMetric" Value="0.15" />
            <Parameter Name="SomeOtherMetric" Value="0.20" />
        </Section>
```

<span data-ttu-id="89a89-497">via ClusterConfig.json para implantações Autônomas ou Template.json para clusters hospedados pelo Azure:</span><span class="sxs-lookup"><span data-stu-id="89a89-497">via ClusterConfig.json for Standalone deployments or Template.json for Azure hosted clusters:</span></span>

```json
"fabricSettings": [
  {
    "name": "NodeBufferPercentage",
    "parameters": [
      {
          "name": "SomeMetric",
          "value": "0.15"
      },
      {
          "name": "SomeOtherMetric",
          "value": "0.20"
      }
    ]
  }
]
```

<span data-ttu-id="89a89-498">a criação de novos serviços Olá falha quando cluster Olá fora da capacidade de buffer de uma métrica.</span><span class="sxs-lookup"><span data-stu-id="89a89-498">hello creation of new services fails when hello cluster is out of buffered capacity for a metric.</span></span> <span data-ttu-id="89a89-499">Impedindo a criação de saudação do buffer de saudação do novo serviços toopreserve garante que atualizações e falhas não causam nós toogo acima da capacidade.</span><span class="sxs-lookup"><span data-stu-id="89a89-499">Preventing hello creation of new services toopreserve hello buffer ensures that upgrades and failures don’t cause nodes toogo over capacity.</span></span> <span data-ttu-id="89a89-500">A capacidade em buffer é opcional, mas é recomendada em qualquer cluster que define uma capacidade para uma métrica.</span><span class="sxs-lookup"><span data-stu-id="89a89-500">Buffered capacity is optional but is recommended in any cluster that defines a capacity for a metric.</span></span>

<span data-ttu-id="89a89-501">Olá Gerenciador de recursos de Cluster expõe essas informações de carga.</span><span class="sxs-lookup"><span data-stu-id="89a89-501">hello Cluster Resource Manager exposes this load information.</span></span> <span data-ttu-id="89a89-502">Para cada métrica, as informações incluem:</span><span class="sxs-lookup"><span data-stu-id="89a89-502">For each metric, this information includes:</span></span> 
  - <span data-ttu-id="89a89-503">Olá em buffer as definições de capacidade</span><span class="sxs-lookup"><span data-stu-id="89a89-503">hello buffered capacity settings</span></span>
  - <span data-ttu-id="89a89-504">capacidade total Olá</span><span class="sxs-lookup"><span data-stu-id="89a89-504">hello total capacity</span></span>
  - <span data-ttu-id="89a89-505">consumo atual Olá</span><span class="sxs-lookup"><span data-stu-id="89a89-505">hello current consumption</span></span>
  - <span data-ttu-id="89a89-506">se cada métrica é considerada balanceada ou não</span><span class="sxs-lookup"><span data-stu-id="89a89-506">whether each metric is considered balanced or not</span></span>
  - <span data-ttu-id="89a89-507">estatísticas sobre o desvio padrão de saudação</span><span class="sxs-lookup"><span data-stu-id="89a89-507">statistics about hello standard deviation</span></span>
  - <span data-ttu-id="89a89-508">nós de saudação que têm hello mais e menos carga</span><span class="sxs-lookup"><span data-stu-id="89a89-508">hello nodes which have hello most and least load</span></span>  
  
<span data-ttu-id="89a89-509">Abaixo, vemos um exemplo dessa saída:</span><span class="sxs-lookup"><span data-stu-id="89a89-509">Below we see an example of that output:</span></span>

```posh
PS C:\Users\user> Get-ServiceFabricClusterLoadInformation
LastBalancingStartTimeUtc : 9/1/2016 12:54:59 AM
LastBalancingEndTimeUtc   : 9/1/2016 12:54:59 AM
LoadMetricInformation     :
                            LoadMetricName        : Metric1
                            IsBalancedBefore      : False
                            IsBalancedAfter       : False
                            DeviationBefore       : 0.192450089729875
                            DeviationAfter        : 0.192450089729875
                            BalancingThreshold    : 1
                            Action                : NoActionNeeded
                            ActivityThreshold     : 0
                            ClusterCapacity       : 189
                            ClusterLoad           : 45
                            ClusterRemainingCapacity : 144
                            NodeBufferPercentage  : 10
                            ClusterBufferedCapacity : 170
                            ClusterRemainingBufferedCapacity : 125
                            ClusterCapacityViolation : False
                            MinNodeLoadValue      : 0
                            MinNodeLoadNodeId     : 3ea71e8e01f4b0999b121abcbf27d74d
                            MaxNodeLoadValue      : 15
                            MaxNodeLoadNodeId     : 2cc648b6770be1bc9824fa995d5b68b1
```

## <a name="next-steps"></a><span data-ttu-id="89a89-510">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="89a89-510">Next steps</span></span>
* <span data-ttu-id="89a89-511">Para obter informações sobre o fluxo de informações e arquitetura de hello dentro Olá Gerenciador de recursos de Cluster, check-out [neste artigo](service-fabric-cluster-resource-manager-architecture.md)</span><span class="sxs-lookup"><span data-stu-id="89a89-511">For information on hello architecture and information flow within hello Cluster Resource Manager, check out [this article ](service-fabric-cluster-resource-manager-architecture.md)</span></span>
* <span data-ttu-id="89a89-512">Definir métricas de desfragmentação é carga tooconsolidate unidirecional em nós em vez de propagação de. toolearn como tooconfigure desfragmentação, consulte muito[neste artigo](service-fabric-cluster-resource-manager-defragmentation-metrics.md)</span><span class="sxs-lookup"><span data-stu-id="89a89-512">Defining Defragmentation Metrics is one way tooconsolidate load on nodes instead of spreading it out. toolearn how tooconfigure defragmentation, refer too[this article](service-fabric-cluster-resource-manager-defragmentation-metrics.md)</span></span>
* <span data-ttu-id="89a89-513">Desde o início de saudação e [obter uma introdução toohello Gerenciador de recursos de Cluster do serviço de malha](service-fabric-cluster-resource-manager-introduction.md)</span><span class="sxs-lookup"><span data-stu-id="89a89-513">Start from hello beginning and [get an Introduction toohello Service Fabric Cluster Resource Manager](service-fabric-cluster-resource-manager-introduction.md)</span></span>
* <span data-ttu-id="89a89-514">toofind out sobre como Olá Gerenciador de recursos de Cluster gerencia e equilibra a carga no cluster hello, check-out artigo Olá em [balanceamento de carga](service-fabric-cluster-resource-manager-balancing.md)</span><span class="sxs-lookup"><span data-stu-id="89a89-514">toofind out about how hello Cluster Resource Manager manages and balances load in hello cluster, check out hello article on [balancing load](service-fabric-cluster-resource-manager-balancing.md)</span></span>

[Image1]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-fault-domains.png
[Image2]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-uneven-fault-domain-layout.png
[Image3]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-fault-and-upgrade-domains-with-placement.png
[Image4]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-fault-and-upgrade-domain-layout-strategies.png
[Image5]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-layout-different-workloads.png
[Image6]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-placement-constraints-node-properties.png
[Image7]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-nodes-and-capacity.png
