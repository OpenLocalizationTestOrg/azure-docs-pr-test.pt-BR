---
title: "Tutorial de atualização de aplicativo do Service Fabric | Microsoft Docs"
description: "Este artigo descreve a experiência de implantação de um Aplicativo do Service Fabric, a alteração do código e a distribuição de uma atualização usando o Visual Studio."
services: service-fabric
documentationcenter: .net
author: mani-ramaswamy
manager: timlt
editor: 
ms.assetid: a3181a7a-9ab1-4216-b07a-05b79bd826a4
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 8/9/2017
ms.author: subramar
ms.openlocfilehash: 940440688ec770a4aeb932b574bd6be173f494d4
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/18/2017
---
# <a name="service-fabric-application-upgrade-tutorial-using-visual-studio"></a><span data-ttu-id="dd2d0-103">Tutorial de atualização do aplicativo Service Fabric usando o Visual Studio</span><span class="sxs-lookup"><span data-stu-id="dd2d0-103">Service Fabric application upgrade tutorial using Visual Studio</span></span>
> [!div class="op_single_selector"]
> * [<span data-ttu-id="dd2d0-104">PowerShell</span><span class="sxs-lookup"><span data-stu-id="dd2d0-104">PowerShell</span></span>](service-fabric-application-upgrade-tutorial-powershell.md)
> * [<span data-ttu-id="dd2d0-105">Visual Studio</span><span class="sxs-lookup"><span data-stu-id="dd2d0-105">Visual Studio</span></span>](service-fabric-application-upgrade-tutorial.md)
> 
> 

<br/>

<span data-ttu-id="dd2d0-106">O Azure Service Fabric simplifica o processo de atualização de aplicativos em nuvem, garantindo que apenas os serviços alterados sejam atualizados e que a integridade do aplicativo seja monitorada durante todo o processo de atualização.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-106">Azure Service Fabric simplifies the process of upgrading cloud applications by ensuring that only changed services are upgraded, and that application health is monitored throughout the upgrade process.</span></span> <span data-ttu-id="dd2d0-107">Além disso, ele reverte automaticamente o aplicativo para a versão anterior ao encontrar problemas.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-107">It also automatically rolls back the application to the previous version upon encountering issues.</span></span> <span data-ttu-id="dd2d0-108">As atualizações de aplicativo do Service Fabric não apresentam *Nenhum Tempo de Inatividade*, pois o aplicativo pode ser atualizado sem qualquer tempo de inatividade.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-108">Service Fabric application upgrades are *Zero Downtime*, since the application can be upgraded with no downtime.</span></span> <span data-ttu-id="dd2d0-109">Este tutorial aborda como concluir uma atualização sem interrupção por meio do Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-109">This tutorial covers how to complete a rolling upgrade from Visual Studio.</span></span>

## <a name="step-1-build-and-publish-the-visual-objects-sample"></a><span data-ttu-id="dd2d0-110">Etapa 1: Compilar e implantar o exemplo do Visual Objects</span><span class="sxs-lookup"><span data-stu-id="dd2d0-110">Step 1: Build and publish the Visual Objects sample</span></span>
<span data-ttu-id="dd2d0-111">Primeiro, baixe o aplicativo [Visual Objects](https://github.com/Azure-Samples/service-fabric-dotnet-getting-started/tree/classic/Actors/VisualObjects) do GitHub.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-111">First, download the [Visual Objects](https://github.com/Azure-Samples/service-fabric-dotnet-getting-started/tree/classic/Actors/VisualObjects) application from GitHub.</span></span> <span data-ttu-id="dd2d0-112">Em seguida, crie e publique o aplicativo clicando com o botão direito do mouse no projeto do aplicativo, **VisualObjects** e selecionando o comando **Publicar** no item de menu Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-112">Then, build and publish the application by right-clicking on the application project, **VisualObjects**, and selecting the **Publish** command in the Service Fabric menu item.</span></span>

![Menu de contexto para um aplicativo do Service Fabric][image1]

<span data-ttu-id="dd2d0-114">A seleção de **Publicar** exibe um pop-up, e você pode definir o **Perfil de destino** como **PublishProfiles\Local.xml**.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-114">Selecting **Publish** brings up a popup, and you can set the **Target profile** to **PublishProfiles\Local.xml**.</span></span> <span data-ttu-id="dd2d0-115">A janela deve parecer com o seguinte antes de clicar em **Publicar**.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-115">The window should look like the following before you click **Publish**.</span></span>

![Publicar um aplicativo do Service Fabric][image2]

<span data-ttu-id="dd2d0-117">Agora, clique em **Publicar** na caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-117">Now you can click **Publish** in the dialog box.</span></span> <span data-ttu-id="dd2d0-118">Você pode usar o [Gerenciador do Service Fabric para exibir o cluster e o aplicativo](service-fabric-visualizing-your-cluster.md).</span><span class="sxs-lookup"><span data-stu-id="dd2d0-118">You can use [Service Fabric Explorer to view the cluster and the application](service-fabric-visualizing-your-cluster.md).</span></span> <span data-ttu-id="dd2d0-119">O aplicativo Visual Objects tem um serviço Web que pode ser acessado digitando [http://localhost:8081/visualobjects/](http://localhost:8081/visualobjects/) na barra de endereços do navegador.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-119">The Visual Objects application has a web service that you can go to by typing [http://localhost:8081/visualobjects/](http://localhost:8081/visualobjects/) in the address bar of your browser.</span></span>  <span data-ttu-id="dd2d0-120">Você deve ver 10 objetos visuais flutuantes na tela.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-120">You should see 10 floating visual objects moving around on the screen.</span></span>

<span data-ttu-id="dd2d0-121">**OBSERVAÇÃO:** se estiver implantando no perfil `Cloud.xml` (Azure Service Fabric), o aplicativo deverá estar disponível em **http://{NomeDoServiceFabric}.{Region}.cloudapp.azure.com:8081/visualobjects/**.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-121">**NOTE:** If deploying to `Cloud.xml` profile (Azure Service Fabric), the application should then be available at **http://{ServiceFabricName}.{Region}.cloudapp.azure.com:8081/visualobjects/**.</span></span> <span data-ttu-id="dd2d0-122">Verifique se você tem `8081/TCP` configurado no Balanceador de Carga (localize o Balanceador de Carga no mesmo grupo de recursos que a instância do Service Fabric).</span><span class="sxs-lookup"><span data-stu-id="dd2d0-122">Make sure you do have `8081/TCP` configured in the Load Balancer (find the Load Balancer in the same resource group as the Service Fabric instance).</span></span>

## <a name="step-2-update-the-visual-objects-sample"></a><span data-ttu-id="dd2d0-123">Etapa 2: atualizar o exemplo de Objetos Visuais</span><span class="sxs-lookup"><span data-stu-id="dd2d0-123">Step 2: Update the Visual Objects sample</span></span>
<span data-ttu-id="dd2d0-124">Você pode notar que a com a versão implantada na Etapa 1, os objetos visuais não giram.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-124">You might notice that with the version that was deployed in step 1, the visual objects do not rotate.</span></span> <span data-ttu-id="dd2d0-125">Vamos atualizar esse aplicativo para um onde os objetos visuais possam girar.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-125">Let's upgrade this application to one where the visual objects also rotate.</span></span>

<span data-ttu-id="dd2d0-126">Selecione o projeto VisualObjects.ActorService na solução VisualObjects e abra o arquivo **VisualObjectActor.cs** .</span><span class="sxs-lookup"><span data-stu-id="dd2d0-126">Select the VisualObjects.ActorService project within the VisualObjects solution, and open the **VisualObjectActor.cs** file.</span></span> <span data-ttu-id="dd2d0-127">Nesse arquivo, acesse o método `MoveObject`, comente `visualObject.Move(false)` e remova a marca de comentário de `visualObject.Move(true)`.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-127">Within that file, go to the method `MoveObject`, comment out `visualObject.Move(false)`, and uncomment `visualObject.Move(true)`.</span></span> <span data-ttu-id="dd2d0-128">Essa alteração de código gira os objetos após a atualização do serviço.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-128">This code change rotates the objects after the service is upgraded.</span></span>  <span data-ttu-id="dd2d0-129">**Agora você pode compilar (não recompilar) a solução**, que compilará os projetos modificados.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-129">**Now you can build (not rebuild) the solution**, which builds the modified projects.</span></span> <span data-ttu-id="dd2d0-130">Se você selecionar *Recompilar todos*, terá que atualizar as versões de todos os projetos.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-130">If you select *Rebuild all*, you have to update the versions for all the projects.</span></span>

<span data-ttu-id="dd2d0-131">Também precisamos definir a versão do nosso aplicativo.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-131">We also need to version our application.</span></span> <span data-ttu-id="dd2d0-132">Você pode usar a opção **Editar Versões do Manifesto** do Visual Studio depois de clicar com o botão direito do mouse no projeto **VisualObjects** para fazer as alterações de versão.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-132">To make the version changes after you right-click on the **VisualObjects** project, you can use the Visual Studio **Edit Manifest Versions** option.</span></span> <span data-ttu-id="dd2d0-133">Selecionar esta opção abrirá a caixa de diálogo para edição de versões da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="dd2d0-133">Selecting this option brings up the dialog box for edition versions as follows:</span></span>

![Caixa de diálogo Controle de Versão][image3]

<span data-ttu-id="dd2d0-135">Atualize as versões dos projetos modificados e seus pacotes de código, juntamente com o aplicativo, para a versão 2.0.0.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-135">Update the versions for the modified projects and their code packages, along with the application to version 2.0.0.</span></span> <span data-ttu-id="dd2d0-136">Depois que as alterações forem feitas, o manifesto deverá parecer com o seguinte (as partes em negrito mostram as alterações):</span><span class="sxs-lookup"><span data-stu-id="dd2d0-136">After the changes are made, the manifest should look like the following (bold portions show the changes):</span></span>

![Atualizando versões][image4]

<span data-ttu-id="dd2d0-138">As ferramentas do Visual Studio podem fazer rollups automáticos das versões ao selecionar **Atualizar automaticamente o aplicativo e as versões de serviço**.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-138">The Visual Studio tools can do automatic rollups of versions upon selecting **Automatically update application and service versions**.</span></span> <span data-ttu-id="dd2d0-139">Se você usar [SemVer](http://www.semver.org), será necessário atualizar a versão do código e/ou apenas do pacote de configuração se essa opção for selecionada.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-139">If you use [SemVer](http://www.semver.org), you need to update the code and/or configuration package version alone if that option is selected.</span></span>

<span data-ttu-id="dd2d0-140">Salve as alterações e marque a caixa **Atualizar o Aplicativo** .</span><span class="sxs-lookup"><span data-stu-id="dd2d0-140">Save the changes, and now check the **Upgrade the Application** box.</span></span>

## <a name="step-3--upgrade-your-application"></a><span data-ttu-id="dd2d0-141">Etapa 3: Atualizar seu aplicativo</span><span class="sxs-lookup"><span data-stu-id="dd2d0-141">Step 3:  Upgrade your application</span></span>
<span data-ttu-id="dd2d0-142">Familiarize-se com os [parâmetros de atualização de aplicativo](service-fabric-application-upgrade-parameters.md) e o [processo de atualização](service-fabric-application-upgrade.md) para ter uma boa compreensão dos vários parâmetros de atualização, do critério de tempos limite e de integridade que podem ser aplicados.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-142">Familiarize yourself with the [application upgrade parameters](service-fabric-application-upgrade-parameters.md) and the [upgrade process](service-fabric-application-upgrade.md) to get a good understanding of the various upgrade parameters, time-outs, and health criterion that can be applied.</span></span> <span data-ttu-id="dd2d0-143">Neste passo a passo, o critério de avaliação de integridade do serviço é definido com o valor padrão (modo sem monitoramento).</span><span class="sxs-lookup"><span data-stu-id="dd2d0-143">For this walkthrough, the service health evaluation criterion is set to the default (unmonitored mode).</span></span> <span data-ttu-id="dd2d0-144">Você pode definir essas configurações selecionando **Definir Configurações de Atualização** e modificando os parâmetros conforme o desejado.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-144">You can configure these settings by selecting **Configure Upgrade Settings** and then modifying the parameters as desired.</span></span>

<span data-ttu-id="dd2d0-145">Agora, estamos prontos para iniciar a atualização do aplicativo selecionando **Publicar**.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-145">Now we are all set to start the application upgrade by selecting **Publish**.</span></span> <span data-ttu-id="dd2d0-146">Essa opção atualiza o aplicativo para a versão 2.0.0 no qual os objetos giram.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-146">This option upgrades your application to version 2.0.0, in which the objects rotate.</span></span> <span data-ttu-id="dd2d0-147">O Service Fabric atualiza um domínio de atualização por vez (alguns objetos são atualizados primeiro e logo na sequência os outros) e o serviço estará acessível durante a atualização.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-147">Service Fabric upgrades one update domain at a time (some objects are updated first, followed by others), and the service remains accessible during the upgrade.</span></span> <span data-ttu-id="dd2d0-148">O acesso ao serviço pode ser verificado por meio de seu cliente (navegador).</span><span class="sxs-lookup"><span data-stu-id="dd2d0-148">Access to the service can be checked through your client (browser).</span></span>  

<span data-ttu-id="dd2d0-149">Agora, à medida que a atualização do aplicativo continua, você poderá monitorá-lo usando o Service Fabric Explorer, na guia **Atualizações em Andamento** nos aplicativos.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-149">Now, as the application upgrade proceeds, you can monitor it with Service Fabric Explorer, by using the **Upgrades in Progress** tab under the applications.</span></span>

<span data-ttu-id="dd2d0-150">Em alguns minutos, todos os domínios de atualização devem estar atualizados (concluídos), e a janela de saída do Visual Studio também deverá indicar que a atualização foi concluída.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-150">In a few minutes, all update domains should be upgraded (completed), and the Visual Studio output window should also state that the upgrade is completed.</span></span> <span data-ttu-id="dd2d0-151">E você deverá notar que *todos* os objetos visuais na janela do navegador estarão girando!</span><span class="sxs-lookup"><span data-stu-id="dd2d0-151">And you should find that *all* the visual objects in your browser window are now rotating!</span></span>

<span data-ttu-id="dd2d0-152">Convém tentar alterar as versões e mudar da versão 2.0.0 para a versão 3.0.0 como um exercício, ou até mesmo da versão 2.0.0 de volta para a versão 1.0.0.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-152">You may want to try changing the versions, and moving from version 2.0.0 to version 3.0.0 as an exercise, or even from version 2.0.0 back to version 1.0.0.</span></span> <span data-ttu-id="dd2d0-153">Teste as possibilidades com políticas de integridade e tempos limite para ficar familiarizado com eles.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-153">Play with time-outs and health policies to make yourself familiar with them.</span></span> <span data-ttu-id="dd2d0-154">Ao implantar em um cluster do Azure em vez de um cluster local, os parâmetros usados podem ter diferentes.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-154">When deploying to an Azure cluster as opposed to a local cluster, the parameters used may have to differ.</span></span> <span data-ttu-id="dd2d0-155">É recomendável que você defina os tempos limite forma prudente.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-155">We recommend that you set the time-outs conservatively.</span></span>

## <a name="next-steps"></a><span data-ttu-id="dd2d0-156">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="dd2d0-156">Next steps</span></span>
<span data-ttu-id="dd2d0-157">[Atualização do aplicativo usando o PowerShell](service-fabric-application-upgrade-tutorial-powershell.md) orienta você uma atualização de aplicativo usando o PowerShell.</span><span class="sxs-lookup"><span data-stu-id="dd2d0-157">[Upgrading your application using PowerShell](service-fabric-application-upgrade-tutorial-powershell.md) walks you through an application upgrade using PowerShell.</span></span>

<span data-ttu-id="dd2d0-158">Controle como seu aplicativo é atualizado usando [parâmetros de atualização](service-fabric-application-upgrade-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="dd2d0-158">Control how your application is upgraded by using [upgrade parameters](service-fabric-application-upgrade-parameters.md).</span></span>

<span data-ttu-id="dd2d0-159">Torne suas atualizações de aplicativo compatíveis aprendendo a usar a [serialização de dados](service-fabric-application-upgrade-data-serialization.md).</span><span class="sxs-lookup"><span data-stu-id="dd2d0-159">Make your application upgrades compatible by learning how to use [data serialization](service-fabric-application-upgrade-data-serialization.md).</span></span>

<span data-ttu-id="dd2d0-160">Saiba como usar a funcionalidade avançada ao atualizar seu aplicativo consultando os [Tópicos avançados](service-fabric-application-upgrade-advanced.md).</span><span class="sxs-lookup"><span data-stu-id="dd2d0-160">Learn how to use advanced functionality while upgrading your application by referring to [Advanced topics](service-fabric-application-upgrade-advanced.md).</span></span>

<span data-ttu-id="dd2d0-161">Corrija problemas comuns em atualizações de aplicativo consultando as etapas em [Solução de problemas de atualizações de aplicativo](service-fabric-application-upgrade-troubleshooting.md).</span><span class="sxs-lookup"><span data-stu-id="dd2d0-161">Fix common problems in application upgrades by referring to the steps in [Troubleshooting application upgrades](service-fabric-application-upgrade-troubleshooting.md).</span></span>

[image1]: media/service-fabric-application-upgrade-tutorial/upgrade7.png
[image2]: media/service-fabric-application-upgrade-tutorial/upgrade1.png
[image3]: media/service-fabric-application-upgrade-tutorial/upgrade5.png
[image4]: media/service-fabric-application-upgrade-tutorial/upgrade6.png
