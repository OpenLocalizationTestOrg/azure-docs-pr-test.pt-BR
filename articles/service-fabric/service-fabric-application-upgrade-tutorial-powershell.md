---
title: "Atualização de aplicativo do Service Fabric usando o PowerShell | Microsoft Docs"
description: "Este artigo descreve a experiência de implantação de um aplicativo do Service Fabric, de alteração do código e de distribuição de uma atualização usando o PowerShell."
services: service-fabric
documentationcenter: .net
author: mani-ramaswamy
manager: timlt
editor: 
ms.assetid: 9bc75748-96b0-49ca-8d8a-41fe08398f25
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 8/9/2017
ms.author: subramar
ms.openlocfilehash: 3591ced970887d4eb5a33cec8f6951b5476d04f8
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/18/2017
---
# <a name="service-fabric-application-upgrade-using-powershell"></a><span data-ttu-id="89c42-103">Atualização do aplicativo do Service Fabric usando o PowerShell</span><span class="sxs-lookup"><span data-stu-id="89c42-103">Service Fabric application upgrade using PowerShell</span></span>
> [!div class="op_single_selector"]
> * [<span data-ttu-id="89c42-104">PowerShell</span><span class="sxs-lookup"><span data-stu-id="89c42-104">PowerShell</span></span>](service-fabric-application-upgrade-tutorial-powershell.md)
> * [<span data-ttu-id="89c42-105">Visual Studio</span><span class="sxs-lookup"><span data-stu-id="89c42-105">Visual Studio</span></span>](service-fabric-application-upgrade-tutorial.md)
> 
> 

<br/>

<span data-ttu-id="89c42-106">O mais usado e o método de atualização recomendado é a atualização sem interrupção monitorada.</span><span class="sxs-lookup"><span data-stu-id="89c42-106">The most frequently used and recommended upgrade approach is the monitored rolling upgrade.</span></span>  <span data-ttu-id="89c42-107">O Service Fabric do Azure monitora a integridade do aplicativo que está sendo atualizado com base em um conjunto de políticas de integridade.</span><span class="sxs-lookup"><span data-stu-id="89c42-107">Azure Service Fabric monitors the health of the application being upgraded based on a set of health policies.</span></span> <span data-ttu-id="89c42-108">Quando um UD (domínio de atualização) for atualizado, o Service Fabric avaliará a integridade do aplicativo e prosseguirá para o próximo domínio de atualização ou retornará um erro para a atualização dependendo das políticas de integridade.</span><span class="sxs-lookup"><span data-stu-id="89c42-108">Once an update domain (UD) is upgraded, Service Fabric evaluates the application health and either proceeds to the next update domain or fails the upgrade depending on the health policies.</span></span>

<span data-ttu-id="89c42-109">Uma atualização do aplicativo monitorada pode ser executada usando APIs, PowerShell ou REST nativos ou gerenciados.</span><span class="sxs-lookup"><span data-stu-id="89c42-109">A monitored application upgrade can be performed using the managed or native APIs, PowerShell, or REST.</span></span> <span data-ttu-id="89c42-110">Para obter instruções sobre como executar uma atualização usando o Visual Studio, confira [Atualização do aplicativo usando o Visual Studio](service-fabric-application-upgrade-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="89c42-110">For instructions on performing an upgrade using Visual Studio, see [Upgrading your application using Visual Studio](service-fabric-application-upgrade-tutorial.md).</span></span>

<span data-ttu-id="89c42-111">Com as atualizações monitoradas sem interrupção do Service Fabric, o administrador de aplicativos pode configurar a política de avaliação de integridade que o Service Fabric usa para determinar se o aplicativo está íntegro.</span><span class="sxs-lookup"><span data-stu-id="89c42-111">With Service Fabric monitored rolling upgrades, the application administrator can configure the health evaluation policy that Service Fabric uses to determine if the application is healthy.</span></span> <span data-ttu-id="89c42-112">Além disso, o administrador pode configurar a ação a ser executada quando a avaliação de integridade falha (por exemplo, uma reversão automática). Esta seção fornece um passo a passo de uma atualização monitorada para um dos exemplos de SDK que usa o PowerShell.</span><span class="sxs-lookup"><span data-stu-id="89c42-112">In addition, the administrator can configure the action to be taken when the health evaluation fails (for example, doing an automatic rollback.) This section walks through a monitored upgrade for one of the SDK samples that uses PowerShell.</span></span> <span data-ttu-id="89c42-113">O vídeo do Microsoft Virtual Academy a seguir também explica o processo de atualização de um aplicativo: <center><a target="_blank" href="https://mva.microsoft.com/en-US/training-courses/building-microservices-applications-on-azure-service-fabric-16747?l=OrHJH66yC_6406218965">
<img src="./media/service-fabric-application-upgrade-tutorial-powershell/AppLifecycleVid.png" WIDTH="360" HEIGHT="244">
</a></center></span><span class="sxs-lookup"><span data-stu-id="89c42-113">The following Microsoft Virtual Academy video also walks you through an app upgrade: <center><a target="_blank" href="https://mva.microsoft.com/en-US/training-courses/building-microservices-applications-on-azure-service-fabric-16747?l=OrHJH66yC_6406218965">
<img src="./media/service-fabric-application-upgrade-tutorial-powershell/AppLifecycleVid.png" WIDTH="360" HEIGHT="244">
</a></center></span></span>

## <a name="step-1-build-and-deploy-the-visual-objects-sample"></a><span data-ttu-id="89c42-114">Etapa 1: criar e implantar o exemplo de Objetos Visuais</span><span class="sxs-lookup"><span data-stu-id="89c42-114">Step 1: Build and deploy the Visual Objects sample</span></span>
<span data-ttu-id="89c42-115">Crie e publique o aplicativo clicando com o botão direito do mouse no projeto do aplicativo, **VisualObjectsApplication** e selecionando o comando **Publicar**.</span><span class="sxs-lookup"><span data-stu-id="89c42-115">Build and publish the application by right-clicking on the application project, **VisualObjectsApplication,** and selecting the **Publish** command.</span></span>  <span data-ttu-id="89c42-116">Para obter mais informações, confira o [Tutorial de atualização de aplicativos do Service Fabric](service-fabric-application-upgrade-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="89c42-116">For more information, see [Service Fabric application upgrade tutorial](service-fabric-application-upgrade-tutorial.md).</span></span>  <span data-ttu-id="89c42-117">Se preferir, você pode usar o PowerShell para implantar o seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="89c42-117">Alternatively, you can use PowerShell to deploy your application.</span></span>

> [!NOTE]
> <span data-ttu-id="89c42-118">Antes de qualquer um dos comandos do Service Fabric poder ser usado no PowerShell, você precisa primeiro conectar ao cluster usando o cmdlet `Connect-ServiceFabricCluster`.</span><span class="sxs-lookup"><span data-stu-id="89c42-118">Before any of the Service Fabric commands may be used in PowerShell, you first need to connect to the cluster by using the `Connect-ServiceFabricCluster` cmdlet.</span></span> <span data-ttu-id="89c42-119">Da mesma forma, supõe-se que o Cluster já esteja configurado no computador local.</span><span class="sxs-lookup"><span data-stu-id="89c42-119">Similarly, it is assumed that the Cluster has already been set up on your local machine.</span></span> <span data-ttu-id="89c42-120">Consulte o artigo [configurando o ambiente de desenvolvimento de Malha do serviço](service-fabric-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="89c42-120">See the article on [setting up your Service Fabric development environment](service-fabric-get-started.md).</span></span>
> 
> 

<span data-ttu-id="89c42-121">Depois de criar o projeto no Visual Studio, você pode usar o comando do PowerShell [Copy-ServiceFabricApplicationPackage](/powershell/servicefabric/vlatest/copy-servicefabricapplicationpackage) para copiar o pacote de aplicativos para o ImageStore.</span><span class="sxs-lookup"><span data-stu-id="89c42-121">After building the project in Visual Studio, you can use the PowerShell command [Copy-ServiceFabricApplicationPackage](/powershell/servicefabric/vlatest/copy-servicefabricapplicationpackage) to copy the application package to the ImageStore.</span></span> <span data-ttu-id="89c42-122">Se quiser verificar o pacote do aplicativo localmente, use o cmdlet [Test-ServiceFabricApplicationPackage](/powershell/servicefabric/vlatest/test-servicefabricapplicationpackage).</span><span class="sxs-lookup"><span data-stu-id="89c42-122">If you want to verify the app package locally, use the [Test-ServiceFabricApplicationPackage](/powershell/servicefabric/vlatest/test-servicefabricapplicationpackage) cmdlet.</span></span> <span data-ttu-id="89c42-123">A próxima etapa é registrar o aplicativo no tempo de execução do Service Fabric usando o cmdlet [Register-ServiceFabricApplicationPackage](/powershell/servicefabric/vlatest/register-servicefabricapplicationtype) .</span><span class="sxs-lookup"><span data-stu-id="89c42-123">The next step is to register the application to the Service Fabric runtime using the [Register-ServiceFabricApplicationPackage](/powershell/servicefabric/vlatest/register-servicefabricapplicationtype) cmdlet.</span></span> <span data-ttu-id="89c42-124">A etapa final é iniciar uma instância do aplicativo usando o cmdlet [New-ServiceFabricApplication](/powershell/module/servicefabric/new-servicefabricapplication?view=azureservicefabricps) .</span><span class="sxs-lookup"><span data-stu-id="89c42-124">The final step is to start an instance of the application by using the [New-ServiceFabricApplication](/powershell/module/servicefabric/new-servicefabricapplication?view=azureservicefabricps) cmdlet.</span></span>  <span data-ttu-id="89c42-125">Estas três etapas são semelhantes a usar o item de menu **Implantar** no Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="89c42-125">These three steps are analogous to using the **Deploy** menu item in Visual Studio.</span></span>

<span data-ttu-id="89c42-126">Agora, você pode usar o [Gerenciador de Malha do serviço para exibir o cluster e o aplicativo](service-fabric-visualizing-your-cluster.md).</span><span class="sxs-lookup"><span data-stu-id="89c42-126">Now, you can use [Service Fabric Explorer to view the cluster and the application](service-fabric-visualizing-your-cluster.md).</span></span> <span data-ttu-id="89c42-127">O aplicativo tem um serviço Web que pode ser acessado no Internet Explorer, digitando [http://localhost:8081/visualobjects](http://localhost:8081/visualobjects) na barra de endereços.</span><span class="sxs-lookup"><span data-stu-id="89c42-127">The application has a web service that can be navigated to in Internet Explorer by typing [http://localhost:8081/visualobjects](http://localhost:8081/visualobjects) in the address bar.</span></span>  <span data-ttu-id="89c42-128">Você deve ver alguns objetos visuais flutuantes moverem-se na tela.</span><span class="sxs-lookup"><span data-stu-id="89c42-128">You should see some floating visual objects moving around in the screen.</span></span>  <span data-ttu-id="89c42-129">Além disso, você pode usar [Get-ServiceFabricApplication](/powershell/module/servicefabric/get-servicefabricapplication?view=azureservicefabricps) para verificar o status do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="89c42-129">Additionally, you can use [Get-ServiceFabricApplication](/powershell/module/servicefabric/get-servicefabricapplication?view=azureservicefabricps) to check the application status.</span></span>

## <a name="step-2-update-the-visual-objects-sample"></a><span data-ttu-id="89c42-130">Etapa 2: atualizar o exemplo de Objetos Visuais</span><span class="sxs-lookup"><span data-stu-id="89c42-130">Step 2: Update the Visual Objects sample</span></span>
<span data-ttu-id="89c42-131">Você pode notar que a com a versão implantada na Etapa 1, os objetos visuais não giram.</span><span class="sxs-lookup"><span data-stu-id="89c42-131">You might notice that with the version that was deployed in Step 1, the visual objects do not rotate.</span></span> <span data-ttu-id="89c42-132">Vamos atualizar esse aplicativo para um onde os objetos visuais possam girar.</span><span class="sxs-lookup"><span data-stu-id="89c42-132">Let's upgrade this application to one where the visual objects also rotate.</span></span>

<span data-ttu-id="89c42-133">Selecione o projeto VisualObjects.ActorService dentro da solução VisualObjects e abra o arquivo StatefulVisualObjectActor.cs.</span><span class="sxs-lookup"><span data-stu-id="89c42-133">Select the VisualObjects.ActorService project within the VisualObjects solution, and open the StatefulVisualObjectActor.cs file.</span></span> <span data-ttu-id="89c42-134">Nesse arquivo, navegue até o método `MoveObject`, desmarque o comentário `this.State.Move()` e remova os comentários `this.State.Move(true)`.</span><span class="sxs-lookup"><span data-stu-id="89c42-134">Within that file, navigate to the method `MoveObject`, comment out `this.State.Move()`, and uncomment `this.State.Move(true)`.</span></span> <span data-ttu-id="89c42-135">Essa alteração gira os objetos após a atualização do serviço.</span><span class="sxs-lookup"><span data-stu-id="89c42-135">This change rotates the objects after the service is upgraded.</span></span>

<span data-ttu-id="89c42-136">Também precisamos atualizar o arquivo *ServiceManifest.xml* (em PackageRoot) do projeto **VisualObjects.ActorService**.</span><span class="sxs-lookup"><span data-stu-id="89c42-136">We also need to update the *ServiceManifest.xml* file (under PackageRoot) of the project **VisualObjects.ActorService**.</span></span> <span data-ttu-id="89c42-137">Atualize o *CodePackage* e a versão de serviço para 2.0, bem como as linhas correspondentes no arquivo *ServiceManifest.xml*.</span><span class="sxs-lookup"><span data-stu-id="89c42-137">Update the *CodePackage* and the service version to 2.0, and the corresponding lines in the *ServiceManifest.xml* file.</span></span>
<span data-ttu-id="89c42-138">Você pode usar a opção *Editar Arquivos de Manifesto* do Visual Studio depois de clicar com o botão direito na solução para fazer as alterações no arquivo de manifesto.</span><span class="sxs-lookup"><span data-stu-id="89c42-138">You can use the Visual Studio *Edit Manifest Files* option after you right-click on the solution to make the manifest file changes.</span></span>

<span data-ttu-id="89c42-139">Depois que as alterações forem feitas, o manifesto deverá se parecer com o seguinte (as partes realçadas mostram as alterações):</span><span class="sxs-lookup"><span data-stu-id="89c42-139">After the changes are made, the manifest should look like the following (highlighted portions show the changes):</span></span>

```xml
<ServiceManifestName="VisualObjects.ActorService" Version="2.0" xmlns="http://schemas.microsoft.com/2011/01/fabric" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

<CodePackageName="Code" Version="2.0">
```

<span data-ttu-id="89c42-140">Agora, o arquivo *ApplicationManifest.xml* (localizado no projeto **VisualObjects** na solução **VisualObjects**) é atualizado para a versão 2.0 do projeto **VisualObjects.ActorService**.</span><span class="sxs-lookup"><span data-stu-id="89c42-140">Now the *ApplicationManifest.xml* file (found under the **VisualObjects** project under the **VisualObjects** solution) is updated to version 2.0 of the **VisualObjects.ActorService** project.</span></span> <span data-ttu-id="89c42-141">Além disso, a versão do aplicativo é atualizada para 2.0.0.0 de 1.0.0.0.</span><span class="sxs-lookup"><span data-stu-id="89c42-141">In addition, the Application version is updated to 2.0.0.0 from 1.0.0.0.</span></span> <span data-ttu-id="89c42-142">O *ApplicationManifest.xml* deve se parecer com o seguinte trecho:</span><span class="sxs-lookup"><span data-stu-id="89c42-142">The *ApplicationManifest.xml* should look like the following snippet:</span></span>

```xml
<ApplicationManifestxmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" ApplicationTypeName="VisualObjects" ApplicationTypeVersion="2.0.0.0" xmlns="http://schemas.microsoft.com/2011/01/fabric">

 <ServiceManifestRefServiceManifestName="VisualObjects.ActorService" ServiceManifestVersion="2.0" />
```


<span data-ttu-id="89c42-143">Agora, compile o projeto selecionando apenas o projeto **ActorService**, clicando com o botão direito do mouse e selecionando **Compilar** no Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="89c42-143">Now, build the project by selecting just the **ActorService** project, and then right-clicking and selecting the **Build** option in Visual Studio.</span></span> <span data-ttu-id="89c42-144">Se você selecionar **Recompilar todos**, deverá atualizar as versões de todos os projetos, pois o código pode ter sido alterado.</span><span class="sxs-lookup"><span data-stu-id="89c42-144">If you select **Rebuild all**, you should update the versions for all projects, since the code would have changed.</span></span> <span data-ttu-id="89c42-145">Agora, vamos empacotar o aplicativo atualizado clicando com o botão direito do mouse em ***VisualObjectsApplication***, selecionando o menu do Service Fabric e escolhendo **Pacote**.</span><span class="sxs-lookup"><span data-stu-id="89c42-145">Next, let's package the updated application by right-clicking on ***VisualObjectsApplication***, selecting the Service Fabric Menu, and choosing **Package**.</span></span> <span data-ttu-id="89c42-146">Essa ação cria um pacote de aplicativos que pode ser implantado.</span><span class="sxs-lookup"><span data-stu-id="89c42-146">This action creates an application package that can be deployed.</span></span>  <span data-ttu-id="89c42-147">Seu aplicativo atualizado está pronto para ser implantado.</span><span class="sxs-lookup"><span data-stu-id="89c42-147">Your updated application is ready to be deployed.</span></span>

## <a name="step-3--decide-on-health-policies-and-upgrade-parameters"></a><span data-ttu-id="89c42-148">Etapa 3: decida sobre diretivas de integridade e parâmetros de atualização</span><span class="sxs-lookup"><span data-stu-id="89c42-148">Step 3:  Decide on health policies and upgrade parameters</span></span>
<span data-ttu-id="89c42-149">Familiarize-se com os [parâmetros de atualização de aplicativo](service-fabric-application-upgrade-parameters.md) e o [processo de atualização](service-fabric-application-upgrade.md) para obter uma boa compreensão dos vários parâmetros de atualização, os tempos limite e o critério de integridade aplicados.</span><span class="sxs-lookup"><span data-stu-id="89c42-149">Familiarize yourself with the [application upgrade parameters](service-fabric-application-upgrade-parameters.md) and the [upgrade process](service-fabric-application-upgrade.md) to get a good understanding of the various upgrade parameters, time-outs, and health criterion applied.</span></span> <span data-ttu-id="89c42-150">Para este passo a passo, o critério de avaliação de integridade do serviço é definido como o padrão (e valores recomendados), o que significa que todos os serviços e as instâncias devem estar *íntegros* após a atualização.</span><span class="sxs-lookup"><span data-stu-id="89c42-150">For this walkthrough, the service health evaluation criterion is set to the default (and recommended) values, which means that all services and instances should be *healthy* after the upgrade.</span></span>  

<span data-ttu-id="89c42-151">Vamos, no entanto, aumentar *HealthCheckStableDuration* para 60 segundos (de modo que os serviços estejam íntegros pelo menos 20 segundos antes que a atualização prossiga para o próximo domínio de atualização).</span><span class="sxs-lookup"><span data-stu-id="89c42-151">However, let's increase the *HealthCheckStableDuration* to 60 seconds (so that the services are healthy for at least 20 seconds before the upgrade proceeds to the next update domain).</span></span>  <span data-ttu-id="89c42-152">Vamos definir também *UpgradeDomainTimeout* para 1.200 segundos e *UpgradeTimeout* para 3.000 segundos.</span><span class="sxs-lookup"><span data-stu-id="89c42-152">Let's also set the *UpgradeDomainTimeout* to be 1200 seconds and the *UpgradeTimeout* to be 3000 seconds.</span></span>

<span data-ttu-id="89c42-153">Por fim, vamos definir também *UpgradeFailureAction* para reversão.</span><span class="sxs-lookup"><span data-stu-id="89c42-153">Finally, let's also set the *UpgradeFailureAction* to rollback.</span></span> <span data-ttu-id="89c42-154">Essa opção exige que o Service Fabric reverta o aplicativo para a versão anterior caso encontre problemas durante a atualização.</span><span class="sxs-lookup"><span data-stu-id="89c42-154">This option requires Service Fabric to roll back the application to the previous version if it encounters any issues during the upgrade.</span></span> <span data-ttu-id="89c42-155">Portanto, ao iniciar a atualização (na etapa 4), os seguintes parâmetros são especificados:</span><span class="sxs-lookup"><span data-stu-id="89c42-155">Thus, when starting the upgrade (in Step 4), the following parameters are specified:</span></span>

<span data-ttu-id="89c42-156">FailureAction = Rollback</span><span class="sxs-lookup"><span data-stu-id="89c42-156">FailureAction = Rollback</span></span>

<span data-ttu-id="89c42-157">HealthCheckStableDurationSec = 60</span><span class="sxs-lookup"><span data-stu-id="89c42-157">HealthCheckStableDurationSec = 60</span></span>

<span data-ttu-id="89c42-158">UpgradeDomainTimeoutSec = 1200</span><span class="sxs-lookup"><span data-stu-id="89c42-158">UpgradeDomainTimeoutSec = 1200</span></span>

<span data-ttu-id="89c42-159">UpgradeTimeout = 3000</span><span class="sxs-lookup"><span data-stu-id="89c42-159">UpgradeTimeout = 3000</span></span>

## <a name="step-4-prepare-application-for-upgrade"></a><span data-ttu-id="89c42-160">Etapa 4: preparar o aplicativo para atualização</span><span class="sxs-lookup"><span data-stu-id="89c42-160">Step 4: Prepare application for upgrade</span></span>
<span data-ttu-id="89c42-161">Agora, o aplicativo está compilado e pronto para ser atualizado.</span><span class="sxs-lookup"><span data-stu-id="89c42-161">Now the application is built and ready to be upgraded.</span></span> <span data-ttu-id="89c42-162">Se você abrir uma janela do PowerShell como administrador e digitar [Get-ServiceFabricApplication](/powershell/module/servicefabric/get-servicefabricapplication?view=azureservicefabricps), será informado de que o aplicativo tipo 1.0.0.0 do **VisualObjects** foi implantado.</span><span class="sxs-lookup"><span data-stu-id="89c42-162">If you open up a PowerShell window as an administrator and type [Get-ServiceFabricApplication](/powershell/module/servicefabric/get-servicefabricapplication?view=azureservicefabricps), it should let you know that it is application type 1.0.0.0 of **VisualObjects** that's been deployed.</span></span>  

<span data-ttu-id="89c42-163">O pacote de aplicativos é armazenado no seguinte caminho relativo onde você descompactou o SDK de Service Fabric - *Samples\Services\Stateful\VisualObjects\VisualObjects\obj\x64\Debug*.</span><span class="sxs-lookup"><span data-stu-id="89c42-163">The application package is stored under the following relative path where you uncompressed the Service Fabric SDK - *Samples\Services\Stateful\VisualObjects\VisualObjects\obj\x64\Debug*.</span></span> <span data-ttu-id="89c42-164">Você deve localizar uma pasta "Pacote" nesse diretório, no qual o pacote de aplicativos está armazenado.</span><span class="sxs-lookup"><span data-stu-id="89c42-164">You should find a "Package" folder in that directory, where the application package is stored.</span></span> <span data-ttu-id="89c42-165">Verifique os carimbos de data/hora para garantir que é o build mais recente (talvez seja necessário modificar os caminhos adequadamente também).</span><span class="sxs-lookup"><span data-stu-id="89c42-165">Check the timestamps to ensure that it is the latest build (you may need to modify the paths appropriately as well).</span></span>

<span data-ttu-id="89c42-166">Agora vamos copiar o pacote de aplicativo atualizado para o ImageStore de Malha do serviço (onde os pacotes de aplicativos são armazenados pela Malha do serviço).</span><span class="sxs-lookup"><span data-stu-id="89c42-166">Now let's copy the updated application package to the Service Fabric ImageStore (where the application packages are stored by Service Fabric).</span></span> <span data-ttu-id="89c42-167">O parâmetro *ApplicationPackagePathInImageStore* informa à Malha de serviço onde ela pode encontrar o pacote do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="89c42-167">The parameter *ApplicationPackagePathInImageStore* informs Service Fabric where it can find the application package.</span></span> <span data-ttu-id="89c42-168">Criamos o aplicativo atualizado no "VisualObjects\_V2" com o seguinte comando (pode ser que você tenha que modificar novamente os caminhos).</span><span class="sxs-lookup"><span data-stu-id="89c42-168">We have put the updated application in "VisualObjects\_V2" with the following command (you may need to modify paths again appropriately).</span></span>

```powershell
Copy-ServiceFabricApplicationPackage  -ApplicationPackagePath .\Samples\Services\Stateful\VisualObjects\VisualObjects\obj\x64\Debug\Package
-ImageStoreConnectionString fabric:ImageStore   -ApplicationPackagePathInImageStore "VisualObjects\_V2"
```

<span data-ttu-id="89c42-169">A próxima etapa será registrar esse aplicativo no Service Fabric, o que pode ser feito usando o comando [Register-ServiceFabricApplicationType](/powershell/module/servicefabric/register-servicefabricapplicationtype?view=azureservicefabricps):</span><span class="sxs-lookup"><span data-stu-id="89c42-169">The next step is to register this application with Service Fabric, which can be performed using the [Register-ServiceFabricApplicationType](/powershell/module/servicefabric/register-servicefabricapplicationtype?view=azureservicefabricps) command:</span></span>

```powershell
Register-ServiceFabricApplicationType -ApplicationPathInImageStore "VisualObjects\_V2"
```

<span data-ttu-id="89c42-170">Caso o comando anterior não funcione, é provável que você precise recompilar todos os serviços.</span><span class="sxs-lookup"><span data-stu-id="89c42-170">If the preceding command doesn't succeed, it is likely that you need a rebuild of all services.</span></span> <span data-ttu-id="89c42-171">Conforme mencionado na Etapa 2, você terá que atualizar sua versão do serviço Web.</span><span class="sxs-lookup"><span data-stu-id="89c42-171">As mentioned in Step 2, you may have to update your WebService version as well.</span></span>

## <a name="step-5-start-the-application-upgrade"></a><span data-ttu-id="89c42-172">Etapa 5: iniciar a atualização do aplicativo</span><span class="sxs-lookup"><span data-stu-id="89c42-172">Step 5: Start the application upgrade</span></span>
<span data-ttu-id="89c42-173">Agora podemos iniciar a atualização do aplicativo usando o comando [Start-ServiceFabricApplicationUpgrade](/powershell/module/servicefabric/start-servicefabricapplicationupgrade?view=azureservicefabricps):</span><span class="sxs-lookup"><span data-stu-id="89c42-173">Now, we're all set to start the application upgrade by using the [Start-ServiceFabricApplicationUpgrade](/powershell/module/servicefabric/start-servicefabricapplicationupgrade?view=azureservicefabricps) command:</span></span>

```powershell
Start-ServiceFabricApplicationUpgrade -ApplicationName fabric:/VisualObjects -ApplicationTypeVersion 2.0.0.0 -HealthCheckStableDurationSec 60 -UpgradeDomainTimeoutSec 1200 -UpgradeTimeout 3000   -FailureAction Rollback -Monitored
```


<span data-ttu-id="89c42-174">O nome do aplicativo é o mesmo descrito no arquivo *ApplicationManifest.xml* .</span><span class="sxs-lookup"><span data-stu-id="89c42-174">The application name is the same as it was described in the *ApplicationManifest.xml* file.</span></span> <span data-ttu-id="89c42-175">A Malha de serviços usa esse nome para identificar qual aplicativo está sendo atualizado.</span><span class="sxs-lookup"><span data-stu-id="89c42-175">Service Fabric uses this name to identify which application is getting upgraded.</span></span> <span data-ttu-id="89c42-176">Se você definir tempos limite muito curtos, poderá encontrar uma mensagem de erro informando o problema.</span><span class="sxs-lookup"><span data-stu-id="89c42-176">If you set the time-outs to be too short, you may encounter a failure message that states the problem.</span></span> <span data-ttu-id="89c42-177">Consulte a seção de solução de problemas ou aumente os tempos limite.</span><span class="sxs-lookup"><span data-stu-id="89c42-177">Refer to the troubleshooting section, or increase the time-outs.</span></span>

<span data-ttu-id="89c42-178">Agora, enquanto a atualização do aplicativo está sendo realizada, você pode monitorá-lo usando o Service Fabric Explorer ou usando o comando do PowerShell [Get-ServiceFabricApplicationUpgrade](/powershell/module/servicefabric/get-servicefabricapplicationupgrade?view=azureservicefabricps):</span><span class="sxs-lookup"><span data-stu-id="89c42-178">Now, as the application upgrade proceeds, you can monitor it using Service Fabric Explorer, or by using the [Get-ServiceFabricApplicationUpgrade](/powershell/module/servicefabric/get-servicefabricapplicationupgrade?view=azureservicefabricps) PowerShell command:</span></span> 

```powershell
Get-ServiceFabricApplicationUpgrade fabric:/VisualObjects
```

<span data-ttu-id="89c42-179">Em alguns minutos, o status recebido que usa o comando do PowerShell acima deve indicar que todos os domínios de atualização foram atualizados (concluído).</span><span class="sxs-lookup"><span data-stu-id="89c42-179">In a few minutes, the status that you got by using the preceding PowerShell command, should state that all update domains were upgraded (completed).</span></span> <span data-ttu-id="89c42-180">E você deve notar que os objetos visuais na janela do navegador começaram a girar!</span><span class="sxs-lookup"><span data-stu-id="89c42-180">And you should find that the visual objects in your browser window have started rotating!</span></span>

<span data-ttu-id="89c42-181">Você pode tentar atualizar da versão 2 para a versão 3 ou da versão 2 para a versão 1 como um exercício.</span><span class="sxs-lookup"><span data-stu-id="89c42-181">You can try upgrading from version 2 to version 3, or from version 2 to version 1 as an exercise.</span></span> <span data-ttu-id="89c42-182">Migrar da versão 2 para a versão 1 também é considerado uma atualização.</span><span class="sxs-lookup"><span data-stu-id="89c42-182">Moving from version 2 to version 1 is also considered an upgrade.</span></span> <span data-ttu-id="89c42-183">Teste as possibilidades com políticas de integridade e tempos limite para ficar familiarizado com eles.</span><span class="sxs-lookup"><span data-stu-id="89c42-183">Play with time-outs and health policies to make yourself familiar with them.</span></span> <span data-ttu-id="89c42-184">Quando você estiver implantando um cluster do Azure, os parâmetros precisarão ser definidos corretamente.</span><span class="sxs-lookup"><span data-stu-id="89c42-184">When you are deploying to an Azure cluster, the parameters need to be set appropriately.</span></span> <span data-ttu-id="89c42-185">É bom definir os tempos limite de forma prudente.</span><span class="sxs-lookup"><span data-stu-id="89c42-185">It is good to set the time-outs conservatively.</span></span>

## <a name="next-steps"></a><span data-ttu-id="89c42-186">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="89c42-186">Next steps</span></span>
<span data-ttu-id="89c42-187">[Atualização do aplicativo usando o Visual Studio](service-fabric-application-upgrade-tutorial.md) orienta você durante a atualização de aplicativo usando o Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="89c42-187">[Upgrading your application using Visual Studio](service-fabric-application-upgrade-tutorial.md) walks you through an application upgrade using Visual Studio.</span></span>

<span data-ttu-id="89c42-188">Controle como seu aplicativo é atualizado usando [parâmetros de atualização](service-fabric-application-upgrade-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="89c42-188">Control how your application upgrades by using [upgrade parameters](service-fabric-application-upgrade-parameters.md).</span></span>

<span data-ttu-id="89c42-189">Torne suas atualizações de aplicativo compatíveis aprendendo a usar a [serialização de dados](service-fabric-application-upgrade-data-serialization.md).</span><span class="sxs-lookup"><span data-stu-id="89c42-189">Make your application upgrades compatible by learning how to use [data serialization](service-fabric-application-upgrade-data-serialization.md).</span></span>

<span data-ttu-id="89c42-190">Saiba como usar a funcionalidade avançada ao atualizar seu aplicativo consultando os [Tópicos avançados](service-fabric-application-upgrade-advanced.md).</span><span class="sxs-lookup"><span data-stu-id="89c42-190">Learn how to use advanced functionality while upgrading your application by referring to [Advanced topics](service-fabric-application-upgrade-advanced.md).</span></span>

<span data-ttu-id="89c42-191">Corrija problemas comuns em atualizações de aplicativo consultando as etapas em [Solução de problemas de atualizações de aplicativo](service-fabric-application-upgrade-troubleshooting.md).</span><span class="sxs-lookup"><span data-stu-id="89c42-191">Fix common problems in application upgrades by referring to the steps in [Troubleshooting application upgrades](service-fabric-application-upgrade-troubleshooting.md).</span></span>

