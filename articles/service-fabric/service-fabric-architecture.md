---
title: Arquitetura do Service Fabric do Azure | Microsoft Docs
description: "A Malha do Serviço é uma plataforma de sistemas distribuídos usada para criar aplicativos escalonáveis, confiáveis e facilmente gerenciados para a nuvem. Este artigo mostra a arquitetura da malha de serviço."
services: service-fabric
documentationcenter: .net
author: rishirsinha
manager: timlt
editor: rishirsinha
ms.assetid: 6b554243-70cb-4c22-9b28-1a8b4703f45e
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 04/19/2017
ms.author: rsinha
ms.openlocfilehash: 3cf019bf9a08574c984e92985452df438f3eeb77
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 07/11/2017
---
# <a name="service-fabric-architecture"></a><span data-ttu-id="d43bb-104">Arquitetura do Service Fabric</span><span class="sxs-lookup"><span data-stu-id="d43bb-104">Service Fabric architecture</span></span>
<span data-ttu-id="d43bb-105">O Service Fabric é criado com subsistemas em camadas.</span><span class="sxs-lookup"><span data-stu-id="d43bb-105">Service Fabric is built with layered subsystems.</span></span> <span data-ttu-id="d43bb-106">Esses subsistemas permitem escrever aplicativos:</span><span class="sxs-lookup"><span data-stu-id="d43bb-106">These subsystems enable you to write applications that are:</span></span>

* <span data-ttu-id="d43bb-107">Altamente disponível</span><span class="sxs-lookup"><span data-stu-id="d43bb-107">Highly available</span></span>
* <span data-ttu-id="d43bb-108">Escalonável</span><span class="sxs-lookup"><span data-stu-id="d43bb-108">Scalable</span></span>
* <span data-ttu-id="d43bb-109">Gerenciáveis</span><span class="sxs-lookup"><span data-stu-id="d43bb-109">Manageable</span></span>
* <span data-ttu-id="d43bb-110">Testável</span><span class="sxs-lookup"><span data-stu-id="d43bb-110">Testable</span></span>

<span data-ttu-id="d43bb-111">A figura a seguir mostra os subsistemas principais do Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="d43bb-111">The following diagram shows the major subsystems of Service Fabric.</span></span>

![Diagrama da arquitetura do Service Fabric](media/service-fabric-architecture/service-fabric-architecture.png)

<span data-ttu-id="d43bb-113">Em um sistema distribuído, a capacidade de estabelecer uma comunicação segura entre os nós em um cluster é crucial.</span><span class="sxs-lookup"><span data-stu-id="d43bb-113">In a distributed system, the ability to securely communicate between nodes in a cluster is crucial.</span></span> <span data-ttu-id="d43bb-114">Na base da pilha está o subsistema de transporte, que fornece comunicação segura entre os nós.</span><span class="sxs-lookup"><span data-stu-id="d43bb-114">At the base of the stack is the transport subsystem, which provides secure communication between nodes.</span></span> <span data-ttu-id="d43bb-115">Acima do subsistema de transporte, encontra-se o subsistema de federação, que agrupa os diferentes nós em uma única entidade (clusters nomeados) para que o Service Fabric possa detectar falhas, executar eleição de líder e permitir o roteamento de forma consistente.</span><span class="sxs-lookup"><span data-stu-id="d43bb-115">Above the transport subsystem lies the federation subsystem, which clusters the different nodes into a single entity (named clusters) so that Service Fabric can detect failures, perform leader election, and provide consistent routing.</span></span> <span data-ttu-id="d43bb-116">O subsistema de confiabilidade, na camada mais alta do subsistema de federação, é responsável pela confiabilidade dos serviços do Service Fabric por meio de mecanismos como replicação, gerenciamento de recursos e failover.</span><span class="sxs-lookup"><span data-stu-id="d43bb-116">The reliability subsystem, layered on top of the federation subsystem, is responsible for the reliability of Service Fabric services through mechanisms such as replication, resource management, and failover.</span></span> <span data-ttu-id="d43bb-117">O subsistema de federação também serve como base para o subsistema de hospedagem e de ativação, que gerencia o ciclo de vida de um aplicativo em um único nó.</span><span class="sxs-lookup"><span data-stu-id="d43bb-117">The federation subsystem also underlies the hosting and activation subsystem, which manages the lifecycle of an application on a single node.</span></span> <span data-ttu-id="d43bb-118">O subsistema de gerenciamento gerencia o ciclo de vida de aplicativos e de serviços.</span><span class="sxs-lookup"><span data-stu-id="d43bb-118">The management subsystem manages the lifecycle of applications and services.</span></span> <span data-ttu-id="d43bb-119">O subsistema de capacidade de teste ajuda os desenvolvedores de aplicativos a testar seus serviços por meio de falhas simuladas antes e depois da implantação de aplicativos e de serviços em ambientes de produção.</span><span class="sxs-lookup"><span data-stu-id="d43bb-119">The testability subsystem helps application developers test their services through simulated faults before and after deploying applications and services to production environments.</span></span> <span data-ttu-id="d43bb-120">O Service Fabric oferece a capacidade de resolver locais de serviço por meio de seu subsistema de comunicação.</span><span class="sxs-lookup"><span data-stu-id="d43bb-120">Service Fabric provides the ability to resolve service locations through its communication subsystem.</span></span> <span data-ttu-id="d43bb-121">Os modelos de programação de aplicativo apresentados aos desenvolvedores estão em camadas sobre esses subsistemas, junto com o modelo de aplicativo para habilitar as ferramentas.</span><span class="sxs-lookup"><span data-stu-id="d43bb-121">The application programming models exposed to developers are layered on top of these subsystems along with the application model to enable tooling.</span></span>

## <a name="transport-subsystem"></a><span data-ttu-id="d43bb-122">Subsistema de transporte</span><span class="sxs-lookup"><span data-stu-id="d43bb-122">Transport subsystem</span></span>
<span data-ttu-id="d43bb-123">O subsistema de transporte implementa um canal de comunicação de datagrama ponto a ponto.</span><span class="sxs-lookup"><span data-stu-id="d43bb-123">The transport subsystem implements a point-to-point datagram communication channel.</span></span> <span data-ttu-id="d43bb-124">Esse canal é usado para a comunicação dentro de clusters do Service Fabric e para a comunicação entre clientes e o cluster do Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="d43bb-124">This channel is used for communication within service fabric clusters and communication between the service fabric cluster and clients.</span></span> <span data-ttu-id="d43bb-125">Ele dá suporte a padrão de comunicação unidirecional e de solicitação-resposta, que oferece a base para a implementação de difusão e de multicast na camada de Federação.</span><span class="sxs-lookup"><span data-stu-id="d43bb-125">It supports one-way and request-reply communication patterns, which provides the basis for implementing broadcast and multicast in the Federation layer.</span></span> <span data-ttu-id="d43bb-126">O subsistema de transporte protege a comunicação usando certificados X509 ou segurança do Windows.</span><span class="sxs-lookup"><span data-stu-id="d43bb-126">The transport subsystem secures communication by using X509 certificates or Windows security.</span></span> <span data-ttu-id="d43bb-127">Esse subsistema é usado internamente pelo Service Fabric e não pode ser acessado diretamente pelos desenvolvedores para a programação de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="d43bb-127">This subsystem is used internally by Service Fabric and is not directly accessible to developers for application programming.</span></span>

## <a name="federation-subsystem"></a><span data-ttu-id="d43bb-128">Subsistema de federação</span><span class="sxs-lookup"><span data-stu-id="d43bb-128">Federation subsystem</span></span>
<span data-ttu-id="d43bb-129">Para justificar um conjunto de nós em um sistema distribuído, você precisa ter uma visão consistente do sistema.</span><span class="sxs-lookup"><span data-stu-id="d43bb-129">In order to reason about a set of nodes in a distributed system, you need to have a consistent view of the system.</span></span> <span data-ttu-id="d43bb-130">O subsistema de federação usa os primitivos da comunicação fornecidos pelo subsistema de transporte e junta vários nós em um único cluster unificado que ele pode justificar.</span><span class="sxs-lookup"><span data-stu-id="d43bb-130">The federation subsystem uses the communication primitives provided by the transport subsystem and stitches the various nodes into a single unified cluster that it can reason about.</span></span> <span data-ttu-id="d43bb-131">Ele fornece os primitivos de sistemas distribuídos necessários para outros subsistemas - detecção de falhas, eleição de líder e roteamento consistente.</span><span class="sxs-lookup"><span data-stu-id="d43bb-131">It provides the distributed systems primitives needed by the other subsystems - failure detection, leader election, and consistent routing.</span></span> <span data-ttu-id="d43bb-132">O subsistema de federação é criado sobre tabelas de hash distribuídas com um espaço de token de 128 bits.</span><span class="sxs-lookup"><span data-stu-id="d43bb-132">The federation subsystem is built on top of distributed hash tables with a 128-bit token space.</span></span> <span data-ttu-id="d43bb-133">O subsistema cria uma topologia de anel sobre os nós, com cada nó no anel sendo alocado a um subconjunto do espaço de token para a propriedade.</span><span class="sxs-lookup"><span data-stu-id="d43bb-133">The subsystem creates a ring topology over the nodes, with each node in the ring being allocated a subset of the token space for ownership.</span></span> <span data-ttu-id="d43bb-134">Para detecção de falha, a camada usa um mecanismo de concessão baseado em heartbeat e arbitragem.</span><span class="sxs-lookup"><span data-stu-id="d43bb-134">For failure detection, the layer uses a leasing mechanism based on heart beating and arbitration.</span></span> <span data-ttu-id="d43bb-135">O subsistema de federação também garante através de uma junção complexa e protocolos de saída que somente um único proprietário de um token exista a qualquer momento.</span><span class="sxs-lookup"><span data-stu-id="d43bb-135">The federation subsystem also guarantees through intricate join and departure protocols that only a single owner of a token exists at any time.</span></span> <span data-ttu-id="d43bb-136">Isso oferece garantias de eleição de líder e de roteamento consistente.</span><span class="sxs-lookup"><span data-stu-id="d43bb-136">This provides leader election and consistent routing guarantees.</span></span>

## <a name="reliability-subsystem"></a><span data-ttu-id="d43bb-137">Subsistema de confiabilidade</span><span class="sxs-lookup"><span data-stu-id="d43bb-137">Reliability subsystem</span></span>
<span data-ttu-id="d43bb-138">O subsistema de confiabilidade fornece o mecanismo para manter o estado de um serviço do Service Fabric altamente disponível por meio do uso do *Replicator*, do *Gerenciador de Failover* e do *Balanceador de Recurso*.</span><span class="sxs-lookup"><span data-stu-id="d43bb-138">The reliability subsystem provides the mechanism to make the state of a Service Fabric service highly available through the use of the *Replicator*, *Failover Manager*, and *Resource Balancer*.</span></span>

* <span data-ttu-id="d43bb-139">O Replicador garante que as alterações de estado da réplica principal serviço automaticamente serão replicadas para réplicas secundárias, mantendo a consistência entre as réplicas primárias e secundárias em um conjunto de réplicas do serviço.</span><span class="sxs-lookup"><span data-stu-id="d43bb-139">The Replicator ensures that state changes in the primary service replica will automatically be replicated to secondary replicas, maintaining consistency between the primary and secondary replicas in a service replica set.</span></span> <span data-ttu-id="d43bb-140">O replicador é responsável pelo gerenciamento de quorum entre as réplicas no conjunto de réplicas.</span><span class="sxs-lookup"><span data-stu-id="d43bb-140">The replicator is responsible for quorum management among the replicas in the replica set.</span></span> <span data-ttu-id="d43bb-141">Ele interage com a unidade de failover para obter a lista de operações a replicar, e o agente de reconfiguração fornece-a com a configuração do conjunto de réplicas.</span><span class="sxs-lookup"><span data-stu-id="d43bb-141">It interacts with the failover unit to get the list of operations to replicate, and the reconfiguration agent provides it with the configuration of the replica set.</span></span> <span data-ttu-id="d43bb-142">Essa configuração indica em quais réplicas as operações devem ser replicadas.</span><span class="sxs-lookup"><span data-stu-id="d43bb-142">That configuration indicates which replicas the operations need to be replicated.</span></span> <span data-ttu-id="d43bb-143">O Service Fabric fornece um replicador padrão chamado Fabric Replicator, que pode ser usado pela API de modelo de programação para tornar o estado do serviço altamente disponível e confiável.</span><span class="sxs-lookup"><span data-stu-id="d43bb-143">Service Fabric provides a default replicator called Fabric Replicator, which can be used by the programming model API to make the service state highly available and reliable.</span></span>
* <span data-ttu-id="d43bb-144">O Gerenciador de Failover garante que quando os nós forem adicionados ou removidos do cluster, a carga será automaticamente redistribuída entre os nós disponíveis.</span><span class="sxs-lookup"><span data-stu-id="d43bb-144">The Failover Manager ensures that when nodes are added to or removed from the cluster, the load is automatically redistributed across the available nodes.</span></span> <span data-ttu-id="d43bb-145">Se um nó do cluster falhar, o cluster automaticamente reconfigurará as réplicas de serviço para manter a disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="d43bb-145">If a node in the cluster fails, the cluster will automatically reconfigure the service replicas to maintain availability.</span></span>
* <span data-ttu-id="d43bb-146">O Gerenciador de Recursos coloca o domínio de falha entre réplicas de serviço no cluster e garante que todas as unidades de failover estejam operacionais.</span><span class="sxs-lookup"><span data-stu-id="d43bb-146">The Resource Manager places service replicas across failure domain in the cluster and ensures that all failover units are operational.</span></span> <span data-ttu-id="d43bb-147">O Gerenciador de Recursos também faz o balanceamento de recursos de serviço no pool compartilhado subjacente de nós de cluster para atingir a distribuição de carga uniforme ideal.</span><span class="sxs-lookup"><span data-stu-id="d43bb-147">The Resource Manager also balances service resources across the underlying shared pool of cluster nodes to achieve optimal uniform load distribution.</span></span>

## <a name="management-subsystem"></a><span data-ttu-id="d43bb-148">Subsistema de gerenciamento</span><span class="sxs-lookup"><span data-stu-id="d43bb-148">Management subsystem</span></span>
<span data-ttu-id="d43bb-149">O subsistema de gerenciamento oferece serviços de ponta a ponta e gerenciamento de ciclo de vida do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="d43bb-149">The management subsystem provides end-to-end service and application lifecycle management.</span></span> <span data-ttu-id="d43bb-150">Os cmdlets do PowerShell e as APIs administrativas permitem provisionar, implantar, corrigir, atualizar e desprovisionar aplicativos sem perda de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="d43bb-150">PowerShell cmdlets and administrative APIs enable you to provision, deploy, patch, upgrade, and de-provision applications without loss of availability.</span></span> <span data-ttu-id="d43bb-151">O subsistema de gerenciamento faz isso por meio dos serviços a seguir.</span><span class="sxs-lookup"><span data-stu-id="d43bb-151">The management subsystem performs this through the following services.</span></span>

* <span data-ttu-id="d43bb-152">**Gerenciador de Cluster**: esse é o principal serviço que interage com o Gerenciador de Failover de confiabilidade para posicionar os aplicativos nos nós com base nas restrições de posicionamento de serviço.</span><span class="sxs-lookup"><span data-stu-id="d43bb-152">**Cluster Manager**: This is the primary service that interacts with the Failover Manager from reliability to place the applications on the nodes based on the service placement constraints.</span></span> <span data-ttu-id="d43bb-153">O Gerenciador de Recursos no subsistema de failover faz com que as restrições nunca sejam desfeitas.</span><span class="sxs-lookup"><span data-stu-id="d43bb-153">The Resource Manager in failover subsystem ensures that the constraints are never broken.</span></span> <span data-ttu-id="d43bb-154">O gerenciador de cluster gerencia o ciclo de vida dos aplicativos de provisionamento para desprovisionamento.</span><span class="sxs-lookup"><span data-stu-id="d43bb-154">The cluster manager manages the lifecycle of the applications from provision to de-provision.</span></span> <span data-ttu-id="d43bb-155">Ele se integra ao gerenciador de integridade para garantir que a disponibilidade de aplicativos não seja perdida de uma perspectiva de semântica de integridade durante as atualizações.</span><span class="sxs-lookup"><span data-stu-id="d43bb-155">It integrates with the health manager to ensure that application availability is not lost from a semantic health perspective during upgrades.</span></span>
* <span data-ttu-id="d43bb-156">**Gerenciador de Integridade**: esse serviço permite o monitoramento de integridade de aplicativos, serviços e entidades de cluster.</span><span class="sxs-lookup"><span data-stu-id="d43bb-156">**Health Manager**: This service enables health monitoring of applications, services, and cluster entities.</span></span> <span data-ttu-id="d43bb-157">As entidades de cluster (como os nós, as partições de serviço e as réplicas) podem relatar informações de integridade, que são então agregadas a um repositório centralizado de integridade.</span><span class="sxs-lookup"><span data-stu-id="d43bb-157">Cluster entities (such as nodes, service partitions, and replicas) can report health information, which is then aggregated into the centralized health store.</span></span> <span data-ttu-id="d43bb-158">Essas informações de integridade fornecem um instantâneo da integridade geral de um ponto no tempo dos serviços e nós distribuídas em vários nós no cluster, permitindo que você tome as ações corretivas necessárias.</span><span class="sxs-lookup"><span data-stu-id="d43bb-158">This health information provides an overall point-in-time health snapshot of the services and nodes distributed across multiple nodes in the cluster, enabling you to take any needed corrective actions.</span></span> <span data-ttu-id="d43bb-159">As APIs de consulta de integridade permitem consultar os eventos de integridade relatados ao subsistema de integridade.</span><span class="sxs-lookup"><span data-stu-id="d43bb-159">Health query APIs enable you to query the health events reported to the health subsystem.</span></span> <span data-ttu-id="d43bb-160">As APIs de consulta de integridade retornam os dados brutos de integridade armazenados no repositório de integridade ou os dados de integridade agregados e interpretados de uma entidade de cluster específica.</span><span class="sxs-lookup"><span data-stu-id="d43bb-160">The health query APIs return the raw health data stored in the health store or the aggregated, interpreted health data for a specific cluster entity.</span></span>
* <span data-ttu-id="d43bb-161">**Repositório de Imagens**: esse serviço permite o armazenamento e a distribuição dos binários do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="d43bb-161">**Image Store**: This service provides storage and distribution of the application binaries.</span></span> <span data-ttu-id="d43bb-162">O serviço fornece armazenamento de arquivos distribuídos simples, onde os aplicativos são carregados e de onde são baixados.</span><span class="sxs-lookup"><span data-stu-id="d43bb-162">This service provides a simple distributed file store where the applications are uploaded to and downloaded from.</span></span>

## <a name="hosting-subsystem"></a><span data-ttu-id="d43bb-163">Subsistema de hospedagem</span><span class="sxs-lookup"><span data-stu-id="d43bb-163">Hosting subsystem</span></span>
<span data-ttu-id="d43bb-164">O gerenciador de cluster informa o subsistema de hospedagem (em execução em cada nó), os serviços que precisa para gerenciar um nó específico.</span><span class="sxs-lookup"><span data-stu-id="d43bb-164">The cluster manager informs the hosting subsystem (running on each node) which services it needs to manage for a particular node.</span></span> <span data-ttu-id="d43bb-165">O subsistema de hospedagem, em seguida, gerencia o ciclo de vida do aplicativo nesse nó.</span><span class="sxs-lookup"><span data-stu-id="d43bb-165">The hosting subsystem then manages the lifecycle of the application on that node.</span></span> <span data-ttu-id="d43bb-166">Ele interage com os componentes de confiabilidade e integridade para garantir que as réplicas estão posicionadas corretamente e estão íntegras.</span><span class="sxs-lookup"><span data-stu-id="d43bb-166">It interacts with the reliability and health components to ensure that the replicas are properly placed and are healthy.</span></span>

## <a name="communication-subsystem"></a><span data-ttu-id="d43bb-167">Subsistema de comunicação</span><span class="sxs-lookup"><span data-stu-id="d43bb-167">Communication subsystem</span></span>
<span data-ttu-id="d43bb-168">Esse subsistema fornece um sistema de mensagens confiável dentro do cluster e descoberta de serviço por meio do serviço de nomenclatura.</span><span class="sxs-lookup"><span data-stu-id="d43bb-168">This subsystem provides reliable messaging within the cluster and service discovery through the Naming service.</span></span> <span data-ttu-id="d43bb-169">O serviço de nomenclatura resolve nomes de serviço para um local no cluster e permite aos usuários gerenciar propriedades e nomes de serviço.</span><span class="sxs-lookup"><span data-stu-id="d43bb-169">The Naming service resolves service names to a location in the cluster and enables users to manage service names and properties.</span></span> <span data-ttu-id="d43bb-170">Usando o serviço de nomenclatura, os clientes podem comunicar-se com segurança com qualquer nó no cluster para resolver um nome de serviço e recuperar metadados de serviço.</span><span class="sxs-lookup"><span data-stu-id="d43bb-170">Using the Naming service, clients can securely communicate with any node in the cluster to resolve a service name and retrieve service metadata.</span></span> <span data-ttu-id="d43bb-171">Usando uma API de cliente de nomenclatura simples de nomenclatura, os usuários do Service Fabric podem desenvolver serviços e clientes capazes de resolver o local de rede atual, independentemente do dinamismo do nó ou do redimensionamento do cluster.</span><span class="sxs-lookup"><span data-stu-id="d43bb-171">Using a simple Naming client API, users of Service Fabric can develop services and clients capable of resolving the current network location despite node dynamism or the re-sizing of the cluster.</span></span>

## <a name="testability-subsystem"></a><span data-ttu-id="d43bb-172">Subsistema de capacidade de teste</span><span class="sxs-lookup"><span data-stu-id="d43bb-172">Testability subsystem</span></span>
<span data-ttu-id="d43bb-173">Capacidade de teste é um conjunto de ferramentas desenvolvidas especificamente para testar serviços criados com base na malha de serviço.</span><span class="sxs-lookup"><span data-stu-id="d43bb-173">Testability is a suite of tools specifically designed for testing services built on Service Fabric.</span></span> <span data-ttu-id="d43bb-174">As ferramentas permitem que um desenvolvedor induza com facilidade falhas significativas e execute cenários de teste para praticar e validar os vários estados e transições pelos quais o serviço passa durante o ciclo de vida, tudo de uma maneira segura e controlada.</span><span class="sxs-lookup"><span data-stu-id="d43bb-174">The tools let a developer easily induce meaningful faults and run test scenarios to exercise and validate the numerous states and transitions that a service will experience throughout its lifetime, all in a controlled and safe manner.</span></span> <span data-ttu-id="d43bb-175">A capacidade de teste também fornece um mecanismo para executar testes mais longos que podem iterar por várias possíveis falhas sem perder a disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="d43bb-175">Testability also provides a mechanism to run longer tests that can iterate through various possible failures without losing availability.</span></span> <span data-ttu-id="d43bb-176">Isso fornece a você um ambiente de teste em produção.</span><span class="sxs-lookup"><span data-stu-id="d43bb-176">This provides you with a test-in-production environment.</span></span>

