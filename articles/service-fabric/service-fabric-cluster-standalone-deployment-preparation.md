---
title: "Preparação para implantação de cluster autônomo do Azure Service Fabric | Microsoft Docs"
description: "Documentação relacionada à preparação do ambiente e à criação da configuração de cluster a ser considerada antes de implantar um cluster voltado para a manipulação de uma carga de trabalho de produção."
services: service-fabric
documentationcenter: .net
author: maburlik
manager: timlt
editor: 
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 1/17/2017
ms.author: maburlik;chackdan
ms.openlocfilehash: f332193f9a53260173a1010b8bf9f08726bea427
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 07/11/2017
---
<a id="preparemachines"></a>

## <a name="plan-and-prepare-your-service-fabric-standalone-cluster-deployment"></a><span data-ttu-id="90dad-103">Planejar e preparar a implantação de cluster autônomo do Service Fabric</span><span class="sxs-lookup"><span data-stu-id="90dad-103">Plan and prepare your Service Fabric standalone cluster deployment</span></span>
<span data-ttu-id="90dad-104">Execute as seguintes etapas antes de criar o cluster.</span><span class="sxs-lookup"><span data-stu-id="90dad-104">Perform the following steps before you create your cluster.</span></span>

### <a name="step-1-plan-your-cluster-infrastructure"></a><span data-ttu-id="90dad-105">Etapa 1: Planejar a infraestrutura de cluster</span><span class="sxs-lookup"><span data-stu-id="90dad-105">Step 1: Plan your cluster infrastructure</span></span>
<span data-ttu-id="90dad-106">Você está prestes a criar um cluster do Service Fabric em seus computadores. Sendo assim, você pode decidir a quais tipos de falhas deseja que o cluster sobreviva.</span><span class="sxs-lookup"><span data-stu-id="90dad-106">You are about to create a Service Fabric cluster on machines you own, so you can decide what kinds of failures you want the cluster to survive.</span></span> <span data-ttu-id="90dad-107">Por exemplo, você precisa separar as linhas de energia ou conexões de Internet fornecidas para os computadores?</span><span class="sxs-lookup"><span data-stu-id="90dad-107">For example, do you need separate power lines or Internet connections supplied to these machines?</span></span> <span data-ttu-id="90dad-108">Além disso, considere a segurança física dos computadores.</span><span class="sxs-lookup"><span data-stu-id="90dad-108">In addition, consider the physical security of these machines.</span></span> <span data-ttu-id="90dad-109">Onde os computadores estão localizados e quem precisa acessá-los?</span><span class="sxs-lookup"><span data-stu-id="90dad-109">Where are the machines located and who needs access to them?</span></span> <span data-ttu-id="90dad-110">Depois de tomar essas decisões, você poderá mapear logicamente os computadores para vários domínios de falha (confira a Etapa 4).</span><span class="sxs-lookup"><span data-stu-id="90dad-110">After you make these decisions, you can logically map the machines to the various fault domains (see Step 4).</span></span> <span data-ttu-id="90dad-111">O planejamento da infraestrutura para os clusters de produção está mais envolvido do que para os clusters de teste.</span><span class="sxs-lookup"><span data-stu-id="90dad-111">The infrastructure planning for production clusters is more involved than for test clusters.</span></span>

### <a name="step-2-prepare-the-machines-to-meet-the-prerequisites"></a><span data-ttu-id="90dad-112">Etapa 2: Preparar os computadores para atender os pré-requisitos</span><span class="sxs-lookup"><span data-stu-id="90dad-112">Step 2: Prepare the machines to meet the prerequisites</span></span>
<span data-ttu-id="90dad-113">Pré-requisitos para cada computador que você deseja adicionar ao cluster:</span><span class="sxs-lookup"><span data-stu-id="90dad-113">Prerequisites for each machine that you want to add to the cluster:</span></span>

* <span data-ttu-id="90dad-114">É recomendável, no mínimo, 16 GB de RAM.</span><span class="sxs-lookup"><span data-stu-id="90dad-114">A minimum of 16 GB of RAM is recommended.</span></span>
* <span data-ttu-id="90dad-115">É recomendável um espaço em disco disponível mínimo de 40 GB.</span><span class="sxs-lookup"><span data-stu-id="90dad-115">A minimum of 40 of GB available disk space is recommended.</span></span>
* <span data-ttu-id="90dad-116">É recomendável uma CPU com quatro núcleos ou mais.</span><span class="sxs-lookup"><span data-stu-id="90dad-116">A 4 core or greater CPU is recommended.</span></span>
* <span data-ttu-id="90dad-117">Conectividade com uma rede segura para todos os computadores.</span><span class="sxs-lookup"><span data-stu-id="90dad-117">Connectivity to a secure network or networks for all machines.</span></span>
* <span data-ttu-id="90dad-118">Windows Server 2012 R2 ou Windows Server 2016.</span><span class="sxs-lookup"><span data-stu-id="90dad-118">Windows Server 2012 R2 or Windows Server 2016.</span></span> 
* <span data-ttu-id="90dad-119">[.NET Framework 4.5.1 ou posterior](https://www.microsoft.com/download/details.aspx?id=40773), instalação completa.</span><span class="sxs-lookup"><span data-stu-id="90dad-119">[.NET Framework 4.5.1 or higher](https://www.microsoft.com/download/details.aspx?id=40773), full install.</span></span>
* <span data-ttu-id="90dad-120">[Windows PowerShell 3.0](https://msdn.microsoft.com/powershell/scripting/setup/installing-windows-powershell).</span><span class="sxs-lookup"><span data-stu-id="90dad-120">[Windows PowerShell 3.0](https://msdn.microsoft.com/powershell/scripting/setup/installing-windows-powershell).</span></span>
* <span data-ttu-id="90dad-121">O [serviço RemoteRegistry](https://technet.microsoft.com/library/cc754820) deve estar em execução em todos os computadores.</span><span class="sxs-lookup"><span data-stu-id="90dad-121">The [RemoteRegistry service](https://technet.microsoft.com/library/cc754820) should be running on all the machines.</span></span>

<span data-ttu-id="90dad-122">O administrador do cluster que implanta e configura o cluster deve ter [privilégios de administrador](https://social.technet.microsoft.com/wiki/contents/articles/13436.windows-server-2012-how-to-add-an-account-to-a-local-administrator-group.aspx) em cada um dos computadores.</span><span class="sxs-lookup"><span data-stu-id="90dad-122">The cluster administrator deploying and configuring the cluster must have [administrator privileges](https://social.technet.microsoft.com/wiki/contents/articles/13436.windows-server-2012-how-to-add-an-account-to-a-local-administrator-group.aspx) on each of the machines.</span></span> <span data-ttu-id="90dad-123">Você não pode instalar o Service Fabric em um controlador de domínio.</span><span class="sxs-lookup"><span data-stu-id="90dad-123">You cannot install Service Fabric on a domain controller.</span></span>

### <a name="step-3-determine-the-initial-cluster-size"></a><span data-ttu-id="90dad-124">Etapa 3: Determinar o tamanho inicial do cluster</span><span class="sxs-lookup"><span data-stu-id="90dad-124">Step 3: Determine the initial cluster size</span></span>
<span data-ttu-id="90dad-125">Cada nó em um cluster do Service Fabric autônomo tem o tempo de execução do Service Fabric implantado e é membro do cluster.</span><span class="sxs-lookup"><span data-stu-id="90dad-125">Each node in a standalone Service Fabric cluster has the Service Fabric runtime deployed and is a member of the cluster.</span></span> <span data-ttu-id="90dad-126">Em uma implantação típica de produção, há um nó por instância de SO (física ou virtual).</span><span class="sxs-lookup"><span data-stu-id="90dad-126">In a typical production deployment, there is one node per OS instance (physical or virtual).</span></span> <span data-ttu-id="90dad-127">O tamanho do cluster é determinado por suas necessidades comerciais.</span><span class="sxs-lookup"><span data-stu-id="90dad-127">The cluster size is determined by your business needs.</span></span> <span data-ttu-id="90dad-128">No entanto, seu cluster deve ter um tamanho mínimo de três nós (computadores ou máquinas virtuais).</span><span class="sxs-lookup"><span data-stu-id="90dad-128">However, you must have a minimum cluster size of three nodes (machines or virtual machines).</span></span>
<span data-ttu-id="90dad-129">Para fins de desenvolvimento, você pode ter mais de um nó em um determinado computador.</span><span class="sxs-lookup"><span data-stu-id="90dad-129">For development purposes, you can have more than one node on a given machine.</span></span> <span data-ttu-id="90dad-130">Em um ambiente de produção, o Service Fabric dá suporte apenas a um nó por máquina virtual ou física.</span><span class="sxs-lookup"><span data-stu-id="90dad-130">In a production environment, Service Fabric supports only one node per physical or virtual machine.</span></span>

### <a name="step-4-determine-the-number-of-fault-domains-and-upgrade-domains"></a><span data-ttu-id="90dad-131">Etapa 4: Determinar o número de domínios de falha e domínios de atualização</span><span class="sxs-lookup"><span data-stu-id="90dad-131">Step 4: Determine the number of fault domains and upgrade domains</span></span>
<span data-ttu-id="90dad-132">Um *FD* (Domínio de Falha) é uma unidade física de falha e está diretamente relacionada à infraestrutura física dos data centers.</span><span class="sxs-lookup"><span data-stu-id="90dad-132">A *fault domain* (FD) is a physical unit of failure and is directly related to the physical infrastructure in the data centers.</span></span> <span data-ttu-id="90dad-133">Um domínio de falha consiste em componentes de hardware (computadores, comutadores, redes, entre outros) que compartilham um ponto único de falha.</span><span class="sxs-lookup"><span data-stu-id="90dad-133">A fault domain consists of hardware components (computers, switches, networks, and more) that share a single point of failure.</span></span> <span data-ttu-id="90dad-134">Embora não haja um mapeamento individual entre domínios de falha e racks, de maneira geral, cada rack pode ser considerado um domínio de falha.</span><span class="sxs-lookup"><span data-stu-id="90dad-134">Although there is no 1:1 mapping between fault domains and racks, loosely speaking, each rack can be considered a fault domain.</span></span> <span data-ttu-id="90dad-135">Ao considerar os nós no cluster, recomendamos fortemente distribuir os nós entre pelo menos três domínios de falha.</span><span class="sxs-lookup"><span data-stu-id="90dad-135">When considering the nodes in your cluster, we strongly recommend that the nodes be distributed among at least three fault domains.</span></span>

<span data-ttu-id="90dad-136">Ao especificar FDs no ClusterConfig.json, você pode escolher o nome de cada FD.</span><span class="sxs-lookup"><span data-stu-id="90dad-136">When you specify FDs in ClusterConfig.json, you can choose the name for each FD.</span></span> <span data-ttu-id="90dad-137">O Service Fabric dá suporte a FDs hierárquicos, de modo que você pode refletir a topologia da sua infraestrutura neles.</span><span class="sxs-lookup"><span data-stu-id="90dad-137">Service Fabric supports hierarchical FDs, so you can reflect your infrastructure topology in them.</span></span>  <span data-ttu-id="90dad-138">Por exemplo, os seguintes FDs são válidos:</span><span class="sxs-lookup"><span data-stu-id="90dad-138">For example, the following FDs are valid:</span></span>

* <span data-ttu-id="90dad-139">"faultDomain": "fd:/Room1/Rack1/Machine1"</span><span class="sxs-lookup"><span data-stu-id="90dad-139">"faultDomain": "fd:/Room1/Rack1/Machine1"</span></span>
* <span data-ttu-id="90dad-140">"faultDomain": "fd:/FD1"</span><span class="sxs-lookup"><span data-stu-id="90dad-140">"faultDomain": "fd:/FD1"</span></span>
* <span data-ttu-id="90dad-141">"faultDomain": "fd:/Room1/Rack1/PDU1/M1"</span><span class="sxs-lookup"><span data-stu-id="90dad-141">"faultDomain": "fd:/Room1/Rack1/PDU1/M1"</span></span>

<span data-ttu-id="90dad-142">Um *UD* (Domínio de Atualização) é uma unidade lógica de nós.</span><span class="sxs-lookup"><span data-stu-id="90dad-142">An *upgrade domain* (UD) is a logical unit of nodes.</span></span> <span data-ttu-id="90dad-143">Durante as atualizações orquestradas do Service Fabric (atualização de aplicativo ou atualização de cluster), todos os nós em um UD são desativados para realizar a atualização, enquanto os nós em outros UDs permanecem disponíveis para atender às solicitações.</span><span class="sxs-lookup"><span data-stu-id="90dad-143">During Service Fabric orchestrated upgrades (either an application upgrade or a cluster upgrade), all nodes in a UD are taken down to perform the upgrade while nodes in other UDs remain available to serve requests.</span></span> <span data-ttu-id="90dad-144">As atualizações de firmware executadas em seus computadores não se aplicam a UDs, assim, é preciso fazê-las em um computador por vez.</span><span class="sxs-lookup"><span data-stu-id="90dad-144">The firmware upgrades you perform on your machines do not honor UDs, so you must do them one machine at a time.</span></span>

<span data-ttu-id="90dad-145">A maneira mais simples de pensar nesses conceitos é considerar os FDs como a unidade de falha não planejada e as UDs como a unidade de manutenção planejada.</span><span class="sxs-lookup"><span data-stu-id="90dad-145">The simplest way to think about these concepts is to consider FDs as the unit of unplanned failure and UDs as the unit of planned maintenance.</span></span>

<span data-ttu-id="90dad-146">Ao especificar UDs no ClusterConfig.json, você pode escolher o nome de cada UD.</span><span class="sxs-lookup"><span data-stu-id="90dad-146">When you specify UDs in ClusterConfig.json, you can choose the name for each UD.</span></span> <span data-ttu-id="90dad-147">Por exemplo, os seguintes nomes são válidos:</span><span class="sxs-lookup"><span data-stu-id="90dad-147">For example, the following names are valid:</span></span>

* <span data-ttu-id="90dad-148">"upgradeDomain": "UD0"</span><span class="sxs-lookup"><span data-stu-id="90dad-148">"upgradeDomain": "UD0"</span></span>
* <span data-ttu-id="90dad-149">"upgradeDomain": "UD1A"</span><span class="sxs-lookup"><span data-stu-id="90dad-149">"upgradeDomain": "UD1A"</span></span>
* <span data-ttu-id="90dad-150">"upgradeDomain": "DomainRed"</span><span class="sxs-lookup"><span data-stu-id="90dad-150">"upgradeDomain": "DomainRed"</span></span>
* <span data-ttu-id="90dad-151">"upgradeDomain": "Blue"</span><span class="sxs-lookup"><span data-stu-id="90dad-151">"upgradeDomain": "Blue"</span></span>

<span data-ttu-id="90dad-152">Para obter informações mais detalhadas sobre os domínios de atualização e de falha, confira [Describing a Service Fabric cluster](service-fabric-cluster-resource-manager-cluster-description.md) (Descrevendo um cluster do Service Fabric).</span><span class="sxs-lookup"><span data-stu-id="90dad-152">For more detailed information on upgrade domains and fault domains, see [Describing a Service Fabric cluster](service-fabric-cluster-resource-manager-cluster-description.md).</span></span>

### <a name="step-5-download-the-service-fabric-standalone-package-for-windows-server"></a><span data-ttu-id="90dad-153">Etapa 5: baixar o pacote autônomo do Service Fabric para Windows Server</span><span class="sxs-lookup"><span data-stu-id="90dad-153">Step 5: Download the Service Fabric standalone package for Windows Server</span></span>
<span data-ttu-id="90dad-154">[Baixe o Pacote autônomo do Service Fabric – Windows Server](http://go.microsoft.com/fwlink/?LinkId=730690) e descompacte o pacote para um computador de implantação que não faça parte do cluster ou para um dos computadores que farão parte do cluster.</span><span class="sxs-lookup"><span data-stu-id="90dad-154">[Download Link - Service Fabric Standalone Package - Windows Server](http://go.microsoft.com/fwlink/?LinkId=730690) and unzip the package, either to a deployment machine that is not part of the cluster, or to one of the machines that will be a part of your cluster.</span></span>

### <a name="step-6-modify-cluster-configuration"></a><span data-ttu-id="90dad-155">Etapa 6: modificar a configuração do cluster</span><span class="sxs-lookup"><span data-stu-id="90dad-155">Step 6: Modify cluster configuration</span></span>
<span data-ttu-id="90dad-156">Para criar um cluster autônomo, você precisa criar um arquivo de configuração de cluster autônomo ClusterConfig.json, que descreve a especificação do cluster.</span><span class="sxs-lookup"><span data-stu-id="90dad-156">To create a standalone cluster you have to create a standalone cluster configuration ClusterConfig.json file, which describes the specification of the cluster.</span></span> <span data-ttu-id="90dad-157">Você pode basear o arquivo de configuração nos modelos encontrados no link abaixo.</span><span class="sxs-lookup"><span data-stu-id="90dad-157">You can base the configuration file on the templates found at the below link.</span></span> <br><span data-ttu-id="90dad-158">
[Configurações de cluster autônomo](https://github.com/Azure-Samples/service-fabric-dotnet-standalone-cluster-configuration/tree/master/Samples)</span><span class="sxs-lookup"><span data-stu-id="90dad-158">
[Standalone Cluster Configurations](https://github.com/Azure-Samples/service-fabric-dotnet-standalone-cluster-configuration/tree/master/Samples)</span></span>

<span data-ttu-id="90dad-159">Para obter detalhes sobre as seções neste arquivo, confira [Definições de configuração para o cluster autônomo no Windows](service-fabric-cluster-manifest.md).</span><span class="sxs-lookup"><span data-stu-id="90dad-159">For details on the sections in this file, see [Configuration settings for standalone Windows cluster](service-fabric-cluster-manifest.md).</span></span>

<span data-ttu-id="90dad-160">Abra um dos arquivos ClusterConfig.json do pacote baixado e modifique as seguintes configurações:</span><span class="sxs-lookup"><span data-stu-id="90dad-160">Open one of the ClusterConfig.json files from the package you downloaded and modify the following settings:</span></span>
| <span data-ttu-id="90dad-161">**Parâmetro de configuração**</span><span class="sxs-lookup"><span data-stu-id="90dad-161">**Configuration Setting**</span></span> | <span data-ttu-id="90dad-162">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="90dad-162">**Description**</span></span> |
| --- | --- |
| <span data-ttu-id="90dad-163">**NodeTypes**</span><span class="sxs-lookup"><span data-stu-id="90dad-163">**NodeTypes**</span></span> |<span data-ttu-id="90dad-164">Os tipos de nós permitem separar os nós do cluster em vários grupos.</span><span class="sxs-lookup"><span data-stu-id="90dad-164">Node types allow you to separate your cluster nodes into various groups.</span></span> <span data-ttu-id="90dad-165">Um cluster precisa ter pelo menos um NodeType.</span><span class="sxs-lookup"><span data-stu-id="90dad-165">A cluster must have at least one NodeType.</span></span> <span data-ttu-id="90dad-166">Todos os nós em um grupo têm as seguintes características comuns: </span><span class="sxs-lookup"><span data-stu-id="90dad-166">All nodes in a group have the following common characteristics:</span></span> <br> <span data-ttu-id="90dad-167">**Nome** – esse é o nome do tipo de nó.</span><span class="sxs-lookup"><span data-stu-id="90dad-167">**Name** - This is the node type name.</span></span> <br><span data-ttu-id="90dad-168">**Portas do Ponto de Extremidade** : são vários pontos de extremidade (portas) nomeados que estão associados a esse tipo de nó.</span><span class="sxs-lookup"><span data-stu-id="90dad-168">**Endpoint Ports** - These are various named end points (ports) that are associated with this node type.</span></span> <span data-ttu-id="90dad-169">Você pode usar qualquer número de porta que desejar, desde que não entre em conflito com nada mais neste manifesto e já não esteja em uso por outro aplicativo em execução no computador/VM.</span><span class="sxs-lookup"><span data-stu-id="90dad-169">You can use any port number that you wish, as long as they do not conflict with anything else in this manifest and are not already in use by any other application running on the machine/VM.</span></span> <br> <span data-ttu-id="90dad-170">**Propriedades de posicionamento** – Descrevem as propriedades do tipo de nó que você usou como restrições de posicionamento para os serviços do sistema ou seus serviços.</span><span class="sxs-lookup"><span data-stu-id="90dad-170">**Placement Properties** - These describe properties for this node type that you use as placement constraints for the system services or your services.</span></span> <span data-ttu-id="90dad-171">Essas propriedades são pares de chave/valor definidos pelo usuário que fornecem metadados extras para um determinado nó.</span><span class="sxs-lookup"><span data-stu-id="90dad-171">These properties are user-defined key/value pairs that provide extra meta data for a given node.</span></span> <span data-ttu-id="90dad-172">Exemplos de propriedades de nó incluem se o nó temum disco rígido ou uma placa de vídeo, o número de eixos no disco rígido, núcleos e outras propriedades físicas.</span><span class="sxs-lookup"><span data-stu-id="90dad-172">Examples of node properties would be whether the node has a hard drive or graphics card, the number of spindles in its hard drive, cores, and other physical properties.</span></span> <br> <span data-ttu-id="90dad-173">**Capacidades** : as capacidades do nó definem o nome e a quantidade de um recurso específico que um determinado nó tem disponível para consumo.</span><span class="sxs-lookup"><span data-stu-id="90dad-173">**Capacities** - Node capacities define the name and amount of a particular resource that a particular node has available for consumption.</span></span> <span data-ttu-id="90dad-174">Por exemplo, um nó pode definir que tem capacidade para uma métrica chamada "MemoryInMb" e que tem 2048 MB de memória disponível por padrão.</span><span class="sxs-lookup"><span data-stu-id="90dad-174">For example, a node may define that it has capacity for a metric called “MemoryInMb” and that it has 2048 MB available by default.</span></span> <span data-ttu-id="90dad-175">Essas capacidades são usadas no tempo de execução para garantir que os serviços que exigem quantidades específicas de recursos sejam colocados em nós que tenham esses recursos disponíveis nas quantidades necessárias.</span><span class="sxs-lookup"><span data-stu-id="90dad-175">These capacities are used at runtime to ensure that services that require particular amounts of resources are placed on the nodes that have those resources available in the required amounts.</span></span><br><span data-ttu-id="90dad-176">**IsPrimary** – se você tiver mais de um NodeType definido, verifique se somente um está definido como principal com o valor *true*, que é onde os serviços do sistema são executados.</span><span class="sxs-lookup"><span data-stu-id="90dad-176">**IsPrimary** - If you have more than one NodeType defined ensure that only one is set to primary with the value *true*, which is where the system services run.</span></span> <span data-ttu-id="90dad-177">Todos os outros tipos de nó devem ser definidos para o valor *false*</span><span class="sxs-lookup"><span data-stu-id="90dad-177">All other node types should be set to the value *false*</span></span> |
| <span data-ttu-id="90dad-178">**Nós**</span><span class="sxs-lookup"><span data-stu-id="90dad-178">**Nodes**</span></span> |<span data-ttu-id="90dad-179">Esses são os detalhes de cada um dos nós que fazem parte do cluster (tipo de nó, nome do nó, endereço IP, domínio de falha e domínio de atualização do nó).</span><span class="sxs-lookup"><span data-stu-id="90dad-179">These are the details for each of the nodes that are part of the cluster (node type, node name, IP address, fault domain, and upgrade domain of the node).</span></span> <span data-ttu-id="90dad-180">Os computadores nos quais você deseja que o cluster seja criado precisam ser listados aqui com os endereços IP.</span><span class="sxs-lookup"><span data-stu-id="90dad-180">The machines you want the cluster to be created on need to be listed here with their IP addresses.</span></span> <br> <span data-ttu-id="90dad-181">Se você usar o mesmo endereço IP para todos os nós, um cluster one-box será criado, que você pode usar para fins de teste.</span><span class="sxs-lookup"><span data-stu-id="90dad-181">If you use the same IP address for all the nodes, then a one-box cluster is created, which you can use for testing purposes.</span></span> <span data-ttu-id="90dad-182">Não use clusters de uma caixa para implantar cargas de trabalho de produção.</span><span class="sxs-lookup"><span data-stu-id="90dad-182">Do not use One-box clusters for deploying production workloads.</span></span> |

<span data-ttu-id="90dad-183">Depois que a configuração do cluster tiver todas as configurações definidas no ambiente, ela poderá ser testada no ambiente de cluster (etapa 7).</span><span class="sxs-lookup"><span data-stu-id="90dad-183">After the cluster configuration has had all settings configured to the environment, it can be tested against the cluster environment (step 7).</span></span>

<a id="environmentsetup"></a>

### <a name="step-7-environment-setup"></a><span data-ttu-id="90dad-184">Etapa 7.</span><span class="sxs-lookup"><span data-stu-id="90dad-184">Step 7.</span></span> <span data-ttu-id="90dad-185">Configuração do ambiente</span><span class="sxs-lookup"><span data-stu-id="90dad-185">Environment setup</span></span>

<span data-ttu-id="90dad-186">Quando um administrador de cluster configura um cluster autônomo do Service Fabric, o ambiente precisa ser configurado com os seguintes critérios:</span><span class="sxs-lookup"><span data-stu-id="90dad-186">When a cluster administrator configures a Service Fabric standalone cluster, the environment is needs to be set up with the following criteria:</span></span> <br>
1. <span data-ttu-id="90dad-187">O usuário que está criando o cluster deve ter privilégios de segurança de nível de administrador para todos os computadores listados como nós no arquivo de configuração do cluster.</span><span class="sxs-lookup"><span data-stu-id="90dad-187">The user creating the cluster should have administrator-level security privileges to all machines that are listed as nodes in the cluster configuration file.</span></span>
2. <span data-ttu-id="90dad-188">No computador do qual o cluster é criado, bem como em cada computador do nó de cluster, é necessário:</span><span class="sxs-lookup"><span data-stu-id="90dad-188">Machine from which the cluster is created, as well as each cluster node machine must:</span></span>
* <span data-ttu-id="90dad-189">Desinstalar o SDK do Service Fabric</span><span class="sxs-lookup"><span data-stu-id="90dad-189">Have Service Fabric SDK uninstalled</span></span>
* <span data-ttu-id="90dad-190">Desinstalar o tempo de execução do Service Fabric</span><span class="sxs-lookup"><span data-stu-id="90dad-190">Have Service Fabric runtime uninstalled</span></span> 
* <span data-ttu-id="90dad-191">Habilitar o serviço de Firewall do Windows (mpssvc)</span><span class="sxs-lookup"><span data-stu-id="90dad-191">Have the Windows Firewall service (mpssvc) enabled</span></span>
* <span data-ttu-id="90dad-192">Habilitar o Serviço de Registro Remoto (remoteregistry)</span><span class="sxs-lookup"><span data-stu-id="90dad-192">Have the Remote Registry Service (remoteregistry) enabled</span></span>
* <span data-ttu-id="90dad-193">Habilitar o compartilhamento de arquivos (SMB)</span><span class="sxs-lookup"><span data-stu-id="90dad-193">Have file sharing (SMB) enabled</span></span>
* <span data-ttu-id="90dad-194">Abrir as portas necessárias, com base nas portas de configuração de cluster</span><span class="sxs-lookup"><span data-stu-id="90dad-194">Have necessary ports opened, based on cluster configuration ports</span></span>
* <span data-ttu-id="90dad-195">Abrir as portas necessárias para o Serviço de Registro Remoto e o SMB do Windows: 135, 137, 138, 139 e 445</span><span class="sxs-lookup"><span data-stu-id="90dad-195">Have necessary ports opened for Windows SMB and Remote Registry service: 135, 137, 138, 139, and 445</span></span>
* <span data-ttu-id="90dad-196">Ter conectividade de rede com os outros computadores</span><span class="sxs-lookup"><span data-stu-id="90dad-196">Have network connectivity to one another</span></span>
3. <span data-ttu-id="90dad-197">Nenhum dos computadores de nó de cluster deve ser um controlador de domínio.</span><span class="sxs-lookup"><span data-stu-id="90dad-197">None of the cluster node machines should be a Domain Controller.</span></span>
4. <span data-ttu-id="90dad-198">Se o cluster a ser implantado é um cluster seguro, valide que os pré-requisitos de segurança necessários estão em vigor e configurados corretamente em relação à configuração.</span><span class="sxs-lookup"><span data-stu-id="90dad-198">If the cluster to be deployed is a secure cluster, validate the necessary security prerequisites are in place, and are configured correctly against the configuration.</span></span>
5. <span data-ttu-id="90dad-199">Se os computadores do cluster não são acessíveis pela Internet, defina o seguinte na configuração do cluster:</span><span class="sxs-lookup"><span data-stu-id="90dad-199">If the cluster machines are not internet-accessible, set the following in the cluster configuration:</span></span>
* <span data-ttu-id="90dad-200">Desabilitar a telemetria: em *Propriedades*, defina *"enableTelemetry": false*</span><span class="sxs-lookup"><span data-stu-id="90dad-200">Disable telemetry:   Under *properties* set   *"enableTelemetry": false*</span></span>
* <span data-ttu-id="90dad-201">Desabilitar o download automático de versão do Fabric e as notificações que informam que a versão do cluster atual está se aproximando do fim do suporte: em *Propriedades*, defina *"fabricClusterAutoupgradeEnabled": false*</span><span class="sxs-lookup"><span data-stu-id="90dad-201">Disable automatic Fabric version downloading & notifications that the current cluster version is nearing end of support:   Under *properties* set   *"fabricClusterAutoupgradeEnabled": false*</span></span>
* <span data-ttu-id="90dad-202">Como alternativa, se o acesso à rede da Internet estiver limitado aos domínios na lista de permissões, os domínios abaixo serão necessários para a atualização automática: go.microsoft.com   download.microsoft.com</span><span class="sxs-lookup"><span data-stu-id="90dad-202">Alternatively if network internet access is limited to white-listed domains, the domains below are required for automatic upgrade:   go.microsoft.com   download.microsoft.com</span></span>

6. <span data-ttu-id="90dad-203">Defina as exclusões de antivírus do Service Fabric apropriadas:</span><span class="sxs-lookup"><span data-stu-id="90dad-203">Set appropriate Service Fabric antivirus exclusions:</span></span>

| <span data-ttu-id="90dad-204">**Diretórios de Antivírus excluídos**</span><span class="sxs-lookup"><span data-stu-id="90dad-204">**Antivirus Excluded directories**</span></span> |
| --- |
| <span data-ttu-id="90dad-205">Program Files\Microsoft Service Fabric</span><span class="sxs-lookup"><span data-stu-id="90dad-205">Program Files\Microsoft Service Fabric</span></span> |
| <span data-ttu-id="90dad-206">FabricDataRoot (da configuração de cluster)</span><span class="sxs-lookup"><span data-stu-id="90dad-206">FabricDataRoot (from cluster configuration)</span></span> |
| <span data-ttu-id="90dad-207">FabricLogRoot (da configuração de cluster)</span><span class="sxs-lookup"><span data-stu-id="90dad-207">FabricLogRoot (from cluster configuration)</span></span> |

| <span data-ttu-id="90dad-208">**Processos do antivírus excluídos**</span><span class="sxs-lookup"><span data-stu-id="90dad-208">**Antivirus Excluded processes**</span></span> |
| --- |
| <span data-ttu-id="90dad-209">Fabric.exe</span><span class="sxs-lookup"><span data-stu-id="90dad-209">Fabric.exe</span></span> |
| <span data-ttu-id="90dad-210">FabricHost.exe</span><span class="sxs-lookup"><span data-stu-id="90dad-210">FabricHost.exe</span></span> |
| <span data-ttu-id="90dad-211">FabricInstallerService.exe</span><span class="sxs-lookup"><span data-stu-id="90dad-211">FabricInstallerService.exe</span></span> |
| <span data-ttu-id="90dad-212">FabricSetup.exe</span><span class="sxs-lookup"><span data-stu-id="90dad-212">FabricSetup.exe</span></span> |
| <span data-ttu-id="90dad-213">FabricDeployer.exe</span><span class="sxs-lookup"><span data-stu-id="90dad-213">FabricDeployer.exe</span></span> |
| <span data-ttu-id="90dad-214">ImageBuilder.exe</span><span class="sxs-lookup"><span data-stu-id="90dad-214">ImageBuilder.exe</span></span> |
| <span data-ttu-id="90dad-215">FabricGateway.exe</span><span class="sxs-lookup"><span data-stu-id="90dad-215">FabricGateway.exe</span></span> |
| <span data-ttu-id="90dad-216">FabricDCA.exe</span><span class="sxs-lookup"><span data-stu-id="90dad-216">FabricDCA.exe</span></span> |
| <span data-ttu-id="90dad-217">FabricFAS.exe</span><span class="sxs-lookup"><span data-stu-id="90dad-217">FabricFAS.exe</span></span> |
| <span data-ttu-id="90dad-218">FabricUOS.exe</span><span class="sxs-lookup"><span data-stu-id="90dad-218">FabricUOS.exe</span></span> |
| <span data-ttu-id="90dad-219">FabricRM.exe</span><span class="sxs-lookup"><span data-stu-id="90dad-219">FabricRM.exe</span></span> |
| <span data-ttu-id="90dad-220">FileStoreService.exe</span><span class="sxs-lookup"><span data-stu-id="90dad-220">FileStoreService.exe</span></span> |

### <a name="step-8-validate-environment-using-testconfiguration-script"></a><span data-ttu-id="90dad-221">Etapa 8.</span><span class="sxs-lookup"><span data-stu-id="90dad-221">Step 8.</span></span> <span data-ttu-id="90dad-222">Validar o ambiente usando o script TestConfiguration</span><span class="sxs-lookup"><span data-stu-id="90dad-222">Validate environment using TestConfiguration script</span></span>
<span data-ttu-id="90dad-223">O script TestConfiguration.ps1 pode ser encontrado no pacote autônomo.</span><span class="sxs-lookup"><span data-stu-id="90dad-223">The TestConfiguration.ps1 script can be found in the standalone package.</span></span> <span data-ttu-id="90dad-224">Ele é usado como um Analisador de Práticas Recomendadas para validar alguns dos critérios acima e deve ser usado como uma verificação de integridade para validar se um cluster pode ser implantado em um ambiente específico.</span><span class="sxs-lookup"><span data-stu-id="90dad-224">It is used as a Best Practices Analyzer to validate some of the criteria above and should be used as a sanity check to validate whether a cluster can be deployed on a given environment.</span></span> <span data-ttu-id="90dad-225">Se houver alguma falha, consulte a lista em [Configuração do Ambiente](service-fabric-cluster-standalone-deployment-preparation.md) para solução de problemas.</span><span class="sxs-lookup"><span data-stu-id="90dad-225">If there is any failure, refer to the list under [Environment Setup](service-fabric-cluster-standalone-deployment-preparation.md) for troubleshooting.</span></span> 

<span data-ttu-id="90dad-226">Esse script pode ser executado em qualquer computador que tenha o acesso de administrador para todos os computadores listados como nós no arquivo de configuração do cluster.</span><span class="sxs-lookup"><span data-stu-id="90dad-226">This script can be run on any machine that has administrator access to all the machines that are listed as nodes in the cluster configuration file.</span></span> <span data-ttu-id="90dad-227">O computador no qual este script é executado não precisa fazer parte do cluster.</span><span class="sxs-lookup"><span data-stu-id="90dad-227">The machine that this script is run on does not have to be part of the cluster.</span></span>

```powershell
PS C:\temp\Microsoft.Azure.ServiceFabric.WindowsServer> .\TestConfiguration.ps1 -ClusterConfigFilePath .\ClusterConfig.Unsecure.DevCluster.json
Trace folder already exists. Traces will be written to existing trace folder: C:\temp\Microsoft.Azure.ServiceFabric.WindowsServer\DeploymentTraces
Running Best Practices Analyzer...
Best Practices Analyzer completed successfully.


LocalAdminPrivilege        : True
IsJsonValid                : True
IsCabValid                 : True
RequiredPortsOpen          : True
RemoteRegistryAvailable    : True
FirewallAvailable          : True
RpcCheckPassed             : True
NoConflictingInstallations : True
FabricInstallable          : True
Passed                     : True
```

<span data-ttu-id="90dad-228">No momento, este módulo de teste de configuração não valida a configuração de segurança, por isso deve ser feito de forma independente.</span><span class="sxs-lookup"><span data-stu-id="90dad-228">Currently this configuration testing module does not validate the security configuration so this has to be done independently.</span></span>  

> [!NOTE]
> <span data-ttu-id="90dad-229">Estamos continuamente fazendo aprimoramentos para tornar esse módulo mais robusto, então, se há um caso com falha ou ausente que você acredita não ter sido detectado até o momento pelo TestConfiguration, informe-nos pelos nossos [canais de suporte](https://docs.microsoft.com/en-us/azure/service-fabric/service-fabric-support).</span><span class="sxs-lookup"><span data-stu-id="90dad-229">We are continually making improvements to make this module more robust, so if there is a faulty or missing case which you believe isn't currently caught by TestConfiguration, please let us know through our [support channels](https://docs.microsoft.com/en-us/azure/service-fabric/service-fabric-support).</span></span>   
> 
> 

## <a name="next-steps"></a><span data-ttu-id="90dad-230">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="90dad-230">Next steps</span></span>
* [<span data-ttu-id="90dad-231">Criar um cluster autônomo em execução no Windows Server</span><span class="sxs-lookup"><span data-stu-id="90dad-231">Create a standalone cluster running on Windows Server</span></span>](service-fabric-cluster-creation-for-windows-server.md)
