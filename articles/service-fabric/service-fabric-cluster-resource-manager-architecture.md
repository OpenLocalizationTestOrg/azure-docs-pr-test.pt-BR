---
title: Arquitetura do Gerenciador de Recursos | Microsoft Docs
description: "Uma visão geral da arquitetura do Gerenciador de Recursos de Cluster do Service Fabric."
services: service-fabric
documentationcenter: .net
author: masnider
manager: timlt
editor: 
ms.assetid: 6c4421f9-834b-450c-939f-1cb4ff456b9b
ms.service: Service-Fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 08/18/2017
ms.author: masnider
ms.openlocfilehash: 565c20637fa93ed92bb6c52e585a4b70bdeb6f8c
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/18/2017
---
# <a name="cluster-resource-manager-architecture-overview"></a><span data-ttu-id="c6225-103">Visão geral da arquitetura do Gerenciador de Recursos de Cluster</span><span class="sxs-lookup"><span data-stu-id="c6225-103">Cluster resource manager architecture overview</span></span>
<span data-ttu-id="c6225-104">O Gerenciador de Recursos de Cluster do Service Fabric é um serviço central que é executado no cluster.</span><span class="sxs-lookup"><span data-stu-id="c6225-104">The Service Fabric Cluster Resource Manager is a central service that runs in the cluster.</span></span> <span data-ttu-id="c6225-105">Ele gerencia o estado desejado dos serviços no cluster, particularmente com relação ao consumo de recursos e às regras de posicionamento.</span><span class="sxs-lookup"><span data-stu-id="c6225-105">It manages the desired state of the services in the cluster, particularly with respect to resource consumption and any placement rules.</span></span> 

<span data-ttu-id="c6225-106">Para gerenciar os recursos em seu cluster, o Gerenciador de Recursos de Cluster do Service Fabric precisa ter várias informações:</span><span class="sxs-lookup"><span data-stu-id="c6225-106">To manage the resources in your cluster, the Service Fabric Cluster Resource Manager must have several pieces of information:</span></span>

- <span data-ttu-id="c6225-107">Quais serviços existem atualmente</span><span class="sxs-lookup"><span data-stu-id="c6225-107">Which services currently exist</span></span>
- <span data-ttu-id="c6225-108">O consumo de recursos atual (ou padrão) de cada serviço</span><span class="sxs-lookup"><span data-stu-id="c6225-108">Each service's current (or default) resource consumption</span></span> 
- <span data-ttu-id="c6225-109">A capacidade restante do cluster</span><span class="sxs-lookup"><span data-stu-id="c6225-109">The remaining cluster capacity</span></span> 
- <span data-ttu-id="c6225-110">A capacidade dos nós no cluster</span><span class="sxs-lookup"><span data-stu-id="c6225-110">The capacity of the nodes in the cluster</span></span> 
- <span data-ttu-id="c6225-111">A quantidade de recursos consumidos em cada nó</span><span class="sxs-lookup"><span data-stu-id="c6225-111">The amount of resources consumed on each node</span></span>

<span data-ttu-id="c6225-112">O consumo de recursos de um determinado serviço pode mudar com o tempo e, geralmente, os serviços consideram mais de um tipo de recurso.</span><span class="sxs-lookup"><span data-stu-id="c6225-112">The resource consumption of a given service can change over time, and services usually care about more than one type of resource.</span></span> <span data-ttu-id="c6225-113">Em serviços diferentes, pode haver recursos físicos e físicos reais que estão sendo medidos.</span><span class="sxs-lookup"><span data-stu-id="c6225-113">Across different services, there may be both real physical and physical resources being measured.</span></span> <span data-ttu-id="c6225-114">Os serviços podem rastrear métricas físicas, como consumo de disco e memória.</span><span class="sxs-lookup"><span data-stu-id="c6225-114">Services may track physical metrics like memory and disk consumption.</span></span> <span data-ttu-id="c6225-115">Com mais frequência, os serviços podem considerar métricas lógicas — como "WorkQueueDepth" ou "TotalRequests".</span><span class="sxs-lookup"><span data-stu-id="c6225-115">More commonly, services may care about logical metrics - things like "WorkQueueDepth" or "TotalRequests".</span></span> <span data-ttu-id="c6225-116">Métricas lógicas e físicas podem ser usadas no mesmo cluster.</span><span class="sxs-lookup"><span data-stu-id="c6225-116">Both logical and physical metrics can be used in the same cluster.</span></span> <span data-ttu-id="c6225-117">As métricas podem ser compartilhadas entre vários serviços ou podem ser específicas de um serviço em particular.</span><span class="sxs-lookup"><span data-stu-id="c6225-117">Metrics can be shared across many services or be specific to a particular service.</span></span>

## <a name="other-considerations"></a><span data-ttu-id="c6225-118">Outras considerações</span><span class="sxs-lookup"><span data-stu-id="c6225-118">Other considerations</span></span>
<span data-ttu-id="c6225-119">Os proprietários e operadores do cluster podem ser diferentes dos autores do serviço e do aplicativo ou, no mínimo, são as mesmas pessoas desempenhando funções diferentes.</span><span class="sxs-lookup"><span data-stu-id="c6225-119">The owners and operators of the cluster can be different from the service and application authors, or at a minimum are the same people wearing different hats.</span></span> <span data-ttu-id="c6225-120">Quando desenvolve seu aplicativo, você sabe quais são algumas das coisas que ele requer.</span><span class="sxs-lookup"><span data-stu-id="c6225-120">When you develop your application you know a few things about what it requires.</span></span> <span data-ttu-id="c6225-121">Você tem uma estimativa dos recursos que ele consumirá e como diferentes serviços devem ser implantados.</span><span class="sxs-lookup"><span data-stu-id="c6225-121">You have an estimate of the resources it will consume and how different services should be deployed.</span></span> <span data-ttu-id="c6225-122">Por exemplo, a camada da Web precisa ser executada em nós expostos à Internet, enquanto os serviços de banco de dados não.</span><span class="sxs-lookup"><span data-stu-id="c6225-122">For example, the web tier needs to run on nodes exposed to the Internet, while the database services should not.</span></span> <span data-ttu-id="c6225-123">Outro exemplo são os serviços Web, provavelmente são restritos pela rede e pela CPU, enquanto os serviços da camada de dados têm mais relação com o consumo de memória e disco.</span><span class="sxs-lookup"><span data-stu-id="c6225-123">As another example, the web services are probably constrained by CPU and network, while the data tier services care more about memory and disk consumption.</span></span> <span data-ttu-id="c6225-124">No entanto, a pessoa que manipula um incidente de site ao vivo para esse serviço em produção ou que está gerenciando uma atualização do serviço, tem um trabalho diferente a fazer, que exige ferramentas diferentes.</span><span class="sxs-lookup"><span data-stu-id="c6225-124">However, the person handling a live-site incident for that service in production, or who is managing an upgrade to the service has a different job to do, and requires different tools.</span></span> 

<span data-ttu-id="c6225-125">O cluster e os serviços são dinâmicos:</span><span class="sxs-lookup"><span data-stu-id="c6225-125">Both the cluster and services are dynamic:</span></span>

- <span data-ttu-id="c6225-126">O número de nós no cluster pode aumentar e diminuir</span><span class="sxs-lookup"><span data-stu-id="c6225-126">The number of nodes in the cluster can grow and shrink</span></span>
- <span data-ttu-id="c6225-127">Nós de diferentes tamanhos e tipos podem entrar e sair</span><span class="sxs-lookup"><span data-stu-id="c6225-127">Nodes of different sizes and types can come and go</span></span>
- <span data-ttu-id="c6225-128">Serviços podem ser criados, removidos e podem alterar as respectivas alocações de recursos e regras de posicionamento desejadas</span><span class="sxs-lookup"><span data-stu-id="c6225-128">Services can be created, removed, and change their desired resource allocations and placement rules</span></span>
- <span data-ttu-id="c6225-129">Atualizações ou outras operações de gerenciamento podem passar pelo cluster até o aplicativo percorrendo os níveis de infraestrutura</span><span class="sxs-lookup"><span data-stu-id="c6225-129">Upgrades or other management operations can roll through the cluster at the application on infrastructure levels</span></span>
- <span data-ttu-id="c6225-130">Falhas podem ocorrer a qualquer momento.</span><span class="sxs-lookup"><span data-stu-id="c6225-130">Failures can happen at any time.</span></span>

## <a name="cluster-resource-manager-components-and-data-flow"></a><span data-ttu-id="c6225-131">Componentes e fluxo de dados do Gerenciador de Recursos de Cluster</span><span class="sxs-lookup"><span data-stu-id="c6225-131">Cluster resource manager components and data flow</span></span>
<span data-ttu-id="c6225-132">O Gerenciador de Recursos de Cluster precisa controlar os requisitos de cada serviço e o consumo de recursos por cada objeto de serviço dentro desses serviços.</span><span class="sxs-lookup"><span data-stu-id="c6225-132">The Cluster Resource Manager has to track the requirements of each service and the consumption of resources by each service object within those services.</span></span> <span data-ttu-id="c6225-133">O Gerenciador de Recursos de Cluster tem duas partes conceituais: agentes que são executados em cada nó e um serviço tolerante a falhas.</span><span class="sxs-lookup"><span data-stu-id="c6225-133">The Cluster Resource Manager has two conceptual parts: agents that run on each node and a fault-tolerant service.</span></span> <span data-ttu-id="c6225-134">Os agentes em cada nó rastreiam os relatórios de carga dos serviços, agregando-os e reportando-os periodicamente.</span><span class="sxs-lookup"><span data-stu-id="c6225-134">The agents on each node track load reports from services, aggregate them, and periodically report them.</span></span> <span data-ttu-id="c6225-135">O serviço do Gerenciador de Recursos de Cluster agrega todas as informações dos agentes locais e reage com base em sua configuração atual.</span><span class="sxs-lookup"><span data-stu-id="c6225-135">The Cluster Resource Manager service aggregates all the information from the local agents and reacts based on its current configuration.</span></span>

<span data-ttu-id="c6225-136">Vamos observar o seguinte diagrama:</span><span class="sxs-lookup"><span data-stu-id="c6225-136">Let’s look at the following diagram:</span></span>

<span data-ttu-id="c6225-137"><center>
![Arquitetura do Balanceador de Recursos][Image1]
</center></span><span class="sxs-lookup"><span data-stu-id="c6225-137"><center>
![Resource Balancer Architecture][Image1]
</center></span></span>

<span data-ttu-id="c6225-138">No tempo de execução, muitas alterações poderiam acontecer.</span><span class="sxs-lookup"><span data-stu-id="c6225-138">During runtime, there are many changes that could happen.</span></span> <span data-ttu-id="c6225-139">Por exemplo, digamos que a quantidade de recursos que alguns recursos consomem muda, alguns serviços falham e alguns nós entram e saem do cluster.</span><span class="sxs-lookup"><span data-stu-id="c6225-139">For example, let’s say the amount of resources some services consume changes, some services fail, and some nodes join and leave the cluster.</span></span> <span data-ttu-id="c6225-140">Todas as alterações em um nó são agregadas e enviadas periodicamente ao serviço do Gerenciador de Recursos de Cluster (1 e 2), onde são agregadas novamente, analisadas e armazenadas.</span><span class="sxs-lookup"><span data-stu-id="c6225-140">All the changes on a node are aggregated and periodically sent to the Cluster Resource Manager service (1,2) where they are aggregated again, analyzed, and stored.</span></span> <span data-ttu-id="c6225-141">Em intervalo de segundos, o serviço analisa todas as alterações e determina se alguma ação é necessária (3).</span><span class="sxs-lookup"><span data-stu-id="c6225-141">Every few seconds that service looks at the changes and determines if any actions are necessary (3).</span></span> <span data-ttu-id="c6225-142">Por exemplo, ele poderia observar que alguns nós vazios foram adicionados ao cluster.</span><span class="sxs-lookup"><span data-stu-id="c6225-142">For example, it could notice that some empty nodes have been added to the cluster.</span></span> <span data-ttu-id="c6225-143">Como resultado, ele decide mover alguns serviços para esses nós.</span><span class="sxs-lookup"><span data-stu-id="c6225-143">As a result, it decides to move some services to those nodes.</span></span> <span data-ttu-id="c6225-144">O Gerenciador de Recursos de Cluster também poderia observar que um nó específico está sobrecarregado ou que determinados serviços falharam ou foram excluídos, liberando recursos em outro lugar.</span><span class="sxs-lookup"><span data-stu-id="c6225-144">The Cluster Resource Manager could also notice that a particular node is overloaded, or that certain services have failed or been deleted, freeing up resources elsewhere.</span></span>

<span data-ttu-id="c6225-145">Vamos observar o próximo diagrama e ver o que acontece em seguida.</span><span class="sxs-lookup"><span data-stu-id="c6225-145">Let’s look at the following diagram and see what happens next.</span></span> <span data-ttu-id="c6225-146">Digamos que o Gerenciador de Recursos de Cluster determine que é necessário fazer alterações.</span><span class="sxs-lookup"><span data-stu-id="c6225-146">Let’s say that the Cluster Resource Manager determines that changes are necessary.</span></span> <span data-ttu-id="c6225-147">Ele se organiza com outros serviços do sistema (em especial, o Gerenciador de Failover) para fazer as alterações necessárias.</span><span class="sxs-lookup"><span data-stu-id="c6225-147">It coordinates with other system services (in particular the Failover Manager) to make the necessary changes.</span></span> <span data-ttu-id="c6225-148">Em seguida, os comandos necessários são enviados aos nós apropriados (4).</span><span class="sxs-lookup"><span data-stu-id="c6225-148">Then the necessary commands are sent to the appropriate nodes (4).</span></span> <span data-ttu-id="c6225-149">Por exemplo, digamos que o Gerenciador de Recursos tenha observado que o Node5 estava sobrecarregado e, então, decidiu mover o serviço B do Node5 para o Node4.</span><span class="sxs-lookup"><span data-stu-id="c6225-149">For example, let's say the Resource Manager noticed that Node5 was overloaded, and so decided to move service B from Node5 to Node4.</span></span> <span data-ttu-id="c6225-150">No final da reconfiguração (5), o cluster terá esta aparência:</span><span class="sxs-lookup"><span data-stu-id="c6225-150">At the end of the reconfiguration (5), the cluster looks like this:</span></span>

<span data-ttu-id="c6225-151"><center>
![Arquitetura do Balanceador de Recursos][Image2]
</center></span><span class="sxs-lookup"><span data-stu-id="c6225-151"><center>
![Resource Balancer Architecture][Image2]
</center></span></span>

## <a name="next-steps"></a><span data-ttu-id="c6225-152">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="c6225-152">Next steps</span></span>
- <span data-ttu-id="c6225-153">O Gerenciador de Recursos de Cluster tem muitas opções para descrever o cluster.</span><span class="sxs-lookup"><span data-stu-id="c6225-153">The Cluster Resource Manager has many options for describing the cluster.</span></span> <span data-ttu-id="c6225-154">Para saber mais sobre elas, confira este artigo sobre a [descrição de um cluster do Service Fabric](./service-fabric-cluster-resource-manager-cluster-description.md)</span><span class="sxs-lookup"><span data-stu-id="c6225-154">To find out more about them, check out this article on [describing a Service Fabric cluster](./service-fabric-cluster-resource-manager-cluster-description.md)</span></span>
- <span data-ttu-id="c6225-155">As tarefas principais do Gerenciador de Recursos de Cluster são o rebalanceamento do cluster e a imposição de regras de posicionamento.</span><span class="sxs-lookup"><span data-stu-id="c6225-155">The Cluster Resource Manager's primary duties are rebalancing the cluster and enforcing placement rules.</span></span> <span data-ttu-id="c6225-156">Para obter mais informações sobre como configurar esses comportamentos, consulte [Balanceamento do cluster do Service Fabric](./service-fabric-cluster-resource-manager-balancing.md)</span><span class="sxs-lookup"><span data-stu-id="c6225-156">For more information on configuring these behaviors, see [balancing your Service Fabric cluster](./service-fabric-cluster-resource-manager-balancing.md)</span></span>

[Image1]:./media/service-fabric-cluster-resource-manager-architecture/Service-Fabric-Resource-Manager-Architecture-Activity-1.png
[Image2]:./media/service-fabric-cluster-resource-manager-architecture/Service-Fabric-Resource-Manager-Architecture-Activity-2.png
