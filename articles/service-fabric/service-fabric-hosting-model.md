---
title: "aaaAzure modelo de host de malha do serviço | Microsoft Docs"
description: "Descreve a relação entre réplicas (ou instâncias) de um serviço do Service Fabric implantado e o processo de host do serviço."
services: service-fabric
documentationcenter: .net
author: harahma
manager: timlt
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 04/15/2017
ms.author: harahma
ms.openlocfilehash: 30e0ba19cd672a722f76477a311ecef7c213b055
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="service-fabric-hosting-model"></a><span data-ttu-id="0c5a6-103">Modelo de hospedagem do Service Fabric</span><span class="sxs-lookup"><span data-stu-id="0c5a6-103">Service Fabric hosting model</span></span>
<span data-ttu-id="0c5a6-104">Este artigo fornece uma visão geral dos modelos fornecidos pela malha do serviço de hospedagem de aplicativos e descreve as diferenças de saudação entre hello **processo compartilhado** e **processo exclusivo** modelos.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-104">This article provides an overview of application hosting models provided by Service Fabric, and describes hello differences between hello **Shared Process** and **Exclusive Process** models.</span></span> <span data-ttu-id="0c5a6-105">Ele descreve a aparência de um aplicativo implantado em um nó de malha do serviço e a relação entre réplicas (ou instâncias) do serviço de saudação e o processo de host de serviço hello.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-105">It describes how a deployed application looks on a Service Fabric node and relationship between replicas (or instances) of hello service and hello service-host process.</span></span>

<span data-ttu-id="0c5a6-106">Antes de continuar, familiarize-se com o [Modelo de Aplicativo do Service Fabric][a1] e compreenda vários conceitos e a relação entre eles.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-106">Before proceeding further, make sure that you are familiar with [Service Fabric Application Model][a1] and understand various concepts and relation among them.</span></span> 

> [!NOTE]
> <span data-ttu-id="0c5a6-107">Neste artigo, para fins de simplicidade, a menos que mencionado explicitamente:</span><span class="sxs-lookup"><span data-stu-id="0c5a6-107">In this article, for simplicity, unless explicitly mentioned:</span></span>
>
> - <span data-ttu-id="0c5a6-108">Todos os usos do word *réplica* refere-se tooboth uma réplica de um serviço com monitoração de estado ou uma instância de um serviço statless.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-108">All uses of word *replica* refers tooboth a replica of a stateful service or an instance of a statless service.</span></span>
> - <span data-ttu-id="0c5a6-109">*CodePackage* é o equivalente tratada muito*ServiceHost* processo registra um *ServiceType* e hosts de réplicas de serviços do que *ServiceType*.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-109">*CodePackage* is treated equivalent too*ServiceHost* process that registers a *ServiceType* and hosts replicas of services of that *ServiceType*.</span></span>
>

<span data-ttu-id="0c5a6-110">toounderstand Olá modelo de hospedagem, vamos percorrer um exemplo.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-110">toounderstand hello hosting model, let us walk through an example.</span></span> <span data-ttu-id="0c5a6-111">Digamos que temos um *ApplicationType* “MyAppType”, que tem um *ServiceType* “MyServiceType”, que é fornecido por *ServicePackage* “MyServicePackage”, que tem um *CodePackage* “MyCodePackage”, que registra *ServiceType* “MyServiceType” quando é executado.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-111">Let us say, we have an *ApplicationType* 'MyAppType' which has a *ServiceType* 'MyServiceType' which is provided by *ServicePackage* 'MyServicePackage' which has a *CodePackage* 'MyCodePackage' which registers *ServiceType* 'MyServiceType' when it runs.</span></span>

<span data-ttu-id="0c5a6-112">Vamos supor que temos um cluster de 3 nós e que criamos um *aplicativo* **fabric:/App1** do tipo “MyAppType”.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-112">Let's say we have a 3 node cluster and we create an *application* **fabric:/App1** of type 'MyAppType'.</span></span> <span data-ttu-id="0c5a6-113">Nesse *aplicativo* **fabric:/App1**, criamos um serviço **fabric:/App1/ServiceA** do tipo “MyServiceType”, que tem 2 partições (digamos **P1** & **P2**) e 3 réplicas por partição.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-113">Inside this *application* **fabric:/App1** we create a service **fabric:/App1/ServiceA** of type 'MyServiceType' which has 2 partitions (say **P1** & **P2**) and 3 replicas per partition.</span></span> <span data-ttu-id="0c5a6-114">Olá diagrama a seguir mostra exibição Olá deste aplicativo como ele acaba implantado em um nó.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-114">hello following diagram shows hello view of this application as it ends up deployed on a node.</span></span>

<span data-ttu-id="0c5a6-115"><center>
![Exibição do nó do aplicativo implantado][node-view-one]
</center></span><span class="sxs-lookup"><span data-stu-id="0c5a6-115"><center>
![Node view of deployed application][node-view-one]
</center></span></span>

<span data-ttu-id="0c5a6-116">Service Fabric ativado 'MyServicePackage' que foi iniciado 'MyCodePackage', que está hospedando réplicas de ambas as partições de saudação ou seja, **P1** & **P2**.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-116">Service Fabric activated 'MyServicePackage' which started 'MyCodePackage' which is hosting replicas from both hello partitions i.e. **P1** & **P2**.</span></span> <span data-ttu-id="0c5a6-117">Observe que todos os nós de saudação em cluster Olá terá mesma exibição desde que escolhemos o número de réplicas por toonumber igual de partição de nós no cluster de saudação.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-117">Note that all hello nodes in hello cluster will have same view since we chose number of replicas per partition equal toonumber of nodes in hello cluster.</span></span> <span data-ttu-id="0c5a6-118">Vamos criar outro serviço **fabric:/App1/ServiceB** no aplicativo **fabric:/App1** que tem 1 partição (digamos **P3**) e 3 réplicas por partição.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-118">Let's create another service **fabric:/App1/ServiceB** in application **fabric:/App1** which has 1 partition (say **P3**) and 3 replicas per partition.</span></span> <span data-ttu-id="0c5a6-119">Diagrama a seguir mostra a nova exibição Olá no nó de saudação:</span><span class="sxs-lookup"><span data-stu-id="0c5a6-119">Following diagram shows hello new view on hello node:</span></span>

<span data-ttu-id="0c5a6-120"><center>
![Exibição do nó do aplicativo implantado][node-view-two]
</center></span><span class="sxs-lookup"><span data-stu-id="0c5a6-120"><center>
![Node view of deployed application][node-view-two]
</center></span></span>

<span data-ttu-id="0c5a6-121">Como podemos ver Service Fabric colocada a nova réplica Olá para partição **P3** do serviço **fabric: / App1/ServiceB** na ativação existente de saudação do 'MyServicePackage'.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-121">As we can see Service Fabric placed hello new replica for partition **P3** of service **fabric:/App1/ServiceB** in hello existing activation of 'MyServicePackage'.</span></span> <span data-ttu-id="0c5a6-122">Agora, vamos criar outro *aplicativo* **fabric:/App2** do tipo “MyAppType” e dentro de **fabric:/App2** criar o serviço **fabric:/App2/ServiceA**, que tem 2 partições (digamos **P4** & **P5**) e 3 réplicas por partição.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-122">Now lets create another *application* **fabric:/App2** of type 'MyAppType' and inside **fabric:/App2** create service **fabric:/App2/ServiceA** which has 2 partitions (say **P4** & **P5**) and 3 replicas per partition.</span></span> <span data-ttu-id="0c5a6-123">Diagramas a seguir mostra a nova exibição de nó hello:</span><span class="sxs-lookup"><span data-stu-id="0c5a6-123">Following diagrams shows hello new node view:</span></span>

<span data-ttu-id="0c5a6-124"><center>
![Exibição do nó do aplicativo implantado][node-view-three]
</center></span><span class="sxs-lookup"><span data-stu-id="0c5a6-124"><center>
![Node view of deployed application][node-view-three]
</center></span></span>

<span data-ttu-id="0c5a6-125">Desta vez, o Service Fabric ativou uma nova cópia de “MyServicePackage”, que inicia uma nova cópia de “MyCodePackage” e as réplicas de ambas as partições do serviço **fabric:/App2/ServiceA** (ou seja, **P4** & **P5**) são colocadas nessa nova cópia de “MyCodePackage”.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-125">This time Service Fabric has activated a new copy of 'MyServicePackage' which starts a new copy of 'MyCodePackage' and replicas from both partitions of service **fabric:/App2/ServiceA** (i.e. **P4** & **P5**) are placed in this new copy 'MyCodePackage'.</span></span>

## <a name="shared-process-model"></a><span data-ttu-id="0c5a6-126">Modelo de processo compartilhado</span><span class="sxs-lookup"><span data-stu-id="0c5a6-126">Shared process model</span></span>
<span data-ttu-id="0c5a6-127">O que vimos acima é o padrão de saudação do modelo fornecido pela malha do serviço de hospedagem e é chamado tooas **processo compartilhado** modelo.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-127">What we saw above is hello default hosting model provided by Service Fabric and is referred tooas **Shared Process** model.</span></span> <span data-ttu-id="0c5a6-128">Nesse modelo, para um determinado *aplicativo*, apenas uma cópia de um determinado *ServicePackage* é ativado em um *nó* (que iniciará o hello todos os *CodePackages* contidos nele) e todos os Olá réplicas de todos os serviços de um determinado *ServiceType* são colocados em Olá *CodePackage* que registra que *ServiceType*.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-128">In this model, for a given *application*, only one copy of a given *ServicePackage* is activated on a *Node* (which starts all hello *CodePackages* contained in it) and all hello replicas of all services of a given  *ServiceType* are placed in hello *CodePackage* that registers that *ServiceType*.</span></span> <span data-ttu-id="0c5a6-129">Em outras palavras, todos os Olá réplicas de todos os serviços de um determinado *ServiceType* compartilhar Olá mesmo processo.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-129">In other words, all hello replicas of all services of a given *ServiceType* share hello same process.</span></span>

## <a name="exclusive-process-model"></a><span data-ttu-id="0c5a6-130">Modelo de processo exclusivo</span><span class="sxs-lookup"><span data-stu-id="0c5a6-130">Exclusive process model</span></span>
<span data-ttu-id="0c5a6-131">Olá outro modelo de hospedagem fornecido pelo Service Fabric é **processo exclusivo** modelo.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-131">hello other hosting model provided by Service Fabric is **Exclusive Process** model.</span></span> <span data-ttu-id="0c5a6-132">Nesse modelo, em um determinado *nó*, para colocar cada réplica, o Service Fabric ativa uma nova cópia do *ServicePackage* (que iniciará o hello todos os *CodePackages* contidos nele ) e a réplica é colocada no hello *CodePackage* que Olá registrado *ServiceType* de saudação serviço toowhich réplica pertence.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-132">In this model, on a given *Node*, for placing each replica, Service Fabric activates a new copy of *ServicePackage* (which starts all hello *CodePackages* contained in it) and replica is placed in hello *CodePackage* that registered hello *ServiceType* of hello service toowhich replica belongs.</span></span> <span data-ttu-id="0c5a6-133">Em outras palavras, cada réplica reside em seu próprio processo dedicado.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-133">In other words, each replica lives in its own dedicated process.</span></span> 

<span data-ttu-id="0c5a6-134">Há suporte para esse modelo a partir da versão 5.6 do Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-134">This model is supported starting version 5.6 of Service Fabric.</span></span> <span data-ttu-id="0c5a6-135">**Processo exclusivo** modelo pode ser escolhido no tempo de saudação de criação de serviço de saudação (usando [PowerShell][p1], [REST] [ r1]ou [FabricClient][c1]), especificando **ServicePackageActivationMode** como 'ExclusiveProcess'.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-135">**Exclusive Process** model can be chosen at hello time of creating hello service (using [PowerShell][p1], [REST][r1] or [FabricClient][c1]) by specifying **ServicePackageActivationMode** as 'ExclusiveProcess'.</span></span>

```powershell
PS C:\>New-ServiceFabricService -ApplicationName "fabric:/App1" -ServiceName "fabric:/App1/ServiceA" -ServiceTypeName "MyServiceType" -Stateless -PartitionSchemeSingleton -InstanceCount -1 -ServicePackageActivationMode "ExclusiveProcess"
```

```csharp
var serviceDescription = new StatelessServiceDescription
{
    ApplicationName = new Uri("fabric:/App1"),
    ServiceName = new Uri("fabric:/App1/ServiceA"),
    ServiceTypeName = "MyServiceType",
    PartitionSchemeDescription = new SingletonPartitionSchemeDescription(),
    InstanceCount = -1,
    ServicePackageActivationMode = ServicePackageActivationMode.ExclusiveProcess
};

var fabricClient = new FabricClient(clusterEndpoints);
await fabricClient.ServiceManager.CreateServiceAsync(serviceDescription);
```

<span data-ttu-id="0c5a6-136">Se você tiver um serviço padrão no manifesto do aplicativo, poderá escolher o modelo de **Processo Exclusivo** especificando o atributo **ServicePackageActivationMode** conforme mostrado abaixo:</span><span class="sxs-lookup"><span data-stu-id="0c5a6-136">If you have a default service in your application manifest, you can choose **Exclusive Process** model by specifying **ServicePackageActivationMode** attribute as shown below:</span></span>

```xml
<DefaultServices>
  <Service Name="MyService" ServicePackageActivationMode="ExclusiveProcess">
    <StatelessService ServiceTypeName="MyServiceType" InstanceCount="1">
      <SingletonPartition/>
    </StatelessService>
  </Service>
</DefaultServices>
```
<span data-ttu-id="0c5a6-137">Continuando com o nosso exemplo acima, permite criar outro serviço **fabric: / App1/ServiceC** no aplicativo **fabric: / App1** que tem 2 partições (digamos **P6**  &  **P7**) e 3 réplicas por partição com **ServicePackageActivationMode** definir too'ExclusiveProcess'.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-137">Continuing with our example above, lets create another service **fabric:/App1/ServiceC** in application **fabric:/App1** which has 2 partitions (say **P6** & **P7**) and 3 replicas per partition with **ServicePackageActivationMode** set too'ExclusiveProcess'.</span></span> <span data-ttu-id="0c5a6-138">Diagrama a seguir mostra o novo modo de exibição no nó hello:</span><span class="sxs-lookup"><span data-stu-id="0c5a6-138">Following diagram shows new view on hello node:</span></span>

<span data-ttu-id="0c5a6-139"><center>
![Exibição do nó do aplicativo implantado][node-view-four]
</center></span><span class="sxs-lookup"><span data-stu-id="0c5a6-139"><center>
![Node view of deployed application][node-view-four]
</center></span></span>

<span data-ttu-id="0c5a6-140">Como você pode ver, o Service Fabric ativou duas novas cópias de “MyServicePackage” (uma para cada réplica da partição **P6** & **P7**) e colocou cada réplica em sua cópia dedicada de *CodePackage*.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-140">As you can see, Service Fabric activated two new copies of 'MyServicePackage' (one for each replica from partition **P6** & **P7**) and placed each replica in its dedicated copy of *CodePackage*.</span></span> <span data-ttu-id="0c5a6-141">Outro toonote coisa aqui é, quando **processo exclusivo** modelo é usado, para um determinado *aplicativo*, várias cópias de um determinado *ServicePackage* podem estar ativas em um  *Nó*.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-141">Another thing toonote here is, when **Exclusive Process** model is used, for a given *application*, multiple copies of a given *ServicePackage* can be active on a *Node*.</span></span> <span data-ttu-id="0c5a6-142">No exemplo acima, vemos que três cópias de “MyServicePackage” estão ativas em **fabric:/App1**.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-142">In above example, we see that three copies of 'MyServicePackage' are active for **fabric:/App1**.</span></span> <span data-ttu-id="0c5a6-143">Cada uma dessas cópias ativas de “MyServicePackage” tem uma **ServicePackageAtivationId** associada a ela que identifica essa cópia no *aplicativo* **fabric:/App1**.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-143">Each of these active copies of 'MyServicePackage' has a **ServicePackageAtivationId** associated with it which identifies that copy within *application* **fabric:/App1**.</span></span>

<span data-ttu-id="0c5a6-144">Quando apenas o modelo de **Processo Compartilhado** é usado para um *aplicativo*, como **fabric:/App2** no exemplo acima, há apenas uma cópia ativa do *ServicePackage* em um *Nó* e uma **ServicePackageAtivationId** dessa ativação do *ServicePackage* é uma “cadeia de caracteres vazia”.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-144">When only **Shared Process** model is used for an *application*, like **fabric:/App2** in above example, there is only one active copy of *ServicePackage* on a *Node* and **ServicePackageAtivationId** for this activation of *ServicePackage* is 'empty string'.</span></span>

> [!NOTE]
>- <span data-ttu-id="0c5a6-145">**Compartilhado processo** hospedando modelo corresponde muito**ServicePackageAtivationMode** igual **SharedProcess**.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-145">**Shared Process** hosting model corresponds too**ServicePackageAtivationMode** equal **SharedProcess**.</span></span> <span data-ttu-id="0c5a6-146">Este é o padrão de saudação hospedando modelo e **ServicePackageAtivationMode** não precisa ser especificado em tempo de saudação de criação de serviço de saudação.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-146">This is hello default hosting model and **ServicePackageAtivationMode** need not be specified at hello time of creating hello service.</span></span>
>
>- <span data-ttu-id="0c5a6-147">**Processo exclusivo** hospedando modelo corresponde muito**ServicePackageAtivationMode** igual **ExclusiveProcess** e precisa toobe especificado explicitamente no tempo de saudação de criação de saudação serviço.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-147">**Exclusive Process** hosting model corresponds too**ServicePackageAtivationMode** equal **ExclusiveProcess** and need toobe explicitly specified at hello time of creating hello service.</span></span> 
>
>- <span data-ttu-id="0c5a6-148">Modelo de hospedagem de um serviço pode ser conhecido por consultar Olá [descrição do serviço] [ p2] e examinando o valor de **ServicePackageAtivationMode**.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-148">Hosting model of a service can be known by querying hello [service description][p2] and looking at value of **ServicePackageAtivationMode**.</span></span>
>
>

## <a name="working-with-deployed-service-package"></a><span data-ttu-id="0c5a6-149">Trabalhando com o pacote de serviço implantado</span><span class="sxs-lookup"><span data-stu-id="0c5a6-149">Working with deployed service package</span></span>
<span data-ttu-id="0c5a6-150">Uma cópia ativa de um *ServicePackage* em um nó é conhecido como um [pacote de serviço implantado][p3].</span><span class="sxs-lookup"><span data-stu-id="0c5a6-150">An active copy of a *ServicePackage* on a node is referred as [deployed service package][p3].</span></span> <span data-ttu-id="0c5a6-151">Conforme mencionado anteriormente acima, quando **processo exclusivo** modelo é usado para criar serviços, para um determinado *aplicativo*, pode haver vários serviço implantado pacotes para Olá mesmo  *ServicePackage*.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-151">As previously mentioned above, when **Exclusive Process** model is used for creating services, for a given *application*, there could be multiple deployed service packages for hello same *ServicePackage*.</span></span> <span data-ttu-id="0c5a6-152">Ao executar operações como o pacote de serviço específico toodeployed [relatório de integridade de um pacote de serviço implantado] [ p4] ou [reiniciar o pacote de código de um pacote de serviço implantado] [ p5] etc., **ServicePackageActivationId** toobe necessidades fornecido tooidentify um pacote de serviço implantado específico.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-152">While performing operations specific toodeployed service package like [reporting health of a deployed service package][p4] or [restarting code package of a deployed service package][p5] etc., **ServicePackageActivationId** needs toobe provided tooidentify a specific deployed service package.</span></span>

 <span data-ttu-id="0c5a6-153">**ServicePackageActivationId** de um serviço implantado o pacote pode ser obtido consultando a lista de saudação do [pacotes de serviço implantados] [ p3] em um nó.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-153">**ServicePackageActivationId** of a deployed service package can be obtained by querying hello list of [deployed service packages][p3] on a node.</span></span> <span data-ttu-id="0c5a6-154">Ao consultar [implantado tipos de serviço][p6], [implantado réplicas] [ p7] e [implantado pacotes de códigos] [ p8] em um nó, o resultado da consulta Olá também contém Olá **ServicePackageActivationId** de pacote de serviço pai implantado.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-154">When querying [deployed service types][p6], [deployed replicas][p7] and [deployed code packages][p8] on a node, hello query result also contains hello **ServicePackageActivationId** of parent deployed service package.</span></span>

> [!NOTE]
>- <span data-ttu-id="0c5a6-155">No modelo de hospedagem do **Processo Compartilhado**, em determinado *nó* de determinado *aplicativo*, apenas uma cópia de um *ServicePackage* é ativada.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-155">Under **Shared Process** hosting model, on a given *node*, for a given *application*, only one copy of a *ServicePackage* is activated.</span></span> <span data-ttu-id="0c5a6-156">Ele tem **ServicePackageActivationId** igual muito*cadeia de caracteres vazia* e não precisa ser especificada enquanto operações relacionadas à execução de pacote de serviço implantado.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-156">It has **ServicePackageActivationId** equal too*empty string* and need not be specified while performing deployed service package related operations.</span></span> 
>
> - <span data-ttu-id="0c5a6-157">No modelo de hospedagem do **Processo Exclusivo**, em um determinado *nó* de determinado *aplicativo*, uma ou mais cópias de um *ServicePackage* podem estar ativas.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-157">Under **Exclusive Process** hosting model, on a given *node*, for a given *application*, one or more copies of a *ServicePackage* can be active.</span></span> <span data-ttu-id="0c5a6-158">Cada ativação tem um *não vazio* **ServicePackageActivationId** e precisa toobe especificado enquanto operações relacionadas à execução de pacote de serviço implantado.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-158">Each activation has a *non-empty* **ServicePackageActivationId** and needs toobe specified while performing deployed service package related operations.</span></span> 
>
> - <span data-ttu-id="0c5a6-159">Se **ServicePackageActivationId** é omitido, o padrão é too'empty de cadeia de caracteres '.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-159">If **ServicePackageActivationId** is ommited it defaults too'empty string'.</span></span> <span data-ttu-id="0c5a6-160">Se um serviço implantado do pacote que foi ativada em **processo compartilhado** modelo está presente, em seguida, será possível executar a operação, caso contrário, Olá operação falhará.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-160">If a deployed service package that was activated under **Shared Process** model is present, then operation will be performed on it, otherwise hello operation will fail.</span></span>
>
> - <span data-ttu-id="0c5a6-161">Não é recomendável tooquery uma vez e cache **ServicePackageActivationId** conforme ele é gerado dinamicamente e pode alterar por vários motivos.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-161">It is not recommended tooquery once and cache **ServicePackageActivationId** as it is dynamically generated and can change for various reasons.</span></span> <span data-ttu-id="0c5a6-162">Antes de executar uma operação que precisa **ServicePackageActivationId**, você primeiro deve consultar a lista de saudação do [pacotes de serviço implantados] [ p3] em um nó e, em seguida, use  *ServicePackageActivationId** de operação de Olá de tooperform resultados de consulta original.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-162">Before performing an operation that needs **ServicePackageActivationId**, you should first query hello list of [deployed service packages][p3] on a node and then use *ServicePackageActivationId** from query result tooperform hello original operation.</span></span>
>
>

## <a name="guest-executable-and-container-applications"></a><span data-ttu-id="0c5a6-163">Aplicativos executáveis e de contêiner convidados</span><span class="sxs-lookup"><span data-stu-id="0c5a6-163">Guest executable and container applications</span></span>
<span data-ttu-id="0c5a6-164">O Service Fabric trata os aplicativos [executáveis][a2] e de [contêiner convidados][a3] como serviços sem estado que são independentes; ou seja, não há nenhum tempo de execução do Service Fabric em *ServiceHost* (um processo ou contêiner).</span><span class="sxs-lookup"><span data-stu-id="0c5a6-164">Service Fabric treats [Guest executable][a2] and [container][a3] applications as statless services which are self-contained i.e. there is no Service Fabric runtime in *ServiceHost* (a process or container).</span></span> <span data-ttu-id="0c5a6-165">Como esses serviços são independentes, o número de réplicas por *ServiceHost* não é aplicável a esses serviços.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-165">Since these services are self-contained, number of replicas per *ServiceHost* is not applicable for these services.</span></span> <span data-ttu-id="0c5a6-166">Olá, configuração mais comum usada com esses serviços é única partição com [InstanceCount] [ c2] igual muito-1 (ou seja, uma cópia do código de saudação do serviço em execução em cada nó do cluster).</span><span class="sxs-lookup"><span data-stu-id="0c5a6-166">hello most common configuration used with these services is single-partition with [InstanceCount][c2] equal too-1 (i.e. one copy of hello service code running on each node of cluster).</span></span> 

<span data-ttu-id="0c5a6-167">Olá padrão **ServicePackageActivationMode** para esses serviços é **SharedProcess** caso em que o Service Fabric ativa somente uma cópia de *ServicePackage* em um *Nó* para um determinado *aplicativo* que significa que apenas uma cópia do código de serviço será executado um *nó*.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-167">hello default **ServicePackageActivationMode** for these services is **SharedProcess** in which case Service Fabric only activates one copy of *ServicePackage* on a *Node* for a given *application* which means only one copy of service code will run a *Node*.</span></span> <span data-ttu-id="0c5a6-168">Se você quiser várias cópias de seu toorun de código de serviço em um *nó* quando você criar vários serviços (*Service1* muito*ServiceN*) de *ServiceType* (especificado na *ServiceManifest*) ou ao seu serviço for particionado vários, você deve especificar **ServicePackageActivationMode** como **ExclusiveProcess**em tempo de saudação de criação de serviço de saudação.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-168">If you want multiple copies of your service code toorun on a *Node* when you create multiple services (*Service1* too*ServiceN*) of *ServiceType* (specified in *ServiceManifest*) or when your service is multi-partitioned, you should specify **ServicePackageActivationMode** as **ExclusiveProcess** at hello time of creating hello service.</span></span>

## <a name="changing-hosting-model-of-an-existing-service"></a><span data-ttu-id="0c5a6-169">Alterando o modelo de hospedagem de um serviço existente</span><span class="sxs-lookup"><span data-stu-id="0c5a6-169">Changing hosting model of an existing service</span></span>
<span data-ttu-id="0c5a6-170">Alterar o modelo de hospedagem de um serviço existente do **processo compartilhado** muito**processo exclusivo** e vice-versa por meio de atualização ou mecanismo de atualização (ou especificação de aplicativo de serviço padrão manifesto) não é suportado atualmente.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-170">Changing hosting model of an existing service from **Shared Process** too**Exclusive Process** and vice-versa through upgrade or update mechanism (or in default service specification in application manifest) is currently not supported.</span></span> <span data-ttu-id="0c5a6-171">O suporte a esse recurso será fornecido em versões futuras.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-171">Support for this feature will come in future versions.</span></span>

## <a name="choosing-between-shared-process-and-exclusive-process-model"></a><span data-ttu-id="0c5a6-172">Escolhendo entre o modelo de processo compartilhado e processo exclusivo</span><span class="sxs-lookup"><span data-stu-id="0c5a6-172">Choosing between shared process and exclusive process model</span></span>
<span data-ttu-id="0c5a6-173">Esses modelos de hospedagem têm seus prós e contras e o usuário deve tooevaluate que melhor atenda suas necessidades.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-173">Both these hosting models have its pros and cons and user needs tooevaluate which one fits their requirements best.</span></span> <span data-ttu-id="0c5a6-174">**Compartilhado processo** modelo permite melhor utilização de recursos do sistema operacional porque menos processos são gerados, Olá de várias réplicas no mesmo processo pode compartilhar portas, etc. No entanto, se uma das réplicas Olá atinge um erro em que ele precisa toobring para baixo de host de serviço hello, isso afetará todas as outras réplicas no mesmo processo.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-174">**Shared Process** model enables better utilization of OS resources because fewer processes are spawned, multiple replicas in hello same process can share ports, etc. However, if one of hello replicas hits an error where it needs toobring down hello service host, it will impact all other replicas in same process.</span></span>

 <span data-ttu-id="0c5a6-175">O modelo de **Processo Exclusivo** fornece um melhor isolamento com cada réplica em seu próprio processo e uma réplica com comportamento inadequado não afetará outras réplicas.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-175">**Exclusive Process** model provides better isolation with every replica in its own process and a misbehaving replica will not impact other replicas.</span></span> <span data-ttu-id="0c5a6-176">Essa opção é útil para casos onde o compartilhamento de porta não é suportado pelo protocolo de comunicação de saudação.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-176">It comes in handy for cases where port sharing is not supported by hello communication protocol.</span></span> <span data-ttu-id="0c5a6-177">Ele facilita a governança de recursos de tooapply Olá capacidade no nível da réplica.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-177">It facilitates hello ability tooapply resource governance at replica level.</span></span> <span data-ttu-id="0c5a6-178">Olá por outro lado, **processo exclusivo** consumirá mais recursos do sistema operacional, ele gera um processo para cada réplica no nó de saudação.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-178">On hello other hand, **Exclusive Process** will consume more OS resources as it spawns one process for each replica on hello node.</span></span>

## <a name="exclusive-process-model-and-application-model-considerations"></a><span data-ttu-id="0c5a6-179">Considerações sobre o modelo de processo exclusivo e o modelo de aplicativo</span><span class="sxs-lookup"><span data-stu-id="0c5a6-179">Exclusive process model and application model considerations</span></span>
<span data-ttu-id="0c5a6-180">Olá recomendado maneira toomodel seu aplicativo no serviço de malha é tookeep uma *ServiceType* por *ServicePackage* e esse modelo funciona bem para a maioria dos aplicativos de saudação.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-180">hello recommended way toomodel your application in Service Fabric is tookeep one *ServiceType* per *ServicePackage* and this model works well for most of hello applications.</span></span> 

<span data-ttu-id="0c5a6-181">No entanto, cenários especiais tooenable onde um *ServiceType* por *ServicePackage* pode não ser desejável, funcionalmente, Service Fabric permite toohave mais de uma *ServiceType* por *ServicePackage* (um *CodePackage* pode registrar mais de um *ServiceType*).</span><span class="sxs-lookup"><span data-stu-id="0c5a6-181">However, tooenable special scenarios where one *ServiceType* per *ServicePackage* may not be desirable, functionally, Service Fabric allows toohave more than one *ServiceType* per *ServicePackage* (and one *CodePackage* can register more than one *ServiceType*).</span></span> <span data-ttu-id="0c5a6-182">A seguir estão alguns dos cenários de saudação onde essas configurações podem ser úteis:</span><span class="sxs-lookup"><span data-stu-id="0c5a6-182">Following are some of hello scenarios where these configurations can be useful:</span></span>

- <span data-ttu-id="0c5a6-183">Você deseja toooptimize utilização de recursos de sistema operacional, gerando menos processos e tornando maior densidade de réplica por processo.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-183">You want toooptimize OS resource utilization by spawning fewer processes and having higher replica density per process.</span></span>
- <span data-ttu-id="0c5a6-184">Réplicas de diferentes ServiceTypes necessário tooshare alguns dados comuns que tem uma alta inicialização ou o custo de memória.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-184">Replicas from different ServiceTypes need tooshare some common data that has a high initialization or memory cost.</span></span>
- <span data-ttu-id="0c5a6-185">Você tem uma oferta de serviço gratuito e deseja tooput um limite de utilização de recursos, colocando todas as réplicas do serviço de saudação no mesmo processo.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-185">You have a free service offering and you want tooput a limit on resource utilization by putting all replicas of hello service in same process.</span></span>

<span data-ttu-id="0c5a6-186">O modelo de hospedagem de **Processo Exclusivo** não é coerente com o modelo de aplicativo que tem vários *ServiceTypes* por *ServicePackage*.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-186">**Exclusive Process** hosting model is not coherent with application model having multiple *ServiceTypes* per *ServicePackage*.</span></span> <span data-ttu-id="0c5a6-187">Isso ocorre porque vários *ServiceTypes* por *ServicePackage* é projetado tooachieve mais recursos de compartilhamento entre réplicas e permite maior densidade de réplica por processo.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-187">This is because multiple *ServiceTypes* per *ServicePackage* is designed tooachieve higher resource sharing among replicas and enables higher replica density per process.</span></span> <span data-ttu-id="0c5a6-188">Isso é toowhat contrary **processo exclusivo** modelo é tooachieve projetado.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-188">This is contrary toowhat **Exclusive Process** model is designed tooachieve.</span></span>

<span data-ttu-id="0c5a6-189">Considere o caso de saudação de vários *ServiceTypes* por *ServicePackage* com diferentes *CodePackage* registrar cada *ServiceType*.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-189">Consider hello case of multiple *ServiceTypes* per *ServicePackage* with different *CodePackage* registering each *ServiceType*.</span></span> <span data-ttu-id="0c5a6-190">Digamos que temos um *ServicePackage* “MultiTypeServicePackge”, que tem dois *CodePackages*:</span><span class="sxs-lookup"><span data-stu-id="0c5a6-190">Let's say we have a *ServicePackage* 'MultiTypeServicePackge' which has two *CodePackages*:</span></span>

- <span data-ttu-id="0c5a6-191">“MyCodePackageA”, que registra *ServiceType* “MyServiceTypeA”.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-191">'MyCodePackageA' which registers *ServiceType* 'MyServiceTypeA'.</span></span>
- <span data-ttu-id="0c5a6-192">“MyCodePackageB”, que registra *ServiceType* “MyServiceTypeB”.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-192">'MyCodePackageB' which registers *ServiceType* 'MyServiceTypeB'.</span></span>

<span data-ttu-id="0c5a6-193">Agora, digamos que criamos um *aplicativo* **fabric:/SpecialApp** e dentro de **fabric:/SpecialApp** criamos os dois seguintes serviços com o modelo de **Processo Exclusivo**:</span><span class="sxs-lookup"><span data-stu-id="0c5a6-193">Now, lets say, we create an *application* **fabric:/SpecialApp** and inside **fabric:/SpecialApp** we create following two services with **Exclusive Process** model:</span></span>

- <span data-ttu-id="0c5a6-194">Serviço **fabric:/SpecialApp/ServiceA** do tipo “MyServiceTypeA” com duas partições (digamos **P1** e **P2**) e 3 réplicas por partição.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-194">Service **fabric:/SpecialApp/ServiceA** of type 'MyServiceTypeA' with two partitions (say **P1** and **P2**) and 3 replicas per partition.</span></span>
- <span data-ttu-id="0c5a6-195">Serviço **fabric:/SpecialApp/ServiceB** do tipo “MyServiceTypeB” com duas partições (digamos **P3** e **P4**) e 3 réplicas por partição.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-195">Service **fabric:/SpecialApp/ServiceB** of type 'MyServiceTypeB' with two partitions (say **P3** and **P4**) and 3 replicas per partition.</span></span>

<span data-ttu-id="0c5a6-196">Em um nó específico, os dois serviços Olá terá duas réplicas.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-196">On a given node, both hello services will have two replicas each.</span></span> <span data-ttu-id="0c5a6-197">Como usamos **processo exclusivo** serviços do modelo toocreate hello, Service Fabric ativará uma nova cópia de 'MyServicePackge' para cada réplica.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-197">Since we used **Exclusive Process** model toocreate hello services, Service Fabric will activate a new copy of 'MyServicePackge' for each replica.</span></span> <span data-ttu-id="0c5a6-198">Cada ativação de “MultiTypeServicePackge” iniciará uma cópia de “MyCodePackageA” e “MyCodePackageB”.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-198">Each activation of 'MultiTypeServicePackge' will start a copy of 'MyCodePackageA' and 'MyCodePackageB'.</span></span> <span data-ttu-id="0c5a6-199">No entanto, apenas um dos 'MyCodePackageA' ou 'MyCodePackageB' hospedará a réplica Olá para o qual 'MultiTypeServicePackge' foi ativado.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-199">However, only one of 'MyCodePackageA' or 'MyCodePackageB' will host hello replica for which 'MultiTypeServicePackge' was activated.</span></span> <span data-ttu-id="0c5a6-200">Diagrama a seguir mostra a exibição do nó de saudação:</span><span class="sxs-lookup"><span data-stu-id="0c5a6-200">Following diagram shows hello node view:</span></span>

<span data-ttu-id="0c5a6-201"><center>
![Exibição do nó do aplicativo implantado][node-view-five]
</center></span><span class="sxs-lookup"><span data-stu-id="0c5a6-201"><center>
![Node view of deployed application][node-view-five]
</center></span></span>

 <span data-ttu-id="0c5a6-202">Como podemos ver, na ativação de saudação do 'MultiTypeServicePackge' para a réplica da partição **P1** do serviço **fabric: / SpecialApp/Services**, 'MyCodePackageA' está hospedando a réplica hello e ' MyCodePackageB' está apenas em execução.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-202">As we can see, in hello activation of 'MultiTypeServicePackge' for replica of partition **P1** of service **fabric:/SpecialApp/ServiceA**, 'MyCodePackageA' is hosting hello replica and 'MyCodePackageB' is just up and running.</span></span> <span data-ttu-id="0c5a6-203">Da mesma forma, na ativação de 'MultiTypeServicePackge' para a réplica da partição **P3** do serviço **fabric: / SpecialApp/ServiceB**, 'MyCodePackageB' está hospedando a réplica de saudação e é 'MyCodePackageA' apenas em funcionamento e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-203">Similarly, in activation of 'MultiTypeServicePackge' for replica of partition **P3** of service **fabric:/SpecialApp/ServiceB**, 'MyCodePackageB' is hosting hello replica and 'MyCodePackageA' is just up and running and so on.</span></span> <span data-ttu-id="0c5a6-204">Portanto, Olá mais o número de *CodePackages* (Registrando diferentes *ServiceTypes*) por *ServicePackage*, maior será o uso de recursos de redundância.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-204">Hence, more hello number of *CodePackages* (registering different *ServiceTypes*) per *ServicePackage*, higher will be redundant resource usage.</span></span> 
 
 <span data-ttu-id="0c5a6-205">Olá no outro lado, se criarmos Serviços **malha: / SpecialApp/Services** e **fabric: / SpecialApp/ServiceB** com **processo compartilhado** modelo será Service Fabric Ativar somente uma cópia de 'MultiTypeServicePackge' para *aplicativo* **fabric: / SpecialApp** (como visto anteriormente).</span><span class="sxs-lookup"><span data-stu-id="0c5a6-205">On hello other hand if we create services **fabric:/SpecialApp/ServiceA** and **fabric:/SpecialApp/ServiceB** with **Shared Process** model, Service Fabric will activate only one copy of 'MultiTypeServicePackge' for *application* **fabric:/SpecialApp** (as we saw previously).</span></span> <span data-ttu-id="0c5a6-206">'MyCodePackageA' hospedará todas as réplicas para o serviço **fabric: / SpecialApp/Services** (ou de qualquer serviço do tipo 'MyServiceTypeA' toobe mais preciso) e 'MyCodePackageB' hospedará todas as réplicas para o serviço **fabric: / SpecialApp/ServiceB** (ou de qualquer serviço do tipo 'MyServiceTypeB' toobe mais preciso).</span><span class="sxs-lookup"><span data-stu-id="0c5a6-206">'MyCodePackageA' will host all replicas for service **fabric:/SpecialApp/ServiceA** (or of any service of type 'MyServiceTypeA' toobe more precise) and 'MyCodePackageB' will host all replicas for service **fabric:/SpecialApp/ServiceB** (or of any service of type 'MyServiceTypeB' toobe more precise).</span></span> <span data-ttu-id="0c5a6-207">Diagrama a seguir mostra a exibição do nó Olá nessa configuração:</span><span class="sxs-lookup"><span data-stu-id="0c5a6-207">Following diagram shows hello node view in this setting:</span></span> 

<span data-ttu-id="0c5a6-208"><center>
![Exibição do nó do aplicativo implantado][node-view-six]
</center></span><span class="sxs-lookup"><span data-stu-id="0c5a6-208"><center>
![Node view of deployed application][node-view-six]
</center></span></span>

<span data-ttu-id="0c5a6-209">Olá, o exemplo acima, você pode pensar se 'MyCodePackageA' registra 'MyServiceTypeA' e 'MyServiceTypeB' e não há nenhum MyCodePackageB, será redundante não *CodePackage* em execução.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-209">In hello above example, you might think if 'MyCodePackageA' registers both 'MyServiceTypeA' and 'MyServiceTypeB' and there is no 'MyCodePackageB', then there will be no redundant *CodePackage* running.</span></span> <span data-ttu-id="0c5a6-210">Isso está correto, mas, como mencionado anteriormente, esse modelo de aplicativo não se alinha com o modelo de hospedagem de **Processo Exclusivo**.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-210">This is correct, however, as mentioned previously, this application model does not align with **Exclusive Process** hosting model.</span></span> <span data-ttu-id="0c5a6-211">Se o objetivo é tooput cada réplica em seu próprio dedicado processo de registro de ambos *ServiceTypes* mesmo *CodePackage* não é necessária e colocando cada *ServiceType* em seu próprio *ServicePacakge* é uma escolha mais natural.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-211">If goal is tooput each replica in its own dedicated process then registering both *ServiceTypes* from same *CodePackage* is not needed and putting each *ServiceType* in its own *ServicePacakge* is a more natural choice.</span></span>

## <a name="next-steps"></a><span data-ttu-id="0c5a6-212">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="0c5a6-212">Next steps</span></span>
<span data-ttu-id="0c5a6-213">[Empacotar um aplicativo] [ a4] e deixá-lo toodeploy pronto.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-213">[Package an application][a4] and get it ready toodeploy.</span></span>

<span data-ttu-id="0c5a6-214">[Implantar e remover aplicativos] [ a5] descreve como instâncias do aplicativo toouse PowerShell toomanage.</span><span class="sxs-lookup"><span data-stu-id="0c5a6-214">[Deploy and remove applications][a5] describes how toouse PowerShell toomanage application instances.</span></span>

<!--Image references-->
[node-view-one]: ./media/service-fabric-hosting-model/node-view-one.png
[node-view-two]: ./media/service-fabric-hosting-model/node-view-two.png
[node-view-three]: ./media/service-fabric-hosting-model/node-view-three.png
[node-view-four]: ./media/service-fabric-hosting-model/node-view-four.png
[node-view-five]: ./media/service-fabric-hosting-model/node-view-five.png
[node-view-six]: ./media/service-fabric-hosting-model/node-view-six.png

<!--Link references--In actual articles, you only need a single period before hello slash-->
[a1]: service-fabric-application-model.md
[a2]: service-fabric-deploy-existing-app.md
[a3]: service-fabric-containers-overview.md
[a4]: service-fabric-package-apps.md
[a5]: service-fabric-deploy-remove-applications.md

[r1]: https://docs.microsoft.com/rest/api/servicefabric/sfclient-api-createservice

[c1]: https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient.servicemanagementclient.createserviceasync
[c2]: https://docs.microsoft.com/dotnet/api/system.fabric.description.statelessservicedescription.instancecount

[p1]: https://docs.microsoft.com/powershell/servicefabric/vlatest/new-servicefabricservice
[p2]: https://docs.microsoft.com/powershell/servicefabric/vlatest/get-servicefabricservicedescription
[p3]: https://docs.microsoft.com/powershell/servicefabric/vlatest/get-servicefabricdeployedservicePackage
[p4]: https://docs.microsoft.com/powershell/servicefabric/vlatest/send-servicefabricdeployedservicepackagehealthreport
[p5]: https://docs.microsoft.com/powershell/servicefabric/vlatest/restart-servicefabricdeployedcodepackage
[p6]: https://docs.microsoft.com/powershell/servicefabric/vlatest/get-servicefabricdeployedservicetype
[p7]: https://docs.microsoft.com/powershell/servicefabric/vlatest/get-servicefabricdeployedreplica
[p8]: https://docs.microsoft.com/powershell/servicefabric/vlatest/get-servicefabricdeployedcodepackage