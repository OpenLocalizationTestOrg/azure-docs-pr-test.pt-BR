---
title: "atualização de aplicativo de malha aaaService | Microsoft Docs"
description: "Este artigo fornece uma introdução tooupgrading um aplicativo de malha do serviço, incluindo modos de atualização escolhendo e executando verificações de integridade."
services: service-fabric
documentationcenter: .net
author: mani-ramaswamy
manager: timlt
editor: 
ms.assetid: 803c9c63-373a-4d6a-8ef2-ea97e16e88dd
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 8/9/2017
ms.author: subramar
ms.openlocfilehash: 6f649ef4a5c0afab682522bcba7d2d66a4268ead
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="service-fabric-application-upgrade"></a><span data-ttu-id="520bd-103">Atualização de aplicativos do Service Fabric</span><span class="sxs-lookup"><span data-stu-id="520bd-103">Service Fabric application upgrade</span></span>
<span data-ttu-id="520bd-104">Um aplicativo do Azure Service Fabric é uma coleção de serviços.</span><span class="sxs-lookup"><span data-stu-id="520bd-104">An Azure Service Fabric application is a collection of services.</span></span> <span data-ttu-id="520bd-105">Durante uma atualização, o Service Fabric compara Olá novo [o manifesto do aplicativo](service-fabric-application-model.md#describe-an-application) com versão anterior do hello e determina quais serviços de aplicativo hello exigem atualizações.</span><span class="sxs-lookup"><span data-stu-id="520bd-105">During an upgrade, Service Fabric compares hello new [application manifest](service-fabric-application-model.md#describe-an-application) with hello previous version and determines which services in hello application require updates.</span></span> <span data-ttu-id="520bd-106">Service Fabric compara versão Olá números no serviço Olá manifestos com números de versão de saudação na versão anterior do hello.</span><span class="sxs-lookup"><span data-stu-id="520bd-106">Service Fabric compares hello version numbers in hello service manifests with hello version numbers in hello previous version.</span></span> <span data-ttu-id="520bd-107">Se um serviço não foi alterado, ele não foi atualizado.</span><span class="sxs-lookup"><span data-stu-id="520bd-107">If a service has not changed, that service is not upgraded.</span></span>

## <a name="rolling-upgrades-overview"></a><span data-ttu-id="520bd-108">Visão geral das atualizações sem interrupção</span><span class="sxs-lookup"><span data-stu-id="520bd-108">Rolling upgrades overview</span></span>
<span data-ttu-id="520bd-109">Em uma atualização sem interrupção do aplicativo, a atualização de saudação é executada em estágios.</span><span class="sxs-lookup"><span data-stu-id="520bd-109">In a rolling application upgrade, hello upgrade is performed in stages.</span></span> <span data-ttu-id="520bd-110">Em cada estágio, a atualização de saudação é aplicado tooa subconjunto de nós no cluster hello, chamado de um domínio de atualização.</span><span class="sxs-lookup"><span data-stu-id="520bd-110">At each stage, hello upgrade is applied tooa subset of nodes in hello cluster, called an update domain.</span></span> <span data-ttu-id="520bd-111">Como resultado, o aplicativo hello permanece disponível durante a atualização de saudação.</span><span class="sxs-lookup"><span data-stu-id="520bd-111">As a result, hello application remains available throughout hello upgrade.</span></span> <span data-ttu-id="520bd-112">Durante a atualização de saudação cluster Olá pode conter uma mistura de versões antigas e novas de saudação.</span><span class="sxs-lookup"><span data-stu-id="520bd-112">During hello upgrade, hello cluster may contain a mix of hello old and new versions.</span></span>

<span data-ttu-id="520bd-113">Por esse motivo, as versões de saudação dois devem ser frente e para trás compatível.</span><span class="sxs-lookup"><span data-stu-id="520bd-113">For that reason, hello two versions must be forward and backward compatible.</span></span> <span data-ttu-id="520bd-114">Se eles não forem compatíveis, o administrador do aplicativo hello é responsável por uma disponibilidade toomaintain de atualização de várias fases de preparação.</span><span class="sxs-lookup"><span data-stu-id="520bd-114">If they are not compatible, hello application administrator is responsible for staging a multiple-phase upgrade toomaintain availability.</span></span> <span data-ttu-id="520bd-115">Em uma atualização de várias fases, primeira etapa de saudação está atualizando versão intermediária tooan aplicativo hello que é compatível com a versão anterior de saudação.</span><span class="sxs-lookup"><span data-stu-id="520bd-115">In a multiple-phase upgrade, hello first step is upgrading tooan intermediate version of hello application that is compatible with hello previous version.</span></span> <span data-ttu-id="520bd-116">Olá segunda etapa é tooupgrade Olá versão final que quebras de compatibilidade com a versão de pré-atualização hello, mas é compatível com versão intermediária hello.</span><span class="sxs-lookup"><span data-stu-id="520bd-116">hello second step is tooupgrade hello final version that breaks compatibility with hello pre-update version, but is compatible with hello intermediate version.</span></span>

<span data-ttu-id="520bd-117">Domínios de atualização são especificados no manifesto do cluster hello quando você configurar o cluster hello.</span><span class="sxs-lookup"><span data-stu-id="520bd-117">Update domains are specified in hello cluster manifest when you configure hello cluster.</span></span> <span data-ttu-id="520bd-118">Os domínios de atualização não recebem atualizações em uma ordem específica.</span><span class="sxs-lookup"><span data-stu-id="520bd-118">Update domains do not receive updates in a particular order.</span></span> <span data-ttu-id="520bd-119">Um domínio de atualização é uma unidade lógica de implantação para um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="520bd-119">An update domain is a logical unit of deployment for an application.</span></span> <span data-ttu-id="520bd-120">Domínios de atualização permitem Olá serviços tooremain a alta disponibilidade durante uma atualização.</span><span class="sxs-lookup"><span data-stu-id="520bd-120">Update domains allow hello services tooremain at high availability during an upgrade.</span></span>

<span data-ttu-id="520bd-121">As atualizações sem interrupção não são possíveis se Olá for aplicado tooall nós no cluster hello, que é o caso de saudação quando o aplicativo hello tem apenas um domínio de atualização.</span><span class="sxs-lookup"><span data-stu-id="520bd-121">Non-rolling upgrades are possible if hello upgrade is applied tooall nodes in hello cluster, which is hello case when hello application has only one update domain.</span></span> <span data-ttu-id="520bd-122">Essa abordagem não é recomendável, pois o serviço Olá fica inativo e não está disponível no momento de saudação da atualização.</span><span class="sxs-lookup"><span data-stu-id="520bd-122">This approach is not recommended, since hello service goes down and isn't available at hello time of upgrade.</span></span> <span data-ttu-id="520bd-123">Além disso, o Azure não fornece qualquer garantia quando um cluster é configurado com apenas um domínio de atualização.</span><span class="sxs-lookup"><span data-stu-id="520bd-123">Additionally, Azure doesn't provide any guarantees when a cluster is set up with only one update domain.</span></span>

## <a name="health-checks-during-upgrades"></a><span data-ttu-id="520bd-124">Verificações de integridade durante atualizações</span><span class="sxs-lookup"><span data-stu-id="520bd-124">Health checks during upgrades</span></span>
<span data-ttu-id="520bd-125">Para uma atualização, as diretivas de integridade tem toobe definido (ou valores padrão podem ser usados).</span><span class="sxs-lookup"><span data-stu-id="520bd-125">For an upgrade, health policies have toobe set (or default values may be used).</span></span> <span data-ttu-id="520bd-126">Uma atualização é chamada com êxito quando todos os domínios de atualização são atualizados em Olá especificado tempos limite e quando a atualização de todos os domínios são considerados íntegros.</span><span class="sxs-lookup"><span data-stu-id="520bd-126">An upgrade is termed successful when all update domains are upgraded within hello specified time-outs, and when all update domains are deemed healthy.</span></span>  <span data-ttu-id="520bd-127">Um domínio de atualização Íntegro significa que esse domínio de atualização Olá passado todas as verificações de integridade Olá especificadas na política de integridade de saudação.</span><span class="sxs-lookup"><span data-stu-id="520bd-127">A healthy update domain means that hello update domain passed all hello health checks specified in hello health policy.</span></span> <span data-ttu-id="520bd-128">Por exemplo, uma política de integridade pode obrigar que todos os serviços em uma instância do aplicativo estejam *íntegros*, de acordo com a definição de integridade do Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="520bd-128">For example, a health policy may mandate that all services within an application instance must be *healthy*, as health is defined by Service Fabric.</span></span>

<span data-ttu-id="520bd-129">As políticas e verificações de integridade durante a atualização feita pelo Service Fabric são independentes do serviço e do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="520bd-129">Health policies and checks during upgrade by Service Fabric are service and application agnostic.</span></span> <span data-ttu-id="520bd-130">Ou seja, nenhum teste específico de serviço é realizado.</span><span class="sxs-lookup"><span data-stu-id="520bd-130">That is, no service-specific tests are done.</span></span>  <span data-ttu-id="520bd-131">Por exemplo, o serviço pode ter um requisito de taxa de transferência, mas o Service Fabric não tem a taxa de transferência do hello informações toocheck.</span><span class="sxs-lookup"><span data-stu-id="520bd-131">For example, your service might have a throughput requirement, but Service Fabric does not have hello information toocheck throughput.</span></span> <span data-ttu-id="520bd-132">Consulte toohello [artigos de integridade](service-fabric-health-introduction.md) para verificações de saudação que são executadas.</span><span class="sxs-lookup"><span data-stu-id="520bd-132">Refer toohello [health articles](service-fabric-health-introduction.md) for hello checks that are performed.</span></span> <span data-ttu-id="520bd-133">verificações de saudação que ocorrem durante uma atualização incluir testa se o pacote de aplicativo hello foi copiado corretamente, se Olá instância foi iniciada e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="520bd-133">hello checks that happen during an upgrade include tests for whether hello application package was copied correctly, whether hello instance was started, and so on.</span></span>

<span data-ttu-id="520bd-134">integridade do aplicativo Hello é uma agregação de entidades de filho de saudação do aplicativo hello.</span><span class="sxs-lookup"><span data-stu-id="520bd-134">hello application health is an aggregation of hello child entities of hello application.</span></span> <span data-ttu-id="520bd-135">Em resumo, Service Fabric avalia a integridade de saudação do aplicativo hello por meio de integridade Olá relatado no aplicativo hello.</span><span class="sxs-lookup"><span data-stu-id="520bd-135">In short, Service Fabric evaluates hello health of hello application through hello health that is reported on hello application.</span></span> <span data-ttu-id="520bd-136">Também avalia a integridade Olá de todos os serviços de saudação para o aplicativo hello dessa maneira.</span><span class="sxs-lookup"><span data-stu-id="520bd-136">It also evaluates hello health of all hello services for hello application this way.</span></span> <span data-ttu-id="520bd-137">Adicional do Service Fabric avalia a integridade de saudação dos serviços de aplicativo hello agregando integridade Olá de seus filhos, como réplicas do serviço hello.</span><span class="sxs-lookup"><span data-stu-id="520bd-137">Service Fabric further evaluates hello health of hello application services by aggregating hello health of their children, such as hello service replica.</span></span> <span data-ttu-id="520bd-138">Quando a política de integridade de aplicativo hello for satisfeita, atualização Olá pode continuar.</span><span class="sxs-lookup"><span data-stu-id="520bd-138">Once hello application health policy is satisfied, hello upgrade can proceed.</span></span> <span data-ttu-id="520bd-139">Se a política de integridade de saudação for violada, a atualização do aplicativo hello falhará.</span><span class="sxs-lookup"><span data-stu-id="520bd-139">If hello health policy is violated, hello application upgrade fails.</span></span>

## <a name="upgrade-modes"></a><span data-ttu-id="520bd-140">Modos de atualização</span><span class="sxs-lookup"><span data-stu-id="520bd-140">Upgrade modes</span></span>
<span data-ttu-id="520bd-141">Olá modo que recomendamos para atualização de aplicativo é Olá monitorado, que é o modo de saudação usado com frequência.</span><span class="sxs-lookup"><span data-stu-id="520bd-141">hello mode that we recommend for application upgrade is hello monitored mode, which is hello commonly used mode.</span></span> <span data-ttu-id="520bd-142">Modo monitorado executa a atualização de saudação na atualização de um domínio e se as verificações de integridade de todos os passagem (por Olá política especificada), move em toohello próximo domínio de atualização automaticamente.</span><span class="sxs-lookup"><span data-stu-id="520bd-142">Monitored mode performs hello upgrade on one update domain, and if all health checks pass (per hello policy specified), moves on toohello next update domain automatically.</span></span>  <span data-ttu-id="520bd-143">Se as verificações de integridade falharem e/ou tempos limite é atingido, Olá é ou reverter a atualização para o domínio de atualização de saudação ou modo Olá é alterado toounmonitored manual.</span><span class="sxs-lookup"><span data-stu-id="520bd-143">If health checks fail and/or time-outs are reached, hello upgrade is either rolled back for hello update domain, or hello mode is changed toounmonitored manual.</span></span> <span data-ttu-id="520bd-144">Você pode configurar Olá toochoose atualização um desses dois modos para atualizações que falharam.</span><span class="sxs-lookup"><span data-stu-id="520bd-144">You can configure hello upgrade toochoose one of those two modes for failed upgrades.</span></span> 

<span data-ttu-id="520bd-145">Não monitorado de modo manual precisa de intervenção manual depois de cada atualização em um domínio de atualização, tookick off Olá atualização no próximo domínio de atualização hello.</span><span class="sxs-lookup"><span data-stu-id="520bd-145">Unmonitored manual mode needs manual intervention after every upgrade on an update domain, tookick off hello upgrade on hello next update domain.</span></span> <span data-ttu-id="520bd-146">Nenhuma verificação de integridade do Service Fabric é executada.</span><span class="sxs-lookup"><span data-stu-id="520bd-146">No Service Fabric health checks are performed.</span></span> <span data-ttu-id="520bd-147">administrador Olá executa verificações de integridade ou status de saudação antes de Iniciar atualização Olá Olá próximo domínio de atualização.</span><span class="sxs-lookup"><span data-stu-id="520bd-147">hello administrator performs hello health or status checks before starting hello upgrade in hello next update domain.</span></span>

## <a name="upgrade-default-services"></a><span data-ttu-id="520bd-148">Fazer upgrade dos serviços padrão</span><span class="sxs-lookup"><span data-stu-id="520bd-148">Upgrade default services</span></span>
<span data-ttu-id="520bd-149">Serviços de padrão de aplicativo de malha do serviço podem ser atualizados durante o processo de atualização de saudação de um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="520bd-149">Default services within Service Fabric application can be upgraded during hello upgrade process of an application.</span></span> <span data-ttu-id="520bd-150">Serviços padrão são definidos em Olá [o manifesto do aplicativo](service-fabric-application-model.md#describe-an-application).</span><span class="sxs-lookup"><span data-stu-id="520bd-150">Default services are defined in hello [application manifest](service-fabric-application-model.md#describe-an-application).</span></span> <span data-ttu-id="520bd-151">saudação de regras padrão da atualização de serviços padrão é:</span><span class="sxs-lookup"><span data-stu-id="520bd-151">hello standard rules of upgrading default services are:</span></span>

1. <span data-ttu-id="520bd-152">Serviços de saudação novo padrão [o manifesto do aplicativo](service-fabric-application-model.md#describe-an-application) que não existe no cluster Olá são criados.</span><span class="sxs-lookup"><span data-stu-id="520bd-152">Default services in hello new [application manifest](service-fabric-application-model.md#describe-an-application) that do not exist in hello cluster are created.</span></span>
> [!TIP]
> <span data-ttu-id="520bd-153">[EnableDefaultServicesUpgrade](service-fabric-cluster-fabric-settings.md#fabric-settings-that-you-can-customize) precisa toobe definir tootrue tooenable Olá regras a seguir.</span><span class="sxs-lookup"><span data-stu-id="520bd-153">[EnableDefaultServicesUpgrade](service-fabric-cluster-fabric-settings.md#fabric-settings-that-you-can-customize) needs toobe set tootrue tooenable hello following rules.</span></span> <span data-ttu-id="520bd-154">Esse recurso é compatível com a v5.5.</span><span class="sxs-lookup"><span data-stu-id="520bd-154">This feature is supported from v5.5.</span></span>

2. <span data-ttu-id="520bd-155">Os serviços padrão existentes no [manifesto do aplicativo](service-fabric-application-model.md#describe-an-application) anterior e na nova versão são atualizados.</span><span class="sxs-lookup"><span data-stu-id="520bd-155">Default services existing in both previous [application manifest](service-fabric-application-model.md#describe-an-application) and new version are updated.</span></span> <span data-ttu-id="520bd-156">Descrições de serviços na nova versão de hello substituiria aqueles já está em cluster hello.</span><span class="sxs-lookup"><span data-stu-id="520bd-156">Service descriptions in hello new version would overwrite those already in hello cluster.</span></span> <span data-ttu-id="520bd-157">A atualização do aplicativo é revertida automaticamente na falha de atualização do serviço padrão.</span><span class="sxs-lookup"><span data-stu-id="520bd-157">Application upgrade would rollback automatically upon updating default service failure.</span></span>
3. <span data-ttu-id="520bd-158">Serviços de saudação anterior padrão [o manifesto do aplicativo](service-fabric-application-model.md#describe-an-application) , mas não na nova versão de hello serão excluídos.</span><span class="sxs-lookup"><span data-stu-id="520bd-158">Default services in hello previous [application manifest](service-fabric-application-model.md#describe-an-application) but not in hello new version are deleted.</span></span> <span data-ttu-id="520bd-159">**Observe que essa exclusão de serviços padrão não pode ser revertida.**</span><span class="sxs-lookup"><span data-stu-id="520bd-159">**Note that this deleting default services can not be reverted.**</span></span>

<span data-ttu-id="520bd-160">No caso de um aplicativo de atualização é revertida, serviços padrão são toohello revertido status antes do início da atualização.</span><span class="sxs-lookup"><span data-stu-id="520bd-160">In case of an application upgrade is rolled back, default services are reverted toohello status before upgrade started.</span></span> <span data-ttu-id="520bd-161">Mas os serviços excluídos nunca poderão ser criados.</span><span class="sxs-lookup"><span data-stu-id="520bd-161">But deleted services can never be created.</span></span>

## <a name="application-upgrade-flowchart"></a><span data-ttu-id="520bd-162">Fluxograma de atualização de aplicativo</span><span class="sxs-lookup"><span data-stu-id="520bd-162">Application upgrade flowchart</span></span>
<span data-ttu-id="520bd-163">fluxograma Olá este parágrafo a seguir pode ajudá-lo a entender o processo de atualização de saudação de um aplicativo de malha do serviço.</span><span class="sxs-lookup"><span data-stu-id="520bd-163">hello flowchart following this paragraph can help you understand hello upgrade process of a Service Fabric application.</span></span> <span data-ttu-id="520bd-164">Em particular, descreve o fluxo de Olá Olá como tempos-limite, inclusive *HealthCheckStableDuration*, *HealthCheckRetryTimeout*, e *UpgradeHealthCheckInterval*, ajuda a controlar quando Olá atualização no domínio de uma atualização é considerada um sucesso ou falha.</span><span class="sxs-lookup"><span data-stu-id="520bd-164">In particular, hello flow describes how hello time-outs, including *HealthCheckStableDuration*, *HealthCheckRetryTimeout*, and *UpgradeHealthCheckInterval*, help control when hello upgrade in one update domain is considered a success or a failure.</span></span>

![processo de atualização Olá para um aplicativo de serviço de malha][image]

## <a name="next-steps"></a><span data-ttu-id="520bd-166">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="520bd-166">Next steps</span></span>
<span data-ttu-id="520bd-167">[Atualização do aplicativo usando o Visual Studio](service-fabric-application-upgrade-tutorial.md) orienta você durante a atualização de aplicativo usando o Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="520bd-167">[Upgrading your Application Using Visual Studio](service-fabric-application-upgrade-tutorial.md) walks you through an application upgrade using Visual Studio.</span></span>

<span data-ttu-id="520bd-168">[Atualização do aplicativo usando o PowerShell](service-fabric-application-upgrade-tutorial-powershell.md) orienta você uma atualização de aplicativo usando o PowerShell.</span><span class="sxs-lookup"><span data-stu-id="520bd-168">[Upgrading your Application Using Powershell](service-fabric-application-upgrade-tutorial-powershell.md) walks you through an application upgrade using PowerShell.</span></span>

<span data-ttu-id="520bd-169">Controle como seu aplicativo é atualizado usando [Parâmetros de Atualização](service-fabric-application-upgrade-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="520bd-169">Control how your application upgrades by using [Upgrade Parameters](service-fabric-application-upgrade-parameters.md).</span></span>

<span data-ttu-id="520bd-170">Verifique suas atualizações de aplicativo compatível aprendendo como toouse [serialização de dados](service-fabric-application-upgrade-data-serialization.md).</span><span class="sxs-lookup"><span data-stu-id="520bd-170">Make your application upgrades compatible by learning how toouse [Data Serialization](service-fabric-application-upgrade-data-serialization.md).</span></span>

<span data-ttu-id="520bd-171">Saiba como toouse funcionalidade avançada ao atualizar seu aplicativo referindo-se muito[tópicos avançados](service-fabric-application-upgrade-advanced.md).</span><span class="sxs-lookup"><span data-stu-id="520bd-171">Learn how toouse advanced functionality while upgrading your application by referring too[Advanced Topics](service-fabric-application-upgrade-advanced.md).</span></span>

<span data-ttu-id="520bd-172">Corrigir problemas comuns em atualizações de aplicativo consultando etapas toohello [de solução de problemas de atualizações de aplicativo](service-fabric-application-upgrade-troubleshooting.md).</span><span class="sxs-lookup"><span data-stu-id="520bd-172">Fix common problems in application upgrades by referring toohello steps in [Troubleshooting Application Upgrades](service-fabric-application-upgrade-troubleshooting.md).</span></span>

[image]: media/service-fabric-application-upgrade/service-fabric-application-upgrade-flowchart.png
