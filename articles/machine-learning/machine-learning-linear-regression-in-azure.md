---
title: "Usando a Regressão Linear no Machine Learning | Microsoft Docs"
description: "Uma comparação dos modelos de regressão linear no Excel e no Azure Machine Learning Studio"
metakeywords: 
services: machine-learning
documentationcenter: 
author: garyericson
manager: jhubbard
editor: cgronlun
ms.assetid: 417ae6ab-de4f-4bdd-957a-d96133234656
ms.service: machine-learning
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 03/20/2017
ms.author: kbaroni;garye
ms.openlocfilehash: 7feb5d62415850e66f8eb7e22b9ada0d25a7058e
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 07/11/2017
---
# <a name="using-linear-regression-in-azure-machine-learning"></a><span data-ttu-id="7b5b1-103">Usando regressão linear no Azure Machine Learning</span><span class="sxs-lookup"><span data-stu-id="7b5b1-103">Using linear regression in Azure Machine Learning</span></span>
> <span data-ttu-id="7b5b1-104">*Kate Baroni* e *Ben Boatman* são arquitetos de soluções corporativas no Data Insights Center of Excellence da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-104">*Kate Baroni* and *Ben Boatman* are enterprise solution architects in Microsoft’s Data Insights Center of Excellence.</span></span> <span data-ttu-id="7b5b1-105">Neste artigo, eles descrevem sua experiência de migração de um pacote existente de análise de regressão para uma solução baseada em nuvem usando o Azure Machine Learning.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-105">In this article, they describe their experience migrating an existing regression analysis suite to a cloud-based solution using Azure Machine Learning.</span></span> 
> 
> 

&nbsp; 

[!INCLUDE [machine-learning-free-trial](../../includes/machine-learning-free-trial.md)]

## <a name="goal"></a><span data-ttu-id="7b5b1-106">Objetivo</span><span class="sxs-lookup"><span data-stu-id="7b5b1-106">Goal</span></span>
<span data-ttu-id="7b5b1-107">Nosso projeto começou com dois objetivos:</span><span class="sxs-lookup"><span data-stu-id="7b5b1-107">Our project started with two goals in mind:</span></span> 

1. <span data-ttu-id="7b5b1-108">Usar a análise preditiva para melhorar a precisão das projeções de receita mensal de nossa organização</span><span class="sxs-lookup"><span data-stu-id="7b5b1-108">Use predictive analytics to improve the accuracy of our organization’s monthly revenue projections</span></span> 
2. <span data-ttu-id="7b5b1-109">Usar o Azure Machine Learning para confirmar, otimizar, aumentar a velocidade e a escala de nossos resultados.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-109">Use Azure Machine Learning to confirm, optimize, increase velocity, and scale of our results.</span></span> 

<span data-ttu-id="7b5b1-110">Como muitas empresas, nossa organização passa por uma processo de previsão de receita mensal.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-110">Like many businesses, our organization goes through a monthly revenue forecasting process.</span></span> <span data-ttu-id="7b5b1-111">Nossa pequena equipe de analistas de negócios foi encarregada de usar o Azure Machine Learning para dar suporte ao processo e aumentar a precisão da previsão.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-111">Our small team of business analysts was tasked with using Azure Machine Learning to support the process and improve forecast accuracy.</span></span> <span data-ttu-id="7b5b1-112">A equipe passou vários meses coletando dados de várias fontes e submetendo os atributos de dados à análise estatística, identificando os principais atributos relevantes à previsão de vendas de serviços.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-112">The team spent several months collecting data from multiple sources and running the data attributes through statistical analysis identifying key attributes relevant to services sales forecasting.</span></span> <span data-ttu-id="7b5b1-113">A etapa seguinte foi iniciar a criação de protótipos de modelos de regressão estatística com os dados no Excel.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-113">The next step was to begin prototyping statistical regression models on the data in Excel.</span></span> <span data-ttu-id="7b5b1-114">Em poucas semanas, tínhamos um modelo de regressão do Excel que superava os processos atuais de previsão de campo e finanças.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-114">Within a few weeks, we had an Excel regression model that was outperforming the current field and finance forecasting processes.</span></span> <span data-ttu-id="7b5b1-115">Esse se tornou o resultado de previsão de linha de base.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-115">This became the baseline prediction result.</span></span> 

<span data-ttu-id="7b5b1-116">Passamos, então, à etapa seguinte e movemos nossa análise preditiva para o Azure Machine Learning, para descobrir como ele poderia melhorar o desempenho preditivo.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-116">We then took the next step to moving our predictive analytics over to Azure Machine Learning to find out how Machine Learning could improve on predictive performance.</span></span>

## <a name="achieving-predictive-performance-parity"></a><span data-ttu-id="7b5b1-117">Obtendo a paridade de desempenho preditivo</span><span class="sxs-lookup"><span data-stu-id="7b5b1-117">Achieving predictive performance parity</span></span>
<span data-ttu-id="7b5b1-118">Nossa maior prioridade era obter paridade entre os modelos de regressão do Azure Machine Learning e aqueles do Excel.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-118">Our first priority was to achieve parity between Machine Learning and Excel regression models.</span></span> <span data-ttu-id="7b5b1-119">Usando os mesmos dados e a mesma divisão para dados de treinamento e de teste, queríamos obter paridade de desempenho preditivo entre o Excel e o Azure Machine Learning.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-119">Given the same data, and the same split for training and testing data, we wanted to achieve predictive performance parity between Excel and Machine Learning.</span></span> <span data-ttu-id="7b5b1-120">Inicialmente, falhamos.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-120">Initially we failed.</span></span> <span data-ttu-id="7b5b1-121">O modelo do Excel superou o do Azure Machine Learning.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-121">The Excel model outperformed the Machine Learning model.</span></span> <span data-ttu-id="7b5b1-122">A falha ocorreu pela falta de compreensão da configuração da ferramenta de base no Machine Learning.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-122">The failure was due to a lack of understanding of the base tool setting in Machine Learning.</span></span> <span data-ttu-id="7b5b1-123">Após uma sincronização com a equipe de produto do Machine Learning, compreendemos melhor a configuração de base necessária aos nossos conjuntos de dados e alcançamos paridade entre os dois modelos.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-123">After a sync with the Machine Learning product team, we gained a better understanding of the base setting required for our data sets, and achieved parity between the two models.</span></span> 

### <a name="create-regression-model-in-excel"></a><span data-ttu-id="7b5b1-124">Criar um modelo de regressão no Excel</span><span class="sxs-lookup"><span data-stu-id="7b5b1-124">Create regression model in Excel</span></span>
<span data-ttu-id="7b5b1-125">Nossa Regressão do Excel usou o modelo de regressão linear padrão encontrado nas Ferramentas de Análise do Excel.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-125">Our Excel Regression used the standard linear regression model found in the Excel Analysis ToolPak.</span></span> 

<span data-ttu-id="7b5b1-126">Calculamos o *Erro de Média Absoluta %* e o usamos como a medida de desempenho para o modelo.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-126">We calculated *Mean Absolute % Error* and used it as the performance measure for the model.</span></span> <span data-ttu-id="7b5b1-127">Levamos três meses para chegar a um modelo de trabalho usando o Excel.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-127">It took 3 months to arrive at a working model using Excel.</span></span> <span data-ttu-id="7b5b1-128">Aproveitamos muito o aprendizado para o experimento com o Machine Learning Studio, que, em última análise, foi útil para entendermos os requisitos.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-128">We brought much of the learning into the Machine Learning Studio experiment which ultimately was beneficial in understanding requirements.</span></span>

### <a name="create-comparable-experiment-in-azure-machine-learning"></a><span data-ttu-id="7b5b1-129">Criar um experimento comparável no Azure Machine Learning</span><span class="sxs-lookup"><span data-stu-id="7b5b1-129">Create comparable experiment in Azure Machine Learning</span></span>
<span data-ttu-id="7b5b1-130">Seguimos estas etapas para criar nosso experimento no Machine Learning Studio:</span><span class="sxs-lookup"><span data-stu-id="7b5b1-130">We followed these steps to create our experiment in Machine Learning Studio:</span></span> 

1. <span data-ttu-id="7b5b1-131">Carregamos o conjunto de dados como arquivo csv no Machine Learning Studio (arquivo muito pequeno)</span><span class="sxs-lookup"><span data-stu-id="7b5b1-131">Uploaded the dataset as a csv file to Machine Learning Studio (very small file)</span></span>
2. <span data-ttu-id="7b5b1-132">Criamos um novo experimento e usamos o módulo [Selecionar Colunas no Conjunto de Dados][select-columns] para selecionar os mesmos recursos de dados usados no Excel</span><span class="sxs-lookup"><span data-stu-id="7b5b1-132">Created a new experiment and used the [Select Columns in Dataset][select-columns] module to select the same data features used in Excel</span></span> 
3. <span data-ttu-id="7b5b1-133">Usamos o módulo [Dividir Dados][split] (com o modo *Expressão Relativa*) para dividir os dados nos mesmos conjuntos de dados de treinamento usados no Excel</span><span class="sxs-lookup"><span data-stu-id="7b5b1-133">Used the [Split Data][split] module (with *Relative Expression* mode) to divide the data into the same training datasets as had been done in Excel</span></span> 
4. <span data-ttu-id="7b5b1-134">Experimentamos o módulo de [Regressão Linear][linear-regression] (somente opções padrão), documentamos e comparamos os resultados com o nosso modelo de regressão do Excel</span><span class="sxs-lookup"><span data-stu-id="7b5b1-134">Experimented with the [Linear Regression][linear-regression] module (default options only), documented, and compared the results to our Excel regression model</span></span>

### <a name="review-initial-results"></a><span data-ttu-id="7b5b1-135">Examinar os resultados iniciais</span><span class="sxs-lookup"><span data-stu-id="7b5b1-135">Review initial results</span></span>
<span data-ttu-id="7b5b1-136">Inicialmente, o modelo do Excel superou claramente o do Machine Learning Studio:</span><span class="sxs-lookup"><span data-stu-id="7b5b1-136">At first, the Excel model clearly outperformed the Machine Learning Studio model:</span></span> 

|  | <span data-ttu-id="7b5b1-137">Excel</span><span class="sxs-lookup"><span data-stu-id="7b5b1-137">Excel</span></span> | <span data-ttu-id="7b5b1-138">Estúdio</span><span class="sxs-lookup"><span data-stu-id="7b5b1-138">Studio</span></span> |
| --- |:---:|:---:|
| <span data-ttu-id="7b5b1-139">Desempenho</span><span class="sxs-lookup"><span data-stu-id="7b5b1-139">Performance</span></span> | | |
| <ul style="list-style-type: none;"><li><span data-ttu-id="7b5b1-140">Quadrado R Ajustado</span><span class="sxs-lookup"><span data-stu-id="7b5b1-140">Adjusted R Square</span></span></li></ul> |<span data-ttu-id="7b5b1-141">0,96</span><span class="sxs-lookup"><span data-stu-id="7b5b1-141">0.96</span></span> |<span data-ttu-id="7b5b1-142">N/D</span><span class="sxs-lookup"><span data-stu-id="7b5b1-142">N/A</span></span> |
| <ul style="list-style-type: none;"><li><span data-ttu-id="7b5b1-143">Coeficiente de</span><span class="sxs-lookup"><span data-stu-id="7b5b1-143">Coefficient of</span></span> <br /><span data-ttu-id="7b5b1-144">Determinação</span><span class="sxs-lookup"><span data-stu-id="7b5b1-144">Determination</span></span></li></ul> |<span data-ttu-id="7b5b1-145">N/D</span><span class="sxs-lookup"><span data-stu-id="7b5b1-145">N/A</span></span> |<span data-ttu-id="7b5b1-146">0,78</span><span class="sxs-lookup"><span data-stu-id="7b5b1-146">0.78</span></span><br /><span data-ttu-id="7b5b1-147">(baixa precisão)</span><span class="sxs-lookup"><span data-stu-id="7b5b1-147">(low accuracy)</span></span> |
| <span data-ttu-id="7b5b1-148">Erro Absoluto Médio</span><span class="sxs-lookup"><span data-stu-id="7b5b1-148">Mean Absolute Error</span></span> |<span data-ttu-id="7b5b1-149">US$ 9,5 milhões</span><span class="sxs-lookup"><span data-stu-id="7b5b1-149">$9.5M</span></span> |<span data-ttu-id="7b5b1-150">US$ 19,4 milhões</span><span class="sxs-lookup"><span data-stu-id="7b5b1-150">$ 19.4M</span></span> |
| <span data-ttu-id="7b5b1-151">Erro Absoluto Médio (%)</span><span class="sxs-lookup"><span data-stu-id="7b5b1-151">Mean Absolute Error (%)</span></span> |<span data-ttu-id="7b5b1-152">6,03%</span><span class="sxs-lookup"><span data-stu-id="7b5b1-152">6.03%</span></span> |<span data-ttu-id="7b5b1-153">12,2%</span><span class="sxs-lookup"><span data-stu-id="7b5b1-153">12.2%</span></span> |

<span data-ttu-id="7b5b1-154">Quando apresentamos nosso processo e os resultados aos desenvolvedores e cientistas de dados à equipe do Machine Learning, eles forneceram rapidamente algumas dicas úteis.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-154">When we ran our process and results by the developers and data scientists on the Machine Learning team, they quickly provided some useful tips.</span></span> 

* <span data-ttu-id="7b5b1-155">Quando você usa o módulo [Regressão Linear][linear-regression] no Machine Learning Studio, são fornecidos dois métodos:</span><span class="sxs-lookup"><span data-stu-id="7b5b1-155">When you use the [Linear Regression][linear-regression] module in Machine Learning Studio, two methods are provided:</span></span>
  * <span data-ttu-id="7b5b1-156">Gradiente Online Descendente: talvez seja mais adequado para problemas de maior escala</span><span class="sxs-lookup"><span data-stu-id="7b5b1-156">Online Gradient Descent: May be more suitable for larger-scale problems</span></span>
  * <span data-ttu-id="7b5b1-157">Mínimos Quadrados Comuns: esse é o método em que muitas pessoas pensam quando ouvem falar em regressão linear.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-157">Ordinary Least Squares: This is the method most people think of when they hear linear regression.</span></span> <span data-ttu-id="7b5b1-158">Para conjuntos de dados pequenos, Mínimos Quadrados Comuns pode ser uma opção melhor.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-158">For small datasets, Ordinary Least Squares can be a more optimal choice.</span></span>
* <span data-ttu-id="7b5b1-159">Considere a possibilidade de ajustar o parâmetro L2 de Regularização de Peso para melhorar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-159">Consider tweaking the L2 Regularization Weight parameter to improve performance.</span></span> <span data-ttu-id="7b5b1-160">Ele é definido como 0,001 por padrão e, para nosso pequeno conjunto de dados, o definimos como 0,005 para melhorar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-160">It is set to 0.001 by default, but for our small data set we set it to 0.005 to improve performance.</span></span> 

### <a name="mystery-solved"></a><span data-ttu-id="7b5b1-161">Mistério resolvido!</span><span class="sxs-lookup"><span data-stu-id="7b5b1-161">Mystery solved!</span></span>
<span data-ttu-id="7b5b1-162">Quando aplicamos as recomendações, atingimos desempenho de linha de base no Machine Learning Studio igual ao do Excel:</span><span class="sxs-lookup"><span data-stu-id="7b5b1-162">When we applied the recommendations, we achieved the same baseline performance in Machine Learning Studio as with Excel:</span></span> 

|  | <span data-ttu-id="7b5b1-163">Excel</span><span class="sxs-lookup"><span data-stu-id="7b5b1-163">Excel</span></span> | <span data-ttu-id="7b5b1-164">Estúdio (inicial)</span><span class="sxs-lookup"><span data-stu-id="7b5b1-164">Studio (Initial)</span></span> | <span data-ttu-id="7b5b1-165">Estúdio c/ quadrados mínimos</span><span class="sxs-lookup"><span data-stu-id="7b5b1-165">Studio w/ Least Squares</span></span> |
| --- |:---:|:---:|:---:|
| <span data-ttu-id="7b5b1-166">Valor rotulado</span><span class="sxs-lookup"><span data-stu-id="7b5b1-166">Labeled value</span></span> |<span data-ttu-id="7b5b1-167">Dados reais (numéricos)</span><span class="sxs-lookup"><span data-stu-id="7b5b1-167">Actuals (numeric)</span></span> |<span data-ttu-id="7b5b1-168">mesmo</span><span class="sxs-lookup"><span data-stu-id="7b5b1-168">same</span></span> |<span data-ttu-id="7b5b1-169">mesmo</span><span class="sxs-lookup"><span data-stu-id="7b5b1-169">same</span></span> |
| <span data-ttu-id="7b5b1-170">Aprendiz</span><span class="sxs-lookup"><span data-stu-id="7b5b1-170">Learner</span></span> |<span data-ttu-id="7b5b1-171">Excel -> Dados da Análise -> Regressão</span><span class="sxs-lookup"><span data-stu-id="7b5b1-171">Excel -> Data Analysis -> Regression</span></span> |<span data-ttu-id="7b5b1-172">Regressão Linear.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-172">Linear Regression.</span></span> |<span data-ttu-id="7b5b1-173">Regressão Linear</span><span class="sxs-lookup"><span data-stu-id="7b5b1-173">Linear Regression</span></span> |
| <span data-ttu-id="7b5b1-174">Opções de aprendiz</span><span class="sxs-lookup"><span data-stu-id="7b5b1-174">Learner options</span></span> |<span data-ttu-id="7b5b1-175">N/D</span><span class="sxs-lookup"><span data-stu-id="7b5b1-175">N/A</span></span> |<span data-ttu-id="7b5b1-176">Padrões</span><span class="sxs-lookup"><span data-stu-id="7b5b1-176">Defaults</span></span> |<span data-ttu-id="7b5b1-177">quadrados mínimos comuns</span><span class="sxs-lookup"><span data-stu-id="7b5b1-177">ordinary least squares</span></span><br /><span data-ttu-id="7b5b1-178">L2 = 0,005</span><span class="sxs-lookup"><span data-stu-id="7b5b1-178">L2 = 0.005</span></span> |
| <span data-ttu-id="7b5b1-179">Conjunto de dados</span><span class="sxs-lookup"><span data-stu-id="7b5b1-179">Data Set</span></span> |<span data-ttu-id="7b5b1-180">26 linhas, 3 recursos, 1 rótulo.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-180">26 rows, 3 features, 1 label.</span></span> <span data-ttu-id="7b5b1-181">Todos numéricos.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-181">All numeric.</span></span> |<span data-ttu-id="7b5b1-182">mesmo</span><span class="sxs-lookup"><span data-stu-id="7b5b1-182">same</span></span> |<span data-ttu-id="7b5b1-183">mesmo</span><span class="sxs-lookup"><span data-stu-id="7b5b1-183">same</span></span> |
| <span data-ttu-id="7b5b1-184">Divisão: treinamento</span><span class="sxs-lookup"><span data-stu-id="7b5b1-184">Split: Train</span></span> |<span data-ttu-id="7b5b1-185">Excel treinado nas primeiras 18 linhas e testado nas últimas 8 linhas.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-185">Excel trained on the first 18 rows, tested on the last 8 rows.</span></span> |<span data-ttu-id="7b5b1-186">mesmo</span><span class="sxs-lookup"><span data-stu-id="7b5b1-186">same</span></span> |<span data-ttu-id="7b5b1-187">mesmo</span><span class="sxs-lookup"><span data-stu-id="7b5b1-187">same</span></span> |
| <span data-ttu-id="7b5b1-188">Divisão: teste</span><span class="sxs-lookup"><span data-stu-id="7b5b1-188">Split: Test</span></span> |<span data-ttu-id="7b5b1-189">Fórmula de regressão do Excel aplicada às últimas 8 linhas</span><span class="sxs-lookup"><span data-stu-id="7b5b1-189">Excel regression formula applied to the last 8 rows</span></span> |<span data-ttu-id="7b5b1-190">mesmo</span><span class="sxs-lookup"><span data-stu-id="7b5b1-190">same</span></span> |<span data-ttu-id="7b5b1-191">mesmo</span><span class="sxs-lookup"><span data-stu-id="7b5b1-191">same</span></span> |
| <span data-ttu-id="7b5b1-192">**Desempenho**</span><span class="sxs-lookup"><span data-stu-id="7b5b1-192">**Performance**</span></span> | | | |
| <span data-ttu-id="7b5b1-193">Quadrado R Ajustado</span><span class="sxs-lookup"><span data-stu-id="7b5b1-193">Adjusted R Square</span></span> |<span data-ttu-id="7b5b1-194">0,96</span><span class="sxs-lookup"><span data-stu-id="7b5b1-194">0.96</span></span> |<span data-ttu-id="7b5b1-195">N/D</span><span class="sxs-lookup"><span data-stu-id="7b5b1-195">N/A</span></span> | |
| <span data-ttu-id="7b5b1-196">Coeficiente de Determinação</span><span class="sxs-lookup"><span data-stu-id="7b5b1-196">Coefficient of Determination</span></span> |<span data-ttu-id="7b5b1-197">N/D</span><span class="sxs-lookup"><span data-stu-id="7b5b1-197">N/A</span></span> |<span data-ttu-id="7b5b1-198">0,78</span><span class="sxs-lookup"><span data-stu-id="7b5b1-198">0.78</span></span> |<span data-ttu-id="7b5b1-199">0,952049</span><span class="sxs-lookup"><span data-stu-id="7b5b1-199">0.952049</span></span> |
| <span data-ttu-id="7b5b1-200">Erro Absoluto Médio</span><span class="sxs-lookup"><span data-stu-id="7b5b1-200">Mean Absolute Error</span></span> |<span data-ttu-id="7b5b1-201">US$ 9,5 milhões</span><span class="sxs-lookup"><span data-stu-id="7b5b1-201">$9.5M</span></span> |<span data-ttu-id="7b5b1-202">US$ 19,4 milhões</span><span class="sxs-lookup"><span data-stu-id="7b5b1-202">$ 19.4M</span></span> |<span data-ttu-id="7b5b1-203">US$ 9,5 milhões</span><span class="sxs-lookup"><span data-stu-id="7b5b1-203">$9.5M</span></span> |
| <span data-ttu-id="7b5b1-204">Erro Absoluto Médio (%)</span><span class="sxs-lookup"><span data-stu-id="7b5b1-204">Mean Absolute Error (%)</span></span> |<span data-ttu-id="7b5b1-205"><span style="background-color: 00FF00;"> 6,03%</span></span><span class="sxs-lookup"><span data-stu-id="7b5b1-205"><span style="background-color: 00FF00;"> 6.03%</span></span></span> |<span data-ttu-id="7b5b1-206">12,2%</span><span class="sxs-lookup"><span data-stu-id="7b5b1-206">12.2%</span></span> |<span data-ttu-id="7b5b1-207"><span style="background-color: 00FF00;"> 6,03%</span></span><span class="sxs-lookup"><span data-stu-id="7b5b1-207"><span style="background-color: 00FF00;"> 6.03%</span></span></span> |

<span data-ttu-id="7b5b1-208">Além disso, os coeficientes do Excel saíram-se bem em comparação com os pesos de recurso no modelo de treinamento do Azure:</span><span class="sxs-lookup"><span data-stu-id="7b5b1-208">In addition, the Excel coefficients compared well to the feature weights in the Azure trained model:</span></span>

|  | <span data-ttu-id="7b5b1-209">Coeficientes do Excel</span><span class="sxs-lookup"><span data-stu-id="7b5b1-209">Excel Coefficients</span></span> | <span data-ttu-id="7b5b1-210">Pesos de recursos do Azure</span><span class="sxs-lookup"><span data-stu-id="7b5b1-210">Azure Feature Weights</span></span> |
| --- |:---:|:---:|
| <span data-ttu-id="7b5b1-211">Interceptação/desvio</span><span class="sxs-lookup"><span data-stu-id="7b5b1-211">Intercept/Bias</span></span> |<span data-ttu-id="7b5b1-212">19470209,88</span><span class="sxs-lookup"><span data-stu-id="7b5b1-212">19470209.88</span></span> |<span data-ttu-id="7b5b1-213">19328500</span><span class="sxs-lookup"><span data-stu-id="7b5b1-213">19328500</span></span> |
| <span data-ttu-id="7b5b1-214">Recurso A</span><span class="sxs-lookup"><span data-stu-id="7b5b1-214">Feature A</span></span> |<span data-ttu-id="7b5b1-215">0,832653063</span><span class="sxs-lookup"><span data-stu-id="7b5b1-215">0.832653063</span></span> |<span data-ttu-id="7b5b1-216">0,834156</span><span class="sxs-lookup"><span data-stu-id="7b5b1-216">0.834156</span></span> |
| <span data-ttu-id="7b5b1-217">Recurso B</span><span class="sxs-lookup"><span data-stu-id="7b5b1-217">Feature B</span></span> |<span data-ttu-id="7b5b1-218">11071967,08</span><span class="sxs-lookup"><span data-stu-id="7b5b1-218">11071967.08</span></span> |<span data-ttu-id="7b5b1-219">11007300</span><span class="sxs-lookup"><span data-stu-id="7b5b1-219">11007300</span></span> |
| <span data-ttu-id="7b5b1-220">Recurso C</span><span class="sxs-lookup"><span data-stu-id="7b5b1-220">Feature C</span></span> |<span data-ttu-id="7b5b1-221">25383318,09</span><span class="sxs-lookup"><span data-stu-id="7b5b1-221">25383318.09</span></span> |<span data-ttu-id="7b5b1-222">25140800</span><span class="sxs-lookup"><span data-stu-id="7b5b1-222">25140800</span></span> |

## <a name="next-steps"></a><span data-ttu-id="7b5b1-223">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="7b5b1-223">Next Steps</span></span>
<span data-ttu-id="7b5b1-224">Queríamos usar o serviço Web do Machine Learning no Excel.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-224">We wanted to consume the Machine Learning web service within Excel.</span></span> <span data-ttu-id="7b5b1-225">Nossos analistas de negócios usam o Excel, e precisávamos de um modo para chamar o serviço Web do Machine Learning com uma linha de dados do Excel e fazer com que ele retornasse ao Excel o valor previsto.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-225">Our business analysts rely on Excel and we needed a way to call the Machine Learning web service with a row of Excel data and have it return the predicted value to Excel.</span></span> 

<span data-ttu-id="7b5b1-226">Também queríamos otimizar nosso modelo, usando as opções e os algoritmos disponíveis no Machine Learning Studio.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-226">We also wanted to optimize our model, using the options and algorithms available in Machine Learning Studio.</span></span>

### <a name="integration-with-excel"></a><span data-ttu-id="7b5b1-227">Integração com o Excel</span><span class="sxs-lookup"><span data-stu-id="7b5b1-227">Integration with Excel</span></span>
<span data-ttu-id="7b5b1-228">A solução foi operacionalizar nosso modelo de regressão do Machine Learning criando um serviço Web com base no modelo treinado.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-228">Our solution was to operationalize our Machine Learning regression model by creating a web service from the trained model.</span></span> <span data-ttu-id="7b5b1-229">Em alguns minutos, o serviço Web foi criado e pudemos chamá-lo diretamente no Excel para retornar um valor de receita prevista.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-229">Within a few minutes, the web service was created and we could call it directly from Excel to return a predicted revenue value.</span></span> 

<span data-ttu-id="7b5b1-230">A seção *Painel de Serviços Web* inclui uma pasta de trabalho do Excel que pode ser baixada.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-230">The *Web Services Dashboard* section includes a downloadable Excel workbook.</span></span> <span data-ttu-id="7b5b1-231">A pasta de trabalho vem pré-formatada com a API do serviço Web e informações de esquema inseridas.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-231">The workbook comes pre-formatted with the web service API and schema information embedded.</span></span> <span data-ttu-id="7b5b1-232">Quando você clica em *Baixar Pasta de Trabalho do Excel*, ela é aberta e você pode salvá-la em seu computador local.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-232">When you click *Download Excel Workbook*, the workbook opens and you can save it to your local computer.</span></span> 

![][1]

<span data-ttu-id="7b5b1-233">Com a pasta de trabalho aberta, copie os parâmetros predefinidos para a seção azul Parâmetro, conforme mostrado abaixo.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-233">With the workbook open, copy your predefined parameters into the blue Parameter section as shown below.</span></span> <span data-ttu-id="7b5b1-234">Depois que os parâmetros forem inseridos, o Excel chamará o serviço Web do Machine Learning, e os rótulos pontuados previstos serão exibidos na seção verde Valores Previstos.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-234">Once the parameters are entered, Excel calls out to the Machine Learning web service and the predicted scored labels will display in the green Predicted Values section.</span></span> <span data-ttu-id="7b5b1-235">A pasta de trabalho continuará a criar previsões para parâmetros com base em seu modelo treinado para todos os itens de linha inseridos em Parâmetros.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-235">The workbook will continue to create predictions for parameters based on your trained model for all row items entered under Parameters.</span></span> <span data-ttu-id="7b5b1-236">Para obter mais informações sobre como usar esse recurso, confira [Utilizando um serviço Web do Azure Machine Learning no Excel](machine-learning-consuming-from-excel.md).</span><span class="sxs-lookup"><span data-stu-id="7b5b1-236">For more information on how to use this feature, see [Consuming an Azure Machine Learning Web Service from Excel](machine-learning-consuming-from-excel.md).</span></span> 

![][2]

### <a name="optimization-and-further-experiments"></a><span data-ttu-id="7b5b1-237">Otimização e experimentos adicionais</span><span class="sxs-lookup"><span data-stu-id="7b5b1-237">Optimization and further experiments</span></span>
<span data-ttu-id="7b5b1-238">Agora que tínhamos uma linha de base com nosso modelo do Excel, otimizamos nosso Modelo de Regressão Linear do Machine Learning.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-238">Now that we had a baseline with our Excel model, we moved ahead to optimize our Machine Learning Linear Regression Model.</span></span> <span data-ttu-id="7b5b1-239">Usamos o módulo [Seleção de Recursos com Base em Filtro][filter-based-feature-selection] para melhorar nossa seleção de elementos de dados iniciais e isso nos ajudou a obter uma melhoria de desempenho de 4,6% de Erro Absoluto Médio.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-239">We used the module [Filter-Based Feature Selection][filter-based-feature-selection] to improve on our selection of initial data elements and it helped us achieve a performance improvement of 4.6% Mean Absolute Error.</span></span> <span data-ttu-id="7b5b1-240">Para projetos futuros, usaremos esse recurso, que pode nos poupar semanas na iteração de atributos de dados para localizar o conjunto certo de recursos a serem usados para modelagem.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-240">For future projects we will use this feature which could save us weeks in iterating through data attributes to find the right set of features to use for modelling.</span></span> 

<span data-ttu-id="7b5b1-241">Em seguida, planejamos incluir algoritmos adicionais, como [Bayesiano][bayesian-linear-regression] ou [Árvores de Decisão Aumentadas][boosted-decision-tree-regression] em nosso experimento para comparar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-241">Next we plan to include additional algorithms like [Bayesian][bayesian-linear-regression] or [Boosted Decision Trees][boosted-decision-tree-regression] in our experiment to compare performance.</span></span> 

<span data-ttu-id="7b5b1-242">Se você quiser experimentar a regressão, um bom conjunto de dados para tentar é o conjunto de dados de exemplo de Regressão de Eficiência de Energia, que tem muitos atributos numéricos.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-242">If you want to experiment with regression, a good dataset to try is the Energy Efficiency Regression sample dataset, which has lots of numerical attributes.</span></span> <span data-ttu-id="7b5b1-243">O conjunto de dados integra os conjuntos de dados de exemplo no Machine Learning Studio.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-243">The dataset is provided as part of the sample datasets in Machine Learning Studio.</span></span> <span data-ttu-id="7b5b1-244">Você pode usar diversos módulos de aprendizado para prever a Carga de Aquecimento ou a Carga de Resfriamento.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-244">You can use a variety of learning modules to predict either Heating Load or Cooling Load.</span></span> <span data-ttu-id="7b5b1-245">O gráfico abaixo é uma comparação de desempenho de diferentes aprendizados de regressão em relação ao conjunto de dados de Eficiência Energética, prevendo a Carga de Resfriamento de variável de destino:</span><span class="sxs-lookup"><span data-stu-id="7b5b1-245">The chart below is a performance comparison of different regression learns against the Energy Efficiency dataset predicting for the target variable Cooling Load:</span></span> 

| <span data-ttu-id="7b5b1-246">Modelo</span><span class="sxs-lookup"><span data-stu-id="7b5b1-246">Model</span></span> | <span data-ttu-id="7b5b1-247">Erro Absoluto Médio</span><span class="sxs-lookup"><span data-stu-id="7b5b1-247">Mean Absolute Error</span></span> | <span data-ttu-id="7b5b1-248">Erro Quadrado Médio de Raiz</span><span class="sxs-lookup"><span data-stu-id="7b5b1-248">Root Mean Squared Error</span></span> | <span data-ttu-id="7b5b1-249">Erro Absoluto Relativo</span><span class="sxs-lookup"><span data-stu-id="7b5b1-249">Relative Absolute Error</span></span> | <span data-ttu-id="7b5b1-250">Erro Quadrado Relativo</span><span class="sxs-lookup"><span data-stu-id="7b5b1-250">Relative Squared Error</span></span> | <span data-ttu-id="7b5b1-251">Coeficiente de Determinação</span><span class="sxs-lookup"><span data-stu-id="7b5b1-251">Coefficient of Determination</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="7b5b1-252">Árvore de Decisão Aumentada</span><span class="sxs-lookup"><span data-stu-id="7b5b1-252">Boosted Decision Tree</span></span> |<span data-ttu-id="7b5b1-253">0,930113</span><span class="sxs-lookup"><span data-stu-id="7b5b1-253">0.930113</span></span> |<span data-ttu-id="7b5b1-254">1,4239</span><span class="sxs-lookup"><span data-stu-id="7b5b1-254">1.4239</span></span> |<span data-ttu-id="7b5b1-255">0,106647</span><span class="sxs-lookup"><span data-stu-id="7b5b1-255">0.106647</span></span> |<span data-ttu-id="7b5b1-256">0,021662</span><span class="sxs-lookup"><span data-stu-id="7b5b1-256">0.021662</span></span> |<span data-ttu-id="7b5b1-257">0,978338</span><span class="sxs-lookup"><span data-stu-id="7b5b1-257">0.978338</span></span> |
| <span data-ttu-id="7b5b1-258">Regressão Linear (Gradiente Descendente)</span><span class="sxs-lookup"><span data-stu-id="7b5b1-258">Linear Regression (Gradient Descent)</span></span> |<span data-ttu-id="7b5b1-259">2,035693</span><span class="sxs-lookup"><span data-stu-id="7b5b1-259">2.035693</span></span> |<span data-ttu-id="7b5b1-260">2,98006</span><span class="sxs-lookup"><span data-stu-id="7b5b1-260">2.98006</span></span> |<span data-ttu-id="7b5b1-261">0,233414</span><span class="sxs-lookup"><span data-stu-id="7b5b1-261">0.233414</span></span> |<span data-ttu-id="7b5b1-262">0,094881</span><span class="sxs-lookup"><span data-stu-id="7b5b1-262">0.094881</span></span> |<span data-ttu-id="7b5b1-263">0,905119</span><span class="sxs-lookup"><span data-stu-id="7b5b1-263">0.905119</span></span> |
| <span data-ttu-id="7b5b1-264">Regressão de Rede Neural</span><span class="sxs-lookup"><span data-stu-id="7b5b1-264">Neural Network Regression</span></span> |<span data-ttu-id="7b5b1-265">1,548195</span><span class="sxs-lookup"><span data-stu-id="7b5b1-265">1.548195</span></span> |<span data-ttu-id="7b5b1-266">2,114617</span><span class="sxs-lookup"><span data-stu-id="7b5b1-266">2.114617</span></span> |<span data-ttu-id="7b5b1-267">0,177517</span><span class="sxs-lookup"><span data-stu-id="7b5b1-267">0.177517</span></span> |<span data-ttu-id="7b5b1-268">0,047774</span><span class="sxs-lookup"><span data-stu-id="7b5b1-268">0.047774</span></span> |<span data-ttu-id="7b5b1-269">0,952226</span><span class="sxs-lookup"><span data-stu-id="7b5b1-269">0.952226</span></span> |
| <span data-ttu-id="7b5b1-270">Regressão Linear (Quadrados Mínimos Comuns)</span><span class="sxs-lookup"><span data-stu-id="7b5b1-270">Linear Regression (Ordinary Least Squares)</span></span> |<span data-ttu-id="7b5b1-271">1,428273</span><span class="sxs-lookup"><span data-stu-id="7b5b1-271">1.428273</span></span> |<span data-ttu-id="7b5b1-272">1,984461</span><span class="sxs-lookup"><span data-stu-id="7b5b1-272">1.984461</span></span> |<span data-ttu-id="7b5b1-273">0,163767</span><span class="sxs-lookup"><span data-stu-id="7b5b1-273">0.163767</span></span> |<span data-ttu-id="7b5b1-274">0,042074</span><span class="sxs-lookup"><span data-stu-id="7b5b1-274">0.042074</span></span> |<span data-ttu-id="7b5b1-275">0,957926</span><span class="sxs-lookup"><span data-stu-id="7b5b1-275">0.957926</span></span> |

## <a name="key-takeaways"></a><span data-ttu-id="7b5b1-276">Principais observações</span><span class="sxs-lookup"><span data-stu-id="7b5b1-276">Key Takeaways</span></span>
<span data-ttu-id="7b5b1-277">Aprendemos muito executando os experimentos de regressão do Excel e do Azure Machine Learning em paralelo.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-277">We learned a lot by from running Excel regression and Azure Machine Learning experiments in parallel.</span></span> <span data-ttu-id="7b5b1-278">Criar o modelo de linha de base no Excel e compará-lo a modelos usando a [Regressão Linear][linear-regression] do Machine Learning nos ajudou a aprender sobre o Azure Machine Learning e descobrimos oportunidades para melhorar o desempenho da seleção e modelagem de dados.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-278">Creating the baseline model in Excel and comparing it to models using Machine Learning [Linear Regression][linear-regression] helped us learn Azure Machine Learning, and we discovered opportunities to improve data selection and model performance.</span></span> 

<span data-ttu-id="7b5b1-279">Também descobrimos que é aconselhável usar a [Seleção de Recursos com Base em Filtro][filter-based-feature-selection] para acelerar projetos de previsão futuros.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-279">We also found that it is advisable to use [Filter-Based Feature Selection][filter-based-feature-selection] to accelerate future prediction projects.</span></span> <span data-ttu-id="7b5b1-280">Aplicando a seleção de recursos aos seus dados, você pode criar um modelo aprimorado no Machine Learning com melhor desempenho geral.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-280">By applying feature selection to your data, you can create an improved model in Machine Learning with better overall performance.</span></span> 

<span data-ttu-id="7b5b1-281">A capacidade de transferir a previsão de análise preditiva do Machine Learning para o Excel permite sistematicamente um aumento significativo na capacidade de fornecer resultados com êxito para um amplo público de negócios.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-281">The ability to transfer the predictive analytic forecasting from Machine Learning to Excel systemically allows a significant increase in the ability to successfully provide results to a broad business user audience.</span></span> 

## <a name="resources"></a><span data-ttu-id="7b5b1-282">Recursos</span><span class="sxs-lookup"><span data-stu-id="7b5b1-282">Resources</span></span>
<span data-ttu-id="7b5b1-283">Estes são alguns recursos que ajudam a trabalhar com a regressão:</span><span class="sxs-lookup"><span data-stu-id="7b5b1-283">Here are some resources for helping you work with regression:</span></span> 

* <span data-ttu-id="7b5b1-284">Regressão no Excel.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-284">Regression in Excel.</span></span> <span data-ttu-id="7b5b1-285">Se você nunca experimentou a regressão no Excel, este tutorial facilita tudo: [http://www.excel-easy.com/examples/regression.html](http://www.excel-easy.com/examples/regression.html)</span><span class="sxs-lookup"><span data-stu-id="7b5b1-285">If you’ve never tried regression in Excel, this tutorial makes it easy: [http://www.excel-easy.com/examples/regression.html](http://www.excel-easy.com/examples/regression.html)</span></span>
* <span data-ttu-id="7b5b1-286">Regressão versus previsão.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-286">Regression vs forecasting.</span></span> <span data-ttu-id="7b5b1-287">Tyler Chessman escreveu um artigo no blog explicando como realizar a previsão de série temporal no Excel, que contém uma boa descrição para iniciantes sobre a regressão linear.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-287">Tyler Chessman wrote a blog article explaining how to do time series forecasting in Excel, which contains a good beginner’s description of linear regression.</span></span> [<span data-ttu-id="7b5b1-288">http://sqlmag.com/sql-server-analysis-services/understanding-time-series-forecasting-concepts</span><span class="sxs-lookup"><span data-stu-id="7b5b1-288">http://sqlmag.com/sql-server-analysis-services/understanding-time-series-forecasting-concepts</span></span>](http://sqlmag.com/sql-server-analysis-services/understanding-time-series-forecasting-concepts) 
* <span data-ttu-id="7b5b1-289">Regressão linear de quadrados mínimos simples: falhas, problemas e armadilhas.</span><span class="sxs-lookup"><span data-stu-id="7b5b1-289">Ordinary Least Squares Linear Regression: Flaws, Problems and Pitfalls.</span></span> <span data-ttu-id="7b5b1-290">Para obter uma introdução e uma discussão sobre regressão: [http://www.clockbackward.com/2009/06/18/ordinary-least-squares-linear-regression-flaws-problems-and-pitfalls/ ](http://www.clockbackward.com/2009/06/18/ordinary-least-squares-linear-regression-flaws-problems-and-pitfalls/)</span><span class="sxs-lookup"><span data-stu-id="7b5b1-290">For an introduction and discussion of Regression: [http://www.clockbackward.com/2009/06/18/ordinary-least-squares-linear-regression-flaws-problems-and-pitfalls/ ](http://www.clockbackward.com/2009/06/18/ordinary-least-squares-linear-regression-flaws-problems-and-pitfalls/)</span></span>

[1]: ./media/machine-learning-linear-regression-in-azure/machine-learning-linear-regression-in-azure-1.png
[2]: ./media/machine-learning-linear-regression-in-azure/machine-learning-linear-regression-in-azure-2.png


<!-- Module References -->
[bayesian-linear-regression]: https://msdn.microsoft.com/library/azure/ee12de50-2b34-4145-aec0-23e0485da308/
[boosted-decision-tree-regression]: https://msdn.microsoft.com/library/azure/0207d252-6c41-4c77-84c3-73bdf1ac5960/
[filter-based-feature-selection]: https://msdn.microsoft.com/library/azure/918b356b-045c-412b-aa12-94a1d2dad90f/
[linear-regression]: https://msdn.microsoft.com/library/azure/31960a6f-789b-4cf7-88d6-2e1152c0bd1a/
[select-columns]: https://msdn.microsoft.com/library/azure/1ec722fa-b623-4e26-a44e-a50c6d726223/
[split]: https://msdn.microsoft.com/library/azure/70530644-c97a-4ab6-85f7-88bf30a8be5f/

