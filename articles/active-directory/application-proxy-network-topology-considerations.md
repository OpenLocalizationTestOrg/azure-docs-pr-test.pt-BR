---
title: "Considerações de topologia de rede ao usar o Proxy de Aplicativo do Azure Active Directory | Microsoft Docs"
description: "Cobre as considerações de topologia de rede ao usar o Proxy de Aplicativo do Azure AD."
services: active-directory
documentationcenter: 
author: kgremban
manager: femila
ms.assetid: 
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/28/2017
ms.author: kgremban
ms.reviewer: harshja
ms.custom: it-pro
ms.openlocfilehash: 11244e0044eef8441e3a37ab8aeff0da30dacdb8
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/18/2017
---
# <a name="network-topology-considerations-when-using-azure-active-directory-application-proxy"></a><span data-ttu-id="32535-103">Considerações de topologia de rede ao usar o Proxy de Aplicativo do Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="32535-103">Network topology considerations when using Azure Active Directory Application Proxy</span></span>

<span data-ttu-id="32535-104">Este artigo explica as considerações de topologia de rede ao usar o Proxy de Aplicativo do Azure AD (Azure Active Directory) para publicar e acessar seus aplicativos remotamente.</span><span class="sxs-lookup"><span data-stu-id="32535-104">This article explains network topology considerations when using Azure Active Directory (Azure AD) Application Proxy for publishing and accessing your applications remotely.</span></span>

## <a name="traffic-flow"></a><span data-ttu-id="32535-105">Fluxo de tráfego</span><span class="sxs-lookup"><span data-stu-id="32535-105">Traffic flow</span></span>

<span data-ttu-id="32535-106">Quando um aplicativo é publicado por meio do Proxy de Aplicativo do Azure AD, o tráfego dos usuários para os aplicativos flui por meio de três conexões:</span><span class="sxs-lookup"><span data-stu-id="32535-106">When an application is published through Azure AD Application Proxy, traffic from the users to the applications flows through three connections:</span></span>

1. <span data-ttu-id="32535-107">O usuário se conecta ao ponto de extremidade público do serviço Proxy de Aplicativo do Azure AD no Azure</span><span class="sxs-lookup"><span data-stu-id="32535-107">The user connects to the Azure AD Application Proxy service public endpoint on Azure</span></span>
2. <span data-ttu-id="32535-108">O serviço Proxy de Aplicativo se conecta ao conector de Proxy de Aplicativo</span><span class="sxs-lookup"><span data-stu-id="32535-108">The Application Proxy service connects to the Application Proxy connector</span></span>
3. <span data-ttu-id="32535-109">O conector de Proxy de Aplicativo se conecta ao aplicativo de destino</span><span class="sxs-lookup"><span data-stu-id="32535-109">The Application Proxy connector connects to the target application</span></span>

![Diagrama mostrando o fluxo de tráfego de usuário para o aplicativo de destino](./media/application-proxy-network-topologies/application-proxy-three-hops.png)

## <a name="tenant-location-and-application-proxy-service"></a><span data-ttu-id="32535-111">Local do locatário e serviço Proxy de Aplicativo</span><span class="sxs-lookup"><span data-stu-id="32535-111">Tenant location and Application Proxy service</span></span>

<span data-ttu-id="32535-112">Quando você se inscreve para um locatário do Azure AD, a região do seu locatário é determinada pelo país especificado.</span><span class="sxs-lookup"><span data-stu-id="32535-112">When you sign up for an Azure AD tenant, the region of your tenant is determined by the country you specify.</span></span> <span data-ttu-id="32535-113">Quando você habilita o Proxy de Aplicativo, as instâncias do serviço Proxy de Aplicativo de seu locatário são escolhidas ou criadas na mesma região que seu locatário do Azure AD, ou na região mais próxima a ele.</span><span class="sxs-lookup"><span data-stu-id="32535-113">When you enable Application Proxy, the Application Proxy service instances for your tenant are chosen or created in the same region as your Azure AD tenant, or the closest region to it.</span></span>

<span data-ttu-id="32535-114">Por exemplo, se a região do seu locatário do Azure AD é a UE (União Europeia), todos os conectores de Proxy de Aplicativo usam instâncias de serviço em datacenters do Azure na UE.</span><span class="sxs-lookup"><span data-stu-id="32535-114">For example, if your Azure AD tenant’s region is the European Union (EU), all your Application Proxy connectors use service instances in Azure datacenters in the EU.</span></span> <span data-ttu-id="32535-115">Quando seus usuários acessarem aplicativos publicados, o tráfego deles passará por instâncias do serviço Proxy de Aplicativo nessa localização.</span><span class="sxs-lookup"><span data-stu-id="32535-115">When your users access published applications, their traffic goes through the Application Proxy service instances in this location.</span></span>

## <a name="considerations-for-reducing-latency"></a><span data-ttu-id="32535-116">Considerações para redução da latência</span><span class="sxs-lookup"><span data-stu-id="32535-116">Considerations for reducing latency</span></span>

<span data-ttu-id="32535-117">Todas as soluções de proxy introduzem a latência em sua conexão de rede.</span><span class="sxs-lookup"><span data-stu-id="32535-117">All proxy solutions introduce latency into your network connection.</span></span> <span data-ttu-id="32535-118">Não importa a solução de proxy ou VPN escolhida como sua solução de acesso remoto, ela sempre incluirá um conjunto de servidores, permitindo a conexão dentro de sua rede corporativa.</span><span class="sxs-lookup"><span data-stu-id="32535-118">No matter which proxy or VPN solution you choose as your remote access solution, it always includes a set of servers enabling the connection to inside your corporate network.</span></span>

<span data-ttu-id="32535-119">As organizações geralmente incluem pontos de extremidade do servidor em sua rede de perímetro.</span><span class="sxs-lookup"><span data-stu-id="32535-119">Organizations typically include server endpoints in their perimeter network.</span></span> <span data-ttu-id="32535-120">No entanto, com o Proxy de Aplicativo do Azure AD, o tráfego flui por meio do serviço de proxy na nuvem, enquanto os conectores residem em sua rede corporativa.</span><span class="sxs-lookup"><span data-stu-id="32535-120">With Azure AD Application Proxy, however, traffic flows through the proxy service in the cloud while the connectors reside on your corporate network.</span></span> <span data-ttu-id="32535-121">Nenhuma rede de perímetro é necessária.</span><span class="sxs-lookup"><span data-stu-id="32535-121">No perimeter network is required.</span></span>

<span data-ttu-id="32535-122">As seções a seguir contêm sugestões adicionais para ajudá-lo a reduzir a latência ainda mais.</span><span class="sxs-lookup"><span data-stu-id="32535-122">The next sections contain additional suggestions to help you reduce latency even further.</span></span> 

### <a name="connector-placement"></a><span data-ttu-id="32535-123">Posicionamento do conector</span><span class="sxs-lookup"><span data-stu-id="32535-123">Connector placement</span></span>

<span data-ttu-id="32535-124">O serviço Proxy de Aplicativo escolhe o local das instâncias para você, com base no local de seu locatário.</span><span class="sxs-lookup"><span data-stu-id="32535-124">Application Proxy chooses the location of instances for you, based on your tenant location.</span></span> <span data-ttu-id="32535-125">Entretanto, você pode decidir onde instalar o conector, permitindo que você defina as características de latência de seu tráfego de rede.</span><span class="sxs-lookup"><span data-stu-id="32535-125">However, you get to decide where to install the connector, giving you the power to define the latency characteristics of your network traffic.</span></span>

<span data-ttu-id="32535-126">Ao configurar o serviço de Proxy de Aplicativo, faça as seguintes perguntas:</span><span class="sxs-lookup"><span data-stu-id="32535-126">When setting up the Application Proxy service, ask the following questions:</span></span>

* <span data-ttu-id="32535-127">Onde o aplicativo está localizado?</span><span class="sxs-lookup"><span data-stu-id="32535-127">Where is the app located?</span></span>
* <span data-ttu-id="32535-128">Onde está localizada a maioria dos usuários que acessam o aplicativo?</span><span class="sxs-lookup"><span data-stu-id="32535-128">Where are most users who access the app located?</span></span>
* <span data-ttu-id="32535-129">Onde a instância do Proxy de Aplicativo está localizada?</span><span class="sxs-lookup"><span data-stu-id="32535-129">Where is the Application Proxy instance located?</span></span>
* <span data-ttu-id="32535-130">Você já tem uma conexão de rede dedicada com os data centers configurados do Azure, por exemplo, o Azure ExpressRoute ou uma VPN semelhante?</span><span class="sxs-lookup"><span data-stu-id="32535-130">Do you already have a dedicated network connection to Azure datacenters set up, like Azure ExpressRoute or a similar VPN?</span></span>

<span data-ttu-id="32535-131">O conector tem de se comunicar com o Azure e seus aplicativos (as etapas 2 e 3 no diagrama de fluxo Tráfego), de modo que o posicionamento do conector afeta a latência dessas duas conexões.</span><span class="sxs-lookup"><span data-stu-id="32535-131">The connector has to communicate with both Azure and your applications (steps 2 and 3 in the Traffic flow diagram), so the placement of the connector affects the latency of those two connections.</span></span> <span data-ttu-id="32535-132">Ao avaliar o posicionamento do conector, tenha em mente os seguintes pontos:</span><span class="sxs-lookup"><span data-stu-id="32535-132">When evaluating the placement of the connector, keep in mind the following points:</span></span>

* <span data-ttu-id="32535-133">Se você quiser usar a delegação restrita de Kerberos (KCD) para logon único, o conector precisará de uma linha de visão para um datacenter.</span><span class="sxs-lookup"><span data-stu-id="32535-133">If you want to use Kerberos constrained delegation (KCD) for single sign-on, then the connector needs a line of sight to a datacenter.</span></span> <span data-ttu-id="32535-134">Além disso, o servidor do conector deve ser ingressado no domínio.</span><span class="sxs-lookup"><span data-stu-id="32535-134">Additionally, the connector server needs to be domain joined.</span></span>  
* <span data-ttu-id="32535-135">Em caso de dúvida, instale o conector mais próximo ao aplicativo.</span><span class="sxs-lookup"><span data-stu-id="32535-135">When in doubt, install the connector closer to the application.</span></span>

### <a name="general-approach-to-minimize-latency"></a><span data-ttu-id="32535-136">Abordagem geral para minimizar a latência</span><span class="sxs-lookup"><span data-stu-id="32535-136">General approach to minimize latency</span></span>

<span data-ttu-id="32535-137">Você pode minimizar a latência do tráfego de ponta a ponta otimizando cada conexão de rede.</span><span class="sxs-lookup"><span data-stu-id="32535-137">You can minimize the latency of the end-to-end traffic by optimizing each network connection.</span></span> <span data-ttu-id="32535-138">Cada conexão pode ser otimizada com:</span><span class="sxs-lookup"><span data-stu-id="32535-138">Each connection can be optimized by:</span></span>

* <span data-ttu-id="32535-139">Reduzindo a distância entre as duas extremidades do salto.</span><span class="sxs-lookup"><span data-stu-id="32535-139">Reducing the distance between the two ends of the hop.</span></span>
* <span data-ttu-id="32535-140">Escolhendo a rede certa para percorrer.</span><span class="sxs-lookup"><span data-stu-id="32535-140">Choosing the right network to traverse.</span></span> <span data-ttu-id="32535-141">Por exemplo, percorrer uma rede privada, em vez da Internet pública, pode ser mais rápido devido aos links dedicados.</span><span class="sxs-lookup"><span data-stu-id="32535-141">For example, traversing a private network rather than the public Internet may be faster, due to dedicated links.</span></span>

<span data-ttu-id="32535-142">Se você tiver um link dedicado de VPN ou do ExpressRoute entre o Azure e sua rede corporativa, convém usá-lo.</span><span class="sxs-lookup"><span data-stu-id="32535-142">If you have a dedicated VPN or ExpressRoute link between Azure and your corporate network, you may want to use that.</span></span>

## <a name="focus-your-optimization-strategy"></a><span data-ttu-id="32535-143">Concentrar-se em sua estratégia de otimização</span><span class="sxs-lookup"><span data-stu-id="32535-143">Focus your optimization strategy</span></span>

<span data-ttu-id="32535-144">Não há muito que você pode fazer para controlar a conexão entre os usuários e o serviço Proxy de Aplicativo.</span><span class="sxs-lookup"><span data-stu-id="32535-144">There's little that you can do to control the connection between your users and the Application Proxy service.</span></span> <span data-ttu-id="32535-145">Os usuários podem acessar seus aplicativos de uma rede doméstica, de uma cafeteria ou de um país diferente.</span><span class="sxs-lookup"><span data-stu-id="32535-145">Users may access your apps from a home network, a coffee shop, or a different country.</span></span> <span data-ttu-id="32535-146">Em vez disso, você pode otimizar as conexões do serviço Proxy de Aplicativo para os conectores de Proxy de Aplicativo para os aplicativos.</span><span class="sxs-lookup"><span data-stu-id="32535-146">Instead, you can optimize the connections from the Application Proxy service to the Application Proxy connectors to the apps.</span></span> <span data-ttu-id="32535-147">Considere a possibilidade de incorporar os padrões a seguir em seu ambiente.</span><span class="sxs-lookup"><span data-stu-id="32535-147">Consider incorporating the following patterns in your environment.</span></span>

### <a name="pattern-1-put-the-connector-close-to-the-application"></a><span data-ttu-id="32535-148">Padrão 1: colocar o conector perto do aplicativo</span><span class="sxs-lookup"><span data-stu-id="32535-148">Pattern 1: Put the connector close to the application</span></span>

<span data-ttu-id="32535-149">Coloque o conector perto do aplicativo de destino na rede do cliente.</span><span class="sxs-lookup"><span data-stu-id="32535-149">Place the connector close to the target application in the customer network.</span></span> <span data-ttu-id="32535-150">Essa configuração minimiza a etapa 3 no diagrama de topografia porque o conector e o aplicativo estão próximos.</span><span class="sxs-lookup"><span data-stu-id="32535-150">This configuration minimizes step 3 in the topography diagram, because the connector and application are close.</span></span> 

<span data-ttu-id="32535-151">Se seu conector precisar de uma linha de visão para o controlador de domínio, então esse padrão será vantajoso.</span><span class="sxs-lookup"><span data-stu-id="32535-151">If your connector needs a line of sight to the domain controller, then this pattern is advantageous.</span></span> <span data-ttu-id="32535-152">A maioria de nossos clientes usa esse padrão, porque ele funciona bem para a maioria dos cenários.</span><span class="sxs-lookup"><span data-stu-id="32535-152">Most of our customers use this pattern, because it works well for most scenarios.</span></span> <span data-ttu-id="32535-153">Esse padrão também pode ser combinado com o padrão 2 para otimizar o tráfego entre o serviço e o conector.</span><span class="sxs-lookup"><span data-stu-id="32535-153">This pattern can also be combined with pattern 2 to optimize traffic between the service and the connector.</span></span>

### <a name="pattern-2-take-advantage-of-expressroute-with-public-peering"></a><span data-ttu-id="32535-154">Padrão 2: Aproveitar o ExpressRoute com o emparelhamento público</span><span class="sxs-lookup"><span data-stu-id="32535-154">Pattern 2: Take advantage of ExpressRoute with public peering</span></span>

<span data-ttu-id="32535-155">Se você tiver configurado com o emparelhamento público do ExpressRoute, você poderá usar a conexão do ExpressRoute mais rápida para o tráfego entre o Proxy de Aplicativo e o conector.</span><span class="sxs-lookup"><span data-stu-id="32535-155">If you have ExpressRoute set up with public peering, you can use the faster ExpressRoute connection for traffic between Application Proxy and the connector.</span></span> <span data-ttu-id="32535-156">O conector ainda está em sua rede, perto do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="32535-156">The connector is still on your network, close to the app.</span></span>

### <a name="pattern-3-take-advantage-of-expressroute-with-private-peering"></a><span data-ttu-id="32535-157">Padrão 3: Aproveitar o ExpressRoute com o emparelhamento privado</span><span class="sxs-lookup"><span data-stu-id="32535-157">Pattern 3: Take advantage of ExpressRoute with private peering</span></span>

<span data-ttu-id="32535-158">Se você tiver uma configuração de VPN ou ExpressRoute dedicada com emparelhamento privado entre o Azure e sua rede corporativa, terá outra opção.</span><span class="sxs-lookup"><span data-stu-id="32535-158">If you have a dedicated VPN or ExpressRoute set up with private peering between Azure and your corporate network, you have another option.</span></span> <span data-ttu-id="32535-159">Nessa configuração, a rede virtual no Azure é geralmente considerada uma extensão da rede corporativa.</span><span class="sxs-lookup"><span data-stu-id="32535-159">In this configuration, the virtual network in Azure is typically considered as an extension of the corporate network.</span></span> <span data-ttu-id="32535-160">Portanto, você pode instalar o conector no data center do Azure e ainda atender aos requisitos de baixa latência da conexão entre o aplicativo e o conector.</span><span class="sxs-lookup"><span data-stu-id="32535-160">So you can install the connector in the Azure datacenter, and still satisfy the low latency requirements of the connector-to-app connection.</span></span>

<span data-ttu-id="32535-161">A latência não é comprometida, pois o tráfego está fluindo por uma conexão dedicada.</span><span class="sxs-lookup"><span data-stu-id="32535-161">Latency is not compromised because traffic is flowing over a dedicated connection.</span></span> <span data-ttu-id="32535-162">Você também obtém uma menor latência de serviço para o conector do Proxy de Aplicativo porque o conector está instalado em um datacenter do Azure perto da localização do locatário do Azure AD.</span><span class="sxs-lookup"><span data-stu-id="32535-162">You also get improved Application Proxy service-to-connector latency because the connector is installed in an Azure datacenter close to your Azure AD tenant location.</span></span>

![Diagrama mostrando o conector instalado em um datacenter do Azure](./media/application-proxy-network-topologies/application-proxy-expressroute-private.png)

### <a name="other-approaches"></a><span data-ttu-id="32535-164">Outras abordagens</span><span class="sxs-lookup"><span data-stu-id="32535-164">Other approaches</span></span>

<span data-ttu-id="32535-165">Embora o foco deste artigo é a instalação, você também pode alterar o posicionamento do aplicativo para obter os melhores características de latência.</span><span class="sxs-lookup"><span data-stu-id="32535-165">Although the focus of this article is connector placement, you can also change the placement of the application to get better latency characteristics.</span></span>

<span data-ttu-id="32535-166">As organizações estão cada vez mais migrando suas redes para ambientes hospedados.</span><span class="sxs-lookup"><span data-stu-id="32535-166">Increasingly, organizations are moving their networks into hosted environments.</span></span> <span data-ttu-id="32535-167">Isso permite colocar os aplicativos em um ambiente hospedado que também faz parte da rede corporativa, e ainda ser dentro do domínio.</span><span class="sxs-lookup"><span data-stu-id="32535-167">This enables them to place their apps in a hosted environment that is also part of their corporate network, and still be within the domain.</span></span> <span data-ttu-id="32535-168">Nesse caso, os padrões discutidos nas seções anteriores podem ser aplicados para o novo local do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="32535-168">In this case, the patterns discussed in the preceding sections can be applied to the new application location.</span></span> <span data-ttu-id="32535-169">Se você estiver considerando essa opção, consulte [Serviços de Domínio do Azure AD](../active-directory-domain-services/active-directory-ds-overview.md).</span><span class="sxs-lookup"><span data-stu-id="32535-169">If you're considering this option, see [Azure AD Domain Services](../active-directory-domain-services/active-directory-ds-overview.md).</span></span>

<span data-ttu-id="32535-170">Além disso, considere a possibilidade de organizar seus conectores usando [grupos de conectores](active-directory-application-proxy-connectors.md) para ter como destino aplicativos que estejam em locais e redes diferentes.</span><span class="sxs-lookup"><span data-stu-id="32535-170">Additionally, consider organizing your connectors using [connector groups](active-directory-application-proxy-connectors.md) to target apps that are in different locations and networks.</span></span> 

## <a name="common-use-cases"></a><span data-ttu-id="32535-171">Casos de uso comuns</span><span class="sxs-lookup"><span data-stu-id="32535-171">Common use cases</span></span>

<span data-ttu-id="32535-172">Nesta seção, veremos alguns cenários comuns.</span><span class="sxs-lookup"><span data-stu-id="32535-172">In this section, we walk through a few common scenarios.</span></span> <span data-ttu-id="32535-173">Suponha que o locatário do Azure AD (e, portanto, ponto de extremidade de serviço de proxy) está localizado nos Estados Unidos (EUA).</span><span class="sxs-lookup"><span data-stu-id="32535-173">Assume that the Azure AD tenant (and therefore proxy service endpoint) is located in the United States (US).</span></span> <span data-ttu-id="32535-174">As considerações discutidas nesses casos de uso também se aplicam a outras regiões pelo mundo.</span><span class="sxs-lookup"><span data-stu-id="32535-174">The considerations discussed in these use cases also apply to other regions around the globe.</span></span>

<span data-ttu-id="32535-175">Nesses cenários, chamamos cada conexão de um "salto" e os numeramos para uma discussão mais fácil:</span><span class="sxs-lookup"><span data-stu-id="32535-175">For these scenarios, we call each connection a "hop" and number them for easier discussion:</span></span>

- <span data-ttu-id="32535-176">**Salto 1**: usuário para o serviço Proxy de Aplicativo</span><span class="sxs-lookup"><span data-stu-id="32535-176">**Hop 1**: User to the Application Proxy service</span></span>
- <span data-ttu-id="32535-177">**Salto 2**: Serviço de Proxy de Aplicativo para o conector de Proxy de Aplicativo</span><span class="sxs-lookup"><span data-stu-id="32535-177">**Hop 2**: Application Proxy service to the Application Proxy connector</span></span>
- <span data-ttu-id="32535-178">**Salto 3**: Conector de Proxy de Aplicativo para o aplicativo de destino</span><span class="sxs-lookup"><span data-stu-id="32535-178">**Hop 3**: Application Proxy connector to the target application</span></span> 

### <a name="use-case-1"></a><span data-ttu-id="32535-179">Caso de uso 1</span><span class="sxs-lookup"><span data-stu-id="32535-179">Use case 1</span></span>

<span data-ttu-id="32535-180">**Cenário:** o aplicativo está na rede da organização nos EUA, com usuários na mesma região.</span><span class="sxs-lookup"><span data-stu-id="32535-180">**Scenario:** The app is in an organization's network in the US, with users in the same region.</span></span> <span data-ttu-id="32535-181">Não há um ExpressRoute ou uma VPN entre o data center do Azure e a rede corporativa.</span><span class="sxs-lookup"><span data-stu-id="32535-181">No ExpressRoute or VPN exists between the Azure datacenter and the corporate network.</span></span>

<span data-ttu-id="32535-182">**Recomendação:** siga o padrão 1, explicado na seção anterior.</span><span class="sxs-lookup"><span data-stu-id="32535-182">**Recommendation:** Follow pattern 1, explained in the previous section.</span></span> <span data-ttu-id="32535-183">Para melhorar a latência, considere o uso do ExpressRoute, se necessário.</span><span class="sxs-lookup"><span data-stu-id="32535-183">For improved latency, consider using ExpressRoute, if needed.</span></span>

<span data-ttu-id="32535-184">Este é um padrão simples.</span><span class="sxs-lookup"><span data-stu-id="32535-184">This is a simple pattern.</span></span> <span data-ttu-id="32535-185">Você otimiza o salto 3 colocando o conector perto do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="32535-185">You optimize hop 3 by placing the connector near the app.</span></span> <span data-ttu-id="32535-186">Essa também é uma opção natural, pois o conector normalmente é instalado com uma linha de visão para o aplicativo e com o data center para executar operações KCD.</span><span class="sxs-lookup"><span data-stu-id="32535-186">This is also a natural choice, because the connector typically is installed with line of sight to the app and to the datacenter to perform KCD operations.</span></span>

![Diagrama mostrando que usuários, proxy, conector e aplicativo estão todos nos EUA](./media/application-proxy-network-topologies/application-proxy-pattern1.png)

### <a name="use-case-2"></a><span data-ttu-id="32535-188">Caso de uso 2</span><span class="sxs-lookup"><span data-stu-id="32535-188">Use case 2</span></span>

<span data-ttu-id="32535-189">**Cenário:** o aplicativo está na rede da organização nos EUA, com usuários distribuídos globalmente.</span><span class="sxs-lookup"><span data-stu-id="32535-189">**Scenario:** The app is in an organization's network in the US, with users spread out globally.</span></span> <span data-ttu-id="32535-190">Não há um ExpressRoute ou uma VPN entre o data center do Azure e a rede corporativa.</span><span class="sxs-lookup"><span data-stu-id="32535-190">No ExpressRoute or VPN exists between the Azure datacenter and the corporate network.</span></span>

<span data-ttu-id="32535-191">**Recomendação:** siga o padrão 1, explicado na seção anterior.</span><span class="sxs-lookup"><span data-stu-id="32535-191">**Recommendation:** Follow pattern 1, explained in the previous section.</span></span> 

<span data-ttu-id="32535-192">Novamente, o padrão mais comum é otimizar o salto 3, onde você coloca o conector perto do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="32535-192">Again, the common pattern is to optimize hop 3, where you place the connector near the app.</span></span> <span data-ttu-id="32535-193">O salto 3 não costuma ser caro, se tudo estiver dentro da mesma região.</span><span class="sxs-lookup"><span data-stu-id="32535-193">Hop 3 is not typically expensive, if it is all within the same region.</span></span> <span data-ttu-id="32535-194">No entanto, o salto 1 poderá ser mais caro dependendo de onde o usuário estiver, pois os usuários pelo mundo precisarão acessar a instância do Proxy de Aplicativo nos EUA.</span><span class="sxs-lookup"><span data-stu-id="32535-194">However, hop 1 can be more expensive depending on where the user is, because users across the world must access the Application Proxy instance in the US.</span></span> <span data-ttu-id="32535-195">Vale a pena observar que qualquer solução de proxy tem características semelhantes sobre os usuários que estão sendo distribuídos globalmente.</span><span class="sxs-lookup"><span data-stu-id="32535-195">It's worth noting that any proxy solution has similar characteristics regarding users being spread out globally.</span></span>

![Diagrama mostrando que os usuários estão distribuídos globalmente, mas o proxy, o conector e o aplicativo estão nos EUA](./media/application-proxy-network-topologies/application-proxy-pattern2.png)

### <a name="use-case-3"></a><span data-ttu-id="32535-197">Caso de uso 3</span><span class="sxs-lookup"><span data-stu-id="32535-197">Use case 3</span></span>

<span data-ttu-id="32535-198">**Cenário:** o aplicativo está na rede da organização nos EUA.</span><span class="sxs-lookup"><span data-stu-id="32535-198">**Scenario:** The app is in an organization's network in the US.</span></span> <span data-ttu-id="32535-199">Há a ExpressRoute com emparelhamento público entre o Azure e a rede corporativa.</span><span class="sxs-lookup"><span data-stu-id="32535-199">ExpressRoute with public peering exists between Azure and the corporate network.</span></span>

<span data-ttu-id="32535-200">**Recomendação:** siga os padrões 1 e 2, explicados na seção anterior.</span><span class="sxs-lookup"><span data-stu-id="32535-200">**Recommendation:** Follow patterns 1 and 2, explained in the previous section.</span></span>

<span data-ttu-id="32535-201">Primeiro, coloque o conector mais próximo possível do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="32535-201">First, place the connector as close as possible to the app.</span></span> <span data-ttu-id="32535-202">O sistema usará automaticamente o ExpressRoute para o salto 2.</span><span class="sxs-lookup"><span data-stu-id="32535-202">Then, the system automatically uses ExpressRoute for hop 2.</span></span> 

<span data-ttu-id="32535-203">Se o link de ExpressRoute estiver usando o emparelhamento público, o tráfego entre o proxy e o conector flui por esse link.</span><span class="sxs-lookup"><span data-stu-id="32535-203">If the ExpressRoute link is using public peering, the traffic between the proxy and the connector flows over that link.</span></span> <span data-ttu-id="32535-204">O salto 2 tem latência otimizada.</span><span class="sxs-lookup"><span data-stu-id="32535-204">Hop 2 has optimized latency.</span></span>

![Diagrama mostrando o ExpressRoute entre o proxy e o conector](./media/application-proxy-network-topologies/application-proxy-pattern3.png)

### <a name="use-case-4"></a><span data-ttu-id="32535-206">Caso de uso 4</span><span class="sxs-lookup"><span data-stu-id="32535-206">Use case 4</span></span>

<span data-ttu-id="32535-207">**Cenário:** o aplicativo está na rede da organização nos EUA.</span><span class="sxs-lookup"><span data-stu-id="32535-207">**Scenario:** The app is in an organization's network in the US.</span></span> <span data-ttu-id="32535-208">Há a ExpressRoute com emparelhamento privado entre o Azure e a rede corporativa.</span><span class="sxs-lookup"><span data-stu-id="32535-208">ExpressRoute with private peering exists between Azure and the corporate network.</span></span>

<span data-ttu-id="32535-209">**Recomendação:** siga o padrão 3, explicado na seção anterior.</span><span class="sxs-lookup"><span data-stu-id="32535-209">**Recommendation:** Follow pattern 3, explained in the previous section.</span></span>

<span data-ttu-id="32535-210">Coloque o conector no data center do Azure que está conectado à rede corporativa por meio de emparelhamento privado do ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="32535-210">Place the connector in the Azure datacenter that is connected to the corporate network through ExpressRoute private peering.</span></span> 

<span data-ttu-id="32535-211">O conector pode ser colocado no datacenter do Azure.</span><span class="sxs-lookup"><span data-stu-id="32535-211">The connector can be placed in the Azure datacenter.</span></span> <span data-ttu-id="32535-212">Como o conector ainda tem uma linha de visão para o aplicativo e o data center por meio da rede privada, o salto 3 permanece otimizado.</span><span class="sxs-lookup"><span data-stu-id="32535-212">Since the connector still has a line of sight to the application and the datacenter through the private network, hop 3 remains optimized.</span></span> <span data-ttu-id="32535-213">Além disso, o salto 2 é ainda mais otimizado.</span><span class="sxs-lookup"><span data-stu-id="32535-213">In addition, hop 2 is optimized further.</span></span>

![Diagrama mostrando o conector em um datacenter do Azure e o ExpressRoute entre o conector e o aplicativo](./media/application-proxy-network-topologies/application-proxy-pattern4.png)

### <a name="use-case-5"></a><span data-ttu-id="32535-215">Caso de uso 5</span><span class="sxs-lookup"><span data-stu-id="32535-215">Use case 5</span></span>

<span data-ttu-id="32535-216">**Cenário:** o aplicativo está na rede da organização na UE, com a instância do Proxy de Aplicativo e a maioria dos usuários nos Estados Unidos.</span><span class="sxs-lookup"><span data-stu-id="32535-216">**Scenario:** The app is in an organization's network in the EU, with the Application Proxy instance and most users in the US.</span></span>

<span data-ttu-id="32535-217">**Recomendação:** coloque o conector próximo ao aplicativo.</span><span class="sxs-lookup"><span data-stu-id="32535-217">**Recommendation:** Place the connector near the app.</span></span> <span data-ttu-id="32535-218">Como os usuários dos Estados Unidos estão acessando uma instância do Proxy de Aplicativo que está na mesma região, o salto 1 não é muito caro.</span><span class="sxs-lookup"><span data-stu-id="32535-218">Because US users are accessing an Application Proxy instance that happens to be in the same region, hop 1 is not too expensive.</span></span> <span data-ttu-id="32535-219">O salto 3 está otimizado.</span><span class="sxs-lookup"><span data-stu-id="32535-219">Hop 3 is optimized.</span></span> <span data-ttu-id="32535-220">Considere a possibilidade de usar o ExpressRoute para otimizar o salto 2.</span><span class="sxs-lookup"><span data-stu-id="32535-220">Consider using ExpressRoute to optimize hop 2.</span></span> 

![Diagrama mostrando o proxy e usuários nos EUA, com o conector e o aplicativo na UE](./media/application-proxy-network-topologies/application-proxy-pattern5b.png)

<span data-ttu-id="32535-222">Você também pode considerar o uso de uma outra variante nessa situação.</span><span class="sxs-lookup"><span data-stu-id="32535-222">You can also consider using one other variant in this situation.</span></span> <span data-ttu-id="32535-223">Se a maioria dos usuários na organização estiver nos EUA, provavelmente sua rede se “estende” também para os EUA.</span><span class="sxs-lookup"><span data-stu-id="32535-223">If most users in the organization are in the US, then chances are that your network extends to the US as well.</span></span> <span data-ttu-id="32535-224">Coloque o conector nos EUA e use a linha de rede corporativa interna dedicada para o aplicativo na UE.</span><span class="sxs-lookup"><span data-stu-id="32535-224">Place the connector in the US, and use the dedicated internal corporate network line to the application in the EU.</span></span> <span data-ttu-id="32535-225">Desta forma, os saltos 2 e 3 são otimizados.</span><span class="sxs-lookup"><span data-stu-id="32535-225">This way hops 2 and 3 are optimized.</span></span>

![Diagrama mostrando os usuários, o proxy e o conector nos EUA e o aplicativo na UE](./media/application-proxy-network-topologies/application-proxy-pattern5c.png)

## <a name="next-steps"></a><span data-ttu-id="32535-227">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="32535-227">Next steps</span></span>

- [<span data-ttu-id="32535-228">Habilitar Proxy de aplicativo</span><span class="sxs-lookup"><span data-stu-id="32535-228">Enable Application Proxy</span></span>](active-directory-application-proxy-enable.md)
- [<span data-ttu-id="32535-229">Habilitar o logon único</span><span class="sxs-lookup"><span data-stu-id="32535-229">Enable single-sign on</span></span>](active-directory-application-proxy-sso-using-kcd.md)
- [<span data-ttu-id="32535-230">Habilitar o acesso condicional</span><span class="sxs-lookup"><span data-stu-id="32535-230">Enable conditional access</span></span>](active-directory-application-proxy-conditional-access.md)
- [<span data-ttu-id="32535-231">Solucionar problemas que surgirem com o Proxy de Aplicativo</span><span class="sxs-lookup"><span data-stu-id="32535-231">Troubleshoot issues you're having with Application Proxy</span></span>](active-directory-application-proxy-troubleshoot.md)
