---
title: "Implementar a sincronização de senha com o Azure AD Connect | Microsoft Docs"
description: "Fornece informações sobre como funciona a sincronização de senha e como configurá-la."
services: active-directory
documentationcenter: 
author: MarkusVi
manager: femila
editor: 
ms.assetid: 05f16c3e-9d23-45dc-afca-3d0fa9dbf501
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/17/2017
ms.author: billmath
ms.openlocfilehash: db9b1578a235be9018fc1985cc75a0a05ee47b3a
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/03/2017
---
# <a name="implement-password-synchronization-with-azure-ad-connect-sync"></a><span data-ttu-id="32d2c-103">Implementar a sincronização de senha com o Azure AD Connect</span><span class="sxs-lookup"><span data-stu-id="32d2c-103">Implement password synchronization with Azure AD Connect sync</span></span>
<span data-ttu-id="32d2c-104">Este artigo fornece as informações necessárias para sincronizar suas senhas de usuário de uma instância do AD (Active Directory) local para uma instância do Azure AD (Azure Active Directory) baseada na nuvem.</span><span class="sxs-lookup"><span data-stu-id="32d2c-104">This article provides information that you need to synchronize your user passwords from an on-premises Active Directory instance to a cloud-based Azure Active Directory (Azure AD) instance.</span></span>

## <a name="what-is-password-synchronization"></a><span data-ttu-id="32d2c-105">O que é sincronização de senha</span><span class="sxs-lookup"><span data-stu-id="32d2c-105">What is password synchronization</span></span>
<span data-ttu-id="32d2c-106">A probabilidade de você ser impedido de concluir seu trabalho devido a uma senha esquecida está relacionada ao número de senhas diferentes que você precisa se lembrar.</span><span class="sxs-lookup"><span data-stu-id="32d2c-106">The probability that you're blocked from getting your work done due to a forgotten password is related to the number of different passwords you need to remember.</span></span> <span data-ttu-id="32d2c-107">Quanto mais senhas você precisa lembrar, maior a probabilidade de se esquecer uma delas.</span><span class="sxs-lookup"><span data-stu-id="32d2c-107">The more passwords you need to remember, the higher the probability to forget one.</span></span> <span data-ttu-id="32d2c-108">Perguntas e chamadas sobre redefinições de senha e outros problemas relacionados à senha demandam a maior parte dos recursos de assistência técnica.</span><span class="sxs-lookup"><span data-stu-id="32d2c-108">Questions and calls about password resets and other password-related issues demand the most helpdesk resources.</span></span>

<span data-ttu-id="32d2c-109">A sincronização de senha é um recurso usado para sincronizar senhas de usuário de uma instância do Active Directory local para uma instância do Azure Active Directory local.</span><span class="sxs-lookup"><span data-stu-id="32d2c-109">Password synchronization is a feature used to synchronize user passwords from an on-premises Active Directory instance to a cloud-based Azure AD instance.</span></span>
<span data-ttu-id="32d2c-110">Use esse recurso para entrar nos serviços do Azure AD como Office 365, Microsoft Intune, CRM Online e Azure Active Directory Domain Services (Azure AD DS).</span><span class="sxs-lookup"><span data-stu-id="32d2c-110">Use this feature to sign in to Azure AD services like Office 365, Microsoft Intune, CRM Online, and Azure Active Directory Domain Services (Azure AD DS).</span></span> <span data-ttu-id="32d2c-111">Você entra no serviço usando a mesma senha que usa para entrar sua instância do Active Directory local.</span><span class="sxs-lookup"><span data-stu-id="32d2c-111">You sign in to the service by using the same password you use to sign in to your on-premises Active Directory instance.</span></span>

![O que é o Azure AD Connect](./media/active-directory-aadconnectsync-implement-password-synchronization/arch1.png)

<span data-ttu-id="32d2c-113">Reduzindo o número de senhas que os usuários precisam manter para apenas uma.</span><span class="sxs-lookup"><span data-stu-id="32d2c-113">By reducing the number of passwords, your users need to maintain to just one.</span></span> <span data-ttu-id="32d2c-114">A sincronização de senha ajuda você a:</span><span class="sxs-lookup"><span data-stu-id="32d2c-114">Password synchronization helps you to:</span></span>

* <span data-ttu-id="32d2c-115">Aumentar a produtividade dos seus usuários.</span><span class="sxs-lookup"><span data-stu-id="32d2c-115">Improve the productivity of your users.</span></span>
* <span data-ttu-id="32d2c-116">Reduzir os custos de assistência técnica.</span><span class="sxs-lookup"><span data-stu-id="32d2c-116">Reduce your helpdesk costs.</span></span>  

<span data-ttu-id="32d2c-117">Se você optar por usar a [Federação com o Active Directory Federation Services (AD FS)](https://channel9.msdn.com/Series/Azure-Active-Directory-Videos-Demos/Configuring-AD-FS-for-user-sign-in-with-Azure-AD-Connect), outra opção será configurar a sincronização de senha como um backup em caso de falha na infraestrutura do AD FS.</span><span class="sxs-lookup"><span data-stu-id="32d2c-117">Also, if you decide to use [Federation with Active Directory Federation Services (AD FS)](https://channel9.msdn.com/Series/Azure-Active-Directory-Videos-Demos/Configuring-AD-FS-for-user-sign-in-with-Azure-AD-Connect), you can optionally set up password synchronization as a backup in case your AD FS infrastructure fails.</span></span>

<span data-ttu-id="32d2c-118">A sincronização de senha é uma extensão para o recurso de sincronização de diretório, implementado pelo Azure AD Connect Sync.</span><span class="sxs-lookup"><span data-stu-id="32d2c-118">Password synchronization is an extension to the directory synchronization feature implemented by Azure AD Connect sync.</span></span> <span data-ttu-id="32d2c-119">Para usar a sincronização de senha no seu ambiente, você precisa:</span><span class="sxs-lookup"><span data-stu-id="32d2c-119">To use password synchronization in your environment, you need to:</span></span>

* <span data-ttu-id="32d2c-120">Instalar o Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="32d2c-120">Install Azure AD Connect.</span></span>  
* <span data-ttu-id="32d2c-121">Configurar a sincronização de diretórios entre sua instância do Active Directory local e a instância do Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="32d2c-121">Configure directory synchronization between your on-premises Active Directory instance and your Azure Active Directory instance.</span></span>
* <span data-ttu-id="32d2c-122">Habilitar a sincronização de senha.</span><span class="sxs-lookup"><span data-stu-id="32d2c-122">Enable password synchronization.</span></span>

<span data-ttu-id="32d2c-123">Para saber mais, confira [Integrar suas identidades locais ao Azure Active Directory](active-directory-aadconnect.md).</span><span class="sxs-lookup"><span data-stu-id="32d2c-123">For more details, see [Integrating your on-premises identities with Azure Active Directory](active-directory-aadconnect.md).</span></span>

> [!NOTE]
> <span data-ttu-id="32d2c-124">Para obter mais detalhes sobre Azure Active Directory Domain Services, configurados para sincronização de senha e FIPS, veja “Sincronização de senha e FIPS” posteriormente neste artigo.</span><span class="sxs-lookup"><span data-stu-id="32d2c-124">For more details about Azure Active Directory Domain Services configured for FIPS and password synchronization, see "Password synchronization and FIPS" later in this article.</span></span>
>
>

## <a name="how-password-synchronization-works"></a><span data-ttu-id="32d2c-125">Como a sincronização de senha funciona</span><span class="sxs-lookup"><span data-stu-id="32d2c-125">How password synchronization works</span></span>
<span data-ttu-id="32d2c-126">O serviço de domínio do Active Directory armazena as senhas na forma de uma representação do valor de hash da senha de usuário real.</span><span class="sxs-lookup"><span data-stu-id="32d2c-126">The Active Directory domain service stores passwords in the form of a hash value representation of the actual user password.</span></span> <span data-ttu-id="32d2c-127">Um valor de hash é um resultado de uma função matemática unidirecional (o *algoritmo de hash*).</span><span class="sxs-lookup"><span data-stu-id="32d2c-127">A hash value is a result of a one-way mathematical function (the *hashing algorithm*).</span></span> <span data-ttu-id="32d2c-128">Não há um método para reverter o resultado de uma função unidirecional para a versão de texto sem formatação de uma senha.</span><span class="sxs-lookup"><span data-stu-id="32d2c-128">There is no method to revert the result of a one-way function to the plain text version of a password.</span></span> <span data-ttu-id="32d2c-129">Não é possível usar o hash de senha para entrar na sua rede local.</span><span class="sxs-lookup"><span data-stu-id="32d2c-129">You cannot use a password hash to sign in to your on-premises network.</span></span>

<span data-ttu-id="32d2c-130">Para sincronizar sua senha, a sincronização do Azure AD Connect extrai o hash da senha de usuário da instância do Active Directory local.</span><span class="sxs-lookup"><span data-stu-id="32d2c-130">To synchronize your password, Azure AD Connect sync extracts your password hash from the on-premises Active Directory instance.</span></span> <span data-ttu-id="32d2c-131">O processamento de segurança adicional é aplicado ao hash da senha antes que ele seja sincronizado com o serviço de autenticação do Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="32d2c-131">Extra security processing is applied to the password hash before it is synchronized to the Azure Active Directory authentication service.</span></span> <span data-ttu-id="32d2c-132">As senhas são sincronizadas por usuário e em ordem cronológica.</span><span class="sxs-lookup"><span data-stu-id="32d2c-132">Passwords are synchronized on a per-user basis and in chronological order.</span></span>

<span data-ttu-id="32d2c-133">O fluxo de dados real do processo de sincronização de senha é semelhante à sincronização de dados de usuário como DisplayName ou Endereços de Email.</span><span class="sxs-lookup"><span data-stu-id="32d2c-133">The actual data flow of the password synchronization process is similar to the synchronization of user data such as DisplayName or Email Addresses.</span></span> <span data-ttu-id="32d2c-134">Contudo, as senhas são sincronizadas com mais frequência do que a janela de sincronização de diretório padrão para outros atributos.</span><span class="sxs-lookup"><span data-stu-id="32d2c-134">However, passwords are synchronized more frequently than the standard directory synchronization window for other attributes.</span></span> <span data-ttu-id="32d2c-135">O processo de sincronização de senha é executado a cada 2 minutos.</span><span class="sxs-lookup"><span data-stu-id="32d2c-135">The password synchronization process runs every 2 minutes.</span></span> <span data-ttu-id="32d2c-136">Não é possível modificar a frequência desse processo.</span><span class="sxs-lookup"><span data-stu-id="32d2c-136">You cannot modify the frequency of this process.</span></span> <span data-ttu-id="32d2c-137">Ao sincronizar uma senha, ela substituirá a senha de nuvem existente.</span><span class="sxs-lookup"><span data-stu-id="32d2c-137">When you synchronize a password, it overwrites the existing cloud password.</span></span>

<span data-ttu-id="32d2c-138">Na primeira vez que você habilitar o recurso de sincronização de senha, ele executará uma sincronização inicial das senhas de todos os usuários no escopo.</span><span class="sxs-lookup"><span data-stu-id="32d2c-138">The first time you enable the password synchronization feature, it performs an initial synchronization of the passwords of all in-scope users.</span></span> <span data-ttu-id="32d2c-139">Você não pode definir explicitamente um subconjunto de senhas de usuário que deseja sincronizar.</span><span class="sxs-lookup"><span data-stu-id="32d2c-139">You cannot explicitly define a subset of user passwords that you want to synchronize.</span></span>

<span data-ttu-id="32d2c-140">Quando você altera uma senha local, a senha atualizada é sincronizada, geralmente em questão de minutos.</span><span class="sxs-lookup"><span data-stu-id="32d2c-140">When you change an on-premises password, the updated password is synchronized, most often in a matter of minutes.</span></span>
<span data-ttu-id="32d2c-141">O recurso de sincronização de senha repete automaticamente tentativas de sincronização com falha.</span><span class="sxs-lookup"><span data-stu-id="32d2c-141">The password synchronization feature automatically retries failed synchronization attempts.</span></span> <span data-ttu-id="32d2c-142">Se ocorrer um erro durante uma tentativa de sincronização de senha, um erro é registrado no seu visualizador de eventos.</span><span class="sxs-lookup"><span data-stu-id="32d2c-142">If an error occurs during an attempt to synchronize a password, an error is logged in your event viewer.</span></span>

<span data-ttu-id="32d2c-143">A sincronização de uma senha não afeta um usuário conectado atualmente.</span><span class="sxs-lookup"><span data-stu-id="32d2c-143">The synchronization of a password has no impact on the user  who is currently signed in.</span></span>
<span data-ttu-id="32d2c-144">Sua sessão de serviço de nuvem atual não será afetada imediatamente por uma alteração de senha sincronizada que ocorre enquanto você está logado em um serviço de nuvem.</span><span class="sxs-lookup"><span data-stu-id="32d2c-144">Your current cloud service session is not immediately affected by a synchronized password change that occurs while you are signed in to a cloud service.</span></span> <span data-ttu-id="32d2c-145">No entanto, quando o serviço de nuvem exigir que você se autentique novamente, será necessário fornecer a nova senha.</span><span class="sxs-lookup"><span data-stu-id="32d2c-145">However, when the cloud service requires you to authenticate again, you need to provide your new password.</span></span>

<span data-ttu-id="32d2c-146">O usuário deve inserir suas credenciais corporativas uma segunda vez para autenticar no Azure AD, independentemente se ele está conectado à rede corporativa.</span><span class="sxs-lookup"><span data-stu-id="32d2c-146">A user must enter their corporate credentials a second time to authenticate to Azure AD, regardless of whether they're signed in to their corporate network.</span></span> <span data-ttu-id="32d2c-147">Porém, esse padrão pode ser minimizado se o usuário marca a caixa de seleção "Manter-me conectado" (KMSI) ao entrar.</span><span class="sxs-lookup"><span data-stu-id="32d2c-147">These pattern can be minimized, however, if the user selects the Keep me signed in (KMSI) check box at sign in.</span></span> <span data-ttu-id="32d2c-148">Essa seleção define um cookie de sessão que ignora a autenticação por um curto período.</span><span class="sxs-lookup"><span data-stu-id="32d2c-148">This selection sets a session cookie that bypasses authentication for a short period.</span></span> <span data-ttu-id="32d2c-149">O comportamento KMSI pode ser habilitado ou desabilitado pelo administrador do Azure AD.</span><span class="sxs-lookup"><span data-stu-id="32d2c-149">KMSI behavior can be enabled or disabled by the Azure AD administrator.</span></span>

> [!NOTE]
> <span data-ttu-id="32d2c-150">Somente há suporte para a sincronização de senha para o usuário do tipo de objeto no Active Directory.</span><span class="sxs-lookup"><span data-stu-id="32d2c-150">Password sync is only supported for the object type user in Active Directory.</span></span> <span data-ttu-id="32d2c-151">Não há suporte para o tipo de objeto iNetOrgPerson.</span><span class="sxs-lookup"><span data-stu-id="32d2c-151">It is not supported for the iNetOrgPerson object type.</span></span>

### <a name="detailed-description-of-how-password-synchronization-works"></a><span data-ttu-id="32d2c-152">Descrição detalhada de como funciona a sincronização de senha</span><span class="sxs-lookup"><span data-stu-id="32d2c-152">Detailed description of how password synchronization works</span></span>
<span data-ttu-id="32d2c-153">Veja a seguir uma descrição detalhada de como funciona a sincronização de senha entre o Active Directory e o Azure AD.</span><span class="sxs-lookup"><span data-stu-id="32d2c-153">The following describes in-depth how password synchronization works between Active Directory and Azure AD.</span></span>

![Fluxo da senha detalhado](./media/active-directory-aadconnectsync-implement-password-synchronization/arch3.png)


1. <span data-ttu-id="32d2c-155">A cada dois minutos, o agente de sincronização de senha no servidor do AD Connect solicita hashes de senha armazenados (o atributo unicodePwd) de um controlador de domínio por meio do protocolo de replicação padrão [MS-DRSR](https://msdn.microsoft.com/library/cc228086.aspx) usado para sincronizar dados entre controladores de domínio.</span><span class="sxs-lookup"><span data-stu-id="32d2c-155">Every two minutes, the password synchronization agent on the AD Connect server requests stored password hashes (the unicodePwd attribute) from a DC via the standard [MS-DRSR](https://msdn.microsoft.com/library/cc228086.aspx) replication protocol used to synchronize data between DCs.</span></span> <span data-ttu-id="32d2c-156">A conta do serviço deve ter as permissões do AD Replicar Alterações de Diretório e Replicar Todas as Alterações de Diretório (concedidas por padrão na instalação) para obter os hashes de senha.</span><span class="sxs-lookup"><span data-stu-id="32d2c-156">The service account must have Replicate Directory Changes and Replicate Directory Changes All AD permissions (granted by default on installation) to obtain the password hashes.</span></span>
2. <span data-ttu-id="32d2c-157">Antes de enviar, o controlador de domínio criptografa o hash de senha MD4 usando uma chave que é um hash [MD5](http://www.rfc-editor.org/rfc/rfc1321.txt) da chave de sessão RPC e um valor de sal.</span><span class="sxs-lookup"><span data-stu-id="32d2c-157">Before sending, the DC encrypts the MD4 password hash by using a key that is a [MD5](http://www.rfc-editor.org/rfc/rfc1321.txt) hash of the RPC session key and a salt.</span></span> <span data-ttu-id="32d2c-158">Em seguida, ele envia o resultado para o agente de sincronização de senha por RPC.</span><span class="sxs-lookup"><span data-stu-id="32d2c-158">It then sends the result to the password synchronization agent over RPC.</span></span> <span data-ttu-id="32d2c-159">O controlador de domínio também passa o sal para o agente de sincronização usando o protocolo de replicação do controlador de domínio, para que o agente possa descriptografar o envelope.</span><span class="sxs-lookup"><span data-stu-id="32d2c-159">The DC also passes the salt to the synchronization agent by using the DC replication protocol, so the agent will be able to decrypt the envelope.</span></span>
3.  <span data-ttu-id="32d2c-160">Depois que o agente de sincronização de senha tiver o envelope criptografado, ele usará [MD5CryptoServiceProvider](https://msdn.microsoft.com/library/System.Security.Cryptography.MD5CryptoServiceProvider.aspx) e o sal para gerar uma chave para descriptografar os dados recebidos de volta para seu formato original de MD4.</span><span class="sxs-lookup"><span data-stu-id="32d2c-160">After the password synchronization agent has the encrypted envelope, it uses [MD5CryptoServiceProvider](https://msdn.microsoft.com/library/System.Security.Cryptography.MD5CryptoServiceProvider.aspx) and the salt to generate a key to decrypt the received data back to its original MD4 format.</span></span> <span data-ttu-id="32d2c-161">Em nenhum momento, o agente de sincronização de senha tem acesso à senha de texto não criptografado.</span><span class="sxs-lookup"><span data-stu-id="32d2c-161">At no point does the password synchronization agent have access to the clear text password.</span></span> <span data-ttu-id="32d2c-162">Uso que o agente de sincronização de senha faz do MD5 é estritamente para compatibilidade de protocolo de replicação com o controlador de domínio, e é usado somente no local entre o controlador de domínio e o agente de sincronização de senha.</span><span class="sxs-lookup"><span data-stu-id="32d2c-162">The password synchronization agent’s use of MD5 is strictly for replication protocol compatibility with the DC, and it is only used on premises between the DC and the password synchronization agent.</span></span>
4.  <span data-ttu-id="32d2c-163">O agente de sincronização de senha expande o hash de senha binária de 16 bits para 64 bytes convertendo primeiro o hash em uma cadeia hexadecimal de 32 bytes, depois convertendo essa cadeia de caracteres de volta para o binário com a codificação UTF-16.</span><span class="sxs-lookup"><span data-stu-id="32d2c-163">The password synchronization agent expands the 16-byte binary password hash to 64 bytes by first converting the hash to a 32-byte hexadecimal string, then converting this string back into binary with UTF-16 encoding.</span></span>
5.  <span data-ttu-id="32d2c-164">O agente de sincronização de senha adiciona um sal, composto por um sal de 10 bytes, para o binário de 64 bits a fim de proteger ainda mais o hash original.</span><span class="sxs-lookup"><span data-stu-id="32d2c-164">The password synchronization agent adds a salt, consisting of a 10-byte length salt, to the 64-byte binary to further protect the original hash.</span></span>
6.  <span data-ttu-id="32d2c-165">Depois, o agente de sincronização de senha combina o hash MD4 e o sal com entradas na função [PBKDF2](https://www.ietf.org/rfc/rfc2898.txt).</span><span class="sxs-lookup"><span data-stu-id="32d2c-165">The password synchronization agent then combines the MD4 hash plus salt, and inputs it into the [PBKDF2](https://www.ietf.org/rfc/rfc2898.txt) function.</span></span> <span data-ttu-id="32d2c-166">Um total de 1000 iterações do algoritmo de hash com chave [HMAC-SHA256](https://msdn.microsoft.com/library/system.security.cryptography.hmacsha256.aspx) é usado.</span><span class="sxs-lookup"><span data-stu-id="32d2c-166">1000 iterations of the [HMAC-SHA256](https://msdn.microsoft.com/library/system.security.cryptography.hmacsha256.aspx) keyed hashing algorithm is used.</span></span> 
7.  <span data-ttu-id="32d2c-167">O agente de sincronização de senha usa o hash resultante de 32 bytes, concatena o sal e o número de iterações SHA256 a ele (para ser usado pelo Azure AD) e transmite a cadeia de caracteres do Azure AD Connect para o Azure AD por SSL.</span><span class="sxs-lookup"><span data-stu-id="32d2c-167">The password synchronization agent takes the resulting 32-byte hash, concatenates both the salt and the number of SHA256 iterations to it (for use by Azure AD), then transmits the string from Azure AD Connect to Azure AD over SSL.</span></span></br> 
8.  <span data-ttu-id="32d2c-168">Quando um usuário tenta entrar no Azure AD e insere sua senha, a senha é executada por meio do mesmo processo de MD4 + sal + PBKDF2 + HMAC-SHA256.</span><span class="sxs-lookup"><span data-stu-id="32d2c-168">When a user attempts to sign in to Azure AD and enters their password, the password is run through the same MD4+salt+PBKDF2+HMAC-SHA256 process.</span></span> <span data-ttu-id="32d2c-169">Se o hash resultante corresponder ao hash armazenado no Azure AD, isso significa que o usuário digitou a senha correta e será autenticado.</span><span class="sxs-lookup"><span data-stu-id="32d2c-169">If the resulting hash matches the hash stored in Azure AD, the user has entered the correct password and is authenticated.</span></span> 

>[!Note] 
><span data-ttu-id="32d2c-170">O hash MD4 original não é transmitido para o Azure AD.</span><span class="sxs-lookup"><span data-stu-id="32d2c-170">The original MD4 hash is not transmitted to Azure AD.</span></span> <span data-ttu-id="32d2c-171">Em vez disso, o hash SHA256 do hash MD4 original é transmitido.</span><span class="sxs-lookup"><span data-stu-id="32d2c-171">Instead, the SHA256 hash of the original MD4 hash is transmitted.</span></span> <span data-ttu-id="32d2c-172">Como resultado, se o hash armazenado no Azure AD for obtido, ele não poderá ser usada em um ataque de passagem de hash no local.</span><span class="sxs-lookup"><span data-stu-id="32d2c-172">As a result, if the hash stored in Azure AD is obtained, it cannot be used in an on-premises pass-the-hash attack.</span></span>

### <a name="how-password-synchronization-works-with-azure-active-directory-domain-services"></a><span data-ttu-id="32d2c-173">Como funciona a sincronização de senhas com o Azure Active Directory Domain Services</span><span class="sxs-lookup"><span data-stu-id="32d2c-173">How password synchronization works with Azure Active Directory Domain Services</span></span>
<span data-ttu-id="32d2c-174">Você também pode usar o recurso de sincronização de senha para sincronizar suas senhas locais para o [Azure Active Directory Domain Services](../../active-directory-domain-services/active-directory-ds-overview.md).</span><span class="sxs-lookup"><span data-stu-id="32d2c-174">You can also use the password synchronization feature to synchronize your on-premises passwords to [Azure Active Directory Domain Services](../../active-directory-domain-services/active-directory-ds-overview.md).</span></span> <span data-ttu-id="32d2c-175">Nesse cenário, a instância do Azure Active Directory Domain Services autentica os usuários na nuvem com todos os métodos disponíveis na instância do Active Directory local.</span><span class="sxs-lookup"><span data-stu-id="32d2c-175">In this scenario, the Azure Active Directory Domain Services instance authenticates your users in the cloud with all the methods available in your on-premises Active Directory instance.</span></span> <span data-ttu-id="32d2c-176">A experiência desse cenário é semelhante a usar a ADMT (Ferramenta de Migração do Active Directory) em um ambiente local.</span><span class="sxs-lookup"><span data-stu-id="32d2c-176">The experience of this scenario is similar to using the Active Directory Migration Tool (ADMT) in an on-premises environment.</span></span>

### <a name="security-considerations"></a><span data-ttu-id="32d2c-177">Considerações de segurança</span><span class="sxs-lookup"><span data-stu-id="32d2c-177">Security considerations</span></span>
<span data-ttu-id="32d2c-178">Ao sincronizar senhas, a versão da sua senha em texto sem formatação não é exposta ao recurso de sincronização de senha, nem ao Azure AD ou qualquer um dos serviços associados.</span><span class="sxs-lookup"><span data-stu-id="32d2c-178">When synchronizing passwords, the plain-text version of your password is not exposed to the password synchronization feature, to Azure AD, or any of the associated services.</span></span>

<span data-ttu-id="32d2c-179">A autenticação do usuário ocorre no Azure AD e não na própria instância do Active Directory da organização.</span><span class="sxs-lookup"><span data-stu-id="32d2c-179">User authentication takes place against Azure AD rather than against the organization's own Active Directory instance.</span></span> <span data-ttu-id="32d2c-180">Se sua organização se preocupar com a saída de dados de senha da empresa, considere o fato de que os dados de senha SHA256 armazenados no Azure AD -- um hash do hash MD4 original -- são consideravelmente mais seguros do que o que está armazenado no Active Directory.</span><span class="sxs-lookup"><span data-stu-id="32d2c-180">If your organization has concerns about password data in any form leaving the premises, consider the fact that the SHA256 password data stored in Azure AD--a hash of the original MD4 hash--is significantly more secure than what is stored in Active Directory.</span></span> <span data-ttu-id="32d2c-181">Além disso, como não é possível descriptografar esse hash SHA256, ele não pode ser levado de volta ao ambiente do Active Directory da organização e apresentado como uma senha de usuário válida em um ataque de passagem de hash.</span><span class="sxs-lookup"><span data-stu-id="32d2c-181">Further, because this SHA256 hash cannot be decrypted, it cannot be brought back to the organization's Active Directory environment and presented as a valid user password in a pass-the-hash attack.</span></span>





### <a name="password-policy-considerations"></a><span data-ttu-id="32d2c-182">Considerações sobre política de senha</span><span class="sxs-lookup"><span data-stu-id="32d2c-182">Password policy considerations</span></span>
<span data-ttu-id="32d2c-183">Há dois tipos de políticas de senha que são afetadas ao habilitar a sincronização de senha:</span><span class="sxs-lookup"><span data-stu-id="32d2c-183">There are two types of password policies that are affected by enabling password synchronization:</span></span>

* <span data-ttu-id="32d2c-184">Política de complexidade de senha</span><span class="sxs-lookup"><span data-stu-id="32d2c-184">Password complexity policy</span></span>
* <span data-ttu-id="32d2c-185">Política de expiração de senha</span><span class="sxs-lookup"><span data-stu-id="32d2c-185">Password expiration policy</span></span>

#### <a name="password-complexity-policy"></a><span data-ttu-id="32d2c-186">Política de complexidade de senha</span><span class="sxs-lookup"><span data-stu-id="32d2c-186">Password complexity policy</span></span>  
<span data-ttu-id="32d2c-187">Quando a sincronização de senha é habilitada, as políticas de complexidade de senha na instância do Active Directory local substituem as políticas de complexidade na nuvem para usuários sincronizados.</span><span class="sxs-lookup"><span data-stu-id="32d2c-187">When password synchronization is enabled, the password complexity policies in your on-premises Active Directory instance override complexity policies in the cloud for synchronized users.</span></span> <span data-ttu-id="32d2c-188">Você pode usar todas as senhas válidas da sua instância do Active Directory local para acessar os serviços do Azure AD.</span><span class="sxs-lookup"><span data-stu-id="32d2c-188">You can use all of the valid passwords from your on-premises Active Directory instance to access Azure AD services.</span></span>

> [!NOTE]
> <span data-ttu-id="32d2c-189">Senhas de usuários criadas diretamente na nuvem ainda estão sujeitas a políticas de senha, conforme definido na nuvem.</span><span class="sxs-lookup"><span data-stu-id="32d2c-189">Passwords for users that are created directly in the cloud are still subject to password policies as defined in the cloud.</span></span>

#### <a name="password-expiration-policy"></a><span data-ttu-id="32d2c-190">Política de expiração de senha</span><span class="sxs-lookup"><span data-stu-id="32d2c-190">Password expiration policy</span></span>  
<span data-ttu-id="32d2c-191">Se um usuário estiver no escopo de sincronização de senha, a senha da conta de nuvem será definida como *Nunca Expirar*.</span><span class="sxs-lookup"><span data-stu-id="32d2c-191">If a user is in the scope of password synchronization, the cloud account password is set to *Never Expire*.</span></span>

<span data-ttu-id="32d2c-192">Você pode continuar entrando nos serviços de nuvem usando uma senha sincronizada que expirou no seu ambiente local.</span><span class="sxs-lookup"><span data-stu-id="32d2c-192">You can continue to sign in to your cloud services by using a synchronized password that is expired in your on-premises environment.</span></span> <span data-ttu-id="32d2c-193">A senha de nuvem será atualizada na próxima vez que você alterar a senha no ambiente local.</span><span class="sxs-lookup"><span data-stu-id="32d2c-193">Your cloud password is updated the next time you change the password in the on-premises environment.</span></span>

#### <a name="account-expiration"></a><span data-ttu-id="32d2c-194">Expiração da conta</span><span class="sxs-lookup"><span data-stu-id="32d2c-194">Account expiration</span></span>
<span data-ttu-id="32d2c-195">Se sua organização usar o atributo accountExpires como parte do gerenciamento de contas de usuário, lembre-se de que esse atributo não está sincronizado no Azure AD.</span><span class="sxs-lookup"><span data-stu-id="32d2c-195">If your organization uses the accountExpires attribute as part of user account management, be aware that this attribute is not synchronized to Azure AD.</span></span> <span data-ttu-id="32d2c-196">Como resultado, uma conta expirada do Active Directory em um ambiente configurado para sincronização de senha ainda estará ativa no Azure AD.</span><span class="sxs-lookup"><span data-stu-id="32d2c-196">As a result, an expired Active Directory account in an environment configured for password synchronization will still be active in Azure AD.</span></span> <span data-ttu-id="32d2c-197">Recomendamos que, se a conta expirar, uma ação de fluxo de trabalho deverá disparar um script do PowerShell que desabilita a conta de usuário do Azure AD.</span><span class="sxs-lookup"><span data-stu-id="32d2c-197">We recommend that if the account is expired, a workflow action should trigger a PowerShell script that disables the user's Azure AD account.</span></span> <span data-ttu-id="32d2c-198">Por outro lado, quando a conta for ativada, a instância do Azure AD deverá ser ativada.</span><span class="sxs-lookup"><span data-stu-id="32d2c-198">Conversely, when the account is turned on, the Azure AD instance should be turned on.</span></span>

### <a name="overwrite-synchronized-passwords"></a><span data-ttu-id="32d2c-199">Substituir senhas sincronizadas</span><span class="sxs-lookup"><span data-stu-id="32d2c-199">Overwrite synchronized passwords</span></span>
<span data-ttu-id="32d2c-200">Um administrador pode redefinir sua senha manualmente usando o Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="32d2c-200">An administrator can manually reset your password by using Windows PowerShell.</span></span>

<span data-ttu-id="32d2c-201">Nesse caso, a nova senha substitui a senha sincronizada e todas as políticas de senha definidas na nuvem se aplicam à nova senha.</span><span class="sxs-lookup"><span data-stu-id="32d2c-201">In this case, the new password overrides your synchronized password, and all password policies defined in the cloud are applied to the new password.</span></span>

<span data-ttu-id="32d2c-202">Se você alterar a senha local novamente, a nova senha será sincronizada com a nuvem e substituirá a senha atualizada manualmente.</span><span class="sxs-lookup"><span data-stu-id="32d2c-202">If you change your on-premises password again, the new password is synchronized to the cloud, and it overrides the manually updated password.</span></span>

<span data-ttu-id="32d2c-203">A sincronização de uma senha não afeta um usuário do Azure que está conectado.</span><span class="sxs-lookup"><span data-stu-id="32d2c-203">The synchronization of a password has no impact on the Azure user who is signed in.</span></span> <span data-ttu-id="32d2c-204">Sua sessão de serviço de nuvem atual não será afetada imediatamente por uma alteração de senha sincronizada que ocorre enquanto você está conectado a um serviço de nuvem.</span><span class="sxs-lookup"><span data-stu-id="32d2c-204">Your current cloud service session is not immediately affected by a synchronized password change that occurs while you're signed in to a cloud service.</span></span> <span data-ttu-id="32d2c-205">KMSI ampliará a duração dessa diferença.</span><span class="sxs-lookup"><span data-stu-id="32d2c-205">KMSI extends the duration of this difference.</span></span> <span data-ttu-id="32d2c-206">Quando o serviço de nuvem exigir que você se autentique novamente, será necessário fornecer a nova senha.</span><span class="sxs-lookup"><span data-stu-id="32d2c-206">When the cloud service requires you to authenticate again, you need to provide your new password.</span></span>

### <a name="additional-advantages"></a><span data-ttu-id="32d2c-207">Vantagens adicionais</span><span class="sxs-lookup"><span data-stu-id="32d2c-207">Additional advantages</span></span>

- <span data-ttu-id="32d2c-208">Em geral, a sincronização de senha é mais simples de implementar do que um serviço de federação.</span><span class="sxs-lookup"><span data-stu-id="32d2c-208">Generally, password synchronization is simpler to implement than a federation service.</span></span> <span data-ttu-id="32d2c-209">Ela não exige quaisquer servidores adicionais e elimina a dependência de um serviço de federação altamente disponível para autenticar usuários.</span><span class="sxs-lookup"><span data-stu-id="32d2c-209">It doesn't require any additional servers, and eliminates dependence on a highly available federation service to authenticate users.</span></span> 
- <span data-ttu-id="32d2c-210">A sincronização de senha também pode ser habilitada além da federação.</span><span class="sxs-lookup"><span data-stu-id="32d2c-210">Password synchronization can also be enabled in addition to federation.</span></span> <span data-ttu-id="32d2c-211">Ela pode ser usada como um fallback se seu serviço de federação sofrer uma interrupção.</span><span class="sxs-lookup"><span data-stu-id="32d2c-211">It may be used as a fallback if your federation service experiences an outage.</span></span>












## <a name="enable-password-synchronization"></a><span data-ttu-id="32d2c-212">Habilitar a sincronização de senha</span><span class="sxs-lookup"><span data-stu-id="32d2c-212">Enable password synchronization</span></span>
<span data-ttu-id="32d2c-213">quando você instala o Azure AD Connect usando as **Configurações Expressas**, a sincronização de senha é habilitada automaticamente.</span><span class="sxs-lookup"><span data-stu-id="32d2c-213">When you install Azure AD Connect by using the **Express Settings** option, password synchronization is automatically enabled.</span></span> <span data-ttu-id="32d2c-214">Para obter mais detalhes, confira [Introdução ao Azure AD Connect usando configurações expressas](active-directory-aadconnect-get-started-express.md).</span><span class="sxs-lookup"><span data-stu-id="32d2c-214">For more details, see [Getting started with Azure AD Connect using express settings](active-directory-aadconnect-get-started-express.md).</span></span>

<span data-ttu-id="32d2c-215">Se você usar configurações personalizadas quando instalar o Azure AD Connect, a sincronização de senha estará disponível na página de entrada do usuário.</span><span class="sxs-lookup"><span data-stu-id="32d2c-215">If you use custom settings when you install Azure AD Connect, password synchronization is available on the user sign-in page.</span></span> <span data-ttu-id="32d2c-216">Para obter mais detalhes, confira [Instalação personalizada do Azure AD Connect](active-directory-aadconnect-get-started-custom.md).</span><span class="sxs-lookup"><span data-stu-id="32d2c-216">For more details, see [Custom installation of Azure AD Connect](active-directory-aadconnect-get-started-custom.md).</span></span>

![Habilitando a sincronização de senha](./media/active-directory-aadconnectsync-implement-password-synchronization/usersignin.png)

### <a name="password-synchronization-and-fips"></a><span data-ttu-id="32d2c-218">Sincronização de senha e FIPS</span><span class="sxs-lookup"><span data-stu-id="32d2c-218">Password synchronization and FIPS</span></span>
<span data-ttu-id="32d2c-219">Se o servidor tiver sido bloqueado de acordo com o FIPS (Federal Information Processing Standard), isso significará que o MD5 foi desabilitado.</span><span class="sxs-lookup"><span data-stu-id="32d2c-219">If your server has been locked down according to Federal Information Processing Standard (FIPS), then MD5 is disabled.</span></span>

<span data-ttu-id="32d2c-220">**Para habilitar MD5 para a sincronização de senha, execute as seguintes etapas:**</span><span class="sxs-lookup"><span data-stu-id="32d2c-220">**To enable MD5 for password synchronization, perform the following steps:**</span></span>

1. <span data-ttu-id="32d2c-221">Vá para %programfiles%\Azure AD Sync\Bin.</span><span class="sxs-lookup"><span data-stu-id="32d2c-221">Go to %programfiles%\Azure AD Sync\Bin.</span></span>
2. <span data-ttu-id="32d2c-222">Abra miiserver.exe.config.</span><span class="sxs-lookup"><span data-stu-id="32d2c-222">Open miiserver.exe.config.</span></span>
3. <span data-ttu-id="32d2c-223">Acesse o nó configuração/tempo de execução no fim do arquivo.</span><span class="sxs-lookup"><span data-stu-id="32d2c-223">Go to the configuration/runtime node at the end of the file.</span></span>
4. <span data-ttu-id="32d2c-224">Adicione o seguinte nó: `<enforceFIPSPolicy enabled="false"/>`</span><span class="sxs-lookup"><span data-stu-id="32d2c-224">Add the following node: `<enforceFIPSPolicy enabled="false"/>`</span></span>
5. <span data-ttu-id="32d2c-225">Salve suas alterações.</span><span class="sxs-lookup"><span data-stu-id="32d2c-225">Save your changes.</span></span>

<span data-ttu-id="32d2c-226">Para referência, essa captura mostra como deve ser a aparência:</span><span class="sxs-lookup"><span data-stu-id="32d2c-226">For reference, this snippet is what it should look like:</span></span>

```
    <configuration>
        <runtime>
            <enforceFIPSPolicy enabled="false"/>
        </runtime>
    </configuration>
```

<span data-ttu-id="32d2c-227">Para saber mais sobre segurança e FIPS, veja [Sincronização de senha do AAD, criptografia e conformidade FIPS](https://blogs.technet.microsoft.com/enterprisemobility/2014/06/28/aad-password-sync-encryption-and-fips-compliance/).</span><span class="sxs-lookup"><span data-stu-id="32d2c-227">For information about security and FIPS, see [AAD Password Sync, encryption and FIPS compliance](https://blogs.technet.microsoft.com/enterprisemobility/2014/06/28/aad-password-sync-encryption-and-fips-compliance/).</span></span>

## <a name="troubleshoot-password-synchronization"></a><span data-ttu-id="32d2c-228">Solucionar problemas de sincronização de senha</span><span class="sxs-lookup"><span data-stu-id="32d2c-228">Troubleshoot password synchronization</span></span>
<span data-ttu-id="32d2c-229">Caso tenha problemas com a sincronização de senha, veja [Solucionar problemas de sincronização de senha](active-directory-aadconnectsync-troubleshoot-password-synchronization.md).</span><span class="sxs-lookup"><span data-stu-id="32d2c-229">If you have problems with password synchronization, see [Troubleshoot password synchronization](active-directory-aadconnectsync-troubleshoot-password-synchronization.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="32d2c-230">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="32d2c-230">Next steps</span></span>
* [<span data-ttu-id="32d2c-231">Sincronização do Azure AD Connect: personalizando opções de sincronização</span><span class="sxs-lookup"><span data-stu-id="32d2c-231">Azure AD Connect sync: Customizing synchronization options</span></span>](active-directory-aadconnectsync-whatis.md)
* [<span data-ttu-id="32d2c-232">Integração de suas identidades locais com o Active Directory do Azure</span><span class="sxs-lookup"><span data-stu-id="32d2c-232">Integrating your on-premises identities with Azure Active Directory</span></span>](active-directory-aadconnect.md)
