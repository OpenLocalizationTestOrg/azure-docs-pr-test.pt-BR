---
title: "Azure AD Connect: atualizar de uma versão anterior | Microsoft Docs"
description: "Explica Olá diferentes métodos tooupgrade toohello versão mais recente do Azure Active Directory Connect, incluindo uma atualização in-loco e uma migração de movimento."
services: active-directory
documentationcenter: 
author: AndKjell
manager: femila
editor: 
ms.assetid: 31f084d8-2b89-478c-9079-76cf92e6618f
ms.service: active-directory
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: Identity
ms.date: 07/12/2017
ms.author: billmath
ms.openlocfilehash: 57bd5b094654e4983cafa303b6f3daecadafb01c
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="azure-ad-connect-upgrade-from-a-previous-version-toohello-latest"></a><span data-ttu-id="50d25-103">Do Azure AD Connect: A atualização de toohello uma versão anterior mais recente</span><span class="sxs-lookup"><span data-stu-id="50d25-103">Azure AD Connect: Upgrade from a previous version toohello latest</span></span>
<span data-ttu-id="50d25-104">Este tópico descreve métodos diferentes de saudação que você pode usar tooupgrade sua versão mais recente do Connect do Azure Active Directory (AD do Azure) instalação toohello.</span><span class="sxs-lookup"><span data-stu-id="50d25-104">This topic describes hello different methods that you can use tooupgrade your Azure Active Directory (Azure AD) Connect installation toohello latest release.</span></span> <span data-ttu-id="50d25-105">É recomendável que você mantenha-se atualizado com as versões de saudação do Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="50d25-105">We recommend that you keep yourself current with hello releases of Azure AD Connect.</span></span> <span data-ttu-id="50d25-106">Você também usar etapas Olá Olá [gire migração](#swing-migration) seção quando você alterar uma configuração significativa.</span><span class="sxs-lookup"><span data-stu-id="50d25-106">You also use hello steps in hello [Swing migration](#swing-migration) section when you make a substantial configuration change.</span></span>

<span data-ttu-id="50d25-107">Se você quiser tooupgrade do DirSync, consulte [atualização da ferramenta de sincronização do AD do Azure (DirSync)](active-directory-aadconnect-dirsync-upgrade-get-started.md) em vez disso.</span><span class="sxs-lookup"><span data-stu-id="50d25-107">If you want tooupgrade from DirSync, see [Upgrade from Azure AD sync tool (DirSync)](active-directory-aadconnect-dirsync-upgrade-get-started.md) instead.</span></span>

<span data-ttu-id="50d25-108">Há algumas estratégias diferentes que você pode usar tooupgrade do Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="50d25-108">There are a few different strategies that you can use tooupgrade Azure AD Connect.</span></span>

| <span data-ttu-id="50d25-109">Método</span><span class="sxs-lookup"><span data-stu-id="50d25-109">Method</span></span> | <span data-ttu-id="50d25-110">Descrição</span><span class="sxs-lookup"><span data-stu-id="50d25-110">Description</span></span> |
| --- | --- |
| [<span data-ttu-id="50d25-111">Atualização automática</span><span class="sxs-lookup"><span data-stu-id="50d25-111">Automatic upgrade</span></span>](active-directory-aadconnect-feature-automatic-upgrade.md) |<span data-ttu-id="50d25-112">Este é o método mais fácil de saudação para clientes com uma instalação expressa.</span><span class="sxs-lookup"><span data-stu-id="50d25-112">This is hello easiest method for customers with an express installation.</span></span> |
| [<span data-ttu-id="50d25-113">Atualização in-loco</span><span class="sxs-lookup"><span data-stu-id="50d25-113">In-place upgrade</span></span>](#in-place-upgrade) |<span data-ttu-id="50d25-114">Se você tiver um único servidor, você pode atualizar Olá instalação local no mesmo servidor de hello.</span><span class="sxs-lookup"><span data-stu-id="50d25-114">If you have a single server, you can upgrade hello installation in-place on hello same server.</span></span> |
| [<span data-ttu-id="50d25-115">Migração swing</span><span class="sxs-lookup"><span data-stu-id="50d25-115">Swing migration</span></span>](#swing-migration) |<span data-ttu-id="50d25-116">Com dois servidores, você pode preparar um dos servidores de saudação com a nova versão de hello ou configuração e alterar o servidor ativo hello quando você estiver pronto.</span><span class="sxs-lookup"><span data-stu-id="50d25-116">With two servers, you can prepare one of hello servers with hello new release or configuration, and change hello active server when you're ready.</span></span> |

<span data-ttu-id="50d25-117">Para obter informações de permissões, consulte Olá [permissões necessárias para uma atualização](active-directory-aadconnect-accounts-permissions.md#upgrade).</span><span class="sxs-lookup"><span data-stu-id="50d25-117">For permissions information, see hello [permissions required for an upgrade](active-directory-aadconnect-accounts-permissions.md#upgrade).</span></span>

> [!NOTE]
> <span data-ttu-id="50d25-118">Depois de habilitar a sua nova conexão do AD do Azure server toostart sincronizando alterações tooAzure AD, não reverta toousing DirSync ou o Azure AD Sync. Downgrade de clientes de toolegacy de conexão do AD do Azure, incluindo o DirSync e sincronização do AD do Azure, não é suportado e pode levar tooissues como perda de dados no AD do Azure.</span><span class="sxs-lookup"><span data-stu-id="50d25-118">After you've enabled your new Azure AD Connect server toostart synchronizing changes tooAzure AD, you must not roll back toousing DirSync or Azure AD Sync. Downgrading from Azure AD Connect toolegacy clients, including DirSync and Azure AD Sync, isn't supported and can lead tooissues such as data loss in Azure AD.</span></span>

## <a name="in-place-upgrade"></a><span data-ttu-id="50d25-119">Atualização in-loco</span><span class="sxs-lookup"><span data-stu-id="50d25-119">In-place upgrade</span></span>
<span data-ttu-id="50d25-120">Uma atualização in-loco funciona para mudar do Azure AD Sync ou do Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="50d25-120">An in-place upgrade works for moving from Azure AD Sync or Azure AD Connect.</span></span> <span data-ttu-id="50d25-121">Ele não funcionará para a migração do DirSync ou para uma solução com o FIM (Forefront Identity Manager) + Azure AD Connector.</span><span class="sxs-lookup"><span data-stu-id="50d25-121">It doesn't work for moving from DirSync or for a solution with Forefront Identity Manager (FIM) + Azure AD Connector.</span></span>

<span data-ttu-id="50d25-122">Esse será o método preferencial quando você tiver um único servidor e menos de cerca de 100.000 objetos.</span><span class="sxs-lookup"><span data-stu-id="50d25-122">This method is preferred when you have a single server and less than about 100,000 objects.</span></span> <span data-ttu-id="50d25-123">Se houver alterações de regras de sincronização de fora da caixa de toohello, uma importação completa e sincronização completa ocorrerem após a atualização de saudação.</span><span class="sxs-lookup"><span data-stu-id="50d25-123">If there are any changes toohello out-of-box sync rules, a full import and full synchronization occur after hello upgrade.</span></span> <span data-ttu-id="50d25-124">Esse método garante que Olá nova configuração é aplicada tooall os objetos existentes no sistema de saudação.</span><span class="sxs-lookup"><span data-stu-id="50d25-124">This method ensures that hello new configuration is applied tooall existing objects in hello system.</span></span> <span data-ttu-id="50d25-125">Essa execução pode levar algumas horas, dependendo do número de saudação de objetos que estão no escopo do mecanismo de sincronização de saudação.</span><span class="sxs-lookup"><span data-stu-id="50d25-125">This run might take a few hours, depending on hello number of objects that are in scope of hello sync engine.</span></span> <span data-ttu-id="50d25-126">Agendador de sincronização delta normal da saudação (que sincroniza a cada 30 minutos por padrão) é suspenso, mas continua a sincronização de senha.</span><span class="sxs-lookup"><span data-stu-id="50d25-126">hello normal delta synchronization scheduler (which synchronizes every 30 minutes by default) is suspended, but password synchronization continues.</span></span> <span data-ttu-id="50d25-127">Você pode considerar fazer atualização in-loco de saudação durante um fim de semana.</span><span class="sxs-lookup"><span data-stu-id="50d25-127">You might consider doing hello in-place upgrade during a weekend.</span></span> <span data-ttu-id="50d25-128">Se não houver nenhuma configuração de fora da caixa de toohello alterações com versão de conectar Olá novo AD do Azure, em seguida, um normal importação/sincronização delta inicia em vez disso.</span><span class="sxs-lookup"><span data-stu-id="50d25-128">If there are no changes toohello out-of-box configuration with hello new Azure AD Connect release, then a normal delta import/sync starts instead.</span></span>  
![Atualização in-loco](./media/active-directory-aadconnect-upgrade-previous-version/inplaceupgrade.png)

<span data-ttu-id="50d25-130">Se você tiver feito alterações regras de sincronização de fora da caixa de toohello, em seguida, essas regras estiverem definidas volta configuração padrão de toohello na atualização.</span><span class="sxs-lookup"><span data-stu-id="50d25-130">If you've made changes toohello out-of-box synchronization rules, then these rules are set back toohello default configuration on upgrade.</span></span> <span data-ttu-id="50d25-131">toomake-se de que sua configuração é mantida entre atualizações, certifique-se de que você faça alterações conforme eles são descritos em [as práticas recomendadas para alterar a configuração padrão de saudação](active-directory-aadconnectsync-best-practices-changing-default-configuration.md).</span><span class="sxs-lookup"><span data-stu-id="50d25-131">toomake sure that your configuration is kept between upgrades, make sure that you make changes as they're described in [Best practices for changing hello default configuration](active-directory-aadconnectsync-best-practices-changing-default-configuration.md).</span></span>

<span data-ttu-id="50d25-132">Durante a atualização in-loco, pode haver alterações que requerem sincronização específica toobe de atividades (incluindo as etapas de importação completa e sincronização completa) executado após a conclusão da atualização.</span><span class="sxs-lookup"><span data-stu-id="50d25-132">During in-place upgrade, there may be changes introduced that require specific synchronization activities (including Full Import step and Full Synchronization step) toobe executed after upgrade completes.</span></span> <span data-ttu-id="50d25-133">toodefer tais atividades, consulte toosection [como toodefer completo sincronização após a atualização](#how-to-defer-full-synchronization-after-upgrade).</span><span class="sxs-lookup"><span data-stu-id="50d25-133">toodefer such activities, refer toosection [How toodefer full synchronization after upgrade](#how-to-defer-full-synchronization-after-upgrade).</span></span>

## <a name="swing-migration"></a><span data-ttu-id="50d25-134">Migração swing</span><span class="sxs-lookup"><span data-stu-id="50d25-134">Swing migration</span></span>
<span data-ttu-id="50d25-135">Se você tiver uma implantação complexa ou muitos objetos, pode ser impraticável toodo uma atualização no local no sistema ao vivo hello.</span><span class="sxs-lookup"><span data-stu-id="50d25-135">If you have a complex deployment or many objects, it might be impractical toodo an in-place upgrade on hello live system.</span></span> <span data-ttu-id="50d25-136">Para alguns clientes, o processo poderá levar vários dias e, durante esse tempo, nenhuma alteração delta será processada.</span><span class="sxs-lookup"><span data-stu-id="50d25-136">For some customers, this process might take multiple days--and during this time, no delta changes are processed.</span></span> <span data-ttu-id="50d25-137">Você também pode usar esse método quando você planejar a configuração de tooyour de alterações substanciais toomake e você deseja tootry-los out antes que elas são enviadas toohello nuvem.</span><span class="sxs-lookup"><span data-stu-id="50d25-137">You can also use this method when you plan toomake substantial changes tooyour configuration and you want tootry them out before they're pushed toohello cloud.</span></span>

<span data-ttu-id="50d25-138">Olá recomendado método para esses cenários é toouse uma migração de movimento.</span><span class="sxs-lookup"><span data-stu-id="50d25-138">hello recommended method for these scenarios is toouse a swing migration.</span></span> <span data-ttu-id="50d25-139">Você precisa de (pelo menos) dois servidores, um servidor ativo e um de preparo.</span><span class="sxs-lookup"><span data-stu-id="50d25-139">You need (at least) two servers--one active server and one staging server.</span></span> <span data-ttu-id="50d25-140">servidor ativo de saudação (mostrado com linhas azuis sólidas em Olá figura abaixo) é responsável pela carga de produção ativo hello.</span><span class="sxs-lookup"><span data-stu-id="50d25-140">hello active server (shown with solid blue lines in hello following picture) is responsible for hello active production load.</span></span> <span data-ttu-id="50d25-141">saudação (mostrado com tracejadas roxas) do servidor de preparo está preparada com a nova versão de hello ou configuração.</span><span class="sxs-lookup"><span data-stu-id="50d25-141">hello staging server (shown with dashed purple lines) is prepared with hello new release or configuration.</span></span> <span data-ttu-id="50d25-142">Quando estiver totalmente pronto, esse servidor ficará ativo.</span><span class="sxs-lookup"><span data-stu-id="50d25-142">When it's fully ready, this server is made active.</span></span> <span data-ttu-id="50d25-143">Olá anterior active server, que agora tem hello configuração instalado ou versão antiga, é feita no servidor de preparo Olá e é atualizado.</span><span class="sxs-lookup"><span data-stu-id="50d25-143">hello previous active server, which now has hello old version or configuration installed, is made into hello staging server and is upgraded.</span></span>

<span data-ttu-id="50d25-144">dois servidores de saudação podem usar diferentes versões.</span><span class="sxs-lookup"><span data-stu-id="50d25-144">hello two servers can use different versions.</span></span> <span data-ttu-id="50d25-145">Por exemplo, o servidor ativo de saudação que você planeje toodecommission pode usar o Azure AD Sync e novo servidor de preparo Olá pode usar o Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="50d25-145">For example, hello active server that you plan toodecommission can use Azure AD Sync, and hello new staging server can use Azure AD Connect.</span></span> <span data-ttu-id="50d25-146">Se você usar o giro migração toodevelop uma nova configuração, ela é uma boa ideia toohave Olá mesmas versões em Olá dois servidores.</span><span class="sxs-lookup"><span data-stu-id="50d25-146">If you use swing migration toodevelop a new configuration, it's a good idea toohave hello same versions on hello two servers.</span></span>  
![Servidor de preparo](./media/active-directory-aadconnect-upgrade-previous-version/stagingserver1.png)

> [!NOTE]
> <span data-ttu-id="50d25-148">Alguns clientes preferem toohave três ou quatro servidores para este cenário.</span><span class="sxs-lookup"><span data-stu-id="50d25-148">Some customers prefer toohave three or four servers for this scenario.</span></span> <span data-ttu-id="50d25-149">Quando Olá servidor de preparo é atualizado, você não tiver um servidor de backup para [a recuperação de desastres](active-directory-aadconnectsync-operations.md#disaster-recovery).</span><span class="sxs-lookup"><span data-stu-id="50d25-149">When hello staging server is upgraded, you don't have a backup server for [disaster recovery](active-directory-aadconnectsync-operations.md#disaster-recovery).</span></span> <span data-ttu-id="50d25-150">Com três ou quatro servidores, você pode preparar um conjunto de servidores de principal/standby Olá nova versão, que garante que haja sempre um servidor de preparo está pronto tootake acima.</span><span class="sxs-lookup"><span data-stu-id="50d25-150">With three or four servers, you can prepare one set of primary/standby servers with hello new version, which ensures that there is always a staging server that's ready tootake over.</span></span>

<span data-ttu-id="50d25-151">Essas etapas de trabalho também toomove de sincronização do AD do Azure ou uma solução com FIM + conector AD do Azure.</span><span class="sxs-lookup"><span data-stu-id="50d25-151">These steps also work toomove from Azure AD Sync or a solution with FIM + Azure AD Connector.</span></span> <span data-ttu-id="50d25-152">Essas etapas não funcionam para DirSync, mas Olá mesmo movimento método de migração (também chamado de implantação paralela) com as etapas para DirSync está em [sincronização de atualizar o Active Directory do Azure (DirSync)](active-directory-aadconnect-dirsync-upgrade-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="50d25-152">These steps don't work for DirSync, but hello same swing migration method (also called parallel deployment) with steps for DirSync is in [Upgrade Azure Active Directory sync (DirSync)](active-directory-aadconnect-dirsync-upgrade-get-started.md).</span></span>

### <a name="use-a-swing-migration-tooupgrade"></a><span data-ttu-id="50d25-153">Usar um tooupgrade de migração de movimento</span><span class="sxs-lookup"><span data-stu-id="50d25-153">Use a swing migration tooupgrade</span></span>
1. <span data-ttu-id="50d25-154">Se você usar o Azure AD Connect em servidores e verifique tooonly de plano uma alteração de configuração, certifique-se de que o servidor ativo e o servidor de preparo estiverem usando Olá a mesma versão.</span><span class="sxs-lookup"><span data-stu-id="50d25-154">If you use Azure AD Connect on both servers and plan tooonly make a configuration change, make sure that your active server and staging server are both using hello same version.</span></span> <span data-ttu-id="50d25-155">Que torna mais fácil diferenças de toocompare mais tarde.</span><span class="sxs-lookup"><span data-stu-id="50d25-155">That makes it easier toocompare differences later.</span></span> <span data-ttu-id="50d25-156">Se você estiver atualizando do Azure AD Sync, esses servidores terão versões diferentes.</span><span class="sxs-lookup"><span data-stu-id="50d25-156">If you're upgrading from Azure AD Sync, then these servers have different versions.</span></span> <span data-ttu-id="50d25-157">Se você estiver atualizando de uma versão anterior do Azure AD Connect, é toostart uma boa ideia com hello dois servidores de Olá usando a mesma versão, mas não é obrigatório.</span><span class="sxs-lookup"><span data-stu-id="50d25-157">If you're upgrading from an older version of Azure AD Connect, it's a good idea toostart with hello two servers that are using hello same version, but it's not required.</span></span>
2. <span data-ttu-id="50d25-158">Se você fez uma configuração personalizada e o servidor de preparo não-lo, execute as etapas de saudação em [mover uma configuração personalizada de saudação do active server toohello servidor de preparo](#move-custom-configuration-from-active-to-staging-server).</span><span class="sxs-lookup"><span data-stu-id="50d25-158">If you've made a custom configuration and your staging server doesn't have it, follow hello steps under [Move a custom configuration from hello active server toohello staging server](#move-custom-configuration-from-active-to-staging-server).</span></span>
3. <span data-ttu-id="50d25-159">Se você estiver atualizando de uma versão anterior do Azure AD Connect, atualize Olá versão mais recente do servidor toohello de preparo.</span><span class="sxs-lookup"><span data-stu-id="50d25-159">If you're upgrading from an earlier release of Azure AD Connect, upgrade hello staging server toohello latest version.</span></span> <span data-ttu-id="50d25-160">Se estiver movendo do Azure AD Sync, instale o Azure AD Connect em seu servidor de preparo.</span><span class="sxs-lookup"><span data-stu-id="50d25-160">If you're moving from Azure AD Sync, then install Azure AD Connect on your staging server.</span></span>
4. <span data-ttu-id="50d25-161">Permitem que a importação completa do mecanismo de execução Olá sincronização e sincronização completa em seu servidor de preparo.</span><span class="sxs-lookup"><span data-stu-id="50d25-161">Let hello sync engine run full import and full synchronization on your staging server.</span></span>
5. <span data-ttu-id="50d25-162">Verifique se essa nova configuração de saudação não causar alterações inesperadas usando Olá etapas em "Verificar" no [Verificar configuração de saudação de um servidor](active-directory-aadconnectsync-operations.md#verify-the-configuration-of-a-server).</span><span class="sxs-lookup"><span data-stu-id="50d25-162">Verify that hello new configuration didn't cause any unexpected changes by using hello steps under "Verify" in [Verify hello configuration of a server](active-directory-aadconnectsync-operations.md#verify-the-configuration-of-a-server).</span></span> <span data-ttu-id="50d25-163">Se algo não estiver correto, como esperado, execute importação hello e sincronização e verifique dados saudação até que parece bom, seguindo as etapas de saudação.</span><span class="sxs-lookup"><span data-stu-id="50d25-163">If something isn't as expected, correct it, run hello import and sync, and verify hello data until it looks good, by following hello steps.</span></span>
6. <span data-ttu-id="50d25-164">Comutador hello toobe Olá active servidor de preparo.</span><span class="sxs-lookup"><span data-stu-id="50d25-164">Switch hello staging server toobe hello active server.</span></span> <span data-ttu-id="50d25-165">Esta é a etapa de final de hello "Switch servidor ativo" no [Verificar configuração de saudação de um servidor](active-directory-aadconnectsync-operations.md#verify-the-configuration-of-a-server).</span><span class="sxs-lookup"><span data-stu-id="50d25-165">This is hello final step "Switch active server" in [Verify hello configuration of a server](active-directory-aadconnectsync-operations.md#verify-the-configuration-of-a-server).</span></span>
7. <span data-ttu-id="50d25-166">Se você estiver atualizando do Azure AD Connect, atualize o servidor de saudação que é agora de preparo na versão mais recente do modo toohello.</span><span class="sxs-lookup"><span data-stu-id="50d25-166">If you're upgrading Azure AD Connect, upgrade hello server that's now in staging mode toohello latest release.</span></span> <span data-ttu-id="50d25-167">Siga Olá mesmo etapas antes tooget Olá dados e atualizado.</span><span class="sxs-lookup"><span data-stu-id="50d25-167">Follow hello same steps as before tooget hello data and configuration upgraded.</span></span> <span data-ttu-id="50d25-168">Se estiver atualizando do Azure AD Sync, agora você poderá desativar e encerrar o servidor antigo.</span><span class="sxs-lookup"><span data-stu-id="50d25-168">If you upgraded from Azure AD Sync, you can now turn off and decommission your old server.</span></span>

### <a name="move-a-custom-configuration-from-hello-active-server-toohello-staging-server"></a><span data-ttu-id="50d25-169">Mover uma configuração personalizada do servidor de preparo Olá active server toohello</span><span class="sxs-lookup"><span data-stu-id="50d25-169">Move a custom configuration from hello active server toohello staging server</span></span>
<span data-ttu-id="50d25-170">Se você fez o servidor ativo de toohello de alterações de configuração, você precisa toomake-se que Olá mesmo as alterações são aplicada toohello servidor de preparo.</span><span class="sxs-lookup"><span data-stu-id="50d25-170">If you've made configuration changes toohello active server, you need toomake sure that hello same changes are applied toohello staging server.</span></span> <span data-ttu-id="50d25-171">Mover toohelp com isso, você pode usar o hello [Documentador de configuração do Azure AD Connect](https://github.com/Microsoft/AADConnectConfigDocumenter).</span><span class="sxs-lookup"><span data-stu-id="50d25-171">toohelp with this move, you can use hello [Azure AD Connect configuration documenter](https://github.com/Microsoft/AADConnectConfigDocumenter).</span></span>

<span data-ttu-id="50d25-172">Você pode mover as regras de sincronização personalizadas Olá que você criou usando o PowerShell.</span><span class="sxs-lookup"><span data-stu-id="50d25-172">You can move hello custom sync rules that you've created by using PowerShell.</span></span> <span data-ttu-id="50d25-173">Você deve aplicar outros Olá alterações maneira mesmo em ambos os sistemas e você não pode migrar alterações hello.</span><span class="sxs-lookup"><span data-stu-id="50d25-173">You must apply other changes hello same way on both systems, and you can't migrate hello changes.</span></span> <span data-ttu-id="50d25-174">Olá [Documentador configuração](https://github.com/Microsoft/AADConnectConfigDocumenter) pode ajudá-lo a comparar Olá dois sistemas toomake-se de que eles são idênticos.</span><span class="sxs-lookup"><span data-stu-id="50d25-174">hello [configuration documenter](https://github.com/Microsoft/AADConnectConfigDocumenter) can help you comparing hello two systems toomake sure they are identical.</span></span> <span data-ttu-id="50d25-175">ferramenta de saudação também pode ajudar a automatizar etapas Olá encontradas nesta seção.</span><span class="sxs-lookup"><span data-stu-id="50d25-175">hello tool can also help in automating hello steps found in this section.</span></span>

<span data-ttu-id="50d25-176">Você precisa tooconfigure Olá seguinte coisas Olá mesmo maneira em ambos os servidores:</span><span class="sxs-lookup"><span data-stu-id="50d25-176">You need tooconfigure hello following things hello same way on both servers:</span></span>

* <span data-ttu-id="50d25-177">Conexão toohello mesmo florestas</span><span class="sxs-lookup"><span data-stu-id="50d25-177">Connection toohello same forests</span></span>
* <span data-ttu-id="50d25-178">Qualquer filtragem de domínio e de unidade organizacional</span><span class="sxs-lookup"><span data-stu-id="50d25-178">Any domain and OU filtering</span></span>
* <span data-ttu-id="50d25-179">Olá mesmo recursos opcionais, como a sincronização de senha e Write-back de senha</span><span class="sxs-lookup"><span data-stu-id="50d25-179">hello same optional features, such as password sync and password writeback</span></span>

<span data-ttu-id="50d25-180">**Mover regras de sincronização personalizadas**</span><span class="sxs-lookup"><span data-stu-id="50d25-180">**Move custom synchronization rules**</span></span>  
<span data-ttu-id="50d25-181">regras de sincronização personalizadas toomove, Olá a seguir:</span><span class="sxs-lookup"><span data-stu-id="50d25-181">toomove custom synchronization rules, do hello following:</span></span>

1. <span data-ttu-id="50d25-182">Abra o **Editor de Regras de Sincronização** em seu servidor ativo.</span><span class="sxs-lookup"><span data-stu-id="50d25-182">Open **Synchronization Rules Editor** on your active server.</span></span>
2. <span data-ttu-id="50d25-183">Selecione uma regra personalizada.</span><span class="sxs-lookup"><span data-stu-id="50d25-183">Select a custom rule.</span></span> <span data-ttu-id="50d25-184">Clique em **Exportar**.</span><span class="sxs-lookup"><span data-stu-id="50d25-184">Click **Export**.</span></span> <span data-ttu-id="50d25-185">Isso abre uma janela do Bloco de Notas.</span><span class="sxs-lookup"><span data-stu-id="50d25-185">This brings up a Notepad window.</span></span> <span data-ttu-id="50d25-186">Salve o arquivo temporário Olá com uma extensão PS1.</span><span class="sxs-lookup"><span data-stu-id="50d25-186">Save hello temporary file with a PS1 extension.</span></span> <span data-ttu-id="50d25-187">Isso o transforma em um script do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="50d25-187">This makes it a PowerShell script.</span></span> <span data-ttu-id="50d25-188">Copie toohello de arquivo PS1 Olá servidor de preparo.</span><span class="sxs-lookup"><span data-stu-id="50d25-188">Copy hello PS1 file toohello staging server.</span></span>  
   <span data-ttu-id="50d25-189">![Exportação da regra de sincronização](./media/active-directory-aadconnect-upgrade-previous-version/exportrule.png)</span><span class="sxs-lookup"><span data-stu-id="50d25-189">![Sync rule export](./media/active-directory-aadconnect-upgrade-previous-version/exportrule.png)</span></span>
3. <span data-ttu-id="50d25-190">Olá GUID do conector é diferente em Olá servidor de preparo, e você deve alterá-la.</span><span class="sxs-lookup"><span data-stu-id="50d25-190">hello Connector GUID is different on hello staging server, and you must change it.</span></span> <span data-ttu-id="50d25-191">Olá tooget GUID, iniciar **Editor de regras de sincronização**, selecione uma das regras de out-of-box Olá Olá que representam mesmo sistema conectado e clique em **exportar**.</span><span class="sxs-lookup"><span data-stu-id="50d25-191">tooget hello GUID, start **Synchronization Rules Editor**, select one of hello out-of-box rules that represent hello same connected system, and click **Export**.</span></span> <span data-ttu-id="50d25-192">Substitua Olá GUID em seu arquivo PS1 Olá GUID da saudação servidor de preparo.</span><span class="sxs-lookup"><span data-stu-id="50d25-192">Replace hello GUID in your PS1 file with hello GUID from hello staging server.</span></span>
4. <span data-ttu-id="50d25-193">Em um prompt do PowerShell, execute o arquivo hello PS1.</span><span class="sxs-lookup"><span data-stu-id="50d25-193">In a PowerShell prompt, run hello PS1 file.</span></span> <span data-ttu-id="50d25-194">Isso cria a regra de sincronização personalizadas Olá em Olá servidor de preparo.</span><span class="sxs-lookup"><span data-stu-id="50d25-194">This creates hello custom synchronization rule on hello staging server.</span></span>
5. <span data-ttu-id="50d25-195">Repita essa etapa para todas as regras personalizadas.</span><span class="sxs-lookup"><span data-stu-id="50d25-195">Repeat this for all your custom rules.</span></span>

## <a name="how-toodefer-full-synchronization-after-upgrade"></a><span data-ttu-id="50d25-196">Como toodefer completo sincronização após a atualização</span><span class="sxs-lookup"><span data-stu-id="50d25-196">How toodefer full synchronization after upgrade</span></span>
<span data-ttu-id="50d25-197">Durante a atualização in-loco, pode haver alterações que requerem sincronização específica atividades (incluindo as etapas de importação completa e sincronização completa) toobe executado.</span><span class="sxs-lookup"><span data-stu-id="50d25-197">During in-place upgrade, there may be changes introduced that require specific synchronization activities (including Full Import step and Full Synchronization step) toobe executed.</span></span> <span data-ttu-id="50d25-198">Por exemplo, alterações de esquema do conector exigem **importação completa** requerem alterações de regra de sincronização de etapa e out-of-box **completo sincronização** etapa toobe executado nos conectores afetados.</span><span class="sxs-lookup"><span data-stu-id="50d25-198">For example, connector schema changes require **full import** step and out-of-box synchronization rule changes require **full synchronization** step toobe executed on affected connectors.</span></span> <span data-ttu-id="50d25-199">Durante a atualização, o Azure AD Connect determina quais atividades de sincronização são necessárias e registra-as como *substituições*.</span><span class="sxs-lookup"><span data-stu-id="50d25-199">During upgrade, Azure AD Connect determines what synchronization activities are required and records them as *overrides*.</span></span> <span data-ttu-id="50d25-200">Em Olá após o ciclo de sincronização, Agendador de sincronização de saudação pega essas substituições e executa-los.</span><span class="sxs-lookup"><span data-stu-id="50d25-200">In hello following synchronization cycle, hello synchronization scheduler picks up these overrides and executes them.</span></span> <span data-ttu-id="50d25-201">Quando uma substituição é executada com êxito, ela é removida.</span><span class="sxs-lookup"><span data-stu-id="50d25-201">Once an override is successfully executed, it is removed.</span></span>

<span data-ttu-id="50d25-202">Pode haver situações em que você não quer local de tootake essas substituições imediatamente após a atualização.</span><span class="sxs-lookup"><span data-stu-id="50d25-202">There may be situations where you do not want these overrides tootake place immediately after upgrade.</span></span> <span data-ttu-id="50d25-203">Por exemplo, você tem vários objetos sincronizados e você deseja que essas toooccur de etapas de sincronização depois do horário comercial.</span><span class="sxs-lookup"><span data-stu-id="50d25-203">For example, you have numerous synchronized objects and you would like these synchronization steps toooccur after business hours.</span></span> <span data-ttu-id="50d25-204">tooremove essas substituições:</span><span class="sxs-lookup"><span data-stu-id="50d25-204">tooremove these overrides:</span></span>

1. <span data-ttu-id="50d25-205">Durante a atualização, **desmarque** Olá opção **iniciar o processo de sincronização de saudação quando configuração for concluída**.</span><span class="sxs-lookup"><span data-stu-id="50d25-205">During upgrade, **uncheck** hello option **Start hello synchronization process when configuration completes**.</span></span> <span data-ttu-id="50d25-206">Isso desabilita o Agendador de sincronização hello e impede que ciclo de sincronização ocorra automaticamente antes de substituições de saudação são removidas.</span><span class="sxs-lookup"><span data-stu-id="50d25-206">This disables hello synchronization scheduler and prevents synchronization cycle from taking place automatically before hello overrides are removed.</span></span>

   ![DisableFullSyncAfterUpgrade](./media/active-directory-aadconnect-upgrade-previous-version/disablefullsync01.png)

2. <span data-ttu-id="50d25-208">Após a conclusão da atualização, execute Olá toofind cmdlet out quais substituições foram adicionadas a seguir:`Get-ADSyncSchedulerConnectorOverride | fl`</span><span class="sxs-lookup"><span data-stu-id="50d25-208">After upgrade completes, run hello following cmdlet toofind out what overrides have been added: `Get-ADSyncSchedulerConnectorOverride | fl`</span></span>

   >[!NOTE]
   > <span data-ttu-id="50d25-209">Olá substituições são específicas do conector.</span><span class="sxs-lookup"><span data-stu-id="50d25-209">hello overrides are connector-specific.</span></span> <span data-ttu-id="50d25-210">No hello exemplo a seguir, as etapas de importação completa e sincronização completa foram adicionados tooboth Olá conector AD local e conector AD do Azure.</span><span class="sxs-lookup"><span data-stu-id="50d25-210">In hello following example, Full Import step and Full Synchronization step have been added tooboth hello on-premises AD Connector and Azure AD Connector.</span></span>

   ![DisableFullSyncAfterUpgrade](./media/active-directory-aadconnect-upgrade-previous-version/disablefullsync02.png)

3. <span data-ttu-id="50d25-212">Anote Olá existente substituições que foram adicionados.</span><span class="sxs-lookup"><span data-stu-id="50d25-212">Note down hello existing overrides that have been added.</span></span>
   
4. <span data-ttu-id="50d25-213">Olá tooremove substituições para importação completa e sincronização completa em um conector arbitrária, executar Olá cmdlet a seguir:`Set-ADSyncSchedulerConnectorOverride -ConnectorIdentifier <Guid-of-ConnectorIdentifier> -FullImportRequired $false -FullSyncRequired $false`</span><span class="sxs-lookup"><span data-stu-id="50d25-213">tooremove hello overrides for both full import and full synchronization on an arbitrary connector, run hello following cmdlet: `Set-ADSyncSchedulerConnectorOverride -ConnectorIdentifier <Guid-of-ConnectorIdentifier> -FullImportRequired $false -FullSyncRequired $false`</span></span>

   <span data-ttu-id="50d25-214">substituições de saudação tooremove em todos os conectores, execute Olá script do PowerShell a seguir:</span><span class="sxs-lookup"><span data-stu-id="50d25-214">tooremove hello overrides on all connectors, execute hello following PowerShell script:</span></span>

   ```
   foreach ($connectorOverride in Get-ADSyncSchedulerConnectorOverride)
   {
       Set-ADSyncSchedulerConnectorOverride -ConnectorIdentifier $connectorOverride.ConnectorIdentifier.Guid -FullSyncRequired $false -FullImportRequired $false
   }
   ```

5. <span data-ttu-id="50d25-215">Agendador de saudação tooresume, execute Olá cmdlet a seguir:`Set-ADSyncScheduler -SyncCycleEnabled $true`</span><span class="sxs-lookup"><span data-stu-id="50d25-215">tooresume hello scheduler, run hello following cmdlet: `Set-ADSyncScheduler -SyncCycleEnabled $true`</span></span>

   >[!IMPORTANT]
   > <span data-ttu-id="50d25-216">Lembre-se tooexecute Olá necessárias etapas de sincronização assim que for possível.</span><span class="sxs-lookup"><span data-stu-id="50d25-216">Remember tooexecute hello required synchronization steps at your earliest convenience.</span></span> <span data-ttu-id="50d25-217">Manualmente você pode executar essas etapas usando Olá Synchronization Service Manager ou adicionar substituições hello usando Olá conjunto ADSyncSchedulerConnectorOverride cmdlet.</span><span class="sxs-lookup"><span data-stu-id="50d25-217">You can either manually execute these steps using hello Synchronization Service Manager or add hello overrides back using hello Set-ADSyncSchedulerConnectorOverride cmdlet.</span></span>

<span data-ttu-id="50d25-218">Olá tooadd substituições para importação completa e sincronização completa em um conector arbitrária, executar Olá cmdlet a seguir:`Set-ADSyncSchedulerConnectorOverride -ConnectorIdentifier <Guid> -FullImportRequired $true -FullSyncRequired $true`</span><span class="sxs-lookup"><span data-stu-id="50d25-218">tooadd hello overrides for both full import and full synchronization on an arbitrary connector, run hello following cmdlet:  `Set-ADSyncSchedulerConnectorOverride -ConnectorIdentifier <Guid> -FullImportRequired $true -FullSyncRequired $true`</span></span>

## <a name="next-steps"></a><span data-ttu-id="50d25-219">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="50d25-219">Next steps</span></span>
<span data-ttu-id="50d25-220">Saiba mais sobre [como integrar suas identidades locais ao Azure Active Directory](active-directory-aadconnect.md).</span><span class="sxs-lookup"><span data-stu-id="50d25-220">Learn more about [integrating your on-premises identities with Azure Active Directory](active-directory-aadconnect.md).</span></span>
