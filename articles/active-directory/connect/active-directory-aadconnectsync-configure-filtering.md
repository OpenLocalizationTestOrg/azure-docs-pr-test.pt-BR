---
title: "Configurar a sincronização do Azure AD Connect: configurar a filtragem | Microsoft Docs"
description: Explica como configurar a filtragem no Azure AD Connect Sync.
services: active-directory
documentationcenter: 
author: andkjell
manager: femila
editor: 
ms.assetid: 880facf6-1192-40e9-8181-544c0759d506
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/12/2017
ms.author: billmath
ms.openlocfilehash: 064642ebb9cafb0c6e1b3ff306241182a95215cc
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/03/2017
---
# <a name="azure-ad-connect-sync-configure-filtering"></a><span data-ttu-id="39f42-103">Sincronização do Azure AD Connect: configurar a filtragem</span><span class="sxs-lookup"><span data-stu-id="39f42-103">Azure AD Connect sync: Configure filtering</span></span>
<span data-ttu-id="39f42-104">Com a filtragem, você pode controlar quais objetos do seu diretório local devem aparecer no Azure Active Directory (Azure AD).</span><span class="sxs-lookup"><span data-stu-id="39f42-104">By using filtering, you can control which objects appear in Azure Active Directory (Azure AD) from your on-premises directory.</span></span> <span data-ttu-id="39f42-105">A configuração padrão obtém todos os objetos em todos os domínios nas florestas configuradas.</span><span class="sxs-lookup"><span data-stu-id="39f42-105">The default configuration takes all objects in all domains in the configured forests.</span></span> <span data-ttu-id="39f42-106">Em geral, essa é a configuração recomendada.</span><span class="sxs-lookup"><span data-stu-id="39f42-106">In general, this is the recommended configuration.</span></span> <span data-ttu-id="39f42-107">Os usuários que utilizarem cargas de trabalho do Office 365, como o Exchange Online e o Skype for Business, receberão uma Lista de Endereços Global completa para poderem enviar emails e fazer chamadas para todos.</span><span class="sxs-lookup"><span data-stu-id="39f42-107">Users using Office 365 workloads, such as Exchange Online and Skype for Business, benefit from a complete Global Address List so they can send email and call everyone.</span></span> <span data-ttu-id="39f42-108">Com a configuração padrão, eles teriam a mesma experiência de uma implementação local do Exchange ou do Lync.</span><span class="sxs-lookup"><span data-stu-id="39f42-108">With the default configuration, they would have the same experience that they would have with an on-premises implementation of Exchange or Lync.</span></span>

<span data-ttu-id="39f42-109">Em alguns casos, é necessário fazer alterações na configuração padrão.</span><span class="sxs-lookup"><span data-stu-id="39f42-109">In some cases however, you're required make some changes to the default configuration.</span></span> <span data-ttu-id="39f42-110">Estes são alguns exemplos:</span><span class="sxs-lookup"><span data-stu-id="39f42-110">Here are some examples:</span></span>

* <span data-ttu-id="39f42-111">Você planeja usar a [topologia de vários diretórios do Azure AD](active-directory-aadconnect-topologies.md#each-object-only-once-in-an-azure-ad-tenant).</span><span class="sxs-lookup"><span data-stu-id="39f42-111">You plan to use the [multi-Azure AD directory topology](active-directory-aadconnect-topologies.md#each-object-only-once-in-an-azure-ad-tenant).</span></span> <span data-ttu-id="39f42-112">Então, você precisa aplicar um filtro para controlar os objetos que devem ser sincronizados com um determinado diretório do Azure AD.</span><span class="sxs-lookup"><span data-stu-id="39f42-112">Then you need to apply a filter to control which objects are synchronized to a particular Azure AD directory.</span></span>
* <span data-ttu-id="39f42-113">Você executa um piloto para o Azure ou o Office 365 e só deseja um subconjunto de usuários no Azure AD.</span><span class="sxs-lookup"><span data-stu-id="39f42-113">You run a pilot for Azure or Office 365 and you only want a subset of users in Azure AD.</span></span> <span data-ttu-id="39f42-114">Em um piloto pequeno, não é importante ter uma Lista de Endereços Global completa para demonstrar essa funcionalidade.</span><span class="sxs-lookup"><span data-stu-id="39f42-114">In the small pilot, it's not important to have a complete Global Address List to demonstrate the functionality.</span></span>
* <span data-ttu-id="39f42-115">Você tem muitas contas de serviço e outras contas não pessoais que não deseja adicionar ao Azure AD.</span><span class="sxs-lookup"><span data-stu-id="39f42-115">You have many service accounts and other nonpersonal accounts that you don't want in Azure AD.</span></span>
* <span data-ttu-id="39f42-116">Por motivos de conformidade, não exclua contas de usuário locais.</span><span class="sxs-lookup"><span data-stu-id="39f42-116">For compliance reasons, you don't delete any user accounts on-premises.</span></span> <span data-ttu-id="39f42-117">Você só pode desabilitá-las.</span><span class="sxs-lookup"><span data-stu-id="39f42-117">You only disable them.</span></span> <span data-ttu-id="39f42-118">Mas no Azure AD, você deseja ter apenas as contas ativas.</span><span class="sxs-lookup"><span data-stu-id="39f42-118">But in Azure AD, you only want active accounts to be present.</span></span>

<span data-ttu-id="39f42-119">Este artigo mostra como configurar os diferentes métodos de filtragem.</span><span class="sxs-lookup"><span data-stu-id="39f42-119">This article covers how to configure the different filtering methods.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="39f42-120">A Microsoft não oferece suporte à modificação ou à operação da sincronização do Azure AD Connect fora das ações formalmente documentadas.</span><span class="sxs-lookup"><span data-stu-id="39f42-120">Microsoft doesn't support modifying or operating Azure AD Connect sync outside of the actions that are formally documented.</span></span> <span data-ttu-id="39f42-121">Qualquer uma dessas ações pode resultar em um estado inconsistente ou sem suporte da sincronização do Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="39f42-121">Any of these actions might result in an inconsistent or unsupported state of Azure AD Connect sync.</span></span> <span data-ttu-id="39f42-122">Consequentemente, a Microsoft não pode fornecer suporte técnico para essas implantações.</span><span class="sxs-lookup"><span data-stu-id="39f42-122">As a result, Microsoft can't provide technical support for such deployments.</span></span>

## <a name="basics-and-important-notes"></a><span data-ttu-id="39f42-123">Noções básicas e observações importantes</span><span class="sxs-lookup"><span data-stu-id="39f42-123">Basics and important notes</span></span>
<span data-ttu-id="39f42-124">No Azure AD Connect Sync, você pode habilitar a filtragem a qualquer momento.</span><span class="sxs-lookup"><span data-stu-id="39f42-124">In Azure AD Connect sync, you can enable filtering at any time.</span></span> <span data-ttu-id="39f42-125">Se você já tiver começado com uma configuração padrão de sincronização de diretório e então configurou a filtragem, os objetos que são filtrados não são mais sincronizados ao AD do Azure.</span><span class="sxs-lookup"><span data-stu-id="39f42-125">If you start with a default configuration of directory synchronization and then configure filtering, the objects that are filtered out are no longer synchronized to Azure AD.</span></span> <span data-ttu-id="39f42-126">Devido a essa alteração, quaisquer objetos no Azure AD que foram anteriormente sincronizados, mas filtrados depois, serão excluídos do Azure AD.</span><span class="sxs-lookup"><span data-stu-id="39f42-126">Because of this change, any objects in Azure AD that were previously synchronized but were then filtered are deleted in Azure AD.</span></span>

<span data-ttu-id="39f42-127">Antes de começar a fazer alterações na filtragem, [desabilite a tarefa agendada](#disable-scheduled-task) para não fazer acidentalmente alterações de exportação que ainda não tenham sido verificadas como corretas.</span><span class="sxs-lookup"><span data-stu-id="39f42-127">Before you start making changes to filtering, make sure that you [disable the scheduled task](#disable-scheduled-task) so you don't accidentally export changes that you haven't yet verified to be correct.</span></span>

<span data-ttu-id="39f42-128">Como a filtragem pode remover muitos objetos ao mesmo tempo, certifique-se de que os novos filtros estejam corretos antes de iniciar a exportação de todas as alterações para o Azure AD.</span><span class="sxs-lookup"><span data-stu-id="39f42-128">Because filtering can remove many objects at the same time, you want to make sure that your new filters are correct before you start exporting any changes to Azure AD.</span></span> <span data-ttu-id="39f42-129">Depois de concluir as etapas de configuração, recomendamos que você siga as [etapas de verificação](#apply-and-verify-changes) antes de fazer alterações e de exportar para o Azure AD.</span><span class="sxs-lookup"><span data-stu-id="39f42-129">After you've completed the configuration steps, we strongly recommend that you follow the [verification steps](#apply-and-verify-changes) before you export and make changes to Azure AD.</span></span>

<span data-ttu-id="39f42-130">Para que você não exclua muitos objetos por acidente, o recurso “[impedir exclusões acidentais](active-directory-aadconnectsync-feature-prevent-accidental-deletes.md)” está ativado por padrão.</span><span class="sxs-lookup"><span data-stu-id="39f42-130">To protect you from deleting many objects by accident, the feature "[prevent accidental deletes](active-directory-aadconnectsync-feature-prevent-accidental-deletes.md)" is on by default.</span></span> <span data-ttu-id="39f42-131">Se você excluir muitos objetos devido à filtragem (500, por padrão), precisará seguir as etapas deste artigo para permitir que as exclusões passem para o Azure AD.</span><span class="sxs-lookup"><span data-stu-id="39f42-131">If you delete many objects due to filtering (500 by default), you need to follow the steps in this article to allow the deletes to go through to Azure AD.</span></span>

<span data-ttu-id="39f42-132">Se você usar uma versão anterior à de novembro de 2015([1.0.9125](active-directory-aadconnect-version-history.md#1091250)), alterar a configuração de filtro e usar a sincronização de senha, precisará disparar uma sincronização completa de todas as senhas depois de concluir a configuração.</span><span class="sxs-lookup"><span data-stu-id="39f42-132">If you use a build before November 2015 ([1.0.9125](active-directory-aadconnect-version-history.md#1091250)), make a change to a filter configuration, and use password synchronization, then you need to trigger a full sync of all passwords after you've completed the configuration.</span></span> <span data-ttu-id="39f42-133">Para obter as etapas para disparar uma sincronização de senhas completa, consulte [Disparar uma sincronização completa de todas as senhas](active-directory-aadconnectsync-troubleshoot-password-synchronization.md#trigger-a-full-sync-of-all-passwords).</span><span class="sxs-lookup"><span data-stu-id="39f42-133">For steps on how to trigger a password full sync, see [Trigger a full sync of all passwords](active-directory-aadconnectsync-troubleshoot-password-synchronization.md#trigger-a-full-sync-of-all-passwords).</span></span> <span data-ttu-id="39f42-134">Se você estiver usando a versão 1.0.9125 ou uma versão posterior, a ação da **sincronização completa** normal, também avalia se as senhas precisam ser sincronizadas e esta etapa adicional não será mais necessária.</span><span class="sxs-lookup"><span data-stu-id="39f42-134">If you're on build 1.0.9125 or later, then the regular **full synchronization** action also calculates whether passwords should be synchronized and if this extra step is no longer required.</span></span>

<span data-ttu-id="39f42-135">Se objetos de **usuário** tiverem sido excluídos acidentalmente do Azure AD devido a um erro de filtragem, você pode recriar os objetos de usuário no Azure AD, removendo as configurações de filtragem.</span><span class="sxs-lookup"><span data-stu-id="39f42-135">If **user** objects were inadvertently deleted in Azure AD because of a filtering error, you can recreate the user objects in Azure AD by removing your filtering configurations.</span></span> <span data-ttu-id="39f42-136">Em seguida, você pode sincronizar os diretórios novamente.</span><span class="sxs-lookup"><span data-stu-id="39f42-136">Then you can synchronize your directories again.</span></span> <span data-ttu-id="39f42-137">Essa ação restaura os usuários da lixeira no Azure AD.</span><span class="sxs-lookup"><span data-stu-id="39f42-137">This action restores the users from the recycle bin in Azure AD.</span></span> <span data-ttu-id="39f42-138">Contudo, não é possível cancelar a exclusão de outros tipos de objeto.</span><span class="sxs-lookup"><span data-stu-id="39f42-138">However, you can't undelete other object types.</span></span> <span data-ttu-id="39f42-139">Por exemplo, se você excluir acidentalmente um grupo de segurança usado para criar a ACL de um recurso, o grupo e suas ACLs não poderão ser recuperados.</span><span class="sxs-lookup"><span data-stu-id="39f42-139">For example, if you accidentally delete a security group and it was used to ACL a resource, the group and its ACLs can't be recovered.</span></span>

<span data-ttu-id="39f42-140">O Azure AD Connect só exclui os objetos que já considerou como parte do escopo.</span><span class="sxs-lookup"><span data-stu-id="39f42-140">Azure AD Connect only deletes objects that it has once considered to be in scope.</span></span> <span data-ttu-id="39f42-141">Se houver objetos no Azure AD criados por outro mecanismo de sincronização e eles não estiverem no escopo, adicionar filtros não os removerá.</span><span class="sxs-lookup"><span data-stu-id="39f42-141">If there are objects in Azure AD that were created by another sync engine and these objects aren't in scope, adding filtering doesn't remove them.</span></span> <span data-ttu-id="39f42-142">Por exemplo, se você começar com um servidor DirSync, que criou uma cópia completa do diretório inteiro no Azure AD, e instalar um novo servidor de sincronização do Azure AD Connect em paralelo com a filtragem habilitada desde o início, o Azure AD Connect não removerá os objetos adicionais criados pelo DirSync.</span><span class="sxs-lookup"><span data-stu-id="39f42-142">For example, if you start with a DirSync server that created a complete copy of your entire directory in Azure AD, and you install a new Azure AD Connect sync server in parallel with filtering enabled from the beginning, Azure AD Connect doesn't remove the extra objects that are created by DirSync.</span></span>

<span data-ttu-id="39f42-143">As configurações de filtragem serão mantidas quando você instalar ou atualizar para uma versão mais recente do Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="39f42-143">The filtering configuration is retained when you install or upgrade to a newer version of Azure AD Connect.</span></span> <span data-ttu-id="39f42-144">É sempre uma prática recomendada verificar se a configuração não foi inadvertidamente alterada após uma atualização para uma versão mais recente, antes de executar o primeiro ciclo de sincronização.</span><span class="sxs-lookup"><span data-stu-id="39f42-144">It's always a best practice to verify that the configuration wasn't inadvertently changed after an upgrade to a newer version before running the first synchronization cycle.</span></span>

<span data-ttu-id="39f42-145">Se você tiver mais de uma floresta, aplique as configurações de filtragem descritas neste tópico a todas as florestas (supondo que você queira a mesma configuração para todas elas).</span><span class="sxs-lookup"><span data-stu-id="39f42-145">If you have more than one forest, then you must apply the filtering configurations that are described in this topic to every forest (assuming that you want the same configuration for all of them).</span></span>

### <a name="disable-the-scheduled-task"></a><span data-ttu-id="39f42-146">Desabilitar a tarefa agendada</span><span class="sxs-lookup"><span data-stu-id="39f42-146">Disable the scheduled task</span></span>
<span data-ttu-id="39f42-147">Para desabilitar o agendador interno, dispara um ciclo de sincronização a cada 30 minutos, siga estas etapas:</span><span class="sxs-lookup"><span data-stu-id="39f42-147">To disable the built-in scheduler that triggers a synchronization cycle every 30 minutes, follow these steps:</span></span>

1. <span data-ttu-id="39f42-148">Vá até um prompt do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="39f42-148">Go to a PowerShell prompt.</span></span>
2. <span data-ttu-id="39f42-149">Execute `Set-ADSyncScheduler -SyncCycleEnabled $False` para desabilitar o agendador.</span><span class="sxs-lookup"><span data-stu-id="39f42-149">Run `Set-ADSyncScheduler -SyncCycleEnabled $False` to disable the scheduler.</span></span>
3. <span data-ttu-id="39f42-150">Faça as alterações documentadas neste artigo.</span><span class="sxs-lookup"><span data-stu-id="39f42-150">Make the changes that are documented in this article.</span></span>
4. <span data-ttu-id="39f42-151">Execute `Set-ADSyncScheduler -SyncCycleEnabled $True` para habilitar o agendador novamente.</span><span class="sxs-lookup"><span data-stu-id="39f42-151">Run `Set-ADSyncScheduler -SyncCycleEnabled $True` to enable the scheduler again.</span></span>

<span data-ttu-id="39f42-152">**Se você usa um build do Azure AD Connect anterior ao 1.1.105.0**</span><span class="sxs-lookup"><span data-stu-id="39f42-152">**If you use an Azure AD Connect build before 1.1.105.0**</span></span>  
<span data-ttu-id="39f42-153">Para desabilitar a tarefa agendada que dispara um ciclo de sincronização a cada três horas, siga estas etapas:</span><span class="sxs-lookup"><span data-stu-id="39f42-153">To disable the scheduled task that triggers a synchronization cycle every three hours, follow these steps:</span></span>

1. <span data-ttu-id="39f42-154">Inicie o **Agendador de Tarefas** no menu **Iniciar**.</span><span class="sxs-lookup"><span data-stu-id="39f42-154">Start **Task Scheduler** from the **Start** menu.</span></span>
2. <span data-ttu-id="39f42-155">Diretamente na **Biblioteca do Agendador de Tarefas**, localize a tarefa chamada **Agendador de Sincronização do Azure AD**, clique com o botão direito do mouse e selecione **Desabilitar**.</span><span class="sxs-lookup"><span data-stu-id="39f42-155">Directly under **Task Scheduler Library**, find the task named **Azure AD Sync Scheduler**, right-click, and select **Disable**.</span></span>  
   <span data-ttu-id="39f42-156">![Agendador de Tarefas](./media/active-directory-aadconnectsync-configure-filtering/taskscheduler.png)</span><span class="sxs-lookup"><span data-stu-id="39f42-156">![Task Scheduler](./media/active-directory-aadconnectsync-configure-filtering/taskscheduler.png)</span></span>  
3. <span data-ttu-id="39f42-157">Agora você pode fazer alterações de configuração e executar o mecanismo de sincronização manualmente do console do **Synchronization Service Manager** .</span><span class="sxs-lookup"><span data-stu-id="39f42-157">You can now make configuration changes and run the sync engine manually from the **Synchronization Service Manager** console.</span></span>

<span data-ttu-id="39f42-158">Depois de concluir todas as alterações de filtragem, não se esqueça de voltar e **Habilitar** a tarefa novamente.</span><span class="sxs-lookup"><span data-stu-id="39f42-158">After you've completed all your filtering changes, don't forget to come back and **Enable** the task again.</span></span>

## <a name="filtering-options"></a><span data-ttu-id="39f42-159">Opções de filtragem</span><span class="sxs-lookup"><span data-stu-id="39f42-159">Filtering options</span></span>
<span data-ttu-id="39f42-160">Você pode aplicar os seguintes tipos de configuração de filtragem à Ferramenta de Sincronização de Diretório:</span><span class="sxs-lookup"><span data-stu-id="39f42-160">You can apply the following filtering configuration types to the directory synchronization tool:</span></span>

* <span data-ttu-id="39f42-161">[**Baseada em grupo**](#group-based-filtering): a filtragem baseada em um único grupo só pode ser configurada na instalação inicial usando o assistente de instalação.</span><span class="sxs-lookup"><span data-stu-id="39f42-161">[**Group-based**](#group-based-filtering): Filtering based on a single group can only be configured on initial installation by using the installation wizard.</span></span>
* <span data-ttu-id="39f42-162">[**Baseada em domínio**](#domain-based-filtering): essa opção permite que você selecione quais domínios serão sincronizados com o Azure AD.</span><span class="sxs-lookup"><span data-stu-id="39f42-162">[**Domain-based**](#domain-based-filtering): By using this option, you can select which domains synchronize to Azure AD.</span></span> <span data-ttu-id="39f42-163">Você também pode adicionar e remover domínios da configuração do mecanismo de sincronização quando fizer alterações na infraestrutura local, depois de instalar da sincronização do Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="39f42-163">You can also add and remove domains from the sync engine configuration when you make changes to your on-premises infrastructure after you install Azure AD Connect sync.</span></span>
* <span data-ttu-id="39f42-164">[**Baseada em unidade organizacional (OU)**](#organizational-unitbased-filtering): essa opção permite que você selecione quais UOs serão sincronizadas com o Azure AD.</span><span class="sxs-lookup"><span data-stu-id="39f42-164">[**Organizational unit (OU)–based**](#organizational-unitbased-filtering): By using this option, you can select which OUs synchronize to Azure AD.</span></span> <span data-ttu-id="39f42-165">Essa opção é para todos os tipos de objeto em UOs selecionadas.</span><span class="sxs-lookup"><span data-stu-id="39f42-165">This option is for all object types in selected OUs.</span></span>
* <span data-ttu-id="39f42-166">[**Baseada em atributo**](#attribute-based-filtering): essa opção permite que você filtre objetos com base nos valores de atributos nos objetos.</span><span class="sxs-lookup"><span data-stu-id="39f42-166">[**Attribute-based**](#attribute-based-filtering): By using this option, you can filter objects based on attribute values on the objects.</span></span> <span data-ttu-id="39f42-167">Você também pode ter filtros diferentes para tipos de objeto diferentes.</span><span class="sxs-lookup"><span data-stu-id="39f42-167">You can also have different filters for different object types.</span></span>

<span data-ttu-id="39f42-168">Você pode usar várias opções de filtragem ao mesmo tempo.</span><span class="sxs-lookup"><span data-stu-id="39f42-168">You can use multiple filtering options at the same time.</span></span> <span data-ttu-id="39f42-169">Por exemplo, você pode usar a filtragem baseada em unidade organizacional para incluir apenas os objetos em uma unidade organizacional.</span><span class="sxs-lookup"><span data-stu-id="39f42-169">For example, you can use OU-based filtering to only include objects in one OU.</span></span> <span data-ttu-id="39f42-170">Ao mesmo tempo, você pode usar a filtragem baseada em atributo para filtrar ainda mais os objetos.</span><span class="sxs-lookup"><span data-stu-id="39f42-170">At the same time, you can use attribute-based filtering to filter the objects further.</span></span> <span data-ttu-id="39f42-171">Quando você usa vários métodos de filtragem, os filtros usam um “E” lógico entre eles.</span><span class="sxs-lookup"><span data-stu-id="39f42-171">When you use multiple filtering methods, the filters use a logical "AND" between the filters.</span></span>

## <a name="domain-based-filtering"></a><span data-ttu-id="39f42-172">Filtragem baseada em domínio</span><span class="sxs-lookup"><span data-stu-id="39f42-172">Domain-based filtering</span></span>
<span data-ttu-id="39f42-173">Esta seção fornece as etapas para configurar o filtro de domínio.</span><span class="sxs-lookup"><span data-stu-id="39f42-173">This section provides you with the steps to configure your domain filter.</span></span> <span data-ttu-id="39f42-174">Se você adicionar ou remover domínios na floresta depois de ter instalado o Azure AD Connect, também será necessário atualizar a configuração de filtragem.</span><span class="sxs-lookup"><span data-stu-id="39f42-174">If you added or removed domains in your forest after you installed Azure AD Connect, you also have to update the filtering configuration.</span></span>

<span data-ttu-id="39f42-175">A melhor maneira de alterar a filtragem baseada em domínio é executando o assistente de instalação para alterar a [filtragem de domínio e UO](active-directory-aadconnect-get-started-custom.md#domain-and-ou-filtering).</span><span class="sxs-lookup"><span data-stu-id="39f42-175">The preferred way to change domain-based filtering is by running the installation wizard and changing [domain and OU filtering](active-directory-aadconnect-get-started-custom.md#domain-and-ou-filtering).</span></span> <span data-ttu-id="39f42-176">O assistente de instalação automatiza todas as tarefas documentadas neste tópico.</span><span class="sxs-lookup"><span data-stu-id="39f42-176">The installation wizard automates all the tasks that are documented in this topic.</span></span>

<span data-ttu-id="39f42-177">Você só deve seguir estas etapas se, por algum motivo, não conseguir executar o assistente de instalação.</span><span class="sxs-lookup"><span data-stu-id="39f42-177">You should only follow these steps if you're unable to run the installation wizard for some reason.</span></span>

<span data-ttu-id="39f42-178">A configuração de filtragem baseada em domínio consiste nestas etapas:</span><span class="sxs-lookup"><span data-stu-id="39f42-178">Domain-based filtering configuration consists of these steps:</span></span>

1. <span data-ttu-id="39f42-179">[Selecione os domínios](#select-domains-to-be-synchronized) que você deseja incluir na sincronização.</span><span class="sxs-lookup"><span data-stu-id="39f42-179">[Select the domains](#select-domains-to-be-synchronized) that you want to include in the synchronization.</span></span>
2. <span data-ttu-id="39f42-180">Para cada domínio adicionado e removido, ajuste os [perfis de execução](#update-run-profiles).</span><span class="sxs-lookup"><span data-stu-id="39f42-180">For each added and removed domain, adjust the [run profiles](#update-run-profiles).</span></span>
3. <span data-ttu-id="39f42-181">[Aplicar e verificar as alterações](#apply-and-verify-changes).</span><span class="sxs-lookup"><span data-stu-id="39f42-181">[Apply and verify changes](#apply-and-verify-changes).</span></span>

### <a name="select-the-domains-to-be-synchronized"></a><span data-ttu-id="39f42-182">Selecionar os domínios a serem sincronizados</span><span class="sxs-lookup"><span data-stu-id="39f42-182">Select the domains to be synchronized</span></span>
<span data-ttu-id="39f42-183">Para definir o filtro de domínio, siga estas etapas:</span><span class="sxs-lookup"><span data-stu-id="39f42-183">To set the domain filter, do the following steps:</span></span>

1. <span data-ttu-id="39f42-184">Entre no servidor que está executando a sincronização do Azure AD Connect usando uma conta que seja membro do grupo de segurança **ADSyncAdmins** .</span><span class="sxs-lookup"><span data-stu-id="39f42-184">Sign in to the server that is running Azure AD Connect sync by using an account that is a member of the **ADSyncAdmins** security group.</span></span>
2. <span data-ttu-id="39f42-185">Inicie o **Serviço de Sincronização** no menu **Iniciar**.</span><span class="sxs-lookup"><span data-stu-id="39f42-185">Start **Synchronization Service** from the **Start** menu.</span></span>
3. <span data-ttu-id="39f42-186">Selecione **Conectores** e, na lista **Conectores**, selecione o conector com o tipo **Active Directory Domain Services**.</span><span class="sxs-lookup"><span data-stu-id="39f42-186">Select **Connectors**, and in the **Connectors** list, select the Connector with the type **Active Directory Domain Services**.</span></span> <span data-ttu-id="39f42-187">Em **Ações**, selecione **Propriedades**.</span><span class="sxs-lookup"><span data-stu-id="39f42-187">In **Actions**, select **Properties**.</span></span>  
   <span data-ttu-id="39f42-188">![Propriedades do conector](./media/active-directory-aadconnectsync-configure-filtering/connectorproperties.png)</span><span class="sxs-lookup"><span data-stu-id="39f42-188">![Connector properties](./media/active-directory-aadconnectsync-configure-filtering/connectorproperties.png)</span></span>  
4. <span data-ttu-id="39f42-189">Clique em **Configurar Partições de Diretório**.</span><span class="sxs-lookup"><span data-stu-id="39f42-189">Click **Configure Directory Partitions**.</span></span>
5. <span data-ttu-id="39f42-190">Na lista **Selecionar partições de diretório**, marque ou desmarque as caixas de seleção dos domínios conforme necessário.</span><span class="sxs-lookup"><span data-stu-id="39f42-190">In the **Select directory partitions** list, select and unselect domains as needed.</span></span> <span data-ttu-id="39f42-191">Verifique se apenas as partições que você deseja sincronizar estão selecionadas.</span><span class="sxs-lookup"><span data-stu-id="39f42-191">Verify that only the partitions that you want to synchronize are selected.</span></span>  
   <span data-ttu-id="39f42-192">![Partições](./media/active-directory-aadconnectsync-configure-filtering/connectorpartitions.png)</span><span class="sxs-lookup"><span data-stu-id="39f42-192">![Partitions](./media/active-directory-aadconnectsync-configure-filtering/connectorpartitions.png)</span></span>  
   <span data-ttu-id="39f42-193">Se você tiver alterado a infraestrutura local do Active Drectory e tiver adicionado ou removido domínios da floresta, clique no botão **Atualizar** para obter uma lista atualizada.</span><span class="sxs-lookup"><span data-stu-id="39f42-193">If you've changed your on-premises Active Directory infrastructure and added or removed domains from the forest, then click the **Refresh** button to get an updated list.</span></span> <span data-ttu-id="39f42-194">Ao atualizar, você precisará fornecer as credenciais.</span><span class="sxs-lookup"><span data-stu-id="39f42-194">When you refresh, you're asked for credentials.</span></span> <span data-ttu-id="39f42-195">Forneça todas as credenciais com o acesso de leitura para o Windows Server Active Directory.</span><span class="sxs-lookup"><span data-stu-id="39f42-195">Provide any credentials with read access to Windows Server Active Directory.</span></span> <span data-ttu-id="39f42-196">Ele não precisa ser o usuário previamente preenchido na caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="39f42-196">It doesn't have to be the user that is prepopulated in the dialog box.</span></span>  
   <span data-ttu-id="39f42-197">![Atualização necessária](./media/active-directory-aadconnectsync-configure-filtering/refreshneeded.png)</span><span class="sxs-lookup"><span data-stu-id="39f42-197">![Refresh needed](./media/active-directory-aadconnectsync-configure-filtering/refreshneeded.png)</span></span>  
6. <span data-ttu-id="39f42-198">Quando terminar, clique em **OK** para fechar a caixa de diálogo **Propriedades**.</span><span class="sxs-lookup"><span data-stu-id="39f42-198">When you're done, close the **Properties** dialog by clicking **OK**.</span></span> <span data-ttu-id="39f42-199">Se você tiver removido domínios da floresta, será exibida uma mensagem informando que um domínio foi removido e que a configuração será limpa.</span><span class="sxs-lookup"><span data-stu-id="39f42-199">If you removed domains from the forest, a message pop-up says that a domain was removed and that configuration will be cleaned up.</span></span>
7. <span data-ttu-id="39f42-200">Prossiga para ajustar os [perfis de execução](#update-run-profiles).</span><span class="sxs-lookup"><span data-stu-id="39f42-200">Continue to adjust the [run profiles](#update-run-profiles).</span></span>

### <a name="update-the-run-profiles"></a><span data-ttu-id="39f42-201">Atualizar perfis de execução</span><span class="sxs-lookup"><span data-stu-id="39f42-201">Update the run profiles</span></span>
<span data-ttu-id="39f42-202">Se você tiver atualizado o filtro de domínio, também precisará atualizar os perfis de execução.</span><span class="sxs-lookup"><span data-stu-id="39f42-202">If you've updated your domain filter, you also need to update the run profiles.</span></span>

1. <span data-ttu-id="39f42-203">Na lista **Conectores** , verifique se o conector que você alterou na etapa anterior está selecionado.</span><span class="sxs-lookup"><span data-stu-id="39f42-203">In the **Connectors** list, make sure that the Connector that you changed in the previous step is selected.</span></span> <span data-ttu-id="39f42-204">Em **Ações**, selecione **Configurar Perfis de Execução**.</span><span class="sxs-lookup"><span data-stu-id="39f42-204">In **Actions**, select **Configure Run Profiles**.</span></span>  
   <span data-ttu-id="39f42-205">![Perfis de execução do conector 1](./media/active-directory-aadconnectsync-configure-filtering/connectorrunprofiles1.png)</span><span class="sxs-lookup"><span data-stu-id="39f42-205">![Connector run profiles 1](./media/active-directory-aadconnectsync-configure-filtering/connectorrunprofiles1.png)</span></span>  
2. <span data-ttu-id="39f42-206">Localize e identifique os seguintes perfis:</span><span class="sxs-lookup"><span data-stu-id="39f42-206">Find and identify the following profiles:</span></span>
    * <span data-ttu-id="39f42-207">Importação completa</span><span class="sxs-lookup"><span data-stu-id="39f42-207">Full Import</span></span>
    * <span data-ttu-id="39f42-208">sincronização total</span><span class="sxs-lookup"><span data-stu-id="39f42-208">Full Synchronization</span></span>
    * <span data-ttu-id="39f42-209">Importação de delta</span><span class="sxs-lookup"><span data-stu-id="39f42-209">Delta Import</span></span>
    * <span data-ttu-id="39f42-210">Sincronização de delta</span><span class="sxs-lookup"><span data-stu-id="39f42-210">Delta Synchronization</span></span>
    * <span data-ttu-id="39f42-211">Exportação</span><span class="sxs-lookup"><span data-stu-id="39f42-211">Export</span></span>
3. <span data-ttu-id="39f42-212">Para cada perfil, ajuste os domínios **adicionados** e **removidos**.</span><span class="sxs-lookup"><span data-stu-id="39f42-212">For each profile, adjust the **added** and **removed** domains.</span></span>
    1. <span data-ttu-id="39f42-213">Para cada um dos cinco perfis, execute as seguintes etapas para cada domínio **adicionado**:</span><span class="sxs-lookup"><span data-stu-id="39f42-213">For each of the five profiles, do the following steps for each **added** domain:</span></span>
        1. <span data-ttu-id="39f42-214">Selecione o perfil de execução e clique em **Nova Etapa**.</span><span class="sxs-lookup"><span data-stu-id="39f42-214">Select the run profile and click **New Step**.</span></span>
        2. <span data-ttu-id="39f42-215">Na página **Configurar Etapa**, no menu suspenso **Tipo**, selecione o tipo de etapa com o mesmo nome do perfil que você está configurando.</span><span class="sxs-lookup"><span data-stu-id="39f42-215">On the **Configure Step** page, in the **Type** drop-down menu, select the step type with the same name as the profile that you're configuring.</span></span> <span data-ttu-id="39f42-216">Em seguida, clique em **Próximo**.</span><span class="sxs-lookup"><span data-stu-id="39f42-216">Then click **Next**.</span></span>  
        <span data-ttu-id="39f42-217">![Perfis de execução do conector 2](./media/active-directory-aadconnectsync-configure-filtering/runprofilesnewstep1.png)</span><span class="sxs-lookup"><span data-stu-id="39f42-217">![Connector run profiles 2](./media/active-directory-aadconnectsync-configure-filtering/runprofilesnewstep1.png)</span></span>  
        3. <span data-ttu-id="39f42-218">Na página **Configuração do Conector**, no menu suspenso **Partição**, selecione o nome do domínio que você adicionou ao filtro de domínio.</span><span class="sxs-lookup"><span data-stu-id="39f42-218">On the **Connector Configuration** page, in the **Partition** drop-down menu, select the name of the domain that you've added to your domain filter.</span></span>  
        <span data-ttu-id="39f42-219">![Perfis de execução do conector 3](./media/active-directory-aadconnectsync-configure-filtering/runprofilesnewstep2.png)</span><span class="sxs-lookup"><span data-stu-id="39f42-219">![Connector run profiles 3](./media/active-directory-aadconnectsync-configure-filtering/runprofilesnewstep2.png)</span></span>  
        4. <span data-ttu-id="39f42-220">Para fechar a caixa de diálogo **Configurar Perfil de Execução**, clique em **Concluir**.</span><span class="sxs-lookup"><span data-stu-id="39f42-220">To close the **Configure Run Profile** dialog, click **Finish**.</span></span>
    2. <span data-ttu-id="39f42-221">Para cada um dos cinco perfis, execute as seguintes etapas para cada domínio **removido**:</span><span class="sxs-lookup"><span data-stu-id="39f42-221">For each of the five profiles, do the following steps for each **removed** domain:</span></span>
        1. <span data-ttu-id="39f42-222">Selecione o perfil de execução.</span><span class="sxs-lookup"><span data-stu-id="39f42-222">Select the run profile.</span></span>
        2. <span data-ttu-id="39f42-223">Se o **Valor** do atributo **Partition** for um GUID, selecione a etapa de execução e clique em **Excluir Etapa**.</span><span class="sxs-lookup"><span data-stu-id="39f42-223">If the **Value** of the **Partition** attribute is a GUID, select the run step and click **Delete Step**.</span></span>  
        <span data-ttu-id="39f42-224">![Perfis de execução do conector 4](./media/active-directory-aadconnectsync-configure-filtering/runprofilesdeletestep.png)</span><span class="sxs-lookup"><span data-stu-id="39f42-224">![Connector run profiles 4](./media/active-directory-aadconnectsync-configure-filtering/runprofilesdeletestep.png)</span></span>  
    3. <span data-ttu-id="39f42-225">Verifique se a alteração.</span><span class="sxs-lookup"><span data-stu-id="39f42-225">Verify your change.</span></span> <span data-ttu-id="39f42-226">Cada domínio que você deseja sincronizar deve estar listado como uma etapa em cada perfil de execução.</span><span class="sxs-lookup"><span data-stu-id="39f42-226">Each domain that you want to synchronize should be listed as a step in each run profile.</span></span>
4. <span data-ttu-id="39f42-227">Para fechar o diálogo **Configurar Perfis de Execução**, clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="39f42-227">To close the **Configure Run Profiles** dialog, click **OK**.</span></span>
5.  <span data-ttu-id="39f42-228">Para concluir a configuração, você precisa executar uma **Importação completa** e uma **Sincronização Delta**.</span><span class="sxs-lookup"><span data-stu-id="39f42-228">To complete the configuration, you need to run a **Full import** and a **Delta sync**.</span></span> <span data-ttu-id="39f42-229">Continue a ler a seção [Aplicar e verificar as alterações](#apply-and-verify-changes).</span><span class="sxs-lookup"><span data-stu-id="39f42-229">Continue reading the section [Apply and verify changes](#apply-and-verify-changes).</span></span>

## <a name="organizational-unitbased-filtering"></a><span data-ttu-id="39f42-230">Filtragem baseada em unidade organizacional</span><span class="sxs-lookup"><span data-stu-id="39f42-230">Organizational unit–based filtering</span></span>
<span data-ttu-id="39f42-231">A melhor maneira de alterar a filtragem baseada em unidade organizacional é executar o assistente de instalação e alterar a [filtragem de domínio e UO](active-directory-aadconnect-get-started-custom.md#domain-and-ou-filtering).</span><span class="sxs-lookup"><span data-stu-id="39f42-231">The preferred way to change OU-based filtering is by running the installation wizard and changing [domain and OU filtering](active-directory-aadconnect-get-started-custom.md#domain-and-ou-filtering).</span></span> <span data-ttu-id="39f42-232">O assistente de instalação automatiza todas as tarefas documentadas neste tópico.</span><span class="sxs-lookup"><span data-stu-id="39f42-232">The installation wizard automates all the tasks that are documented in this topic.</span></span>

<span data-ttu-id="39f42-233">Você só deve seguir estas etapas se, por algum motivo, não conseguir executar o assistente de instalação.</span><span class="sxs-lookup"><span data-stu-id="39f42-233">You should only follow these steps if you're unable to run the installation wizard for some reason.</span></span>

<span data-ttu-id="39f42-234">Para configurar a filtragem baseada em unidade organizacional, execute as seguintes etapas:</span><span class="sxs-lookup"><span data-stu-id="39f42-234">To configure organizational unit–based filtering, do the following steps:</span></span>

1. <span data-ttu-id="39f42-235">Entre no servidor que está executando a sincronização do Azure AD Connect usando uma conta que seja membro do grupo de segurança **ADSyncAdmins** .</span><span class="sxs-lookup"><span data-stu-id="39f42-235">Sign in to the server that is running Azure AD Connect sync by using an account that is a member of the **ADSyncAdmins** security group.</span></span>
2. <span data-ttu-id="39f42-236">Inicie o **Serviço de Sincronização** no menu **Iniciar**.</span><span class="sxs-lookup"><span data-stu-id="39f42-236">Start **Synchronization Service** from the **Start** menu.</span></span>
3. <span data-ttu-id="39f42-237">Selecione **Conectores** e, na lista **Conectores**, selecione o conector com o tipo **Active Directory Domain Services**.</span><span class="sxs-lookup"><span data-stu-id="39f42-237">Select **Connectors**, and in the **Connectors** list, select the Connector with the type **Active Directory Domain Services**.</span></span> <span data-ttu-id="39f42-238">Em **Ações**, selecione **Propriedades**.</span><span class="sxs-lookup"><span data-stu-id="39f42-238">In **Actions**, select **Properties**.</span></span>  
   <span data-ttu-id="39f42-239">![Propriedades do conector](./media/active-directory-aadconnectsync-configure-filtering/connectorproperties.png)</span><span class="sxs-lookup"><span data-stu-id="39f42-239">![Connector properties](./media/active-directory-aadconnectsync-configure-filtering/connectorproperties.png)</span></span>  
4. <span data-ttu-id="39f42-240">Clique em **Configurar Partições de Diretório**, selecione o domínio que você deseja configurar e clique em **Contêineres**.</span><span class="sxs-lookup"><span data-stu-id="39f42-240">Click **Configure Directory Partitions**, select the domain that you want to configure, and then click **Containers**.</span></span>
5. <span data-ttu-id="39f42-241">Quando solicitado, forneça todas as credenciais com o acesso de leitura para o Active Directory local.</span><span class="sxs-lookup"><span data-stu-id="39f42-241">When you're prompted, provide any credentials with read access to your on-premises Active Directory.</span></span> <span data-ttu-id="39f42-242">Ele não precisa ser o usuário previamente preenchido na caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="39f42-242">It doesn't have to be the user that is prepopulated in the dialog box.</span></span>
6. <span data-ttu-id="39f42-243">Na caixa de diálogo **Selecionar Contêineres**, desmarque as UOs que você não deseja sincronizar com o diretório de nuvem e clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="39f42-243">In the **Select Containers** dialog box, clear the OUs that you don’t want to synchronize with the cloud directory, and then click **OK**.</span></span>  
   <span data-ttu-id="39f42-244">![Unidades organizacionais na caixa de diálogo Selecionar Contêineres](./media/active-directory-aadconnectsync-configure-filtering/ou.png)</span><span class="sxs-lookup"><span data-stu-id="39f42-244">![OUs in the Select Containers dialog box](./media/active-directory-aadconnectsync-configure-filtering/ou.png)</span></span>  
   * <span data-ttu-id="39f42-245">O contêiner **Computadores** deve ser selecionado para que os computadores com Windows 10 sejam sincronizados com êxito com o Azure AD.</span><span class="sxs-lookup"><span data-stu-id="39f42-245">The **Computers** container should be selected for your Windows 10 computers to be successfully synchronized to Azure AD.</span></span> <span data-ttu-id="39f42-246">Se os computadores ingressados no domínio estiverem localizados em outras UOs, verifique se eles estão selecionados.</span><span class="sxs-lookup"><span data-stu-id="39f42-246">If your domain-joined computers are located in other OUs, make sure those are selected.</span></span>
   * <span data-ttu-id="39f42-247">O contêiner **ForeignSecurityPrincipals** deverá ser selecionado se você tiver várias florestas com relações de confiança.</span><span class="sxs-lookup"><span data-stu-id="39f42-247">The **ForeignSecurityPrincipals** container should be selected if you have multiple forests with trusts.</span></span> <span data-ttu-id="39f42-248">Esse contêiner permite que a associação de grupo de segurança entre florestas seja resolvida.</span><span class="sxs-lookup"><span data-stu-id="39f42-248">This container allows cross-forest security group membership to be resolved.</span></span>
   * <span data-ttu-id="39f42-249">A UO **RegisteredDevices** deverá ser selecionada caso você tenha habilitado o recurso de write-back do dispositivo.</span><span class="sxs-lookup"><span data-stu-id="39f42-249">The **RegisteredDevices** OU should be selected if you enabled the device writeback feature.</span></span> <span data-ttu-id="39f42-250">Se você usar outro recurso de write-back, como o write-back de grupo, verifique se esses locais estão selecionados.</span><span class="sxs-lookup"><span data-stu-id="39f42-250">If you use another writeback feature, such as group writeback, make sure these locations are selected.</span></span>
   * <span data-ttu-id="39f42-251">Selecione qualquer outra UO, onde usuários, iNetOrgPersons, grupos, contatos e computadores estão localizados.</span><span class="sxs-lookup"><span data-stu-id="39f42-251">Select any other OU where Users, iNetOrgPersons, Groups, Contacts, and Computers are located.</span></span> <span data-ttu-id="39f42-252">Na figura, todas essas UOs estão localizadas na UO ManagedObjects.</span><span class="sxs-lookup"><span data-stu-id="39f42-252">In the picture, all these OUs are located in the ManagedObjects OU.</span></span>
   * <span data-ttu-id="39f42-253">Se você usar a filtragem baseada em grupo, a UO onde o grupo está localizado deverá ser incluída.</span><span class="sxs-lookup"><span data-stu-id="39f42-253">If you use group-based filtering, then the OU where the group is located must be included.</span></span>
   * <span data-ttu-id="39f42-254">Observe que você pode configurar se as novas UOs adicionadas após a conclusão da configuração da filtragem deverão ser sincronizadas ou não.</span><span class="sxs-lookup"><span data-stu-id="39f42-254">Note that you can configure whether new OUs that are added after the filtering configuration finishes are synchronized or not synchronized.</span></span> <span data-ttu-id="39f42-255">Consulte a próxima seção para obter detalhes.</span><span class="sxs-lookup"><span data-stu-id="39f42-255">See the next section for details.</span></span>
7. <span data-ttu-id="39f42-256">Quando terminar, clique em **OK** para fechar a caixa de diálogo **Propriedades**.</span><span class="sxs-lookup"><span data-stu-id="39f42-256">When you're done, close the **Properties** dialog by clicking **OK**.</span></span>
8. <span data-ttu-id="39f42-257">Para concluir a configuração, você precisa executar uma **Importação completa** e uma **Sincronização Delta**.</span><span class="sxs-lookup"><span data-stu-id="39f42-257">To complete the configuration, you need to run a **Full import** and a **Delta sync**.</span></span> <span data-ttu-id="39f42-258">Continue a ler a seção [Aplicar e verificar as alterações](#apply-and-verify-changes).</span><span class="sxs-lookup"><span data-stu-id="39f42-258">Continue reading the section [Apply and verify changes](#apply-and-verify-changes).</span></span>

### <a name="synchronize-new-ous"></a><span data-ttu-id="39f42-259">Sincronizar novas UOs</span><span class="sxs-lookup"><span data-stu-id="39f42-259">Synchronize new OUs</span></span>
<span data-ttu-id="39f42-260">As novas UOs criadas após a configuração da filtragem são sincronizadas por padrão.</span><span class="sxs-lookup"><span data-stu-id="39f42-260">New OUs that are created after filtering has been configured are synchronized by default.</span></span> <span data-ttu-id="39f42-261">Esse estado é indicado por uma marca de seleção na caixa.</span><span class="sxs-lookup"><span data-stu-id="39f42-261">This state is indicated by a selected check box.</span></span> <span data-ttu-id="39f42-262">Você também pode cancelar a seleção de alguns subunidades organizacionais.</span><span class="sxs-lookup"><span data-stu-id="39f42-262">You can also unselect some sub-OUs.</span></span> <span data-ttu-id="39f42-263">Para isso, clique na caixa até que ela se torne branca com uma marca de seleção azul (seu estado padrão).</span><span class="sxs-lookup"><span data-stu-id="39f42-263">To get this behavior, click the box until it becomes white with a blue check mark (its default state).</span></span> <span data-ttu-id="39f42-264">Em seguida, desmarque todas as subunidades organizacionais que você não deseja sincronizar.</span><span class="sxs-lookup"><span data-stu-id="39f42-264">Then unselect any sub-OUs that you don't want to synchronize.</span></span>

<span data-ttu-id="39f42-265">Se todas as subunidades organizacionais forem sincronizadas, a caixa ficará branca com uma marca de seleção azul.</span><span class="sxs-lookup"><span data-stu-id="39f42-265">If all sub-OUs are synchronized, then the box is white with a blue check mark.</span></span>  
![UO com todas as caixas selecionadas](./media/active-directory-aadconnectsync-configure-filtering/ousyncnewall.png)

<span data-ttu-id="39f42-267">Se algumas subunidades organizacionais forem desmarcadas, a caixa ficará cinza com uma marca de seleção branca.</span><span class="sxs-lookup"><span data-stu-id="39f42-267">If some sub-OUs have been unselected, then the box is gray with a white check mark.</span></span>  
![UO com algumas subunidades organizacionais desmarcadas](./media/active-directory-aadconnectsync-configure-filtering/ousyncnew.png)

<span data-ttu-id="39f42-269">Com essa configuração, uma nova UO que foi criada em ManagedObjects será sincronizada.</span><span class="sxs-lookup"><span data-stu-id="39f42-269">With this configuration, a new OU that was created under ManagedObjects is synchronized.</span></span>

<span data-ttu-id="39f42-270">O assistente de instalação do Azure AD Connect sempre cria essa configuração.</span><span class="sxs-lookup"><span data-stu-id="39f42-270">The Azure AD Connect installation wizard always creates this configuration.</span></span>

### <a name="dont-synchronize-new-ous"></a><span data-ttu-id="39f42-271">Não sincronizar novas UOs</span><span class="sxs-lookup"><span data-stu-id="39f42-271">Don't synchronize new OUs</span></span>
<span data-ttu-id="39f42-272">Você pode configurar o mecanismo de sincronização para não sincronizar novas UOs após a conclusão da configuração da filtragem.</span><span class="sxs-lookup"><span data-stu-id="39f42-272">You can configure the sync engine to not synchronize new OUs after the filtering configuration has finished.</span></span> <span data-ttu-id="39f42-273">Esse estado é indicado na interface do usuário por uma caixa cinza sem marca de seleção.</span><span class="sxs-lookup"><span data-stu-id="39f42-273">This state is indicated in the UI by the box appearing solid gray with no check mark.</span></span> <span data-ttu-id="39f42-274">Para isso, clique na caixa até que ela se torne branca sem marca de seleção.</span><span class="sxs-lookup"><span data-stu-id="39f42-274">To get this behavior, click the box until it becomes white with no check mark.</span></span> <span data-ttu-id="39f42-275">Em seguida, escolha as subunidades organizacionais que você deseja sincronizar.</span><span class="sxs-lookup"><span data-stu-id="39f42-275">Then select the sub-OUs that you want to synchronize.</span></span>

![UO com raiz desmarcada](./media/active-directory-aadconnectsync-configure-filtering/oudonotsyncnew.png)

<span data-ttu-id="39f42-277">Com essa configuração, uma nova UO que foi criada em ManagedObjects não será sincronizada.</span><span class="sxs-lookup"><span data-stu-id="39f42-277">With this configuration, a new OU that was created under ManagedObjects isn't synchronized.</span></span>

## <a name="attribute-based-filtering"></a><span data-ttu-id="39f42-278">Filtragem baseada em atributo</span><span class="sxs-lookup"><span data-stu-id="39f42-278">Attribute-based filtering</span></span>
<span data-ttu-id="39f42-279">Verifique se você está usando a versão de novembro de 2015 ([1.0.9125](active-directory-aadconnect-version-history.md#1091250)) ou uma versão posterior para que estas etapas funcionem.</span><span class="sxs-lookup"><span data-stu-id="39f42-279">Make sure that you're using the November 2015 ([1.0.9125](active-directory-aadconnect-version-history.md#1091250)) or later build for these steps to work.</span></span>

<span data-ttu-id="39f42-280">A filtragem baseada em atributo é a maneira mais flexível de filtrar objetos.</span><span class="sxs-lookup"><span data-stu-id="39f42-280">Attribute-based filtering is the most flexible way to filter objects.</span></span> <span data-ttu-id="39f42-281">Você pode usar o [provisionamento declarativo](active-directory-aadconnectsync-understanding-declarative-provisioning.md) para controlar quase todos os aspectos de quando um objeto deve ser sincronizado com o Azure AD.</span><span class="sxs-lookup"><span data-stu-id="39f42-281">You can use the power of [declarative provisioning](active-directory-aadconnectsync-understanding-declarative-provisioning.md) to control almost every aspect of when an object is synchronized to Azure AD.</span></span>

<span data-ttu-id="39f42-282">Você pode aplicar a filtragem de [entrada](#inbound-filtering) do Active Directory para o metaverso e a filtragem de [saída](#outbound-filtering) do metaverso para o Azure AD.</span><span class="sxs-lookup"><span data-stu-id="39f42-282">You can apply [inbound](#inbound-filtering) filtering from Active Directory to the metaverse, and [outbound](#outbound-filtering) filtering from the metaverse to Azure AD.</span></span> <span data-ttu-id="39f42-283">É recomendável que você aplique a filtragem de entrada porque ela é mais fácil de manter.</span><span class="sxs-lookup"><span data-stu-id="39f42-283">We recommend that you apply inbound filtering because that is the easiest to maintain.</span></span> <span data-ttu-id="39f42-284">Você só deve usar a filtragem de saída se ela for necessária para unir objetos de mais de uma floresta antes da avaliação.</span><span class="sxs-lookup"><span data-stu-id="39f42-284">You should only use outbound filtering if it's required to join objects from more than one forest before the evaluation can take place.</span></span>

### <a name="inbound-filtering"></a><span data-ttu-id="39f42-285">Filtragem de entrada</span><span class="sxs-lookup"><span data-stu-id="39f42-285">Inbound filtering</span></span>
<span data-ttu-id="39f42-286">A filtragem de entrada usa a configuração padrão, na qual objetos em direção ao Azure AD não devem ter o atributo metaverso cloudFiltered definido como um valor a ser sincronizado.</span><span class="sxs-lookup"><span data-stu-id="39f42-286">Inbound filtering uses the default configuration, where objects going to Azure AD must have the metaverse attribute cloudFiltered not set to a value to be synchronized.</span></span> <span data-ttu-id="39f42-287">Se o valor desse atributo for definido como **True**, o objeto não será sincronizado.</span><span class="sxs-lookup"><span data-stu-id="39f42-287">If this attribute's value is set to **True**, then the object isn't synchronized.</span></span> <span data-ttu-id="39f42-288">Ele não deve ser definido como **False** por padrão.</span><span class="sxs-lookup"><span data-stu-id="39f42-288">It shouldn't be set to **False**, by design.</span></span> <span data-ttu-id="39f42-289">Para garantir que outras regras tenham a capacidade de contribuir com um valor, esse atributo só deverá ter os valores **True** ou **NULL** (ausente).</span><span class="sxs-lookup"><span data-stu-id="39f42-289">To make sure other rules have the ability to contribute a value, this attribute is only supposed to have the values **True** or **NULL** (absent).</span></span>

<span data-ttu-id="39f42-290">Na filtragem de entrada, você usa o **escopo** para determinar quais objetos devem ou não ser sincronizados.</span><span class="sxs-lookup"><span data-stu-id="39f42-290">In inbound filtering, you use the power of **scope** to determine which objects to synchronize or not synchronize.</span></span> <span data-ttu-id="39f42-291">Aqui, você faz os ajustes para os requisitos da sua própria organização.</span><span class="sxs-lookup"><span data-stu-id="39f42-291">This is where you make adjustments to fit your own organization's requirements.</span></span> <span data-ttu-id="39f42-292">O módulo do escopo tem um **grupo** e uma **cláusula** para determinar quando uma regra de sincronização deve estar no escopo.</span><span class="sxs-lookup"><span data-stu-id="39f42-292">The scope module has a **group** and a **clause** to determine when a sync rule is in scope.</span></span> <span data-ttu-id="39f42-293">Um grupo contém uma ou muitas cláusulas.</span><span class="sxs-lookup"><span data-stu-id="39f42-293">A group contains one or many clauses.</span></span> <span data-ttu-id="39f42-294">Há um “E” lógico entre várias cláusulas e um “OU” lógico entre vários grupos.</span><span class="sxs-lookup"><span data-stu-id="39f42-294">There is a logical "AND" between multiple clauses, and a logical "OR" between multiple groups.</span></span>

<span data-ttu-id="39f42-295">Vamos examinar um exemplo: </span><span class="sxs-lookup"><span data-stu-id="39f42-295">Let us look at an example:</span></span>  
<span data-ttu-id="39f42-296">![Escopo](./media/active-directory-aadconnectsync-configure-filtering/scope.png)</span><span class="sxs-lookup"><span data-stu-id="39f42-296">![Scope](./media/active-directory-aadconnectsync-configure-filtering/scope.png)</span></span>  
<span data-ttu-id="39f42-297">Isso deve ser lido como **(departamento = TI) OU (departamento = Vendas E c = EUA)**.</span><span class="sxs-lookup"><span data-stu-id="39f42-297">This should be read as **(department = IT) OR (department = Sales AND c = US)**.</span></span>

<span data-ttu-id="39f42-298">Nos exemplos e nas etapas abaixo, usaremos o objeto de usuário como um exemplo, mas você poderá usar isso para todos os tipos de objeto.</span><span class="sxs-lookup"><span data-stu-id="39f42-298">In the following samples and steps, you use the user object as an example, but you can use this for all object types.</span></span>

<span data-ttu-id="39f42-299">Nos exemplos a seguir, o valor de precedência começa com 50.</span><span class="sxs-lookup"><span data-stu-id="39f42-299">In the following samples, the precedence value starts with 50.</span></span> <span data-ttu-id="39f42-300">Isso pode ser qualquer número não usado, mas deve ser inferior a 100.</span><span class="sxs-lookup"><span data-stu-id="39f42-300">This can be any number not used, but should be lower than 100.</span></span>

#### <a name="negative-filtering-do-not-sync-these"></a><span data-ttu-id="39f42-301">Filtragem negativa, “não sincronizar estes”</span><span class="sxs-lookup"><span data-stu-id="39f42-301">Negative filtering: "do not sync these"</span></span>
<span data-ttu-id="39f42-302">No exemplo abaixo, você filtra (e não sincroniza) todos os usuários em que **extensionAttribute15** tem o valor **NoSync**.</span><span class="sxs-lookup"><span data-stu-id="39f42-302">In the following example, you filter out (not synchronize) all users where **extensionAttribute15** has the value **NoSync**.</span></span>

1. <span data-ttu-id="39f42-303">Entre no servidor que está executando a sincronização do Azure AD Connect usando uma conta que seja membro do grupo de segurança **ADSyncAdmins** .</span><span class="sxs-lookup"><span data-stu-id="39f42-303">Sign in to the server that is running Azure AD Connect sync by using an account that is a member of the **ADSyncAdmins** security group.</span></span>
2. <span data-ttu-id="39f42-304">Inicie o **Editor de Regras de Sincronização** no menu **Iniciar**.</span><span class="sxs-lookup"><span data-stu-id="39f42-304">Start **Synchronization Rules Editor** from the **Start** menu.</span></span>
3. <span data-ttu-id="39f42-305">Verifique se a opção **Entrada** está selecionada e clique em **Adicionar Nova Regra**.</span><span class="sxs-lookup"><span data-stu-id="39f42-305">Make sure **Inbound** is selected, and click **Add New Rule**.</span></span>
4. <span data-ttu-id="39f42-306">Dê à regra um nome descritivo, como "*Entrada do AD – User DoNotSyncFilter*".</span><span class="sxs-lookup"><span data-stu-id="39f42-306">Give the rule a descriptive name, such as "*In from AD – User DoNotSyncFilter*".</span></span> <span data-ttu-id="39f42-307">Selecione a floresta correta, **Usuário** como o **Tipo de objeto do CS** e **Pessoa** como o **Tipo de objeto do MV**.</span><span class="sxs-lookup"><span data-stu-id="39f42-307">Select the correct forest, select **User** as the **CS object type**, and select **Person** as the **MV object type**.</span></span> <span data-ttu-id="39f42-308">Em **Tipo de Link**, selecione **Junção**.</span><span class="sxs-lookup"><span data-stu-id="39f42-308">In **Link Type**, select **Join**.</span></span> <span data-ttu-id="39f42-309">Em **Precedência**, digite um valor que não esteja sendo usado atualmente por outra regra de sincronização (por exemplo, 50). Em seguida, clique em **Avançar**.</span><span class="sxs-lookup"><span data-stu-id="39f42-309">In **Precedence**, type a value that isn't currently used by another synchronization rule (for example 50), and then click **Next**.</span></span>  
   <span data-ttu-id="39f42-310">![Descrição da entrada 1](./media/active-directory-aadconnectsync-configure-filtering/inbound1.png)</span><span class="sxs-lookup"><span data-stu-id="39f42-310">![Inbound 1 description](./media/active-directory-aadconnectsync-configure-filtering/inbound1.png)</span></span>  
5. <span data-ttu-id="39f42-311">Em **Filtro de escopo**, clique em **Adicionar Grupo** e em **Adicionar Cláusula**.</span><span class="sxs-lookup"><span data-stu-id="39f42-311">In **Scoping filter**, click **Add Group**, and click **Add Clause**.</span></span> <span data-ttu-id="39f42-312">Em **Atributo**, selecione **ExtensionAttribute15**.</span><span class="sxs-lookup"><span data-stu-id="39f42-312">In **Attribute**, select **ExtensionAttribute15**.</span></span> <span data-ttu-id="39f42-313">Verifique se **Operador** está definido como **EQUAL** e digite o valor **NoSync** na caixa **Valor**.</span><span class="sxs-lookup"><span data-stu-id="39f42-313">Make sure that **Operator** is set to **EQUAL**, and type the value **NoSync** in the **Value** box.</span></span> <span data-ttu-id="39f42-314">Clique em **Avançar**.</span><span class="sxs-lookup"><span data-stu-id="39f42-314">Click **Next**.</span></span>  
   <span data-ttu-id="39f42-315">![Escopo da entrada 2](./media/active-directory-aadconnectsync-configure-filtering/inbound2.png)</span><span class="sxs-lookup"><span data-stu-id="39f42-315">![Inbound 2 scope](./media/active-directory-aadconnectsync-configure-filtering/inbound2.png)</span></span>  
6. <span data-ttu-id="39f42-316">Deixe as regras de **Junção** vazias e clique em **Avançar**.</span><span class="sxs-lookup"><span data-stu-id="39f42-316">Leave the **Join** rules empty, and then click **Next**.</span></span>
7. <span data-ttu-id="39f42-317">Clique em **Adicionar Transformação**, selecione **FlowType** como **Constante** e selecione **cloudFiltered** como o **Atributo de Destino**.</span><span class="sxs-lookup"><span data-stu-id="39f42-317">Click **Add Transformation**, select the **FlowType** as **Constant**, and select **cloudFiltered** as the **Target Attribute**.</span></span> <span data-ttu-id="39f42-318">Na caixa de texto **Origem**, digite **True**.</span><span class="sxs-lookup"><span data-stu-id="39f42-318">In the **Source** text box, type **True**.</span></span> <span data-ttu-id="39f42-319">Clique em **Adicionar** para salvar a regra.</span><span class="sxs-lookup"><span data-stu-id="39f42-319">Click **Add** to save the rule.</span></span>  
   <span data-ttu-id="39f42-320">![Transformação da entrada 3](./media/active-directory-aadconnectsync-configure-filtering/inbound3.png)</span><span class="sxs-lookup"><span data-stu-id="39f42-320">![Inbound 3 transformation](./media/active-directory-aadconnectsync-configure-filtering/inbound3.png)</span></span>
8. <span data-ttu-id="39f42-321">Para concluir a configuração, você precisa executar uma **Sincronização completa**.</span><span class="sxs-lookup"><span data-stu-id="39f42-321">To complete the configuration, you need to run a **Full sync**.</span></span> <span data-ttu-id="39f42-322">Continue a ler a seção [Aplicar e verificar as alterações](#apply-and-verify-changes).</span><span class="sxs-lookup"><span data-stu-id="39f42-322">Continue reading the section [Apply and verify changes](#apply-and-verify-changes).</span></span>

#### <a name="positive-filtering-only-sync-these"></a><span data-ttu-id="39f42-323">Filtragem positiva: "sincronizar somente estas"</span><span class="sxs-lookup"><span data-stu-id="39f42-323">Positive filtering: "only sync these"</span></span>
<span data-ttu-id="39f42-324">Expressar a filtragem positiva pode ser mais desafiador, já que você também precisa considerar os objetos que não são óbvios para a sincronização, como as salas de conferência.</span><span class="sxs-lookup"><span data-stu-id="39f42-324">Expressing positive filtering can be more challenging because you also have to consider objects that aren't obvious to be synchronized, such as conference rooms.</span></span> <span data-ttu-id="39f42-325">Você também irá substituir o filtro padrão na regra diretamente **Entrada do AD – Associação de Usuário**.</span><span class="sxs-lookup"><span data-stu-id="39f42-325">You are also going to override the default filter in the out-of-box rule **In from AD - User Join**.</span></span> <span data-ttu-id="39f42-326">Quando você criar seu filtro personalizado, não inclua os objetos críticos do sistema, objetos de replicação em conflito, caixas de correio especiais e contas de serviço para o Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="39f42-326">When you create your custom filter, make sure to not include critical system objects, replication conflict objects, special mailboxes, and the service accounts for Azure AD Connect.</span></span>

<span data-ttu-id="39f42-327">A opção de filtragem positiva requer duas regras de sincronização.</span><span class="sxs-lookup"><span data-stu-id="39f42-327">The positive filtering option requires two sync rules.</span></span> <span data-ttu-id="39f42-328">Você precisa de uma regra (ou várias) com o escopo correto dos objetos que serão sincronizados.</span><span class="sxs-lookup"><span data-stu-id="39f42-328">You need one rule (or several) with the correct scope of objects to synchronize.</span></span> <span data-ttu-id="39f42-329">Você também precisa de uma segunda regra de sincronização pega-tudo que filtra todos os objetos ainda não identificados como um objeto a ser sincronizado.</span><span class="sxs-lookup"><span data-stu-id="39f42-329">You also need a second catch-all sync rule that filters out all objects that haven't yet been identified as an object that should be synchronized.</span></span>

<span data-ttu-id="39f42-330">No exemplo a seguir, você só sincroniza os objetos de usuário quando o atributo de departamento tiver o valor **Vendas**.</span><span class="sxs-lookup"><span data-stu-id="39f42-330">In the following example, you only synchronize user objects where the department attribute has the value **Sales**.</span></span>

1. <span data-ttu-id="39f42-331">Entre no servidor que está executando a sincronização do Azure AD Connect usando uma conta que seja membro do grupo de segurança **ADSyncAdmins** .</span><span class="sxs-lookup"><span data-stu-id="39f42-331">Sign in to the server that is running Azure AD Connect sync by using an account that is a member of the **ADSyncAdmins** security group.</span></span>
2. <span data-ttu-id="39f42-332">Inicie o **Editor de Regras de Sincronização** no menu **Iniciar**.</span><span class="sxs-lookup"><span data-stu-id="39f42-332">Start **Synchronization Rules Editor** from the **Start** menu.</span></span>
3. <span data-ttu-id="39f42-333">Verifique se a opção **Entrada** está selecionada e clique em **Adicionar Nova Regra**.</span><span class="sxs-lookup"><span data-stu-id="39f42-333">Make sure **Inbound** is selected, and click **Add New Rule**.</span></span>
4. <span data-ttu-id="39f42-334">Dê à regra um nome descritivo, como "*Entrada do AD – Sincronização de Vendas de Usuário*".</span><span class="sxs-lookup"><span data-stu-id="39f42-334">Give the rule a descriptive name, such as "*In from AD – User Sales sync*".</span></span> <span data-ttu-id="39f42-335">Selecione a floresta correta, **Usuário** como o **Tipo de objeto do CS** e **Pessoa** como o **Tipo de objeto do MV**.</span><span class="sxs-lookup"><span data-stu-id="39f42-335">Select the correct forest, select **User** as the **CS object type**, and select **Person** as the **MV object type**.</span></span> <span data-ttu-id="39f42-336">Em **Tipo de Link**, selecione **Junção**.</span><span class="sxs-lookup"><span data-stu-id="39f42-336">In **Link Type**, select **Join**.</span></span> <span data-ttu-id="39f42-337">Em **Precedência**, digite um valor que não esteja sendo usado atualmente por outra regra de sincronização (por exemplo, 51). Em seguida, clique em **Avançar**.</span><span class="sxs-lookup"><span data-stu-id="39f42-337">In **Precedence**, type a value that isn't currently used by another synchronization rule (for example 51), and then click **Next**.</span></span>  
   <span data-ttu-id="39f42-338">![Descrição da entrada 4](./media/active-directory-aadconnectsync-configure-filtering/inbound4.png)</span><span class="sxs-lookup"><span data-stu-id="39f42-338">![Inbound 4 description](./media/active-directory-aadconnectsync-configure-filtering/inbound4.png)</span></span>  
5. <span data-ttu-id="39f42-339">Em **Filtro de escopo**, clique em **Adicionar Grupo** e em **Adicionar Cláusula**.</span><span class="sxs-lookup"><span data-stu-id="39f42-339">In **Scoping filter**, click **Add Group**, and click **Add Clause**.</span></span> <span data-ttu-id="39f42-340">Em **Atributo**, selecione **Departamento**.</span><span class="sxs-lookup"><span data-stu-id="39f42-340">In **Attribute**, select **department**.</span></span> <span data-ttu-id="39f42-341">Verifique se Operador está definido como **EQUAL** e digite o valor **Vendas** na caixa **Valor**.</span><span class="sxs-lookup"><span data-stu-id="39f42-341">Make sure that Operator is set to **EQUAL**, and type the value **Sales** in the **Value** box.</span></span> <span data-ttu-id="39f42-342">Clique em **Avançar**.</span><span class="sxs-lookup"><span data-stu-id="39f42-342">Click **Next**.</span></span>  
   <span data-ttu-id="39f42-343">![Escopo da entrada 5](./media/active-directory-aadconnectsync-configure-filtering/inbound5.png)</span><span class="sxs-lookup"><span data-stu-id="39f42-343">![Inbound 5 scope](./media/active-directory-aadconnectsync-configure-filtering/inbound5.png)</span></span>  
6. <span data-ttu-id="39f42-344">Deixe as regras de **Junção** vazias e clique em **Avançar**.</span><span class="sxs-lookup"><span data-stu-id="39f42-344">Leave the **Join** rules empty, and then click **Next**.</span></span>
7. <span data-ttu-id="39f42-345">Clique em **Adicionar Transformação**, selecione **Constant** como **FlowType** e selecione **cloudFiltered** como o **Atributo de Destino**.</span><span class="sxs-lookup"><span data-stu-id="39f42-345">Click **Add Transformation**, select **Constant** as the **FlowType**, and select the **cloudFiltered** as the **Target Attribute**.</span></span> <span data-ttu-id="39f42-346">Na caixa **Origem** , digite **False**.</span><span class="sxs-lookup"><span data-stu-id="39f42-346">In the **Source** box, type **False**.</span></span> <span data-ttu-id="39f42-347">Clique em **Adicionar** para salvar a regra.</span><span class="sxs-lookup"><span data-stu-id="39f42-347">Click **Add** to save the rule.</span></span>  
   <span data-ttu-id="39f42-348">![Transformação da entrada 6](./media/active-directory-aadconnectsync-configure-filtering/inbound6.png)</span><span class="sxs-lookup"><span data-stu-id="39f42-348">![Inbound 6 transformation](./media/active-directory-aadconnectsync-configure-filtering/inbound6.png)</span></span>  
   <span data-ttu-id="39f42-349">Este é um caso especial em que você define cloudFiltered explicitamente como **False**.</span><span class="sxs-lookup"><span data-stu-id="39f42-349">This is a special case where you explicitly set cloudFiltered to **False**.</span></span>
8. <span data-ttu-id="39f42-350">Agora temos de criar a regra de sincronização que captura tudo.</span><span class="sxs-lookup"><span data-stu-id="39f42-350">We now have to create the catch-all sync rule.</span></span> <span data-ttu-id="39f42-351">Dê à regra um nome descritivo, como "*Entrada do AD – Filtro Captura Tudo Usuário*".</span><span class="sxs-lookup"><span data-stu-id="39f42-351">Give the rule a descriptive name, such as "*In from AD – User Catch-all filter*".</span></span> <span data-ttu-id="39f42-352">Selecione a floresta correta, **Usuário** como o **Tipo de objeto do CS** e **Pessoa** como o **Tipo de objeto do MV**.</span><span class="sxs-lookup"><span data-stu-id="39f42-352">Select the correct forest, select **User** as the **CS object type**, and select **Person** as the **MV object type**.</span></span> <span data-ttu-id="39f42-353">Em **Tipo de Link**, selecione **Junção**.</span><span class="sxs-lookup"><span data-stu-id="39f42-353">In **Link Type**, select **Join**.</span></span> <span data-ttu-id="39f42-354">Em **Precedência**, digite um valor que não esteja sendo usado atualmente por outra Regra de Sincronização (por exemplo, 99).</span><span class="sxs-lookup"><span data-stu-id="39f42-354">In **Precedence**, type a value that isn't currently used by another Synchronization Rule (for example 99).</span></span> <span data-ttu-id="39f42-355">Você selecionou um valor de precedência mais alto (menor precedência) do que para a regra de sincronização anterior.</span><span class="sxs-lookup"><span data-stu-id="39f42-355">You've selected a precedence value that is higher (lower precedence) than the previous sync rule.</span></span> <span data-ttu-id="39f42-356">Mas você também deixou algum espaço para poder adicionar mais regras de sincronização de filtragem depois, quando quiser iniciar a sincronização de outros departamentos.</span><span class="sxs-lookup"><span data-stu-id="39f42-356">But you've also left some room so that you can add more filtering sync rules later when you want to start synchronizing additional departments.</span></span> <span data-ttu-id="39f42-357">Clique em **Avançar**.</span><span class="sxs-lookup"><span data-stu-id="39f42-357">Click **Next**.</span></span>  
   <span data-ttu-id="39f42-358">![Descrição da entrada 7](./media/active-directory-aadconnectsync-configure-filtering/inbound7.png)</span><span class="sxs-lookup"><span data-stu-id="39f42-358">![Inbound 7 description](./media/active-directory-aadconnectsync-configure-filtering/inbound7.png)</span></span>  
9. <span data-ttu-id="39f42-359">Deixe **Filtro de escopo** vazio e clique em **Avançar**.</span><span class="sxs-lookup"><span data-stu-id="39f42-359">Leave **Scoping filter** empty, and click **Next**.</span></span> <span data-ttu-id="39f42-360">Um filtro vazio indica que a regra deve ser aplicada a todos os objetos.</span><span class="sxs-lookup"><span data-stu-id="39f42-360">An empty filter indicates that the rule is to be applied to all objects.</span></span>
10. <span data-ttu-id="39f42-361">Deixe as regras de **Junção** vazias e clique em **Avançar**.</span><span class="sxs-lookup"><span data-stu-id="39f42-361">Leave the **Join** rules empty, and then click **Next**.</span></span>
11. <span data-ttu-id="39f42-362">Clique em **Adicionar Transformação**, selecione **Constant** como **FlowType** e selecione **cloudFiltered** como o **Atributo de Destino**.</span><span class="sxs-lookup"><span data-stu-id="39f42-362">Click **Add Transformation**, select **Constant** as the **FlowType**, and select **cloudFiltered** as the **Target Attribute**.</span></span> <span data-ttu-id="39f42-363">Na caixa **Origem** , digite **True**.</span><span class="sxs-lookup"><span data-stu-id="39f42-363">In the **Source** box, type **True**.</span></span> <span data-ttu-id="39f42-364">Clique em **Adicionar** para salvar a regra.</span><span class="sxs-lookup"><span data-stu-id="39f42-364">Click **Add** to save the rule.</span></span>  
    <span data-ttu-id="39f42-365">![Transformação da entrada 3](./media/active-directory-aadconnectsync-configure-filtering/inbound3.png)</span><span class="sxs-lookup"><span data-stu-id="39f42-365">![Inbound 3 transformation](./media/active-directory-aadconnectsync-configure-filtering/inbound3.png)</span></span>  
12. <span data-ttu-id="39f42-366">Para concluir a configuração, você precisa executar uma **Sincronização completa**.</span><span class="sxs-lookup"><span data-stu-id="39f42-366">To complete the configuration, you need to run a **Full sync**.</span></span> <span data-ttu-id="39f42-367">Continue a ler a seção [Aplicar e verificar as alterações](#apply-and-verify-changes).</span><span class="sxs-lookup"><span data-stu-id="39f42-367">Continue reading the section [Apply and verify changes](#apply-and-verify-changes).</span></span>

<span data-ttu-id="39f42-368">Se for necessário, você pode criar mais regras do primeiro tipo, para incluir outros objetos para sincronização.</span><span class="sxs-lookup"><span data-stu-id="39f42-368">If you need to, you can create more rules of the first type where you include more objects in the synchronization.</span></span>

### <a name="outbound-filtering"></a><span data-ttu-id="39f42-369">Filtragem de saída</span><span class="sxs-lookup"><span data-stu-id="39f42-369">Outbound filtering</span></span>
<span data-ttu-id="39f42-370">Em alguns casos, é necessário fazer a filtragem somente depois que os objetos já estiverem no metaverso.</span><span class="sxs-lookup"><span data-stu-id="39f42-370">In some cases, it's necessary to do the filtering only after the objects have joined in the metaverse.</span></span> <span data-ttu-id="39f42-371">Por exemplo, pode ser necessário examinar o atributo de email na floresta de recursos e o atributo userPrincipalName na floresta de contas para determinar se um objeto deve ser sincronizado.</span><span class="sxs-lookup"><span data-stu-id="39f42-371">For example, it might be necessary to look at the mail attribute from the resource forest, and the userPrincipalName attribute from the account forest, to determine if an object should be synchronized.</span></span> <span data-ttu-id="39f42-372">Nesses casos, você cria a filtragem na regra de saída.</span><span class="sxs-lookup"><span data-stu-id="39f42-372">In these cases, you create the filtering on the outbound rule.</span></span>

<span data-ttu-id="39f42-373">Neste exemplo, você altera a filtragem para que somente usuários com emails e o userPrincipalName terminados em @contoso.com sejam sincronizados:</span><span class="sxs-lookup"><span data-stu-id="39f42-373">In this example, you change the filtering so that only users that have both their mail and userPrincipalName ending in @contoso.com are synchronized:</span></span>

1. <span data-ttu-id="39f42-374">Entre no servidor que está executando a sincronização do Azure AD Connect usando uma conta que seja membro do grupo de segurança **ADSyncAdmins** .</span><span class="sxs-lookup"><span data-stu-id="39f42-374">Sign in to the server that is running Azure AD Connect sync by using an account that is a member of the **ADSyncAdmins** security group.</span></span>
2. <span data-ttu-id="39f42-375">Inicie o **Editor de Regras de Sincronização** no menu **Iniciar**.</span><span class="sxs-lookup"><span data-stu-id="39f42-375">Start **Synchronization Rules Editor** from the **Start** menu.</span></span>
3. <span data-ttu-id="39f42-376">Em **Tipos de Regra**, clique em **Saída**.</span><span class="sxs-lookup"><span data-stu-id="39f42-376">Under **Rules Type**, click **Outbound**.</span></span>
4. <span data-ttu-id="39f42-377">Encontre a regra chamada **Saída para AAD – Ingresso de Usuário** e clique em **Editar**.</span><span class="sxs-lookup"><span data-stu-id="39f42-377">Find the rule named **Out to AAD – User Join**, and click **Edit**.</span></span>
5. <span data-ttu-id="39f42-378">No pop-up, responda **Sim** para criar uma cópia da regra.</span><span class="sxs-lookup"><span data-stu-id="39f42-378">In the pop-up, answer **Yes** to create a copy of the rule.</span></span>
6. <span data-ttu-id="39f42-379">Na página **Descrição**, altere **Precedência** para um valor não usado, por exemplo, 50.</span><span class="sxs-lookup"><span data-stu-id="39f42-379">On the **Description** page, change **Precedence** to an unused value, such as 50.</span></span>
7. <span data-ttu-id="39f42-380">Clique em **Filtro de escopo** na barra de navegação à esquerda e clique em **Adicionar cláusula**.</span><span class="sxs-lookup"><span data-stu-id="39f42-380">Click **Scoping filter** on the left-hand navigation, and then click **Add clause**.</span></span> <span data-ttu-id="39f42-381">Em **Atributo**, selecione **mail**.</span><span class="sxs-lookup"><span data-stu-id="39f42-381">In **Attribute**, select **mail**.</span></span> <span data-ttu-id="39f42-382">Em **Operador**, selecione **ENDSWITH**.</span><span class="sxs-lookup"><span data-stu-id="39f42-382">In **Operator**, select **ENDSWITH**.</span></span> <span data-ttu-id="39f42-383">Em **Valor**, digite **@contoso.com** e clique em **Adicionar cláusula**.</span><span class="sxs-lookup"><span data-stu-id="39f42-383">In **Value**, type **@contoso.com**, and then click **Add clause**.</span></span> <span data-ttu-id="39f42-384">Em **Atributo**, selecione **userPrincipalName**.</span><span class="sxs-lookup"><span data-stu-id="39f42-384">In **Attribute**, select **userPrincipalName**.</span></span> <span data-ttu-id="39f42-385">Em **Operador**, selecione **ENDSWITH**.</span><span class="sxs-lookup"><span data-stu-id="39f42-385">In **Operator**, select **ENDSWITH**.</span></span> <span data-ttu-id="39f42-386">Em **Valor**, digite **@contoso.com**.</span><span class="sxs-lookup"><span data-stu-id="39f42-386">In **Value**, type **@contoso.com**.</span></span>
8. <span data-ttu-id="39f42-387">Clique em **Salvar**.</span><span class="sxs-lookup"><span data-stu-id="39f42-387">Click **Save**.</span></span>
9. <span data-ttu-id="39f42-388">Para concluir a configuração, você precisa executar uma **Sincronização completa**.</span><span class="sxs-lookup"><span data-stu-id="39f42-388">To complete the configuration, you need to run a **Full sync**.</span></span> <span data-ttu-id="39f42-389">Continue a ler a seção [Aplicar e verificar as alterações](#apply-and-verify-changes).</span><span class="sxs-lookup"><span data-stu-id="39f42-389">Continue reading the section [Apply and verify changes](#apply-and-verify-changes).</span></span>

## <a name="apply-and-verify-changes"></a><span data-ttu-id="39f42-390">Aplicar e verificar as alterações</span><span class="sxs-lookup"><span data-stu-id="39f42-390">Apply and verify changes</span></span>
<span data-ttu-id="39f42-391">Depois de alterar as configurações, você precisa aplicá-las aos objetos já presentes no sistema.</span><span class="sxs-lookup"><span data-stu-id="39f42-391">After you've made your configuration changes, you must apply them to the objects that are already present in the system.</span></span> <span data-ttu-id="39f42-392">Os objetos que não estão presentes no mecanismo de sincronização talvez precisem ser processados (e o mecanismo de sincronização talvez precise ler o sistema de origem novamente para verificar seu conteúdo).</span><span class="sxs-lookup"><span data-stu-id="39f42-392">It might also be that the objects that aren't currently in the sync engine should be processed (and the sync engine needs to read the source system again to verify its content).</span></span>

<span data-ttu-id="39f42-393">Se tiver alterado a configuração usando a filtragem de **domínio** ou de **unidade organizacional**, você precisará fazer uma **Importação completa** seguida pela **Sincronização Delta**.</span><span class="sxs-lookup"><span data-stu-id="39f42-393">If you changed the configuration by using **domain** or **organizational-unit** filtering, then you need to do a **Full import**, followed by **Delta synchronization**.</span></span>

<span data-ttu-id="39f42-394">Se tiver alterado a configuração usando a filtragem de **atributo**, você precisará fazer uma **Sincronização completa**.</span><span class="sxs-lookup"><span data-stu-id="39f42-394">If you changed the configuration by using **attribute** filtering, then you need to do a **Full synchronization**.</span></span>

<span data-ttu-id="39f42-395">Execute as seguintes etapas:</span><span class="sxs-lookup"><span data-stu-id="39f42-395">Do the following steps:</span></span>

1. <span data-ttu-id="39f42-396">Inicie o **Serviço de Sincronização** no menu **Iniciar**.</span><span class="sxs-lookup"><span data-stu-id="39f42-396">Start **Synchronization Service** from the **Start** menu.</span></span>
2. <span data-ttu-id="39f42-397">Selecione **Conectores**.</span><span class="sxs-lookup"><span data-stu-id="39f42-397">Select **Connectors**.</span></span> <span data-ttu-id="39f42-398">Na lista **Conectores**, selecione o conector cuja configuração você anteriormente.</span><span class="sxs-lookup"><span data-stu-id="39f42-398">In the **Connectors** list, select the Connector where you made a configuration change earlier.</span></span> <span data-ttu-id="39f42-399">Em **Ações**, selecione **Executar**.</span><span class="sxs-lookup"><span data-stu-id="39f42-399">In **Actions**, select **Run**.</span></span>  
   <span data-ttu-id="39f42-400">![Execução do conector](./media/active-directory-aadconnectsync-configure-filtering/connectorrun.png)</span><span class="sxs-lookup"><span data-stu-id="39f42-400">![Connector run](./media/active-directory-aadconnectsync-configure-filtering/connectorrun.png)</span></span>  
3. <span data-ttu-id="39f42-401">Em **Perfis de execução**, selecione a operação mencionada na seção anterior.</span><span class="sxs-lookup"><span data-stu-id="39f42-401">In **Run profiles**, select the operation that was mentioned in the previous section.</span></span> <span data-ttu-id="39f42-402">Se você precisar executar duas ações, execute a segunda após a conclusão da primeira.</span><span class="sxs-lookup"><span data-stu-id="39f42-402">If you need to run two actions, run the second after the first one has finished.</span></span> <span data-ttu-id="39f42-403">(A coluna **Estado** indica que o conector selecionado está **Ocioso**.)</span><span class="sxs-lookup"><span data-stu-id="39f42-403">(The **State** column is **Idle** for the selected connector.)</span></span>

<span data-ttu-id="39f42-404">Após a sincronização, todas as alterações serão preparadas para exportação.</span><span class="sxs-lookup"><span data-stu-id="39f42-404">After the synchronization, all changes are staged to be exported.</span></span> <span data-ttu-id="39f42-405">Antes de realmente fazer as alterações no Azure AD, convém verificar se todas essas alterações estão corretas.</span><span class="sxs-lookup"><span data-stu-id="39f42-405">Before you actually make the changes in Azure AD, you want to verify that all these changes are correct.</span></span>

1. <span data-ttu-id="39f42-406">Inicie um prompt de comando e vá para `%Program Files%\Microsoft Azure AD Sync\bin`.</span><span class="sxs-lookup"><span data-stu-id="39f42-406">Start a command prompt, and go to `%Program Files%\Microsoft Azure AD Sync\bin`.</span></span>
2. <span data-ttu-id="39f42-407">Execute `csexport "Name of Connector" %temp%\export.xml /f:x`.</span><span class="sxs-lookup"><span data-stu-id="39f42-407">Run `csexport "Name of Connector" %temp%\export.xml /f:x`.</span></span>  
   <span data-ttu-id="39f42-408">O nome do conector pode ser encontrado no Serviço de Sincronização.</span><span class="sxs-lookup"><span data-stu-id="39f42-408">The name of the Connector is in Synchronization Service.</span></span> <span data-ttu-id="39f42-409">Ele tem um nome semelhante a "contoso.com – AAD" para o Azure AD.</span><span class="sxs-lookup"><span data-stu-id="39f42-409">It has a name similar to "contoso.com – AAD" for Azure AD.</span></span>
3. <span data-ttu-id="39f42-410">Execute `CSExportAnalyzer %temp%\export.xml > %temp%\export.csv`.</span><span class="sxs-lookup"><span data-stu-id="39f42-410">Run `CSExportAnalyzer %temp%\export.xml > %temp%\export.csv`.</span></span>
4. <span data-ttu-id="39f42-411">Agora você tem um arquivo em %temp% chamado export.csv que pode ser examinado no Microsoft Excel.</span><span class="sxs-lookup"><span data-stu-id="39f42-411">You now have a file in %temp% named export.csv that can be examined in Microsoft Excel.</span></span> <span data-ttu-id="39f42-412">Esse arquivo contém todas as alterações que estão prestes a ser exportadas.</span><span class="sxs-lookup"><span data-stu-id="39f42-412">This file contains all the changes that are about to be exported.</span></span>
5. <span data-ttu-id="39f42-413">Faça as alterações necessárias na configuração ou nos dados e execute essas etapas novamente (importar, sincronizar e verificar) até que você esteja satisfeito com as alterações que serão exportadas.</span><span class="sxs-lookup"><span data-stu-id="39f42-413">Make the necessary changes to the data or configuration, and run these steps again (Import, Synchronize, and Verify) until the changes that are about to be exported are what you expect.</span></span>

<span data-ttu-id="39f42-414">Quando estiver satisfeito, exporte as alterações para o Azure AD.</span><span class="sxs-lookup"><span data-stu-id="39f42-414">When you're satisfied, export the changes to Azure AD.</span></span>

1. <span data-ttu-id="39f42-415">Selecione **Conectores**.</span><span class="sxs-lookup"><span data-stu-id="39f42-415">Select **Connectors**.</span></span> <span data-ttu-id="39f42-416">Na lista **Conectores**, selecione o conector do Azure AD.</span><span class="sxs-lookup"><span data-stu-id="39f42-416">In the **Connectors** list, select the Azure AD Connector.</span></span> <span data-ttu-id="39f42-417">Em **Ações**, selecione **Executar**.</span><span class="sxs-lookup"><span data-stu-id="39f42-417">In **Actions**, select **Run**.</span></span>
2. <span data-ttu-id="39f42-418">Em **Perfis de execução**, selecione **Exportar**.</span><span class="sxs-lookup"><span data-stu-id="39f42-418">In **Run profiles**, select **Export**.</span></span>
3. <span data-ttu-id="39f42-419">Se suas alterações na configuração excluírem vários objetos, você verá um erro na exportação quando o número for maior do que o limite configurado (por padrão, 500).</span><span class="sxs-lookup"><span data-stu-id="39f42-419">If your configuration changes delete many objects, then you see an error in the export when the number is more than the configured threshold (by default 500).</span></span> <span data-ttu-id="39f42-420">Se você vir esse erro, será necessário desabilitar temporariamente o recurso “[impedir exclusões acidentais](active-directory-aadconnectsync-feature-prevent-accidental-deletes.md)”.</span><span class="sxs-lookup"><span data-stu-id="39f42-420">If you see this error, then you need to temporarily disable the "[prevent accidental deletes](active-directory-aadconnectsync-feature-prevent-accidental-deletes.md)" feature.</span></span>

<span data-ttu-id="39f42-421">Agora é hora de habilitar o agendador novamente.</span><span class="sxs-lookup"><span data-stu-id="39f42-421">Now it's time to enable the scheduler again.</span></span>

1. <span data-ttu-id="39f42-422">Inicie o **Agendador de Tarefas** no menu **Iniciar**.</span><span class="sxs-lookup"><span data-stu-id="39f42-422">Start **Task Scheduler** from the **Start** menu.</span></span>
2. <span data-ttu-id="39f42-423">Diretamente na **Biblioteca do Agendador de Tarefas**, localize a tarefa chamada **Agendador de Sincronização do Azure AD**, clique com o botão direito do mouse e selecione **Habilitar**.</span><span class="sxs-lookup"><span data-stu-id="39f42-423">Directly under **Task Scheduler Library**, find the task named **Azure AD Sync Scheduler**, right-click, and select **Enable**.</span></span>

## <a name="group-based-filtering"></a><span data-ttu-id="39f42-424">Filtragem baseada em grupo</span><span class="sxs-lookup"><span data-stu-id="39f42-424">Group-based filtering</span></span>
<span data-ttu-id="39f42-425">Você pode configurar a filtragem baseada em grupo quando instalar o Azure AD Connect pela primeira vez usando a [instalação personalizada](active-directory-aadconnect-get-started-custom.md#sync-filtering-based-on-groups).</span><span class="sxs-lookup"><span data-stu-id="39f42-425">You can configure group-based filtering the first time that you install Azure AD Connect by using [custom installation](active-directory-aadconnect-get-started-custom.md#sync-filtering-based-on-groups).</span></span> <span data-ttu-id="39f42-426">Ela é destinada uma implantação piloto para sincronizar um pequeno conjunto de objetos.</span><span class="sxs-lookup"><span data-stu-id="39f42-426">It's intended for a pilot deployment where you want only a small set of objects to be synchronized.</span></span> <span data-ttu-id="39f42-427">Se você desabilitar a filtragem baseada em grupo, ela não poderá ser habilitada novamente.</span><span class="sxs-lookup"><span data-stu-id="39f42-427">When you disable group-based filtering, it can't be enabled again.</span></span> <span data-ttu-id="39f42-428">*Não há suporte* para o uso da filtragem baseada em grupo em uma configuração personalizada.</span><span class="sxs-lookup"><span data-stu-id="39f42-428">It's *not supported* to use group-based filtering in a custom configuration.</span></span> <span data-ttu-id="39f42-429">Esse recurso só pode ser configurado com o assistente de instalação.</span><span class="sxs-lookup"><span data-stu-id="39f42-429">It's only supported to configure this feature by using the installation wizard.</span></span> <span data-ttu-id="39f42-430">Depois de concluir o piloto, você deve usar uma das outras opções de filtragem descritas neste tópico.</span><span class="sxs-lookup"><span data-stu-id="39f42-430">When you've completed your pilot, then use one of the other filtering options in this topic.</span></span> <span data-ttu-id="39f42-431">Ao usar a filtragem baseada em UO em conjunto com a filtragem baseada em grupos, as UOs em que o grupo e seus membros estão localizados devem ser incluídas.</span><span class="sxs-lookup"><span data-stu-id="39f42-431">When using OU-based filtering in conjunction with group-based filtering, the OU(s) where the group and its members are located must be included.</span></span>

<span data-ttu-id="39f42-432">Durante a sincronização de várias florestas do AD, você pode configurar a filtragem baseada em grupo com a especificação de um grupo diferente para cada conector do AD.</span><span class="sxs-lookup"><span data-stu-id="39f42-432">When synchronizing multiple AD forests, you can configure group-based filtering by specifying a different group for each AD connector.</span></span> <span data-ttu-id="39f42-433">Se você deseja sincronizar um usuário em um AD floresta e o mesmo usuário tem um ou mais objetos FSP (entidade de segurança externa) correspondentes em outras florestas do AD, você deve garantir que o objeto de usuário e todos os seus objetos FSP correspondentes estão no escopo da filtragem baseada em grupo.</span><span class="sxs-lookup"><span data-stu-id="39f42-433">If you wish to synchronize a user in one AD forest and the same user has one or more corresponding FSP (Foreign Security Principal) objects in other AD forests, you must ensure that the user object and all its corresponding FSP objects are within group-based filtering scope.</span></span> <span data-ttu-id="39f42-434">Se um ou mais dos objetos FSP são excluídos por filtragem baseada em grupo, o objeto de usuário não será sincronizado para o Azure AD.</span><span class="sxs-lookup"><span data-stu-id="39f42-434">If one or more of the FSP objects are excluded by group-based filtering, the user object will not be synchronized to Azure AD.</span></span>

## <a name="next-steps"></a><span data-ttu-id="39f42-435">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="39f42-435">Next steps</span></span>
- <span data-ttu-id="39f42-436">Saiba mais sobre a configuração da [sincronização do Azure AD Connect](active-directory-aadconnectsync-whatis.md).</span><span class="sxs-lookup"><span data-stu-id="39f42-436">Learn more about [Azure AD Connect sync](active-directory-aadconnectsync-whatis.md) configuration.</span></span>
- <span data-ttu-id="39f42-437">Saiba mais sobre a [integração de identidades locais com o Azure AD](active-directory-aadconnect.md).</span><span class="sxs-lookup"><span data-stu-id="39f42-437">Learn more about [integrating your on-premises identities with Azure AD](active-directory-aadconnect.md).</span></span>
