---
title: Conector do PowerShell | Microsoft Docs
description: Este artigo descreve como configurar o conector Windows PowerShell da Microsoft.
services: active-directory
documentationcenter: 
author: AndKjell
manager: femila
editor: 
ms.assetid: 6dba8e34-a874-4ff0-90bc-bd2b0a4199b5
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/12/2017
ms.author: billmath
ms.openlocfilehash: 0e5ccf5a38072e31d85bbc63eb0c608b0c34cfc2
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/03/2017
---
# <a name="windows-powershell-connector-technical-reference"></a><span data-ttu-id="72eb3-103">Referência técnica do Windows PowerShell Connector</span><span class="sxs-lookup"><span data-stu-id="72eb3-103">Windows PowerShell Connector technical reference</span></span>
<span data-ttu-id="72eb3-104">Este artigo descreve o conector do Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="72eb3-104">This article describes the Windows PowerShell Connector.</span></span> <span data-ttu-id="72eb3-105">O artigo se aplica aos seguintes produtos:</span><span class="sxs-lookup"><span data-stu-id="72eb3-105">The article applies to the following products:</span></span>

* <span data-ttu-id="72eb3-106">Microsoft Identity Manager 2016 (MIM2016)</span><span class="sxs-lookup"><span data-stu-id="72eb3-106">Microsoft Identity Manager 2016 (MIM2016)</span></span>
* <span data-ttu-id="72eb3-107">Forefront Identity Manager 2010 R2 (FIM2010R2)</span><span class="sxs-lookup"><span data-stu-id="72eb3-107">Forefront Identity Manager 2010 R2 (FIM2010R2)</span></span>
  * <span data-ttu-id="72eb3-108">É necessário usar o hotfix 4.1.3671.0 ou posterior [KB3092178](https://support.microsoft.com/kb/3092178).</span><span class="sxs-lookup"><span data-stu-id="72eb3-108">Must use hotfix 4.1.3671.0 or later [KB3092178](https://support.microsoft.com/kb/3092178).</span></span>

<span data-ttu-id="72eb3-109">Para MIM2016 e FIM2010R2 o conector está disponível para download do [Centro de Download da Microsoft](http://go.microsoft.com/fwlink/?LinkId=717495).</span><span class="sxs-lookup"><span data-stu-id="72eb3-109">For MIM2016 and FIM2010R2, the Connector is available as a download from the [Microsoft Download Center](http://go.microsoft.com/fwlink/?LinkId=717495).</span></span>

## <a name="overview-of-the-powershell-connector"></a><span data-ttu-id="72eb3-110">Visão geral do conector do PowerShell</span><span class="sxs-lookup"><span data-stu-id="72eb3-110">Overview of the PowerShell Connector</span></span>
<span data-ttu-id="72eb3-111">O conector do PowerShell o habilita a integrar o serviço de sincronização a sistemas externos que oferecem que APIs baseadas no Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="72eb3-111">The PowerShell Connector enables you to integrate the synchronization service with external systems that offer Windows PowerShell based APIs.</span></span> <span data-ttu-id="72eb3-112">O conector fornece uma ponte entre os recursos da estrutura do ECMA2 (agente de gerenciamento de conectividade extensível 2) baseada em chamada e o Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="72eb3-112">The connector provides a bridge between the capabilities of the call-based extensible connectivity management agent 2 (ECMA2) framework and Windows PowerShell.</span></span> <span data-ttu-id="72eb3-113">Para obter mais informações sobre a estrutura do ECMA, confira [Extensible Connectivity 2.2 Management Agent Reference](https://msdn.microsoft.com/library/windows/desktop/hh859557.aspx).</span><span class="sxs-lookup"><span data-stu-id="72eb3-113">For more information about the ECMA framework, see the [Extensible Connectivity 2.2 Management Agent Reference](https://msdn.microsoft.com/library/windows/desktop/hh859557.aspx).</span></span>

### <a name="prerequisites"></a><span data-ttu-id="72eb3-114">Pré-requisitos</span><span class="sxs-lookup"><span data-stu-id="72eb3-114">Prerequisites</span></span>
<span data-ttu-id="72eb3-115">Para usar o conector, verifique se você tem os seguintes itens no servidor de sincronização:</span><span class="sxs-lookup"><span data-stu-id="72eb3-115">Before you use the Connector, make sure you have the following on the synchronization server:</span></span>

* <span data-ttu-id="72eb3-116">Microsoft .NET 4.5.2 Framework ou posterior</span><span class="sxs-lookup"><span data-stu-id="72eb3-116">Microsoft .NET 4.5.2 Framework or later</span></span>
* <span data-ttu-id="72eb3-117">Windows PowerShell 2.0, 3.0 ou 4.0</span><span class="sxs-lookup"><span data-stu-id="72eb3-117">Windows PowerShell 2.0, 3.0, or 4.0</span></span>

<span data-ttu-id="72eb3-118">A política de execução no servidor do Serviço de Sincronização deve ser configurada para permitir que o conector execute scripts do Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="72eb3-118">The execution policy on the Synchronization Service server must be configured to allow the connector to run Windows PowerShell scripts.</span></span> <span data-ttu-id="72eb3-119">A menos que os scripts que o conector executa sejam digitalmente assinados, configure a política de execução usando este comando: </span><span class="sxs-lookup"><span data-stu-id="72eb3-119">Unless the scripts the connector runs are digitally signed, configure the execution policy by running this command:</span></span>  
`Set-ExecutionPolicy -ExecutionPolicy RemoteSigned`

## <a name="create-a-new-connector"></a><span data-ttu-id="72eb3-120">Criar um novo conector</span><span class="sxs-lookup"><span data-stu-id="72eb3-120">Create a new Connector</span></span>
<span data-ttu-id="72eb3-121">Para criar um conector Windows PowerShell no serviço de sincronização, você deve fornecer uma série de scripts do Windows PowerShell que execute as etapas solicitadas pelo serviço de sincronização.</span><span class="sxs-lookup"><span data-stu-id="72eb3-121">To create a Windows PowerShell connector in the synchronization service, you must provide a series of Windows PowerShell scripts that execute the steps requested by the synchronization service.</span></span> <span data-ttu-id="72eb3-122">Os scripts que você deve implementar variam de acordo com a fonte de dados com a qual você vai se conectar e da funcionalidade que vai exigir.</span><span class="sxs-lookup"><span data-stu-id="72eb3-122">Depending on the data source you connect to and the functionality you require, the scripts you must implement varies.</span></span> <span data-ttu-id="72eb3-123">Esta seção descreve cada um dos scripts que podem ser implementados e quando eles são exigidos.</span><span class="sxs-lookup"><span data-stu-id="72eb3-123">This section outlines each of the scripts that can be implemented and when they are required.</span></span>

<span data-ttu-id="72eb3-124">O conector Windows PowerShell foi desenvolvido para armazenar cada um dos scripts dentro do banco de dados do Serviço de Sincronização.</span><span class="sxs-lookup"><span data-stu-id="72eb3-124">The Windows PowerShell connector is designed to store each of the scripts inside the Synchronization Service database.</span></span> <span data-ttu-id="72eb3-125">Embora seja possível executar scripts que são armazenados no sistema de arquivos, é mais fácil inserir o corpo de cada script diretamente na configuração do conector.</span><span class="sxs-lookup"><span data-stu-id="72eb3-125">While it is possible to run scripts that are stored on the file system, it is easier to insert the body of each script directly in to the connector’s configuration.</span></span>

<span data-ttu-id="72eb3-126">Para criar um conector PowerShell, em **Serviço de Sincronização**, selecione **Agente de Gerenciamento** e **Criar**.</span><span class="sxs-lookup"><span data-stu-id="72eb3-126">To Create a PowerShell connector, in **Synchronization Service** select **Management Agent** and **Create**.</span></span> <span data-ttu-id="72eb3-127">Selecione o conector **PowerShell (Microsoft)** .</span><span class="sxs-lookup"><span data-stu-id="72eb3-127">Select the **PowerShell (Microsoft)** Connector.</span></span>

![Criar o conector](./media/active-directory-aadconnectsync-connector-powershell/createconnector.png)

### <a name="connectivity"></a><span data-ttu-id="72eb3-129">Conectividade</span><span class="sxs-lookup"><span data-stu-id="72eb3-129">Connectivity</span></span>
<span data-ttu-id="72eb3-130">Forneça parâmetros de configuração para se conectar a um sistema remoto.</span><span class="sxs-lookup"><span data-stu-id="72eb3-130">Supply configuration parameters for connecting to a remote system.</span></span> <span data-ttu-id="72eb3-131">Esses valores são armazenados com segurança pelo Serviço de Sincronização e disponibilizados para os scripts do Windows PowerShell quando o conector for executado.</span><span class="sxs-lookup"><span data-stu-id="72eb3-131">These values are securely stored by the Synchronization Service and made available to your Windows PowerShell scripts when the connector is run.</span></span>

![Conectividade](./media/active-directory-aadconnectsync-connector-powershell/connectivity.png)

<span data-ttu-id="72eb3-133">É possível configurar os seguintes parâmetros de conectividade:</span><span class="sxs-lookup"><span data-stu-id="72eb3-133">You can configure the following Connectivity parameters:</span></span>

<span data-ttu-id="72eb3-134">**Conectividade**</span><span class="sxs-lookup"><span data-stu-id="72eb3-134">**Connectivity**</span></span>

| <span data-ttu-id="72eb3-135">Parâmetro</span><span class="sxs-lookup"><span data-stu-id="72eb3-135">Parameter</span></span> | <span data-ttu-id="72eb3-136">Valor Padrão</span><span class="sxs-lookup"><span data-stu-id="72eb3-136">Default Value</span></span> | <span data-ttu-id="72eb3-137">Finalidade</span><span class="sxs-lookup"><span data-stu-id="72eb3-137">Purpose</span></span> |
| --- | --- | --- |
| <span data-ttu-id="72eb3-138">Servidor</span><span class="sxs-lookup"><span data-stu-id="72eb3-138">Server</span></span> |<Blank> |<span data-ttu-id="72eb3-139">Nome do servidor ao qual o conector deve se conectar.</span><span class="sxs-lookup"><span data-stu-id="72eb3-139">Server name that the connector should connect to.</span></span> |
| <span data-ttu-id="72eb3-140">Domínio</span><span class="sxs-lookup"><span data-stu-id="72eb3-140">Domain</span></span> |<Blank> |<span data-ttu-id="72eb3-141">Domínio da credencial a ser armazenado para uso quando o conector é executado.</span><span class="sxs-lookup"><span data-stu-id="72eb3-141">Domain of the credential to store for use when the connector is run.</span></span> |
| <span data-ttu-id="72eb3-142">Usuário</span><span class="sxs-lookup"><span data-stu-id="72eb3-142">User</span></span> |<Blank> |<span data-ttu-id="72eb3-143">Nome de usuário da credencial a ser armazenado para uso quando o conector é executado.</span><span class="sxs-lookup"><span data-stu-id="72eb3-143">Username of the credential to store for use when the connector is run.</span></span> |
| <span data-ttu-id="72eb3-144">Senha</span><span class="sxs-lookup"><span data-stu-id="72eb3-144">Password</span></span> |<Blank> |<span data-ttu-id="72eb3-145">Senha da credencial a ser armazenada para uso quando o conector é executado.</span><span class="sxs-lookup"><span data-stu-id="72eb3-145">Password of the credential to store for use when the connector is run.</span></span> |
| <span data-ttu-id="72eb3-146">Representar Conta do Conector</span><span class="sxs-lookup"><span data-stu-id="72eb3-146">Impersonate Connector Account</span></span> |<span data-ttu-id="72eb3-147">Falso</span><span class="sxs-lookup"><span data-stu-id="72eb3-147">False</span></span> |<span data-ttu-id="72eb3-148">Quando verdadeiro, o serviço de sincronização executa os scripts do Windows PowerShell no contexto das credenciais fornecidas.</span><span class="sxs-lookup"><span data-stu-id="72eb3-148">When true, the synchronization service runs the Windows PowerShell scripts in the context of the credentials supplied.</span></span> <span data-ttu-id="72eb3-149">Quando possível, é recomendável que o parâmetro **$Credentials** é passado para cada script seja usado em vez da representação.</span><span class="sxs-lookup"><span data-stu-id="72eb3-149">When possible, it is recommended that the **$Credentials** parameter is passed to each script is used instead of impersonation.</span></span> <span data-ttu-id="72eb3-150">Para obter mais informações sobre permissões adicionais que são necessárias para usar essa opção, confira [Configuração adicional para representação](#additional-configuration-for-impersonation).</span><span class="sxs-lookup"><span data-stu-id="72eb3-150">For more information on additional permissions that are required to use this option, see [Additional Configuration for Impersonation](#additional-configuration-for-impersonation).</span></span> |
| <span data-ttu-id="72eb3-151">Carregar o Perfil de Usuário ao Representar</span><span class="sxs-lookup"><span data-stu-id="72eb3-151">Load User Profile When Impersonating</span></span> |<span data-ttu-id="72eb3-152">Falso</span><span class="sxs-lookup"><span data-stu-id="72eb3-152">False</span></span> |<span data-ttu-id="72eb3-153">Instrui o Windows a carregar o perfil do usuário das credenciais do conector durante a representação.</span><span class="sxs-lookup"><span data-stu-id="72eb3-153">Instructs Windows to load the user profile of the connector’s credentials during impersonation.</span></span> <span data-ttu-id="72eb3-154">Se o usuário representado tiver um perfil móvel, o conector não carregará o perfil móvel.</span><span class="sxs-lookup"><span data-stu-id="72eb3-154">If the impersonated user has a roaming profile, the connector does not load the roaming profile.</span></span> <span data-ttu-id="72eb3-155">Para obter mais informações sobre permissões adicionais que são necessárias para usar esse parâmetro, confira [Configuração adicional para representação](#additional-configuration-for-impersonation).</span><span class="sxs-lookup"><span data-stu-id="72eb3-155">For more information on additional permissions that are required to use this parameter, see [Additional Configuration for Impersonation](#additional-configuration-for-impersonation).</span></span> |
| <span data-ttu-id="72eb3-156">Tipo de Logon ao Representar</span><span class="sxs-lookup"><span data-stu-id="72eb3-156">Logon Type When Impersonating</span></span> |<span data-ttu-id="72eb3-157">Nenhum</span><span class="sxs-lookup"><span data-stu-id="72eb3-157">None</span></span> |<span data-ttu-id="72eb3-158">Tipo de logon durante representação.</span><span class="sxs-lookup"><span data-stu-id="72eb3-158">Logon type during impersonation.</span></span> <span data-ttu-id="72eb3-159">Para saber mais, veja a documentação de [dwLogonType][dw].</span><span class="sxs-lookup"><span data-stu-id="72eb3-159">For more information, see the [dwLogonType][dw] documentation.</span></span> |
| <span data-ttu-id="72eb3-160">Somente Scripts Assinados</span><span class="sxs-lookup"><span data-stu-id="72eb3-160">Signed Scripts Only</span></span> |<span data-ttu-id="72eb3-161">Falso</span><span class="sxs-lookup"><span data-stu-id="72eb3-161">False</span></span> |<span data-ttu-id="72eb3-162">Se verdadeiro, o conector Windows PowerShell confirmará que cada script tem uma assinatura digital válida.</span><span class="sxs-lookup"><span data-stu-id="72eb3-162">If true, the Windows PowerShell connector validates that each script has a valid digital signature.</span></span> <span data-ttu-id="72eb3-163">Se falso, verifique se a política de execução do Windows PowerShell do servidor do Serviço de Sincronização é RemoteSigned ou Unrestricted.</span><span class="sxs-lookup"><span data-stu-id="72eb3-163">If false, ensure that the Synchronization Service server’s Windows PowerShell execution policy is RemoteSigned or Unrestricted.</span></span> |

<span data-ttu-id="72eb3-164">**Módulo Comum**</span><span class="sxs-lookup"><span data-stu-id="72eb3-164">**Common Module**</span></span>  
<span data-ttu-id="72eb3-165">O conector permite que você armazene um módulo do Windows PowerShell compartilhado na configuração.</span><span class="sxs-lookup"><span data-stu-id="72eb3-165">The connector allows you to store a shared Windows PowerShell module in the configuration.</span></span> <span data-ttu-id="72eb3-166">Quando o conector executa um script, o módulo do Windows PowerShell é extraído para o sistema de arquivos para que ele possa ser importado por cada script.</span><span class="sxs-lookup"><span data-stu-id="72eb3-166">When the connector runs a script, the Windows PowerShell module is extracted to the file system so that it can be imported by each script.</span></span>

<span data-ttu-id="72eb3-167">Para os scripts Importação, Exportação e Sincronização de Senha, o módulo comum é extraído para a pasta MAData do conector.</span><span class="sxs-lookup"><span data-stu-id="72eb3-167">For Import, Export, and Password Synchronization scripts, the common module is extracted to the connector’s MAData folder.</span></span> <span data-ttu-id="72eb3-168">Para os scripts Descoberta de Esquema, Validação, Hierarquia e Partição, o módulo comum é extraído para a pasta %TEMP%.</span><span class="sxs-lookup"><span data-stu-id="72eb3-168">For Schema, Validation, Hierarchy, and Partition discovery scripts, the common module is extracted to the %TEMP% folder.</span></span> <span data-ttu-id="72eb3-169">Em ambos os casos, o script Módulo Comum é denominado de acordo com a configuração Nome de Script do Módulo Comum.</span><span class="sxs-lookup"><span data-stu-id="72eb3-169">In both cases, the extracted Common Module script is named according to the Common Module Script Name setting.</span></span>

<span data-ttu-id="72eb3-170">Para carregar um módulo chamado FIMPowerShellConnectorModule.psm1 da pasta MAData, use a seguinte instrução: `Import-Module (Join-Path -Path [Microsoft.MetadirectoryServices.MAUtils]::MAFolder -ChildPath "FIMPowerShellConnectorModule.psm1")`</span><span class="sxs-lookup"><span data-stu-id="72eb3-170">To load a module called FIMPowerShellConnectorModule.psm1 from the MAData folder, use the following statement: `Import-Module (Join-Path -Path [Microsoft.MetadirectoryServices.MAUtils]::MAFolder -ChildPath "FIMPowerShellConnectorModule.psm1")`</span></span>

<span data-ttu-id="72eb3-171">Para carregar um módulo chamado FIMPowerShellConnectorModule.psm1 da pasta %TEMP%, use a seguinte instrução: `Import-Module (Join-Path -Path $env:TEMP -ChildPath "FIMPowerShellConnectorModule.psm1")`</span><span class="sxs-lookup"><span data-stu-id="72eb3-171">To load a module called FIMPowerShellConnectorModule.psm1 from the %TEMP% folder, use the following statement: `Import-Module (Join-Path -Path $env:TEMP -ChildPath "FIMPowerShellConnectorModule.psm1")`</span></span>

<span data-ttu-id="72eb3-172">**Validação de Parâmetro**</span><span class="sxs-lookup"><span data-stu-id="72eb3-172">**Parameter Validation**</span></span>  
<span data-ttu-id="72eb3-173">O Script de Validação é um script opcional do Windows PowerShell que pode ser usado para garantir que os parâmetros de configuração do conector fornecidos pelo administrador sejam válidos.</span><span class="sxs-lookup"><span data-stu-id="72eb3-173">The Validation Script is an optional Windows PowerShell script that can be used to ensure that connector configuration parameters supplied by the administrator are valid.</span></span> <span data-ttu-id="72eb3-174">Validar as credenciais de conexão e servidor e os parâmetros de conectividade são usos comuns do script de validação.</span><span class="sxs-lookup"><span data-stu-id="72eb3-174">Validating server, connection credentials, and connectivity parameters are common usages of the validation script.</span></span> <span data-ttu-id="72eb3-175">O script de validação é chamado depois que as seguintes guias e caixas de diálogo são modificadas:</span><span class="sxs-lookup"><span data-stu-id="72eb3-175">The validation script is called after the following tabs and dialogs are modified:</span></span>

* <span data-ttu-id="72eb3-176">Conectividade</span><span class="sxs-lookup"><span data-stu-id="72eb3-176">Connectivity</span></span>
* <span data-ttu-id="72eb3-177">Parâmetros Globais</span><span class="sxs-lookup"><span data-stu-id="72eb3-177">Global Parameters</span></span>
* <span data-ttu-id="72eb3-178">Configuração de Partição</span><span class="sxs-lookup"><span data-stu-id="72eb3-178">Partition Configuration</span></span>

<span data-ttu-id="72eb3-179">O script de validação recebe os seguintes parâmetros do conector:</span><span class="sxs-lookup"><span data-stu-id="72eb3-179">The validation script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="72eb3-180">Nome</span><span class="sxs-lookup"><span data-stu-id="72eb3-180">Name</span></span> | <span data-ttu-id="72eb3-181">Tipo de Dados</span><span class="sxs-lookup"><span data-stu-id="72eb3-181">Data Type</span></span> | <span data-ttu-id="72eb3-182">Descrição</span><span class="sxs-lookup"><span data-stu-id="72eb3-182">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="72eb3-183">ConfigParameterPage</span><span class="sxs-lookup"><span data-stu-id="72eb3-183">ConfigParameterPage</span></span> |<span data-ttu-id="72eb3-184">[ConfigParameterPage][cpp]</span><span class="sxs-lookup"><span data-stu-id="72eb3-184">[ConfigParameterPage][cpp]</span></span> |<span data-ttu-id="72eb3-185">A guia ou caixa de diálogo de configuração que disparou a solicitação de validação.</span><span class="sxs-lookup"><span data-stu-id="72eb3-185">The configuration tab or dialog that triggered the validation request.</span></span> |
| <span data-ttu-id="72eb3-186">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="72eb3-186">ConfigParameters</span></span> |<span data-ttu-id="72eb3-187">[KeyedCollection][keyk] [string, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="72eb3-187">[KeyedCollection][keyk] [string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="72eb3-188">Tabela de parâmetros de configuração para o conector.</span><span class="sxs-lookup"><span data-stu-id="72eb3-188">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="72eb3-189">Credencial</span><span class="sxs-lookup"><span data-stu-id="72eb3-189">Credential</span></span> |<span data-ttu-id="72eb3-190">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="72eb3-190">[PSCredential][pscred]</span></span> |<span data-ttu-id="72eb3-191">Contém as credenciais inseridas pelo administrador na guia Conectividade.</span><span class="sxs-lookup"><span data-stu-id="72eb3-191">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |

<span data-ttu-id="72eb3-192">O script de validação deve retornar um único objeto ParameterValidationResult para o pipeline.</span><span class="sxs-lookup"><span data-stu-id="72eb3-192">The validation script should return a single ParameterValidationResult object to the pipeline.</span></span>

<span data-ttu-id="72eb3-193">**Descoberta de Esquema**</span><span class="sxs-lookup"><span data-stu-id="72eb3-193">**Schema Discovery**</span></span>  
<span data-ttu-id="72eb3-194">O script de Descoberta de Esquema é obrigatório.</span><span class="sxs-lookup"><span data-stu-id="72eb3-194">The Schema Discovery script is mandatory.</span></span> <span data-ttu-id="72eb3-195">Esse script retorna o tipo de objeto, atributos e restrições de atributo que o Serviço de Sincronização usa ao configurar regras de fluxo de atributo.</span><span class="sxs-lookup"><span data-stu-id="72eb3-195">This script returns the object types, attributes, and attribute constraints that the Synchronization Service uses when configuring attribute flow rules.</span></span> <span data-ttu-id="72eb3-196">O script de Descoberta de Esquema é executado durante a criação do conector e popula o esquema do conector.</span><span class="sxs-lookup"><span data-stu-id="72eb3-196">The Schema Discovery script is run during connector creation and populates the connector’s schema.</span></span> <span data-ttu-id="72eb3-197">Ele também é usado pela ação de Atualização de Esquema no Gerenciador de Serviço de Sincronização.</span><span class="sxs-lookup"><span data-stu-id="72eb3-197">It is also used by the Refresh Schema action in the Synchronization Service Manager.</span></span>

<span data-ttu-id="72eb3-198">O script de descoberta de esquema recebe os seguintes parâmetros do conector:</span><span class="sxs-lookup"><span data-stu-id="72eb3-198">The schema discovery script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="72eb3-199">Nome</span><span class="sxs-lookup"><span data-stu-id="72eb3-199">Name</span></span> | <span data-ttu-id="72eb3-200">Tipo de Dados</span><span class="sxs-lookup"><span data-stu-id="72eb3-200">Data Type</span></span> | <span data-ttu-id="72eb3-201">Descrição</span><span class="sxs-lookup"><span data-stu-id="72eb3-201">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="72eb3-202">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="72eb3-202">ConfigParameters</span></span> |<span data-ttu-id="72eb3-203">[KeyedCollection][keyk] [string, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="72eb3-203">[KeyedCollection][keyk] [string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="72eb3-204">Tabela de parâmetros de configuração para o conector.</span><span class="sxs-lookup"><span data-stu-id="72eb3-204">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="72eb3-205">Credencial</span><span class="sxs-lookup"><span data-stu-id="72eb3-205">Credential</span></span> |<span data-ttu-id="72eb3-206">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="72eb3-206">[PSCredential][pscred]</span></span> |<span data-ttu-id="72eb3-207">Contém as credenciais inseridas pelo administrador na guia Conectividade.</span><span class="sxs-lookup"><span data-stu-id="72eb3-207">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |

<span data-ttu-id="72eb3-208">O script deve retornar um único objeto [Schema][schema] para o pipeline.</span><span class="sxs-lookup"><span data-stu-id="72eb3-208">The script must return a single [Schema][schema] object to the pipeline.</span></span> <span data-ttu-id="72eb3-209">O Objeto de Esquema é composto de objetos [SchemaType][schemaT] que representam os tipos de objeto (por exemplo: usuários e grupos).</span><span class="sxs-lookup"><span data-stu-id="72eb3-209">The Schema object is composed of [SchemaType][schemaT] objects that represent object types (for example: users and groups).</span></span> <span data-ttu-id="72eb3-210">O objeto SchemaType mantém um conjunto de objetos [SchemaAttribute][schemaA] que representa os atributos (por ex., nome fornecido, sobrenome e endereço postal) do tipo.</span><span class="sxs-lookup"><span data-stu-id="72eb3-210">The SchemaType object holds a collection of [SchemaAttribute][schemaA] objects that represent the attributes (for example: given name, surname, and postal address) of the type.</span></span>

<span data-ttu-id="72eb3-211">**Parâmetros Adicionais**</span><span class="sxs-lookup"><span data-stu-id="72eb3-211">**Additional Parameters**</span></span>  
<span data-ttu-id="72eb3-212">Além das definições de configuração padrão abordadas até agora, você pode definir configurações personalizadas adicionais que sejam específicas à instância do conector.</span><span class="sxs-lookup"><span data-stu-id="72eb3-212">In addition to the standard configuration settings, you can define additional custom configuration settings that are specific to the instance of the Connector.</span></span> <span data-ttu-id="72eb3-213">Esses parâmetros podem ser especificados nos níveis de conector, partição ou etapa de execução e acessados no script relevante do Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="72eb3-213">These parameters can be specified at the connector, partition, or run step levels and accessed from the relevant Windows PowerShell script.</span></span> <span data-ttu-id="72eb3-214">As definições de configuração personalizadas podem ser armazenadas no banco de dados do Serviço de Sincronização como texto sem formatação ou podem ser criptografadas.</span><span class="sxs-lookup"><span data-stu-id="72eb3-214">Custom configuration settings can be stored in the Synchronization Service database in plain text format or they may be encrypted.</span></span> <span data-ttu-id="72eb3-215">O Serviço de Sincronização criptografa e descriptografa automaticamente as definições de configuração seguras quando necessário.</span><span class="sxs-lookup"><span data-stu-id="72eb3-215">The Synchronization Service automatically encrypts and decrypts secure configuration settings when required.</span></span>

<span data-ttu-id="72eb3-216">Para especificar as definições de configuração personalizadas, separe o nome de cada parâmetro com uma vírgula (,).</span><span class="sxs-lookup"><span data-stu-id="72eb3-216">To specify custom configuration settings, separate the name of each parameter with a comma ( , ).</span></span>

<span data-ttu-id="72eb3-217">Para acessar as definições de configuração personalizadas em um script, você deve colocar o sufixo com um sublinhado ( \_ ) no nome e o escopo do parâmetro (Global, Partição ou RunStep).</span><span class="sxs-lookup"><span data-stu-id="72eb3-217">To access custom configuration settings from a script, you must suffix the name with an underscore ( \_ ) and the scope of the parameter (Global, Partition, or RunStep).</span></span> <span data-ttu-id="72eb3-218">Por exemplo, para acessar o parâmetro Global FileName, use este trecho de código: `$ConfigurationParameters["FileName_Global"].Value`</span><span class="sxs-lookup"><span data-stu-id="72eb3-218">For example, to access the Global FileName parameter, use this code snippet: `$ConfigurationParameters["FileName_Global"].Value`</span></span>

### <a name="capabilities"></a><span data-ttu-id="72eb3-219">Funcionalidades</span><span class="sxs-lookup"><span data-stu-id="72eb3-219">Capabilities</span></span>
<span data-ttu-id="72eb3-220">A guia Recursos do Designer do Agente de Gerenciamento define o comportamento e a funcionalidade do conector.</span><span class="sxs-lookup"><span data-stu-id="72eb3-220">The capabilities tab of the Management Agent Designer defines the behavior and functionality of the connector.</span></span> <span data-ttu-id="72eb3-221">As seleções feitas nessa guia não podem ser modificadas depois que o conector tiver sido criado.</span><span class="sxs-lookup"><span data-stu-id="72eb3-221">The selections made on this tab cannot be modified when the connector has been created.</span></span> <span data-ttu-id="72eb3-222">Esta tabela lista as configurações de recurso.</span><span class="sxs-lookup"><span data-stu-id="72eb3-222">This table lists the capability settings.</span></span>

![Funcionalidades](./media/active-directory-aadconnectsync-connector-powershell/capabilities.png)

| <span data-ttu-id="72eb3-224">Recurso</span><span class="sxs-lookup"><span data-stu-id="72eb3-224">Capability</span></span> | <span data-ttu-id="72eb3-225">Descrição</span><span class="sxs-lookup"><span data-stu-id="72eb3-225">Description</span></span> |
| --- | --- |
| <span data-ttu-id="72eb3-226">[Estilo de Nome Diferenciado][dnstyle]</span><span class="sxs-lookup"><span data-stu-id="72eb3-226">[Distinguished Name Style][dnstyle]</span></span> |<span data-ttu-id="72eb3-227">Indica se o conector dá suporte a nomes diferenciados e, em caso positivo, à qual estilo.</span><span class="sxs-lookup"><span data-stu-id="72eb3-227">Indicates if the connector supports distinguished names and if so, what style.</span></span> |
| <span data-ttu-id="72eb3-228">[Tipo de Exportação][exportT]</span><span class="sxs-lookup"><span data-stu-id="72eb3-228">[Export Type][exportT]</span></span> |<span data-ttu-id="72eb3-229">Determina os tipos de objeto que são apresentados para o script Exportar.</span><span class="sxs-lookup"><span data-stu-id="72eb3-229">Determines the type of objects that are presented to the Export script.</span></span> <li><span data-ttu-id="72eb3-230">AttributeReplace – inclui o conjunto completo de valores para um atributo com vários valores, quando o atributo é alterado.</span><span class="sxs-lookup"><span data-stu-id="72eb3-230">AttributeReplace – includes the full set of values for a multi-valued attribute when the attribute changes.</span></span></li><li><span data-ttu-id="72eb3-231">AttributeUpdate – inclui apenas deltas para um atributo com vários valores, quando o atributo é alterado.</span><span class="sxs-lookup"><span data-stu-id="72eb3-231">AttributeUpdate – includes only the deltas to a multi-valued attribute when the attribute changes.</span></span></li><li><span data-ttu-id="72eb3-232">MultivaluedReferenceAttributeUpdate - inclui um conjunto completo de valores de atributos de vários valores de não referência e apenas deltas para atributos de referência com vários valores.</span><span class="sxs-lookup"><span data-stu-id="72eb3-232">MultivaluedReferenceAttributeUpdate - includes a full set of values for non-reference multi-valued attributes and only deltas for multi-valued reference attributes.</span></span></li><li><span data-ttu-id="72eb3-233">ObjectReplace – inclui todos os atributos de um objeto quando qualquer atributo é alterado</span><span class="sxs-lookup"><span data-stu-id="72eb3-233">ObjectReplace – includes all attributes for an object when any attribute changes</span></span></li> |
| <span data-ttu-id="72eb3-234">[Normalização de Dados][DataNorm]</span><span class="sxs-lookup"><span data-stu-id="72eb3-234">[Data Normalization][DataNorm]</span></span> |<span data-ttu-id="72eb3-235">Instrui o Serviço de Sincronização a normalizar os atributos de âncora antes que eles sejam fornecidos aos scripts.</span><span class="sxs-lookup"><span data-stu-id="72eb3-235">Instructs the Synchronization Service to normalize anchor attributes before they are provided to scripts.</span></span> |
| <span data-ttu-id="72eb3-236">[Confirmação do Objeto][oconf]</span><span class="sxs-lookup"><span data-stu-id="72eb3-236">[Object Confirmation][oconf]</span></span> |<span data-ttu-id="72eb3-237">Define o comportamento de importação pendente no Serviço de Sincronização.</span><span class="sxs-lookup"><span data-stu-id="72eb3-237">Configures the pending import behavior in the Synchronization Service.</span></span> <li><span data-ttu-id="72eb3-238">Normal – o comportamento padrão que espera todas as alterações exportadas para confirmação por meio da importação</span><span class="sxs-lookup"><span data-stu-id="72eb3-238">Normal – default behavior that expects all exported changes to be confirmed via import</span></span></li><li><span data-ttu-id="72eb3-239">NoDeleteConfirmation – quando um objeto é excluído, não há nenhuma importação pendente gerada.</span><span class="sxs-lookup"><span data-stu-id="72eb3-239">NoDeleteConfirmation – when an object is deleted, there is no pending import generated.</span></span></li><li><span data-ttu-id="72eb3-240">NoAddAndDeleteConfirmation – quando um objeto é criado ou excluído, não há nenhuma importação pendente gerada.</span><span class="sxs-lookup"><span data-stu-id="72eb3-240">NoAddAndDeleteConfirmation – when an object is created or deleted, there is no pending import generated.</span></span></li> |
| <span data-ttu-id="72eb3-241">Usar DN como âncora</span><span class="sxs-lookup"><span data-stu-id="72eb3-241">Use DN as Anchor</span></span> |<span data-ttu-id="72eb3-242">Se o Estilo de Nome Diferenciado for definido como LDAP, o atributo de âncora do espaço do conector também será o nome diferenciado.</span><span class="sxs-lookup"><span data-stu-id="72eb3-242">If the Distinguished Name Style is set to LDAP, the anchor attribute for the connector space is also the distinguished name.</span></span> |
| <span data-ttu-id="72eb3-243">Operações Simultâneas de Vários Conectores</span><span class="sxs-lookup"><span data-stu-id="72eb3-243">Concurrent Operations of Several Connectors</span></span> |<span data-ttu-id="72eb3-244">Quando marcada, vários conectores do Windows PowerShell podem ser executados simultaneamente.</span><span class="sxs-lookup"><span data-stu-id="72eb3-244">When checked, multiple Windows PowerShell connectors can run simultaneously.</span></span> |
| <span data-ttu-id="72eb3-245">Partições</span><span class="sxs-lookup"><span data-stu-id="72eb3-245">Partitions</span></span> |<span data-ttu-id="72eb3-246">Quando marcada, o conector oferece suporte a várias partições e à descoberta de partição.</span><span class="sxs-lookup"><span data-stu-id="72eb3-246">When checked, the connector supports multiple partitions and partition discovery.</span></span> |
| <span data-ttu-id="72eb3-247">Hierarquia</span><span class="sxs-lookup"><span data-stu-id="72eb3-247">Hierarchy</span></span> |<span data-ttu-id="72eb3-248">Quando marcada, o conector oferece suporte a uma estrutura hierárquica de estilo LDAP.</span><span class="sxs-lookup"><span data-stu-id="72eb3-248">When checked, the connector supports an LDAP style hierarchical structure.</span></span> |
| <span data-ttu-id="72eb3-249">Habilitar Importação</span><span class="sxs-lookup"><span data-stu-id="72eb3-249">Enable Import</span></span> |<span data-ttu-id="72eb3-250">Quando marcada, o conector importa dados por meio de scripts de importação.</span><span class="sxs-lookup"><span data-stu-id="72eb3-250">When checked, the connector imports data via import scripts.</span></span> |
| <span data-ttu-id="72eb3-251">Habilitar Importação Delta</span><span class="sxs-lookup"><span data-stu-id="72eb3-251">Enable Delta Import</span></span> |<span data-ttu-id="72eb3-252">Quando marcada, o conector pode solicitar deltas de scripts de importação.</span><span class="sxs-lookup"><span data-stu-id="72eb3-252">When checked, the connector can request deltas from the import scripts.</span></span> |
| <span data-ttu-id="72eb3-253">Habilitar Exportação</span><span class="sxs-lookup"><span data-stu-id="72eb3-253">Enable Export</span></span> |<span data-ttu-id="72eb3-254">Quando marcada, o conector exporta dados por meio de scripts de exportação.</span><span class="sxs-lookup"><span data-stu-id="72eb3-254">When checked, the connector exports data via export scripts.</span></span> |
| <span data-ttu-id="72eb3-255">Habilitar Exportação Completa</span><span class="sxs-lookup"><span data-stu-id="72eb3-255">Enable Full Export</span></span> |<span data-ttu-id="72eb3-256">Quando marcada, os scripts de exportação oferecem suporte à exportação do espaço inteiro do conector.</span><span class="sxs-lookup"><span data-stu-id="72eb3-256">When checked, the export scripts support exporting the entire connector space.</span></span> <span data-ttu-id="72eb3-257">Para usar essa opção, Habilitar Exportação também deve ser marcada.</span><span class="sxs-lookup"><span data-stu-id="72eb3-257">To use this option, Enable Export must also be checked.</span></span> |
| <span data-ttu-id="72eb3-258">Nenhum Valor de Referência na Primeira Passagem de Exportação</span><span class="sxs-lookup"><span data-stu-id="72eb3-258">No Reference Values In First Export Pass</span></span> |<span data-ttu-id="72eb3-259">Quando marcada, os atributos de referência são exportados em uma segunda passagem de exportação.</span><span class="sxs-lookup"><span data-stu-id="72eb3-259">When checked, reference attributes are exported in a second export pass.</span></span> |
| <span data-ttu-id="72eb3-260">Habilitar Renomeação do Objeto</span><span class="sxs-lookup"><span data-stu-id="72eb3-260">Enable Object Rename</span></span> |<span data-ttu-id="72eb3-261">Quando marcada, os nomes diferenciados podem ser modificados.</span><span class="sxs-lookup"><span data-stu-id="72eb3-261">When checked, distinguished names can be modified.</span></span> |
| <span data-ttu-id="72eb3-262">Excluir-Adicionar como Substituição</span><span class="sxs-lookup"><span data-stu-id="72eb3-262">Delete-Add As Replace</span></span> |<span data-ttu-id="72eb3-263">Quando marcada, as operações excluir-adicionar são exportadas como uma única substituição.</span><span class="sxs-lookup"><span data-stu-id="72eb3-263">When checked, delete-add operations are exported as a single replacement.</span></span> |
| <span data-ttu-id="72eb3-264">Habilitar Operações de Senha</span><span class="sxs-lookup"><span data-stu-id="72eb3-264">Enable Password Operations</span></span> |<span data-ttu-id="72eb3-265">Quando marcada, há suporte para scripts de sincronização de senha.</span><span class="sxs-lookup"><span data-stu-id="72eb3-265">When checked, password synchronization scripts are supported.</span></span> |
| <span data-ttu-id="72eb3-266">Habilitar Exportar Senha na Primeira Passagem</span><span class="sxs-lookup"><span data-stu-id="72eb3-266">Enable Export Password in First Pass</span></span> |<span data-ttu-id="72eb3-267">Quando marcada, as senhas definidas durante o provisionamento são exportadas quando o objeto é criado.</span><span class="sxs-lookup"><span data-stu-id="72eb3-267">When checked, passwords set during provisioning are exported when the object is created.</span></span> |

### <a name="global-parameters"></a><span data-ttu-id="72eb3-268">Parâmetros Globais</span><span class="sxs-lookup"><span data-stu-id="72eb3-268">Global Parameters</span></span>
<span data-ttu-id="72eb3-269">A guia Parâmetros Globais no Designer de Agente de Gerenciamento permite que você configure os scripts do Windows PowerShell que são executados pelo conector.</span><span class="sxs-lookup"><span data-stu-id="72eb3-269">The Global Parameters tab in the Management Agent Designer enables you to configure the Windows PowerShell scripts that are run by the connector.</span></span> <span data-ttu-id="72eb3-270">Você também pode configurar valores globais para configurações personalizadas definidas na guia Conectividade.</span><span class="sxs-lookup"><span data-stu-id="72eb3-270">You can also configure global values for custom configuration settings defined on the Connectivity tab.</span></span>

<span data-ttu-id="72eb3-271">**Descoberta de Partição**</span><span class="sxs-lookup"><span data-stu-id="72eb3-271">**Partition Discovery**</span></span>  
<span data-ttu-id="72eb3-272">Uma partição é um namespace separado dentro de um esquema compartilhado.</span><span class="sxs-lookup"><span data-stu-id="72eb3-272">A partition is a separate namespace within one shared schema.</span></span> <span data-ttu-id="72eb3-273">Por exemplo, no Active Directory, cada domínio é uma partição em uma floresta.</span><span class="sxs-lookup"><span data-stu-id="72eb3-273">For example, in Active Directory every domain is a partition within one forest.</span></span> <span data-ttu-id="72eb3-274">Uma partição é o agrupamento lógico de operações de importação e exportação.</span><span class="sxs-lookup"><span data-stu-id="72eb3-274">A partition is the logical grouping for import and export operations.</span></span> <span data-ttu-id="72eb3-275">Importação e Exportação têm partição como um contexto e todas as operações ocorrem nesse contexto.</span><span class="sxs-lookup"><span data-stu-id="72eb3-275">Import and Export have partition as a context and all operations happens in this context.</span></span> <span data-ttu-id="72eb3-276">As partições supostamente representam uma hierarquia no LDAP.</span><span class="sxs-lookup"><span data-stu-id="72eb3-276">Partitions are supposed to represent a hierarchy in LDAP.</span></span> <span data-ttu-id="72eb3-277">O nome diferenciado de uma partição é usado na importação para verificar se todos os objetos retornados estão dentro do escopo de uma partição.</span><span class="sxs-lookup"><span data-stu-id="72eb3-277">The distinguished name of a partition is used in import to verify that all returned objects are within the scope of a partition.</span></span> <span data-ttu-id="72eb3-278">O nome diferenciado da partição também é usado durante o provisionamento do metaverso para o espaço do conector, de modo a determinar a qual partição um objeto deve ser associado durante a exportação.</span><span class="sxs-lookup"><span data-stu-id="72eb3-278">The partition distinguished name is also used during provisioning from the metaverse to the connector space to determine the partition an object should be associated with during export.</span></span>

<span data-ttu-id="72eb3-279">O script de descoberta de partição recebe os seguintes parâmetros do conector:</span><span class="sxs-lookup"><span data-stu-id="72eb3-279">The partition discovery script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="72eb3-280">Nome</span><span class="sxs-lookup"><span data-stu-id="72eb3-280">Name</span></span> | <span data-ttu-id="72eb3-281">Tipo de Dados</span><span class="sxs-lookup"><span data-stu-id="72eb3-281">Data Type</span></span> | <span data-ttu-id="72eb3-282">Descrição</span><span class="sxs-lookup"><span data-stu-id="72eb3-282">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="72eb3-283">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="72eb3-283">ConfigParameters</span></span> |<span data-ttu-id="72eb3-284">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="72eb3-284">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="72eb3-285">Tabela de parâmetros de configuração para o conector.</span><span class="sxs-lookup"><span data-stu-id="72eb3-285">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="72eb3-286">Credencial</span><span class="sxs-lookup"><span data-stu-id="72eb3-286">Credential</span></span> |<span data-ttu-id="72eb3-287">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="72eb3-287">[PSCredential][pscred]</span></span> |<span data-ttu-id="72eb3-288">Contém as credenciais inseridas pelo administrador na guia Conectividade.</span><span class="sxs-lookup"><span data-stu-id="72eb3-288">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |

<span data-ttu-id="72eb3-289">O script deve retornar um único objeto [Partition][part] ou uma Lista[T] de objetos Partition para o pipeline.</span><span class="sxs-lookup"><span data-stu-id="72eb3-289">The script must return a either a single [Partition][part] object or a List[T] of Partition objects to the pipeline.</span></span>

<span data-ttu-id="72eb3-290">**Descoberta de Hierarquia**</span><span class="sxs-lookup"><span data-stu-id="72eb3-290">**Hierarchy Discovery**</span></span>  
<span data-ttu-id="72eb3-291">O script de descoberta de hierarquia é usado apenas quando o recurso Estilo de Nome Diferenciado é LDAP.</span><span class="sxs-lookup"><span data-stu-id="72eb3-291">The hierarchy discovery script is only used when the Distinguished Name Style capability is LDAP.</span></span> <span data-ttu-id="72eb3-292">O script é usado para permitir que você navegue e selecione um conjunto de contêineres que é considerado em escopo ou fora de escopo para operações de importação e exportação.</span><span class="sxs-lookup"><span data-stu-id="72eb3-292">The script is used to allow you to browse and select a set of containers that is considered in or out of scope for import and export operations.</span></span> <span data-ttu-id="72eb3-293">O script deve fornecer somente uma lista de nós que sejam filhos diretos do nó raiz fornecido para o script.</span><span class="sxs-lookup"><span data-stu-id="72eb3-293">The script should only provide a list of nodes that are direct children of the root node supplied to the script.</span></span>

<span data-ttu-id="72eb3-294">O script de descoberta de hierarquia recebe os seguintes parâmetros do conector:</span><span class="sxs-lookup"><span data-stu-id="72eb3-294">The hierarchy discovery script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="72eb3-295">Nome</span><span class="sxs-lookup"><span data-stu-id="72eb3-295">Name</span></span> | <span data-ttu-id="72eb3-296">Tipo de Dados</span><span class="sxs-lookup"><span data-stu-id="72eb3-296">Data Type</span></span> | <span data-ttu-id="72eb3-297">Descrição</span><span class="sxs-lookup"><span data-stu-id="72eb3-297">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="72eb3-298">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="72eb3-298">ConfigParameters</span></span> |<span data-ttu-id="72eb3-299">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="72eb3-299">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="72eb3-300">Tabela de parâmetros de configuração para o conector.</span><span class="sxs-lookup"><span data-stu-id="72eb3-300">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="72eb3-301">Credencial</span><span class="sxs-lookup"><span data-stu-id="72eb3-301">Credential</span></span> |<span data-ttu-id="72eb3-302">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="72eb3-302">[PSCredential][pscred]</span></span> |<span data-ttu-id="72eb3-303">Contém as credenciais inseridas pelo administrador na guia Conectividade.</span><span class="sxs-lookup"><span data-stu-id="72eb3-303">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |
| <span data-ttu-id="72eb3-304">ParentNode</span><span class="sxs-lookup"><span data-stu-id="72eb3-304">ParentNode</span></span> |<span data-ttu-id="72eb3-305">[HierarchyNode][hn]</span><span class="sxs-lookup"><span data-stu-id="72eb3-305">[HierarchyNode][hn]</span></span> |<span data-ttu-id="72eb3-306">O nó raiz da hierarquia sob a qual o script deve retornar os filhos diretos.</span><span class="sxs-lookup"><span data-stu-id="72eb3-306">The root node of the hierarchy under which the script should return direct children.</span></span> |

<span data-ttu-id="72eb3-307">O script deve retornar um único objeto filho HierarchyNode ou uma Lista[T] de objetos filho HierarchyNode para o pipeline.</span><span class="sxs-lookup"><span data-stu-id="72eb3-307">The script must return a either a single child HierarchyNode object or a List[T] of child HierarchyNode objects to the pipeline.</span></span>

#### <a name="import"></a><span data-ttu-id="72eb3-308">Importar</span><span class="sxs-lookup"><span data-stu-id="72eb3-308">Import</span></span>
<span data-ttu-id="72eb3-309">Os conectores que oferecem suporte às operações de importação devem implementar três scripts.</span><span class="sxs-lookup"><span data-stu-id="72eb3-309">Connectors that support import operations must implement three scripts.</span></span>

<span data-ttu-id="72eb3-310">**Iniciar Importação**</span><span class="sxs-lookup"><span data-stu-id="72eb3-310">**Begin Import**</span></span>  
<span data-ttu-id="72eb3-311">O script de início de importação é executado no começo de uma etapa de execução de importação.</span><span class="sxs-lookup"><span data-stu-id="72eb3-311">The begin import script is run at the beginning of an import run step.</span></span> <span data-ttu-id="72eb3-312">Durante esta etapa, você pode estabelecer uma conexão com o sistema de origem e executar etapas preparatórias antes de importar dados de sistema conectado.</span><span class="sxs-lookup"><span data-stu-id="72eb3-312">During this step, you can establish a connection to the source system and do preparatory steps before importing data from the connected system.</span></span>

<span data-ttu-id="72eb3-313">O script de início de importação recebe os seguintes parâmetros do conector:</span><span class="sxs-lookup"><span data-stu-id="72eb3-313">The begin import script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="72eb3-314">Nome</span><span class="sxs-lookup"><span data-stu-id="72eb3-314">Name</span></span> | <span data-ttu-id="72eb3-315">Tipo de Dados</span><span class="sxs-lookup"><span data-stu-id="72eb3-315">Data Type</span></span> | <span data-ttu-id="72eb3-316">Descrição</span><span class="sxs-lookup"><span data-stu-id="72eb3-316">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="72eb3-317">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="72eb3-317">ConfigParameters</span></span> |<span data-ttu-id="72eb3-318">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="72eb3-318">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="72eb3-319">Tabela de parâmetros de configuração para o conector.</span><span class="sxs-lookup"><span data-stu-id="72eb3-319">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="72eb3-320">Credencial</span><span class="sxs-lookup"><span data-stu-id="72eb3-320">Credential</span></span> |<span data-ttu-id="72eb3-321">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="72eb3-321">[PSCredential][pscred]</span></span> |<span data-ttu-id="72eb3-322">Contém as credenciais inseridas pelo administrador na guia Conectividade.</span><span class="sxs-lookup"><span data-stu-id="72eb3-322">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |
| <span data-ttu-id="72eb3-323">OpenImportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="72eb3-323">OpenImportConnectionRunStep</span></span> |<span data-ttu-id="72eb3-324">[OpenImportConnectionRunStep][oicrs]</span><span class="sxs-lookup"><span data-stu-id="72eb3-324">[OpenImportConnectionRunStep][oicrs]</span></span> |<span data-ttu-id="72eb3-325">Informa o script sobre o tipo de execução de importação (delta ou completa), partição, hierarquia, marca d'água e tamanho esperado da página.</span><span class="sxs-lookup"><span data-stu-id="72eb3-325">Informs the script about the type of import run (delta or full), partition, hierarchy, watermark, and expected page size.</span></span> |
| <span data-ttu-id="72eb3-326">Tipos</span><span class="sxs-lookup"><span data-stu-id="72eb3-326">Types</span></span> |<span data-ttu-id="72eb3-327">[Schema][schema]</span><span class="sxs-lookup"><span data-stu-id="72eb3-327">[Schema][schema]</span></span> |<span data-ttu-id="72eb3-328">Esquema para o espaço do conector que é importado.</span><span class="sxs-lookup"><span data-stu-id="72eb3-328">Schema for the connector space that is imported.</span></span> |

<span data-ttu-id="72eb3-329">O script deve retornar um único objeto [OpenImportConnectionResults][oicres] para o pipeline. Por exemplo: `Write-Output (New-Object Microsoft.MetadirectoryServices.OpenImportConnectionResults)`</span><span class="sxs-lookup"><span data-stu-id="72eb3-329">The script must return a single [OpenImportConnectionResults][oicres] object to the pipeline, for example: `Write-Output (New-Object Microsoft.MetadirectoryServices.OpenImportConnectionResults)`</span></span>

<span data-ttu-id="72eb3-330">**Importar Dados**</span><span class="sxs-lookup"><span data-stu-id="72eb3-330">**Import Data**</span></span>  
<span data-ttu-id="72eb3-331">O script de importação de dados é chamado pelo conector até que o script indique que não há mais dados a serem importados.</span><span class="sxs-lookup"><span data-stu-id="72eb3-331">The import data script is called by the connector until the script indicates that there is no more data to import.</span></span> <span data-ttu-id="72eb3-332">O conector Windows PowerShell tem um tamanho de página de 9.999 objetos.</span><span class="sxs-lookup"><span data-stu-id="72eb3-332">The Windows PowerShell connector has a page size of 9,999 objects.</span></span> <span data-ttu-id="72eb3-333">Se o script retornar mais de 9.999 objetos para importação, você deverá dar suporte à paginação.</span><span class="sxs-lookup"><span data-stu-id="72eb3-333">If your script returns more than 9,999 objects for import, you must support paging.</span></span> <span data-ttu-id="72eb3-334">O conector expõe uma propriedade dados personalizada que pode ser usada para armazenar uma marca d’água, de modo que toda vez que o script de importação de dados for chamado, o script retome a importação de objetos onde ela foi interrompida.</span><span class="sxs-lookup"><span data-stu-id="72eb3-334">The connector exposes a custom data property that you can use to a store a watermark so that each time the import data script is called, your script resumes importing objects where it left off.</span></span>

<span data-ttu-id="72eb3-335">O script de importação de dados recebe os seguintes parâmetros do conector:</span><span class="sxs-lookup"><span data-stu-id="72eb3-335">The import data script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="72eb3-336">Nome</span><span class="sxs-lookup"><span data-stu-id="72eb3-336">Name</span></span> | <span data-ttu-id="72eb3-337">Tipo de Dados</span><span class="sxs-lookup"><span data-stu-id="72eb3-337">Data Type</span></span> | <span data-ttu-id="72eb3-338">Descrição</span><span class="sxs-lookup"><span data-stu-id="72eb3-338">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="72eb3-339">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="72eb3-339">ConfigParameters</span></span> |<span data-ttu-id="72eb3-340">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="72eb3-340">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="72eb3-341">Tabela de parâmetros de configuração para o conector.</span><span class="sxs-lookup"><span data-stu-id="72eb3-341">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="72eb3-342">Credencial</span><span class="sxs-lookup"><span data-stu-id="72eb3-342">Credential</span></span> |<span data-ttu-id="72eb3-343">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="72eb3-343">[PSCredential][pscred]</span></span> |<span data-ttu-id="72eb3-344">Contém as credenciais inseridas pelo administrador na guia Conectividade.</span><span class="sxs-lookup"><span data-stu-id="72eb3-344">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |
| <span data-ttu-id="72eb3-345">GetImportEntriesRunStep</span><span class="sxs-lookup"><span data-stu-id="72eb3-345">GetImportEntriesRunStep</span></span> |<span data-ttu-id="72eb3-346">[ImportRunStep][irs]</span><span class="sxs-lookup"><span data-stu-id="72eb3-346">[ImportRunStep][irs]</span></span> |<span data-ttu-id="72eb3-347">Contém a marca d'água (CustomData) que pode ser usada durante importações paginadas e importações delta.</span><span class="sxs-lookup"><span data-stu-id="72eb3-347">Holds the watermark (CustomData) that can be used during paged imports and delta imports.</span></span> |
| <span data-ttu-id="72eb3-348">OpenImportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="72eb3-348">OpenImportConnectionRunStep</span></span> |<span data-ttu-id="72eb3-349">[OpenImportConnectionRunStep][oicrs]</span><span class="sxs-lookup"><span data-stu-id="72eb3-349">[OpenImportConnectionRunStep][oicrs]</span></span> |<span data-ttu-id="72eb3-350">Informa o script sobre o tipo de execução de importação (delta ou completa), partição, hierarquia, marca d'água e tamanho esperado da página.</span><span class="sxs-lookup"><span data-stu-id="72eb3-350">Informs the script about the type of import run (delta or full), partition, hierarchy, watermark, and expected page size.</span></span> |
| <span data-ttu-id="72eb3-351">Tipos</span><span class="sxs-lookup"><span data-stu-id="72eb3-351">Types</span></span> |<span data-ttu-id="72eb3-352">[Schema][schema]</span><span class="sxs-lookup"><span data-stu-id="72eb3-352">[Schema][schema]</span></span> |<span data-ttu-id="72eb3-353">Esquema para o espaço do conector que é importado.</span><span class="sxs-lookup"><span data-stu-id="72eb3-353">Schema for the connector space that is imported.</span></span> |

<span data-ttu-id="72eb3-354">O script de importação de dados deve gravar um objeto List[[CSEntryChange][csec]] no pipeline.</span><span class="sxs-lookup"><span data-stu-id="72eb3-354">The import data script must write a List[[CSEntryChange][csec]] object to the pipeline.</span></span> <span data-ttu-id="72eb3-355">Essa coleção é composta por atributos CSEntryChange que representam cada objeto que está sendo importado.</span><span class="sxs-lookup"><span data-stu-id="72eb3-355">This collection is composed of CSEntryChange attributes that represent each object being imported.</span></span> <span data-ttu-id="72eb3-356">Durante uma importação completa, essa coleção deve ter um conjunto completo de objetos CSEntryChange que tenham todos os atributos para cada objeto.</span><span class="sxs-lookup"><span data-stu-id="72eb3-356">During a Full Import run, this collection should have a full set of CSEntryChange objects that have all attributes for every object.</span></span> <span data-ttu-id="72eb3-357">Durante uma importação delta, o objeto CSEntryChange deve conter os deltas de nível de atributo para cada objeto a ser importado ou uma representação completa dos objetos que foram alterados (modo Substituir).</span><span class="sxs-lookup"><span data-stu-id="72eb3-357">During a Delta Import, the CSEntryChange object should either contain the attribute level deltas for each object to import, or a complete representation of the objects that have changed (Replace mode).</span></span>

<span data-ttu-id="72eb3-358">**Encerrar Importação**</span><span class="sxs-lookup"><span data-stu-id="72eb3-358">**End Import**</span></span>  
<span data-ttu-id="72eb3-359">Na conclusão da execução da importação, o script Encerrar Importação é executado.</span><span class="sxs-lookup"><span data-stu-id="72eb3-359">At the conclusion of the import run, the End Import script is run.</span></span> <span data-ttu-id="72eb3-360">Esse script deve executar as tarefas de limpeza necessárias (por exemplo, fechar conexões a sistemas e responder a falhas).</span><span class="sxs-lookup"><span data-stu-id="72eb3-360">This script should perform any cleanup tasks necessary (for example, close connections to systems and respond to failures).</span></span>

<span data-ttu-id="72eb3-361">O script de finalização de importação recebe os seguintes parâmetros do conector:</span><span class="sxs-lookup"><span data-stu-id="72eb3-361">The end import script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="72eb3-362">Nome</span><span class="sxs-lookup"><span data-stu-id="72eb3-362">Name</span></span> | <span data-ttu-id="72eb3-363">Tipo de Dados</span><span class="sxs-lookup"><span data-stu-id="72eb3-363">Data Type</span></span> | <span data-ttu-id="72eb3-364">Descrição</span><span class="sxs-lookup"><span data-stu-id="72eb3-364">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="72eb3-365">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="72eb3-365">ConfigParameters</span></span> |<span data-ttu-id="72eb3-366">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="72eb3-366">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="72eb3-367">Tabela de parâmetros de configuração para o conector.</span><span class="sxs-lookup"><span data-stu-id="72eb3-367">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="72eb3-368">Credencial</span><span class="sxs-lookup"><span data-stu-id="72eb3-368">Credential</span></span> |<span data-ttu-id="72eb3-369">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="72eb3-369">[PSCredential][pscred]</span></span> |<span data-ttu-id="72eb3-370">Contém as credenciais inseridas pelo administrador na guia Conectividade.</span><span class="sxs-lookup"><span data-stu-id="72eb3-370">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |
| <span data-ttu-id="72eb3-371">OpenImportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="72eb3-371">OpenImportConnectionRunStep</span></span> |<span data-ttu-id="72eb3-372">[OpenImportConnectionRunStep][oicrs]</span><span class="sxs-lookup"><span data-stu-id="72eb3-372">[OpenImportConnectionRunStep][oicrs]</span></span> |<span data-ttu-id="72eb3-373">Informa o script sobre o tipo de execução de importação (delta ou completa), partição, hierarquia, marca d'água e tamanho esperado da página.</span><span class="sxs-lookup"><span data-stu-id="72eb3-373">Informs the script about the type of import run (delta or full), partition, hierarchy, watermark, and expected page size.</span></span> |
| <span data-ttu-id="72eb3-374">CloseImportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="72eb3-374">CloseImportConnectionRunStep</span></span> |<span data-ttu-id="72eb3-375">[CloseImportConnectionRunStep][cecrs]</span><span class="sxs-lookup"><span data-stu-id="72eb3-375">[CloseImportConnectionRunStep][cecrs]</span></span> |<span data-ttu-id="72eb3-376">Informa o script sobre o motivo da finalização da importação.</span><span class="sxs-lookup"><span data-stu-id="72eb3-376">Informs the script about the reason the import was ended.</span></span> |

<span data-ttu-id="72eb3-377">O script deve retornar um único objeto [CloseImportConnectionResults][cicres] para o pipeline, por exemplo: `Write-Output (New-Object Microsoft.MetadirectoryServices.CloseImportConnectionResults)`</span><span class="sxs-lookup"><span data-stu-id="72eb3-377">The script must return a single [CloseImportConnectionResults][cicres] object to the pipeline, for example: `Write-Output (New-Object Microsoft.MetadirectoryServices.CloseImportConnectionResults)`</span></span>

#### <a name="export"></a><span data-ttu-id="72eb3-378">Exportação</span><span class="sxs-lookup"><span data-stu-id="72eb3-378">Export</span></span>
<span data-ttu-id="72eb3-379">Assim como a arquitetura de importação do conector, os conectores que oferecem suporte à exportação devem implementar três scripts.</span><span class="sxs-lookup"><span data-stu-id="72eb3-379">Identical to the import architecture of the connector, connectors that support Export must implement three scripts.</span></span>

<span data-ttu-id="72eb3-380">**Iniciar Importação**</span><span class="sxs-lookup"><span data-stu-id="72eb3-380">**Begin Export**</span></span>  
<span data-ttu-id="72eb3-381">O script de início de exportação é executado no começo de uma etapa de execução de exportação.</span><span class="sxs-lookup"><span data-stu-id="72eb3-381">The begin export script is run at the beginning of an export run step.</span></span> <span data-ttu-id="72eb3-382">Durante esta etapa, você pode estabelecer uma conexão com o sistema de origem e realizar todas as etapas preparatórias antes de exportar dados para o sistema conectado.</span><span class="sxs-lookup"><span data-stu-id="72eb3-382">During this step, you can establish a connection to the source system and conduct any preparatory steps before exporting data to the connected system.</span></span>

<span data-ttu-id="72eb3-383">O script de início de exportação recebe os seguintes parâmetros do conector:</span><span class="sxs-lookup"><span data-stu-id="72eb3-383">The begin export script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="72eb3-384">Nome</span><span class="sxs-lookup"><span data-stu-id="72eb3-384">Name</span></span> | <span data-ttu-id="72eb3-385">Tipo de Dados</span><span class="sxs-lookup"><span data-stu-id="72eb3-385">Data Type</span></span> | <span data-ttu-id="72eb3-386">Descrição</span><span class="sxs-lookup"><span data-stu-id="72eb3-386">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="72eb3-387">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="72eb3-387">ConfigParameters</span></span> |<span data-ttu-id="72eb3-388">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="72eb3-388">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="72eb3-389">Tabela de parâmetros de configuração para o conector.</span><span class="sxs-lookup"><span data-stu-id="72eb3-389">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="72eb3-390">Credencial</span><span class="sxs-lookup"><span data-stu-id="72eb3-390">Credential</span></span> |<span data-ttu-id="72eb3-391">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="72eb3-391">[PSCredential][pscred]</span></span> |<span data-ttu-id="72eb3-392">Contém as credenciais inseridas pelo administrador na guia Conectividade.</span><span class="sxs-lookup"><span data-stu-id="72eb3-392">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |
| <span data-ttu-id="72eb3-393">OpenExportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="72eb3-393">OpenExportConnectionRunStep</span></span> |<span data-ttu-id="72eb3-394">[OpenExportConnectionRunStep][oecrs]</span><span class="sxs-lookup"><span data-stu-id="72eb3-394">[OpenExportConnectionRunStep][oecrs]</span></span> |<span data-ttu-id="72eb3-395">Informa o script sobre o tipo de execução de exportação (delta ou completa), partição, hierarquia e tamanho esperado da página.</span><span class="sxs-lookup"><span data-stu-id="72eb3-395">Informs the script about the type of export run (delta or full), partition, hierarchy, and expected page size.</span></span> |
| <span data-ttu-id="72eb3-396">Tipos</span><span class="sxs-lookup"><span data-stu-id="72eb3-396">Types</span></span> |<span data-ttu-id="72eb3-397">[Schema][schema]</span><span class="sxs-lookup"><span data-stu-id="72eb3-397">[Schema][schema]</span></span> |<span data-ttu-id="72eb3-398">Esquema para o espaço do conector é exportado.</span><span class="sxs-lookup"><span data-stu-id="72eb3-398">Schema for the connector space that is exported.</span></span> |

<span data-ttu-id="72eb3-399">O script não deve retornar saídas para o pipeline.</span><span class="sxs-lookup"><span data-stu-id="72eb3-399">The script should not return any output to the pipeline.</span></span>

<span data-ttu-id="72eb3-400">**Exportar Dados**</span><span class="sxs-lookup"><span data-stu-id="72eb3-400">**Export Data**</span></span>  
<span data-ttu-id="72eb3-401">O Serviço de Sincronização chama o script Exportar Dados quantas vezes forem necessárias para processar todas as exportações pendentes.</span><span class="sxs-lookup"><span data-stu-id="72eb3-401">The Synchronization Service calls the Export Data script as many times as is necessary to process all pending exports.</span></span> <span data-ttu-id="72eb3-402">Se o espaço do conector tiver mais exportações pendentes do que o tamanho de página do conector, o script de exportação de dados poderá ser chamado várias vezes e, possivelmente, várias vezes para o mesmo objeto.</span><span class="sxs-lookup"><span data-stu-id="72eb3-402">If the connector space has more pending exports than the connector’s page size, the export data script may be called multiple times and possibly multiple times for the same object.</span></span>

<span data-ttu-id="72eb3-403">O script de exportação de dados recebe os seguintes parâmetros do conector:</span><span class="sxs-lookup"><span data-stu-id="72eb3-403">The export data script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="72eb3-404">Nome</span><span class="sxs-lookup"><span data-stu-id="72eb3-404">Name</span></span> | <span data-ttu-id="72eb3-405">Tipo de Dados</span><span class="sxs-lookup"><span data-stu-id="72eb3-405">Data Type</span></span> | <span data-ttu-id="72eb3-406">Descrição</span><span class="sxs-lookup"><span data-stu-id="72eb3-406">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="72eb3-407">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="72eb3-407">ConfigParameters</span></span> |<span data-ttu-id="72eb3-408">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="72eb3-408">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="72eb3-409">Tabela de parâmetros de configuração para o conector.</span><span class="sxs-lookup"><span data-stu-id="72eb3-409">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="72eb3-410">Credencial</span><span class="sxs-lookup"><span data-stu-id="72eb3-410">Credential</span></span> |<span data-ttu-id="72eb3-411">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="72eb3-411">[PSCredential][pscred]</span></span> |<span data-ttu-id="72eb3-412">Contém as credenciais inseridas pelo administrador na guia Conectividade.</span><span class="sxs-lookup"><span data-stu-id="72eb3-412">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |
| <span data-ttu-id="72eb3-413">CSEntries</span><span class="sxs-lookup"><span data-stu-id="72eb3-413">CSEntries</span></span> |<span data-ttu-id="72eb3-414">IList[CSEntryChange][csec]</span><span class="sxs-lookup"><span data-stu-id="72eb3-414">IList[CSEntryChange][csec]</span></span> |<span data-ttu-id="72eb3-415">Lista de todos os objetos do espaço do conector com exportações pendentes a serem processadas durante essa etapa.</span><span class="sxs-lookup"><span data-stu-id="72eb3-415">List of all the connector space objects with pending exports to be processed during this pass.</span></span> |
| <span data-ttu-id="72eb3-416">OpenExportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="72eb3-416">OpenExportConnectionRunStep</span></span> |<span data-ttu-id="72eb3-417">[OpenExportConnectionRunStep][oecrs]</span><span class="sxs-lookup"><span data-stu-id="72eb3-417">[OpenExportConnectionRunStep][oecrs]</span></span> |<span data-ttu-id="72eb3-418">Informa o script sobre o tipo de execução de exportação (delta ou completa), partição, hierarquia e tamanho esperado da página.</span><span class="sxs-lookup"><span data-stu-id="72eb3-418">Informs the script about the type of export run (delta or full), partition, hierarchy, and expected page size.</span></span> |
| <span data-ttu-id="72eb3-419">Tipos</span><span class="sxs-lookup"><span data-stu-id="72eb3-419">Types</span></span> |<span data-ttu-id="72eb3-420">[Schema][schema]</span><span class="sxs-lookup"><span data-stu-id="72eb3-420">[Schema][schema]</span></span> |<span data-ttu-id="72eb3-421">Esquema para o espaço do conector é exportado.</span><span class="sxs-lookup"><span data-stu-id="72eb3-421">Schema for the connector space that is exported.</span></span> |

<span data-ttu-id="72eb3-422">O script de exportação de dados deve retornar um objeto [PutExportEntriesResults][peeres] para o pipeline.</span><span class="sxs-lookup"><span data-stu-id="72eb3-422">The export data script must return a [PutExportEntriesResults][peeres] object to the pipeline.</span></span> <span data-ttu-id="72eb3-423">Esse objeto não precisa incluir informações de resultado para cada conector exportado, a menos que ocorra um erro ou uma alteração no atributo de âncora.</span><span class="sxs-lookup"><span data-stu-id="72eb3-423">This object does not need to include result information for each exported connector unless an error or a change to the anchor attribute occurs.</span></span> <span data-ttu-id="72eb3-424">Por exemplo, para retornar um objeto PutExportEntriesResults para o pipeline: `Write-Output (New-Object Microsoft.MetadirectoryServices.PutExportEntriesResults)`</span><span class="sxs-lookup"><span data-stu-id="72eb3-424">For example, to return a PutExportEntriesResults object to the pipeline: `Write-Output (New-Object Microsoft.MetadirectoryServices.PutExportEntriesResults)`</span></span>

<span data-ttu-id="72eb3-425">**Encerrar Exportação**</span><span class="sxs-lookup"><span data-stu-id="72eb3-425">**End Export**</span></span>  
<span data-ttu-id="72eb3-426">Na conclusão da execução de exportação, o script Encerrar Exportação é executado.</span><span class="sxs-lookup"><span data-stu-id="72eb3-426">At the conclusion of the export run, the End Export script to run.</span></span> <span data-ttu-id="72eb3-427">Esse script deve executar as tarefas de limpeza necessárias (por exemplo, fechar conexões a sistemas e responder a falhas).</span><span class="sxs-lookup"><span data-stu-id="72eb3-427">This script should perform any cleanup tasks necessary (for example, close connections to systems and respond to failures).</span></span>

<span data-ttu-id="72eb3-428">O script de finalização de exportação recebe os seguintes parâmetros do conector:</span><span class="sxs-lookup"><span data-stu-id="72eb3-428">The end export script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="72eb3-429">Nome</span><span class="sxs-lookup"><span data-stu-id="72eb3-429">Name</span></span> | <span data-ttu-id="72eb3-430">Tipo de Dados</span><span class="sxs-lookup"><span data-stu-id="72eb3-430">Data Type</span></span> | <span data-ttu-id="72eb3-431">Descrição</span><span class="sxs-lookup"><span data-stu-id="72eb3-431">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="72eb3-432">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="72eb3-432">ConfigParameters</span></span> |<span data-ttu-id="72eb3-433">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="72eb3-433">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="72eb3-434">Tabela de parâmetros de configuração para o conector.</span><span class="sxs-lookup"><span data-stu-id="72eb3-434">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="72eb3-435">Credencial</span><span class="sxs-lookup"><span data-stu-id="72eb3-435">Credential</span></span> |<span data-ttu-id="72eb3-436">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="72eb3-436">[PSCredential][pscred]</span></span> |<span data-ttu-id="72eb3-437">Contém as credenciais inseridas pelo administrador na guia Conectividade.</span><span class="sxs-lookup"><span data-stu-id="72eb3-437">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |
| <span data-ttu-id="72eb3-438">OpenExportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="72eb3-438">OpenExportConnectionRunStep</span></span> |<span data-ttu-id="72eb3-439">[OpenExportConnectionRunStep][oecrs]</span><span class="sxs-lookup"><span data-stu-id="72eb3-439">[OpenExportConnectionRunStep][oecrs]</span></span> |<span data-ttu-id="72eb3-440">Informa o script sobre o tipo de execução de exportação (delta ou completa), partição, hierarquia e tamanho esperado da página.</span><span class="sxs-lookup"><span data-stu-id="72eb3-440">Informs the script about the type of export run (delta or full), partition, hierarchy, and expected page size.</span></span> |
| <span data-ttu-id="72eb3-441">CloseExportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="72eb3-441">CloseExportConnectionRunStep</span></span> |<span data-ttu-id="72eb3-442">[CloseExportConnectionRunStep][cecrs]</span><span class="sxs-lookup"><span data-stu-id="72eb3-442">[CloseExportConnectionRunStep][cecrs]</span></span> |<span data-ttu-id="72eb3-443">Informa o script sobre o motivo da finalização da exportação.</span><span class="sxs-lookup"><span data-stu-id="72eb3-443">Informs the script about the reason the export was ended.</span></span> |

<span data-ttu-id="72eb3-444">O script não deve retornar saídas para o pipeline.</span><span class="sxs-lookup"><span data-stu-id="72eb3-444">The script should not return any output to the pipeline.</span></span>

#### <a name="password-synchronization"></a><span data-ttu-id="72eb3-445">Sincronização de senha</span><span class="sxs-lookup"><span data-stu-id="72eb3-445">Password Synchronization</span></span>
<span data-ttu-id="72eb3-446">Os conectores do Windows PowerShell podem ser usados como um destino para alterações/redefinições de senha.</span><span class="sxs-lookup"><span data-stu-id="72eb3-446">Windows PowerShell connectors can be used as a target for password changes/resets.</span></span>

<span data-ttu-id="72eb3-447">O script de senha recebe os seguintes parâmetros do conector:</span><span class="sxs-lookup"><span data-stu-id="72eb3-447">The password script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="72eb3-448">Nome</span><span class="sxs-lookup"><span data-stu-id="72eb3-448">Name</span></span> | <span data-ttu-id="72eb3-449">Tipo de Dados</span><span class="sxs-lookup"><span data-stu-id="72eb3-449">Data Type</span></span> | <span data-ttu-id="72eb3-450">Descrição</span><span class="sxs-lookup"><span data-stu-id="72eb3-450">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="72eb3-451">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="72eb3-451">ConfigParameters</span></span> |<span data-ttu-id="72eb3-452">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="72eb3-452">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="72eb3-453">Tabela de parâmetros de configuração para o conector.</span><span class="sxs-lookup"><span data-stu-id="72eb3-453">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="72eb3-454">Credencial</span><span class="sxs-lookup"><span data-stu-id="72eb3-454">Credential</span></span> |<span data-ttu-id="72eb3-455">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="72eb3-455">[PSCredential][pscred]</span></span> |<span data-ttu-id="72eb3-456">Contém as credenciais inseridas pelo administrador na guia Conectividade.</span><span class="sxs-lookup"><span data-stu-id="72eb3-456">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |
| <span data-ttu-id="72eb3-457">Partition</span><span class="sxs-lookup"><span data-stu-id="72eb3-457">Partition</span></span> |<span data-ttu-id="72eb3-458">[Partição][part]</span><span class="sxs-lookup"><span data-stu-id="72eb3-458">[Partition][part]</span></span> |<span data-ttu-id="72eb3-459">Partição de diretório em que CSEntry está.</span><span class="sxs-lookup"><span data-stu-id="72eb3-459">Directory partition that the CSEntry is in.</span></span> |
| <span data-ttu-id="72eb3-460">CSEntry</span><span class="sxs-lookup"><span data-stu-id="72eb3-460">CSEntry</span></span> |<span data-ttu-id="72eb3-461">[CSEntry][cse]</span><span class="sxs-lookup"><span data-stu-id="72eb3-461">[CSEntry][cse]</span></span> |<span data-ttu-id="72eb3-462">Entrada do espaço do conector para o objeto que recebeu uma alteração ou redefinição de senha.</span><span class="sxs-lookup"><span data-stu-id="72eb3-462">Connector space entry for the object that is received a password change or reset.</span></span> |
| <span data-ttu-id="72eb3-463">OperationType</span><span class="sxs-lookup"><span data-stu-id="72eb3-463">OperationType</span></span> |<span data-ttu-id="72eb3-464">Cadeia de caracteres</span><span class="sxs-lookup"><span data-stu-id="72eb3-464">String</span></span> |<span data-ttu-id="72eb3-465">Indica se a operação é uma redefinição (**SetPassword**) ou uma alteração (**ChangePassword**).</span><span class="sxs-lookup"><span data-stu-id="72eb3-465">Indicates if the operation is a reset (**SetPassword**) or a change (**ChangePassword**).</span></span> |
| <span data-ttu-id="72eb3-466">PasswordOptions</span><span class="sxs-lookup"><span data-stu-id="72eb3-466">PasswordOptions</span></span> |<span data-ttu-id="72eb3-467">[PasswordOptions][pwdopt]</span><span class="sxs-lookup"><span data-stu-id="72eb3-467">[PasswordOptions][pwdopt]</span></span> |<span data-ttu-id="72eb3-468">Sinalizadores que especificam o comportamento de redefinição de senha pretendido.</span><span class="sxs-lookup"><span data-stu-id="72eb3-468">Flags that specify the intended password reset behavior.</span></span> <span data-ttu-id="72eb3-469">Esse parâmetro estará disponível somente se OperationType for **SetPassword**.</span><span class="sxs-lookup"><span data-stu-id="72eb3-469">This parameter is only available if OperationType is **SetPassword**.</span></span> |
| <span data-ttu-id="72eb3-470">OldPassword</span><span class="sxs-lookup"><span data-stu-id="72eb3-470">OldPassword</span></span> |<span data-ttu-id="72eb3-471">Cadeia de caracteres</span><span class="sxs-lookup"><span data-stu-id="72eb3-471">String</span></span> |<span data-ttu-id="72eb3-472">Populado com a senha antiga do objeto para alterações de senha.</span><span class="sxs-lookup"><span data-stu-id="72eb3-472">Populated with the object’s old password for password changes.</span></span> <span data-ttu-id="72eb3-473">Esse parâmetro estará disponível somente se OperationType for **ChangePassword**.</span><span class="sxs-lookup"><span data-stu-id="72eb3-473">This parameter is only available if OperationType is **ChangePassword**.</span></span> |
| <span data-ttu-id="72eb3-474">NewPassword</span><span class="sxs-lookup"><span data-stu-id="72eb3-474">NewPassword</span></span> |<span data-ttu-id="72eb3-475">Cadeia de caracteres</span><span class="sxs-lookup"><span data-stu-id="72eb3-475">String</span></span> |<span data-ttu-id="72eb3-476">Populado com a nova senha do objeto que o script deve definir.</span><span class="sxs-lookup"><span data-stu-id="72eb3-476">Populated with the object’s new password that the script should set.</span></span> |

<span data-ttu-id="72eb3-477">Não é comum que o script de senha retorne algum resultado para o pipeline do Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="72eb3-477">The password script is not expected to return any results to the Windows PowerShell pipeline.</span></span> <span data-ttu-id="72eb3-478">Se ocorrer um erro no script de senha, o script deverá lançar uma das seguintes exceções para informar o Serviço de Sincronização sobre o problema:</span><span class="sxs-lookup"><span data-stu-id="72eb3-478">If an error occurs in the password script, the script should throw one of the following exceptions to inform the Synchronization Service about the problem:</span></span>

* <span data-ttu-id="72eb3-479">[PasswordPolicyViolationException][pwdex1] – lançada se a senha não atender à política de senha no sistema conectado.</span><span class="sxs-lookup"><span data-stu-id="72eb3-479">[PasswordPolicyViolationException][pwdex1] – Thrown if the password does not meet the password policy in the connected system.</span></span>
* <span data-ttu-id="72eb3-480">[PasswordIllFormedException][pwdex2] – lançada se a senha não for aceitável para o sistema conectado.</span><span class="sxs-lookup"><span data-stu-id="72eb3-480">[PasswordIllFormedException][pwdex2] – Thrown if the password is not acceptable for the connected system.</span></span>
* <span data-ttu-id="72eb3-481">[PasswordExtension][pwdex3] – lançada para todos os outros erros no script de senha.</span><span class="sxs-lookup"><span data-stu-id="72eb3-481">[PasswordExtension][pwdex3] – Thrown for all other errors in the password script.</span></span>

## <a name="sample-connectors"></a><span data-ttu-id="72eb3-482">Conectores de exemplo</span><span class="sxs-lookup"><span data-stu-id="72eb3-482">Sample Connectors</span></span>
<span data-ttu-id="72eb3-483">Para obter uma visão geral completa dos conectores de exemplo disponíveis, confira [Windows PowerShell Connector Sample Connector Collection][samp].</span><span class="sxs-lookup"><span data-stu-id="72eb3-483">For a complete overview of the available sample connectors, see [Windows PowerShell Connector Sample Connector Collection][samp].</span></span>

## <a name="other-notes"></a><span data-ttu-id="72eb3-484">Outras observações</span><span class="sxs-lookup"><span data-stu-id="72eb3-484">Other notes</span></span>
### <a name="additional-configuration-for-impersonation"></a><span data-ttu-id="72eb3-485">Configuração adicional para representação</span><span class="sxs-lookup"><span data-stu-id="72eb3-485">Additional Configuration for Impersonation</span></span>
<span data-ttu-id="72eb3-486">Conceda ao usuário que é representado as seguintes permissões no servidor do Serviço de Sincronização:</span><span class="sxs-lookup"><span data-stu-id="72eb3-486">Grant the user that is impersonated the following permissions on the Synchronization Service server:</span></span>

<span data-ttu-id="72eb3-487">Acesso de leitura para as seguintes chaves do registro:</span><span class="sxs-lookup"><span data-stu-id="72eb3-487">Read access to the following registry keys:</span></span>

* <span data-ttu-id="72eb3-488">HKEY_USERS\\[SynchronizationServiceServiceAccountSID]\Software\Microsoft\PowerShell</span><span class="sxs-lookup"><span data-stu-id="72eb3-488">HKEY_USERS\\[SynchronizationServiceServiceAccountSID]\Software\Microsoft\PowerShell</span></span>
* <span data-ttu-id="72eb3-489">HKEY_USERS\\[SynchronizationServiceServiceAccountSID]\Environment</span><span class="sxs-lookup"><span data-stu-id="72eb3-489">HKEY_USERS\\[SynchronizationServiceServiceAccountSID]\Environment</span></span>

<span data-ttu-id="72eb3-490">Para determinar o SID (Identificador de Segurança) da conta de serviço do Serviço de Sincronização, execute os seguintes comandos do PowerShell:</span><span class="sxs-lookup"><span data-stu-id="72eb3-490">To determine the Security Identifier (SID) of the Synchronization Service service account, run the following PowerShell commands:</span></span>

```
$account = New-Object System.Security.Principal.NTAccount "<domain>\<username>"
$account.Translate([System.Security.Principal.SecurityIdentifier]).Value
```

<span data-ttu-id="72eb3-491">Acesso de leitura para as seguintes pastas do sistema de arquivos:</span><span class="sxs-lookup"><span data-stu-id="72eb3-491">Read access to the following file system folders:</span></span>

* <span data-ttu-id="72eb3-492">%ProgramFiles%\Microsoft Forefront Identity Manager\2010\Synchronization Service\Extensions</span><span class="sxs-lookup"><span data-stu-id="72eb3-492">%ProgramFiles%\Microsoft Forefront Identity Manager\2010\Synchronization Service\Extensions</span></span>
* <span data-ttu-id="72eb3-493">%ProgramFiles%\Microsoft Forefront Identity Manager\2010\Synchronization Service\ExtensionsCache</span><span class="sxs-lookup"><span data-stu-id="72eb3-493">%ProgramFiles%\Microsoft Forefront Identity Manager\2010\Synchronization Service\ExtensionsCache</span></span>
* <span data-ttu-id="72eb3-494">%ProgramFiles%\Microsoft Forefront Identity Manager\2010\Synchronization Service\MaData\\{ConnectorName}</span><span class="sxs-lookup"><span data-stu-id="72eb3-494">%ProgramFiles%\Microsoft Forefront Identity Manager\2010\Synchronization Service\MaData\\{ConnectorName}</span></span>

<span data-ttu-id="72eb3-495">Substitua o nome do conector Windows PowerShell para o espaço reservado {ConnectorName}.</span><span class="sxs-lookup"><span data-stu-id="72eb3-495">Substitute the name of the Windows PowerShell connector for the {ConnectorName} placeholder.</span></span>

## <a name="troubleshooting"></a><span data-ttu-id="72eb3-496">Solucionar problemas</span><span class="sxs-lookup"><span data-stu-id="72eb3-496">Troubleshooting</span></span>
* <span data-ttu-id="72eb3-497">Para saber mais sobre como habilitar o registro em log para solucionar problemas do conector, confira [How to Enable ETW Tracing for Connectors](http://go.microsoft.com/fwlink/?LinkId=335731).</span><span class="sxs-lookup"><span data-stu-id="72eb3-497">For information on how to enable logging to troubleshoot the connector, see the [How to Enable ETW Tracing for Connectors](http://go.microsoft.com/fwlink/?LinkId=335731).</span></span>

<!--Reference style links - using these makes the source content way more readable than using inline links-->
[cpp]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.configparameterpage.aspx
[keyk]: https://msdn.microsoft.com/library/ms132438.aspx
[cp]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.configparameter.aspx
[pscred]: https://msdn.microsoft.com/library/system.management.automation.pscredential.aspx
[schema]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.schema.aspx
[schemaT]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.schematype.aspx
[schemaA]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.schemaattribute.aspx
[dnstyle]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.madistinguishednamestyle.aspx
[exportT]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.maexporttype.aspx
[DataNorm]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.manormalizations.aspx
[oconf]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.maobjectconfirmation.aspx
[dw]: https://msdn.microsoft.com/library/windows/desktop/aa378184.aspx
[part]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.partition.aspx
[hn]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.hierarchynode.aspx
[oicrs]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.openimportconnectionrunstep.aspx
[cecrs]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.closeexportconnectionrunstep.aspx
[oicres]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.openimportconnectionresults.aspx
[cecrs]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.closeexportconnectionrunstep.aspx
[cicres]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.closeimportconnectionresults.aspx
[oecrs]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.openexportconnectionrunstep.aspx
[irs]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.importrunstep.aspx
[cse]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.csentry.aspx
[csec]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.csentrychange.aspx
[peeres]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.putexportentriesresults.aspx
[pwdopt]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.passwordoptions.aspx
[pwdex1]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.passwordpolicyviolationexception.aspx
[pwdex2]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.passwordillformedexception.aspx
[pwdex3]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.passwordextensionexception.aspx
[samp]: http://go.microsoft.com/fwlink/?LinkId=394291
