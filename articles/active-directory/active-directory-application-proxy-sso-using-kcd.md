---
title: aaaSingle logon com o Proxy de aplicativo | Microsoft Docs
description: "Aborda como tooprovide o logon único usando o Proxy de aplicativo do Azure AD."
services: active-directory
documentationcenter: 
author: kgremban
manager: femila
ms.assetid: ded0d9c9-45f6-47d7-bd0f-3f7fd99ab621
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/25/2017
ms.author: kgremban
ms.reviewer: harshja
ms.custom: H1Hack27Feb2017, it-pro
ms.openlocfilehash: 0047e834cd42e057a75ebc0c5dcf860734464a05
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="kerberos-constrained-delegation-for-single-sign-on-tooyour-apps-with-application-proxy"></a><span data-ttu-id="98545-103">Delegação restrita de Kerberos para aplicativos tooyour de logon único com o Proxy de aplicativo</span><span class="sxs-lookup"><span data-stu-id="98545-103">Kerberos Constrained Delegation for single sign-on tooyour apps with Application Proxy</span></span>

<span data-ttu-id="98545-104">Você pode fornecer o logon único para aplicativos locais, publicados por meio do Proxy do Aplicativo, que sejam protegidos com a Autenticação Integrada do Windows.</span><span class="sxs-lookup"><span data-stu-id="98545-104">You can provide single sign-on for on-premises applications published through Application Proxy that are secured with Integrated Windows Authentication.</span></span> <span data-ttu-id="98545-105">Esses aplicativos exigem um tíquete Kerberos para acessar.</span><span class="sxs-lookup"><span data-stu-id="98545-105">These applications require a Kerberos ticket for access.</span></span> <span data-ttu-id="98545-106">Proxy de aplicativo usa a delegação restrita de Kerberos (KCD) toosupport esses aplicativos.</span><span class="sxs-lookup"><span data-stu-id="98545-106">Application Proxy uses Kerberos Constrained Delegation (KCD) toosupport these applications.</span></span> 

<span data-ttu-id="98545-107">Você pode habilitar aplicativos de tooyour de logon único usando a concessão de permissão de conectores de Proxy de aplicativo em usuários do Active Directory tooimpersonate Windows IWA (autenticação integrada).</span><span class="sxs-lookup"><span data-stu-id="98545-107">You can enable single sign-on tooyour applications using Integrated Windows Authentication (IWA) by giving Application Proxy connectors permission in Active Directory tooimpersonate users.</span></span> <span data-ttu-id="98545-108">conectores de saudação usam toosend essa permissão e recebem tokens em seu nome.</span><span class="sxs-lookup"><span data-stu-id="98545-108">hello connectors use this permission toosend and receive tokens on their behalf.</span></span>

## <a name="how-single-sign-on-with-kcd-works"></a><span data-ttu-id="98545-109">Como funciona o logon único com a KCD</span><span class="sxs-lookup"><span data-stu-id="98545-109">How single sign-on with KCD works</span></span>
<span data-ttu-id="98545-110">Esse diagrama explica o fluxo de saudação quando um usuário tenta tooaccess um aplicativo local que usa a IWA.</span><span class="sxs-lookup"><span data-stu-id="98545-110">This diagram explains hello flow when a user attempts tooaccess an on-prem application that uses IWA.</span></span>

![Diagrama de fluxo de autenticação do Microsoft AAD](./media/active-directory-application-proxy-sso-using-kcd/AuthDiagram.png)

1. <span data-ttu-id="98545-112">usuário de saudação insere aplicativo hello URL tooaccess Olá local por meio do Proxy de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="98545-112">hello user enters hello URL tooaccess hello on-prem application through Application Proxy.</span></span>
2. <span data-ttu-id="98545-113">Proxy de aplicativo redireciona Olá solicitação tooAzure AD autenticação serviços toopreauthenticate.</span><span class="sxs-lookup"><span data-stu-id="98545-113">Application Proxy redirects hello request tooAzure AD authentication services toopreauthenticate.</span></span> <span data-ttu-id="98545-114">Neste ponto, o AD do Azure se aplica a qualquer política de autenticação e autorização aplicável, tal como autenticação multifator.</span><span class="sxs-lookup"><span data-stu-id="98545-114">At this point, Azure AD applies any applicable authentication and authorization policies, such as multifactor authentication.</span></span> <span data-ttu-id="98545-115">Se Olá usuário for validado, o AD do Azure cria um token e envia toohello usuário.</span><span class="sxs-lookup"><span data-stu-id="98545-115">If hello user is validated, Azure AD creates a token and sends it toohello user.</span></span>
3. <span data-ttu-id="98545-116">usuário Olá passa Olá token tooApplication Proxy.</span><span class="sxs-lookup"><span data-stu-id="98545-116">hello user passes hello token tooApplication Proxy.</span></span>
4. <span data-ttu-id="98545-117">Proxy de aplicativo valida o token hello e recupera Olá Nome Principal do usuário (UPN) dele e, em seguida, envia Olá solicitação, Olá UPN e Olá toohello conector do nome Principal do serviço (SPN) por meio de um canal seguro duplamente autenticado.</span><span class="sxs-lookup"><span data-stu-id="98545-117">Application Proxy validates hello token and retrieves hello User Principal Name (UPN) from it, and then sends hello request, hello UPN, and hello Service Principal Name (SPN) toohello Connector through a dually authenticated secure channel.</span></span>
5. <span data-ttu-id="98545-118">Olá conector realiza a negociação de delegação restrita de Kerberos (KCD) com hello prem AD, representando Olá usuário tooget um aplicativo de toohello token Kerberos.</span><span class="sxs-lookup"><span data-stu-id="98545-118">hello Connector performs Kerberos Constrained Delegation (KCD) negotiation with hello on-prem AD, impersonating hello user tooget a Kerberos token toohello application.</span></span>
6. <span data-ttu-id="98545-119">Do Active Directory envia o token Kerberos de saudação para Olá aplicativo toohello conector.</span><span class="sxs-lookup"><span data-stu-id="98545-119">Active Directory sends hello Kerberos token for hello application toohello Connector.</span></span>
7. <span data-ttu-id="98545-120">Olá conector envia Olá solicitação toohello aplicativo servidor original, usando o token do Kerberos Olá recebido do AD.</span><span class="sxs-lookup"><span data-stu-id="98545-120">hello Connector sends hello original request toohello application server, using hello Kerberos token it received from AD.</span></span>
8. <span data-ttu-id="98545-121">aplicativo Hello envia Olá resposta toohello conector, que é retornado toohello serviço de Proxy de aplicativo e, finalmente, o usuário toohello.</span><span class="sxs-lookup"><span data-stu-id="98545-121">hello application sends hello response toohello Connector, which is then returned toohello Application Proxy service and finally toohello user.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="98545-122">Pré-requisitos</span><span class="sxs-lookup"><span data-stu-id="98545-122">Prerequisites</span></span>
<span data-ttu-id="98545-123">Antes de começar a usar o logon único para aplicativos de IWA, verifique se seu ambiente está preparado com hello definições e configurações a seguir:</span><span class="sxs-lookup"><span data-stu-id="98545-123">Before you get started with single sign-on for IWA applications, make sure your environment is ready with hello following settings and configurations:</span></span>

* <span data-ttu-id="98545-124">Seus aplicativos, como aplicativos Web do SharePoint, são definidos toouse autenticação integrada do Windows.</span><span class="sxs-lookup"><span data-stu-id="98545-124">Your apps, like SharePoint Web apps, are set toouse Integrated Windows Authentication.</span></span> <span data-ttu-id="98545-125">Para sabe rmais, veja [Habilitar suporte para autenticação Kerberos](https://technet.microsoft.com/library/dd759186.aspx), ou para o SharePoint, consulte [Planejar a autenticação Kerberos no SharePoint 2013](https://technet.microsoft.com/library/ee806870.aspx).</span><span class="sxs-lookup"><span data-stu-id="98545-125">For more information, see [Enable Support for Kerberos Authentication](https://technet.microsoft.com/library/dd759186.aspx), or for SharePoint see [Plan for Kerberos authentication in SharePoint 2013](https://technet.microsoft.com/library/ee806870.aspx).</span></span>
* <span data-ttu-id="98545-126">Todos os seus aplicativos têm [nome da entidade de serviço](https://social.technet.microsoft.com/wiki/contents/articles/717.service-principal-names-spns-setspn-syntax-setspn-exe.aspx).</span><span class="sxs-lookup"><span data-stu-id="98545-126">All your apps have [Service Principal Names](https://social.technet.microsoft.com/wiki/contents/articles/717.service-principal-names-spns-setspn-syntax-setspn-exe.aspx).</span></span>
* <span data-ttu-id="98545-127">saudação em execução do servidor de saudação conector e o servidor de saudação executando o aplicativo hello estão associados ao domínio e a parte da saudação mesmo domínio ou em domínios confiáveis.</span><span class="sxs-lookup"><span data-stu-id="98545-127">hello server running hello Connector and hello server running hello app are domain joined and part of hello same domain or trusting domains.</span></span> <span data-ttu-id="98545-128">Para obter mais informações sobre associação de domínio, consulte [ingressar em um domínio de tooa do computador](https://technet.microsoft.com/library/dd807102.aspx).</span><span class="sxs-lookup"><span data-stu-id="98545-128">For more information on domain join, see [Join a Computer tooa Domain](https://technet.microsoft.com/library/dd807102.aspx).</span></span>
* <span data-ttu-id="98545-129">servidor de saudação executando Olá conector tem atributo TokenGroupsGlobalAndUniversal do acesso tooread Olá para usuários.</span><span class="sxs-lookup"><span data-stu-id="98545-129">hello server running hello Connector has access tooread hello TokenGroupsGlobalAndUniversal attribute for users.</span></span> <span data-ttu-id="98545-130">Essa configuração padrão pode foi afetada por ambiente Olá de proteção de segurança.</span><span class="sxs-lookup"><span data-stu-id="98545-130">This default setting might have been impacted by security hardening hello environment.</span></span>

### <a name="configure-active-directory"></a><span data-ttu-id="98545-131">Configurar o Active Directory</span><span class="sxs-lookup"><span data-stu-id="98545-131">Configure Active Directory</span></span>
<span data-ttu-id="98545-132">configuração do Active Directory Olá varia, dependendo se o conector de Proxy de aplicativo e o servidor de aplicativo hello estão em Olá mesmo domínio ou não.</span><span class="sxs-lookup"><span data-stu-id="98545-132">hello Active Directory configuration varies, depending on whether your Application Proxy connector and hello application server are in hello same domain or not.</span></span>

#### <a name="connector-and-application-server-in-hello-same-domain"></a><span data-ttu-id="98545-133">Conector e o servidor de aplicativos no hello mesmo domínio</span><span class="sxs-lookup"><span data-stu-id="98545-133">Connector and application server in hello same domain</span></span>
1. <span data-ttu-id="98545-134">No Active Directory, vá muito**ferramentas** > **usuários e computadores**.</span><span class="sxs-lookup"><span data-stu-id="98545-134">In Active Directory, go too**Tools** > **Users and Computers**.</span></span>
2. <span data-ttu-id="98545-135">Selecione o servidor de saudação executando o conector de saudação.</span><span class="sxs-lookup"><span data-stu-id="98545-135">Select hello server running hello connector.</span></span>
3. <span data-ttu-id="98545-136">Clique com o botão direito do mouse e selecione **Propriedades** > **Delegação**.</span><span class="sxs-lookup"><span data-stu-id="98545-136">Right-click and select **Properties** > **Delegation**.</span></span>
4. <span data-ttu-id="98545-137">Selecione **confiar no computador para delegação toospecified dos serviços somente**.</span><span class="sxs-lookup"><span data-stu-id="98545-137">Select **Trust this computer for delegation toospecified services only**.</span></span> 
5. <span data-ttu-id="98545-138">Em **serviços toowhich esta conta pode apresentar credenciais delegadas** Adicionar valor Olá Olá identidade SPN saudação do servidor de aplicativos.</span><span class="sxs-lookup"><span data-stu-id="98545-138">Under **Services toowhich this account can present delegated credentials** add hello value for hello SPN identity of hello application server.</span></span> <span data-ttu-id="98545-139">Isso permite que os usuários tooimpersonate de conector de Proxy de aplicativo hello no AD contra aplicativos Olá definidos na lista de saudação.</span><span class="sxs-lookup"><span data-stu-id="98545-139">This enables hello Application Proxy Connector tooimpersonate users in AD against hello applications defined in hello list.</span></span>

   ![Captura de tela da janela Propriedades do Conector SVR](./media/active-directory-application-proxy-sso-using-kcd/Properties.jpg)

#### <a name="connector-and-application-server-in-different-domains"></a><span data-ttu-id="98545-141">O conector e o servidor de aplicativos estão em domínios diferentes</span><span class="sxs-lookup"><span data-stu-id="98545-141">Connector and application server in different domains</span></span>
1. <span data-ttu-id="98545-142">Para obter uma lista de pré-requisitos para trabalhar com o KCD entre domínios, consulte [Delegação restrita de Kerberos nos domínios](https://technet.microsoft.com/library/hh831477.aspx).</span><span class="sxs-lookup"><span data-stu-id="98545-142">For a list of prerequisites for working with KCD across domains, see [Kerberos Constrained Delegation across domains](https://technet.microsoft.com/library/hh831477.aspx).</span></span>
2. <span data-ttu-id="98545-143">Saudação de uso `principalsallowedtodelegateto` propriedade Olá conector server tooenable Olá Proxy de aplicativo toodelegate para o servidor de conector hello.</span><span class="sxs-lookup"><span data-stu-id="98545-143">Use hello `principalsallowedtodelegateto` property on hello Connector server tooenable hello Application Proxy toodelegate for hello Connector server.</span></span> <span data-ttu-id="98545-144">servidor de aplicativo Hello for `sharepointserviceaccount` e delegação de servidor de saudação é `connectormachineaccount`.</span><span class="sxs-lookup"><span data-stu-id="98545-144">hello application server is `sharepointserviceaccount` and hello delegating server is `connectormachineaccount`.</span></span> <span data-ttu-id="98545-145">Para o Windows 2012 R2, use esse código como um exemplo:</span><span class="sxs-lookup"><span data-stu-id="98545-145">For Windows 2012 R2, use this code as an example:</span></span>

        $connector= Get-ADComputer -Identity connectormachineaccount -server dc.connectordomain.com

        Set-ADComputer -Identity sharepointserviceaccount -PrincipalsAllowedToDelegateToAccount $connector

        Get-ADComputer sharepointserviceaccount -Properties PrincipalsAllowedToDelegateToAccount

<span data-ttu-id="98545-146">Sharepointserviceaccount pode ser a conta de máquina do SPS hello ou uma conta de serviço sob a qual Olá SPS pool de aplicativos está sendo executado.</span><span class="sxs-lookup"><span data-stu-id="98545-146">Sharepointserviceaccount can be hello SPS machine account or a service account under which hello SPS app pool is running.</span></span>

## <a name="configure-single-sign-on"></a><span data-ttu-id="98545-147">Configurar o logon único</span><span class="sxs-lookup"><span data-stu-id="98545-147">Configure single sign-on</span></span> 
1. <span data-ttu-id="98545-148">Publicar seu aplicativo de acordo com as instruções de toohello descritas em [publicar aplicativos com Proxy de aplicativo](application-proxy-publish-azure-portal.md).</span><span class="sxs-lookup"><span data-stu-id="98545-148">Publish your application according toohello instructions described in [Publish applications with Application Proxy](application-proxy-publish-azure-portal.md).</span></span> <span data-ttu-id="98545-149">Certifique-se de que tooselect **Active Directory do Azure** como Olá **método de pré-autenticação**.</span><span class="sxs-lookup"><span data-stu-id="98545-149">Make sure tooselect **Azure Active Directory** as hello **Preauthentication Method**.</span></span>
2. <span data-ttu-id="98545-150">Depois que o aplicativo aparece na lista de saudação de aplicativos corporativos, selecione-o e clique em **o logon único**.</span><span class="sxs-lookup"><span data-stu-id="98545-150">After your application appears in hello list of enterprise applications, select it and click **Single sign-on**.</span></span>
3. <span data-ttu-id="98545-151">Definir o modo de logon único Olá muito**autenticação integrada do Windows**.</span><span class="sxs-lookup"><span data-stu-id="98545-151">Set hello single sign-on mode too**Integrated Windows Authentication**.</span></span>  
4. <span data-ttu-id="98545-152">Digite hello **SPN do aplicativo interno** saudação do servidor de aplicativos.</span><span class="sxs-lookup"><span data-stu-id="98545-152">Enter hello **Internal Application SPN** of hello application server.</span></span> <span data-ttu-id="98545-153">Neste exemplo, a saudação SPN para nosso aplicativo publicado é http/www.contoso.com. Este toobe de necessidades SPN na lista de saudação do conector de saudação do toowhich de serviços pode apresentar credenciais delegadas.</span><span class="sxs-lookup"><span data-stu-id="98545-153">In this example, hello SPN for our published application is http/www.contoso.com. This SPN needs toobe in hello list of services toowhich hello connector can present delegated credentials.</span></span> 
5. <span data-ttu-id="98545-154">Escolha Olá **identidade de logon recebido** para Olá conector toouse em nome de seus usuários.</span><span class="sxs-lookup"><span data-stu-id="98545-154">Choose hello **Delegated Login Identity** for hello connector toouse on behalf of your users.</span></span> <span data-ttu-id="98545-155">Para obter mais informações, consulte [Trabalhando com identidades diferentes de nuvem e local](#Working-with-different-on-premises-and-cloud-identities)</span><span class="sxs-lookup"><span data-stu-id="98545-155">For more information, see [Working with different on-premises and cloud identities](#Working-with-different-on-premises-and-cloud-identities)</span></span>

   ![Configuração de Aplicativo Avançada](./media/active-directory-application-proxy-sso-using-kcd/cwap_auth2.png)  


## <a name="sso-for-non-windows-apps"></a><span data-ttu-id="98545-157">SSO para aplicativos não Windows</span><span class="sxs-lookup"><span data-stu-id="98545-157">SSO for non-Windows apps</span></span>
<span data-ttu-id="98545-158">Olá fluxo de delegação de Kerberos no Proxy de aplicativo do Azure AD inicia quando o AD do Azure autentica o usuário Olá na nuvem de saudação.</span><span class="sxs-lookup"><span data-stu-id="98545-158">hello Kerberos delegation flow in Azure AD Application Proxy starts when Azure AD authenticates hello user in hello cloud.</span></span> <span data-ttu-id="98545-159">Depois que a solicitação Olá chega no local, Olá Proxy de aplicativo do Azure AD conector emite um tíquete Kerberos em nome de usuário de saudação interagindo com hello Active Directory local.</span><span class="sxs-lookup"><span data-stu-id="98545-159">Once hello request arrives on-premises, hello Azure AD Application Proxy connector issues a Kerberos ticket on behalf of hello user by interacting with hello local Active Directory.</span></span> <span data-ttu-id="98545-160">Esse processo é chamado tooas a delegação restrita de Kerberos (KCD).</span><span class="sxs-lookup"><span data-stu-id="98545-160">This process is referred tooas Kerberos Constrained Delegation (KCD).</span></span> <span data-ttu-id="98545-161">Olá próxima fase, uma solicitação é enviada toohello aplicativo de back-end com esse tíquete Kerberos.</span><span class="sxs-lookup"><span data-stu-id="98545-161">In hello next phase, a request is sent toohello backend application with this Kerberos ticket.</span></span> <span data-ttu-id="98545-162">Há vários protocolos que definem como toosend tais solicitações.</span><span class="sxs-lookup"><span data-stu-id="98545-162">There are several protocols that define how toosend such requests.</span></span> <span data-ttu-id="98545-163">A maioria dos servidores não Windows espera Negotiate/SPNego, que agora tem suporte no Proxy de Aplicativo do AD do Azure.</span><span class="sxs-lookup"><span data-stu-id="98545-163">Most non-Windows servers expect Negotiate/SPNego that is now supported on Azure AD Application Proxy.</span></span>

<span data-ttu-id="98545-164">Para obter mais informações sobre o Kerberos, consulte [tudo o que você deseja tooknow sobre delegação de restrita de Kerberos (KCD)](https://blogs.technet.microsoft.com/applicationproxyblog/2015/09/21/all-you-want-to-know-about-kerberos-constrained-delegation-kcd).</span><span class="sxs-lookup"><span data-stu-id="98545-164">For more information about Kerberos, see [All you want tooknow about Kerberos Constrained Delegation (KCD)](https://blogs.technet.microsoft.com/applicationproxyblog/2015/09/21/all-you-want-to-know-about-kerberos-constrained-delegation-kcd).</span></span>

<span data-ttu-id="98545-165">Os aplicativos que não são do Windows normalmente utilizam nomes de usuário ou nomes de conta SAM em vez de endereços de email de domínio.</span><span class="sxs-lookup"><span data-stu-id="98545-165">Non-Windows apps typically user usernames or SAM account names instead of domain email addresses.</span></span> <span data-ttu-id="98545-166">Se essa situação se aplica a aplicativos tooyour, será necessário tooconfigure Olá delegado logon identidade campo tooconnect suas identidades de aplicativo de tooyour de identidades de nuvem.</span><span class="sxs-lookup"><span data-stu-id="98545-166">If that situation applies tooyour applications, you need tooconfigure hello delegated login identity field tooconnect your cloud identities tooyour application identities.</span></span> 

## <a name="working-with-different-on-premises-and-cloud-identities"></a><span data-ttu-id="98545-167">Trabalhando com identidades diferentes de nuvem e local</span><span class="sxs-lookup"><span data-stu-id="98545-167">Working with different on-premises and cloud identities</span></span>
<span data-ttu-id="98545-168">Proxy de aplicativo pressupõe que os usuários tenham exatamente Olá a mesma identidade em nuvem hello e local.</span><span class="sxs-lookup"><span data-stu-id="98545-168">Application Proxy assumes that users have exactly hello same identity in hello cloud and on-premises.</span></span> <span data-ttu-id="98545-169">Se não for o caso de Olá, você pode ainda poderá usar KCD para logon único.</span><span class="sxs-lookup"><span data-stu-id="98545-169">If that's not hello case, you can can still use KCD for single sign-on.</span></span> <span data-ttu-id="98545-170">Configurar um **delegada a identidade de logon** para cada toospecify aplicativo qual identidade deve ser usada ao executar o logon único.</span><span class="sxs-lookup"><span data-stu-id="98545-170">Configure a **Delegated login identity** for each application toospecify which identity should be used when performing single sign-on.</span></span>  

<span data-ttu-id="98545-171">Esse recurso permite que muitas empresas que têm diferentes locais e na nuvem identidades toohave SSO de saudação nuvem local tooon aplicativos sem a necessidade de saudação usuários tooenter diferentes nomes de usuário e senhas.</span><span class="sxs-lookup"><span data-stu-id="98545-171">This capability allows many organizations that have different on-premises and cloud identities toohave SSO from hello cloud tooon-premises apps without requiring hello users tooenter different usernames and passwords.</span></span> <span data-ttu-id="98545-172">Isso inclui as organizações que:</span><span class="sxs-lookup"><span data-stu-id="98545-172">This includes organizations that:</span></span>

* <span data-ttu-id="98545-173">Têm vários domínios internamente (joe@us.contoso.com, joe@eu.contoso.com) e um domínio único na nuvem hello (joe@contoso.com).</span><span class="sxs-lookup"><span data-stu-id="98545-173">Have multiple domains internally (joe@us.contoso.com, joe@eu.contoso.com) and a single domain in hello cloud (joe@contoso.com).</span></span>
* <span data-ttu-id="98545-174">Tem o nome de domínio não roteáveis internamente (joe@contoso.usa) e um válido na nuvem hello.</span><span class="sxs-lookup"><span data-stu-id="98545-174">Have non-routable domain name internally (joe@contoso.usa) and a legal one in hello cloud.</span></span>
* <span data-ttu-id="98545-175">Não usem nomes de domínio internamente (joe)</span><span class="sxs-lookup"><span data-stu-id="98545-175">Do not use domain names internally (joe)</span></span>
* <span data-ttu-id="98545-176">Use aliases diferentes locais e na nuvem hello.</span><span class="sxs-lookup"><span data-stu-id="98545-176">Use different aliases on-prem and in hello cloud.</span></span> <span data-ttu-id="98545-177">Por exemplo, joe-johns@contoso.com versus joej@contoso.com</span><span class="sxs-lookup"><span data-stu-id="98545-177">For example, joe-johns@contoso.com vs. joej@contoso.com</span></span>  

<span data-ttu-id="98545-178">Com o Proxy de aplicativo, você pode selecionar quais Olá de tooobtain identidade toouse tíquete Kerberos.</span><span class="sxs-lookup"><span data-stu-id="98545-178">With Application Proxy, you can select which identity toouse tooobtain hello Kerberos ticket.</span></span> <span data-ttu-id="98545-179">Essa configuração é por aplicativo.</span><span class="sxs-lookup"><span data-stu-id="98545-179">This setting is per application.</span></span> <span data-ttu-id="98545-180">Algumas dessas opções são adequadas para sistemas que não aceitam o formato de endereço de email, e outras são desenvolvidas para logon alternativo.</span><span class="sxs-lookup"><span data-stu-id="98545-180">Some of these options are suitable for systems that do not accept email address format, others are designed for alternative login.</span></span>

![Captura de tela de parâmetro de identidade de logon delegada](./media/active-directory-application-proxy-sso-using-kcd/app_proxy_sso_diff_id_upn.png)

<span data-ttu-id="98545-182">Se a identidade de logon delegado é usada, Olá valor pode não ser exclusivo em todos os domínios de saudação ou florestas em sua organização.</span><span class="sxs-lookup"><span data-stu-id="98545-182">If delegated login identity is used, hello value might not be unique across all hello domains or forests in your organization.</span></span> <span data-ttu-id="98545-183">Você pode evitar esse problema publicando esses aplicativos duas vezes com dois grupos diferentes de Conectores.</span><span class="sxs-lookup"><span data-stu-id="98545-183">You can avoid this issue by publishing these applications twice using two different Connector groups.</span></span> <span data-ttu-id="98545-184">Como cada aplicativo tem um público diferente, você pode adicionar seu domínio de diferentes tooa conectores.</span><span class="sxs-lookup"><span data-stu-id="98545-184">Since each application has a different user audience, you can join its Connectors tooa different domain.</span></span>

### <a name="configure-sso-for-different-identities"></a><span data-ttu-id="98545-185">Configurar o SSO para diferentes identidades</span><span class="sxs-lookup"><span data-stu-id="98545-185">Configure SSO for different identities</span></span>
1. <span data-ttu-id="98545-186">Defina configurações de conexão do AD do Azure para a identidade principal Olá é o endereço de email de saudação (email).</span><span class="sxs-lookup"><span data-stu-id="98545-186">Configure Azure AD Connect settings so hello main identity is hello email address (mail).</span></span> <span data-ttu-id="98545-187">Isso é feito como parte da saudação personalizar o processo, alterando Olá **Nome Principal do usuário** campo nas configurações de sincronização de saudação.</span><span class="sxs-lookup"><span data-stu-id="98545-187">This is done as part of hello customize process, by changing hello **User Principal Name** field in hello sync settings.</span></span> <span data-ttu-id="98545-188">Essas configurações também determinam como os usuários fazem logon no tooOffice365 Windows10 dispositivos e outros aplicativos que usam o Azure AD como seu repositório de identidade.</span><span class="sxs-lookup"><span data-stu-id="98545-188">These settings also determine how users log in tooOffice365, Windows10 devices, and other applications that use Azure AD as their identity store.</span></span>  
   <span data-ttu-id="98545-189">![Identificando a captura de tela de usuários - lista suspensa Nome UPN](./media/active-directory-application-proxy-sso-using-kcd/app_proxy_sso_diff_id_connect_settings.png)</span><span class="sxs-lookup"><span data-stu-id="98545-189">![Identifying users screenshot - User Principal Name dropdown](./media/active-directory-application-proxy-sso-using-kcd/app_proxy_sso_diff_id_connect_settings.png)</span></span>  
2. <span data-ttu-id="98545-190">Em definições de configuração de aplicativo de Olá para o aplicativo hello você gostaria que toomodify, selecione Olá **identidade de logon recebido** toobe usado:</span><span class="sxs-lookup"><span data-stu-id="98545-190">In hello Application Configuration settings for hello application you would like toomodify, select hello **Delegated Login Identity** toobe used:</span></span>

   * <span data-ttu-id="98545-191">Nome UPN (por exemplo, joe@contoso.com)</span><span class="sxs-lookup"><span data-stu-id="98545-191">User Principal Name (for example, joe@contoso.com)</span></span>
   * <span data-ttu-id="98545-192">Nome UPN alternativo (por exemplo, joed@contoso.local)</span><span class="sxs-lookup"><span data-stu-id="98545-192">Alternate User Principal Name (for example, joed@contoso.local)</span></span>
   * <span data-ttu-id="98545-193">Nome de usuário que faz parte do nome UPN (por exemplo, joe)</span><span class="sxs-lookup"><span data-stu-id="98545-193">Username part of User Principal Name (for example, joe)</span></span>
   * <span data-ttu-id="98545-194">Nome de usuário que faz parte do nome UPN alternativo (por exemplo, joed)</span><span class="sxs-lookup"><span data-stu-id="98545-194">Username part of Alternate User Principal Name (for example, joed)</span></span>
   * <span data-ttu-id="98545-195">Nome de conta SAM local (depende da configuração do controlador de domínio Olá)</span><span class="sxs-lookup"><span data-stu-id="98545-195">On-premises SAM account name (depends on hello domain controller configuration)</span></span>

### <a name="troubleshooting-sso-for-different-identities"></a><span data-ttu-id="98545-196">Solucionando problemas de SSO para diferentes identidades</span><span class="sxs-lookup"><span data-stu-id="98545-196">Troubleshooting SSO for different identities</span></span>
<span data-ttu-id="98545-197">Se houver um erro no hello processo SSO, ele aparece no log de eventos de máquina Olá conector conforme explicado em [solução de problemas](application-proxy-back-end-kerberos-constrained-delegation-how-to.md).</span><span class="sxs-lookup"><span data-stu-id="98545-197">If there is an error in hello SSO process, it appears in hello connector machine event log as explained in [Troubleshooting](application-proxy-back-end-kerberos-constrained-delegation-how-to.md).</span></span>
<span data-ttu-id="98545-198">Mas, em alguns casos, Olá solicitação é enviada com êxito aplicativo de back-end toohello enquanto este aplicativo respostas em várias outras respostas HTTP.</span><span class="sxs-lookup"><span data-stu-id="98545-198">But, in some cases, hello request is successfully sent toohello backend application while this application replies in various other HTTP responses.</span></span> <span data-ttu-id="98545-199">Nesses casos de solução de problemas deve começar examinando o número de eventos 24029 na máquina de conector Olá no log de eventos de sessão de Proxy de aplicativo hello.</span><span class="sxs-lookup"><span data-stu-id="98545-199">Troubleshooting these cases should start by examining event number 24029 on hello connector machine in hello Application Proxy session event log.</span></span> <span data-ttu-id="98545-200">identidade do usuário Olá que foi usada para delegação aparece no campo de "usuário" de saudação em detalhes do evento hello.</span><span class="sxs-lookup"><span data-stu-id="98545-200">hello user identity that was used for delegation appears in hello “user” field within hello event details.</span></span> <span data-ttu-id="98545-201">Selecione tooturn no log de sessão, **Mostrar analítica e logs de depuração** no menu de exibição do Visualizador de eventos hello.</span><span class="sxs-lookup"><span data-stu-id="98545-201">tooturn on session log, select **Show analytic and debug logs** in hello event viewer view menu.</span></span>

## <a name="next-steps"></a><span data-ttu-id="98545-202">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="98545-202">Next steps</span></span>

* [<span data-ttu-id="98545-203">Como tooconfigure um aplicativo de Proxy de aplicativo toouse delegação restrita de Kerberos</span><span class="sxs-lookup"><span data-stu-id="98545-203">How tooconfigure an Application Proxy application toouse Kerberos Constrained Delegation</span></span>](application-proxy-back-end-kerberos-constrained-delegation-how-to.md)
* [<span data-ttu-id="98545-204">Solucionar problemas que surgirem com o Proxy de Aplicativo</span><span class="sxs-lookup"><span data-stu-id="98545-204">Troubleshoot issues you're having with Application Proxy</span></span>](active-directory-application-proxy-troubleshoot.md)


<span data-ttu-id="98545-205">Para Olá últimas notícias e atualizações, confira Olá [blog de Proxy de aplicativo](http://blogs.technet.com/b/applicationproxyblog/)</span><span class="sxs-lookup"><span data-stu-id="98545-205">For hello latest news and updates, check out hello [Application Proxy blog](http://blogs.technet.com/b/applicationproxyblog/)</span></span>

