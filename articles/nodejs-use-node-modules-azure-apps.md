---
title: "Trabalhando com módulos de Node.js"
description: "Aprenda a trabalhar com os módulos de Node.js ao usar o Serviço de Aplicativo ou Serviços de Nuvem do Azure."
services: 
documentationcenter: nodejs
author: TomArcher
manager: routlaw
editor: 
ms.assetid: c0e6cd3d-932d-433e-b72d-e513e23b4eb6
ms.service: multiple
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: nodejs
ms.topic: article
ms.date: 08/17/2016
ms.author: tarcher
ms.openlocfilehash: 1418c19594f19a15402d494880514298826445df
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/18/2017
---
# <a name="using-nodejs-modules-with-azure-applications"></a><span data-ttu-id="8b80f-103">Usando Módulos no Node.js com aplicativos do Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="8b80f-103">Using Node.js Modules with Azure applications</span></span>
<span data-ttu-id="8b80f-104">Este documento fornece orientação sobre como usar módulos no Node.js com aplicativos hospedados no Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="8b80f-104">This document provides guidance on using Node.js modules with applications hosted on Azure.</span></span> <span data-ttu-id="8b80f-105">Fornece orientação para garantir que seu aplicativo use uma versão específica do módulo, bem como para usar módulos nativos com o Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="8b80f-105">It provides guidance on ensuring that your application uses a specific version of module as well as using native modules with Azure.</span></span>

<span data-ttu-id="8b80f-106">Se já estiver acostumado a usar os módulos no Node.js e os arquivos **package.json** e **npm-shrinkwrap.json**, as informações a seguir apresentam um rápido resumo do que será discutido neste artigo:</span><span class="sxs-lookup"><span data-stu-id="8b80f-106">If you are already familiar with using Node.js modules, **package.json** and **npm-shrinkwrap.json** files, the following information provides a quick summary of what is discussed in this article:</span></span>

* <span data-ttu-id="8b80f-107">O Serviço de Aplicativo do Azure compreende arquivos **package.json** e **npm-shrinkwrap.json** e podem instalar módulos com base em entradas nestes arquivos.</span><span class="sxs-lookup"><span data-stu-id="8b80f-107">Azure App Service understands **package.json** and **npm-shrinkwrap.json** files and can install modules based on entries in these files.</span></span>

* <span data-ttu-id="8b80f-108">Os Serviços de Nuvem do Microsoft Azure esperam que todos os módulos sejam instalados no ambiente de desenvolvimento e que o diretório **node\_modules** seja incluído como parte do pacote de implantação.</span><span class="sxs-lookup"><span data-stu-id="8b80f-108">Azure Cloud Services expect all modules to be installed on the development environment, and the **node\_modules** directory to be included as part of the deployment package.</span></span> <span data-ttu-id="8b80f-109">É possível habilitar o suporte para instalar módulos usando arquivos **package.json** ou **npm-shrinkwrap.json** nos Serviços de Nuvem; no entanto, essa configuração requer uma personalização dos scripts padrão usados por projetos do Serviço de Nuvem.</span><span class="sxs-lookup"><span data-stu-id="8b80f-109">It is possible to enable support for installing modules using **package.json** or **npm-shrinkwrap.json** files on Cloud Services; however, this configuration requires customization of the default scripts used by Cloud Service projects.</span></span> <span data-ttu-id="8b80f-110">Para um exemplo de como configurar esse ambiente, consulte [Tarefa de Inicialização do Azure para executar npm install e evitar a implantação de módulos de nó](https://github.com/woloski/nodeonazure-blog/blob/master/articles/startup-task-to-run-npm-in-azure.markdown)</span><span class="sxs-lookup"><span data-stu-id="8b80f-110">For an example of how to configure this environment, see [Azure Startup task to run npm install to avoid deploying node modules](https://github.com/woloski/nodeonazure-blog/blob/master/articles/startup-task-to-run-npm-in-azure.markdown)</span></span>

> [!NOTE]
> <span data-ttu-id="8b80f-111">As Máquinas Virtuais do Azure não são discutidas neste artigo, já que a experiência de implantação em uma VM depende do sistema operacional hospedado pela Máquina Virtual.</span><span class="sxs-lookup"><span data-stu-id="8b80f-111">Azure Virtual Machines are not discussed in this article, as the deployment experience in a VM is dependent on the operating system hosted by the Virtual Machine.</span></span>
> 
> 

## <a name="nodejs-modules"></a><span data-ttu-id="8b80f-112">Módulos no Node.js</span><span class="sxs-lookup"><span data-stu-id="8b80f-112">Node.js Modules</span></span>
<span data-ttu-id="8b80f-113">Os módulos são pacotes carregáveis do JavaScript que fornecem funcionalidade específica para seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="8b80f-113">Modules are loadable JavaScript packages that provide specific functionality for your application.</span></span> <span data-ttu-id="8b80f-114">Em geral, instalam-se módulos com a ferramenta de linha de comando **npm**. Porém, alguns módulos (como http) são fornecidos como parte do pacote central do Node.js.</span><span class="sxs-lookup"><span data-stu-id="8b80f-114">Modules are usually installed using the **npm** command-line tool, however some modules (such as the http module) are provided as part of the core Node.js package.</span></span>

<span data-ttu-id="8b80f-115">Quando os módulos são instalados, são armazenados no diretório **node\_modules**, na raiz da estrutura do diretório de seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="8b80f-115">When modules are installed, they are stored in the **node\_modules** directory at the root of your application directory structure.</span></span> <span data-ttu-id="8b80f-116">Cada módulo dentro do diretório **node\_modules** mantém seu próprio diretório **node\_modules**, que contém todos os módulos dos quais ele depende. Esse comportamento se repete para cada módulo em toda a cadeia de dependência.</span><span class="sxs-lookup"><span data-stu-id="8b80f-116">Each module within the **node\_modules** directory maintains its own **node\_modules** directory that contains any modules that it depends on, and this behavior repeats for every module all the way down the dependency chain.</span></span> <span data-ttu-id="8b80f-117">Esse ambiente permite que cada módulo instalado tenha seus próprios requisitos de versão para os módulos dos quais depende, porém, o resultado pode ser uma estrutura de diretório muito grande.</span><span class="sxs-lookup"><span data-stu-id="8b80f-117">This environment allows each module installed to have its own version requirements for the modules it depends on, however it can result in quite a large directory structure.</span></span>

<span data-ttu-id="8b80f-118">Implantar o diretório **node\_modules** como parte de seu aplicativo aumenta o tamanho da implantação em comparação ao uso de um arquivo **package.json** ou **npm-shrinkwrap.json**, mas assegura que a versão dos módulos usados na produção seja igual à dos módulos usados no desenvolvimento.</span><span class="sxs-lookup"><span data-stu-id="8b80f-118">Deploying the **node\_modules** directory as part of your application increases the size of the deployment when compared to using a **package.json** or **npm-shrinkwrap.json** file; however, it does guarantee that the versions of the modules used in production are the same as the modules used in development.</span></span>

### <a name="native-modules"></a><span data-ttu-id="8b80f-119">Módulos Nativos</span><span class="sxs-lookup"><span data-stu-id="8b80f-119">Native Modules</span></span>
<span data-ttu-id="8b80f-120">Enquanto a maioria dos módulos são simples arquivos de texto JavaScript, outros são imagens binárias específicas de plataforma.</span><span class="sxs-lookup"><span data-stu-id="8b80f-120">While most modules are simply plain-text JavaScript files, some modules are platform-specific binary images.</span></span> <span data-ttu-id="8b80f-121">Estes módulos são compilados no momento da instalação, geralmente usando o Python e o node-gyp.</span><span class="sxs-lookup"><span data-stu-id="8b80f-121">These modules are compiled at install time, usually by using Python and node-gyp.</span></span> <span data-ttu-id="8b80f-122">Uma vez que os Serviços de Nuvem do Microsoft Azure contam com a pasta **node\_modules** sendo implantada como parte do aplicativo, qualquer módulo nativo incluído como parte dos módulos instalados deve funcionar em um serviço de nuvem, desde que tenha sido instalado e compilado em um sistema de desenvolvimento do Windows.</span><span class="sxs-lookup"><span data-stu-id="8b80f-122">Since Azure Cloud Services rely on the **node\_modules** folder being deployed as part of the application, any native module included as part of the installed modules should work in a cloud service as long as it was installed and compiled on a Windows development system.</span></span>

<span data-ttu-id="8b80f-123">O Serviço de Aplicativo do Azure não dá suporte a todos os módulos nativos e pode falhar ao compilar módulos com pré-requisitos específicos.</span><span class="sxs-lookup"><span data-stu-id="8b80f-123">Azure App Service does not support all native modules, and might fail when compiling modules with specific prerequisites.</span></span> <span data-ttu-id="8b80f-124">Embora alguns módulos populares como o MongoDB tenham dependências nativas opcionais e funcionem bem sem elas, duas soluções alternativas foram comprovadamente bem-sucedidas com quase todos os módulos nativos disponíveis hoje:</span><span class="sxs-lookup"><span data-stu-id="8b80f-124">While some popular modules like MongoDB have optional native dependencies and work fine without them, two workarounds proved successful with almost all native modules available today:</span></span>

* <span data-ttu-id="8b80f-125">Execute a **npm install** em uma máquina do Windows que tenha todos os pré-requisitos do módulo nativo.</span><span class="sxs-lookup"><span data-stu-id="8b80f-125">Run **npm install** on a Windows machine that has all the native module's prerequisites installed.</span></span> <span data-ttu-id="8b80f-126">Em seguida, implante a pasta **node\_modules** criada como parte do aplicativo no Serviço de Aplicativo do Azure.</span><span class="sxs-lookup"><span data-stu-id="8b80f-126">Then, deploy the created **node\_modules** folder as part of the application to Azure App Service.</span></span>

  * <span data-ttu-id="8b80f-127">Antes de compilar, verifique se sua instalação local do Node.js tem arquitetura correspondente e se a versão é a mais próxima possível da usada no Azure (os valores atuais podem ser verificados no tempo de execução das propriedades **process.arch** e **process.version**).</span><span class="sxs-lookup"><span data-stu-id="8b80f-127">Before compiling, check that your local Node.js installation has matching architecture and the version is as close as possible to the one used in Azure (the current values can be checked on runtime from properties **process.arch** and **process.version**).</span></span>

* <span data-ttu-id="8b80f-128">O Serviço de Aplicativo do Azure podem ser configurados para executar scripts bash ou de shell personalizados durante a implantação, oferecendo a você a oportunidade de executar comandos personalizados e configurar com precisão a maneira como o **npm install** é executado.</span><span class="sxs-lookup"><span data-stu-id="8b80f-128">Azure App Service can be configured to execute custom bash or shell scripts during deployment, giving you the opportunity to execute custom commands and precisely configure the way **npm install** is being run.</span></span> <span data-ttu-id="8b80f-129">Para obter um vídeo mostrando como configurar esse ambiente, consulte [Scripts de implantação de site personalizado com Kudu].</span><span class="sxs-lookup"><span data-stu-id="8b80f-129">For a video showing how to configure that environment, see [Custom Website Deployment Scripts with Kudu].</span></span>

### <a name="using-a-packagejson-file"></a><span data-ttu-id="8b80f-130">Usando um arquivo package.json</span><span class="sxs-lookup"><span data-stu-id="8b80f-130">Using a package.json file</span></span>
<span data-ttu-id="8b80f-131">O arquivo **package.json** é uma maneira de especificar as dependências de nível superior que seu aplicativo requer para que a plataforma de hospedagem possa instalar as dependências, em vez de exigir a inclusão da pasta **node\_packages** como parte da implantação.</span><span class="sxs-lookup"><span data-stu-id="8b80f-131">The **package.json** file is a way to specify the top-level dependencies your application requires so that the hosting platform can install the dependencies, rather than requiring you to include the **node\_packages** folder as part of the deployment.</span></span> <span data-ttu-id="8b80f-132">Após o aplicativo ser implantado, o comando **instalar npm** é usado para analisar o arquivo **package.json** e instalar todas as dependências listadas.</span><span class="sxs-lookup"><span data-stu-id="8b80f-132">After the application has been deployed, the **npm install** command is used to parse the **package.json** file and install all the dependencies listed.</span></span>

<span data-ttu-id="8b80f-133">Ao instalar módulos durante o desenvolvimento, você pode usar os parâmetros **--save**, **--save-dev** ou **--save-optional** para adicionar, automaticamente, uma entrada para o módulo de seu arquivo **package.json**.</span><span class="sxs-lookup"><span data-stu-id="8b80f-133">During development, you can use the **--save**, **--save-dev**, or **--save-optional** parameters when installing modules to add an entry for the module to your **package.json** file automatically.</span></span> <span data-ttu-id="8b80f-134">Para obter mais informações, consulte [instalar-npm](https://docs.npmjs.com/cli/install).</span><span class="sxs-lookup"><span data-stu-id="8b80f-134">For more information, see [npm-install](https://docs.npmjs.com/cli/install).</span></span>

<span data-ttu-id="8b80f-135">Um problema potencial com o arquivo **package.json** é que este só especifica a versão para dependências de nível superior.</span><span class="sxs-lookup"><span data-stu-id="8b80f-135">One potential problem with the **package.json** file is that it only specifies the version for top-level dependencies.</span></span> <span data-ttu-id="8b80f-136">Cada módulo instalado pode ou não especificar a versão dos módulos da qual depende e, desta forma, é possível que você acabe com uma cadeia de dependências diferente daquele usada no desenvolvimento.</span><span class="sxs-lookup"><span data-stu-id="8b80f-136">Each module installed may or may not specify the version of the modules it depends on, and so it is possible that you may end up with a different dependency chain than the one used in development.</span></span>

> [!NOTE]
> <span data-ttu-id="8b80f-137">Quando estiver implantando no Serviço de Aplicativo do Azure, se o seu arquivo <b>package.json</b> fizer referência a um módulo nativo, você poderá ver um erro semelhante ao exemplo a seguir ao publicar o aplicativo usando Git:</span><span class="sxs-lookup"><span data-stu-id="8b80f-137">When deploying to Azure App Service, if your <b>package.json</b> file references a native module you might see an error similar to the following example when publishing the application using Git:</span></span>
> 
> <span data-ttu-id="8b80f-138">npm ERR!</span><span class="sxs-lookup"><span data-stu-id="8b80f-138">npm ERR!</span></span> <span data-ttu-id="8b80f-139">Instalar module-name@0.6.0: 'node-gyp configure build'</span><span class="sxs-lookup"><span data-stu-id="8b80f-139">module-name@0.6.0 install: 'node-gyp configure build'</span></span>
> 
> <span data-ttu-id="8b80f-140">npm ERR!</span><span class="sxs-lookup"><span data-stu-id="8b80f-140">npm ERR!</span></span> <span data-ttu-id="8b80f-141">'cmd "/c" "node-gyp rebuild"' falhou com 1</span><span class="sxs-lookup"><span data-stu-id="8b80f-141">'cmd "/c" "node-gyp configure build"' failed with 1</span></span>
> 
> 

### <a name="using-a-npm-shrinkwrapjson-file"></a><span data-ttu-id="8b80f-142">Usando um arquivo npm-shrinkwrap.json</span><span class="sxs-lookup"><span data-stu-id="8b80f-142">Using a npm-shrinkwrap.json file</span></span>
<span data-ttu-id="8b80f-143">O arquivo **npm-shrinkwrap.json** é uma tentativa de resolver as limitações da versão do módulo do arquivo **package.json**.</span><span class="sxs-lookup"><span data-stu-id="8b80f-143">The **npm-shrinkwrap.json** file is an attempt to address the module versioning limitations of the **package.json** file.</span></span> <span data-ttu-id="8b80f-144">Enquanto o arquivo **package.json** inclui apenas versões para os módulos de nível superior, o arquivo **npm-shrinkwrap.json** contém os requisitos de versão para a cadeia de dependências de módulo completo.</span><span class="sxs-lookup"><span data-stu-id="8b80f-144">While the **package.json** file only includes versions for the top-level modules, the **npm-shrinkwrap.json** file contains the version requirements for the full module dependency chain.</span></span>

<span data-ttu-id="8b80f-145">Quando seu aplicativo estiver pronto para produção, você poderá bloquear os requisitos de versão e criar um arquivo **npm-shrinkwrap.json** usando o comando **npm shrinkwrap**.</span><span class="sxs-lookup"><span data-stu-id="8b80f-145">When your application is ready for production, you can lock down version requirements and create an **npm-shrinkwrap.json** file by using the **npm shrinkwrap** command.</span></span> <span data-ttu-id="8b80f-146">Esse comando usará as versões atualmente instaladas na pasta **node\_modules** e registrará essas versões no arquivo **npm-shrinkwrap.json**.</span><span class="sxs-lookup"><span data-stu-id="8b80f-146">This command will use the versions currently installed in the **node\_modules** folder, and record these versions to the **npm-shrinkwrap.json** file.</span></span> <span data-ttu-id="8b80f-147">Após o aplicativo ser implantado no ambiente de hospedagem, o comando **instalar npm** é usado para analisar o arquivo **npm-shrinkwrap.json** e instalar todas as dependências listadas.</span><span class="sxs-lookup"><span data-stu-id="8b80f-147">After the application has been deployed to the hosting environment, the **npm install** command is used to parse the **npm-shrinkwrap.json** file and install all the dependencies listed.</span></span> <span data-ttu-id="8b80f-148">Para obter mais informações, consulte [npm-shrinkwrap](https://docs.npmjs.com/cli/shrinkwrap).</span><span class="sxs-lookup"><span data-stu-id="8b80f-148">For more information, see [npm-shrinkwrap](https://docs.npmjs.com/cli/shrinkwrap).</span></span>

> [!NOTE]
> <span data-ttu-id="8b80f-149">Quando estiver implantando no Serviço de Aplicativo do Azure, se o seu arquivo <b>npm-shrinkwrap.json</b> fizer referência a um módulo nativo, você poderá ver um erro semelhante ao exemplo a seguir ao publicar o aplicativo usando Git:</span><span class="sxs-lookup"><span data-stu-id="8b80f-149">When deploying to Azure App Service, if your <b>npm-shrinkwrap.json</b> file references a native module you might see an error similar to the following example when publishing the application using Git:</span></span>
> 
> <span data-ttu-id="8b80f-150">npm ERR!</span><span class="sxs-lookup"><span data-stu-id="8b80f-150">npm ERR!</span></span> <span data-ttu-id="8b80f-151">Instalar module-name@0.6.0: 'node-gyp configure build'</span><span class="sxs-lookup"><span data-stu-id="8b80f-151">module-name@0.6.0 install: 'node-gyp configure build'</span></span>
> 
> <span data-ttu-id="8b80f-152">npm ERR!</span><span class="sxs-lookup"><span data-stu-id="8b80f-152">npm ERR!</span></span> <span data-ttu-id="8b80f-153">'cmd "/c" "node-gyp rebuild"' falhou com 1</span><span class="sxs-lookup"><span data-stu-id="8b80f-153">'cmd "/c" "node-gyp configure build"' failed with 1</span></span>
> 
> 

## <a name="next-steps"></a><span data-ttu-id="8b80f-154">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="8b80f-154">Next steps</span></span>
<span data-ttu-id="8b80f-155">Agora que você aprendeu como usar os módulos no Node.js com o Azure, aprenda como [especificar a versão do Node.js], [compilar e implantar um aplicativo Web Node.js](app-service-web/app-service-web-get-started-nodejs.md) e [Como usar a Interface de Linha de Comando do Azure para Mac e Linux].</span><span class="sxs-lookup"><span data-stu-id="8b80f-155">Now that you understand how to use Node.js modules with Azure, learn how to [specify the Node.js version], [build and deploy a Node.js web app](app-service-web/app-service-web-get-started-nodejs.md), and [How to use the Azure Command-Line Interface for Mac and Linux].</span></span>

<span data-ttu-id="8b80f-156">Para saber mais, confira o [Centro de desenvolvedores do Node.js](/nodejs/azure/).</span><span class="sxs-lookup"><span data-stu-id="8b80f-156">For more information, see the [Node.js Developer Center](/nodejs/azure/).</span></span>

<span data-ttu-id="8b80f-157">[especificar a versão do Node.js]: nodejs-specify-node-version-azure-apps.md</span><span class="sxs-lookup"><span data-stu-id="8b80f-157">[specify the Node.js version]: nodejs-specify-node-version-azure-apps.md</span></span>
<span data-ttu-id="8b80f-158">[Como usar a Interface de Linha de Comando do Azure para Mac e Linux]:cli-install-nodejs.md</span><span class="sxs-lookup"><span data-stu-id="8b80f-158">[How to use the Azure Command-Line Interface for Mac and Linux]:cli-install-nodejs.md</span></span>
<span data-ttu-id="8b80f-159">[Scripts de implantação de site personalizado com Kudu]: https://channel9.msdn.com/Shows/Azure-Friday/Custom-Web-Site-Deployment-Scripts-with-Kudu-with-David-Ebbo</span><span class="sxs-lookup"><span data-stu-id="8b80f-159">[Custom Website Deployment Scripts with Kudu]: https://channel9.msdn.com/Shows/Azure-Friday/Custom-Web-Site-Deployment-Scripts-with-Kudu-with-David-Ebbo</span></span>
