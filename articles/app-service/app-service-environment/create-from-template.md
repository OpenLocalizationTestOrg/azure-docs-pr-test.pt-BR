---
title: "Criar um ambiente do Serviço de Aplicativo do Azure usando um modelo do Resource Manager"
description: "Explica como criar um Ambiente do Serviço de Aplicativo do Azure ILB ou Externo usando um modelo do Resource Manager"
services: app-service
documentationcenter: na
author: ccompy
manager: stefsch
ms.assetid: 6eb7d43d-e820-4a47-818c-80ff7d3b6f8e
ms.service: app-service
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/13/2017
ms.author: ccompy
ms.openlocfilehash: e6b21086488352c1da914b4656ad1d216fd6de85
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/03/2017
---
# <a name="create-an-ase-by-using-an-azure-resource-manager-template"></a><span data-ttu-id="f6074-103">Criar um ASE usando um modelo do Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="f6074-103">Create an ASE by using an Azure Resource Manager template</span></span>

## <a name="overview"></a><span data-ttu-id="f6074-104">Visão geral</span><span class="sxs-lookup"><span data-stu-id="f6074-104">Overview</span></span>
<span data-ttu-id="f6074-105">Ambientes do Serviço de Aplicativo do Azure (ASEs) podem ser criados com um ponto de extremidade acessível pela Internet ou um ponto de extremidade em um endereço interno na rede virtual (VNet) do Azure.</span><span class="sxs-lookup"><span data-stu-id="f6074-105">Azure App Service environments (ASEs) can be created with an internet-accessible endpoint or an endpoint on an internal address in an Azure virtual network (VNet).</span></span> <span data-ttu-id="f6074-106">Quando criado com um ponto de extremidade interno, esse ponto de extremidade é fornecido por um componente do Azure chamado ILB (balanceador de carga interno).</span><span class="sxs-lookup"><span data-stu-id="f6074-106">When created with an internal endpoint, that endpoint is provided by an Azure component called an internal load balancer (ILB).</span></span> <span data-ttu-id="f6074-107">O ASE em um endereço IP interno é chamado de um ASE ILB.</span><span class="sxs-lookup"><span data-stu-id="f6074-107">The ASE on an internal IP address is called an ILB ASE.</span></span> <span data-ttu-id="f6074-108">O ASE com um ponto de extremidade público é chamado de um ASE externo.</span><span class="sxs-lookup"><span data-stu-id="f6074-108">The ASE with a public endpoint is called an External ASE.</span></span> 

<span data-ttu-id="f6074-109">Um ASE pode ser criado usando o portal do Azure ou um modelo do Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="f6074-109">An ASE can be created by using the Azure portal or an Azure Resource Manager template.</span></span> <span data-ttu-id="f6074-110">Este artigo explica as etapas e a sintaxe que você precisa para criar um ASE Externo ou um ASE ILB com modelos do Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="f6074-110">This article walks through the steps and syntax you need to create an External ASE or ILB ASE with Resource Manager templates.</span></span> <span data-ttu-id="f6074-111">Para saber como criar uma ASE no portal do Azure, consulte [Fazer um ASE externo][MakeExternalASE] ou [Fazer um ASE ILB][MakeILBASE].</span><span class="sxs-lookup"><span data-stu-id="f6074-111">To learn how to create an ASE in the Azure portal, see [Make an External ASE][MakeExternalASE] or [Make an ILB ASE][MakeILBASE].</span></span>

<span data-ttu-id="f6074-112">Ao criar um ASE no portal do Azure, você pode criar sua VNet ao mesmo tempo ou escolher uma VNet pré-existente na qual implantar.</span><span class="sxs-lookup"><span data-stu-id="f6074-112">When you create an ASE in the Azure portal, you can create your VNet at the same time or choose a preexisting VNet to deploy into.</span></span> <span data-ttu-id="f6074-113">Ao criar um ASE com base em um modelo, você deve começar com:</span><span class="sxs-lookup"><span data-stu-id="f6074-113">When you create an ASE from a template, you must start with:</span></span> 

* <span data-ttu-id="f6074-114">Uma VNet do Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="f6074-114">A Resource Manager VNet.</span></span>
* <span data-ttu-id="f6074-115">Uma sub-rede nessa VNet.</span><span class="sxs-lookup"><span data-stu-id="f6074-115">A subnet in that VNet.</span></span> <span data-ttu-id="f6074-116">É recomendável um tamanho de sub-rede ASE de `/25` com 128 endereços para acomodar o crescimento futuro.</span><span class="sxs-lookup"><span data-stu-id="f6074-116">We recommend an ASE subnet size of `/25` with 128 addresses to accomodate future growth.</span></span> <span data-ttu-id="f6074-117">Depois que o ASE é criado, você não pode alterar o tamanho.</span><span class="sxs-lookup"><span data-stu-id="f6074-117">After the ASE is created, you can't change the size.</span></span>
* <span data-ttu-id="f6074-118">A ID do recurso da sua VNet.</span><span class="sxs-lookup"><span data-stu-id="f6074-118">The resource ID from your VNet.</span></span> <span data-ttu-id="f6074-119">Você pode obter mais informações no portal do Azure nas propriedades da rede virtual.</span><span class="sxs-lookup"><span data-stu-id="f6074-119">You can get this information from the Azure portal under your virtual network properties.</span></span>
* <span data-ttu-id="f6074-120">A assinatura na qual você deseja implantar.</span><span class="sxs-lookup"><span data-stu-id="f6074-120">The subscription you want to deploy into.</span></span>
* <span data-ttu-id="f6074-121">O local no qual você deseja implantar.</span><span class="sxs-lookup"><span data-stu-id="f6074-121">The location you want to deploy into.</span></span>

<span data-ttu-id="f6074-122">Para automatizar a criação do ASE:</span><span class="sxs-lookup"><span data-stu-id="f6074-122">To automate your ASE creation:</span></span>

1. <span data-ttu-id="f6074-123">Crie o ASE com base em um modelo.</span><span class="sxs-lookup"><span data-stu-id="f6074-123">Create the ASE from a template.</span></span> <span data-ttu-id="f6074-124">Se você criar um ASE externo, terá concluído após essa etapa.</span><span class="sxs-lookup"><span data-stu-id="f6074-124">If you create an External ASE, you're finished after this step.</span></span> <span data-ttu-id="f6074-125">Se estiver criando um ASE ILB, haverá algumas coisas extras a serem feitas.</span><span class="sxs-lookup"><span data-stu-id="f6074-125">If you create an ILB ASE, there are a few more things to do.</span></span>

2. <span data-ttu-id="f6074-126">Depois que o ASE ILB for criado, um certificado SSL correspondente ao domínio do ASE ILB será carregado.</span><span class="sxs-lookup"><span data-stu-id="f6074-126">After your ILB ASE is created, an SSL certificate that matches your ILB ASE domain is uploaded.</span></span>

3. <span data-ttu-id="f6074-127">O certificado SSL carregado é atribuído ao ASE ILB como seu certificado SSL “padrão”.</span><span class="sxs-lookup"><span data-stu-id="f6074-127">The uploaded SSL certificate is assigned to the ILB ASE as its "default" SSL certificate.</span></span>  <span data-ttu-id="f6074-128">Esse certificado SSL será usado para o tráfego SSL dos aplicativos no ASE ILB quando eles usam o domínio-raiz comum atribuído ao ASE (por exemplo, https://someapp.mycustomrootcomain.com).</span><span class="sxs-lookup"><span data-stu-id="f6074-128">This certificate is used for SSL traffic to apps on the ILB ASE when they use the common root domain that's assigned to the ASE (for example, https://someapp.mycustomrootcomain.com).</span></span>


## <a name="create-the-ase"></a><span data-ttu-id="f6074-129">Criar o ASE</span><span class="sxs-lookup"><span data-stu-id="f6074-129">Create the ASE</span></span>
<span data-ttu-id="f6074-130">Um modelo do Resource Manager que cria um ASE e seu arquivo de parâmetros associado está disponível [no exemplo][quickstartasev2create] no GitHub.</span><span class="sxs-lookup"><span data-stu-id="f6074-130">A Resource Manager template that creates an ASE and its associated parameters file is available [in an example][quickstartasev2create] on GitHub.</span></span>

<span data-ttu-id="f6074-131">Se você quiser fazer uma ASE ILB, use esses [exemplos][quickstartilbasecreate] do modelo do Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="f6074-131">If you want to make an ILB ASE, use these Resource Manager template [examples][quickstartilbasecreate].</span></span> <span data-ttu-id="f6074-132">Eles atendem a esse caso de uso.</span><span class="sxs-lookup"><span data-stu-id="f6074-132">They cater to that use case.</span></span> <span data-ttu-id="f6074-133">A maioria dos parâmetros no arquivo *azuredeploy.parameters.json* é comum à criação de ASEs ILB e ASEs Externos.</span><span class="sxs-lookup"><span data-stu-id="f6074-133">Most of the parameters in the *azuredeploy.parameters.json* file are common to the creation of ILB ASEs and External ASEs.</span></span> <span data-ttu-id="f6074-134">A lista a seguir chama parâmetros de anotação especial ou que são exclusivos, quando você cria um ASE ILB:</span><span class="sxs-lookup"><span data-stu-id="f6074-134">The following list calls out parameters of special note, or that are unique, when you create an ILB ASE:</span></span>

* <span data-ttu-id="f6074-135">*interalLoadBalancingMode*: Na maioria dos casos, define para 3, o que significa que o tráfego HTTP/HTTPS nas portas 80/443 e as portas do canal de dados/controle atendidas pelo serviço FTP no ASE serão associados a um endereço interno da rede virtual alocada do ILB.</span><span class="sxs-lookup"><span data-stu-id="f6074-135">*interalLoadBalancingMode*: In most cases, set this to 3, which means both HTTP/HTTPS traffic on ports 80/443, and the control/data channel ports listened to by the FTP service on the ASE, will be bound to an ILB-allocated virtual network internal address.</span></span> <span data-ttu-id="f6074-136">Se essa propriedade é definida como 2, somente as portas relacionadas de serviço FTP (canais de controle e de dados) estão associadas a um endereço ILB.</span><span class="sxs-lookup"><span data-stu-id="f6074-136">If this property is set to 2, only the FTP service-related ports (both control and data channels) are bound to an ILB address.</span></span> <span data-ttu-id="f6074-137">O tráfego HTTP/HTTPS permanece no VIP público.</span><span class="sxs-lookup"><span data-stu-id="f6074-137">The HTTP/HTTPS traffic remains on the public VIP.</span></span>
* <span data-ttu-id="f6074-138">*dnsSuffix*: Esse parâmetro define o domínio-raiz padrão que é atribuído ao ASE.</span><span class="sxs-lookup"><span data-stu-id="f6074-138">*dnsSuffix*: This parameter defines the default root domain that's assigned to the ASE.</span></span> <span data-ttu-id="f6074-139">A variação pública do Serviço de Aplicativo do Azure, o domínio de raiz padrão para todos os aplicativos Web, é *azurewebsites.net*.</span><span class="sxs-lookup"><span data-stu-id="f6074-139">In the public variation of Azure App Service, the default root domain for all web apps is *azurewebsites.net*.</span></span> <span data-ttu-id="f6074-140">Como um ASE ILB é interno na rede virtual do cliente, não faz sentido usar o domínio-raiz padrão do serviço público.</span><span class="sxs-lookup"><span data-stu-id="f6074-140">Because an ILB ASE is internal to a customer's virtual network, it doesn't make sense to use the public service's default root domain.</span></span> <span data-ttu-id="f6074-141">Em vez disso, um ASE ILB deve ter um domínio de raiz padrão que faça sentido para uso dentro da rede virtual interna da empresa.</span><span class="sxs-lookup"><span data-stu-id="f6074-141">Instead, an ILB ASE should have a default root domain that makes sense for use within a company's internal virtual network.</span></span> <span data-ttu-id="f6074-142">Por exemplo, a Contoso Corporation pode usar um domínio raiz padrão *internal-contoso.com* para aplicativos que se destinam a serem resolvidos e acessados apenas na rede virtual da Contoso.</span><span class="sxs-lookup"><span data-stu-id="f6074-142">For example, Contoso Corporation might use a default root domain of *internal-contoso.com* for apps that are intended to be resolvable and accessible only within Contoso's virtual network.</span></span> 
* <span data-ttu-id="f6074-143">*ipSslAddressCount*: Esse parâmetro padroniza automaticamente para um valor 0 no arquivo *azuredeploy.json* porque os ASEs ILB têm apenas um único endereço ILB.</span><span class="sxs-lookup"><span data-stu-id="f6074-143">*ipSslAddressCount*: This parameter automatically defaults to a value of 0 in the *azuredeploy.json* file because ILB ASEs only have a single ILB address.</span></span> <span data-ttu-id="f6074-144">Não há nenhum endereço IP SSL explícito para um ASE ILB.</span><span class="sxs-lookup"><span data-stu-id="f6074-144">There are no explicit IP-SSL addresses for an ILB ASE.</span></span> <span data-ttu-id="f6074-145">Portanto, o pool de endereços IP SSL para um ASE ILB deve ser definido como zero.</span><span class="sxs-lookup"><span data-stu-id="f6074-145">Hence, the IP-SSL address pool for an ILB ASE must be set to zero.</span></span> <span data-ttu-id="f6074-146">Caso contrário, ocorrerá um erro de provisionamento.</span><span class="sxs-lookup"><span data-stu-id="f6074-146">Otherwise, a provisioning error occurs.</span></span> 

<span data-ttu-id="f6074-147">Após o arquivo *azuredeploy.parameters.json* ser preenchido, crie o ASE usando o trecho de código do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="f6074-147">After the *azuredeploy.parameters.json* file is filled in, create the ASE by using the PowerShell code snippet.</span></span> <span data-ttu-id="f6074-148">Altere os caminhos do arquivo para corresponder aos locais do modelo Resource Manager no seu computador.</span><span class="sxs-lookup"><span data-stu-id="f6074-148">Change the file paths to match the Resource Manager template-file locations on your machine.</span></span> <span data-ttu-id="f6074-149">Lembre-se de fornecer seus próprios valores para o nome de implantação do Resource Manager e para o nome do grupo de recursos:</span><span class="sxs-lookup"><span data-stu-id="f6074-149">Remember to supply your own values for the Resource Manager deployment name and the resource group name:</span></span>

    $templatePath="PATH\azuredeploy.json"
    $parameterPath="PATH\azuredeploy.parameters.json"

    New-AzureRmResourceGroupDeployment -Name "CHANGEME" -ResourceGroupName "YOUR-RG-NAME-HERE" -TemplateFile $templatePath -TemplateParameterFile $parameterPath

<span data-ttu-id="f6074-150">Leva aproximadamente uma hora para o ASE ser criado.</span><span class="sxs-lookup"><span data-stu-id="f6074-150">It takes about an hour for the ASE to be created.</span></span> <span data-ttu-id="f6074-151">Em seguida, o ASE aparece no portal na lista de ASEs para a assinatura que disparou a implantação.</span><span class="sxs-lookup"><span data-stu-id="f6074-151">Then the ASE shows up in the portal in the list of ASEs for the subscription that triggered the deployment.</span></span>

## <a name="upload-and-configure-the-default-ssl-certificate"></a><span data-ttu-id="f6074-152">Carregar e configurar o certificado SSL "padrão"</span><span class="sxs-lookup"><span data-stu-id="f6074-152">Upload and configure the "default" SSL certificate</span></span>
<span data-ttu-id="f6074-153">Um certificado SSL deve ser associado ao ASE como o certificado SSL “padrão” que é usado para estabelecer conexões SSL com aplicativos.</span><span class="sxs-lookup"><span data-stu-id="f6074-153">An SSL certificate must be associated with the ASE as the "default" SSL certificate that's used to establish SSL connections to apps.</span></span> <span data-ttu-id="f6074-154">Se o sufixo DNS padrão do ASE for *internal-contoso.com*, uma conexão com https://some-random-app.internal-contoso.com irá requerer um certificado SSL válido para **.internal-contoso.com*.</span><span class="sxs-lookup"><span data-stu-id="f6074-154">If the ASE's default DNS suffix is *internal-contoso.com*, a connection to https://some-random-app.internal-contoso.com requires an SSL certificate that's valid for **.internal-contoso.com*.</span></span> 

<span data-ttu-id="f6074-155">Obtenha um certificado SSL válido, usando autoridades de certificação internas, adquirindo um certificado de um emissor externo ou usando um certificado autoassinado.</span><span class="sxs-lookup"><span data-stu-id="f6074-155">Obtain a valid SSL certificate by using internal certificate authorities, purchasing a certificate from an external issuer, or using a self-signed certificate.</span></span> <span data-ttu-id="f6074-156">Independentemente da origem do certificado SSL, os seguintes atributos de certificado devem ser configurados corretamente:</span><span class="sxs-lookup"><span data-stu-id="f6074-156">Regardless of the source of the SSL certificate, the following certificate attributes must be configured properly:</span></span>

* <span data-ttu-id="f6074-157">**Assunto**: Esse atributo deve ser definido para **.domínio-raiz-aqui.com*.</span><span class="sxs-lookup"><span data-stu-id="f6074-157">**Subject**: This attribute must be set to **.your-root-domain-here.com*.</span></span>
* <span data-ttu-id="f6074-158">**Nome Alternativo da Entidade**: Esse atributo deve incluir **.seu-dominio-raiz-aqui.com* e **.scm.seu-dominio-raiz-aqui.com*.</span><span class="sxs-lookup"><span data-stu-id="f6074-158">**Subject Alternative Name**: This attribute must include both **.your-root-domain-here.com* and **.scm.your-root-domain-here.com*.</span></span> <span data-ttu-id="f6074-159">Conexões SSL para o site SCM/Kudu associados a cada aplicativo usam um endereço no formato *nome-do-seu-aplicativo.scm.seu-domínio-raiz-aqui.com*.</span><span class="sxs-lookup"><span data-stu-id="f6074-159">SSL connections to the SCM/Kudu site associated with each app use an address of the form *your-app-name.scm.your-root-domain-here.com*.</span></span>

<span data-ttu-id="f6074-160">Com um certificado SSL válido em mãos, são necessárias mais duas etapas preparatórias.</span><span class="sxs-lookup"><span data-stu-id="f6074-160">With a valid SSL certificate in hand, two additional preparatory steps are needed.</span></span> <span data-ttu-id="f6074-161">Converta ou salve o certificado SSL como um arquivo .pfx.</span><span class="sxs-lookup"><span data-stu-id="f6074-161">Convert/save the SSL certificate as a .pfx file.</span></span> <span data-ttu-id="f6074-162">Lembre-se que o arquivo .pfx deve incluir todos os certificados intermediários e raiz.</span><span class="sxs-lookup"><span data-stu-id="f6074-162">Remember that the .pfx file must include all intermediate and root certificates.</span></span> <span data-ttu-id="f6074-163">Proteja-o com uma senha.</span><span class="sxs-lookup"><span data-stu-id="f6074-163">Secure it with a password.</span></span>

<span data-ttu-id="f6074-164">O arquivo .pfx resultante deve ser convertido em uma cadeia de caracteres de base64 porque o certificado SSL é carregado usando um modelo do Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="f6074-164">The .pfx file needs to be converted into a base64 string because the SSL certificate is uploaded by using a Resource Manager template.</span></span> <span data-ttu-id="f6074-165">Como os modelos do Resource Manager são arquivos de texto, o arquivo. pfx deve ser convertido em uma cadeia de caracteres base64.</span><span class="sxs-lookup"><span data-stu-id="f6074-165">Because Resource Manager templates are text files, the .pfx file must be converted into a base64 string.</span></span> <span data-ttu-id="f6074-166">Dessa forma pode ser incluído como um parâmetro do modelo.</span><span class="sxs-lookup"><span data-stu-id="f6074-166">This way it can be included as a parameter of the template.</span></span>

<span data-ttu-id="f6074-167">Use o seguinte trecho de código do PowerShell para:</span><span class="sxs-lookup"><span data-stu-id="f6074-167">Use the following PowerShell code snippet to:</span></span>

* <span data-ttu-id="f6074-168">Criar um certificado autoassinado.</span><span class="sxs-lookup"><span data-stu-id="f6074-168">Generate a self-signed certificate.</span></span>
* <span data-ttu-id="f6074-169">Exportar o certificado como um arquivo. pfx.</span><span class="sxs-lookup"><span data-stu-id="f6074-169">Export the certificate as a .pfx file.</span></span>
* <span data-ttu-id="f6074-170">Converter o arquivo. pfx em uma cadeia de caracteres codificada em base64.</span><span class="sxs-lookup"><span data-stu-id="f6074-170">Convert the .pfx file into a base64-encoded string.</span></span>
* <span data-ttu-id="f6074-171">Salvar a cadeia de caracteres codificada em base64 em um arquivo separado.</span><span class="sxs-lookup"><span data-stu-id="f6074-171">Save the base64-encoded string to a separate file.</span></span> 

<span data-ttu-id="f6074-172">Este código do PowerShell para a codificação de base64 foi adaptado do [Blog de Scripts do PowerShell][examplebase64encoding]:</span><span class="sxs-lookup"><span data-stu-id="f6074-172">This PowerShell code for base64 encoding was adapted from the [PowerShell scripts blog][examplebase64encoding]:</span></span>

        $certificate = New-SelfSignedCertificate -certstorelocation cert:\localmachine\my -dnsname "*.internal-contoso.com","*.scm.internal-contoso.com"

        $certThumbprint = "cert:\localMachine\my\" + $certificate.Thumbprint
        $password = ConvertTo-SecureString -String "CHANGETHISPASSWORD" -Force -AsPlainText

        $fileName = "exportedcert.pfx"
        Export-PfxCertificate -cert $certThumbprint -FilePath $fileName -Password $password     

        $fileContentBytes = get-content -encoding byte $fileName
        $fileContentEncoded = [System.Convert]::ToBase64String($fileContentBytes)
        $fileContentEncoded | set-content ($fileName + ".b64")

<span data-ttu-id="f6074-173">Depois que o certificado SSL for gerado com êxito e convertido em uma cadeia de caracteres codificada em base64, use o modelo do Resource Manager de exemplo para [Configurar o certificado SSL padrão][quickstartconfiguressl] no GitHub.</span><span class="sxs-lookup"><span data-stu-id="f6074-173">After the SSL certificate is successfully generated and converted to a base64-encoded string, use the example Resource Manager template [Configure the default SSL certificate][quickstartconfiguressl] on GitHub.</span></span> 

<span data-ttu-id="f6074-174">Os parâmetros no arquivo *azuredeploy.parameters.json* estão listados abaixo:</span><span class="sxs-lookup"><span data-stu-id="f6074-174">The parameters in the *azuredeploy.parameters.json* file are listed here:</span></span>

* <span data-ttu-id="f6074-175">*appServiceEnvironmentName*: o nome do ASE ILB que está sendo configurado.</span><span class="sxs-lookup"><span data-stu-id="f6074-175">*appServiceEnvironmentName*: The name of the ILB ASE being configured.</span></span>
* <span data-ttu-id="f6074-176">*existingAseLocation*: cadeia de caracteres de texto que contém a região do Azure onde o ASE ILB foi implantado.</span><span class="sxs-lookup"><span data-stu-id="f6074-176">*existingAseLocation*: Text string containing the Azure region where the ILB ASE was deployed.</span></span>  <span data-ttu-id="f6074-177">Por exemplo, "Centro-Sul dos EUA".</span><span class="sxs-lookup"><span data-stu-id="f6074-177">For example: "South Central US".</span></span>
* <span data-ttu-id="f6074-178">*pfxBlobString*: A representação de cadeia de caracteres codificada em base 64 do arquivo .pfx.</span><span class="sxs-lookup"><span data-stu-id="f6074-178">*pfxBlobString*: The based64-encoded string representation of the .pfx file.</span></span> <span data-ttu-id="f6074-179">Use o trecho de código mostrado anteriormente e copie a cadeia de caracteres contida em "exportedcert.pfx.b64".</span><span class="sxs-lookup"><span data-stu-id="f6074-179">Use the code snippet shown earlier and copy the string contained in "exportedcert.pfx.b64".</span></span> <span data-ttu-id="f6074-180">Cole-o como o valor de atributo *pfxBlobString*.</span><span class="sxs-lookup"><span data-stu-id="f6074-180">Paste it in as the value of the *pfxBlobString* attribute.</span></span>
* <span data-ttu-id="f6074-181">*password*: A senha usada para proteger o arquivo .pfx.</span><span class="sxs-lookup"><span data-stu-id="f6074-181">*password*: The password used to secure the .pfx file.</span></span>
* <span data-ttu-id="f6074-182">*certificateThumbprint*: impressão digital do certificado.</span><span class="sxs-lookup"><span data-stu-id="f6074-182">*certificateThumbprint*: The certificate's thumbprint.</span></span> <span data-ttu-id="f6074-183">Se você recuperar esse valor do PowerShell (por exemplo, *$certificate.Thumbprint* do trecho de código anterior), poderá usar o valor como estiver.</span><span class="sxs-lookup"><span data-stu-id="f6074-183">If you retrieve this value from PowerShell (for example, *$certificate.Thumbprint* from the earlier code snippet), you can use the value as is.</span></span> <span data-ttu-id="f6074-184">Se você copiar o valor da caixa de diálogo Certificado Windows, lembre-se de retirar os espaços estranhos.</span><span class="sxs-lookup"><span data-stu-id="f6074-184">If you copy the value from the Windows certificate dialog box, remember to strip out the extraneous spaces.</span></span> <span data-ttu-id="f6074-185">O *certificateThumbprint* deve ser semelhante a: AF3143EB61D43F6727842115BB7F17BBCECAECAE.</span><span class="sxs-lookup"><span data-stu-id="f6074-185">The *certificateThumbprint* should look something like  AF3143EB61D43F6727842115BB7F17BBCECAECAE.</span></span>
* <span data-ttu-id="f6074-186">*certificateName*: um identificador de cadeia de caracteres amigável de sua escolha usado para identificar o certificado.</span><span class="sxs-lookup"><span data-stu-id="f6074-186">*certificateName*: A friendly string identifier of your own choosing used to identity the certificate.</span></span> <span data-ttu-id="f6074-187">O nome é usado como parte do identificador exclusivo do Resource Manager para a entidade *Microsoft.Web/certificates* que representa o certificado SSL.</span><span class="sxs-lookup"><span data-stu-id="f6074-187">The name is used as part of the unique Resource Manager identifier for the *Microsoft.Web/certificates* entity that represents the SSL certificate.</span></span> <span data-ttu-id="f6074-188">O nome *deve* terminar com o seguinte sufixo: \_seuNomeASEAqui_InternalLoadBalancingASE.</span><span class="sxs-lookup"><span data-stu-id="f6074-188">The name *must* end with the following suffix: \_yourASENameHere_InternalLoadBalancingASE.</span></span> <span data-ttu-id="f6074-189">O portal do Azure usa esse sufixo como um indicador de que o certificado é usado para proteger um ASE habilitado por ILB.</span><span class="sxs-lookup"><span data-stu-id="f6074-189">The Azure portal uses this suffix as an indicator that the certificate is used to secure an ILB-enabled ASE.</span></span>

<span data-ttu-id="f6074-190">Um exemplo abreviado de *azuredeploy.parameters.json* é mostrado aqui:</span><span class="sxs-lookup"><span data-stu-id="f6074-190">An abbreviated example of *azuredeploy.parameters.json* is shown here:</span></span>

    {
         "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentParameters.json",
         "contentVersion": "1.0.0.0",
         "parameters": {
              "appServiceEnvironmentName": {
                   "value": "yourASENameHere"
              },
              "existingAseLocation": {
                   "value": "East US 2"
              },
              "pfxBlobString": {
                   "value": "MIIKcAIBAz...snip...snip...pkCAgfQ"
              },
              "password": {
                   "value": "PASSWORDGOESHERE"
              },
              "certificateThumbprint": {
                   "value": "AF3143EB61D43F6727842115BB7F17BBCECAECAE"
              },
              "certificateName": {
                   "value": "DefaultCertificateFor_yourASENameHere_InternalLoadBalancingASE"
              }
         }
    }

<span data-ttu-id="f6074-191">Após o arquivo *azuredeploy.parameters.json* ser preenchido, configure o certificado SSL padrão usando o trecho de código do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="f6074-191">After the *azuredeploy.parameters.json* file is filled in, configure the default SSL certificate by using the PowerShell code snippet.</span></span> <span data-ttu-id="f6074-192">Altere os caminhos do arquivo para corresponder ao local em que os arquivos do modelo do Resource Manager estão localizados no seu computador.</span><span class="sxs-lookup"><span data-stu-id="f6074-192">Change the file paths to match where the Resource Manager template files are located on your machine.</span></span> <span data-ttu-id="f6074-193">Lembre-se de fornecer seus próprios valores para o nome de implantação do Resource Manager e para o nome do grupo de recursos:</span><span class="sxs-lookup"><span data-stu-id="f6074-193">Remember to supply your own values for the Resource Manager deployment name and the resource group name:</span></span>

     $templatePath="PATH\azuredeploy.json"
     $parameterPath="PATH\azuredeploy.parameters.json"

     New-AzureRmResourceGroupDeployment -Name "CHANGEME" -ResourceGroupName "YOUR-RG-NAME-HERE" -TemplateFile $templatePath -TemplateParameterFile $parameterPath

<span data-ttu-id="f6074-194">Leva cerca de 40 minutos por front-end ASE para aplicar a alteração.</span><span class="sxs-lookup"><span data-stu-id="f6074-194">It takes roughly 40 minutes per ASE front end to apply the change.</span></span> <span data-ttu-id="f6074-195">Por exemplo, para um ASE padrão dimensionado que usa dois front-ends, o modelo leva aproximadamente uma hora e 20 minutos para concluir.</span><span class="sxs-lookup"><span data-stu-id="f6074-195">For example, for a default-sized ASE that uses two front ends, the template takes around one hour and 20 minutes to complete.</span></span> <span data-ttu-id="f6074-196">Enquanto o modelo estiver em execução, o ASE não pode ser dimensionado.</span><span class="sxs-lookup"><span data-stu-id="f6074-196">While the template is running, the ASE can't scale.</span></span>  

<span data-ttu-id="f6074-197">Depois que o modelo for concluído, aplicativos em ASE ILB podem ser acessados via HTTPS.</span><span class="sxs-lookup"><span data-stu-id="f6074-197">After the template finishes, apps on the ILB ASE can be accessed over HTTPS.</span></span> <span data-ttu-id="f6074-198">As conexões são protegidas usando o certificado SSL padrão.</span><span class="sxs-lookup"><span data-stu-id="f6074-198">The connections are secured by using the default SSL certificate.</span></span> <span data-ttu-id="f6074-199">O certificado SSL padrão é usado quando aplicativos no ASE ILB forem endereçados utilizando uma combinação de nome do aplicativo com o nome do host padrão.</span><span class="sxs-lookup"><span data-stu-id="f6074-199">The default SSL certificate is used when apps on the ILB ASE are addressed by using a combination of the application name plus the default host name.</span></span> <span data-ttu-id="f6074-200">Por exemplo, https://mycustomapp.internal-contoso.com usa o certificado SSL padrão para **.internal-contoso.com*.</span><span class="sxs-lookup"><span data-stu-id="f6074-200">For example, https://mycustomapp.internal-contoso.com uses the default SSL certificate for **.internal-contoso.com*.</span></span>

<span data-ttu-id="f6074-201">No entanto, assim como os aplicativos que são executados no serviço público multilocatário, os desenvolvedores podem configurar nomes de host personalizados para aplicativos individuais.</span><span class="sxs-lookup"><span data-stu-id="f6074-201">However, just like apps that run on the public multitenant service, developers can configure custom host names for individual apps.</span></span> <span data-ttu-id="f6074-202">Eles também podem configurar associações de certificado SSL SNI exclusivas para aplicativos individuais.</span><span class="sxs-lookup"><span data-stu-id="f6074-202">They also can configure unique SNI SSL certificate bindings for individual apps.</span></span>

## <a name="app-service-environment-v1"></a><span data-ttu-id="f6074-203">Ambiente do Serviço de Aplicativo v1</span><span class="sxs-lookup"><span data-stu-id="f6074-203">App Service Environment v1</span></span> ##
<span data-ttu-id="f6074-204">O Ambiente do Serviço de Aplicativo tem duas versões: ASEv1 e ASEv2.</span><span class="sxs-lookup"><span data-stu-id="f6074-204">App Service Environment has two versions: ASEv1 and ASEv2.</span></span> <span data-ttu-id="f6074-205">As informações anteriores foram baseadas no ASEv2.</span><span class="sxs-lookup"><span data-stu-id="f6074-205">The preceding information was based on ASEv2.</span></span> <span data-ttu-id="f6074-206">Esta seção mostra as diferenças entre o ASEv1 e o ASEv2.</span><span class="sxs-lookup"><span data-stu-id="f6074-206">This section shows you the differences between ASEv1 and ASEv2.</span></span>

<span data-ttu-id="f6074-207">No ASEv1, você gerencia todos os recursos manualmente.</span><span class="sxs-lookup"><span data-stu-id="f6074-207">In ASEv1, you manage all of the resources manually.</span></span> <span data-ttu-id="f6074-208">Isso inclui os front-ends, as funções de trabalho e os endereços IP usados para o SSL baseado em IP.</span><span class="sxs-lookup"><span data-stu-id="f6074-208">That includes the front ends, workers, and IP addresses used for IP-based SSL.</span></span> <span data-ttu-id="f6074-209">Antes de poder escalar horizontalmente o plano do Serviço de Aplicativo, primeiro você deve escalar horizontalmente o pool de trabalho que você deseja hospedar.</span><span class="sxs-lookup"><span data-stu-id="f6074-209">Before you can scale out your App Service plan, you must scale out the worker pool that you want to host it.</span></span>

<span data-ttu-id="f6074-210">O ASEv1 usa um modelo de preço diferente do ASEv2.</span><span class="sxs-lookup"><span data-stu-id="f6074-210">ASEv1 uses a different pricing model from ASEv2.</span></span> <span data-ttu-id="f6074-211">No ASEv1, você paga por cada núcleo alocado.</span><span class="sxs-lookup"><span data-stu-id="f6074-211">In ASEv1, you pay for each core allocated.</span></span> <span data-ttu-id="f6074-212">Isso inclui os núcleos que são usados para front-ends ou funções de trabalho que não hospedam nenhuma carga de trabalho.</span><span class="sxs-lookup"><span data-stu-id="f6074-212">That includes cores that are used for front ends or workers that aren't hosting any workloads.</span></span> <span data-ttu-id="f6074-213">No ASEv1, o tamanho máximo de escala padrão de um ASE é de 55 hosts no total.</span><span class="sxs-lookup"><span data-stu-id="f6074-213">In ASEv1, the default maximum-scale size of an ASE is 55 total hosts.</span></span> <span data-ttu-id="f6074-214">Isso inclui funções de trabalho e front-ends.</span><span class="sxs-lookup"><span data-stu-id="f6074-214">That includes workers and front ends.</span></span> <span data-ttu-id="f6074-215">Uma vantagem do ASEv1 é que ele pode ser implantado em uma rede virtual clássica, bem como em uma rede virtual do Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="f6074-215">One advantage to ASEv1 is that it can be deployed in a classic virtual network and a Resource Manager virtual network.</span></span> <span data-ttu-id="f6074-216">Para saber mais sobre o ASEv1, consulte [Introdução ao Ambiente do Serviço de Aplicativo v1][ASEv1Intro].</span><span class="sxs-lookup"><span data-stu-id="f6074-216">To learn more about ASEv1, see [App Service Environment v1 introduction][ASEv1Intro].</span></span>

<span data-ttu-id="f6074-217">Para criar um ASEv1 usando um modelo do Resource Manager, consulte [Criar um ASE v1 ILB com um modelo do Resource Manager][ILBASEv1Template].</span><span class="sxs-lookup"><span data-stu-id="f6074-217">To create an ASEv1 by using a Resource Manager template, see [Create an ILB ASE v1 with a Resource Manager template][ILBASEv1Template].</span></span>


<!--Links-->
[quickstartilbasecreate]: http://azure.microsoft.com/documentation/templates/201-web-app-asev2-ilb-create
[quickstartasev2create]: http://azure.microsoft.com/documentation/templates/201-web-app-asev2-create
[quickstartconfiguressl]: http://azure.microsoft.com/documentation/templates/201-web-app-ase-ilb-configure-default-ssl
[quickstartwebapponasev2create]: http://azure.microsoft.com/documentation/templates/201-web-app-asp-app-on-asev2-create
[examplebase64encoding]: http://powershellscripts.blogspot.com/2007/02/base64-encode-file.html 
[configuringDefaultSSLCertificate]: https://azure.microsoft.com/documentation/templates/201-web-app-ase-ilb-configure-default-ssl/
[Intro]: ./intro.md
[MakeExternalASE]: ./create-external-ase.md
[MakeASEfromTemplate]: ./create-from-template.md
[MakeILBASE]: ./create-ilb-ase.md
[ASENetwork]: ./network-info.md
[ASEReadme]: ./readme.md
[UsingASE]: ./using-an-ase.md
[UDRs]: ../../virtual-network/virtual-networks-udr-overview.md
[NSGs]: ../../virtual-network/virtual-networks-nsg.md
[ConfigureASEv1]: ../../app-service-web/app-service-web-configure-an-app-service-environment.md
[ASEv1Intro]: ../../app-service-web/app-service-app-service-environment-intro.md
[webapps]: ../../app-service-web/app-service-web-overview.md
[mobileapps]: ../../app-service-mobile/app-service-mobile-value-prop.md
[APIapps]: ../../app-service-api/app-service-api-apps-why-best-platform.md
[Functions]: ../../azure-functions/index.yml
[Pricing]: http://azure.microsoft.com/pricing/details/app-service/
[ARMOverview]: ../../azure-resource-manager/resource-group-overview.md
[ConfigureSSL]: ../../app-service-web/web-sites-purchase-ssl-web-site.md
[Kudu]: http://azure.microsoft.com/resources/videos/super-secret-kudu-debug-console-for-azure-web-sites/
[AppDeploy]: ../../app-service-web/web-sites-deploy.md
[ASEWAF]: ../../app-service-web/app-service-app-service-environment-web-application-firewall.md
[AppGW]: ../../application-gateway/application-gateway-web-application-firewall-overview.md
[ILBASEv1Template]: ../../app-service-web/app-service-app-service-environment-create-ilb-ase-resourcemanager.md
