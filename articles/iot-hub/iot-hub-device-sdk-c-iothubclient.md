---
title: dispositivo de IoT aaaAzure SDK para C - IoTHubClient | Microsoft Docs
description: "Como biblioteca de IoTHubClient toouse Olá no dispositivo de Azure IoT Olá SDK para aplicativos de dispositivo de toocreate C que se comunicam com um hub IoT."
services: iot-hub
documentationcenter: 
author: olivierbloch
manager: timlt
editor: 
ms.assetid: 828cf2bf-999d-4b8a-8a28-c7c901629600
ms.service: iot-hub
ms.devlang: cpp
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 09/06/2016
ms.author: obloch
ms.openlocfilehash: d1ece79e9ba6d1e5fd45cabb8fca393b24052e07
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="azure-iot-device-sdk-for-c--more-about-iothubclient"></a><span data-ttu-id="bb430-103">SDK do dispositivo IoT do Azure para C – mais sobre o IoTHubClient</span><span class="sxs-lookup"><span data-stu-id="bb430-103">Azure IoT device SDK for C – more about IoTHubClient</span></span>
<span data-ttu-id="bb430-104">Olá [primeiro artigo](iot-hub-device-sdk-c-intro.md) em Olá essa série introduzido **dispositivo IoT do Azure SDK para C**. Esse artigo explicou que há duas camadas de arquitetura no SDK.</span><span class="sxs-lookup"><span data-stu-id="bb430-104">hello [first article](iot-hub-device-sdk-c-intro.md) in this series introduced hello **Azure IoT device SDK for C**. That article explained that there are two architectural layers in SDK.</span></span> <span data-ttu-id="bb430-105">Olá base é Olá **IoTHubClient** biblioteca que gerencia a comunicação com o IoT Hub diretamente.</span><span class="sxs-lookup"><span data-stu-id="bb430-105">At hello base is hello **IoTHubClient** library which directly manages communication with IoT Hub.</span></span> <span data-ttu-id="bb430-106">Também há Olá **serializador** biblioteca que se baseia em cima dessa tooprovide serviços de serialização.</span><span class="sxs-lookup"><span data-stu-id="bb430-106">There's also hello **serializer** library that builds on top of that tooprovide serialization services.</span></span> <span data-ttu-id="bb430-107">Neste artigo forneceremos detalhes adicionais sobre Olá **IoTHubClient** biblioteca.</span><span class="sxs-lookup"><span data-stu-id="bb430-107">In this article we'll provide additional detail on hello **IoTHubClient** library.</span></span>

<span data-ttu-id="bb430-108">artigo anterior de saudação descrito como Olá toouse **IoTHubClient** biblioteca toosend eventos tooIoT Hub e receber mensagens.</span><span class="sxs-lookup"><span data-stu-id="bb430-108">hello previous article described how toouse hello **IoTHubClient** library toosend events tooIoT Hub and receive messages.</span></span> <span data-ttu-id="bb430-109">Este artigo estende essa discussão, explicando como precisamente gerenciar toomore *quando* enviar e receber dados, apresentando toohello **APIs de nível inferior**.</span><span class="sxs-lookup"><span data-stu-id="bb430-109">This article extends that discussion by explaining how toomore precisely manage *when* you send and receive data, introducing you toohello **lower-level APIs**.</span></span> <span data-ttu-id="bb430-110">Explicaremos também como tooattach propriedades tooevents (e recuperá-los de mensagens) usando propriedade Olá tratamento recursos Olá **IoTHubClient** biblioteca.</span><span class="sxs-lookup"><span data-stu-id="bb430-110">We'll also explain how tooattach properties tooevents (and retrieve them from messages) using hello property handling features in hello **IoTHubClient** library.</span></span> <span data-ttu-id="bb430-111">Por fim, forneceremos explicação adicional de diferentes maneiras toohandle mensagens recebidas do IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="bb430-111">Finally, we'll provide additional explanation of different ways toohandle messages received from IoT Hub.</span></span>

<span data-ttu-id="bb430-112">Olá artigo conclui abordando alguns dos diversos tópicos, incluindo mais sobre as credenciais do dispositivo e como toochange Olá comportamento de saudação **IoTHubClient** por meio de opções de configuração.</span><span class="sxs-lookup"><span data-stu-id="bb430-112">hello article concludes by covering a couple of miscellaneous topics, including more about device credentials and how toochange hello behavior of hello **IoTHubClient** through configuration options.</span></span>

<span data-ttu-id="bb430-113">Vamos usar Olá **IoTHubClient** SDK exemplos tooexplain esses tópicos.</span><span class="sxs-lookup"><span data-stu-id="bb430-113">We'll use hello **IoTHubClient** SDK samples tooexplain these topics.</span></span> <span data-ttu-id="bb430-114">Se você quiser toofollow ao longo, consulte Olá **hub IOT\_cliente\_exemplo\_http** e **hub IOT\_cliente\_exemplo\_amqp** aplicativos que estão incluídos no dispositivo do hello IoT do Azure SDK para C. tudo descrito nas seções a seguir de saudação é demonstrado nesses exemplos.</span><span class="sxs-lookup"><span data-stu-id="bb430-114">If you want toofollow along, see hello **iothub\_client\_sample\_http** and **iothub\_client\_sample\_amqp** applications that are included in hello Azure IoT device SDK for C. Everything described in hello following sections is demonstrated in these samples.</span></span>

<span data-ttu-id="bb430-115">Você pode encontrar hello [ **dispositivo IoT do Azure SDK para C** ](https://github.com/Azure/azure-iot-sdk-c) GitHub repositório e exibir os detalhes de saudação API no hello [referência da API C](https://azure.github.io/azure-iot-sdk-c/index.html).</span><span class="sxs-lookup"><span data-stu-id="bb430-115">You can find hello [**Azure IoT device SDK for C**](https://github.com/Azure/azure-iot-sdk-c) GitHub repository and view details of hello API in hello [C API reference](https://azure.github.io/azure-iot-sdk-c/index.html).</span></span>

## <a name="hello-lower-level-apis"></a><span data-ttu-id="bb430-116">Olá APIs de nível inferior</span><span class="sxs-lookup"><span data-stu-id="bb430-116">hello lower-level APIs</span></span>
<span data-ttu-id="bb430-117">artigo anterior Olá descrito operação básica de saudação do hello **IotHubClient** no contexto de saudação do hello **hub IOT\_cliente\_exemplo\_amqp** aplicativo.</span><span class="sxs-lookup"><span data-stu-id="bb430-117">hello previous article described hello basic operation of hello **IotHubClient** within hello context of hello **iothub\_client\_sample\_amqp** application.</span></span> <span data-ttu-id="bb430-118">Por exemplo, ele explicado como tooinitialize hello usando esse código de biblioteca.</span><span class="sxs-lookup"><span data-stu-id="bb430-118">For example, it explained how tooinitialize hello library using this code.</span></span>

```
IOTHUB_CLIENT_HANDLE iotHubClientHandle;
iotHubClientHandle = IoTHubClient_CreateFromConnectionString(connectionString, AMQP_Protocol);
```

<span data-ttu-id="bb430-119">Ele também descritos como eventos toosend usando esta chamada de função.</span><span class="sxs-lookup"><span data-stu-id="bb430-119">It also described how toosend events using this function call.</span></span>

```
IoTHubClient_SendEventAsync(iotHubClientHandle, message.messageHandle, SendConfirmationCallback, &message);
```

<span data-ttu-id="bb430-120">Olá Além disso, descreveu como tooreceive mensagens registrando uma função de retorno de chamada.</span><span class="sxs-lookup"><span data-stu-id="bb430-120">hello article also described how tooreceive messages by registering a callback function.</span></span>

```
int receiveContext = 0;
IoTHubClient_SetMessageCallback(iotHubClientHandle, ReceiveMessageCallback, &receiveContext);
```

<span data-ttu-id="bb430-121">artigo Olá também mostrou como recursos toofree usando código como o seguinte hello.</span><span class="sxs-lookup"><span data-stu-id="bb430-121">hello article also showed how toofree resources using code such as hello following.</span></span>

```
IoTHubClient_Destroy(iotHubClientHandle);
```

<span data-ttu-id="bb430-122">No entanto, há complementar funções tooeach dessas APIs:</span><span class="sxs-lookup"><span data-stu-id="bb430-122">However there are companion functions tooeach of these APIs:</span></span>

* <span data-ttu-id="bb430-123">IoTHubClient\_LL\_CreateFromConnectionString</span><span class="sxs-lookup"><span data-stu-id="bb430-123">IoTHubClient\_LL\_CreateFromConnectionString</span></span>
* <span data-ttu-id="bb430-124">IoTHubClient\_LL\_SendEventAsync</span><span class="sxs-lookup"><span data-stu-id="bb430-124">IoTHubClient\_LL\_SendEventAsync</span></span>
* <span data-ttu-id="bb430-125">IoTHubClient\_LL\_SetMessageCallback</span><span class="sxs-lookup"><span data-stu-id="bb430-125">IoTHubClient\_LL\_SetMessageCallback</span></span>
* <span data-ttu-id="bb430-126">IoTHubClient\_LL\_Destroy</span><span class="sxs-lookup"><span data-stu-id="bb430-126">IoTHubClient\_LL\_Destroy</span></span>

<span data-ttu-id="bb430-127">Essas funções todos incluem "Tudo" no nome da API hello.</span><span class="sxs-lookup"><span data-stu-id="bb430-127">These functions all include “LL” in hello API name.</span></span> <span data-ttu-id="bb430-128">Além disso, parâmetros de Olá de cada uma dessas funções são contrapartes de não-LL tootheir idênticos.</span><span class="sxs-lookup"><span data-stu-id="bb430-128">Other than that, hello parameters of each of these functions are identical tootheir non-LL counterparts.</span></span> <span data-ttu-id="bb430-129">No entanto, o comportamento de saudação dessas funções é diferente de uma maneira importante.</span><span class="sxs-lookup"><span data-stu-id="bb430-129">However, hello behavior of these functions is different in one important way.</span></span>

<span data-ttu-id="bb430-130">Quando você chama **IoTHubClient\_CreateFromConnectionString**, bibliotecas subjacente Olá criar um novo thread é executado no plano de fundo de saudação.</span><span class="sxs-lookup"><span data-stu-id="bb430-130">When you call **IoTHubClient\_CreateFromConnectionString**, hello underlying libraries create a new thread that runs in hello background.</span></span> <span data-ttu-id="bb430-131">Esse thread envia eventos para o Hub IoT e recebe mensagens dele.</span><span class="sxs-lookup"><span data-stu-id="bb430-131">This thread sends events to, and receives messages from, IoT Hub.</span></span> <span data-ttu-id="bb430-132">Sem esse thread é criado ao trabalhar com hello "Tudo" APIs.</span><span class="sxs-lookup"><span data-stu-id="bb430-132">No such thread is created when working with hello "LL" APIs.</span></span> <span data-ttu-id="bb430-133">criação de saudação do thread de plano de fundo de saudação é um desenvolvedor de toohello conveniência.</span><span class="sxs-lookup"><span data-stu-id="bb430-133">hello creation of hello background thread is a convenience toohello developer.</span></span> <span data-ttu-id="bb430-134">Você não tem tooworry sobre envio de eventos explicitamente e receber mensagens de IoT Hub – isso acontece automaticamente no plano de fundo de saudação.</span><span class="sxs-lookup"><span data-stu-id="bb430-134">You don’t have tooworry about explicitly sending events and receiving messages from IoT Hub -- it happens automatically in hello background.</span></span> <span data-ttu-id="bb430-135">Por outro lado, Olá "Tudo" APIs oferecem controle explícito sobre a comunicação com o IoT Hub, se necessário.</span><span class="sxs-lookup"><span data-stu-id="bb430-135">In contrast, hello "LL" APIs give you explicit control over communication with IoT Hub, if you need it.</span></span>

<span data-ttu-id="bb430-136">toounderstand essa melhor, vamos examinar um exemplo:</span><span class="sxs-lookup"><span data-stu-id="bb430-136">toounderstand this better, let’s look at an example:</span></span>

<span data-ttu-id="bb430-137">Quando você chama **IoTHubClient\_SendEventAsync**, o que você está fazendo é colocar evento Olá em um buffer.</span><span class="sxs-lookup"><span data-stu-id="bb430-137">When you call **IoTHubClient\_SendEventAsync**, what you're actually doing is putting hello event in a buffer.</span></span> <span data-ttu-id="bb430-138">Olá thread em segundo plano criado quando você chamar **IoTHubClient\_CreateFromConnectionString** continuamente monitora esse buffer e envia os dados que ele contém tooIoT Hub.</span><span class="sxs-lookup"><span data-stu-id="bb430-138">hello background thread created when you call **IoTHubClient\_CreateFromConnectionString** continually monitors this buffer and sends any data that it contains tooIoT Hub.</span></span> <span data-ttu-id="bb430-139">Isso ocorre no plano de fundo de saudação em Olá mesmo tempo em que Olá thread principal está sendo executado outro trabalho.</span><span class="sxs-lookup"><span data-stu-id="bb430-139">This happens in hello background at hello same time that hello main thread is performing other work.</span></span>

<span data-ttu-id="bb430-140">Da mesma forma, quando você registrar uma função de retorno de chamada para mensagens usando **IoTHubClient\_SetMessageCallback**, está solicitando que o plano de fundo do hello SDK toohave Olá thread invocar a função de retorno de chamada hello quando uma mensagem recebida, independentemente do thread principal de saudação.</span><span class="sxs-lookup"><span data-stu-id="bb430-140">Similarly, when you register a callback function for messages using **IoTHubClient\_SetMessageCallback**, you're instructing hello SDK toohave hello background thread invoke hello callback function when a message is received, independent of hello main thread.</span></span>

<span data-ttu-id="bb430-141">Olá "Tudo" APIs não cria um thread em segundo plano.</span><span class="sxs-lookup"><span data-stu-id="bb430-141">hello "LL" APIs don’t create a background thread.</span></span> <span data-ttu-id="bb430-142">Em vez disso, uma nova API deve ser chamado tooexplicitly enviar e receber dados de IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="bb430-142">Instead, a new API must be called tooexplicitly send and receive data from IoT Hub.</span></span> <span data-ttu-id="bb430-143">Isso é demonstrado no exemplo a seguir de saudação.</span><span class="sxs-lookup"><span data-stu-id="bb430-143">This is demonstrated in hello following example.</span></span>

<span data-ttu-id="bb430-144">Olá **hub IOT\_cliente\_exemplo\_http** aplicativo que está incluído no hello SDK demonstra Olá APIs de nível inferior.</span><span class="sxs-lookup"><span data-stu-id="bb430-144">hello **iothub\_client\_sample\_http** application that’s included in hello SDK demonstrates hello lower-level APIs.</span></span> <span data-ttu-id="bb430-145">No exemplo, podemos enviar eventos tooIoT Hub com código como Olá seguinte:</span><span class="sxs-lookup"><span data-stu-id="bb430-145">In that sample, we send events tooIoT Hub with code such as hello following:</span></span>

```
EVENT_INSTANCE message;
sprintf_s(msgText, sizeof(msgText), "Message_%d_From_IoTHubClient_LL_Over_HTTP", i);
message.messageHandle = IoTHubMessage_CreateFromByteArray((const unsigned char*)msgText, strlen(msgText));

IoTHubClient_LL_SendEventAsync(iotHubClientHandle, message.messageHandle, SendConfirmationCallback, &message)
```

<span data-ttu-id="bb430-146">três primeiras linhas Hello criam mensagem de saudação e última linha de saudação envia eventos hello.</span><span class="sxs-lookup"><span data-stu-id="bb430-146">hello first three lines create hello message, and hello last line sends hello event.</span></span> <span data-ttu-id="bb430-147">No entanto, conforme mencionado anteriormente, "envio" evento de saudação significa que os dados de saudação simplesmente são colocados em um buffer.</span><span class="sxs-lookup"><span data-stu-id="bb430-147">However, as mentioned previously, "sending" hello event means that hello data is simply placed in a buffer.</span></span> <span data-ttu-id="bb430-148">Nada é transmitido em rede hello quando chamamos **IoTHubClient\_LL\_SendEventAsync**.</span><span class="sxs-lookup"><span data-stu-id="bb430-148">Nothing is transmitted on hello network when we call **IoTHubClient\_LL\_SendEventAsync**.</span></span> <span data-ttu-id="bb430-149">Em ordem tooactually entrada hello dados tooIoT Hub, você deve chamar **IoTHubClient\_LL\_DoWork**, como no exemplo:</span><span class="sxs-lookup"><span data-stu-id="bb430-149">In order tooactually ingress hello data tooIoT Hub, you must call **IoTHubClient\_LL\_DoWork**, as in this example:</span></span>

```
while (1)
{
    IoTHubClient_LL_DoWork(iotHubClientHandle);
    ThreadAPI_Sleep(1000);
}
```

<span data-ttu-id="bb430-150">Esse código (da saudação **hub IOT\_cliente\_exemplo\_http** aplicativo) chama repetidamente **IoTHubClient\_LL\_DoWork** .</span><span class="sxs-lookup"><span data-stu-id="bb430-150">This code (from hello **iothub\_client\_sample\_http** application) repeatedly calls **IoTHubClient\_LL\_DoWork**.</span></span> <span data-ttu-id="bb430-151">Cada vez que **IoTHubClient\_LL\_DoWork** é chamado, ele envia alguns eventos de saudação buffer tooIoT Hub e recupera uma mensagem na fila de envio toohello dispositivo.</span><span class="sxs-lookup"><span data-stu-id="bb430-151">Each time **IoTHubClient\_LL\_DoWork** is called, it sends some events from hello buffer tooIoT Hub and it retrieves a queued message being sent toohello device.</span></span> <span data-ttu-id="bb430-152">Caso Olá significa que, se é registrado uma função de retorno de chamada para mensagens, em seguida, o retorno de chamada de saudação é invocado (supondo que todas as mensagens são colocadas em fila).</span><span class="sxs-lookup"><span data-stu-id="bb430-152">hello latter case means that if we registered a callback function for messages, then hello callback is invoked (assuming any messages are queued up).</span></span> <span data-ttu-id="bb430-153">Seria registramos uma função de retorno de chamada com o código como Olá seguinte:</span><span class="sxs-lookup"><span data-stu-id="bb430-153">We would have registered such a callback function with code such as hello following:</span></span>

```
IoTHubClient_LL_SetMessageCallback(iotHubClientHandle, ReceiveMessageCallback, &receiveContext)
```

<span data-ttu-id="bb430-154">saudação de motivo que **IoTHubClient\_LL\_DoWork** geralmente é chamado em um loop for que cada vez que ele é chamado, ele envia *alguns* buffer eventos tooIoT Hub e recupera *Olá lado* mensagem na fila para o dispositivo de saudação.</span><span class="sxs-lookup"><span data-stu-id="bb430-154">hello reason that **IoTHubClient\_LL\_DoWork** is often called in a loop is that each time it’s called, it sends *some* buffered events tooIoT Hub and retrieves *hello next* message queued up for hello device.</span></span> <span data-ttu-id="bb430-155">Cada chamada não é garantida em buffer toosend todos os eventos ou enfileiradas tooretrieve todas as mensagens.</span><span class="sxs-lookup"><span data-stu-id="bb430-155">Each call isn’t guaranteed toosend all buffered events or tooretrieve all queued messages.</span></span> <span data-ttu-id="bb430-156">Se você quiser toosend todos os eventos de saudação do buffer e continuam com outro processamento, você pode substituir esse loop por código como Olá seguinte:</span><span class="sxs-lookup"><span data-stu-id="bb430-156">If you want toosend all events in hello buffer and then continue on with other processing you can replace this loop with code such as hello following:</span></span>

```
IOTHUB_CLIENT_STATUS status;

while ((IoTHubClient_LL_GetSendStatus(iotHubClientHandle, &status) == IOTHUB_CLIENT_OK) && (status == IOTHUB_CLIENT_SEND_STATUS_BUSY))
{
    IoTHubClient_LL_DoWork(iotHubClientHandle);
    ThreadAPI_Sleep(1000);
}
```

<span data-ttu-id="bb430-157">Esse código chama **IoTHubClient\_LL\_DoWork** até que todos os eventos no buffer de saudação receberam tooIoT Hub.</span><span class="sxs-lookup"><span data-stu-id="bb430-157">This code calls **IoTHubClient\_LL\_DoWork** until all events in hello buffer have been sent tooIoT Hub.</span></span> <span data-ttu-id="bb430-158">Observe que isso também não significa que todas as mensagens em fila tenham sido recebidas.</span><span class="sxs-lookup"><span data-stu-id="bb430-158">Note this does not also imply that all queued messages have been received.</span></span> <span data-ttu-id="bb430-159">Parte do motivo Olá para isso é que Verificando mensagens "all" não é uma ação como determinista.</span><span class="sxs-lookup"><span data-stu-id="bb430-159">Part of hello reason for this is that checking for "all" messages isn’t as deterministic an action.</span></span> <span data-ttu-id="bb430-160">O que acontece se você recuperar "all" das mensagens de saudação, mas, em seguida, o outro é enviado toohello dispositivo imediatamente após?</span><span class="sxs-lookup"><span data-stu-id="bb430-160">What happens if you retrieve "all" of hello messages, but then another one is sent toohello device immediately after?</span></span> <span data-ttu-id="bb430-161">É uma melhor toodeal de maneira com que com um tempo limite programado.</span><span class="sxs-lookup"><span data-stu-id="bb430-161">A better way toodeal with that is with a programmed timeout.</span></span> <span data-ttu-id="bb430-162">Por exemplo, função de retorno de chamada de mensagem de saudação foi possível redefinir um temporizador toda vez que ele é invocado.</span><span class="sxs-lookup"><span data-stu-id="bb430-162">For example, hello message callback function could reset a timer every time it’s invoked.</span></span> <span data-ttu-id="bb430-163">Você pode então escrever processamento da lógica de toocontinue se, por exemplo, nenhuma mensagem foram recebidas na Olá última *X* segundos.</span><span class="sxs-lookup"><span data-stu-id="bb430-163">You can then write logic toocontinue processing if, for example, no messages have been received in hello last *X* seconds.</span></span>

<span data-ttu-id="bb430-164">Quando você estiver concluído ingressing eventos e receber mensagens, ser toocall se Olá correspondente função tooclean recursos.</span><span class="sxs-lookup"><span data-stu-id="bb430-164">When you’re finished ingressing events and receiving messages, be sure toocall hello corresponding function tooclean up resources.</span></span>

```
IoTHubClient_LL_Destroy(iotHubClientHandle);
```

<span data-ttu-id="bb430-165">Basicamente, há apenas um conjunto de APIs toosend e receber dados de um thread em segundo plano e outro conjunto de APIs que Olá sem thread de segundo plano Olá a mesma coisa.</span><span class="sxs-lookup"><span data-stu-id="bb430-165">Basically there’s only one set of APIs toosend and receive data with a background thread and another set of APIs that does hello same thing without hello background thread.</span></span> <span data-ttu-id="bb430-166">Muitos desenvolvedores podem preferir Olá não - LL APIs, mas hello APIs de nível inferior são úteis quando Olá desenvolvedor deseja ter controle explícito sobre as transmissões de rede.</span><span class="sxs-lookup"><span data-stu-id="bb430-166">A lot of developers may prefer hello non-LL APIs, but hello lower-level APIs are useful when hello developer wants explicit control over network transmissions.</span></span> <span data-ttu-id="bb430-167">Por exemplo, alguns dispositivos coletam dados ao longo do tempo e apenas inserem eventos em intervalos especificados (por exemplo, de hora em hora ou uma vez por dia).</span><span class="sxs-lookup"><span data-stu-id="bb430-167">For example, some devices collect data over time and only ingress events at specified intervals (for example, once an hour or once a day).</span></span> <span data-ttu-id="bb430-168">Olá dê APIs de nível inferior Olá controle de tooexplicitly capacidade ao enviar e receber dados de IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="bb430-168">hello lower-level APIs give you hello ability tooexplicitly control when you send and receive data from IoT Hub.</span></span> <span data-ttu-id="bb430-169">Outros simplesmente preferirão simplicidade Olá que Olá que fornecem APIs de nível inferior.</span><span class="sxs-lookup"><span data-stu-id="bb430-169">Others will simply prefer hello simplicity that hello lower-level APIs provide.</span></span> <span data-ttu-id="bb430-170">Tudo o que acontece no thread principal de saudação em vez de ocorra algum trabalho no plano de fundo de saudação.</span><span class="sxs-lookup"><span data-stu-id="bb430-170">Everything happens on hello main thread rather than some work happening in hello background.</span></span>

<span data-ttu-id="bb430-171">O modelo que você escolher, ser toobe-se consistente no qual APIs que você usar.</span><span class="sxs-lookup"><span data-stu-id="bb430-171">Whichever model you choose, be sure toobe consistent in which APIs you use.</span></span> <span data-ttu-id="bb430-172">Se você iniciar chamando **IoTHubClient\_LL\_CreateFromConnectionString**, certifique-se de que você só usar Olá correspondente APIs de nível inferior para qualquer trabalho de acompanhamento:</span><span class="sxs-lookup"><span data-stu-id="bb430-172">If you start by calling **IoTHubClient\_LL\_CreateFromConnectionString**, be sure you only use hello corresponding lower-level APIs for any follow-up work:</span></span>

* <span data-ttu-id="bb430-173">IoTHubClient\_LL\_SendEventAsync</span><span class="sxs-lookup"><span data-stu-id="bb430-173">IoTHubClient\_LL\_SendEventAsync</span></span>
* <span data-ttu-id="bb430-174">IoTHubClient\_LL\_SetMessageCallback</span><span class="sxs-lookup"><span data-stu-id="bb430-174">IoTHubClient\_LL\_SetMessageCallback</span></span>
* <span data-ttu-id="bb430-175">IoTHubClient\_LL\_Destroy</span><span class="sxs-lookup"><span data-stu-id="bb430-175">IoTHubClient\_LL\_Destroy</span></span>
* <span data-ttu-id="bb430-176">IoTHubClient\_LL\_DoWork</span><span class="sxs-lookup"><span data-stu-id="bb430-176">IoTHubClient\_LL\_DoWork</span></span>

<span data-ttu-id="bb430-177">Olá oposto também é verdadeiro.</span><span class="sxs-lookup"><span data-stu-id="bb430-177">hello opposite is true as well.</span></span> <span data-ttu-id="bb430-178">Se você iniciar com **IoTHubClient\_CreateFromConnectionString**, em seguida, use Olá não - LL APIs para qualquer processamento adicional.</span><span class="sxs-lookup"><span data-stu-id="bb430-178">If you start with **IoTHubClient\_CreateFromConnectionString**, then use hello non-LL APIs for any additional processing.</span></span>

<span data-ttu-id="bb430-179">No dispositivo de IoT do Azure de saudação SDK para C, consulte Olá **hub IOT\_cliente\_exemplo\_http** APIs de nível inferior de aplicativo para um exemplo completo de saudação.</span><span class="sxs-lookup"><span data-stu-id="bb430-179">In hello Azure IoT device SDK for C, see hello **iothub\_client\_sample\_http** application for a complete example of hello lower-level APIs.</span></span> <span data-ttu-id="bb430-180">Olá **hub IOT\_cliente\_exemplo\_amqp** aplicativo pode ser referenciado para obter um exemplo completo de saudação não - LL APIs.</span><span class="sxs-lookup"><span data-stu-id="bb430-180">hello **iothub\_client\_sample\_amqp** application can be referenced for a full example of hello non-LL APIs.</span></span>

## <a name="property-handling"></a><span data-ttu-id="bb430-181">Manipulação de propriedades</span><span class="sxs-lookup"><span data-stu-id="bb430-181">Property handling</span></span>
<span data-ttu-id="bb430-182">Até o momento quando descrevemos o envio de dados, nós já foi referência toohello corpo de mensagem de saudação.</span><span class="sxs-lookup"><span data-stu-id="bb430-182">So far when we've described sending data, we've been referring toohello body of hello message.</span></span> <span data-ttu-id="bb430-183">Por exemplo, considere este código:</span><span class="sxs-lookup"><span data-stu-id="bb430-183">For example, consider this code:</span></span>

```
EVENT_INSTANCE message;
sprintf_s(msgText, sizeof(msgText), "Hello World");
message.messageHandle = IoTHubMessage_CreateFromByteArray((const unsigned char*)msgText, strlen(msgText));
IoTHubClient_LL_SendEventAsync(iotHubClientHandle, message.messageHandle, SendConfirmationCallback, &message)
```

<span data-ttu-id="bb430-184">Este exemplo envia uma mensagem tooIoT Hub com texto de saudação "Olá, mundo".</span><span class="sxs-lookup"><span data-stu-id="bb430-184">This example sends a message tooIoT Hub with hello text "Hello World."</span></span> <span data-ttu-id="bb430-185">No entanto, IoT Hub também permite que a mensagem do propriedades toobe tooeach anexado.</span><span class="sxs-lookup"><span data-stu-id="bb430-185">However, IoT Hub also allows properties toobe attached tooeach message.</span></span> <span data-ttu-id="bb430-186">Propriedades são pares nome/valor que podem ser anexado toohello mensagem.</span><span class="sxs-lookup"><span data-stu-id="bb430-186">Properties are name/value pairs that can be attached toohello message.</span></span> <span data-ttu-id="bb430-187">Por exemplo, podemos modificar tooattach de código anterior Olá uma mensagem de toohello de propriedade:</span><span class="sxs-lookup"><span data-stu-id="bb430-187">For example, we can modify hello previous code tooattach a property toohello message:</span></span>

```
MAP_HANDLE propMap = IoTHubMessage_Properties(message.messageHandle);
sprintf_s(propText, sizeof(propText), "%d", i);
Map_AddOrUpdate(propMap, "SequenceNumber", propText);
```

<span data-ttu-id="bb430-188">Vamos começar chamando **IoTHubMessage\_propriedades** e passando-o identificador de saudação da nossa mensagem.</span><span class="sxs-lookup"><span data-stu-id="bb430-188">We start by calling **IoTHubMessage\_Properties** and passing it hello handle of our message.</span></span> <span data-ttu-id="bb430-189">O que obtemos é um **mapa\_tratar** referência que nos permite toostart Adicionando propriedades.</span><span class="sxs-lookup"><span data-stu-id="bb430-189">What we get back is a **MAP\_HANDLE** reference that enables us toostart adding properties.</span></span> <span data-ttu-id="bb430-190">Olá este último é feito chamando **mapa\_AddOrUpdate**, que usa uma referência tooa mapa\_identificador, o nome da propriedade hello e o valor da propriedade hello.</span><span class="sxs-lookup"><span data-stu-id="bb430-190">hello latter is accomplished by calling **Map\_AddOrUpdate**, which takes a reference tooa MAP\_HANDLE, hello property name, and hello property value.</span></span> <span data-ttu-id="bb430-191">Com essa API, podemos adicionar quantas propriedades quisermos.</span><span class="sxs-lookup"><span data-stu-id="bb430-191">With this API we can add as many properties as we like.</span></span>

<span data-ttu-id="bb430-192">Quando o evento Olá é lido da **Hubs de eventos**, receptor Olá pode enumerar Olá propriedades e recuperar seus valores correspondentes.</span><span class="sxs-lookup"><span data-stu-id="bb430-192">When hello event is read from **Event Hubs**, hello receiver can enumerate hello properties and retrieve their corresponding values.</span></span> <span data-ttu-id="bb430-193">Por exemplo, no .NET isso deve ser feito acessando Olá [coleção de propriedades no objeto de EventData Olá](https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.eventdata.properties.aspx).</span><span class="sxs-lookup"><span data-stu-id="bb430-193">For example, in .NET this would be accomplished by accessing hello [Properties collection on hello EventData object](https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.eventdata.properties.aspx).</span></span>

<span data-ttu-id="bb430-194">No exemplo anterior de saudação, estamos anexando evento tooan de propriedades que enviamos tooIoT Hub.</span><span class="sxs-lookup"><span data-stu-id="bb430-194">In hello previous example, we’re attaching properties tooan event that we send tooIoT Hub.</span></span> <span data-ttu-id="bb430-195">Propriedades também podem ser anexados toomessages recebido do IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="bb430-195">Properties can also be attached toomessages received from IoT Hub.</span></span> <span data-ttu-id="bb430-196">Se quisermos tooretrieve propriedades de uma mensagem, podemos usar código como o seguinte de saudação em nossa função de retorno de chamada de mensagem:</span><span class="sxs-lookup"><span data-stu-id="bb430-196">If we want tooretrieve properties from a message, we can use code such as hello following in our message callback function:</span></span>

```
static IOTHUBMESSAGE_DISPOSITION_RESULT ReceiveMessageCallback(IOTHUB_MESSAGE_HANDLE message, void* userContextCallback)
{
    . . .

    // Retrieve properties from hello message
    MAP_HANDLE mapProperties = IoTHubMessage_Properties(message);
    if (mapProperties != NULL)
    {
        const char*const* keys;
        const char*const* values;
        size_t propertyCount = 0;
        if (Map_GetInternals(mapProperties, &keys, &values, &propertyCount) == MAP_OK)
        {
            if (propertyCount > 0)
            {
                printf("Message Properties:\r\n");
                for (size_t index = 0; index < propertyCount; index++)
                {
                    printf("\tKey: %s Value: %s\r\n", keys[index], values[index]);
                }
                printf("\r\n");
            }
        }
    }

    . . .
}
```

<span data-ttu-id="bb430-197">Olá chamada muito**IoTHubMessage\_propriedades** retorna Olá **mapa\_tratar** referência.</span><span class="sxs-lookup"><span data-stu-id="bb430-197">hello call too**IoTHubMessage\_Properties** returns hello **MAP\_HANDLE** reference.</span></span> <span data-ttu-id="bb430-198">Em seguida, passamos que referenciam muito**mapa\_GetInternals** tooobtain uma matriz de tooan de referência de nome/valor Olá pares (bem como uma contagem de propriedades de saudação).</span><span class="sxs-lookup"><span data-stu-id="bb430-198">We then pass that reference too**Map\_GetInternals** tooobtain a reference tooan array of hello name/value pairs (as well as a count of hello properties).</span></span> <span data-ttu-id="bb430-199">Neste ponto é uma simples questão de enumeração Olá propriedades tooget toohello valores que desejamos.</span><span class="sxs-lookup"><span data-stu-id="bb430-199">At that point it's a simple matter of enumerating hello properties tooget toohello values we want.</span></span>

<span data-ttu-id="bb430-200">Você não tem propriedades toouse em seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="bb430-200">You don't have toouse properties in your application.</span></span> <span data-ttu-id="bb430-201">No entanto, se você precisar tooset-los em eventos ou recuperá-los de mensagens, hello **IoTHubClient** biblioteca torna mais fácil.</span><span class="sxs-lookup"><span data-stu-id="bb430-201">However, if you need tooset them on events or retrieve them from messages, hello **IoTHubClient** library makes it easy.</span></span>

## <a name="message-handling"></a><span data-ttu-id="bb430-202">Manipulação de mensagens</span><span class="sxs-lookup"><span data-stu-id="bb430-202">Message handling</span></span>
<span data-ttu-id="bb430-203">Como mencionado anteriormente, quando chegam mensagens da saudação do IoT Hub **IoTHubClient** biblioteca responde invocando uma função de retorno de chamada registrado.</span><span class="sxs-lookup"><span data-stu-id="bb430-203">As stated previously, when messages arrive from IoT Hub hello **IoTHubClient** library responds by invoking a registered callback function.</span></span> <span data-ttu-id="bb430-204">Há um parâmetro de retorno dessa função que merece uma explicação adicional.</span><span class="sxs-lookup"><span data-stu-id="bb430-204">There is a return parameter of this function that deserves some additional explanation.</span></span> <span data-ttu-id="bb430-205">Aqui está um trecho da função de retorno de chamada de saudação em Olá **hub IOT\_cliente\_exemplo\_http** aplicativo de exemplo:</span><span class="sxs-lookup"><span data-stu-id="bb430-205">Here’s an excerpt of hello callback function in hello **iothub\_client\_sample\_http** sample application:</span></span>

```
static IOTHUBMESSAGE_DISPOSITION_RESULT ReceiveMessageCallback(IOTHUB_MESSAGE_HANDLE message, void* userContextCallback)
{
    . . .
    return IOTHUBMESSAGE_ACCEPTED;
}
```

<span data-ttu-id="bb430-206">Observe que o tipo de retorno de saudação é **IOTHUBMESSAGE\_disposição\_resultados** e neste caso específico retornamos **IOTHUBMESSAGE\_aceito**.</span><span class="sxs-lookup"><span data-stu-id="bb430-206">Note that hello return type is **IOTHUBMESSAGE\_DISPOSITION\_RESULT** and in this particular case we return **IOTHUBMESSAGE\_ACCEPTED**.</span></span> <span data-ttu-id="bb430-207">Há outros valores que podemos voltar por essa função, alterar como Olá **IoTHubClient** biblioteca reage toohello de retorno de chamada de mensagem.</span><span class="sxs-lookup"><span data-stu-id="bb430-207">There are other values we can return from this function that change how hello **IoTHubClient** library reacts toohello message callback.</span></span> <span data-ttu-id="bb430-208">Aqui estão as opções de saudação.</span><span class="sxs-lookup"><span data-stu-id="bb430-208">Here are hello options.</span></span>

* <span data-ttu-id="bb430-209">**IOTHUBMESSAGE\_aceito** – a mensagem de saudação foi processada com êxito.</span><span class="sxs-lookup"><span data-stu-id="bb430-209">**IOTHUBMESSAGE\_ACCEPTED** – hello message has been processed successfully.</span></span> <span data-ttu-id="bb430-210">Olá **IoTHubClient** biblioteca não chamará a função de retorno de chamada hello novamente com hello mesma mensagem.</span><span class="sxs-lookup"><span data-stu-id="bb430-210">hello **IoTHubClient** library will not invoke hello callback function again with hello same message.</span></span>
* <span data-ttu-id="bb430-211">**IOTHUBMESSAGE\_rejeitado** – a mensagem não foi processada e não há nenhum toodo desejo Olá isso no futuro.</span><span class="sxs-lookup"><span data-stu-id="bb430-211">**IOTHUBMESSAGE\_REJECTED** – hello message was not processed and there is no desire toodo so in hello future.</span></span> <span data-ttu-id="bb430-212">Olá **IoTHubClient** biblioteca não deve chamar a função de retorno de chamada hello novamente com hello mesma mensagem.</span><span class="sxs-lookup"><span data-stu-id="bb430-212">hello **IoTHubClient** library should not invoke hello callback function again with hello same message.</span></span>
* <span data-ttu-id="bb430-213">**IOTHUBMESSAGE\_ABANDONADO** – a mensagem não foi processada com êxito, mas Olá **IoTHubClient** biblioteca deve chamar a função de retorno de chamada hello novamente com hello mesma mensagem.</span><span class="sxs-lookup"><span data-stu-id="bb430-213">**IOTHUBMESSAGE\_ABANDONED** – hello message was not processed successfully, but hello **IoTHubClient** library should invoke hello callback function again with hello same message.</span></span>

<span data-ttu-id="bb430-214">Para Olá primeiro dois códigos de retorno, hello **IoTHubClient** biblioteca envia tooIoT uma mensagem indicando que essa mensagem de saudação do Hub deve ser excluído da fila de dispositivo de saudação e não entregue novamente.</span><span class="sxs-lookup"><span data-stu-id="bb430-214">For hello first two return codes, hello **IoTHubClient** library sends a message tooIoT Hub indicating that hello message should be deleted from hello device queue and not delivered again.</span></span> <span data-ttu-id="bb430-215">efeito da saudação é Olá mesmo (mensagem de saudação é excluída da fila de dispositivo de saudação), mas se a mensagem de saudação foi aceitas ou rejeitada ainda é registrada.</span><span class="sxs-lookup"><span data-stu-id="bb430-215">hello net effect is hello same (hello message is deleted from hello device queue), but whether hello message was accepted or rejected is still recorded.</span></span>  <span data-ttu-id="bb430-216">Registrar essa distinção é útil toosenders de mensagem de saudação que pode escutar comentários e descobrir se um dispositivo aceitou ou rejeitou uma mensagem específica.</span><span class="sxs-lookup"><span data-stu-id="bb430-216">Recording this distinction is useful toosenders of hello message who can listen for feedback and find out if a device has accepted or rejected a particular message.</span></span>

<span data-ttu-id="bb430-217">No caso de última Olá uma mensagem também é enviada tooIoT Hub, mas ele indica que essa mensagem de saudação deve ser entregue novamente.</span><span class="sxs-lookup"><span data-stu-id="bb430-217">In hello last case a message is also sent tooIoT Hub, but it indicates that hello message should be redelivered.</span></span> <span data-ttu-id="bb430-218">Normalmente você vai abandonar uma mensagem se você encontrar algum erro tootry tooprocess Olá mensagem novamente.</span><span class="sxs-lookup"><span data-stu-id="bb430-218">Typically you’ll abandon a message if you encounter some error but want tootry tooprocess hello message again.</span></span> <span data-ttu-id="bb430-219">Por outro lado, a rejeição de uma mensagem é apropriado quando você encontrar um erro irrecuperável (ou se você simplesmente decidir que não quer tooprocess mensagem de saudação).</span><span class="sxs-lookup"><span data-stu-id="bb430-219">In contrast, rejecting a message is appropriate when you encounter an unrecoverable error (or if you simply decide you don’t want tooprocess hello message).</span></span>

<span data-ttu-id="bb430-220">Em qualquer caso, lembre-Olá diferentes de códigos de retorno para que você pode extrair o comportamento de saudação desejado Olá **IoTHubClient** biblioteca.</span><span class="sxs-lookup"><span data-stu-id="bb430-220">In any case, be aware of hello different return codes so that you can elicit hello behavior you want from hello **IoTHubClient** library.</span></span>

## <a name="alternate-device-credentials"></a><span data-ttu-id="bb430-221">Credenciais de dispositivo alternativas</span><span class="sxs-lookup"><span data-stu-id="bb430-221">Alternate device credentials</span></span>
<span data-ttu-id="bb430-222">Conforme explicado anteriormente, Olá primeiro toodo ao trabalhar com hello **IoTHubClient** biblioteca é tooobtain uma **hub IOT\_cliente\_tratar** com uma chamada como Olá a seguir:</span><span class="sxs-lookup"><span data-stu-id="bb430-222">As explained previously, hello first thing toodo when working with hello **IoTHubClient** library is tooobtain a **IOTHUB\_CLIENT\_HANDLE** with a call such as hello following:</span></span>

```
IOTHUB_CLIENT_HANDLE iotHubClientHandle;
iotHubClientHandle = IoTHubClient_CreateFromConnectionString(connectionString, AMQP_Protocol);
```

<span data-ttu-id="bb430-223">Olá argumentos muito**IoTHubClient\_CreateFromConnectionString** são cadeia de caracteres de conexão de dispositivo hello e um parâmetro que indica o protocolo de saudação usamos toocommunicate com o IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="bb430-223">hello arguments too**IoTHubClient\_CreateFromConnectionString** are hello device connection string and a parameter that indicates hello protocol we use toocommunicate with IoT Hub.</span></span> <span data-ttu-id="bb430-224">cadeia de caracteres de conexão de dispositivo Olá tem um formato que aparece da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="bb430-224">hello device connection string has a format that appears as follows:</span></span>

```
HostName=IOTHUBNAME.IOTHUBSUFFIX;DeviceId=DEVICEID;SharedAccessKey=SHAREDACCESSKEY
```

<span data-ttu-id="bb430-225">Há quatro tipos de informação nesta cadeia de caracteres: nome do Hub IoT, sufixo do Hub IoT, ID do dispositivo e chave de acesso compartilhado.</span><span class="sxs-lookup"><span data-stu-id="bb430-225">There are four pieces of information in this string: IoT Hub name, IoT Hub suffix, device ID, and shared access key.</span></span> <span data-ttu-id="bb430-226">Obter o nome de domínio totalmente qualificado (FQDN) Olá de um hub IoT quando você cria sua instância do hub IoT no hello portal do Azure — isso fornece o nome do hub IoT hello (Olá primeira parte do hello FQDN) e o sufixo de hub IoT de saudação (restante de saudação do hello FQDN).</span><span class="sxs-lookup"><span data-stu-id="bb430-226">You obtain hello fully qualified domain name (FQDN) of an IoT hub when you create your IoT hub instance in hello Azure portal — this gives you hello IoT hub name (hello first part of hello FQDN) and hello IoT hub suffix (hello rest of hello FQDN).</span></span> <span data-ttu-id="bb430-227">Obter Olá ID do dispositivo e a chave de acesso compartilhado hello quando você registra seu dispositivo com o IoT Hub (conforme descrito em Olá [artigo anterior](iot-hub-device-sdk-c-intro.md)).</span><span class="sxs-lookup"><span data-stu-id="bb430-227">You get hello device ID and hello shared access key when you register your device with IoT Hub (as described in hello [previous article](iot-hub-device-sdk-c-intro.md)).</span></span>

<span data-ttu-id="bb430-228">**IoTHubClient\_CreateFromConnectionString** lhe biblioteca de saudação tooinitialize unidirecional.</span><span class="sxs-lookup"><span data-stu-id="bb430-228">**IoTHubClient\_CreateFromConnectionString** gives you one way tooinitialize hello library.</span></span> <span data-ttu-id="bb430-229">Se preferir, você pode criar um novo **hub IOT\_cliente\_tratar** usando esses parâmetros individuais em vez de cadeia de caracteres de conexão de dispositivo hello.</span><span class="sxs-lookup"><span data-stu-id="bb430-229">If you prefer, you can create a new **IOTHUB\_CLIENT\_HANDLE** by using these individual parameters rather than hello device connection string.</span></span> <span data-ttu-id="bb430-230">Isso é feito com hello código a seguir:</span><span class="sxs-lookup"><span data-stu-id="bb430-230">This is achieved with hello following code:</span></span>

```
IOTHUB_CLIENT_CONFIG iotHubClientConfig;
iotHubClientConfig.iotHubName = "";
iotHubClientConfig.deviceId = "";
iotHubClientConfig.deviceKey = "";
iotHubClientConfig.iotHubSuffix = "";
iotHubClientConfig.protocol = HTTP_Protocol;
IOTHUB_CLIENT_HANDLE iotHubClientHandle = IoTHubClient_LL_Create(&iotHubClientConfig);
```

<span data-ttu-id="bb430-231">Isso é feito Olá mesma coisa que **IoTHubClient\_CreateFromConnectionString**.</span><span class="sxs-lookup"><span data-stu-id="bb430-231">This accomplishes hello same thing as **IoTHubClient\_CreateFromConnectionString**.</span></span>

<span data-ttu-id="bb430-232">Pode parecer óbvio que você desejaria toouse **IoTHubClient\_CreateFromConnectionString** em vez desse método mais detalhado de inicialização.</span><span class="sxs-lookup"><span data-stu-id="bb430-232">It may seem obvious that you would want toouse **IoTHubClient\_CreateFromConnectionString** rather than this more verbose method of initialization.</span></span> <span data-ttu-id="bb430-233">Entretanto, tenha em mente que, ao registrar um dispositivo no Hub IoT, o que obtemos é uma ID de dispositivo e uma chave do dispositivo (e não uma cadeia de conexão).</span><span class="sxs-lookup"><span data-stu-id="bb430-233">Keep in mind, however, that when you register a device in IoT Hub what you get is a device ID and device key (not a connection string).</span></span> <span data-ttu-id="bb430-234">Olá *Gerenciador de dispositivo* ferramenta SDK introduzida no hello [artigo anterior](iot-hub-device-sdk-c-intro.md) usa bibliotecas no hello **SDK do serviço de Azure IoT** cadeia de conexão de dispositivo toocreate saudação do ID do dispositivo Hello, chave do dispositivo e o nome de host do IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="bb430-234">hello *device explorer* SDK tool introduced in hello [previous article](iot-hub-device-sdk-c-intro.md) uses libraries in hello **Azure IoT service SDK** toocreate hello device connection string from hello device ID, device key, and IoT Hub host name.</span></span> <span data-ttu-id="bb430-235">Para chamar **IoTHubClient\_LL\_criar** pode ser preferível porque poupa etapa Olá de gerar uma cadeia de caracteres de conexão.</span><span class="sxs-lookup"><span data-stu-id="bb430-235">So calling **IoTHubClient\_LL\_Create** may be preferable because it saves you hello step of generating a connection string.</span></span> <span data-ttu-id="bb430-236">Use o método que for conveniente.</span><span class="sxs-lookup"><span data-stu-id="bb430-236">Use whichever method is convenient.</span></span>

## <a name="configuration-options"></a><span data-ttu-id="bb430-237">Opções de configuração</span><span class="sxs-lookup"><span data-stu-id="bb430-237">Configuration options</span></span>
<span data-ttu-id="bb430-238">Até agora tudo descrito sobre Olá Olá de maneira **IoTHubClient** biblioteca funciona reflete o comportamento padrão.</span><span class="sxs-lookup"><span data-stu-id="bb430-238">So far everything described about hello way hello **IoTHubClient** library works reflects its default behavior.</span></span> <span data-ttu-id="bb430-239">No entanto, há algumas opções que você pode definir toochange como funciona a biblioteca de saudação.</span><span class="sxs-lookup"><span data-stu-id="bb430-239">However, there are a few options that you can set toochange how hello library works.</span></span> <span data-ttu-id="bb430-240">Isso é feito aproveitando Olá **IoTHubClient\_LL\_SetOption** API.</span><span class="sxs-lookup"><span data-stu-id="bb430-240">This is accomplished by leveraging hello **IoTHubClient\_LL\_SetOption** API.</span></span> <span data-ttu-id="bb430-241">Considere este exemplo:</span><span class="sxs-lookup"><span data-stu-id="bb430-241">Consider this example:</span></span>

```
unsigned int timeout = 30000;
IoTHubClient_LL_SetOption(iotHubClientHandle, "timeout", &timeout);
```

<span data-ttu-id="bb430-242">Há duas opções que normalmente são usadas:</span><span class="sxs-lookup"><span data-stu-id="bb430-242">There are a couple of options that are commonly used:</span></span>

* <span data-ttu-id="bb430-243">**SetBatching** (bool) – se **true**, os dados enviados tooIoT Hub é enviado em lotes.</span><span class="sxs-lookup"><span data-stu-id="bb430-243">**SetBatching** (bool) – If **true**, then data sent tooIoT Hub is sent in batches.</span></span> <span data-ttu-id="bb430-244">Se for **false**, as mensagens serão enviadas individualmente.</span><span class="sxs-lookup"><span data-stu-id="bb430-244">If **false**, then messages are sent individually.</span></span> <span data-ttu-id="bb430-245">saudação padrão é **false**.</span><span class="sxs-lookup"><span data-stu-id="bb430-245">hello default is **false**.</span></span> <span data-ttu-id="bb430-246">Observe que Olá **SetBatching** opção só se aplica a toohello HTTP protocolo e não toohello MQTT ou AMQP protocolos.</span><span class="sxs-lookup"><span data-stu-id="bb430-246">Note that hello **SetBatching** option only applies toohello HTTP protocol and not toohello MQTT or AMQP protocols.</span></span>
* <span data-ttu-id="bb430-247">**Tempo limite** (inteiro não atribuído) – Esse valor é representado em milissegundos.</span><span class="sxs-lookup"><span data-stu-id="bb430-247">**Timeout** (unsigned int) – This value is represented in milliseconds.</span></span> <span data-ttu-id="bb430-248">Se enviar uma solicitação HTTP ou o recebimento de uma resposta demora mais do que esse tempo, em seguida, conexão Olá expire.</span><span class="sxs-lookup"><span data-stu-id="bb430-248">If sending an HTTP request or receiving a response takes longer than this time, then hello connection times out.</span></span>

<span data-ttu-id="bb430-249">Olá, opção de envio em lote é importante.</span><span class="sxs-lookup"><span data-stu-id="bb430-249">hello batching option is important.</span></span> <span data-ttu-id="bb430-250">Por padrão, Olá eventos em bibliotecas de ingresses individualmente (um único evento é tudo o que você passa muito**IoTHubClient\_LL\_SendEventAsync**).</span><span class="sxs-lookup"><span data-stu-id="bb430-250">By default, hello library ingresses events individually (a single event is whatever you pass too**IoTHubClient\_LL\_SendEventAsync**).</span></span> <span data-ttu-id="bb430-251">Se Olá opção de envio em lote é **true**, biblioteca Olá coleta quantos eventos possível de buffer de saudação (backup toohello tamanho máximo da mensagem que aceitará o IoT Hub).</span><span class="sxs-lookup"><span data-stu-id="bb430-251">If hello batching option is **true**, hello library collects as many events as it can from hello buffer (up toohello maximum message size that IoT Hub will accept).</span></span>  <span data-ttu-id="bb430-252">Olá evento lote for enviado tooIoT Hub em uma única chamada HTTP (eventos individuais Olá são agrupados em uma matriz JSON).</span><span class="sxs-lookup"><span data-stu-id="bb430-252">hello event batch is sent tooIoT Hub in a single HTTP call (hello individual events are bundled into a JSON array).</span></span> <span data-ttu-id="bb430-253">A habilitação do envio em lote geralmente resulta em grandes ganhos de desempenho, uma vez que você está reduzindo as viagens de ida e volta da rede.</span><span class="sxs-lookup"><span data-stu-id="bb430-253">Enabling batching typically results in big performance gains since you’re reducing network round-trips.</span></span> <span data-ttu-id="bb430-254">Ela também reduz significativamente a largura de banda, uma vez que você está enviando um conjunto de cabeçalhos HTTP com um lote de evento, em vez de um conjunto de cabeçalhos para cada evento individual.</span><span class="sxs-lookup"><span data-stu-id="bb430-254">It also significantly reduces bandwidth since you are sending one set of HTTP headers with an event batch rather than a set of headers for each individual event.</span></span> <span data-ttu-id="bb430-255">A menos que tenha um motivo específico toodo caso contrário, normalmente você desejará tooenable envio em lote.</span><span class="sxs-lookup"><span data-stu-id="bb430-255">Unless you have a specific reason toodo otherwise, typically you’ll want tooenable batching.</span></span>

## <a name="next-steps"></a><span data-ttu-id="bb430-256">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="bb430-256">Next steps</span></span>
<span data-ttu-id="bb430-257">Este artigo descreve no comportamento de saudação de detalhe de saudação **IoTHubClient** biblioteca encontrado no hello **dispositivo IoT do Azure SDK para C**. Com essas informações, você deve ter uma boa compreensão dos recursos de saudação do hello **IoTHubClient** biblioteca.</span><span class="sxs-lookup"><span data-stu-id="bb430-257">This article describes in detail hello behavior of hello **IoTHubClient** library found in hello **Azure IoT device SDK for C**. With this information, you should have a good understanding of hello capabilities of hello **IoTHubClient** library.</span></span> <span data-ttu-id="bb430-258">Olá [próximo artigo](iot-hub-device-sdk-c-serializer.md) fornece detalhes semelhantes em Olá **serializador** biblioteca.</span><span class="sxs-lookup"><span data-stu-id="bb430-258">hello [next article](iot-hub-device-sdk-c-serializer.md) provides similar detail on hello **serializer** library.</span></span>

<span data-ttu-id="bb430-259">toolearn mais sobre como desenvolver para o IoT Hub, consulte Olá [SDKs do Azure IoT][lnk-sdks].</span><span class="sxs-lookup"><span data-stu-id="bb430-259">toolearn more about developing for IoT Hub, see hello [Azure IoT SDKs][lnk-sdks].</span></span>

<span data-ttu-id="bb430-260">toofurther explorar recursos de saudação do IoT Hub, consulte:</span><span class="sxs-lookup"><span data-stu-id="bb430-260">toofurther explore hello capabilities of IoT Hub, see:</span></span>

* <span data-ttu-id="bb430-261">[Simulando um dispositivo com Azure IoT Edge][lnk-iotedge]</span><span class="sxs-lookup"><span data-stu-id="bb430-261">[Simulating a device with Azure IoT Edge][lnk-iotedge]</span></span>

[lnk-sdks]: iot-hub-devguide-sdks.md

[lnk-iotedge]: iot-hub-linux-iot-edge-simulated-device.md
