---
<span data-ttu-id="98e83-101">título: aaa "lição suplementar do tutorial do Azure Analysis Services: segurança dinâmica | Descrição de Microsoft Docs": descreve como os filtros de segurança dinâmica em toouse usando a linha no tutorial do hello Azure Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="98e83-101">title: aaa"Azure Analysis Services tutorial supplemental lesson: Dynamic security | Microsoft Docs" description: Describes how toouse dynamic security by using row filters in hello Azure Analysis Services tutorial.</span></span>
<span data-ttu-id="98e83-102">serviços: documentationcenter do analysis services: ' autor: manager minewiskan: erikre editor: ' marcas: '</span><span class="sxs-lookup"><span data-stu-id="98e83-102">services: analysis-services documentationcenter: '' author: minewiskan manager: erikre editor: '' tags: ''</span></span>

<span data-ttu-id="98e83-103">MS. AssetID: MS. Service: MS. devlang do analysis services: NA MS. Topic: get-started-article tgt_pltfrm: NA Workload: MS. Date na: 26/05/2017 Author: owend</span><span class="sxs-lookup"><span data-stu-id="98e83-103">ms.assetid: ms.service: analysis-services ms.devlang: NA ms.topic: get-started-article ms.tgt_pltfrm: NA ms.workload: na ms.date: 05/26/2017 ms.author: owend</span></span>
---
# <a name="supplemental-lesson---dynamic-security"></a><span data-ttu-id="98e83-104">Lição suplementar – segurança dinâmica</span><span class="sxs-lookup"><span data-stu-id="98e83-104">Supplemental lesson - Dynamic security</span></span>

[!INCLUDE[analysis-services-appliesto-aas-sql2017-later](../../../includes/analysis-services-appliesto-aas-sql2017-later.md)]

<span data-ttu-id="98e83-105">Nesta lição suplementar, você cria uma função adicional que implementa a segurança dinâmica.</span><span class="sxs-lookup"><span data-stu-id="98e83-105">In this supplemental lesson, you create an additional role that implements dynamic security.</span></span> <span data-ttu-id="98e83-106">Segurança dinâmica oferece segurança no nível de linha com base na id de nome ou o logon de usuário de saudação do usuário Olá conectado no momento.</span><span class="sxs-lookup"><span data-stu-id="98e83-106">Dynamic security provides row-level security based on hello user name or login id of hello user currently logged on.</span></span> 
  
<span data-ttu-id="98e83-107">segurança dinâmica em tooimplement, adicionar um modelo de tooyour de tabela que contém os nomes de usuário Olá desses usuários que podem conectar-se o modelo de toohello e procurar dados e objetos de modelo.</span><span class="sxs-lookup"><span data-stu-id="98e83-107">tooimplement dynamic security, you add a table tooyour model containing hello user names of those users that can connect toohello model and browse model objects and data.</span></span> <span data-ttu-id="98e83-108">modelo Olá que você cria usando este tutorial está no contexto de saudação do Adventure Works; No entanto, toocomplete esta lição, você deve adicionar uma tabela que contém os usuários de seu próprio domínio.</span><span class="sxs-lookup"><span data-stu-id="98e83-108">hello model you create using this tutorial is in hello context of Adventure Works; however, toocomplete this lesson, you must add a table containing users from your own domain.</span></span> <span data-ttu-id="98e83-109">Não é necessário senhas Olá Olá para nomes de usuário que são adicionados.</span><span class="sxs-lookup"><span data-stu-id="98e83-109">You do not need hello passwords for hello user names that are added.</span></span> <span data-ttu-id="98e83-110">toocreate uma tabela EmployeeSecurity, com uma pequena amostra dos usuários de seu próprio domínio, você usa Olá recurso de colar, colando dados de funcionários de uma planilha do Excel.</span><span class="sxs-lookup"><span data-stu-id="98e83-110">toocreate an EmployeeSecurity table, with a small sample of users from your own domain, you use hello Paste feature, pasting employee data from an Excel spreadsheet.</span></span> <span data-ttu-id="98e83-111">Em um cenário do mundo real, tabela Olá contendo nomes de usuário normalmente seria uma tabela de banco de dados real como uma fonte de dados; Por exemplo, uma tabela DimEmployee real.</span><span class="sxs-lookup"><span data-stu-id="98e83-111">In a real-world scenario, hello table containing user names would typically be a table from an actual database as a data source; for example, a real DimEmployee table.</span></span>  
  
<span data-ttu-id="98e83-112">segurança dinâmica em tooimplement, você usar duas funções DAX: [função USERNAME (DAX)](http://msdn.microsoft.com/22dddc4b-1648-4c89-8c93-f1151162b93f) e [função LOOKUPVALUE (DAX)](http://msdn.microsoft.com/73a51c4d-131c-4c33-a139-b1342d10caab).</span><span class="sxs-lookup"><span data-stu-id="98e83-112">tooimplement dynamic security, you use two DAX functions: [USERNAME Function (DAX)](http://msdn.microsoft.com/22dddc4b-1648-4c89-8c93-f1151162b93f) and [LOOKUPVALUE Function (DAX)](http://msdn.microsoft.com/73a51c4d-131c-4c33-a139-b1342d10caab).</span></span> <span data-ttu-id="98e83-113">Essas funções, aplicadas em uma fórmula de filtro de linha, são definidas em uma nova função.</span><span class="sxs-lookup"><span data-stu-id="98e83-113">These functions, applied in a row filter formula, are defined in a new role.</span></span> <span data-ttu-id="98e83-114">Usando a função LOOKUPVALUE hello, fórmula Olá Especifica um valor de tabela de EmployeeSecurity hello.</span><span class="sxs-lookup"><span data-stu-id="98e83-114">By using hello LOOKUPVALUE function, hello formula specifies a value from hello EmployeeSecurity table.</span></span> <span data-ttu-id="98e83-115">fórmula de Hello, em seguida, passa a função USERNAME toohello de valor, que especifica o nome de usuário saudação do usuário Olá conectado pertence toothis função.</span><span class="sxs-lookup"><span data-stu-id="98e83-115">hello formula then passes that value toohello USERNAME function, which specifies hello user name of hello user logged on belongs toothis role.</span></span> <span data-ttu-id="98e83-116">Olá usuário pode procurar apenas nos dados especificados pelos filtros de linha da função hello.</span><span class="sxs-lookup"><span data-stu-id="98e83-116">hello user can then browse only data specified by hello role’s row filters.</span></span> <span data-ttu-id="98e83-117">Nesse cenário, você especificar que os funcionários de vendas só podem procurar dados de vendas pela Internet para territórios de vendas Olá no qual eles são membros.</span><span class="sxs-lookup"><span data-stu-id="98e83-117">In this scenario, you specify that sales employees can only browse Internet sales data for hello sales territories in which they are a member.</span></span>  
  
<span data-ttu-id="98e83-118">As tarefas que são exclusivos toothis cenário de modelo de tabela do Adventure Works, mas não seriam aplicariam necessariamente o cenário do mundo real tooa são identificadas como tal.</span><span class="sxs-lookup"><span data-stu-id="98e83-118">Those tasks that are unique toothis Adventure Works tabular model scenario, but would not necessarily apply tooa real-world scenario are identified as such.</span></span> <span data-ttu-id="98e83-119">Cada tarefa inclui informações adicionais que descreve a finalidade de saudação da tarefa de saudação.</span><span class="sxs-lookup"><span data-stu-id="98e83-119">Each task includes additional information describing hello purpose of hello task.</span></span>  
  
<span data-ttu-id="98e83-120">Estimado tempo toocomplete nesta lição: **30 minutos**</span><span class="sxs-lookup"><span data-stu-id="98e83-120">Estimated time toocomplete this lesson: **30 minutes**</span></span>  
  
## <a name="prerequisites"></a><span data-ttu-id="98e83-121">Pré-requisitos</span><span class="sxs-lookup"><span data-stu-id="98e83-121">Prerequisites</span></span>  
<span data-ttu-id="98e83-122">Este tópico de lição suplementar faz parte de um tutorial de modelagem tabular, que deve ser concluído na devida ordem.</span><span class="sxs-lookup"><span data-stu-id="98e83-122">This supplemental lesson topic is part of a tabular modeling tutorial, which should be completed in order.</span></span> <span data-ttu-id="98e83-123">Antes de executar tarefas de saudação nesta lição suplementar, você deve concluir todas as lições anteriores.</span><span class="sxs-lookup"><span data-stu-id="98e83-123">Before performing hello tasks in this supplemental lesson, you should have completed all previous lessons.</span></span>  
  
## <a name="add-hello-dimsalesterritory-table-toohello-aw-internet-sales-tabular-model-project"></a><span data-ttu-id="98e83-124">Adicionar Olá DimSalesTerritory tabela toohello projeto de modelo Tabular do AW Internet Sales</span><span class="sxs-lookup"><span data-stu-id="98e83-124">Add hello DimSalesTerritory table toohello AW Internet Sales Tabular Model Project</span></span>  
<span data-ttu-id="98e83-125">tooimplement segurança dinâmica para este cenário do Adventure Works, você deve adicionar o modelo de tooyour duas tabelas adicionais.</span><span class="sxs-lookup"><span data-stu-id="98e83-125">tooimplement dynamic security for this Adventure Works scenario, you must add two additional tables tooyour model.</span></span> <span data-ttu-id="98e83-126">tabela do primeiro Olá você adicionar é DimSalesTerritory (como Sales Territory) do hello mesmo banco de dados AdventureWorksDW.</span><span class="sxs-lookup"><span data-stu-id="98e83-126">hello first table you add is DimSalesTerritory (as Sales Territory) from hello same AdventureWorksDW database.</span></span> <span data-ttu-id="98e83-127">Você aplicar posteriormente uma tabela de SalesTerritory de toohello de filtro de linha que define os dados específicos de saudação saudação do usuário conectada pode procurar.</span><span class="sxs-lookup"><span data-stu-id="98e83-127">You later apply a row filter toohello SalesTerritory table that defines hello particular data hello logged on user can browse.</span></span>  
  
#### <a name="tooadd-hello-dimsalesterritory-table"></a><span data-ttu-id="98e83-128">tabela de DimSalesTerritory tooadd Olá</span><span class="sxs-lookup"><span data-stu-id="98e83-128">tooadd hello DimSalesTerritory table</span></span>  
  
1.  <span data-ttu-id="98e83-129">Em Gerenciador de Modelos tabulares > **Fontes de Dados**, clique com o botão direito do mouse em sua conexão e clique em **Importar Novas Tabelas**.</span><span class="sxs-lookup"><span data-stu-id="98e83-129">In Tabular Model Explorer > **Data Sources**, right-click your connection, and then click **Import New Tables**.</span></span>  

    <span data-ttu-id="98e83-130">Se for exibida a caixa de diálogo de credenciais de representação Olá, digite as credenciais de representação de saudação usado na lição 2: adicionar dados.</span><span class="sxs-lookup"><span data-stu-id="98e83-130">If hello Impersonation Credentials dialog box appears, type hello impersonation credentials you used in Lesson 2: Add Data.</span></span>
  
2.  <span data-ttu-id="98e83-131">No navegador, selecione Olá **DimSalesTerritory** de tabela e, em seguida, clique em **Okey**.</span><span class="sxs-lookup"><span data-stu-id="98e83-131">In Navigator, select hello **DimSalesTerritory** table, and then click **OK**.</span></span>    
  
3.  <span data-ttu-id="98e83-132">No Editor de consultas, clique em Olá **DimSalesTerritory** de consulta e, em seguida, remover **SalesTerritoryAlternateKey** coluna.</span><span class="sxs-lookup"><span data-stu-id="98e83-132">In Query Editor, click hello **DimSalesTerritory** query, and then remove **SalesTerritoryAlternateKey** column.</span></span>  
  
7.  <span data-ttu-id="98e83-133">Clique em **Importar**.</span><span class="sxs-lookup"><span data-stu-id="98e83-133">Click **Import**.</span></span>  
  
    <span data-ttu-id="98e83-134">Olá nova tabela será adicionada toohello espaço de trabalho do modelo.</span><span class="sxs-lookup"><span data-stu-id="98e83-134">hello new table is added toohello model workspace.</span></span> <span data-ttu-id="98e83-135">Objetos e dados Olá DimSalesTerritory da tabela de origem, em seguida, são importados para o modelo de tabela de vendas de Internet AW.</span><span class="sxs-lookup"><span data-stu-id="98e83-135">Objects and data from hello source DimSalesTerritory table are then imported into your AW Internet Sales Tabular Model.</span></span>  
  
9. <span data-ttu-id="98e83-136">Depois de tabela Olá foi importada com êxito, clique em **fechar**.</span><span class="sxs-lookup"><span data-stu-id="98e83-136">After hello table has been imported successfully, click **Close**.</span></span>  

## <a name="add-a-table-with-user-name-data"></a><span data-ttu-id="98e83-137">Adicionar uma tabela com os dados de nome de usuário</span><span class="sxs-lookup"><span data-stu-id="98e83-137">Add a table with user name data</span></span>  
<span data-ttu-id="98e83-138">tabela do Hello DimEmployee no banco de dados do exemplo hello AdventureWorksDW contém usuários do domínio de AdventureWorks da saudação.</span><span class="sxs-lookup"><span data-stu-id="98e83-138">hello DimEmployee table in hello AdventureWorksDW sample database contains users from hello AdventureWorks domain.</span></span> <span data-ttu-id="98e83-139">Esses nomes de usuários não existem em seu ambiente.</span><span class="sxs-lookup"><span data-stu-id="98e83-139">Those user names do not exist in your own environment.</span></span> <span data-ttu-id="98e83-140">Você deve criar uma tabela em seu modelo que contenha um exemplo pequeno (pelo menos três) de usuários reais de sua organização.</span><span class="sxs-lookup"><span data-stu-id="98e83-140">You must create a table in your model that contains a small sample (at least three) of actual users from your organization.</span></span> <span data-ttu-id="98e83-141">Você, em seguida, adicionar esses usuários como nova função de toohello de membros.</span><span class="sxs-lookup"><span data-stu-id="98e83-141">You then add these users as members toohello new role.</span></span> <span data-ttu-id="98e83-142">Você não precisa senhas Olá para nomes de usuário de exemplo hello, mas é necessário nomes de usuário do Windows reais de seu próprio domínio.</span><span class="sxs-lookup"><span data-stu-id="98e83-142">You do not need hello passwords for hello sample user names, but you do need actual Windows user names from your own domain.</span></span>  
  
#### <a name="tooadd-an-employeesecurity-table"></a><span data-ttu-id="98e83-143">tooadd uma tabela EmployeeSecurity</span><span class="sxs-lookup"><span data-stu-id="98e83-143">tooadd an EmployeeSecurity table</span></span>  
  
1.  <span data-ttu-id="98e83-144">Abra o Microsoft Excel e crie uma planilha.</span><span class="sxs-lookup"><span data-stu-id="98e83-144">Open Microsoft Excel, creating a worksheet.</span></span>  
  
2.  <span data-ttu-id="98e83-145">Copie Olá tabela, incluindo a linha de cabeçalho hello, a seguir e cole-o na planilha de saudação.</span><span class="sxs-lookup"><span data-stu-id="98e83-145">Copy hello following table, including hello header row, and then paste it into hello worksheet.</span></span>  

    ```
      |EmployeeId|SalesTerritoryId|FirstName|LastName|LoginId|  
      |---------------|----------------------|--------------|-------------|------------|  
      |1|2|<user first name>|<user last name>|\<domain\username>|  
      |1|3|<user first name>|<user last name>|\<domain\username>|  
      |2|4|<user first name>|<user last name>|\<domain\username>|  
      |3|5|<user first name>|<user last name>|\<domain\username>|  
    ```

3.  <span data-ttu-id="98e83-146">Substitua saudação primeiro nome, sobrenome e domínio ome de usuário com nomes de saudação e ids de logon de três usuários em sua organização.</span><span class="sxs-lookup"><span data-stu-id="98e83-146">Replace hello first name, last name, and domain\username with hello names and login ids of three users in your organization.</span></span> <span data-ttu-id="98e83-147">Colocar Olá mesmo usuário em Olá duas primeiras linhas, para 1 EmployeeId, mostrando a este usuário pertence toomore que um território de vendas.</span><span class="sxs-lookup"><span data-stu-id="98e83-147">Put hello same user on hello first two rows, for EmployeeId 1, showing this user belongs toomore than one sales territory.</span></span> <span data-ttu-id="98e83-148">Deixe Olá campos EmployeeId e SalesTerritoryId como estão.</span><span class="sxs-lookup"><span data-stu-id="98e83-148">Leave hello EmployeeId and SalesTerritoryId fields as they are.</span></span>  
  
4.  <span data-ttu-id="98e83-149">Salvar a planilha hello como **SampleEmployee**.</span><span class="sxs-lookup"><span data-stu-id="98e83-149">Save hello worksheet as **SampleEmployee**.</span></span>  
  
5.  <span data-ttu-id="98e83-150">Na planilha de hello, selecione todas as células de saudação com dados de funcionário, incluindo os cabeçalhos de hello, em seguida, clique dados saudação selecionado e, em seguida, clique em **cópia**.</span><span class="sxs-lookup"><span data-stu-id="98e83-150">In hello worksheet, select all hello cells with employee data, including hello headers, then right-click hello selected data, and then click **Copy**.</span></span>  
  
6.  <span data-ttu-id="98e83-151">No SSDT, clique em Olá **editar** menu e clique **colar**.</span><span class="sxs-lookup"><span data-stu-id="98e83-151">In SSDT, click hello **Edit** menu, and then click **Paste**.</span></span>  
  
    <span data-ttu-id="98e83-152">Se colar estiver esmaecido, clique em qualquer coluna em qualquer tabela na janela de designer de modelo hello e tente novamente.</span><span class="sxs-lookup"><span data-stu-id="98e83-152">If Paste is grayed out, click any column in any table in hello model designer window, and try again.</span></span>  
  
7.  <span data-ttu-id="98e83-153">Em Olá **visualização de colagem** na caixa **nome de tabela**, tipo **EmployeeSecurity**.</span><span class="sxs-lookup"><span data-stu-id="98e83-153">In hello **Paste Preview** dialog box, in **Table Name**, type **EmployeeSecurity**.</span></span>  
  
8.  <span data-ttu-id="98e83-154">Em **toobe dados colado**, verifique se dados saudação incluem todos os dados de saudação do usuário e cabeçalhos de planilha de SampleEmployee hello.</span><span class="sxs-lookup"><span data-stu-id="98e83-154">In **Data toobe pasted**, verify hello data includes all hello user data and headers from hello SampleEmployee worksheet.</span></span>  
  
9. <span data-ttu-id="98e83-155">Verifique se a opção **Usar primeira linha como cabeçalhos de coluna** está marcada e clique em **Ok**.</span><span class="sxs-lookup"><span data-stu-id="98e83-155">Verify **Use first row as column headers** is checked, and then click **Ok**.</span></span>  
  
    <span data-ttu-id="98e83-156">Uma nova tabela denominada EmployeeSecurity com dados de funcionário copiados da planilha de SampleEmployee Olá é criada.</span><span class="sxs-lookup"><span data-stu-id="98e83-156">A new table named EmployeeSecurity with employee data copied from hello SampleEmployee worksheet is created.</span></span>  
  
## <a name="create-relationships-between-factinternetsales-dimgeography-and-dimsalesterritory-table"></a><span data-ttu-id="98e83-157">Criar relações entre as tabelas FactInternetSales, DimGeography e DimSalesTerritory</span><span class="sxs-lookup"><span data-stu-id="98e83-157">Create relationships between FactInternetSales, DimGeography, and DimSalesTerritory table</span></span>  
<span data-ttu-id="98e83-158">Olá FactInternetSales, DimGeography e DimSalesTerritory tabelas contém uma coluna comum, SalesTerritoryId.</span><span class="sxs-lookup"><span data-stu-id="98e83-158">hello FactInternetSales, DimGeography, and DimSalesTerritory table all contain a common column, SalesTerritoryId.</span></span> <span data-ttu-id="98e83-159">coluna de SalesTerritoryId de saudação na tabela de DimSalesTerritory Olá contém valores com uma Id diferente para cada região de vendas.</span><span class="sxs-lookup"><span data-stu-id="98e83-159">hello SalesTerritoryId column in hello DimSalesTerritory table contains values with a different Id for each sales territory.</span></span>  
  
#### <a name="toocreate-relationships-between-hello-factinternetsales-dimgeography-and-hello-dimsalesterritory-table"></a><span data-ttu-id="98e83-160">relações de toocreate entre Olá FactInternetSales, DimGeography e tabela de DimSalesTerritory Olá</span><span class="sxs-lookup"><span data-stu-id="98e83-160">toocreate relationships between hello FactInternetSales, DimGeography, and hello DimSalesTerritory table</span></span>  
  
1.  <span data-ttu-id="98e83-161">Na exibição de diagrama no hello **DimGeography** de tabela, clique e mantenha Olá **SalesTerritoryId** coluna, em seguida, arraste Olá cursor toohello **SalesTerritoryId** coluna Olá **DimSalesTerritory** de tabela e, em seguida, solte.</span><span class="sxs-lookup"><span data-stu-id="98e83-161">In Diagram View, in hello **DimGeography** table, click, and hold on hello **SalesTerritoryId** column, then drag hello cursor toohello **SalesTerritoryId** column in hello **DimSalesTerritory** table, and then release.</span></span>  
  
2.  <span data-ttu-id="98e83-162">Em Olá **FactInternetSales** de tabela, clique e mantenha Olá **SalesTerritoryId** coluna, em seguida, arraste Olá cursor toohello **SalesTerritoryId** coluna Olá  **DimSalesTerritory** da tabela e, em seguida, solte.</span><span class="sxs-lookup"><span data-stu-id="98e83-162">In hello **FactInternetSales** table, click, and hold on hello **SalesTerritoryId** column, then drag hello cursor toohello **SalesTerritoryId** column in hello **DimSalesTerritory** table, and then release.</span></span>  
  
    <span data-ttu-id="98e83-163">Olá aviso propriedade ativa desta relação é False, o que significa que ele está inativo.</span><span class="sxs-lookup"><span data-stu-id="98e83-163">Notice hello Active property for this relationship is False, meaning it's inactive.</span></span> <span data-ttu-id="98e83-164">tabela de FactInternetSales Olá já tem outra relação ativa.</span><span class="sxs-lookup"><span data-stu-id="98e83-164">hello FactInternetSales table already has another active relationship.</span></span>  
  
## <a name="hide-hello-employeesecurity-table-from-client-applications"></a><span data-ttu-id="98e83-165">Ocultar Olá EmployeeSecurity tabela de aplicativos cliente</span><span class="sxs-lookup"><span data-stu-id="98e83-165">Hide hello EmployeeSecurity Table from client applications</span></span>  
<span data-ttu-id="98e83-166">Nesta tarefa, você ocultar tabela de EmployeeSecurity hello, impedindo que ela apareça na lista de campos de um aplicativo cliente.</span><span class="sxs-lookup"><span data-stu-id="98e83-166">In this task, you hide hello EmployeeSecurity table, keeping it from appearing in a client application’s field list.</span></span> <span data-ttu-id="98e83-167">Lembre-se de que a ocultação de uma tabela não a protege.</span><span class="sxs-lookup"><span data-stu-id="98e83-167">Keep in mind that hiding a table does not secure it.</span></span> <span data-ttu-id="98e83-168">Se souberem como, os usuários ainda poderão consultar os dados da tabela EmployeeSecurity.</span><span class="sxs-lookup"><span data-stu-id="98e83-168">Users can still query EmployeeSecurity table data if they know how.</span></span> <span data-ttu-id="98e83-169">toosecure Olá EmployeeSecurity dados da tabela, impedindo que os usuários que estão sendo tooquery capaz de qualquer um dos seus dados, aplicar um filtro em uma tarefa posterior.</span><span class="sxs-lookup"><span data-stu-id="98e83-169">toosecure hello EmployeeSecurity table data, preventing users from being able tooquery any of its data, you apply a filter in a later task.</span></span>  
  
#### <a name="toohide-hello-employeesecurity-table-from-client-applications"></a><span data-ttu-id="98e83-170">tabela de EmployeeSecurity toohide Olá de aplicativos cliente</span><span class="sxs-lookup"><span data-stu-id="98e83-170">toohide hello EmployeeSecurity table from client applications</span></span>  
  
-   <span data-ttu-id="98e83-171">No designer de modelo hello, na exibição de diagrama, clique com botão direito Olá **funcionário** cabeçalho de tabela e, em seguida, clique em **ocultar das ferramentas de cliente**.</span><span class="sxs-lookup"><span data-stu-id="98e83-171">In hello model designer, in Diagram View, right-click hello **Employee** table heading, and then click **Hide from Client Tools**.</span></span>  
  
## <a name="create-a-sales-employees-by-territory-user-role"></a><span data-ttu-id="98e83-172">Criar uma função de usuário de Funcionários de Vendas por Região</span><span class="sxs-lookup"><span data-stu-id="98e83-172">Create a Sales Employees by Territory user role</span></span>  
<span data-ttu-id="98e83-173">Nesta tarefa, você deve criar uma função de usuário.</span><span class="sxs-lookup"><span data-stu-id="98e83-173">In this task, you create a user role.</span></span> <span data-ttu-id="98e83-174">Essa função inclui um filtro de linha que define quais linhas da tabela de DimSalesTerritory Olá são toousers visível.</span><span class="sxs-lookup"><span data-stu-id="98e83-174">This role includes a row filter defining which rows of hello DimSalesTerritory table are visible toousers.</span></span> <span data-ttu-id="98e83-175">Olá filtro é aplicado em relação um-para-muitos da saudação direção tooall outras tabelas relacionada tooDimSalesTerritory.</span><span class="sxs-lookup"><span data-stu-id="98e83-175">hello filter is then applied in hello one-to-many relationship direction tooall other tables related tooDimSalesTerritory.</span></span> <span data-ttu-id="98e83-176">Você também pode aplicar um filtro que protege a tabela de consulta por qualquer usuário que seja membro da função de saudação do hello inteira EmployeeSecurity.</span><span class="sxs-lookup"><span data-stu-id="98e83-176">You also apply a filter that secures hello entire EmployeeSecurity table from being queryable by any user that is a member of hello role.</span></span>  
  
> [!NOTE]  
> <span data-ttu-id="98e83-177">Olá funcionários de vendas por função Territory criada nesta lição restringe os membros toobrowse (consulta) apenas dados de vendas ou para Olá território de vendas toowhich pertencem.</span><span class="sxs-lookup"><span data-stu-id="98e83-177">hello Sales Employees by Territory role you create in this lesson restricts members toobrowse (or query) only sales data for hello sales territory toowhich they belong.</span></span> <span data-ttu-id="98e83-178">Se você adicionar um usuário como um membro toohello funcionários de vendas pela função de território que também existe como um membro em uma função criada em [lição 11: criar funções](../tutorials/aas-lesson-11-create-roles.md), você obtém uma combinação de permissões.</span><span class="sxs-lookup"><span data-stu-id="98e83-178">If you add a user as a member toohello Sales Employees by Territory role that also exists as a member in a role created in [Lesson 11: Create Roles](../tutorials/aas-lesson-11-create-roles.md), you get a combination of permissions.</span></span> <span data-ttu-id="98e83-179">Quando um usuário for um membro de várias funções, permissões de saudação e filtros de linha definidos para cada função serão cumulativas.</span><span class="sxs-lookup"><span data-stu-id="98e83-179">When a user is a member of multiple roles, hello permissions, and row filters defined for each role are cumulative.</span></span> <span data-ttu-id="98e83-180">Ou seja, o usuário Olá tem permissões de maior Olá determinadas pela combinação de saudação de funções.</span><span class="sxs-lookup"><span data-stu-id="98e83-180">That is, hello user has hello greater permissions determined by hello combination of roles.</span></span>  
  
#### <a name="toocreate-a-sales-employees-by-territory-user-role"></a><span data-ttu-id="98e83-181">toocreate um funcionários de vendas por função de usuário de território</span><span class="sxs-lookup"><span data-stu-id="98e83-181">toocreate a Sales Employees by Territory user role</span></span>  
  
1.  <span data-ttu-id="98e83-182">No SSDT, clique em Olá **modelo** menu e clique **funções**.</span><span class="sxs-lookup"><span data-stu-id="98e83-182">In SSDT, click hello **Model** menu, and then click **Roles**.</span></span>  
  
2.  <span data-ttu-id="98e83-183">No **Gerenciador de Funções**, clique em **Novo**.</span><span class="sxs-lookup"><span data-stu-id="98e83-183">In **Role Manager**, click **New**.</span></span>  
  
    <span data-ttu-id="98e83-184">Uma nova função com hello nenhuma permissão é adicionado toohello lista.</span><span class="sxs-lookup"><span data-stu-id="98e83-184">A new role with hello None permission is added toohello list.</span></span>  
  
3.  <span data-ttu-id="98e83-185">Clique em nova função de Olá e, em seguida, em Olá **nome** coluna, renomeie a função hello muito**funcionários de vendas por território**.</span><span class="sxs-lookup"><span data-stu-id="98e83-185">Click hello new role, and then in hello **Name** column, rename hello role too**Sales Employees by Territory**.</span></span>  
  
4.  <span data-ttu-id="98e83-186">Em Olá **permissões** coluna, clique em lista suspensa de saudação e selecione Olá **leitura** permissão.</span><span class="sxs-lookup"><span data-stu-id="98e83-186">In hello **Permissions** column, click hello dropdown list, and then select hello **Read** permission.</span></span>  
  
5.  <span data-ttu-id="98e83-187">Clique em Olá **membros** guia e, em seguida, clique em **adicionar**.</span><span class="sxs-lookup"><span data-stu-id="98e83-187">Click hello **Members** tab, and then click **Add**.</span></span>  
  
6.  <span data-ttu-id="98e83-188">Em Olá **Selecionar usuário ou grupo** na caixa **objeto de saudação Enter denominado tooselect**, tipo hello primeiro exemplo nome de usuário usado ao criar a tabela de EmployeeSecurity hello.</span><span class="sxs-lookup"><span data-stu-id="98e83-188">In hello **Select User or Group** dialog box, in **Enter hello object named tooselect**, type hello first sample user name you used when creating hello EmployeeSecurity table.</span></span> <span data-ttu-id="98e83-189">Clique em **verificar nomes** tooverify nome de usuário de saudação é válido e, em seguida, clique em **Okey**.</span><span class="sxs-lookup"><span data-stu-id="98e83-189">Click **Check Names** tooverify hello user name is valid, and then click **Ok**.</span></span>  
  
    <span data-ttu-id="98e83-190">Repita essa etapa, adicionando Olá outros exemplos de nomes de usuário usado ao criar a tabela de EmployeeSecurity hello.</span><span class="sxs-lookup"><span data-stu-id="98e83-190">Repeat this step, adding hello other sample user names you used when creating hello EmployeeSecurity table.</span></span>  
  
7.  <span data-ttu-id="98e83-191">Clique em Olá **filtros de linha** guia.</span><span class="sxs-lookup"><span data-stu-id="98e83-191">Click hello **Row Filters** tab.</span></span>  
  
8.  <span data-ttu-id="98e83-192">Para Olá **EmployeeSecurity** tabela Olá **filtro DAX** coluna, Olá tipo seguinte fórmula:</span><span class="sxs-lookup"><span data-stu-id="98e83-192">For hello **EmployeeSecurity** table, in hello **DAX Filter** column, type hello following formula:</span></span>  
  
    ```
      =FALSE()  
    ```
  
    <span data-ttu-id="98e83-193">Esta fórmula Especifica que todas as colunas são resolvidas condição booliana false de toohello.</span><span class="sxs-lookup"><span data-stu-id="98e83-193">This formula specifies that all columns resolve toohello false Boolean condition.</span></span> <span data-ttu-id="98e83-194">Nenhuma coluna da tabela de EmployeeSecurity Olá pode ser consultada por um membro da saudação funcionários de vendas por função de usuário de território.</span><span class="sxs-lookup"><span data-stu-id="98e83-194">No columns for hello EmployeeSecurity table can be queried by a member of hello Sales Employees by Territory user role.</span></span>  
  
9. <span data-ttu-id="98e83-195">Para Olá **DimSalesTerritory** tabela, Olá tipo seguinte fórmula:</span><span class="sxs-lookup"><span data-stu-id="98e83-195">For hello **DimSalesTerritory** table, type hello following formula:</span></span>  

    ```  
    ='Sales Territory'[Sales Territory Id]=LOOKUPVALUE('Employee Security'[Sales Territory Id], 
      'Employee Security'[Login Id], USERNAME(), 
      'Employee Security'[Sales Territory Id], 
      'Sales Territory'[Sales Territory Id]) 
    ```
  
    <span data-ttu-id="98e83-196">Nesta fórmula, Olá função LOOKUPVALUE retorna todos os valores para a coluna de DimEmployeeSecurity [SalesTerritoryId] hello, onde hello EmployeeSecurity [LoginId] é Olá mesmo como Olá atual do logon de nome de usuário do Windows e EmployeeSecurity [ SalesTerritoryId] é Olá igual a saudação DimSalesTerritory [SalesTerritoryId].</span><span class="sxs-lookup"><span data-stu-id="98e83-196">In this formula, hello LOOKUPVALUE function returns all values for hello DimEmployeeSecurity[SalesTerritoryId] column, where hello EmployeeSecurity[LoginId] is hello same as hello current logged on Windows user name, and EmployeeSecurity[SalesTerritoryId] is hello same as hello DimSalesTerritory[SalesTerritoryId].</span></span>  
  
    <span data-ttu-id="98e83-197">Olá conjunto de IDs de território de vendas retornado por LOOKUPVALUE é usado toorestrict Olá linhas mostradas na tabela DimSalesTerritory de saudação.</span><span class="sxs-lookup"><span data-stu-id="98e83-197">hello set of sales territory IDs returned by LOOKUPVALUE is then used toorestrict hello rows shown in hello DimSalesTerritory table.</span></span> <span data-ttu-id="98e83-198">Somente as linhas onde hello SalesTerritoryID para linha hello está no conjunto de saudação de IDs retornadas pela função LOOKUPVALUE de saudação são exibidas.</span><span class="sxs-lookup"><span data-stu-id="98e83-198">Only rows where hello SalesTerritoryID for hello row is in hello set of IDs returned by hello LOOKUPVALUE function are displayed.</span></span>  
  
10. <span data-ttu-id="98e83-199">Em Gerenciador de Funções, clique em **Ok**.</span><span class="sxs-lookup"><span data-stu-id="98e83-199">In Role Manager, click **Ok**.</span></span>  
  
## <a name="test-hello-sales-employees-by-territory-user-role"></a><span data-ttu-id="98e83-200">Olá funcionários de vendas por território de função de usuário de teste</span><span class="sxs-lookup"><span data-stu-id="98e83-200">Test hello Sales Employees by Territory User Role</span></span>  
<span data-ttu-id="98e83-201">Nesta tarefa, você pode usar Olá analisar no recurso do Excel no SSDT tootest Olá eficácia Olá funcionários de vendas por função de usuário de território.</span><span class="sxs-lookup"><span data-stu-id="98e83-201">In this task, you use hello Analyze in Excel feature in SSDT tootest hello efficacy of hello Sales Employees by Territory user role.</span></span> <span data-ttu-id="98e83-202">Especifique uma saudação nomes de usuário que você adicionou toohello EmployeeSecurity tabela e como um membro da função de saudação.</span><span class="sxs-lookup"><span data-stu-id="98e83-202">You specify one of hello user names you added toohello EmployeeSecurity table and as a member of hello role.</span></span> <span data-ttu-id="98e83-203">Este nome de usuário, em seguida, é usado como nome de usuário efetivo Olá na conexão Olá criada entre o modelo do Excel e hello.</span><span class="sxs-lookup"><span data-stu-id="98e83-203">This user name is then used as hello effective user name in hello connection created between Excel and hello model.</span></span>  
  
#### <a name="tootest-hello-sales-employees-by-territory-user-role"></a><span data-ttu-id="98e83-204">Olá tootest funcionários de vendas por função de usuário de território</span><span class="sxs-lookup"><span data-stu-id="98e83-204">tootest hello Sales Employees by Territory user role</span></span>  
  
1.  <span data-ttu-id="98e83-205">No SSDT, clique em Olá **modelo** menu e clique **analisar no Excel**.</span><span class="sxs-lookup"><span data-stu-id="98e83-205">In SSDT, click hello **Model** menu, and then click **Analyze in Excel**.</span></span>  
  
2.  <span data-ttu-id="98e83-206">Em Olá **analisar no Excel** na caixa **especifique Olá usuário nome ou a função toouse tooconnect toohello modelo**, selecione **outro usuário do Windows**e, em seguida, clique em **Procurar**.</span><span class="sxs-lookup"><span data-stu-id="98e83-206">In hello **Analyze in Excel** dialog box, in **Specify hello user name or role toouse tooconnect toohello model**, select **Other Windows User**, and then click **Browse**.</span></span>  
  
3.  <span data-ttu-id="98e83-207">Em Olá **Selecionar usuário ou grupo** na caixa **digite Olá objeto nome tooselect**, digite um nome de usuário incluídos na tabela de EmployeeSecurity hello e, em seguida, clique em **verificar nomes**.</span><span class="sxs-lookup"><span data-stu-id="98e83-207">In hello **Select User or Group** dialog box, in **Enter hello object name tooselect**, type a user name you included in hello EmployeeSecurity table, and then click **Check Names**.</span></span>  
  
4.  <span data-ttu-id="98e83-208">Clique em **Okey** tooclose Olá **Selecionar usuário ou grupo** caixa de diálogo e clique **Okey** tooclose Olá **analisar no Excel** caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="98e83-208">Click **Ok** tooclose hello **Select User or Group** dialog box, and then click **Ok** tooclose hello **Analyze in Excel** dialog box.</span></span>  
  
    <span data-ttu-id="98e83-209">O Excel abre com uma nova pasta de trabalho.</span><span class="sxs-lookup"><span data-stu-id="98e83-209">Excel opens with a new workbook.</span></span> <span data-ttu-id="98e83-210">Uma tabela dinâmica é criada automaticamente.</span><span class="sxs-lookup"><span data-stu-id="98e83-210">A PivotTable is automatically created.</span></span> <span data-ttu-id="98e83-211">Olá lista PivotTable Fields inclui a maioria Olá de campos de dados disponíveis no novo modelo.</span><span class="sxs-lookup"><span data-stu-id="98e83-211">hello PivotTable Fields list includes most of hello data fields available in your new model.</span></span>  
  
    <span data-ttu-id="98e83-212">Tabela de EmployeeSecurity de saudação aviso não é visível no hello lista PivotTable Fields.</span><span class="sxs-lookup"><span data-stu-id="98e83-212">Notice hello EmployeeSecurity table is not visible in hello PivotTable Fields list.</span></span> <span data-ttu-id="98e83-213">Você ocultou essa tabela das ferramentas de cliente em uma tarefa anterior.</span><span class="sxs-lookup"><span data-stu-id="98e83-213">You hid this table from client tools in a previous task.</span></span>  
  
5.  <span data-ttu-id="98e83-214">Em Olá **campos** listar, **∑ Internet Sales** (medidas), selecione Olá **InternetTotalSales** medidas.</span><span class="sxs-lookup"><span data-stu-id="98e83-214">In hello **Fields** list, in **∑ Internet Sales** (measures), select hello **InternetTotalSales** measure.</span></span> <span data-ttu-id="98e83-215">medida de saudação é inserida no hello **valores** campos.</span><span class="sxs-lookup"><span data-stu-id="98e83-215">hello measure is entered into hello **Values** fields.</span></span>  
  
6.  <span data-ttu-id="98e83-216">Selecione Olá **SalesTerritoryId** coluna da saudação **DimSalesTerritory** tabela.</span><span class="sxs-lookup"><span data-stu-id="98e83-216">Select hello **SalesTerritoryId** column from hello **DimSalesTerritory** table.</span></span> <span data-ttu-id="98e83-217">coluna de saudação é inserida no hello **rótulos de linha** campos.</span><span class="sxs-lookup"><span data-stu-id="98e83-217">hello column is entered into hello **Row Labels** fields.</span></span>  
  
    <span data-ttu-id="98e83-218">Aviso Internet vendas aparecem apenas para Olá uma região toowhich Olá efetivo nome de usuário usado pertence.</span><span class="sxs-lookup"><span data-stu-id="98e83-218">Notice Internet sales figures appear only for hello one region toowhich hello effective user name you used belongs.</span></span> <span data-ttu-id="98e83-219">Se você selecionar outra coluna, como cidade da tabela de DimGeography hello como campo Row Label, cidades apenas no usuário efetivo do Olá Olá território de vendas toowhich pertence são exibidos.</span><span class="sxs-lookup"><span data-stu-id="98e83-219">If you select another column, like City from hello DimGeography table as Row Label field, only cities in hello sales territory toowhich hello effective user belongs are displayed.</span></span>  
  
    <span data-ttu-id="98e83-220">Este usuário não pode pesquisar ou consultar quaisquer dados de vendas da Internet para regiões que não sejam Olá um pertencerem a.</span><span class="sxs-lookup"><span data-stu-id="98e83-220">This user cannot browse or query any Internet sales data for territories other than hello one they belong to.</span></span> <span data-ttu-id="98e83-221">Essa restrição é porque o filtro de linha definido para a tabela de DimSalesTerritory hello, em Olá funcionários de vendas por função de usuário de território, hello protege os dados para todos os dados relacionados tooother territórios de vendas.</span><span class="sxs-lookup"><span data-stu-id="98e83-221">This restriction is because hello row filter defined for hello DimSalesTerritory table, in hello Sales Employees by Territory user role, secures data for all data related tooother sales territories.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="98e83-222">Consulte também</span><span class="sxs-lookup"><span data-stu-id="98e83-222">See Also</span></span>  
[<span data-ttu-id="98e83-223">Função USERNAME (DAX)</span><span class="sxs-lookup"><span data-stu-id="98e83-223">USERNAME Function (DAX)</span></span>](https://msdn.microsoft.com/library/hh230954.aspx)  
[<span data-ttu-id="98e83-224">Função LOOKUPVALUE (DAX)</span><span class="sxs-lookup"><span data-stu-id="98e83-224">LOOKUPVALUE Function (DAX)</span></span>](https://msdn.microsoft.com/library/gg492170.aspx)  
[<span data-ttu-id="98e83-225">Função CUSTOMDATA (DAX)</span><span class="sxs-lookup"><span data-stu-id="98e83-225">CUSTOMDATA Function (DAX)</span></span>](https://msdn.microsoft.com/library/hh213140.aspx)  