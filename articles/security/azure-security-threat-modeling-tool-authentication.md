---
title: "Autenticação - Microsoft Threat Modeling Tool - Azure | Microsoft Docs"
description: "atenuações de ameaças expostas na Ferramenta de Modelagem de Ameaças"
services: security
documentationcenter: na
author: RodSan
manager: RodSan
editor: RodSan
ms.assetid: na
ms.service: security
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/17/2017
ms.author: rodsan
ms.openlocfilehash: e547469dc61eddd1d772571ab0919532ac91f128
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/29/2017
---
# <a name="security-frame-authentication--mitigations"></a><span data-ttu-id="000c6-103">Estrutura de segurança: autenticação | Atenuações</span><span class="sxs-lookup"><span data-stu-id="000c6-103">Security Frame: Authentication | Mitigations</span></span> 
| <span data-ttu-id="000c6-104">Produto/Serviço</span><span class="sxs-lookup"><span data-stu-id="000c6-104">Product/Service</span></span> | <span data-ttu-id="000c6-105">Artigo</span><span class="sxs-lookup"><span data-stu-id="000c6-105">Article</span></span> |
| --------------- | ------- |
| <span data-ttu-id="000c6-106">**Aplicativo Web**</span><span class="sxs-lookup"><span data-stu-id="000c6-106">**Web Application**</span></span>    | <ul><li>[<span data-ttu-id="000c6-107">Considere o uso de um mecanismo de autenticação padrão para autenticação no aplicativo Web</span><span class="sxs-lookup"><span data-stu-id="000c6-107">Consider using a standard authentication mechanism to authenticate to Web Application</span></span>](#standard-authn-web-app)</li><li>[<span data-ttu-id="000c6-108">Os aplicativos devem lidar com cenários de autenticação com falha com segurança</span><span class="sxs-lookup"><span data-stu-id="000c6-108">Applications must handle failed authentication scenarios securely</span></span>](#handle-failed-authn)</li><li>[<span data-ttu-id="000c6-109">Habilitar upgrade ou autenticação adaptável</span><span class="sxs-lookup"><span data-stu-id="000c6-109">Enable step up or adaptive authentication</span></span>](#step-up-adaptive-authn)</li><li>[<span data-ttu-id="000c6-110">Verifique se as interfaces administrativas estão adequadamente bloqueadas</span><span class="sxs-lookup"><span data-stu-id="000c6-110">Ensure that administrative interfaces are appropriately locked down</span></span>](#admin-interface-lockdown)</li><li>[<span data-ttu-id="000c6-111">Implemente funcionalidades de senha esquecida com segurança</span><span class="sxs-lookup"><span data-stu-id="000c6-111">Implement forgot password functionalities securely</span></span>](#forgot-pword-fxn)</li><li>[<span data-ttu-id="000c6-112">Verifique se as políticas de conta e senha são implementadas</span><span class="sxs-lookup"><span data-stu-id="000c6-112">Ensure that password and account policy are implemented</span></span>](#pword-account-policy)</li><li>[<span data-ttu-id="000c6-113">Implemente controles para impedir a enumeração de nome de usuário</span><span class="sxs-lookup"><span data-stu-id="000c6-113">Implement controls to prevent username enumeration</span></span>](#controls-username-enum)</li></ul> |
| <span data-ttu-id="000c6-114">**Banco de dados**</span><span class="sxs-lookup"><span data-stu-id="000c6-114">**Database**</span></span> | <ul><li>[<span data-ttu-id="000c6-115">Quando possível, use a Autenticação do Windows para se conectar ao SQL Server</span><span class="sxs-lookup"><span data-stu-id="000c6-115">When possible, use Windows Authentication for connecting to SQL Server</span></span>](#win-authn-sql)</li><li>[<span data-ttu-id="000c6-116">Quando possível, use a Autenticação do Azure Active Directory para se conectar ao banco de dados SQL</span><span class="sxs-lookup"><span data-stu-id="000c6-116">When possible use Azure Active Directory Authentication for Connecting to SQL Database</span></span>](#aad-authn-sql)</li><li>[<span data-ttu-id="000c6-117">Quando o modo de autenticação do SQL for usado, verifique se as políticas de conta e senha são impostas no SQL server</span><span class="sxs-lookup"><span data-stu-id="000c6-117">When SQL authentication mode is used, ensure that account and password policy are enforced on SQL server</span></span>](#authn-account-pword)</li><li>[<span data-ttu-id="000c6-118">Não use a Autenticação do SQL em bancos de dados independentes</span><span class="sxs-lookup"><span data-stu-id="000c6-118">Do not use SQL Authentication in contained databases</span></span>](#autn-contained-db)</li></ul> |
| <span data-ttu-id="000c6-119">**Hub de Eventos do Azure**</span><span class="sxs-lookup"><span data-stu-id="000c6-119">**Azure Event Hub**</span></span> | <ul><li>[<span data-ttu-id="000c6-120">Use credenciais de autenticação por dispositivo usando tokens SaS</span><span class="sxs-lookup"><span data-stu-id="000c6-120">Use per device authentication credentials using SaS tokens</span></span>](#authn-sas-tokens)</li></ul> |
| <span data-ttu-id="000c6-121">**Limite de Confiança do Azure**</span><span class="sxs-lookup"><span data-stu-id="000c6-121">**Azure Trust Boundary**</span></span> | <ul><li>[<span data-ttu-id="000c6-122">Habilitar Autenticação Multifator do Azure para administradores do Azure</span><span class="sxs-lookup"><span data-stu-id="000c6-122">Enable Azure Multi-Factor Authentication for Azure Administrators</span></span>](#multi-factor-azure-admin)</li></ul> |
| <span data-ttu-id="000c6-123">**Limite de confiança do Service Fabric**</span><span class="sxs-lookup"><span data-stu-id="000c6-123">**Service Fabric Trust Boundary**</span></span> | <ul><li>[<span data-ttu-id="000c6-124">Restrinja o acesso anônimo ao Cluster de Service Fabric</span><span class="sxs-lookup"><span data-stu-id="000c6-124">Restrict anonymous access to Service Fabric Cluster</span></span>](#anon-access-cluster)</li><li>[<span data-ttu-id="000c6-125">Verifique se o certificado de cliente para o nó de Service Fabric serviço é diferente do certificado de nó para nó</span><span class="sxs-lookup"><span data-stu-id="000c6-125">Ensure that Service Fabric client-to-node certificate is different from node-to-node certificate</span></span>](#fabric-cn-nn)</li><li>[<span data-ttu-id="000c6-126">Use o AAD para autenticar clientes para clusters do service fabric</span><span class="sxs-lookup"><span data-stu-id="000c6-126">Use AAD to authenticate clients to service fabric clusters</span></span>](#aad-client-fabric)</li><li>[<span data-ttu-id="000c6-127">Verifique se os certificados de service fabric são obtidos de uma CA (autoridade de certificação) aprovada</span><span class="sxs-lookup"><span data-stu-id="000c6-127">Ensure that service fabric certificates are obtained from an approved Certificate Authority (CA)</span></span>](#fabric-cert-ca)</li></ul> |
| <span data-ttu-id="000c6-128">**Identity Server**</span><span class="sxs-lookup"><span data-stu-id="000c6-128">**Identity Server**</span></span> | <ul><li>[<span data-ttu-id="000c6-129">Use cenários de autenticação padrão com suporte no Servidor de Identidade</span><span class="sxs-lookup"><span data-stu-id="000c6-129">Use standard authentication scenarios supported by Identity Server</span></span>](#standard-authn-id)</li><li>[<span data-ttu-id="000c6-130">Substitua o cache de token de identidade de servidor padrão por uma alternativa escalonável</span><span class="sxs-lookup"><span data-stu-id="000c6-130">Override the default Identity Server token cache with a scalable alternative</span></span>](#override-token)</li></ul> |
| <span data-ttu-id="000c6-131">**Limite de confiança de computador**</span><span class="sxs-lookup"><span data-stu-id="000c6-131">**Machine Trust Boundary**</span></span> | <ul><li>[<span data-ttu-id="000c6-132">Verifique se os binários do aplicativo implantado são assinados digitalmente</span><span class="sxs-lookup"><span data-stu-id="000c6-132">Ensure that deployed application's binaries are digitally signed</span></span>](#binaries-signed)</li></ul> |
| <span data-ttu-id="000c6-133">**WCF**</span><span class="sxs-lookup"><span data-stu-id="000c6-133">**WCF**</span></span> | <ul><li>[<span data-ttu-id="000c6-134">Habilite a autenticação ao se conectar às filas MSMQ do WCF</span><span class="sxs-lookup"><span data-stu-id="000c6-134">Enable authentication when connecting to MSMQ queues in WCF</span></span>](#msmq-queues)</li><li>[<span data-ttu-id="000c6-135">WCF - não defina clientCredentialType de mensagem como none</span><span class="sxs-lookup"><span data-stu-id="000c6-135">WCF-Do not set Message clientCredentialType to none</span></span>](#message-none)</li><li>[<span data-ttu-id="000c6-136">WCF - não defina clientCredentialType de transporte como none</span><span class="sxs-lookup"><span data-stu-id="000c6-136">WCF-Do not set Transport clientCredentialType to none</span></span>](#transport-none)</li></ul> |
| <span data-ttu-id="000c6-137">**API da Web**</span><span class="sxs-lookup"><span data-stu-id="000c6-137">**Web API**</span></span> | <ul><li>[<span data-ttu-id="000c6-138">Verifique se técnicas de autenticação padrão são usadas para proteger as APIs Web</span><span class="sxs-lookup"><span data-stu-id="000c6-138">Ensure that standard authentication techniques are used to secure Web APIs</span></span>](#authn-secure-api)</li></ul> |
| <span data-ttu-id="000c6-139">**Azure AD**</span><span class="sxs-lookup"><span data-stu-id="000c6-139">**Azure AD**</span></span> | <ul><li>[<span data-ttu-id="000c6-140">Use cenários de autenticação padrão com suporte no Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="000c6-140">Use standard authentication scenarios supported by Azure Active Directory</span></span>](#authn-aad)</li><li>[<span data-ttu-id="000c6-141">Substitua o cache de token ADAL padrão por uma alternativa escalonável</span><span class="sxs-lookup"><span data-stu-id="000c6-141">Override the default ADAL token cache with a scalable alternative</span></span>](#adal-scalable)</li><li>[<span data-ttu-id="000c6-142">Verifique se TokenReplayCache é usado para evitar a repetição de tokens de autenticação ADAL</span><span class="sxs-lookup"><span data-stu-id="000c6-142">Ensure that TokenReplayCache is used to prevent the replay of ADAL authentication tokens</span></span>](#tokenreplaycache-adal)</li><li>[<span data-ttu-id="000c6-143">Use bibliotecas ADAL para gerenciar solicitações de token de clientes OAuth2 ao AAD (ou AD local)</span><span class="sxs-lookup"><span data-stu-id="000c6-143">Use ADAL libraries to manage token requests from OAuth2 clients to AAD (or on-premises AD)</span></span>](#adal-oauth2)</li></ul> |
| <span data-ttu-id="000c6-144">**Gateway de Campo de IoT**</span><span class="sxs-lookup"><span data-stu-id="000c6-144">**IoT Field Gateway**</span></span> | <ul><li>[<span data-ttu-id="000c6-145">Autenticar dispositivos que se conectam ao Gateway de Campo</span><span class="sxs-lookup"><span data-stu-id="000c6-145">Authenticate devices connecting to the Field Gateway</span></span>](#authn-devices-field)</li></ul> |
| <span data-ttu-id="000c6-146">**Gateway de Nuvem IoT**</span><span class="sxs-lookup"><span data-stu-id="000c6-146">**IoT Cloud Gateway**</span></span> | <ul><li>[<span data-ttu-id="000c6-147">Verifique se os dispositivos conectados ao gateway de nuvem são autenticados</span><span class="sxs-lookup"><span data-stu-id="000c6-147">Ensure that devices connecting to Cloud gateway are authenticated</span></span>](#authn-devices-cloud)</li><li>[<span data-ttu-id="000c6-148">Usar credenciais de autenticação por dispositivo</span><span class="sxs-lookup"><span data-stu-id="000c6-148">Use per-device authentication credentials</span></span>](#authn-cred)</li></ul> |
| <span data-ttu-id="000c6-149">**Armazenamento do Azure**</span><span class="sxs-lookup"><span data-stu-id="000c6-149">**Azure Storage**</span></span> | <ul><li>[<span data-ttu-id="000c6-150">Verifique se apenas os contêineres necessários e os blobs recebem acesso de leitura anônimo</span><span class="sxs-lookup"><span data-stu-id="000c6-150">Ensure that only the required containers and blobs are given anonymous read access</span></span>](#req-containers-anon)</li><li>[<span data-ttu-id="000c6-151">Conceda acesso limitado a objetos no armazenamento do Azure usando SAS ou SAP</span><span class="sxs-lookup"><span data-stu-id="000c6-151">Grant limited access to objects in Azure storage using SAS or SAP</span></span>](#limited-access-sas)</li></ul> |

## <span data-ttu-id="000c6-152"><a id="standard-authn-web-app"></a>Considere o uso de um mecanismo de autenticação padrão para se autenticar no Aplicativo Web</span><span class="sxs-lookup"><span data-stu-id="000c6-152"><a id="standard-authn-web-app"></a>Consider using a standard authentication mechanism to authenticate to Web Application</span></span>

| <span data-ttu-id="000c6-153">Title</span><span class="sxs-lookup"><span data-stu-id="000c6-153">Title</span></span>                   | <span data-ttu-id="000c6-154">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-154">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="000c6-155">**Componente**</span><span class="sxs-lookup"><span data-stu-id="000c6-155">**Component**</span></span>               | <span data-ttu-id="000c6-156">Aplicativo Web</span><span class="sxs-lookup"><span data-stu-id="000c6-156">Web Application</span></span> | 
| <span data-ttu-id="000c6-157">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="000c6-157">**SDL Phase**</span></span>               | <span data-ttu-id="000c6-158">Compilação</span><span class="sxs-lookup"><span data-stu-id="000c6-158">Build</span></span> |  
| <span data-ttu-id="000c6-159">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="000c6-159">**Applicable Technologies**</span></span> | <span data-ttu-id="000c6-160">Genérico</span><span class="sxs-lookup"><span data-stu-id="000c6-160">Generic</span></span> |
| <span data-ttu-id="000c6-161">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="000c6-161">**Attributes**</span></span>              | <span data-ttu-id="000c6-162">N/D</span><span class="sxs-lookup"><span data-stu-id="000c6-162">N/A</span></span>  |
| <span data-ttu-id="000c6-163">**Referências**</span><span class="sxs-lookup"><span data-stu-id="000c6-163">**References**</span></span>              | <span data-ttu-id="000c6-164">N/D</span><span class="sxs-lookup"><span data-stu-id="000c6-164">N/A</span></span>  |
| <span data-ttu-id="000c6-165">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-165">Details</span></span> | <p><span data-ttu-id="000c6-166">A autenticação é o processo em que uma entidade comprova sua identidade, normalmente por meio de credenciais, como um nome de usuário e uma senha.</span><span class="sxs-lookup"><span data-stu-id="000c6-166">Authentication is the process where an entity proves its identity, typically through credentials, such as a user name and password.</span></span> <span data-ttu-id="000c6-167">Há vários protocolos de autenticação disponíveis que podem ser considerados.</span><span class="sxs-lookup"><span data-stu-id="000c6-167">There are multiple authentication protocols available which may be considered.</span></span> <span data-ttu-id="000c6-168">Alguns deles são listados abaixo:</span><span class="sxs-lookup"><span data-stu-id="000c6-168">Some of them are listed below:</span></span></p><ul><li><span data-ttu-id="000c6-169">Certificados do cliente</span><span class="sxs-lookup"><span data-stu-id="000c6-169">Client certificates</span></span></li><li><span data-ttu-id="000c6-170">Baseado no Windows</span><span class="sxs-lookup"><span data-stu-id="000c6-170">Windows based</span></span></li><li><span data-ttu-id="000c6-171">Baseado em formulários</span><span class="sxs-lookup"><span data-stu-id="000c6-171">Forms based</span></span></li><li><span data-ttu-id="000c6-172">Federação - ADFS</span><span class="sxs-lookup"><span data-stu-id="000c6-172">Federation - ADFS</span></span></li><li><span data-ttu-id="000c6-173">Federação – Azure AD</span><span class="sxs-lookup"><span data-stu-id="000c6-173">Federation - Azure AD</span></span></li><li><span data-ttu-id="000c6-174">Federação - Servidor de Identidade</span><span class="sxs-lookup"><span data-stu-id="000c6-174">Federation - Identity Server</span></span></li></ul><p><span data-ttu-id="000c6-175">Considere usar um mecanismo de autenticação padrão para identificar o processo de origem</span><span class="sxs-lookup"><span data-stu-id="000c6-175">Consider using a standard authentication mechanism to identify the source process</span></span></p>|

## <span data-ttu-id="000c6-176"><a id="handle-failed-authn"></a>Os aplicativos devem lidar com segurança com os cenários de autenticação com falha</span><span class="sxs-lookup"><span data-stu-id="000c6-176"><a id="handle-failed-authn"></a>Applications must handle failed authentication scenarios securely</span></span>

| <span data-ttu-id="000c6-177">Title</span><span class="sxs-lookup"><span data-stu-id="000c6-177">Title</span></span>                   | <span data-ttu-id="000c6-178">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-178">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="000c6-179">**Componente**</span><span class="sxs-lookup"><span data-stu-id="000c6-179">**Component**</span></span>               | <span data-ttu-id="000c6-180">Aplicativo Web</span><span class="sxs-lookup"><span data-stu-id="000c6-180">Web Application</span></span> | 
| <span data-ttu-id="000c6-181">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="000c6-181">**SDL Phase**</span></span>               | <span data-ttu-id="000c6-182">Compilação</span><span class="sxs-lookup"><span data-stu-id="000c6-182">Build</span></span> |  
| <span data-ttu-id="000c6-183">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="000c6-183">**Applicable Technologies**</span></span> | <span data-ttu-id="000c6-184">Genérico</span><span class="sxs-lookup"><span data-stu-id="000c6-184">Generic</span></span> |
| <span data-ttu-id="000c6-185">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="000c6-185">**Attributes**</span></span>              | <span data-ttu-id="000c6-186">N/D</span><span class="sxs-lookup"><span data-stu-id="000c6-186">N/A</span></span>  |
| <span data-ttu-id="000c6-187">**Referências**</span><span class="sxs-lookup"><span data-stu-id="000c6-187">**References**</span></span>              | <span data-ttu-id="000c6-188">N/D</span><span class="sxs-lookup"><span data-stu-id="000c6-188">N/A</span></span>  |
| <span data-ttu-id="000c6-189">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-189">Details</span></span> | <p><span data-ttu-id="000c6-190">Aplicativos que autenticam usuários explicitamente devem controlar os cenários de autenticação com falha com segurança. O mecanismo de autenticação deve:</span><span class="sxs-lookup"><span data-stu-id="000c6-190">Applications that explicitly authenticate users must handle failed authentication scenarios securely.The authentication mechanism must:</span></span></p><ul><li><span data-ttu-id="000c6-191">Negar acesso a recursos privilegiados quando a autenticação falhar</span><span class="sxs-lookup"><span data-stu-id="000c6-191">Deny access to privileged resources when authentication fails</span></span></li><li><span data-ttu-id="000c6-192">Exibir uma mensagem de erro genérica após falha na autenticação e acesso negado</span><span class="sxs-lookup"><span data-stu-id="000c6-192">Display a generic error message after failed authentication and access denied occurs</span></span></li></ul><p><span data-ttu-id="000c6-193">Teste de:</span><span class="sxs-lookup"><span data-stu-id="000c6-193">Test for:</span></span></p><ul><li><span data-ttu-id="000c6-194">Proteção de recursos privilegiados após logons com falha</span><span class="sxs-lookup"><span data-stu-id="000c6-194">Protection of privileged resources after failed logins</span></span></li><li><span data-ttu-id="000c6-195">Será exibida uma mensagem de erro genérica em evento(s) de autenticação com falha e acesso negado</span><span class="sxs-lookup"><span data-stu-id="000c6-195">A generic error message is displayed on failed authentication and access denied event(s)</span></span></li><li><span data-ttu-id="000c6-196">As contas são desabilitadas após um número excessivo de tentativas com falha</span><span class="sxs-lookup"><span data-stu-id="000c6-196">Accounts are disabled after an excessive number of failed attempts</span></span></li><ul>|

## <span data-ttu-id="000c6-197"><a id="step-up-adaptive-authn"></a>Habilitar upgrade ou autenticação adaptável</span><span class="sxs-lookup"><span data-stu-id="000c6-197"><a id="step-up-adaptive-authn"></a>Enable step up or adaptive authentication</span></span>

| <span data-ttu-id="000c6-198">Title</span><span class="sxs-lookup"><span data-stu-id="000c6-198">Title</span></span>                   | <span data-ttu-id="000c6-199">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-199">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="000c6-200">**Componente**</span><span class="sxs-lookup"><span data-stu-id="000c6-200">**Component**</span></span>               | <span data-ttu-id="000c6-201">Aplicativo Web</span><span class="sxs-lookup"><span data-stu-id="000c6-201">Web Application</span></span> | 
| <span data-ttu-id="000c6-202">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="000c6-202">**SDL Phase**</span></span>               | <span data-ttu-id="000c6-203">Compilação</span><span class="sxs-lookup"><span data-stu-id="000c6-203">Build</span></span> |  
| <span data-ttu-id="000c6-204">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="000c6-204">**Applicable Technologies**</span></span> | <span data-ttu-id="000c6-205">Genérico</span><span class="sxs-lookup"><span data-stu-id="000c6-205">Generic</span></span> |
| <span data-ttu-id="000c6-206">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="000c6-206">**Attributes**</span></span>              | <span data-ttu-id="000c6-207">N/D</span><span class="sxs-lookup"><span data-stu-id="000c6-207">N/A</span></span>  |
| <span data-ttu-id="000c6-208">**Referências**</span><span class="sxs-lookup"><span data-stu-id="000c6-208">**References**</span></span>              | <span data-ttu-id="000c6-209">N/D</span><span class="sxs-lookup"><span data-stu-id="000c6-209">N/A</span></span>  |
| <span data-ttu-id="000c6-210">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-210">Details</span></span> | <p><span data-ttu-id="000c6-211">Verifique se o aplicativo tem autorização adicional (como step-up ou autenticação adaptável, por meio de autenticação multifator como o envio de OTP no SMS, email etc. ou solicitação de reautenticação) para que o usuário receba um desafio antes de obter acesso a informações confidenciais.</span><span class="sxs-lookup"><span data-stu-id="000c6-211">Verify the application has additional authorization (such as step up or adaptive authentication, via multi-factor authentication such as sending OTP in SMS, email etc. or prompting for re-authentication) so the user is challenged before being granted access to sensitive information.</span></span> <span data-ttu-id="000c6-212">Essa regra também se aplica para fazer alterações importantes em uma conta ou uma ação</span><span class="sxs-lookup"><span data-stu-id="000c6-212">This rule also applies for making critical changes to an account or action</span></span></p><p><span data-ttu-id="000c6-213">Isso também significa que a adaptação de autenticação deve ser implementada de forma que o aplicativo imponha corretamente a autorização contextual para não permitir uma manipulação não autorizada por meio de violação de parâmetros, como no exemplo</span><span class="sxs-lookup"><span data-stu-id="000c6-213">This also means that the adaptation of authentication has to be implemented in such a manner that the application correctly enforces context-sensitive authorization so as to not allow unauthorized manipulation by means of in example, parameter tampering</span></span></p>|

## <span data-ttu-id="000c6-214"><a id="admin-interface-lockdown"></a>Verifique se as interfaces administrativas estão adequadamente bloqueadas</span><span class="sxs-lookup"><span data-stu-id="000c6-214"><a id="admin-interface-lockdown"></a>Ensure that administrative interfaces are appropriately locked down</span></span>

| <span data-ttu-id="000c6-215">Title</span><span class="sxs-lookup"><span data-stu-id="000c6-215">Title</span></span>                   | <span data-ttu-id="000c6-216">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-216">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="000c6-217">**Componente**</span><span class="sxs-lookup"><span data-stu-id="000c6-217">**Component**</span></span>               | <span data-ttu-id="000c6-218">Aplicativo Web</span><span class="sxs-lookup"><span data-stu-id="000c6-218">Web Application</span></span> | 
| <span data-ttu-id="000c6-219">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="000c6-219">**SDL Phase**</span></span>               | <span data-ttu-id="000c6-220">Compilação</span><span class="sxs-lookup"><span data-stu-id="000c6-220">Build</span></span> |  
| <span data-ttu-id="000c6-221">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="000c6-221">**Applicable Technologies**</span></span> | <span data-ttu-id="000c6-222">Genérico</span><span class="sxs-lookup"><span data-stu-id="000c6-222">Generic</span></span> |
| <span data-ttu-id="000c6-223">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="000c6-223">**Attributes**</span></span>              | <span data-ttu-id="000c6-224">N/D</span><span class="sxs-lookup"><span data-stu-id="000c6-224">N/A</span></span>  |
| <span data-ttu-id="000c6-225">**Referências**</span><span class="sxs-lookup"><span data-stu-id="000c6-225">**References**</span></span>              | <span data-ttu-id="000c6-226">N/D</span><span class="sxs-lookup"><span data-stu-id="000c6-226">N/A</span></span>  |
| <span data-ttu-id="000c6-227">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-227">Details</span></span> | <span data-ttu-id="000c6-228">A primeira solução é conceder acesso apenas de determinado intervalo IP de origem para a interface administrativa.</span><span class="sxs-lookup"><span data-stu-id="000c6-228">The first solution is to grant access only from a certain source IP range to the administrative interface.</span></span> <span data-ttu-id="000c6-229">Se essa solução não for possível, sempre será recomendável impor uma autenticação step-up ou adaptável para fazer logon na interface administrativa</span><span class="sxs-lookup"><span data-stu-id="000c6-229">If that solution would not be possible than it is always recommended to enforce a step-up or adaptive authentication for logging in into the administrative interface</span></span> |

## <span data-ttu-id="000c6-230"><a id="forgot-pword-fxn"></a>Implemente funcionalidades de senha esquecida com segurança</span><span class="sxs-lookup"><span data-stu-id="000c6-230"><a id="forgot-pword-fxn"></a>Implement forgot password functionalities securely</span></span>

| <span data-ttu-id="000c6-231">Title</span><span class="sxs-lookup"><span data-stu-id="000c6-231">Title</span></span>                   | <span data-ttu-id="000c6-232">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-232">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="000c6-233">**Componente**</span><span class="sxs-lookup"><span data-stu-id="000c6-233">**Component**</span></span>               | <span data-ttu-id="000c6-234">Aplicativo Web</span><span class="sxs-lookup"><span data-stu-id="000c6-234">Web Application</span></span> | 
| <span data-ttu-id="000c6-235">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="000c6-235">**SDL Phase**</span></span>               | <span data-ttu-id="000c6-236">Compilação</span><span class="sxs-lookup"><span data-stu-id="000c6-236">Build</span></span> |  
| <span data-ttu-id="000c6-237">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="000c6-237">**Applicable Technologies**</span></span> | <span data-ttu-id="000c6-238">Genérico</span><span class="sxs-lookup"><span data-stu-id="000c6-238">Generic</span></span> |
| <span data-ttu-id="000c6-239">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="000c6-239">**Attributes**</span></span>              | <span data-ttu-id="000c6-240">N/D</span><span class="sxs-lookup"><span data-stu-id="000c6-240">N/A</span></span>  |
| <span data-ttu-id="000c6-241">**Referências**</span><span class="sxs-lookup"><span data-stu-id="000c6-241">**References**</span></span>              | <span data-ttu-id="000c6-242">N/D</span><span class="sxs-lookup"><span data-stu-id="000c6-242">N/A</span></span>  |
| <span data-ttu-id="000c6-243">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-243">Details</span></span> | <p><span data-ttu-id="000c6-244">A primeira coisa é verificar se você esqueceu a senha, e outros caminhos de recuperação enviam um link com um token de ativação de tempo limitado, em vez da própria senha.</span><span class="sxs-lookup"><span data-stu-id="000c6-244">The first thing is to verify that forgot password and other recovery paths send a link including a time-limited activation token rather than the password itself.</span></span> <span data-ttu-id="000c6-245">A autenticação adicional com base em tokens de software (por exemplo, token de SMS, aplicativos móveis nativos etc.) também pode ser necessária antes que o link seja enviado.</span><span class="sxs-lookup"><span data-stu-id="000c6-245">Additional authentication based on soft-tokens (e.g. SMS token, native mobile applications, etc.) can be required as well before the link is sent over.</span></span> <span data-ttu-id="000c6-246">Em segundo lugar, você não deverá bloquear a conta de usuários enquanto o processo de obtenção de uma nova senha estiver em andamento.</span><span class="sxs-lookup"><span data-stu-id="000c6-246">Second, you should not lock out the users account whilst the process of getting a new password is in progress.</span></span></p><p><span data-ttu-id="000c6-247">Isso poderá levar a um ataque de Negação de serviço sempre que um invasor decidir bloquear intencionalmente os usuários com um ataque automatizado.</span><span class="sxs-lookup"><span data-stu-id="000c6-247">This could lead to a Denial of service attack whenever an attacker decides to intentionally lock out the users with an automated attack.</span></span> <span data-ttu-id="000c6-248">Em terceiro lugar, sempre que a nova solicitação de senha for definida em andamento, a mensagem que será exibida deverá ser generalizada para evitar a enumeração de nome de usuário.</span><span class="sxs-lookup"><span data-stu-id="000c6-248">Third, whenever the new password request was set in progress, the message you display should be generalized in order to prevent username enumeration.</span></span> <span data-ttu-id="000c6-249">Em quarto lugar, sempre proíba o uso de senhas antigas e implemente uma política de senha forte.</span><span class="sxs-lookup"><span data-stu-id="000c6-249">Fourth, always disallow the use of old passwords and implement a strong password policy.</span></span></p> |

## <span data-ttu-id="000c6-250"><a id="pword-account-policy"></a>Verifique se as políticas de conta e senha são implementadas</span><span class="sxs-lookup"><span data-stu-id="000c6-250"><a id="pword-account-policy"></a>Ensure that password and account policy are implemented</span></span>

| <span data-ttu-id="000c6-251">Title</span><span class="sxs-lookup"><span data-stu-id="000c6-251">Title</span></span>                   | <span data-ttu-id="000c6-252">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-252">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="000c6-253">**Componente**</span><span class="sxs-lookup"><span data-stu-id="000c6-253">**Component**</span></span>               | <span data-ttu-id="000c6-254">Aplicativo Web</span><span class="sxs-lookup"><span data-stu-id="000c6-254">Web Application</span></span> | 
| <span data-ttu-id="000c6-255">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="000c6-255">**SDL Phase**</span></span>               | <span data-ttu-id="000c6-256">Compilação</span><span class="sxs-lookup"><span data-stu-id="000c6-256">Build</span></span> |  
| <span data-ttu-id="000c6-257">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="000c6-257">**Applicable Technologies**</span></span> | <span data-ttu-id="000c6-258">Genérico</span><span class="sxs-lookup"><span data-stu-id="000c6-258">Generic</span></span> |
| <span data-ttu-id="000c6-259">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="000c6-259">**Attributes**</span></span>              | <span data-ttu-id="000c6-260">N/D</span><span class="sxs-lookup"><span data-stu-id="000c6-260">N/A</span></span>  |
| <span data-ttu-id="000c6-261">**Referências**</span><span class="sxs-lookup"><span data-stu-id="000c6-261">**References**</span></span>              | <span data-ttu-id="000c6-262">N/D</span><span class="sxs-lookup"><span data-stu-id="000c6-262">N/A</span></span>  |
| <span data-ttu-id="000c6-263">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-263">Details</span></span> | <p><span data-ttu-id="000c6-264">A política de conta e senha em conformidade com a política organizacional e as práticas recomendadas deve ser implementadas.</span><span class="sxs-lookup"><span data-stu-id="000c6-264">Password and account policy in compliance with organizational policy and best practices should be implemented.</span></span></p><p><span data-ttu-id="000c6-265">Para proteção contra força bruta e adivinhação baseada em dicionário: a política de senha forte deve ser implementada para garantir que os usuários criem senhas complexas (por exemplo, comprimento mínimo de 12 caracteres, caracteres especiais e alfanuméricos).</span><span class="sxs-lookup"><span data-stu-id="000c6-265">To defend against brute-force and dictionary based guessing: Strong password policy must be implemented to ensure that users create complex password (e.g., 12 characters minimum length, alphanumeric and special characters).</span></span></p><p><span data-ttu-id="000c6-266">Políticas de bloqueio de conta podem ser implementadas da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="000c6-266">Account lockout policies may be implemented in the following manner:</span></span></p><ul><li><span data-ttu-id="000c6-267">**Limite de bloqueio flexível:** essa pode ser uma boa opção para proteger os usuários contra ataques de força bruta.</span><span class="sxs-lookup"><span data-stu-id="000c6-267">**Soft lock-out:** This can be a good option for protecting your users against brute force attacks.</span></span> <span data-ttu-id="000c6-268">Por exemplo, sempre que o usuário insere uma senha incorreta três vezes, o aplicativo pode bloquear a conta por um minuto para tornar mais lento o processo de obtenção da senha por força bruta, tornando-o menos rentável para o invasor.</span><span class="sxs-lookup"><span data-stu-id="000c6-268">For example, whenever the user enters a wrong password three times the application could lock down the account for a minute in order to slow down the process of brute forcing his password making it less profitable for the attacker to proceed.</span></span> <span data-ttu-id="000c6-269">Se implementar contramedidas de bloqueio rígidas neste exemplo, você obterá um "Dos" bloqueando permanentemente as contas.</span><span class="sxs-lookup"><span data-stu-id="000c6-269">If u were to implement hard lock-out countermeasures for this example you would achieve a "Dos" by permanently locking out accounts.</span></span> <span data-ttu-id="000c6-270">Como alternativa, o aplicativo pode gerar uma OTP (senha única) e enviá-la fora de banda (por email, sms etc.) ao usuário.</span><span class="sxs-lookup"><span data-stu-id="000c6-270">Alternatively, application may generate an OTP (One Time Password) and send it out-of-band (through email, sms etc.) to the user.</span></span> <span data-ttu-id="000c6-271">Outra abordagem seria implementar CAPTCHA depois que um número limite de tentativas for atingido.</span><span class="sxs-lookup"><span data-stu-id="000c6-271">Another approach may be to implement CAPTCHA after a threshold number of failed attempts is reached.</span></span></li><li><span data-ttu-id="000c6-272">**Limite de bloqueio rígido:** esse tipo de bloqueio deverá ser aplicado sempre que você detectar que um usuário está atacando o aplicativo, impedindo-o por meio do bloqueio permanente de sua conta, até que uma equipe de resposta tenha tempo de fazer a análise forense.</span><span class="sxs-lookup"><span data-stu-id="000c6-272">**Hard lock-out:** This type of lockout should be applied whenever you detect a user attacking your application and counter him by means of permanently locking out his account until a response team had time to do their forensics.</span></span> <span data-ttu-id="000c6-273">Após esse processo, que você pode optar por dar a conta de volta ao usuário ou tomar outras medidas legais contra ele.</span><span class="sxs-lookup"><span data-stu-id="000c6-273">After this process you can decide to give the user back his account or take further legal actions against him.</span></span> <span data-ttu-id="000c6-274">Esse tipo de abordagem impede que o invasor penetre ainda mais em seu aplicativo e infraestrutura.</span><span class="sxs-lookup"><span data-stu-id="000c6-274">This type of approach prevents the attacker from further penetrating your application and infrastructure.</span></span></li></ul><p><span data-ttu-id="000c6-275">Para se proteger contra ataques em contas previsíveis e padrão, verifique se todas as chaves e senhas são substituíveis e são geradas ou substituídas após a instalação.</span><span class="sxs-lookup"><span data-stu-id="000c6-275">To defend against attacks on default and predictable accounts, verify that all keys and passwords are replaceable, and are generated or replaced after installation time.</span></span></p><p><span data-ttu-id="000c6-276">Se o aplicativo precisar gerar senhas automaticamente, verifique se as senhas geradas são aleatórias e têm alta entropia.</span><span class="sxs-lookup"><span data-stu-id="000c6-276">If the application has to auto-generate passwords, ensure that the generated passwords are random and have high entropy.</span></span></p>|

## <span data-ttu-id="000c6-277"><a id="controls-username-enum"></a>Implemente controles para impedir a enumeração de nome de usuário</span><span class="sxs-lookup"><span data-stu-id="000c6-277"><a id="controls-username-enum"></a>Implement controls to prevent username enumeration</span></span>

| <span data-ttu-id="000c6-278">Title</span><span class="sxs-lookup"><span data-stu-id="000c6-278">Title</span></span>                   | <span data-ttu-id="000c6-279">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-279">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="000c6-280">**Componente**</span><span class="sxs-lookup"><span data-stu-id="000c6-280">**Component**</span></span>               | <span data-ttu-id="000c6-281">Aplicativo Web</span><span class="sxs-lookup"><span data-stu-id="000c6-281">Web Application</span></span> | 
| <span data-ttu-id="000c6-282">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="000c6-282">**SDL Phase**</span></span>               | <span data-ttu-id="000c6-283">Compilação</span><span class="sxs-lookup"><span data-stu-id="000c6-283">Build</span></span> |  
| <span data-ttu-id="000c6-284">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="000c6-284">**Applicable Technologies**</span></span> | <span data-ttu-id="000c6-285">Genérico</span><span class="sxs-lookup"><span data-stu-id="000c6-285">Generic</span></span> |
| <span data-ttu-id="000c6-286">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="000c6-286">**Attributes**</span></span>              | <span data-ttu-id="000c6-287">N/D</span><span class="sxs-lookup"><span data-stu-id="000c6-287">N/A</span></span>  |
| <span data-ttu-id="000c6-288">**Referências**</span><span class="sxs-lookup"><span data-stu-id="000c6-288">**References**</span></span>              | <span data-ttu-id="000c6-289">N/D</span><span class="sxs-lookup"><span data-stu-id="000c6-289">N/A</span></span>  |
| <span data-ttu-id="000c6-290">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="000c6-290">**Steps**</span></span> | <span data-ttu-id="000c6-291">Todas as mensagens de erro devem ser generalizadas para evitar a enumeração de nome de usuário.</span><span class="sxs-lookup"><span data-stu-id="000c6-291">All error messages should be generalized in order to prevent username enumeration.</span></span> <span data-ttu-id="000c6-292">Além disso, às vezes você não pode evitar o vazamento de recursos, como uma página de registro de informações.</span><span class="sxs-lookup"><span data-stu-id="000c6-292">Also sometimes you cannot avoid information leaking in functionalities such as a registration page.</span></span> <span data-ttu-id="000c6-293">Aqui, você precisa usar métodos de limitação de taxa, como CAPTCHA, para evitar um ataque automatizado por um invasor.</span><span class="sxs-lookup"><span data-stu-id="000c6-293">Here you need to use rate-limiting methods like CAPTCHA to prevent an automated attack by an attacker.</span></span> |

## <span data-ttu-id="000c6-294"><a id="win-authn-sql"></a>Quando possível, use a Autenticação do Windows para se conectar ao SQL Server</span><span class="sxs-lookup"><span data-stu-id="000c6-294"><a id="win-authn-sql"></a>When possible, use Windows Authentication for connecting to SQL Server</span></span>

| <span data-ttu-id="000c6-295">Title</span><span class="sxs-lookup"><span data-stu-id="000c6-295">Title</span></span>                   | <span data-ttu-id="000c6-296">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-296">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="000c6-297">**Componente**</span><span class="sxs-lookup"><span data-stu-id="000c6-297">**Component**</span></span>               | <span data-ttu-id="000c6-298">Banco de dados</span><span class="sxs-lookup"><span data-stu-id="000c6-298">Database</span></span> | 
| <span data-ttu-id="000c6-299">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="000c6-299">**SDL Phase**</span></span>               | <span data-ttu-id="000c6-300">Compilação</span><span class="sxs-lookup"><span data-stu-id="000c6-300">Build</span></span> |  
| <span data-ttu-id="000c6-301">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="000c6-301">**Applicable Technologies**</span></span> | <span data-ttu-id="000c6-302">OnPrem</span><span class="sxs-lookup"><span data-stu-id="000c6-302">OnPrem</span></span> |
| <span data-ttu-id="000c6-303">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="000c6-303">**Attributes**</span></span>              | <span data-ttu-id="000c6-304">Versão do SQL - Todas</span><span class="sxs-lookup"><span data-stu-id="000c6-304">SQL Version - All</span></span> |
| <span data-ttu-id="000c6-305">**Referências**</span><span class="sxs-lookup"><span data-stu-id="000c6-305">**References**</span></span>              | [<span data-ttu-id="000c6-306">SQL Server - escolher um modo de autenticação</span><span class="sxs-lookup"><span data-stu-id="000c6-306">SQL Server - Choose an Authentication Mode</span></span>](https://msdn.microsoft.com/library/ms144284.aspx) |
| <span data-ttu-id="000c6-307">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="000c6-307">**Steps**</span></span> | <span data-ttu-id="000c6-308">A Autenticação do Windows usa o protocolo de segurança Kerberos, fornece imposição de política de senha com relação à validação de complexidade para senhas fortes e dá suporte ao bloqueio de conta e à expiração de senha.</span><span class="sxs-lookup"><span data-stu-id="000c6-308">Windows Authentication uses Kerberos security protocol, provides password policy enforcement with regard to complexity validation for strong passwords, provides support for account lockout, and supports password expiration.</span></span>|

## <span data-ttu-id="000c6-309"><a id="aad-authn-sql"></a>Quando possível, use a Autenticação do Azure Active Directory para se conectar ao banco de dados SQL</span><span class="sxs-lookup"><span data-stu-id="000c6-309"><a id="aad-authn-sql"></a>When possible use Azure Active Directory Authentication for Connecting to SQL Database</span></span>

| <span data-ttu-id="000c6-310">Title</span><span class="sxs-lookup"><span data-stu-id="000c6-310">Title</span></span>                   | <span data-ttu-id="000c6-311">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-311">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="000c6-312">**Componente**</span><span class="sxs-lookup"><span data-stu-id="000c6-312">**Component**</span></span>               | <span data-ttu-id="000c6-313">Banco de dados</span><span class="sxs-lookup"><span data-stu-id="000c6-313">Database</span></span> | 
| <span data-ttu-id="000c6-314">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="000c6-314">**SDL Phase**</span></span>               | <span data-ttu-id="000c6-315">Compilação</span><span class="sxs-lookup"><span data-stu-id="000c6-315">Build</span></span> |  
| <span data-ttu-id="000c6-316">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="000c6-316">**Applicable Technologies**</span></span> | <span data-ttu-id="000c6-317">SQL Azure</span><span class="sxs-lookup"><span data-stu-id="000c6-317">SQL Azure</span></span> |
| <span data-ttu-id="000c6-318">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="000c6-318">**Attributes**</span></span>              | <span data-ttu-id="000c6-319">Versão do SQL - V12</span><span class="sxs-lookup"><span data-stu-id="000c6-319">SQL Version - V12</span></span> |
| <span data-ttu-id="000c6-320">**Referências**</span><span class="sxs-lookup"><span data-stu-id="000c6-320">**References**</span></span>              | [<span data-ttu-id="000c6-321">Conectar-se ao Banco de Dados SQL usando a autenticação do Active Directory do Azure</span><span class="sxs-lookup"><span data-stu-id="000c6-321">Connecting to SQL Database By Using Azure Active Directory Authentication</span></span>](https://azure.microsoft.com/documentation/articles/sql-database-aad-authentication/) |
| <span data-ttu-id="000c6-322">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="000c6-322">**Steps**</span></span> | <span data-ttu-id="000c6-323">**Versão mínima:** a V12 do Banco de Dados do SQL Azure é necessária para permitir que o banco de dados SQL Azure use a Autenticação do AAD no Microsoft Directory</span><span class="sxs-lookup"><span data-stu-id="000c6-323">**Minimum version:** Azure SQL Database V12 required to allow Azure SQL Database to use AAD Authentication against the Microsoft Directory</span></span> |

## <span data-ttu-id="000c6-324"><a id="authn-account-pword"></a>Quando o modo de autenticação do SQL for usado, verifique se as políticas de conta e senha são impostas no SQL server</span><span class="sxs-lookup"><span data-stu-id="000c6-324"><a id="authn-account-pword"></a>When SQL authentication mode is used, ensure that account and password policy are enforced on SQL server</span></span>

| <span data-ttu-id="000c6-325">Title</span><span class="sxs-lookup"><span data-stu-id="000c6-325">Title</span></span>                   | <span data-ttu-id="000c6-326">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-326">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="000c6-327">**Componente**</span><span class="sxs-lookup"><span data-stu-id="000c6-327">**Component**</span></span>               | <span data-ttu-id="000c6-328">Banco de dados</span><span class="sxs-lookup"><span data-stu-id="000c6-328">Database</span></span> | 
| <span data-ttu-id="000c6-329">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="000c6-329">**SDL Phase**</span></span>               | <span data-ttu-id="000c6-330">Compilação</span><span class="sxs-lookup"><span data-stu-id="000c6-330">Build</span></span> |  
| <span data-ttu-id="000c6-331">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="000c6-331">**Applicable Technologies**</span></span> | <span data-ttu-id="000c6-332">Genérico</span><span class="sxs-lookup"><span data-stu-id="000c6-332">Generic</span></span> |
| <span data-ttu-id="000c6-333">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="000c6-333">**Attributes**</span></span>              | <span data-ttu-id="000c6-334">N/D</span><span class="sxs-lookup"><span data-stu-id="000c6-334">N/A</span></span>  |
| <span data-ttu-id="000c6-335">**Referências**</span><span class="sxs-lookup"><span data-stu-id="000c6-335">**References**</span></span>              | <span data-ttu-id="000c6-336">[Política de senha do SQL Server](https://technet.microsoft.com/library/ms161959(v=sql.110).aspx)</span><span class="sxs-lookup"><span data-stu-id="000c6-336">[SQL Server password policy](https://technet.microsoft.com/library/ms161959(v=sql.110).aspx)</span></span> |
| <span data-ttu-id="000c6-337">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="000c6-337">**Steps**</span></span> | <span data-ttu-id="000c6-338">Ao usar a Autenticação do SQL Server, são criados logons no SQL Server que não se baseiam em contas de usuário do Windows.</span><span class="sxs-lookup"><span data-stu-id="000c6-338">When using SQL Server Authentication, logins are created in SQL Server that are not based on Windows user accounts.</span></span> <span data-ttu-id="000c6-339">O nome de usuário e a senha são criados usando o SQL Server e são armazenados no SQL Server.</span><span class="sxs-lookup"><span data-stu-id="000c6-339">Both the user name and the password are created by using SQL Server and stored in SQL Server.</span></span> <span data-ttu-id="000c6-340">O SQL Server pode usar mecanismos de política de senha do Windows.</span><span class="sxs-lookup"><span data-stu-id="000c6-340">SQL Server can use Windows password policy mechanisms.</span></span> <span data-ttu-id="000c6-341">Ele pode aplicar a mesma complexidade e as políticas de expiração usadas no Windows para senhas usadas no SQL Server.</span><span class="sxs-lookup"><span data-stu-id="000c6-341">It can apply the same complexity and expiration policies used in Windows to passwords used inside SQL Server.</span></span> |

## <span data-ttu-id="000c6-342"><a id="autn-contained-db"></a>Não use a Autenticação do SQL em bancos de dados independentes</span><span class="sxs-lookup"><span data-stu-id="000c6-342"><a id="autn-contained-db"></a>Do not use SQL Authentication in contained databases</span></span>

| <span data-ttu-id="000c6-343">Title</span><span class="sxs-lookup"><span data-stu-id="000c6-343">Title</span></span>                   | <span data-ttu-id="000c6-344">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-344">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="000c6-345">**Componente**</span><span class="sxs-lookup"><span data-stu-id="000c6-345">**Component**</span></span>               | <span data-ttu-id="000c6-346">Banco de dados</span><span class="sxs-lookup"><span data-stu-id="000c6-346">Database</span></span> | 
| <span data-ttu-id="000c6-347">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="000c6-347">**SDL Phase**</span></span>               | <span data-ttu-id="000c6-348">Compilação</span><span class="sxs-lookup"><span data-stu-id="000c6-348">Build</span></span> |  
| <span data-ttu-id="000c6-349">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="000c6-349">**Applicable Technologies**</span></span> | <span data-ttu-id="000c6-350">OnPrem, SQL Azure</span><span class="sxs-lookup"><span data-stu-id="000c6-350">OnPrem, SQL Azure</span></span> |
| <span data-ttu-id="000c6-351">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="000c6-351">**Attributes**</span></span>              | <span data-ttu-id="000c6-352">Versão do SQL - MSSQL2012, Versão do SQL - V12</span><span class="sxs-lookup"><span data-stu-id="000c6-352">SQL Version - MSSQL2012, SQL Version - V12</span></span> |
| <span data-ttu-id="000c6-353">**Referências**</span><span class="sxs-lookup"><span data-stu-id="000c6-353">**References**</span></span>              | [<span data-ttu-id="000c6-354">Práticas recomendadas de segurança com bancos de dados contidos</span><span class="sxs-lookup"><span data-stu-id="000c6-354">Security Best Practices with Contained Databases</span></span>](http://msdn.microsoft.com/library/ff929055.aspx) |
| <span data-ttu-id="000c6-355">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="000c6-355">**Steps**</span></span> | <span data-ttu-id="000c6-356">A ausência de uma política de senha imposta pode aumentar a probabilidade de que uma credencial fraca seja estabelecida em um banco de dados independente.</span><span class="sxs-lookup"><span data-stu-id="000c6-356">The absence of an enforced password policy may increase the likelihood of a weak credential being established in a contained database.</span></span> <span data-ttu-id="000c6-357">Aproveite a Autenticação do Windows.</span><span class="sxs-lookup"><span data-stu-id="000c6-357">Leverage Windows Authentication.</span></span> |

## <span data-ttu-id="000c6-358"><a id="authn-sas-tokens"></a>Use credenciais de autenticação por dispositivo usando tokens SaS</span><span class="sxs-lookup"><span data-stu-id="000c6-358"><a id="authn-sas-tokens"></a>Use per device authentication credentials using SaS tokens</span></span>

| <span data-ttu-id="000c6-359">Title</span><span class="sxs-lookup"><span data-stu-id="000c6-359">Title</span></span>                   | <span data-ttu-id="000c6-360">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-360">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="000c6-361">**Componente**</span><span class="sxs-lookup"><span data-stu-id="000c6-361">**Component**</span></span>               | <span data-ttu-id="000c6-362">Hub de Eventos do Azure</span><span class="sxs-lookup"><span data-stu-id="000c6-362">Azure Event Hub</span></span> | 
| <span data-ttu-id="000c6-363">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="000c6-363">**SDL Phase**</span></span>               | <span data-ttu-id="000c6-364">Compilação</span><span class="sxs-lookup"><span data-stu-id="000c6-364">Build</span></span> |  
| <span data-ttu-id="000c6-365">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="000c6-365">**Applicable Technologies**</span></span> | <span data-ttu-id="000c6-366">Genérico</span><span class="sxs-lookup"><span data-stu-id="000c6-366">Generic</span></span> |
| <span data-ttu-id="000c6-367">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="000c6-367">**Attributes**</span></span>              | <span data-ttu-id="000c6-368">N/D</span><span class="sxs-lookup"><span data-stu-id="000c6-368">N/A</span></span>  |
| <span data-ttu-id="000c6-369">**Referências**</span><span class="sxs-lookup"><span data-stu-id="000c6-369">**References**</span></span>              | [<span data-ttu-id="000c6-370">Visão geral do modelo de autenticação e segurança dos Hubs de Eventos</span><span class="sxs-lookup"><span data-stu-id="000c6-370">Event Hubs authentication and security model overview</span></span>](https://azure.microsoft.com/documentation/articles/event-hubs-authentication-and-security-model-overview/) |
| <span data-ttu-id="000c6-371">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="000c6-371">**Steps**</span></span> | <p><span data-ttu-id="000c6-372">O modelo de segurança dos Hubs de Eventos se baseia em uma combinação de tokens SAS (Assinatura de Acesso Compartilhado) e de editores de eventos.</span><span class="sxs-lookup"><span data-stu-id="000c6-372">The Event Hubs security model is based on a combination of Shared Access Signature (SAS) tokens and event publishers.</span></span> <span data-ttu-id="000c6-373">O nome do publicador representa o DeviceID que recebe o token.</span><span class="sxs-lookup"><span data-stu-id="000c6-373">The publisher name represents the DeviceID that receives the token.</span></span> <span data-ttu-id="000c6-374">Isso ajudaria a associar os tokens gerados aos respectivos dispositivos.</span><span class="sxs-lookup"><span data-stu-id="000c6-374">This would help associate the tokens generated with the respective devices.</span></span></p><p><span data-ttu-id="000c6-375">Todas as mensagens são marcadas com o originador no lado do serviço, o que permite a detecção de tentativas de falsificação de origem na carga.</span><span class="sxs-lookup"><span data-stu-id="000c6-375">All messages are tagged with originator on service side allowing detection of in-payload origin spoofing attempts.</span></span> <span data-ttu-id="000c6-376">Na autenticação de dispositivos, gere um token SaS por dispositivo com escopo para um publicador exclusivo.</span><span class="sxs-lookup"><span data-stu-id="000c6-376">When authenticating devices, generate a per device SaS token scoped to a unique publisher.</span></span></p>|

## <span data-ttu-id="000c6-377"><a id="multi-factor-azure-admin"></a>Habilitar Autenticação Multifator do Azure para administradores do Azure</span><span class="sxs-lookup"><span data-stu-id="000c6-377"><a id="multi-factor-azure-admin"></a>Enable Azure Multi-Factor Authentication for Azure Administrators</span></span>

| <span data-ttu-id="000c6-378">Title</span><span class="sxs-lookup"><span data-stu-id="000c6-378">Title</span></span>                   | <span data-ttu-id="000c6-379">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-379">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="000c6-380">**Componente**</span><span class="sxs-lookup"><span data-stu-id="000c6-380">**Component**</span></span>               | <span data-ttu-id="000c6-381">Limite de Confiança do Azure</span><span class="sxs-lookup"><span data-stu-id="000c6-381">Azure Trust Boundary</span></span> | 
| <span data-ttu-id="000c6-382">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="000c6-382">**SDL Phase**</span></span>               | <span data-ttu-id="000c6-383">Implantação</span><span class="sxs-lookup"><span data-stu-id="000c6-383">Deployment</span></span> |  
| <span data-ttu-id="000c6-384">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="000c6-384">**Applicable Technologies**</span></span> | <span data-ttu-id="000c6-385">Genérico</span><span class="sxs-lookup"><span data-stu-id="000c6-385">Generic</span></span> |
| <span data-ttu-id="000c6-386">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="000c6-386">**Attributes**</span></span>              | <span data-ttu-id="000c6-387">N/D</span><span class="sxs-lookup"><span data-stu-id="000c6-387">N/A</span></span>  |
| <span data-ttu-id="000c6-388">**Referências**</span><span class="sxs-lookup"><span data-stu-id="000c6-388">**References**</span></span>              | [<span data-ttu-id="000c6-389">O que é a Autenticação Multifator do Azure?</span><span class="sxs-lookup"><span data-stu-id="000c6-389">What is Azure Multi-Factor Authentication?</span></span>](https://azure.microsoft.com/documentation/articles/multi-factor-authentication/) |
| <span data-ttu-id="000c6-390">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="000c6-390">**Steps**</span></span> | <p><span data-ttu-id="000c6-391">A autenticação multifator (MFA) é um método de autenticação que exige mais de um método de verificação e adiciona uma segunda camada crítica de segurança aos logons e às transações dos usuários.</span><span class="sxs-lookup"><span data-stu-id="000c6-391">Multi-factor authentication (MFA) is a method of authentication that requires more than one verification method and adds a critical second layer of security to user sign-ins and transactions.</span></span> <span data-ttu-id="000c6-392">Ela funciona, exigindo dois ou mais dos métodos de verificação a seguir:</span><span class="sxs-lookup"><span data-stu-id="000c6-392">It works by requiring any two or more of the following verification methods:</span></span></p><ul><li><span data-ttu-id="000c6-393">Algo que você sabe (normalmente, uma senha)</span><span class="sxs-lookup"><span data-stu-id="000c6-393">Something you know (typically a password)</span></span></li><li><span data-ttu-id="000c6-394">Algo que você tem (um dispositivo confiável que não pode ser facilmente clonado, como um telefone)</span><span class="sxs-lookup"><span data-stu-id="000c6-394">Something you have (a trusted device that is not easily duplicated, like a phone)</span></span></li><li><span data-ttu-id="000c6-395">Algo seu (biometria)</span><span class="sxs-lookup"><span data-stu-id="000c6-395">Something you are (biometrics)</span></span></li><ul>|

## <span data-ttu-id="000c6-396"><a id="anon-access-cluster"></a>Restrinja o acesso anônimo ao Cluster de Service Fabric</span><span class="sxs-lookup"><span data-stu-id="000c6-396"><a id="anon-access-cluster"></a>Restrict anonymous access to Service Fabric Cluster</span></span>

| <span data-ttu-id="000c6-397">Title</span><span class="sxs-lookup"><span data-stu-id="000c6-397">Title</span></span>                   | <span data-ttu-id="000c6-398">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-398">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="000c6-399">**Componente**</span><span class="sxs-lookup"><span data-stu-id="000c6-399">**Component**</span></span>               | <span data-ttu-id="000c6-400">Limite de confiança do Service Fabric</span><span class="sxs-lookup"><span data-stu-id="000c6-400">Service Fabric Trust Boundary</span></span> | 
| <span data-ttu-id="000c6-401">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="000c6-401">**SDL Phase**</span></span>               | <span data-ttu-id="000c6-402">Implantação</span><span class="sxs-lookup"><span data-stu-id="000c6-402">Deployment</span></span> |  
| <span data-ttu-id="000c6-403">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="000c6-403">**Applicable Technologies**</span></span> | <span data-ttu-id="000c6-404">Genérico</span><span class="sxs-lookup"><span data-stu-id="000c6-404">Generic</span></span> |
| <span data-ttu-id="000c6-405">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="000c6-405">**Attributes**</span></span>              | <span data-ttu-id="000c6-406">Ambiente - Azure</span><span class="sxs-lookup"><span data-stu-id="000c6-406">Environment - Azure</span></span>  |
| <span data-ttu-id="000c6-407">**Referências**</span><span class="sxs-lookup"><span data-stu-id="000c6-407">**References**</span></span>              | [<span data-ttu-id="000c6-408">Cenários de segurança do cluster do Service Fabric</span><span class="sxs-lookup"><span data-stu-id="000c6-408">Service Fabric cluster security scenarios</span></span>](https://azure.microsoft.com/documentation/articles/service-fabric-cluster-security) |
| <span data-ttu-id="000c6-409">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="000c6-409">**Steps**</span></span> | <p><span data-ttu-id="000c6-410">Os clusters sempre devem ser protegidos para evitar que usuários não autorizados se conectem ao cluster, especialmente quando ele tiver cargas de trabalho de produção em execução.</span><span class="sxs-lookup"><span data-stu-id="000c6-410">Clusters should always be secured to prevent unauthorized users from connecting to your cluster, especially when it has production workloads running on it.</span></span></p><p><span data-ttu-id="000c6-411">Ao criar um cluster de service fabric, verifique se o modo de segurança está definido como "seguro" e configure o certificado de servidor X.509 necessário.</span><span class="sxs-lookup"><span data-stu-id="000c6-411">While creating a service fabric cluster, ensure that the security mode is set to "secure" and configure the required X.509 server certificate.</span></span> <span data-ttu-id="000c6-412">Criar um cluster "inseguro" permitirá que qualquer usuário anônimo se conecte a ele se ele expuser pontos de extremidade de gerenciamento para a Internet pública.</span><span class="sxs-lookup"><span data-stu-id="000c6-412">Creating an "insecure" cluster will allow any anonymous user to connect to it if it exposes management endpoints to the public Internet.</span></span></p>|

## <span data-ttu-id="000c6-413"><a id="fabric-cn-nn"></a>Verifique se o certificado de cliente para o nó de Service Fabric serviço é diferente do certificado de nó para nó</span><span class="sxs-lookup"><span data-stu-id="000c6-413"><a id="fabric-cn-nn"></a>Ensure that Service Fabric client-to-node certificate is different from node-to-node certificate</span></span>

| <span data-ttu-id="000c6-414">Title</span><span class="sxs-lookup"><span data-stu-id="000c6-414">Title</span></span>                   | <span data-ttu-id="000c6-415">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-415">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="000c6-416">**Componente**</span><span class="sxs-lookup"><span data-stu-id="000c6-416">**Component**</span></span>               | <span data-ttu-id="000c6-417">Limite de confiança do Service Fabric</span><span class="sxs-lookup"><span data-stu-id="000c6-417">Service Fabric Trust Boundary</span></span> | 
| <span data-ttu-id="000c6-418">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="000c6-418">**SDL Phase**</span></span>               | <span data-ttu-id="000c6-419">Implantação</span><span class="sxs-lookup"><span data-stu-id="000c6-419">Deployment</span></span> |  
| <span data-ttu-id="000c6-420">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="000c6-420">**Applicable Technologies**</span></span> | <span data-ttu-id="000c6-421">Genérico</span><span class="sxs-lookup"><span data-stu-id="000c6-421">Generic</span></span> |
| <span data-ttu-id="000c6-422">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="000c6-422">**Attributes**</span></span>              | <span data-ttu-id="000c6-423">Ambiente - Azure, ambiente - autônomo</span><span class="sxs-lookup"><span data-stu-id="000c6-423">Environment - Azure, Environment - Stand alone</span></span> |
| <span data-ttu-id="000c6-424">**Referências**</span><span class="sxs-lookup"><span data-stu-id="000c6-424">**References**</span></span>              | <span data-ttu-id="000c6-425">[Segurança de certificado de cliente para nó do Service Fabric](https://azure.microsoft.com/documentation/articles/service-fabric-cluster-security/#_client-to-node-certificate-security), [Conectar-se a um cluster seguro usando um certificado de cliente](https://azure.microsoft.com/documentation/articles/service-fabric-connect-to-secure-cluster/)</span><span class="sxs-lookup"><span data-stu-id="000c6-425">[Service Fabric Client-to-node certificate security](https://azure.microsoft.com/documentation/articles/service-fabric-cluster-security/#_client-to-node-certificate-security), [Connect to a secure cluster using client certificate](https://azure.microsoft.com/documentation/articles/service-fabric-connect-to-secure-cluster/)</span></span> |
| <span data-ttu-id="000c6-426">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="000c6-426">**Steps**</span></span> | <p><span data-ttu-id="000c6-427">A segurança de certificado de cliente para nó é configurada durante a criação do cluster por meio do portal do Azure, dos modelos do Resource Manager ou de um modelo JSON autônomo, especificando um certificado de cliente do administrador e/ou um certificado de cliente do usuário.</span><span class="sxs-lookup"><span data-stu-id="000c6-427">Client-to-node certificate security is configured while creating the cluster either through the Azure portal, Resource Manager templates or a standalone JSON template by specifying an admin client certificate and/or a user client certificate.</span></span></p><p><span data-ttu-id="000c6-428">Os certificados de cliente administrador e certificados de cliente de usuário que você especificar devem ser diferentes dos certificados primários e secundários que você especifica para a Segurança de nó para nó.</span><span class="sxs-lookup"><span data-stu-id="000c6-428">The admin client and user client certificates you specify should be different than the primary and secondary certificates you specify for Node-to-node security.</span></span></p>|

## <span data-ttu-id="000c6-429"><a id="aad-client-fabric"></a>Use o AAD para autenticar clientes para clusters do service fabric</span><span class="sxs-lookup"><span data-stu-id="000c6-429"><a id="aad-client-fabric"></a>Use AAD to authenticate clients to service fabric clusters</span></span>

| <span data-ttu-id="000c6-430">Title</span><span class="sxs-lookup"><span data-stu-id="000c6-430">Title</span></span>                   | <span data-ttu-id="000c6-431">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-431">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="000c6-432">**Componente**</span><span class="sxs-lookup"><span data-stu-id="000c6-432">**Component**</span></span>               | <span data-ttu-id="000c6-433">Limite de confiança do Service Fabric</span><span class="sxs-lookup"><span data-stu-id="000c6-433">Service Fabric Trust Boundary</span></span> | 
| <span data-ttu-id="000c6-434">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="000c6-434">**SDL Phase**</span></span>               | <span data-ttu-id="000c6-435">Implantação</span><span class="sxs-lookup"><span data-stu-id="000c6-435">Deployment</span></span> |  
| <span data-ttu-id="000c6-436">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="000c6-436">**Applicable Technologies**</span></span> | <span data-ttu-id="000c6-437">Genérico</span><span class="sxs-lookup"><span data-stu-id="000c6-437">Generic</span></span> |
| <span data-ttu-id="000c6-438">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="000c6-438">**Attributes**</span></span>              | <span data-ttu-id="000c6-439">Ambiente - Azure</span><span class="sxs-lookup"><span data-stu-id="000c6-439">Environment - Azure</span></span> |
| <span data-ttu-id="000c6-440">**Referências**</span><span class="sxs-lookup"><span data-stu-id="000c6-440">**References**</span></span>              | [<span data-ttu-id="000c6-441">Cenários de segurança - recomendações de segurança de cluster</span><span class="sxs-lookup"><span data-stu-id="000c6-441">Cluster security scenarios - Security Recommendations</span></span>](https://azure.microsoft.com/documentation/articles/service-fabric-cluster-security/#security-recommendations) |
| <span data-ttu-id="000c6-442">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="000c6-442">**Steps**</span></span> | <span data-ttu-id="000c6-443">Clusters em execução no Azure também podem proteger o acesso aos pontos de extremidade de gerenciamento usando o AAD (Azure Active Directory), além de certificados de cliente.</span><span class="sxs-lookup"><span data-stu-id="000c6-443">Clusters running on Azure can also secure access to the management endpoints using Azure Active Directory (AAD), apart from client certificates.</span></span> <span data-ttu-id="000c6-444">Para clusters do Azure, é recomendável usar a segurança do AAD para autenticar clientes e certificados para a segurança de nó para nó.</span><span class="sxs-lookup"><span data-stu-id="000c6-444">For Azure clusters, it is recommended that you use AAD security to authenticate clients and certificates for node-to-node security.</span></span>|

## <span data-ttu-id="000c6-445"><a id="fabric-cert-ca"></a>Verifique se os certificados de service fabric são obtidos de uma CA (autoridade de certificação) aprovada</span><span class="sxs-lookup"><span data-stu-id="000c6-445"><a id="fabric-cert-ca"></a>Ensure that service fabric certificates are obtained from an approved Certificate Authority (CA)</span></span>

| <span data-ttu-id="000c6-446">Title</span><span class="sxs-lookup"><span data-stu-id="000c6-446">Title</span></span>                   | <span data-ttu-id="000c6-447">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-447">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="000c6-448">**Componente**</span><span class="sxs-lookup"><span data-stu-id="000c6-448">**Component**</span></span>               | <span data-ttu-id="000c6-449">Limite de confiança do Service Fabric</span><span class="sxs-lookup"><span data-stu-id="000c6-449">Service Fabric Trust Boundary</span></span> | 
| <span data-ttu-id="000c6-450">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="000c6-450">**SDL Phase**</span></span>               | <span data-ttu-id="000c6-451">Implantação</span><span class="sxs-lookup"><span data-stu-id="000c6-451">Deployment</span></span> |  
| <span data-ttu-id="000c6-452">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="000c6-452">**Applicable Technologies**</span></span> | <span data-ttu-id="000c6-453">Genérico</span><span class="sxs-lookup"><span data-stu-id="000c6-453">Generic</span></span> |
| <span data-ttu-id="000c6-454">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="000c6-454">**Attributes**</span></span>              | <span data-ttu-id="000c6-455">Ambiente - Azure</span><span class="sxs-lookup"><span data-stu-id="000c6-455">Environment - Azure</span></span> |
| <span data-ttu-id="000c6-456">**Referências**</span><span class="sxs-lookup"><span data-stu-id="000c6-456">**References**</span></span>              | [<span data-ttu-id="000c6-457">Certificados X.509 e Service Fabric</span><span class="sxs-lookup"><span data-stu-id="000c6-457">X.509 certificates and Service Fabric</span></span>](https://azure.microsoft.com/documentation/articles/service-fabric-cluster-security/#x509-certificates-and-service-fabric) |
| <span data-ttu-id="000c6-458">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="000c6-458">**Steps**</span></span> | <p><span data-ttu-id="000c6-459">O Service Fabric usa certificados de servidor X.509 para autenticar clientes e nós.</span><span class="sxs-lookup"><span data-stu-id="000c6-459">Service Fabric uses X.509 server certificates for authenticating nodes and clients.</span></span></p><p><span data-ttu-id="000c6-460">Alguns pontos importantes a considerar ao usar certificados em service fabrics:</span><span class="sxs-lookup"><span data-stu-id="000c6-460">Some important things to consider while using certificates in service fabrics:</span></span></p><ul><li><span data-ttu-id="000c6-461">Os certificados usados em clusters que executam cargas de trabalho de produção devem ser criados por meio de um serviço de certificado do Windows Server configurado corretamente ou obtidos por meio de uma AC (Autoridade de Certificação) aprovada.</span><span class="sxs-lookup"><span data-stu-id="000c6-461">Certificates used in clusters running production workloads should be created by using a correctly configured Windows Server certificate service or obtained from an approved Certificate Authority (CA).</span></span> <span data-ttu-id="000c6-462">A CA pode ser uma CA externa aprovada ou um PKI (Public Key Infrastructure) gerenciado adequadamente</span><span class="sxs-lookup"><span data-stu-id="000c6-462">The CA can be an approved external CA or a properly managed internal Public Key Infrastructure (PKI)</span></span></li><li><span data-ttu-id="000c6-463">Nunca use nenhum certificado temporário ou de teste em produção criado com ferramentas como MakeCert.exe</span><span class="sxs-lookup"><span data-stu-id="000c6-463">Never use any temporary or test certificates in production that are created with tools such as MakeCert.exe</span></span></li><li><span data-ttu-id="000c6-464">Você pode usar um certificado autoassinado, mas deve fazer isso somente para clusters de teste e não em produção</span><span class="sxs-lookup"><span data-stu-id="000c6-464">You can use a self-signed certificate, but should only do so for test clusters and not in production</span></span></li></ul>|

## <span data-ttu-id="000c6-465"><a id="standard-authn-id"></a>Use cenários de autenticação padrão com suporte no Servidor de Identidade</span><span class="sxs-lookup"><span data-stu-id="000c6-465"><a id="standard-authn-id"></a>Use standard authentication scenarios supported by Identity Server</span></span>

| <span data-ttu-id="000c6-466">Title</span><span class="sxs-lookup"><span data-stu-id="000c6-466">Title</span></span>                   | <span data-ttu-id="000c6-467">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-467">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="000c6-468">**Componente**</span><span class="sxs-lookup"><span data-stu-id="000c6-468">**Component**</span></span>               | <span data-ttu-id="000c6-469">Servidor de Identidade</span><span class="sxs-lookup"><span data-stu-id="000c6-469">Identity Server</span></span> | 
| <span data-ttu-id="000c6-470">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="000c6-470">**SDL Phase**</span></span>               | <span data-ttu-id="000c6-471">Compilação</span><span class="sxs-lookup"><span data-stu-id="000c6-471">Build</span></span> |  
| <span data-ttu-id="000c6-472">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="000c6-472">**Applicable Technologies**</span></span> | <span data-ttu-id="000c6-473">Genérico</span><span class="sxs-lookup"><span data-stu-id="000c6-473">Generic</span></span> |
| <span data-ttu-id="000c6-474">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="000c6-474">**Attributes**</span></span>              | <span data-ttu-id="000c6-475">N/D</span><span class="sxs-lookup"><span data-stu-id="000c6-475">N/A</span></span>  |
| <span data-ttu-id="000c6-476">**Referências**</span><span class="sxs-lookup"><span data-stu-id="000c6-476">**References**</span></span>              | [<span data-ttu-id="000c6-477">IdentityServer3 - visão geral</span><span class="sxs-lookup"><span data-stu-id="000c6-477">IdentityServer3 - The Big Picture</span></span>](https://identityserver.github.io/Documentation/docsv2/overview/bigPicture.html) |
| <span data-ttu-id="000c6-478">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="000c6-478">**Steps**</span></span> | <p><span data-ttu-id="000c6-479">Abaixo estão as interações típicas com suporte no Servidor de Identidade:</span><span class="sxs-lookup"><span data-stu-id="000c6-479">Below are the typical interactions supported by Identity Server:</span></span></p><ul><li><span data-ttu-id="000c6-480">Os navegadores se comunicam com aplicativos Web</span><span class="sxs-lookup"><span data-stu-id="000c6-480">Browsers communicate with web applications</span></span></li><li><span data-ttu-id="000c6-481">Os aplicativos Web se comunicam com APIs Web (às vezes, por conta própria e, às vezes, em nome do usuário)</span><span class="sxs-lookup"><span data-stu-id="000c6-481">Web applications communicate with web APIs (sometimes on their own, sometimes on behalf of a user)</span></span></li><li><span data-ttu-id="000c6-482">Aplicativos baseados em navegador se comunicam com APIs Web</span><span class="sxs-lookup"><span data-stu-id="000c6-482">Browser-based applications communicate with web APIs</span></span></li><li><span data-ttu-id="000c6-483">Aplicativos nativos se comunicam com APIs Web</span><span class="sxs-lookup"><span data-stu-id="000c6-483">Native applications communicate with web APIs</span></span></li><li><span data-ttu-id="000c6-484">Aplicativos baseados em servidor se comunicam com APIs Web</span><span class="sxs-lookup"><span data-stu-id="000c6-484">Server-based applications communicate with web APIs</span></span></li><li><span data-ttu-id="000c6-485">As APIs Web se comunicam com as APIs Web (às vezes, por conta própria e, às vezes, em nome do usuário)</span><span class="sxs-lookup"><span data-stu-id="000c6-485">Web APIs communicate with web APIs (sometimes on their own, sometimes on behalf of a user)</span></span></li></ul>|

## <span data-ttu-id="000c6-486"><a id="override-token"></a>Substitua o cache de token de identidade de servidor padrão por uma alternativa escalonável</span><span class="sxs-lookup"><span data-stu-id="000c6-486"><a id="override-token"></a>Override the default Identity Server token cache with a scalable alternative</span></span>

| <span data-ttu-id="000c6-487">Title</span><span class="sxs-lookup"><span data-stu-id="000c6-487">Title</span></span>                   | <span data-ttu-id="000c6-488">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-488">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="000c6-489">**Componente**</span><span class="sxs-lookup"><span data-stu-id="000c6-489">**Component**</span></span>               | <span data-ttu-id="000c6-490">Servidor de Identidade</span><span class="sxs-lookup"><span data-stu-id="000c6-490">Identity Server</span></span> | 
| <span data-ttu-id="000c6-491">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="000c6-491">**SDL Phase**</span></span>               | <span data-ttu-id="000c6-492">Implantação</span><span class="sxs-lookup"><span data-stu-id="000c6-492">Deployment</span></span> |  
| <span data-ttu-id="000c6-493">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="000c6-493">**Applicable Technologies**</span></span> | <span data-ttu-id="000c6-494">Genérico</span><span class="sxs-lookup"><span data-stu-id="000c6-494">Generic</span></span> |
| <span data-ttu-id="000c6-495">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="000c6-495">**Attributes**</span></span>              | <span data-ttu-id="000c6-496">N/D</span><span class="sxs-lookup"><span data-stu-id="000c6-496">N/A</span></span>  |
| <span data-ttu-id="000c6-497">**Referências**</span><span class="sxs-lookup"><span data-stu-id="000c6-497">**References**</span></span>              | [<span data-ttu-id="000c6-498">Implantação de Servidor de Identidade - cache</span><span class="sxs-lookup"><span data-stu-id="000c6-498">Identity Server Deployment - Caching</span></span>](https://identityserver.github.io/Documentation/docsv2/advanced/deployment.html) |
| <span data-ttu-id="000c6-499">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="000c6-499">**Steps**</span></span> | <p><span data-ttu-id="000c6-500">IdentityServer tem um cache na memória interno simples.</span><span class="sxs-lookup"><span data-stu-id="000c6-500">IdentityServer has a simple built-in in-memory cache.</span></span> <span data-ttu-id="000c6-501">Embora seja adequado para aplicativos nativos de pequena escala, ele não é dimensionado para aplicativos de camada intermediária e back-end pelos seguintes motivos:</span><span class="sxs-lookup"><span data-stu-id="000c6-501">While this is good for small scale native apps, it does not scale for mid tier and backend applications for the following reasons:</span></span></p><ul><li><span data-ttu-id="000c6-502">Esses aplicativos são acessados por vários usuários simultaneamente.</span><span class="sxs-lookup"><span data-stu-id="000c6-502">These applications are accessed by many users at once.</span></span> <span data-ttu-id="000c6-503">Salvar todos os tokens de acesso no mesmo repositório cria problemas de isolamento e apresenta desafios ao operar em grande escala: vários usuários, cada um com o mesmo número de tokens que os recursos que o aplicativo acessa em seu nome, podem significar numerosas operações de pesquisa muito caras</span><span class="sxs-lookup"><span data-stu-id="000c6-503">Saving all access tokens in the same store creates isolation issues and presents challenges when operating at scale: many users, each with as many tokens as the resources the app accesses on their behalf, can mean huge numbers and very expensive lookup operations</span></span></li><li><span data-ttu-id="000c6-504">Esses aplicativos normalmente são implantados em topologias distribuídas, em que vários nós devem ter acesso ao mesmo cache</span><span class="sxs-lookup"><span data-stu-id="000c6-504">These applications are typically deployed on distributed topologies, where multiple nodes must have access to the same cache</span></span></li><li><span data-ttu-id="000c6-505">Os tokens em cache devem sobreviver a desativações e reciclagem de processo</span><span class="sxs-lookup"><span data-stu-id="000c6-505">Cached tokens must survive process recycles and deactivations</span></span></li><li><span data-ttu-id="000c6-506">Por todos os motivos acima, com a implementação de aplicativos Web, é recomendável substituir o cache de token do servidor de identidade padrão por uma alternativa escalonável, como o cache Redis do Azure</span><span class="sxs-lookup"><span data-stu-id="000c6-506">For all the above reasons, while implementing web apps, it is recommended to override the default Identity Server's token cache with a scalable alternative such as Azure Redis cache</span></span></li></ul>|

## <span data-ttu-id="000c6-507"><a id="binaries-signed"></a>Verifique se os binários do aplicativo implantado são assinados digitalmente</span><span class="sxs-lookup"><span data-stu-id="000c6-507"><a id="binaries-signed"></a>Ensure that deployed application's binaries are digitally signed</span></span>

| <span data-ttu-id="000c6-508">Title</span><span class="sxs-lookup"><span data-stu-id="000c6-508">Title</span></span>                   | <span data-ttu-id="000c6-509">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-509">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="000c6-510">**Componente**</span><span class="sxs-lookup"><span data-stu-id="000c6-510">**Component**</span></span>               | <span data-ttu-id="000c6-511">Limite de Confiança de Máquina</span><span class="sxs-lookup"><span data-stu-id="000c6-511">Machine Trust Boundary</span></span> | 
| <span data-ttu-id="000c6-512">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="000c6-512">**SDL Phase**</span></span>               | <span data-ttu-id="000c6-513">Implantação</span><span class="sxs-lookup"><span data-stu-id="000c6-513">Deployment</span></span> |  
| <span data-ttu-id="000c6-514">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="000c6-514">**Applicable Technologies**</span></span> | <span data-ttu-id="000c6-515">Genérico</span><span class="sxs-lookup"><span data-stu-id="000c6-515">Generic</span></span> |
| <span data-ttu-id="000c6-516">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="000c6-516">**Attributes**</span></span>              | <span data-ttu-id="000c6-517">N/D</span><span class="sxs-lookup"><span data-stu-id="000c6-517">N/A</span></span>  |
| <span data-ttu-id="000c6-518">**Referências**</span><span class="sxs-lookup"><span data-stu-id="000c6-518">**References**</span></span>              | <span data-ttu-id="000c6-519">N/D</span><span class="sxs-lookup"><span data-stu-id="000c6-519">N/A</span></span>  |
| <span data-ttu-id="000c6-520">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="000c6-520">**Steps**</span></span> | <span data-ttu-id="000c6-521">Verifique se os binários do aplicativo implantado são assinados digitalmente para que seja possível verificar a integridade dos binários</span><span class="sxs-lookup"><span data-stu-id="000c6-521">Ensure that deployed application's binaries are digitally signed so that the integrity of the binaries can be verified</span></span>|

## <span data-ttu-id="000c6-522"><a id="msmq-queues"></a>Habilite a autenticação ao se conectar às filas MSMQ do WCF</span><span class="sxs-lookup"><span data-stu-id="000c6-522"><a id="msmq-queues"></a>Enable authentication when connecting to MSMQ queues in WCF</span></span>

| <span data-ttu-id="000c6-523">Title</span><span class="sxs-lookup"><span data-stu-id="000c6-523">Title</span></span>                   | <span data-ttu-id="000c6-524">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-524">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="000c6-525">**Componente**</span><span class="sxs-lookup"><span data-stu-id="000c6-525">**Component**</span></span>               | <span data-ttu-id="000c6-526">WCF</span><span class="sxs-lookup"><span data-stu-id="000c6-526">WCF</span></span> | 
| <span data-ttu-id="000c6-527">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="000c6-527">**SDL Phase**</span></span>               | <span data-ttu-id="000c6-528">Compilação</span><span class="sxs-lookup"><span data-stu-id="000c6-528">Build</span></span> |  
| <span data-ttu-id="000c6-529">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="000c6-529">**Applicable Technologies**</span></span> | <span data-ttu-id="000c6-530">Genérico, NET Framework 3</span><span class="sxs-lookup"><span data-stu-id="000c6-530">Generic, NET Framework 3</span></span> |
| <span data-ttu-id="000c6-531">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="000c6-531">**Attributes**</span></span>              | <span data-ttu-id="000c6-532">N/D</span><span class="sxs-lookup"><span data-stu-id="000c6-532">N/A</span></span> |
| <span data-ttu-id="000c6-533">**Referências**</span><span class="sxs-lookup"><span data-stu-id="000c6-533">**References**</span></span>              | [<span data-ttu-id="000c6-534">MSDN</span><span class="sxs-lookup"><span data-stu-id="000c6-534">MSDN</span></span>](https://msdn.microsoft.com/library/ff648500.aspx) |
| <span data-ttu-id="000c6-535">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="000c6-535">**Steps**</span></span> | <span data-ttu-id="000c6-536">O programa não habilita a autenticação ao conectar-se às filas do MSMQ. Um invasor anônimo pode enviar mensagens à fila para processamento.</span><span class="sxs-lookup"><span data-stu-id="000c6-536">Program fails to enable authentication when connecting to MSMQ queues, an attacker can anonymously submit messages to the queue for processing.</span></span> <span data-ttu-id="000c6-537">Se a autenticação não for usada para se conectar a uma fila do MSMQ usada para enviar uma mensagem a outro programa, um invasor poderá enviar uma mensagem anônima mal-intencionada.</span><span class="sxs-lookup"><span data-stu-id="000c6-537">If authentication is not used to connect to an MSMQ queue used to deliver a message to another program, an attacker could submit an anonymous message that is malicious.</span></span>|

### <a name="example"></a><span data-ttu-id="000c6-538">Exemplo</span><span class="sxs-lookup"><span data-stu-id="000c6-538">Example</span></span>
<span data-ttu-id="000c6-539">O elemento `<netMsmqBinding/>` do arquivo de configuração WCF abaixo instrui o WCF a desabilitar a autenticação ao se conectar a uma fila do MSMQ para entrega de mensagens.</span><span class="sxs-lookup"><span data-stu-id="000c6-539">The `<netMsmqBinding/>` element of the WCF configuration file below instructs WCF to disable authentication when connecting to an MSMQ queue for message delivery.</span></span>
```
<bindings>
    <netMsmqBinding>
        <binding>
            <security>
                <transport msmqAuthenticationMode=""None"" />
            </security>
        </binding>
    </netMsmqBinding>
</bindings>
```
<span data-ttu-id="000c6-540">Configure o MSMQ para exigir sempre autenticação de Domínio do Windows ou de Certificado para todas as mensagens de entrada ou saída.</span><span class="sxs-lookup"><span data-stu-id="000c6-540">Configure MSMQ to require Windows Domain or Certificate authentication at all times for any incoming or outgoing messages.</span></span>

### <a name="example"></a><span data-ttu-id="000c6-541">Exemplo</span><span class="sxs-lookup"><span data-stu-id="000c6-541">Example</span></span>
<span data-ttu-id="000c6-542">O elemento `<netMsmqBinding/>` do arquivo de configuração WCF abaixo instrui o WCF a habilitar a autenticação de certificado ao se conectar a uma fila do MSMQ.</span><span class="sxs-lookup"><span data-stu-id="000c6-542">The `<netMsmqBinding/>` element of the WCF configuration file below instructs WCF to enable certificate authentication when connecting to an MSMQ queue.</span></span> <span data-ttu-id="000c6-543">O cliente é autenticado usando certificados X.509.</span><span class="sxs-lookup"><span data-stu-id="000c6-543">The client is authenticated using X.509 certificates.</span></span> <span data-ttu-id="000c6-544">O certificado do cliente deve estar presente no repositório de certificados do servidor.</span><span class="sxs-lookup"><span data-stu-id="000c6-544">The client certificate must be present in the certificate store of the server.</span></span>
```
<bindings>
    <netMsmqBinding>
        <binding>
            <security>
                <transport msmqAuthenticationMode=""Certificate"" />
            </security>
        </binding>
    </netMsmqBinding>
</bindings>
```

## <span data-ttu-id="000c6-545"><a id="message-none"></a>WCF - não defina clientCredentialType de mensagem como none</span><span class="sxs-lookup"><span data-stu-id="000c6-545"><a id="message-none"></a>WCF-Do not set Message clientCredentialType to none</span></span>

| <span data-ttu-id="000c6-546">Title</span><span class="sxs-lookup"><span data-stu-id="000c6-546">Title</span></span>                   | <span data-ttu-id="000c6-547">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-547">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="000c6-548">**Componente**</span><span class="sxs-lookup"><span data-stu-id="000c6-548">**Component**</span></span>               | <span data-ttu-id="000c6-549">WCF</span><span class="sxs-lookup"><span data-stu-id="000c6-549">WCF</span></span> | 
| <span data-ttu-id="000c6-550">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="000c6-550">**SDL Phase**</span></span>               | <span data-ttu-id="000c6-551">Compilação</span><span class="sxs-lookup"><span data-stu-id="000c6-551">Build</span></span> |  
| <span data-ttu-id="000c6-552">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="000c6-552">**Applicable Technologies**</span></span> | <span data-ttu-id="000c6-553">.NET Framework 3</span><span class="sxs-lookup"><span data-stu-id="000c6-553">.NET Framework 3</span></span> |
| <span data-ttu-id="000c6-554">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="000c6-554">**Attributes**</span></span>              | <span data-ttu-id="000c6-555">Tipo de Credencial de Cliente - Nenhuma</span><span class="sxs-lookup"><span data-stu-id="000c6-555">Client Credential Type - None</span></span> |
| <span data-ttu-id="000c6-556">**Referências**</span><span class="sxs-lookup"><span data-stu-id="000c6-556">**References**</span></span>              | <span data-ttu-id="000c6-557">[MSDN](https://msdn.microsoft.com/library/ff648500.aspx), [Fortalecer](https://vulncat.fortify.com/en/vulncat/index.html)</span><span class="sxs-lookup"><span data-stu-id="000c6-557">[MSDN](https://msdn.microsoft.com/library/ff648500.aspx), [Fortify](https://vulncat.fortify.com/en/vulncat/index.html)</span></span> |
| <span data-ttu-id="000c6-558">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="000c6-558">**Steps**</span></span> | <span data-ttu-id="000c6-559">A ausência de autenticação significa que todos podem acessar o serviço.</span><span class="sxs-lookup"><span data-stu-id="000c6-559">The absence of authentication means everyone is able to access this service.</span></span> <span data-ttu-id="000c6-560">Um serviço que não autentica seus clientes permite acesso a todos os usuários.</span><span class="sxs-lookup"><span data-stu-id="000c6-560">A service that does not authenticate its clients allows access to all users.</span></span> <span data-ttu-id="000c6-561">Configure o aplicativo para autenticação em relação às credenciais do cliente.</span><span class="sxs-lookup"><span data-stu-id="000c6-561">Configure the application to authenticate against client credentials.</span></span> <span data-ttu-id="000c6-562">Isso pode ser feito definindo a mensagem clientCredentialType para Windows ou Certificado.</span><span class="sxs-lookup"><span data-stu-id="000c6-562">This can be done by setting the message clientCredentialType to Windows or Certificate.</span></span> |

### <a name="example"></a><span data-ttu-id="000c6-563">Exemplo</span><span class="sxs-lookup"><span data-stu-id="000c6-563">Example</span></span>
```
<message clientCredentialType=""Certificate""/>
```

## <span data-ttu-id="000c6-564"><a id="transport-none"></a>WCF - não defina clientCredentialType de transporte como none</span><span class="sxs-lookup"><span data-stu-id="000c6-564"><a id="transport-none"></a>WCF-Do not set Transport clientCredentialType to none</span></span>

| <span data-ttu-id="000c6-565">Title</span><span class="sxs-lookup"><span data-stu-id="000c6-565">Title</span></span>                   | <span data-ttu-id="000c6-566">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-566">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="000c6-567">**Componente**</span><span class="sxs-lookup"><span data-stu-id="000c6-567">**Component**</span></span>               | <span data-ttu-id="000c6-568">WCF</span><span class="sxs-lookup"><span data-stu-id="000c6-568">WCF</span></span> | 
| <span data-ttu-id="000c6-569">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="000c6-569">**SDL Phase**</span></span>               | <span data-ttu-id="000c6-570">Compilação</span><span class="sxs-lookup"><span data-stu-id="000c6-570">Build</span></span> |  
| <span data-ttu-id="000c6-571">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="000c6-571">**Applicable Technologies**</span></span> | <span data-ttu-id="000c6-572">Genérico, .NET Framework 3</span><span class="sxs-lookup"><span data-stu-id="000c6-572">Generic, .NET Framework 3</span></span> |
| <span data-ttu-id="000c6-573">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="000c6-573">**Attributes**</span></span>              | <span data-ttu-id="000c6-574">Tipo de Credencial de Cliente - Nenhuma</span><span class="sxs-lookup"><span data-stu-id="000c6-574">Client Credential Type - None</span></span> |
| <span data-ttu-id="000c6-575">**Referências**</span><span class="sxs-lookup"><span data-stu-id="000c6-575">**References**</span></span>              | <span data-ttu-id="000c6-576">[MSDN](https://msdn.microsoft.com/library/ff648500.aspx), [Fortalecer](https://vulncat.fortify.com/en/vulncat/index.html)</span><span class="sxs-lookup"><span data-stu-id="000c6-576">[MSDN](https://msdn.microsoft.com/library/ff648500.aspx), [Fortify](https://vulncat.fortify.com/en/vulncat/index.html)</span></span> |
| <span data-ttu-id="000c6-577">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="000c6-577">**Steps**</span></span> | <span data-ttu-id="000c6-578">A ausência de autenticação significa que todos podem acessar o serviço.</span><span class="sxs-lookup"><span data-stu-id="000c6-578">The absence of authentication means everyone is able to access this service.</span></span> <span data-ttu-id="000c6-579">Um serviço que não autentica seus clientes permite que todos os usuários acessem sua funcionalidade.</span><span class="sxs-lookup"><span data-stu-id="000c6-579">A service that does not authenticate its clients allows all users to access its functionality.</span></span> <span data-ttu-id="000c6-580">Configure o aplicativo para autenticação em relação às credenciais do cliente.</span><span class="sxs-lookup"><span data-stu-id="000c6-580">Configure the application to authenticate against client credentials.</span></span> <span data-ttu-id="000c6-581">Isso pode ser feito definindo o transporte clientCredentialType para Windows ou Certificado.</span><span class="sxs-lookup"><span data-stu-id="000c6-581">This can be done by setting the transport clientCredentialType to Windows or Certificate.</span></span> |

### <a name="example"></a><span data-ttu-id="000c6-582">Exemplo</span><span class="sxs-lookup"><span data-stu-id="000c6-582">Example</span></span>
```
<transport clientCredentialType=""Certificate""/>
```

## <span data-ttu-id="000c6-583"><a id="authn-secure-api"></a>Verifique se técnicas de autenticação padrão são usadas para proteger as APIs Web</span><span class="sxs-lookup"><span data-stu-id="000c6-583"><a id="authn-secure-api"></a>Ensure that standard authentication techniques are used to secure Web APIs</span></span>

| <span data-ttu-id="000c6-584">Title</span><span class="sxs-lookup"><span data-stu-id="000c6-584">Title</span></span>                   | <span data-ttu-id="000c6-585">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-585">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="000c6-586">**Componente**</span><span class="sxs-lookup"><span data-stu-id="000c6-586">**Component**</span></span>               | <span data-ttu-id="000c6-587">API Web</span><span class="sxs-lookup"><span data-stu-id="000c6-587">Web API</span></span> | 
| <span data-ttu-id="000c6-588">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="000c6-588">**SDL Phase**</span></span>               | <span data-ttu-id="000c6-589">Compilação</span><span class="sxs-lookup"><span data-stu-id="000c6-589">Build</span></span> |  
| <span data-ttu-id="000c6-590">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="000c6-590">**Applicable Technologies**</span></span> | <span data-ttu-id="000c6-591">Genérico</span><span class="sxs-lookup"><span data-stu-id="000c6-591">Generic</span></span> |
| <span data-ttu-id="000c6-592">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="000c6-592">**Attributes**</span></span>              | <span data-ttu-id="000c6-593">N/D</span><span class="sxs-lookup"><span data-stu-id="000c6-593">N/A</span></span>  |
| <span data-ttu-id="000c6-594">**Referências**</span><span class="sxs-lookup"><span data-stu-id="000c6-594">**References**</span></span>              | <span data-ttu-id="000c6-595">[Autenticação e Autorização na API Web ASP.NET](http://www.asp.net/web-api/overview/security/authentication-and-authorization-in-aspnet-web-api), [Serviços de Autenticação Externa com a API Web do ASP.NET (C#)](http://www.asp.net/web-api/overview/security/external-authentication-services)</span><span class="sxs-lookup"><span data-stu-id="000c6-595">[Authentication and Authorization in ASP.NET Web API](http://www.asp.net/web-api/overview/security/authentication-and-authorization-in-aspnet-web-api), [External Authentication Services with ASP.NET Web API (C#)](http://www.asp.net/web-api/overview/security/external-authentication-services)</span></span> |
| <span data-ttu-id="000c6-596">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="000c6-596">**Steps**</span></span> | <p><span data-ttu-id="000c6-597">A autenticação é o processo em que uma entidade comprova sua identidade, normalmente por meio de credenciais, como um nome de usuário e uma senha.</span><span class="sxs-lookup"><span data-stu-id="000c6-597">Authentication is the process where an entity proves its identity, typically through credentials, such as a user name and password.</span></span> <span data-ttu-id="000c6-598">Há vários protocolos de autenticação disponíveis que podem ser considerados.</span><span class="sxs-lookup"><span data-stu-id="000c6-598">There are multiple authentication protocols available which may be considered.</span></span> <span data-ttu-id="000c6-599">Alguns deles são listados abaixo:</span><span class="sxs-lookup"><span data-stu-id="000c6-599">Some of them are listed below:</span></span></p><ul><li><span data-ttu-id="000c6-600">Certificados do cliente</span><span class="sxs-lookup"><span data-stu-id="000c6-600">Client certificates</span></span></li><li><span data-ttu-id="000c6-601">Baseado no Windows</span><span class="sxs-lookup"><span data-stu-id="000c6-601">Windows based</span></span></li><li><span data-ttu-id="000c6-602">Baseado em formulários</span><span class="sxs-lookup"><span data-stu-id="000c6-602">Forms based</span></span></li><li><span data-ttu-id="000c6-603">Federação - ADFS</span><span class="sxs-lookup"><span data-stu-id="000c6-603">Federation - ADFS</span></span></li><li><span data-ttu-id="000c6-604">Federação – Azure AD</span><span class="sxs-lookup"><span data-stu-id="000c6-604">Federation - Azure AD</span></span></li><li><span data-ttu-id="000c6-605">Federação - Servidor de Identidade</span><span class="sxs-lookup"><span data-stu-id="000c6-605">Federation - Identity Server</span></span></li></ul><p><span data-ttu-id="000c6-606">Os links na seção de referências fornecem detalhes de baixo nível sobre como cada um dos esquemas de autenticação pode ser implementado para proteger uma API Web.</span><span class="sxs-lookup"><span data-stu-id="000c6-606">Links in the references section provide low-level details on how each of the authentication schemes can be implemented to secure a Web API.</span></span></p>|

## <span data-ttu-id="000c6-607"><a id="authn-aad"></a>Use cenários de autenticação padrão com suporte no Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="000c6-607"><a id="authn-aad"></a>Use standard authentication scenarios supported by Azure Active Directory</span></span>

| <span data-ttu-id="000c6-608">Title</span><span class="sxs-lookup"><span data-stu-id="000c6-608">Title</span></span>                   | <span data-ttu-id="000c6-609">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-609">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="000c6-610">**Componente**</span><span class="sxs-lookup"><span data-stu-id="000c6-610">**Component**</span></span>               | <span data-ttu-id="000c6-611">AD do Azure</span><span class="sxs-lookup"><span data-stu-id="000c6-611">Azure AD</span></span> | 
| <span data-ttu-id="000c6-612">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="000c6-612">**SDL Phase**</span></span>               | <span data-ttu-id="000c6-613">Compilação</span><span class="sxs-lookup"><span data-stu-id="000c6-613">Build</span></span> |  
| <span data-ttu-id="000c6-614">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="000c6-614">**Applicable Technologies**</span></span> | <span data-ttu-id="000c6-615">Genérico</span><span class="sxs-lookup"><span data-stu-id="000c6-615">Generic</span></span> |
| <span data-ttu-id="000c6-616">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="000c6-616">**Attributes**</span></span>              | <span data-ttu-id="000c6-617">N/D</span><span class="sxs-lookup"><span data-stu-id="000c6-617">N/A</span></span>  |
| <span data-ttu-id="000c6-618">**Referências**</span><span class="sxs-lookup"><span data-stu-id="000c6-618">**References**</span></span>              | <span data-ttu-id="000c6-619">[Cenários de Autenticação do Azure AD](https://azure.microsoft.com/documentation/articles/active-directory-authentication-scenarios/), [Exemplos de Código do Azure Active Directory](https://azure.microsoft.com/documentation/articles/active-directory-code-samples/), [Guia do Desenvolvedor do Azure Active Directory](https://azure.microsoft.com/documentation/articles/active-directory-developers-guide/)</span><span class="sxs-lookup"><span data-stu-id="000c6-619">[Authentication Scenarios for Azure AD](https://azure.microsoft.com/documentation/articles/active-directory-authentication-scenarios/), [Azure Active Directory Code Samples](https://azure.microsoft.com/documentation/articles/active-directory-code-samples/), [Azure Active Directory developer's guide](https://azure.microsoft.com/documentation/articles/active-directory-developers-guide/)</span></span> |
| <span data-ttu-id="000c6-620">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="000c6-620">**Steps**</span></span> | <p><span data-ttu-id="000c6-621">O Azure AD (Azure Active Directory) simplifica a autenticação para os desenvolvedores fornecendo identidade como um serviço, com suporte para protocolos padrão do setor, como OAuth 2.0 e OpenID Connect.</span><span class="sxs-lookup"><span data-stu-id="000c6-621">Azure Active Directory (Azure AD) simplifies authentication for developers by providing identity as a service, with support for industry-standard protocols such as OAuth 2.0 and OpenID Connect.</span></span> <span data-ttu-id="000c6-622">Abaixo estão os cinco cenários de aplicativo principais suportados pelo Azure AD:</span><span class="sxs-lookup"><span data-stu-id="000c6-622">Below are the five primary application scenarios supported by Azure AD:</span></span></p><ul><li><span data-ttu-id="000c6-623">Navegador da Web para aplicativo Web: um usuário precisa entrar em um aplicativo Web protegido pelo Azure AD</span><span class="sxs-lookup"><span data-stu-id="000c6-623">Web Browser to Web Application: A user needs to sign in to a web application that is secured by Azure AD</span></span></li><li><span data-ttu-id="000c6-624">SPA (Aplicativo de Página Única): um usuário precisa entrar em um aplicativo de página única protegida pelo Azure AD</span><span class="sxs-lookup"><span data-stu-id="000c6-624">Single Page Application (SPA): A user needs to sign in to a single page application that is secured by Azure AD</span></span></li><li><span data-ttu-id="000c6-625">Aplicativo nativo para API da Web: um aplicativo nativo que é executado em um telefone, tablet ou PC precisa autenticar um usuário para obter recursos de uma API da Web que é protegida pelo Azure AD</span><span class="sxs-lookup"><span data-stu-id="000c6-625">Native Application to Web API: A native application that runs on a phone, tablet, or PC needs to authenticate a user to get resources from a web API that is secured by Azure AD</span></span></li><li><span data-ttu-id="000c6-626">Aplicativo Web para API da Web: um aplicativo Web precisa obter recursos de uma API da Web protegida pelo Azure AD</span><span class="sxs-lookup"><span data-stu-id="000c6-626">Web Application to Web API: A web application needs to get resources from a web API secured by Azure AD</span></span></li><li><span data-ttu-id="000c6-627">Aplicativo daemon ou de servidor para API da Web: um aplicativo daemon ou um aplicativo de servidor sem interface do usuário da Web precisa obter recursos de uma API da Web protegida pelo Azure AD</span><span class="sxs-lookup"><span data-stu-id="000c6-627">Daemon or Server Application to Web API: A daemon application or a server application with no web user interface needs to get resources from a web API secured by Azure AD</span></span></li></ul><p><span data-ttu-id="000c6-628">Confira os links na seção de referências para obter detalhes sobre a implementação de nível baixo</span><span class="sxs-lookup"><span data-stu-id="000c6-628">Please refer to the links in the references section for low-level implementation details</span></span></p>|

## <span data-ttu-id="000c6-629"><a id="adal-scalable"></a>Substitua o cache de token ADAL padrão por uma alternativa escalonável</span><span class="sxs-lookup"><span data-stu-id="000c6-629"><a id="adal-scalable"></a>Override the default ADAL token cache with a scalable alternative</span></span>

| <span data-ttu-id="000c6-630">Title</span><span class="sxs-lookup"><span data-stu-id="000c6-630">Title</span></span>                   | <span data-ttu-id="000c6-631">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-631">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="000c6-632">**Componente**</span><span class="sxs-lookup"><span data-stu-id="000c6-632">**Component**</span></span>               | <span data-ttu-id="000c6-633">AD do Azure</span><span class="sxs-lookup"><span data-stu-id="000c6-633">Azure AD</span></span> | 
| <span data-ttu-id="000c6-634">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="000c6-634">**SDL Phase**</span></span>               | <span data-ttu-id="000c6-635">Compilação</span><span class="sxs-lookup"><span data-stu-id="000c6-635">Build</span></span> |  
| <span data-ttu-id="000c6-636">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="000c6-636">**Applicable Technologies**</span></span> | <span data-ttu-id="000c6-637">Genérico</span><span class="sxs-lookup"><span data-stu-id="000c6-637">Generic</span></span> |
| <span data-ttu-id="000c6-638">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="000c6-638">**Attributes**</span></span>              | <span data-ttu-id="000c6-639">N/D</span><span class="sxs-lookup"><span data-stu-id="000c6-639">N/A</span></span>  |
| <span data-ttu-id="000c6-640">**Referências**</span><span class="sxs-lookup"><span data-stu-id="000c6-640">**References**</span></span>              | <span data-ttu-id="000c6-641">[Autenticação Moderna com o Azure Active Directory para Aplicativos Web](https://blogs.msdn.microsoft.com/microsoft_press/2016/01/04/new-book-modern-authentication-with-azure-active-directory-for-web-applications/), [Usando o Redis como cache de token ADAL](https://blogs.msdn.microsoft.com/mrochon/2016/09/19/using-redis-as-adal-token-cache/)</span><span class="sxs-lookup"><span data-stu-id="000c6-641">[Modern Authentication with Azure Active Directory for Web Applications](https://blogs.msdn.microsoft.com/microsoft_press/2016/01/04/new-book-modern-authentication-with-azure-active-directory-for-web-applications/), [Using Redis as ADAL token cache](https://blogs.msdn.microsoft.com/mrochon/2016/09/19/using-redis-as-adal-token-cache/)</span></span>  |
| <span data-ttu-id="000c6-642">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="000c6-642">**Steps**</span></span> | <p><span data-ttu-id="000c6-643">O cache padrão que usa a ADAL (Biblioteca de Autenticação do Active Directory) é um cache na memória que se baseia em um armazenamento estático, disponível em todo o processo.</span><span class="sxs-lookup"><span data-stu-id="000c6-643">The default cache that ADAL (Active Directory Authentication Library) uses is an in-memory cache that relies on a static store, available process-wide.</span></span> <span data-ttu-id="000c6-644">Embora isso funcione para aplicativos nativos, ele não é dimensionado para aplicativos de camada intermediária e back-end pelos seguintes motivos:</span><span class="sxs-lookup"><span data-stu-id="000c6-644">While this works for native applications, it does not scale for mid tier and backend applications for the following reasons:</span></span></p><ul><li><span data-ttu-id="000c6-645">Esses aplicativos são acessados por vários usuários simultaneamente.</span><span class="sxs-lookup"><span data-stu-id="000c6-645">These applications are accessed by many users at once.</span></span> <span data-ttu-id="000c6-646">Salvar todos os tokens de acesso no mesmo repositório cria problemas de isolamento e apresenta desafios ao operar em grande escala: vários usuários, cada um com o mesmo número de tokens que os recursos que o aplicativo acessa em seu nome, podem significar numerosas operações de pesquisa muito caras</span><span class="sxs-lookup"><span data-stu-id="000c6-646">Saving all access tokens in the same store creates isolation issues and presents challenges when operating at scale: many users, each with as many tokens as the resources the app accesses on their behalf, can mean huge numbers and very expensive lookup operations</span></span></li><li><span data-ttu-id="000c6-647">Esses aplicativos normalmente são implantados em topologias distribuídas, em que vários nós devem ter acesso ao mesmo cache</span><span class="sxs-lookup"><span data-stu-id="000c6-647">These applications are typically deployed on distributed topologies, where multiple nodes must have access to the same cache</span></span></li><li><span data-ttu-id="000c6-648">Os tokens em cache devem sobreviver a desativações e reciclagem de processo</span><span class="sxs-lookup"><span data-stu-id="000c6-648">Cached tokens must survive process recycles and deactivations</span></span></li></ul><p><span data-ttu-id="000c6-649">Por todos os motivos acima, com a implementação de aplicativos Web, é recomendável substituir o cache de token ADAL padrão por uma alternativa escalonável, como o cache Redis do Azure.</span><span class="sxs-lookup"><span data-stu-id="000c6-649">For all the above reasons, while implementing web apps, it is recommended to override the default ADAL token cache with a scalable alternative such as Azure Redis cache.</span></span></p>|

## <span data-ttu-id="000c6-650"><a id="tokenreplaycache-adal"></a>Verifique se TokenReplayCache é usado para evitar a repetição de tokens de autenticação ADAL</span><span class="sxs-lookup"><span data-stu-id="000c6-650"><a id="tokenreplaycache-adal"></a>Ensure that TokenReplayCache is used to prevent the replay of ADAL authentication tokens</span></span>

| <span data-ttu-id="000c6-651">Title</span><span class="sxs-lookup"><span data-stu-id="000c6-651">Title</span></span>                   | <span data-ttu-id="000c6-652">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-652">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="000c6-653">**Componente**</span><span class="sxs-lookup"><span data-stu-id="000c6-653">**Component**</span></span>               | <span data-ttu-id="000c6-654">AD do Azure</span><span class="sxs-lookup"><span data-stu-id="000c6-654">Azure AD</span></span> | 
| <span data-ttu-id="000c6-655">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="000c6-655">**SDL Phase**</span></span>               | <span data-ttu-id="000c6-656">Compilação</span><span class="sxs-lookup"><span data-stu-id="000c6-656">Build</span></span> |  
| <span data-ttu-id="000c6-657">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="000c6-657">**Applicable Technologies**</span></span> | <span data-ttu-id="000c6-658">Genérico</span><span class="sxs-lookup"><span data-stu-id="000c6-658">Generic</span></span> |
| <span data-ttu-id="000c6-659">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="000c6-659">**Attributes**</span></span>              | <span data-ttu-id="000c6-660">N/D</span><span class="sxs-lookup"><span data-stu-id="000c6-660">N/A</span></span>  |
| <span data-ttu-id="000c6-661">**Referências**</span><span class="sxs-lookup"><span data-stu-id="000c6-661">**References**</span></span>              | [<span data-ttu-id="000c6-662">Autenticação Moderna com o Azure Active Directory para Aplicativos Web</span><span class="sxs-lookup"><span data-stu-id="000c6-662">Modern Authentication with Azure Active Directory for Web Applications</span></span>](https://blogs.msdn.microsoft.com/microsoft_press/2016/01/04/new-book-modern-authentication-with-azure-active-directory-for-web-applications/) |
| <span data-ttu-id="000c6-663">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="000c6-663">**Steps**</span></span> | <p><span data-ttu-id="000c6-664">A propriedade TokenReplayCache permite aos desenvolvedores definir um cache de reprodução de token, um repositório que pode ser usado para salvar os tokens com a finalidade de verificar se nenhum token pode ser usado mais de uma vez.</span><span class="sxs-lookup"><span data-stu-id="000c6-664">The TokenReplayCache property allows developers to define a token replay cache, a store that can be used for saving tokens for the purpose of verifying that no token can be used more than once.</span></span></p><p><span data-ttu-id="000c6-665">Essa é uma medida contra um ataque comum, o ataque de reprodução de token, cujo nome é bastante apropriado: um invasor que intercepta o token enviado na entrada pode tentar enviá-la novamente ao aplicativo ("repeti-lo") para estabelecer uma nova sessão.</span><span class="sxs-lookup"><span data-stu-id="000c6-665">This is a measure against a common attack, the aptly called token replay attack: an attacker intercepting the token sent at sign-in might try to send it to the app again (“replay” it) for establishing a new session.</span></span> <span data-ttu-id="000c6-666">Por exemplo, no fluxo de concessão de código do OIDC, após a autenticação bem-sucedida do usuário, uma solicitação para "/signin-oidc" do ponto de extremidade da terceira parte confiável é feita com os parâmetros "id_token", "code" e "state".</span><span class="sxs-lookup"><span data-stu-id="000c6-666">E.g., In OIDC code-grant flow, after successful user authentication, a request to "/signin-oidc" endpoint of the relying party is made with "id_token", "code" and "state" parameters.</span></span></p><p><span data-ttu-id="000c6-667">A terceira parte confiável valida a solicitação e estabelece uma nova sessão.</span><span class="sxs-lookup"><span data-stu-id="000c6-667">The relying party validates this request and establishes a new session.</span></span> <span data-ttu-id="000c6-668">Se um adversário capturar essa solicitação e a repetir, poderá estabelecer uma sessão bem-sucedida e falsificar o usuário.</span><span class="sxs-lookup"><span data-stu-id="000c6-668">If an adversary captures this request and replays it, he/she can establish a successful session and spoof the user.</span></span> <span data-ttu-id="000c6-669">A presença de nonce em OpenID Connect pode limitar, mas não elimina totalmente as circunstâncias em que o ataque pode ser realizado com êxito.</span><span class="sxs-lookup"><span data-stu-id="000c6-669">The presence of the nonce in OpenID Connect can limit but not fully eliminate the circumstances in which the attack can be successfully enacted.</span></span> <span data-ttu-id="000c6-670">Para proteger os aplicativos, os desenvolvedores podem fornecer uma implementação de ITokenReplayCache e atribuir uma instância de TokenReplayCache.</span><span class="sxs-lookup"><span data-stu-id="000c6-670">To protect their applications, developers can provide an implementation of ITokenReplayCache and assign an instance to TokenReplayCache.</span></span></p>|

### <a name="example"></a><span data-ttu-id="000c6-671">Exemplo</span><span class="sxs-lookup"><span data-stu-id="000c6-671">Example</span></span>
```C#
// ITokenReplayCache defined in ADAL
public interface ITokenReplayCache
{
bool TryAdd(string securityToken, DateTime expiresOn);
bool TryFind(string securityToken);
}
```

### <a name="example"></a><span data-ttu-id="000c6-672">Exemplo</span><span class="sxs-lookup"><span data-stu-id="000c6-672">Example</span></span>
<span data-ttu-id="000c6-673">Aqui está uma implementação de exemplo da interface ITokenReplayCache.</span><span class="sxs-lookup"><span data-stu-id="000c6-673">Here is a sample implementation of the ITokenReplayCache interface.</span></span> <span data-ttu-id="000c6-674">(Personalize e implemente sua estrutura de cache específica do projeto)</span><span class="sxs-lookup"><span data-stu-id="000c6-674">(Please customize and implement your project-specific caching framework)</span></span>
```C#
public class TokenReplayCache : ITokenReplayCache
{
    private readonly ICacheProvider cache; // Your project-specific cache provider
    public TokenReplayCache(ICacheProvider cache)
    {
        this.cache = cache;
    }
    public bool TryAdd(string securityToken, DateTime expiresOn)
    {
        if (this.cache.Get<string>(securityToken) == null)
        {
            this.cache.Set(securityToken, securityToken);
            return true;
        }
        return false;
    }
    public bool TryFind(string securityToken)
    {
        return this.cache.Get<string>(securityToken) != null;
    }
}
```
<span data-ttu-id="000c6-675">O cache implementado precisa ser referenciado em opções de OIDC por meio da propriedade "TokenValidationParameters" da maneira a seguir.</span><span class="sxs-lookup"><span data-stu-id="000c6-675">The implemented cache has to be referenced in OIDC options via the "TokenValidationParameters" property as follows.</span></span>
```C#
OpenIdConnectOptions openIdConnectOptions = new OpenIdConnectOptions
{
    AutomaticAuthenticate = true,
    ... // other configuration properties follow..
    TokenValidationParameters = new TokenValidationParameters
    {
        TokenReplayCache = new TokenReplayCache(/*Inject your cache provider*/);
    }
}
```

<span data-ttu-id="000c6-676">Observe que, para testar a eficácia dessa configuração, faça logon no aplicativo local protegido por OIDC e capture a solicitação para o ponto de extremidade `"/signin-oidc"` no fiddler.</span><span class="sxs-lookup"><span data-stu-id="000c6-676">Please note that to test the effectiveness of this configuration, login into your local OIDC-protected application and capture the request to `"/signin-oidc"` endpoint in fiddler.</span></span> <span data-ttu-id="000c6-677">Quando a proteção não estiver em vigor, repetir essa solicitação no fiddler definirá um novo cookie de sessão.</span><span class="sxs-lookup"><span data-stu-id="000c6-677">When the protection is not in place, replaying this request in fiddler will set a new session cookie.</span></span> <span data-ttu-id="000c6-678">Quando a solicitação for repetida depois que a proteção de TokenReplayCache for adicionada, o aplicativo gerará uma exceção da seguinte maneira:`SecurityTokenReplayDetectedException: IDX10228: The securityToken has previously been validated, securityToken: 'eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik1uQ19WWmNBVGZNNXBPWWlKSE1iYTlnb0VLWSIsImtpZCI6Ik1uQ1......`</span><span class="sxs-lookup"><span data-stu-id="000c6-678">When the request is replayed after the TokenReplayCache protection is added, the application will throw an exception as follows: `SecurityTokenReplayDetectedException: IDX10228: The securityToken has previously been validated, securityToken: 'eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik1uQ19WWmNBVGZNNXBPWWlKSE1iYTlnb0VLWSIsImtpZCI6Ik1uQ1......`</span></span>

## <span data-ttu-id="000c6-679"><a id="adal-oauth2"></a>Use bibliotecas ADAL para gerenciar solicitações de token de clientes OAuth2 ao AAD (ou AD local)</span><span class="sxs-lookup"><span data-stu-id="000c6-679"><a id="adal-oauth2"></a>Use ADAL libraries to manage token requests from OAuth2 clients to AAD (or on-premises AD)</span></span>

| <span data-ttu-id="000c6-680">Title</span><span class="sxs-lookup"><span data-stu-id="000c6-680">Title</span></span>                   | <span data-ttu-id="000c6-681">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-681">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="000c6-682">**Componente**</span><span class="sxs-lookup"><span data-stu-id="000c6-682">**Component**</span></span>               | <span data-ttu-id="000c6-683">AD do Azure</span><span class="sxs-lookup"><span data-stu-id="000c6-683">Azure AD</span></span> | 
| <span data-ttu-id="000c6-684">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="000c6-684">**SDL Phase**</span></span>               | <span data-ttu-id="000c6-685">Compilação</span><span class="sxs-lookup"><span data-stu-id="000c6-685">Build</span></span> |  
| <span data-ttu-id="000c6-686">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="000c6-686">**Applicable Technologies**</span></span> | <span data-ttu-id="000c6-687">Genérico</span><span class="sxs-lookup"><span data-stu-id="000c6-687">Generic</span></span> |
| <span data-ttu-id="000c6-688">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="000c6-688">**Attributes**</span></span>              | <span data-ttu-id="000c6-689">N/D</span><span class="sxs-lookup"><span data-stu-id="000c6-689">N/A</span></span>  |
| <span data-ttu-id="000c6-690">**Referências**</span><span class="sxs-lookup"><span data-stu-id="000c6-690">**References**</span></span>              | [<span data-ttu-id="000c6-691">ADAL</span><span class="sxs-lookup"><span data-stu-id="000c6-691">ADAL</span></span>](https://azure.microsoft.com/documentation/articles/active-directory-authentication-libraries/) |
| <span data-ttu-id="000c6-692">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="000c6-692">**Steps**</span></span> | <p><span data-ttu-id="000c6-693">A Biblioteca de autenticação do AD do Azure (ADAL) permite que os desenvolvedores de aplicativo cliente autentiquem facilmente os usuários no Active Directory (AD) local ou em nuvem e daí obtenham tokens de acesso para proteger chamadas de API.</span><span class="sxs-lookup"><span data-stu-id="000c6-693">The Azure AD authentication Library (ADAL) enables client application developers to easily authenticate users to cloud or on-premises Active Directory (AD), and then obtain access tokens for securing API calls.</span></span></p><p><span data-ttu-id="000c6-694">A ADAL tem muitos recursos que tornam a autenticação mais fácil para os desenvolvedores, como o suporte assíncrono, um cache de token configurável que armazena os tokens de acesso e de atualização, atualização automática de token quando um token de acesso expira e um token de atualização está disponível, e muito mais.</span><span class="sxs-lookup"><span data-stu-id="000c6-694">ADAL has many features that make authentication easier for developers, such as asynchronous support, a configurable token cache that stores access tokens and refresh tokens, automatic token refresh when an access token expires and a refresh token is available, and more.</span></span></p><p><span data-ttu-id="000c6-695">Controlando a maior parte da complexidade, a ADAL pode ajudar o desenvolvedor a se concentrar na lógica de negócios em seus aplicativos e a proteger facilmente os recursos sem ser um especialista em segurança.</span><span class="sxs-lookup"><span data-stu-id="000c6-695">By handling most of the complexity, ADAL can help a developer focus on business logic in their application and easily secure resources without being an expert on security.</span></span> <span data-ttu-id="000c6-696">Bibliotecas separadas estão disponíveis para .NET, JavaScript (cliente e Node.js), iOS, Android e Java.</span><span class="sxs-lookup"><span data-stu-id="000c6-696">Separate libraries are available for .NET, JavaScript (client and Node.js), iOS, Android and Java.</span></span></p>|

## <span data-ttu-id="000c6-697"><a id="authn-devices-field"></a>Autentique dispositivos que se conectam ao Gateway de Campo</span><span class="sxs-lookup"><span data-stu-id="000c6-697"><a id="authn-devices-field"></a>Authenticate devices connecting to the Field Gateway</span></span>

| <span data-ttu-id="000c6-698">Title</span><span class="sxs-lookup"><span data-stu-id="000c6-698">Title</span></span>                   | <span data-ttu-id="000c6-699">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-699">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="000c6-700">**Componente**</span><span class="sxs-lookup"><span data-stu-id="000c6-700">**Component**</span></span>               | <span data-ttu-id="000c6-701">Gateway de Campo de IoT</span><span class="sxs-lookup"><span data-stu-id="000c6-701">IoT Field Gateway</span></span> | 
| <span data-ttu-id="000c6-702">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="000c6-702">**SDL Phase**</span></span>               | <span data-ttu-id="000c6-703">Compilação</span><span class="sxs-lookup"><span data-stu-id="000c6-703">Build</span></span> |  
| <span data-ttu-id="000c6-704">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="000c6-704">**Applicable Technologies**</span></span> | <span data-ttu-id="000c6-705">Genérico</span><span class="sxs-lookup"><span data-stu-id="000c6-705">Generic</span></span> |
| <span data-ttu-id="000c6-706">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="000c6-706">**Attributes**</span></span>              | <span data-ttu-id="000c6-707">N/D</span><span class="sxs-lookup"><span data-stu-id="000c6-707">N/A</span></span>  |
| <span data-ttu-id="000c6-708">**Referências**</span><span class="sxs-lookup"><span data-stu-id="000c6-708">**References**</span></span>              | <span data-ttu-id="000c6-709">N/D</span><span class="sxs-lookup"><span data-stu-id="000c6-709">N/A</span></span>  |
| <span data-ttu-id="000c6-710">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="000c6-710">**Steps**</span></span> | <span data-ttu-id="000c6-711">Verifique se cada dispositivo é autenticado pelo Gateway de Campo antes de aceitar dados deles e antes de facilitar as comunicações upstream com o Gateway de Nuvem.</span><span class="sxs-lookup"><span data-stu-id="000c6-711">Ensure that each device is authenticated by the Field Gateway before accepting data from them and before facilitating upstream communications with the Cloud Gateway.</span></span> <span data-ttu-id="000c6-712">Além disso, verifique se os dispositivos se conectam com uma credencial por dispositivo, para que dispositivos individuais possam ser identificados exclusivamente.</span><span class="sxs-lookup"><span data-stu-id="000c6-712">Also, ensure that devices connect with a per device credential so that individual devices can be uniquely identified.</span></span>|

## <span data-ttu-id="000c6-713"><a id="authn-devices-cloud"></a>Verifique se os dispositivos conectados ao gateway de Nuvem são autenticados</span><span class="sxs-lookup"><span data-stu-id="000c6-713"><a id="authn-devices-cloud"></a>Ensure that devices connecting to Cloud gateway are authenticated</span></span>

| <span data-ttu-id="000c6-714">Title</span><span class="sxs-lookup"><span data-stu-id="000c6-714">Title</span></span>                   | <span data-ttu-id="000c6-715">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-715">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="000c6-716">**Componente**</span><span class="sxs-lookup"><span data-stu-id="000c6-716">**Component**</span></span>               | <span data-ttu-id="000c6-717">Gateway de Nuvem IoT</span><span class="sxs-lookup"><span data-stu-id="000c6-717">IoT Cloud Gateway</span></span> | 
| <span data-ttu-id="000c6-718">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="000c6-718">**SDL Phase**</span></span>               | <span data-ttu-id="000c6-719">Compilação</span><span class="sxs-lookup"><span data-stu-id="000c6-719">Build</span></span> |  
| <span data-ttu-id="000c6-720">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="000c6-720">**Applicable Technologies**</span></span> | <span data-ttu-id="000c6-721">Genérico, C#, Node.JS,</span><span class="sxs-lookup"><span data-stu-id="000c6-721">Generic, C#, Node.JS,</span></span>  |
| <span data-ttu-id="000c6-722">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="000c6-722">**Attributes**</span></span>              | <span data-ttu-id="000c6-723">N/A, Opção de gateway - Hub IoT do Azure</span><span class="sxs-lookup"><span data-stu-id="000c6-723">N/A, Gateway choice - Azure IoT Hub</span></span> |
| <span data-ttu-id="000c6-724">**Referências**</span><span class="sxs-lookup"><span data-stu-id="000c6-724">**References**</span></span>              | <span data-ttu-id="000c6-725">N/A, [Hub IoT do Azure com .NET](https://azure.microsoft.com/documentation/articles/iot-hub-csharp-csharp-getstarted/), [Introdução ao hub IoT e Nó JS](https://azure.microsoft.com/documentation/articles/iot-hub-node-node-getstarted), [Protegendo a IoT com SAS e certificados](https://azure.microsoft.com/documentation/articles/iot-hub-sas-tokens/), [Repositório Git](https://github.com/Azure/azure-iot-sdks/tree/master/node)</span><span class="sxs-lookup"><span data-stu-id="000c6-725">N/A, [Azure IoT hub with .NET](https://azure.microsoft.com/documentation/articles/iot-hub-csharp-csharp-getstarted/), [Getting Started wih IoT hub and Node JS](https://azure.microsoft.com/documentation/articles/iot-hub-node-node-getstarted), [Securing IoT with SAS and certificates](https://azure.microsoft.com/documentation/articles/iot-hub-sas-tokens/), [Git repository](https://github.com/Azure/azure-iot-sdks/tree/master/node)</span></span> |
| <span data-ttu-id="000c6-726">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="000c6-726">**Steps**</span></span> | <ul><li><span data-ttu-id="000c6-727">**Genérico:** autentique o dispositivo usando o protocolo TLS ou IPSec.</span><span class="sxs-lookup"><span data-stu-id="000c6-727">**Generic:** Authenticate the device using Transport Layer Security (TLS) or IPSec.</span></span> <span data-ttu-id="000c6-728">A infraestrutura deve dar suporte ao uso da PSK (chave pré-compartilhada) nos dispositivos que não conseguem lidar com a criptografia assimétrica completa.</span><span class="sxs-lookup"><span data-stu-id="000c6-728">Infrastructure should support using pre-shared key (PSK) on those devices that cannot handle full asymmetric cryptography.</span></span> <span data-ttu-id="000c6-729">Aproveite o Azure AD e o OAuth.</span><span class="sxs-lookup"><span data-stu-id="000c6-729">Leverage Azure AD, Oauth.</span></span></li><li><span data-ttu-id="000c6-730">**C#:** ao criar uma instância de DeviceClient, por padrão, o método Create cria uma instância de DeviceClient que usa o protocolo AMQP para se comunicar com o Hub IoT.</span><span class="sxs-lookup"><span data-stu-id="000c6-730">**C#:** When creating a DeviceClient instance, by default, the Create method creates a DeviceClient instance that uses the AMQP protocol to communicate with IoT Hub.</span></span> <span data-ttu-id="000c6-731">Para usar o protocolo HTTPS, use a substituição do método Create que permite especificar o protocolo.</span><span class="sxs-lookup"><span data-stu-id="000c6-731">To use the HTTPS protocol, use the override of the Create method that enables you to specify the protocol.</span></span> <span data-ttu-id="000c6-732">Se usar o protocolo HTTPS, você também deverá adicionar o pacote do NuGet `Microsoft.AspNet.WebApi.Client` ao projeto para incluir o namespace `System.Net.Http.Formatting`.</span><span class="sxs-lookup"><span data-stu-id="000c6-732">If you use the HTTPS protocol, you should also add the `Microsoft.AspNet.WebApi.Client` NuGet package to your project to include the `System.Net.Http.Formatting` namespace.</span></span></li></ul>|

### <a name="example"></a><span data-ttu-id="000c6-733">Exemplo</span><span class="sxs-lookup"><span data-stu-id="000c6-733">Example</span></span>
```C#
static DeviceClient deviceClient;

static string deviceKey = "{device key}";
static string iotHubUri = "{iot hub hostname}";

var messageString = "{message in string format}";
var message = new Message(Encoding.ASCII.GetBytes(messageString));

deviceClient = DeviceClient.Create(iotHubUri, new DeviceAuthenticationWithRegistrySymmetricKey("myFirstDevice", deviceKey));

await deviceClient.SendEventAsync(message);
```

### <a name="example"></a><span data-ttu-id="000c6-734">Exemplo</span><span class="sxs-lookup"><span data-stu-id="000c6-734">Example</span></span>
<span data-ttu-id="000c6-735">**Node.JS: Autenticação**</span><span class="sxs-lookup"><span data-stu-id="000c6-735">**Node.JS: Authentication**</span></span>
#### <a name="symmetric-key"></a><span data-ttu-id="000c6-736">Chave simétrica</span><span class="sxs-lookup"><span data-stu-id="000c6-736">Symmetric key</span></span>
* <span data-ttu-id="000c6-737">Criar um hub IoT no azure</span><span class="sxs-lookup"><span data-stu-id="000c6-737">Create a IoT hub on azure</span></span>
* <span data-ttu-id="000c6-738">Criar uma entrada no registro de identidade de dispositivo</span><span class="sxs-lookup"><span data-stu-id="000c6-738">Create an entry in the device identity registry</span></span>
    ```javascript
    var device = new iothub.Device(null);
    device.deviceId = <DeviceId >
    registry.create(device, function(err, deviceInfo, res) {})
    ```
* <span data-ttu-id="000c6-739">Criar um dispositivo simulado</span><span class="sxs-lookup"><span data-stu-id="000c6-739">Create a simulated device</span></span>
    ```javascript
    var clientFromConnectionString = require('azure-iot-device-amqp').clientFromConnectionString;
    var Message = require('azure-iot-device').Message;
    var connectionString = 'HostName=<HostName>DeviceId=<DeviceId>SharedAccessKey=<SharedAccessKey>';
    var client = clientFromConnectionString(connectionString);
    ```
#### <a name="sas-token"></a><span data-ttu-id="000c6-740">Token SAS</span><span class="sxs-lookup"><span data-stu-id="000c6-740">SAS Token</span></span>
* <span data-ttu-id="000c6-741">É gerado internamente ao usar a chave simétrica, mas também pode gerá-la e usá-la explicitamente</span><span class="sxs-lookup"><span data-stu-id="000c6-741">Gets internally generated when using symmetric key but we can generate and use it explicitly as well</span></span>
* <span data-ttu-id="000c6-742">Defina um protocolo: `var Http = require('azure-iot-device-http').Http;`</span><span class="sxs-lookup"><span data-stu-id="000c6-742">Define a protocol : `var Http = require('azure-iot-device-http').Http;`</span></span>
* <span data-ttu-id="000c6-743">Crie um token sas:</span><span class="sxs-lookup"><span data-stu-id="000c6-743">Create a sas token :</span></span>
    ```javascript
    resourceUri = encodeURIComponent(resourceUri.toLowerCase()).toLowerCase();
    var deviceName = "<deviceName >";
    var expires = (Date.now() / 1000) + expiresInMins * 60;
    var toSign = resourceUri + '\n' + expires;
    // using crypto
    var decodedPassword = new Buffer(signingKey, 'base64').toString('binary');
    const hmac = crypto.createHmac('sha256', decodedPassword);
    hmac.update(toSign);
    var base64signature = hmac.digest('base64');
    var base64UriEncoded = encodeURIComponent(base64signature);
    // construct authorization string
    var token = "SharedAccessSignature sr=" + resourceUri + "%2fdevices%2f"+deviceName+"&sig="
    + base64UriEncoded + "&se=" + expires;
    if (policyName) token += "&skn="+policyName;
    return token;
    ```
* <span data-ttu-id="000c6-744">Conecte-se usando um token sas:</span><span class="sxs-lookup"><span data-stu-id="000c6-744">Connect using sas token:</span></span> 
    ```javascript
    Client.fromSharedAccessSignature(sas, Http); 
    ```
#### <a name="certificates"></a><span data-ttu-id="000c6-745">Certificados</span><span class="sxs-lookup"><span data-stu-id="000c6-745">Certificates</span></span>
* <span data-ttu-id="000c6-746">Gerar um certificado X509 autoassinado usando qualquer ferramenta, como OpenSSL, para gerar arquivos .cert e .key para armazenar o certificado e a chave, respectivamente</span><span class="sxs-lookup"><span data-stu-id="000c6-746">Generate a self signed X509 certificate using any tool such as OpenSSL to generate a .cert and .key files to store the certificate and the key respectively</span></span>
* <span data-ttu-id="000c6-747">Provisione um dispositivo que aceite a conexão segura usando certificados.</span><span class="sxs-lookup"><span data-stu-id="000c6-747">Provision a device that accepts secured connection using certificates.</span></span>
    ```javascript
    var connectionString = '<connectionString>';
    var registry = iothub.Registry.fromConnectionString(connectionString);
    var deviceJSON = {deviceId:"<deviceId>",
    authentication: {
        x509Thumbprint: {
        primaryThumbprint: "<PrimaryThumbprint>",
        secondaryThumbprint: "<SecondaryThumbprint>"
        }
    }}
    var device = deviceJSON;
    registry.create(device, function (err) {});
    ```
* <span data-ttu-id="000c6-748">Conectar um dispositivo usando um certificado</span><span class="sxs-lookup"><span data-stu-id="000c6-748">Connect a device using a certificate</span></span>
    ```javascript
    var Protocol = require('azure-iot-device-http').Http;
    var Client = require('azure-iot-device').Client;
    var connectionString = 'HostName=<HostName>DeviceId=<DeviceId>x509=true';
    var client = Client.fromConnectionString(connectionString, Protocol);
    var options = {
        key: fs.readFileSync('./key.pem', 'utf8'),
        cert: fs.readFileSync('./server.crt', 'utf8')
    }; 
    // Calling setOptions with the x509 certificate and key (and optionally, passphrase) will configure the client //transport to use x509 when connecting to IoT Hub
    client.setOptions(options);
    //call fn to execute after the connection is set up
    client.open(fn);
    ```

## <span data-ttu-id="000c6-749"><a id="authn-cred"></a>Usar credenciais de autenticação por dispositivo</span><span class="sxs-lookup"><span data-stu-id="000c6-749"><a id="authn-cred"></a>Use per-device authentication credentials</span></span>

| <span data-ttu-id="000c6-750">Title</span><span class="sxs-lookup"><span data-stu-id="000c6-750">Title</span></span>                   | <span data-ttu-id="000c6-751">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-751">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="000c6-752">**Componente**</span><span class="sxs-lookup"><span data-stu-id="000c6-752">**Component**</span></span>               | <span data-ttu-id="000c6-753">Gateway de Nuvem IoT</span><span class="sxs-lookup"><span data-stu-id="000c6-753">IoT Cloud Gateway</span></span>  | 
| <span data-ttu-id="000c6-754">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="000c6-754">**SDL Phase**</span></span>               | <span data-ttu-id="000c6-755">Compilação</span><span class="sxs-lookup"><span data-stu-id="000c6-755">Build</span></span> |  
| <span data-ttu-id="000c6-756">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="000c6-756">**Applicable Technologies**</span></span> | <span data-ttu-id="000c6-757">Genérico</span><span class="sxs-lookup"><span data-stu-id="000c6-757">Generic</span></span> |
| <span data-ttu-id="000c6-758">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="000c6-758">**Attributes**</span></span>              | <span data-ttu-id="000c6-759">Opção de gateway - Hub IoT do Azure</span><span class="sxs-lookup"><span data-stu-id="000c6-759">Gateway choice - Azure IoT Hub</span></span> |
| <span data-ttu-id="000c6-760">**Referências**</span><span class="sxs-lookup"><span data-stu-id="000c6-760">**References**</span></span>              | [<span data-ttu-id="000c6-761">Tokens de segurança do Hub IoT do Azure</span><span class="sxs-lookup"><span data-stu-id="000c6-761">Azure IoT Hub Security Tokens</span></span>](https://azure.microsoft.com/documentation/articles/iot-hub-sas-tokens/) |
| <span data-ttu-id="000c6-762">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="000c6-762">**Steps**</span></span> | <span data-ttu-id="000c6-763">Use credenciais de autenticação por dispositivo usando tokens SaS com base na chave do dispositivo ou no certificado de cliente, em vez de políticas de acesso compartilhado de nível de Hub IoT.</span><span class="sxs-lookup"><span data-stu-id="000c6-763">Use per device authentication credentials using SaS tokens based on Device key or Client Certificate, instead of IoT Hub-level shared access policies.</span></span> <span data-ttu-id="000c6-764">Isso impede a reutilização de tokens de autenticação de um gateway de campo ou dispositivo por outro</span><span class="sxs-lookup"><span data-stu-id="000c6-764">This prevents the reuse of authentication tokens of one device or field gateway by another</span></span> |

## <span data-ttu-id="000c6-765"><a id="req-containers-anon"></a>Verifique se apenas os contêineres necessários e os blobs recebem acesso de leitura anônimo</span><span class="sxs-lookup"><span data-stu-id="000c6-765"><a id="req-containers-anon"></a>Ensure that only the required containers and blobs are given anonymous read access</span></span>

| <span data-ttu-id="000c6-766">Title</span><span class="sxs-lookup"><span data-stu-id="000c6-766">Title</span></span>                   | <span data-ttu-id="000c6-767">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-767">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="000c6-768">**Componente**</span><span class="sxs-lookup"><span data-stu-id="000c6-768">**Component**</span></span>               | <span data-ttu-id="000c6-769">Armazenamento do Azure</span><span class="sxs-lookup"><span data-stu-id="000c6-769">Azure Storage</span></span> | 
| <span data-ttu-id="000c6-770">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="000c6-770">**SDL Phase**</span></span>               | <span data-ttu-id="000c6-771">Compilação</span><span class="sxs-lookup"><span data-stu-id="000c6-771">Build</span></span> |  
| <span data-ttu-id="000c6-772">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="000c6-772">**Applicable Technologies**</span></span> | <span data-ttu-id="000c6-773">Genérico</span><span class="sxs-lookup"><span data-stu-id="000c6-773">Generic</span></span> |
| <span data-ttu-id="000c6-774">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="000c6-774">**Attributes**</span></span>              | <span data-ttu-id="000c6-775">StorageType - Blob</span><span class="sxs-lookup"><span data-stu-id="000c6-775">StorageType - Blob</span></span> |
| <span data-ttu-id="000c6-776">**Referências**</span><span class="sxs-lookup"><span data-stu-id="000c6-776">**References**</span></span>              | <span data-ttu-id="000c6-777">[Gerenciar acesso anônimo de leitura para contêineres e blobs](https://azure.microsoft.com/documentation/articles/storage-manage-access-to-resources/), [Assinaturas de acesso compartilhado, parte 1: noções básicas sobre o modelo SAS](https://azure.microsoft.com/documentation/articles/storage-dotnet-shared-access-signature-part-1/)</span><span class="sxs-lookup"><span data-stu-id="000c6-777">[Manage anonymous read access to containers and blobs](https://azure.microsoft.com/documentation/articles/storage-manage-access-to-resources/), [Shared Access Signatures, Part 1: Understanding the SAS model](https://azure.microsoft.com/documentation/articles/storage-dotnet-shared-access-signature-part-1/)</span></span> |
| <span data-ttu-id="000c6-778">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="000c6-778">**Steps**</span></span> | <p><span data-ttu-id="000c6-779">Por padrão, um contêiner e todos os blobs dentro dele podem ser acessados somente pelo proprietário da conta de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="000c6-779">By default, a container and any blobs within it may be accessed only by the owner of the storage account.</span></span> <span data-ttu-id="000c6-780">Para dar aos usuários anônimos permissões de leitura a um contêiner e seus blobs, é possível definir as permissões de contêiner para permitir acesso público.</span><span class="sxs-lookup"><span data-stu-id="000c6-780">To give anonymous users read permissions to a container and its blobs, one can set the container permissions to allow public access.</span></span> <span data-ttu-id="000c6-781">Usuários anônimos podem ler blobs dentro de um contêiner publicamente acessível sem autenticar a solicitação.</span><span class="sxs-lookup"><span data-stu-id="000c6-781">Anonymous users can read blobs within a publicly accessible container without authenticating the request.</span></span></p><p><span data-ttu-id="000c6-782">Os contêineres fornecem as seguintes opções para gerenciar o acesso do contêiner:</span><span class="sxs-lookup"><span data-stu-id="000c6-782">Containers provide the following options for managing container access:</span></span></p><ul><li><span data-ttu-id="000c6-783">Acesso completo de leitura pública: os dados de contêiner e blob podem ser lidos por solicitação anônima.</span><span class="sxs-lookup"><span data-stu-id="000c6-783">Full public read access: Container and blob data can be read via anonymous request.</span></span> <span data-ttu-id="000c6-784">Os clientes podem enumerar os blobs no contêiner por meio de uma solicitação anônima, mas não podem enumerar os contêineres em uma conta de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="000c6-784">Clients can enumerate blobs within the container via anonymous request, but cannot enumerate containers within the storage account.</span></span></li><li><span data-ttu-id="000c6-785">Acesso de leitura pública somente para blobs: os dados blob nesse contêiner podem ser lidos por solicitação anônima, mas os dados do contêiner não estão disponíveis.</span><span class="sxs-lookup"><span data-stu-id="000c6-785">Public read access for blobs only: Blob data within this container can be read via anonymous request, but container data is not available.</span></span> <span data-ttu-id="000c6-786">Os clientes não podem enumerar os blobs no contêiner por meio de uma solicitação anônima</span><span class="sxs-lookup"><span data-stu-id="000c6-786">Clients cannot enumerate blobs within the container via anonymous request</span></span></li><li><span data-ttu-id="000c6-787">Sem acesso de leitura público: os dados de contêiner e de blob podem ser lidos por apenas o proprietário da conta</span><span class="sxs-lookup"><span data-stu-id="000c6-787">No public read access: Container and blob data can be read by the account owner only</span></span></li></ul><p><span data-ttu-id="000c6-788">O acesso anônimo é ideal para cenários em que determinados blobs sempre devem estar disponíveis para acesso de leitura anônimo.</span><span class="sxs-lookup"><span data-stu-id="000c6-788">Anonymous access is best for scenarios where certain blobs should always be available for anonymous read access.</span></span> <span data-ttu-id="000c6-789">Para um controle mais refinado, é possível criar uma assinatura de acesso compartilhado, que permite delegar o acesso restrito usando diferentes permissões e em um intervalo de tempo especificado.</span><span class="sxs-lookup"><span data-stu-id="000c6-789">For finer-grained control, one can create a shared access signature, which enables to delegate restricted access using different permissions and over a specified time interval.</span></span> <span data-ttu-id="000c6-790">Verifique se contêineres e blobs, que podem conter dados confidenciais, não recebem acesso anônimo acidentalmente</span><span class="sxs-lookup"><span data-stu-id="000c6-790">Ensure that containers and blobs, which may potentially contain sensitive data, are not given anonymous access accidentally</span></span></p>|

## <span data-ttu-id="000c6-791"><a id="limited-access-sas"></a>Conceda acesso limitado a objetos no armazenamento do Azure usando SAS ou SAP</span><span class="sxs-lookup"><span data-stu-id="000c6-791"><a id="limited-access-sas"></a>Grant limited access to objects in Azure storage using SAS or SAP</span></span>

| <span data-ttu-id="000c6-792">Title</span><span class="sxs-lookup"><span data-stu-id="000c6-792">Title</span></span>                   | <span data-ttu-id="000c6-793">Detalhes</span><span class="sxs-lookup"><span data-stu-id="000c6-793">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="000c6-794">**Componente**</span><span class="sxs-lookup"><span data-stu-id="000c6-794">**Component**</span></span>               | <span data-ttu-id="000c6-795">Armazenamento do Azure</span><span class="sxs-lookup"><span data-stu-id="000c6-795">Azure Storage</span></span> | 
| <span data-ttu-id="000c6-796">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="000c6-796">**SDL Phase**</span></span>               | <span data-ttu-id="000c6-797">Compilação</span><span class="sxs-lookup"><span data-stu-id="000c6-797">Build</span></span> |  
| <span data-ttu-id="000c6-798">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="000c6-798">**Applicable Technologies**</span></span> | <span data-ttu-id="000c6-799">Genérico</span><span class="sxs-lookup"><span data-stu-id="000c6-799">Generic</span></span> |
| <span data-ttu-id="000c6-800">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="000c6-800">**Attributes**</span></span>              | <span data-ttu-id="000c6-801">N/D</span><span class="sxs-lookup"><span data-stu-id="000c6-801">N/A</span></span> |
| <span data-ttu-id="000c6-802">**Referências**</span><span class="sxs-lookup"><span data-stu-id="000c6-802">**References**</span></span>              | <span data-ttu-id="000c6-803">[Assinaturas de acesso compartilhado, parte 1: noções básicas sobre o modelo SAS](https://azure.microsoft.com/documentation/articles/storage-dotnet-shared-access-signature-part-1/), [Assinaturas de acesso compartilhado, parte 2: criar e usar SAS com o armazenamento de Blobs](https://azure.microsoft.com/documentation/articles/storage-dotnet-shared-access-signature-part-2/), [Como delegar acesso a objetos em sua conta usando assinaturas de acesso compartilhado e políticas de acesso armazenado](https://azure.microsoft.com/documentation/articles/storage-security-guide/#_how-to-delegate-access-to-objects-in-your-account-using-shared-access-signatures-and-stored-access-policies)</span><span class="sxs-lookup"><span data-stu-id="000c6-803">[Shared Access Signatures, Part 1: Understanding the SAS model](https://azure.microsoft.com/documentation/articles/storage-dotnet-shared-access-signature-part-1/), [Shared Access Signatures, Part 2: Create and use a SAS with Blob storage](https://azure.microsoft.com/documentation/articles/storage-dotnet-shared-access-signature-part-2/), [How to delegate access to objects in your account using Shared Access Signatures and Stored Access Policies](https://azure.microsoft.com/documentation/articles/storage-security-guide/#_how-to-delegate-access-to-objects-in-your-account-using-shared-access-signatures-and-stored-access-policies)</span></span> |
| <span data-ttu-id="000c6-804">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="000c6-804">**Steps**</span></span> | <p><span data-ttu-id="000c6-805">O uso de SAS (assinatura de acesso compartilhado) é uma maneira eficiente de conceder acesso limitado a objetos na conta de armazenamento a outros clientes, sem precisar expor a chave de acesso da conta.</span><span class="sxs-lookup"><span data-stu-id="000c6-805">Using a shared access signature (SAS) is a powerful way to grant limited access to objects in a storage account to other clients, without having to expose account access key.</span></span> <span data-ttu-id="000c6-806">A SAS é um URI que engloba em seus parâmetros de consulta todas as informações necessárias para o acesso autenticado a um recurso de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="000c6-806">The SAS is a URI that encompasses in its query parameters all of the information necessary for authenticated access to a storage resource.</span></span> <span data-ttu-id="000c6-807">Para acessar recursos de armazenamento com a SAS, o cliente só precisa passar a SAS ao construtor apropriado ou ao método apropriado.</span><span class="sxs-lookup"><span data-stu-id="000c6-807">To access storage resources with the SAS, the client only needs to pass in the SAS to the appropriate constructor or method.</span></span></p><p><span data-ttu-id="000c6-808">Você pode usar uma SAS quando desejar fornecer acesso aos recursos de sua conta de armazenamento a um cliente não confiável com a chave de conta.</span><span class="sxs-lookup"><span data-stu-id="000c6-808">You can use a SAS when you want to provide access to resources in your storage account to a client that can't be trusted with the account key.</span></span> <span data-ttu-id="000c6-809">As chaves de conta de armazenamento incluem uma chave primária e uma chave secundária, que concedem acesso administrativo à sua conta e a todos os recursos que ela contém.</span><span class="sxs-lookup"><span data-stu-id="000c6-809">Your storage account keys include both a primary and secondary key, both of which grant administrative access to your account and all of the resources in it.</span></span> <span data-ttu-id="000c6-810">A exposição de qualquer uma de suas chaves de conta torna sua conta vulnerável a um possível uso mal-intencionado ou negligente.</span><span class="sxs-lookup"><span data-stu-id="000c6-810">Exposing either of your account keys opens your account to the possibility of malicious or negligent use.</span></span> <span data-ttu-id="000c6-811">As assinaturas de acesso compartilhado são uma alternativa segura que permite que outros clientes leiam, gravem e excluam dados da sua conta de armazenamento de acordo com as permissões que você tiver concedido a eles e sem que eles precisem da chave de conta.</span><span class="sxs-lookup"><span data-stu-id="000c6-811">Shared access signatures provide a safe alternative that allows other clients to read, write, and delete data in your storage account according to the permissions you've granted, and without need for the account key.</span></span></p><p><span data-ttu-id="000c6-812">Se você tiver um conjunto lógico de parâmetros que são sempre semelhantes, o uso de SAP (política de acesso armazenada) será uma ideia melhor.</span><span class="sxs-lookup"><span data-stu-id="000c6-812">If you have a logical set of parameters that are similar each time, using a Stored Access Policy (SAP) is a better idea.</span></span> <span data-ttu-id="000c6-813">Como usar uma SAS derivada de uma Política de Acesso Armazenado dá a possibilidade de revogar essa SAS imediatamente, a prática recomendada é, sempre que possível, usar Políticas de Acesso Armazenado.</span><span class="sxs-lookup"><span data-stu-id="000c6-813">Because using a SAS derived from a Stored Access Policy gives you the ability to revoke that SAS immediately, it is the recommended best practice to always use Stored Access Policies when possible.</span></span></p>|