---
title: "aaaInput validação - ferramenta de modelagem de ameaça Microsoft - Azure | Microsoft Docs"
description: "reduções de ameaças expostas em Olá, ferramenta de modelagem de ameaça"
services: security
documentationcenter: na
author: RodSan
manager: RodSan
editor: RodSan
ms.assetid: na
ms.service: security
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/17/2017
ms.author: rodsan
ms.openlocfilehash: 823503881f4bae292ef021834d5e64acf2a0f54a
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="security-frame-input-validation--mitigations"></a><span data-ttu-id="c2ebc-103">Estrutura de segurança: validação de entrada | Atenuações</span><span class="sxs-lookup"><span data-stu-id="c2ebc-103">Security Frame: Input Validation | Mitigations</span></span> 
| <span data-ttu-id="c2ebc-104">Produto/Serviço</span><span class="sxs-lookup"><span data-stu-id="c2ebc-104">Product/Service</span></span> | <span data-ttu-id="c2ebc-105">Artigo</span><span class="sxs-lookup"><span data-stu-id="c2ebc-105">Article</span></span> |
| --------------- | ------- |
| <span data-ttu-id="c2ebc-106">**Aplicativo Web**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-106">**Web Application**</span></span> | <ul><li>[<span data-ttu-id="c2ebc-107">Desabilite o script XSLT para todas as transformações com uso de folhas de estilo não confiáveis</span><span class="sxs-lookup"><span data-stu-id="c2ebc-107">Disable XSLT scripting for all transforms using untrusted style sheets</span></span>](#disable-xslt)</li><li>[<span data-ttu-id="c2ebc-108">Verifique se cada página que pode ter conteúdo controlável pelo usuário recusa a detecção automática de MIME</span><span class="sxs-lookup"><span data-stu-id="c2ebc-108">Ensure that each page that could contain user controllable content opts out of automatic MIME sniffing</span></span>](#out-sniffing)</li><li>[<span data-ttu-id="c2ebc-109">Proteger ou desabilitar a resolução de entidade XML</span><span class="sxs-lookup"><span data-stu-id="c2ebc-109">Harden or Disable XML Entity Resolution</span></span>](#xml-resolution)</li><li>[<span data-ttu-id="c2ebc-110">Aplicativos que usam http.sys executam a verificação de conversão em formato canônico de URL</span><span class="sxs-lookup"><span data-stu-id="c2ebc-110">Applications utilizing http.sys perform URL canonicalization verification</span></span>](#app-verification)</li><li>[<span data-ttu-id="c2ebc-111">Verifique se os controles adequados estão em vigor ao aceitar arquivos de usuários</span><span class="sxs-lookup"><span data-stu-id="c2ebc-111">Ensure appropriate controls are in place when accepting files from users</span></span>](#controls-users)</li><li>[<span data-ttu-id="c2ebc-112">Verifique se os parâmetros de tipo seguro são usados no aplicativo Web para acesso a dados</span><span class="sxs-lookup"><span data-stu-id="c2ebc-112">Ensure that type-safe parameters are used in Web Application for data access</span></span>](#typesafe)</li><li>[<span data-ttu-id="c2ebc-113">Usar as classes de associação de modelo separado ou listas de filtro de associação de vulnerabilidade de atribuição em massa de MVC tooprevent</span><span class="sxs-lookup"><span data-stu-id="c2ebc-113">Use separate model binding classes or binding filter lists tooprevent MVC mass assignment vulnerability</span></span>](#binding-mvc)</li><li>[<span data-ttu-id="c2ebc-114">Codificar toorendering anterior de saída da web não confiável</span><span class="sxs-lookup"><span data-stu-id="c2ebc-114">Encode untrusted web output prior toorendering</span></span>](#rendering)</li><li>[<span data-ttu-id="c2ebc-115">Execute a validação de entrada e a filtragem em todos os tipos de cadeia de caracteres de propriedades do modelo</span><span class="sxs-lookup"><span data-stu-id="c2ebc-115">Perform input validation and filtering on all string type Model properties</span></span>](#typemodel)</li><li>[<span data-ttu-id="c2ebc-116">A limpeza deve ser aplicada em campos de formulário que aceitam todos os caracteres, como o editor de rich text</span><span class="sxs-lookup"><span data-stu-id="c2ebc-116">Sanitization should be applied on form fields that accept all characters, e.g, rich text editor</span></span>](#richtext)</li><li>[<span data-ttu-id="c2ebc-117">Não atribua toosinks de elementos DOM que não têm embutidas de codificação</span><span class="sxs-lookup"><span data-stu-id="c2ebc-117">Do not assign DOM elements toosinks that do not have inbuilt encoding</span></span>](#inbuilt-encode)</li><li>[<span data-ttu-id="c2ebc-118">Validar todos os redirecionamentos de dentro do aplicativo hello serão fechados ou feitos com segurança</span><span class="sxs-lookup"><span data-stu-id="c2ebc-118">Validate all redirects within hello application are closed or done safely</span></span>](#redirect-safe)</li><li>[<span data-ttu-id="c2ebc-119">Implemente a validação de entrada em todos os parâmetros de tipo de cadeia de caracteres aceitos por métodos do Controlador</span><span class="sxs-lookup"><span data-stu-id="c2ebc-119">Implement input validation on all string type parameters accepted by Controller methods</span></span>](#string-method)</li><li>[<span data-ttu-id="c2ebc-120">Definir tempo limite de limite superior de expressão regular de processamento DoS tooprevent devido a expressões regulares toobad</span><span class="sxs-lookup"><span data-stu-id="c2ebc-120">Set upper limit timeout for regular expression processing tooprevent DoS due toobad regular expressions</span></span>](#dos-expression)</li><li>[<span data-ttu-id="c2ebc-121">Evite usar Html.Raw nos modos de exibição do Razor</span><span class="sxs-lookup"><span data-stu-id="c2ebc-121">Avoid using Html.Raw in Razor views</span></span>](#html-razor)</li></ul> | 
| <span data-ttu-id="c2ebc-122">**Banco de dados**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-122">**Database**</span></span> | <ul><li>[<span data-ttu-id="c2ebc-123">Não use consultas dinâmicas em procedimentos armazenados</span><span class="sxs-lookup"><span data-stu-id="c2ebc-123">Do not use dynamic queries in stored procedures</span></span>](#stored-proc)</li></ul> |
| <span data-ttu-id="c2ebc-124">**API da Web**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-124">**Web API**</span></span> | <ul><li>[<span data-ttu-id="c2ebc-125">Verifique se a validação do modelo é feita nos métodos de API Web</span><span class="sxs-lookup"><span data-stu-id="c2ebc-125">Ensure that model validation is done on Web API methods</span></span>](#validation-api)</li><li>[<span data-ttu-id="c2ebc-126">Implemente a validação de entrada em todos os parâmetros de tipo de cadeia de caracteres aceitos pelos métodos de API Web</span><span class="sxs-lookup"><span data-stu-id="c2ebc-126">Implement input validation on all string type parameters accepted by Web API methods</span></span>](#string-api)</li><li>[<span data-ttu-id="c2ebc-127">Verifique se os parâmetros de tipo seguro são usados na API Web para acesso a dados</span><span class="sxs-lookup"><span data-stu-id="c2ebc-127">Ensure that type-safe parameters are used in Web API for data access</span></span>](#typesafe-api)</li></ul> | 
| <span data-ttu-id="c2ebc-128">**Azure DocumentDB**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-128">**Azure Document DB**</span></span> | <ul><li>[<span data-ttu-id="c2ebc-129">Usar consultas SQL parametrizadas para DocumentDB</span><span class="sxs-lookup"><span data-stu-id="c2ebc-129">Use parametrized SQL queries for DocumentDB</span></span>](#sql-docdb)</li></ul> | 
| <span data-ttu-id="c2ebc-130">**WCF**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-130">**WCF**</span></span> | <ul><li>[<span data-ttu-id="c2ebc-131">Validação de entrada de WCF por meio de associação de esquema</span><span class="sxs-lookup"><span data-stu-id="c2ebc-131">WCF Input validation through Schema binding</span></span>](#schema-binding)</li><li>[<span data-ttu-id="c2ebc-132">Validação de entrada de WCF por meio de Inspetores de Parâmetro</span><span class="sxs-lookup"><span data-stu-id="c2ebc-132">WCF- Input validation through Parameter Inspectors</span></span>](#parameters)</li></ul> |

## <span data-ttu-id="c2ebc-133"><a id="disable-xslt"></a>Desabilite os scripts XSLT para todas as transformações usando folhas de estilo não confiáveis</span><span class="sxs-lookup"><span data-stu-id="c2ebc-133"><a id="disable-xslt"></a>Disable XSLT scripting for all transforms using untrusted style sheets</span></span>

| <span data-ttu-id="c2ebc-134">Title</span><span class="sxs-lookup"><span data-stu-id="c2ebc-134">Title</span></span>                   | <span data-ttu-id="c2ebc-135">Detalhes</span><span class="sxs-lookup"><span data-stu-id="c2ebc-135">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="c2ebc-136">**Componente**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-136">**Component**</span></span>               | <span data-ttu-id="c2ebc-137">Aplicativo Web</span><span class="sxs-lookup"><span data-stu-id="c2ebc-137">Web Application</span></span> | 
| <span data-ttu-id="c2ebc-138">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-138">**SDL Phase**</span></span>               | <span data-ttu-id="c2ebc-139">Compilação</span><span class="sxs-lookup"><span data-stu-id="c2ebc-139">Build</span></span> |  
| <span data-ttu-id="c2ebc-140">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-140">**Applicable Technologies**</span></span> | <span data-ttu-id="c2ebc-141">Genérico</span><span class="sxs-lookup"><span data-stu-id="c2ebc-141">Generic</span></span> |
| <span data-ttu-id="c2ebc-142">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-142">**Attributes**</span></span>              | <span data-ttu-id="c2ebc-143">N/D</span><span class="sxs-lookup"><span data-stu-id="c2ebc-143">N/A</span></span>  |
| <span data-ttu-id="c2ebc-144">**Referências**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-144">**References**</span></span>              | <span data-ttu-id="c2ebc-145">[Segurança do XSLT](https://msdn.microsoft.com/library/ms763800(v=vs.85).aspx), [Propriedade XsltSettings](http://msdn.microsoft.com/library/system.xml.xsl.xsltsettings.enablescript.aspx)</span><span class="sxs-lookup"><span data-stu-id="c2ebc-145">[XSLT Security](https://msdn.microsoft.com/library/ms763800(v=vs.85).aspx), [XsltSettings.EnableScript Property](http://msdn.microsoft.com/library/system.xml.xsl.xsltsettings.enablescript.aspx)</span></span> |
| <span data-ttu-id="c2ebc-146">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-146">**Steps**</span></span> | <span data-ttu-id="c2ebc-147">XSLT oferece suporte a scripts dentro de folhas de estilo usando Olá `<msxml:script>` elemento.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-147">XSLT supports scripting inside style sheets using hello `<msxml:script>` element.</span></span> <span data-ttu-id="c2ebc-148">Isso permite que funções personalizadas toobe usado em uma transformação XSLT.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-148">This allows custom functions toobe used in an XSLT transformation.</span></span> <span data-ttu-id="c2ebc-149">Olá script é executado no contexto de saudação do processo de saudação executando Olá transformação.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-149">hello script is executed under hello context of hello process performing hello transform.</span></span> <span data-ttu-id="c2ebc-150">Script XSLT deve ser desabilitada quando em execução tooprevent não confiável do ambiente de código não confiável.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-150">XSLT script must be disabled when in an untrusted environment tooprevent execution of untrusted code.</span></span> <span data-ttu-id="c2ebc-151">*Se o uso do .NET:* script XSLT é desabilitado por padrão; no entanto, você deve garantir que ele não foi explicitamente habilitado por meio de saudação `XsltSettings.EnableScript` propriedade.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-151">*If using .NET:* XSLT scripting is disabled by default; however, you must ensure that it has not been explicitly enabled through hello `XsltSettings.EnableScript` property.</span></span>|

### <a name="example"></a><span data-ttu-id="c2ebc-152">Exemplo</span><span class="sxs-lookup"><span data-stu-id="c2ebc-152">Example</span></span> 

```C#
XsltSettings settings = new XsltSettings();
settings.EnableScript = true; // WRONG: THIS SHOULD BE SET toofalse
```

### <a name="example"></a><span data-ttu-id="c2ebc-153">Exemplo</span><span class="sxs-lookup"><span data-stu-id="c2ebc-153">Example</span></span>
<span data-ttu-id="c2ebc-154">Se você estiver usando MSXML 6.0, XSLT de script está desabilitado por padrão. No entanto, você deve garantir que ele não foi explicitamente habilitado por meio da propriedade do objeto XML DOM Olá AllowXsltScript.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-154">If you are using using MSXML 6.0, XSLT scripting is disabled by default; however, you must ensure that it has not been explicitly enabled through hello XML DOM object property AllowXsltScript.</span></span> 

```C#
doc.setProperty("AllowXsltScript", true); // WRONG: THIS SHOULD BE SET toofalse
```

### <a name="example"></a><span data-ttu-id="c2ebc-155">Exemplo</span><span class="sxs-lookup"><span data-stu-id="c2ebc-155">Example</span></span>
<span data-ttu-id="c2ebc-156">Se você estiver usando MSXML 5 ou anterior, o script XSLT será habilitado por padrão, e você deverá desabilitá-lo explicitamente.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-156">If you are using MSXML 5 or below, XSLT scripting is enabled by default and you must explicitly disable it.</span></span> <span data-ttu-id="c2ebc-157">Defina Olá XML DOM objeto propriedade AllowXsltScript toofalse.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-157">Set hello XML DOM object property AllowXsltScript toofalse.</span></span> 

```C#
doc.setProperty("AllowXsltScript", false); // CORRECT. Setting toofalse disables XSLT scripting.
```

## <span data-ttu-id="c2ebc-158"><a id="out-sniffing"></a>Verifique se cada página que pode ter conteúdo controlável pelo usuário recusa a detecção automática de MIME</span><span class="sxs-lookup"><span data-stu-id="c2ebc-158"><a id="out-sniffing"></a>Ensure that each page that could contain user controllable content opts out of automatic MIME sniffing</span></span>

| <span data-ttu-id="c2ebc-159">Title</span><span class="sxs-lookup"><span data-stu-id="c2ebc-159">Title</span></span>                   | <span data-ttu-id="c2ebc-160">Detalhes</span><span class="sxs-lookup"><span data-stu-id="c2ebc-160">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="c2ebc-161">**Componente**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-161">**Component**</span></span>               | <span data-ttu-id="c2ebc-162">Aplicativo Web</span><span class="sxs-lookup"><span data-stu-id="c2ebc-162">Web Application</span></span> | 
| <span data-ttu-id="c2ebc-163">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-163">**SDL Phase**</span></span>               | <span data-ttu-id="c2ebc-164">Compilação</span><span class="sxs-lookup"><span data-stu-id="c2ebc-164">Build</span></span> |  
| <span data-ttu-id="c2ebc-165">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-165">**Applicable Technologies**</span></span> | <span data-ttu-id="c2ebc-166">Genérico</span><span class="sxs-lookup"><span data-stu-id="c2ebc-166">Generic</span></span> |
| <span data-ttu-id="c2ebc-167">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-167">**Attributes**</span></span>              | <span data-ttu-id="c2ebc-168">N/D</span><span class="sxs-lookup"><span data-stu-id="c2ebc-168">N/A</span></span>  |
| <span data-ttu-id="c2ebc-169">**Referências**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-169">**References**</span></span>              | [<span data-ttu-id="c2ebc-170">Segurança do IE8 parte V - proteção abrangente</span><span class="sxs-lookup"><span data-stu-id="c2ebc-170">IE8 Security Part V - Comprehensive Protection</span></span>](http://blogs.msdn.com/ie/archive/2008/07/02/ie8-security-part-v-comprehensive-protection.aspx)  |
| <span data-ttu-id="c2ebc-171">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-171">**Steps**</span></span> | <p><span data-ttu-id="c2ebc-172">Para cada página que pode conter conteúdo controlável do usuário, você deve usar o hello cabeçalho HTTP `X-Content-Type-Options:nosniff`.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-172">For each page that could contain user controllable content, you must use hello HTTP Header `X-Content-Type-Options:nosniff`.</span></span> <span data-ttu-id="c2ebc-173">toocomply com esse requisito, você pode cabeçalho necessário qualquer conjunto Olá página por página para somente as páginas que podem conter conteúdo usuário controlável ou você pode defini-lo globalmente para todas as páginas no aplicativo hello.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-173">toocomply with this requirement, you can either set hello required header page by page for only those pages that might contain user-controllable content, or you can set it globally for all pages in hello application.</span></span></p><p><span data-ttu-id="c2ebc-174">Cada tipo de arquivo entregue a partir de um servidor da web possui um tipo de [tipo MIME](http://en.wikipedia.org/wiki/Mime_type) (também chamado de um *tipo de conteúdo*) que descreve a natureza de saudação do conteúdo hello (ou seja, imagem, texto, aplicativo, etc.)</span><span class="sxs-lookup"><span data-stu-id="c2ebc-174">Each type of file delivered from a web server has an associated [MIME type](http://en.wikipedia.org/wiki/Mime_type) (also called a *content-type*) that describes hello nature of hello content (that is, image, text, application, etc.)</span></span></p><p><span data-ttu-id="c2ebc-175">cabeçalho Olá X conteúdo-tipo de opções é um cabeçalho HTTP que permite aos desenvolvedores toospecify que seu conteúdo não deve ser detectados MIME.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-175">hello X-Content-Type-Options header is an HTTP header that allows developers toospecify that their content should not be MIME-sniffed.</span></span> <span data-ttu-id="c2ebc-176">Esse cabeçalho é projetado toomitigate ataques de detecção de MIME.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-176">This header is designed toomitigate MIME-Sniffing attacks.</span></span> <span data-ttu-id="c2ebc-177">Foi adicionado suporte para esse cabeçalho no Internet Explorer 8 (IE8)</span><span class="sxs-lookup"><span data-stu-id="c2ebc-177">Support for this header was added in Internet Explorer 8 (IE8)</span></span></p><p><span data-ttu-id="c2ebc-178">Somente os usuários do Internet Explorer 8 (IE8) se beneficiarão de Content-Type-Options.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-178">Only users of Internet Explorer 8 (IE8) will benefit from X-Content-Type-Options.</span></span> <span data-ttu-id="c2ebc-179">Versões anteriores do Internet Explorer não respeitam atualmente cabeçalho X-conteúdo-opções de tipo de saudação</span><span class="sxs-lookup"><span data-stu-id="c2ebc-179">Previous versions of Internet Explorer do not currently respect hello X-Content-Type-Options header</span></span></p><p><span data-ttu-id="c2ebc-180">Internet Explorer 8 (e posterior) são Olá apenas principais navegadores tooimplement MIME-sniffing recusar o recurso.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-180">Internet Explorer 8 (and later) are hello only major browsers tooimplement a MIME-sniffing opt-out feature.</span></span> <span data-ttu-id="c2ebc-181">Se e quando os principais navegadores (Firefox, Safari, Chrome) implementam recursos semelhantes, essa recomendação será atualizado tooinclude sintaxe para esses navegadores</span><span class="sxs-lookup"><span data-stu-id="c2ebc-181">If and when other major browsers (Firefox, Safari, Chrome) implement similar features, this recommendation will be updated tooinclude syntax for those browsers as well</span></span></p>|

### <a name="example"></a><span data-ttu-id="c2ebc-182">Exemplo</span><span class="sxs-lookup"><span data-stu-id="c2ebc-182">Example</span></span>
<span data-ttu-id="c2ebc-183">cabeçalho necessário de saudação de tooenable globalmente para todas as páginas no aplicativo hello, você pode fazer um dos seguintes hello:</span><span class="sxs-lookup"><span data-stu-id="c2ebc-183">tooenable hello required header globally for all pages in hello application, you can do one of hello following:</span></span> 

* <span data-ttu-id="c2ebc-184">Adicionar cabeçalho Olá no arquivo Web. config de saudação se o aplicativo hello é hospedado pelo Internet Information Services (IIS) 7</span><span class="sxs-lookup"><span data-stu-id="c2ebc-184">Add hello header in hello web.config file if hello application is hosted by Internet Information Services (IIS) 7</span></span> 

```
<system.webServer> 
  <httpProtocol> 
    <customHeaders> 
      <add name=""X-Content-Type-Options"" value=""nosniff""/>
    </customHeaders>
  </httpProtocol>
</system.webServer> 
```

* <span data-ttu-id="c2ebc-185">Adicionar cabeçalho Olá Olá aplicativo global\_BeginRequest</span><span class="sxs-lookup"><span data-stu-id="c2ebc-185">Add hello header through hello global Application\_BeginRequest</span></span> 

``` 
void Application_BeginRequest(object sender, EventArgs e)
{
  this.Response.Headers[""X-Content-Type-Options""] = ""nosniff"";
} 
```

* <span data-ttu-id="c2ebc-186">Implementar o módulo HTTP personalizado</span><span class="sxs-lookup"><span data-stu-id="c2ebc-186">Implement custom HTTP module</span></span> 

``` 
public class XContentTypeOptionsModule : IHttpModule 
  {
    #region IHttpModule Members 
    public void Dispose() 
    { 

    } 
    public void Init(HttpApplication context)
    { 
      context.PreSendRequestHeaders += newEventHandler(context_PreSendRequestHeaders); 
    } 
    #endregion 
    void context_PreSendRequestHeaders(object sender, EventArgs e) 
      { 
        HttpApplication application = sender as HttpApplication; 
        if (application == null) 
          return; 
        if (application.Response.Headers[""X-Content-Type-Options ""] != null) 
          return; 
        application.Response.Headers.Add(""X-Content-Type-Options "", ""nosniff""); 
      } 
  } 

``` 

* <span data-ttu-id="c2ebc-187">Você pode habilitar o cabeçalho de saudação necessário apenas para páginas específicas, adicionando-tooindividual respostas:</span><span class="sxs-lookup"><span data-stu-id="c2ebc-187">You can enable hello required header only for specific pages by adding it tooindividual responses:</span></span> 

```
this.Response.Headers[""X-Content-Type-Options""] = ""nosniff""; 
``` 

## <span data-ttu-id="c2ebc-188"><a id="xml-resolution"></a>Proteger ou desabilitar a resolução de entidade XML</span><span class="sxs-lookup"><span data-stu-id="c2ebc-188"><a id="xml-resolution"></a>Harden or Disable XML Entity Resolution</span></span>

| <span data-ttu-id="c2ebc-189">Title</span><span class="sxs-lookup"><span data-stu-id="c2ebc-189">Title</span></span>                   | <span data-ttu-id="c2ebc-190">Detalhes</span><span class="sxs-lookup"><span data-stu-id="c2ebc-190">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="c2ebc-191">**Componente**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-191">**Component**</span></span>               | <span data-ttu-id="c2ebc-192">Aplicativo Web</span><span class="sxs-lookup"><span data-stu-id="c2ebc-192">Web Application</span></span> | 
| <span data-ttu-id="c2ebc-193">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-193">**SDL Phase**</span></span>               | <span data-ttu-id="c2ebc-194">Compilação</span><span class="sxs-lookup"><span data-stu-id="c2ebc-194">Build</span></span> |  
| <span data-ttu-id="c2ebc-195">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-195">**Applicable Technologies**</span></span> | <span data-ttu-id="c2ebc-196">Genérico</span><span class="sxs-lookup"><span data-stu-id="c2ebc-196">Generic</span></span> |
| <span data-ttu-id="c2ebc-197">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-197">**Attributes**</span></span>              | <span data-ttu-id="c2ebc-198">N/D</span><span class="sxs-lookup"><span data-stu-id="c2ebc-198">N/A</span></span>  |
| <span data-ttu-id="c2ebc-199">**Referências**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-199">**References**</span></span>              | <span data-ttu-id="c2ebc-200">[Expansão de Entidade XML](http://capec.mitre.org/data/definitions/197.html), [Ataques de negação de serviço de XML e defesas](http://msdn.microsoft.com/magazine/ee335713.aspx), [Visão geral de segurança do MSXML](http://msdn.microsoft.com/library/ms754611(v=VS.85).aspx), [Práticas recomendadas para proteger o código do MSXML](http://msdn.microsoft.com/library/ms759188(VS.85).aspx), [Referência de protocolo NSXMLParserDelegate](http://developer.apple.com/library/ios/#documentation/cocoa/reference/NSXMLParserDelegate_Protocol/Reference/Reference.html), [Resolvendo referências externas](https://msdn.microsoft.com/library/5fcwybb2.aspx)</span><span class="sxs-lookup"><span data-stu-id="c2ebc-200">[XML Entity Expansion](http://capec.mitre.org/data/definitions/197.html), [XML Denial of Service Attacks and Defenses](http://msdn.microsoft.com/magazine/ee335713.aspx), [MSXML Security Overview](http://msdn.microsoft.com/library/ms754611(v=VS.85).aspx), [Best Practices for Securing MSXML Code](http://msdn.microsoft.com/library/ms759188(VS.85).aspx), [NSXMLParserDelegate Protocol Reference](http://developer.apple.com/library/ios/#documentation/cocoa/reference/NSXMLParserDelegate_Protocol/Reference/Reference.html), [Resolving External References](https://msdn.microsoft.com/library/5fcwybb2.aspx)</span></span> |
| <span data-ttu-id="c2ebc-201">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-201">**Steps**</span></span>| <p><span data-ttu-id="c2ebc-202">Embora ele ainda não é amplamente usado, há um recurso de XML que permite tooexpand de analisador XML Olá entidades de macro com valores definidos no próprio documento hello ou de fontes externas.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-202">Although it is not widely used, there is a feature of XML that allows hello XML parser tooexpand macro entities with values defined either within hello document itself or from external sources.</span></span> <span data-ttu-id="c2ebc-203">Por exemplo, o documento hello pode definir uma entidade "companyname" com valor de hello "Microsoft", para que sempre Olá texto "&companyname;" aparece no documento hello, ele é substituído automaticamente pelo texto de saudação Microsoft.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-203">For example, hello document might define an entity "companyname" with hello value "Microsoft," so that every time hello text "&companyname;" appears in hello document, it is automatically replaced with hello text Microsoft.</span></span> <span data-ttu-id="c2ebc-204">Ou, documento hello pode definir uma entidade "MSFTStock", o que faz referência a um web externo serviço toofetch Olá valor atual de ações da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-204">Or, hello document might define an entity "MSFTStock" that references an external web service toofetch hello current value of Microsoft stock.</span></span></p><p><span data-ttu-id="c2ebc-205">Em seguida, a qualquer momento "&MSFTStock;" aparece no documento hello, ele é substituído automaticamente pelo preço de estoque atual de saudação.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-205">Then any time "&MSFTStock;" appears in hello document, it is automatically replaced with hello current stock price.</span></span> <span data-ttu-id="c2ebc-206">No entanto, essa funcionalidade pode ser mal utilizada toocreate condições de negação de serviço (DoS).</span><span class="sxs-lookup"><span data-stu-id="c2ebc-206">However, this functionality can be abused toocreate denial of service (DoS) conditions.</span></span> <span data-ttu-id="c2ebc-207">Um invasor pode aninhar uma bomba XML de expansão exponencial que consome toda a memória disponível no sistema de saudação toocreate de várias entidades.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-207">An attacker can nest multiple entities toocreate an exponential expansion XML bomb that consumes all available memory on hello system.</span></span> </p><p><span data-ttu-id="c2ebc-208">Como alternativa, ele pode criar uma referência externa que transmite novamente um valor infinito de dados ou que simplesmente trava thread hello.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-208">Alternatively, he can create an external reference that streams back an infinite amount of data or that simply hangs hello thread.</span></span> <span data-ttu-id="c2ebc-209">Como resultado, todas as equipes devem desabilitar a resolução de entidade XML interna e/ou externa totalmente se seu aplicativo não usá-lo, ou manualmente limitar a quantidade de saudação de memória e a hora em que o aplicativo hello pode consumir para resolução de entidade se essa funcionalidade é absolutamente necessário.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-209">As a result, all teams must disable internal and/or external XML entity resolution entirely if their application does not use it, or manually limit hello amount of memory and time that hello application can consume for entity resolution if this functionality is absolutely necessary.</span></span> <span data-ttu-id="c2ebc-210">Se a resolução de entidade não for exigida pelo aplicativo, desabilite-a.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-210">If entity resolution is not required by your application, then disable it.</span></span> </p>|

### <a name="example"></a><span data-ttu-id="c2ebc-211">Exemplo</span><span class="sxs-lookup"><span data-stu-id="c2ebc-211">Example</span></span>
<span data-ttu-id="c2ebc-212">Código do .NET Framework, você pode usar o hello abordagens a seguir:</span><span class="sxs-lookup"><span data-stu-id="c2ebc-212">For .NET Framework code, you can use hello following approaches:</span></span>

```C#
XmlTextReader reader = new XmlTextReader(stream);
reader.ProhibitDtd = true;

XmlReaderSettings settings = new XmlReaderSettings();
settings.ProhibitDtd = true;
XmlReader reader = XmlReader.Create(stream, settings);

// for .NET 4
XmlReaderSettings settings = new XmlReaderSettings();
settings.DtdProcessing = DtdProcessing.Prohibit;
XmlReader reader = XmlReader.Create(stream, settings);
```
<span data-ttu-id="c2ebc-213">Observe o valor padrão Olá de `ProhibitDtd` na `XmlReaderSettings` for true, mas em `XmlTextReader` é false.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-213">Note that hello default value of `ProhibitDtd` in `XmlReaderSettings` is true, but in `XmlTextReader` it is false.</span></span> <span data-ttu-id="c2ebc-214">Se você estiver usando XmlReaderSettings, você não precisa tooset ProhibitDtd tootrue explicitamente, mas é recomendável para a mesma segurança que você faça.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-214">If you are using XmlReaderSettings, you do not need tooset ProhibitDtd tootrue explicitly, but it is recommended for safety sake that you do.</span></span> <span data-ttu-id="c2ebc-215">Também Observe que Olá classe XmlDocument permite que a resolução de entidade por padrão.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-215">Also note that hello XmlDocument class allows entity resolution by default.</span></span> 

### <a name="example"></a><span data-ttu-id="c2ebc-216">Exemplo</span><span class="sxs-lookup"><span data-stu-id="c2ebc-216">Example</span></span>
<span data-ttu-id="c2ebc-217">resolução de entidade toodisable para XmlDocument, use Olá `XmlDocument.Load(XmlReader)` sobrecarga da saudação método Load e definir Olá propriedades adequadas na resolução de toodisable de argumento de XmlReader hello, conforme ilustrado na saudação de código a seguir:</span><span class="sxs-lookup"><span data-stu-id="c2ebc-217">toodisable entity resolution for XmlDocuments, use hello `XmlDocument.Load(XmlReader)` overload of hello Load method and set hello appropriate properties in hello XmlReader argument toodisable resolution, as illustrated in hello following code:</span></span> 

```C#
XmlReaderSettings settings = new XmlReaderSettings();
settings.ProhibitDtd = true;
XmlReader reader = XmlReader.Create(stream, settings);
XmlDocument doc = new XmlDocument();
doc.Load(reader);
```

### <a name="example"></a><span data-ttu-id="c2ebc-218">Exemplo</span><span class="sxs-lookup"><span data-stu-id="c2ebc-218">Example</span></span>
<span data-ttu-id="c2ebc-219">Se desabilitar a resolução de entidade não é possível para o seu aplicativo, defina Olá XmlReaderSettings.MaxCharactersFromEntities tooa razoável valor da propriedade de acordo com as necessidades do aplicativo tooyour.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-219">If disabling entity resolution is not possible for your application, set hello XmlReaderSettings.MaxCharactersFromEntities property tooa reasonable value according tooyour application's needs.</span></span> <span data-ttu-id="c2ebc-220">Isso limitará o impacto de saudação de possíveis ataques de expansão exponencial.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-220">This will limit hello impact of potential exponential expansion DoS attacks.</span></span> <span data-ttu-id="c2ebc-221">saudação de código a seguir fornece um exemplo dessa abordagem:</span><span class="sxs-lookup"><span data-stu-id="c2ebc-221">hello following code provides an example of this approach:</span></span> 

```C#
XmlReaderSettings settings = new XmlReaderSettings();
settings.ProhibitDtd = false;
settings.MaxCharactersFromEntities = 1000;
XmlReader reader = XmlReader.Create(stream, settings);
```

### <a name="example"></a><span data-ttu-id="c2ebc-222">Exemplo</span><span class="sxs-lookup"><span data-stu-id="c2ebc-222">Example</span></span>
<span data-ttu-id="c2ebc-223">Se você precisar tooresolve embutido entidades, mas não é necessário para entidades externas tooresolve, defina Olá XmlReaderSettings.XmlResolver propriedade toonull.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-223">If you need tooresolve inline entities but do not need tooresolve external entities, set hello XmlReaderSettings.XmlResolver property toonull.</span></span> <span data-ttu-id="c2ebc-224">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="c2ebc-224">For example:</span></span> 

```C#
XmlReaderSettings settings = new XmlReaderSettings();
settings.ProhibitDtd = false;
settings.MaxCharactersFromEntities = 1000;
settings.XmlResolver = null;
XmlReader reader = XmlReader.Create(stream, settings);
```
<span data-ttu-id="c2ebc-225">Observe que no MSXML6, ProhibitDTD é definido tootrue (desabilitar o processamento do DTD) por padrão.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-225">Note that in MSXML6, ProhibitDTD is set tootrue (disabling DTD processing) by default.</span></span> <span data-ttu-id="c2ebc-226">Para código do Apple OSX/iOS, há dois analisadores XML que você pode usar: NSXMLParser e libXML2.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-226">For Apple OSX/iOS code, there are two XML parsers you can use: NSXMLParser and libXML2.</span></span> 

## <span data-ttu-id="c2ebc-227"><a id="app-verification"></a>Os aplicativos que usam http.sys executam a verificação de conversão em formato canônico de URL</span><span class="sxs-lookup"><span data-stu-id="c2ebc-227"><a id="app-verification"></a>Applications utilizing http.sys perform URL canonicalization verification</span></span>

| <span data-ttu-id="c2ebc-228">Title</span><span class="sxs-lookup"><span data-stu-id="c2ebc-228">Title</span></span>                   | <span data-ttu-id="c2ebc-229">Detalhes</span><span class="sxs-lookup"><span data-stu-id="c2ebc-229">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="c2ebc-230">**Componente**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-230">**Component**</span></span>               | <span data-ttu-id="c2ebc-231">Aplicativo Web</span><span class="sxs-lookup"><span data-stu-id="c2ebc-231">Web Application</span></span> | 
| <span data-ttu-id="c2ebc-232">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-232">**SDL Phase**</span></span>               | <span data-ttu-id="c2ebc-233">Compilação</span><span class="sxs-lookup"><span data-stu-id="c2ebc-233">Build</span></span> |  
| <span data-ttu-id="c2ebc-234">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-234">**Applicable Technologies**</span></span> | <span data-ttu-id="c2ebc-235">Genérico</span><span class="sxs-lookup"><span data-stu-id="c2ebc-235">Generic</span></span> |
| <span data-ttu-id="c2ebc-236">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-236">**Attributes**</span></span>              | <span data-ttu-id="c2ebc-237">N/D</span><span class="sxs-lookup"><span data-stu-id="c2ebc-237">N/A</span></span>  |
| <span data-ttu-id="c2ebc-238">**Referências**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-238">**References**</span></span>              | <span data-ttu-id="c2ebc-239">N/D</span><span class="sxs-lookup"><span data-stu-id="c2ebc-239">N/A</span></span>  |
| <span data-ttu-id="c2ebc-240">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-240">**Steps**</span></span> | <p><span data-ttu-id="c2ebc-241">Qualquer aplicativo que usa http.sys deve seguir estas diretrizes:</span><span class="sxs-lookup"><span data-stu-id="c2ebc-241">Any application that uses http.sys should follow these guidelines:</span></span></p><ul><li><span data-ttu-id="c2ebc-242">Limite Olá toono de comprimento de URL mais de 16.384 caracteres (ASCII ou Unicode).</span><span class="sxs-lookup"><span data-stu-id="c2ebc-242">Limit hello URL length toono more than 16,384 characters (ASCII or Unicode).</span></span> <span data-ttu-id="c2ebc-243">Isso é Olá absoluto tamanho máximo da URL com base na configuração de serviços de informações da Internet (IIS) 6 saudação padrão.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-243">This is hello absolute maximum URL length based on hello default Internet Information Services (IIS) 6 setting.</span></span> <span data-ttu-id="c2ebc-244">Os sites devem se esforçar para ter um comprimento menor do que isso, se possível</span><span class="sxs-lookup"><span data-stu-id="c2ebc-244">Websites should strive for a length shorter than this if possible</span></span></li><li><span data-ttu-id="c2ebc-245">Usar Olá classes do .NET Framework e/s de arquivo (como FileStream) como esses aproveitarão Olá regras de conversão em formato canônico no hello .NET FX</span><span class="sxs-lookup"><span data-stu-id="c2ebc-245">Use hello standard .NET Framework file I/O classes (such as FileStream) as these will take advantage of hello canonicalization rules in hello .NET FX</span></span></li><li><span data-ttu-id="c2ebc-246">Criar explicitamente uma lista de permissões de nomes de arquivo conhecidos</span><span class="sxs-lookup"><span data-stu-id="c2ebc-246">Explicitly build an allow-list of known filenames</span></span></li><li><span data-ttu-id="c2ebc-247">Rejeite explicitamente tipos de arquivo conhecidos que você não fornecerá a rejeições de UrlScan: exe, bat, cmd, com, htw, ida, idq, htr, idc, shtm[l], stm, printer, ini, pol, arquivos files</span><span class="sxs-lookup"><span data-stu-id="c2ebc-247">Explicitly reject known filetypes you will not serve UrlScan rejects: exe, bat, cmd, com, htw, ida, idq, htr, idc, shtm[l], stm, printer, ini, pol, dat files</span></span></li><li><span data-ttu-id="c2ebc-248">Catch Olá exceções a seguir:</span><span class="sxs-lookup"><span data-stu-id="c2ebc-248">Catch hello following exceptions:</span></span><ul><li><span data-ttu-id="c2ebc-249">System.ArgumentException (para nomes de dispositivo)</span><span class="sxs-lookup"><span data-stu-id="c2ebc-249">System.ArgumentException (for device names)</span></span></li><li><span data-ttu-id="c2ebc-250">System.NotSupportedException (para fluxos de dados)</span><span class="sxs-lookup"><span data-stu-id="c2ebc-250">System.NotSupportedException (for data streams)</span></span></li><li><span data-ttu-id="c2ebc-251">System.IO.FileNotFoundException (para nomes com escape inválidos)</span><span class="sxs-lookup"><span data-stu-id="c2ebc-251">System.IO.FileNotFoundException (for invalid escaped filenames)</span></span></li><li><span data-ttu-id="c2ebc-252">System.IO.DirectoryNotFoundException (para diretórios com escape inválidos)</span><span class="sxs-lookup"><span data-stu-id="c2ebc-252">System.IO.DirectoryNotFoundException (for invalid escaped dirs)</span></span></li></ul></li><li><span data-ttu-id="c2ebc-253">*Não* chamar tooWin32 arquivo I/O APIs.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-253">*Do not* call out tooWin32 file I/O APIs.</span></span> <span data-ttu-id="c2ebc-254">Em uma URL inválida normalmente retornam um erro de 400 toohello usuário e logon erro real hello.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-254">On an invalid URL gracefully return a 400 error toohello user, and log hello real error.</span></span></li></ul>|

## <span data-ttu-id="c2ebc-255"><a id="controls-users"></a>Verifique se os controles adequados estão em vigor ao aceitar arquivos de usuários</span><span class="sxs-lookup"><span data-stu-id="c2ebc-255"><a id="controls-users"></a>Ensure appropriate controls are in place when accepting files from users</span></span>

| <span data-ttu-id="c2ebc-256">Title</span><span class="sxs-lookup"><span data-stu-id="c2ebc-256">Title</span></span>                   | <span data-ttu-id="c2ebc-257">Detalhes</span><span class="sxs-lookup"><span data-stu-id="c2ebc-257">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="c2ebc-258">**Componente**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-258">**Component**</span></span>               | <span data-ttu-id="c2ebc-259">Aplicativo Web</span><span class="sxs-lookup"><span data-stu-id="c2ebc-259">Web Application</span></span> | 
| <span data-ttu-id="c2ebc-260">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-260">**SDL Phase**</span></span>               | <span data-ttu-id="c2ebc-261">Compilação</span><span class="sxs-lookup"><span data-stu-id="c2ebc-261">Build</span></span> |  
| <span data-ttu-id="c2ebc-262">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-262">**Applicable Technologies**</span></span> | <span data-ttu-id="c2ebc-263">Genérico</span><span class="sxs-lookup"><span data-stu-id="c2ebc-263">Generic</span></span> |
| <span data-ttu-id="c2ebc-264">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-264">**Attributes**</span></span>              | <span data-ttu-id="c2ebc-265">N/D</span><span class="sxs-lookup"><span data-stu-id="c2ebc-265">N/A</span></span>  |
| <span data-ttu-id="c2ebc-266">**Referências**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-266">**References**</span></span>              | <span data-ttu-id="c2ebc-267">[Upload de arquivo irrestrito](https://www.owasp.org/index.php/Unrestricted_File_Upload), [Tabela de assinatura de arquivo](http://www.garykessler.net/library/file_sigs.html)</span><span class="sxs-lookup"><span data-stu-id="c2ebc-267">[Unrestricted File Upload](https://www.owasp.org/index.php/Unrestricted_File_Upload), [File Signature Table](http://www.garykessler.net/library/file_sigs.html)</span></span> |
| <span data-ttu-id="c2ebc-268">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-268">**Steps**</span></span> | <p><span data-ttu-id="c2ebc-269">Arquivos carregados representam um risco significativo tooapplications.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-269">Uploaded files represent a significant risk tooapplications.</span></span></p><p><span data-ttu-id="c2ebc-270">a primeira etapa Olá em muitos ataques é tooget alguns toobe do código toohello sistema atacado.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-270">hello first step in many attacks is tooget some code toohello system toobe attacked.</span></span> <span data-ttu-id="c2ebc-271">Em seguida, ataque Olá só precisa toofind executado um código de saudação do tooget de maneira.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-271">Then hello attack only needs toofind a way tooget hello code executed.</span></span> <span data-ttu-id="c2ebc-272">Usar um upload de arquivo Ajuda invasor Olá realizar a primeira etapa de saudação.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-272">Using a file upload helps hello attacker accomplish hello first step.</span></span> <span data-ttu-id="c2ebc-273">consequências de saudação do carregamento de arquivo irrestrito podem variar, incluindo controle de sistema completo, um banco de dados, desfiguração simple e sistemas de tooback a fim de ataques de encaminhamento ou sistema de arquivos sobrecarregados.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-273">hello consequences of unrestricted file upload can vary, including complete system takeover, an overloaded file system or database, forwarding attacks tooback-end systems, and simple defacement.</span></span></p><p><span data-ttu-id="c2ebc-274">Depende do qual aplicativo hello não com o arquivo hello carregado e especialmente onde ele está armazenado.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-274">It depends on what hello application does with hello uploaded file and especially where it is stored.</span></span> <span data-ttu-id="c2ebc-275">A validação do lado do servidor de uploads de arquivo está ausente.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-275">Server side validation of file uploads is missing.</span></span> <span data-ttu-id="c2ebc-276">Os controles de segurança a seguir devem ser implementados para a funcionalidade de Upload de Arquivo:</span><span class="sxs-lookup"><span data-stu-id="c2ebc-276">Following security controls should be implemented for File Upload functionality:</span></span></p><ul><li><span data-ttu-id="c2ebc-277">Verificação de extensão de arquivo (somente um conjunto válido de tipos de arquivo permitidos deve ser aceito)</span><span class="sxs-lookup"><span data-stu-id="c2ebc-277">File Extension check (only a valid set of allowed file type should be accepted)</span></span></li><li><span data-ttu-id="c2ebc-278">Limite de tamanho máximo de arquivo</span><span class="sxs-lookup"><span data-stu-id="c2ebc-278">Maximum file size limit</span></span></li><li><span data-ttu-id="c2ebc-279">Arquivo não deve ser carregado toowebroot; local de saudação deve ser um diretório no disco não são do sistema</span><span class="sxs-lookup"><span data-stu-id="c2ebc-279">File should not be uploaded toowebroot; hello location should be a directory on non-system drive</span></span></li><li><span data-ttu-id="c2ebc-280">Convenção de nomenclatura deve ser seguida, de modo que hello nome de arquivo carregado tem algumas aleatoriedade, portanto, como tooprevent arquivo substitui</span><span class="sxs-lookup"><span data-stu-id="c2ebc-280">Naming convention should be followed, such that hello uploaded file name have some randomness, so as tooprevent file overwrites</span></span></li><li><span data-ttu-id="c2ebc-281">Arquivos devem ser verificados antivírus antes de gravar o disco toohello</span><span class="sxs-lookup"><span data-stu-id="c2ebc-281">Files should be scanned for anti-virus before writing toohello disk</span></span></li><li><span data-ttu-id="c2ebc-282">Certifique-se de que o nome do arquivo hello e quaisquer outros metadados (por exemplo, o caminho do arquivo) são validados para caracteres mal-intencionado</span><span class="sxs-lookup"><span data-stu-id="c2ebc-282">Ensure that hello file name and any other metadata (e.g., file path) are validated for malicious characters</span></span></li><li><span data-ttu-id="c2ebc-283">Assinatura do arquivo de formato deve ser verificada, tooprevent um usuário carregue um arquivo masqueraded (por exemplo, carregando um arquivo exe, alterando a extensão tootxt)</span><span class="sxs-lookup"><span data-stu-id="c2ebc-283">File format signature should be checked, tooprevent a user from uploading a masqueraded file (e.g., uploading an exe file by changing extension tootxt)</span></span></li></ul>| 

### <a name="example"></a><span data-ttu-id="c2ebc-284">Exemplo</span><span class="sxs-lookup"><span data-stu-id="c2ebc-284">Example</span></span>
<span data-ttu-id="c2ebc-285">Para o último ponto relacionadas à validação de assinatura de formato de arquivo hello, consulte classe toohello abaixo para obter detalhes:</span><span class="sxs-lookup"><span data-stu-id="c2ebc-285">For hello last point regarding file format signature validation, refer toohello class below for details:</span></span> 

```C#
        private static Dictionary<string, List<byte[]>> fileSignature = new Dictionary<string, List<byte[]>>
                    {
                    { ".DOC", new List<byte[]> { new byte[] { 0xD0, 0xCF, 0x11, 0xE0, 0xA1, 0xB1, 0x1A, 0xE1 } } },
                    { ".DOCX", new List<byte[]> { new byte[] { 0x50, 0x4B, 0x03, 0x04 } } },
                    { ".PDF", new List<byte[]> { new byte[] { 0x25, 0x50, 0x44, 0x46 } } },
                    { ".ZIP", new List<byte[]> 
                                            {
                                              new byte[] { 0x50, 0x4B, 0x03, 0x04 },
                                              new byte[] { 0x50, 0x4B, 0x4C, 0x49, 0x54, 0x55 },
                                              new byte[] { 0x50, 0x4B, 0x53, 0x70, 0x58 },
                                              new byte[] { 0x50, 0x4B, 0x05, 0x06 },
                                              new byte[] { 0x50, 0x4B, 0x07, 0x08 },
                                              new byte[] { 0x57, 0x69, 0x6E, 0x5A, 0x69, 0x70 }
                                                }
                                            },
                    { ".PNG", new List<byte[]> { new byte[] { 0x89, 0x50, 0x4E, 0x47, 0x0D, 0x0A, 0x1A, 0x0A } } },
                    { ".JPG", new List<byte[]>
                                    {
                                              new byte[] { 0xFF, 0xD8, 0xFF, 0xE0 },
                                              new byte[] { 0xFF, 0xD8, 0xFF, 0xE1 },
                                              new byte[] { 0xFF, 0xD8, 0xFF, 0xE8 }
                                    }
                                    },
                    { ".JPEG", new List<byte[]>
                                        { 
                                            new byte[] { 0xFF, 0xD8, 0xFF, 0xE0 },
                                            new byte[] { 0xFF, 0xD8, 0xFF, 0xE2 },
                                            new byte[] { 0xFF, 0xD8, 0xFF, 0xE3 }
                                        }
                                        },
                    { ".XLS", new List<byte[]>
                                            {
                                              new byte[] { 0xD0, 0xCF, 0x11, 0xE0, 0xA1, 0xB1, 0x1A, 0xE1 },
                                              new byte[] { 0x09, 0x08, 0x10, 0x00, 0x00, 0x06, 0x05, 0x00 },
                                              new byte[] { 0xFD, 0xFF, 0xFF, 0xFF }
                                            }
                                            },
                    { ".XLSX", new List<byte[]> { new byte[] { 0x50, 0x4B, 0x03, 0x04 } } },
                    { ".GIF", new List<byte[]> { new byte[] { 0x47, 0x49, 0x46, 0x38 } } }
                };

        public static bool IsValidFileExtension(string fileName, byte[] fileData, byte[] allowedChars)
        {
            if (string.IsNullOrEmpty(fileName) || fileData == null || fileData.Length == 0)
            {
                return false;
            }

            bool flag = false;
            string ext = Path.GetExtension(fileName);
            if (string.IsNullOrEmpty(ext))
            {
                return false;
            }

            ext = ext.ToUpperInvariant();

            if (ext.Equals(".TXT") || ext.Equals(".CSV") || ext.Equals(".PRN"))
            {
                foreach (byte b in fileData)
                {
                    if (b > 0x7F)
                    {
                        if (allowedChars != null)
                        {
                            if (!allowedChars.Contains(b))
                            {
                                return false;
                            }
                        }
                        else
                        {
                            return false;
                        }
                    }
                }

                return true;
            }

            if (!fileSignature.ContainsKey(ext))
            {
                return true;
            }

            List<byte[]> sig = fileSignature[ext];
            foreach (byte[] b in sig)
            {
                var curFileSig = new byte[b.Length];
                Array.Copy(fileData, curFileSig, b.Length);
                if (curFileSig.SequenceEqual(b))
                {
                    flag = true;
                    break;
                }
            }

            return flag;
        }
```

## <span data-ttu-id="c2ebc-286"><a id="typesafe"></a>Verifique se os parâmetros de tipo seguro são usados no aplicativo Web para acesso a dados</span><span class="sxs-lookup"><span data-stu-id="c2ebc-286"><a id="typesafe"></a>Ensure that type-safe parameters are used in Web Application for data access</span></span>

| <span data-ttu-id="c2ebc-287">Title</span><span class="sxs-lookup"><span data-stu-id="c2ebc-287">Title</span></span>                   | <span data-ttu-id="c2ebc-288">Detalhes</span><span class="sxs-lookup"><span data-stu-id="c2ebc-288">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="c2ebc-289">**Componente**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-289">**Component**</span></span>               | <span data-ttu-id="c2ebc-290">Aplicativo Web</span><span class="sxs-lookup"><span data-stu-id="c2ebc-290">Web Application</span></span> | 
| <span data-ttu-id="c2ebc-291">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-291">**SDL Phase**</span></span>               | <span data-ttu-id="c2ebc-292">Compilação</span><span class="sxs-lookup"><span data-stu-id="c2ebc-292">Build</span></span> |  
| <span data-ttu-id="c2ebc-293">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-293">**Applicable Technologies**</span></span> | <span data-ttu-id="c2ebc-294">Genérico</span><span class="sxs-lookup"><span data-stu-id="c2ebc-294">Generic</span></span> |
| <span data-ttu-id="c2ebc-295">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-295">**Attributes**</span></span>              | <span data-ttu-id="c2ebc-296">N/D</span><span class="sxs-lookup"><span data-stu-id="c2ebc-296">N/A</span></span>  |
| <span data-ttu-id="c2ebc-297">**Referências**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-297">**References**</span></span>              | <span data-ttu-id="c2ebc-298">N/D</span><span class="sxs-lookup"><span data-stu-id="c2ebc-298">N/A</span></span>  |
| <span data-ttu-id="c2ebc-299">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-299">**Steps**</span></span> | <p><span data-ttu-id="c2ebc-300">Se você usar a coleção de parâmetros hello, SQL trata Olá entrada é como um valor literal e, em seguida, em vez disso, como código executável.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-300">If you use hello Parameters collection, SQL treats hello input is as a literal value rather then as executable code.</span></span> <span data-ttu-id="c2ebc-301">Olá coleção de parâmetros pode ser restrições de comprimento e tipo de tooenforce usado nos dados de entrada.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-301">hello Parameters collection can be used tooenforce type and length constraints on input data.</span></span> <span data-ttu-id="c2ebc-302">Valores fora do intervalo de saudação disparar uma exceção.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-302">Values outside of hello range trigger an exception.</span></span> <span data-ttu-id="c2ebc-303">Se não forem usados parâmetros SQL de tipo seguro, os invasores podem ser tooexecute capaz de ataques de injeção que são inseridos na entrada hello filtrada.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-303">If type-safe SQL parameters are not used, attackers might be able tooexecute injection attacks that are embedded in hello unfiltered input.</span></span></p><p><span data-ttu-id="c2ebc-304">Use parâmetros de tipo de segurança ao construir SQL consultas tooavoid possíveis ataques de injeção SQL que podem ocorrer com a entrada não filtrada.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-304">Use type safe parameters when constructing SQL queries tooavoid possible SQL injection attacks that can occur with unfiltered input.</span></span> <span data-ttu-id="c2ebc-305">Você pode usar parâmetros de tipo seguro com procedimentos armazenados e instruções SQL dinâmicas.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-305">You can use type safe parameters with stored procedures and with dynamic SQL statements.</span></span> <span data-ttu-id="c2ebc-306">Parâmetros são tratados como valores literais por banco de dados de saudação e não como código executável.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-306">Parameters are treated as literal values by hello database and not as executable code.</span></span> <span data-ttu-id="c2ebc-307">Os parâmetros também são verificados quanto ao tipo e ao tamanho.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-307">Parameters are also checked for type and length.</span></span></p>|

### <a name="example"></a><span data-ttu-id="c2ebc-308">Exemplo</span><span class="sxs-lookup"><span data-stu-id="c2ebc-308">Example</span></span> 
<span data-ttu-id="c2ebc-309">Olá código a seguir mostra como toouse parâmetros de tipo seguros com hello SqlParameterCollection ao chamar um procedimento armazenado.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-309">hello following code shows how toouse type safe parameters with hello SqlParameterCollection when calling a stored procedure.</span></span> 

```C#
using System.Data;
using System.Data.SqlClient;

using (SqlConnection connection = new SqlConnection(connectionString))
{ 
DataSet userDataset = new DataSet(); 
SqlDataAdapter myCommand = new SqlDataAdapter(LoginStoredProcedure", connection); 
myCommand.SelectCommand.CommandType = CommandType.StoredProcedure; 
myCommand.SelectCommand.Parameters.Add("@au_id", SqlDbType.VarChar, 11); 
myCommand.SelectCommand.Parameters["@au_id"].Value = SSN.Text; 
myCommand.Fill(userDataset);
}  
```
<span data-ttu-id="c2ebc-310">Olá precede o exemplo de código, o valor de entrada hello não pode ser mais de 11 caracteres.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-310">In hello preceding code example, hello input value cannot be longer than 11 characters.</span></span> <span data-ttu-id="c2ebc-311">Se dados saudação não está de acordo com tipo de toohello ou o comprimento definido pelo parâmetro hello, Olá classe SqlParameter gera uma exceção.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-311">If hello data does not conform toohello type or length defined by hello parameter, hello SqlParameter class throws an exception.</span></span> 

## <span data-ttu-id="c2ebc-312"><a id="binding-mvc"></a>Usar as classes de associação de modelo separado ou listas de filtro de associação de vulnerabilidade de atribuição em massa de MVC tooprevent</span><span class="sxs-lookup"><span data-stu-id="c2ebc-312"><a id="binding-mvc"></a>Use separate model binding classes or binding filter lists tooprevent MVC mass assignment vulnerability</span></span>

| <span data-ttu-id="c2ebc-313">Title</span><span class="sxs-lookup"><span data-stu-id="c2ebc-313">Title</span></span>                   | <span data-ttu-id="c2ebc-314">Detalhes</span><span class="sxs-lookup"><span data-stu-id="c2ebc-314">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="c2ebc-315">**Componente**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-315">**Component**</span></span>               | <span data-ttu-id="c2ebc-316">Aplicativo Web</span><span class="sxs-lookup"><span data-stu-id="c2ebc-316">Web Application</span></span> | 
| <span data-ttu-id="c2ebc-317">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-317">**SDL Phase**</span></span>               | <span data-ttu-id="c2ebc-318">Compilação</span><span class="sxs-lookup"><span data-stu-id="c2ebc-318">Build</span></span> |  
| <span data-ttu-id="c2ebc-319">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-319">**Applicable Technologies**</span></span> | <span data-ttu-id="c2ebc-320">MVC5, MVC6</span><span class="sxs-lookup"><span data-stu-id="c2ebc-320">MVC5, MVC6</span></span> |
| <span data-ttu-id="c2ebc-321">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-321">**Attributes**</span></span>              | <span data-ttu-id="c2ebc-322">N/D</span><span class="sxs-lookup"><span data-stu-id="c2ebc-322">N/A</span></span>  |
| <span data-ttu-id="c2ebc-323">**Referências**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-323">**References**</span></span>              | <span data-ttu-id="c2ebc-324">[Atributos de metadados](http://msdn.microsoft.com/library/system.componentmodel.dataannotations.metadatatypeattribute), [pública chave de segurança e mitigação de vulnerabilidade](https://github.com/blog/1068-public-key-security-vulnerability-and-mitigation), [tooMass guia completo atribuição no ASP.NET MVC](http://odetocode.com/Blogs/scott/archive/2012/03/11/complete-guide-to-mass-assignment-in-asp-net-mvc.aspx), [guia de Introdução ao EF com MVC](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-basic-crud-functionality-with-the-entity-framework-in-asp-net-mvc-application#overpost)</span><span class="sxs-lookup"><span data-stu-id="c2ebc-324">[Metadata Attributes](http://msdn.microsoft.com/library/system.componentmodel.dataannotations.metadatatypeattribute), [Public Key Security Vulnerability And Mitigation](https://github.com/blog/1068-public-key-security-vulnerability-and-mitigation), [Complete Guide tooMass Assignment in ASP.NET MVC](http://odetocode.com/Blogs/scott/archive/2012/03/11/complete-guide-to-mass-assignment-in-asp-net-mvc.aspx), [Getting Started with EF using MVC](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-basic-crud-functionality-with-the-entity-framework-in-asp-net-mvc-application#overpost)</span></span> |
| <span data-ttu-id="c2ebc-325">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-325">**Steps**</span></span> | <ul><li><span data-ttu-id="c2ebc-326">**Quando devo procurar vulnerabilidades de overposting? -** As vulnerabilidades de overposting podem ocorrer em qualquer lugar em que você associar classes de modelo da entrada do usuário.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-326">**When should I look for over-posting vulnerabilities? -** Over-posting vulnerabilities can occur any place you bind model classes from user input.</span></span> <span data-ttu-id="c2ebc-327">Estruturas como MVC podem representar dados de usuário em classes personalizadas do .NET, incluindo POCOs (Plain Old CLR Objects).</span><span class="sxs-lookup"><span data-stu-id="c2ebc-327">Frameworks like MVC can represent user data in custom .NET classes, including Plain Old CLR Objects (POCOs).</span></span> <span data-ttu-id="c2ebc-328">MVC preenche automaticamente essas classes de modelo com dados de solicitação hello, fornecendo uma representação conveniente para lidar com a entrada do usuário.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-328">MVC automatically populates these model classes with data from hello request, providing a convenient representation for dealing with user input.</span></span> <span data-ttu-id="c2ebc-329">Quando essas classes incluem propriedades que não devem ser definidas pelo usuário Olá, o aplicativo hello pode ser vulneráveis ataques de lançamento tooover, que permitem o controle de usuário de dados que o aplicativo de hello nunca se destina.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-329">When these classes include properties that should not be set by hello user, hello application can be vulnerable tooover-posting attacks, which allow user control of data that hello application never intended.</span></span> <span data-ttu-id="c2ebc-330">Como associação de modelo MVC, tecnologias de acesso de banco de dados como mapeadores de objeto/relacional como Entity Framework geralmente também suportam o uso de dados de banco de dados de toorepresent POCO objetos.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-330">Like MVC model binding, database access technologies such as object/relational mappers like Entity Framework often also support using POCO objects toorepresent database data.</span></span> <span data-ttu-id="c2ebc-331">Essas classes de modelo de dados fornecem Olá conveniência mesmo em lidar com dados de banco de dados, como o MVC ao lidar com a entrada do usuário.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-331">These data model classes provide hello same convenience in dealing with database data as MVC does in dealing with user input.</span></span> <span data-ttu-id="c2ebc-332">Porque o banco de dados do MVC e hello suporte semelhantes modelos, como os objetos POCO, parece Olá tooreuse fácil mesmo classes para ambas as finalidades.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-332">Because both MVC and hello database support similar models, like POCO objects, it seems easy tooreuse hello same classes for both purposes.</span></span> <span data-ttu-id="c2ebc-333">Esta prática falhar, toopreserve separação de preocupações e uma área comum onde propriedades são expostos associação toomodel, habilitar ataques de excesso de lançamento.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-333">This practice fails toopreserve separation of concerns, and it is one common area where unintended properties are exposed toomodel binding, enabling over-posting attacks.</span></span></li><li><span data-ttu-id="c2ebc-334">**Por que não devem usar meu classes de modelo de banco de dados não filtrados como ações de MVC toomy parâmetros? -** Associação de modelo MVC porque associará nada nessa classe.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-334">**Why shouldn't I use my unfiltered database model classes as parameters toomy MVC actions? -** Because MVC model binding will bind anything in that class.</span></span> <span data-ttu-id="c2ebc-335">Mesmo se Olá dados não aparecem no modo de exibição, que um usuário mal-intencionado pode enviar uma solicitação HTTP com dados incluídos e MVC serão forneceremos associá-lo porque sua ação diz que a classe de banco de dados é forma Olá dos dados, ele deve aceitar entrada do usuário.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-335">Even if hello data does not appear in your view, a malicious user can send an HTTP request with this data included, and MVC will gladly bind it because your action says that database class is hello shape of data it should accept for user input.</span></span></li><li><span data-ttu-id="c2ebc-336">**Por que devo me preocupar Olá forma usada para associação de modelo? -** Associação de modelo usando o ASP.NET MVC com modelos demasiadamente amplas expõe ataques de lançamento tooover um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-336">**Why should I care about hello shape used for model binding? -** Using ASP.NET MVC model binding with overly broad models exposes an application tooover-posting attacks.</span></span> <span data-ttu-id="c2ebc-337">Excesso de lançamento pode permitir que dados de aplicativo invasores toochange além do qual desenvolvedor Olá pretendido, como a substituição de preço Olá para um item ou hello privilégios de segurança para uma conta.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-337">Over-posting could enable attackers toochange application data beyond what hello developer intended, such as overriding hello price for an item or hello security privileges for an account.</span></span> <span data-ttu-id="c2ebc-338">Aplicativos devem usar um contrato explícito tooprovide associação de modelos (ou listas de filtros de propriedade permitido específica) da ação específica para que tooallow de entrada não confiável por meio de associação de modelo.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-338">Applications should use action-specific binding models (or specific allowed property filter lists) tooprovide an explicit contract for what untrusted input tooallow via model binding.</span></span></li><li><span data-ttu-id="c2ebc-339">**Ter modelos de associação separados apenas duplica o código? -** Não, é uma questão de separação de questões.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-339">**Is having separate binding models just duplicating code? -** No, it is a matter of separation of concerns.</span></span> <span data-ttu-id="c2ebc-340">Se você reutilizar os modelos de banco de dados em métodos de ação, você está dizendo qualquer propriedade (ou subpropriedade) em que a classe pode ser definida pelo usuário de saudação em uma solicitação HTTP.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-340">If you reuse database models in action methods, you are saying any property (or sub-property) in that class can be set by hello user in an HTTP request.</span></span> <span data-ttu-id="c2ebc-341">Se não desejar for toodo MVC, você precisa de uma lista de filtros ou tooshow de forma uma classe separada MVC que os dados podem vir de usuário de entrada em vez disso.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-341">If that is not what you want MVC toodo, you need a filter list or a separate class shape tooshow MVC what data can come from user input instead.</span></span></li><li><span data-ttu-id="c2ebc-342">**Se os modelos de associação separada para a entrada do usuário, é necessário tooduplicate todos os atributos de anotação meus dados? -** Não necessariamente.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-342">**If I have separate binding models for user input, do I have tooduplicate all my data annotation attributes? -** Not necessarily.</span></span> <span data-ttu-id="c2ebc-343">Você pode usar MetadataTypeAttribute em Olá banco de dados modelo toolink toohello metadados de classe em uma classe de associação de modelo.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-343">You can use MetadataTypeAttribute on hello database model class toolink toohello metadata on a model binding class.</span></span> <span data-ttu-id="c2ebc-344">Apenas Observe que Olá tipo referenciado pela Olá MetadataTypeAttribute deve ser um subconjunto de saudação fazendo referência ao tipo (ele pode ter menos de propriedades, mas não mais).</span><span class="sxs-lookup"><span data-stu-id="c2ebc-344">Just note that hello type referenced by hello MetadataTypeAttribute must be a subset of hello referencing type (it can have fewer properties, but not more).</span></span></li><li><span data-ttu-id="c2ebc-345">**A movimentação de dados entre modelos de entrada de usuário e modelos de banco de dados é entediante. Posso simplesmente copiar todas as propriedades usando a reflexão? -** Sim.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-345">**Moving data back and forth between user input models and database models is tedious. Can I just copy over all properties using reflection? -** Yes.</span></span> <span data-ttu-id="c2ebc-346">Hello, apenas as propriedades que aparecem em modelos de associação de saudação são Olá que você determinou toobe seguro para a entrada do usuário.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-346">hello only properties that appear in hello binding models are hello ones you have determined toobe safe for user input.</span></span> <span data-ttu-id="c2ebc-347">Não há nenhum motivo de segurança que impede usando reflexão toocopy em todas as propriedades que existem em comum entre esses dois modelos.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-347">There is no security reason that prevents using reflection toocopy over all properties that exist in common between these two models.</span></span></li><li><span data-ttu-id="c2ebc-348">**Que tal [Bind(Exclude ="â€¦")]. Posso usar isso em vez de ter modelos de associação separados? -** Essa abordagem não é recomendada.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-348">**What about [Bind(Exclude ="â€¦")]. Can I use that instead of having separate binding models? -** This approach is not recommended.</span></span> <span data-ttu-id="c2ebc-349">Usar [Bind(Exclude ="â€¦")] significa que qualquer nova propriedade é associável por padrão.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-349">Using [Bind(Exclude ="â€¦")] means that any new property is bindable by default.</span></span> <span data-ttu-id="c2ebc-350">Quando uma nova propriedade é adicionada, coisas de tookeep de tooremember uma etapa extra é seguro, em vez de ter design Olá ser seguro por padrão.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-350">When a new property is added, there is an extra step tooremember tookeep things secure, rather than having hello design be secure by default.</span></span> <span data-ttu-id="c2ebc-351">Dependendo de desenvolvedor Olá é arriscado verificar essa lista toda vez que uma propriedade é adicionada.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-351">Depending on hello developer checking this list every time a property is added is risky.</span></span></li><li><span data-ttu-id="c2ebc-352">**[Bind(Include ="â€¦")] é útil para operações de edição? -** Não.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-352">**Is [Bind(Include ="â€¦")] useful for Edit operations? -** No.</span></span> <span data-ttu-id="c2ebc-353">[Bind(Include ="â€¦")] só é adequado para operações de estilo INSERT (adicionar novos dados).</span><span class="sxs-lookup"><span data-stu-id="c2ebc-353">[Bind(Include ="â€¦")] is only suitable for INSERT-style operations (adding new data).</span></span> <span data-ttu-id="c2ebc-354">Para operações de atualização de estilo (revisar os dados existentes), use outra abordagem, como ter modelos de associação separado ou passar uma lista explícita de propriedades permitidos tooUpdateModel ou TryUpdateModel.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-354">For UPDATE-style operations (revising existing data), use another approach, like having separate binding models or passing an explicit list of allowed properties tooUpdateModel or TryUpdateModel.</span></span> <span data-ttu-id="c2ebc-355">Adicionando um [associar (Include = "â..")] atributo em uma operação de edição significa que o MVC será criar uma instância do objeto e definir somente Olá listadas propriedades, deixando todos os outros valores padrão.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-355">Adding a [Bind(Include ="â€¦")] attribute on an Edit operation means that MVC will create an object instance and set only hello listed properties, leaving all others at their default values.</span></span> <span data-ttu-id="c2ebc-356">Quando os dados de saudação são persistentes, substituirá totalmente entidade existente do hello, redefinindo valores hello para os padrões de tootheir propriedades omitido.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-356">When hello data is persisted, it will entirely replace hello existing entity, resetting hello values for any omitted properties tootheir defaults.</span></span> <span data-ttu-id="c2ebc-357">Por exemplo, se IsAdmin foi omitido um [associar (Include = "â..")] atributo em uma operação de edição, qualquer usuário cujo nome foi editado por meio dessa ação seria tooIsAdmin redefinição = false (qualquer usuário editado perderia status de administrador).</span><span class="sxs-lookup"><span data-stu-id="c2ebc-357">For example, if IsAdmin was omitted from a [Bind(Include ="â€¦")] attribute on an Edit operation, any user whose name was edited via this action would be reset tooIsAdmin = false (any edited user would lose administrator status).</span></span> <span data-ttu-id="c2ebc-358">Se você quiser tooprevent atualiza as propriedades de toocertain, use um dos Olá outras abordagens acima.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-358">If you want tooprevent updates toocertain properties, use one of hello other approaches above.</span></span> <span data-ttu-id="c2ebc-359">Observe que algumas versões das ferramentas do MVC geram classes de controlador com [Bind(Include ="â€¦")] em ações de edição. Isso implica que a remoção de uma propriedade da lista impedirá ataques de excesso de postagem.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-359">Note that some versions of MVC tooling generate controller classes with [Bind(Include ="â€¦")] on Edit actions and imply that removing a property from that list will prevent over-posting attacks.</span></span> <span data-ttu-id="c2ebc-360">No entanto, conforme descrito acima, essa abordagem não funciona conforme o esperado e em vez disso redefinirá todos os dados em Olá omitido propriedades tootheir padrão valores.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-360">However, as described above, that approach does not work as intended and instead will reset any data in hello omitted properties tootheir default values.</span></span></li><li><span data-ttu-id="c2ebc-361">**Para operações Create, há alguma restrição ao uso de [Bind(Include ="â€¦")] em vez de modelos de associação separada? -** Sim.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-361">**For Create operations, are there any caveats using [Bind(Include ="â€¦")] rather than separate binding models? -** Yes.</span></span> <span data-ttu-id="c2ebc-362">Primeiro, essa abordagem não funciona para cenários de Edição, que exigem a manutenção de duas abordagens separadas para atenuar todas as vulnerabilidades de excesso de postagem.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-362">First this approach does not work for Edit scenarios, requiring maintaining two separate approaches for mitigating all over-posting vulnerabilities.</span></span> <span data-ttu-id="c2ebc-363">Modelos de associação separado e segundo impõem a separação de preocupações entre Olá forma usada para a forma de entrada e hello de usuário usada para a persistência, algo [associar (Include = "â...")] não faz.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-363">Second, separate binding models enforce separation of concerns between hello shape used for user input and hello shape used for persistence, something [Bind(Include ="â€¦")] does not do.</span></span> <span data-ttu-id="c2ebc-364">Observe que, em terceiro lugar, [associar (Include = "â...")] pode lidar somente com propriedades de nível superior; Você não pode permitir que somente partes de subpropriedades (como "Details.Name") no atributo hello.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-364">Third, note that [Bind(Include ="â€¦")] can only handle top-level properties; you cannot allow only portions of sub-properties (such as "Details.Name") in hello attribute.</span></span> <span data-ttu-id="c2ebc-365">Por fim e talvez o mais importante, usando [associar (Include = "â...")] adiciona uma etapa extra que deve ser lembrada qualquer classe de saudação do tempo é usado para associação de modelo.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-365">Finally, and perhaps most importantly, using [Bind(Include ="â€¦")] adds an extra step that must be remembered any time hello class is used for model binding.</span></span> <span data-ttu-id="c2ebc-366">Se um novo método de ação associa a classe de dados toohello diretamente e esquecer tooinclude um [associar (Include = "â..")] atributo, ele pode ser vulnerável ataques tooover lançamento, portanto Olá [associar (incluir = "â..")] abordagem é menos segura por padrão.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-366">If a new action method binds toohello data class directly and forgets tooinclude a [Bind(Include ="â€¦")] attribute, it can be vulnerable tooover-posting attacks, so hello [Bind(Include ="â€¦")] approach is somewhat less secure by default.</span></span> <span data-ttu-id="c2ebc-367">Se você usar [associar (Include = "â...")], tome sempre cuidado tooremember toospecify-lo toda vez que suas classes de dados aparecem como parâmetros de método de ação.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-367">If you use [Bind(Include ="â€¦")], take care always tooremember toospecify it every time your data classes appear as action method parameters.</span></span></li><li><span data-ttu-id="c2ebc-368">**Para criar operações, o que colocar Olá [associar (Include = "â...")] atributo na própria classe de modelo Olá? Não, essa abordagem evitar Olá necessidade tooremember colocando Olá atributo em cada método de ação? -** Essa abordagem funciona em alguns casos.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-368">**For Create operations, what about putting hello [Bind(Include ="â€¦")] attribute on hello model class itself? Does not this approach avoid hello need tooremember putting hello attribute on every action method? -** This approach works in some cases.</span></span> <span data-ttu-id="c2ebc-369">Usando [associar (Include = "â...")] no próprio tipo de modelo hello (e não em parâmetros de ação usando essa classe), evite Olá necessidade tooremember tooinclude Olá [associar (Include = "â...")] atributo em cada método de ação.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-369">Using [Bind(Include ="â€¦")] on hello model type itself (rather than on action parameters using this class), does avoid hello need tooremember tooinclude hello [Bind(Include ="â€¦")] attribute on every action method.</span></span> <span data-ttu-id="c2ebc-370">Usar o atributo Olá diretamente à classe Olá efetivamente cria uma área de superfície separada dessa classe para fins de associação de modelo.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-370">Using hello attribute directly on hello class effectively creates a separate surface area of this class for model binding purposes.</span></span> <span data-ttu-id="c2ebc-371">No entanto, essa abordagem só permite uma forma de associação de modelo por classe de modelo.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-371">However, this approach only allows for one model binding shape per model class.</span></span> <span data-ttu-id="c2ebc-372">Se um método de ação precisa tooallow a associação de modelo de um campo (por exemplo, um administrador somente ação que atualiza as funções de usuário) e outras ações necessário tooprevent a associação de modelo do campo, essa abordagem não funcionará.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-372">If one action method needs tooallow model binding of a field (for example, an administrator-only action that updates user roles) and other actions need tooprevent model binding of this field, this approach will not work.</span></span> <span data-ttu-id="c2ebc-373">Cada classe pode ter apenas uma forma de associação de modelo; Se precisam de ações diferentes formas de associação de modelo diferente, que precisam toorepresent esses separam formas usando ou classes de associação de modelo separado ou separam [associar (Include = "â...")] atributos em métodos de ação de saudação.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-373">Each class can only have one model binding shape; if different actions need different model binding shapes, they need toorepresent these separate shapes using either separate model binding classes or separate [Bind(Include ="â€¦")] attributes on hello action methods.</span></span></li><li><span data-ttu-id="c2ebc-374">**O que são modelos de associação? São que eles Olá a mesma coisa que exibir modelos? -** Esses são dois conceitos relacionados.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-374">**What are binding models? Are they hello same thing as view models? -** These are two related concepts.</span></span> <span data-ttu-id="c2ebc-375">termo Olá modelo de associação refere-se a classe de modelo tooa usada em uma ação é a lista de parâmetros (forma Olá passada do método de ação do MVC modelo associação toohello).</span><span class="sxs-lookup"><span data-stu-id="c2ebc-375">hello term binding model refers tooa model class used in an action is parameter list (hello shape passed from MVC model binding toohello action method).</span></span> <span data-ttu-id="c2ebc-376">modelo de exibição de termo Olá refere-se tooa classe de modelo passado de uma exibição de tooa do método de ação.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-376">hello term view model refers tooa model class passed from an action method tooa view.</span></span> <span data-ttu-id="c2ebc-377">Usando um modelo de exibição específica é uma abordagem comum para transmitir dados de uma exibição de tooa do método de ação.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-377">Using a view-specific model is a common approach for passing data from an action method tooa view.</span></span> <span data-ttu-id="c2ebc-378">Geralmente, essa forma também é adequada para a associação de modelo e modelo de exibição de termo Olá pode ser usado toorefer Olá mesmo modelo usado em ambos os locais.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-378">Often, this shape is also suitable for model binding, and hello term view model can be used toorefer hello same model used in both places.</span></span> <span data-ttu-id="c2ebc-379">toobe preciso, esse procedimento fala especificamente sobre associação de modelos, concentrando-se na forma de saudação passada toohello ação, que é o que é importante para fins de atribuição em massa.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-379">toobe precise, this procedure talks specifically about binding models, focusing on hello shape passed toohello action, which is what matters for mass assignment purposes.</span></span></li></ul>| 

## <span data-ttu-id="c2ebc-380"><a id="rendering"></a>Codificar toorendering anterior de saída da web não confiável</span><span class="sxs-lookup"><span data-stu-id="c2ebc-380"><a id="rendering"></a>Encode untrusted web output prior toorendering</span></span>

| <span data-ttu-id="c2ebc-381">Title</span><span class="sxs-lookup"><span data-stu-id="c2ebc-381">Title</span></span>                   | <span data-ttu-id="c2ebc-382">Detalhes</span><span class="sxs-lookup"><span data-stu-id="c2ebc-382">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="c2ebc-383">**Componente**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-383">**Component**</span></span>               | <span data-ttu-id="c2ebc-384">Aplicativo Web</span><span class="sxs-lookup"><span data-stu-id="c2ebc-384">Web Application</span></span> | 
| <span data-ttu-id="c2ebc-385">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-385">**SDL Phase**</span></span>               | <span data-ttu-id="c2ebc-386">Compilação</span><span class="sxs-lookup"><span data-stu-id="c2ebc-386">Build</span></span> |  
| <span data-ttu-id="c2ebc-387">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-387">**Applicable Technologies**</span></span> | <span data-ttu-id="c2ebc-388">Genérico, Formulários da Web, MVC5, MVC6</span><span class="sxs-lookup"><span data-stu-id="c2ebc-388">Generic, Web Forms, MVC5, MVC6</span></span> |
| <span data-ttu-id="c2ebc-389">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-389">**Attributes**</span></span>              | <span data-ttu-id="c2ebc-390">N/D</span><span class="sxs-lookup"><span data-stu-id="c2ebc-390">N/A</span></span>  |
| <span data-ttu-id="c2ebc-391">**Referências**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-391">**References**</span></span>              | <span data-ttu-id="c2ebc-392">[Como tooprevent Cross site scripting no ASP.NET](http://msdn.microsoft.com/library/ms998274.aspx), [scripts intersites](http://cwe.mitre.org/data/definitions/79.html), [XSS (Cross Site Scripting) prevenção Cheat Sheet](https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet)</span><span class="sxs-lookup"><span data-stu-id="c2ebc-392">[How tooprevent Cross-site scripting in ASP.NET](http://msdn.microsoft.com/library/ms998274.aspx), [Cross-site Scripting](http://cwe.mitre.org/data/definitions/79.html), [XSS (Cross Site Scripting) Prevention Cheat Sheet](https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet)</span></span> |
| <span data-ttu-id="c2ebc-393">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-393">**Steps**</span></span> | <span data-ttu-id="c2ebc-394">Scripts intersites (frequentemente abreviado como XSS) é um vetor de ataque para serviços online ou qualquer aplicativo/componente que consome a entrada da web hello.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-394">Cross-site scripting (commonly abbreviated as XSS) is an attack vector for online services or any application/component that consumes input from hello web.</span></span> <span data-ttu-id="c2ebc-395">Vulnerabilidades XSS podem permitir que um invasor tooexecute script no computador de outro usuário por meio de um aplicativo web vulnerável.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-395">XSS vulnerabilities may allow an attacker tooexecute script on another user's machine through a vulnerable web application.</span></span> <span data-ttu-id="c2ebc-396">Scripts mal-intencionados podem ser usados toosteal cookies e adulterar caso contrário, a máquina da vítima através de JavaScript.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-396">Malicious scripts can be used toosteal cookies and otherwise tamper with a victim's machine through JavaScript.</span></span> <span data-ttu-id="c2ebc-397">O XSS é impedido pela validação da entrada do usuário, garantindo que ele seja bem-formado e codificado antes de ser renderizado em uma página da Web.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-397">XSS is prevented by validating user input, ensuring it is well formed and encoding before it is rendered in a web page.</span></span> <span data-ttu-id="c2ebc-398">A validação de entrada e a codificação de saída podem ser feitas usando a Web Protection Library.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-398">Input validation and output encoding can be done by using Web Protection Library.</span></span> <span data-ttu-id="c2ebc-399">Para código gerenciado (C\#, VB.net, etc.), use um ou mais apropriado métodos de codificação de saudação biblioteca de proteção da Web (Anti-XSS), dependendo do contexto de saudação onde a entrada do usuário Olá obtém manifestada:</span><span class="sxs-lookup"><span data-stu-id="c2ebc-399">For Managed code (C\#, VB.net, etc.), use one or more appropriate encoding methods from hello Web Protection (Anti-XSS) Library, depending on hello context where hello user input gets manifested:</span></span>| 

### <a name="example"></a><span data-ttu-id="c2ebc-400">Exemplo</span><span class="sxs-lookup"><span data-stu-id="c2ebc-400">Example</span></span>

```C#
* Encoder.HtmlEncode 
* Encoder.HtmlAttributeEncode 
* Encoder.JavaScriptEncode 
* Encoder.UrlEncode
* Encoder.VisualBasicScriptEncode 
* Encoder.XmlEncode 
* Encoder.XmlAttributeEncode 
* Encoder.CssEncode 
* Encoder.LdapEncode 
```

## <span data-ttu-id="c2ebc-401"><a id="typemodel"></a>Execute a validação de entrada e a filtragem em todos os tipos de cadeia de caracteres de propriedades do modelo</span><span class="sxs-lookup"><span data-stu-id="c2ebc-401"><a id="typemodel"></a>Perform input validation and filtering on all string type Model properties</span></span>

| <span data-ttu-id="c2ebc-402">Title</span><span class="sxs-lookup"><span data-stu-id="c2ebc-402">Title</span></span>                   | <span data-ttu-id="c2ebc-403">Detalhes</span><span class="sxs-lookup"><span data-stu-id="c2ebc-403">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="c2ebc-404">**Componente**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-404">**Component**</span></span>               | <span data-ttu-id="c2ebc-405">Aplicativo Web</span><span class="sxs-lookup"><span data-stu-id="c2ebc-405">Web Application</span></span> | 
| <span data-ttu-id="c2ebc-406">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-406">**SDL Phase**</span></span>               | <span data-ttu-id="c2ebc-407">Compilação</span><span class="sxs-lookup"><span data-stu-id="c2ebc-407">Build</span></span> |  
| <span data-ttu-id="c2ebc-408">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-408">**Applicable Technologies**</span></span> | <span data-ttu-id="c2ebc-409">Genérico, MVC5, MVC6</span><span class="sxs-lookup"><span data-stu-id="c2ebc-409">Generic, MVC5, MVC6</span></span> |
| <span data-ttu-id="c2ebc-410">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-410">**Attributes**</span></span>              | <span data-ttu-id="c2ebc-411">N/D</span><span class="sxs-lookup"><span data-stu-id="c2ebc-411">N/A</span></span>  |
| <span data-ttu-id="c2ebc-412">**Referências**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-412">**References**</span></span>              | <span data-ttu-id="c2ebc-413">[Adicionando Validação](http://www.asp.net/mvc/overview/getting-started/introduction/adding-validation), [Validando Dados de Modelo em um Aplicativo MVC](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx), [Princípios Básicos para Aplicativos ASP.NET MVC](http://msdn.microsoft.com/magazine/dd942822.aspx)</span><span class="sxs-lookup"><span data-stu-id="c2ebc-413">[Adding Validation](http://www.asp.net/mvc/overview/getting-started/introduction/adding-validation), [Validating Model Data in an MVC Application](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx), [Guiding Principles For Your ASP.NET MVC Applications](http://msdn.microsoft.com/magazine/dd942822.aspx)</span></span> |
| <span data-ttu-id="c2ebc-414">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-414">**Steps**</span></span> | <p><span data-ttu-id="c2ebc-415">Todos os parâmetros de entrada hello devem ser validados antes de serem usadas em Olá aplicativo tooensure que o aplicativo hello está protegido contra entradas de usuário mal-intencionado.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-415">All hello input parameters must be validated before they are used in hello application tooensure that hello application is safeguarded against malicious user inputs.</span></span> <span data-ttu-id="c2ebc-416">Valide os valores de entrada hello usando validações de expressão regular no lado do servidor com uma estratégia de validação da lista de permissões.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-416">Validate hello input values using regular expression validations on server side with a whitelist validation strategy.</span></span> <span data-ttu-id="c2ebc-417">Unsanitized entradas de usuário / parâmetros passados toohello métodos podem causar código vulnerabilidades de injeção.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-417">Unsanitized user inputs / parameters passed toohello methods can cause code injection vulnerabilities.</span></span></p><p><span data-ttu-id="c2ebc-418">Para aplicativos Web, os pontos de entrada também podem incluir campos de formulário, QueryStrings, cookies, cabeçalhos HTTP e parâmetros de serviço Web.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-418">For web applications, entry points can also include form fields, QueryStrings, cookies, HTTP headers, and web service parameters.</span></span></p><p><span data-ttu-id="c2ebc-419">Olá seguintes verificações de validação de entrada devem ser executadas após a associação de modelo:</span><span class="sxs-lookup"><span data-stu-id="c2ebc-419">hello following input validation checks must be performed upon model binding:</span></span></p><ul><li><span data-ttu-id="c2ebc-420">Propriedades do modelo Olá devem ser anotadas com a anotação RegularExpression, para aceitar os caracteres permitidos e o comprimento máximo permitido</span><span class="sxs-lookup"><span data-stu-id="c2ebc-420">hello model properties should be annotated with RegularExpression annotation, for accepting allowed characters and maximum permissible length</span></span></li><li><span data-ttu-id="c2ebc-421">os métodos do controlador Olá devem executar ModelState validade</span><span class="sxs-lookup"><span data-stu-id="c2ebc-421">hello controller methods should perform ModelState validity</span></span></li></ul>|

## <span data-ttu-id="c2ebc-422"><a id="richtext"></a>A limpeza deve ser aplicada em campos de formulário que aceitam todos os caracteres, como o editor de rich text</span><span class="sxs-lookup"><span data-stu-id="c2ebc-422"><a id="richtext"></a>Sanitization should be applied on form fields that accept all characters, e.g, rich text editor</span></span>

| <span data-ttu-id="c2ebc-423">Title</span><span class="sxs-lookup"><span data-stu-id="c2ebc-423">Title</span></span>                   | <span data-ttu-id="c2ebc-424">Detalhes</span><span class="sxs-lookup"><span data-stu-id="c2ebc-424">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="c2ebc-425">**Componente**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-425">**Component**</span></span>               | <span data-ttu-id="c2ebc-426">Aplicativo Web</span><span class="sxs-lookup"><span data-stu-id="c2ebc-426">Web Application</span></span> | 
| <span data-ttu-id="c2ebc-427">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-427">**SDL Phase**</span></span>               | <span data-ttu-id="c2ebc-428">Compilação</span><span class="sxs-lookup"><span data-stu-id="c2ebc-428">Build</span></span> |  
| <span data-ttu-id="c2ebc-429">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-429">**Applicable Technologies**</span></span> | <span data-ttu-id="c2ebc-430">Genérico</span><span class="sxs-lookup"><span data-stu-id="c2ebc-430">Generic</span></span> |
| <span data-ttu-id="c2ebc-431">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-431">**Attributes**</span></span>              | <span data-ttu-id="c2ebc-432">N/D</span><span class="sxs-lookup"><span data-stu-id="c2ebc-432">N/A</span></span>  |
| <span data-ttu-id="c2ebc-433">**Referências**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-433">**References**</span></span>              | <span data-ttu-id="c2ebc-434">[Codificar a entrada não segura](https://msdn.microsoft.com/library/ff647397.aspx#paght000003_step3), [HTML Sanitizer](https://github.com/mganss/HtmlSanitizer)</span><span class="sxs-lookup"><span data-stu-id="c2ebc-434">[Encode Unsafe Input](https://msdn.microsoft.com/library/ff647397.aspx#paght000003_step3), [HTML Sanitizer](https://github.com/mganss/HtmlSanitizer)</span></span> |
| <span data-ttu-id="c2ebc-435">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-435">**Steps**</span></span> | <p><span data-ttu-id="c2ebc-436">Identifica todas as marcas de marcação estática que você deseja toouse.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-436">Identify all static markup tags that you want toouse.</span></span> <span data-ttu-id="c2ebc-437">Uma prática comum é toorestrict formatação toosafe HTML elementos, como `<b>` (negrito) e `<i>` (itálico).</span><span class="sxs-lookup"><span data-stu-id="c2ebc-437">A common practice is toorestrict formatting toosafe HTML elements, such as `<b>` (bold) and `<i>` (italic).</span></span></p><p><span data-ttu-id="c2ebc-438">Antes de gravar dados hello, codificação HTML-lo.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-438">Before writing hello data, HTML-encode it.</span></span> <span data-ttu-id="c2ebc-439">Isso faz com que qualquer script mal-intencionado seguro, levando toobe tratado como texto, não como código executável.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-439">This makes any malicious script safe by causing it toobe handled as text, not as executable code.</span></span></p><ol><li><span data-ttu-id="c2ebc-440">Desabilitar solicitação ASP.NET validação adicionando Olá Olá ValidateRequest = "false" atributo toohello diretiva @ Page</span><span class="sxs-lookup"><span data-stu-id="c2ebc-440">Disable ASP.NET request validation by hello adding hello ValidateRequest="false" attribute toohello @ Page directive</span></span></li><li><span data-ttu-id="c2ebc-441">Codifique a entrada de cadeia de caracteres de saudação com método de HtmlEncode hello</span><span class="sxs-lookup"><span data-stu-id="c2ebc-441">Encode hello string input with hello HtmlEncode method</span></span></li><li><span data-ttu-id="c2ebc-442">Usar StringBuilder e chamada seu tooselectively do método de substituição remover Olá codificação em elementos de saudação HTML que você deseja toopermit</span><span class="sxs-lookup"><span data-stu-id="c2ebc-442">Use a StringBuilder and call its Replace method tooselectively remove hello encoding on hello HTML elements that you want toopermit</span></span></li></ol><p><span data-ttu-id="c2ebc-443">Olá Olá na página referências desabilita a validação de solicitação do ASP.NET, definindo `ValidateRequest="false"`.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-443">hello page-in hello references disables ASP.NET request validation by setting `ValidateRequest="false"`.</span></span> <span data-ttu-id="c2ebc-444">Ele hello codifica o HTML de entrada e permite seletivamente Olá `<b>` e `<i>` como alternativa, também pode ser usada uma biblioteca .NET para a limpeza de HTML.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-444">It HTML-encodes hello input and selectively allows hello `<b>` and `<i>` Alternatively, a .NET library for HTML sanitization may also be used.</span></span></p><p><span data-ttu-id="c2ebc-445">HtmlSanitizer é uma biblioteca .NET para fragmentos HTML e documentos de construções que podem levar a ataques de tooXSS de limpeza.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-445">HtmlSanitizer is a .NET library for cleaning HTML fragments and documents from constructs that can lead tooXSS attacks.</span></span> <span data-ttu-id="c2ebc-446">Ele usa AngleSharp tooparse, manipular e renderizar HTML e CSS.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-446">It uses AngleSharp tooparse, manipulate, and render HTML and CSS.</span></span> <span data-ttu-id="c2ebc-447">HtmlSanitizer pode ser instalado como um pacote do NuGet e entrada do usuário Olá pode ser passada HTML ou CSS limpeza métodos relevantes, conforme aplicável, no lado do servidor de saudação.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-447">HtmlSanitizer can be installed as a NuGet package, and hello user input can be passed through relevant HTML or CSS sanitization methods, as applicable, on hello server side.</span></span> <span data-ttu-id="c2ebc-448">Observe que a limpeza como um controle de segurança deve ser considerada apenas como último recurso.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-448">Please note that Sanitization as a security control should be considered only as a last option.</span></span></p><p><span data-ttu-id="c2ebc-449">A validação de entrada e a codificação de saída são consideradas controles de segurança melhores.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-449">Input validation and Output Encoding are considered better security controls.</span></span></p> |

## <span data-ttu-id="c2ebc-450"><a id="inbuilt-encode"></a>Não atribua toosinks de elementos DOM que não têm embutidas de codificação</span><span class="sxs-lookup"><span data-stu-id="c2ebc-450"><a id="inbuilt-encode"></a>Do not assign DOM elements toosinks that do not have inbuilt encoding</span></span>

| <span data-ttu-id="c2ebc-451">Title</span><span class="sxs-lookup"><span data-stu-id="c2ebc-451">Title</span></span>                   | <span data-ttu-id="c2ebc-452">Detalhes</span><span class="sxs-lookup"><span data-stu-id="c2ebc-452">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="c2ebc-453">**Componente**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-453">**Component**</span></span>               | <span data-ttu-id="c2ebc-454">Aplicativo Web</span><span class="sxs-lookup"><span data-stu-id="c2ebc-454">Web Application</span></span> | 
| <span data-ttu-id="c2ebc-455">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-455">**SDL Phase**</span></span>               | <span data-ttu-id="c2ebc-456">Compilação</span><span class="sxs-lookup"><span data-stu-id="c2ebc-456">Build</span></span> |  
| <span data-ttu-id="c2ebc-457">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-457">**Applicable Technologies**</span></span> | <span data-ttu-id="c2ebc-458">Genérico</span><span class="sxs-lookup"><span data-stu-id="c2ebc-458">Generic</span></span> |
| <span data-ttu-id="c2ebc-459">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-459">**Attributes**</span></span>              | <span data-ttu-id="c2ebc-460">N/D</span><span class="sxs-lookup"><span data-stu-id="c2ebc-460">N/A</span></span>  |
| <span data-ttu-id="c2ebc-461">**Referências**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-461">**References**</span></span>              | <span data-ttu-id="c2ebc-462">N/D</span><span class="sxs-lookup"><span data-stu-id="c2ebc-462">N/A</span></span>  |
| <span data-ttu-id="c2ebc-463">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-463">**Steps**</span></span> | <span data-ttu-id="c2ebc-464">Muitas funções de javascript não fazem a codificação por padrão.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-464">Many javascript functions don't do encoding by default.</span></span> <span data-ttu-id="c2ebc-465">Ao atribuir elementos tooDOM de entrada não confiáveis por meio de funções, pode resultar em várias execuções de script (XSS) do site.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-465">When assigning untrusted input tooDOM elements via such functions, may result in cross site script (XSS) executions.</span></span>| 

### <a name="example"></a><span data-ttu-id="c2ebc-466">Exemplo</span><span class="sxs-lookup"><span data-stu-id="c2ebc-466">Example</span></span>
<span data-ttu-id="c2ebc-467">A seguir estão exemplos não seguros:</span><span class="sxs-lookup"><span data-stu-id="c2ebc-467">Following are insecure examples:</span></span> 

```
document.getElementByID("div1").innerHtml = value;
$("#userName").html(res.Name);
return $('<div/>').html(value)
$('body').append(resHTML);   
```
<span data-ttu-id="c2ebc-468">Não use `innerHtml`; em vez disso, use `innerText`.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-468">Don't use `innerHtml`; instead use `innerText`.</span></span> <span data-ttu-id="c2ebc-469">Da mesma forma, em vez de `$("#elm").html()`, use `$("#elm").text()`</span><span class="sxs-lookup"><span data-stu-id="c2ebc-469">Similarly, instead of `$("#elm").html()`, use `$("#elm").text()`</span></span> 

## <span data-ttu-id="c2ebc-470"><a id="redirect-safe"></a>Validar todos os redirecionamentos de dentro do aplicativo hello serão fechados ou feitos com segurança</span><span class="sxs-lookup"><span data-stu-id="c2ebc-470"><a id="redirect-safe"></a>Validate all redirects within hello application are closed or done safely</span></span>

| <span data-ttu-id="c2ebc-471">Title</span><span class="sxs-lookup"><span data-stu-id="c2ebc-471">Title</span></span>                   | <span data-ttu-id="c2ebc-472">Detalhes</span><span class="sxs-lookup"><span data-stu-id="c2ebc-472">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="c2ebc-473">**Componente**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-473">**Component**</span></span>               | <span data-ttu-id="c2ebc-474">Aplicativo Web</span><span class="sxs-lookup"><span data-stu-id="c2ebc-474">Web Application</span></span> | 
| <span data-ttu-id="c2ebc-475">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-475">**SDL Phase**</span></span>               | <span data-ttu-id="c2ebc-476">Compilação</span><span class="sxs-lookup"><span data-stu-id="c2ebc-476">Build</span></span> |  
| <span data-ttu-id="c2ebc-477">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-477">**Applicable Technologies**</span></span> | <span data-ttu-id="c2ebc-478">Genérico</span><span class="sxs-lookup"><span data-stu-id="c2ebc-478">Generic</span></span> |
| <span data-ttu-id="c2ebc-479">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-479">**Attributes**</span></span>              | <span data-ttu-id="c2ebc-480">N/D</span><span class="sxs-lookup"><span data-stu-id="c2ebc-480">N/A</span></span>  |
| <span data-ttu-id="c2ebc-481">**Referências**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-481">**References**</span></span>              | [<span data-ttu-id="c2ebc-482">Olá estrutura de autorização do OAuth 2.0 - redirecionadores aberto</span><span class="sxs-lookup"><span data-stu-id="c2ebc-482">hello OAuth 2.0 Authorization Framework - Open Redirectors</span></span>](http://tools.ietf.org/html/rfc6749#section-10.15) |
| <span data-ttu-id="c2ebc-483">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-483">**Steps**</span></span> | <p><span data-ttu-id="c2ebc-484">Exigir tooa fornecido pelo usuário local de redirecionamento de design do aplicativo deve restringir Olá redirecionamento possíveis destinos tooa "seguro" lista predefinida de sites ou domínios.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-484">Application design requiring redirection tooa user-supplied location must constrain hello possible redirection targets tooa predefined "safe" list of sites or domains.</span></span> <span data-ttu-id="c2ebc-485">Todos os redirecionamentos no aplicativo hello devem ser fechado/safe.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-485">All redirects in hello application must be closed/safe.</span></span></p><p><span data-ttu-id="c2ebc-486">toodo isso:</span><span class="sxs-lookup"><span data-stu-id="c2ebc-486">toodo this:</span></span></p><ul><li><span data-ttu-id="c2ebc-487">Identificar todos os redirecionamentos</span><span class="sxs-lookup"><span data-stu-id="c2ebc-487">Identify all redirects</span></span></li><li><span data-ttu-id="c2ebc-488">Implemente uma atenuação apropriada para cada tipo de redirecionamento.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-488">Implement an appropriate mitigation for each redirect.</span></span> <span data-ttu-id="c2ebc-489">Atenuações apropriadas incluem a confirmação de usuário ou a lista de permissões de redirecionamento.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-489">Appropriate mitigations include redirect whitelist or user confirmation.</span></span> <span data-ttu-id="c2ebc-490">Se um site ou serviço com uma vulnerabilidade de redirecionamento aberto usar provedores de identidade Facebook/OAuth/OpenID, um invasor poderá roubar o token de logon do usuário e representar o usuário.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-490">If a web site or service with an open redirect vulnerability uses Facebook/OAuth/OpenID identity providers, an attacker can steal a user's logon token and impersonate that user.</span></span> <span data-ttu-id="c2ebc-491">Este é um risco inerente ao usar o OAuth, que está documentada na RFC 6749 "Olá estrutura de autorização OAuth 2.0", seção 10.15 "abrir redireciona" da mesma forma, as credenciais do usuário podem ser comprometidas por ataques de phishing lança usando redirecionamentos abertos</span><span class="sxs-lookup"><span data-stu-id="c2ebc-491">This is an inherent risk when using OAuth, which is documented in RFC 6749 "hello OAuth 2.0 Authorization Framework", Section 10.15 "Open Redirects" Similarly, users' credentials can be compromised by spear phishing attacks using open redirects</span></span></li></ul>|

## <span data-ttu-id="c2ebc-492"><a id="string-method"></a>Implemente a validação de entrada em todos os parâmetros de tipo de cadeia de caracteres aceitos por métodos do Controlador</span><span class="sxs-lookup"><span data-stu-id="c2ebc-492"><a id="string-method"></a>Implement input validation on all string type parameters accepted by Controller methods</span></span>

| <span data-ttu-id="c2ebc-493">Title</span><span class="sxs-lookup"><span data-stu-id="c2ebc-493">Title</span></span>                   | <span data-ttu-id="c2ebc-494">Detalhes</span><span class="sxs-lookup"><span data-stu-id="c2ebc-494">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="c2ebc-495">**Componente**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-495">**Component**</span></span>               | <span data-ttu-id="c2ebc-496">Aplicativo Web</span><span class="sxs-lookup"><span data-stu-id="c2ebc-496">Web Application</span></span> | 
| <span data-ttu-id="c2ebc-497">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-497">**SDL Phase**</span></span>               | <span data-ttu-id="c2ebc-498">Compilação</span><span class="sxs-lookup"><span data-stu-id="c2ebc-498">Build</span></span> |  
| <span data-ttu-id="c2ebc-499">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-499">**Applicable Technologies**</span></span> | <span data-ttu-id="c2ebc-500">Genérico, MVC5, MVC6</span><span class="sxs-lookup"><span data-stu-id="c2ebc-500">Generic, MVC5, MVC6</span></span> |
| <span data-ttu-id="c2ebc-501">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-501">**Attributes**</span></span>              | <span data-ttu-id="c2ebc-502">N/D</span><span class="sxs-lookup"><span data-stu-id="c2ebc-502">N/A</span></span>  |
| <span data-ttu-id="c2ebc-503">**Referências**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-503">**References**</span></span>              | <span data-ttu-id="c2ebc-504">[Validando dados de modelo em um aplicativo MVC](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx), [Princípios básicos para aplicativos ASP.NET MVC](http://msdn.microsoft.com/magazine/dd942822.aspx)</span><span class="sxs-lookup"><span data-stu-id="c2ebc-504">[Validating Model Data in an MVC Application](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx), [Guiding Principles For Your ASP.NET MVC Applications](http://msdn.microsoft.com/magazine/dd942822.aspx)</span></span> |
| <span data-ttu-id="c2ebc-505">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-505">**Steps**</span></span> | <span data-ttu-id="c2ebc-506">Para métodos que aceitam apenas o tipo de dados primitivo e não modelos como argumento, a validação de entrada deve ser feita usando a Expressão Regular.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-506">For methods that just accept primitive data type, and not models as argument,input validation using Regular Expression should be done.</span></span> <span data-ttu-id="c2ebc-507">Aqui, Regex.IsMatch deve ser usado com um padrão de regex válido.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-507">Here Regex.IsMatch should be used with a valid regex pattern.</span></span> <span data-ttu-id="c2ebc-508">Se não corresponder a entrada hello Olá Expressão Regular especificada, controle não deve continuar e deve ser exibido um aviso adequado sobre falha de validação.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-508">If hello input doesn't match hello specified Regular Expression, control should not proceed further, and an adequate warning regarding validation failure should be displayed.</span></span>| 

## <span data-ttu-id="c2ebc-509"><a id="dos-expression"></a>Definir tempo limite de limite superior de expressão regular de processamento DoS tooprevent devido a expressões regulares toobad</span><span class="sxs-lookup"><span data-stu-id="c2ebc-509"><a id="dos-expression"></a>Set upper limit timeout for regular expression processing tooprevent DoS due toobad regular expressions</span></span>

| <span data-ttu-id="c2ebc-510">Title</span><span class="sxs-lookup"><span data-stu-id="c2ebc-510">Title</span></span>                   | <span data-ttu-id="c2ebc-511">Detalhes</span><span class="sxs-lookup"><span data-stu-id="c2ebc-511">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="c2ebc-512">**Componente**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-512">**Component**</span></span>               | <span data-ttu-id="c2ebc-513">Aplicativo Web</span><span class="sxs-lookup"><span data-stu-id="c2ebc-513">Web Application</span></span> | 
| <span data-ttu-id="c2ebc-514">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-514">**SDL Phase**</span></span>               | <span data-ttu-id="c2ebc-515">Compilação</span><span class="sxs-lookup"><span data-stu-id="c2ebc-515">Build</span></span> |  
| <span data-ttu-id="c2ebc-516">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-516">**Applicable Technologies**</span></span> | <span data-ttu-id="c2ebc-517">Genérico, Formulários da Web, MVC5, MVC6</span><span class="sxs-lookup"><span data-stu-id="c2ebc-517">Generic, Web Forms, MVC5, MVC6</span></span>  |
| <span data-ttu-id="c2ebc-518">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-518">**Attributes**</span></span>              | <span data-ttu-id="c2ebc-519">N/D</span><span class="sxs-lookup"><span data-stu-id="c2ebc-519">N/A</span></span>  |
| <span data-ttu-id="c2ebc-520">**Referências**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-520">**References**</span></span>              | [<span data-ttu-id="c2ebc-521">Propriedade DefaultRegexMatchTimeout</span><span class="sxs-lookup"><span data-stu-id="c2ebc-521">DefaultRegexMatchTimeout Property </span></span>](https://msdn.microsoft.com/library/system.web.configuration.httpruntimesection.defaultregexmatchtimeout.aspx) |
| <span data-ttu-id="c2ebc-522">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-522">**Steps**</span></span> | <span data-ttu-id="c2ebc-523">tooensure ataques de negação de serviço contra mal criado expressões regulares, o que fazer com que um lote de retrocesso, definir tempo limite padrão global de saudação.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-523">tooensure denial of service attacks against badly created regular expressions, that cause a lot of backtracking, set hello global default timeout.</span></span> <span data-ttu-id="c2ebc-524">Se o tempo de processamento de saudação demora mais do que Olá definido pelo limite superior, ele deve gerar uma exceção de tempo limite.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-524">If hello processing time takes longer than hello defined upper limit, it would throw a Timeout exception.</span></span> <span data-ttu-id="c2ebc-525">Se nada estiver configurado, o tempo limite de saudação seria infinito.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-525">If nothing is configured, hello timeout would be infinite.</span></span>| 

### <a name="example"></a><span data-ttu-id="c2ebc-526">Exemplo</span><span class="sxs-lookup"><span data-stu-id="c2ebc-526">Example</span></span>
<span data-ttu-id="c2ebc-527">Por exemplo, hello configuração a seguir lançará um RegexMatchTimeoutException, se o processamento de saudação demorar mais de 5 segundos:</span><span class="sxs-lookup"><span data-stu-id="c2ebc-527">For example, hello following configuration will throw a RegexMatchTimeoutException, if hello processing takes more than 5 seconds:</span></span> 

```C#
<httpRuntime targetFramework="4.5" defaultRegexMatchTimeout="00:00:05" />
```

## <span data-ttu-id="c2ebc-528"><a id="html-razor"></a>Evite usar Html.Raw nos modos de exibição do Razor</span><span class="sxs-lookup"><span data-stu-id="c2ebc-528"><a id="html-razor"></a>Avoid using Html.Raw in Razor views</span></span>

| <span data-ttu-id="c2ebc-529">Title</span><span class="sxs-lookup"><span data-stu-id="c2ebc-529">Title</span></span>                   | <span data-ttu-id="c2ebc-530">Detalhes</span><span class="sxs-lookup"><span data-stu-id="c2ebc-530">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="c2ebc-531">**Componente**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-531">**Component**</span></span>               | <span data-ttu-id="c2ebc-532">Aplicativo Web</span><span class="sxs-lookup"><span data-stu-id="c2ebc-532">Web Application</span></span> | 
| <span data-ttu-id="c2ebc-533">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-533">**SDL Phase**</span></span>               | <span data-ttu-id="c2ebc-534">Compilação</span><span class="sxs-lookup"><span data-stu-id="c2ebc-534">Build</span></span> |  
| <span data-ttu-id="c2ebc-535">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-535">**Applicable Technologies**</span></span> | <span data-ttu-id="c2ebc-536">MVC5, MVC6</span><span class="sxs-lookup"><span data-stu-id="c2ebc-536">MVC5, MVC6</span></span> |
| <span data-ttu-id="c2ebc-537">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-537">**Attributes**</span></span>              | <span data-ttu-id="c2ebc-538">N/D</span><span class="sxs-lookup"><span data-stu-id="c2ebc-538">N/A</span></span>  |
| <span data-ttu-id="c2ebc-539">**Referências**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-539">**References**</span></span>              | <span data-ttu-id="c2ebc-540">N/D</span><span class="sxs-lookup"><span data-stu-id="c2ebc-540">N/A</span></span>  |
| <span data-ttu-id="c2ebc-541">Etapa</span><span class="sxs-lookup"><span data-stu-id="c2ebc-541">Step</span></span> | <span data-ttu-id="c2ebc-542">Páginas da Web do ASP.Net (Razor) executam a codificação HTML automática.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-542">ASP.Net WebPages (Razor) perform automatic HTML encoding.</span></span> <span data-ttu-id="c2ebc-543">Todas as cadeias de caracteres impressas por nuggets de código inserido (blocos @) são codificadas em HTML automaticamente.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-543">All strings printed by embedded code nuggets (@ blocks) are automatically HTML-encoded.</span></span> <span data-ttu-id="c2ebc-544">No entanto, quando o método `HtmlHelper.Raw` é invocado, ele retorna uma marcação que não é codificada em HTML.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-544">However, when `HtmlHelper.Raw` Method is invoked, it returns markup that is not HTML encoded.</span></span> <span data-ttu-id="c2ebc-545">Se `Html.Raw()` método auxiliar é usado, ignora Olá proteção automática de codificação que fornece Razor.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-545">If `Html.Raw()` helper method is used, it bypasses hello automatic encoding protection that Razor provides.</span></span>|

### <a name="example"></a><span data-ttu-id="c2ebc-546">Exemplo</span><span class="sxs-lookup"><span data-stu-id="c2ebc-546">Example</span></span>
<span data-ttu-id="c2ebc-547">A seguir está um exemplo não seguro:</span><span class="sxs-lookup"><span data-stu-id="c2ebc-547">Following is an insecure example:</span></span> 

```C#
<div class="form-group">
            @Html.Raw(Model.AccountConfirmText)
        </div>
        <div class="form-group">
            @Html.Raw(Model.PaymentConfirmText)
        </div>
</div>
```
<span data-ttu-id="c2ebc-548">Não use `Html.Raw()` , a menos que você precisa toodisplay marcação.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-548">Do not use `Html.Raw()` unless you need toodisplay markup.</span></span> <span data-ttu-id="c2ebc-549">Esse método não executa implicitamente a codificação de saída.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-549">This method does not perform output encoding implicitly.</span></span> <span data-ttu-id="c2ebc-550">Use outros auxiliares do ASP.NET; por exemplo, `@Html.DisplayFor()`</span><span class="sxs-lookup"><span data-stu-id="c2ebc-550">Use other ASP.NET helpers e.g., `@Html.DisplayFor()`</span></span> 

## <span data-ttu-id="c2ebc-551"><a id="stored-proc"></a>Não use consultas dinâmicas em procedimentos armazenados</span><span class="sxs-lookup"><span data-stu-id="c2ebc-551"><a id="stored-proc"></a>Do not use dynamic queries in stored procedures</span></span>

| <span data-ttu-id="c2ebc-552">Title</span><span class="sxs-lookup"><span data-stu-id="c2ebc-552">Title</span></span>                   | <span data-ttu-id="c2ebc-553">Detalhes</span><span class="sxs-lookup"><span data-stu-id="c2ebc-553">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="c2ebc-554">**Componente**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-554">**Component**</span></span>               | <span data-ttu-id="c2ebc-555">Banco de dados</span><span class="sxs-lookup"><span data-stu-id="c2ebc-555">Database</span></span> | 
| <span data-ttu-id="c2ebc-556">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-556">**SDL Phase**</span></span>               | <span data-ttu-id="c2ebc-557">Compilação</span><span class="sxs-lookup"><span data-stu-id="c2ebc-557">Build</span></span> |  
| <span data-ttu-id="c2ebc-558">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-558">**Applicable Technologies**</span></span> | <span data-ttu-id="c2ebc-559">Genérico</span><span class="sxs-lookup"><span data-stu-id="c2ebc-559">Generic</span></span> |
| <span data-ttu-id="c2ebc-560">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-560">**Attributes**</span></span>              | <span data-ttu-id="c2ebc-561">N/D</span><span class="sxs-lookup"><span data-stu-id="c2ebc-561">N/A</span></span>  |
| <span data-ttu-id="c2ebc-562">**Referências**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-562">**References**</span></span>              | <span data-ttu-id="c2ebc-563">N/D</span><span class="sxs-lookup"><span data-stu-id="c2ebc-563">N/A</span></span>  |
| <span data-ttu-id="c2ebc-564">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-564">**Steps**</span></span> | <p><span data-ttu-id="c2ebc-565">Um ataque de injeção de SQL explora vulnerabilidades em comandos arbitrários de toorun de validação de entrada no banco de dados de saudação.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-565">A SQL injection attack exploits vulnerabilities in input validation toorun arbitrary commands in hello database.</span></span> <span data-ttu-id="c2ebc-566">Pode ocorrer quando o aplicativo usa a entrada tooconstruct dinâmico tooaccess de instruções SQL Olá banco de dados.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-566">It can occur when your application uses input tooconstruct dynamic SQL statements tooaccess hello database.</span></span> <span data-ttu-id="c2ebc-567">Isso também poderá ocorrer se o código usar procedimentos armazenados que sejam cadeias de caracteres passadas que contenham entrada bruta do usuário.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-567">It can also occur if your code uses stored procedures that are passed strings that contain raw user input.</span></span> <span data-ttu-id="c2ebc-568">Usando Olá ataque de injeção de SQL, invasor Olá pode executar comandos arbitrários no banco de dados de saudação.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-568">Using hello SQL injection attack, hello attacker can execute arbitrary commands in hello database.</span></span> <span data-ttu-id="c2ebc-569">Todas as instruções SQL (incluindo instruções SQL de saudação em procedimentos armazenados) devem ser parametrizadas.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-569">All SQL statements (including hello SQL statements in stored procedures) must be parameterized.</span></span> <span data-ttu-id="c2ebc-570">Instruções SQL parametrizadas aceitará caracteres que têm significado especial a tooSQL (como uma aspa simples) sem problemas porque eles são fortemente tipados.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-570">Parameterized SQL statements will accept characters that have special meaning tooSQL (like single quote) without problems because they are strongly typed.</span></span> |

### <a name="example"></a><span data-ttu-id="c2ebc-571">Exemplo</span><span class="sxs-lookup"><span data-stu-id="c2ebc-571">Example</span></span>
<span data-ttu-id="c2ebc-572">A seguir está um exemplo de Procedimento Armazenado dinâmico não seguro:</span><span class="sxs-lookup"><span data-stu-id="c2ebc-572">Following is an example of insecure dynamic Stored Procedure:</span></span> 

```C#
CREATE PROCEDURE [dbo].[uspGetProductsByCriteria]
(
  @productName nvarchar(200) = NULL,
  @startPrice float = NULL,
  @endPrice float = NULL
)
AS
 BEGIN
  DECLARE @sql nvarchar(max)
  SELECT @sql = ' SELECT ProductID, ProductName, Description, UnitPrice, ImagePath' +
       ' FROM dbo.Products WHERE 1 = 1 '
       PRINT @sql
  IF @productName IS NOT NULL
     SELECT @sql = @sql + ' AND ProductName LIKE ''%' + @productName + '%'''
  IF @startPrice IS NOT NULL
     SELECT @sql = @sql + ' AND UnitPrice > ''' + CONVERT(VARCHAR(10),@startPrice) + ''''
  IF @endPrice IS NOT NULL
     SELECT @sql = @sql + ' AND UnitPrice < ''' + CONVERT(VARCHAR(10),@endPrice) + ''''

  PRINT @sql
  EXEC(@sql)
 END
```

### <a name="example"></a><span data-ttu-id="c2ebc-573">Exemplo</span><span class="sxs-lookup"><span data-stu-id="c2ebc-573">Example</span></span>
<span data-ttu-id="c2ebc-574">A seguir é hello mesmo procedimento armazenado com segurança implementado:</span><span class="sxs-lookup"><span data-stu-id="c2ebc-574">Following is hello same stored procedure implemented securely:</span></span> 
```C#
CREATE PROCEDURE [dbo].[uspGetProductsByCriteriaSecure]
(
             @productName nvarchar(200) = NULL,
             @startPrice float = NULL,
             @endPrice float = NULL
)
AS
       BEGIN
             SELECT ProductID, ProductName, Description, UnitPrice, ImagePath
             FROM dbo.Products where
             (@productName IS NULL or ProductName like '%'+ @productName +'%')
             AND
             (@startPrice IS NULL or UnitPrice > @startPrice)
             AND
             (@endPrice IS NULL or UnitPrice < @endPrice)         
       END
```

## <span data-ttu-id="c2ebc-575"><a id="validation-api"></a>Verifique se a validação do modelo é feita nos métodos de API Web</span><span class="sxs-lookup"><span data-stu-id="c2ebc-575"><a id="validation-api"></a>Ensure that model validation is done on Web API methods</span></span>

| <span data-ttu-id="c2ebc-576">Title</span><span class="sxs-lookup"><span data-stu-id="c2ebc-576">Title</span></span>                   | <span data-ttu-id="c2ebc-577">Detalhes</span><span class="sxs-lookup"><span data-stu-id="c2ebc-577">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="c2ebc-578">**Componente**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-578">**Component**</span></span>               | <span data-ttu-id="c2ebc-579">API Web</span><span class="sxs-lookup"><span data-stu-id="c2ebc-579">Web API</span></span> | 
| <span data-ttu-id="c2ebc-580">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-580">**SDL Phase**</span></span>               | <span data-ttu-id="c2ebc-581">Compilação</span><span class="sxs-lookup"><span data-stu-id="c2ebc-581">Build</span></span> |  
| <span data-ttu-id="c2ebc-582">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-582">**Applicable Technologies**</span></span> | <span data-ttu-id="c2ebc-583">MVC5, MVC6</span><span class="sxs-lookup"><span data-stu-id="c2ebc-583">MVC5, MVC6</span></span> |
| <span data-ttu-id="c2ebc-584">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-584">**Attributes**</span></span>              | <span data-ttu-id="c2ebc-585">N/D</span><span class="sxs-lookup"><span data-stu-id="c2ebc-585">N/A</span></span>  |
| <span data-ttu-id="c2ebc-586">**Referências**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-586">**References**</span></span>              | [<span data-ttu-id="c2ebc-587">Validação de modelo na API Web ASP.NET</span><span class="sxs-lookup"><span data-stu-id="c2ebc-587">Model Validation in ASP.NET Web API </span></span>](http://www.asp.net/web-api/overview/formats-and-model-binding/model-validation-in-aspnet-web-api) |
| <span data-ttu-id="c2ebc-588">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-588">**Steps**</span></span> | <span data-ttu-id="c2ebc-589">Quando um cliente envia a API da web de tooa dados, são obrigatórias toovalidate Olá dados antes de executar qualquer processamento.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-589">When a client sends data tooa web API, it is mandatory toovalidate hello data before doing any processing.</span></span> <span data-ttu-id="c2ebc-590">Para APIs da Web ASP.NET que aceitam modelos como entrada, use as anotações de dados em regras de validação de tooset modelos nas propriedades de saudação do modelo de saudação.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-590">For ASP.NET Web APIs which accept models as input, use data annotations on models tooset validation rules on hello properties of hello model.</span></span>|

### <a name="example"></a><span data-ttu-id="c2ebc-591">Exemplo</span><span class="sxs-lookup"><span data-stu-id="c2ebc-591">Example</span></span>
<span data-ttu-id="c2ebc-592">saudação de código a seguir demonstra Olá mesmo:</span><span class="sxs-lookup"><span data-stu-id="c2ebc-592">hello following code demonstrates hello same:</span></span> 

```C#
using System.ComponentModel.DataAnnotations;

namespace MyApi.Models
{
    public class Product
    {
        public int Id { get; set; }
        [Required]
        [RegularExpression(@"^[a-zA-Z0-9]*$", ErrorMessage="Only alphanumeric characters are allowed.")]
        public string Name { get; set; }
        public decimal Price { get; set; }
        [Range(0, 999)]
        public double Weight { get; set; }
    }
}
```

### <a name="example"></a><span data-ttu-id="c2ebc-593">Exemplo</span><span class="sxs-lookup"><span data-stu-id="c2ebc-593">Example</span></span>
<span data-ttu-id="c2ebc-594">No método de ação de saudação dos controladores da API de hello, validade do modelo de saudação tem toobe explicitamente marcada como mostrado abaixo:</span><span class="sxs-lookup"><span data-stu-id="c2ebc-594">In hello action method of hello API controllers, validity of hello model has toobe explicitly checked as shown below:</span></span> 

```C#
namespace MyApi.Controllers
{
    public class ProductsController : ApiController
    {
        public HttpResponseMessage Post(Product product)
        {
            if (ModelState.IsValid)
            {
                // Do something with hello product (not shown).

                return new HttpResponseMessage(HttpStatusCode.OK);
            }
            else
            {
                return Request.CreateErrorResponse(HttpStatusCode.BadRequest, ModelState);
            }
        }
    }
}
```

## <span data-ttu-id="c2ebc-595"><a id="string-api"></a>Implemente a validação de entrada em todos os parâmetros de tipo de cadeia de caracteres aceitos pelos métodos de API Web</span><span class="sxs-lookup"><span data-stu-id="c2ebc-595"><a id="string-api"></a>Implement input validation on all string type parameters accepted by Web API methods</span></span>

| <span data-ttu-id="c2ebc-596">Title</span><span class="sxs-lookup"><span data-stu-id="c2ebc-596">Title</span></span>                   | <span data-ttu-id="c2ebc-597">Detalhes</span><span class="sxs-lookup"><span data-stu-id="c2ebc-597">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="c2ebc-598">**Componente**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-598">**Component**</span></span>               | <span data-ttu-id="c2ebc-599">API Web</span><span class="sxs-lookup"><span data-stu-id="c2ebc-599">Web API</span></span> | 
| <span data-ttu-id="c2ebc-600">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-600">**SDL Phase**</span></span>               | <span data-ttu-id="c2ebc-601">Compilação</span><span class="sxs-lookup"><span data-stu-id="c2ebc-601">Build</span></span> |  
| <span data-ttu-id="c2ebc-602">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-602">**Applicable Technologies**</span></span> | <span data-ttu-id="c2ebc-603">Genérico, MVC 5, MVC 6</span><span class="sxs-lookup"><span data-stu-id="c2ebc-603">Generic, MVC 5, MVC 6</span></span> |
| <span data-ttu-id="c2ebc-604">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-604">**Attributes**</span></span>              | <span data-ttu-id="c2ebc-605">N/D</span><span class="sxs-lookup"><span data-stu-id="c2ebc-605">N/A</span></span>  |
| <span data-ttu-id="c2ebc-606">**Referências**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-606">**References**</span></span>              | <span data-ttu-id="c2ebc-607">[Validando dados de modelo em um aplicativo MVC](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx), [Princípios básicos para aplicativos ASP.NET MVC](http://msdn.microsoft.com/magazine/dd942822.aspx)</span><span class="sxs-lookup"><span data-stu-id="c2ebc-607">[Validating Model Data in an MVC Application](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx), [Guiding Principles For Your ASP.NET MVC Applications](http://msdn.microsoft.com/magazine/dd942822.aspx)</span></span> |
| <span data-ttu-id="c2ebc-608">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-608">**Steps**</span></span> | <span data-ttu-id="c2ebc-609">Para métodos que aceitam apenas o tipo de dados primitivo e não modelos como argumento, a validação de entrada deve ser feita usando a Expressão Regular.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-609">For methods that just accept primitive data type, and not models as argument,input validation using Regular Expression should be done.</span></span> <span data-ttu-id="c2ebc-610">Aqui, Regex.IsMatch deve ser usado com um padrão de regex válido.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-610">Here Regex.IsMatch should be used with a valid regex pattern.</span></span> <span data-ttu-id="c2ebc-611">Se não corresponder a entrada hello Olá Expressão Regular especificada, controle não deve continuar e deve ser exibido um aviso adequado sobre falha de validação.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-611">If hello input doesn't match hello specified Regular Expression, control should not proceed further, and an adequate warning regarding validation failure should be displayed.</span></span>|

## <span data-ttu-id="c2ebc-612"><a id="typesafe-api"></a>Verifique se os parâmetros de tipo seguro são usados na API Web para acesso a dados</span><span class="sxs-lookup"><span data-stu-id="c2ebc-612"><a id="typesafe-api"></a>Ensure that type-safe parameters are used in Web API for data access</span></span>

| <span data-ttu-id="c2ebc-613">Title</span><span class="sxs-lookup"><span data-stu-id="c2ebc-613">Title</span></span>                   | <span data-ttu-id="c2ebc-614">Detalhes</span><span class="sxs-lookup"><span data-stu-id="c2ebc-614">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="c2ebc-615">**Componente**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-615">**Component**</span></span>               | <span data-ttu-id="c2ebc-616">API Web</span><span class="sxs-lookup"><span data-stu-id="c2ebc-616">Web API</span></span> | 
| <span data-ttu-id="c2ebc-617">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-617">**SDL Phase**</span></span>               | <span data-ttu-id="c2ebc-618">Compilação</span><span class="sxs-lookup"><span data-stu-id="c2ebc-618">Build</span></span> |  
| <span data-ttu-id="c2ebc-619">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-619">**Applicable Technologies**</span></span> | <span data-ttu-id="c2ebc-620">Genérico</span><span class="sxs-lookup"><span data-stu-id="c2ebc-620">Generic</span></span> |
| <span data-ttu-id="c2ebc-621">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-621">**Attributes**</span></span>              | <span data-ttu-id="c2ebc-622">N/D</span><span class="sxs-lookup"><span data-stu-id="c2ebc-622">N/A</span></span>  |
| <span data-ttu-id="c2ebc-623">**Referências**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-623">**References**</span></span>              | <span data-ttu-id="c2ebc-624">N/D</span><span class="sxs-lookup"><span data-stu-id="c2ebc-624">N/A</span></span>  |
| <span data-ttu-id="c2ebc-625">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-625">**Steps**</span></span> | <p><span data-ttu-id="c2ebc-626">Se você usar a coleção de parâmetros hello, SQL trata Olá entrada é como um valor literal e, em seguida, em vez disso, como código executável.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-626">If you use hello Parameters collection, SQL treats hello input is as a literal value rather then as executable code.</span></span> <span data-ttu-id="c2ebc-627">Olá coleção de parâmetros pode ser restrições de comprimento e tipo de tooenforce usado nos dados de entrada.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-627">hello Parameters collection can be used tooenforce type and length constraints on input data.</span></span> <span data-ttu-id="c2ebc-628">Valores fora do intervalo de saudação disparar uma exceção.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-628">Values outside of hello range trigger an exception.</span></span> <span data-ttu-id="c2ebc-629">Se não forem usados parâmetros SQL de tipo seguro, os invasores podem ser tooexecute capaz de ataques de injeção que são inseridos na entrada hello filtrada.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-629">If type-safe SQL parameters are not used, attackers might be able tooexecute injection attacks that are embedded in hello unfiltered input.</span></span></p><p><span data-ttu-id="c2ebc-630">Use parâmetros de tipo de segurança ao construir SQL consultas tooavoid possíveis ataques de injeção SQL que podem ocorrer com a entrada não filtrada.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-630">Use type safe parameters when constructing SQL queries tooavoid possible SQL injection attacks that can occur with unfiltered input.</span></span> <span data-ttu-id="c2ebc-631">Você pode usar parâmetros de tipo seguro com procedimentos armazenados e instruções SQL dinâmicas.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-631">You can use type safe parameters with stored procedures and with dynamic SQL statements.</span></span> <span data-ttu-id="c2ebc-632">Parâmetros são tratados como valores literais por banco de dados de saudação e não como código executável.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-632">Parameters are treated as literal values by hello database and not as executable code.</span></span> <span data-ttu-id="c2ebc-633">Os parâmetros também são verificados quanto ao tipo e ao tamanho.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-633">Parameters are also checked for type and length.</span></span></p>|

### <a name="example"></a><span data-ttu-id="c2ebc-634">Exemplo</span><span class="sxs-lookup"><span data-stu-id="c2ebc-634">Example</span></span>
<span data-ttu-id="c2ebc-635">Olá código a seguir mostra como toouse parâmetros de tipo seguros com hello SqlParameterCollection ao chamar um procedimento armazenado.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-635">hello following code shows how toouse type safe parameters with hello SqlParameterCollection when calling a stored procedure.</span></span> 

```C#
using System.Data;
using System.Data.SqlClient;

using (SqlConnection connection = new SqlConnection(connectionString))
{ 
DataSet userDataset = new DataSet(); 
SqlDataAdapter myCommand = new SqlDataAdapter(LoginStoredProcedure", connection); 
myCommand.SelectCommand.CommandType = CommandType.StoredProcedure; 
myCommand.SelectCommand.Parameters.Add("@au_id", SqlDbType.VarChar, 11); 
myCommand.SelectCommand.Parameters["@au_id"].Value = SSN.Text; 
myCommand.Fill(userDataset);
}  
```
<span data-ttu-id="c2ebc-636">Olá precede o exemplo de código, o valor de entrada hello não pode ser mais de 11 caracteres.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-636">In hello preceding code example, hello input value cannot be longer than 11 characters.</span></span> <span data-ttu-id="c2ebc-637">Se dados saudação não está de acordo com tipo de toohello ou o comprimento definido pelo parâmetro hello, Olá classe SqlParameter gera uma exceção.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-637">If hello data does not conform toohello type or length defined by hello parameter, hello SqlParameter class throws an exception.</span></span> 

## <span data-ttu-id="c2ebc-638"><a id="sql-docdb"></a>Usar consultas SQL parametrizadas no Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="c2ebc-638"><a id="sql-docdb"></a>Use parametrized SQL queries for Cosmos DB</span></span>

| <span data-ttu-id="c2ebc-639">Title</span><span class="sxs-lookup"><span data-stu-id="c2ebc-639">Title</span></span>                   | <span data-ttu-id="c2ebc-640">Detalhes</span><span class="sxs-lookup"><span data-stu-id="c2ebc-640">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="c2ebc-641">**Componente**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-641">**Component**</span></span>               | <span data-ttu-id="c2ebc-642">Azure Document DB</span><span class="sxs-lookup"><span data-stu-id="c2ebc-642">Azure Document DB</span></span> | 
| <span data-ttu-id="c2ebc-643">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-643">**SDL Phase**</span></span>               | <span data-ttu-id="c2ebc-644">Compilação</span><span class="sxs-lookup"><span data-stu-id="c2ebc-644">Build</span></span> |  
| <span data-ttu-id="c2ebc-645">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-645">**Applicable Technologies**</span></span> | <span data-ttu-id="c2ebc-646">Genérico</span><span class="sxs-lookup"><span data-stu-id="c2ebc-646">Generic</span></span> |
| <span data-ttu-id="c2ebc-647">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-647">**Attributes**</span></span>              | <span data-ttu-id="c2ebc-648">N/D</span><span class="sxs-lookup"><span data-stu-id="c2ebc-648">N/A</span></span>  |
| <span data-ttu-id="c2ebc-649">**Referências**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-649">**References**</span></span>              | [<span data-ttu-id="c2ebc-650">Anunciando a parametrização de SQL no DocumentDB</span><span class="sxs-lookup"><span data-stu-id="c2ebc-650">Announcing SQL Parameterization in DocumentDB</span></span>](https://azure.microsoft.com/blog/announcing-sql-parameterization-in-documentdb/) |
| <span data-ttu-id="c2ebc-651">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-651">**Steps**</span></span> | <span data-ttu-id="c2ebc-652">Embora o DocumentDB só dê suporte a consultas somente leitura, a injeção de SQL ainda será possível se as consultas forem construídas concatenando com a entrada do usuário.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-652">Although DocumentDB only supports read-only queries, SQL injection is still possible if queries are constructed by concatenating with user input.</span></span> <span data-ttu-id="c2ebc-653">Talvez seja possível para um usuário toogain acesso toodata que eles não devem estar acessando dentro Olá mesma coleção ao criar consultas SQL mal-intencionadas.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-653">It might be possible for a user toogain access toodata they shouldn’t be accessing within hello same collection by crafting malicious SQL queries.</span></span> <span data-ttu-id="c2ebc-654">Use consultas SQL parametrizadas se as consultas forem construídas com base na entrada do usuário.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-654">Use parameterized SQL queries if queries are constructed based on user input.</span></span> |

## <span data-ttu-id="c2ebc-655"><a id="schema-binding"></a>Validação de entrada de WCF por meio de associação de esquema</span><span class="sxs-lookup"><span data-stu-id="c2ebc-655"><a id="schema-binding"></a>WCF Input validation through Schema binding</span></span>

| <span data-ttu-id="c2ebc-656">Title</span><span class="sxs-lookup"><span data-stu-id="c2ebc-656">Title</span></span>                   | <span data-ttu-id="c2ebc-657">Detalhes</span><span class="sxs-lookup"><span data-stu-id="c2ebc-657">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="c2ebc-658">**Componente**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-658">**Component**</span></span>               | <span data-ttu-id="c2ebc-659">WCF</span><span class="sxs-lookup"><span data-stu-id="c2ebc-659">WCF</span></span> | 
| <span data-ttu-id="c2ebc-660">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-660">**SDL Phase**</span></span>               | <span data-ttu-id="c2ebc-661">Compilação</span><span class="sxs-lookup"><span data-stu-id="c2ebc-661">Build</span></span> |  
| <span data-ttu-id="c2ebc-662">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-662">**Applicable Technologies**</span></span> | <span data-ttu-id="c2ebc-663">Genérico, NET Framework 3</span><span class="sxs-lookup"><span data-stu-id="c2ebc-663">Generic, NET Framework 3</span></span> |
| <span data-ttu-id="c2ebc-664">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-664">**Attributes**</span></span>              | <span data-ttu-id="c2ebc-665">N/D</span><span class="sxs-lookup"><span data-stu-id="c2ebc-665">N/A</span></span>  |
| <span data-ttu-id="c2ebc-666">**Referências**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-666">**References**</span></span>              | [<span data-ttu-id="c2ebc-667">MSDN</span><span class="sxs-lookup"><span data-stu-id="c2ebc-667">MSDN</span></span>](https://msdn.microsoft.com/library/ff647820.aspx) |
| <span data-ttu-id="c2ebc-668">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-668">**Steps**</span></span> | <p><span data-ttu-id="c2ebc-669">Ausência de validação de clientes potenciais toodifferent ataques de injeção de tipo.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-669">Lack of validation leads toodifferent type injection attacks.</span></span></p><p><span data-ttu-id="c2ebc-670">Validação de mensagem representa uma linha de defesa na proteção de saudação do seu aplicativo do WCF.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-670">Message validation represents one line of defense in hello protection of your WCF application.</span></span> <span data-ttu-id="c2ebc-671">Com essa abordagem, você deve validar mensagens usando operações de serviço WCF esquemas tooprotect contra ataques de um cliente mal-intencionado.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-671">With this approach, you validate messages using schemas tooprotect WCF service operations from attack by a malicious client.</span></span> <span data-ttu-id="c2ebc-672">Valide todas as mensagens recebidas por Olá tooprotect Olá cliente contra ataques por um serviço mal-intencionado.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-672">Validate all messages received by hello client tooprotect hello client from attack by a malicious service.</span></span> <span data-ttu-id="c2ebc-673">Validação de mensagem torna possível toovalidate mensagens quando as operações de consumir contratos de mensagem ou contratos de dados, que não podem ser feitos usando a validação de parâmetro.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-673">Message validation makes it possible toovalidate messages when operations consume message contracts or data contracts, which cannot be done using parameter validation.</span></span> <span data-ttu-id="c2ebc-674">Validação de mensagem permite que você toocreate a lógica de validação dentro de esquemas, assim, fornecendo mais flexibilidade e reduzir o tempo de desenvolvimento.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-674">Message validation allows you toocreate validation logic inside schemas, thereby providing more flexibility and reducing development time.</span></span> <span data-ttu-id="c2ebc-675">Esquemas podem ser reutilizadas em diferentes aplicativos dentro da organização hello, criação de padrões para representação de dados.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-675">Schemas can be reused across different applications inside hello organization, creating standards for data representation.</span></span> <span data-ttu-id="c2ebc-676">Além disso, validação de mensagem permite operações tooprotect quando eles consomem tipos de dados mais complexos que envolvem contratos que representa a lógica de negócios.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-676">Additionally, message validation allows you tooprotect operations when they consume more complex data types involving contracts representing business logic.</span></span></p><p><span data-ttu-id="c2ebc-677">validação de mensagem tooperform, você cria um esquema que representa as operações de saudação de seus tipos de dados de serviço e hello consumidas por essas operações.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-677">tooperform message validation, you first build a schema that represents hello operations of your service and hello data types consumed by those operations.</span></span> <span data-ttu-id="c2ebc-678">Você criar uma classe .NET que implementa um Inspetor de mensagens do cliente personalizado e dispatcher personalizado Inspetor toovalidate Olá mensagens enviadas/recebidas de/para o serviço de saudação.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-678">You then create a .NET class that implements a custom client message inspector and custom dispatcher message inspector toovalidate hello messages sent/received to/from hello service.</span></span> <span data-ttu-id="c2ebc-679">Em seguida, você deve implementar uma validação de mensagem do ponto de extremidade personalizado comportamento tooenable no cliente hello e serviço hello.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-679">Next, you implement a custom endpoint behavior tooenable message validation on both hello client and hello service.</span></span> <span data-ttu-id="c2ebc-680">Finalmente, você implementa um elemento de configuração personalizada na classe Olá que permite que você tooexpose Olá estendidos comportamento de ponto de extremidade personalizado no arquivo de configuração de saudação do serviço de saudação ou cliente hello"</span><span class="sxs-lookup"><span data-stu-id="c2ebc-680">Finally, you implement a custom configuration element on hello class that allows you tooexpose hello extended custom endpoint behavior in hello configuration file of hello service or hello client"</span></span></p>|

## <span data-ttu-id="c2ebc-681"><a id="parameters"></a>Validação de entrada de WCF por meio de Inspetores de Parâmetro</span><span class="sxs-lookup"><span data-stu-id="c2ebc-681"><a id="parameters"></a>WCF- Input validation through Parameter Inspectors</span></span>

| <span data-ttu-id="c2ebc-682">Title</span><span class="sxs-lookup"><span data-stu-id="c2ebc-682">Title</span></span>                   | <span data-ttu-id="c2ebc-683">Detalhes</span><span class="sxs-lookup"><span data-stu-id="c2ebc-683">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="c2ebc-684">**Componente**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-684">**Component**</span></span>               | <span data-ttu-id="c2ebc-685">WCF</span><span class="sxs-lookup"><span data-stu-id="c2ebc-685">WCF</span></span> | 
| <span data-ttu-id="c2ebc-686">**Fase do SDL**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-686">**SDL Phase**</span></span>               | <span data-ttu-id="c2ebc-687">Compilação</span><span class="sxs-lookup"><span data-stu-id="c2ebc-687">Build</span></span> |  
| <span data-ttu-id="c2ebc-688">**Tecnologias aplicáveis**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-688">**Applicable Technologies**</span></span> | <span data-ttu-id="c2ebc-689">Genérico, NET Framework 3</span><span class="sxs-lookup"><span data-stu-id="c2ebc-689">Generic, NET Framework 3</span></span> |
| <span data-ttu-id="c2ebc-690">**Atributos**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-690">**Attributes**</span></span>              | <span data-ttu-id="c2ebc-691">N/D</span><span class="sxs-lookup"><span data-stu-id="c2ebc-691">N/A</span></span>  |
| <span data-ttu-id="c2ebc-692">**Referências**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-692">**References**</span></span>              | [<span data-ttu-id="c2ebc-693">MSDN</span><span class="sxs-lookup"><span data-stu-id="c2ebc-693">MSDN</span></span>](https://msdn.microsoft.com/library/ff647875.aspx) |
| <span data-ttu-id="c2ebc-694">**Etapas**</span><span class="sxs-lookup"><span data-stu-id="c2ebc-694">**Steps**</span></span> | <p><span data-ttu-id="c2ebc-695">Validação de entrada e de dados representa um importante de linha de defesa na proteção de saudação do seu aplicativo do WCF.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-695">Input and data validation represents one important line of defense in hello protection of your WCF application.</span></span> <span data-ttu-id="c2ebc-696">Você deve validar todos os parâmetros expostos no WCF operações tooprotect Olá serviço contra ataques por um cliente mal-intencionado.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-696">You should validate all parameters exposed in WCF service operations tooprotect hello service from attack by a malicious client.</span></span> <span data-ttu-id="c2ebc-697">Por outro lado, você também deve validar todos os valores de retorno recebidos pelo Olá tooprotect Olá cliente contra ataques por um serviço mal-intencionado</span><span class="sxs-lookup"><span data-stu-id="c2ebc-697">Conversely, you should also validate all return values received by hello client tooprotect hello client from attack by a malicious service</span></span></p><p><span data-ttu-id="c2ebc-698">O WCF fornece pontos de extensibilidade diferentes que permitem que você comportamento de tempo de execução toocustomize Olá WCF ao criar extensões personalizadas.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-698">WCF provides different extensibility points that allow you toocustomize hello WCF runtime behavior by creating custom extensions.</span></span> <span data-ttu-id="c2ebc-699">Inspetores e inspetores de parâmetro são dois mecanismos de extensibilidade de mensagem usada toogain maior controle sobre dados Olá passando entre um cliente e um serviço.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-699">Message Inspectors and Parameter Inspectors are two extensibility mechanisms used toogain greater control over hello data passing between a client and a service.</span></span> <span data-ttu-id="c2ebc-700">Você deve usar inspetores de parâmetro para validação de entrada e usar inspetores de mensagem somente quando precisar tooinspect Olá toda mensagem que fluem para dentro e fora de um serviço.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-700">You should use parameter inspectors for input validation and use message inspectors only when you need tooinspect hello entire message flowing in and out of a service.</span></span></p><p><span data-ttu-id="c2ebc-701">validação de entrada de tooperform, você criará uma classe do .NET e implementar um Inspetor de parâmetro personalizado em parâmetros de toovalidate ordem nas operações em seu serviço.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-701">tooperform input validation, you will build a .NET class and implement a custom parameter inspector in order toovalidate parameters on operations in your service.</span></span> <span data-ttu-id="c2ebc-702">Em seguida, implementar uma validação de tooenable do comportamento de ponto de extremidade personalizado no cliente hello e serviço hello.</span><span class="sxs-lookup"><span data-stu-id="c2ebc-702">You will then implement a custom endpoint behavior tooenable validation on both hello client and hello service.</span></span> <span data-ttu-id="c2ebc-703">Por fim, você implementará um elemento de configuração personalizada na classe Olá que permite que você tooexpose Olá estendidos comportamento de ponto de extremidade personalizado no arquivo de configuração de saudação do serviço de saudação ou cliente Olá</span><span class="sxs-lookup"><span data-stu-id="c2ebc-703">Finally, you will implement a custom configuration element on hello class that allows you tooexpose hello extended custom endpoint behavior in hello configuration file of hello service or hello client</span></span></p>|
