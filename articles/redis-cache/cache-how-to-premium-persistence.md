---
title: "persistência de dados de tooconfigure aaaHow para um Premium do Azure Redis Cache"
description: "Saiba como tooconfigure e gerenciar suas instâncias de Cache Redis do Azure Premium da camada de persistência de dados"
services: redis-cache
documentationcenter: 
author: steved0x
manager: douge
editor: 
ms.assetid: b01cf279-60a0-4711-8c5f-af22d9540d38
ms.service: cache
ms.workload: tbd
ms.tgt_pltfrm: cache-redis
ms.devlang: na
ms.topic: article
ms.date: 08/24/2017
ms.author: sdanie
ms.openlocfilehash: 62feb6f5522e0270487f045eb303bf852434143d
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="how-tooconfigure-data-persistence-for-a-premium-azure-redis-cache"></a><span data-ttu-id="741f4-103">Como tooconfigure a persistência de dados para um Premium do Azure Redis Cache</span><span class="sxs-lookup"><span data-stu-id="741f4-103">How tooconfigure data persistence for a Premium Azure Redis Cache</span></span>
<span data-ttu-id="741f4-104">Cache Redis do Azure tem diferentes ofertas de cache que fornecem flexibilidade na escolha de saudação do tamanho do cache e recursos, incluindo recursos de camada Premium, como clustering, persistência e suporte de rede virtual.</span><span class="sxs-lookup"><span data-stu-id="741f4-104">Azure Redis Cache has different cache offerings which provide flexibility in hello choice of cache size and features, including Premium tier features such as clustering, persistence, and virtual network support.</span></span> <span data-ttu-id="741f4-105">Este artigo descreve como tooconfigure persistência em uma premium do Azure Redis Cache de instância.</span><span class="sxs-lookup"><span data-stu-id="741f4-105">This article describes how tooconfigure persistence in a premium Azure Redis Cache instance.</span></span>

<span data-ttu-id="741f4-106">Para obter informações sobre outros recursos de cache premium, consulte [camada de Azure Redis Cache Premium Introdução toohello](cache-premium-tier-intro.md).</span><span class="sxs-lookup"><span data-stu-id="741f4-106">For information on other premium cache features, see [Introduction toohello Azure Redis Cache Premium tier](cache-premium-tier-intro.md).</span></span>

## <a name="what-is-data-persistence"></a><span data-ttu-id="741f4-107">O que é a persistência de dados?</span><span class="sxs-lookup"><span data-stu-id="741f4-107">What is data persistence?</span></span>
<span data-ttu-id="741f4-108">[Persistência de redis](https://redis.io/topics/persistence) permite que dados toopersist armazenados no Redis.</span><span class="sxs-lookup"><span data-stu-id="741f4-108">[Redis persistence](https://redis.io/topics/persistence) allows you toopersist data stored in Redis.</span></span> <span data-ttu-id="741f4-109">Você também pode tirar instantâneos e fazer backup de dados hello, que é possível carregar em caso de falha de hardware.</span><span class="sxs-lookup"><span data-stu-id="741f4-109">You can also take snapshots and back up hello data, which you can load in case of a hardware failure.</span></span> <span data-ttu-id="741f4-110">Isso é uma enorme vantagem sobre Basic ou camada padrão, onde todos os Olá dados é armazenada na memória e pode haver perda de dados em caso de falha quando os nós de Cache são para baixo.</span><span class="sxs-lookup"><span data-stu-id="741f4-110">This is a huge advantage over Basic or Standard tier where all hello data is stored in memory and there can be potential data loss in case of a failure where Cache nodes are down.</span></span> 

<span data-ttu-id="741f4-111">Cache Redis do Azure oferece a persistência de Redis usando Olá modelos a seguir:</span><span class="sxs-lookup"><span data-stu-id="741f4-111">Azure Redis Cache offers Redis persistence using hello following models:</span></span>

* <span data-ttu-id="741f4-112">**Persistência RDB** -persistência quando RDB (banco de dados Redis) é configurado, o Cache Redis do Azure persistir um instantâneo de cache do Redis Olá em um formato binário toodisk com base em uma frequência de backup configurável de Redis.</span><span class="sxs-lookup"><span data-stu-id="741f4-112">**RDB persistence** - When RDB (Redis database) persistence is configured, Azure Redis Cache persists a snapshot of hello Redis cache in a Redis binary format toodisk based on a configurable backup frequency.</span></span> <span data-ttu-id="741f4-113">Se um desastre ocorrer que desabilita Olá primário e o cache de réplica, cache Olá é reconstruído usando o instantâneo mais recente hello.</span><span class="sxs-lookup"><span data-stu-id="741f4-113">If a catastrophic event occurs that disables both hello primary and replica cache, hello cache is reconstructed using hello most recent snapshot.</span></span> <span data-ttu-id="741f4-114">Saiba mais sobre Olá [vantagens](https://redis.io/topics/persistence#rdb-advantages) e [desvantagens](https://redis.io/topics/persistence#rdb-disadvantages) de persistência RDB.</span><span class="sxs-lookup"><span data-stu-id="741f4-114">Learn more about hello [advantages](https://redis.io/topics/persistence#rdb-advantages) and [disadvantages](https://redis.io/topics/persistence#rdb-disadvantages) of RDB persistence.</span></span>
* <span data-ttu-id="741f4-115">**Persistência de AOF** -persistência quando AOF (arquivo somente de acréscimo) estiver configurada, o Cache Redis do Azure salva cada log de tooa de operação de gravação que é salvo pelo menos uma vez por segundo em uma conta de armazenamento do Azure.</span><span class="sxs-lookup"><span data-stu-id="741f4-115">**AOF persistence** - When AOF (Append only file) persistence is configured, Azure Redis Cache saves every write operation tooa log that is saved at least once per second into an Azure Storage account.</span></span> <span data-ttu-id="741f4-116">Se um desastre ocorrer que desabilita Olá primário e o cache de réplica, cache Olá será reconstruída usando operações de gravação da saudação armazenada.</span><span class="sxs-lookup"><span data-stu-id="741f4-116">If a catastrophic event occurs that disables both hello primary and replica cache, hello cache is reconstructed using hello stored write operations.</span></span> <span data-ttu-id="741f4-117">Saiba mais sobre Olá [vantagens](https://redis.io/topics/persistence#aof-advantages) e [desvantagens](https://redis.io/topics/persistence#aof-disadvantages) de persistência de AOF.</span><span class="sxs-lookup"><span data-stu-id="741f4-117">Learn more about hello [advantages](https://redis.io/topics/persistence#aof-advantages) and [disadvantages](https://redis.io/topics/persistence#aof-disadvantages) of AOF persistence.</span></span>

<span data-ttu-id="741f4-118">Persistência é configurada da saudação **novo Cache Redis** folha durante a criação do cache e em Olá **menu recursos** para premium existente armazena em cache.</span><span class="sxs-lookup"><span data-stu-id="741f4-118">Persistence is configured from hello **New Redis Cache** blade during cache creation and on hello **Resource menu** for existing premium caches.</span></span>

[!INCLUDE [redis-cache-create](../../includes/redis-cache-premium-create.md)]

<span data-ttu-id="741f4-119">Depois de selecionar um tipo de preço premium, clique em **Persistência do Redis**.</span><span class="sxs-lookup"><span data-stu-id="741f4-119">Once a premium pricing tier is selected, click **Redis persistence**.</span></span>

![Persistência do Redis][redis-cache-persistence]

<span data-ttu-id="741f4-121">Olá etapas na próxima seção, Olá descrevem como tooconfigure Redis persistência em seu novo cache premium.</span><span class="sxs-lookup"><span data-stu-id="741f4-121">hello steps in hello next section describe how tooconfigure Redis persistence on your new premium cache.</span></span> <span data-ttu-id="741f4-122">Após configurar a persistência do Redis, clique em **criar** toocreate premium seu novo cache com a persistência de Redis.</span><span class="sxs-lookup"><span data-stu-id="741f4-122">Once Redis persistence is configured, click **Create** toocreate your new premium cache with Redis persistence.</span></span>

## <a name="enable-redis-persistence"></a><span data-ttu-id="741f4-123">Habilitar a persistência de Redis</span><span class="sxs-lookup"><span data-stu-id="741f4-123">Enable Redis persistence</span></span>

<span data-ttu-id="741f4-124">Redis persistência está ativada Olá **Redis a persistência de dados** folha escolhendo um **RDB** ou **AOF** persistência.</span><span class="sxs-lookup"><span data-stu-id="741f4-124">Redis persistence is enabled on hello **Redis data persistence** blade by choosing either **RDB** or **AOF** persistence.</span></span> <span data-ttu-id="741f4-125">Para novos caches, esta folha é acessada durante o processo de criação do cache hello, conforme descrito na seção anterior hello.</span><span class="sxs-lookup"><span data-stu-id="741f4-125">For new caches, this blade is accessed during hello cache creation process, as described in hello previous section.</span></span> <span data-ttu-id="741f4-126">Para caches existentes, Olá **Redis a persistência de dados** folha é acessada de saudação **menu recursos** para seu cache.</span><span class="sxs-lookup"><span data-stu-id="741f4-126">For existing caches, hello **Redis data persistence** blade is accessed from hello **Resource menu** for your cache.</span></span>

![Configurações do Redis][redis-cache-settings]


## <a name="configure-rdb-persistence"></a><span data-ttu-id="741f4-128">Configurar a persistência de RDB</span><span class="sxs-lookup"><span data-stu-id="741f4-128">Configure RDB persistence</span></span>

<span data-ttu-id="741f4-129">persistência de RDB tooenable, clique em **RDB**.</span><span class="sxs-lookup"><span data-stu-id="741f4-129">tooenable RDB persistence, click **RDB**.</span></span> <span data-ttu-id="741f4-130">persistência de RDB toodisable em um cache premium habilitado anteriormente, clique em **desabilitado**.</span><span class="sxs-lookup"><span data-stu-id="741f4-130">toodisable RDB persistence on a previously enabled premium cache, click **Disabled**.</span></span>

![Persistência de RDB Redis][redis-cache-rdb-persistence]

<span data-ttu-id="741f4-132">tooconfigure Olá intervalo de backup, selecione um **frequência de Backup** da lista suspensa de saudação.</span><span class="sxs-lookup"><span data-stu-id="741f4-132">tooconfigure hello backup interval, select a **Backup Frequency** from hello drop-down list.</span></span> <span data-ttu-id="741f4-133">As opções incluem **15 minutos**, **30 minutos**, **60 minutos**, **6 horas**, **12 horas** e **24 horas**.</span><span class="sxs-lookup"><span data-stu-id="741f4-133">Choices include **15 Minutes**, **30 minutes**, **60 minutes**, **6 hours**, **12 hours**, and **24 hours**.</span></span> <span data-ttu-id="741f4-134">Esse intervalo inicia a contagem regressiva após a conclusão bem-sucedida da operação de backup anterior hello e quando ele expira, um novo backup é iniciado.</span><span class="sxs-lookup"><span data-stu-id="741f4-134">This interval starts counting down after hello previous backup operation successfully completes and when it elapses a new backup is initiated.</span></span>

<span data-ttu-id="741f4-135">Clique em **conta de armazenamento** tooselect Olá toouse da conta de armazenamento e escolha qualquer Olá **chave primária** ou **chave secundária** toouse de saudação **armazenamento Chave** lista suspensa.</span><span class="sxs-lookup"><span data-stu-id="741f4-135">Click **Storage Account** tooselect hello storage account toouse, and choose either hello **Primary key** or **Secondary key** toouse from hello **Storage Key** drop-down.</span></span> <span data-ttu-id="741f4-136">Você deve escolher uma conta de armazenamento no hello mesma região que o cache de Olá e um **armazenamento Premium** conta é recomendada porque o armazenamento premium tem maior taxa de transferência.</span><span class="sxs-lookup"><span data-stu-id="741f4-136">You must choose a storage account in hello same region as hello cache, and a **Premium Storage** account is recommended because premium storage has higher throughput.</span></span> 

> [!IMPORTANT]
> <span data-ttu-id="741f4-137">Se a chave de armazenamento de saudação para sua conta de persistência é regenerada, reconfigure a tecla desejada Olá de saudação **chave de armazenamento** lista suspensa.</span><span class="sxs-lookup"><span data-stu-id="741f4-137">If hello storage key for your persistence account is regenerated, you must reconfigure hello desired key from hello **Storage Key** drop-down.</span></span>
> 
> 

<span data-ttu-id="741f4-138">Clique em **Okey** toosave configuração de persistência de saudação.</span><span class="sxs-lookup"><span data-stu-id="741f4-138">Click **OK** toosave hello persistence configuration.</span></span>

<span data-ttu-id="741f4-139">próximo backup Hello (ou primeiro backup para novos caches) é iniciado depois que o intervalo de frequência de backup de saudação expira.</span><span class="sxs-lookup"><span data-stu-id="741f4-139">hello next backup (or first backup for new caches) is initiated once hello backup frequency interval elapses.</span></span>

## <a name="configure-aof-persistence"></a><span data-ttu-id="741f4-140">Configurar a persistência de AOF</span><span class="sxs-lookup"><span data-stu-id="741f4-140">Configure AOF persistence</span></span>

<span data-ttu-id="741f4-141">persistência de AOF tooenable, clique em **AOF**.</span><span class="sxs-lookup"><span data-stu-id="741f4-141">tooenable AOF persistence, click **AOF**.</span></span> <span data-ttu-id="741f4-142">persistência de AOF toodisable em um cache premium habilitado anteriormente, clique em **desabilitado**.</span><span class="sxs-lookup"><span data-stu-id="741f4-142">toodisable AOF persistence on a previously enabled premium cache, click **Disabled**.</span></span>

![Persistência de AOF de Redis][redis-cache-aof-persistence]

<span data-ttu-id="741f4-144">persistência de AOF tooconfigure, especifique um **primeira conta de armazenamento**.</span><span class="sxs-lookup"><span data-stu-id="741f4-144">tooconfigure AOF persistence, specify a **First Storage Account**.</span></span> <span data-ttu-id="741f4-145">Esta conta de armazenamento deve estar no hello mesma região que o cache de Olá e um **armazenamento Premium** conta é recomendada porque o armazenamento premium tem maior taxa de transferência.</span><span class="sxs-lookup"><span data-stu-id="741f4-145">This storage account must be in hello same region as hello cache, and a **Premium Storage** account is recommended because premium storage has higher throughput.</span></span> <span data-ttu-id="741f4-146">Como opção, você pode configurar uma conta de armazenamento adicional denominada **Segunda Conta de Armazenamento**.</span><span class="sxs-lookup"><span data-stu-id="741f4-146">You can optionally configure an additional storage account named **Second Storage Account**.</span></span> <span data-ttu-id="741f4-147">Se uma segunda conta de armazenamento é configurada, hello gravações toohello réplica cache são gravados toothis segunda conta de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="741f4-147">If a second storage account is configured, hello writes toohello replica cache are written toothis second storage account.</span></span> <span data-ttu-id="741f4-148">Para cada conta de armazenamento configurado, escolher o hello **chave primária** ou **chave secundária** toouse de saudação **chave de armazenamento** lista suspensa.</span><span class="sxs-lookup"><span data-stu-id="741f4-148">For each configured storage account, choose either hello **Primary key** or **Secondary key** toouse from hello **Storage Key** drop-down.</span></span> 

> [!IMPORTANT]
> <span data-ttu-id="741f4-149">Se a chave de armazenamento de saudação para sua conta de persistência é regenerada, reconfigure a tecla desejada Olá de saudação **chave de armazenamento** lista suspensa.</span><span class="sxs-lookup"><span data-stu-id="741f4-149">If hello storage key for your persistence account is regenerated, you must reconfigure hello desired key from hello **Storage Key** drop-down.</span></span>
> 
> 

<span data-ttu-id="741f4-150">Quando a persistência de AOF está habilitada, grave o cache de toohello operações são salvos toohello designado a conta de armazenamento (ou contas, se você tiver configurado uma segunda conta de armazenamento).</span><span class="sxs-lookup"><span data-stu-id="741f4-150">When AOF persistence is enabled, write operations toohello cache are saved toohello designated storage account (or accounts if you have configured a second storage account).</span></span> <span data-ttu-id="741f4-151">No evento de saudação de uma falha catastrófica que leva para baixo ambos Olá primário e cache de réplica, hello armazenado AOF log é usado toorebuild cache de saudação.</span><span class="sxs-lookup"><span data-stu-id="741f4-151">In hello event of a catastrophic failure that takes down both hello primary and replica cache, hello stored AOF log is used toorebuild hello cache.</span></span>

## <a name="persistence-faq"></a><span data-ttu-id="741f4-152">Perguntas frequentes sobre persistência</span><span class="sxs-lookup"><span data-stu-id="741f4-152">Persistence FAQ</span></span>
<span data-ttu-id="741f4-153">Olá lista a seguir contém as respostas toocommonly perguntas frequentes sobre a persistência de Cache Redis do Azure.</span><span class="sxs-lookup"><span data-stu-id="741f4-153">hello following list contains answers toocommonly asked questions about Azure Redis Cache persistence.</span></span>

* [<span data-ttu-id="741f4-154">Posso habilitar a persistência em um cache criado anteriormente?</span><span class="sxs-lookup"><span data-stu-id="741f4-154">Can I enable persistence on a previously created cache?</span></span>](#can-i-enable-persistence-on-a-previously-created-cache)
* [<span data-ttu-id="741f4-155">Posso habilitar persistência AOF e RDB em Olá simultaneamente?</span><span class="sxs-lookup"><span data-stu-id="741f4-155">Can I enable AOF and RDB persistence at hello same time?</span></span>](#can-i-enable-aof-and-rdb-persistence-at-the-same-time)
* [<span data-ttu-id="741f4-156">Qual modelo de persistência eu devo escolher?</span><span class="sxs-lookup"><span data-stu-id="741f4-156">Which persistence model should I choose?</span></span>](#which-persistence-model-should-i-choose)
* [<span data-ttu-id="741f4-157">O que acontece se eu tiver dimensionado tooa um tamanho diferente e um backup é restaurado que foi feita antes da operação de dimensionamento de Olá?</span><span class="sxs-lookup"><span data-stu-id="741f4-157">What happens if I have scaled tooa different size and a backup is restored that was made before hello scaling operation?</span></span>](#what-happens-if-i-have-scaled-to-a-different-size-and-a-backup-is-restored-that-was-made-before-the-scaling-operation)


### <a name="rdb-persistence"></a><span data-ttu-id="741f4-158">Persistência de RDB</span><span class="sxs-lookup"><span data-stu-id="741f4-158">RDB persistence</span></span>
* [<span data-ttu-id="741f4-159">Pode alterar o frequência de backup Olá RDB depois de criar cache Olá?</span><span class="sxs-lookup"><span data-stu-id="741f4-159">Can I change hello RDB backup frequency after I create hello cache?</span></span>](#can-i-change-the-rdb-backup-frequency-after-i-create-the-cache)
* [<span data-ttu-id="741f4-160">Por que quando eu tenho uma frequência de backup de RDB de 60 minutos há mais de 60 minutos entre os backups?</span><span class="sxs-lookup"><span data-stu-id="741f4-160">Why if I have an RDB backup frequency of 60 minutes there is more than 60 minutes between backups?</span></span>](#why-if-i-have-an-rdb-backup-frequency-of-60-minutes-there-is-more-than-60-minutes-between-backups)
* [<span data-ttu-id="741f4-161">O que acontece toohello backups RDB antigos, quando um novo backup é feito?</span><span class="sxs-lookup"><span data-stu-id="741f4-161">What happens toohello old RDB backups when a new backup is made?</span></span>](#what-happens-to-the-old-rdb-backups-when-a-new-backup-is-made)

### <a name="aof-persistence"></a><span data-ttu-id="741f4-162">Persistência de AOF</span><span class="sxs-lookup"><span data-stu-id="741f4-162">AOF persistence</span></span>
* [<span data-ttu-id="741f4-163">Quando devo usar uma segunda conta de armazenamento?</span><span class="sxs-lookup"><span data-stu-id="741f4-163">When should I use a second storage account?</span></span>](#when-should-i-use-a-second-storage-account)
* [<span data-ttu-id="741f4-164">A persistência de AOF afeta a taxa de transferência, latência ou desempenho de meu cache?</span><span class="sxs-lookup"><span data-stu-id="741f4-164">Does AOF persistence affect throughout, latency, or performance of my cache?</span></span>](#does-aof-persistence-affect-throughout-latency-or-performance-of-my-cache)
* [<span data-ttu-id="741f4-165">Como remover a segunda conta de armazenamento Olá?</span><span class="sxs-lookup"><span data-stu-id="741f4-165">How can I remove hello second storage account?</span></span>](#how-can-i-remove-the-second-storage-account)
* [<span data-ttu-id="741f4-166">O que é uma regravação e como ela afeta meu cache?</span><span class="sxs-lookup"><span data-stu-id="741f4-166">What is a rewrite and how does it affect my cache?</span></span>](#what-is-a-rewrite-and-how-does-it-affect-my-cache)
* [<span data-ttu-id="741f4-167">O que devo esperar ao dimensionar um cache com o AOF habilitado?</span><span class="sxs-lookup"><span data-stu-id="741f4-167">What should I expect when scaling a cache with AOF enabled?</span></span>](#what-should-i-expect-when-scaling-a-cache-with-aof-enabled)
* [<span data-ttu-id="741f4-168">Como os dados de AOF são organizados no armazenamento?</span><span class="sxs-lookup"><span data-stu-id="741f4-168">How is my AOF data organized in storage?</span></span>](#how-is-my-aof-data-organized-in-storage)


### <a name="can-i-enable-persistence-on-a-previously-created-cache"></a><span data-ttu-id="741f4-169">Posso habilitar a persistência em um cache criado anteriormente?</span><span class="sxs-lookup"><span data-stu-id="741f4-169">Can I enable persistence on a previously created cache?</span></span>
<span data-ttu-id="741f4-170">Sim, a persistência do Redis pode ser configurada na criação do cache e em caches premium existentes.</span><span class="sxs-lookup"><span data-stu-id="741f4-170">Yes, Redis persistence can be configured both at cache creation and on existing premium caches.</span></span>

### <a name="can-i-enable-aof-and-rdb-persistence-at-hello-same-time"></a><span data-ttu-id="741f4-171">Posso habilitar persistência AOF e RDB em Olá simultaneamente?</span><span class="sxs-lookup"><span data-stu-id="741f4-171">Can I enable AOF and RDB persistence at hello same time?</span></span>

<span data-ttu-id="741f4-172">Não, você pode habilitar apenas RDB ou AOF, mas não ambos ao Olá simultaneamente.</span><span class="sxs-lookup"><span data-stu-id="741f4-172">No, you can enable only RDB or AOF, but not both at hello same time.</span></span>

### <a name="which-persistence-model-should-i-choose"></a><span data-ttu-id="741f4-173">Qual modelo de persistência eu devo escolher?</span><span class="sxs-lookup"><span data-stu-id="741f4-173">Which persistence model should I choose?</span></span>

<span data-ttu-id="741f4-174">Persistência de AOF salva cada gravação tooa log, que tem algum impacto na taxa de transferência, em comparação com RDB persistência que salva os backups com base no hello configurado intervalo de backup, com impacto mínimo no desempenho.</span><span class="sxs-lookup"><span data-stu-id="741f4-174">AOF persistence saves every write tooa log, which has some impact on throughput, compared with RDB persistence which saves backups based on hello configured backup interval, with minimal impact on performance.</span></span> <span data-ttu-id="741f4-175">Escolha persistência AOF se seu principal objetivo é toominimize perda de dados, e você pode manipular uma diminuição na taxa de transferência para seu cache.</span><span class="sxs-lookup"><span data-stu-id="741f4-175">Choose AOF persistence if your primary goal is toominimize data loss, and you can handle a decrease in throughput for your cache.</span></span> <span data-ttu-id="741f4-176">Escolha persistência RDB se você deseja que a taxa de transferência ideal toomaintain em seu cache, mas ainda deseja um mecanismo de recuperação de dados.</span><span class="sxs-lookup"><span data-stu-id="741f4-176">Choose RDB persistence if you wish toomaintain optimal throughput on your cache, but still want a mechanism for data recovery.</span></span>

* <span data-ttu-id="741f4-177">Saiba mais sobre Olá [vantagens](https://redis.io/topics/persistence#rdb-advantages) e [desvantagens](https://redis.io/topics/persistence#rdb-disadvantages) de persistência RDB.</span><span class="sxs-lookup"><span data-stu-id="741f4-177">Learn more about hello [advantages](https://redis.io/topics/persistence#rdb-advantages) and [disadvantages](https://redis.io/topics/persistence#rdb-disadvantages) of RDB persistence.</span></span>
* <span data-ttu-id="741f4-178">Saiba mais sobre Olá [vantagens](https://redis.io/topics/persistence#aof-advantages) e [desvantagens](https://redis.io/topics/persistence#aof-disadvantages) de persistência de AOF.</span><span class="sxs-lookup"><span data-stu-id="741f4-178">Learn more about hello [advantages](https://redis.io/topics/persistence#aof-advantages) and [disadvantages](https://redis.io/topics/persistence#aof-disadvantages) of AOF persistence.</span></span>

<span data-ttu-id="741f4-179">Para saber mais sobre o desempenho ao usar a persistência de AOF, veja [A persistência de AOF afeta a taxa de transferência, latência ou desempenho de meu cache?](#does-aof-persistence-affect-throughout-latency-or-performance-of-my-cache)</span><span class="sxs-lookup"><span data-stu-id="741f4-179">For more information on performance when using AOF persistence, see [Does AOF persistence affect throughout, latency, or performance of my cache?](#does-aof-persistence-affect-throughout-latency-or-performance-of-my-cache)</span></span>

### <a name="what-happens-if-i-have-scaled-tooa-different-size-and-a-backup-is-restored-that-was-made-before-hello-scaling-operation"></a><span data-ttu-id="741f4-180">O que acontece se eu tiver dimensionado tooa um tamanho diferente e um backup é restaurado que foi feita antes da operação de dimensionamento de Olá?</span><span class="sxs-lookup"><span data-stu-id="741f4-180">What happens if I have scaled tooa different size and a backup is restored that was made before hello scaling operation?</span></span>

<span data-ttu-id="741f4-181">Para a persistência de RDB e AOF:</span><span class="sxs-lookup"><span data-stu-id="741f4-181">For both RDB and AOF persistence:</span></span>

* <span data-ttu-id="741f4-182">Se você tiver dimensionado tooa maior tamanho, não há nenhum impacto.</span><span class="sxs-lookup"><span data-stu-id="741f4-182">If you have scaled tooa larger size, there is no impact.</span></span>
* <span data-ttu-id="741f4-183">Se tiver dimensionado tooa menor e você tem um personalizado [bancos de dados](cache-configure.md#databases) configuração é maior do que Olá [limite de bancos de dados](cache-configure.md#databases) para o novo tamanho, os dados nesses bancos de dados não for restaurados.</span><span class="sxs-lookup"><span data-stu-id="741f4-183">If you have scaled tooa smaller size, and you have a custom [databases](cache-configure.md#databases) setting that is greater than hello [databases limit](cache-configure.md#databases) for your new size, data in those databases isn't restored.</span></span> <span data-ttu-id="741f4-184">Para obter mais informações, consulte [A configuração dos meus bancos de dados personalizados é afetada durante o dimensionamento?](cache-how-to-scale.md#is-my-custom-databases-setting-affected-during-scaling)</span><span class="sxs-lookup"><span data-stu-id="741f4-184">For more information, see [Is my custom databases setting affected during scaling?](cache-how-to-scale.md#is-my-custom-databases-setting-affected-during-scaling)</span></span>
* <span data-ttu-id="741f4-185">Se tiver dimensionado tooa menor e não há espaço suficiente no hello menor tamanho toohold todos os dados de saudação de chaves de backup, última Olá serão removidos durante o processo de restauração hello, normalmente usando Olá [allkeys lru](http://redis.io/topics/lru-cache) remoção diretiva.</span><span class="sxs-lookup"><span data-stu-id="741f4-185">If you have scaled tooa smaller size, and there isn't enough room in hello smaller size toohold all of hello data from hello last backup, keys will be evicted during hello restore process, typically using hello [allkeys-lru](http://redis.io/topics/lru-cache) eviction policy.</span></span>

### <a name="can-i-change-hello-rdb-backup-frequency-after-i-create-hello-cache"></a><span data-ttu-id="741f4-186">Pode alterar o frequência de backup Olá RDB depois de criar cache Olá?</span><span class="sxs-lookup"><span data-stu-id="741f4-186">Can I change hello RDB backup frequency after I create hello cache?</span></span>
<span data-ttu-id="741f4-187">Sim, você pode alterar a frequência de backup de saudação de persistência RDB Olá **Redis a persistência de dados** folha.</span><span class="sxs-lookup"><span data-stu-id="741f4-187">Yes, you can change hello backup frequency for RDB persistence on hello **Redis data persistence** blade.</span></span> <span data-ttu-id="741f4-188">Para obter instruções, consulte [Configurar persistência do Redis](#configure-redis-persistence).</span><span class="sxs-lookup"><span data-stu-id="741f4-188">For instructions, see [Configure Redis persistence](#configure-redis-persistence).</span></span>

### <a name="why-if-i-have-an-rdb-backup-frequency-of-60-minutes-there-is-more-than-60-minutes-between-backups"></a><span data-ttu-id="741f4-189">Por que quando eu tenho uma frequência de backup de RDB de 60 minutos há mais de 60 minutos entre os backups?</span><span class="sxs-lookup"><span data-stu-id="741f4-189">Why if I have an RDB backup frequency of 60 minutes there is more than 60 minutes between backups?</span></span>
<span data-ttu-id="741f4-190">intervalo de frequência de backup de persistência de RDB saudação não inicia até que o processo de backup anterior Olá foi concluída com êxito.</span><span class="sxs-lookup"><span data-stu-id="741f4-190">hello RDB persistence backup frequency interval does not start until hello previous backup process has completed successfully.</span></span> <span data-ttu-id="741f4-191">Se frequência de backup Olá é 60 minutos e leva um toosuccessfully de 15 minutos do processo de backup completo, o próximo backup de saudação não iniciará até 75 minutos após Olá hora de início do backup anterior de saudação.</span><span class="sxs-lookup"><span data-stu-id="741f4-191">If hello backup frequency is 60 minutes and it takes a backup process 15 minutes toosuccessfully complete, hello next backup won't start until 75 minutes after hello start time of hello previous backup.</span></span>

### <a name="what-happens-toohello-old-rdb-backups-when-a-new-backup-is-made"></a><span data-ttu-id="741f4-192">O que acontece toohello backups RDB antigos, quando um novo backup é feito?</span><span class="sxs-lookup"><span data-stu-id="741f4-192">What happens toohello old RDB backups when a new backup is made?</span></span>
<span data-ttu-id="741f4-193">Todos os backups de persistência RDB exceto hello mais recente são excluídos automaticamente.</span><span class="sxs-lookup"><span data-stu-id="741f4-193">All RDB persistence backups except for hello most recent one are automatically deleted.</span></span> <span data-ttu-id="741f4-194">Essa exclusão pode não acontecer imediatamente, mas os backups mais antigos não são persistidos por tempo indeterminado.</span><span class="sxs-lookup"><span data-stu-id="741f4-194">This deletion may not happen immediately but older backups are not persisted indefinitely.</span></span>


### <a name="when-should-i-use-a-second-storage-account"></a><span data-ttu-id="741f4-195">Quando devo usar uma segunda conta de armazenamento?</span><span class="sxs-lookup"><span data-stu-id="741f4-195">When should I use a second storage account?</span></span>

<span data-ttu-id="741f4-196">Você deve usar uma segunda conta de armazenamento para a persistência de AOF quando você acreditar que você tem maior do que as operações de conjunto esperado no cache de saudação.</span><span class="sxs-lookup"><span data-stu-id="741f4-196">You should use a second storage account for AOF persistence when you believe you have higher than expected set operations on hello cache.</span></span>  <span data-ttu-id="741f4-197">Configurar conta de armazenamento secundário Olá ajuda a garantir que o cache não atinja os limites de largura de banda de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="741f4-197">Setting up hello secondary storage account helps ensure your cache doesn't reach storage bandwidth limits.</span></span>

### <a name="does-aof-persistence-affect-throughout-latency-or-performance-of-my-cache"></a><span data-ttu-id="741f4-198">A persistência de AOF afeta a taxa de transferência, latência ou desempenho de meu cache?</span><span class="sxs-lookup"><span data-stu-id="741f4-198">Does AOF persistence affect throughout, latency, or performance of my cache?</span></span>

<span data-ttu-id="741f4-199">Persistência AOF afeta a taxa de transferência por aproximadamente 15 a 20% ao cache hello está abaixo de carga máxima (CPU e carga do servidor ambos em 90%).</span><span class="sxs-lookup"><span data-stu-id="741f4-199">AOF persistence affects throughput by about 15% – 20% when hello cache is below maximum load (CPU and Server Load both under 90%).</span></span> <span data-ttu-id="741f4-200">Não deve haver problemas de latência quando cache Olá estiver dentro desses limites.</span><span class="sxs-lookup"><span data-stu-id="741f4-200">There should not be latency issues when hello cache is within these limits.</span></span> <span data-ttu-id="741f4-201">No entanto, o cache de saudação alcançará esses limites mais cedo com AOF habilitado.</span><span class="sxs-lookup"><span data-stu-id="741f4-201">However, hello cache will reach these limits sooner with AOF enabled.</span></span>

### <a name="how-can-i-remove-hello-second-storage-account"></a><span data-ttu-id="741f4-202">Como remover a segunda conta de armazenamento Olá?</span><span class="sxs-lookup"><span data-stu-id="741f4-202">How can I remove hello second storage account?</span></span>

<span data-ttu-id="741f4-203">Você pode remover a conta de armazenamento secundário Olá AOF persistência definindo a conta de armazenamento segundo Olá toobe Olá mesmo como conta de armazenamento primeiro hello.</span><span class="sxs-lookup"><span data-stu-id="741f4-203">You can remove hello AOF persistence secondary storage account by setting hello second storage account toobe hello same as hello first storage account.</span></span> <span data-ttu-id="741f4-204">Para obter instruções, veja [Configurar a persistência de AOF](#configure-aof-persistence).</span><span class="sxs-lookup"><span data-stu-id="741f4-204">For instructions, see [Configure AOF persistence](#configure-aof-persistence).</span></span>

### <a name="what-is-a-rewrite-and-how-does-it-affect-my-cache"></a><span data-ttu-id="741f4-205">O que é uma regravação e como ela afeta meu cache?</span><span class="sxs-lookup"><span data-stu-id="741f4-205">What is a rewrite and how does it affect my cache?</span></span>

<span data-ttu-id="741f4-206">Quando o arquivo AOF Olá se torna grande o suficiente, uma reescrita é automaticamente em fila em cache hello.</span><span class="sxs-lookup"><span data-stu-id="741f4-206">When hello AOF file becomes large enough, a rewrite is automatically queued on hello cache.</span></span> <span data-ttu-id="741f4-207">Olá reconfiguração redimensiona Olá AOF arquivo com o conjunto mínimo de saudação operações necessárias toocreate Olá atual do conjunto de dados.</span><span class="sxs-lookup"><span data-stu-id="741f4-207">hello rewrite resizes hello AOF file with hello minimal set of operations needed toocreate hello current data set.</span></span> <span data-ttu-id="741f4-208">Durante a recriação, espere tooreach limites de desempenho mais cedo, especialmente ao lidar com grandes conjuntos de dados.</span><span class="sxs-lookup"><span data-stu-id="741f4-208">During rewrites, expect tooreach performance limits sooner especially when dealing with large datasets.</span></span> <span data-ttu-id="741f4-209">Regravações menor ocorrerem com frequência como arquivo AOF Olá fica maior, mas terá uma quantidade significativa de tempo quando isso acontece.</span><span class="sxs-lookup"><span data-stu-id="741f4-209">Rewrites occur less often as hello AOF file becomes larger, but will take a significant amount of time when it happens.</span></span>

### <a name="what-should-i-expect-when-scaling-a-cache-with-aof-enabled"></a><span data-ttu-id="741f4-210">O que devo esperar ao dimensionar um cache com o AOF habilitado?</span><span class="sxs-lookup"><span data-stu-id="741f4-210">What should I expect when scaling a cache with AOF enabled?</span></span>

<span data-ttu-id="741f4-211">Se o arquivo AOF Olá no tempo de saudação do dimensionamento é muito grande, em seguida, espere hello mais do que o esperado, pois será ele ser recarregar arquivo hello após dimensionamento de tootake de operação de escala.</span><span class="sxs-lookup"><span data-stu-id="741f4-211">If hello AOF file at hello time of scaling is significantly large, then expect hello scale operation tootake longer than expected since it will be reloading hello file after scaling has finished.</span></span>

<span data-ttu-id="741f4-212">Para obter mais informações sobre dimensionamento, consulte [o que acontece se eu tiver dimensionado tooa um tamanho diferente e um backup é restaurado que foi feita antes da operação de dimensionamento de Olá?](#what-happens-if-i-have-scaled-to-a-different-size-and-a-backup-is-restored-that-was-made-before-the-scaling-operation)</span><span class="sxs-lookup"><span data-stu-id="741f4-212">For more information on scaling, see [What happens if I have scaled tooa different size and a backup is restored that was made before hello scaling operation?](#what-happens-if-i-have-scaled-to-a-different-size-and-a-backup-is-restored-that-was-made-before-the-scaling-operation)</span></span>

### <a name="how-is-my-aof-data-organized-in-storage"></a><span data-ttu-id="741f4-213">Como os dados de AOF são organizados no armazenamento?</span><span class="sxs-lookup"><span data-stu-id="741f4-213">How is my AOF data organized in storage?</span></span>

<span data-ttu-id="741f4-214">Dados armazenados em arquivos AOF são divididos em vários blobs de página por desempenho tooincrease de salvar Olá dados toostorage.</span><span class="sxs-lookup"><span data-stu-id="741f4-214">Data stored in AOF files is divided into multiple page blobs per node tooincrease performance of saving hello data toostorage.</span></span> <span data-ttu-id="741f4-215">Olá seguinte tabela exibe quantos blobs de página são usados para cada tipo de preço:</span><span class="sxs-lookup"><span data-stu-id="741f4-215">hello following table displays how many page blobs are used for each pricing tier:</span></span>

| <span data-ttu-id="741f4-216">Camada premium</span><span class="sxs-lookup"><span data-stu-id="741f4-216">Premium tier</span></span> | <span data-ttu-id="741f4-217">Blobs</span><span class="sxs-lookup"><span data-stu-id="741f4-217">Blobs</span></span> |
|--------------|-------|
| <span data-ttu-id="741f4-218">P1</span><span class="sxs-lookup"><span data-stu-id="741f4-218">P1</span></span>           | <span data-ttu-id="741f4-219">4 por fragmento</span><span class="sxs-lookup"><span data-stu-id="741f4-219">4 per shard</span></span>    |
| <span data-ttu-id="741f4-220">P2</span><span class="sxs-lookup"><span data-stu-id="741f4-220">P2</span></span>           | <span data-ttu-id="741f4-221">8 por fragmento</span><span class="sxs-lookup"><span data-stu-id="741f4-221">8 per shard</span></span>    |
| <span data-ttu-id="741f4-222">P3</span><span class="sxs-lookup"><span data-stu-id="741f4-222">P3</span></span>           | <span data-ttu-id="741f4-223">16 por fragmento</span><span class="sxs-lookup"><span data-stu-id="741f4-223">16 per shard</span></span>   |
| <span data-ttu-id="741f4-224">P4</span><span class="sxs-lookup"><span data-stu-id="741f4-224">P4</span></span>           | <span data-ttu-id="741f4-225">20 por fragmento</span><span class="sxs-lookup"><span data-stu-id="741f4-225">20 per shard</span></span>   |

<span data-ttu-id="741f4-226">Quando o cluster estiver habilitado, cada fragmento no cache de saudação tem seu próprio conjunto de blobs de página, conforme indicado na tabela anterior hello.</span><span class="sxs-lookup"><span data-stu-id="741f4-226">When clustering is enabled, each shard in hello cache has its own set of page blobs, as indicated in hello previous table.</span></span> <span data-ttu-id="741f4-227">Por exemplo, um cache de P2 com três fragmentos distribui seu arquivo AOF em 24 blobs de páginas (oito blobs por fragmento, com três fragmentos).</span><span class="sxs-lookup"><span data-stu-id="741f4-227">For example, a P2 cache with three shards distributes its AOF file across 24 page blobs (8 blobs per shard, with 3 shards).</span></span>

<span data-ttu-id="741f4-228">Após uma regeneração, dois conjuntos de arquivos AOF existirão no armazenamento.</span><span class="sxs-lookup"><span data-stu-id="741f4-228">After a rewrite, two sets of AOF files exist in storage.</span></span> <span data-ttu-id="741f4-229">Regravações ocorrem no plano de fundo hello e acrescente toohello primeiro conjunto de arquivos, enquanto as operações de conjunto que são enviadas toohello cache durante a regravação da saudação acrescentam toohello segundo conjunto.</span><span class="sxs-lookup"><span data-stu-id="741f4-229">Rewrites occur in hello background and append toohello first set of files, while set operations that are sent toohello cache during hello rewrite append toohello second set.</span></span> <span data-ttu-id="741f4-230">Um backup é armazenado temporariamente durante regenerações no caso de falha, mas é excluída imediatamente após a conclusão de uma regeneração.</span><span class="sxs-lookup"><span data-stu-id="741f4-230">A backup is temporarily stored during rewrites in case of failure, but is promptly deleted after a rewrite finishes.</span></span>


## <a name="next-steps"></a><span data-ttu-id="741f4-231">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="741f4-231">Next steps</span></span>
<span data-ttu-id="741f4-232">Saiba como toouse premium mais recursos de cache.</span><span class="sxs-lookup"><span data-stu-id="741f4-232">Learn how toouse more premium cache features.</span></span>

* [<span data-ttu-id="741f4-233">Camada de Azure Redis Cache Premium toohello Introdução</span><span class="sxs-lookup"><span data-stu-id="741f4-233">Introduction toohello Azure Redis Cache Premium tier</span></span>](cache-premium-tier-intro.md)

<!-- IMAGES -->

[redis-cache-premium-pricing-tier]: ./media/cache-how-to-premium-persistence/redis-cache-premium-pricing-tier.png

[redis-cache-persistence]: ./media/cache-how-to-premium-persistence/redis-cache-persistence.png

[redis-cache-rdb-persistence]: ./media/cache-how-to-premium-persistence/redis-cache-rdb-persistence.png

[redis-cache-aof-persistence]: ./media/cache-how-to-premium-persistence/redis-cache-aof-persistence.png

[redis-cache-settings]: ./media/cache-how-to-premium-persistence/redis-cache-settings.png
