---
title: aaaConfigure uma rede Virtual para um Premium do Azure Redis Cache | Microsoft Docs
description: "Saiba como toocreate e gerenciar o suporte de rede Virtual para suas instâncias de Cache Redis do Azure Premium da camada"
services: redis-cache
documentationcenter: 
author: steved0x
manager: douge
editor: 
ms.assetid: 8b1e43a0-a70e-41e6-8994-0ac246d8bf7f
ms.service: cache
ms.workload: tbd
ms.tgt_pltfrm: cache-redis
ms.devlang: na
ms.topic: article
ms.date: 05/15/2017
ms.author: sdanie
ms.openlocfilehash: fab715f4d9365ee4c2f8b89d2e2e58768c25b671
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="how-tooconfigure-virtual-network-support-for-a-premium-azure-redis-cache"></a><span data-ttu-id="3b6f1-103">Como tooconfigure dar suporte a rede Virtual para um Premium do Azure Redis Cache</span><span class="sxs-lookup"><span data-stu-id="3b6f1-103">How tooconfigure Virtual Network Support for a Premium Azure Redis Cache</span></span>
<span data-ttu-id="3b6f1-104">Cache Redis do Azure tem diferentes ofertas de cache, que fornecem flexibilidade na escolha de saudação do tamanho do cache e recursos, incluindo recursos de camada Premium, como clustering, persistência e suporte de rede virtual.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-104">Azure Redis Cache has different cache offerings, which provide flexibility in hello choice of cache size and features, including Premium tier features such as clustering, persistence, and virtual network support.</span></span> <span data-ttu-id="3b6f1-105">Uma rede virtual é uma rede privada na nuvem hello.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-105">A VNet is a private network in hello cloud.</span></span> <span data-ttu-id="3b6f1-106">Quando uma instância de Cache Redis do Azure é configurada com uma rede virtual, não é publicamente endereçável e só pode ser acessado de máquinas virtuais e aplicativos em redes de saudação.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-106">When an Azure Redis Cache instance is configured with a VNet, it is not publicly addressable and can only be accessed from virtual machines and applications within hello VNet.</span></span> <span data-ttu-id="3b6f1-107">Este artigo descreve como dar suporte a rede virtual tooconfigure para uma instância de Cache Redis do Azure premium.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-107">This article describes how tooconfigure virtual network support for a premium Azure Redis Cache instance.</span></span>

> [!NOTE]
> <span data-ttu-id="3b6f1-108">O Cache Redis do Azure dá suporte a VNets clássicas e do Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-108">Azure Redis Cache supports both classic and Resource Manager VNets.</span></span>
> 
> 

<span data-ttu-id="3b6f1-109">Para obter informações sobre outros recursos de cache premium, consulte [camada de Azure Redis Cache Premium Introdução toohello](cache-premium-tier-intro.md).</span><span class="sxs-lookup"><span data-stu-id="3b6f1-109">For information on other premium cache features, see [Introduction toohello Azure Redis Cache Premium tier](cache-premium-tier-intro.md).</span></span>

## <a name="why-vnet"></a><span data-ttu-id="3b6f1-110">Por que a VNet?</span><span class="sxs-lookup"><span data-stu-id="3b6f1-110">Why VNet?</span></span>
<span data-ttu-id="3b6f1-111">[Rede Virtual do Azure (VNet)](https://azure.microsoft.com/services/virtual-network/) implantação oferece maior segurança e isolamento para Cache Redis do Azure, bem como as sub-redes, políticas de controle de acesso, e outros recursos toofurther restringir o acesso.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-111">[Azure Virtual Network (VNet)](https://azure.microsoft.com/services/virtual-network/) deployment provides enhanced security and isolation for your Azure Redis Cache, as well as subnets, access control policies, and other features toofurther restrict access.</span></span>

## <a name="virtual-network-support"></a><span data-ttu-id="3b6f1-112">Suporte de rede virtual</span><span class="sxs-lookup"><span data-stu-id="3b6f1-112">Virtual network support</span></span>
<span data-ttu-id="3b6f1-113">Suporte de rede virtual está configurado no hello **novo Cache Redis** folha durante a criação do cache.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-113">Virtual Network (VNet) support is configured on hello **New Redis Cache** blade during cache creation.</span></span> 

[!INCLUDE [redis-cache-create](../../includes/redis-cache-premium-create.md)]

<span data-ttu-id="3b6f1-114">Depois que você tiver selecionado um preço premium, você pode configurar a integração da VNet Redis selecionando uma rede virtual que está em Olá mesma assinatura e local que o cache.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-114">Once you have selected a premium pricing tier, you can configure Redis VNet integration by selecting a VNet that is in hello same subscription and location as your cache.</span></span> <span data-ttu-id="3b6f1-115">toouse uma nova rede virtual, criá-lo pela primeira vez, seguindo as etapas de saudação em [criar uma rede virtual usando o portal do Azure de saudação](../virtual-network/virtual-networks-create-vnet-arm-pportal.md) ou [criar uma rede virtual (clássica) usando o portal do Azure de saudação](../virtual-network/virtual-networks-create-vnet-classic-pportal.md) e, em seguida, retornar toohello **Novo Cache Redis** toocreate de folha e configure seu cache premium.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-115">toouse a new VNet, create it first by following hello steps in [Create a virtual network using hello Azure portal](../virtual-network/virtual-networks-create-vnet-arm-pportal.md) or [Create a virtual network (classic) by using hello Azure portal](../virtual-network/virtual-networks-create-vnet-classic-pportal.md) and then return toohello **New Redis Cache** blade toocreate and configure your premium cache.</span></span>

<span data-ttu-id="3b6f1-116">Olá tooconfigure redes para seu novo cache, clique em **rede Virtual** em Olá **novo Cache Redis** folha e selecione hello desejado VNet na lista suspensa de saudação.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-116">tooconfigure hello VNet for your new cache, click **Virtual Network** on hello **New Redis Cache** blade, and select hello desired VNet from hello drop-down list.</span></span>

![Rede virtual][redis-cache-vnet]

<span data-ttu-id="3b6f1-118">Selecione Olá sub-rede desejado da saudação **sub-rede** suspensa lista e especificar Olá desejado **endereço IP estático**.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-118">Select hello desired subnet from hello **Subnet** drop-down list, and specify hello desired **Static IP address**.</span></span> <span data-ttu-id="3b6f1-119">Se você estiver usando uma saudação de rede virtual clássica **endereço IP estático** campo é opcional e, se nenhum for especificado, um deles é escolhido da sub-rede de saudação selecionada.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-119">If you are using a classic VNet hello **Static IP address** field is optional, and if none is specified, one is chosen from hello selected subnet.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="3b6f1-120">Ao implantar um Gerenciador de recursos de VNet de tooa do Cache Redis do Azure, cache Olá deve ser em uma sub-rede dedicada que não contém outros recursos, exceto as instâncias de Cache Redis do Azure.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-120">When deploying an Azure Redis Cache tooa Resource Manager VNet, hello cache must be in a dedicated subnet that contains no other resources except for Azure Redis Cache instances.</span></span> <span data-ttu-id="3b6f1-121">Se uma tentativa for feita toodeploy tooa um Cache Redis do Azure Resource Manager VNet tooa sub-rede que contém outros recursos, a implantação de saudação falhará.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-121">If an attempt is made toodeploy an Azure Redis Cache tooa Resource Manager VNet tooa subnet that contains other resources, hello deployment fails.</span></span>
> 
> 

![Rede virtual][redis-cache-vnet-ip]

> [!IMPORTANT]
> <span data-ttu-id="3b6f1-123">O Azure reserva alguns endereços IP em cada sub-rede, os quais não podem ser usados.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-123">Azure reserves some IP addresses within each subnet, and these addresses can't be used.</span></span> <span data-ttu-id="3b6f1-124">Olá primeiro e últimos endereços IP das sub-redes Olá são reservados para conformidade de protocolo, juntamente com três endereços mais usados para serviços do Azure.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-124">hello first and last IP addresses of hello subnets are reserved for protocol conformance, along with three more addresses used for Azure services.</span></span> <span data-ttu-id="3b6f1-125">Para obter mais informações, consulte [Existem restrições quanto ao uso de endereços IP dentro dessas sub-redes?](../virtual-network/virtual-networks-faq.md#are-there-any-restrictions-on-using-ip-addresses-within-these-subnets)</span><span class="sxs-lookup"><span data-stu-id="3b6f1-125">For more information, see [Are there any restrictions on using IP addresses within these subnets?](../virtual-network/virtual-networks-faq.md#are-there-any-restrictions-on-using-ip-addresses-within-these-subnets)</span></span>
> 
> <span data-ttu-id="3b6f1-126">Em adição toohello endereços IP usados pela infraestrutura de rede virtual do Azure hello, de cada Redis instância Olá sub-rede usa dois endereços IP por fragmento e um endereço IP adicional Olá balanceador de carga.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-126">In addition toohello IP addresses used by hello Azure VNET infrastructure, each Redis instance in hello subnet uses two IP addresses per shard and one additional IP address for hello load balancer.</span></span> <span data-ttu-id="3b6f1-127">Um cache sem cluster é considerado toohave um fragmento.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-127">A non-clustered cache is considered toohave one shard.</span></span>
> 
> 

<span data-ttu-id="3b6f1-128">Após Olá cache é criado, você pode exibir configuração Olá Olá VNet clicando **rede Virtual** de saudação **menu recursos**.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-128">After hello cache is created, you can view hello configuration for hello VNet by clicking **Virtual Network** from hello **Resource menu**.</span></span>

![Rede virtual][redis-cache-vnet-info]

<span data-ttu-id="3b6f1-130">tooconnect tooyour Azure Redis cache instância ao usar uma rede virtual, especificar o nome de host de saudação do cache na cadeia de caracteres de conexão Olá conforme mostrado no exemplo a seguir de saudação:</span><span class="sxs-lookup"><span data-stu-id="3b6f1-130">tooconnect tooyour Azure Redis cache instance when using a VNet, specify hello host name of your cache in hello connection string as shown in hello following example:</span></span>

    private static Lazy<ConnectionMultiplexer> lazyConnection = new Lazy<ConnectionMultiplexer>(() =>
    {
        return ConnectionMultiplexer.Connect("contoso5premium.redis.cache.windows.net,abortConnect=false,ssl=true,password=password");
    });

    public static ConnectionMultiplexer Connection
    {
        get
        {
            return lazyConnection.Value;
        }
    }

## <a name="azure-redis-cache-vnet-faq"></a><span data-ttu-id="3b6f1-131">Perguntas frequentes sobre a Vnet do Cache Redis do Azure</span><span class="sxs-lookup"><span data-stu-id="3b6f1-131">Azure Redis Cache VNet FAQ</span></span>
<span data-ttu-id="3b6f1-132">Olá lista a seguir contém as respostas toocommonly perguntas frequentes sobre o dimensionamento do Cache Redis do Azure de saudação.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-132">hello following list contains answers toocommonly asked questions about hello Azure Redis Cache scaling.</span></span>

* [<span data-ttu-id="3b6f1-133">Quais são alguns problemas comuns de configuração incorreta no Cache Redis do Azure e nas VNets?</span><span class="sxs-lookup"><span data-stu-id="3b6f1-133">What are some common misconfiguration issues with Azure Redis Cache and VNets?</span></span>](#what-are-some-common-misconfiguration-issues-with-azure-redis-cache-and-vnets)
* [<span data-ttu-id="3b6f1-134">Como verificar se o cache está funcionando em uma VNET?</span><span class="sxs-lookup"><span data-stu-id="3b6f1-134">How can I verify that my cache is working in a VNET?</span></span>](#how-can-i-verify-that-my-cache-is-working-in-a-vnet)
* [<span data-ttu-id="3b6f1-135">Posso usar VNets com um cache básico ou Standard?</span><span class="sxs-lookup"><span data-stu-id="3b6f1-135">Can I use VNets with a standard or basic cache?</span></span>](#can-i-use-vnets-with-a-standard-or-basic-cache)
* [<span data-ttu-id="3b6f1-136">Por que a criação de um cache Redis falha em algumas sub-redes, mas não em outras?</span><span class="sxs-lookup"><span data-stu-id="3b6f1-136">Why does creating a Redis cache fail in some subnets but not others?</span></span>](#why-does-creating-a-redis-cache-fail-in-some-subnets-but-not-others)
* [<span data-ttu-id="3b6f1-137">Quais são os requisitos de espaço de endereço de sub-rede Olá?</span><span class="sxs-lookup"><span data-stu-id="3b6f1-137">What are hello subnet address space requirements?</span></span>](#what-are-the-subnet-address-space-requirements)
* [<span data-ttu-id="3b6f1-138">Todos os recursos de cache funcionam ao hospedar um cache em uma rede virtual?</span><span class="sxs-lookup"><span data-stu-id="3b6f1-138">Do all cache features work when hosting a cache in a VNET?</span></span>](#do-all-cache-features-work-when-hosting-a-cache-in-a-vnet)

## <a name="what-are-some-common-misconfiguration-issues-with-azure-redis-cache-and-vnets"></a><span data-ttu-id="3b6f1-139">Quais são alguns problemas comuns de configuração incorreta no Cache Redis do Azure e nas VNets?</span><span class="sxs-lookup"><span data-stu-id="3b6f1-139">What are some common misconfiguration issues with Azure Redis Cache and VNets?</span></span>
<span data-ttu-id="3b6f1-140">Quando o Cache Redis do Azure está hospedado em uma rede virtual, portas Olá Olá tabelas a seguir são usadas.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-140">When Azure Redis Cache is hosted in a VNet, hello ports in hello following tables are used.</span></span> 

>[!IMPORTANT]
><span data-ttu-id="3b6f1-141">Se portas Olá Olá tabelas a seguir são bloqueadas, cache Olá pode não funcionar corretamente.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-141">If hello ports in hello following tables are blocked, hello cache may not function correctly.</span></span> <span data-ttu-id="3b6f1-142">Tem um ou mais dessas portas bloqueados é o problema mais comum de má configuração Olá ao usar o Cache Redis do Azure em uma rede virtual.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-142">Having one or more of these ports blocked is hello most common misconfiguration issue when using Azure Redis Cache in a VNet.</span></span>
> 
> 

- [<span data-ttu-id="3b6f1-143">Requisitos de porta de saída</span><span class="sxs-lookup"><span data-stu-id="3b6f1-143">Outbound port requirements</span></span>](#outbound-port-requirements)
- [<span data-ttu-id="3b6f1-144">Requisitos de porta de entrada</span><span class="sxs-lookup"><span data-stu-id="3b6f1-144">Inbound port requirements</span></span>](#inbound-port-requirements)

### <a name="outbound-port-requirements"></a><span data-ttu-id="3b6f1-145">Requisitos de porta de saída</span><span class="sxs-lookup"><span data-stu-id="3b6f1-145">Outbound port requirements</span></span>

<span data-ttu-id="3b6f1-146">Há sete requisitos de porta de saída.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-146">There are seven outbound port requirements.</span></span>

- <span data-ttu-id="3b6f1-147">Se desejar, todos os toohello de conexões de saída à internet pode ser feitas por meio de um cliente auditoria dispositivo local.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-147">If desired, all outbound connections toohello internet can be made through a client's on-premises auditing device.</span></span>
- <span data-ttu-id="3b6f1-148">Três das portas Olá rotear tráfego tooAzure os pontos de extremidade de serviço DNS do Azure e armazenamento do Azure.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-148">Three of hello ports route traffic tooAzure endpoints servicing Azure Storage and Azure DNS.</span></span>
- <span data-ttu-id="3b6f1-149">Olá restantes intervalos de porta e para comunicações de sub-rede internas do Redis.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-149">hello remaining port ranges and for internal Redis subnet communications.</span></span> <span data-ttu-id="3b6f1-150">Não é necessária nenhuma regra do NSG da sub-rede para as comunicações internas de sub-rede Redis.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-150">No subnet NSG rules are required for internal Redis subnet communications.</span></span>

| <span data-ttu-id="3b6f1-151">Porta(s)</span><span class="sxs-lookup"><span data-stu-id="3b6f1-151">Port(s)</span></span> | <span data-ttu-id="3b6f1-152">Direção</span><span class="sxs-lookup"><span data-stu-id="3b6f1-152">Direction</span></span> | <span data-ttu-id="3b6f1-153">Protocolo de Transporte</span><span class="sxs-lookup"><span data-stu-id="3b6f1-153">Transport Protocol</span></span> | <span data-ttu-id="3b6f1-154">Finalidade</span><span class="sxs-lookup"><span data-stu-id="3b6f1-154">Purpose</span></span> | <span data-ttu-id="3b6f1-155">IP local</span><span class="sxs-lookup"><span data-stu-id="3b6f1-155">Local IP</span></span> | <span data-ttu-id="3b6f1-156">IP Remoto</span><span class="sxs-lookup"><span data-stu-id="3b6f1-156">Remote IP</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="3b6f1-157">80, 443</span><span class="sxs-lookup"><span data-stu-id="3b6f1-157">80, 443</span></span> |<span data-ttu-id="3b6f1-158">Saída</span><span class="sxs-lookup"><span data-stu-id="3b6f1-158">Outbound</span></span> |<span data-ttu-id="3b6f1-159">TCP</span><span class="sxs-lookup"><span data-stu-id="3b6f1-159">TCP</span></span> |<span data-ttu-id="3b6f1-160">Dependências de Redis no Armazenamento do Azure/PKI (Internet)</span><span class="sxs-lookup"><span data-stu-id="3b6f1-160">Redis dependencies on Azure Storage/PKI (Internet)</span></span> | <span data-ttu-id="3b6f1-161">(Sub-rede Redis)</span><span class="sxs-lookup"><span data-stu-id="3b6f1-161">(Redis subnet)</span></span> |* |
| <span data-ttu-id="3b6f1-162">53</span><span class="sxs-lookup"><span data-stu-id="3b6f1-162">53</span></span> |<span data-ttu-id="3b6f1-163">Saída</span><span class="sxs-lookup"><span data-stu-id="3b6f1-163">Outbound</span></span> |<span data-ttu-id="3b6f1-164">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="3b6f1-164">TCP/UDP</span></span> |<span data-ttu-id="3b6f1-165">Dependências Redis no DNS (Internet/Rede Virtual)</span><span class="sxs-lookup"><span data-stu-id="3b6f1-165">Redis dependencies on DNS (Internet/VNet)</span></span> | <span data-ttu-id="3b6f1-166">(Sub-rede Redis)</span><span class="sxs-lookup"><span data-stu-id="3b6f1-166">(Redis subnet)</span></span> |* |
| <span data-ttu-id="3b6f1-167">8443</span><span class="sxs-lookup"><span data-stu-id="3b6f1-167">8443</span></span> |<span data-ttu-id="3b6f1-168">Saída</span><span class="sxs-lookup"><span data-stu-id="3b6f1-168">Outbound</span></span> |<span data-ttu-id="3b6f1-169">TCP</span><span class="sxs-lookup"><span data-stu-id="3b6f1-169">TCP</span></span> |<span data-ttu-id="3b6f1-170">Comunicações internas para Redis</span><span class="sxs-lookup"><span data-stu-id="3b6f1-170">Internal communications for Redis</span></span> | <span data-ttu-id="3b6f1-171">(Sub-rede Redis)</span><span class="sxs-lookup"><span data-stu-id="3b6f1-171">(Redis subnet)</span></span> | <span data-ttu-id="3b6f1-172">(Sub-rede Redis)</span><span class="sxs-lookup"><span data-stu-id="3b6f1-172">(Redis subnet)</span></span> |
| <span data-ttu-id="3b6f1-173">10221-10231</span><span class="sxs-lookup"><span data-stu-id="3b6f1-173">10221-10231</span></span> |<span data-ttu-id="3b6f1-174">Saída</span><span class="sxs-lookup"><span data-stu-id="3b6f1-174">Outbound</span></span> |<span data-ttu-id="3b6f1-175">TCP</span><span class="sxs-lookup"><span data-stu-id="3b6f1-175">TCP</span></span> |<span data-ttu-id="3b6f1-176">Comunicações internas para Redis</span><span class="sxs-lookup"><span data-stu-id="3b6f1-176">Internal communications for Redis</span></span> | <span data-ttu-id="3b6f1-177">(Sub-rede Redis)</span><span class="sxs-lookup"><span data-stu-id="3b6f1-177">(Redis subnet)</span></span> | <span data-ttu-id="3b6f1-178">(Sub-rede Redis)</span><span class="sxs-lookup"><span data-stu-id="3b6f1-178">(Redis subnet)</span></span> |
| <span data-ttu-id="3b6f1-179">20226</span><span class="sxs-lookup"><span data-stu-id="3b6f1-179">20226</span></span> |<span data-ttu-id="3b6f1-180">Saída</span><span class="sxs-lookup"><span data-stu-id="3b6f1-180">Outbound</span></span> |<span data-ttu-id="3b6f1-181">TCP</span><span class="sxs-lookup"><span data-stu-id="3b6f1-181">TCP</span></span> |<span data-ttu-id="3b6f1-182">Comunicações internas para Redis</span><span class="sxs-lookup"><span data-stu-id="3b6f1-182">Internal communications for Redis</span></span> | <span data-ttu-id="3b6f1-183">(Sub-rede Redis)</span><span class="sxs-lookup"><span data-stu-id="3b6f1-183">(Redis subnet)</span></span> |<span data-ttu-id="3b6f1-184">(Sub-rede Redis)</span><span class="sxs-lookup"><span data-stu-id="3b6f1-184">(Redis subnet)</span></span> |
| <span data-ttu-id="3b6f1-185">13000-13999</span><span class="sxs-lookup"><span data-stu-id="3b6f1-185">13000-13999</span></span> |<span data-ttu-id="3b6f1-186">Saída</span><span class="sxs-lookup"><span data-stu-id="3b6f1-186">Outbound</span></span> |<span data-ttu-id="3b6f1-187">TCP</span><span class="sxs-lookup"><span data-stu-id="3b6f1-187">TCP</span></span> |<span data-ttu-id="3b6f1-188">Comunicações internas para Redis</span><span class="sxs-lookup"><span data-stu-id="3b6f1-188">Internal communications for Redis</span></span> | <span data-ttu-id="3b6f1-189">(Sub-rede Redis)</span><span class="sxs-lookup"><span data-stu-id="3b6f1-189">(Redis subnet)</span></span> |<span data-ttu-id="3b6f1-190">(Sub-rede Redis)</span><span class="sxs-lookup"><span data-stu-id="3b6f1-190">(Redis subnet)</span></span> |
| <span data-ttu-id="3b6f1-191">15000-15999</span><span class="sxs-lookup"><span data-stu-id="3b6f1-191">15000-15999</span></span> |<span data-ttu-id="3b6f1-192">Saída</span><span class="sxs-lookup"><span data-stu-id="3b6f1-192">Outbound</span></span> |<span data-ttu-id="3b6f1-193">TCP</span><span class="sxs-lookup"><span data-stu-id="3b6f1-193">TCP</span></span> |<span data-ttu-id="3b6f1-194">Comunicações internas para Redis</span><span class="sxs-lookup"><span data-stu-id="3b6f1-194">Internal communications for Redis</span></span> | <span data-ttu-id="3b6f1-195">(Sub-rede Redis)</span><span class="sxs-lookup"><span data-stu-id="3b6f1-195">(Redis subnet)</span></span> |<span data-ttu-id="3b6f1-196">(Sub-rede Redis)</span><span class="sxs-lookup"><span data-stu-id="3b6f1-196">(Redis subnet)</span></span> |


### <a name="inbound-port-requirements"></a><span data-ttu-id="3b6f1-197">Requisitos de porta de entrada</span><span class="sxs-lookup"><span data-stu-id="3b6f1-197">Inbound port requirements</span></span>

<span data-ttu-id="3b6f1-198">Há oito requisitos de intervalo de portas de entrada.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-198">There are eight inbound port range requirements.</span></span> <span data-ttu-id="3b6f1-199">Solicitações de entrada nesses intervalos são entrada de outros serviços hospedados em Olá mesmo VNET ou toohello interno comunicações de sub-rede do Redis.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-199">Inbound requests in these ranges are either inbound from other services hosted in hello same VNET or internal toohello Redis subnet communications.</span></span>

| <span data-ttu-id="3b6f1-200">Porta(s)</span><span class="sxs-lookup"><span data-stu-id="3b6f1-200">Port(s)</span></span> | <span data-ttu-id="3b6f1-201">Direção</span><span class="sxs-lookup"><span data-stu-id="3b6f1-201">Direction</span></span> | <span data-ttu-id="3b6f1-202">Protocolo de Transporte</span><span class="sxs-lookup"><span data-stu-id="3b6f1-202">Transport Protocol</span></span> | <span data-ttu-id="3b6f1-203">Finalidade</span><span class="sxs-lookup"><span data-stu-id="3b6f1-203">Purpose</span></span> | <span data-ttu-id="3b6f1-204">IP local</span><span class="sxs-lookup"><span data-stu-id="3b6f1-204">Local IP</span></span> | <span data-ttu-id="3b6f1-205">IP Remoto</span><span class="sxs-lookup"><span data-stu-id="3b6f1-205">Remote IP</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="3b6f1-206">6379, 6380</span><span class="sxs-lookup"><span data-stu-id="3b6f1-206">6379, 6380</span></span> |<span data-ttu-id="3b6f1-207">Entrada</span><span class="sxs-lookup"><span data-stu-id="3b6f1-207">Inbound</span></span> |<span data-ttu-id="3b6f1-208">TCP</span><span class="sxs-lookup"><span data-stu-id="3b6f1-208">TCP</span></span> |<span data-ttu-id="3b6f1-209">TooRedis de comunicação do cliente, Azure balanceamento de carga</span><span class="sxs-lookup"><span data-stu-id="3b6f1-209">Client communication tooRedis, Azure load balancing</span></span> | <span data-ttu-id="3b6f1-210">(Sub-rede Redis)</span><span class="sxs-lookup"><span data-stu-id="3b6f1-210">(Redis subnet)</span></span> |<span data-ttu-id="3b6f1-211">Rede virtual, Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="3b6f1-211">Virtual Network, Azure Load Balancer</span></span> |
| <span data-ttu-id="3b6f1-212">8443</span><span class="sxs-lookup"><span data-stu-id="3b6f1-212">8443</span></span> |<span data-ttu-id="3b6f1-213">Entrada</span><span class="sxs-lookup"><span data-stu-id="3b6f1-213">Inbound</span></span> |<span data-ttu-id="3b6f1-214">TCP</span><span class="sxs-lookup"><span data-stu-id="3b6f1-214">TCP</span></span> |<span data-ttu-id="3b6f1-215">Comunicações internas para Redis</span><span class="sxs-lookup"><span data-stu-id="3b6f1-215">Internal communications for Redis</span></span> | <span data-ttu-id="3b6f1-216">(Sub-rede Redis)</span><span class="sxs-lookup"><span data-stu-id="3b6f1-216">(Redis subnet)</span></span> |<span data-ttu-id="3b6f1-217">(Sub-rede Redis)</span><span class="sxs-lookup"><span data-stu-id="3b6f1-217">(Redis subnet)</span></span> |
| <span data-ttu-id="3b6f1-218">8500</span><span class="sxs-lookup"><span data-stu-id="3b6f1-218">8500</span></span> |<span data-ttu-id="3b6f1-219">Entrada</span><span class="sxs-lookup"><span data-stu-id="3b6f1-219">Inbound</span></span> |<span data-ttu-id="3b6f1-220">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="3b6f1-220">TCP/UDP</span></span> |<span data-ttu-id="3b6f1-221">Balanceamento de Carga do Azure</span><span class="sxs-lookup"><span data-stu-id="3b6f1-221">Azure load balancing</span></span> | <span data-ttu-id="3b6f1-222">(Sub-rede Redis)</span><span class="sxs-lookup"><span data-stu-id="3b6f1-222">(Redis subnet)</span></span> |<span data-ttu-id="3b6f1-223">Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="3b6f1-223">Azure Load Balancer</span></span> |
| <span data-ttu-id="3b6f1-224">10221-10231</span><span class="sxs-lookup"><span data-stu-id="3b6f1-224">10221-10231</span></span> |<span data-ttu-id="3b6f1-225">Entrada</span><span class="sxs-lookup"><span data-stu-id="3b6f1-225">Inbound</span></span> |<span data-ttu-id="3b6f1-226">TCP</span><span class="sxs-lookup"><span data-stu-id="3b6f1-226">TCP</span></span> |<span data-ttu-id="3b6f1-227">Comunicações internas para Redis</span><span class="sxs-lookup"><span data-stu-id="3b6f1-227">Internal communications for Redis</span></span> | <span data-ttu-id="3b6f1-228">(Sub-rede Redis)</span><span class="sxs-lookup"><span data-stu-id="3b6f1-228">(Redis subnet)</span></span> |<span data-ttu-id="3b6f1-229">(Sub-rede Redus), Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="3b6f1-229">(Redis subnet), Azure Load Balancer</span></span> |
| <span data-ttu-id="3b6f1-230">13000-13999</span><span class="sxs-lookup"><span data-stu-id="3b6f1-230">13000-13999</span></span> |<span data-ttu-id="3b6f1-231">Entrada</span><span class="sxs-lookup"><span data-stu-id="3b6f1-231">Inbound</span></span> |<span data-ttu-id="3b6f1-232">TCP</span><span class="sxs-lookup"><span data-stu-id="3b6f1-232">TCP</span></span> |<span data-ttu-id="3b6f1-233">Comunicação de cliente tooRedis Clusters de balanceamento de carga do Azure</span><span class="sxs-lookup"><span data-stu-id="3b6f1-233">Client communication tooRedis Clusters, Azure load balancing</span></span> | <span data-ttu-id="3b6f1-234">(Sub-rede Redis)</span><span class="sxs-lookup"><span data-stu-id="3b6f1-234">(Redis subnet)</span></span> |<span data-ttu-id="3b6f1-235">Rede virtual, Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="3b6f1-235">Virtual Network, Azure Load Balancer</span></span> |
| <span data-ttu-id="3b6f1-236">15000-15999</span><span class="sxs-lookup"><span data-stu-id="3b6f1-236">15000-15999</span></span> |<span data-ttu-id="3b6f1-237">Entrada</span><span class="sxs-lookup"><span data-stu-id="3b6f1-237">Inbound</span></span> |<span data-ttu-id="3b6f1-238">TCP</span><span class="sxs-lookup"><span data-stu-id="3b6f1-238">TCP</span></span> |<span data-ttu-id="3b6f1-239">TooRedis de comunicação de cliente balanceamento de carga de Clusters, o Azure</span><span class="sxs-lookup"><span data-stu-id="3b6f1-239">Client communication tooRedis Clusters, Azure load Balancing</span></span> | <span data-ttu-id="3b6f1-240">(Sub-rede Redis)</span><span class="sxs-lookup"><span data-stu-id="3b6f1-240">(Redis subnet)</span></span> |<span data-ttu-id="3b6f1-241">Rede virtual, Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="3b6f1-241">Virtual Network, Azure Load Balancer</span></span> |
| <span data-ttu-id="3b6f1-242">16001</span><span class="sxs-lookup"><span data-stu-id="3b6f1-242">16001</span></span> |<span data-ttu-id="3b6f1-243">Entrada</span><span class="sxs-lookup"><span data-stu-id="3b6f1-243">Inbound</span></span> |<span data-ttu-id="3b6f1-244">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="3b6f1-244">TCP/UDP</span></span> |<span data-ttu-id="3b6f1-245">Balanceamento de Carga do Azure</span><span class="sxs-lookup"><span data-stu-id="3b6f1-245">Azure load balancing</span></span> | <span data-ttu-id="3b6f1-246">(Sub-rede Redis)</span><span class="sxs-lookup"><span data-stu-id="3b6f1-246">(Redis subnet)</span></span> |<span data-ttu-id="3b6f1-247">Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="3b6f1-247">Azure Load Balancer</span></span> |
| <span data-ttu-id="3b6f1-248">20226</span><span class="sxs-lookup"><span data-stu-id="3b6f1-248">20226</span></span> |<span data-ttu-id="3b6f1-249">Entrada</span><span class="sxs-lookup"><span data-stu-id="3b6f1-249">Inbound</span></span> |<span data-ttu-id="3b6f1-250">TCP</span><span class="sxs-lookup"><span data-stu-id="3b6f1-250">TCP</span></span> |<span data-ttu-id="3b6f1-251">Comunicações internas para Redis</span><span class="sxs-lookup"><span data-stu-id="3b6f1-251">Internal communications for Redis</span></span> | <span data-ttu-id="3b6f1-252">(Sub-rede Redis)</span><span class="sxs-lookup"><span data-stu-id="3b6f1-252">(Redis subnet)</span></span> |<span data-ttu-id="3b6f1-253">(Sub-rede Redis)</span><span class="sxs-lookup"><span data-stu-id="3b6f1-253">(Redis subnet)</span></span> |

### <a name="additional-vnet-network-connectivity-requirements"></a><span data-ttu-id="3b6f1-254">Requisitos de conectividade de rede VNET adicionais</span><span class="sxs-lookup"><span data-stu-id="3b6f1-254">Additional VNET network connectivity requirements</span></span>

<span data-ttu-id="3b6f1-255">Há requisitos de conectividade de rede para o Cache Redis do Azure que podem não ser atendidos inicialmente em uma rede virtual.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-255">There are network connectivity requirements for Azure Redis Cache that may not be initially met in a virtual network.</span></span> <span data-ttu-id="3b6f1-256">Cache Redis do Azure requer que todos os Olá itens toofunction corretamente quando usados em uma rede virtual a seguir.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-256">Azure Redis Cache requires all hello following items toofunction properly when used within a virtual network.</span></span>

* <span data-ttu-id="3b6f1-257">Rede de saída conectividade tooAzure armazenamento pontos de extremidade em todo o mundo.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-257">Outbound network connectivity tooAzure Storage endpoints worldwide.</span></span> <span data-ttu-id="3b6f1-258">Isso inclui os pontos de extremidade localizados em Olá mesma região que a instância de Cache Redis do Azure hello, bem como pontos de extremidade de armazenamento localizados na **outros** regiões do Azure.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-258">This includes endpoints located in hello same region as hello Azure Redis Cache instance, as well as storage endpoints located in **other** Azure regions.</span></span> <span data-ttu-id="3b6f1-259">Pontos de extremidade de armazenamento do Azure resolver em Olá domínios DNS a seguir: *n e t*, *>.blob.Core.Windows.NET*, *queue.core.windows.net*e *file.core.windows.net*.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-259">Azure Storage endpoints resolve under hello following DNS domains: *table.core.windows.net*, *blob.core.windows.net*, *queue.core.windows.net*, and *file.core.windows.net*.</span></span> 
* <span data-ttu-id="3b6f1-260">Saída conectividade de rede muito*ocsp.msocsp.com*, *mscrl.microsoft.com*, e *crl.microsoft.com*. Essa conectividade é necessário toosupport funcionalidade SSL.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-260">Outbound network connectivity too*ocsp.msocsp.com*, *mscrl.microsoft.com*, and *crl.microsoft.com*. This connectivity is needed toosupport SSL functionality.</span></span>
* <span data-ttu-id="3b6f1-261">configuração de DNS Olá para rede virtual Olá deve ser capaz de resolver todos os pontos de extremidade hello e domínios mencionado na Olá pontos anteriores.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-261">hello DNS configuration for hello virtual network must be capable of resolving all of hello endpoints and domains mentioned in hello earlier points.</span></span> <span data-ttu-id="3b6f1-262">Esses requisitos de DNS podem ser atendidos, garantindo uma infraestrutura DNS válida está configurada e mantida para rede virtual hello.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-262">These DNS requirements can be met by ensuring a valid DNS infrastructure is configured and maintained for hello virtual network.</span></span>
* <span data-ttu-id="3b6f1-263">Toohello de conectividade de rede de saída a seguir de monitoramento do Azure pontos de extremidade, resolver em Olá domínios DNS a seguir: shoebox2 black.shoebox2.metrics.nsatc.net, Norte-prod2.prod2.metrics.nsatc.net azglobal-black.azglobal.metrics.nsatc.net, shoebox2-red.shoebox2.metrics.nsatc.net, Leste-prod2.prod2.metrics.nsatc.net azglobal-red.azglobal.metrics.nsatc.net.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-263">Outbound network connectivity toohello following Azure Monitoring endpoints, which resolve under hello following DNS domains: shoebox2-black.shoebox2.metrics.nsatc.net, north-prod2.prod2.metrics.nsatc.net, azglobal-black.azglobal.metrics.nsatc.net, shoebox2-red.shoebox2.metrics.nsatc.net, east-prod2.prod2.metrics.nsatc.net, azglobal-red.azglobal.metrics.nsatc.net.</span></span>

### <a name="how-can-i-verify-that-my-cache-is-working-in-a-vnet"></a><span data-ttu-id="3b6f1-264">Como verificar se o cache está funcionando em uma VNET?</span><span class="sxs-lookup"><span data-stu-id="3b6f1-264">How can I verify that my cache is working in a VNET?</span></span>

>[!IMPORTANT]
><span data-ttu-id="3b6f1-265">Ao conectar-se a instância de Cache Redis do Azure tooan que é hospedada em uma rede virtual, os clientes devem estar em cache Olá mesma rede virtual, incluindo todos os aplicativos de teste ou ferramentas de diagnóstico do ping.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-265">When connecting tooan Azure Redis Cache instance that is hosted in a VNET, your cache clients must be in hello same VNET, including any test applications or diagnostic pinging tools.</span></span>
>
>

<span data-ttu-id="3b6f1-266">Depois que os requisitos de porta de saudação são configurados conforme descrito na seção anterior hello, você pode verificar se o cache está funcionando executando Olá etapas a seguir.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-266">Once hello port requirements are configured as described in hello previous section, you can verify that your cache is working by performing hello following steps.</span></span>

- <span data-ttu-id="3b6f1-267">[Reinicialize](cache-administration.md#reboot) todos Olá nós de cache.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-267">[Reboot](cache-administration.md#reboot) all of hello cache nodes.</span></span> <span data-ttu-id="3b6f1-268">Se todos Olá necessários dependências de cache não podem ser acessadas (conforme documentado no [requisitos de porta de entrada](cache-how-to-premium-vnet.md#inbound-port-requirements) e [requisitos de porta de saída](cache-how-to-premium-vnet.md#outbound-port-requirements)), o cache de saudação não será capaz de toorestart com êxito.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-268">If all of hello required cache dependencies can't be reached (as documented in [Inbound port requirements](cache-how-to-premium-vnet.md#inbound-port-requirements) and [Outbound port requirements](cache-how-to-premium-vnet.md#outbound-port-requirements)), hello cache won't be able toorestart successfully.</span></span>
- <span data-ttu-id="3b6f1-269">Depois de reiniciar nós de cache hello (conforme relatado pelo status do cache de saudação no Olá portal do Azure), você pode executar Olá testes a seguir:</span><span class="sxs-lookup"><span data-stu-id="3b6f1-269">Once hello cache nodes have restarted (as reported by hello cache status in hello Azure portal), you can perform hello following tests:</span></span>
  - <span data-ttu-id="3b6f1-270">executar ping Olá cache ponto de extremidade (usando a porta 6380) de um computador que está dentro de saudação mesmo VNET como Olá armazenar em cache, usando [tcping](https://www.elifulkerson.com/projects/tcping.php).</span><span class="sxs-lookup"><span data-stu-id="3b6f1-270">ping hello cache endpoint (using port 6380) from a machine that is within hello same VNET as hello cache, using [tcping](https://www.elifulkerson.com/projects/tcping.php).</span></span> <span data-ttu-id="3b6f1-271">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="3b6f1-271">For example:</span></span>
    
    `tcping.exe contosocache.redis.cache.windows.net 6380`
    
    <span data-ttu-id="3b6f1-272">Se hello `tcping` ferramenta reporta que Olá a porta está aberta, o cache de saudação está disponível para a conexão de clientes em redes de saudação.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-272">If hello `tcping` tool reports that hello port is open, hello cache is available for connection from clients in hello VNET.</span></span>

  - <span data-ttu-id="3b6f1-273">Tootest de outra maneira é um cliente de cache de teste de toocreate (que pode ser um simples aplicativo de console usando Stackexchange) que se conecta toohello cache e adiciona e recupera alguns itens do cache de saudação.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-273">Another way tootest is toocreate a test cache client (which could be a simple console application using StackExchange.Redis) that connects toohello cache and adds and retrieves some items from hello cache.</span></span> <span data-ttu-id="3b6f1-274">Instalar o aplicativo de cliente de exemplo hello em uma máquina virtual que está em Olá mesmo VNET como cache hello e execute-o cache de toohello tooverify conectividade.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-274">Install hello sample client application onto a VM that is in hello same VNET as hello cache and run it tooverify connectivity toohello cache.</span></span>


### <a name="can-i-use-vnets-with-a-standard-or-basic-cache"></a><span data-ttu-id="3b6f1-275">Posso usar VNets com um cache básico ou Standard?</span><span class="sxs-lookup"><span data-stu-id="3b6f1-275">Can I use VNets with a standard or basic cache?</span></span>
<span data-ttu-id="3b6f1-276">As VNets podem ser usadas apenas com os caches Premium.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-276">VNets can only be used with premium caches.</span></span>

### <a name="why-does-creating-a-redis-cache-fail-in-some-subnets-but-not-others"></a><span data-ttu-id="3b6f1-277">Por que a criação de um cache Redis falha em algumas sub-redes, mas não em outras?</span><span class="sxs-lookup"><span data-stu-id="3b6f1-277">Why does creating a Redis cache fail in some subnets but not others?</span></span>
<span data-ttu-id="3b6f1-278">Se você estiver implantando um Gerenciador de recursos de VNet de tooa do Cache Redis do Azure, cache Olá deve ser em uma sub-rede dedicada que não contém a nenhum outro tipo de recurso.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-278">If you are deploying an Azure Redis Cache tooa Resource Manager VNet, hello cache must be in a dedicated subnet that contains no other resource type.</span></span> <span data-ttu-id="3b6f1-279">Se uma tentativa for feita toodeploy tooa um Cache Redis do Azure VNet Gerenciador de recursos de sub-rede que contém outros recursos, a implantação de saudação falhará.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-279">If an attempt is made toodeploy an Azure Redis Cache tooa Resource Manager VNet subnet that contains other resources, hello deployment fails.</span></span> <span data-ttu-id="3b6f1-280">Você deve excluir os recursos existentes Olá Olá sub-rede antes de criar um novo cache Redis.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-280">You must delete hello existing resources inside hello subnet before you can create a new Redis cache.</span></span>

<span data-ttu-id="3b6f1-281">Você pode implantar vários tipos de recursos tooa VNet clássico desde que você tem suficiente IP endereços disponíveis.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-281">You can deploy multiple types of resources tooa classic VNet as long as you have enough IP addresses available.</span></span>

### <a name="what-are-hello-subnet-address-space-requirements"></a><span data-ttu-id="3b6f1-282">Quais são os requisitos de espaço de endereço de sub-rede Olá?</span><span class="sxs-lookup"><span data-stu-id="3b6f1-282">What are hello subnet address space requirements?</span></span>
<span data-ttu-id="3b6f1-283">O Azure reserva alguns endereços IP em cada sub-rede, os quais não podem ser usados.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-283">Azure reserves some IP addresses within each subnet, and these addresses can't be used.</span></span> <span data-ttu-id="3b6f1-284">Olá primeiro e últimos endereços IP das sub-redes Olá são reservados para conformidade de protocolo, juntamente com três endereços mais usados para serviços do Azure.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-284">hello first and last IP addresses of hello subnets are reserved for protocol conformance, along with three more addresses used for Azure services.</span></span> <span data-ttu-id="3b6f1-285">Para obter mais informações, consulte [Existem restrições quanto ao uso de endereços IP dentro dessas sub-redes?](../virtual-network/virtual-networks-faq.md#are-there-any-restrictions-on-using-ip-addresses-within-these-subnets)</span><span class="sxs-lookup"><span data-stu-id="3b6f1-285">For more information, see [Are there any restrictions on using IP addresses within these subnets?](../virtual-network/virtual-networks-faq.md#are-there-any-restrictions-on-using-ip-addresses-within-these-subnets)</span></span>

<span data-ttu-id="3b6f1-286">Em adição toohello endereços IP usados pela infraestrutura de rede virtual do Azure hello, de cada Redis instância Olá sub-rede usa dois endereços IP por fragmento e um endereço IP adicional Olá balanceador de carga.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-286">In addition toohello IP addresses used by hello Azure VNET infrastructure, each Redis instance in hello subnet uses two IP addresses per shard and one additional IP address for hello load balancer.</span></span> <span data-ttu-id="3b6f1-287">Um cache sem cluster é considerado toohave um fragmento.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-287">A non-clustered cache is considered toohave one shard.</span></span>

### <a name="do-all-cache-features-work-when-hosting-a-cache-in-a-vnet"></a><span data-ttu-id="3b6f1-288">Todos os recursos de cache funcionam ao hospedar um cache em uma rede virtual?</span><span class="sxs-lookup"><span data-stu-id="3b6f1-288">Do all cache features work when hosting a cache in a VNET?</span></span>
<span data-ttu-id="3b6f1-289">Quando o cache faz parte de uma rede virtual, somente a clientes em redes de saudação pode acessar o cache de saudação.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-289">When your cache is part of a VNET, only clients in hello VNET can access hello cache.</span></span> <span data-ttu-id="3b6f1-290">Como resultado, hello seguintes recursos de gerenciamento de cache não funcionam no momento.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-290">As a result, hello following cache management features don't work at this time.</span></span>

* <span data-ttu-id="3b6f1-291">Console de redis - como Redis Console é executado no navegador local, que está fora da saudação rede virtual, não é possível conectar-se tooyour cache.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-291">Redis Console - Because Redis Console runs in your local browser, which is outside hello VNET, it can't connect tooyour cache.</span></span>

## <a name="use-expressroute-with-azure-redis-cache"></a><span data-ttu-id="3b6f1-292">Usar o ExpressRoute com Cache Redis do Azure</span><span class="sxs-lookup"><span data-stu-id="3b6f1-292">Use ExpressRoute with Azure Redis Cache</span></span>
<span data-ttu-id="3b6f1-293">Os clientes podem conectar um [rota expressa do Azure](https://azure.microsoft.com/services/expressroute/) infraestrutura de rede virtual tootheir circuito, estendendo assim seu tooAzure de rede local.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-293">Customers can connect an [Azure ExpressRoute](https://azure.microsoft.com/services/expressroute/) circuit tootheir virtual network infrastructure, thus extending their on-premises network tooAzure.</span></span> 

<span data-ttu-id="3b6f1-294">Por padrão, um circuito ExpressRoute recém-criado não executa túnel forçado (anúncio de uma rota padrão, 0.0.0.0/0) em uma VNET.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-294">By default, a newly created ExpressRoute circuit does not perform forced tunneling (advertisement of a default route, 0.0.0.0/0) on a VNET.</span></span> <span data-ttu-id="3b6f1-295">Como resultado, conectividade de Internet de saída é permitida diretamente da saudação redes e aplicativos de cliente são capazes de tooconnect tooother do Azure pontos de extremidade incluindo Cache Redis do Azure.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-295">As a result, outbound Internet connectivity is allowed directly from hello VNET and client applications are able tooconnect tooother Azure endpoints including Azure Redis Cache.</span></span>

<span data-ttu-id="3b6f1-296">No entanto, uma configuração de cliente comum é toouse túnel forçado (anuncia uma rota padrão) que força a saída da Internet tráfego tooinstead fluxo local.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-296">However a common customer configuration is toouse forced tunneling (advertise a default route) which forces outbound Internet traffic tooinstead flow on-premises.</span></span> <span data-ttu-id="3b6f1-297">Este fluxo de tráfego quebras de conectividade com o Cache Redis do Azure se for o tráfego de saída hello e bloqueado no local, de modo que hello instância de Cache Redis do Azure não é capaz de toocommunicate com suas dependências.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-297">This traffic flow breaks connectivity with Azure Redis Cache if hello outbound traffic is then blocked on-premises such that hello Azure Redis Cache instance is not able toocommunicate with its dependencies.</span></span>

<span data-ttu-id="3b6f1-298">solução de saudação é toodefine uma (ou mais) definidos pelo usuário rotas (UDRs) na sub-rede Olá que contém Olá Cache Redis do Azure.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-298">hello solution is toodefine one (or more) user-defined routes (UDRs) on hello subnet that contains hello Azure Redis Cache.</span></span> <span data-ttu-id="3b6f1-299">Um UDR define as rotas de sub-rede que serão cumpridas em vez de rota padrão de saudação.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-299">A UDR defines subnet-specific routes that will be honored instead of hello default route.</span></span>

<span data-ttu-id="3b6f1-300">Se possível, é recomendável Olá toouse seguinte configuração:</span><span class="sxs-lookup"><span data-stu-id="3b6f1-300">If possible, it is recommended toouse hello following configuration:</span></span>

* <span data-ttu-id="3b6f1-301">configuração de rota expressa Olá anuncia 0.0.0.0/0 e todo o tráfego de saída no local de túneis de força por padrão.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-301">hello ExpressRoute configuration advertises 0.0.0.0/0 and by default force tunnels all outbound traffic on-premises.</span></span>
* <span data-ttu-id="3b6f1-302">Olá, UDR aplicada toohello sub-rede contendo Olá Cache Redis do Azure define 0.0.0.0/0 com uma rota de trabalho para toohello de tráfego de TCP/IP internet pública. Por exemplo por configuração saudação do próximo salto too'Internet do tipo '.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-302">hello UDR applied toohello subnet containing hello Azure Redis Cache defines 0.0.0.0/0 with a working route for TCP/IP traffic toohello public internet; for example by setting hello next hop type too'Internet'.</span></span>

<span data-ttu-id="3b6f1-303">Olá efeito combinado dessas etapas é que o nível de sub-rede Olá UDR tem precedência sobre Olá ExpressRoute forçada de túneis, garantindo, assim, o acesso de Internet de saída de hello Cache Redis do Azure.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-303">hello combined effect of these steps is that hello subnet level UDR takes precedence over hello ExpressRoute forced tunneling, thus ensuring outbound Internet access from hello Azure Redis Cache.</span></span>

<span data-ttu-id="3b6f1-304">Instância de Cache Redis do Azure tooan conexão de um aplicativo local usando o ExpressRoute não é um cenário de uso típico devido a motivos de tooperformance (para melhor desempenho de Cache Redis do Azure, os clientes devem estar no hello mesma região Olá Cache Redis do Azure).</span><span class="sxs-lookup"><span data-stu-id="3b6f1-304">Connecting tooan Azure Redis Cache instance from an on-premises application using ExpressRoute is not a typical usage scenario due tooperformance reasons (for best performance Azure Redis Cache clients should be in hello same region as hello Azure Redis Cache).</span></span>

>[!IMPORTANT] 
><span data-ttu-id="3b6f1-305">Olá rotas definidas em um UDR **deve** ser específica o suficiente tootake precedência sobre todas as rotas anunciadas pela configuração de rota expressa hello.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-305">hello routes defined in a UDR **must** be specific enough tootake precedence over any routes advertised by hello ExpressRoute configuration.</span></span> <span data-ttu-id="3b6f1-306">Hello exemplo a seguir usa o intervalo de endereços do hello amplo 0.0.0.0/0 e assim pode potencialmente ser acidentalmente substituído pelos anúncios de rota usando intervalos de endereços mais específicos.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-306">hello following example uses hello broad 0.0.0.0/0 address range, and as such can potentially be accidentally overridden by route advertisements using more specific address ranges.</span></span>

>[!WARNING]  
><span data-ttu-id="3b6f1-307">Não há suporte para o Cache Redis do Azure com configurações de rota expressa que **incorretamente entre-anunciar rotas de saudação emparelhamento caminho toohello privada caminho emparelhamento público**.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-307">Azure Redis Cache is not supported with ExpressRoute configurations that **incorrectly cross-advertise routes from hello public peering path toohello private peering path**.</span></span> <span data-ttu-id="3b6f1-308">As configurações de ExpressRoute com emparelhamento público definido receberão anúncios de rota da Microsoft para um grande conjunto de intervalos de endereços IP do Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-308">ExpressRoute configurations that have public peering configured, receive route advertisements from Microsoft for a large set of Microsoft Azure IP address ranges.</span></span> <span data-ttu-id="3b6f1-309">Se esses intervalos de endereços incorretamente entre anunciados no caminho de emparelhamento privado hello, Olá significa que todos os pacotes de saída de rede da sub-rede da instância de Cache Redis do Azure Olá estão rede do local do cliente tooa incorretamente túnel de força infraestrutura.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-309">If these address ranges are incorrectly cross-advertised on hello private peering path, hello result is that all outbound network packets from hello Azure Redis Cache instance's subnet are incorrectly force-tunneled tooa customer's on-premises network infrastructure.</span></span> <span data-ttu-id="3b6f1-310">Esse fluxo de rede interrompe o Cache Redis do Azure.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-310">This network flow breaks Azure Redis Cache.</span></span> <span data-ttu-id="3b6f1-311">problema de toothis solução Olá é toostop as rotas entre publicidade Olá emparelhamento caminho toohello privada caminho emparelhamento público.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-311">hello solution toothis problem is toostop cross-advertising routes from hello public peering path toohello private peering path.</span></span>


<span data-ttu-id="3b6f1-312">Informações básicas sobre as rotas definidas pelo usuário estão disponíveis nesta [visão geral](../virtual-network/virtual-networks-udr-overview.md).</span><span class="sxs-lookup"><span data-stu-id="3b6f1-312">Background information on user-defined routes is available in this [overview](../virtual-network/virtual-networks-udr-overview.md).</span></span>

<span data-ttu-id="3b6f1-313">Para obter mais informações sobre o ExpressRoute, consulte [Visão geral técnica do ExpressRoute](../expressroute/expressroute-introduction.md).</span><span class="sxs-lookup"><span data-stu-id="3b6f1-313">For more information about ExpressRoute, see [ExpressRoute technical overview](../expressroute/expressroute-introduction.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="3b6f1-314">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="3b6f1-314">Next steps</span></span>
<span data-ttu-id="3b6f1-315">Saiba como toouse premium mais recursos de cache.</span><span class="sxs-lookup"><span data-stu-id="3b6f1-315">Learn how toouse more premium cache features.</span></span>

* [<span data-ttu-id="3b6f1-316">Camada de Azure Redis Cache Premium toohello Introdução</span><span class="sxs-lookup"><span data-stu-id="3b6f1-316">Introduction toohello Azure Redis Cache Premium tier</span></span>](cache-premium-tier-intro.md)

<!-- IMAGES -->

[redis-cache-vnet]: ./media/cache-how-to-premium-vnet/redis-cache-vnet.png

[redis-cache-vnet-ip]: ./media/cache-how-to-premium-vnet/redis-cache-vnet-ip.png

[redis-cache-vnet-info]: ./media/cache-how-to-premium-vnet/redis-cache-vnet-info.png

