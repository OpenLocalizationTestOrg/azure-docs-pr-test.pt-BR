---
title: aaaMultiple VIP de Balanceador de carga do Azure | Microsoft Docs
description: "Visão geral de Vários VIPs no Azure Load Balancer"
services: load-balancer
documentationcenter: na
author: chkuhtz
manager: narayan
editor: 
ms.assetid: 748e50cd-3087-4c2e-a9e1-ac0ecce4f869
ms.service: load-balancer
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 08/11/2016
ms.author: chkuhtz
ms.openlocfilehash: e186e1248e7d187e7efd0668dc3244465ce3e156
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="multiple-vips-for-azure-load-balancer"></a><span data-ttu-id="8c83c-103">Múltiplos VIPs para o Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="8c83c-103">Multiple VIPs for Azure Load Balancer</span></span>

<span data-ttu-id="8c83c-104">O balanceador de carga do Azure permite balancear os serviços tooload em várias portas, vários endereços IP ou ambos.</span><span class="sxs-lookup"><span data-stu-id="8c83c-104">Azure Load Balancer allows you tooload balance services on multiple ports, multiple IP addresses, or both.</span></span> <span data-ttu-id="8c83c-105">Você pode usar fluxos de balanceamento de carga públicos e internos balanceador definições tooload em um conjunto de máquinas virtuais.</span><span class="sxs-lookup"><span data-stu-id="8c83c-105">You can use public and internal load balancer definitions tooload balance flows across a set of VMs.</span></span>

<span data-ttu-id="8c83c-106">Este artigo descreve os conceitos básicos de saudação dessa capacidade, conceitos importantes e restrições.</span><span class="sxs-lookup"><span data-stu-id="8c83c-106">This article describes hello fundamentals of this ability, important concepts, and constraints.</span></span> <span data-ttu-id="8c83c-107">Se você pretender serviços tooexpose apenas um endereço IP, você pode encontrar instruções simplificadas para [pública](load-balancer-get-started-internet-portal.md) ou [interno](load-balancer-get-started-ilb-arm-portal.md) configurações de Balanceador de carga.</span><span class="sxs-lookup"><span data-stu-id="8c83c-107">If you only intend tooexpose services on one IP address, you can find simplified instructions for [public](load-balancer-get-started-internet-portal.md) or [internal](load-balancer-get-started-ilb-arm-portal.md) load balancer configurations.</span></span> <span data-ttu-id="8c83c-108">Adicionar vários VIPs é a configuração de VIP único tooa incremental.</span><span class="sxs-lookup"><span data-stu-id="8c83c-108">Adding Multiple VIPs is incremental tooa single VIP configuration.</span></span> <span data-ttu-id="8c83c-109">Com os conceitos de saudação neste artigo, você pode expandir uma configuração simplificada a qualquer momento.</span><span class="sxs-lookup"><span data-stu-id="8c83c-109">Using hello concepts in this article, you can expand a simplified configuration at any time.</span></span>

<span data-ttu-id="8c83c-110">Quando você define um Azure Load Balancer, uma configuração front-end e back-end são conectadas às regras.</span><span class="sxs-lookup"><span data-stu-id="8c83c-110">When you define an Azure Load Balancer, a frontend and a backend configuration are connected with rules.</span></span> <span data-ttu-id="8c83c-111">Olá, referenciada pela regra de saudação de investigação de integridade é usado toodetermine como novos fluxos são enviados nó tooa no pool de back-end de saudação.</span><span class="sxs-lookup"><span data-stu-id="8c83c-111">hello health probe referenced by hello rule is used toodetermine how new flows are sent tooa node in hello backend pool.</span></span> <span data-ttu-id="8c83c-112">Olá front-end é definido por um IP Virtual (VIP), que é uma tupla de 3 consiste de um endereço IP (público ou interno), um protocolo de transporte (UDP ou TCP) e um número de porta.</span><span class="sxs-lookup"><span data-stu-id="8c83c-112">hello frontend is defined by a Virtual IP (VIP), which is a 3-tuple comprised of an IP address (public or internal), a transport protocol (UDP or TCP), and a port number.</span></span> <span data-ttu-id="8c83c-113">Um DIP é que um endereço IP em uma NIC virtual do Azure anexados tooa VM no pool de back-end de saudação.</span><span class="sxs-lookup"><span data-stu-id="8c83c-113">A DIP is an IP address on an Azure virtual NIC attached tooa VM in hello backend pool.</span></span>

<span data-ttu-id="8c83c-114">Olá, a tabela a seguir contém alguns exemplos de configurações de front-end:</span><span class="sxs-lookup"><span data-stu-id="8c83c-114">hello following table contains some example frontend configurations:</span></span>

| <span data-ttu-id="8c83c-115">VIP</span><span class="sxs-lookup"><span data-stu-id="8c83c-115">VIP</span></span> | <span data-ttu-id="8c83c-116">Endereço IP</span><span class="sxs-lookup"><span data-stu-id="8c83c-116">IP address</span></span> | <span data-ttu-id="8c83c-117">protocol</span><span class="sxs-lookup"><span data-stu-id="8c83c-117">protocol</span></span> | <span data-ttu-id="8c83c-118">porta</span><span class="sxs-lookup"><span data-stu-id="8c83c-118">port</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="8c83c-119">1</span><span class="sxs-lookup"><span data-stu-id="8c83c-119">1</span></span> |<span data-ttu-id="8c83c-120">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="8c83c-120">65.52.0.1</span></span> |<span data-ttu-id="8c83c-121">TCP</span><span class="sxs-lookup"><span data-stu-id="8c83c-121">TCP</span></span> |<span data-ttu-id="8c83c-122">80</span><span class="sxs-lookup"><span data-stu-id="8c83c-122">80</span></span> |
| <span data-ttu-id="8c83c-123">2</span><span class="sxs-lookup"><span data-stu-id="8c83c-123">2</span></span> |<span data-ttu-id="8c83c-124">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="8c83c-124">65.52.0.1</span></span> |<span data-ttu-id="8c83c-125">TCP</span><span class="sxs-lookup"><span data-stu-id="8c83c-125">TCP</span></span> |<span data-ttu-id="8c83c-126">*8080*</span><span class="sxs-lookup"><span data-stu-id="8c83c-126">*8080*</span></span> |
| <span data-ttu-id="8c83c-127">3</span><span class="sxs-lookup"><span data-stu-id="8c83c-127">3</span></span> |<span data-ttu-id="8c83c-128">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="8c83c-128">65.52.0.1</span></span> |<span data-ttu-id="8c83c-129">*UDP*</span><span class="sxs-lookup"><span data-stu-id="8c83c-129">*UDP*</span></span> |<span data-ttu-id="8c83c-130">80</span><span class="sxs-lookup"><span data-stu-id="8c83c-130">80</span></span> |
| <span data-ttu-id="8c83c-131">4</span><span class="sxs-lookup"><span data-stu-id="8c83c-131">4</span></span> |<span data-ttu-id="8c83c-132">*65.52.0.2*</span><span class="sxs-lookup"><span data-stu-id="8c83c-132">*65.52.0.2*</span></span> |<span data-ttu-id="8c83c-133">TCP</span><span class="sxs-lookup"><span data-stu-id="8c83c-133">TCP</span></span> |<span data-ttu-id="8c83c-134">80</span><span class="sxs-lookup"><span data-stu-id="8c83c-134">80</span></span> |

<span data-ttu-id="8c83c-135">tabela de saudação mostra quatro front-ends diferentes.</span><span class="sxs-lookup"><span data-stu-id="8c83c-135">hello table shows four different frontends.</span></span> <span data-ttu-id="8c83c-136">Os front-ends 1, 2 e 3 são um único VIP com várias regras.</span><span class="sxs-lookup"><span data-stu-id="8c83c-136">Frontends #1, #2 and #3 are a single VIP with multiple rules.</span></span> <span data-ttu-id="8c83c-137">Olá mesmo endereço IP é usado, mas Olá porta ou protocolo é diferente para cada front-end.</span><span class="sxs-lookup"><span data-stu-id="8c83c-137">hello same IP address is used but hello port or protocol is different for each frontend.</span></span> <span data-ttu-id="8c83c-138">Front-ends #1 e &#4; são um exemplo de vários VIPs, onde hello mesma porta e protocolo de front-end são reutilizadas em vários VIPs.</span><span class="sxs-lookup"><span data-stu-id="8c83c-138">Frontends #1 and #4 are an example of Multiple VIPs, where hello same frontend protocol and port are reused across multiple VIPs.</span></span>

<span data-ttu-id="8c83c-139">O balanceador de carga do Azure fornece flexibilidade na definição de regras de balanceamento de carga de saudação.</span><span class="sxs-lookup"><span data-stu-id="8c83c-139">Azure Load Balancer provides flexibility in defining hello load balancing rules.</span></span> <span data-ttu-id="8c83c-140">Uma regra declara como um endereço e porta de front-end Olá é mapeada toohello endereço de destino e a porta no hello back-end.</span><span class="sxs-lookup"><span data-stu-id="8c83c-140">A rule declares how an address and port on hello frontend is mapped toohello destination address and port on hello backend.</span></span> <span data-ttu-id="8c83c-141">Se as portas de back-end são reutilizadas em regras dependem Olá tipo de regra de saudação.</span><span class="sxs-lookup"><span data-stu-id="8c83c-141">Whether or not backend ports are reused across rules depends on hello type of hello rule.</span></span> <span data-ttu-id="8c83c-142">Cada tipo de regra tem requisitos específicos que podem afetar a configuração do host o design da investigação.</span><span class="sxs-lookup"><span data-stu-id="8c83c-142">Each type of rule has specific requirements that can affect host configuration and probe design.</span></span> <span data-ttu-id="8c83c-143">Há dois tipos de regras:</span><span class="sxs-lookup"><span data-stu-id="8c83c-143">There are two types of rules:</span></span>

1. <span data-ttu-id="8c83c-144">reutilização de regra padrão de saudação com nenhuma porta de back-end</span><span class="sxs-lookup"><span data-stu-id="8c83c-144">hello default rule with no backend port reuse</span></span>
2. <span data-ttu-id="8c83c-145">regra de IP flutuante Olá em que as portas de back-end são reutilizadas</span><span class="sxs-lookup"><span data-stu-id="8c83c-145">hello Floating IP rule where backend ports are reused</span></span>

<span data-ttu-id="8c83c-146">O balanceador de carga do Azure permite que você toomix os dois tipos de regra no Olá a mesma configuração de Balanceador de carga.</span><span class="sxs-lookup"><span data-stu-id="8c83c-146">Azure Load Balancer allows you toomix both rule types on hello same load balancer configuration.</span></span> <span data-ttu-id="8c83c-147">Balanceador de carga Olá pode usá-los simultaneamente para uma determinada VM, ou qualquer combinação, desde que você concorde com restrições de saudação da regra de saudação.</span><span class="sxs-lookup"><span data-stu-id="8c83c-147">hello load balancer can use them simultaneously for a given VM, or any combination, as long as you abide by hello constraints of hello rule.</span></span> <span data-ttu-id="8c83c-148">Que tipo de regra que você escolher depende de requisitos de saudação de seu aplicativo e Olá complexidade de dar suporte a essa configuração.</span><span class="sxs-lookup"><span data-stu-id="8c83c-148">Which rule type you choose depends on hello requirements of your application and hello complexity of supporting that configuration.</span></span> <span data-ttu-id="8c83c-149">Você deve avaliar quais tipos de regras são melhores para seu cenário.</span><span class="sxs-lookup"><span data-stu-id="8c83c-149">You should evaluate which rule types are best for your scenario.</span></span>

<span data-ttu-id="8c83c-150">Iniciando com o comportamento padrão de saudação, exploraremos esses cenários ainda mais.</span><span class="sxs-lookup"><span data-stu-id="8c83c-150">We explore these scenarios further by starting with hello default behavior.</span></span>

## <a name="rule-type-1-no-backend-port-reuse"></a><span data-ttu-id="8c83c-151">Tipo de regra 1: nenhuma reutilização de porta de back-end</span><span class="sxs-lookup"><span data-stu-id="8c83c-151">Rule type #1: No backend port reuse</span></span>

![Ilustração de vários VIPs](./media/load-balancer-multivip-overview/load-balancer-multivip.png)

<span data-ttu-id="8c83c-153">Nesse cenário, front-end Olá VIPs são configurados da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="8c83c-153">In this scenario, hello frontend VIPs are configured as follows:</span></span>

| <span data-ttu-id="8c83c-154">VIP</span><span class="sxs-lookup"><span data-stu-id="8c83c-154">VIP</span></span> | <span data-ttu-id="8c83c-155">Endereço IP</span><span class="sxs-lookup"><span data-stu-id="8c83c-155">IP address</span></span> | <span data-ttu-id="8c83c-156">protocol</span><span class="sxs-lookup"><span data-stu-id="8c83c-156">protocol</span></span> | <span data-ttu-id="8c83c-157">porta</span><span class="sxs-lookup"><span data-stu-id="8c83c-157">port</span></span> |
| --- | --- | --- | --- |
| ![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="8c83c-159">1</span><span class="sxs-lookup"><span data-stu-id="8c83c-159">1</span></span> |<span data-ttu-id="8c83c-160">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="8c83c-160">65.52.0.1</span></span> |<span data-ttu-id="8c83c-161">TCP</span><span class="sxs-lookup"><span data-stu-id="8c83c-161">TCP</span></span> |<span data-ttu-id="8c83c-162">80</span><span class="sxs-lookup"><span data-stu-id="8c83c-162">80</span></span> |
| ![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="8c83c-164">2</span><span class="sxs-lookup"><span data-stu-id="8c83c-164">2</span></span> |<span data-ttu-id="8c83c-165">*65.52.0.2*</span><span class="sxs-lookup"><span data-stu-id="8c83c-165">*65.52.0.2*</span></span> |<span data-ttu-id="8c83c-166">TCP</span><span class="sxs-lookup"><span data-stu-id="8c83c-166">TCP</span></span> |<span data-ttu-id="8c83c-167">80</span><span class="sxs-lookup"><span data-stu-id="8c83c-167">80</span></span> |

<span data-ttu-id="8c83c-168">Olá DIP é destino Olá Olá fluxo de entrada.</span><span class="sxs-lookup"><span data-stu-id="8c83c-168">hello DIP is hello destination of hello inbound flow.</span></span> <span data-ttu-id="8c83c-169">No pool de back-end hello, cada VM expõe serviço Olá desejado em uma porta exclusiva em um DIP.</span><span class="sxs-lookup"><span data-stu-id="8c83c-169">In hello backend pool, each VM exposes hello desired service on a unique port on a DIP.</span></span> <span data-ttu-id="8c83c-170">Esse serviço é associado a saudação front-end por meio de uma definição de regra.</span><span class="sxs-lookup"><span data-stu-id="8c83c-170">This service is associated with hello frontend through a rule definition.</span></span>

<span data-ttu-id="8c83c-171">Definimos duas regras:</span><span class="sxs-lookup"><span data-stu-id="8c83c-171">We define two rules:</span></span>

| <span data-ttu-id="8c83c-172">Regra</span><span class="sxs-lookup"><span data-stu-id="8c83c-172">Rule</span></span> | <span data-ttu-id="8c83c-173">Mapear front-end</span><span class="sxs-lookup"><span data-stu-id="8c83c-173">Map frontend</span></span> | <span data-ttu-id="8c83c-174">pool de toobackend</span><span class="sxs-lookup"><span data-stu-id="8c83c-174">toobackend pool</span></span> |
| --- | --- | --- |
| <span data-ttu-id="8c83c-175">1</span><span class="sxs-lookup"><span data-stu-id="8c83c-175">1</span></span> |![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="8c83c-177">VIP1:80</span><span class="sxs-lookup"><span data-stu-id="8c83c-177">VIP1:80</span></span> |![back-end](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="8c83c-179">DIP1:80,</span><span class="sxs-lookup"><span data-stu-id="8c83c-179">DIP1:80,</span></span> ![back-end](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="8c83c-181">DIP2:80</span><span class="sxs-lookup"><span data-stu-id="8c83c-181">DIP2:80</span></span> |
| <span data-ttu-id="8c83c-182">2</span><span class="sxs-lookup"><span data-stu-id="8c83c-182">2</span></span> |![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="8c83c-184">VIP2:80</span><span class="sxs-lookup"><span data-stu-id="8c83c-184">VIP2:80</span></span> |![back-end](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="8c83c-186">DIP1:81,</span><span class="sxs-lookup"><span data-stu-id="8c83c-186">DIP1:81,</span></span> ![back-end](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="8c83c-188">DIP2:81</span><span class="sxs-lookup"><span data-stu-id="8c83c-188">DIP2:81</span></span> |

<span data-ttu-id="8c83c-189">mapeamento completo de saudação no balanceador de carga do Azure agora é o seguinte:</span><span class="sxs-lookup"><span data-stu-id="8c83c-189">hello complete mapping in Azure Load Balancer is now as follows:</span></span>

| <span data-ttu-id="8c83c-190">Regra</span><span class="sxs-lookup"><span data-stu-id="8c83c-190">Rule</span></span> | <span data-ttu-id="8c83c-191">Endereço IP VIP</span><span class="sxs-lookup"><span data-stu-id="8c83c-191">VIP IP address</span></span> | <span data-ttu-id="8c83c-192">protocol</span><span class="sxs-lookup"><span data-stu-id="8c83c-192">protocol</span></span> | <span data-ttu-id="8c83c-193">porta</span><span class="sxs-lookup"><span data-stu-id="8c83c-193">port</span></span> | <span data-ttu-id="8c83c-194">Destino</span><span class="sxs-lookup"><span data-stu-id="8c83c-194">Destination</span></span> | <span data-ttu-id="8c83c-195">porta</span><span class="sxs-lookup"><span data-stu-id="8c83c-195">port</span></span> |
| --- | --- | --- | --- | --- | --- |
| ![Regra](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="8c83c-197">1</span><span class="sxs-lookup"><span data-stu-id="8c83c-197">1</span></span> |<span data-ttu-id="8c83c-198">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="8c83c-198">65.52.0.1</span></span> |<span data-ttu-id="8c83c-199">TCP</span><span class="sxs-lookup"><span data-stu-id="8c83c-199">TCP</span></span> |<span data-ttu-id="8c83c-200">80</span><span class="sxs-lookup"><span data-stu-id="8c83c-200">80</span></span> |<span data-ttu-id="8c83c-201">Endereço IP DIP</span><span class="sxs-lookup"><span data-stu-id="8c83c-201">DIP IP Address</span></span> |<span data-ttu-id="8c83c-202">80</span><span class="sxs-lookup"><span data-stu-id="8c83c-202">80</span></span> |
| ![Regra](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="8c83c-204">2</span><span class="sxs-lookup"><span data-stu-id="8c83c-204">2</span></span> |<span data-ttu-id="8c83c-205">65.52.0.2</span><span class="sxs-lookup"><span data-stu-id="8c83c-205">65.52.0.2</span></span> |<span data-ttu-id="8c83c-206">TCP</span><span class="sxs-lookup"><span data-stu-id="8c83c-206">TCP</span></span> |<span data-ttu-id="8c83c-207">80</span><span class="sxs-lookup"><span data-stu-id="8c83c-207">80</span></span> |<span data-ttu-id="8c83c-208">Endereço IP DIP</span><span class="sxs-lookup"><span data-stu-id="8c83c-208">DIP IP Address</span></span> |<span data-ttu-id="8c83c-209">81</span><span class="sxs-lookup"><span data-stu-id="8c83c-209">81</span></span> |

<span data-ttu-id="8c83c-210">Cada regra deve produzir um fluxo com uma combinação exclusiva de endereço IP de destino e porta de destino.</span><span class="sxs-lookup"><span data-stu-id="8c83c-210">Each rule must produce a flow with a unique combination of destination IP address and destination port.</span></span> <span data-ttu-id="8c83c-211">Por porta de destino Olá variáveis de fluxo de saudação, várias regras podem fornecer fluxos toohello DIP mesmo em portas diferentes.</span><span class="sxs-lookup"><span data-stu-id="8c83c-211">By varying hello destination port of hello flow, multiple rules can deliver flows toohello same DIP on different ports.</span></span>

<span data-ttu-id="8c83c-212">Investigações de integridade são sempre direcionado toohello DIP de uma VM.</span><span class="sxs-lookup"><span data-stu-id="8c83c-212">Health probes are always directed toohello DIP of a VM.</span></span> <span data-ttu-id="8c83c-213">Você deve garantir que sua investigação reflete a integridade de saudação do hello VM.</span><span class="sxs-lookup"><span data-stu-id="8c83c-213">You must ensure you that your probe reflects hello health of hello VM.</span></span>

## <a name="rule-type-2-backend-port-reuse-by-using-floating-ip"></a><span data-ttu-id="8c83c-214">Tipo de regra 2: reutilização de porta de back-end usando o IP Flutuante</span><span class="sxs-lookup"><span data-stu-id="8c83c-214">Rule type #2: backend port reuse by using Floating IP</span></span>

<span data-ttu-id="8c83c-215">O balanceador de carga do Azure fornece flexibilidade de Olá tooreuse porta de front-end de saudação entre vários VIPs independentemente do tipo de regra de saudação usado.</span><span class="sxs-lookup"><span data-stu-id="8c83c-215">Azure Load Balancer provides hello flexibility tooreuse hello frontend port across multiple VIPs regardless of hello rule type used.</span></span> <span data-ttu-id="8c83c-216">Além disso, alguns cenários de aplicativo preferem ou exigem Olá mesmo toobe usado por várias instâncias do aplicativo em uma única VM no pool de back-end de saudação da porta.</span><span class="sxs-lookup"><span data-stu-id="8c83c-216">Additionally, some application scenarios prefer or require hello same port toobe used by multiple application instances on a single VM in hello backend pool.</span></span> <span data-ttu-id="8c83c-217">Exemplos comuns de reutilização de porta incluem clusters de alta disponibilidade, dispositivos virtuais de rede e exposição de vários pontos de extremidade TLS sem nova criptografia.</span><span class="sxs-lookup"><span data-stu-id="8c83c-217">Common examples of port reuse include clustering for high availability, network virtual appliances, and exposing multiple TLS endpoints without re-encryption.</span></span>

<span data-ttu-id="8c83c-218">Se você quiser tooreuse porta de back-end de saudação em várias regras, você deve habilitar o IP flutuante na definição de regra de saudação.</span><span class="sxs-lookup"><span data-stu-id="8c83c-218">If you want tooreuse hello backend port across multiple rules, you must enable Floating IP in hello rule definition.</span></span>

<span data-ttu-id="8c83c-219">IP Flutuante é uma parte do que é conhecido como DSR (retorno de servidor direto).</span><span class="sxs-lookup"><span data-stu-id="8c83c-219">Floating IP is a portion of what is known as Direct Server Return (DSR).</span></span> <span data-ttu-id="8c83c-220">O DSR é formado por duas partes: uma topologia de fluxo e um esquema de mapeamento de endereço IP.</span><span class="sxs-lookup"><span data-stu-id="8c83c-220">DSR consists of two parts: a flow topology and an IP address mapping scheme.</span></span> <span data-ttu-id="8c83c-221">Em um nível de plataforma, o Azure Load Balancer sempre opera em uma topologia de fluxo de DSR, independentemente de o IP Flutuante estar habilitado ou não.</span><span class="sxs-lookup"><span data-stu-id="8c83c-221">At a platform level, Azure Load Balancer always operates in a DSR flow topology regardless of whether Floating IP is enabled or not.</span></span> <span data-ttu-id="8c83c-222">Isso significa que parte de saída de saudação de um fluxo é sempre tooflow corretamente regravada toohello diretamente back origem.</span><span class="sxs-lookup"><span data-stu-id="8c83c-222">This means that hello outbound part of a flow is always correctly rewritten tooflow directly back toohello origin.</span></span>

<span data-ttu-id="8c83c-223">Com o tipo de regra padrão hello, o Azure expõe uma esquema de mapeamento de endereço IP para facilitar o uso de balanceamento de carga tradicional.</span><span class="sxs-lookup"><span data-stu-id="8c83c-223">With hello default rule type, Azure exposes a traditional load balancing IP address mapping scheme for ease of use.</span></span> <span data-ttu-id="8c83c-224">Habilitação de IP flutuante altera Olá tooallow de esquema de mapeamento de endereço IP para obter flexibilidade adicional como explicado abaixo.</span><span class="sxs-lookup"><span data-stu-id="8c83c-224">Enabling Floating IP changes hello IP address mapping scheme tooallow for additional flexibility as explained below.</span></span>

<span data-ttu-id="8c83c-225">Olá diagrama a seguir ilustra essa configuração:</span><span class="sxs-lookup"><span data-stu-id="8c83c-225">hello following diagram illustrates this configuration:</span></span>

![Ilustração de vários VIPs](./media/load-balancer-multivip-overview/load-balancer-multivip-dsr.png)

<span data-ttu-id="8c83c-227">Para este cenário, todas as VMs no pool de back-end Olá tem três interfaces de rede:</span><span class="sxs-lookup"><span data-stu-id="8c83c-227">For this scenario, every VM in hello backend pool has three network interfaces:</span></span>

* <span data-ttu-id="8c83c-228">DIP: uma NIC Virtual associada Olá VM (configuração de IP do recurso NIC do Azure)</span><span class="sxs-lookup"><span data-stu-id="8c83c-228">DIP: a Virtual NIC associated with hello VM (IP configuration of Azure's NIC resource)</span></span>
* <span data-ttu-id="8c83c-229">VIP1: uma interface de loopback no sistema operacional convidado que está configurado com o endereço IP do VIP1</span><span class="sxs-lookup"><span data-stu-id="8c83c-229">VIP1: a loopback interface within guest OS that is configured with IP address of VIP1</span></span>
* <span data-ttu-id="8c83c-230">VIP2: uma interface de loopback no sistema operacional convidado que está configurado com o endereço IP do VIP2</span><span class="sxs-lookup"><span data-stu-id="8c83c-230">VIP2: a loopback interface within guest OS that is configured with IP address of VIP2</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8c83c-231">configuração de saudação de interfaces lógicas Olá é executada no sistema operacional convidado de saudação.</span><span class="sxs-lookup"><span data-stu-id="8c83c-231">hello configuration of hello logical interfaces is performed within hello guest OS.</span></span> <span data-ttu-id="8c83c-232">Essa configuração não é executada ou gerenciada pelo Azure.</span><span class="sxs-lookup"><span data-stu-id="8c83c-232">This configuration is not performed or managed by Azure.</span></span> <span data-ttu-id="8c83c-233">Sem essa configuração, as regras de saudação não funcionará.</span><span class="sxs-lookup"><span data-stu-id="8c83c-233">Without this configuration, hello rules will not function.</span></span> <span data-ttu-id="8c83c-234">As definições de teste de integridade Olá DIP da saudação VM em vez de Olá VIP lógico.</span><span class="sxs-lookup"><span data-stu-id="8c83c-234">Health probe definitions use hello DIP of hello VM rather than hello logical VIP.</span></span> <span data-ttu-id="8c83c-235">Portanto, seu serviço deve fornecer as respostas de teste em uma porta DIP que refletem o status de saudação do serviço de saudação oferecido no VIP lógico hello.</span><span class="sxs-lookup"><span data-stu-id="8c83c-235">Therefore, your service must provide probe responses on a DIP port that reflect hello status of hello service offered on hello logical VIP.</span></span>

<span data-ttu-id="8c83c-236">Vamos supor que Olá mesma configuração de front-end, como no cenário anterior hello:</span><span class="sxs-lookup"><span data-stu-id="8c83c-236">Let's assume hello same frontend configuration as in hello previous scenario:</span></span>

| <span data-ttu-id="8c83c-237">VIP</span><span class="sxs-lookup"><span data-stu-id="8c83c-237">VIP</span></span> | <span data-ttu-id="8c83c-238">Endereço IP</span><span class="sxs-lookup"><span data-stu-id="8c83c-238">IP address</span></span> | <span data-ttu-id="8c83c-239">protocol</span><span class="sxs-lookup"><span data-stu-id="8c83c-239">protocol</span></span> | <span data-ttu-id="8c83c-240">porta</span><span class="sxs-lookup"><span data-stu-id="8c83c-240">port</span></span> |
| --- | --- | --- | --- |
| ![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="8c83c-242">1</span><span class="sxs-lookup"><span data-stu-id="8c83c-242">1</span></span> |<span data-ttu-id="8c83c-243">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="8c83c-243">65.52.0.1</span></span> |<span data-ttu-id="8c83c-244">TCP</span><span class="sxs-lookup"><span data-stu-id="8c83c-244">TCP</span></span> |<span data-ttu-id="8c83c-245">80</span><span class="sxs-lookup"><span data-stu-id="8c83c-245">80</span></span> |
| ![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="8c83c-247">2</span><span class="sxs-lookup"><span data-stu-id="8c83c-247">2</span></span> |<span data-ttu-id="8c83c-248">*65.52.0.2*</span><span class="sxs-lookup"><span data-stu-id="8c83c-248">*65.52.0.2*</span></span> |<span data-ttu-id="8c83c-249">TCP</span><span class="sxs-lookup"><span data-stu-id="8c83c-249">TCP</span></span> |<span data-ttu-id="8c83c-250">80</span><span class="sxs-lookup"><span data-stu-id="8c83c-250">80</span></span> |

<span data-ttu-id="8c83c-251">Definimos duas regras:</span><span class="sxs-lookup"><span data-stu-id="8c83c-251">We define two rules:</span></span>

| <span data-ttu-id="8c83c-252">Regra</span><span class="sxs-lookup"><span data-stu-id="8c83c-252">Rule</span></span> | <span data-ttu-id="8c83c-253">Mapear front-end</span><span class="sxs-lookup"><span data-stu-id="8c83c-253">Map frontend</span></span> | <span data-ttu-id="8c83c-254">pool de toobackend</span><span class="sxs-lookup"><span data-stu-id="8c83c-254">toobackend pool</span></span> |
| --- | --- | --- |
| <span data-ttu-id="8c83c-255">1</span><span class="sxs-lookup"><span data-stu-id="8c83c-255">1</span></span> |![Regra](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="8c83c-257">VIP1:80</span><span class="sxs-lookup"><span data-stu-id="8c83c-257">VIP1:80</span></span> |![back-end](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="8c83c-259">VIP1:80 (na VM1 e VM2)</span><span class="sxs-lookup"><span data-stu-id="8c83c-259">VIP1:80 (in VM1 and VM2)</span></span> |
| <span data-ttu-id="8c83c-260">2</span><span class="sxs-lookup"><span data-stu-id="8c83c-260">2</span></span> |![Regra](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="8c83c-262">VIP2:80</span><span class="sxs-lookup"><span data-stu-id="8c83c-262">VIP2:80</span></span> |![back-end](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="8c83c-264">VIP2:80 (na VM1 e VM2)</span><span class="sxs-lookup"><span data-stu-id="8c83c-264">VIP2:80 (in VM1 and VM2)</span></span> |

<span data-ttu-id="8c83c-265">Olá a tabela a seguir mostra o mapeamento de conclusão Olá no balanceador de carga de saudação:</span><span class="sxs-lookup"><span data-stu-id="8c83c-265">hello following table shows hello complete mapping in hello load balancer:</span></span>

| <span data-ttu-id="8c83c-266">Regra</span><span class="sxs-lookup"><span data-stu-id="8c83c-266">Rule</span></span> | <span data-ttu-id="8c83c-267">Endereço IP VIP</span><span class="sxs-lookup"><span data-stu-id="8c83c-267">VIP IP address</span></span> | <span data-ttu-id="8c83c-268">protocol</span><span class="sxs-lookup"><span data-stu-id="8c83c-268">protocol</span></span> | <span data-ttu-id="8c83c-269">porta</span><span class="sxs-lookup"><span data-stu-id="8c83c-269">port</span></span> | <span data-ttu-id="8c83c-270">Destino</span><span class="sxs-lookup"><span data-stu-id="8c83c-270">Destination</span></span> | <span data-ttu-id="8c83c-271">porta</span><span class="sxs-lookup"><span data-stu-id="8c83c-271">port</span></span> |
| --- | --- | --- | --- | --- | --- |
| ![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="8c83c-273">1</span><span class="sxs-lookup"><span data-stu-id="8c83c-273">1</span></span> |<span data-ttu-id="8c83c-274">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="8c83c-274">65.52.0.1</span></span> |<span data-ttu-id="8c83c-275">TCP</span><span class="sxs-lookup"><span data-stu-id="8c83c-275">TCP</span></span> |<span data-ttu-id="8c83c-276">80</span><span class="sxs-lookup"><span data-stu-id="8c83c-276">80</span></span> |<span data-ttu-id="8c83c-277">mesmo que o VIP (65.52.0.1)</span><span class="sxs-lookup"><span data-stu-id="8c83c-277">same as VIP (65.52.0.1)</span></span> |<span data-ttu-id="8c83c-278">mesmo que o VIP (80)</span><span class="sxs-lookup"><span data-stu-id="8c83c-278">same as VIP (80)</span></span> |
| ![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="8c83c-280">2</span><span class="sxs-lookup"><span data-stu-id="8c83c-280">2</span></span> |<span data-ttu-id="8c83c-281">65.52.0.2</span><span class="sxs-lookup"><span data-stu-id="8c83c-281">65.52.0.2</span></span> |<span data-ttu-id="8c83c-282">TCP</span><span class="sxs-lookup"><span data-stu-id="8c83c-282">TCP</span></span> |<span data-ttu-id="8c83c-283">80</span><span class="sxs-lookup"><span data-stu-id="8c83c-283">80</span></span> |<span data-ttu-id="8c83c-284">mesmo que o VIP (65.52.0.2)</span><span class="sxs-lookup"><span data-stu-id="8c83c-284">same as VIP (65.52.0.2)</span></span> |<span data-ttu-id="8c83c-285">mesmo que o VIP (80)</span><span class="sxs-lookup"><span data-stu-id="8c83c-285">same as VIP (80)</span></span> |

<span data-ttu-id="8c83c-286">destino de saudação do hello fluxo de entrada é o endereço de saudação VIP na interface de loopback Olá Olá VM.</span><span class="sxs-lookup"><span data-stu-id="8c83c-286">hello destination of hello inbound flow is hello VIP address on hello loopback interface in hello VM.</span></span> <span data-ttu-id="8c83c-287">Cada regra deve produzir um fluxo com uma combinação exclusiva de endereço IP de destino e porta de destino.</span><span class="sxs-lookup"><span data-stu-id="8c83c-287">Each rule must produce a flow with a unique combination of destination IP address and destination port.</span></span> <span data-ttu-id="8c83c-288">Por variados Olá endereço IP de destino do fluxo de saudação de reutilização de porta é possível em Olá mesma VM.</span><span class="sxs-lookup"><span data-stu-id="8c83c-288">By varying hello destination IP address of hello flow, port reuse is possible on hello same VM.</span></span> <span data-ttu-id="8c83c-289">O serviço é exposto toohello balanceador de carga vinculando-o endereço IP e a porta de interface de loopback do respectivos Olá toohello do VIP.</span><span class="sxs-lookup"><span data-stu-id="8c83c-289">Your service is exposed toohello load balancer by binding it toohello VIP’s IP address and port of hello respective loopback interface.</span></span>

<span data-ttu-id="8c83c-290">Observe que este exemplo não alterar a porta de destino hello.</span><span class="sxs-lookup"><span data-stu-id="8c83c-290">Notice that this example does not change hello destination port.</span></span> <span data-ttu-id="8c83c-291">Embora esse seja um cenário de IP flutuante, balanceador de carga do Azure também oferece suporte a definição de uma porta de destino regra toorewrite Olá back-end e toomake-diferente da porta de destino do hello front-end.</span><span class="sxs-lookup"><span data-stu-id="8c83c-291">Even though this is a Floating IP scenario, Azure Load Balancer also supports defining a rule toorewrite hello backend destination port and toomake it different from hello frontend destination port.</span></span>

<span data-ttu-id="8c83c-292">Olá tipo de regra de IP flutuante é a base de saudação de vários padrões de configuração de Balanceador de carga.</span><span class="sxs-lookup"><span data-stu-id="8c83c-292">hello Floating IP rule type is hello foundation of several load balancer configuration patterns.</span></span> <span data-ttu-id="8c83c-293">Um exemplo que está disponível no momento é hello [AlwaysOn do SQL com vários ouvintes](../virtual-machines/windows/sql/virtual-machines-windows-portal-sql-ps-alwayson-int-listener.md) configuração.</span><span class="sxs-lookup"><span data-stu-id="8c83c-293">One example that is currently available is hello [SQL AlwaysOn with Multiple Listeners](../virtual-machines/windows/sql/virtual-machines-windows-portal-sql-ps-alwayson-int-listener.md) configuration.</span></span> <span data-ttu-id="8c83c-294">Ao longo do tempo, documentaremos mais esses cenários.</span><span class="sxs-lookup"><span data-stu-id="8c83c-294">Over time, we will document more of these scenarios.</span></span>

## <a name="limitations"></a><span data-ttu-id="8c83c-295">Limitações</span><span class="sxs-lookup"><span data-stu-id="8c83c-295">Limitations</span></span>

* <span data-ttu-id="8c83c-296">Há suporte para várias configurações de VIP apenas com VMs de IaaS.</span><span class="sxs-lookup"><span data-stu-id="8c83c-296">Multiple VIP configurations are only supported with IaaS VMs.</span></span>
* <span data-ttu-id="8c83c-297">Com a regra de IP flutuante hello, seu aplicativo deve usar Olá DIP para fluxos de saída.</span><span class="sxs-lookup"><span data-stu-id="8c83c-297">With hello Floating IP rule, your application must use hello DIP for outbound flows.</span></span> <span data-ttu-id="8c83c-298">Se seu aplicativo associa toohello VIP endereço configurado na interface de loopback Olá no sistema operacional convidado de hello, em seguida, SNAT não é fluxo de saída de hello toorewrite disponíveis e fluxo Olá falha.</span><span class="sxs-lookup"><span data-stu-id="8c83c-298">If your application binds toohello VIP address configured on hello loopback interface in hello guest OS, then SNAT is not available toorewrite hello outbound flow and hello flow fails.</span></span>
* <span data-ttu-id="8c83c-299">Endereços IP públicos têm um efeito sobre a cobrança.</span><span class="sxs-lookup"><span data-stu-id="8c83c-299">Public IP addresses have an effect on billing.</span></span> <span data-ttu-id="8c83c-300">Para saber mais, confira [Preços de endereço IP](https://azure.microsoft.com/pricing/details/ip-addresses/)</span><span class="sxs-lookup"><span data-stu-id="8c83c-300">For more information, see [IP Address pricing](https://azure.microsoft.com/pricing/details/ip-addresses/)</span></span>
* <span data-ttu-id="8c83c-301">Limites de assinatura são aplicados.</span><span class="sxs-lookup"><span data-stu-id="8c83c-301">Subscription limits apply.</span></span> <span data-ttu-id="8c83c-302">Para saber mais, confira [Limites de serviço](../azure-subscription-service-limits.md#networking-limits) .</span><span class="sxs-lookup"><span data-stu-id="8c83c-302">For more information, see [Service limits](../azure-subscription-service-limits.md#networking-limits) for details.</span></span>
