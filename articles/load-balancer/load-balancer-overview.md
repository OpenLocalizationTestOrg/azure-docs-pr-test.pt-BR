---
title: "Visão geral do Azure Load Balancer | Microsoft Docs"
description: "Visão geral dos recursos do Balanceador de Carga do Azure, arquitetura e implementação. Saiba como o balanceador de carga funciona e como aproveitá-lo na nuvem."
services: load-balancer
documentationcenter: na
author: kumudd
manager: timlt
editor: 
ms.assetid: 0f313dc0-f007-4cee-b2b9-f542357925a3
ms.service: load-balancer
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 10/24/2016
ms.author: kumud
ms.openlocfilehash: 617da1cf41db08d319d6fe9fa7bc96b794a0001e
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/03/2017
---
# <a name="azure-load-balancer-overview"></a><span data-ttu-id="5a9b8-104">Visão geral do Balanceador de Carga do Azure</span><span class="sxs-lookup"><span data-stu-id="5a9b8-104">Azure Load Balancer overview</span></span>

<span data-ttu-id="5a9b8-105">O Balanceador de Carga do Azure oferece alta disponibilidade e desempenho de rede para seus aplicativos.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-105">Azure Load Balancer delivers high availability and network performance to your applications.</span></span> <span data-ttu-id="5a9b8-106">É um balanceador de carga do tipo Camada 4 (TCP, UDP) que distribui o tráfego de entrada entre as instâncias de serviço íntegras definidas em um conjunto de balanceadores de carga.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-106">It is a Layer 4 (TCP, UDP) load balancer that distributes incoming traffic among healthy instances of services defined in a load-balanced set.</span></span>

<span data-ttu-id="5a9b8-107">O Azure Load Balancer pode ser configurado para:</span><span class="sxs-lookup"><span data-stu-id="5a9b8-107">Azure Load Balancer can be configured to:</span></span>

* <span data-ttu-id="5a9b8-108">Balancear carga de tráfego de entrada na Internet para máquinas virtuais.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-108">Load balance incoming Internet traffic to virtual machines.</span></span> <span data-ttu-id="5a9b8-109">Essa configuração é conhecida como [balanceamento de carga voltada para a Internet](load-balancer-internet-overview.md).</span><span class="sxs-lookup"><span data-stu-id="5a9b8-109">This configuration is known as [Internet-facing load balancing](load-balancer-internet-overview.md).</span></span>
* <span data-ttu-id="5a9b8-110">Balanceie o tráfego de carga entre as máquinas virtuais em uma rede virtual, entre as máquinas virtuais nos serviços de nuvem ou entre os computadores locais e as máquinas virtuais em uma rede virtual entre as instalações.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-110">Load balance traffic between virtual machines in a virtual network, between virtual machines in cloud services, or between on-premises computers and virtual machines in a cross-premises virtual network.</span></span> <span data-ttu-id="5a9b8-111">Essa configuração é conhecida como [balanceamento de carga interno](load-balancer-internal-overview.md).</span><span class="sxs-lookup"><span data-stu-id="5a9b8-111">This configuration is known as [internal load balancing](load-balancer-internal-overview.md).</span></span>
* <span data-ttu-id="5a9b8-112">Encaminhe o tráfego externo para uma máquina virtual específica.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-112">Forward external traffic to a specific virtual machine.</span></span>

<span data-ttu-id="5a9b8-113">Todos os recursos na nuvem precisam de um endereço IP público para serem acessíveis pela Internet.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-113">All resources in the cloud need a public IP address to be reachable from the Internet.</span></span> <span data-ttu-id="5a9b8-114">A infraestrutura de nuvem no Azure usa endereços IP não roteáveis para seus recursos.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-114">The cloud infrastructure in Azure uses non-routable IP addresses for its resources.</span></span> <span data-ttu-id="5a9b8-115">O Azure usa a conversão de endereços de rede (NAT) com os endereços IP públicos para se comunicar com a Internet.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-115">Azure uses network address translation (NAT) with public IP addresses to communicate to the Internet.</span></span>

## <a name="azure-deployment-models"></a><span data-ttu-id="5a9b8-116">Modelos de implantação do Azure</span><span class="sxs-lookup"><span data-stu-id="5a9b8-116">Azure deployment models</span></span>

<span data-ttu-id="5a9b8-117">É importante entender as diferenças entre os [modelos de implantação](../azure-resource-manager/resource-manager-deployment-model.md)clássico e de Resource Manager do Azure.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-117">It's important to understand the differences between the Azure classic and Resource Manager [deployment models](../azure-resource-manager/resource-manager-deployment-model.md).</span></span> <span data-ttu-id="5a9b8-118">O Azure Load Balancer está configurado de forma diferente em cada modelo.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-118">Azure Load Balancer is configured differently in each model.</span></span>

### <a name="azure-classic-deployment-model"></a><span data-ttu-id="5a9b8-119">modelo de implantação clássico do Azure</span><span class="sxs-lookup"><span data-stu-id="5a9b8-119">Azure classic deployment model</span></span>

<span data-ttu-id="5a9b8-120">As máquinas virtuais implantadas dentro de um limite de serviço de nuvem podem ser agrupadas para usar um balanceador de carga.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-120">Virtual machines deployed within a cloud service boundary can be grouped to use a load balancer.</span></span> <span data-ttu-id="5a9b8-121">Nesse modelo, um endereço IP público e um FQDN (Nome de Domínio Totalmente Qualificado) são atribuídos a um serviço de nuvem.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-121">In this model a public IP address and a Fully Qualified Domain Name, (FQDN) are assigned to a cloud service.</span></span> <span data-ttu-id="5a9b8-122">O balanceador de carga fará a conversão da porta e balanceará a carga do tráfego da rede utilizando o endereço IP público do serviço de nuvem.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-122">The load balancer does port translation and load balances the network traffic by using the public IP address for the cloud service.</span></span>

<span data-ttu-id="5a9b8-123">O tráfego de balanceamento de carga é definido por pontos de extremidade.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-123">Load-balanced traffic is defined by endpoints.</span></span> <span data-ttu-id="5a9b8-124">Os pontos de extremidade de conversão da porta têm uma relação de um para um entre a porta pública atribuída do endereço IP público e a porta local atribuída ao serviço em uma máquina virtual específica.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-124">Port translation endpoints have a one-to-one relationship between the public-assigned port of the public IP address and the local port assigned to the service on a specific virtual machine.</span></span> <span data-ttu-id="5a9b8-125">Os pontos de extremidade de balanceamento de carga são uma relação de um para muitos entre o endereço IP público e as portas locais atribuídas aos serviços nas máquinas virtuais no serviço de nuvem.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-125">Load balancing endpoints have a one-to-many relationship between the public IP address and the local ports assigned to the services on the virtual machines in the cloud service.</span></span>

![Azure Load Balancer no modelo de implantação clássico](./media/load-balancer-overview/asm-lb.png)

<span data-ttu-id="5a9b8-127">Figura 1 – Azure Load Balancer no modelo de implantação clássico</span><span class="sxs-lookup"><span data-stu-id="5a9b8-127">Figure 1 - Azure Load Balancer in the classic deployment model</span></span>

<span data-ttu-id="5a9b8-128">O rótulo do domínio para o endereço IP público que um balanceador de carga usa nesse modelo de implantação é \<nome do serviço de nuvem\>.cloudapp.net.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-128">The domain label for the public IP address that the load balancer uses for this deployment model is \<cloud service name\>.cloudapp.net.</span></span> <span data-ttu-id="5a9b8-129">O gráfico a seguir mostra o Azure Load Balancer nesse modelo.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-129">The following graphic shows the Azure Load Balancer in this model.</span></span>

### <a name="azure-resource-manager-deployment-model"></a><span data-ttu-id="5a9b8-130">modelo de implantação do Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="5a9b8-130">Azure Resource Manager deployment model</span></span>

<span data-ttu-id="5a9b8-131">No modelo de implantação do Resource Manager não é necessário criar um serviço de nuvem.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-131">In the Resource Manager deployment model there is no need to create a Cloud service.</span></span> <span data-ttu-id="5a9b8-132">O balanceador de carga é criado para rotear explicitamente o tráfego entre várias máquinas virtuais.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-132">The load balancer is created to explicitly route traffic among multiple virtual machines.</span></span>

<span data-ttu-id="5a9b8-133">Um endereço IP público é um recurso individual que tem um rótulo de domínio (nome DNS).</span><span class="sxs-lookup"><span data-stu-id="5a9b8-133">A public IP address is an individual resource that has a domain label (DNS name).</span></span> <span data-ttu-id="5a9b8-134">O endereço IP público é associado ao recurso do balanceador de carga.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-134">The public IP address is associated with the load balancer resource.</span></span> <span data-ttu-id="5a9b8-135">As regras do balanceador de carga e as regras NAT de entrada usam o endereço IP público como o ponto de extremidade da Internet para os recursos que estão recebendo o tráfego de rede com balanceamento de carga.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-135">Load balancer rules and inbound NAT rules use the public IP address as the Internet endpoint for the resources that are receiving load-balanced network traffic.</span></span>

<span data-ttu-id="5a9b8-136">Um endereço IP privado ou público é atribuído ao recurso de interface de rede anexado à máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-136">A private or public IP address is assigned to the network interface resource attached to a virtual machine.</span></span> <span data-ttu-id="5a9b8-137">Quando uma interface de rede é adicionada a um pool de endereços IP de back-end do balanceador de carga, o balanceador de carga consegue enviar o tráfego de rede com carga balanceada baseado nas regras de balanceamento de carga criadas.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-137">Once a network interface is added to a load balancer's back-end IP address pool, the load balancer is able to send load-balanced network traffic based on the load-balanced rules that are created.</span></span>

<span data-ttu-id="5a9b8-138">O gráfico a seguir mostra o Azure Load Balancer nesse modelo:</span><span class="sxs-lookup"><span data-stu-id="5a9b8-138">The following graphic shows the Azure Load Balancer in this model:</span></span>

![Azure Load Balancer no Gerenciador de Recursos](./media/load-balancer-overview/arm-lb.png)

<span data-ttu-id="5a9b8-140">Figura 2 – Azure Load Balancer no Resource Manager</span><span class="sxs-lookup"><span data-stu-id="5a9b8-140">Figure 2 - Azure Load Balancer in Resource Manager</span></span>

<span data-ttu-id="5a9b8-141">O balanceador de carga pode ser gerenciado usando ferramentas, modelos e APIs baseadas no Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-141">The load balancer can be managed through Resource Manager-based templates, APIs, and tools.</span></span> <span data-ttu-id="5a9b8-142">Para saber mais sobre o Resource Manager, consulte [Resource Manager overview (Visão geral do Resource Manager)](../azure-resource-manager/resource-group-overview.md).</span><span class="sxs-lookup"><span data-stu-id="5a9b8-142">To learn more about Resource Manager, see the [Resource Manager overview](../azure-resource-manager/resource-group-overview.md).</span></span>

## <a name="load-balancer-features"></a><span data-ttu-id="5a9b8-143">Recursos do balanceador de carga</span><span class="sxs-lookup"><span data-stu-id="5a9b8-143">Load Balancer features</span></span>

* <span data-ttu-id="5a9b8-144">Distribuição baseada em hash</span><span class="sxs-lookup"><span data-stu-id="5a9b8-144">Hash-based distribution</span></span>

    <span data-ttu-id="5a9b8-145">O Balanceador de Carga do Azure usa um algoritmo de distribuição baseado em hash.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-145">Azure Load Balancer uses a hash-based distribution algorithm.</span></span> <span data-ttu-id="5a9b8-146">Por padrão, ele usa um hash de 5 tuplas composto por IP de origem, porta de origem, IP de destino, porta de destino e tipo de protocolo para mapear o tráfego até os servidores disponíveis.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-146">By default, it uses a 5-tuple hash composed of source IP, source port, destination IP, destination port, and protocol type to map traffic to available servers.</span></span> <span data-ttu-id="5a9b8-147">Ele fornece permanência somente *dentro* de uma sessão de transporte.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-147">It provides stickiness only *within* a transport session.</span></span> <span data-ttu-id="5a9b8-148">Os pacotes na mesma sessão TCP ou UDP serão direcionados para a mesma instância atrás do ponto de extremidade de balanceamento de carga.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-148">Packets in the same TCP or UDP session will be directed to the same instance behind the load-balanced endpoint.</span></span> <span data-ttu-id="5a9b8-149">Quando o cliente fecha e reabre a conexão ou inicia uma nova sessão no mesmo IP de origem, a porta de origem é alterada.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-149">When the client closes and reopens the connection or starts a new session from the same source IP, the source port changes.</span></span> <span data-ttu-id="5a9b8-150">Isso pode fazer com que o tráfego vá para um ponto de extremidade diferente em um datacenter diferente.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-150">This may cause the traffic to go to a different endpoint in a different datacenter.</span></span>

    <span data-ttu-id="5a9b8-151">Para obter mais detalhes, consulte [Modo de distribuição do balanceador de carga](load-balancer-distribution-mode.md).</span><span class="sxs-lookup"><span data-stu-id="5a9b8-151">For more details, see [Load balancer distribution mode](load-balancer-distribution-mode.md).</span></span> <span data-ttu-id="5a9b8-152">O gráfico a seguir mostra a distribuição baseada em hash:</span><span class="sxs-lookup"><span data-stu-id="5a9b8-152">The following graphic shows the hash-based distribution:</span></span>

    ![Distribuição baseada em hash](./media/load-balancer-overview/load-balancer-distribution.png)

    <span data-ttu-id="5a9b8-154">Figura 3 – Distribuição baseada em hash</span><span class="sxs-lookup"><span data-stu-id="5a9b8-154">Figure 3 - Hash based distribution</span></span>

* <span data-ttu-id="5a9b8-155">Encaminhamento de porta</span><span class="sxs-lookup"><span data-stu-id="5a9b8-155">Port forwarding</span></span>

    <span data-ttu-id="5a9b8-156">O Balanceador de Carga do Azure oferece-lhe controle sobre como a comunicação de entrada é gerenciada.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-156">Azure Load Balancer gives you control over how inbound communication is managed.</span></span> <span data-ttu-id="5a9b8-157">Essa comunicação inclui o tráfego iniciado de hosts da Internet ou de máquinas virtuais em outros serviços de nuvem ou redes virtuais.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-157">This communication includes traffic initiated from Internet hosts, virtual machines in other cloud services, or virtual networks.</span></span> <span data-ttu-id="5a9b8-158">Esse controle é representado por um ponto de extremidade (também chamado de ponto de extremidade de entrada).</span><span class="sxs-lookup"><span data-stu-id="5a9b8-158">This control is represented by an endpoint (also called an input endpoint).</span></span>

    <span data-ttu-id="5a9b8-159">Um ponto de extremidade de entrada escuta em uma porta pública e encaminha o tráfego para uma porta interna.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-159">An input endpoint listens on a public port and forwards traffic to an internal port.</span></span> <span data-ttu-id="5a9b8-160">Você pode mapear as mesmas portas para um ponto de extremidade interno ou externo ou usar uma porta diferente para eles.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-160">You can map the same ports for an internal or external endpoint or use a different port for them.</span></span> <span data-ttu-id="5a9b8-161">Por exemplo, você pode ter uma escuta configurada no servidor Web para a porta 81 enquanto o mapeamento do ponto de extremidade público é a porta 80.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-161">For example, you can have a web server configured to listen to port 81 while the public endpoint mapping is port 80.</span></span> <span data-ttu-id="5a9b8-162">A criação de um ponto de extremidade público dispara a criação de uma instância do balanceador de carga.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-162">The creation of a public endpoint triggers the creation of a load balancer instance.</span></span>

    <span data-ttu-id="5a9b8-163">Quando ele é criado usando o portal do Azure, o portal cria automaticamente pontos de extremidade na máquina virtual para o protocolo RDP (Remote Desktop Protocol) e para o tráfego de sessão remota do Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-163">When created using the Azure portal, the portal automatically creates endpoints to the virtual machine for the Remote Desktop Protocol (RDP) and remote Windows PowerShell session traffic.</span></span> <span data-ttu-id="5a9b8-164">Você pode usar esses pontos de extremidade para administrar remotamente a máquina virtual pela Internet.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-164">You can use these endpoints to remotely administer the virtual machine over the Internet.</span></span>

* <span data-ttu-id="5a9b8-165">Reconfiguração automática</span><span class="sxs-lookup"><span data-stu-id="5a9b8-165">Automatic reconfiguration</span></span>

    <span data-ttu-id="5a9b8-166">O Balanceador de Carga do Azure reconfigura-se instantaneamente quando você aumenta ou diminui as instâncias.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-166">Azure Load Balancer instantly reconfigures itself when you scale instances up or down.</span></span> <span data-ttu-id="5a9b8-167">Por exemplo, essa reconfiguração acontece quando você aumenta a contagem de instâncias da função de trabalho/Web em um serviço de nuvem ou quando coloca máquinas virtuais adicionais no mesmo conjunto de balanceamento de carga.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-167">For example, this reconfiguration happens when you increase the instance count for web/worker roles in a cloud service or when you add additional virtual machines into the same load-balanced set.</span></span>

* <span data-ttu-id="5a9b8-168">Monitoramento do serviço</span><span class="sxs-lookup"><span data-stu-id="5a9b8-168">Service monitoring</span></span>

    <span data-ttu-id="5a9b8-169">O Azure Load Balancer pode testar a integridade de várias instâncias de servidor.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-169">Azure Load Balancer can probe the health of the various server instances.</span></span> <span data-ttu-id="5a9b8-170">Quando uma investigação não responde, o balanceador de carga interrompe o envio de novas conexões para as instâncias não íntegras.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-170">When a probe fails to respond, the load balancer stops sending new connections to the unhealthy instances.</span></span> <span data-ttu-id="5a9b8-171">As conexões existentes não são afetadas.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-171">Existing connections are not impacted.</span></span>

    <span data-ttu-id="5a9b8-172">Existem três tipos de investigação com suporte:</span><span class="sxs-lookup"><span data-stu-id="5a9b8-172">Three types of probes are supported:</span></span>

    + <span data-ttu-id="5a9b8-173">**Investigação de agente convidado (somente em máquinas virtuais de plataforma como serviço):** o balanceador de carga utiliza o agente convidado dentro da máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-173">**Guest agent probe (on Platform as a Service Virtual Machines only):** The load balancer utilizes the guest agent inside the virtual machine.</span></span> <span data-ttu-id="5a9b8-174">O agente convidado escuta e responde com uma resposta HTTP 200 OK somente quando a instância está no estado Pronto (ou seja, a instância não está em um estado ocupado, reciclando ou interrompendo).</span><span class="sxs-lookup"><span data-stu-id="5a9b8-174">The guest agent listens and responds with an HTTP 200 OK response only when the instance is in the ready state (i.e. the instance is not in a state like busy, recycling, or stopping).</span></span> <span data-ttu-id="5a9b8-175">Se o agente não responder com HTTP 200 OK, o balanceador de carga marcará a instância como sem resposta e interromperá o envio de tráfego para essa instância.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-175">If the agent fails to respond with an HTTP 200 OK, the load balancer marks the instance as unresponsive and stops sending traffic to that instance.</span></span> <span data-ttu-id="5a9b8-176">O balanceador de carga continuará executando o ping nessa instância.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-176">The load balancer continues to ping the instance.</span></span> <span data-ttu-id="5a9b8-177">Se o agente convidado responder com um HTTP 200, o balanceador de carga enviará o tráfego para essa instância novamente.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-177">If the guest agent responds with an HTTP 200, the load balancer will send traffic to that instance again.</span></span> <span data-ttu-id="5a9b8-178">Quando você está usando uma função web, o código do site geralmente é executado no w3wp.exe, que não é monitorado pela malha do Azure nem pelo agente convidado.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-178">When you're using a web role, your website code typically runs in w3wp.exe, which is not monitored by the Azure fabric or guest agent.</span></span> <span data-ttu-id="5a9b8-179">Isso significa que as falhas no w3wp.exe (por exemplo, as respostas HTTP 500) não serão relatadas para o agente convidado e o balanceador de carga não saberá retirar essa instância da rotação.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-179">This means that failures in w3wp.exe (e.g. HTTP 500 responses) will not be reported to the guest agent, and the load balancer will not know to take that instance out of rotation.</span></span>
    + <span data-ttu-id="5a9b8-180">**Investigação HTTP personalizada:** essa investigação substitui a investigação padrão (agente convidado).</span><span class="sxs-lookup"><span data-stu-id="5a9b8-180">**HTTP custom probe:** This probe overrides the default (guest agent) probe.</span></span> <span data-ttu-id="5a9b8-181">Você pode usá-la para criar sua própria lógica personalizada para determinar a integridade da instância de função.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-181">You can use it to create your own custom logic to determine the health of the role instance.</span></span> <span data-ttu-id="5a9b8-182">O balanceador de carga investigará regularmente seu ponto de extremidade (a cada 15 segundos, por padrão).</span><span class="sxs-lookup"><span data-stu-id="5a9b8-182">The load balancer will regularly probe your endpoint (every 15 seconds, by default).</span></span> <span data-ttu-id="5a9b8-183">A instância é considerada em rotação se responder com um TCP ACK ou HTTP 200 dentro do período de tempo limite (padrão de 31 segundos).</span><span class="sxs-lookup"><span data-stu-id="5a9b8-183">The instance is considered to be in rotation if it responds with a TCP ACK or HTTP 200 within the timeout period (default of 31 seconds).</span></span> <span data-ttu-id="5a9b8-184">Isso é útil para implementar sua própria lógica para remover as instâncias da rotação do balanceador de carga.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-184">This is useful for implementing your own logic to remove instances from the load balancer's rotation.</span></span> <span data-ttu-id="5a9b8-185">Por exemplo, você pode configurar a instância para retornar um status não 200 se a instância estiver acima de 90% da CPU.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-185">For example, you can configure the instance to return a non-200 status if the instance is above 90% CPU.</span></span> <span data-ttu-id="5a9b8-186">Para as funções da Web que usam o w3wp.exe, você também obtém um monitoramento automático do seu site, pois as falhas no código do site retornam um status não 200 para a investigação.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-186">For web roles that use w3wp.exe, you also get automatic monitoring of your website, since failures in your website code return a non-200 status to the probe.</span></span>
    + <span data-ttu-id="5a9b8-187">**Investigação TCP personalizada:** essa investigação depende do estabelecimento bem-sucedido da sessão de TCP em uma porta de investigação definida.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-187">**TCP custom probe:** This probe relies on successful TCP session establishment to a defined probe port.</span></span>

    <span data-ttu-id="5a9b8-188">Para obter mais informações, consulte o [esquema LoadBalancerProbe](https://msdn.microsoft.com/library/azure/jj151530.aspx).</span><span class="sxs-lookup"><span data-stu-id="5a9b8-188">For more information, see the [LoadBalancerProbe schema](https://msdn.microsoft.com/library/azure/jj151530.aspx).</span></span>

* <span data-ttu-id="5a9b8-189">NAT de Origem</span><span class="sxs-lookup"><span data-stu-id="5a9b8-189">Source NAT</span></span>

    <span data-ttu-id="5a9b8-190">Todo o tráfego de saída para a Internet proveniente de seu serviço passa pela SNAT (NAT de origem), que usa o mesmo endereço VIP do tráfego de entrada.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-190">All outbound traffic to the Internet that originates from your service undergoes source NAT (SNAT) by using the same VIP address as the incoming traffic.</span></span> <span data-ttu-id="5a9b8-191">A SNAT fornece benefícios importantes:</span><span class="sxs-lookup"><span data-stu-id="5a9b8-191">SNAT provides important benefits:</span></span>

    + <span data-ttu-id="5a9b8-192">Permite uma fácil atualização e recuperação de desastres dos serviços, já que o VIP pode ser mapeado dinamicamente para outra instância do serviço.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-192">It enables easy upgrade and disaster recovery of services, since the VIP can be dynamically mapped to another instance of the service.</span></span>
    + <span data-ttu-id="5a9b8-193">Facilita o gerenciamento de ACL (lista de controle de acesso).</span><span class="sxs-lookup"><span data-stu-id="5a9b8-193">It makes access control list (ACL) management easier.</span></span> <span data-ttu-id="5a9b8-194">ACLs expressadas em termos de VIPs não mudam à medida que os serviços são escalados verticalmente ou reimplantados.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-194">ACLs expressed in terms of VIPs do not change as services scale up, down, or get redeployed.</span></span>

    <span data-ttu-id="5a9b8-195">A configuração do balanceador de carga dá suporte para NAT de cone completo para UDP.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-195">The load balancer configuration supports full cone NAT for UDP.</span></span> <span data-ttu-id="5a9b8-196">Cone NAT completo é um tipo de NAT em que a porta permite conexões de entrada de qualquer host externo (em resposta a uma solicitação de saída).</span><span class="sxs-lookup"><span data-stu-id="5a9b8-196">Full cone NAT is a type of NAT where the port allows inbound connections from any external host (in response to an outbound request).</span></span>

    <span data-ttu-id="5a9b8-197">Para cada nova conexão de saída que inicia uma máquina virtual, uma porta de saída também é alocada pelo balanceador de carga.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-197">For each new outbound connection that a virtual machine initiates, an outbound port is also allocated by the load balancer.</span></span> <span data-ttu-id="5a9b8-198">O host externo vê o tráfego com uma porta alocada do IP virtual (VIP).</span><span class="sxs-lookup"><span data-stu-id="5a9b8-198">The external host sees traffic with a virtual IP (VIP)-allocated port.</span></span> <span data-ttu-id="5a9b8-199">Para cenários que exigem um grande número de conexões de saída, recomendamos o uso de endereços [IP públicos em nível de instância](../virtual-network/virtual-networks-instance-level-public-ip.md) , para que as VMs tenham um endereço IP de saída dedicado para SNAT.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-199">For scenarios that require a large number of outbound connections, it is recommended to use [instance-level public IP](../virtual-network/virtual-networks-instance-level-public-ip.md) addresses so that the VMs have a dedicated outbound IP address for SNAT.</span></span> <span data-ttu-id="5a9b8-200">Isso reduz o risco de esgotamento da porta.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-200">This reduces the risk of port exhaustion.</span></span>

    <span data-ttu-id="5a9b8-201">Consulte [conexões de saída](load-balancer-outbound-connections.md) para obter mais detalhes sobre esse tópico.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-201">Please see [outbound connections](load-balancer-outbound-connections.md) article for more details on this topic.</span></span>

### <a name="support-for-multiple-load-balanced-ip-addresses-for-virtual-machines"></a><span data-ttu-id="5a9b8-202">Suporte para vários endereços IP com balanceamento de carga para máquinas virtuais</span><span class="sxs-lookup"><span data-stu-id="5a9b8-202">Support for multiple load-balanced IP addresses for virtual machines</span></span>
<span data-ttu-id="5a9b8-203">Você pode atribuir mais de um endereço IP público com balanceamento de carga a um conjunto de máquinas virtuais.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-203">You can assign more than one load-balanced public IP address to a set of virtual machines.</span></span> <span data-ttu-id="5a9b8-204">Com esse recurso, você pode hospedar vários sites SSL e/ou ouvintes do Grupo de Disponibilidade AlwaysOn do SQL Server no mesmo conjunto de máquinas virtuais.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-204">With this ability, you can host multiple SSL websites and/or multiple SQL Server AlwaysOn Availability Group listeners on the same set of virtual machines.</span></span> <span data-ttu-id="5a9b8-205">Para obter mais informações, consulte [Vários VIPs por serviço de nuvem](load-balancer-multivip.md).</span><span class="sxs-lookup"><span data-stu-id="5a9b8-205">For more information, see [Multiple VIPs per cloud service](load-balancer-multivip.md).</span></span>

[!INCLUDE [load-balancer-compare-tm-ag-lb-include.md](../../includes/load-balancer-compare-tm-ag-lb-include.md)]

## <a name="limitations"></a><span data-ttu-id="5a9b8-206">Limitações</span><span class="sxs-lookup"><span data-stu-id="5a9b8-206">Limitations</span></span>

<span data-ttu-id="5a9b8-207">Pools de back-end do Load Balancer podem conter qualquer SKU de VM exceto camada Básica.</span><span class="sxs-lookup"><span data-stu-id="5a9b8-207">Load Balancer backend pools can contain any VM SKU except Basic tier.</span></span>

## <a name="next-steps"></a><span data-ttu-id="5a9b8-208">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="5a9b8-208">Next steps</span></span>

- <span data-ttu-id="5a9b8-209">Saiba mais sobre o [balanceador de carga para a Internet](load-balancer-internet-overview.md)</span><span class="sxs-lookup"><span data-stu-id="5a9b8-209">Learn more about [Internet-facing load balancer](load-balancer-internet-overview.md)</span></span>

- <span data-ttu-id="5a9b8-210">Saiba mais sobre a [Visão geral do balanceador de carga interno](load-balancer-internal-overview.md)</span><span class="sxs-lookup"><span data-stu-id="5a9b8-210">Learn more about [Internal load balancer overview](load-balancer-internal-overview.md)</span></span>

- <span data-ttu-id="5a9b8-211">Criar um [balanceador de carga para a Internet](load-balancer-get-started-internet-portal.md)</span><span class="sxs-lookup"><span data-stu-id="5a9b8-211">Create an [Internet-facing load balancer](load-balancer-get-started-internet-portal.md)</span></span>

- <span data-ttu-id="5a9b8-212">Saiba mais sobre algumas das outras principais [funcionalidades de rede](../networking/networking-overview.md) do Azure</span><span class="sxs-lookup"><span data-stu-id="5a9b8-212">Learn about some of the other key [networking capabilities](../networking/networking-overview.md) of Azure</span></span>

