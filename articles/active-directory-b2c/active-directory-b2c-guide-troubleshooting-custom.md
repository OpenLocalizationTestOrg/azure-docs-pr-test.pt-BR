---
title: "Azure Active Directory B2C: solucionar problemas de políticas personalizadas | Microsoft Docs"
description: "Saiba mais sobre as abordagens toosolving erros ao trabalhar com políticas personalizadas no Active Directory do Azure."
services: active-directory-b2c
documentationcenter: 
author: rojasja
manager: krassk
editor: rojasja
ms.assetid: 
ms.service: active-directory-b2c
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/07/2017
ms.author: joroja
ms.openlocfilehash: b9e1b46df1ddb29cdb90953e4a0d6f1dd085441f
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="troubleshoot-azure-ad-b2c-custom-policies-and-identity-experience-framework"></a><span data-ttu-id="9af2e-103">Solucionar problemas de políticas personalizadas do Azure AD B2C e da Estrutura de Experiência de Identidade</span><span class="sxs-lookup"><span data-stu-id="9af2e-103">Troubleshoot Azure AD B2C custom policies and Identity Experience Framework</span></span>

<span data-ttu-id="9af2e-104">Se você usar o Azure Active Directory B2C (Azure AD B2C) de políticas personalizadas, você pode experimentar desafios Configurando Olá a estrutura de experiência de identidade em seu formato XML de idioma de política.</span><span class="sxs-lookup"><span data-stu-id="9af2e-104">If you use Azure Active Directory B2C (Azure AD B2C) custom policies, you might experience challenges setting up hello Identity Experience Framework in its policy language XML format.</span></span>  <span data-ttu-id="9af2e-105">Políticas personalizadas de toowrite de aprendizado podem ser como uma nova linguagem de aprendizado.</span><span class="sxs-lookup"><span data-stu-id="9af2e-105">Learning toowrite custom policies can be like learning a new language.</span></span> <span data-ttu-id="9af2e-106">Neste artigo, descreveremos ferramentas e dicas que podem ajudar a identificar e resolver problemas.</span><span class="sxs-lookup"><span data-stu-id="9af2e-106">In this article, we describe tools and tips that can help you quickly discover and resolve issues.</span></span> 

> [!NOTE]
> <span data-ttu-id="9af2e-107">Este artigo concentra-se na solução de problemas da configuração de política personalizada do Azure AD B2C.</span><span class="sxs-lookup"><span data-stu-id="9af2e-107">This article focuses on troubleshooting your Azure AD B2C custom policy configuration.</span></span> <span data-ttu-id="9af2e-108">Ele não aborda Olá terceira o aplicativo de terceiros ou sua biblioteca de identidade.</span><span class="sxs-lookup"><span data-stu-id="9af2e-108">It doesn't address hello relying party application or its identity library.</span></span>

## <a name="xml-editing"></a><span data-ttu-id="9af2e-109">Edição de XML</span><span class="sxs-lookup"><span data-stu-id="9af2e-109">XML editing</span></span>

<span data-ttu-id="9af2e-110">Olá erro mais comuns na configuração de políticas personalizadas está incorretamente formatado XML.</span><span class="sxs-lookup"><span data-stu-id="9af2e-110">hello most common error in setting up custom policies is improperly formatted XML.</span></span> <span data-ttu-id="9af2e-111">Um bom editor de XML é praticamente essencial.</span><span class="sxs-lookup"><span data-stu-id="9af2e-111">A good XML editor is nearly essential.</span></span> <span data-ttu-id="9af2e-112">Um bom editor de XML exibe XML nativamente, codifica o conteúdo por cor, preenche os termos comuns com antecedência, mantém os elementos XML indexados e pode validar no esquema.</span><span class="sxs-lookup"><span data-stu-id="9af2e-112">A good XML editor displays XML natively, color-codes content, prefills common terms, keeps XML elements indexed, and can validate with schema.</span></span> <span data-ttu-id="9af2e-113">Aqui estão dois dos nossos editores de XML favoritos:</span><span class="sxs-lookup"><span data-stu-id="9af2e-113">Here are two of our favorite XML editors:</span></span>

* [<span data-ttu-id="9af2e-114">Visual Studio Code</span><span class="sxs-lookup"><span data-stu-id="9af2e-114">Visual Studio Code</span></span>](https://code.visualstudio.com/)
* [<span data-ttu-id="9af2e-115">Bloco de Notas++</span><span class="sxs-lookup"><span data-stu-id="9af2e-115">Notepad++</span></span>](https://notepad-plus-plus.org/)

<span data-ttu-id="9af2e-116">A validação de esquema XML identifica os erros antes do upload do arquivo XML.</span><span class="sxs-lookup"><span data-stu-id="9af2e-116">XML schema validation identifies errors before you upload your XML file.</span></span> <span data-ttu-id="9af2e-117">Na pasta raiz de saudação do pacote de inicializador Olá, obter a definição de esquema XML Olá TrustFrameworkPolicy_0.3.0.0.xsd.</span><span class="sxs-lookup"><span data-stu-id="9af2e-117">In hello root folder of hello starter pack, get hello XML schema definition TrustFrameworkPolicy_0.3.0.0.xsd.</span></span> <span data-ttu-id="9af2e-118">Para obter mais informações, na documentação de saudação do seu editor XML, procure *ferramentas XML* e *validação de XML*.</span><span class="sxs-lookup"><span data-stu-id="9af2e-118">For more information, in hello documentation of your XML editor, look for *XML tools* and *XML validation*.</span></span>

<span data-ttu-id="9af2e-119">Talvez seja útil examinar as regras de XML.</span><span class="sxs-lookup"><span data-stu-id="9af2e-119">You might find a review of XML rules helpful.</span></span> <span data-ttu-id="9af2e-120">O Azure AD B2C rejeita qualquer erro de formatação de XML que detecta.</span><span class="sxs-lookup"><span data-stu-id="9af2e-120">Azure AD B2C rejects any XML formatting errors that it detects.</span></span> <span data-ttu-id="9af2e-121">Ocasionalmente, um XML formatado incorretamente pode causar mensagens de erros falsos.</span><span class="sxs-lookup"><span data-stu-id="9af2e-121">Occasionally, incorrectly formatted XML might cause error messages that are misleading.</span></span>

## <a name="upload-policies-and-policy-validation"></a><span data-ttu-id="9af2e-122">Políticas de upload e validação de política</span><span class="sxs-lookup"><span data-stu-id="9af2e-122">Upload policies and policy validation</span></span>

 <span data-ttu-id="9af2e-123">A validação de upload de arquivo XML é automática.</span><span class="sxs-lookup"><span data-stu-id="9af2e-123">XML file upload validation is automatic.</span></span> <span data-ttu-id="9af2e-124">A maioria dos erros causar Olá toofail de carregamento.</span><span class="sxs-lookup"><span data-stu-id="9af2e-124">Most errors cause hello upload toofail.</span></span> <span data-ttu-id="9af2e-125">Validação inclui o arquivo de política de saudação que você está carregando.</span><span class="sxs-lookup"><span data-stu-id="9af2e-125">Validation includes hello policy file that you are uploading.</span></span> <span data-ttu-id="9af2e-126">Ele também inclui a cadeia de saudação de arquivos de arquivo de carregamento da saudação refere-se muito (Olá o arquivo de política de terceira parte confiável, o arquivo de extensões de hello e o arquivo base Olá).</span><span class="sxs-lookup"><span data-stu-id="9af2e-126">It also includes hello chain of files hello upload file refers too(hello relying party policy file, hello extensions file, and hello base file).</span></span> 
 
 <span data-ttu-id="9af2e-127">Erros de validação comuns incluem o seguinte hello.</span><span class="sxs-lookup"><span data-stu-id="9af2e-127">Common validation errors include hello following.</span></span>

<span data-ttu-id="9af2e-128">Trecho de código de erro: `... makes a reference tooClaimType with id "displaName" but neither hello policy nor any of its base policies contain such an element`</span><span class="sxs-lookup"><span data-stu-id="9af2e-128">Error snippet: `... makes a reference tooClaimType with id "displaName" but neither hello policy nor any of its base policies contain such an element`</span></span>
* <span data-ttu-id="9af2e-129">Olá ClaimType valor pode estar incorreto ou não existe no esquema de saudação.</span><span class="sxs-lookup"><span data-stu-id="9af2e-129">hello ClaimType value might be misspelled, or does not exist in hello schema.</span></span>
* <span data-ttu-id="9af2e-130">ClaimType valores devem ser definidos em pelo menos um dos arquivos de saudação na política de saudação.</span><span class="sxs-lookup"><span data-stu-id="9af2e-130">ClaimType values must be defined in at least one of hello files in hello policy.</span></span> 
    <span data-ttu-id="9af2e-131">Por exemplo: ` <ClaimType Id="socialIdpUserId">`</span><span class="sxs-lookup"><span data-stu-id="9af2e-131">For example: ` <ClaimType Id="socialIdpUserId">`</span></span>
* <span data-ttu-id="9af2e-132">Se ClaimType está definida no arquivo de extensões de saudação, mas ele também é usado em um valor de TechnicalProfile no arquivo de base Olá, carregamento de arquivo base Olá resulta em um erro.</span><span class="sxs-lookup"><span data-stu-id="9af2e-132">If ClaimType is defined in hello extensions file, but it's also used in a TechnicalProfile value in hello base file, uploading hello base file results in an error.</span></span>

<span data-ttu-id="9af2e-133">Trecho de código de erro: `...makes a reference tooa ClaimsTransformation with id...`</span><span class="sxs-lookup"><span data-stu-id="9af2e-133">Error snippet: `...makes a reference tooa ClaimsTransformation with id...`</span></span>
* <span data-ttu-id="9af2e-134">Olá causas para erro Olá pode ser Olá mesmo para erro de ClaimType hello.</span><span class="sxs-lookup"><span data-stu-id="9af2e-134">hello causes for hello error might be hello same as for hello ClaimType error.</span></span>

<span data-ttu-id="9af2e-135">Trecho de código de erro: `Reason: User is currently logged as a user of 'yourtenant.onmicrosoft.com' tenant. In order toomanage 'yourtenant.onmicrosoft.com', please login as a user of 'yourtenant.onmicrosoft.com' tenant`</span><span class="sxs-lookup"><span data-stu-id="9af2e-135">Error snippet: `Reason: User is currently logged as a user of 'yourtenant.onmicrosoft.com' tenant. In order toomanage 'yourtenant.onmicrosoft.com', please login as a user of 'yourtenant.onmicrosoft.com' tenant`</span></span>
* <span data-ttu-id="9af2e-136">Verificar esse valor de TenantId em Olá Olá  **\<TrustFrameworkPolicy\>**  e  **\<BasePolicy\>**  elementos correspondem o destino do Azure AD B2C locatário.</span><span class="sxs-lookup"><span data-stu-id="9af2e-136">Check that hello TenantId value in hello **\<TrustFrameworkPolicy\>** and **\<BasePolicy\>** elements match your target Azure AD B2C tenant.</span></span>  

## <a name="troubleshoot-hello-runtime"></a><span data-ttu-id="9af2e-137">Solucionar problemas de tempo de execução de saudação</span><span class="sxs-lookup"><span data-stu-id="9af2e-137">Troubleshoot hello runtime</span></span>

* <span data-ttu-id="9af2e-138">Use `Run Now` e `https://jwt.io` tootest suas políticas independentemente de sua web ou aplicativo móvel.</span><span class="sxs-lookup"><span data-stu-id="9af2e-138">Use `Run Now` and `https://jwt.io` tootest your policies independently of your web or mobile application.</span></span> <span data-ttu-id="9af2e-139">Este site funciona como um aplicativo de terceira parte confiável.</span><span class="sxs-lookup"><span data-stu-id="9af2e-139">This website acts like a relying party application.</span></span> <span data-ttu-id="9af2e-140">Ele exibe conteúdo Olá Olá JSON Web Token (JWT) que é gerada pela sua política do Azure AD B2C.</span><span class="sxs-lookup"><span data-stu-id="9af2e-140">It displays hello contents of hello JSON Web Token (JWT) that is generated by your Azure AD B2C policy.</span></span> <span data-ttu-id="9af2e-141">toocreate um aplicativo de teste na estrutura de experiência de identidade, use Olá valores a seguir:</span><span class="sxs-lookup"><span data-stu-id="9af2e-141">toocreate a test application in Identity Experience Framework, use hello following values:</span></span>
    * <span data-ttu-id="9af2e-142">Nome: TestApp</span><span class="sxs-lookup"><span data-stu-id="9af2e-142">Name: TestApp</span></span>
    * <span data-ttu-id="9af2e-143">Aplicativo Web/API Web: não</span><span class="sxs-lookup"><span data-stu-id="9af2e-143">Web App/Web API: No</span></span>
    * <span data-ttu-id="9af2e-144">Cliente nativo: Não</span><span class="sxs-lookup"><span data-stu-id="9af2e-144">Native client: No</span></span>

* <span data-ttu-id="9af2e-145">troca de saudação do tootrace de mensagens entre o navegador do cliente e o Azure AD B2C, use [Fiddler](http://www.telerik.com/fiddler).</span><span class="sxs-lookup"><span data-stu-id="9af2e-145">tootrace hello exchange of messages between your client browser and Azure AD B2C, use [Fiddler](http://www.telerik.com/fiddler).</span></span> <span data-ttu-id="9af2e-146">Ele pode ajudá-lo a obter uma indicação de onde sua jornada de usuário está falhando nas etapas de orquestração.</span><span class="sxs-lookup"><span data-stu-id="9af2e-146">It can help you get an indication of where your user journey is failing in your orchestration steps.</span></span>

* <span data-ttu-id="9af2e-147">Em **modo de desenvolvimento**, use **Application Insights** tootrace atividade de saudação de sua jornada de usuário do Framework de experiência de identidade.</span><span class="sxs-lookup"><span data-stu-id="9af2e-147">In **Development mode**, use **Application Insights** tootrace hello activity of your Identity Experience Framework user journey.</span></span> <span data-ttu-id="9af2e-148">Em **modo de desenvolvimento**, você pode observar o intercâmbio de saudação de declarações entre hello Framework de experiência de identidade e hello vários provedores de declarações que são definidos por perfis de técnicos, como provedores de identidade, serviços baseados na API diretório de usuário de saudação do Azure AD B2C e outros serviços, como o Azure Multi-Factor-Authentication.</span><span class="sxs-lookup"><span data-stu-id="9af2e-148">In **Development mode**, you can observe hello exchange of claims between hello Identity Experience Framework and hello various claims providers that are defined by technical profiles, such as identity providers, API-based services, hello Azure AD B2C user directory, and other services, like Azure Multi-Factor-Authentication.</span></span>  

## <a name="recommended-practices"></a><span data-ttu-id="9af2e-149">Práticas recomendadas</span><span class="sxs-lookup"><span data-stu-id="9af2e-149">Recommended practices</span></span>

<span data-ttu-id="9af2e-150">**Mantenha várias versões de seus cenários. Agrupe-os em um projeto com seu aplicativo.**</span><span class="sxs-lookup"><span data-stu-id="9af2e-150">**Keep multiple versions of your scenarios. Group them in a project with your application.**</span></span> <span data-ttu-id="9af2e-151">Olá base, extensões e arquivos de terceira parte confiável são diretamente dependentes entre si.</span><span class="sxs-lookup"><span data-stu-id="9af2e-151">hello base, extensions, and relying party files are directly dependent on each other.</span></span> <span data-ttu-id="9af2e-152">Salve-os como um grupo.</span><span class="sxs-lookup"><span data-stu-id="9af2e-152">Save them as a group.</span></span> <span data-ttu-id="9af2e-153">À medida que novos recursos são adicionados tooyour políticas, manter versões separadas de trabalho.</span><span class="sxs-lookup"><span data-stu-id="9af2e-153">As new features are added tooyour policies, keep separate working versions.</span></span> <span data-ttu-id="9af2e-154">Versões de trabalho do estágio em seu próprio arquivo de sistema com eles interagem com o código do aplicativo hello.</span><span class="sxs-lookup"><span data-stu-id="9af2e-154">Stage working versions in your own file system with hello application code they interact with.</span></span>  <span data-ttu-id="9af2e-155">Os aplicativos podem invocar várias políticas de terceira parte confiável diferentes em um locatário.</span><span class="sxs-lookup"><span data-stu-id="9af2e-155">Your applications might invoke many different relying party policies in a tenant.</span></span> <span data-ttu-id="9af2e-156">Eles podem se tornar dependentes Olá declarações que esperam de suas políticas do Azure AD B2C.</span><span class="sxs-lookup"><span data-stu-id="9af2e-156">They might become dependent on hello claims that they expect from your Azure AD B2C policies.</span></span>

<span data-ttu-id="9af2e-157">**Desenvolver e testar perfis técnicos com jornadas de usuário conhecidas.**</span><span class="sxs-lookup"><span data-stu-id="9af2e-157">**Develop and test technical profiles with known user journeys.**</span></span> <span data-ttu-id="9af2e-158">Use starter testado pacote políticas tooset seus perfis técnica.</span><span class="sxs-lookup"><span data-stu-id="9af2e-158">Use tested starter pack policies tooset up your technical profiles.</span></span> <span data-ttu-id="9af2e-159">Teste-as separadamente antes de incorporá-las em suas próprias jornadas de usuário.</span><span class="sxs-lookup"><span data-stu-id="9af2e-159">Test them separately before you incorporate them into your own user journeys.</span></span>

<span data-ttu-id="9af2e-160">**Desenvolva e teste jornadas de usuário com perfis técnicos testados.**</span><span class="sxs-lookup"><span data-stu-id="9af2e-160">**Develop and test user journeys with tested technical profiles.**</span></span> <span data-ttu-id="9af2e-161">Altere etapas de orquestração de saudação da jornada de um usuário incrementalmente.</span><span class="sxs-lookup"><span data-stu-id="9af2e-161">Change hello orchestration steps of a user journey incrementally.</span></span> <span data-ttu-id="9af2e-162">Crie os seus cenários desejados de forma progressiva.</span><span class="sxs-lookup"><span data-stu-id="9af2e-162">Progressively build your intended scenarios.</span></span>

## <a name="next-steps"></a><span data-ttu-id="9af2e-163">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="9af2e-163">Next steps</span></span>

* <span data-ttu-id="9af2e-164">No GitHub, baixe o arquivo de arquivos. zip (https://github.com/Azure-Samples/active-directory-b2c-custom-policy-starterpack/archive/master.zip) [active-directory-b2c-custom-policy-starterpack] de saudação.</span><span class="sxs-lookup"><span data-stu-id="9af2e-164">In GitHub, download hello [active-directory-b2c-custom-policy-starterpack] (https://github.com/Azure-Samples/active-directory-b2c-custom-policy-starterpack/archive/master.zip) .zip file.</span></span>
