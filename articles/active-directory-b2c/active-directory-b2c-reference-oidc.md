---
title: Entrada na Web com o OpenID Connect - Azure AD B2C | Microsoft Docs
description: "Criação de aplicativos Web usando a implementação do Azure Active Directory do protocolo de autenticação OpenID Connect"
services: active-directory-b2c
documentationcenter: 
author: saeedakhter-msft
manager: krassk
editor: parakhj
ms.assetid: 21d420c8-3c10-4319-b681-adf2e89e7ede
ms.service: active-directory-b2c
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/16/2017
ms.author: saeedakhter-msft
ms.openlocfilehash: b0c33a47dd0cae79eab32ac578448fae8bf59be5
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/29/2017
---
# <a name="azure-active-directory-b2c-web-sign-in-with-openid-connect"></a><span data-ttu-id="e44ed-103">Azure Active Directory B2C: entrada na Web com o OpenID Connect</span><span class="sxs-lookup"><span data-stu-id="e44ed-103">Azure Active Directory B2C: Web sign-in with OpenID Connect</span></span>
<span data-ttu-id="e44ed-104">O OpenID Connect é um protocolo de autenticação criado com base em OAuth 2.0 que pode ser usado para conectar com segurança os usuários em aplicativos Web.</span><span class="sxs-lookup"><span data-stu-id="e44ed-104">OpenID Connect is an authentication protocol, built on top of OAuth 2.0, that can be used to securely sign users in to web applications.</span></span> <span data-ttu-id="e44ed-105">Ao usar a implementação do Azure AD B2C (Azure Active Directory B2C) do OpenID Connect, você pode terceirizar a inscrição, a entrada e outras experiências de gerenciamento de identidade em seus aplicativos Web para o Azure AD (Azure Active Directory).</span><span class="sxs-lookup"><span data-stu-id="e44ed-105">By using the Azure Active Directory B2C (Azure AD B2C) implementation of OpenID Connect, you can outsource sign-up, sign-in, and other identity management experiences in your web applications to Azure Active Directory (Azure AD).</span></span> <span data-ttu-id="e44ed-106">Este guia mostra como fazer isso de maneira independente da linguagem.</span><span class="sxs-lookup"><span data-stu-id="e44ed-106">This guide shows you how to do so in a language-independent manner.</span></span> <span data-ttu-id="e44ed-107">Ele descreve como enviar e receber mensagens HTTP sem usar qualquer uma das nossas bibliotecas de software livre.</span><span class="sxs-lookup"><span data-stu-id="e44ed-107">It describes how to send and receive HTTP messages without using any of our open-source libraries.</span></span>

<span data-ttu-id="e44ed-108">O [OpenID Connect](http://openid.net/specs/openid-connect-core-1_0.html) estende o protocolo de *autorização* do OAuth 2.0 a ser usado como um protocolo de *autenticação*.</span><span class="sxs-lookup"><span data-stu-id="e44ed-108">[OpenID Connect](http://openid.net/specs/openid-connect-core-1_0.html) extends the OAuth 2.0 *authorization* protocol for use as an *authentication* protocol.</span></span> <span data-ttu-id="e44ed-109">Isso permite que você execute o logon único usando OAuth.</span><span class="sxs-lookup"><span data-stu-id="e44ed-109">This allows you to perform single sign-on by using OAuth.</span></span> <span data-ttu-id="e44ed-110">Ele apresenta o conceito de um *token de ID*, que é um token de segurança que permite ao cliente verificar a identidade do usuário e obter informações básicas de perfil sobre o usuário.</span><span class="sxs-lookup"><span data-stu-id="e44ed-110">It introduces the concept of an *ID token*, which is a security token that allows the client to verify the identity of the user and obtain basic profile information about the user.</span></span>

<span data-ttu-id="e44ed-111">Como ele estende o OAuth 2.0, também permite que os aplicativos adquiram *tokens de acesso* com segurança.</span><span class="sxs-lookup"><span data-stu-id="e44ed-111">Because it extends OAuth 2.0, it also enables apps to securely acquire *access tokens*.</span></span> <span data-ttu-id="e44ed-112">Você pode usar access_tokens para acessar os recursos protegidos por um [servidor de autorização](active-directory-b2c-reference-protocols.md#the-basics).</span><span class="sxs-lookup"><span data-stu-id="e44ed-112">You can use access_tokens to access resources that are secured by an [authorization server](active-directory-b2c-reference-protocols.md#the-basics).</span></span> <span data-ttu-id="e44ed-113">Nós recomendamos o OpenID Connect se você estiver criando um aplicativo Web que fica hospedado em um servidor e é acessado por meio de um navegador.</span><span class="sxs-lookup"><span data-stu-id="e44ed-113">We recommend OpenID Connect if you're building a web application that is hosted on a server and accessed through a browser.</span></span> <span data-ttu-id="e44ed-114">Se você deseja adicionar o gerenciamento de identidades para seus aplicativos móveis ou para área de trabalho usando o Azure AD B2C, deve usar o [OAuth 2.0](active-directory-b2c-reference-oauth-code.md) em vez do OpenID Connect.</span><span class="sxs-lookup"><span data-stu-id="e44ed-114">If you want to add identity management to your mobile or desktop applications by using Azure AD B2C, you should use [OAuth 2.0](active-directory-b2c-reference-oauth-code.md) rather than OpenID Connect.</span></span>

<span data-ttu-id="e44ed-115">O Azure AD B2C estende o protocolo padrão OpenID Connect para fazer mais do que uma simples ação de autenticação e autorização.</span><span class="sxs-lookup"><span data-stu-id="e44ed-115">Azure AD B2C extends the standard OpenID Connect protocol to do more than simple authentication and authorization.</span></span> <span data-ttu-id="e44ed-116">Ele apresenta o [parâmetro de política](active-directory-b2c-reference-policies.md), que permite usar o OpenID Connect para adicionar experiências de usuário, como o gerenciamento de inscrição, de entrada e de perfis, ao seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="e44ed-116">It introduces the [policy parameter](active-directory-b2c-reference-policies.md), which enables you to use OpenID Connect to add user experiences--such as sign-up, sign-in, and profile management--to your app.</span></span> <span data-ttu-id="e44ed-117">Aqui, mostramos como usar o OpenID Connect e as políticas para implementar cada uma dessas experiências em seus aplicativos Web.</span><span class="sxs-lookup"><span data-stu-id="e44ed-117">Here, we show you how to use OpenID Connect and policies to implement each of these experiences in your web applications.</span></span> <span data-ttu-id="e44ed-118">Também mostraremos como obter tokens de acesso para acessar APIs Web.</span><span class="sxs-lookup"><span data-stu-id="e44ed-118">We'll also show you how to get access tokens for accessing web APIs.</span></span>

<span data-ttu-id="e44ed-119">As solicitações HTTP de exemplo na próxima sessão usam nosso diretório B2C de exemplo, fabrikamb2c.onmicrosoft.com, bem como nossas políticas e nosso aplicativo de exemplo https://aadb2cplayground.azurewebsites.net.</span><span class="sxs-lookup"><span data-stu-id="e44ed-119">The example HTTP requests in the next section use our sample B2C directory, fabrikamb2c.onmicrosoft.com, as well as our sample application, https://aadb2cplayground.azurewebsites.net, and policies.</span></span> <span data-ttu-id="e44ed-120">Fique à vontade para experimentar as solicitações usando esses valores ou os substituindo pelos seus próprios.</span><span class="sxs-lookup"><span data-stu-id="e44ed-120">You're free to try out the requests yourself by using these values, or you can replace them with your own.</span></span>
<span data-ttu-id="e44ed-121">Saiba como [obter seus próprios locatário, aplicativo e políticas B2C](#use-your-own-b2c-directory).</span><span class="sxs-lookup"><span data-stu-id="e44ed-121">Learn how to [get your own B2C tenant, application, and policies](#use-your-own-b2c-directory).</span></span>

## <a name="send-authentication-requests"></a><span data-ttu-id="e44ed-122">Enviar solicitações de autenticação</span><span class="sxs-lookup"><span data-stu-id="e44ed-122">Send authentication requests</span></span>
<span data-ttu-id="e44ed-123">Quando o aplicativo Web precisa autenticar o usuário e executar uma política, ele pode direcionar o usuário para o ponto de extremidade `/authorize` .</span><span class="sxs-lookup"><span data-stu-id="e44ed-123">When your web app needs to authenticate the user and execute a policy, it can direct the user to the `/authorize` endpoint.</span></span> <span data-ttu-id="e44ed-124">Essa é a parte interativa do fluxo, em que o usuário realiza uma ação, dependendo da política.</span><span class="sxs-lookup"><span data-stu-id="e44ed-124">This is the interactive portion of the flow, where the user takes action, depending on the policy.</span></span>

<span data-ttu-id="e44ed-125">Nessa solicitação, o cliente indica as permissões que precisa adquirir do usuário no parâmetro `scope` e a política a ser executada no parâmetro `p`.</span><span class="sxs-lookup"><span data-stu-id="e44ed-125">In this request, the client indicates the permissions that it needs to acquire from the user in the `scope` parameter and the policy to execute in the `p` parameter.</span></span> <span data-ttu-id="e44ed-126">Três exemplos são fornecidos nas seções a seguir (com quebras de linha para facilitar a leitura), cada um com uma política diferente.</span><span class="sxs-lookup"><span data-stu-id="e44ed-126">Three examples are provided in the following sections (with line breaks for readability), each using a different policy.</span></span> <span data-ttu-id="e44ed-127">Para ter uma ideia de como funciona cada solicitação, tente colar a solicitação em um navegador e executá-lo.</span><span class="sxs-lookup"><span data-stu-id="e44ed-127">To get a feel for how each request works, try pasting the request into a browser and running it.</span></span>

#### <a name="use-a-sign-in-policy"></a><span data-ttu-id="e44ed-128">Usar uma política de entrada</span><span class="sxs-lookup"><span data-stu-id="e44ed-128">Use a sign-in policy</span></span>
```
GET https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/oauth2/v2.0/authorize?
client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6
&response_type=code+id_token
&redirect_uri=https%3A%2F%2Faadb2cplayground.azurewebsites.net%2F
&response_mode=form_post
&scope=openid%20offline_access
&state=arbitrary_data_you_can_receive_in_the_response
&nonce=12345
&p=b2c_1_sign_in
```

#### <a name="use-a-sign-up-policy"></a><span data-ttu-id="e44ed-129">Usar uma política de inscrição</span><span class="sxs-lookup"><span data-stu-id="e44ed-129">Use a sign-up policy</span></span>
```
GET https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/oauth2/v2.0/authorize?
client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6
&response_type=code+id_token
&redirect_uri=https%3A%2F%2Faadb2cplayground.azurewebsites.net%2F
&response_mode=form_post
&scope=openid%20offline_access
&state=arbitrary_data_you_can_receive_in_the_response
&nonce=12345
&p=b2c_1_sign_up
```

#### <a name="use-an-edit-profile-policy"></a><span data-ttu-id="e44ed-130">Usar uma política de edição de perfil</span><span class="sxs-lookup"><span data-stu-id="e44ed-130">Use an edit-profile policy</span></span>
```
GET https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/oauth2/v2.0/authorize?
client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6
&response_type=code+id_token
&redirect_uri=https%3A%2F%2Faadb2cplayground.azurewebsites.net%2F
&response_mode=form_post
&scope=openid%20offline_access
&state=arbitrary_data_you_can_receive_in_the_response
&nonce=12345
&p=b2c_1_edit_profile
```

| <span data-ttu-id="e44ed-131">Parâmetro</span><span class="sxs-lookup"><span data-stu-id="e44ed-131">Parameter</span></span> | <span data-ttu-id="e44ed-132">Obrigatório?</span><span class="sxs-lookup"><span data-stu-id="e44ed-132">Required?</span></span> | <span data-ttu-id="e44ed-133">Descrição</span><span class="sxs-lookup"><span data-stu-id="e44ed-133">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="e44ed-134">client_id</span><span class="sxs-lookup"><span data-stu-id="e44ed-134">client_id</span></span> |<span data-ttu-id="e44ed-135">Obrigatório</span><span class="sxs-lookup"><span data-stu-id="e44ed-135">Required</span></span> |<span data-ttu-id="e44ed-136">A ID do aplicativo que o [portal do Azure](https://portal.azure.com/) atribuiu a seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="e44ed-136">The application ID that the [Azure portal](https://portal.azure.com/) assigned to your app.</span></span> |
| <span data-ttu-id="e44ed-137">response_type</span><span class="sxs-lookup"><span data-stu-id="e44ed-137">response_type</span></span> |<span data-ttu-id="e44ed-138">Obrigatório</span><span class="sxs-lookup"><span data-stu-id="e44ed-138">Required</span></span> |<span data-ttu-id="e44ed-139">O tipo de resposta, que deve incluir token de ID para o OpenID Connect.</span><span class="sxs-lookup"><span data-stu-id="e44ed-139">The response type, which must include an ID token for OpenID Connect.</span></span> <span data-ttu-id="e44ed-140">Se seu aplicativo Web também precisa de tokens para chamar uma API Web, você pode usar `code+id_token`, como fizemos aqui.</span><span class="sxs-lookup"><span data-stu-id="e44ed-140">If your web app also needs tokens for calling a web API, you can use `code+id_token`, as we've done here.</span></span> |
| <span data-ttu-id="e44ed-141">redirect_uri</span><span class="sxs-lookup"><span data-stu-id="e44ed-141">redirect_uri</span></span> |<span data-ttu-id="e44ed-142">Recomendadas</span><span class="sxs-lookup"><span data-stu-id="e44ed-142">Recommended</span></span> |<span data-ttu-id="e44ed-143">O parâmetro `redirect_uri` do seu aplicativo, em que as respostas de autenticação podem ser enviadas e recebidas pelo aplicativo.</span><span class="sxs-lookup"><span data-stu-id="e44ed-143">The `redirect_uri` parameter of your app, where authentication responses can be sent and received by your app.</span></span> <span data-ttu-id="e44ed-144">Ele deve corresponder exatamente a um dos parâmetros `redirect_uri` que você registrou no portal, com exceção de que ele deve ser codificado por URL.</span><span class="sxs-lookup"><span data-stu-id="e44ed-144">It must exactly match one of the `redirect_uri` parameters that you registered in the portal, except that it must be URL encoded.</span></span> |
| <span data-ttu-id="e44ed-145">scope</span><span class="sxs-lookup"><span data-stu-id="e44ed-145">scope</span></span> |<span data-ttu-id="e44ed-146">Obrigatório</span><span class="sxs-lookup"><span data-stu-id="e44ed-146">Required</span></span> |<span data-ttu-id="e44ed-147">Uma lista de escopos separados por espaços.</span><span class="sxs-lookup"><span data-stu-id="e44ed-147">A space-separated list of scopes.</span></span> <span data-ttu-id="e44ed-148">Um único valor de escopo indica ao Azure AD ambas as permissões que estão sendo solicitadas.</span><span class="sxs-lookup"><span data-stu-id="e44ed-148">A single scope value indicates to Azure AD both permissions that are being requested.</span></span> <span data-ttu-id="e44ed-149">O escopo `openid` indica uma permissão para conectar o usuário e obter dados sobre ele na forma de tokens de ID (falaremos mais sobre isso posteriormente neste artigo).</span><span class="sxs-lookup"><span data-stu-id="e44ed-149">The `openid` scope indicates a permission to sign in the user and get data about the user in the form of ID tokens (more to come on this later in the article).</span></span> <span data-ttu-id="e44ed-150">O escopo `offline_access` é opcional para aplicativos Web.</span><span class="sxs-lookup"><span data-stu-id="e44ed-150">The `offline_access` scope is optional for web apps.</span></span> <span data-ttu-id="e44ed-151">Ele indica que seu aplicativo precisará de um *token de atualização* para obter acesso de longa duração aos recursos.</span><span class="sxs-lookup"><span data-stu-id="e44ed-151">It indicates that your app will need a *refresh token* for long-lived access to resources.</span></span> |
| <span data-ttu-id="e44ed-152">response_mode</span><span class="sxs-lookup"><span data-stu-id="e44ed-152">response_mode</span></span> |<span data-ttu-id="e44ed-153">Recomendadas</span><span class="sxs-lookup"><span data-stu-id="e44ed-153">Recommended</span></span> |<span data-ttu-id="e44ed-154">O método que deve ser usado para enviar o código de autorização resultante de volta ao aplicativo.</span><span class="sxs-lookup"><span data-stu-id="e44ed-154">The method that should be used to send the resulting authorization code back to your app.</span></span> <span data-ttu-id="e44ed-155">Ele pode ser `query`, `form_post` ou `fragment`.</span><span class="sxs-lookup"><span data-stu-id="e44ed-155">It can be either `query`, `form_post`, or `fragment`.</span></span>  <span data-ttu-id="e44ed-156">O modo de resposta `form_post` é recomendado para maior segurança.</span><span class="sxs-lookup"><span data-stu-id="e44ed-156">The `form_post` response mode is recommended for best security.</span></span> |
| <span data-ttu-id="e44ed-157">state</span><span class="sxs-lookup"><span data-stu-id="e44ed-157">state</span></span> |<span data-ttu-id="e44ed-158">Recomendadas</span><span class="sxs-lookup"><span data-stu-id="e44ed-158">Recommended</span></span> |<span data-ttu-id="e44ed-159">Um valor incluído na solicitação que também retorna na resposta do token.</span><span class="sxs-lookup"><span data-stu-id="e44ed-159">A value included in the request that is also returned in the token response.</span></span> <span data-ttu-id="e44ed-160">Pode ser uma cadeia de caracteres de qualquer conteúdo desejado.</span><span class="sxs-lookup"><span data-stu-id="e44ed-160">It can be a string of any content that you want.</span></span> <span data-ttu-id="e44ed-161">Um valor exclusivo gerado aleatoriamente que normalmente é usado para impedir ataques de solicitação intersite forjada.</span><span class="sxs-lookup"><span data-stu-id="e44ed-161">A randomly generated unique value is typically used for preventing cross-site request forgery attacks.</span></span> <span data-ttu-id="e44ed-162">O estado também é usado para codificar as informações sobre o estado do usuário no aplicativo antes da solicitação de autenticação ocorrida, como a página em que ele estava.</span><span class="sxs-lookup"><span data-stu-id="e44ed-162">The state is also used to encode information about the user's state in the app before the authentication request occurred, such as the page they were on.</span></span> |
| <span data-ttu-id="e44ed-163">nonce</span><span class="sxs-lookup"><span data-stu-id="e44ed-163">nonce</span></span> |<span data-ttu-id="e44ed-164">Obrigatório</span><span class="sxs-lookup"><span data-stu-id="e44ed-164">Required</span></span> |<span data-ttu-id="e44ed-165">Um valor incluído na solicitação(gerado pelo aplicativo) que será incluído no token de ID resultante como uma declaração.</span><span class="sxs-lookup"><span data-stu-id="e44ed-165">A value included in the request (generated by the app) that will be included in the resulting ID token as a claim.</span></span> <span data-ttu-id="e44ed-166">O aplicativo pode verificar esse valor para reduzir os ataques de reprodução de token.</span><span class="sxs-lookup"><span data-stu-id="e44ed-166">The app can then verify this value to mitigate token replay attacks.</span></span> <span data-ttu-id="e44ed-167">Normalmente, o valor é uma cadeia de caracteres aleatória e exclusiva que pode ser usada para identificar a origem da solicitação.</span><span class="sxs-lookup"><span data-stu-id="e44ed-167">The value is typically a randomized unique string that can be used to identify the origin of the request.</span></span> |
| <span data-ttu-id="e44ed-168">p</span><span class="sxs-lookup"><span data-stu-id="e44ed-168">p</span></span> |<span data-ttu-id="e44ed-169">Obrigatório</span><span class="sxs-lookup"><span data-stu-id="e44ed-169">Required</span></span> |<span data-ttu-id="e44ed-170">A política que será executada.</span><span class="sxs-lookup"><span data-stu-id="e44ed-170">The policy that will be executed.</span></span> <span data-ttu-id="e44ed-171">É o nome de uma política criada no locatário B2C.</span><span class="sxs-lookup"><span data-stu-id="e44ed-171">It is the name of a policy that is created in your B2C tenant.</span></span> <span data-ttu-id="e44ed-172">O valor do nome da política deve começar com `b2c\_1\_`.</span><span class="sxs-lookup"><span data-stu-id="e44ed-172">The policy name value should begin with `b2c\_1\_`.</span></span> <span data-ttu-id="e44ed-173">Saiba mais sobre as políticas e a [estrutura de política extensível](active-directory-b2c-reference-policies.md).</span><span class="sxs-lookup"><span data-stu-id="e44ed-173">Learn more about policies and the [extensible policy framework](active-directory-b2c-reference-policies.md).</span></span> |
| <span data-ttu-id="e44ed-174">prompt</span><span class="sxs-lookup"><span data-stu-id="e44ed-174">prompt</span></span> |<span data-ttu-id="e44ed-175">Opcional</span><span class="sxs-lookup"><span data-stu-id="e44ed-175">Optional</span></span> |<span data-ttu-id="e44ed-176">O tipo de interação do usuário que é necessário.</span><span class="sxs-lookup"><span data-stu-id="e44ed-176">The type of user interaction that is required.</span></span> <span data-ttu-id="e44ed-177">O único valor válido no momento é `login`, que força o usuário a inserir suas credenciais nessa solicitação.</span><span class="sxs-lookup"><span data-stu-id="e44ed-177">The only valid value at this time is `login`, which forces the user to enter their credentials on that request.</span></span> <span data-ttu-id="e44ed-178">O logon único não terá efeito.</span><span class="sxs-lookup"><span data-stu-id="e44ed-178">Single sign-on will not take effect.</span></span> |

<span data-ttu-id="e44ed-179">Nesse momento, é solicitado que o usuário conclua o fluxo de trabalho da política.</span><span class="sxs-lookup"><span data-stu-id="e44ed-179">At this point, the user is asked to complete the policy's workflow.</span></span> <span data-ttu-id="e44ed-180">Isso pode exigir que o usuário insira seu nome de usuário e senha, entre com uma identidade social, inscreva-se no diretório ou outras etapas, dependendo de como a política está definida.</span><span class="sxs-lookup"><span data-stu-id="e44ed-180">This might involve the user entering their username and password, signing in with a social identity, signing up for the directory, or any other number of steps, depending on how the policy is defined.</span></span>

<span data-ttu-id="e44ed-181">Depois que o usuário conclui a política, o Azure AD retorna uma resposta ao seu aplicativo no parâmetro `redirect_uri` indicado, usando o método especificado no parâmetro `response_mode`.</span><span class="sxs-lookup"><span data-stu-id="e44ed-181">After the user completes the policy, Azure AD returns a response to your app at the indicated `redirect_uri` parameter, by using the method that is specified in the `response_mode` parameter.</span></span> <span data-ttu-id="e44ed-182">A resposta é a mesma para cada um dos casos anteriores, independentemente da política que é executada.</span><span class="sxs-lookup"><span data-stu-id="e44ed-182">The response is the same for each of the preceding cases, independent of the policy that is executed.</span></span>

<span data-ttu-id="e44ed-183">Uma resposta bem-sucedida usando `response_mode=fragment` se parece com esta:</span><span class="sxs-lookup"><span data-stu-id="e44ed-183">A successful response using `response_mode=fragment` would look like:</span></span>

```
GET https://aadb2cplayground.azurewebsites.net/#
id_token=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...
&code=AwABAAAAvPM1KaPlrEqdFSBzjqfTGBCmLdgfSTLEMPGYuNHSUYBrq...
&state=arbitrary_data_you_can_receive_in_the_response
```

| <span data-ttu-id="e44ed-184">Parâmetro</span><span class="sxs-lookup"><span data-stu-id="e44ed-184">Parameter</span></span> | <span data-ttu-id="e44ed-185">Descrição</span><span class="sxs-lookup"><span data-stu-id="e44ed-185">Description</span></span> |
| --- | --- |
| <span data-ttu-id="e44ed-186">id_token</span><span class="sxs-lookup"><span data-stu-id="e44ed-186">id_token</span></span> |<span data-ttu-id="e44ed-187">O token de ID que o aplicativo solicitou.</span><span class="sxs-lookup"><span data-stu-id="e44ed-187">The ID token that the app requested.</span></span> <span data-ttu-id="e44ed-188">Você pode usar o token de ID para verificar a identidade do usuário e iniciar uma sessão com o usuário.</span><span class="sxs-lookup"><span data-stu-id="e44ed-188">You can use the ID token to verify the user's identity and begin a session with the user.</span></span> <span data-ttu-id="e44ed-189">Mais detalhes sobre tokens de ID e respectivo conteúdo estão incluídos na [referência de token do Azure AD B2C](active-directory-b2c-reference-tokens.md).</span><span class="sxs-lookup"><span data-stu-id="e44ed-189">More details on ID tokens and their contents are included in the [Azure AD B2C token reference](active-directory-b2c-reference-tokens.md).</span></span> |
| <span data-ttu-id="e44ed-190">código</span><span class="sxs-lookup"><span data-stu-id="e44ed-190">code</span></span> |<span data-ttu-id="e44ed-191">O código de autorização que o aplicativo solicitou, se você usou `response_type=code+id_token`.</span><span class="sxs-lookup"><span data-stu-id="e44ed-191">The authorization code that the app requested, if you used `response_type=code+id_token`.</span></span> <span data-ttu-id="e44ed-192">O aplicativo pode usar o código de autorização para solicitar um token de acesso para um recurso de destino.</span><span class="sxs-lookup"><span data-stu-id="e44ed-192">The app can use the authorization code to request an access token for a target resource.</span></span> <span data-ttu-id="e44ed-193">Os códigos de autorização têm uma duração muito curta.</span><span class="sxs-lookup"><span data-stu-id="e44ed-193">Authorization codes are very short-lived.</span></span> <span data-ttu-id="e44ed-194">Normalmente, eles expiram depois de cerca de 10 minutos.</span><span class="sxs-lookup"><span data-stu-id="e44ed-194">Typically, they expire after about 10 minutes.</span></span> |
| <span data-ttu-id="e44ed-195">state</span><span class="sxs-lookup"><span data-stu-id="e44ed-195">state</span></span> |<span data-ttu-id="e44ed-196">Se um parâmetro `state` estiver incluído na solicitação, o mesmo valor deverá aparecer na resposta.</span><span class="sxs-lookup"><span data-stu-id="e44ed-196">If a `state` parameter is included in the request, the same value should appear in the response.</span></span> <span data-ttu-id="e44ed-197">O aplicativo deve verificar se os valores `state` na solicitação e na resposta são idênticos.</span><span class="sxs-lookup"><span data-stu-id="e44ed-197">The app should verify that the `state` values in the request and response are identical.</span></span> |

<span data-ttu-id="e44ed-198">As respostas de erro também podem ser enviadas ao parâmetro `redirect_uri` para que o aplicativo possa tratá-las adequadamente:</span><span class="sxs-lookup"><span data-stu-id="e44ed-198">Error responses can also be sent to the `redirect_uri` parameter so that the app can handle them appropriately:</span></span>

```
GET https://aadb2cplayground.azurewebsites.net/#
error=access_denied
&error_description=the+user+canceled+the+authentication
&state=arbitrary_data_you_can_receive_in_the_response
```

| <span data-ttu-id="e44ed-199">Parâmetro</span><span class="sxs-lookup"><span data-stu-id="e44ed-199">Parameter</span></span> | <span data-ttu-id="e44ed-200">Descrição</span><span class="sxs-lookup"><span data-stu-id="e44ed-200">Description</span></span> |
| --- | --- |
| <span data-ttu-id="e44ed-201">error</span><span class="sxs-lookup"><span data-stu-id="e44ed-201">error</span></span> |<span data-ttu-id="e44ed-202">Uma cadeia de caracteres de códigos de erro que pode ser usada para classificar tipos de erro que ocorrem e pode ser usada para responder aos erros.</span><span class="sxs-lookup"><span data-stu-id="e44ed-202">An error-code string that can be used to classify types of errors that occur and that can be used to react to errors.</span></span> |
| <span data-ttu-id="e44ed-203">error_description</span><span class="sxs-lookup"><span data-stu-id="e44ed-203">error_description</span></span> |<span data-ttu-id="e44ed-204">Uma mensagem de erro específica que pode ajudar um desenvolvedor a identificar a causa raiz de um erro de autenticação.</span><span class="sxs-lookup"><span data-stu-id="e44ed-204">A specific error message that can help a developer identify the root cause of an authentication error.</span></span> |
| <span data-ttu-id="e44ed-205">state</span><span class="sxs-lookup"><span data-stu-id="e44ed-205">state</span></span> |<span data-ttu-id="e44ed-206">Confira a descrição completa da primeira tabela nesta seção.</span><span class="sxs-lookup"><span data-stu-id="e44ed-206">See the full description in the first table in this section.</span></span> <span data-ttu-id="e44ed-207">Se um parâmetro `state` estiver incluído na solicitação, o mesmo valor deverá aparecer na resposta.</span><span class="sxs-lookup"><span data-stu-id="e44ed-207">If a `state` parameter is included in the request, the same value should appear in the response.</span></span> <span data-ttu-id="e44ed-208">O aplicativo deve verificar se os valores `state` na solicitação e resposta são idênticos.</span><span class="sxs-lookup"><span data-stu-id="e44ed-208">The app should verify that the `state` values in the request and response are identical.</span></span> |

## <a name="validate-the-id-token"></a><span data-ttu-id="e44ed-209">Validar o token de ID</span><span class="sxs-lookup"><span data-stu-id="e44ed-209">Validate the ID token</span></span>
<span data-ttu-id="e44ed-210">Apenas o recebimento de um tokend de ID não é suficiente para autenticar o usuário.</span><span class="sxs-lookup"><span data-stu-id="e44ed-210">Just receiving an ID token is not enough to authenticate the user.</span></span> <span data-ttu-id="e44ed-211">Você deve validar a assinatura do token de ID e verificar as declarações no token, de acordo com os requisitos do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="e44ed-211">You must validate the ID token's signature and verify the claims in the token per your app's requirements.</span></span> <span data-ttu-id="e44ed-212">O Azure AD B2C usa [JWTs (Tokens Web JSON)](http://self-issued.info/docs/draft-ietf-oauth-json-web-token.html) e criptografia de chave pública para assinar tokens e verificar se eles são válidos.</span><span class="sxs-lookup"><span data-stu-id="e44ed-212">Azure AD B2C uses [JSON Web Tokens (JWTs)](http://self-issued.info/docs/draft-ietf-oauth-json-web-token.html) and public key cryptography to sign tokens and verify that they are valid.</span></span>

<span data-ttu-id="e44ed-213">Há muitas bibliotecas de software livre para validar JWTs dependendo do idioma de preferência.</span><span class="sxs-lookup"><span data-stu-id="e44ed-213">There are many open-source libraries that are available for validating JWTs, depending on your language of preference.</span></span> <span data-ttu-id="e44ed-214">Recomendamos que você explore essas opções em vez de implementar a sua própria lógica de validação.</span><span class="sxs-lookup"><span data-stu-id="e44ed-214">We recommend exploring those options rather than implementing your own validation logic.</span></span> <span data-ttu-id="e44ed-215">As informações aqui serão úteis para descobrir como usar essas bibliotecas adequadamente.</span><span class="sxs-lookup"><span data-stu-id="e44ed-215">The information here will be useful in figuring out how to properly use those libraries.</span></span>

<span data-ttu-id="e44ed-216">O Azure AD B2C tem um ponto de extremidade de metadados do OpenID Connect, que permite a um aplicativo buscar informações sobre o Azure AD B2C no tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="e44ed-216">Azure AD B2C has an OpenID Connect metadata endpoint, which allows an app to fetch information about Azure AD B2C at runtime.</span></span> <span data-ttu-id="e44ed-217">Essas informações incluem pontos de extremidade, conteúdos de token e chaves de assinatura de token.</span><span class="sxs-lookup"><span data-stu-id="e44ed-217">This information includes endpoints, token contents, and token signing keys.</span></span> <span data-ttu-id="e44ed-218">Há um documento de metadados JSON para cada política no seu locatário de B2C.</span><span class="sxs-lookup"><span data-stu-id="e44ed-218">There is a JSON metadata document for each policy in your B2C tenant.</span></span> <span data-ttu-id="e44ed-219">Por exemplo, o documento de metadados para a política `b2c_1_sign_in` em `fabrikamb2c.onmicrosoft.com` está localizado em:</span><span class="sxs-lookup"><span data-stu-id="e44ed-219">For example, the metadata document for the `b2c_1_sign_in` policy in `fabrikamb2c.onmicrosoft.com` is located at:</span></span>

`https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/v2.0/.well-known/openid-configuration?p=b2c_1_sign_in`

<span data-ttu-id="e44ed-220">Uma das propriedades desse documento de configuração é a `jwks_uri`, cujo valor para a mesma política seria:</span><span class="sxs-lookup"><span data-stu-id="e44ed-220">One of the properties of this configuration document is `jwks_uri`, whose value for the same policy would be:</span></span>

<span data-ttu-id="e44ed-221">`https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/discovery/v2.0/keys?p=b2c_1_sign_in`.</span><span class="sxs-lookup"><span data-stu-id="e44ed-221">`https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/discovery/v2.0/keys?p=b2c_1_sign_in`.</span></span>

<span data-ttu-id="e44ed-222">Para determinar qual política foi usada na assinatura de um token de ID (e onde buscar os metadados), você tem duas opções.</span><span class="sxs-lookup"><span data-stu-id="e44ed-222">To determine which policy was used in signing an ID token (and from where to fetch the metadata), you have two options.</span></span> <span data-ttu-id="e44ed-223">Primeiro, o nome da política é incluído na declaração `acr` no token de ID.</span><span class="sxs-lookup"><span data-stu-id="e44ed-223">First, the policy name is included in the `acr` claim in the ID token.</span></span> <span data-ttu-id="e44ed-224">Para obter informações sobre como analisar as declarações de um token de ID, consulte a [Referência de token do Azure AD B2C](active-directory-b2c-reference-tokens.md).</span><span class="sxs-lookup"><span data-stu-id="e44ed-224">For information on how to parse the claims from an ID token, see the [Azure AD B2C token reference](active-directory-b2c-reference-tokens.md).</span></span> <span data-ttu-id="e44ed-225">A outra opção é codificar a política no valor do parâmetro `state` quando você emitir a solicitação e, em seguida, decodificá-lo para determinar qual política foi usada.</span><span class="sxs-lookup"><span data-stu-id="e44ed-225">Your other option is to encode the policy in the value of the `state` parameter when you issue the request, and then decode it to determine which policy was used.</span></span> <span data-ttu-id="e44ed-226">Ambos os métodos são válidos.</span><span class="sxs-lookup"><span data-stu-id="e44ed-226">Either method is valid.</span></span>

<span data-ttu-id="e44ed-227">Depois que tiver adquirido o documento de metadados do ponto de extremidade de metadados do OpenID Connect, você poderá usar as chaves públicas RSA 256 (localizadas nesse ponto de extremidade) para validar a assinatura do token de ID.</span><span class="sxs-lookup"><span data-stu-id="e44ed-227">After you've acquired the metadata document from the OpenID Connect metadata endpoint, you can use the RSA 256 public keys (which are located at this endpoint) to validate the signature of the ID token.</span></span> <span data-ttu-id="e44ed-228">Poderá haver várias chaves listadas nesse ponto de extremidade em qualquer ponto no tempo, cada uma identificada por uma declaração `kid`.</span><span class="sxs-lookup"><span data-stu-id="e44ed-228">There might be multiple keys listed at this endpoint at any given point in time, each identified by a `kid` claim.</span></span> <span data-ttu-id="e44ed-229">O cabeçalho do token de ID também contém uma declaração `kid`, que indica quais dessas chaves foi usada para assinar o token de ID.</span><span class="sxs-lookup"><span data-stu-id="e44ed-229">The header of the ID token also contains a `kid` claim, which indicates which of these keys was used to sign the ID token.</span></span> <span data-ttu-id="e44ed-230">Para obter mais informações, consulte a [referência de token do Azure AD B2C](active-directory-b2c-reference-tokens.md) (especialmente a seção [validando tokens](active-directory-b2c-reference-tokens.md#token-validation)).</span><span class="sxs-lookup"><span data-stu-id="e44ed-230">For more information, see the [Azure AD B2C token reference](active-directory-b2c-reference-tokens.md) (the section on [validating tokens](active-directory-b2c-reference-tokens.md#token-validation), in particular).</span></span>
<!--TODO: Improve the information on this-->

<span data-ttu-id="e44ed-231">Depois de validar a assinatura do token de ID, há várias declarações que você precisa verificar.</span><span class="sxs-lookup"><span data-stu-id="e44ed-231">After you've validated the signature of the ID token, there are several claims that you need to verify.</span></span> <span data-ttu-id="e44ed-232">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="e44ed-232">For instance:</span></span>

* <span data-ttu-id="e44ed-233">Você deve validar a declaração `nonce` para evitar ataques de reprodução de token.</span><span class="sxs-lookup"><span data-stu-id="e44ed-233">You should validate the `nonce` claim to prevent token replay attacks.</span></span> <span data-ttu-id="e44ed-234">Seu valor deve ser o que você especificou na solicitação de conexão.</span><span class="sxs-lookup"><span data-stu-id="e44ed-234">Its value should be what you specified in the sign-in request.</span></span>
* <span data-ttu-id="e44ed-235">Você deve validar a declaração `aud` para garantir que o token de ID foi emitido para o seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="e44ed-235">You should validate the `aud` claim to ensure that the ID token was issued for your app.</span></span> <span data-ttu-id="e44ed-236">Seu valor deve ser a ID do aplicativo do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="e44ed-236">Its value should be the application ID of your app.</span></span>
* <span data-ttu-id="e44ed-237">Você deve validar as declarações `iat` e `exp` para garantir que o token de ID não tenha se expirado.</span><span class="sxs-lookup"><span data-stu-id="e44ed-237">You should validate the `iat` and `exp` claims to ensure that the ID token has not expired.</span></span>

<span data-ttu-id="e44ed-238">Também há várias outras validações que devem ser realizadas.</span><span class="sxs-lookup"><span data-stu-id="e44ed-238">There are also several more validations that you should perform.</span></span> <span data-ttu-id="e44ed-239">Elas estão descritas detalhadamente nas [Especificações básicas do OpenID Connect](http://openid.net/specs/openid-connect-core-1_0.html).  Talvez você também queira validar declarações adicionais, dependendo do cenário.</span><span class="sxs-lookup"><span data-stu-id="e44ed-239">These are described in detail in the [OpenID Connect Core Spec](http://openid.net/specs/openid-connect-core-1_0.html).  You might also want to validate additional claims, depending on your scenario.</span></span> <span data-ttu-id="e44ed-240">Algumas validações comuns incluem:</span><span class="sxs-lookup"><span data-stu-id="e44ed-240">Some common validations include:</span></span>

* <span data-ttu-id="e44ed-241">A garantia de que o usuário/organização tenha feito inscrição para usar o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="e44ed-241">Ensuring that the user/organization has signed up for the app.</span></span>
* <span data-ttu-id="e44ed-242">A garantia de que o usuário tenha a autorização/os privilégios adequados.</span><span class="sxs-lookup"><span data-stu-id="e44ed-242">Ensuring that the user has proper authorization/privileges.</span></span>
* <span data-ttu-id="e44ed-243">A garantia de que uma determinada intensidade de autenticação tenha ocorrido, como o Azure Multi-Factor Authentication.</span><span class="sxs-lookup"><span data-stu-id="e44ed-243">Ensuring that a certain strength of authentication has occurred, such as Azure Multi-Factor Authentication.</span></span>

<span data-ttu-id="e44ed-244">Para obter mais informações sobre as declarações em um token de ID, consulte a [referência de token do Azure AD B2C](active-directory-b2c-reference-tokens.md).</span><span class="sxs-lookup"><span data-stu-id="e44ed-244">For more information on the claims in an ID token, see the [Azure AD B2C token reference](active-directory-b2c-reference-tokens.md).</span></span>

<span data-ttu-id="e44ed-245">Após validar o token de ID, você poderá iniciar uma sessão com o usuário.</span><span class="sxs-lookup"><span data-stu-id="e44ed-245">After you have validated the ID token, you can begin a session with the user.</span></span> <span data-ttu-id="e44ed-246">Você pode usar as declarações no token de ID para obter informações sobre o usuário em seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="e44ed-246">You can use the claims in the ID token to obtain information about the user in your app.</span></span> <span data-ttu-id="e44ed-247">Os usos para essas informações incluem exibição, registros e autorização.</span><span class="sxs-lookup"><span data-stu-id="e44ed-247">Uses for this information include display, records, and authorization.</span></span>

## <a name="get-a-token"></a><span data-ttu-id="e44ed-248">Obter um token</span><span class="sxs-lookup"><span data-stu-id="e44ed-248">Get a token</span></span>
<span data-ttu-id="e44ed-249">Se você precisar de seu aplicativo Web somente para executar as políticas, você poderá ignorar as próximas seções.</span><span class="sxs-lookup"><span data-stu-id="e44ed-249">If you need your web app to only execute policies, you can skip the next few sections.</span></span> <span data-ttu-id="e44ed-250">Essas seções serão aplicáveis somente aos aplicativos Web que precisarem fazer chamadas autenticadas a uma API Web e que também sejam protegidas pelo Azure AD B2C.</span><span class="sxs-lookup"><span data-stu-id="e44ed-250">These sections are applicable only to web apps that need to make authenticated calls to a web API and are also protected by Azure AD B2C.</span></span>

<span data-ttu-id="e44ed-251">Você pode resgatar o código de autorização adquirido (usando `response_type=code+id_token`) para um token do recurso desejado enviando uma solicitação `POST` ao ponto de extremidade `/token`.</span><span class="sxs-lookup"><span data-stu-id="e44ed-251">You can redeem the authorization code that you acquired (by using `response_type=code+id_token`) for a token to the desired resource by sending a `POST` request to the `/token` endpoint.</span></span> <span data-ttu-id="e44ed-252">Atualmente, o único recurso para o qual você pode solicitar um token é a própria API Web de back-end do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="e44ed-252">Currently, the only resource that you can request a token for is your app's own back-end web API.</span></span> <span data-ttu-id="e44ed-253">A convenção para solicitar um token para si mesmo é usar a ID do cliente do aplicativo como o escopo:</span><span class="sxs-lookup"><span data-stu-id="e44ed-253">The convention for requesting a token to yourself is to use your app's client ID as the scope:</span></span>

```
POST fabrikamb2c.onmicrosoft.com/oauth2/v2.0/token?p=b2c_1_sign_in HTTP/1.1
Host: https://login.microsoftonline.com
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code&client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6&scope=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6 offline_access&code=AwABAAAAvPM1KaPlrEqdFSBzjqfTGBCmLdgfSTLEMPGYuNHSUYBrq...&redirect_uri=urn:ietf:wg:oauth:2.0:oob&client_secret=<your-application-secret>

```

| <span data-ttu-id="e44ed-254">Parâmetro</span><span class="sxs-lookup"><span data-stu-id="e44ed-254">Parameter</span></span> | <span data-ttu-id="e44ed-255">Obrigatório?</span><span class="sxs-lookup"><span data-stu-id="e44ed-255">Required?</span></span> | <span data-ttu-id="e44ed-256">Descrição</span><span class="sxs-lookup"><span data-stu-id="e44ed-256">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="e44ed-257">p</span><span class="sxs-lookup"><span data-stu-id="e44ed-257">p</span></span> |<span data-ttu-id="e44ed-258">Obrigatório</span><span class="sxs-lookup"><span data-stu-id="e44ed-258">Required</span></span> |<span data-ttu-id="e44ed-259">A política que foi usada para adquirir o código de autorização.</span><span class="sxs-lookup"><span data-stu-id="e44ed-259">The policy that was used to acquire the authorization code.</span></span> <span data-ttu-id="e44ed-260">Você não poderá usar uma política diferente nessa solicitação.</span><span class="sxs-lookup"><span data-stu-id="e44ed-260">You cannot use a different policy in this request.</span></span> <span data-ttu-id="e44ed-261">Observe que esse parâmetro é adicionado à cadeia de caracteres de consulta e não ao corpo do `POST`.</span><span class="sxs-lookup"><span data-stu-id="e44ed-261">Note that you add this parameter to the query string, not to the `POST` body.</span></span> |
| <span data-ttu-id="e44ed-262">client_id</span><span class="sxs-lookup"><span data-stu-id="e44ed-262">client_id</span></span> |<span data-ttu-id="e44ed-263">Obrigatório</span><span class="sxs-lookup"><span data-stu-id="e44ed-263">Required</span></span> |<span data-ttu-id="e44ed-264">A ID do aplicativo que o [portal do Azure](https://portal.azure.com/) atribuiu a seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="e44ed-264">The application ID that the [Azure portal](https://portal.azure.com/) assigned to your app.</span></span> |
| <span data-ttu-id="e44ed-265">grant_type</span><span class="sxs-lookup"><span data-stu-id="e44ed-265">grant_type</span></span> |<span data-ttu-id="e44ed-266">Obrigatório</span><span class="sxs-lookup"><span data-stu-id="e44ed-266">Required</span></span> |<span data-ttu-id="e44ed-267">O tipo de concessão, que deve ser `authorization_code` para o fluxo do código de autorização.</span><span class="sxs-lookup"><span data-stu-id="e44ed-267">The type of grant, which must be `authorization_code` for the authorization code flow.</span></span> |
| <span data-ttu-id="e44ed-268">scope</span><span class="sxs-lookup"><span data-stu-id="e44ed-268">scope</span></span> |<span data-ttu-id="e44ed-269">Recomendadas</span><span class="sxs-lookup"><span data-stu-id="e44ed-269">Recommended</span></span> |<span data-ttu-id="e44ed-270">Uma lista de escopos separados por espaços.</span><span class="sxs-lookup"><span data-stu-id="e44ed-270">A space-separated list of scopes.</span></span> <span data-ttu-id="e44ed-271">Um único valor de escopo indica ao Azure AD ambas as permissões que estão sendo solicitadas.</span><span class="sxs-lookup"><span data-stu-id="e44ed-271">A single scope value indicates to Azure AD both permissions that are being requested.</span></span> <span data-ttu-id="e44ed-272">O escopo `openid` indica uma permissão para conectar o usuário e obter dados sobre ele na forma de parâmetros de id_token.</span><span class="sxs-lookup"><span data-stu-id="e44ed-272">The `openid` scope indicates a permission to sign in the user and get data about the user in the form of id_token parameters.</span></span> <span data-ttu-id="e44ed-273">Ele pode ser usado para obter tokens para a própria API Web de back-end do seu aplicativo, representado pela mesma ID do aplicativo que o cliente.</span><span class="sxs-lookup"><span data-stu-id="e44ed-273">It can be used to get tokens to your app's own back-end web API, which is represented by the same application ID as the client.</span></span> <span data-ttu-id="e44ed-274">O escopo `offline_access` indica que o aplicativo precisará de um token de atualização para acessar os recursos de longa duração.</span><span class="sxs-lookup"><span data-stu-id="e44ed-274">The `offline_access` scope indicates that your app will need a refresh token for long-lived access to resources.</span></span> |
| <span data-ttu-id="e44ed-275">código</span><span class="sxs-lookup"><span data-stu-id="e44ed-275">code</span></span> |<span data-ttu-id="e44ed-276">Obrigatório</span><span class="sxs-lookup"><span data-stu-id="e44ed-276">Required</span></span> |<span data-ttu-id="e44ed-277">O código de autorização que você adquiriu no primeiro segmento do fluxo.</span><span class="sxs-lookup"><span data-stu-id="e44ed-277">The authorization code that you acquired in the first leg of the flow.</span></span> |
| <span data-ttu-id="e44ed-278">redirect_uri</span><span class="sxs-lookup"><span data-stu-id="e44ed-278">redirect_uri</span></span> |<span data-ttu-id="e44ed-279">Obrigatório</span><span class="sxs-lookup"><span data-stu-id="e44ed-279">Required</span></span> |<span data-ttu-id="e44ed-280">O parâmetro `redirect_uri` do aplicativo em que você recebeu o código de autorização.</span><span class="sxs-lookup"><span data-stu-id="e44ed-280">The `redirect_uri` parameter of the application where you received the authorization code.</span></span> |
| <span data-ttu-id="e44ed-281">client_secret</span><span class="sxs-lookup"><span data-stu-id="e44ed-281">client_secret</span></span> |<span data-ttu-id="e44ed-282">Obrigatório</span><span class="sxs-lookup"><span data-stu-id="e44ed-282">Required</span></span> |<span data-ttu-id="e44ed-283">O segredo do aplicativo gerado no [portal do Azure](https://portal.azure.com/).</span><span class="sxs-lookup"><span data-stu-id="e44ed-283">The application secret that you generated in the [Azure portal](https://portal.azure.com/).</span></span> <span data-ttu-id="e44ed-284">O segredo do aplicativo é um artefato de segurança importante.</span><span class="sxs-lookup"><span data-stu-id="e44ed-284">This application secret is an important security artifact.</span></span> <span data-ttu-id="e44ed-285">Você deve armazená-lo com segurança no servidor.</span><span class="sxs-lookup"><span data-stu-id="e44ed-285">You should store it securely on your server.</span></span> <span data-ttu-id="e44ed-286">Você também deve circular esse segredo do cliente em intervalos periódicos.</span><span class="sxs-lookup"><span data-stu-id="e44ed-286">You should also rotate this client secret on a periodic basis.</span></span> |

<span data-ttu-id="e44ed-287">Uma resposta de token bem-sucedida tem a seguinte aparência:</span><span class="sxs-lookup"><span data-stu-id="e44ed-287">A successful token response looks like:</span></span>

```
{
    "not_before": "1442340812",
    "token_type": "Bearer",
    "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...",
    "scope": "90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6 offline_access",
    "expires_in": "3600",
    "refresh_token": "AAQfQmvuDy8WtUv-sd0TBwWVQs1rC-Lfxa_NDkLqpg50Cxp5Dxj0VPF1mx2Z...",
}
```
| <span data-ttu-id="e44ed-288">Parâmetro</span><span class="sxs-lookup"><span data-stu-id="e44ed-288">Parameter</span></span> | <span data-ttu-id="e44ed-289">Descrição</span><span class="sxs-lookup"><span data-stu-id="e44ed-289">Description</span></span> |
| --- | --- |
| <span data-ttu-id="e44ed-290">not_before</span><span class="sxs-lookup"><span data-stu-id="e44ed-290">not_before</span></span> |<span data-ttu-id="e44ed-291">A hora em que o token é considerado válido, nos valores de hora da época.</span><span class="sxs-lookup"><span data-stu-id="e44ed-291">The time at which the token is considered valid, in epoch time.</span></span> |
| <span data-ttu-id="e44ed-292">token_type</span><span class="sxs-lookup"><span data-stu-id="e44ed-292">token_type</span></span> |<span data-ttu-id="e44ed-293">O valor do tipo de token.</span><span class="sxs-lookup"><span data-stu-id="e44ed-293">The token type value.</span></span> <span data-ttu-id="e44ed-294">O único tipo com suporte do Azure AD é o `Bearer`.</span><span class="sxs-lookup"><span data-stu-id="e44ed-294">The only type that Azure AD supports is `Bearer`.</span></span> |
| <span data-ttu-id="e44ed-295">access_token</span><span class="sxs-lookup"><span data-stu-id="e44ed-295">access_token</span></span> |<span data-ttu-id="e44ed-296">O token JWT assinado que você solicitou.</span><span class="sxs-lookup"><span data-stu-id="e44ed-296">The signed JWT token that you requested.</span></span> |
| <span data-ttu-id="e44ed-297">scope</span><span class="sxs-lookup"><span data-stu-id="e44ed-297">scope</span></span> |<span data-ttu-id="e44ed-298">Os escopos para os quais o token é válido.</span><span class="sxs-lookup"><span data-stu-id="e44ed-298">The scopes for which the token is valid.</span></span> <span data-ttu-id="e44ed-299">Eles podem ser usados para o cache de tokens para uso posterior.</span><span class="sxs-lookup"><span data-stu-id="e44ed-299">These can be used for caching tokens for later use.</span></span> |
| <span data-ttu-id="e44ed-300">expires_in</span><span class="sxs-lookup"><span data-stu-id="e44ed-300">expires_in</span></span> |<span data-ttu-id="e44ed-301">O período de tempo pelo qual o token de acesso é válido (em segundos).</span><span class="sxs-lookup"><span data-stu-id="e44ed-301">The length of time that the access token is valid (in seconds).</span></span> |
| <span data-ttu-id="e44ed-302">refresh_token</span><span class="sxs-lookup"><span data-stu-id="e44ed-302">refresh_token</span></span> |<span data-ttu-id="e44ed-303">Um token de atualização do OAuth 2.0.</span><span class="sxs-lookup"><span data-stu-id="e44ed-303">An OAuth 2.0 refresh token.</span></span> <span data-ttu-id="e44ed-304">O aplicativo pode usar esse token para adquirir tokens de acesso adicionais depois que o atual expirar.</span><span class="sxs-lookup"><span data-stu-id="e44ed-304">The app can use this token to acquire additional tokens after the current token expires.</span></span> <span data-ttu-id="e44ed-305">Os tokens de atualização têm longa duração e podem ser usados para reter acesso a recursos por períodos estendidos.</span><span class="sxs-lookup"><span data-stu-id="e44ed-305">Refresh tokens are long-lived and can be used to retain access to resources for extended periods of time.</span></span> <span data-ttu-id="e44ed-306">Para obter mais detalhes, consulte a [referência de token B2C](active-directory-b2c-reference-tokens.md).</span><span class="sxs-lookup"><span data-stu-id="e44ed-306">For more details, refer to the [B2C token reference](active-directory-b2c-reference-tokens.md).</span></span> <span data-ttu-id="e44ed-307">Observe que você deve ter usado o escopo `offline_access` tanto na autorização quanto nas solicitações de token para receber um token de atualização.</span><span class="sxs-lookup"><span data-stu-id="e44ed-307">Note that you must have used the scope `offline_access` in both the authorization and token requests in order to receive a refresh token.</span></span> |

<span data-ttu-id="e44ed-308">As respostas de erro se parecem com:</span><span class="sxs-lookup"><span data-stu-id="e44ed-308">Error responses look like:</span></span>

```
{
    "error": "access_denied",
    "error_description": "The user revoked access to the app.",
}
```

| <span data-ttu-id="e44ed-309">Parâmetro</span><span class="sxs-lookup"><span data-stu-id="e44ed-309">Parameter</span></span> | <span data-ttu-id="e44ed-310">Descrição</span><span class="sxs-lookup"><span data-stu-id="e44ed-310">Description</span></span> |
| --- | --- |
| <span data-ttu-id="e44ed-311">error</span><span class="sxs-lookup"><span data-stu-id="e44ed-311">error</span></span> |<span data-ttu-id="e44ed-312">Uma cadeia de caracteres de códigos de erro que pode ser usada para classificar tipos de erro que ocorrem e pode ser usada para responder aos erros.</span><span class="sxs-lookup"><span data-stu-id="e44ed-312">An error-code string that can be used to classify types of errors that occur and that can be used to react to errors.</span></span> |
| <span data-ttu-id="e44ed-313">error_description</span><span class="sxs-lookup"><span data-stu-id="e44ed-313">error_description</span></span> |<span data-ttu-id="e44ed-314">Uma mensagem de erro específica que pode ajudar um desenvolvedor a identificar a causa raiz de um erro de autenticação.</span><span class="sxs-lookup"><span data-stu-id="e44ed-314">A specific error message that can help a developer identify the root cause of an authentication error.</span></span> |

## <a name="use-the-token"></a><span data-ttu-id="e44ed-315">Usar o token</span><span class="sxs-lookup"><span data-stu-id="e44ed-315">Use the token</span></span>
<span data-ttu-id="e44ed-316">Agora que adquiriu um token de acesso com êxito, você poderá usá-lo em solicitações às suas APIs Web de back-end incluindo-o no cabeçalho `Authorization`:</span><span class="sxs-lookup"><span data-stu-id="e44ed-316">Now that you've successfully acquired an access token, you can use the token in requests to your back-end web APIs by including it in the `Authorization` header:</span></span>

```
GET /tasks
Host: https://mytaskwebapi.com
Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...
```

## <a name="refresh-the-token"></a><span data-ttu-id="e44ed-317">Atualizar o token</span><span class="sxs-lookup"><span data-stu-id="e44ed-317">Refresh the token</span></span>
<span data-ttu-id="e44ed-318">Os tokens de ID têm vida curta.</span><span class="sxs-lookup"><span data-stu-id="e44ed-318">ID tokens are short-lived.</span></span> <span data-ttu-id="e44ed-319">Você deve atualizá-los depois que eles expirarem para poder continuar a acessar os recursos.</span><span class="sxs-lookup"><span data-stu-id="e44ed-319">You must refresh them after they expire to continue being able to access resources.</span></span> <span data-ttu-id="e44ed-320">Faça isso enviando outra solicitação `POST` ao ponto de extremidade `/token`.</span><span class="sxs-lookup"><span data-stu-id="e44ed-320">You can do so by submitting another `POST` request to the `/token` endpoint.</span></span> <span data-ttu-id="e44ed-321">Desta vez, forneça o parâmetro `refresh_token` em vez do parâmetro `code`:</span><span class="sxs-lookup"><span data-stu-id="e44ed-321">This time, provide the `refresh_token` parameter instead of the `code` parameter:</span></span>

```
POST fabrikamb2c.onmicrosoft.com/oauth2/v2.0/token?p=b2c_1_sign_in HTTP/1.1
Host: https://login.microsoftonline.com
Content-Type: application/x-www-form-urlencoded

grant_type=refresh_token&client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6&scope=openid offline_access&refresh_token=AwABAAAAvPM1KaPlrEqdFSBzjqfTGBCmLdgfSTLEMPGYuNHSUYBrq...&redirect_uri=urn:ietf:wg:oauth:2.0:oob&client_secret=<your-application-secret>
```

| <span data-ttu-id="e44ed-322">Parâmetro</span><span class="sxs-lookup"><span data-stu-id="e44ed-322">Parameter</span></span> | <span data-ttu-id="e44ed-323">Obrigatório</span><span class="sxs-lookup"><span data-stu-id="e44ed-323">Required</span></span> | <span data-ttu-id="e44ed-324">Descrição</span><span class="sxs-lookup"><span data-stu-id="e44ed-324">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="e44ed-325">p</span><span class="sxs-lookup"><span data-stu-id="e44ed-325">p</span></span> |<span data-ttu-id="e44ed-326">Obrigatório</span><span class="sxs-lookup"><span data-stu-id="e44ed-326">Required</span></span> |<span data-ttu-id="e44ed-327">A política que foi usada para adquirir o token de atualização original.</span><span class="sxs-lookup"><span data-stu-id="e44ed-327">The policy that was used to acquire the original refresh token.</span></span> <span data-ttu-id="e44ed-328">Você não poderá usar uma política diferente nessa solicitação.</span><span class="sxs-lookup"><span data-stu-id="e44ed-328">You cannot use a different policy in this request.</span></span> <span data-ttu-id="e44ed-329">Observe que esse parâmetro é adicionado à cadeia de caracteres de consulta e não ao corpo do POST.</span><span class="sxs-lookup"><span data-stu-id="e44ed-329">Note that you add this parameter to the query string, not to the POST body.</span></span> |
| <span data-ttu-id="e44ed-330">client_id</span><span class="sxs-lookup"><span data-stu-id="e44ed-330">client_id</span></span> |<span data-ttu-id="e44ed-331">Obrigatório</span><span class="sxs-lookup"><span data-stu-id="e44ed-331">Required</span></span> |<span data-ttu-id="e44ed-332">A ID do aplicativo que o [portal do Azure](https://portal.azure.com/) atribuiu a seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="e44ed-332">The application ID that the [Azure portal](https://portal.azure.com/) assigned to your app.</span></span> |
| <span data-ttu-id="e44ed-333">grant_type</span><span class="sxs-lookup"><span data-stu-id="e44ed-333">grant_type</span></span> |<span data-ttu-id="e44ed-334">Obrigatório</span><span class="sxs-lookup"><span data-stu-id="e44ed-334">Required</span></span> |<span data-ttu-id="e44ed-335">O tipo de concessão, que deve ser um token de atualização para esse segmento do fluxo do código de autorização.</span><span class="sxs-lookup"><span data-stu-id="e44ed-335">The type of grant, which must be a refresh token for this leg of the authorization code flow.</span></span> |
| <span data-ttu-id="e44ed-336">scope</span><span class="sxs-lookup"><span data-stu-id="e44ed-336">scope</span></span> |<span data-ttu-id="e44ed-337">Recomendadas</span><span class="sxs-lookup"><span data-stu-id="e44ed-337">Recommended</span></span> |<span data-ttu-id="e44ed-338">Uma lista de escopos separados por espaços.</span><span class="sxs-lookup"><span data-stu-id="e44ed-338">A space-separated list of scopes.</span></span> <span data-ttu-id="e44ed-339">Um único valor de escopo indica ao Azure AD ambas as permissões que estão sendo solicitadas.</span><span class="sxs-lookup"><span data-stu-id="e44ed-339">A single scope value indicates to Azure AD both permissions that are being requested.</span></span> <span data-ttu-id="e44ed-340">O escopo `openid` indica uma permissão para conectar o usuário e obter dados sobre ele na forma de tokens de ID.</span><span class="sxs-lookup"><span data-stu-id="e44ed-340">The `openid` scope indicates a permission to sign in the user and get data about the user in the form of ID tokens.</span></span> <span data-ttu-id="e44ed-341">Ele pode ser usado para obter tokens para a própria API Web de back-end do seu aplicativo, representado pela mesma ID do aplicativo que o cliente.</span><span class="sxs-lookup"><span data-stu-id="e44ed-341">It can be used to get tokens to your app's own back-end web API, which is represented by the same application ID as the client.</span></span> <span data-ttu-id="e44ed-342">O escopo `offline_access` indica que o aplicativo precisará de um token de atualização para acessar os recursos de longa duração.</span><span class="sxs-lookup"><span data-stu-id="e44ed-342">The `offline_access` scope indicates that your app will need a refresh token for long-lived access to resources.</span></span> |
| <span data-ttu-id="e44ed-343">redirect_uri</span><span class="sxs-lookup"><span data-stu-id="e44ed-343">redirect_uri</span></span> |<span data-ttu-id="e44ed-344">Recomendadas</span><span class="sxs-lookup"><span data-stu-id="e44ed-344">Recommended</span></span> |<span data-ttu-id="e44ed-345">O parâmetro `redirect_uri` do aplicativo em que você recebeu o código de autorização.</span><span class="sxs-lookup"><span data-stu-id="e44ed-345">The `redirect_uri` parameter of the application where you received the authorization code.</span></span> |
| <span data-ttu-id="e44ed-346">refresh_token</span><span class="sxs-lookup"><span data-stu-id="e44ed-346">refresh_token</span></span> |<span data-ttu-id="e44ed-347">Obrigatório</span><span class="sxs-lookup"><span data-stu-id="e44ed-347">Required</span></span> |<span data-ttu-id="e44ed-348">O token de atualização original que você adquiriu na segunda ramificação do fluxo.</span><span class="sxs-lookup"><span data-stu-id="e44ed-348">The original refresh token that you acquired in the second leg of the flow.</span></span> <span data-ttu-id="e44ed-349">Observe que você deve ter usado o escopo `offline_access` tanto na autorização quanto nas solicitações de token para receber um token de atualização.</span><span class="sxs-lookup"><span data-stu-id="e44ed-349">Note that you must have used the scope `offline_access` in both the authorization and token requests in order to receive a refresh token.</span></span> |
| <span data-ttu-id="e44ed-350">client_secret</span><span class="sxs-lookup"><span data-stu-id="e44ed-350">client_secret</span></span> |<span data-ttu-id="e44ed-351">Obrigatório</span><span class="sxs-lookup"><span data-stu-id="e44ed-351">Required</span></span> |<span data-ttu-id="e44ed-352">O segredo do aplicativo gerado no [portal do Azure](https://portal.azure.com/).</span><span class="sxs-lookup"><span data-stu-id="e44ed-352">The application secret that you generated in the [Azure portal](https://portal.azure.com/).</span></span> <span data-ttu-id="e44ed-353">O segredo do aplicativo é um artefato de segurança importante.</span><span class="sxs-lookup"><span data-stu-id="e44ed-353">This application secret is an important security artifact.</span></span> <span data-ttu-id="e44ed-354">Você deve armazená-lo com segurança no servidor.</span><span class="sxs-lookup"><span data-stu-id="e44ed-354">You should store it securely on your server.</span></span> <span data-ttu-id="e44ed-355">Você também deve circular esse segredo do cliente em intervalos periódicos.</span><span class="sxs-lookup"><span data-stu-id="e44ed-355">You should also rotate this client secret on a periodic basis.</span></span> |

<span data-ttu-id="e44ed-356">Uma resposta de token bem-sucedida tem a seguinte aparência:</span><span class="sxs-lookup"><span data-stu-id="e44ed-356">A successful token response looks like:</span></span>

```
{
    "not_before": "1442340812",
    "token_type": "Bearer",
    "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...",
    "scope": "90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6 offline_access",
    "expires_in": "3600",
    "refresh_token": "AAQfQmvuDy8WtUv-sd0TBwWVQs1rC-Lfxa_NDkLqpg50Cxp5Dxj0VPF1mx2Z...",
}
```
| <span data-ttu-id="e44ed-357">Parâmetro</span><span class="sxs-lookup"><span data-stu-id="e44ed-357">Parameter</span></span> | <span data-ttu-id="e44ed-358">Descrição</span><span class="sxs-lookup"><span data-stu-id="e44ed-358">Description</span></span> |
| --- | --- |
| <span data-ttu-id="e44ed-359">not_before</span><span class="sxs-lookup"><span data-stu-id="e44ed-359">not_before</span></span> |<span data-ttu-id="e44ed-360">A hora em que o token é considerado válido, nos valores de hora da época.</span><span class="sxs-lookup"><span data-stu-id="e44ed-360">The time at which the token is considered valid, in epoch time.</span></span> |
| <span data-ttu-id="e44ed-361">token_type</span><span class="sxs-lookup"><span data-stu-id="e44ed-361">token_type</span></span> |<span data-ttu-id="e44ed-362">O valor do tipo de token.</span><span class="sxs-lookup"><span data-stu-id="e44ed-362">The token type value.</span></span> <span data-ttu-id="e44ed-363">O único tipo com suporte do Azure AD é o `Bearer`.</span><span class="sxs-lookup"><span data-stu-id="e44ed-363">The only type that Azure AD supports is `Bearer`.</span></span> |
| <span data-ttu-id="e44ed-364">access_token</span><span class="sxs-lookup"><span data-stu-id="e44ed-364">access_token</span></span> |<span data-ttu-id="e44ed-365">O token JWT assinado que você solicitou.</span><span class="sxs-lookup"><span data-stu-id="e44ed-365">The signed JWT token that you requested.</span></span> |
| <span data-ttu-id="e44ed-366">scope</span><span class="sxs-lookup"><span data-stu-id="e44ed-366">scope</span></span> |<span data-ttu-id="e44ed-367">O escopo para o qual o token é válido, que pode ser usado no cache de tokens para uso posterior.</span><span class="sxs-lookup"><span data-stu-id="e44ed-367">The scope that the token is valid for, which can be used for caching tokens for later use.</span></span> |
| <span data-ttu-id="e44ed-368">expires_in</span><span class="sxs-lookup"><span data-stu-id="e44ed-368">expires_in</span></span> |<span data-ttu-id="e44ed-369">O período de tempo pelo qual o token de acesso é válido (em segundos).</span><span class="sxs-lookup"><span data-stu-id="e44ed-369">The length of time that the access token is valid (in seconds).</span></span> |
| <span data-ttu-id="e44ed-370">refresh_token</span><span class="sxs-lookup"><span data-stu-id="e44ed-370">refresh_token</span></span> |<span data-ttu-id="e44ed-371">Um token de atualização do OAuth 2.0.</span><span class="sxs-lookup"><span data-stu-id="e44ed-371">An OAuth 2.0 refresh token.</span></span> <span data-ttu-id="e44ed-372">O aplicativo pode usar esse token para adquirir tokens de acesso adicionais depois que o atual expirar.</span><span class="sxs-lookup"><span data-stu-id="e44ed-372">The app can use this token to acquire additional tokens after the current token expires.</span></span>  <span data-ttu-id="e44ed-373">Os tokens de atualização têm longa duração e podem ser usados para reter acesso a recursos por períodos estendidos.</span><span class="sxs-lookup"><span data-stu-id="e44ed-373">Refresh tokens are long-lived and can be used to retain access to resources for extended periods of time.</span></span> <span data-ttu-id="e44ed-374">Para obter mais detalhes, consulte a [referência ao token B2C](active-directory-b2c-reference-tokens.md).</span><span class="sxs-lookup"><span data-stu-id="e44ed-374">For more detail, refer to the [B2C token reference](active-directory-b2c-reference-tokens.md).</span></span> |

<span data-ttu-id="e44ed-375">As respostas de erro se parecem com:</span><span class="sxs-lookup"><span data-stu-id="e44ed-375">Error responses look like:</span></span>

```
{
    "error": "access_denied",
    "error_description": "The user revoked access to the app.",
}
```

| <span data-ttu-id="e44ed-376">Parâmetro</span><span class="sxs-lookup"><span data-stu-id="e44ed-376">Parameter</span></span> | <span data-ttu-id="e44ed-377">Descrição</span><span class="sxs-lookup"><span data-stu-id="e44ed-377">Description</span></span> |
| --- | --- |
| <span data-ttu-id="e44ed-378">error</span><span class="sxs-lookup"><span data-stu-id="e44ed-378">error</span></span> |<span data-ttu-id="e44ed-379">Uma cadeia de caracteres de códigos de erro que pode ser usada para classificar tipos de erro que ocorrem e pode ser usada para responder aos erros.</span><span class="sxs-lookup"><span data-stu-id="e44ed-379">An error-code string that can be used to classify types of errors that occur and that can be used to react to errors.</span></span> |
| <span data-ttu-id="e44ed-380">error_description</span><span class="sxs-lookup"><span data-stu-id="e44ed-380">error_description</span></span> |<span data-ttu-id="e44ed-381">Uma mensagem de erro específica que pode ajudar um desenvolvedor a identificar a causa raiz de um erro de autenticação.</span><span class="sxs-lookup"><span data-stu-id="e44ed-381">A specific error message that can help a developer identify the root cause of an authentication error.</span></span> |

## <a name="send-a-sign-out-request"></a><span data-ttu-id="e44ed-382">Enviar uma solicitação de saída</span><span class="sxs-lookup"><span data-stu-id="e44ed-382">Send a sign-out request</span></span>
<span data-ttu-id="e44ed-383">Quando você deseja conectar o usuário do aplicativo, não é suficiente limpar os cookies do aplicativo e encerrar a sessão do usuário.</span><span class="sxs-lookup"><span data-stu-id="e44ed-383">When you want to sign the user out of the app, it is not enough to clear your app's cookies or otherwise end the session with the user.</span></span> <span data-ttu-id="e44ed-384">Você também deve redirecionar o usuário ao Azure AD para sair. Se você não conseguir fazer isso, é provável que o usuário consiga se autenticar novamente no aplicativo sem ter que reinserir as credenciais.</span><span class="sxs-lookup"><span data-stu-id="e44ed-384">You must also redirect the user to Azure AD to sign out. If you fail to do so, the user might be able to reauthenticate to your app without entering their credentials again.</span></span> <span data-ttu-id="e44ed-385">Isso ocorre porque eles terão uma sessão de logon único válida com o Azure AD.</span><span class="sxs-lookup"><span data-stu-id="e44ed-385">This is because they will have a valid single sign-on session with Azure AD.</span></span>

<span data-ttu-id="e44ed-386">Você pode simplesmente redirecionar o usuário para o ponto de extremidade `end_session` listado no documento de metadados do OpenID Connect descrito anteriormente na seção “Validar o token de ID”:</span><span class="sxs-lookup"><span data-stu-id="e44ed-386">You can simply redirect the user to the `end_session` endpoint that is listed in the OpenID Connect metadata document described earlier in the "Validate the ID token" section:</span></span>

```
GET https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/oauth2/v2.0/logout?
p=b2c_1_sign_in
&post_logout_redirect_uri=https%3A%2F%2Faadb2cplayground.azurewebsites.net%2F
```

| <span data-ttu-id="e44ed-387">Parâmetro</span><span class="sxs-lookup"><span data-stu-id="e44ed-387">Parameter</span></span> | <span data-ttu-id="e44ed-388">Obrigatório?</span><span class="sxs-lookup"><span data-stu-id="e44ed-388">Required?</span></span> | <span data-ttu-id="e44ed-389">Descrição</span><span class="sxs-lookup"><span data-stu-id="e44ed-389">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="e44ed-390">p</span><span class="sxs-lookup"><span data-stu-id="e44ed-390">p</span></span> |<span data-ttu-id="e44ed-391">Obrigatório</span><span class="sxs-lookup"><span data-stu-id="e44ed-391">Required</span></span> |<span data-ttu-id="e44ed-392">A política que você deseja usar para desconectar o usuário de seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="e44ed-392">The policy that you want to use to sign the user out of your application.</span></span> |
| <span data-ttu-id="e44ed-393">post_logout_redirect_uri</span><span class="sxs-lookup"><span data-stu-id="e44ed-393">post_logout_redirect_uri</span></span> |<span data-ttu-id="e44ed-394">Recomendadas</span><span class="sxs-lookup"><span data-stu-id="e44ed-394">Recommended</span></span> |<span data-ttu-id="e44ed-395">A URL para a qual o usuário deve ser redirecionado após a saída com êxito. Se não for incluída, o Azure AD B2C mostrará uma mensagem genérica ao usuário.</span><span class="sxs-lookup"><span data-stu-id="e44ed-395">The URL that the user should be redirected to after successful sign-out. If it is not included, Azure AD B2C shows the user a generic message.</span></span> |

> [!NOTE]
> <span data-ttu-id="e44ed-396">Embora o direcionamento do usuário para o ponto de extremidade `end_session` remova algum dos estados de logon único do usuário com o Azure AD B2C, ele não o desconectará da sessão de IDP (provedor de identidade) social.</span><span class="sxs-lookup"><span data-stu-id="e44ed-396">Although directing the user to the `end_session` endpoint will clear some of the user's single sign-on state with Azure AD B2C, it will not sign the user out of their social identity provider (IDP) session.</span></span> <span data-ttu-id="e44ed-397">Se o usuário selecionar o mesmo IDP durante uma conexão posterior, ele será autenticados novamente sem precisar inserir suas credenciais.</span><span class="sxs-lookup"><span data-stu-id="e44ed-397">If the user selects the same IDP during a subsequent sign-in, they will be reauthenticated, without entering their credentials.</span></span> <span data-ttu-id="e44ed-398">Se um usuário deseja sair do seu aplicativo B2C, isso não significa, necessariamente, que ele deseja desconectar-se de sua conta do Facebook.</span><span class="sxs-lookup"><span data-stu-id="e44ed-398">If a user wants to sign out of your B2C application, it does not necessarily mean they want to sign out of their Facebook account.</span></span> <span data-ttu-id="e44ed-399">No entanto, no caso de contas locais, a sessão do usuário será encerrada corretamente.</span><span class="sxs-lookup"><span data-stu-id="e44ed-399">However, in the case of local accounts, the user's session will be ended properly.</span></span>
> 
> 

## <a name="use-your-own-b2c-tenant"></a><span data-ttu-id="e44ed-400">Usar seu próprio locatário B2C</span><span class="sxs-lookup"><span data-stu-id="e44ed-400">Use your own B2C tenant</span></span>
<span data-ttu-id="e44ed-401">Se você quiser experimentar essas solicitações por conta própria, primeiro deverá seguir estas três etapas e, em seguida, substituir os valores descritos anteriormente pelos seus próprios valores:</span><span class="sxs-lookup"><span data-stu-id="e44ed-401">If you want to try these requests for yourself, you must first perform these three steps, and then replace the example values described earlier with your own:</span></span>

1. <span data-ttu-id="e44ed-402">[Criar um locatário de B2C](active-directory-b2c-get-started.md)e usar o nome do seu locatário nas solicitações.</span><span class="sxs-lookup"><span data-stu-id="e44ed-402">[Create a B2C tenant](active-directory-b2c-get-started.md), and use the name of your tenant in the requests.</span></span>
2. <span data-ttu-id="e44ed-403">[Criar um aplicativo](active-directory-b2c-app-registration.md) para obter uma ID de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="e44ed-403">[Create an application](active-directory-b2c-app-registration.md) to obtain an application ID.</span></span> <span data-ttu-id="e44ed-404">Inclui um aplicativo Web/uma API Web em seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="e44ed-404">Include a web app/web API in your app.</span></span> <span data-ttu-id="e44ed-405">Opcionalmente, criar um segredo do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="e44ed-405">Optionally, create an application secret.</span></span>
3. <span data-ttu-id="e44ed-406">[Criar suas regras](active-directory-b2c-reference-policies.md) para obter os nomes de política.</span><span class="sxs-lookup"><span data-stu-id="e44ed-406">[Create your policies](active-directory-b2c-reference-policies.md) to obtain your policy names.</span></span>

