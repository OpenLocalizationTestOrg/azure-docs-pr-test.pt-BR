---
title: aaaPartitioning e escalonamento horizontal no banco de dados do Azure Cosmos | Microsoft Docs
description: "Saiba mais sobre como particionamento funciona no banco de dados do Azure Cosmos, como particionamento tooconfigure e chaves de partição e como toopick Olá direito chave da partição para seu aplicativo."
services: cosmos-db
author: arramac
manager: jhubbard
editor: monicar
documentationcenter: 
ms.assetid: cac9a8cd-b5a3-4827-8505-d40bb61b2416
ms.service: cosmos-db
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/10/2017
ms.author: arramac
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: 87d56db8c4ccc6b94b1650baff0fcfb3db6d1777
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="how-toopartition-and-scale-in-azure-cosmos-db"></a><span data-ttu-id="07ce0-103">Como toopartition e escala no banco de dados do Azure Cosmos</span><span class="sxs-lookup"><span data-stu-id="07ce0-103">How toopartition and scale in Azure Cosmos DB</span></span>

<span data-ttu-id="07ce0-104">[Banco de dados do Microsoft Azure Cosmos](https://azure.microsoft.com/services/cosmos-db/) é toohelp de serviço criado um banco de dados distribuído, vários modelos global você alcançar desempenho rápido e previsível e escalabilidade perfeitamente junto com seu aplicativo à medida que cresce.</span><span class="sxs-lookup"><span data-stu-id="07ce0-104">[Microsoft Azure Cosmos DB](https://azure.microsoft.com/services/cosmos-db/) is a global distributed, multi-model database service designed toohelp you achieve fast, predictable performance and scale seamlessly along with your application as it grows.</span></span> <span data-ttu-id="07ce0-105">Este artigo fornece uma visão geral de como o particionamento funciona para todos os dados de saudação modelos no banco de dados do Azure Cosmos e descreve como você pode configurar escala do banco de dados do Azure Cosmos contêineres tooeffectively seus aplicativos.</span><span class="sxs-lookup"><span data-stu-id="07ce0-105">This article provides an overview of how partitioning works for all hello data models in Azure Cosmos DB, and describes how you can configure Azure Cosmos DB containers tooeffectively scale your applications.</span></span>

<span data-ttu-id="07ce0-106">O particionamento e as chaves de partição também são abordados neste vídeo do Azure Friday com Scott Hanselman e o gerente de engenharia principal do BD Cosmos do Azure, Shireesh Thota.</span><span class="sxs-lookup"><span data-stu-id="07ce0-106">Partitioning and partition keys are also covered in this Azure Friday video with Scott Hanselman and Azure Cosmos DB Principal Engineering Manager, Shireesh Thota.</span></span>

> [!VIDEO https://channel9.msdn.com/Shows/Azure-Friday/Azure-DocumentDB-Elastic-Scale-Partitioning/player]
> 

## <a name="partitioning-in-azure-cosmos-db"></a><span data-ttu-id="07ce0-107">Particionamento no BD Cosmos do Azure</span><span class="sxs-lookup"><span data-stu-id="07ce0-107">Partitioning in Azure Cosmos DB</span></span>
<span data-ttu-id="07ce0-108">No BD Cosmos do Azure, você pode armazenar e consultar dados sem esquema com tempos de resposta da ordem de milissegundos em qualquer escala.</span><span class="sxs-lookup"><span data-stu-id="07ce0-108">In Azure Cosmos DB, you can store and query schema-less data with order-of-millisecond response times at any scale.</span></span> <span data-ttu-id="07ce0-109">O BD Cosmos fornece contêineres para o armazenamento de dados chamados **coleções (para documentos), gráficos ou tabelas**.</span><span class="sxs-lookup"><span data-stu-id="07ce0-109">Cosmos DB provides containers for storing data called **collections (for document), graphs, or tables**.</span></span> <span data-ttu-id="07ce0-110">Contêineres são recursos lógicos e podem abranger um ou mais servidores ou partições físicas.</span><span class="sxs-lookup"><span data-stu-id="07ce0-110">Containers are logical resources and can span one or more physical partitions or servers.</span></span> <span data-ttu-id="07ce0-111">número de saudação de partições é determinado pelo banco de dados do Cosmos com base no tamanho do armazenamento hello e taxa de transferência fornecida do contêiner Olá Olá.</span><span class="sxs-lookup"><span data-stu-id="07ce0-111">hello number of partitions is determined by Cosmos DB based on hello storage size and hello provisioned throughput of hello container.</span></span> <span data-ttu-id="07ce0-112">Cada partição no DB Cosmos tem uma quantidade fixa de armazenamento com suporte de SSD associado a ela e é replicada para alta disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="07ce0-112">Every partition in Cosmos DB has a fixed amount of SSD-backed storage associated with it, and is replicated for high availability.</span></span> <span data-ttu-id="07ce0-113">Gerenciamento de partição é totalmente gerenciado pelo banco de dados do Azure Cosmos, e você não tem código complexo toowrite ou gerenciar as partições.</span><span class="sxs-lookup"><span data-stu-id="07ce0-113">Partition management is fully managed by Azure Cosmos DB, and you do not have toowrite complex code or manage your partitions.</span></span> <span data-ttu-id="07ce0-114">Os contêineres do BD Cosmos são ilimitados em termos de armazenamento e taxa de transferência.</span><span class="sxs-lookup"><span data-stu-id="07ce0-114">Cosmos DB containers are unlimited in terms of storage and throughput.</span></span> 

![horizontal](./media/introduction/azure-cosmos-db-partitioning.png) 

<span data-ttu-id="07ce0-116">O particionamento é um aplicativo tooyour transparente.</span><span class="sxs-lookup"><span data-stu-id="07ce0-116">Partitioning is transparent tooyour application.</span></span> <span data-ttu-id="07ce0-117">Dá suporte a cosmos DB rápidas leituras e gravações, consultas, lógica transacional, níveis de consistência e controle de acesso refinado por meio do recurso de contêiner único tooa métodos/APIs.</span><span class="sxs-lookup"><span data-stu-id="07ce0-117">Cosmos DB supports fast reads and writes, queries, transactional logic, consistency levels, and fine-grained access control via methods/APIs tooa single container resource.</span></span> <span data-ttu-id="07ce0-118">identificadores de serviço Olá roteamento partição correta de toohello de solicitações de consulta e a distribuição de dados entre partições.</span><span class="sxs-lookup"><span data-stu-id="07ce0-118">hello service handles distributing data across partitions and routing query requests toohello right partition.</span></span> 

<span data-ttu-id="07ce0-119">Como o particionamento funciona?</span><span class="sxs-lookup"><span data-stu-id="07ce0-119">How does partitioning work?</span></span> <span data-ttu-id="07ce0-120">Cada item deve ter uma chave de partição e uma chave de linha, que o identificam exclusivamente.</span><span class="sxs-lookup"><span data-stu-id="07ce0-120">Each item must have a partition key and a row key, which uniquely identify it.</span></span> <span data-ttu-id="07ce0-121">Sua chave de partição atua como uma partição lógica para seus dados e fornece ao BD Cosmos um limite natural para a distribuição de dados entre partições.</span><span class="sxs-lookup"><span data-stu-id="07ce0-121">Your partition key acts as a logical partition for your data, and provides Cosmos DB with a natural boundary for distributing data across partitions.</span></span> <span data-ttu-id="07ce0-122">De forma resumida, veja como o particionamento funciona no BD Cosmos do Azure:</span><span class="sxs-lookup"><span data-stu-id="07ce0-122">In brief, here is how partitioning works in Azure Cosmos DB:</span></span>

* <span data-ttu-id="07ce0-123">Você pode provisionar um contêiner do BD Cosmos com uma taxa de transferência de `T` solicitações/s</span><span class="sxs-lookup"><span data-stu-id="07ce0-123">You provision a Cosmos DB container with `T` requests/s throughput</span></span>
* <span data-ttu-id="07ce0-124">Em segundo plano hello, partições de provisões Cosmos DB necessário tooserve `T` solicitações/s.</span><span class="sxs-lookup"><span data-stu-id="07ce0-124">Behind hello scenes, Cosmos DB provisions partitions needed tooserve `T` requests/s.</span></span> <span data-ttu-id="07ce0-125">Se `T` for maior do que a taxa de transferência máxima por partição Olá `t`, então Cosmos DB provisiona `N`  =  `T/t` partições</span><span class="sxs-lookup"><span data-stu-id="07ce0-125">If `T` is higher than hello maximum throughput per partition `t`, then Cosmos DB provisions `N` = `T/t` partitions</span></span>
* <span data-ttu-id="07ce0-126">Cosmos DB aloca espaço Olá da chave de partição hashes chave uniformemente em Olá `N` partições.</span><span class="sxs-lookup"><span data-stu-id="07ce0-126">Cosmos DB allocates hello key space of partition key hashes evenly across hello `N` partitions.</span></span> <span data-ttu-id="07ce0-127">Sendo assim, cada partição (partição física) hospeda 1-N valores de chave de partição (partições lógicas)</span><span class="sxs-lookup"><span data-stu-id="07ce0-127">So, each partition (physical partition) hosts 1-N partition key values (logical partitions)</span></span>
* <span data-ttu-id="07ce0-128">Quando uma partição física `p` atingir seu limite de armazenamento, banco de dados do Cosmos perfeitamente divide `p` em duas novas partições `p1` e `p2` e distribui valores correspondentes tooroughly metade Olá chaves tooeach de saudação partições.</span><span class="sxs-lookup"><span data-stu-id="07ce0-128">When a physical partition `p` reaches its storage limit, Cosmos DB seamlessly splits `p` into two new partitions `p1` and `p2` and distributes values corresponding tooroughly half hello keys tooeach of hello partitions.</span></span> <span data-ttu-id="07ce0-129">Essa operação de divisão é aplicativo tooyour invisível.</span><span class="sxs-lookup"><span data-stu-id="07ce0-129">This split operation is invisible tooyour application.</span></span>
* <span data-ttu-id="07ce0-130">Da mesma forma, quando você provisionar taxa de transferência maior `t*N` taxa de transferência, Cosmos DB divide uma ou mais das sua partições toosupport Olá maior taxa de transferência</span><span class="sxs-lookup"><span data-stu-id="07ce0-130">Similarly, when you provision throughput higher than `t*N` throughput, Cosmos DB splits one or more of your partitions toosupport hello higher throughput</span></span>

<span data-ttu-id="07ce0-131">semântica de saudação para chaves de partição é semântica de saudação toomatch ligeiramente diferentes de cada API, conforme mostrado no Olá a tabela a seguir:</span><span class="sxs-lookup"><span data-stu-id="07ce0-131">hello semantics for partition keys are slightly different toomatch hello semantics of each API, as shown in hello following table:</span></span>

| <span data-ttu-id="07ce0-132">API</span><span class="sxs-lookup"><span data-stu-id="07ce0-132">API</span></span> | <span data-ttu-id="07ce0-133">Chave de partição</span><span class="sxs-lookup"><span data-stu-id="07ce0-133">Partition Key</span></span> | <span data-ttu-id="07ce0-134">Chave de linha</span><span class="sxs-lookup"><span data-stu-id="07ce0-134">Row Key</span></span> |
| --- | --- | --- |
| <span data-ttu-id="07ce0-135">DocumentDB</span><span class="sxs-lookup"><span data-stu-id="07ce0-135">DocumentDB</span></span> | <span data-ttu-id="07ce0-136">caminho da chave de partição personalizada</span><span class="sxs-lookup"><span data-stu-id="07ce0-136">custom partition key path</span></span> | <span data-ttu-id="07ce0-137">`id` fixo</span><span class="sxs-lookup"><span data-stu-id="07ce0-137">fixed `id`</span></span> | 
| <span data-ttu-id="07ce0-138">MongoDB</span><span class="sxs-lookup"><span data-stu-id="07ce0-138">MongoDB</span></span> | <span data-ttu-id="07ce0-139">chave de fragmentação personalizada</span><span class="sxs-lookup"><span data-stu-id="07ce0-139">custom shard key</span></span>  | <span data-ttu-id="07ce0-140">`_id` fixo</span><span class="sxs-lookup"><span data-stu-id="07ce0-140">fixed `_id`</span></span> | 
| <span data-ttu-id="07ce0-141">Gráfico</span><span class="sxs-lookup"><span data-stu-id="07ce0-141">Graph</span></span> | <span data-ttu-id="07ce0-142">propriedade da chave de partição personalizada</span><span class="sxs-lookup"><span data-stu-id="07ce0-142">custom partition key property</span></span> | <span data-ttu-id="07ce0-143">`id` fixo</span><span class="sxs-lookup"><span data-stu-id="07ce0-143">fixed `id`</span></span> | 
| <span data-ttu-id="07ce0-144">Tabela</span><span class="sxs-lookup"><span data-stu-id="07ce0-144">Table</span></span> | <span data-ttu-id="07ce0-145">`PartitionKey` fixo</span><span class="sxs-lookup"><span data-stu-id="07ce0-145">fixed `PartitionKey`</span></span> | <span data-ttu-id="07ce0-146">`RowKey` fixo</span><span class="sxs-lookup"><span data-stu-id="07ce0-146">fixed `RowKey`</span></span> | 

<span data-ttu-id="07ce0-147">O BD Cosmos usa o particionamento baseado em hash.</span><span class="sxs-lookup"><span data-stu-id="07ce0-147">Cosmos DB uses hash-based partitioning.</span></span> <span data-ttu-id="07ce0-148">Quando você escreve um item, Cosmos DB hashes valor de chave de partição hello e use Olá hash resultado toodetermine qual partição toostore Olá item.</span><span class="sxs-lookup"><span data-stu-id="07ce0-148">When you write an item, Cosmos DB hashes hello partition key value and use hello hashed result toodetermine which partition toostore hello item in.</span></span> <span data-ttu-id="07ce0-149">Repositórios cosmos DB Olá todos os itens com a mesma chave de partição no hello mesma partição física.</span><span class="sxs-lookup"><span data-stu-id="07ce0-149">Cosmos DB stores all items with hello same partition key in hello same physical partition.</span></span> <span data-ttu-id="07ce0-150">opção de Olá Olá chave de partição é uma decisão importante que você tenha toomake em tempo de design.</span><span class="sxs-lookup"><span data-stu-id="07ce0-150">hello choice of hello partition key is an important decision that you have toomake at design time.</span></span> <span data-ttu-id="07ce0-151">Você deve escolher um nome de propriedade que tenha uma ampla gama de valores e tenha padrões de acesso uniformes.</span><span class="sxs-lookup"><span data-stu-id="07ce0-151">You must pick a property name that has a wide range of values and has even access patterns.</span></span>

> [!NOTE]
> <span data-ttu-id="07ce0-152">É um toohave de prática recomendada uma chave de partição com muitos valores distintos (100s 1000 no mínimo).</span><span class="sxs-lookup"><span data-stu-id="07ce0-152">It is a best practice toohave a partition key with many distinct values (100s-1000s at a minimum).</span></span>
>

<span data-ttu-id="07ce0-153">Os contêineres do BD Cosmos do Azure podem ser criados como "fixos" ou "ilimitados".</span><span class="sxs-lookup"><span data-stu-id="07ce0-153">Azure Cosmos DB containers can be created as "fixed" or "unlimited."</span></span> <span data-ttu-id="07ce0-154">Contêineres de tamanho fixo têm um limite máximo de 10 GB e taxa de transferência de 10.000 RU/s.</span><span class="sxs-lookup"><span data-stu-id="07ce0-154">Fixed-size containers have a maximum limit of 10 GB and 10,000 RU/s throughput.</span></span> <span data-ttu-id="07ce0-155">Algumas APIs permitem toobe de chave de partição Olá omitido para contêineres de tamanho fixo.</span><span class="sxs-lookup"><span data-stu-id="07ce0-155">Some APIs allow hello partition key toobe omitted for fixed-size containers.</span></span> <span data-ttu-id="07ce0-156">toocreate um contêiner como ilimitado, você deve especificar uma taxa de transferência mínima de 2500 RU/s.</span><span class="sxs-lookup"><span data-stu-id="07ce0-156">toocreate a container as unlimited, you must specify a minimum throughput of 2500 RU/s.</span></span>

## <a name="partitioning-and-provisioned-throughput"></a><span data-ttu-id="07ce0-157">Particionamento e produtividade provisionada</span><span class="sxs-lookup"><span data-stu-id="07ce0-157">Partitioning and provisioned throughput</span></span>
<span data-ttu-id="07ce0-158">O BD Cosmos foi projetado para ter um desempenho previsível.</span><span class="sxs-lookup"><span data-stu-id="07ce0-158">Cosmos DB is designed for predictable performance.</span></span> <span data-ttu-id="07ce0-159">Quando cria um contêiner, você reserva a taxa de transferência em termos de **[RUs](request-units.md) (unidades de solicitação) por segundo, com um complemento potencial de RUs por minuto**.</span><span class="sxs-lookup"><span data-stu-id="07ce0-159">When you create a container, you reserve throughput in terms of **[request units](request-units.md) (RU) per second with a potential add-on for RU per minute**.</span></span> <span data-ttu-id="07ce0-160">Cada solicitação é atribuída um encargo de unidade de solicitação que é proporcional toohello quantidade de recursos do sistema como CPU, memória e e/s consumida pela operação de saudação.</span><span class="sxs-lookup"><span data-stu-id="07ce0-160">Each request is assigned a request unit charge that is proportionate toohello amount of system resources like CPU, Memory, and IO consumed by hello operation.</span></span> <span data-ttu-id="07ce0-161">Uma leitura de um documento de 1 KB com consistência de sessão consome uma unidade de solicitação.</span><span class="sxs-lookup"><span data-stu-id="07ce0-161">A read of a 1-KB document with Session consistency consumes one request unit.</span></span> <span data-ttu-id="07ce0-162">Uma leitura é 1 RU, independentemente do número de saudação de itens armazenados ou Olá o número de solicitações simultâneas em execução no hello simultaneamente.</span><span class="sxs-lookup"><span data-stu-id="07ce0-162">A read is 1 RU regardless of hello number of items stored or hello number of concurrent requests running at hello same time.</span></span> <span data-ttu-id="07ce0-163">Itens maiores exigem mais unidades de solicitação, dependendo do tamanho de saudação.</span><span class="sxs-lookup"><span data-stu-id="07ce0-163">Larger items require higher request units depending on hello size.</span></span> <span data-ttu-id="07ce0-164">Se você souber o tamanho de saudação de suas entidades e Olá número de leituras necessárias toosupport para seu aplicativo, você pode provisionar quantidade exata de saudação de taxa de transferência necessária para seu aplicativo do Leia precisa.</span><span class="sxs-lookup"><span data-stu-id="07ce0-164">If you know hello size of your entities and hello number of reads you need toosupport for your application, you can provision hello exact amount of throughput required for your application's read needs.</span></span> 

> [!NOTE]
> <span data-ttu-id="07ce0-165">tooachieve Olá taxa de transferência total do contêiner hello, você deve escolher uma chave de partição que permite que você tooevenly distribui solicitações entre alguns valores de chave de partição distintos.</span><span class="sxs-lookup"><span data-stu-id="07ce0-165">tooachieve hello full throughput of hello container, you must choose a partition key that allows you tooevenly distribute requests among some distinct partition key values.</span></span>
> 
> 

<a name="designing-for-partitioning"></a>
## <a name="working-with-hello-azure-cosmos-db-apis"></a><span data-ttu-id="07ce0-166">Trabalhando com hello APIs de banco de dados do Azure Cosmos</span><span class="sxs-lookup"><span data-stu-id="07ce0-166">Working with hello Azure Cosmos DB APIs</span></span>
<span data-ttu-id="07ce0-167">Você pode usar o hello portal do Azure ou contêineres de toocreate CLI do Azure e dimensione-los a qualquer momento.</span><span class="sxs-lookup"><span data-stu-id="07ce0-167">You can use hello Azure portal or Azure CLI toocreate containers and scale them at any time.</span></span> <span data-ttu-id="07ce0-168">Esta seção mostra como contêineres toocreate e especifique a saudação taxa de transferência e a partição de definição de chave em cada Olá suporte para APIs.</span><span class="sxs-lookup"><span data-stu-id="07ce0-168">This section shows how toocreate containers and specify hello throughput and partition key definition in each of hello supported APIs.</span></span>

### <a name="documentdb-api"></a><span data-ttu-id="07ce0-169">API do DocumentDB</span><span class="sxs-lookup"><span data-stu-id="07ce0-169">DocumentDB API</span></span>
<span data-ttu-id="07ce0-170">saudação de exemplo a seguir mostra como toocreate um contêiner (coleção) usando Olá API DocumentDB.</span><span class="sxs-lookup"><span data-stu-id="07ce0-170">hello following sample shows how toocreate a container (collection) using hello DocumentDB API.</span></span> <span data-ttu-id="07ce0-171">Você pode encontrar mais detalhes em [Particionamento com a API do DocumentDB](partition-data.md).</span><span class="sxs-lookup"><span data-stu-id="07ce0-171">You can find more details in [Partitioning with DocumentDB API](partition-data.md).</span></span>

```csharp
DocumentClient client = new DocumentClient(new Uri(endpoint), authKey);
await client.CreateDatabaseAsync(new Database { Id = "db" });

DocumentCollection myCollection = new DocumentCollection();
myCollection.Id = "coll";
myCollection.PartitionKey.Paths.Add("/deviceId");

await client.CreateDocumentCollectionAsync(
    UriFactory.CreateDatabaseUri("db"),
    myCollection,
    new RequestOptions { OfferThroughput = 20000 });
```

<span data-ttu-id="07ce0-172">Você pode ler um item (documento) usando Olá `GET` Olá API REST ou usando o método `ReadDocumentAsync` em uma saudação SDKs.</span><span class="sxs-lookup"><span data-stu-id="07ce0-172">You can read an item (document) using hello `GET` method in hello REST API or using `ReadDocumentAsync` in one of hello SDKs.</span></span>

```csharp
// Read document. Needs hello partition key and hello ID toobe specified
DeviceReading document = await client.ReadDocumentAsync<DeviceReading>(
  UriFactory.CreateDocumentUri("db", "coll", "XMS-001-FE24C"), 
  new RequestOptions { PartitionKey = new PartitionKey("XMS-0001") });
```

### <a name="mongodb-api"></a><span data-ttu-id="07ce0-173">API do MongoDB</span><span class="sxs-lookup"><span data-stu-id="07ce0-173">MongoDB API</span></span>
<span data-ttu-id="07ce0-174">Com hello MongoDB API, você pode criar uma coleção fragmentada por meio de sua ferramenta favorita, o driver ou o SDK.</span><span class="sxs-lookup"><span data-stu-id="07ce0-174">With hello MongoDB API, you can create a sharded collection through your favorite tool, driver, or SDK.</span></span> <span data-ttu-id="07ce0-175">Neste exemplo, usamos Olá Shell Mongo para a criação de coleção de saudação.</span><span class="sxs-lookup"><span data-stu-id="07ce0-175">In this example, we use hello Mongo Shell for hello collection creation.</span></span>

<span data-ttu-id="07ce0-176">Em Olá Shell Mongo:</span><span class="sxs-lookup"><span data-stu-id="07ce0-176">In hello Mongo Shell:</span></span>

```
db.runCommand( { shardCollection: "admin.people", key: { region: "hashed" } } )
```
    
<span data-ttu-id="07ce0-177">Resultados:</span><span class="sxs-lookup"><span data-stu-id="07ce0-177">Results:</span></span>

```JSON
{
    "_t" : "ShardCollectionResponse",
    "ok" : 1,
    "collectionsharded" : "admin.people"
}
```

### <a name="table-api"></a><span data-ttu-id="07ce0-178">API de Tabela</span><span class="sxs-lookup"><span data-stu-id="07ce0-178">Table API</span></span>

<span data-ttu-id="07ce0-179">Com hello API de tabela, você especificar taxa de transferência Olá para tabelas na configuração de appSettings Olá para seu aplicativo:</span><span class="sxs-lookup"><span data-stu-id="07ce0-179">With hello Table API, you specify hello throughput for tables in hello appSettings configuration for your application:</span></span>

```xml
<configuration>
    <appSettings>
      <!--Table creation options -->
      <add key="TableThroughput" value="700"/>
    </appSettings>
</configuration>
```

<span data-ttu-id="07ce0-180">Em seguida, você criar uma tabela usando o SDK de armazenamento de tabela do Azure hello.</span><span class="sxs-lookup"><span data-stu-id="07ce0-180">Then you create a table using hello Azure Table storage SDK.</span></span> <span data-ttu-id="07ce0-181">chave de partição Olá é implicitamente criado como Olá `PartitionKey` valor.</span><span class="sxs-lookup"><span data-stu-id="07ce0-181">hello partition key is implicitly created as hello `PartitionKey` value.</span></span> 

```csharp
CloudTableClient tableClient = storageAccount.CreateCloudTableClient();

CloudTable table = tableClient.GetTableReference("people");
table.CreateIfNotExists();
```

<span data-ttu-id="07ce0-182">Você pode recuperar uma única entidade utilizando Olá trecho de código a seguir:</span><span class="sxs-lookup"><span data-stu-id="07ce0-182">You can retrieve a single entity using hello following snippet:</span></span>

```csharp
// Create a retrieve operation that takes a customer entity.
TableOperation retrieveOperation = TableOperation.Retrieve<CustomerEntity>("Smith", "Ben");

// Execute hello retrieve operation.
TableResult retrievedResult = table.Execute(retrieveOperation);
```
<span data-ttu-id="07ce0-183">Consulte [desenvolvendo com hello API tabela](tutorial-develop-table-dotnet.md) para obter mais detalhes.</span><span class="sxs-lookup"><span data-stu-id="07ce0-183">See [Developing with hello Table API](tutorial-develop-table-dotnet.md) for more details.</span></span>

### <a name="graph-api"></a><span data-ttu-id="07ce0-184">Graph API</span><span class="sxs-lookup"><span data-stu-id="07ce0-184">Graph API</span></span>

<span data-ttu-id="07ce0-185">Com hello API do Graph, você deve usar o hello portal do Azure ou contêineres de toocreate CLI.</span><span class="sxs-lookup"><span data-stu-id="07ce0-185">With hello Graph API, you must use hello Azure portal or CLI toocreate containers.</span></span> <span data-ttu-id="07ce0-186">Como alternativa, como o banco de dados do Azure Cosmos vários modelo, você pode usar a uma saudação toocreate outros modelos e dimensionar seu contêiner de gráfico.</span><span class="sxs-lookup"><span data-stu-id="07ce0-186">Alternatively, since Azure Cosmos DB is multi-model, you can use one of hello other models toocreate and scale your graph container.</span></span>

<span data-ttu-id="07ce0-187">Você pode ler qualquer vértice ou usando a chave de partição hello e id no Gremlin de borda.</span><span class="sxs-lookup"><span data-stu-id="07ce0-187">You can read any vertex or edge using hello partition key and id in Gremlin.</span></span> <span data-ttu-id="07ce0-188">Por exemplo, para um gráfico com a região ("EUA") como chave de partição hello e "Seattle" como chave de linha de saudação, você pode encontrar um vértice usando Olá sintaxe a seguir:</span><span class="sxs-lookup"><span data-stu-id="07ce0-188">For example, for a graph with region ("USA") as hello partition key, and "Seattle" as hello row key, you can find a vertex using hello following syntax:</span></span>

```
g.V(['USA', 'Seattle'])
```

<span data-ttu-id="07ce0-189">Mesmo com as margens, você pode referenciar uma borda usando a chave de partição hello e chave de linha.</span><span class="sxs-lookup"><span data-stu-id="07ce0-189">Same with edges, you can reference an edge using hello partition key and row key.</span></span>

```
g.E(['USA', 'I5'])
```

<span data-ttu-id="07ce0-190">Consulte [Suporte do Gremlin para o BD Cosmos](gremlin-support.md) para obter mais detalhes.</span><span class="sxs-lookup"><span data-stu-id="07ce0-190">See [Gremlin support for Cosmos DB](gremlin-support.md) for more details.</span></span>


<a name="designing-for-partitioning"></a>
## <a name="designing-for-partitioning"></a><span data-ttu-id="07ce0-191">Design de particionamento</span><span class="sxs-lookup"><span data-stu-id="07ce0-191">Designing for partitioning</span></span>
<span data-ttu-id="07ce0-192">tooscale efetivamente com o banco de dados do Azure Cosmos, você precisa toopick uma chave de partição boa quando você criar o contêiner.</span><span class="sxs-lookup"><span data-stu-id="07ce0-192">tooscale effectively with Azure Cosmos DB, you need toopick a good partition key when you create your container.</span></span> <span data-ttu-id="07ce0-193">Há dois aspectos principais a considerar ao escolher uma chave de partição:</span><span class="sxs-lookup"><span data-stu-id="07ce0-193">There are two key considerations for choosing a partition key:</span></span>

* <span data-ttu-id="07ce0-194">**Limite de consulta e transações**: sua opção de chave de partição deve equilibrar suas entidades de uso de saudação do hello necessidade tooenable de transações em Olá requisito toodistribute em vários tooensure de chaves de partição uma solução escalonável.</span><span class="sxs-lookup"><span data-stu-id="07ce0-194">**Boundary for query and transactions**: Your choice of partition key should balance hello need tooenable hello use of transactions against hello requirement toodistribute your entities across multiple partition keys tooensure a scalable solution.</span></span> <span data-ttu-id="07ce0-195">De um lado, você pode definir Olá mesma chave de partição para todos os itens, mas isso pode limitar a escalabilidade de saudação de sua solução.</span><span class="sxs-lookup"><span data-stu-id="07ce0-195">At one extreme, you could set hello same partition key for all your items, but this may limit hello scalability of your solution.</span></span> <span data-ttu-id="07ce0-196">Em Olá outro lado, você pode atribuir uma chave de partição exclusivo para cada item, o que seria altamente escalonável, mas poderia impedir o uso de transações entre documentos por meio de procedimentos armazenados e gatilhos.</span><span class="sxs-lookup"><span data-stu-id="07ce0-196">At hello other extreme, you could assign a unique partition key for each item, which would be highly scalable but would prevent you from using cross document transactions via stored procedures and triggers.</span></span> <span data-ttu-id="07ce0-197">Uma chave de partição ideal é um que permite consultas eficientes toouse e que tem cardinalidade suficiente tooensure sua solução é escalável.</span><span class="sxs-lookup"><span data-stu-id="07ce0-197">An ideal partition key is one that enables you toouse efficient queries and that has sufficient cardinality tooensure your solution is scalable.</span></span> 
* <span data-ttu-id="07ce0-198">**Afunilamentos de desempenho e armazenamento**: é importante toopick uma propriedade que permite grava toobe distribuído entre vários valores distintos.</span><span class="sxs-lookup"><span data-stu-id="07ce0-198">**No storage and performance bottlenecks**: It is important toopick a property that allows writes toobe distributed across various distinct values.</span></span> <span data-ttu-id="07ce0-199">Solicitações toohello a mesma chave de partição não pode exceder a taxa de transferência de saudação de uma única partição e são limitados.</span><span class="sxs-lookup"><span data-stu-id="07ce0-199">Requests toohello same partition key cannot exceed hello throughput of a single partition, and are throttled.</span></span> <span data-ttu-id="07ce0-200">Portanto, é importante toopick uma chave de partição não resulta em "pontos de acesso" dentro de seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="07ce0-200">So it is important toopick a partition key that does not result in "hot spots" within your application.</span></span> <span data-ttu-id="07ce0-201">Desde que todos os dados de saudação para uma chave de partição única deve ser armazenada em uma partição, também é recomendável tooavoid chaves de partição com grandes volumes de dados para Olá mesmo valor.</span><span class="sxs-lookup"><span data-stu-id="07ce0-201">Since all hello data for a single partition key must be stored within a partition, it is also recommended tooavoid partition keys that have high volumes of data for hello same value.</span></span> 

<span data-ttu-id="07ce0-202">Vejamos alguns cenários do mundo real e boas chaves de partição para cada um deles:</span><span class="sxs-lookup"><span data-stu-id="07ce0-202">Let's look at a few real-world scenarios, and good partition keys for each:</span></span>
* <span data-ttu-id="07ce0-203">Se você estiver implementando um perfil de usuário back-end, ID de usuário de saudação é uma boa escolha para chave de partição.</span><span class="sxs-lookup"><span data-stu-id="07ce0-203">If you’re implementing a user profile backend, then hello user ID is a good choice for partition key.</span></span>
* <span data-ttu-id="07ce0-204">Se você estiver armazenando dados de IoT, por exemplo, o estado do dispositivo, uma ID do dispositivo será uma boa opção para a chave de partição.</span><span class="sxs-lookup"><span data-stu-id="07ce0-204">If you’re storing IoT data for example, device state, a device ID is a good choice for partition key.</span></span>
* <span data-ttu-id="07ce0-205">Se você estiver usando o banco de dados do Azure Cosmos para registrar em log dados de série temporal, Olá, em seguida, o nome do host ou o ID do processo é uma boa escolha para chave de partição.</span><span class="sxs-lookup"><span data-stu-id="07ce0-205">If you’re using Azure Cosmos DB for logging time-series data, then hello hostname or process ID is a good choice for partition key.</span></span>
* <span data-ttu-id="07ce0-206">Se você tiver uma arquitetura de multilocatária, ID de locatário Olá é uma boa escolha para chave de partição.</span><span class="sxs-lookup"><span data-stu-id="07ce0-206">If you have a multi-tenant architecture, hello tenant ID is a good choice for partition key.</span></span>

<span data-ttu-id="07ce0-207">Em alguns casos como IoT de uso e perfis de usuário, chave de partição Olá pode ser Olá mesmo como o id (chave de documento).</span><span class="sxs-lookup"><span data-stu-id="07ce0-207">In some use cases like IoT and user profiles, hello partition key might be hello same as your id (document key).</span></span> <span data-ttu-id="07ce0-208">Em outros, como dados de série temporal hello, você pode ter uma chave de partição que é diferente da id de saudação.</span><span class="sxs-lookup"><span data-stu-id="07ce0-208">In others like hello time series data, you might have a partition key that’s different than hello id.</span></span>

### <a name="partitioning-and-loggingtime-series-data"></a><span data-ttu-id="07ce0-209">Dados de particionamento e registro em log/da série temporal</span><span class="sxs-lookup"><span data-stu-id="07ce0-209">Partitioning and logging/time-series data</span></span>
<span data-ttu-id="07ce0-210">Um dos casos de uso comuns saudação do banco de dados do Cosmos é para registro em log e telemetria.</span><span class="sxs-lookup"><span data-stu-id="07ce0-210">One of hello common use cases of Cosmos DB is for logging and telemetry.</span></span> <span data-ttu-id="07ce0-211">É importante toopick uma chave de partição boa desde que talvez seja necessário tooread/gravação grandes volumes de dados.</span><span class="sxs-lookup"><span data-stu-id="07ce0-211">It is important toopick a good partition key since you might need tooread/write vast volumes of data.</span></span> <span data-ttu-id="07ce0-212">Escolha de saudação depende de sua leitura e gravação taxas e tipos de consultas que você espera que toorun.</span><span class="sxs-lookup"><span data-stu-id="07ce0-212">hello choice depends on your read and write rates and kinds of queries you expect toorun.</span></span> <span data-ttu-id="07ce0-213">Aqui estão algumas dicas sobre como toochoose uma chave de partição válida.</span><span class="sxs-lookup"><span data-stu-id="07ce0-213">Here are some tips on how toochoose a good partition key.</span></span>

* <span data-ttu-id="07ce0-214">Se o caso de uso envolve uma pequena taxa de gravações acumular por um longo período de tempo e tooquery necessidade por intervalos de carimbos e outros filtros, e em seguida, usando um pacote cumulativo de saudação carimbo de hora, por exemplo, data como uma chave de partição é uma boa abordagem.</span><span class="sxs-lookup"><span data-stu-id="07ce0-214">If your use case involves a small rate of writes accumulating over a long period of time, and need tooquery by ranges of timestamps and other filters, then using a rollup of hello timestamp, for example,  date as a partition key is a good approach.</span></span> <span data-ttu-id="07ce0-215">Isso permite que você tooquery em todos os dados de saudação de uma data de uma única partição.</span><span class="sxs-lookup"><span data-stu-id="07ce0-215">This allows you tooquery over all hello data for a date from a single partition.</span></span> 
* <span data-ttu-id="07ce0-216">Se sua carga de trabalho for intensa em termos de gravação, o que é mais comum, você deverá usar uma chave de partição que não esteja baseada em carimbo de data/hora para que o BD Cosmos possa distribuir as gravações uniformemente entre várias partições.</span><span class="sxs-lookup"><span data-stu-id="07ce0-216">If your workload is written heavy, which is more common, you should use a partition key that’s not based on timestamp so that Cosmos DB can distribute writes evenly across various partitions.</span></span> <span data-ttu-id="07ce0-217">Aqui, um nome do host, ID do processo, ID da atividade ou outra propriedade com alta cardinalidade é uma boa opção.</span><span class="sxs-lookup"><span data-stu-id="07ce0-217">Here a hostname, process ID, activity ID, or another property with high cardinality is a good choice.</span></span> 
* <span data-ttu-id="07ce0-218">Uma terceira abordagem é um híbrido um onde você tem vários contêineres, uma para cada dia/mês e chave de partição Olá é uma propriedade granular como nome do host.</span><span class="sxs-lookup"><span data-stu-id="07ce0-218">A third approach is a hybrid one where you have multiple containers, one for each day/month and hello partition key is a granular property like hostname.</span></span> <span data-ttu-id="07ce0-219">Isso tem o benefício de saudação que você pode definir a taxa de transferência diferente com base na janela de tempo de saudação, por exemplo, recipiente Olá Olá mês atual está provisionado com maior taxa de transferência desde que ele serve leituras e gravações, enquanto os meses anteriores com reduzir a taxa de transferência desde eles servem apenas leituras.</span><span class="sxs-lookup"><span data-stu-id="07ce0-219">This has hello benefit that you can set different throughput based on hello time window, for example, hello container for hello current month is provisioned with higher throughput since it serves reads and writes, whereas previous months with lower throughput since they only serve reads.</span></span>

### <a name="partitioning-and-multi-tenancy"></a><span data-ttu-id="07ce0-220">Particionamento e multilocação</span><span class="sxs-lookup"><span data-stu-id="07ce0-220">Partitioning and multi-tenancy</span></span>
<span data-ttu-id="07ce0-221">Se você estiver implementando um aplicativo multilocatário usando o BD Cosmos, haverá dois padrões populares – uma chave de uma partição por locatário e um contêiner por locatário.</span><span class="sxs-lookup"><span data-stu-id="07ce0-221">If you are implementing a multi-tenant application using Cosmos DB, there are two popular patterns – one partition key per tenant, and one container per tenant.</span></span> <span data-ttu-id="07ce0-222">Aqui estão os profissionais de saudação e desvantagens de cada um:</span><span class="sxs-lookup"><span data-stu-id="07ce0-222">Here are hello pros and cons for each:</span></span>

* <span data-ttu-id="07ce0-223">Uma chave de partição por locatário: nesse modelo, os locatários são colocados em um único contêiner.</span><span class="sxs-lookup"><span data-stu-id="07ce0-223">One Partition Key per tenant: In this model, tenants are collocated within a single container.</span></span> <span data-ttu-id="07ce0-224">No entanto, consultas e inserções de itens em um único locatário podem ser executadas em relação a uma única partição.</span><span class="sxs-lookup"><span data-stu-id="07ce0-224">But queries and inserts for items within a single tenant can be performed against a single partition.</span></span> <span data-ttu-id="07ce0-225">Você também pode implementar a lógica transacional em todos os itens dentro de um locatário.</span><span class="sxs-lookup"><span data-stu-id="07ce0-225">You can also implement transactional logic across all items within a tenant.</span></span> <span data-ttu-id="07ce0-226">Como vários locatários compartilham um contêiner, você pode economizar custos de armazenamento e taxa de transferência realizando o pooling de recursos para locatários em um único contêiner em vez de provisionar capacidade extra para cada locatário.</span><span class="sxs-lookup"><span data-stu-id="07ce0-226">Since multiple tenants share a container, you can save storage and throughput costs by pooling resources for tenants within a single container rather than provisioning extra headroom for each tenant.</span></span> <span data-ttu-id="07ce0-227">desvantagem de saudação é que você não tem o isolamento de desempenho por locatário.</span><span class="sxs-lookup"><span data-stu-id="07ce0-227">hello drawback is that you do not have performance isolation per tenant.</span></span> <span data-ttu-id="07ce0-228">Aumentos de desempenho, throughput aplicam toohello contêiner inteiro vs destinadas aumenta para locatários.</span><span class="sxs-lookup"><span data-stu-id="07ce0-228">Performance/throughput increases apply toohello entire container vs targeted increases for tenants.</span></span>
* <span data-ttu-id="07ce0-229">Um contêiner por locatário: cada locatário tem seu próprio contêiner.</span><span class="sxs-lookup"><span data-stu-id="07ce0-229">One Container per tenant: Each tenant has its own container.</span></span> <span data-ttu-id="07ce0-230">Nesse modelo, você pode reservar o desempenho por locatário.</span><span class="sxs-lookup"><span data-stu-id="07ce0-230">In this model, you can reserve performance per tenant.</span></span> <span data-ttu-id="07ce0-231">Com o novo modelo de preços de provisionamento do BD Cosmos, esse modelo é mais econômico para aplicativos multilocatário com um número pequeno de locatários.</span><span class="sxs-lookup"><span data-stu-id="07ce0-231">With Cosmos DB's new provisioning pricing model, this model is more cost-effective for multi-tenant applications with a few tenants.</span></span>

<span data-ttu-id="07ce0-232">Você também pode usar uma abordagem em camadas combinação/collocates locatários pequenos e migra maior contêiner próprio tootheir de locatários.</span><span class="sxs-lookup"><span data-stu-id="07ce0-232">You can also use a combination/tiered approach that collocates small tenants and migrates larger tenants tootheir own container.</span></span>

## <a name="next-steps"></a><span data-ttu-id="07ce0-233">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="07ce0-233">Next steps</span></span>
<span data-ttu-id="07ce0-234">Neste artigo, fornecemos uma visão geral dos conceitos e práticas recomendadas para o particionamento com qualquer API do BD Cosmos do Azure.</span><span class="sxs-lookup"><span data-stu-id="07ce0-234">In this article, we provided an overview for an overview of concepts and best practices for partitioning with any Azure Cosmos DB API.</span></span> 

* <span data-ttu-id="07ce0-235">Saiba mais sobre a [taxa de transferência provisionada no BD Cosmos do Azure](request-units.md)</span><span class="sxs-lookup"><span data-stu-id="07ce0-235">Learn about [provisioned throughput in Azure Cosmos DB](request-units.md)</span></span>
* <span data-ttu-id="07ce0-236">Saiba mais sobre [distribuição global no BD Cosmos do Azure](distribute-data-globally.md)</span><span class="sxs-lookup"><span data-stu-id="07ce0-236">Learn about [global distribution in Azure Cosmos DB](distribute-data-globally.md)</span></span>



