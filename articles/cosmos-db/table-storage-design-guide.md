---
title: Guia de Design de tabela de armazenamento de aaaAzure | Microsoft Docs
description: "Projete tabelas escalonáveis e de alto desempenho no Armazenamento de Tabelas do Azure"
services: cosmos-db
documentationcenter: na
author: mimig1
manager: tadb
editor: tysonn
ms.assetid: 8e228b0c-2998-4462-8101-9f16517393ca
ms.service: cosmos-db
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: storage
ms.date: 02/28/2017
ms.author: mimig
ms.openlocfilehash: 059f05a1d20e4d9537034b7ca133c5334bbefa04
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="azure-storage-table-design-guide-designing-scalable-and-performant-tables"></a><span data-ttu-id="a3f81-103">Guia de Design de tabela de armazenamento do Azure: projetando tabelas escalonáveis e de alto desempenho</span><span class="sxs-lookup"><span data-stu-id="a3f81-103">Azure Storage Table Design Guide: Designing Scalable and Performant Tables</span></span>
[!INCLUDE [storage-table-cosmos-db-tip-include](../../includes/storage-table-cosmos-db-tip-include.md)]

<span data-ttu-id="a3f81-104">toodesign escalonável e tabelas de alto desempenho, você deve considerar vários fatores como custo, escalabilidade e desempenho.</span><span class="sxs-lookup"><span data-stu-id="a3f81-104">toodesign scalable and performant tables you must consider a number of factors such as performance, scalability, and cost.</span></span> <span data-ttu-id="a3f81-105">Se você criou anteriormente esquemas de bancos de dados relacionais, essas considerações será tooyou familiar, mas existem algumas semelhanças entre o modelo de armazenamento de serviço de tabela do Azure hello e modelos relacionais, também há muitas importantes diferenças.</span><span class="sxs-lookup"><span data-stu-id="a3f81-105">If you have previously designed schemas for relational databases, these considerations will be familiar tooyou, but while there are some similarities between hello Azure Table service storage model and relational models, there are also many important differences.</span></span> <span data-ttu-id="a3f81-106">Normalmente, essas diferenças resultam toovery diferentes designs que pode ser contrário à intuição ou errada toosomeone familiarizado com bancos de dados relacionais, mas que fazem sentido bom se você criar um repositório de chave/valor NoSQL como Olá serviço tabela do Azure.</span><span class="sxs-lookup"><span data-stu-id="a3f81-106">These differences typically lead toovery different designs that may look counter-intuitive or wrong toosomeone familiar with relational databases, but which do make good sense if you are designing for a NoSQL key/value store such as hello Azure Table service.</span></span> <span data-ttu-id="a3f81-107">Muitas das diferenças seu design refletirá Olá fato de serviço de tabela Olá projetado toosupport aplicativos de escala de nuvem que podem conter bilhões de entidades (linhas na terminologia de banco de dados relacional) de dados ou para conjuntos de dados devem oferecer suporte a muito alta volumes de transações: portanto, você precisa toothink diferente sobre como armazenar os dados e entender como funciona a saudação serviço tabela.</span><span class="sxs-lookup"><span data-stu-id="a3f81-107">Many of your design differences will reflect hello fact that hello Table service is designed toosupport cloud-scale applications that can contain billions of entities (rows in relational database terminology) of data or for datasets that must support very high transaction volumes: therefore, you need toothink differently about how you store your data and understand how hello Table service works.</span></span> <span data-ttu-id="a3f81-108">Um repositório de dados NoSQL bem projetado pode habilitar a sua solução tooscale muito mais (e um custo menor) que uma solução que usa um banco de dados relacional.</span><span class="sxs-lookup"><span data-stu-id="a3f81-108">A well designed NoSQL data store can enable your solution tooscale much further (and at a lower cost) than a solution that uses a relational database.</span></span> <span data-ttu-id="a3f81-109">Este guia ajuda você com esses tópicos.</span><span class="sxs-lookup"><span data-stu-id="a3f81-109">This guide helps you with these topics.</span></span>  

## <a name="about-hello-azure-table-service"></a><span data-ttu-id="a3f81-110">Sobre Olá serviço tabela do Azure</span><span class="sxs-lookup"><span data-stu-id="a3f81-110">About hello Azure Table service</span></span>
<span data-ttu-id="a3f81-111">Esta seção destaca alguns Olá principais recursos do serviço de tabela de saudação que são especialmente relevante toodesigning para desempenho e escalabilidade.</span><span class="sxs-lookup"><span data-stu-id="a3f81-111">This section highlights some of hello key features of hello Table service that are especially relevant toodesigning for performance and scalability.</span></span> <span data-ttu-id="a3f81-112">Se você estiver tooAzure novo armazenamento e hello serviço tabela, primeiro leia [tooMicrosoft Introdução armazenamento do Azure](../storage/common/storage-introduction.md) e [Introdução ao armazenamento de tabela do Azure usando o .NET](table-storage-how-to-use-dotnet.md) antes de ler o restante da saudação da artigo.</span><span class="sxs-lookup"><span data-stu-id="a3f81-112">If you are new tooAzure Storage and hello Table service, first read [Introduction tooMicrosoft Azure Storage](../storage/common/storage-introduction.md) and [Get started with Azure Table Storage using .NET](table-storage-how-to-use-dotnet.md) before reading hello remainder of this article.</span></span> <span data-ttu-id="a3f81-113">Embora foco deste guia Olá Olá serviço tabela, ele incluirá alguns discussão de saudação fila do Azure e serviços Blob e como você pode usar-os junto com hello serviço de tabela em uma solução.</span><span class="sxs-lookup"><span data-stu-id="a3f81-113">Although hello focus of this guide is on hello Table service, it will include some discussion of hello Azure Queue and Blob services, and how you might use them along with hello Table service in a solution.</span></span>  

<span data-ttu-id="a3f81-114">O que é o serviço de tabela Olá?</span><span class="sxs-lookup"><span data-stu-id="a3f81-114">What is hello Table service?</span></span> <span data-ttu-id="a3f81-115">Como você pode esperar do nome hello, Olá serviço tabela usa dados de toostore um formato tabular.</span><span class="sxs-lookup"><span data-stu-id="a3f81-115">As you might expect from hello name, hello Table service uses a tabular format toostore data.</span></span> <span data-ttu-id="a3f81-116">Na terminologia de saudação padrão, cada linha da tabela Olá representa uma entidade e repositório de colunas Olá Olá várias propriedades de entidade.</span><span class="sxs-lookup"><span data-stu-id="a3f81-116">In hello standard terminology, each row of hello table represents an entity, and hello columns store hello various properties of that entity.</span></span> <span data-ttu-id="a3f81-117">Cada entidade tem um par de chaves toouniquely identificá-lo, e uma coluna de carimbo de hora que Olá serviço tabela usa tootrack entidade Olá foi atualizada pela última vez (Isso ocorre automaticamente e não é possível substituir manualmente Olá timestamp com um valor arbitrário).</span><span class="sxs-lookup"><span data-stu-id="a3f81-117">Every entity has a pair of keys toouniquely identify it, and a timestamp column that hello Table service uses tootrack when hello entity was last updated (this happens automatically and you cannot manually overwrite hello timestamp with an arbitrary value).</span></span> <span data-ttu-id="a3f81-118">Olá serviço tabela usa esta última modificação timestamp (LMT) toomanage a simultaneidade otimista.</span><span class="sxs-lookup"><span data-stu-id="a3f81-118">hello Table service uses this last-modified timestamp (LMT) toomanage optimistic concurrency.</span></span>  

> [!NOTE]
> <span data-ttu-id="a3f81-119">operações de API REST do serviço de tabela Olá também retornam um **ETag** valor deriva de timestamp última modificação da saudação (LMT).</span><span class="sxs-lookup"><span data-stu-id="a3f81-119">hello Table service REST API operations also return an **ETag** value that it derives from hello last-modified timestamp (LMT).</span></span> <span data-ttu-id="a3f81-120">Neste documento, usamos o hello termos ETag e LMT alternadamente porque elas fazem referência toohello mesmo dados subjacentes.</span><span class="sxs-lookup"><span data-stu-id="a3f81-120">In this document we will use hello terms ETag and LMT interchangeably because they refer toohello same underlying data.</span></span>  
> 
> 

<span data-ttu-id="a3f81-121">Olá exemplo a seguir mostra um toostore de design de tabela simples employee e department entidades.</span><span class="sxs-lookup"><span data-stu-id="a3f81-121">hello following example shows a simple table design toostore employee and department entities.</span></span> <span data-ttu-id="a3f81-122">Muitos dos exemplos de saudação mostrados mais adiante neste guia são baseados nesse design simple.</span><span class="sxs-lookup"><span data-stu-id="a3f81-122">Many of hello examples shown later in this guide are based on this simple design.</span></span>  

<table>
<tr>
<th><span data-ttu-id="a3f81-123">PartitionKey</span><span class="sxs-lookup"><span data-stu-id="a3f81-123">PartitionKey</span></span></th>
<th><span data-ttu-id="a3f81-124">RowKey</span><span class="sxs-lookup"><span data-stu-id="a3f81-124">RowKey</span></span></th>
<th><span data-ttu-id="a3f81-125">Timestamp</span><span class="sxs-lookup"><span data-stu-id="a3f81-125">Timestamp</span></span></th>
<th></th>
</tr>
<tr>
<td><span data-ttu-id="a3f81-126">Marketing</span><span class="sxs-lookup"><span data-stu-id="a3f81-126">Marketing</span></span></td>
<td><span data-ttu-id="a3f81-127">00001</span><span class="sxs-lookup"><span data-stu-id="a3f81-127">00001</span></span></td>
<td><span data-ttu-id="a3f81-128">2014-08-22T00:50:32Z</span><span class="sxs-lookup"><span data-stu-id="a3f81-128">2014-08-22T00:50:32Z</span></span></td>
<td>
<table>
<tr>
<th><span data-ttu-id="a3f81-129">Nome</span><span class="sxs-lookup"><span data-stu-id="a3f81-129">FirstName</span></span></th>
<th><span data-ttu-id="a3f81-130">Sobrenome</span><span class="sxs-lookup"><span data-stu-id="a3f81-130">LastName</span></span></th>
<th><span data-ttu-id="a3f81-131">Idade</span><span class="sxs-lookup"><span data-stu-id="a3f81-131">Age</span></span></th>
<th><span data-ttu-id="a3f81-132">Email</span><span class="sxs-lookup"><span data-stu-id="a3f81-132">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="a3f81-133">Don</span><span class="sxs-lookup"><span data-stu-id="a3f81-133">Don</span></span></td>
<td><span data-ttu-id="a3f81-134">Hall</span><span class="sxs-lookup"><span data-stu-id="a3f81-134">Hall</span></span></td>
<td><span data-ttu-id="a3f81-135">34</span><span class="sxs-lookup"><span data-stu-id="a3f81-135">34</span></span></td>
<td>donh@contoso.com</td>
</tr>
</table>
</tr>
<tr>
<td><span data-ttu-id="a3f81-136">Marketing</span><span class="sxs-lookup"><span data-stu-id="a3f81-136">Marketing</span></span></td>
<td><span data-ttu-id="a3f81-137">00002</span><span class="sxs-lookup"><span data-stu-id="a3f81-137">00002</span></span></td>
<td><span data-ttu-id="a3f81-138">2014-08-22T00:50:34Z</span><span class="sxs-lookup"><span data-stu-id="a3f81-138">2014-08-22T00:50:34Z</span></span></td>
<td>
<table>
<tr>
<th><span data-ttu-id="a3f81-139">Nome</span><span class="sxs-lookup"><span data-stu-id="a3f81-139">FirstName</span></span></th>
<th><span data-ttu-id="a3f81-140">Sobrenome</span><span class="sxs-lookup"><span data-stu-id="a3f81-140">LastName</span></span></th>
<th><span data-ttu-id="a3f81-141">Idade</span><span class="sxs-lookup"><span data-stu-id="a3f81-141">Age</span></span></th>
<th><span data-ttu-id="a3f81-142">Email</span><span class="sxs-lookup"><span data-stu-id="a3f81-142">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="a3f81-143">Jun</span><span class="sxs-lookup"><span data-stu-id="a3f81-143">Jun</span></span></td>
<td><span data-ttu-id="a3f81-144">Cao</span><span class="sxs-lookup"><span data-stu-id="a3f81-144">Cao</span></span></td>
<td><span data-ttu-id="a3f81-145">47</span><span class="sxs-lookup"><span data-stu-id="a3f81-145">47</span></span></td>
<td>junc@contoso.com</td>
</tr>
</table>
</tr>
<tr>
<td><span data-ttu-id="a3f81-146">Marketing</span><span class="sxs-lookup"><span data-stu-id="a3f81-146">Marketing</span></span></td>
<td><span data-ttu-id="a3f81-147">Departamento</span><span class="sxs-lookup"><span data-stu-id="a3f81-147">Department</span></span></td>
<td><span data-ttu-id="a3f81-148">2014-08-22T00:50:30Z</span><span class="sxs-lookup"><span data-stu-id="a3f81-148">2014-08-22T00:50:30Z</span></span></td>
<td>
<table>
<tr>
<th><span data-ttu-id="a3f81-149">DepartmentName</span><span class="sxs-lookup"><span data-stu-id="a3f81-149">DepartmentName</span></span></th>
<th><span data-ttu-id="a3f81-150">EmployeeCount</span><span class="sxs-lookup"><span data-stu-id="a3f81-150">EmployeeCount</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="a3f81-151">Marketing</span><span class="sxs-lookup"><span data-stu-id="a3f81-151">Marketing</span></span></td>
<td><span data-ttu-id="a3f81-152">153</span><span class="sxs-lookup"><span data-stu-id="a3f81-152">153</span></span></td>
</tr>
</table>
</td>
</tr>
<tr>
<td><span data-ttu-id="a3f81-153">Vendas</span><span class="sxs-lookup"><span data-stu-id="a3f81-153">Sales</span></span></td>
<td><span data-ttu-id="a3f81-154">00010</span><span class="sxs-lookup"><span data-stu-id="a3f81-154">00010</span></span></td>
<td><span data-ttu-id="a3f81-155">2014-08-22T00:50:44Z</span><span class="sxs-lookup"><span data-stu-id="a3f81-155">2014-08-22T00:50:44Z</span></span></td>
<td>
<table>
<tr>
<th><span data-ttu-id="a3f81-156">Nome</span><span class="sxs-lookup"><span data-stu-id="a3f81-156">FirstName</span></span></th>
<th><span data-ttu-id="a3f81-157">Sobrenome</span><span class="sxs-lookup"><span data-stu-id="a3f81-157">LastName</span></span></th>
<th><span data-ttu-id="a3f81-158">Idade</span><span class="sxs-lookup"><span data-stu-id="a3f81-158">Age</span></span></th>
<th><span data-ttu-id="a3f81-159">Email</span><span class="sxs-lookup"><span data-stu-id="a3f81-159">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="a3f81-160">Ken</span><span class="sxs-lookup"><span data-stu-id="a3f81-160">Ken</span></span></td>
<td><span data-ttu-id="a3f81-161">Kwok</span><span class="sxs-lookup"><span data-stu-id="a3f81-161">Kwok</span></span></td>
<td><span data-ttu-id="a3f81-162">23</span><span class="sxs-lookup"><span data-stu-id="a3f81-162">23</span></span></td>
<td>kenk@contoso.com</td>
</tr>
</table>
</td>
</tr>
</table>


<span data-ttu-id="a3f81-163">Até agora, parece muito semelhante tabela de tooa em um banco de dados relacional com algumas diferenças de saudação sendo Olá colunas obrigatórias e hello capacidade toostore entidade vários tipos no hello mesma tabela.</span><span class="sxs-lookup"><span data-stu-id="a3f81-163">So far, this looks very similar tooa table in a relational database with hello key differences being hello mandatory columns, and hello ability toostore multiple entity types in hello same table.</span></span> <span data-ttu-id="a3f81-164">Além disso, cada um dos Olá propriedades definidas pelo usuário, como **FirstName** ou **idade** tem um tipo de dados, como integer ou string, assim como uma coluna em um banco de dados relacional.</span><span class="sxs-lookup"><span data-stu-id="a3f81-164">In addition, each of hello user-defined properties such as **FirstName** or **Age** has a data type, such as integer or string, just like a column in a relational database.</span></span> <span data-ttu-id="a3f81-165">Embora, ao contrário de um banco de dados relacional, natureza sem esquema Olá Olá significa do serviço de tabela que não precisa ter uma propriedade Olá mesmo tipo de dados em cada entidade.</span><span class="sxs-lookup"><span data-stu-id="a3f81-165">Although unlike in a relational database, hello schema-less nature of hello Table service means that a property need not have hello same data type on each entity.</span></span> <span data-ttu-id="a3f81-166">tipos de dados complexos toostore em uma única propriedade, você deve usar um formato serializado como JSON ou XML.</span><span class="sxs-lookup"><span data-stu-id="a3f81-166">toostore complex data types in a single property, you must use a serialized format such as JSON or XML.</span></span> <span data-ttu-id="a3f81-167">Para obter mais informações sobre tipos de dados de serviço, como suporte de tabela hello, intervalos de datas com suporte, as regras de nomenclatura e restrições de tamanho, consulte [Olá Noções básicas sobre modelo de dados do serviço de tabela](http://msdn.microsoft.com/library/azure/dd179338.aspx).</span><span class="sxs-lookup"><span data-stu-id="a3f81-167">For more information about hello table service such as supported data types, supported date ranges, naming rules, and size constraints, see [Understanding hello Table Service Data Model](http://msdn.microsoft.com/library/azure/dd179338.aspx).</span></span>

<span data-ttu-id="a3f81-168">Como veremos, a escolha do **PartitionKey** e **RowKey** é fundamental toogood design da tabela.</span><span class="sxs-lookup"><span data-stu-id="a3f81-168">As you will see, your choice of **PartitionKey** and **RowKey** is fundamental toogood table design.</span></span> <span data-ttu-id="a3f81-169">Cada entidade armazenada em uma tabela deve ter uma combinação exclusiva de **PartitionKey** e **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="a3f81-169">Every entity stored in a table must have a unique combination of **PartitionKey** and **RowKey**.</span></span> <span data-ttu-id="a3f81-170">Assim como acontece com as chaves em uma tabela de banco de dados relacional, Olá **PartitionKey** e **RowKey** valores são indexada toocreate um índice clusterizado que permite pesquisas rápidas; no entanto, Olá serviço tabela não criar qualquer índices secundários, portanto esses são Olá apenas duas propriedades indexadas (alguns dos padrões Olá descritos posteriormente mostram como você pode contornar essa limitação aparente).</span><span class="sxs-lookup"><span data-stu-id="a3f81-170">As with keys in a relational database table, hello **PartitionKey** and **RowKey** values are indexed toocreate a clustered index that enables fast look-ups; however, hello Table service does not create any secondary indexes so these are hello only two indexed properties (some of hello patterns described later show how you can work around this apparent limitation).</span></span>  

<span data-ttu-id="a3f81-171">Como você verá muitos Olá decisões tomadas vai ser em torno de escolher um adequado de design e uma tabela é composta de uma ou mais partições **PartitionKey** e **RowKey** toooptimize sua solução.</span><span class="sxs-lookup"><span data-stu-id="a3f81-171">A table is made up of one or more partitions, and as you will see, many of hello design decisions you make will be around choosing a suitable **PartitionKey** and **RowKey** toooptimize your solution.</span></span> <span data-ttu-id="a3f81-172">Uma solução poderia consistir em apenas uma única tabela que contém todas as suas entidades organizadas em partições, mas normalmente uma solução terá várias tabelas.</span><span class="sxs-lookup"><span data-stu-id="a3f81-172">A solution could consist of just a single table that contains all your entities organized into partitions, but typically a solution will have multiple tables.</span></span> <span data-ttu-id="a3f81-173">Ajudarão-lo a tabelas toologically organizar suas entidades, ajudam você a gerenciar o acesso toohello dados usando listas de controle de acesso e você pode descartar uma tabela inteira usando uma única operação de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="a3f81-173">Tables help you toologically organize your entities, help you manage access toohello data using access control lists, and you can drop an entire table using a single storage operation.</span></span>  

### <a name="table-partitions"></a><span data-ttu-id="a3f81-174">Partições de tabela</span><span class="sxs-lookup"><span data-stu-id="a3f81-174">Table partitions</span></span>
<span data-ttu-id="a3f81-175">nome da conta Olá, nome da tabela e **PartitionKey** juntos identificar partição Olá no serviço de armazenamento de saudação em que o serviço de tabela Olá armazena entidade hello.</span><span class="sxs-lookup"><span data-stu-id="a3f81-175">hello account name, table name and **PartitionKey** together identify hello partition within hello storage service where hello table service stores hello entity.</span></span> <span data-ttu-id="a3f81-176">Bem como sendo parte do esquema para entidades de endereçamento de hello, as partições definem um escopo de transações (consulte [transações de grupo de entidade](#entity-group-transactions) abaixo) e a base de saudação do formulário de como o serviço de tabela Olá dimensiona.</span><span class="sxs-lookup"><span data-stu-id="a3f81-176">As well as being part of hello addressing scheme for entities, partitions define a scope for transactions (see [Entity Group Transactions](#entity-group-transactions) below), and form hello basis of how hello table service scales.</span></span> <span data-ttu-id="a3f81-177">Para obter mais informações sobre partições, consulte [Metas de desempenho e escalabilidade de armazenamento do Azure](../storage/common/storage-scalability-targets.md).</span><span class="sxs-lookup"><span data-stu-id="a3f81-177">For more information on partitions see [Azure Storage Scalability and Performance Targets](../storage/common/storage-scalability-targets.md).</span></span>  

<span data-ttu-id="a3f81-178">Olá serviço tabela, um nó individual serviços um ou mais concluir partições e Olá escalas de serviço pelo balanceamento de carga dinamicamente partições em nós.</span><span class="sxs-lookup"><span data-stu-id="a3f81-178">In hello Table service, an individual node services one or more complete partitions and hello service scales by dynamically load-balancing partitions across nodes.</span></span> <span data-ttu-id="a3f81-179">Se um nó está sob carga, o serviço de tabela Olá pode *dividir* intervalo saudação de partições atendido pelo nó em nós diferentes; ao diminuir o tráfego, serviço Olá pode *mesclagem* partição Olá varia de nós silenciosos de volta para um único nó.</span><span class="sxs-lookup"><span data-stu-id="a3f81-179">If a node is under load, hello table service can *split* hello range of partitions serviced by that node onto different nodes; when traffic subsides, hello service can *merge* hello partition ranges from quiet nodes back onto a single node.</span></span>  

<span data-ttu-id="a3f81-180">Para obter mais informações sobre Olá detalhes internos de saudação serviço tabela e em particular como o serviço de saudação gerencia partições, consulte papel Olá [armazenamento do Microsoft Azure: um altamente disponível armazenamento de serviço de nuvem com forte consistência](http://blogs.msdn.com/b/windowsazurestorage/archive/2011/11/20/windows-azure-storage-a-highly-available-cloud-storage-service-with-strong-consistency.aspx).</span><span class="sxs-lookup"><span data-stu-id="a3f81-180">For more information about hello internal details of hello Table service, and in particular how hello service manages partitions, see hello paper [Microsoft Azure Storage: A Highly Available Cloud Storage Service with Strong Consistency](http://blogs.msdn.com/b/windowsazurestorage/archive/2011/11/20/windows-azure-storage-a-highly-available-cloud-storage-service-with-strong-consistency.aspx).</span></span>  

### <a name="entity-group-transactions"></a><span data-ttu-id="a3f81-181">Transações de Grupo de Entidades</span><span class="sxs-lookup"><span data-stu-id="a3f81-181">Entity Group Transactions</span></span>
<span data-ttu-id="a3f81-182">Em Olá serviço tabela, transações de grupo de entidade (EGTs) são mecanismo somente interno de saudação para realizar atualizações atômicas entre várias entidades.</span><span class="sxs-lookup"><span data-stu-id="a3f81-182">In hello Table service, Entity Group Transactions (EGTs) are hello only built-in mechanism for performing atomic updates across multiple entities.</span></span> <span data-ttu-id="a3f81-183">EGTs também são chamados de tooas *lote transações* em alguns documentos.</span><span class="sxs-lookup"><span data-stu-id="a3f81-183">EGTs are also referred tooas *batch transactions* in some documentation.</span></span> <span data-ttu-id="a3f81-184">EGTs só pode operar em entidades armazenadas em Olá mesma partição (compartilhamento Olá mesma chave de partição em uma determinada tabela), portanto, sempre que precisar atômico comportamento transacional entre várias entidades, você precisa tooensure essas entidades são em Olá mesma partição.</span><span class="sxs-lookup"><span data-stu-id="a3f81-184">EGTs can only operate on entities stored in hello same partition (share hello same partition key in a given table), so anytime you need atomic transactional behavior across multiple entities you need tooensure that those entities are in hello same partition.</span></span> <span data-ttu-id="a3f81-185">Isso geralmente é um motivo para manter vários tipos de entidade no hello mesma tabela (e de partição) e não usar várias tabelas para tipos de entidade diferente.</span><span class="sxs-lookup"><span data-stu-id="a3f81-185">This is often a reason for keeping multiple entity types in hello same table (and partition) and not using multiple tables for different entity types.</span></span> <span data-ttu-id="a3f81-186">Uma única EGT pode operar no máximo 100 entidades.</span><span class="sxs-lookup"><span data-stu-id="a3f81-186">A single EGT can operate on at most 100 entities.</span></span>  <span data-ttu-id="a3f81-187">Se você enviar várias EGTs simultâneos para processá-lo é importante tooensure esses EGTs não funcionam em entidades que são comuns em EGTs, caso contrário, o processamento pode ser atrasado.</span><span class="sxs-lookup"><span data-stu-id="a3f81-187">If you submit multiple concurrent EGTs for processing it is important tooensure  those EGTs do not operate on entities that are common across EGTs as otherwise processing can be delayed.</span></span>

<span data-ttu-id="a3f81-188">EGTs também apresentam uma compensação potencial para você tooevaluate em seu design: usar mais partições aumentará escalabilidade de saudação do aplicativo porque o Azure tem mais oportunidades para balanceamento de carga solicitações entre nós, mas isso pode limitar Olá capacidade de seu transações atômicas de tooperform do aplicativo e manter a consistência forte para seus dados.</span><span class="sxs-lookup"><span data-stu-id="a3f81-188">EGTs also introduce a potential trade-off for you tooevaluate in your design: using more partitions will increase hello scalability of your application because Azure has more opportunities for load balancing requests across nodes, but this might limit hello ability of your application tooperform atomic transactions and maintain strong consistency for your data.</span></span> <span data-ttu-id="a3f81-189">Além disso, existem destinos de escalabilidade específico no nível de saudação de uma partição que pode limitar a taxa de transferência de saudação de transações que você pode esperar para um único nó: para obter mais informações sobre os destinos de escalabilidade Olá para contas de armazenamento do Azure e a tabela de saudação serviço, consulte [escalabilidade do armazenamento do Azure e metas de desempenho](../storage/common/storage-scalability-targets.md).</span><span class="sxs-lookup"><span data-stu-id="a3f81-189">Furthermore, there are specific scalability targets at hello level of a partition that might limit hello throughput of transactions you can expect for a single node: for more information about hello scalability targets for Azure storage accounts and hello table service, see [Azure Storage Scalability and Performance Targets](../storage/common/storage-scalability-targets.md).</span></span> <span data-ttu-id="a3f81-190">As seções posteriores deste guia discutem vários design estratégias ajudarão-lo a gerenciar as compensações como este e discutem a melhor toochoose sua chave de partição com base em requisitos específicos de saudação do seu aplicativo cliente.</span><span class="sxs-lookup"><span data-stu-id="a3f81-190">Later sections of this guide discuss various design strategies that help you manage trade-offs such as this one, and discuss how best toochoose your partition key based on hello specific requirements of your client application.</span></span>  

### <a name="capacity-considerations"></a><span data-ttu-id="a3f81-191">Considerações sobre a capacidade</span><span class="sxs-lookup"><span data-stu-id="a3f81-191">Capacity considerations</span></span>
<span data-ttu-id="a3f81-192">Olá tabela a seguir inclui alguns Olá valores de chave toobe atento ao projetar uma solução de serviço de tabela:</span><span class="sxs-lookup"><span data-stu-id="a3f81-192">hello following table includes some of hello key values toobe aware of when you are designing a Table service solution:</span></span>  

| <span data-ttu-id="a3f81-193">Capacidade total de uma conta de armazenamento do Azure</span><span class="sxs-lookup"><span data-stu-id="a3f81-193">Total capacity of an Azure storage account</span></span> | <span data-ttu-id="a3f81-194">500 TB</span><span class="sxs-lookup"><span data-stu-id="a3f81-194">500 TB</span></span> |
| --- | --- |
| <span data-ttu-id="a3f81-195">Número de tabelas em uma conta de armazenamento do Azure</span><span class="sxs-lookup"><span data-stu-id="a3f81-195">Number of tables in an Azure storage account</span></span> |<span data-ttu-id="a3f81-196">Limitado apenas pela capacidade Olá Olá da conta de armazenamento</span><span class="sxs-lookup"><span data-stu-id="a3f81-196">Limited only by hello capacity of hello storage account</span></span> |
| <span data-ttu-id="a3f81-197">Número de partições em uma tabela</span><span class="sxs-lookup"><span data-stu-id="a3f81-197">Number of partitions in a table</span></span> |<span data-ttu-id="a3f81-198">Limitado apenas pela capacidade Olá Olá da conta de armazenamento</span><span class="sxs-lookup"><span data-stu-id="a3f81-198">Limited only by hello capacity of hello storage account</span></span> |
| <span data-ttu-id="a3f81-199">Número de entidades em uma partição</span><span class="sxs-lookup"><span data-stu-id="a3f81-199">Number of entities in a partition</span></span> |<span data-ttu-id="a3f81-200">Limitado apenas pela capacidade Olá Olá da conta de armazenamento</span><span class="sxs-lookup"><span data-stu-id="a3f81-200">Limited only by hello capacity of hello storage account</span></span> |
| <span data-ttu-id="a3f81-201">Tamanho de uma entidade individual</span><span class="sxs-lookup"><span data-stu-id="a3f81-201">Size of an individual entity</span></span> |<span data-ttu-id="a3f81-202">Até too1 MB com um máximo de 255 propriedades (incluindo Olá **PartitionKey**, **RowKey**, e **Timestamp**)</span><span class="sxs-lookup"><span data-stu-id="a3f81-202">Up too1 MB with a maximum of 255 properties (including hello **PartitionKey**, **RowKey**, and **Timestamp**)</span></span> |
| <span data-ttu-id="a3f81-203">Tamanho da saudação **PartitionKey**</span><span class="sxs-lookup"><span data-stu-id="a3f81-203">Size of hello **PartitionKey**</span></span> |<span data-ttu-id="a3f81-204">Uma cadeia de caracteres para cima too1 KB de tamanho</span><span class="sxs-lookup"><span data-stu-id="a3f81-204">A string up too1 KB in size</span></span> |
| <span data-ttu-id="a3f81-205">Tamanho da saudação **RowKey**</span><span class="sxs-lookup"><span data-stu-id="a3f81-205">Size of hello **RowKey**</span></span> |<span data-ttu-id="a3f81-206">Uma cadeia de caracteres para cima too1 KB de tamanho</span><span class="sxs-lookup"><span data-stu-id="a3f81-206">A string up too1 KB in size</span></span> |
| <span data-ttu-id="a3f81-207">Tamanho de uma Transação de Grupo de Entidades</span><span class="sxs-lookup"><span data-stu-id="a3f81-207">Size of an Entity Group Transaction</span></span> |<span data-ttu-id="a3f81-208">Uma transação pode incluir no máximo 100 entidades e carga Olá deve ser menor que 4 MB.</span><span class="sxs-lookup"><span data-stu-id="a3f81-208">A transaction can include at most 100 entities and hello payload must be less than 4 MB in size.</span></span> <span data-ttu-id="a3f81-209">Uma EGT só pode atualizar uma entidade uma vez.</span><span class="sxs-lookup"><span data-stu-id="a3f81-209">An EGT can only update an entity once.</span></span> |

<span data-ttu-id="a3f81-210">Para obter mais informações, consulte [Olá Noções básicas sobre modelo de dados do serviço de tabela](http://msdn.microsoft.com/library/azure/dd179338.aspx).</span><span class="sxs-lookup"><span data-stu-id="a3f81-210">For more information, see [Understanding hello Table Service Data Model](http://msdn.microsoft.com/library/azure/dd179338.aspx).</span></span>  

### <a name="cost-considerations"></a><span data-ttu-id="a3f81-211">Considerações de custo</span><span class="sxs-lookup"><span data-stu-id="a3f81-211">Cost considerations</span></span>
<span data-ttu-id="a3f81-212">Armazenamento de tabela é relativamente baixo custo, mas você deve incluir estimativas de custo para a quantidade de uso e hello ambas as capacidade de transações como parte da avaliação de qualquer solução que usa o serviço de tabela de saudação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-212">Table storage is relatively inexpensive, but you should include cost estimates for both capacity usage and hello quantity of transactions as part of your evaluation of any solution that uses hello Table service.</span></span> <span data-ttu-id="a3f81-213">No entanto, em muitos cenários de armazenamento de dados desnormalizados ou duplicados em Olá de tooimprove ordem desempenho ou a escalabilidade de sua solução é tootake uma abordagem válida.</span><span class="sxs-lookup"><span data-stu-id="a3f81-213">However, in many scenarios storing denormalized or duplicate data in order tooimprove hello performance or scalability of your solution is a valid approach tootake.</span></span> <span data-ttu-id="a3f81-214">Para obter mais informações sobre preços, consulte [Preços de Armazenamento do Azure](https://azure.microsoft.com/pricing/details/storage/).</span><span class="sxs-lookup"><span data-stu-id="a3f81-214">For more information about pricing, see [Azure Storage Pricing](https://azure.microsoft.com/pricing/details/storage/).</span></span>  

## <a name="guidelines-for-table-design"></a><span data-ttu-id="a3f81-215">Diretrizes de design da tabela</span><span class="sxs-lookup"><span data-stu-id="a3f81-215">Guidelines for table design</span></span>
<span data-ttu-id="a3f81-216">Essas listas resumem algumas diretrizes importantes hello, que você deve ter em mente quando você está criando tabelas, e este guia resolvê-los em mais detalhes posteriormente.</span><span class="sxs-lookup"><span data-stu-id="a3f81-216">These lists summarize some of hello key guidelines you should keep in mind when you are designing your tables, and this guide will address them all in more detail later in.</span></span> <span data-ttu-id="a3f81-217">Essas diretrizes são muito diferentes das diretrizes de saudação que siga para design de banco de dados relacional.</span><span class="sxs-lookup"><span data-stu-id="a3f81-217">These guidelines are very different from hello guidelines you would typically follow for relational database design.</span></span>  

<span data-ttu-id="a3f81-218">Projetando sua toobe de solução do serviço de tabela *ler* eficiente:</span><span class="sxs-lookup"><span data-stu-id="a3f81-218">Designing your Table service solution toobe *read* efficient:</span></span>

* <span data-ttu-id="a3f81-219">***Design para consulta em aplicativos com alta taxa de leitura.***</span><span class="sxs-lookup"><span data-stu-id="a3f81-219">***Design for querying in read-heavy applications.***</span></span> <span data-ttu-id="a3f81-220">Quando você estiver criando suas tabelas, pense consultas hello (especialmente Olá latência confidenciais) que será executado antes de você pensar em como você atualizará suas entidades.</span><span class="sxs-lookup"><span data-stu-id="a3f81-220">When you are designing your tables, think about hello queries (especially hello latency sensitive ones) that you will execute before you think about how you will update your entities.</span></span> <span data-ttu-id="a3f81-221">Isso normalmente resulta em uma solução eficiente e de alto desempenho.</span><span class="sxs-lookup"><span data-stu-id="a3f81-221">This typically results in an efficient and performant solution.</span></span>  
* <span data-ttu-id="a3f81-222">***Especifique PartitionKey e RowKey em suas consultas.***</span><span class="sxs-lookup"><span data-stu-id="a3f81-222">***Specify both PartitionKey and RowKey in your queries.***</span></span> <span data-ttu-id="a3f81-223">*Ponto de consultas* como essas são consultas de serviço de tabela mais eficientes hello.</span><span class="sxs-lookup"><span data-stu-id="a3f81-223">*Point queries* such as these are hello most efficient table service queries.</span></span>  
* <span data-ttu-id="a3f81-224">***Considere armazenar cópias duplicadas de entidades.***</span><span class="sxs-lookup"><span data-stu-id="a3f81-224">***Consider storing duplicate copies of entities.***</span></span> <span data-ttu-id="a3f81-225">Armazenamento de tabela é barato portanto, considere armazenar Olá a mesma entidade várias vezes (com chaves diferentes) tooenable consultas mais eficientes.</span><span class="sxs-lookup"><span data-stu-id="a3f81-225">Table storage is cheap so consider storing hello same entity multiple times (with different keys) tooenable more efficient queries.</span></span>  
* <span data-ttu-id="a3f81-226">***Considere a desnormalização de seus dados.***</span><span class="sxs-lookup"><span data-stu-id="a3f81-226">***Consider denormalizing your data.***</span></span> <span data-ttu-id="a3f81-227">O armazenamento de tabela é barato, então considere desnormalizar seus dados.</span><span class="sxs-lookup"><span data-stu-id="a3f81-227">Table storage is cheap so consider denormalizing your data.</span></span> <span data-ttu-id="a3f81-228">Por exemplo, armazene entidades de resumidas para que consultas de agregação de dados precisam apenas tooaccess uma única entidade.</span><span class="sxs-lookup"><span data-stu-id="a3f81-228">For example, store summary entities so that queries for aggregate data only need tooaccess a single entity.</span></span>  
* <span data-ttu-id="a3f81-229">***Use valores de chave composta.***</span><span class="sxs-lookup"><span data-stu-id="a3f81-229">***Use compound key values.***</span></span> <span data-ttu-id="a3f81-230">Olá apenas as chaves que são **PartitionKey** e **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="a3f81-230">hello only keys you have are **PartitionKey** and **RowKey**.</span></span> <span data-ttu-id="a3f81-231">Por exemplo, use os valores de chave composta tooenable com chave de acesso alternativo caminhos tooentities.</span><span class="sxs-lookup"><span data-stu-id="a3f81-231">For example, use compound key values tooenable alternate keyed access paths tooentities.</span></span>  
* <span data-ttu-id="a3f81-232">***Use a projeção de consulta.***</span><span class="sxs-lookup"><span data-stu-id="a3f81-232">***Use query projection.***</span></span> <span data-ttu-id="a3f81-233">Você pode reduzir a quantidade de saudação de dados que são transferidos pela rede Olá por meio de consultas que seleciona apenas os campos de saudação que necessários.</span><span class="sxs-lookup"><span data-stu-id="a3f81-233">You can reduce hello amount of data that you transfer over hello network by using queries that select just hello fields you need.</span></span>  

<span data-ttu-id="a3f81-234">Projetando sua toobe de solução do serviço de tabela *gravar* eficiente:</span><span class="sxs-lookup"><span data-stu-id="a3f81-234">Designing your Table service solution toobe *write* efficient:</span></span>  

* <span data-ttu-id="a3f81-235">***Não crie partições ativas.***</span><span class="sxs-lookup"><span data-stu-id="a3f81-235">***Do not create hot partitions.***</span></span> <span data-ttu-id="a3f81-236">Escolha suas solicitações de chaves que permitem que você toospread por várias partições em qualquer momento.</span><span class="sxs-lookup"><span data-stu-id="a3f81-236">Choose keys that enable you toospread your requests across multiple partitions at any point of time.</span></span>  
* <span data-ttu-id="a3f81-237">***Evite picos no tráfego.***</span><span class="sxs-lookup"><span data-stu-id="a3f81-237">***Avoid spikes in traffic.***</span></span> <span data-ttu-id="a3f81-238">Suavizar o tráfego de saudação em um período de tempo razoável e evitar picos no tráfego.</span><span class="sxs-lookup"><span data-stu-id="a3f81-238">Smooth hello traffic over a reasonable period of time and avoid spikes in traffic.</span></span>
* <span data-ttu-id="a3f81-239">***Não crie, necessariamente, uma tabela separada para cada tipo de entidade.***</span><span class="sxs-lookup"><span data-stu-id="a3f81-239">***Don't necessarily create a separate table for each type of entity.***</span></span> <span data-ttu-id="a3f81-240">Quando você precisar de transações atômicas em todos os tipos de entidade, você pode armazenar esses vários tipos de entidade em Olá mesma partição Olá mesma tabela.</span><span class="sxs-lookup"><span data-stu-id="a3f81-240">When you require atomic transactions across entity types, you can store these multiple entity types in hello same partition in hello same table.</span></span>
* <span data-ttu-id="a3f81-241">***Considere a taxa de transferência máxima Olá que deve atingir.***</span><span class="sxs-lookup"><span data-stu-id="a3f81-241">***Consider hello maximum throughput you must achieve.***</span></span> <span data-ttu-id="a3f81-242">Você deve estar ciente das metas de escalabilidade de saudação para Olá serviço tabela e certifique-se de que seu design não causará você tooexceed-los.</span><span class="sxs-lookup"><span data-stu-id="a3f81-242">You must be aware of hello scalability targets for hello Table service and ensure that your design will not cause you tooexceed them.</span></span>  

<span data-ttu-id="a3f81-243">À medida que você ler este guia, verá exemplos que colocam todos esses princípios em prática.</span><span class="sxs-lookup"><span data-stu-id="a3f81-243">As you read this guide, you will see examples that put all of these principles into practice.</span></span>  

## <a name="design-for-querying"></a><span data-ttu-id="a3f81-244">Design para consulta</span><span class="sxs-lookup"><span data-stu-id="a3f81-244">Design for querying</span></span>
<span data-ttu-id="a3f81-245">Soluções de serviço de tabela podem ser lidos com uso intensivo, com uso intensivo de gravação ou uma mistura de saudação dois.</span><span class="sxs-lookup"><span data-stu-id="a3f81-245">Table service solutions may be read intensive, write intensive, or a mix of hello two.</span></span> <span data-ttu-id="a3f81-246">Esta seção discute Olá coisas toobear em mente quando você está projetando seu toosupport do serviço de tabela com eficiência as operações de leitura.</span><span class="sxs-lookup"><span data-stu-id="a3f81-246">This section focuses on hello things toobear in mind when you are designing your Table service toosupport read operations efficiently.</span></span> <span data-ttu-id="a3f81-247">Normalmente, um design que dá suporte a operações de leitura com eficiência também é eficiente para operações de gravação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-247">Typically, a design that supports read operations efficiently is also efficient for write operations.</span></span> <span data-ttu-id="a3f81-248">No entanto, há considerações adicionais toobear em mente quando projetar toosupport operações de gravação, discutidas na próxima seção, Olá, [Design para modificação de dados](#design-for-data-modification).</span><span class="sxs-lookup"><span data-stu-id="a3f81-248">However, there are additional considerations toobear in mind when designing toosupport write operations, discussed in hello next section, [Design for data modification](#design-for-data-modification).</span></span>

<span data-ttu-id="a3f81-249">Um bom ponto de partida para projetar seu tooenable de solução do serviço de tabela você tooread dados com eficiência são tooask "quais consultas serão necessário tooexecute tooretrieve Olá dados do meu aplicativo precisa de saudação serviço tabela?"</span><span class="sxs-lookup"><span data-stu-id="a3f81-249">A good starting point for designing your Table service solution tooenable you tooread data efficiently is tooask "What queries will my application need tooexecute tooretrieve hello data it needs from hello Table service?"</span></span>  

> [!NOTE]
> <span data-ttu-id="a3f81-250">Com hello serviço tabela, é importante tooget Olá design correto adiantado porque é difícil e caro toochange-lo mais tarde.</span><span class="sxs-lookup"><span data-stu-id="a3f81-250">With hello Table service, it's important tooget hello design correct up front because it's difficult and expensive toochange it later.</span></span> <span data-ttu-id="a3f81-251">Por exemplo, em um banco de dados relacional que é geralmente tooaddress possíveis problemas de desempenho simplesmente adicionando índices tooan banco de dados existente: isso não é uma opção com hello serviço tabela.</span><span class="sxs-lookup"><span data-stu-id="a3f81-251">For example, in a relational database it's often possible tooaddress performance issues simply by adding indexes tooan existing database: this is not an option with hello Table service.</span></span>  
> 
> 

<span data-ttu-id="a3f81-252">Esta seção aborda questões importantes Olá, resolvidos quando você cria as tabelas de consulta.</span><span class="sxs-lookup"><span data-stu-id="a3f81-252">This section focuses on hello key issues you must address when you design your tables for querying.</span></span> <span data-ttu-id="a3f81-253">Olá tópicos abordados nesta seção incluem:</span><span class="sxs-lookup"><span data-stu-id="a3f81-253">hello topics covered in this section include:</span></span>

* [<span data-ttu-id="a3f81-254">Como sua escolha de PartitionKey e RowKey afeta o desempenho da consulta</span><span class="sxs-lookup"><span data-stu-id="a3f81-254">How your choice of PartitionKey and RowKey impacts query performance</span></span>](#how-your-choice-of-partitionkey-and-rowkey-impacts-query-performance)
* [<span data-ttu-id="a3f81-255">Escolhendo uma PartitionKey apropriada</span><span class="sxs-lookup"><span data-stu-id="a3f81-255">Choosing an appropriate PartitionKey</span></span>](#choosing-an-appropriate-partitionkey)
* [<span data-ttu-id="a3f81-256">Otimização de consultas para Olá serviço tabela</span><span class="sxs-lookup"><span data-stu-id="a3f81-256">Optimizing queries for hello Table service</span></span>](#optimizing-queries-for-the-table-service)
* [<span data-ttu-id="a3f81-257">Classificando dados em Olá serviço tabela</span><span class="sxs-lookup"><span data-stu-id="a3f81-257">Sorting data in hello Table service</span></span>](#sorting-data-in-the-table-service)

### <a name="how-your-choice-of-partitionkey-and-rowkey-impacts-query-performance"></a><span data-ttu-id="a3f81-258">Como sua escolha de PartitionKey e RowKey afeta o desempenho da consulta</span><span class="sxs-lookup"><span data-stu-id="a3f81-258">How your choice of PartitionKey and RowKey impacts query performance</span></span>
<span data-ttu-id="a3f81-259">Olá exemplos a seguir presumem serviço de tabela hello está armazenando as entidades de funcionário com hello estrutura a seguir (a maioria dos exemplos de saudação omite Olá **Timestamp** propriedade para maior clareza):</span><span class="sxs-lookup"><span data-stu-id="a3f81-259">hello following examples assume hello table service is storing employee entities with hello following structure (most of hello examples omit hello **Timestamp** property for clarity):</span></span>  

| <span data-ttu-id="a3f81-260">*Nome da coluna*</span><span class="sxs-lookup"><span data-stu-id="a3f81-260">*Column name*</span></span> | <span data-ttu-id="a3f81-261">*Tipo de dados*</span><span class="sxs-lookup"><span data-stu-id="a3f81-261">*Data type*</span></span> |
| --- | --- |
| <span data-ttu-id="a3f81-262">**PartitionKey** (nome de departamento)</span><span class="sxs-lookup"><span data-stu-id="a3f81-262">**PartitionKey** (Department Name)</span></span> |<span data-ttu-id="a3f81-263">Cadeia de caracteres</span><span class="sxs-lookup"><span data-stu-id="a3f81-263">String</span></span> |
| <span data-ttu-id="a3f81-264">**RowKey** (Id do funcionário)</span><span class="sxs-lookup"><span data-stu-id="a3f81-264">**RowKey** (Employee Id)</span></span> |<span data-ttu-id="a3f81-265">Cadeia de caracteres</span><span class="sxs-lookup"><span data-stu-id="a3f81-265">String</span></span> |
| <span data-ttu-id="a3f81-266">**Nome**</span><span class="sxs-lookup"><span data-stu-id="a3f81-266">**FirstName**</span></span> |<span data-ttu-id="a3f81-267">Cadeia de caracteres</span><span class="sxs-lookup"><span data-stu-id="a3f81-267">String</span></span> |
| <span data-ttu-id="a3f81-268">**Sobrenome**</span><span class="sxs-lookup"><span data-stu-id="a3f81-268">**LastName**</span></span> |<span data-ttu-id="a3f81-269">Cadeia de caracteres</span><span class="sxs-lookup"><span data-stu-id="a3f81-269">String</span></span> |
| <span data-ttu-id="a3f81-270">**Idade**</span><span class="sxs-lookup"><span data-stu-id="a3f81-270">**Age**</span></span> |<span data-ttu-id="a3f81-271">Número inteiro</span><span class="sxs-lookup"><span data-stu-id="a3f81-271">Integer</span></span> |
| <span data-ttu-id="a3f81-272">**EmailAddress**</span><span class="sxs-lookup"><span data-stu-id="a3f81-272">**EmailAddress**</span></span> |<span data-ttu-id="a3f81-273">Cadeia de caracteres</span><span class="sxs-lookup"><span data-stu-id="a3f81-273">String</span></span> |

<span data-ttu-id="a3f81-274">Olá seção anterior [visão geral do serviço de tabela do Azure](#overview) descreve Olá principais recursos de saudação serviço tabela do Azure que têm uma influência direta sobre a criação de consulta.</span><span class="sxs-lookup"><span data-stu-id="a3f81-274">hello earlier section [Azure Table service overview](#overview) describes some of hello key features of hello Azure Table service that have a direct influence on designing for query.</span></span> <span data-ttu-id="a3f81-275">Esses resultam em Olá diretrizes gerais para a criação de consultas do serviço de tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="a3f81-275">These result in hello following general guidelines for designing Table service queries.</span></span> <span data-ttu-id="a3f81-276">Observe que a sintaxe do filtro Olá usada nos exemplos de saudação abaixo é saudação do serviço tabela API REST, para obter mais informações, consulte [consultar entidades](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span><span class="sxs-lookup"><span data-stu-id="a3f81-276">Note that hello filter syntax used in hello examples below is from hello Table service REST API, for more information see [Query Entities](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span></span>  

* <span data-ttu-id="a3f81-277">Um ***consulta*** é Olá toouse de pesquisa mais eficiente e é recomendado toobe usado para pesquisas de alto volume ou pesquisas que requerem a menor latência.</span><span class="sxs-lookup"><span data-stu-id="a3f81-277">A ***Point Query*** is hello most efficient lookup toouse and is recommended toobe used for high-volume lookups or lookups requiring lowest latency.</span></span> <span data-ttu-id="a3f81-278">Essa consulta pode usar Olá índices toolocate uma entidade individual maneira muito eficiente especificando ambos Olá **PartitionKey** e **RowKey** valores.</span><span class="sxs-lookup"><span data-stu-id="a3f81-278">Such a query can use hello indexes toolocate an individual entity very efficiently by specifying both hello **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="a3f81-279">Por exemplo: $filter=(PartitionKey eq 'Sales') and (RowKey eq '2')</span><span class="sxs-lookup"><span data-stu-id="a3f81-279">For example: $filter=(PartitionKey eq 'Sales') and (RowKey eq '2')</span></span>  
* <span data-ttu-id="a3f81-280">Segundo melhor é um ***consulta de intervalo*** que usa Olá **PartitionKey** e filtros em um intervalo de **RowKey** valores tooreturn mais de uma entidade.</span><span class="sxs-lookup"><span data-stu-id="a3f81-280">Second best is a ***Range Query*** that uses hello **PartitionKey** and filters on a range of **RowKey** values tooreturn more than one entity.</span></span> <span data-ttu-id="a3f81-281">Olá **PartitionKey** valor identifica uma partição específica e hello **RowKey** valores identificam um subconjunto de entidades Olá nessa partição.</span><span class="sxs-lookup"><span data-stu-id="a3f81-281">hello **PartitionKey** value identifies a specific partition, and hello **RowKey** values identify a subset of hello entities in that partition.</span></span> <span data-ttu-id="a3f81-282">Por exemplo: $filter=PartitionKey eq 'Sales' and RowKey ge 'S' and RowKey lt 'T'</span><span class="sxs-lookup"><span data-stu-id="a3f81-282">For example: $filter=PartitionKey eq 'Sales' and RowKey ge 'S' and RowKey lt 'T'</span></span>  
* <span data-ttu-id="a3f81-283">É melhor terceiro um ***partição verificação*** que usa Olá **PartitionKey** e filtros em outra propriedade de não-chave e que podem retornar mais de uma entidade.</span><span class="sxs-lookup"><span data-stu-id="a3f81-283">Third best is a ***Partition Scan*** that uses hello **PartitionKey** and filters on another non-key property and that may return more than one entity.</span></span> <span data-ttu-id="a3f81-284">Olá **PartitionKey** valor identifica uma partição específica e valores de propriedade de saudação select para um subconjunto de entidades Olá nessa partição.</span><span class="sxs-lookup"><span data-stu-id="a3f81-284">hello **PartitionKey** value identifies a specific partition, and hello property values select for a subset of hello entities in that partition.</span></span> <span data-ttu-id="a3f81-285">Por exemplo: $filter=PartitionKey eq 'Sales' and LastName eq 'Smith'</span><span class="sxs-lookup"><span data-stu-id="a3f81-285">For example: $filter=PartitionKey eq 'Sales' and LastName eq 'Smith'</span></span>  
* <span data-ttu-id="a3f81-286">Um ***Table Scan*** não inclui Olá **PartitionKey** e é muito eficiente porque ele procura todas as partições de saudação que compõem sua tabela para as entidades correspondentes.</span><span class="sxs-lookup"><span data-stu-id="a3f81-286">A ***Table Scan*** does not include hello **PartitionKey** and is very inefficient because it searches all of hello partitions that make up your table in turn for any matching entities.</span></span> <span data-ttu-id="a3f81-287">Ele executará uma verificação de tabela, independentemente de estarem ou não o filtro usa Olá **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="a3f81-287">It will perform a table scan regardless of whether or not your filter uses hello **RowKey**.</span></span> <span data-ttu-id="a3f81-288">Por exemplo: $filter=LastName eq 'Dias'</span><span class="sxs-lookup"><span data-stu-id="a3f81-288">For example: $filter=LastName eq 'Jones'</span></span>  
* <span data-ttu-id="a3f81-289">As consultas que retornam várias entidades as retornam classificadas na ordem **PartitionKey** e **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="a3f81-289">Queries that return multiple entities return them sorted in **PartitionKey** and **RowKey** order.</span></span> <span data-ttu-id="a3f81-290">entidades de saudação reclassificação tooavoid no cliente hello, escolha um **RowKey** que define a ordem de classificação hello mais comuns.</span><span class="sxs-lookup"><span data-stu-id="a3f81-290">tooavoid resorting hello entities in hello client, choose a **RowKey** that defines hello most common sort order.</span></span>  

<span data-ttu-id="a3f81-291">Observe que o uso uma "**ou**" toospecify um filtro baseado em **RowKey** valores resulta em uma verificação de partição e não é tratado como uma consulta de intervalo.</span><span class="sxs-lookup"><span data-stu-id="a3f81-291">Note that using an "**or**" toospecify a filter based on **RowKey** values results in a partition scan and is not treated as a range query.</span></span> <span data-ttu-id="a3f81-292">Portanto, você deve evitar consultas que usam filtros, como: $filter=PartitionKey eq 'Sales' and (RowKey eq '121' or RowKey eq '322')</span><span class="sxs-lookup"><span data-stu-id="a3f81-292">Therefore, you should avoid queries that use filters such as: $filter=PartitionKey eq 'Sales' and (RowKey eq '121' or RowKey eq '322')</span></span>  

<span data-ttu-id="a3f81-293">Para obter exemplos de código do lado do cliente que usam consultas eficientes do tooexecute Olá biblioteca de cliente de armazenamento, consulte:</span><span class="sxs-lookup"><span data-stu-id="a3f81-293">For examples of client-side code that use hello Storage Client Library tooexecute efficient queries, see:</span></span>  

* [<span data-ttu-id="a3f81-294">Executando uma consulta de ponto usando Olá biblioteca de cliente de armazenamento</span><span class="sxs-lookup"><span data-stu-id="a3f81-294">Executing a point query using hello Storage Client Library</span></span>](#executing-a-point-query-using-the-storage-client-library)
* [<span data-ttu-id="a3f81-295">Recuperando várias entidades usando LINQ</span><span class="sxs-lookup"><span data-stu-id="a3f81-295">Retrieving multiple entities using LINQ</span></span>](#retrieving-multiple-entities-using-linq)
* [<span data-ttu-id="a3f81-296">Projeção do lado do servidor</span><span class="sxs-lookup"><span data-stu-id="a3f81-296">Server-side projection</span></span>](#server-side-projection)  

<span data-ttu-id="a3f81-297">Para obter exemplos de código do lado do cliente que pode lidar com a entidade de vários tipos armazenados no hello mesma tabela, consulte:</span><span class="sxs-lookup"><span data-stu-id="a3f81-297">For examples of client-side code that can handle multiple entity types stored in hello same table, see:</span></span>  

* [<span data-ttu-id="a3f81-298">Trabalhando com tipos de entidade heterogênea</span><span class="sxs-lookup"><span data-stu-id="a3f81-298">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)  

### <a name="choosing-an-appropriate-partitionkey"></a><span data-ttu-id="a3f81-299">Escolhendo uma PartitionKey apropriada</span><span class="sxs-lookup"><span data-stu-id="a3f81-299">Choosing an appropriate PartitionKey</span></span>
<span data-ttu-id="a3f81-300">A escolha do **PartitionKey** deve equilibrar Olá necessidade tooenables Olá uso EGTs (tooensure consistência) em relação a saudação requisito toodistribute suas entidades por várias partições (tooensure uma solução escalonável).</span><span class="sxs-lookup"><span data-stu-id="a3f81-300">Your choice of **PartitionKey** should balance hello need tooenables hello use of EGTs (tooensure consistency) against hello requirement toodistribute your entities across multiple partitions (tooensure a scalable solution).</span></span>  

<span data-ttu-id="a3f81-301">De um lado, você pode armazenar todas as suas entidades em uma única partição, mas isso pode limitar a escalabilidade de saudação de sua solução e poderia impedir que o serviço de tabela de saudação de sendo capaz de saldo de tooload solicitações.</span><span class="sxs-lookup"><span data-stu-id="a3f81-301">At one extreme, you could store all your entities in a single partition, but this may limit hello scalability of your solution and would prevent hello table service from being able tooload-balance requests.</span></span> <span data-ttu-id="a3f81-302">Em Olá outro lado, você pode armazenar uma entidade por partição, que seriam altamente escalonável e que permite Olá tabela tooload balancear solicitações, mas que o impediria de uso de transações de grupo de entidade.</span><span class="sxs-lookup"><span data-stu-id="a3f81-302">At hello other extreme, you could store one entity per partition, which would be highly scalable and which enables hello table service tooload-balance requests, but which would prevent you from using entity group transactions.</span></span>  

<span data-ttu-id="a3f81-303">O ideal **PartitionKey** é aquele que permite consultas eficientes toouse e que tem suficiente tooensure de partições sua solução é escalável.</span><span class="sxs-lookup"><span data-stu-id="a3f81-303">An ideal **PartitionKey** is one that enables you toouse efficient queries and that has sufficient partitions tooensure your solution is scalable.</span></span> <span data-ttu-id="a3f81-304">Normalmente, você descobrirá que as entidades terão uma propriedade adequada que distribui suas entidades em partições suficientes.</span><span class="sxs-lookup"><span data-stu-id="a3f81-304">Typically, you will find that your entities will have a suitable property that distributes your entities across sufficient partitions.</span></span>

> [!NOTE]
> <span data-ttu-id="a3f81-305">Por exemplo, em um sistema que armazena informações sobre usuários ou funcionários, UserID pode ser uma boa PartitionKey.</span><span class="sxs-lookup"><span data-stu-id="a3f81-305">For example, in a system that stores information about users or employees, UserID may be a good PartitionKey.</span></span> <span data-ttu-id="a3f81-306">Você pode ter várias entidades que usam uma determinado UserID como chave de partição hello.</span><span class="sxs-lookup"><span data-stu-id="a3f81-306">You may have several entities that use a given UserID as hello partition key.</span></span> <span data-ttu-id="a3f81-307">Cada entidade que armazena dados sobre um usuário é agrupada em uma única partição, e pode ser acessada por meio de transações do grupo de entidades, continuando altamente escalonável.</span><span class="sxs-lookup"><span data-stu-id="a3f81-307">Each entity that stores data about a user is grouped into a single partition, and so these entities are accessible via entity group transactions, while still being highly scalable.</span></span>
> 
> 

<span data-ttu-id="a3f81-308">Há considerações adicionais de sua escolha do **PartitionKey** que se relacionam toohow irá inserir, atualizar e excluir entidades: consulte a seção Olá [Design para modificação de dados](#design-for-data-modification) abaixo.</span><span class="sxs-lookup"><span data-stu-id="a3f81-308">There are additional considerations in your choice of **PartitionKey** that relate toohow you will insert, update, and delete entities: see hello section [Design for data modification](#design-for-data-modification) below.</span></span>  

### <a name="optimizing-queries-for-hello-table-service"></a><span data-ttu-id="a3f81-309">Otimização de consultas para Olá serviço tabela</span><span class="sxs-lookup"><span data-stu-id="a3f81-309">Optimizing queries for hello Table service</span></span>
<span data-ttu-id="a3f81-310">Olá serviço tabela indexa automaticamente suas entidades usando Olá **PartitionKey** e **RowKey** valores em um único índice clusterizado, Olá, portanto, o motivo que as consultas de faixas são Olá toouse mais eficiente .</span><span class="sxs-lookup"><span data-stu-id="a3f81-310">hello Table service automatically indexes your entities using hello **PartitionKey** and **RowKey** values in a single clustered index, hence hello reason that point queries are hello most efficient toouse.</span></span> <span data-ttu-id="a3f81-311">No entanto, não há nenhum índice que não seja o no índice clusterizado Olá Olá **PartitionKey** e **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="a3f81-311">However, there are no indexes other than that on hello clustered index on hello **PartitionKey** and **RowKey**.</span></span>

<span data-ttu-id="a3f81-312">Muitos projetos devem atender a pesquisa de tooenable requisitos de entidades com base em vários critérios.</span><span class="sxs-lookup"><span data-stu-id="a3f81-312">Many designs must meet requirements tooenable lookup of entities based on multiple criteria.</span></span> <span data-ttu-id="a3f81-313">Por exemplo, localizar entidades de funcionário com base em email, ID de funcionário ou sobrenome.</span><span class="sxs-lookup"><span data-stu-id="a3f81-313">For example, locating employee entities based on email, employee id, or last name.</span></span> <span data-ttu-id="a3f81-314">Olá seguintes padrões de seção Olá [padrões de Design de tabela](#table-design-patterns) resolver esses tipos de requisito e descrevem as maneiras de contornar fatos Olá que o serviço de tabela de saudação não fornece índices secundários:</span><span class="sxs-lookup"><span data-stu-id="a3f81-314">hello following patterns in hello section [Table Design Patterns](#table-design-patterns) address these types of requirement and describe ways of working around hello fact that hello Table service does not provide secondary indexes:</span></span>  

* <span data-ttu-id="a3f81-315">[Padrão de índice secundário de dentro da partição](#intra-partition-secondary-index-pattern) -armazenar várias cópias de cada entidade usando diferentes **RowKey** valores (em Olá mesma partição) tooenable rápida e eficiente pesquisas e classificação alternativo ordena usando diferentes **RowKey** valores.</span><span class="sxs-lookup"><span data-stu-id="a3f81-315">[Intra-partition secondary index pattern](#intra-partition-secondary-index-pattern) - Store multiple copies of each entity using different **RowKey** values (in hello same partition) tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span>  
* <span data-ttu-id="a3f81-316">[Padrão de índice secundário de partição entre](#inter-partition-secondary-index-pattern) - armazenar várias cópias de cada entidade usando diferentes valores de RowKey em partições separadas ou em tabelas separadas tooenable rápida e eficientes pesquisas e classificação alternativo ordens usando diferentes **RowKey** valores.</span><span class="sxs-lookup"><span data-stu-id="a3f81-316">[Inter-partition secondary index pattern](#inter-partition-secondary-index-pattern) - Store multiple copies of each entity using different RowKey values in separate partitions or in separate tables tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span>  
* <span data-ttu-id="a3f81-317">[Índice de entidades padrão](#index-entities-pattern) -manter índice entidades tooenable pesquisas eficientes que retornam listas de entidades.</span><span class="sxs-lookup"><span data-stu-id="a3f81-317">[Index Entities Pattern](#index-entities-pattern) - Maintain index entities tooenable efficient searches that return lists of entities.</span></span>  

### <a name="sorting-data-in-hello-table-service"></a><span data-ttu-id="a3f81-318">Classificando dados em Olá serviço tabela</span><span class="sxs-lookup"><span data-stu-id="a3f81-318">Sorting data in hello Table service</span></span>
<span data-ttu-id="a3f81-319">Olá serviço tabela retorna entidades classificadas em ordem crescente com base em **PartitionKey** e, em seguida, por **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="a3f81-319">hello Table service returns entities sorted in ascending order based on **PartitionKey** and then by **RowKey**.</span></span> <span data-ttu-id="a3f81-320">Essas chaves são valores de cadeia de caracteres e tooensure valores numéricos classificados corretamente, você deve convertê-los tooa fixo de comprimento e preencha-os com zeros.</span><span class="sxs-lookup"><span data-stu-id="a3f81-320">These keys are string values and tooensure that numeric values sort correctly, you should convert them tooa fixed length and pad them with zeroes.</span></span> <span data-ttu-id="a3f81-321">Por exemplo, se hello valor de id de funcionário você usar como Olá **RowKey** é um valor inteiro, você deve converter o id de funcionário **123** muito**00000123**.</span><span class="sxs-lookup"><span data-stu-id="a3f81-321">For example, if hello employee id value you use as hello **RowKey** is an integer value, you should convert employee id **123** too**00000123**.</span></span>  

<span data-ttu-id="a3f81-322">Muitos aplicativos têm requisitos toouse dados classificados em ordens diferentes: por exemplo, classificando os funcionários por nome, unindo Data.</span><span class="sxs-lookup"><span data-stu-id="a3f81-322">Many applications have requirements toouse data sorted in different orders: for example, sorting employees by name, or by joining date.</span></span> <span data-ttu-id="a3f81-323">Olá seguintes padrões de seção Olá [padrões de Design de tabela](#table-design-patterns) como ordens de classificação de tooalternate para suas entidades de endereços:</span><span class="sxs-lookup"><span data-stu-id="a3f81-323">hello following patterns in hello section [Table Design Patterns](#table-design-patterns) address how tooalternate sort orders for your entities:</span></span>  

* <span data-ttu-id="a3f81-324">[Padrão de índice secundário de dentro da partição](#intra-partition-secondary-index-pattern) -armazenar várias cópias de cada entidade usando diferentes valores de RowKey (em Olá mesma partição) tooenable rápida e eficiente pesquisas e classificação alternativo ordena usando diferentes valores de RowKey.</span><span class="sxs-lookup"><span data-stu-id="a3f81-324">[Intra-partition secondary index pattern](#intra-partition-secondary-index-pattern) - Store multiple copies of each entity using different RowKey values (in hello same partition) tooenable fast and efficient lookups and alternate sort orders by using different RowKey values.</span></span>  
* <span data-ttu-id="a3f81-325">[Padrão de índice secundário de partição entre](#inter-partition-secondary-index-pattern) - armazenar várias cópias de cada entidade usando diferentes valores de RowKey em partições separadas em tabelas separadas tooenable rápida e eficientes pesquisas e classificação alternativo ordens usando diferente RowKey valores.</span><span class="sxs-lookup"><span data-stu-id="a3f81-325">[Inter-partition secondary index pattern](#inter-partition-secondary-index-pattern) - Store multiple copies of each entity using different RowKey values in separate partitions in separate tables tooenable fast and efficient lookups and alternate sort orders by using different RowKey values.</span></span>
* <span data-ttu-id="a3f81-326">[O padrão da parte final do log](#log-tail-pattern) -Olá recuperar  *n*  entidades adicionada mais recentemente tooa partição usando uma **RowKey** valor classifica em inversa de data e a ordem de tempo.</span><span class="sxs-lookup"><span data-stu-id="a3f81-326">[Log tail pattern](#log-tail-pattern) - Retrieve hello *n* entities most recently added tooa partition by using a **RowKey** value that sorts in reverse date and time order.</span></span>  

## <a name="design-for-data-modification"></a><span data-ttu-id="a3f81-327">Design para modificação de dados</span><span class="sxs-lookup"><span data-stu-id="a3f81-327">Design for data modification</span></span>
<span data-ttu-id="a3f81-328">Esta seção se concentra em considerações de design de saudação para otimizar as inserções, atualizações e exclusões.</span><span class="sxs-lookup"><span data-stu-id="a3f81-328">This section focuses on hello design considerations for optimizing inserts, updates, and deletes.</span></span> <span data-ttu-id="a3f81-329">Em alguns casos, você precisará de compensação de saudação tooevaluate entre os designs otimizar para consultar designs otimizam modificação de dados exatamente como você faria em projetos de bancos de dados relacionais (embora técnicas Olá para o gerenciamento Olá design vantagens e desvantagens são diferentes em um banco de dados relacional).</span><span class="sxs-lookup"><span data-stu-id="a3f81-329">In some cases, you will need tooevaluate hello trade-off between designs that optimize for querying against designs that optimize for data modification just as you do in designs for relational databases (although hello techniques for managing hello design trade-offs are different in a relational database).</span></span> <span data-ttu-id="a3f81-330">Olá seção [padrões de Design de tabela](#table-design-patterns) descreve alguns padrões de design detalhadas para Olá serviço tabela e destaca algumas essas vantagens e desvantagens.</span><span class="sxs-lookup"><span data-stu-id="a3f81-330">hello section [Table Design Patterns](#table-design-patterns) describes some detailed design patterns for hello Table service and highlights some these trade-offs.</span></span> <span data-ttu-id="a3f81-331">Na prática, você descobrirá que muitos designs otimizados para entidades de consulta também funcionam bem para modificar entidades.</span><span class="sxs-lookup"><span data-stu-id="a3f81-331">In practice, you will find that many designs optimized for querying entities also work well for modifying entities.</span></span>  

### <a name="optimizing-hello-performance-of-insert-update-and-delete-operations"></a><span data-ttu-id="a3f81-332">Otimizando o desempenho de saudação de inserir, atualizar e excluir operações</span><span class="sxs-lookup"><span data-stu-id="a3f81-332">Optimizing hello performance of insert, update, and delete operations</span></span>
<span data-ttu-id="a3f81-333">tooupdate ou excluir uma entidade, você deve ser capaz de tooidentify usando Olá **PartitionKey** e **RowKey** valores.</span><span class="sxs-lookup"><span data-stu-id="a3f81-333">tooupdate or delete an entity, you must be able tooidentify it by using hello **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="a3f81-334">Nesse sentido, a escolha do **PartitionKey** e **RowKey** para modificar entidades deve seguir semelhante critérios tooyour opção toosupport ponto consultas porque deseja tooidentify entidades maior eficiência possível.</span><span class="sxs-lookup"><span data-stu-id="a3f81-334">In this respect, your choice of **PartitionKey** and **RowKey** for modifying entities should follow similar criteria tooyour choice toosupport point queries because you want tooidentify entities as efficiently as possible.</span></span> <span data-ttu-id="a3f81-335">Você não quiser toouse um ineficiente partição ou tabela verificação toolocate uma entidade em saudação do pedido toodiscover **PartitionKey** e **RowKey** valores precisar tooupdate ou excluí-lo.</span><span class="sxs-lookup"><span data-stu-id="a3f81-335">You do not want toouse an inefficient partition or table scan toolocate an entity in order toodiscover hello **PartitionKey** and **RowKey** values you need tooupdate or delete it.</span></span>  

<span data-ttu-id="a3f81-336">Olá seguintes padrões de seção Olá [padrões de Design de tabela](#table-design-patterns) endereço otimização de desempenho hello ou sua inserção, atualização e operações de exclusão:</span><span class="sxs-lookup"><span data-stu-id="a3f81-336">hello following patterns in hello section [Table Design Patterns](#table-design-patterns) address optimizing hello performance or your insert, update, and delete operations:</span></span>  

* <span data-ttu-id="a3f81-337">[Exclusão de alto volume](#high-volume-delete-pattern) -habilitar exclusão de saudação de um volume alto de entidades, armazenando todas as entidades de saudação para exclusão simultânea em suas próprias tabelas separadas; você excluir entidades de saudação excluindo tabela hello.</span><span class="sxs-lookup"><span data-stu-id="a3f81-337">[High volume delete pattern](#high-volume-delete-pattern) - Enable hello deletion of a high volume of entities by storing all hello entities for simultaneous deletion in their own separate table; you delete hello entities by deleting hello table.</span></span>  
* <span data-ttu-id="a3f81-338">[Padrão de série de dados](#data-series-pattern) -série de dados completa de armazenamento em um número de saudação toominimize única entidade de solicitações feitas.</span><span class="sxs-lookup"><span data-stu-id="a3f81-338">[Data series pattern](#data-series-pattern) - Store complete data series in a single entity toominimize hello number of requests you make.</span></span>  
* <span data-ttu-id="a3f81-339">[Padrão de entidades ampla](#wide-entities-pattern) -usar várias entidades lógicas toostore de entidades físicas com mais de 252 propriedades.</span><span class="sxs-lookup"><span data-stu-id="a3f81-339">[Wide entities pattern](#wide-entities-pattern) - Use multiple physical entities toostore logical entities with more than 252 properties.</span></span>  
* <span data-ttu-id="a3f81-340">[Padrão de entidades grande](#large-entities-pattern) -valores de propriedade grande toostore do armazenamento de blob de uso.</span><span class="sxs-lookup"><span data-stu-id="a3f81-340">[Large entities pattern](#large-entities-pattern) - Use blob storage toostore large property values.</span></span>  

### <a name="ensuring-consistency-in-your-stored-entities"></a><span data-ttu-id="a3f81-341">Garantindo a consistência nas suas entidades armazenadas</span><span class="sxs-lookup"><span data-stu-id="a3f81-341">Ensuring consistency in your stored entities</span></span>
<span data-ttu-id="a3f81-342">Olá outro fator chave que influencia sua escolha de chaves para otimizar as modificações de dados é como tooensure consistência usando transações atômicas.</span><span class="sxs-lookup"><span data-stu-id="a3f81-342">hello other key factor that influences your choice of keys for optimizing data modifications is how tooensure consistency by using atomic transactions.</span></span> <span data-ttu-id="a3f81-343">Você só pode usar um toooperate EGT em entidades armazenadas em Olá mesma partição.</span><span class="sxs-lookup"><span data-stu-id="a3f81-343">You can only use an EGT toooperate on entities stored in hello same partition.</span></span>  

<span data-ttu-id="a3f81-344">Olá seguintes padrões de seção Olá [padrões de Design de tabela](#table-design-patterns) gerenciar a consistência de endereço:</span><span class="sxs-lookup"><span data-stu-id="a3f81-344">hello following patterns in hello section [Table Design Patterns](#table-design-patterns) address managing consistency:</span></span>  

* <span data-ttu-id="a3f81-345">[Padrão de índice secundário de dentro da partição](#intra-partition-secondary-index-pattern) -armazenar várias cópias de cada entidade usando diferentes **RowKey** valores (em Olá mesma partição) tooenable rápida e eficiente pesquisas e classificação alternativo ordena usando diferentes **RowKey** valores.</span><span class="sxs-lookup"><span data-stu-id="a3f81-345">[Intra-partition secondary index pattern](#intra-partition-secondary-index-pattern) - Store multiple copies of each entity using different **RowKey** values (in hello same partition) tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span>  
* <span data-ttu-id="a3f81-346">[Padrão de índice secundário de partição entre](#inter-partition-secondary-index-pattern) - armazenar várias cópias de cada entidade usando diferentes valores de RowKey em partições separadas ou em tabelas separadas tooenable rápida e eficientes pesquisas e classificação alternativo ordens usando diferentes **RowKey** valores.</span><span class="sxs-lookup"><span data-stu-id="a3f81-346">[Inter-partition secondary index pattern](#inter-partition-secondary-index-pattern) - Store multiple copies of each entity using different RowKey values in separate partitions or in separate tables tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span>  
* <span data-ttu-id="a3f81-347">[Padrão de transações eventualmente consistentes](#eventually-consistent-transactions-pattern) - Habilite comportamento eventualmente consistente entre limites de partição ou limites do sistema de armazenamento usando filas do Azure.</span><span class="sxs-lookup"><span data-stu-id="a3f81-347">[Eventually consistent transactions pattern](#eventually-consistent-transactions-pattern) - Enable eventually consistent behavior across partition boundaries or storage system boundaries by using Azure queues.</span></span>
* <span data-ttu-id="a3f81-348">[Índice de entidades padrão](#index-entities-pattern) -manter índice entidades tooenable pesquisas eficientes que retornam listas de entidades.</span><span class="sxs-lookup"><span data-stu-id="a3f81-348">[Index Entities Pattern](#index-entities-pattern) - Maintain index entities tooenable efficient searches that return lists of entities.</span></span>  
* <span data-ttu-id="a3f81-349">[Padrão de desnormalização](#denormalization-pattern) -combinar dados relacionados em conjunto em uma única entidade tooenable tooretrieve todos Olá necessário com uma consulta de ponto de dados.</span><span class="sxs-lookup"><span data-stu-id="a3f81-349">[Denormalization pattern](#denormalization-pattern) - Combine related data together in a single entity tooenable you tooretrieve all hello data you need with a single point query.</span></span>  
* <span data-ttu-id="a3f81-350">[Padrão de série de dados](#data-series-pattern) -série de dados completa de armazenamento em um número de saudação toominimize única entidade de solicitações feitas.</span><span class="sxs-lookup"><span data-stu-id="a3f81-350">[Data series pattern](#data-series-pattern) - Store complete data series in a single entity toominimize hello number of requests you make.</span></span>  

<span data-ttu-id="a3f81-351">Para obter informações sobre transações de grupo de entidade, consulte a seção de saudação [transações de grupo de entidade](#entity-group-transactions).</span><span class="sxs-lookup"><span data-stu-id="a3f81-351">For information about entity group transactions, see hello section [Entity Group Transactions](#entity-group-transactions).</span></span>  

### <a name="ensuring-your-design-for-efficient-modifications-facilitates-efficient-queries"></a><span data-ttu-id="a3f81-352">Garantir seu design para modificações eficientes facilita consultas eficientes</span><span class="sxs-lookup"><span data-stu-id="a3f81-352">Ensuring your design for efficient modifications facilitates efficient queries</span></span>
<span data-ttu-id="a3f81-353">Em muitos casos, um projeto para resultados de consultando eficientes em modificações eficientes, mas você sempre deve avaliar se esse for o caso de Olá para seu cenário específico.</span><span class="sxs-lookup"><span data-stu-id="a3f81-353">In many cases, a design for efficient querying results in efficient modifications, but you should always evaluate whether this is hello case for your specific scenario.</span></span> <span data-ttu-id="a3f81-354">Alguns dos padrões de saudação na seção Olá [padrões de Design de tabela](#table-design-patterns) explicitamente avaliar variações de consulta e modificação de entidades, e você sempre deve levar em número de saudação da conta de cada tipo de operação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-354">Some of hello patterns in hello section [Table Design Patterns](#table-design-patterns) explicitly evaluate trade-offs between querying and modifying entities, and you should always take into account hello number of each type of operation.</span></span>  

<span data-ttu-id="a3f81-355">Olá seguintes padrões de seção Olá [padrões de Design de tabela](#table-design-patterns) prós e contras projetar consultas eficientes e criação de modificação de dados eficiente de endereços:</span><span class="sxs-lookup"><span data-stu-id="a3f81-355">hello following patterns in hello section [Table Design Patterns](#table-design-patterns) address trade-offs between designing for efficient queries and designing for efficient data modification:</span></span>  

* <span data-ttu-id="a3f81-356">[Padrão de chave composta](#compound-key-pattern) -Use compostas **RowKey** valores tooenable toolookup um cliente relacionadas a dados com uma consulta única.</span><span class="sxs-lookup"><span data-stu-id="a3f81-356">[Compound key pattern](#compound-key-pattern) - Use compound **RowKey** values tooenable a client toolookup related data with a single point query.</span></span>  
* <span data-ttu-id="a3f81-357">[O padrão da parte final do log](#log-tail-pattern) -Olá recuperar  *n*  entidades adicionada mais recentemente tooa partição usando uma **RowKey** valor classifica em inversa de data e a ordem de tempo.</span><span class="sxs-lookup"><span data-stu-id="a3f81-357">[Log tail pattern](#log-tail-pattern) - Retrieve hello *n* entities most recently added tooa partition by using a **RowKey** value that sorts in reverse date and time order.</span></span>  

## <a name="encrypting-table-data"></a><span data-ttu-id="a3f81-358">Criptografando dados de tabela</span><span class="sxs-lookup"><span data-stu-id="a3f81-358">Encrypting Table Data</span></span>
<span data-ttu-id="a3f81-359">Olá biblioteca de cliente de armazenamento do Azure .NET oferece suporte à criptografia de propriedades de entidade de cadeia de caracteres para inserir e substituir operações.</span><span class="sxs-lookup"><span data-stu-id="a3f81-359">hello .NET Azure Storage Client Library supports encryption of string entity properties for insert and replace operations.</span></span> <span data-ttu-id="a3f81-360">cadeias de caracteres de saudação criptografada são armazenadas no serviço de saudação como propriedades binárias, e eles são convertidos toostrings voltar depois da descriptografia.</span><span class="sxs-lookup"><span data-stu-id="a3f81-360">hello encrypted strings are stored on hello service as binary properties, and they are converted back toostrings after decryption.</span></span>    

<span data-ttu-id="a3f81-361">Para tabelas, além de toohello política de criptografia, usuários devem especificar Olá propriedades toobe criptografado.</span><span class="sxs-lookup"><span data-stu-id="a3f81-361">For tables, in addition toohello encryption policy, users must specify hello properties toobe encrypted.</span></span> <span data-ttu-id="a3f81-362">Isso pode ser feito especificando o atributo [EncryptProperty] \(para entidades POCO que derivam de TableEntity) ou um resolvedor de criptografia nas opções de solicitação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-362">This can be done by either specifying an [EncryptProperty] attribute (for POCO entities that derive from TableEntity) or an encryption resolver in request options.</span></span> <span data-ttu-id="a3f81-363">Um resolvedor de criptografia é um delegado que usa uma chave de partição, a chave de linha e o nome da propriedade e retorna um valor booliano que indica se essa propriedade deve ser criptografada.</span><span class="sxs-lookup"><span data-stu-id="a3f81-363">An encryption resolver is a delegate that takes a partition key, row key, and property name and returns a Boolean that indicates whether that property should be encrypted.</span></span> <span data-ttu-id="a3f81-364">Durante a criptografia, biblioteca de saudação do cliente usará esse toodecide informações se uma propriedade deve ser criptografada durante a gravação toohello durante a transmissão.</span><span class="sxs-lookup"><span data-stu-id="a3f81-364">During encryption, hello client library will use this information toodecide whether a property should be encrypted while writing toohello wire.</span></span> <span data-ttu-id="a3f81-365">também fornece delegado Olá possibilidade de saudação da lógica em torno de como as propriedades são criptografadas.</span><span class="sxs-lookup"><span data-stu-id="a3f81-365">hello delegate also provides for hello possibility of logic around how properties are encrypted.</span></span> <span data-ttu-id="a3f81-366">(Por exemplo, se X, então criptografar a propriedade A; caso contrário, criptografar as propriedades A e B.) Observe que ele é necessário não tooprovide essas informações durante a leitura ou consultar entidades.</span><span class="sxs-lookup"><span data-stu-id="a3f81-366">(For example, if X, then encrypt property A; otherwise encrypt properties A and B.) Note that it is not necessary tooprovide this information while reading or querying entities.</span></span>

<span data-ttu-id="a3f81-367">Saiba que atualmente não há suporte para a mesclagem.</span><span class="sxs-lookup"><span data-stu-id="a3f81-367">Note that merge is not currently supported.</span></span> <span data-ttu-id="a3f81-368">Como um subconjunto das propriedades pode ter sido criptografado anteriormente usando uma chave diferente, simplesmente mesclando novas propriedades de saudação e atualizar metadados Olá resultará em perda de dados.</span><span class="sxs-lookup"><span data-stu-id="a3f81-368">Since a subset of properties may have been encrypted previously using a different key, simply merging hello new properties and updating hello metadata will result in data loss.</span></span> <span data-ttu-id="a3f81-369">Mesclar o requer fazer serviço extra chama entidade pré-existente do tooread Olá do serviço hello, ou usando uma nova chave por propriedade, que não são adequados por motivos de desempenho.</span><span class="sxs-lookup"><span data-stu-id="a3f81-369">Merging either requires making extra service calls tooread hello pre-existing entity from hello service, or using a new key per property, both of which are not suitable for performance reasons.</span></span>     

<span data-ttu-id="a3f81-370">Para obter informações sobre como criptografar dados de tabela, confira [Criptografia do lado do cliente e Cofre da Chave do Azure para Armazenamento do Microsoft Azure](../storage/common/storage-client-side-encryption.md).</span><span class="sxs-lookup"><span data-stu-id="a3f81-370">For information about encrypting table data, see [Client-Side Encryption and Azure Key Vault for Microsoft Azure Storage](../storage/common/storage-client-side-encryption.md).</span></span>  

## <a name="modelling-relationships"></a><span data-ttu-id="a3f81-371">Relações de modelagem</span><span class="sxs-lookup"><span data-stu-id="a3f81-371">Modelling relationships</span></span>
<span data-ttu-id="a3f81-372">Criar modelos de domínio é uma etapa importante no design de saudação dos sistemas complexos.</span><span class="sxs-lookup"><span data-stu-id="a3f81-372">Building domain models is a key step in hello design of complex systems.</span></span> <span data-ttu-id="a3f81-373">Normalmente, você usa Olá modelagem processo tooidentify entidades e relações de saudação entre-los como uma maneira toounderstand Olá domínio corporativo e informam o design de saudação do seu sistema.</span><span class="sxs-lookup"><span data-stu-id="a3f81-373">Typically, you use hello modelling process tooidentify entities and hello relationships between them as a way toounderstand hello business domain and inform hello design of your system.</span></span> <span data-ttu-id="a3f81-374">Esta seção discute como você pode traduzir alguns dos tipos de relação comuns Olá encontrados no domínio modelos toodesigns para Olá serviço tabela.</span><span class="sxs-lookup"><span data-stu-id="a3f81-374">This section focuses on how you can translate some of hello common relationship types found in domain models toodesigns for hello Table service.</span></span> <span data-ttu-id="a3f81-375">processo de saudação de mapeamento de um lógica tooa do modelo de dados NoSQL com base em dados-modelo físico é muito diferente da usada durante a criação de um banco de dados relacional.</span><span class="sxs-lookup"><span data-stu-id="a3f81-375">hello process of mapping from a logical data-model tooa physical NoSQL based data-model is very different from that used when designing a relational database.</span></span> <span data-ttu-id="a3f81-376">Design de bancos de dados relacionais geralmente supõe que um processo de normalização de dados otimizado para minimizar a redundância – e um recurso de consultando declarativo que abstrai Olá como implementação de como funciona o banco de dados de saudação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-376">Relational databases design typically assumes a data normalization process optimized for minimizing redundancy – and a declarative querying capability that abstracts how hello implementation of how hello database works.</span></span>  

### <a name="one-to-many-relationships"></a><span data-ttu-id="a3f81-377">Relações um-para-muitos</span><span class="sxs-lookup"><span data-stu-id="a3f81-377">One-to-many relationships</span></span>
<span data-ttu-id="a3f81-378">Relações um-para-muitos entre objetos de domínio de negócios ocorrerem com muita frequência: por exemplo, um departamento tem muitos funcionários.</span><span class="sxs-lookup"><span data-stu-id="a3f81-378">One-to-many relationships between business domain objects occur very frequently: for example, one department has many employees.</span></span> <span data-ttu-id="a3f81-379">Há várias relações de um-para-muitos tooimplement maneiras Olá serviço tabela cada com prós e contras que podem ser relevantes toohello cenário em particular.</span><span class="sxs-lookup"><span data-stu-id="a3f81-379">There are several ways tooimplement one-to-many relationships in hello Table service each with pros and cons that may be relevant toohello particular scenario.</span></span>  

<span data-ttu-id="a3f81-380">Considere o exemplo hello de uma grande empresa multinacional com dezenas de milhares de departamentos e entidades de funcionário, onde cada departamento tem muitos funcionários e cada funcionário como associada a um departamento específico.</span><span class="sxs-lookup"><span data-stu-id="a3f81-380">Consider hello example of a large multi-national corporation with tens of thousands of departments and employee entities where every department has many employees and each employee as associated with one specific department.</span></span> <span data-ttu-id="a3f81-381">Uma abordagem é departamento separado toostore e entidades de funcionário como estes:</span><span class="sxs-lookup"><span data-stu-id="a3f81-381">One approach is toostore separate department and employee entities such as these:</span></span>  

![][1]

<span data-ttu-id="a3f81-382">Este exemplo mostra uma relação um-para-muitos implícita entre tipos de saudação com base em Olá **PartitionKey** valor.</span><span class="sxs-lookup"><span data-stu-id="a3f81-382">This example shows an implicit one-to-many relationship between hello types based on hello **PartitionKey** value.</span></span> <span data-ttu-id="a3f81-383">Cada departamento pode ter muitos funcionários.</span><span class="sxs-lookup"><span data-stu-id="a3f81-383">Each department can have many employees.</span></span>  

<span data-ttu-id="a3f81-384">Este exemplo também mostra uma entidade de departamento e suas entidades relacionadas funcionário em Olá mesma partição.</span><span class="sxs-lookup"><span data-stu-id="a3f81-384">This example also shows a department entity and its related employee entities in hello same partition.</span></span> <span data-ttu-id="a3f81-385">Você pode escolher toouse diferentes partições, tabelas ou até mesmo as contas de armazenamento para tipos de entidade diferente de saudação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-385">You could choose toouse different partitions, tables, or even storage accounts for hello different entity types.</span></span>  

<span data-ttu-id="a3f81-386">Uma abordagem alternativa é toodenormalize suas entidades de dados e o repositório de funcionário somente com dados desnormalizados departamento, conforme mostrado no exemplo a seguir de saudação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-386">An alternative approach is toodenormalize your data and store only employee entities with denormalized department data as shown in hello following example.</span></span> <span data-ttu-id="a3f81-387">Neste cenário específico, essa abordagem desnormalizada pode não ser Olá melhor se você tem detalhes Olá requisito toobe toochange capaz de um gerente de departamento porque toodo isso é necessário tooupdate todos os funcionários do departamento de saudação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-387">In this particular scenario, this denormalized approach may not be hello best if you have a requirement toobe able toochange hello details of a department manager because toodo this you need tooupdate every employee in hello department.</span></span>  

![][2]

<span data-ttu-id="a3f81-388">Para obter mais informações, consulte Olá [padrão desnormalização](#denormalization-pattern) posteriormente neste guia.</span><span class="sxs-lookup"><span data-stu-id="a3f81-388">For more information, see hello [Denormalization pattern](#denormalization-pattern) later in this guide.</span></span>  

<span data-ttu-id="a3f81-389">Olá tabela a seguir resume os profissionais de saudação e os contras de cada uma das abordagens Olá descritas acima para armazenar entidades de departamento que têm uma relação um-para-muitos e funcionário.</span><span class="sxs-lookup"><span data-stu-id="a3f81-389">hello following table summarizes hello pros and cons of each of hello approaches outlined above for storing employee and department entities that have a one-to-many relationship.</span></span> <span data-ttu-id="a3f81-390">Você também deve considerar a frequência você espera que tooperform várias operações: pode ser aceitável toohave um design que inclui uma operação cara se essa operação acontece apenas raramente.</span><span class="sxs-lookup"><span data-stu-id="a3f81-390">You should also consider how often you expect tooperform various operations: it may be acceptable toohave a design that includes an expensive operation if that operation only happens infrequently.</span></span>  

<table>
<tr>
<th><span data-ttu-id="a3f81-391">Abordagem</span><span class="sxs-lookup"><span data-stu-id="a3f81-391">Approach</span></span></th>
<th><span data-ttu-id="a3f81-392">Prós</span><span class="sxs-lookup"><span data-stu-id="a3f81-392">Pros</span></span></th>
<th><span data-ttu-id="a3f81-393">Contras</span><span class="sxs-lookup"><span data-stu-id="a3f81-393">Cons</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="a3f81-394">Separar tipos de entidade, mesma partição, mesma tabela</span><span class="sxs-lookup"><span data-stu-id="a3f81-394">Separate entity types, same partition, same table</span></span></td>
<td>
<ul>
<li><span data-ttu-id="a3f81-395">Você pode atualizar uma entidade de departamento com uma única operação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-395">You can update a department entity with a single operation.</span></span></li>
<li><span data-ttu-id="a3f81-396">Você pode usar uma consistência de toomaintain EGT se você tiver um requisito toomodify uma entidade department sempre que você atualizar/insert/excluir uma entidade funcionário.</span><span class="sxs-lookup"><span data-stu-id="a3f81-396">You can use an EGT toomaintain consistency if you have a requirement toomodify a department entity whenever you update/insert/delete an employee entity.</span></span> <span data-ttu-id="a3f81-397">Por exemplo, se você mantiver uma contagem de funcionários do departamento para cada departamento.</span><span class="sxs-lookup"><span data-stu-id="a3f81-397">For example if you maintain a departmental employee count for each department.</span></span></li>
</ul>
</td>
<td>
<ul>
<li><span data-ttu-id="a3f81-398">Talvez seja necessário tooretrieve um funcionário e uma entidade de departamento em algumas atividades do cliente.</span><span class="sxs-lookup"><span data-stu-id="a3f81-398">You may need tooretrieve both an employee and a department entity for some client activities.</span></span></li>
<li><span data-ttu-id="a3f81-399">As operações de armazenamento acontecem em Olá mesmo partição.</span><span class="sxs-lookup"><span data-stu-id="a3f81-399">Storage operations happen in hello same partition.</span></span> <span data-ttu-id="a3f81-400">Em grandes volumes de transações, isso pode resultar em um ponto de acesso.</span><span class="sxs-lookup"><span data-stu-id="a3f81-400">At high transaction volumes, this may result in a hotspot.</span></span></li>
<li><span data-ttu-id="a3f81-401">Você não pode mover um funcionário tooa departamento usando um EGT.</span><span class="sxs-lookup"><span data-stu-id="a3f81-401">You cannot move an employee tooa new department using an EGT.</span></span></li>
</ul>
</td>
</tr>
<tr>
<td><span data-ttu-id="a3f81-402">Tipos de entidade separada, diferentes partições ou tabelas ou contas de armazenamento</span><span class="sxs-lookup"><span data-stu-id="a3f81-402">Separate entity types, different partitions or tables or storage accounts</span></span></td>
<td>
<ul>
<li><span data-ttu-id="a3f81-403">Você pode atualizar uma entidade de departamento ou funcionário com uma única operação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-403">You can update a department entity or employee entity with a single operation.</span></span></li>
<li><span data-ttu-id="a3f81-404">Em grandes volumes de transações, isso pode ajudar a carga de espalhamento hello mais partições.</span><span class="sxs-lookup"><span data-stu-id="a3f81-404">At high transaction volumes, this may help spread hello load across more partitions.</span></span></li>
</ul>
</td>
<td>
<ul>
<li><span data-ttu-id="a3f81-405">Talvez seja necessário tooretrieve um funcionário e uma entidade de departamento em algumas atividades do cliente.</span><span class="sxs-lookup"><span data-stu-id="a3f81-405">You may need tooretrieve both an employee and a department entity for some client activities.</span></span></li>
<li><span data-ttu-id="a3f81-406">Não é possível usar EGTs toomaintain consistência quando você atualização/inserção/exclusão um funcionário e atualização de um departamento.</span><span class="sxs-lookup"><span data-stu-id="a3f81-406">You cannot use EGTs toomaintain consistency when you update/insert/delete an employee and update a department.</span></span> <span data-ttu-id="a3f81-407">Por exemplo, a atualização de uma contagem de funcionários em uma entidade de departamento.</span><span class="sxs-lookup"><span data-stu-id="a3f81-407">For example, updating an employee count in a department entity.</span></span></li>
<li><span data-ttu-id="a3f81-408">Você não pode mover um funcionário tooa departamento usando um EGT.</span><span class="sxs-lookup"><span data-stu-id="a3f81-408">You cannot move an employee tooa new department using an EGT.</span></span></li>
</ul>
</td>
</tr>
<tr>
<td><span data-ttu-id="a3f81-409">Desnormalizar em um único tipo de entidade</span><span class="sxs-lookup"><span data-stu-id="a3f81-409">Denormalize into single entity type</span></span></td>
<td>
<ul>
<li><span data-ttu-id="a3f81-410">Você pode recuperar todas as informações de saudação que necessário com uma única solicitação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-410">You can retrieve all hello information you need with a single request.</span></span></li>
</ul>
</td>
<td>
<ul>
<li><span data-ttu-id="a3f81-411">Pode ser caro toomaintain consistência se você precisar de informações do departamento de tooupdate (Isso exigirá que você tooupdate todos os funcionários de saudação de um departamento).</span><span class="sxs-lookup"><span data-stu-id="a3f81-411">It may be expensive toomaintain consistency if you need tooupdate department information (this would require you tooupdate all hello employees in a department).</span></span></li>
</ul>
</td>
</tr>
</table>

<span data-ttu-id="a3f81-412">Como escolher entre essas opções e que os profissionais de saudação e contras são mais significativas, depende de seus cenários de aplicativo específico.</span><span class="sxs-lookup"><span data-stu-id="a3f81-412">How you choose between these options, and which of hello pros and cons are most significant, depends on your specific application scenarios.</span></span> <span data-ttu-id="a3f81-413">Por exemplo, quantas vezes você modificar entidades departamento; todas as suas consultas de funcionário precisa de informações departamentais adicionais de saudação; como fechar tem limites de escalabilidade toohello em suas partições ou sua conta de armazenamento?</span><span class="sxs-lookup"><span data-stu-id="a3f81-413">For example, how often do you modify department entities; do all your employee queries need hello additional departmental information; how close are you toohello scalability limits on your partitions or your storage account?</span></span>  

### <a name="one-to-one-relationships"></a><span data-ttu-id="a3f81-414">Relações um-para-um</span><span class="sxs-lookup"><span data-stu-id="a3f81-414">One-to-one relationships</span></span>
<span data-ttu-id="a3f81-415">Modelos de domínio podem incluir relações um-para-um entre entidades.</span><span class="sxs-lookup"><span data-stu-id="a3f81-415">Domain models may include one-to-one relationships between entities.</span></span> <span data-ttu-id="a3f81-416">Se você precisar tooimplement uma relação um para um em Olá serviço tabela, você também deve escolher como toolink Olá duas entidades relacionadas, quando você precisar tooretrieve-os.</span><span class="sxs-lookup"><span data-stu-id="a3f81-416">If you need tooimplement a one-to-one relationship in hello Table service, you must also choose how toolink hello two related entities when you need tooretrieve them both.</span></span> <span data-ttu-id="a3f81-417">Esse link pode ser implícita, com base em uma convenção de nos valores de chave hello ou explícita, armazenando um link no formulário de saudação do **PartitionKey** e **RowKey** valores em cada entidade tooits relacionados de entidades.</span><span class="sxs-lookup"><span data-stu-id="a3f81-417">This link can be either implicit, based on a convention in hello key values, or explicit by storing a link in hello form of **PartitionKey** and **RowKey** values in each entity tooits related entity.</span></span> <span data-ttu-id="a3f81-418">Para obter uma discussão de se você deve armazenar Olá entidades relacionadas no hello mesma partição, consulte a seção Olá [um-para-muitos relações](#one-to-many-relationships).</span><span class="sxs-lookup"><span data-stu-id="a3f81-418">For a discussion of whether you should store hello related entities in hello same partition, see hello section [One-to-many relationships](#one-to-many-relationships).</span></span>  

<span data-ttu-id="a3f81-419">Observe que também há considerações de implementação que podem levar relações um para um tooimplement no serviço de tabela hello:</span><span class="sxs-lookup"><span data-stu-id="a3f81-419">Note that there are also implementation considerations that might lead you tooimplement one-to-one relationships in hello Table service:</span></span>  

* <span data-ttu-id="a3f81-420">Controlando grandes entidades (para obter mais informações, consulte [Padrão de grandes entidades](#large-entities-pattern)).</span><span class="sxs-lookup"><span data-stu-id="a3f81-420">Handling large entities (for more information, see [Large Entities Pattern](#large-entities-pattern)).</span></span>  
* <span data-ttu-id="a3f81-421">A implementação de controles de acesso (para saber mais, consulte [Controlando o acesso com assinaturas de acesso compartilhado](#controlling-access-with-shared-access-signatures)).</span><span class="sxs-lookup"><span data-stu-id="a3f81-421">Implementing access controls (for more information, see [Controlling access with Shared Access Signatures](#controlling-access-with-shared-access-signatures)).</span></span>  

### <a name="join-in-hello-client"></a><span data-ttu-id="a3f81-422">Ingressar no cliente Olá</span><span class="sxs-lookup"><span data-stu-id="a3f81-422">Join in hello client</span></span>
<span data-ttu-id="a3f81-423">Embora existam relações de toomodel maneiras na Olá serviço tabela, você deve não se esqueça de que dois motivos principais Olá para usar o serviço de tabela de saudação são escalabilidade e desempenho.</span><span class="sxs-lookup"><span data-stu-id="a3f81-423">Although there are ways toomodel relationships in hello Table service, you should not forget that hello two prime reasons for using hello Table service are scalability and performance.</span></span> <span data-ttu-id="a3f81-424">Se você encontrar que são modelagem muitas relações que comprometer o desempenho de saudação e a escalabilidade de sua solução, você deve se perguntar que se é necessário toobuild todos Olá relações de dados ao seu design de tabela.</span><span class="sxs-lookup"><span data-stu-id="a3f81-424">If you find you are modelling many relationships that compromise hello performance and scalability of your solution, you should ask yourself if it is necessary toobuild all hello data relationships into your table design.</span></span> <span data-ttu-id="a3f81-425">Você pode ser capaz de toosimplify design de saudação e melhorar a escalabilidade de saudação e desempenho de sua solução, se você permitir que o aplicativo cliente executar qualquer junções necessárias.</span><span class="sxs-lookup"><span data-stu-id="a3f81-425">You may be able toosimplify hello design and improve hello scalability and performance of your solution if you let your client application perform any necessary joins.</span></span>  

<span data-ttu-id="a3f81-426">Por exemplo, se você tiver tabelas pequenas que contêm dados que não se altera muita frequência, em seguida, você pode recuperar esses dados uma vez e armazene em cache no cliente de saudação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-426">For example, if you have small tables that contain data that does not change very often, then you can retrieve this data once and cache it on hello client.</span></span> <span data-ttu-id="a3f81-427">Isso pode evitar as idas e voltas repetidas tooretrieve Olá os mesmos dados.</span><span class="sxs-lookup"><span data-stu-id="a3f81-427">This can avoid repeated roundtrips tooretrieve hello same data.</span></span> <span data-ttu-id="a3f81-428">Exemplos de hello, examinamos neste guia, hello conjunto de departamentos em uma pequena empresa está provavelmente toobe pequeno e raramente tornando um bom candidato para dados que o aplicativo cliente pode baixar uma vez e o cache como pesquisar dados de alteração.</span><span class="sxs-lookup"><span data-stu-id="a3f81-428">In hello examples we have looked at in this guide, hello set of departments in a small organization is likely toobe small and change infrequently making it a good candidate for data that client application can download once and cache as look up data.</span></span>  

### <a name="inheritance-relationships"></a><span data-ttu-id="a3f81-429">Relações de herança</span><span class="sxs-lookup"><span data-stu-id="a3f81-429">Inheritance relationships</span></span>
<span data-ttu-id="a3f81-430">Se seu aplicativo cliente usa um conjunto de classes que fazem parte de um entidades de negócios de toorepresent de relação de herança, você pode facilmente persistir as entidades no hello serviço tabela.</span><span class="sxs-lookup"><span data-stu-id="a3f81-430">If your client application uses a set of classes that form part of an inheritance relationship toorepresent business entities, you can easily persist those entities in hello Table service.</span></span> <span data-ttu-id="a3f81-431">Por exemplo, você pode ter Olá após o conjunto de classes definidas em seu aplicativo cliente onde **pessoa** é uma classe abstrata.</span><span class="sxs-lookup"><span data-stu-id="a3f81-431">For example, you might have hello following set of classes defined in your client application where **Person** is an abstract class.</span></span>

![][3]

<span data-ttu-id="a3f81-432">Você pode manter instâncias das duas classes concretas Olá no hello serviço tabela usando uma única tabela pessoa usando entidades em que se parecem com isso:</span><span class="sxs-lookup"><span data-stu-id="a3f81-432">You can persist instances of hello two concrete classes in hello Table service using a single Person table using entities in that look like this:</span></span>  

![][4]

<span data-ttu-id="a3f81-433">Para obter mais informações sobre como trabalhar com vários tipos de entidade Olá mesma tabela no código do cliente, consulte a seção de saudação [trabalhando com tipos de entidade heterogêneos](#working-with-heterogeneous-entity-types) posteriormente neste guia.</span><span class="sxs-lookup"><span data-stu-id="a3f81-433">For more information about working with multiple entity types in hello same table in client code, see hello section [Working with heterogeneous entity types](#working-with-heterogeneous-entity-types) later in this guide.</span></span> <span data-ttu-id="a3f81-434">Isso fornece exemplos de como toorecognize Olá tipo de entidade no código do cliente.</span><span class="sxs-lookup"><span data-stu-id="a3f81-434">This provides examples of how toorecognize hello entity type in client code.</span></span>  

## <a name="table-design-patterns"></a><span data-ttu-id="a3f81-435">Padrões de design de tabela</span><span class="sxs-lookup"><span data-stu-id="a3f81-435">Table Design Patterns</span></span>
<span data-ttu-id="a3f81-436">Nas seções anteriores, você viu alguns discussões detalhadas sobre como toooptimize sua tabela de design para recuperar dados entidade usando consultas e para inserir, atualizar e excluir dados de entidade.</span><span class="sxs-lookup"><span data-stu-id="a3f81-436">In previous sections, you have seen some detailed discussions about how toooptimize your table design for both retrieving entity data using queries and for inserting, updating, and deleting entity data.</span></span> <span data-ttu-id="a3f81-437">Esta seção descreve alguns padrões adequados para uso com soluções de serviço Tabela.</span><span class="sxs-lookup"><span data-stu-id="a3f81-437">This section describes some patterns appropriate for use with Table service solutions.</span></span> <span data-ttu-id="a3f81-438">Além disso, você verá como praticamente abordar alguns dos problemas de saudação e compensações geradas anteriormente neste guia.</span><span class="sxs-lookup"><span data-stu-id="a3f81-438">In addition, you will see how you can practically address some of hello issues and trade-offs raised previously in this guide.</span></span> <span data-ttu-id="a3f81-439">Olá diagrama a seguir resume as relações de saudação entre diferentes padrões de saudação:</span><span class="sxs-lookup"><span data-stu-id="a3f81-439">hello following diagram summarizes hello relationships between hello different patterns:</span></span>  

![][5]

<span data-ttu-id="a3f81-440">mapa de padrão de saudação acima destaca algumas relações entre os padrões (azuis) e os padrões (laranja) são documentados neste guia.</span><span class="sxs-lookup"><span data-stu-id="a3f81-440">hello pattern map above highlights some relationships between patterns (blue) and anti-patterns (orange) that are documented in this guide.</span></span> <span data-ttu-id="a3f81-441">Certamente há muitos outros padrões que vale a pena considerar.</span><span class="sxs-lookup"><span data-stu-id="a3f81-441">There are of course many other patterns that are worth considering.</span></span> <span data-ttu-id="a3f81-442">Por exemplo, um dos principais cenários de saudação de serviço tabela é Olá toouse [padrão de exibição materializada](https://msdn.microsoft.com/library/azure/dn589782.aspx) de saudação [comando consulta responsabilidade CQRS (segregação)](https://msdn.microsoft.com/library/azure/jj554200.aspx) padrão.</span><span class="sxs-lookup"><span data-stu-id="a3f81-442">For example, one of hello key scenarios for Table Service is toouse hello [Materialized View Pattern](https://msdn.microsoft.com/library/azure/dn589782.aspx) from hello [Command Query Responsibility Segregation (CQRS)](https://msdn.microsoft.com/library/azure/jj554200.aspx) pattern.</span></span>  

### <a name="intra-partition-secondary-index-pattern"></a><span data-ttu-id="a3f81-443">Padrão de índice secundário intrapartição</span><span class="sxs-lookup"><span data-stu-id="a3f81-443">Intra-partition secondary index pattern</span></span>
<span data-ttu-id="a3f81-444">Armazenar várias cópias de cada entidade usando diferentes **RowKey** valores (em Olá mesma partição) tooenable rápida e eficiente pesquisas e classificação alternativo ordena usando diferentes **RowKey** valores.</span><span class="sxs-lookup"><span data-stu-id="a3f81-444">Store multiple copies of each entity using different **RowKey** values (in hello same partition) tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span> <span data-ttu-id="a3f81-445">Atualizações entre as cópias podem ser mantidas consistentes usando EGTs.</span><span class="sxs-lookup"><span data-stu-id="a3f81-445">Updates between copies can be kept consistent using EGT's.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="a3f81-446">Contexto e problema</span><span class="sxs-lookup"><span data-stu-id="a3f81-446">Context and problem</span></span>
<span data-ttu-id="a3f81-447">Olá serviço tabela indexa automaticamente entidades usando Olá **PartitionKey** e **RowKey** valores.</span><span class="sxs-lookup"><span data-stu-id="a3f81-447">hello Table service automatically indexes entities using hello **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="a3f81-448">Isso permite que um tooretrieve de aplicativo do cliente uma entidade com eficiência usando esses valores.</span><span class="sxs-lookup"><span data-stu-id="a3f81-448">This enables a client application tooretrieve an entity efficiently using these values.</span></span> <span data-ttu-id="a3f81-449">Por exemplo, usando a estrutura da tabela Olá mostrada abaixo, um aplicativo cliente pode usar uma consulta de ponto tooretrieve uma entidade funcionário individual usando o nome do departamento hello e id de funcionário hello (Olá **PartitionKey** e  **RowKey** valores).</span><span class="sxs-lookup"><span data-stu-id="a3f81-449">For example, using hello table structure shown below, a client application can use a point query tooretrieve an individual employee entity by using hello department name and hello employee id (hello **PartitionKey** and **RowKey** values).</span></span> <span data-ttu-id="a3f81-450">Um cliente também pode recuperar entidades classificadas por ID de funcionário dentro de cada departamento.</span><span class="sxs-lookup"><span data-stu-id="a3f81-450">A client can also retrieve entities sorted by employee id within each department.</span></span>

![][6]

<span data-ttu-id="a3f81-451">Se você deseja toobe capaz de toofind uma entidade funcionário com base no valor de saudação de outra propriedade, como endereço de email, você deve usar um toofind de verificação de partição uma correspondência menos eficiente.</span><span class="sxs-lookup"><span data-stu-id="a3f81-451">If you also want toobe able toofind an employee entity based on hello value of another property, such as email address, you must use a less efficient partition scan toofind a match.</span></span> <span data-ttu-id="a3f81-452">Isso ocorre porque o serviço de tabela de saudação não fornece índices secundários.</span><span class="sxs-lookup"><span data-stu-id="a3f81-452">This is because hello table service does not provide secondary indexes.</span></span> <span data-ttu-id="a3f81-453">Além disso, não há nenhuma opção toorequest uma lista de funcionários classificados em uma ordem diferente daquela **RowKey** ordem.</span><span class="sxs-lookup"><span data-stu-id="a3f81-453">In addition, there is no option toorequest a list of employees sorted in a different order than **RowKey** order.</span></span>  

#### <a name="solution"></a><span data-ttu-id="a3f81-454">Solução</span><span class="sxs-lookup"><span data-stu-id="a3f81-454">Solution</span></span>
<span data-ttu-id="a3f81-455">toowork em torno de falta de saudação de índices secundários, você pode armazenar várias cópias de cada entidade com cada cópia usando outro **RowKey** valor.</span><span class="sxs-lookup"><span data-stu-id="a3f81-455">toowork around hello lack of secondary indexes, you can store multiple copies of each entity with each copy using a different **RowKey** value.</span></span> <span data-ttu-id="a3f81-456">Se você armazenar uma entidade com estruturas de saudação mostradas abaixo, você pode recuperar com eficiência entidades de funcionário com base na id de funcionário ou de endereço de email. Olá valores de prefixo de saudação **RowKey**, "empid_" e "email_" permitem que você tooquery para um único funcionário ou um intervalo de funcionários por meio de um intervalo de endereços de email ou ids de funcionário.</span><span class="sxs-lookup"><span data-stu-id="a3f81-456">If you store an entity with hello structures shown below, you can efficiently retrieve employee entities based on email address or employee id. hello prefix values for hello **RowKey**, "empid_" and "email_" enable you tooquery for a single employee or a range of employees by using a range of email addresses or employee ids.</span></span>  

![][7]

<span data-ttu-id="a3f81-457">Olá dois critérios de filtro (um pesquisar por id de funcionário e um pesquisar por endereço de email) a seguir especifica consultas:</span><span class="sxs-lookup"><span data-stu-id="a3f81-457">hello following two filter criteria (one looking up by employee id and one looking up by email address) both specify point queries:</span></span>  

* <span data-ttu-id="a3f81-458">$filter=(PartitionKey eq 'Sales') and (RowKey eq 'empid_000223')</span><span class="sxs-lookup"><span data-stu-id="a3f81-458">$filter=(PartitionKey eq 'Sales') and (RowKey eq 'empid_000223')</span></span>  
* <span data-ttu-id="a3f81-459">$filter=(PartitionKey eq 'Sales') e (RowKey eq 'email_jonesj@contoso.com')</span><span class="sxs-lookup"><span data-stu-id="a3f81-459">$filter=(PartitionKey eq 'Sales') and (RowKey eq 'email_jonesj@contoso.com')</span></span>  

<span data-ttu-id="a3f81-460">Se você consultar um intervalo de entidades de funcionário, você pode especificar um intervalo classificados em ordem de id de funcionário, ou um intervalo classificados em ordem de endereço de email por meio de consulta para entidades com o prefixo apropriado de saudação em hello **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="a3f81-460">If you query for a range of employee entities, you can specify a range sorted in employee id order, or a range sorted in email address order by querying for entities with hello appropriate prefix in hello **RowKey**.</span></span>  

* <span data-ttu-id="a3f81-461">usam de todos os funcionários de Olá Olá departamento de vendas com uma id de funcionário Olá intervalo 000100 too000199 toofind: $filter = (PartitionKey eq 'Vendas') e (RowKey ge 'empid_000100') e (RowKey le 'empid_000199')</span><span class="sxs-lookup"><span data-stu-id="a3f81-461">toofind all hello employees in hello Sales department with an employee id in hello range 000100 too000199 use: $filter=(PartitionKey eq 'Sales') and (RowKey ge 'empid_000100') and (RowKey le 'empid_000199')</span></span>  
* <span data-ttu-id="a3f81-462">toofind todos Olá funcionários do departamento de vendas de saudação com um endereço de email a partir Olá letra 'a' uso: $filter = (PartitionKey eq 'Vendas') e (RowKey ge 'email_a') e (RowKey lt 'email_b')</span><span class="sxs-lookup"><span data-stu-id="a3f81-462">toofind all hello employees in hello Sales department with an email address starting with hello letter 'a' use: $filter=(PartitionKey eq 'Sales') and (RowKey ge 'email_a') and (RowKey lt 'email_b')</span></span>  
  
  <span data-ttu-id="a3f81-463">Observe que a sintaxe do filtro Olá usada nos exemplos de saudação acima é saudação do serviço tabela API REST, para obter mais informações, consulte [consultar entidades](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span><span class="sxs-lookup"><span data-stu-id="a3f81-463">Note that hello filter syntax used in hello examples above is from hello Table service REST API, for more information see [Query Entities](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="a3f81-464">Problemas e considerações</span><span class="sxs-lookup"><span data-stu-id="a3f81-464">Issues and considerations</span></span>
<span data-ttu-id="a3f81-465">Considere Olá pontos a seguir ao decidir como tooimplement esse padrão:</span><span class="sxs-lookup"><span data-stu-id="a3f81-465">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="a3f81-466">Armazenamento de tabela é relativamente barata toouse Olá custo sobrecarga de armazenamento de dados duplicados não deve ser a principal preocupação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-466">Table storage is relatively cheap toouse so hello cost overhead of storing duplicate data should not be a major concern.</span></span> <span data-ttu-id="a3f81-467">No entanto, você deve sempre avalie o custo de saudação do seu design com base nas necessidades de armazenamento previstas e somente adicionar consultas de saudação toosupport entidades duplicadas que executará seu aplicativo cliente.</span><span class="sxs-lookup"><span data-stu-id="a3f81-467">However, you should always evaluate hello cost of your design based on your anticipated storage requirements and only add duplicate entities toosupport hello queries your client application will execute.</span></span>  
* <span data-ttu-id="a3f81-468">Como entidades de índice secundário Olá são armazenadas em Olá mesma partição como entidades original hello, certifique-se de que você não exceda os destinos de escalabilidade Olá para uma partição específica.</span><span class="sxs-lookup"><span data-stu-id="a3f81-468">Because hello secondary index entities are stored in hello same partition as hello original entities, you should ensure that you do not exceed hello scalability targets for an individual partition.</span></span>  
* <span data-ttu-id="a3f81-469">Você pode manter suas entidades duplicadas consistentes entre si usando EGTs tooupdate Olá duas cópias da entidade Olá atomicamente.</span><span class="sxs-lookup"><span data-stu-id="a3f81-469">You can keep your duplicate entities consistent with each other by using EGTs tooupdate hello two copies of hello entity atomically.</span></span> <span data-ttu-id="a3f81-470">Isso implica que você deve armazenar todas as cópias de uma entidade em Olá mesma partição.</span><span class="sxs-lookup"><span data-stu-id="a3f81-470">This implies that you should store all copies of an entity in hello same partition.</span></span> <span data-ttu-id="a3f81-471">Para obter mais informações, consulte a seção de saudação [usando transações de grupo de entidade](#entity-group-transactions).</span><span class="sxs-lookup"><span data-stu-id="a3f81-471">For more information, see hello section [Using Entity Group Transactions](#entity-group-transactions).</span></span>  
* <span data-ttu-id="a3f81-472">Olá valor usado para Olá **RowKey** devem ser exclusivos para cada entidade.</span><span class="sxs-lookup"><span data-stu-id="a3f81-472">hello value used for hello **RowKey** must be unique for each entity.</span></span> <span data-ttu-id="a3f81-473">Considere o uso de valores de chave composta.</span><span class="sxs-lookup"><span data-stu-id="a3f81-473">Consider using compound key values.</span></span>  
* <span data-ttu-id="a3f81-474">Preenchimento de valores numéricos em Olá **RowKey** (por exemplo, id de funcionário Olá 000223), permite corrigir a classificação e filtragem de limites com base em superiores e inferiores.</span><span class="sxs-lookup"><span data-stu-id="a3f81-474">Padding numeric values in hello **RowKey** (for example, hello employee id 000223), enables correct sorting and filtering based on upper and lower bounds.</span></span>  
* <span data-ttu-id="a3f81-475">Não é necessariamente necessário tooduplicate todas as propriedades de saudação da entidade.</span><span class="sxs-lookup"><span data-stu-id="a3f81-475">You do not necessarily need tooduplicate all hello properties of your entity.</span></span> <span data-ttu-id="a3f81-476">Por exemplo, se hello consultas entidades de saudação de pesquisa usando Olá email endereços em Olá **RowKey** nunca precisam ter a idade do funcionário hello, essas entidades podem ter Olá estrutura a seguir:</span><span class="sxs-lookup"><span data-stu-id="a3f81-476">For example, if hello queries that lookup hello entities using hello email address in hello **RowKey** never need hello employee's age, these entities could have hello following structure:</span></span>

![][8]

* <span data-ttu-id="a3f81-477">Ele é normalmente melhor toostore os dados duplicados e certifique-se de que você pode recuperar todos os dados de saudação necessário com uma única consulta, que toouse uma consulta toolocate uma entidade e outra saudação de toolookup necessários dados.</span><span class="sxs-lookup"><span data-stu-id="a3f81-477">It is typically better toostore duplicate data and ensure that you can retrieve all hello data you need with a single query, than toouse one query toolocate an entity and another toolookup hello required data.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="a3f81-478">Quando toouse esse padrão</span><span class="sxs-lookup"><span data-stu-id="a3f81-478">When toouse this pattern</span></span>
<span data-ttu-id="a3f81-479">Use esse padrão quando seu aplicativo cliente precisa tooretrieve entidades usando uma variedade de diferentes chaves, quando o cliente precisa tooretrieve entidades diferentes ordens de classificação e onde você pode identificar cada entidade usando uma variedade de valores exclusivos.</span><span class="sxs-lookup"><span data-stu-id="a3f81-479">Use this pattern when your client application needs tooretrieve entities using a variety of different keys, when your client needs tooretrieve entities in different sort orders, and where you can identify each entity using a variety of unique values.</span></span> <span data-ttu-id="a3f81-480">No entanto, você deve ter certeza de não exceder os limites de escalabilidade de partição Olá durante a execução de pesquisas de entidade usando Olá diferente **RowKey** valores.</span><span class="sxs-lookup"><span data-stu-id="a3f81-480">However, you should be sure that you do not exceed hello partition scalability limits when you are performing entity lookups using hello different **RowKey** values.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="a3f81-481">Diretrizes e padrões relacionados</span><span class="sxs-lookup"><span data-stu-id="a3f81-481">Related patterns and guidance</span></span>
<span data-ttu-id="a3f81-482">Olá padrões e diretrizes a seguir também podem ser relevantes ao implementar esse padrão:</span><span class="sxs-lookup"><span data-stu-id="a3f81-482">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="a3f81-483">Padrão de índice secundário entre partições</span><span class="sxs-lookup"><span data-stu-id="a3f81-483">Inter-partition secondary index pattern</span></span>](#inter-partition-secondary-index-pattern)
* [<span data-ttu-id="a3f81-484">Padrão de chave composta</span><span class="sxs-lookup"><span data-stu-id="a3f81-484">Compound key pattern</span></span>](#compound-key-pattern)
* [<span data-ttu-id="a3f81-485">Transações do Grupo de Entidades</span><span class="sxs-lookup"><span data-stu-id="a3f81-485">Entity Group Transactions</span></span>](#entity-group-transactions)
* [<span data-ttu-id="a3f81-486">Trabalhando com tipos de entidade heterogênea</span><span class="sxs-lookup"><span data-stu-id="a3f81-486">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)

### <a name="inter-partition-secondary-index-pattern"></a><span data-ttu-id="a3f81-487">Padrão de índice secundário entre partições</span><span class="sxs-lookup"><span data-stu-id="a3f81-487">Inter-partition secondary index pattern</span></span>
<span data-ttu-id="a3f81-488">Armazenar várias cópias de cada entidade usando diferentes **RowKey** valores em partições separadas ou em tabelas separadas tooenable rápida e eficiente pesquisas e ordens de classificação alternativa usando diferentes **RowKey**valores.</span><span class="sxs-lookup"><span data-stu-id="a3f81-488">Store multiple copies of each entity using different **RowKey** values in separate partitions or in separate tables tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="a3f81-489">Contexto e problema</span><span class="sxs-lookup"><span data-stu-id="a3f81-489">Context and problem</span></span>
<span data-ttu-id="a3f81-490">Olá serviço tabela indexa automaticamente entidades usando Olá **PartitionKey** e **RowKey** valores.</span><span class="sxs-lookup"><span data-stu-id="a3f81-490">hello Table service automatically indexes entities using hello **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="a3f81-491">Isso permite que um tooretrieve de aplicativo do cliente uma entidade com eficiência usando esses valores.</span><span class="sxs-lookup"><span data-stu-id="a3f81-491">This enables a client application tooretrieve an entity efficiently using these values.</span></span> <span data-ttu-id="a3f81-492">Por exemplo, usando a estrutura da tabela Olá mostrada abaixo, um aplicativo cliente pode usar uma consulta de ponto tooretrieve uma entidade funcionário individual usando o nome do departamento hello e id de funcionário hello (Olá **PartitionKey** e  **RowKey** valores).</span><span class="sxs-lookup"><span data-stu-id="a3f81-492">For example, using hello table structure shown below, a client application can use a point query tooretrieve an individual employee entity by using hello department name and hello employee id (hello **PartitionKey** and **RowKey** values).</span></span> <span data-ttu-id="a3f81-493">Um cliente também pode recuperar entidades classificadas por ID de funcionário dentro de cada departamento.</span><span class="sxs-lookup"><span data-stu-id="a3f81-493">A client can also retrieve entities sorted by employee id within each department.</span></span>  

![][9]

<span data-ttu-id="a3f81-494">Se você deseja toobe capaz de toofind uma entidade funcionário com base no valor de saudação de outra propriedade, como endereço de email, você deve usar um toofind de verificação de partição uma correspondência menos eficiente.</span><span class="sxs-lookup"><span data-stu-id="a3f81-494">If you also want toobe able toofind an employee entity based on hello value of another property, such as email address, you must use a less efficient partition scan toofind a match.</span></span> <span data-ttu-id="a3f81-495">Isso ocorre porque o serviço de tabela de saudação não fornece índices secundários.</span><span class="sxs-lookup"><span data-stu-id="a3f81-495">This is because hello table service does not provide secondary indexes.</span></span> <span data-ttu-id="a3f81-496">Além disso, não há nenhuma opção toorequest uma lista de funcionários classificados em uma ordem diferente daquela **RowKey** ordem.</span><span class="sxs-lookup"><span data-stu-id="a3f81-496">In addition, there is no option toorequest a list of employees sorted in a different order than **RowKey** order.</span></span>  

<span data-ttu-id="a3f81-497">Você está prevendo um volume muito alto de transações em relação a essas entidades e deseja toominimize risco de saudação do hello limitação seu cliente de serviço de tabela.</span><span class="sxs-lookup"><span data-stu-id="a3f81-497">You are anticipating a very high volume of transactions against these entities and want toominimize hello risk of hello Table service throttling your client.</span></span>  

#### <a name="solution"></a><span data-ttu-id="a3f81-498">Solução</span><span class="sxs-lookup"><span data-stu-id="a3f81-498">Solution</span></span>
<span data-ttu-id="a3f81-499">toowork em torno de falta de saudação de índices secundários, você pode armazenar várias cópias de cada entidade com cada cópia usando diferentes **PartitionKey** e **RowKey** valores.</span><span class="sxs-lookup"><span data-stu-id="a3f81-499">toowork around hello lack of secondary indexes, you can store multiple copies of each entity with each copy using different **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="a3f81-500">Se você armazenar uma entidade com estruturas de saudação mostradas abaixo, você pode recuperar com eficiência entidades de funcionário com base na id de funcionário ou de endereço de email. Olá valores de prefixo de saudação **PartitionKey**, "empid_" e "email_" permitem que você tooidentify que o índice que você deseja toouse para uma consulta.</span><span class="sxs-lookup"><span data-stu-id="a3f81-500">If you store an entity with hello structures shown below, you can efficiently retrieve employee entities based on email address or employee id. hello prefix values for hello **PartitionKey**, "empid_" and "email_" enable you tooidentify which index you want toouse for a query.</span></span>  

![][10]

<span data-ttu-id="a3f81-501">Olá dois critérios de filtro (um pesquisar por id de funcionário e um pesquisar por endereço de email) a seguir especifica consultas:</span><span class="sxs-lookup"><span data-stu-id="a3f81-501">hello following two filter criteria (one looking up by employee id and one looking up by email address) both specify point queries:</span></span>  

* <span data-ttu-id="a3f81-502">$filter=(PartitionKey eq 'empid_Sales') and (RowKey eq '000223')</span><span class="sxs-lookup"><span data-stu-id="a3f81-502">$filter=(PartitionKey eq 'empid_Sales') and (RowKey eq '000223')</span></span>
* <span data-ttu-id="a3f81-503">$filter=(PartitionKey eq 'email_Sales') e (RowKey eq 'jonesj@contoso.com')</span><span class="sxs-lookup"><span data-stu-id="a3f81-503">$filter=(PartitionKey eq 'email_Sales') and (RowKey eq 'jonesj@contoso.com')</span></span>  

<span data-ttu-id="a3f81-504">Se você consultar um intervalo de entidades de funcionário, você pode especificar um intervalo classificados em ordem de id de funcionário, ou um intervalo classificados em ordem de endereço de email por meio de consulta para entidades com o prefixo apropriado de saudação em hello **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="a3f81-504">If you query for a range of employee entities, you can specify a range sorted in employee id order, or a range sorted in email address order by querying for entities with hello appropriate prefix in hello **RowKey**.</span></span>  

* <span data-ttu-id="a3f81-505">toofind todos Olá funcionários Olá departamento de vendas com uma id de funcionário no intervalo de saudação **000100** muito**000199** classificados no uso de ordem de id de funcionário: $filter = (PartitionKey eq ' empid_Sales') e (RowKey ge ' 000100') e (RowKey le '000199')</span><span class="sxs-lookup"><span data-stu-id="a3f81-505">toofind all hello employees in hello Sales department with an employee id in hello range **000100** too**000199** sorted in employee id order use: $filter=(PartitionKey eq 'empid_Sales') and (RowKey ge '000100') and (RowKey le '000199')</span></span>  
* <span data-ttu-id="a3f81-506">toofind todos os funcionários Olá Olá departamento de vendas com um endereço de email que começa com 'a' classificado no uso de ordem de endereço de email: $filter = (PartitionKey eq ' email_Sales') e (RowKey ge 'a') e (RowKey lt 'b')</span><span class="sxs-lookup"><span data-stu-id="a3f81-506">toofind all hello employees in hello Sales department with an email address that starts with 'a' sorted in email address order use: $filter=(PartitionKey eq 'email_Sales') and (RowKey ge 'a') and (RowKey lt 'b')</span></span>  

<span data-ttu-id="a3f81-507">Observe que a sintaxe do filtro Olá usada nos exemplos de saudação acima é saudação do serviço tabela API REST, para obter mais informações, consulte [consultar entidades](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span><span class="sxs-lookup"><span data-stu-id="a3f81-507">Note that hello filter syntax used in hello examples above is from hello Table service REST API, for more information see [Query Entities](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="a3f81-508">Problemas e considerações</span><span class="sxs-lookup"><span data-stu-id="a3f81-508">Issues and considerations</span></span>
<span data-ttu-id="a3f81-509">Considere Olá pontos a seguir ao decidir como tooimplement esse padrão:</span><span class="sxs-lookup"><span data-stu-id="a3f81-509">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="a3f81-510">Você pode manter suas entidades duplicadas eventualmente consistentes entre si usando Olá [padrão de transações finalmente consistente](#eventually-consistent-transactions-pattern) entidades do toomaintain Olá índice primário e secundário.</span><span class="sxs-lookup"><span data-stu-id="a3f81-510">You can keep your duplicate entities eventually consistent with each other by using hello [Eventually consistent transactions pattern](#eventually-consistent-transactions-pattern) toomaintain hello primary and secondary index entities.</span></span>  
* <span data-ttu-id="a3f81-511">Armazenamento de tabela é relativamente barata toouse Olá custo sobrecarga de armazenamento de dados duplicados não deve ser a principal preocupação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-511">Table storage is relatively cheap toouse so hello cost overhead of storing duplicate data should not be a major concern.</span></span> <span data-ttu-id="a3f81-512">No entanto, você deve sempre avalie o custo de saudação do seu design com base nas necessidades de armazenamento previstas e somente adicionar consultas de saudação toosupport entidades duplicadas que executará seu aplicativo cliente.</span><span class="sxs-lookup"><span data-stu-id="a3f81-512">However, you should always evaluate hello cost of your design based on your anticipated storage requirements and only add duplicate entities toosupport hello queries your client application will execute.</span></span>  
* <span data-ttu-id="a3f81-513">Olá valor usado para Olá **RowKey** devem ser exclusivos para cada entidade.</span><span class="sxs-lookup"><span data-stu-id="a3f81-513">hello value used for hello **RowKey** must be unique for each entity.</span></span> <span data-ttu-id="a3f81-514">Considere o uso de valores de chave composta.</span><span class="sxs-lookup"><span data-stu-id="a3f81-514">Consider using compound key values.</span></span>  
* <span data-ttu-id="a3f81-515">Preenchimento de valores numéricos em Olá **RowKey** (por exemplo, id de funcionário Olá 000223), permite corrigir a classificação e filtragem de limites com base em superiores e inferiores.</span><span class="sxs-lookup"><span data-stu-id="a3f81-515">Padding numeric values in hello **RowKey** (for example, hello employee id 000223), enables correct sorting and filtering based on upper and lower bounds.</span></span>  
* <span data-ttu-id="a3f81-516">Não é necessariamente necessário tooduplicate todas as propriedades de saudação da entidade.</span><span class="sxs-lookup"><span data-stu-id="a3f81-516">You do not necessarily need tooduplicate all hello properties of your entity.</span></span> <span data-ttu-id="a3f81-517">Por exemplo, se hello consultas entidades de saudação de pesquisa usando Olá email endereços em Olá **RowKey** nunca precisam ter a idade do funcionário hello, essas entidades podem ter Olá estrutura a seguir:</span><span class="sxs-lookup"><span data-stu-id="a3f81-517">For example, if hello queries that lookup hello entities using hello email address in hello **RowKey** never need hello employee's age, these entities could have hello following structure:</span></span>
  
  ![][11]
* <span data-ttu-id="a3f81-518">É normalmente melhor dados duplicados toostore e certifique-se de que você pode recuperar todos os dados de saudação que necessário com uma única consulta de toouse toolocate de uma consulta usando uma entidade Olá índice secundário e outro toolookup Olá dados necessários no índice primário hello.</span><span class="sxs-lookup"><span data-stu-id="a3f81-518">It is typically better toostore duplicate data and ensure that you can retrieve all hello data you need with a single query than toouse one query toolocate an entity using hello secondary index and another toolookup hello required data in hello primary index.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="a3f81-519">Quando toouse esse padrão</span><span class="sxs-lookup"><span data-stu-id="a3f81-519">When toouse this pattern</span></span>
<span data-ttu-id="a3f81-520">Use esse padrão quando seu aplicativo cliente precisa tooretrieve entidades usando uma variedade de diferentes chaves, quando o cliente precisa tooretrieve entidades diferentes ordens de classificação e onde você pode identificar cada entidade usando uma variedade de valores exclusivos.</span><span class="sxs-lookup"><span data-stu-id="a3f81-520">Use this pattern when your client application needs tooretrieve entities using a variety of different keys, when your client needs tooretrieve entities in different sort orders, and where you can identify each entity using a variety of unique values.</span></span> <span data-ttu-id="a3f81-521">Use esse padrão quando você quiser tooavoid exceder os limites de escalabilidade de partição hello quando você estiver executando pesquisas de entidade usando Olá diferente **RowKey** valores.</span><span class="sxs-lookup"><span data-stu-id="a3f81-521">Use this pattern when you want tooavoid exceeding hello partition scalability limits when you are performing entity lookups using hello different **RowKey** values.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="a3f81-522">Diretrizes e padrões relacionados</span><span class="sxs-lookup"><span data-stu-id="a3f81-522">Related patterns and guidance</span></span>
<span data-ttu-id="a3f81-523">Olá padrões e diretrizes a seguir também podem ser relevantes ao implementar esse padrão:</span><span class="sxs-lookup"><span data-stu-id="a3f81-523">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="a3f81-524">Padrão de transações eventualmente consistentes</span><span class="sxs-lookup"><span data-stu-id="a3f81-524">Eventually consistent transactions pattern</span></span>](#eventually-consistent-transactions-pattern)  
* [<span data-ttu-id="a3f81-525">Padrão de índice secundário intrapartição</span><span class="sxs-lookup"><span data-stu-id="a3f81-525">Intra-partition secondary index pattern</span></span>](#intra-partition-secondary-index-pattern)  
* [<span data-ttu-id="a3f81-526">Padrão de chave composta</span><span class="sxs-lookup"><span data-stu-id="a3f81-526">Compound key pattern</span></span>](#compound-key-pattern)  
* [<span data-ttu-id="a3f81-527">Transações do Grupo de Entidades</span><span class="sxs-lookup"><span data-stu-id="a3f81-527">Entity Group Transactions</span></span>](#entity-group-transactions)  
* [<span data-ttu-id="a3f81-528">Trabalhando com tipos de entidade heterogênea</span><span class="sxs-lookup"><span data-stu-id="a3f81-528">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)  

### <a name="eventually-consistent-transactions-pattern"></a><span data-ttu-id="a3f81-529">Padrão de transações eventualmente consistentes</span><span class="sxs-lookup"><span data-stu-id="a3f81-529">Eventually consistent transactions pattern</span></span>
<span data-ttu-id="a3f81-530">Habilite comportamento eventualmente consistente entre limites de partição ou limites do sistema de armazenamento usando filas do Azure.</span><span class="sxs-lookup"><span data-stu-id="a3f81-530">Enable eventually consistent behavior across partition boundaries or storage system boundaries by using Azure queues.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="a3f81-531">Contexto e problema</span><span class="sxs-lookup"><span data-stu-id="a3f81-531">Context and problem</span></span>
<span data-ttu-id="a3f81-532">EGTs habilitar transações atômicas entre várias entidades que compartilham Olá mesma chave de partição.</span><span class="sxs-lookup"><span data-stu-id="a3f81-532">EGTs enable atomic transactions across multiple entities that share hello same partition key.</span></span> <span data-ttu-id="a3f81-533">Por motivos de escalabilidade e desempenho, você pode decidir toostore entidades que têm requisitos de consistência em partições separadas ou em um sistema de armazenamento separado: nesse cenário, você não pode usar EGTs toomaintain consistência.</span><span class="sxs-lookup"><span data-stu-id="a3f81-533">For performance and scalability reasons, you might decide toostore entities that have consistency requirements in separate partitions or in a separate storage system: in such a scenario, you cannot use EGTs toomaintain consistency.</span></span> <span data-ttu-id="a3f81-534">Por exemplo, você pode ter uma consistência eventual do requisito toomaintain entre:</span><span class="sxs-lookup"><span data-stu-id="a3f81-534">For example, you might have a requirement toomaintain eventual consistency between:</span></span>  

* <span data-ttu-id="a3f81-535">Entidades armazenadas em duas partições diferentes na mesma tabela, em tabelas diferentes, em diferentes contas de armazenamento de saudação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-535">Entities stored in two different partitions in hello same table, in different tables, in in different storage accounts.</span></span>  
* <span data-ttu-id="a3f81-536">Uma entidade armazenado no hello serviço tabela e um blob armazenado no serviço Blob da saudação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-536">An entity stored in hello Table service and a blob stored in hello Blob service.</span></span>  
* <span data-ttu-id="a3f81-537">Uma entidade armazenada no serviço de tabela hello e um arquivo em um sistema de arquivos.</span><span class="sxs-lookup"><span data-stu-id="a3f81-537">An entity stored in hello Table service and a file in a file system.</span></span>  
* <span data-ttu-id="a3f81-538">Uma entidade armazenar em Olá serviço tabela ainda indexadas usando o serviço de pesquisa do Azure hello.</span><span class="sxs-lookup"><span data-stu-id="a3f81-538">An entity store in hello Table service yet indexed using hello Azure Search service.</span></span>  

#### <a name="solution"></a><span data-ttu-id="a3f81-539">Solução</span><span class="sxs-lookup"><span data-stu-id="a3f81-539">Solution</span></span>
<span data-ttu-id="a3f81-540">Ao usar as filas do Azure, você pode implementar uma solução que fornece consistência eventual em duas ou mais partições ou sistemas de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="a3f81-540">By using Azure queues, you can implement a solution that delivers eventual consistency across two or more partitions or storage systems.</span></span>
<span data-ttu-id="a3f81-541">tooillustrate essa abordagem, suponha que você tiver um requisito toobe tooarchive capaz antigo funcionário entidades.</span><span class="sxs-lookup"><span data-stu-id="a3f81-541">tooillustrate this approach, assume you have a requirement toobe able tooarchive old employee entities.</span></span> <span data-ttu-id="a3f81-542">Entidades antigas de funcionário raramente são consultadas e devem ser excluídas de todas as atividades que lidam com funcionários atuais.</span><span class="sxs-lookup"><span data-stu-id="a3f81-542">Old employee entities are rarely queried and should be excluded from any activities that deal with current employees.</span></span> <span data-ttu-id="a3f81-543">tooimplement esse requisito é armazenar funcionários ativos em Olá **atual** tabela e funcionários antigos Olá **arquivamento** tabela.</span><span class="sxs-lookup"><span data-stu-id="a3f81-543">tooimplement this requirement you store active employees in hello **Current** table and old employees in hello **Archive** table.</span></span> <span data-ttu-id="a3f81-544">Arquivamento de um funcionário requer toodelete entidade de saudação do hello **atual** de tabela e adicionar Olá entidade toohello **arquivamento** tabela, mas você não pode usar um tooperform EGT essas duas operações.</span><span class="sxs-lookup"><span data-stu-id="a3f81-544">Archiving an employee requires you toodelete hello entity from hello **Current** table and add hello entity toohello **Archive** table, but you cannot use an EGT tooperform these two operations.</span></span> <span data-ttu-id="a3f81-545">o risco de saudação tooavoid que uma falha faz com que uma entidade tooappear nas tabelas de ambos ou nenhum, operação do arquivo hello deve ser finalmente consistente.</span><span class="sxs-lookup"><span data-stu-id="a3f81-545">tooavoid hello risk that a failure causes an entity tooappear in both or neither tables, hello archive operation must be eventually consistent.</span></span> <span data-ttu-id="a3f81-546">Hello diagrama sequência a seguir descreve as etapas de saudação nesta operação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-546">hello following sequence diagram outlines hello steps in this operation.</span></span> <span data-ttu-id="a3f81-547">Mais detalhes são fornecidos para caminhos de exceção no texto a seguir hello.</span><span class="sxs-lookup"><span data-stu-id="a3f81-547">More detail is provided for exception paths in hello text following.</span></span>  

![][12]

<span data-ttu-id="a3f81-548">Um cliente inicia a operação de arquivo morto de saudação colocando uma mensagem em uma fila do Azure, em que o funcionário do exemplo tooarchive #456.</span><span class="sxs-lookup"><span data-stu-id="a3f81-548">A client initiates hello archive operation by placing a message on an Azure queue, in this example tooarchive employee #456.</span></span> <span data-ttu-id="a3f81-549">Uma função de trabalho pesquisa a fila de saudação novas mensagens; Quando encontrar um, ele lê a mensagem de saudação e deixa uma cópia oculta na fila de saudação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-549">A worker role polls hello queue for new messages; when it finds one, it reads hello message and leaves a hidden copy on hello queue.</span></span> <span data-ttu-id="a3f81-550">função de trabalho Olá próxima busca uma cópia da entidade de saudação do hello **atual** da tabela, insere uma cópia da saudação **arquivamento** tabela e, em seguida, exclui Olá original da saudação **atual**tabela.</span><span class="sxs-lookup"><span data-stu-id="a3f81-550">hello worker role next fetches a copy of hello entity from hello **Current** table, inserts a copy in hello **Archive** table, and then deletes hello original from hello **Current** table.</span></span> <span data-ttu-id="a3f81-551">Por fim, se não houver erros de etapas anteriores Olá, função de trabalho Olá exclui mensagem oculta Olá da fila de saudação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-551">Finally, if there were no errors from hello previous steps, hello worker role deletes hello hidden message from hello queue.</span></span>  

<span data-ttu-id="a3f81-552">Neste exemplo, a etapa 4 insere funcionário Olá Olá **arquivamento** tabela.</span><span class="sxs-lookup"><span data-stu-id="a3f81-552">In this example, step 4 inserts hello employee into hello **Archive** table.</span></span> <span data-ttu-id="a3f81-553">Ela pode adicionar tooa blob funcionário Olá Olá serviço Blob ou um arquivo em um sistema de arquivos.</span><span class="sxs-lookup"><span data-stu-id="a3f81-553">It could add hello employee tooa blob in hello Blob service or a file in a file system.</span></span>  

#### <a name="recovering-from-failures"></a><span data-ttu-id="a3f81-554">Recuperando de falhas</span><span class="sxs-lookup"><span data-stu-id="a3f81-554">Recovering from failures</span></span>
<span data-ttu-id="a3f81-555">É importante que Olá operações nas etapas **4** e **5** devem ser *idempotente* no caso de função de trabalho Olá precisa de operação de arquivamento toorestart hello.</span><span class="sxs-lookup"><span data-stu-id="a3f81-555">It is important that hello operations in steps **4** and **5** must be *idempotent* in case hello worker role needs toorestart hello archive operation.</span></span> <span data-ttu-id="a3f81-556">Se você estiver usando o serviço de tabela hello, etapa **4** você deve usar uma operação "inserir ou substituir"; para a etapa **5** você deve usar um "Excluir se existe" operação na biblioteca de cliente Olá você está usando.</span><span class="sxs-lookup"><span data-stu-id="a3f81-556">If you are using hello Table service, for step **4** you should use an "insert or replace" operation; for step **5** you should use a "delete if exists" operation in hello client library you are using.</span></span> <span data-ttu-id="a3f81-557">Se você estiver usando outro sistema de armazenamento, deve usar uma operação idempotente apropriada.</span><span class="sxs-lookup"><span data-stu-id="a3f81-557">If you are using another storage system, you must use an appropriate idempotent operation.</span></span>  

<span data-ttu-id="a3f81-558">Se a função de trabalho Olá nunca conclui a etapa **6**, em seguida, depois que uma mensagem de saudação do tempo limite é exibida novamente na fila de saudação pronto para Olá trabalho função tootry tooreprocess-lo.</span><span class="sxs-lookup"><span data-stu-id="a3f81-558">If hello worker role never completes step **6**, then after a timeout hello message reappears on hello queue ready for hello worker role tootry tooreprocess it.</span></span> <span data-ttu-id="a3f81-559">função de trabalho Olá pode verificar quantas vezes uma mensagem na fila de saudação foi lido e, se necessário, o sinalizador é uma mensagem de "suspeita" para investigação, enviando-tooa separar fila.</span><span class="sxs-lookup"><span data-stu-id="a3f81-559">hello worker role can check how many times a message on hello queue has been read and, if necessary, flag it is a "poison" message for investigation by sending it tooa separate queue.</span></span> <span data-ttu-id="a3f81-560">Para obter mais informações sobre a leitura de fila de mensagens e verificando Olá dequeue contagem, consulte [receber mensagens](https://msdn.microsoft.com/library/azure/dd179474.aspx).</span><span class="sxs-lookup"><span data-stu-id="a3f81-560">For more information about reading queue messages and checking hello dequeue count, see [Get Messages](https://msdn.microsoft.com/library/azure/dd179474.aspx).</span></span>  

<span data-ttu-id="a3f81-561">Alguns erros de serviços de tabela e fila Olá são erros transitórios, e o aplicativo cliente deve incluir toohandle de lógica de repetição adequada-los.</span><span class="sxs-lookup"><span data-stu-id="a3f81-561">Some errors from hello Table and Queue services are transient errors, and your client application should include suitable retry logic toohandle them.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="a3f81-562">Problemas e considerações</span><span class="sxs-lookup"><span data-stu-id="a3f81-562">Issues and considerations</span></span>
<span data-ttu-id="a3f81-563">Considere Olá pontos a seguir ao decidir como tooimplement esse padrão:</span><span class="sxs-lookup"><span data-stu-id="a3f81-563">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="a3f81-564">Esta solução não fornece isolamento da transação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-564">This solution does not provide for transaction isolation.</span></span> <span data-ttu-id="a3f81-565">Por exemplo, um cliente pode ler Olá **atual** e **arquivamento** tabelas quando a função de trabalho Olá foi entre as etapas **4** e **5**e consulte um modo de exibição inconsistente dos dados de saudação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-565">For example, a client could read hello **Current** and **Archive** tables when hello worker role was between steps **4** and **5**, and see an inconsistent view of hello data.</span></span> <span data-ttu-id="a3f81-566">Observe que os dados de saudação será consistentes eventualmente.</span><span class="sxs-lookup"><span data-stu-id="a3f81-566">Note that hello data will be consistent eventually.</span></span>  
* <span data-ttu-id="a3f81-567">Você deve certificar-se de que as etapas 4 e 5 são idempotentes na consistência eventual tooensure da ordem.</span><span class="sxs-lookup"><span data-stu-id="a3f81-567">You must be sure that steps 4 and 5 are idempotent in order tooensure eventual consistency.</span></span>  
* <span data-ttu-id="a3f81-568">Você pode dimensionar a solução hello usando várias filas e instâncias de função de trabalho.</span><span class="sxs-lookup"><span data-stu-id="a3f81-568">You can scale hello solution by using multiple queues and worker role instances.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="a3f81-569">Quando toouse esse padrão</span><span class="sxs-lookup"><span data-stu-id="a3f81-569">When toouse this pattern</span></span>
<span data-ttu-id="a3f81-570">Use esse padrão quando quiser que a consistência eventual tooguarantee entre entidades que existem nas tabelas ou partições diferentes.</span><span class="sxs-lookup"><span data-stu-id="a3f81-570">Use this pattern when you want tooguarantee eventual consistency between entities that exist in different partitions or tables.</span></span> <span data-ttu-id="a3f81-571">Você pode estender esse consistência eventual de tooensure padrão para operações de serviço de tabela hello e serviço de Blob hello e outras fontes de dados não é do armazenamento do Azure, como sistema de arquivos de banco de dados ou hello.</span><span class="sxs-lookup"><span data-stu-id="a3f81-571">You can extend this pattern tooensure eventual consistency for operations across hello Table service and hello Blob service and other non-Azure Storage data sources such as database or hello file system.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="a3f81-572">Diretrizes e padrões relacionados</span><span class="sxs-lookup"><span data-stu-id="a3f81-572">Related patterns and guidance</span></span>
<span data-ttu-id="a3f81-573">Olá padrões e diretrizes a seguir também podem ser relevantes ao implementar esse padrão:</span><span class="sxs-lookup"><span data-stu-id="a3f81-573">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="a3f81-574">Transações do Grupo de Entidades</span><span class="sxs-lookup"><span data-stu-id="a3f81-574">Entity Group Transactions</span></span>](#entity-group-transactions)  
* [<span data-ttu-id="a3f81-575">Mesclar ou substituir</span><span class="sxs-lookup"><span data-stu-id="a3f81-575">Merge or replace</span></span>](#merge-or-replace)  

> [!NOTE]
> <span data-ttu-id="a3f81-576">Se o isolamento de transação é uma solução tooyour importante, considere reprojetar sua tooenable tabelas você toouse EGTs.</span><span class="sxs-lookup"><span data-stu-id="a3f81-576">If transaction isolation is important tooyour solution, you should consider redesigning your tables tooenable you toouse EGTs.</span></span>  
> 
> 

### <a name="index-entities-pattern"></a><span data-ttu-id="a3f81-577">Padrão de entidades de índice</span><span class="sxs-lookup"><span data-stu-id="a3f81-577">Index Entities Pattern</span></span>
<span data-ttu-id="a3f81-578">Manter o índice entidades tooenable pesquisas eficientes que retornam listas de entidades.</span><span class="sxs-lookup"><span data-stu-id="a3f81-578">Maintain index entities tooenable efficient searches that return lists of entities.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="a3f81-579">Contexto e problema</span><span class="sxs-lookup"><span data-stu-id="a3f81-579">Context and problem</span></span>
<span data-ttu-id="a3f81-580">Olá serviço tabela indexa automaticamente entidades usando Olá **PartitionKey** e **RowKey** valores.</span><span class="sxs-lookup"><span data-stu-id="a3f81-580">hello Table service automatically indexes entities using hello **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="a3f81-581">Isso permite que um aplicativo de cliente tooretrieve uma entidade com eficiência usando uma consulta de ponto.</span><span class="sxs-lookup"><span data-stu-id="a3f81-581">This enables a client application tooretrieve an entity efficiently using a point query.</span></span> <span data-ttu-id="a3f81-582">Por exemplo, usando a estrutura da tabela Olá mostrada abaixo, um aplicativo cliente pode recuperar de maneira eficiente uma entidade funcionário individual usando o nome do departamento hello e id de funcionário hello (Olá **PartitionKey** e **RowKey** ).</span><span class="sxs-lookup"><span data-stu-id="a3f81-582">For example, using hello table structure shown below, a client application can efficiently retrieve an individual employee entity by using hello department name and hello employee id (hello **PartitionKey** and **RowKey**).</span></span>  

![][13]

<span data-ttu-id="a3f81-583">Se você deseja toobe tooretrieve capaz de obter uma lista de entidades de funcionário com base no valor de saudação de outra propriedade não exclusivo, como seu sobrenome, você deve usar uma partição menos eficiente verificar correspondências toofind em vez de usar um índice toolook-los até diretamente.</span><span class="sxs-lookup"><span data-stu-id="a3f81-583">If you also want toobe able tooretrieve a list of employee entities based on hello value of another non-unique property, such as their last name, you must use a less efficient partition scan toofind matches rather than using an index toolook them up directly.</span></span> <span data-ttu-id="a3f81-584">Isso ocorre porque o serviço de tabela de saudação não fornece índices secundários.</span><span class="sxs-lookup"><span data-stu-id="a3f81-584">This is because hello table service does not provide secondary indexes.</span></span>  

#### <a name="solution"></a><span data-ttu-id="a3f81-585">Solução</span><span class="sxs-lookup"><span data-stu-id="a3f81-585">Solution</span></span>
<span data-ttu-id="a3f81-586">pesquisa de tooenable por sobrenome com estrutura de entidade Olá mostrada acima, você deve manter a lista de ids de funcionário.</span><span class="sxs-lookup"><span data-stu-id="a3f81-586">tooenable lookup by last name with hello entity structure shown above, you must maintain lists of employee ids.</span></span> <span data-ttu-id="a3f81-587">Se você quiser entidades de funcionário de saudação tooretrieve com um determinado sobrenome, como Jones, deve primeiro localizar lista Olá de ids de funcionário para os funcionários com Jones como sobrenome e, em seguida, recuperar as entidades do funcionário.</span><span class="sxs-lookup"><span data-stu-id="a3f81-587">If you want tooretrieve hello employee entities with a particular last name, such as Jones, you must first locate hello list of employee ids for employees with Jones as their last name, and then retrieve those employee entities.</span></span> <span data-ttu-id="a3f81-588">Há três opções principais para armazenar as listas de saudação de ids de funcionário:</span><span class="sxs-lookup"><span data-stu-id="a3f81-588">There are three main options for storing hello lists of employee ids:</span></span>  

* <span data-ttu-id="a3f81-589">Use o armazenamento de blobs.</span><span class="sxs-lookup"><span data-stu-id="a3f81-589">Use blob storage.</span></span>  
* <span data-ttu-id="a3f81-590">Crie entidades de índice no hello mesma partição como entidades de funcionário hello.</span><span class="sxs-lookup"><span data-stu-id="a3f81-590">Create index entities in hello same partition as hello employee entities.</span></span>  
* <span data-ttu-id="a3f81-591">Crie entidades de índice em uma partição ou tabela separada.</span><span class="sxs-lookup"><span data-stu-id="a3f81-591">Create index entities in a separate partition or table.</span></span>  

<span data-ttu-id="a3f81-592"><u>Opção n°. 1: usar o armazenamento de blob</u></span><span class="sxs-lookup"><span data-stu-id="a3f81-592"><u>Option #1: Use blob storage</u></span></span>  

<span data-ttu-id="a3f81-593">Opção de primeira Olá, você criou um blob para cada sobrenome exclusivo e em cada repositório de blob uma lista de saudação **PartitionKey** (departamento) e **RowKey** valores (id de funcionário) para os funcionários que têm ou último nome.</span><span class="sxs-lookup"><span data-stu-id="a3f81-593">For hello first option, you create a blob for every unique last name, and in each blob store a list of hello **PartitionKey** (department) and **RowKey** (employee id) values for employees that have that last name.</span></span> <span data-ttu-id="a3f81-594">Quando você adicionar ou excluir um funcionário, você deve garantir que Olá conteúdo blob relevantes Olá é finalmente consistente com entidades de funcionário hello.</span><span class="sxs-lookup"><span data-stu-id="a3f81-594">When you add or delete an employee you should ensure that hello content of hello relevant blob is eventually consistent with hello employee entities.</span></span>  

<span data-ttu-id="a3f81-595"><u>Opção #2:</u> criar entidades de índice na mesma partição de Olá</span><span class="sxs-lookup"><span data-stu-id="a3f81-595"><u>Option #2:</u> Create index entities in hello same partition</span></span>  

<span data-ttu-id="a3f81-596">Para a segunda opção de Olá, use as entidades de índice que armazenam Olá seguintes dados:</span><span class="sxs-lookup"><span data-stu-id="a3f81-596">For hello second option, use index entities that store hello following data:</span></span>  

![][14]

<span data-ttu-id="a3f81-597">Olá **EmployeeIDs** propriedade contém uma lista de ids de funcionário para os funcionários com o nome do último Olá armazenado em Olá **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="a3f81-597">hello **EmployeeIDs** property contains a list of employee ids for employees with hello last name stored in hello **RowKey**.</span></span>  

<span data-ttu-id="a3f81-598">Olá, etapas a seguir descrevem o processo de saudação que você deve seguir quando você estiver adicionando um novo funcionário, se você estiver usando a opção de segundo hello.</span><span class="sxs-lookup"><span data-stu-id="a3f81-598">hello following steps outline hello process you should follow when you are adding a new employee if you are using hello second option.</span></span> <span data-ttu-id="a3f81-599">Neste exemplo, estamos adicionando um funcionário com Id 000152 e um sobrenome Jones Olá departamento de vendas:</span><span class="sxs-lookup"><span data-stu-id="a3f81-599">In this example, we are adding an employee with Id 000152 and a last name Jones in hello Sales department:</span></span>  

1. <span data-ttu-id="a3f81-600">Recuperar Olá índice entidade com uma **PartitionKey** valor "Vendas" e hello **RowKey** valor "Jones".</span><span class="sxs-lookup"><span data-stu-id="a3f81-600">Retrieve hello index entity with a **PartitionKey** value "Sales" and hello **RowKey** value "Jones."</span></span> <span data-ttu-id="a3f81-601">Salve Olá ETag do toouse entidade na etapa 2.</span><span class="sxs-lookup"><span data-stu-id="a3f81-601">Save hello ETag of this entity toouse in step 2.</span></span>  
2. <span data-ttu-id="a3f81-602">Criar uma transação de grupo de entidade (ou seja, uma operação em lote) que insere a nova entidade de funcionário hello (**PartitionKey** valor "Vendas" e **RowKey** valor "000152"), e as atualizações Olá entidade de índice ( **PartitionKey** valor "Vendas" e **RowKey** valor "Jones"), adicionando Olá nova employee id toohello lista no campo de EmployeeIDs de saudação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-602">Create an entity group transaction (that is, a batch operation) that inserts hello new employee entity (**PartitionKey** value "Sales" and **RowKey** value "000152"), and updates hello index entity (**PartitionKey** value "Sales" and **RowKey** value "Jones") by adding hello new employee id toohello list in hello EmployeeIDs field.</span></span> <span data-ttu-id="a3f81-603">Para saber mais sobre transações de grupo de entidades, confira a seção [Transações de grupo de entidades](#entity-group-transactions).</span><span class="sxs-lookup"><span data-stu-id="a3f81-603">For more information about entity group transactions, see [Entity Group Transactions](#entity-group-transactions).</span></span>  
3. <span data-ttu-id="a3f81-604">Se a transação de grupo de entidades Olá falhar devido a um erro de simultaneidade otimista (apenas alguém tiver modificado entidade de índice Olá), será necessário toostart sobre na etapa 1 novamente.</span><span class="sxs-lookup"><span data-stu-id="a3f81-604">If hello entity group transaction fails because of an optimistic concurrency error (someone else has just modified hello index entity), then you need toostart over at step 1 again.</span></span>  

<span data-ttu-id="a3f81-605">Se você estiver usando a opção de segundo hello, você pode usar um toodeleting de abordagem semelhante um funcionário.</span><span class="sxs-lookup"><span data-stu-id="a3f81-605">You can use a similar approach toodeleting an employee if you are using hello second option.</span></span> <span data-ttu-id="a3f81-606">Alterar sobrenome do funcionário é um pouco mais complexo, pois você precisará tooexecute uma transação de grupo de entidades que atualiza três entidades: Olá entidade employee, entidade de índice Olá antigo nome do último hello e entidade índice Olá Olá novo sobrenome.</span><span class="sxs-lookup"><span data-stu-id="a3f81-606">Changing an employee's last name is slightly more complex because you will need tooexecute an entity group transaction that updates three entities: hello employee entity, hello index entity for hello old last name, and hello index entity for hello new last name.</span></span> <span data-ttu-id="a3f81-607">Você deve recuperar cada entidade antes de fazer alterações na ordem de valores de ETag Olá tooretrieve que você pode usar tooperform Olá atualizações usando simultaneidade otimista.</span><span class="sxs-lookup"><span data-stu-id="a3f81-607">You must retrieve each entity before making any changes in order tooretrieve hello ETag values that you can then use tooperform hello updates using optimistic concurrency.</span></span>  

<span data-ttu-id="a3f81-608">Olá, etapas a seguir descrevem o processo de saudação que você deve seguir ao toolook todos os funcionários de saudação com um determinado sobrenome em um departamento é necessário se você estiver usando a opção de segundo hello.</span><span class="sxs-lookup"><span data-stu-id="a3f81-608">hello following steps outline hello process you should follow when you need toolook up all hello employees with a given last name in a department if you are using hello second option.</span></span> <span data-ttu-id="a3f81-609">Neste exemplo, estamos procurando todos os funcionários de saudação com Sobrenome Jones Olá departamento de vendas:</span><span class="sxs-lookup"><span data-stu-id="a3f81-609">In this example, we are looking up all hello employees with last name Jones in hello Sales department:</span></span>  

1. <span data-ttu-id="a3f81-610">Recuperar Olá índice entidade com uma **PartitionKey** valor "Vendas" e hello **RowKey** valor "Jones".</span><span class="sxs-lookup"><span data-stu-id="a3f81-610">Retrieve hello index entity with a **PartitionKey** value "Sales" and hello **RowKey** value "Jones."</span></span>  
2. <span data-ttu-id="a3f81-611">Analise a lista de saudação do funcionário Ids no campo de EmployeeIDs hello.</span><span class="sxs-lookup"><span data-stu-id="a3f81-611">Parse hello list of employee Ids in hello EmployeeIDs field.</span></span>  
3. <span data-ttu-id="a3f81-612">Se você precisar de informações adicionais sobre cada um desses funcionários (como seus endereços de email), recuperar cada uma das entidades de funcionário hello usando **PartitionKey** valor "Vendas" e **RowKey** valores de lista de saudação de funcionários que você obteve na etapa 2.</span><span class="sxs-lookup"><span data-stu-id="a3f81-612">If you need additional information about each of these employees (such as their email addresses), retrieve each of hello employee entities using **PartitionKey** value "Sales" and **RowKey** values from hello list of employees you obtained in step 2.</span></span>  

<span data-ttu-id="a3f81-613"><u>Opção 3:</u> criar entidades de índice em uma partição ou tabela separada</span><span class="sxs-lookup"><span data-stu-id="a3f81-613"><u>Option #3:</u> Create index entities in a separate partition or table</span></span>  

<span data-ttu-id="a3f81-614">Para a terceira opção de hello, usam as entidades de índice que armazenam Olá seguintes dados:</span><span class="sxs-lookup"><span data-stu-id="a3f81-614">For hello third option, use index entities that store hello following data:</span></span>  

![][15]

<span data-ttu-id="a3f81-615">Olá **EmployeeIDs** propriedade contém uma lista de ids de funcionário para os funcionários com o nome do último Olá armazenado em Olá **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="a3f81-615">hello **EmployeeIDs** property contains a list of employee ids for employees with hello last name stored in hello **RowKey**.</span></span>  

<span data-ttu-id="a3f81-616">Com a opção de terceiro hello, você não pode usar EGTs toomaintain consistência porque são entidades de índice de saudação em uma partição separada de entidades de funcionário hello.</span><span class="sxs-lookup"><span data-stu-id="a3f81-616">With hello third option, you cannot use EGTs toomaintain consistency because hello index entities are in a separate partition from hello employee entities.</span></span> <span data-ttu-id="a3f81-617">Certifique-se de que as entidades de índice Olá são finalmente consistentes com entidades de funcionário hello.</span><span class="sxs-lookup"><span data-stu-id="a3f81-617">You should ensure that hello index entities are eventually consistent with hello employee entities.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="a3f81-618">Problemas e considerações</span><span class="sxs-lookup"><span data-stu-id="a3f81-618">Issues and considerations</span></span>
<span data-ttu-id="a3f81-619">Considere Olá pontos a seguir ao decidir como tooimplement esse padrão:</span><span class="sxs-lookup"><span data-stu-id="a3f81-619">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="a3f81-620">Essa solução requer pelo menos duas consultas tooretrieve correspondência entidades: um tooquery Olá índice tooobtain Olá lista entidades de **RowKey** valores e, em seguida, consulta tooretrieve cada entidade na lista de saudação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-620">This solution requires at least two queries tooretrieve matching entities: one tooquery hello index entities tooobtain hello list of **RowKey** values, and then queries tooretrieve each entity in hello list.</span></span>  
* <span data-ttu-id="a3f81-621">Considerando que uma entidade individual tem um tamanho máximo de 1 MB, a opção #2 e a opção #3 na solução de saudação supõem que lista saudação de ids de funcionário para qualquer determinado sobrenome nunca é maior que 1 MB.</span><span class="sxs-lookup"><span data-stu-id="a3f81-621">Given that an individual entity has a maximum size of 1 MB, option #2 and option #3 in hello solution assume that hello list of employee ids for any given last name is never greater than 1 MB.</span></span> <span data-ttu-id="a3f81-622">Se lista de saudação de ids de funcionário for provável toobe maior que 1 MB de tamanho, use a opção #1 e armazenar dados de índice de saudação no armazenamento de blob.</span><span class="sxs-lookup"><span data-stu-id="a3f81-622">If hello list of employee ids is likely toobe greater than 1 MB in size, use option #1 and store hello index data in blob storage.</span></span>  
* <span data-ttu-id="a3f81-623">Se você usar a opção #2 (usando EGTs toohandle adicionando e excluindo os funcionários e alterando o sobrenome do funcionário) você deve avaliar se o volume de saudação de transações alcançarão os limites de escalabilidade de saudação em uma determinada partição.</span><span class="sxs-lookup"><span data-stu-id="a3f81-623">If you use option #2 (using EGTs toohandle adding and deleting employees, and changing an employee's last name) you must evaluate if hello volume of transactions will approach hello scalability limits in a given partition.</span></span> <span data-ttu-id="a3f81-624">Se esse for o caso de Olá, você deve considerar uma solução finalmente consistente (opção &#1; ou #3) que usa filas toohandle Olá update solicita e permite que você toostore suas entidades de índice em uma partição separada de entidades de funcionário hello.</span><span class="sxs-lookup"><span data-stu-id="a3f81-624">If this is hello case, you should consider an eventually consistent solution (option #1 or option #3) that uses queues toohandle hello update requests and enables you toostore your index entities in a separate partition from hello employee entities.</span></span>  
* <span data-ttu-id="a3f81-625">Opção &#2; nesta solução pressupõe que você deseja toolook backup por sobrenome dentro de um departamento: por exemplo, você deseja tooretrieve uma lista de funcionários com um sobrenome Jones Olá departamento de vendas.</span><span class="sxs-lookup"><span data-stu-id="a3f81-625">Option #2 in this solution assumes that you want toolook up by last name within a department: for example, you want tooretrieve a list of employees with a last name Jones in hello Sales department.</span></span> <span data-ttu-id="a3f81-626">Se você quiser toolook capaz de toobe todos os funcionários de saudação com um sobrenome Jones em toda a organização hello, use a opção &#1; ou #3.</span><span class="sxs-lookup"><span data-stu-id="a3f81-626">If you want toobe able toolook up all hello employees with a last name Jones across hello whole organization, use either option #1 or option #3.</span></span>
* <span data-ttu-id="a3f81-627">Você pode implementar uma solução baseada em fila que fornece consistência eventual (consulte Olá [padrão de transações finalmente consistente](#eventually-consistent-transactions-pattern) para obter mais detalhes).</span><span class="sxs-lookup"><span data-stu-id="a3f81-627">You can implement a queue-based solution that delivers eventual consistency (see hello [Eventually consistent transactions pattern](#eventually-consistent-transactions-pattern) for more details).</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="a3f81-628">Quando toouse esse padrão</span><span class="sxs-lookup"><span data-stu-id="a3f81-628">When toouse this pattern</span></span>
<span data-ttu-id="a3f81-629">Use esse padrão quando você toolookup um conjunto de entidades que compartilham um valor de propriedade comuns, como todos os funcionários com hello sobrenome Jones.</span><span class="sxs-lookup"><span data-stu-id="a3f81-629">Use this pattern when you want toolookup a set of entities that all share a common property value, such as all employees with hello last name Jones.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="a3f81-630">Diretrizes e padrões relacionados</span><span class="sxs-lookup"><span data-stu-id="a3f81-630">Related patterns and guidance</span></span>
<span data-ttu-id="a3f81-631">Olá padrões e diretrizes a seguir também podem ser relevantes ao implementar esse padrão:</span><span class="sxs-lookup"><span data-stu-id="a3f81-631">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="a3f81-632">Padrão de chave composta</span><span class="sxs-lookup"><span data-stu-id="a3f81-632">Compound key pattern</span></span>](#compound-key-pattern)  
* [<span data-ttu-id="a3f81-633">Padrão de transações eventualmente consistentes</span><span class="sxs-lookup"><span data-stu-id="a3f81-633">Eventually consistent transactions pattern</span></span>](#eventually-consistent-transactions-pattern)  
* [<span data-ttu-id="a3f81-634">Transações do Grupo de Entidades</span><span class="sxs-lookup"><span data-stu-id="a3f81-634">Entity Group Transactions</span></span>](#entity-group-transactions)  
* [<span data-ttu-id="a3f81-635">Trabalhando com tipos de entidade heterogênea</span><span class="sxs-lookup"><span data-stu-id="a3f81-635">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)  

### <a name="denormalization-pattern"></a><span data-ttu-id="a3f81-636">Padrão de desnormalização</span><span class="sxs-lookup"><span data-stu-id="a3f81-636">Denormalization pattern</span></span>
<span data-ttu-id="a3f81-637">Combinar dados relacionados em uma única entidade tooenable tooretrieve todos Olá necessário com uma consulta de ponto de dados.</span><span class="sxs-lookup"><span data-stu-id="a3f81-637">Combine related data together in a single entity tooenable you tooretrieve all hello data you need with a single point query.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="a3f81-638">Contexto e problema</span><span class="sxs-lookup"><span data-stu-id="a3f81-638">Context and problem</span></span>
<span data-ttu-id="a3f81-639">Em um banco de dados relacional, você normalmente normaliza tooremove duplicação resultando em consultas que recuperam dados de várias tabelas.</span><span class="sxs-lookup"><span data-stu-id="a3f81-639">In a relational database, you typically normalize data tooremove duplication resulting in queries that retrieve data from multiple tables.</span></span> <span data-ttu-id="a3f81-640">Se você normalize os dados nas tabelas do Azure, você deve fazer várias viagens de ida e de saudação cliente toohello server tooretrieve seus dados relacionados.</span><span class="sxs-lookup"><span data-stu-id="a3f81-640">If you normalize your data in Azure tables, you must make multiple round trips from hello client toohello server tooretrieve your related data.</span></span> <span data-ttu-id="a3f81-641">Por exemplo, com estrutura de tabela Olá mostrada abaixo, você precisam de dois arredondar viagens tooretrieve Olá detalhes um departamento: uma toofetch entidade de departamento de saudação que inclui a id do Gerenciador de saudação e detalhes da outra solicitação toofetch Olá manager em um funcionário entidade.</span><span class="sxs-lookup"><span data-stu-id="a3f81-641">For example, with hello table structure shown below you need two round trips tooretrieve hello details for a department: one toofetch hello department entity that includes hello manager's id, and then another request toofetch hello manager's details in an employee entity.</span></span>  

![][16]

#### <a name="solution"></a><span data-ttu-id="a3f81-642">Solução</span><span class="sxs-lookup"><span data-stu-id="a3f81-642">Solution</span></span>
<span data-ttu-id="a3f81-643">Em vez de armazenar dados saudação em duas entidades separadas, desnormalizar dados saudação e manter uma cópia de detalhes do Gerenciador de saudação na entidade do departamento de saudação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-643">Instead of storing hello data in two separate entities, denormalize hello data and keep a copy of hello manager's details in hello department entity.</span></span> <span data-ttu-id="a3f81-644">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="a3f81-644">For example:</span></span>  

![][17]

<span data-ttu-id="a3f81-645">Com entidades de departamento armazenadas com essas propriedades, você agora pode recuperar todos os detalhes de saudação que necessários sobre um departamento usando uma consulta de ponto.</span><span class="sxs-lookup"><span data-stu-id="a3f81-645">With department entities stored with these properties, you can now retrieve all hello details you need about a department using a point query.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="a3f81-646">Problemas e considerações</span><span class="sxs-lookup"><span data-stu-id="a3f81-646">Issues and considerations</span></span>
<span data-ttu-id="a3f81-647">Considere Olá pontos a seguir ao decidir como tooimplement esse padrão:</span><span class="sxs-lookup"><span data-stu-id="a3f81-647">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="a3f81-648">Existe alguma sobrecarga de custo associada ao armazenar alguns dados duas vezes.</span><span class="sxs-lookup"><span data-stu-id="a3f81-648">There is some cost overhead associated with storing some data twice.</span></span> <span data-ttu-id="a3f81-649">benefício de desempenho (resultante do serviço de armazenamento do menos solicitações toohello) normalmente Hello supera aumento marginal Olá os custos de armazenamento (e esse custo é deslocado parcialmente por uma redução no número de saudação de transações precisar detalhes de saudação toofetch de um departamento).</span><span class="sxs-lookup"><span data-stu-id="a3f81-649">hello performance benefit (resulting from fewer requests toohello storage service) typically outweighs hello marginal increase in storage costs (and this cost is partially offset by a reduction in hello number of transactions you require toofetch hello details of a department).</span></span>  
* <span data-ttu-id="a3f81-650">Você deve manter a consistência de saudação de duas entidades do hello que armazenam informações sobre gerenciadores de.</span><span class="sxs-lookup"><span data-stu-id="a3f81-650">You must maintain hello consistency of hello two entities that store information about managers.</span></span> <span data-ttu-id="a3f81-651">Você pode lidar com problemas de consistência de saudação usando EGTs tooupdate várias entidades em uma única transação atômica: nesse caso, Olá departamento entidades e Olá funcionário para o gerente do departamento de saudação são armazenados em Olá mesma partição.</span><span class="sxs-lookup"><span data-stu-id="a3f81-651">You can handle hello consistency issue by using EGTs tooupdate multiple entities in a single atomic transaction: in this case, hello department entity, and hello employee entity for hello department manager are stored in hello same partition.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="a3f81-652">Quando toouse esse padrão</span><span class="sxs-lookup"><span data-stu-id="a3f81-652">When toouse this pattern</span></span>
<span data-ttu-id="a3f81-653">Use esse padrão quando é frequentemente necessário toolook as informações relacionadas.</span><span class="sxs-lookup"><span data-stu-id="a3f81-653">Use this pattern when you frequently need toolook up related information.</span></span> <span data-ttu-id="a3f81-654">Esse padrão reduz o número de saudação de consultas, que o cliente deve fazer dados de saudação tooretrieve requer.</span><span class="sxs-lookup"><span data-stu-id="a3f81-654">This pattern reduces hello number of queries your client must make tooretrieve hello data it requires.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="a3f81-655">Diretrizes e padrões relacionados</span><span class="sxs-lookup"><span data-stu-id="a3f81-655">Related patterns and guidance</span></span>
<span data-ttu-id="a3f81-656">Olá padrões e diretrizes a seguir também podem ser relevantes ao implementar esse padrão:</span><span class="sxs-lookup"><span data-stu-id="a3f81-656">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="a3f81-657">Padrão de chave composta</span><span class="sxs-lookup"><span data-stu-id="a3f81-657">Compound key pattern</span></span>](#compound-key-pattern)  
* [<span data-ttu-id="a3f81-658">Transações do Grupo de Entidades</span><span class="sxs-lookup"><span data-stu-id="a3f81-658">Entity Group Transactions</span></span>](#entity-group-transactions)  
* [<span data-ttu-id="a3f81-659">Trabalhando com tipos de entidade heterogênea</span><span class="sxs-lookup"><span data-stu-id="a3f81-659">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)

### <a name="compound-key-pattern"></a><span data-ttu-id="a3f81-660">Padrão de chave composta</span><span class="sxs-lookup"><span data-stu-id="a3f81-660">Compound key pattern</span></span>
<span data-ttu-id="a3f81-661">Use compostas **RowKey** valores tooenable toolookup um cliente relacionadas a dados com uma consulta única.</span><span class="sxs-lookup"><span data-stu-id="a3f81-661">Use compound **RowKey** values tooenable a client toolookup related data with a single point query.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="a3f81-662">Contexto e problema</span><span class="sxs-lookup"><span data-stu-id="a3f81-662">Context and problem</span></span>
<span data-ttu-id="a3f81-663">Em um banco de dados relacional, é muito natural toouse junções em consultas tooreturn relacionadas a partes do cliente de toohello de dados em uma única consulta.</span><span class="sxs-lookup"><span data-stu-id="a3f81-663">In a relational database, it is quite natural toouse joins in queries tooreturn related pieces of data toohello client in a single query.</span></span> <span data-ttu-id="a3f81-664">Por exemplo, você pode usar o hello employee id toolook uma lista de entidades relacionadas que contêm o desempenho e examinar os dados para aquele funcionário.</span><span class="sxs-lookup"><span data-stu-id="a3f81-664">For example, you might use hello employee id toolook up a list of related entities that contain performance and review data for that employee.</span></span>  

<span data-ttu-id="a3f81-665">Suponha que você está armazenando as entidades de funcionário no serviço de tabela hello usando Olá estrutura a seguir:</span><span class="sxs-lookup"><span data-stu-id="a3f81-665">Assume you are storing employee entities in hello Table service using hello following structure:</span></span>  

![][18]

<span data-ttu-id="a3f81-666">Você também precisa de dados históricos de toostore relacionadas tooreviews e desempenho para cada funcionário do ano Olá trabalhou para sua organização e tooaccess capaz de toobe essas informações por ano.</span><span class="sxs-lookup"><span data-stu-id="a3f81-666">You also need toostore historical data relating tooreviews and performance for each year hello employee has worked for your organization and you need toobe able tooaccess this information by year.</span></span> <span data-ttu-id="a3f81-667">Uma opção é toocreate outra tabela que armazena as entidades com hello estrutura a seguir:</span><span class="sxs-lookup"><span data-stu-id="a3f81-667">One option is toocreate another table that stores entities with hello following structure:</span></span>  

![][19]

<span data-ttu-id="a3f81-668">Observe que, com essa abordagem, você pode decidir tooduplicate algumas informações (como nome e sobrenome) Olá nova entidade tooenable tooretrieve você seus dados com uma única solicitação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-668">Notice that with this approach you may decide tooduplicate some information (such as first name and last name) in hello new entity tooenable you tooretrieve your data with a single request.</span></span> <span data-ttu-id="a3f81-669">No entanto, você não pode manter a consistência forte porque você não pode usar duas entidades um EGT tooupdate Olá atomicamente.</span><span class="sxs-lookup"><span data-stu-id="a3f81-669">However, you cannot maintain strong consistency because you cannot use an EGT tooupdate hello two entities atomically.</span></span>  

#### <a name="solution"></a><span data-ttu-id="a3f81-670">Solução</span><span class="sxs-lookup"><span data-stu-id="a3f81-670">Solution</span></span>
<span data-ttu-id="a3f81-671">Armazene um novo tipo de entidade em sua tabela original com entidades Olá estrutura a seguir:</span><span class="sxs-lookup"><span data-stu-id="a3f81-671">Store a new entity type in your original table using entities with hello following structure:</span></span>  

![][20]

<span data-ttu-id="a3f81-672">Observe como Olá **RowKey** é agora uma chave composta composta por id de funcionário hello e ano de saudação de dados de análise de saudação que permite que você tooretrieve Olá desempenho do funcionário e analise dados com uma única solicitação para uma única entidade.</span><span class="sxs-lookup"><span data-stu-id="a3f81-672">Notice how hello **RowKey** is now a compound key made up of hello employee id and hello year of hello review data that enables you tooretrieve hello employee's performance and review data with a single request for a single entity.</span></span>  

<span data-ttu-id="a3f81-673">saudação de exemplo a seguir descreve como você pode recuperar todos os dados de análise de saudação para um funcionário específico (por exemplo, um funcionário 000123 Olá departamento de vendas):</span><span class="sxs-lookup"><span data-stu-id="a3f81-673">hello following example outlines how you can retrieve all hello review data for a particular employee (such as employee 000123 in hello Sales department):</span></span>  

<span data-ttu-id="a3f81-674">$filter=(PartitionKey eq 'Sales') and (RowKey ge 'empid_000123') and (RowKey lt 'empid_000124')&$select=RowKey,Manager Rating,Peer Rating,Comments</span><span class="sxs-lookup"><span data-stu-id="a3f81-674">$filter=(PartitionKey eq 'Sales') and (RowKey ge 'empid_000123') and (RowKey lt 'empid_000124')&$select=RowKey,Manager Rating,Peer Rating,Comments</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="a3f81-675">Problemas e considerações</span><span class="sxs-lookup"><span data-stu-id="a3f81-675">Issues and considerations</span></span>
<span data-ttu-id="a3f81-676">Considere Olá pontos a seguir ao decidir como tooimplement esse padrão:</span><span class="sxs-lookup"><span data-stu-id="a3f81-676">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="a3f81-677">Você deve usar um caractere separador adequado que torna mais fácil tooparse Olá **RowKey** valor: por exemplo, **000123_2012**.</span><span class="sxs-lookup"><span data-stu-id="a3f81-677">You should use a suitable separator character that makes it easy tooparse hello **RowKey** value: for example, **000123_2012**.</span></span>  
* <span data-ttu-id="a3f81-678">Você também estiver armazenando essa entidade em Olá mesma partição como outras entidades que contêm dados relacionados a saudação mesmo funcionário, o que significa que você pode usar EGTs toomaintain forte consistência.</span><span class="sxs-lookup"><span data-stu-id="a3f81-678">You are also storing this entity in hello same partition as other entities that contain related data for hello same employee, which means you can use EGTs toomaintain strong consistency.</span></span>
* <span data-ttu-id="a3f81-679">Você deve considerar a frequência com a qual você consultará Olá dados toodetermine se esse padrão é apropriado.</span><span class="sxs-lookup"><span data-stu-id="a3f81-679">You should consider how frequently you will query hello data toodetermine whether this pattern is appropriate.</span></span>  <span data-ttu-id="a3f81-680">Por exemplo, se você vai acessar Olá examinar dados raramente e Olá principais dados de funcionário geralmente que devem mantê-los como entidades separadas.</span><span class="sxs-lookup"><span data-stu-id="a3f81-680">For example, if you will access hello review data infrequently and hello main employee data often you should keep them as separate entities.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="a3f81-681">Quando toouse esse padrão</span><span class="sxs-lookup"><span data-stu-id="a3f81-681">When toouse this pattern</span></span>
<span data-ttu-id="a3f81-682">Use esse padrão quando você precisar toostore uma ou mais entidades relacionadas que você consulta com frequência.</span><span class="sxs-lookup"><span data-stu-id="a3f81-682">Use this pattern when you need toostore one or more related entities that you query frequently.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="a3f81-683">Diretrizes e padrões relacionados</span><span class="sxs-lookup"><span data-stu-id="a3f81-683">Related patterns and guidance</span></span>
<span data-ttu-id="a3f81-684">Olá padrões e diretrizes a seguir também podem ser relevantes ao implementar esse padrão:</span><span class="sxs-lookup"><span data-stu-id="a3f81-684">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="a3f81-685">Transações do Grupo de Entidades</span><span class="sxs-lookup"><span data-stu-id="a3f81-685">Entity Group Transactions</span></span>](#entity-group-transactions)  
* [<span data-ttu-id="a3f81-686">Trabalhando com tipos de entidade heterogênea</span><span class="sxs-lookup"><span data-stu-id="a3f81-686">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)  
* [<span data-ttu-id="a3f81-687">Padrão de transações eventualmente consistentes</span><span class="sxs-lookup"><span data-stu-id="a3f81-687">Eventually consistent transactions pattern</span></span>](#eventually-consistent-transactions-pattern)  

### <a name="log-tail-pattern"></a><span data-ttu-id="a3f81-688">Padrão de rastro do log</span><span class="sxs-lookup"><span data-stu-id="a3f81-688">Log tail pattern</span></span>
<span data-ttu-id="a3f81-689">Recuperar Olá  *n*  entidades adicionada mais recentemente tooa partição usando uma **RowKey** valor classifica em inversa de data e a ordem de tempo.</span><span class="sxs-lookup"><span data-stu-id="a3f81-689">Retrieve hello *n* entities most recently added tooa partition by using a **RowKey** value that sorts in reverse date and time order.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="a3f81-690">Contexto e problema</span><span class="sxs-lookup"><span data-stu-id="a3f81-690">Context and problem</span></span>
<span data-ttu-id="a3f81-691">Um requisito comum é ser capaz de tooretrieve entidades Olá criado mais recentemente, por exemplo hello dez mais recentes declarações de despesas enviadas por um funcionário.</span><span class="sxs-lookup"><span data-stu-id="a3f81-691">A common requirement is be able tooretrieve hello most recently created entities, for example hello ten most recent expense claims submitted by an employee.</span></span> <span data-ttu-id="a3f81-692">Suporte de consulta de tabela um **$top** Olá de tooreturn de operação de consulta primeiro  *n*  entidades de um conjunto: não há nenhum equivalente operação tooreturn Olá últimos n entidades de consulta em um conjunto.</span><span class="sxs-lookup"><span data-stu-id="a3f81-692">Table queries support a **$top** query operation tooreturn hello first *n* entities from a set: there is no equivalent query operation tooreturn hello last n entities in a set.</span></span>  

#### <a name="solution"></a><span data-ttu-id="a3f81-693">Solução</span><span class="sxs-lookup"><span data-stu-id="a3f81-693">Solution</span></span>
<span data-ttu-id="a3f81-694">Repositório Olá entidades usando um **RowKey** que naturalmente classifica em ordem inversa de data/hora ordem usando a entrada mais recente Olá sempre é Olá primeiro uma tabela de saudação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-694">Store hello entities using a **RowKey** that naturally sorts in reverse date/time order by using so hello most recent entry is always hello first one in hello table.</span></span>  

<span data-ttu-id="a3f81-695">Por exemplo, tooretrieve capaz de toobe Olá dez mais recentes declarações de despesas enviadas por um funcionário, você pode usar um valor de escala inversa derivado Olá data/hora atual.</span><span class="sxs-lookup"><span data-stu-id="a3f81-695">For example, toobe able tooretrieve hello ten most recent expense claims submitted by an employee, you can use a reverse tick value derived from hello current date/time.</span></span> <span data-ttu-id="a3f81-696">Olá c# exemplo de código mostra uma maneira toocreate um valor de "invertido tiques" adequado para um **RowKey** que classifica do toohello mais recente do hello mais antiga:</span><span class="sxs-lookup"><span data-stu-id="a3f81-696">hello following C# code sample shows one way toocreate a suitable "inverted ticks" value for a **RowKey** that sorts from hello most recent toohello oldest:</span></span>  

`string invertedTicks = string.Format("{0:D19}", DateTime.MaxValue.Ticks - DateTime.UtcNow.Ticks);`  

<span data-ttu-id="a3f81-697">Você pode voltar toohello valor de data hora usando Olá código a seguir:</span><span class="sxs-lookup"><span data-stu-id="a3f81-697">You can get back toohello date time value using hello following code:</span></span>  

`DateTime dt = new DateTime(DateTime.MaxValue.Ticks - Int64.Parse(invertedTicks));`  

<span data-ttu-id="a3f81-698">consulta de tabela de saudação tem esta aparência:</span><span class="sxs-lookup"><span data-stu-id="a3f81-698">hello table query looks like this:</span></span>  

`https://myaccount.table.core.windows.net/EmployeeExpense(PartitionKey='empid')?$top=10`  

#### <a name="issues-and-considerations"></a><span data-ttu-id="a3f81-699">Problemas e considerações</span><span class="sxs-lookup"><span data-stu-id="a3f81-699">Issues and considerations</span></span>
<span data-ttu-id="a3f81-700">Considere Olá pontos a seguir ao decidir como tooimplement esse padrão:</span><span class="sxs-lookup"><span data-stu-id="a3f81-700">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="a3f81-701">Você deve preencher o valor de escala inversa Olá com zeros à esquerda valor de cadeia de caracteres de saudação tooensure classifica conforme o esperado.</span><span class="sxs-lookup"><span data-stu-id="a3f81-701">You must pad hello reverse tick value with leading zeroes tooensure hello string value sorts as expected.</span></span>  
* <span data-ttu-id="a3f81-702">Você deve estar ciente dos destinos de escalabilidade Olá no nível de saudação de uma partição.</span><span class="sxs-lookup"><span data-stu-id="a3f81-702">You must be aware of hello scalability targets at hello level of a partition.</span></span> <span data-ttu-id="a3f81-703">Cuidado não criar partições com ponto de acesso.</span><span class="sxs-lookup"><span data-stu-id="a3f81-703">Be careful not create hot spot partitions.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="a3f81-704">Quando toouse esse padrão</span><span class="sxs-lookup"><span data-stu-id="a3f81-704">When toouse this pattern</span></span>
<span data-ttu-id="a3f81-705">Use esse padrão quando você precisar tooaccess entidades na ordem inversa de data/hora ou quando você precisar tooaccess hello mais recentemente adicionado entidades.</span><span class="sxs-lookup"><span data-stu-id="a3f81-705">Use this pattern when you need tooaccess entities in reverse date/time order or when you need tooaccess hello most recently added entities.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="a3f81-706">Diretrizes e padrões relacionados</span><span class="sxs-lookup"><span data-stu-id="a3f81-706">Related patterns and guidance</span></span>
<span data-ttu-id="a3f81-707">Olá padrões e diretrizes a seguir também podem ser relevantes ao implementar esse padrão:</span><span class="sxs-lookup"><span data-stu-id="a3f81-707">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="a3f81-708">Antipadrão prefixar/acrescentar</span><span class="sxs-lookup"><span data-stu-id="a3f81-708">Prepend / append anti-pattern</span></span>](#prepend-append-anti-pattern)  
* [<span data-ttu-id="a3f81-709">Recuperando entidades</span><span class="sxs-lookup"><span data-stu-id="a3f81-709">Retrieving entities</span></span>](#retrieving-entities)  

### <a name="high-volume-delete-pattern"></a><span data-ttu-id="a3f81-710">Padrão de exclusão de alto volume</span><span class="sxs-lookup"><span data-stu-id="a3f81-710">High volume delete pattern</span></span>
<span data-ttu-id="a3f81-711">Habilitar a exclusão de saudação de um alto volume de entidades, armazenando todas as entidades de saudação para exclusão simultânea em suas próprias tabelas separadas; Excluir tabela Olá para excluir entidades de saudação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-711">Enable hello deletion of a high volume of entities by storing all hello entities for simultaneous deletion in their own separate table; you delete hello entities by deleting hello table.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="a3f81-712">Contexto e problema</span><span class="sxs-lookup"><span data-stu-id="a3f81-712">Context and problem</span></span>
<span data-ttu-id="a3f81-713">Muitos aplicativos excluir dados antigos que não precisa mais de aplicativo de cliente disponíveis tooa toobe ou aplicativo hello tenha arquivado tooanother mídia de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="a3f81-713">Many applications delete old data which no longer needs toobe available tooa client application, or that hello application has archived tooanother storage medium.</span></span> <span data-ttu-id="a3f81-714">Você geralmente identificar esses dados por uma data: por exemplo, você tem registros de toodelete a necessidade de todas as solicitações de logon mais de 60 dias.</span><span class="sxs-lookup"><span data-stu-id="a3f81-714">You typically identify such data by a date: for example, you have a requirement toodelete records of all login requests that are more than 60 days old.</span></span>  

<span data-ttu-id="a3f81-715">Um design possíveis é date de hello toouse e a hora da solicitação de logon de saudação em Olá **RowKey**:</span><span class="sxs-lookup"><span data-stu-id="a3f81-715">One possible design is toouse hello date and time of hello login request in hello **RowKey**:</span></span>  

![][21]

<span data-ttu-id="a3f81-716">Essa abordagem evita sobrecargas de partição porque o aplicativo hello pode inserir e excluir entidades de logon para cada usuário em uma partição separada.</span><span class="sxs-lookup"><span data-stu-id="a3f81-716">This approach avoids partition hotspots because hello application can insert and delete login entities for each user in a separate partition.</span></span> <span data-ttu-id="a3f81-717">No entanto, essa abordagem pode ser dispendiosa e demorada se você tiver um grande número de entidades porque primeiro é necessário tooperform uma verificação de tabela em ordem tooidentify toodelete de entidades de saudação todas as e, em seguida, você deve excluir cada entidade antiga.</span><span class="sxs-lookup"><span data-stu-id="a3f81-717">However, this approach may be costly and time consuming if you have a large number of entities because first you need tooperform a table scan in order tooidentify all hello entities toodelete, and then you must delete each old entity.</span></span> <span data-ttu-id="a3f81-718">Observe que você pode reduzir o número de saudação de viagens de ida e toohello servidor necessário toodelete Olá entidades antigo por envio em lote de várias solicitações de exclusão em EGTs.</span><span class="sxs-lookup"><span data-stu-id="a3f81-718">Note that you can reduce hello number of round trips toohello server required toodelete hello old entities by batching multiple delete requests into EGTs.</span></span>  

#### <a name="solution"></a><span data-ttu-id="a3f81-719">Solução</span><span class="sxs-lookup"><span data-stu-id="a3f81-719">Solution</span></span>
<span data-ttu-id="a3f81-720">Use uma tabela separada para cada dia de tentativas de logon.</span><span class="sxs-lookup"><span data-stu-id="a3f81-720">Use a separate table for each day of login attempts.</span></span> <span data-ttu-id="a3f81-721">Você pode usar o design de entidade Olá acima tooavoid pontos de acesso quando você estiver inserindo entidades e excluir entidades antigas agora é simplesmente uma questão de excluir uma tabela de todos os dias (uma única operação de armazenamento), em vez de Localizando e excluindo centenas e milhares de entidades de logon individuais diariamente.</span><span class="sxs-lookup"><span data-stu-id="a3f81-721">You can use hello entity design above tooavoid hotspots when you are inserting entities, and deleting old entities is now simply a question of deleting one table every day (a single storage operation) instead of finding and deleting hundreds and thousands of individual login entities every day.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="a3f81-722">Problemas e considerações</span><span class="sxs-lookup"><span data-stu-id="a3f81-722">Issues and considerations</span></span>
<span data-ttu-id="a3f81-723">Considere Olá pontos a seguir ao decidir como tooimplement esse padrão:</span><span class="sxs-lookup"><span data-stu-id="a3f81-723">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="a3f81-724">Seu design dá suporte a outras maneiras em que o aplicativo usará dados hello como pesquisar entidades específicas, vinculando com outros dados ou informações agregadas de geração?</span><span class="sxs-lookup"><span data-stu-id="a3f81-724">Does your design support other ways your application will use hello data such as looking up specific entities, linking with other data, or generating aggregate information?</span></span>  
* <span data-ttu-id="a3f81-725">O design evita pontos de acesso quando você está inserindo novas entidades?</span><span class="sxs-lookup"><span data-stu-id="a3f81-725">Does your design avoid hot spots when you are inserting new entities?</span></span>  
* <span data-ttu-id="a3f81-726">Esperado um atraso, se você quiser tooreuse Olá mesmo nome da tabela após a exclusão.</span><span class="sxs-lookup"><span data-stu-id="a3f81-726">Expect a delay if you want tooreuse hello same table name after deleting it.</span></span> <span data-ttu-id="a3f81-727">É melhor tooalways usar nomes de tabela exclusivo.</span><span class="sxs-lookup"><span data-stu-id="a3f81-727">It's better tooalways use unique table names.</span></span>  
* <span data-ttu-id="a3f81-728">Espere alguns limitação quando você usa uma nova tabela primeiro enquanto hello serviço tabela aprende os padrões de acesso hello e distribui Olá partições em nós.</span><span class="sxs-lookup"><span data-stu-id="a3f81-728">Expect some throttling when you first use a new table while hello Table service learns hello access patterns and distributes hello partitions across nodes.</span></span> <span data-ttu-id="a3f81-729">Você deve considerar a frequência com a qual você precisa toocreate novas tabelas.</span><span class="sxs-lookup"><span data-stu-id="a3f81-729">You should consider how frequently you need toocreate new tables.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="a3f81-730">Quando toouse esse padrão</span><span class="sxs-lookup"><span data-stu-id="a3f81-730">When toouse this pattern</span></span>
<span data-ttu-id="a3f81-731">Use esse padrão quando você tem um volume alto de entidades que você deve excluir a saudação simultaneamente.</span><span class="sxs-lookup"><span data-stu-id="a3f81-731">Use this pattern when you have a high volume of entities that you must delete at hello same time.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="a3f81-732">Diretrizes e padrões relacionados</span><span class="sxs-lookup"><span data-stu-id="a3f81-732">Related patterns and guidance</span></span>
<span data-ttu-id="a3f81-733">Olá padrões e diretrizes a seguir também podem ser relevantes ao implementar esse padrão:</span><span class="sxs-lookup"><span data-stu-id="a3f81-733">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="a3f81-734">Transações do Grupo de Entidades</span><span class="sxs-lookup"><span data-stu-id="a3f81-734">Entity Group Transactions</span></span>](#entity-group-transactions)
* [<span data-ttu-id="a3f81-735">Modificando entidades</span><span class="sxs-lookup"><span data-stu-id="a3f81-735">Modifying entities</span></span>](#modifying-entities)  

### <a name="data-series-pattern"></a><span data-ttu-id="a3f81-736">Padrão de série de dados</span><span class="sxs-lookup"><span data-stu-id="a3f81-736">Data series pattern</span></span>
<span data-ttu-id="a3f81-737">Série de dados completo do repositório de entidade única toominimize Olá inúmeras solicitações feitas.</span><span class="sxs-lookup"><span data-stu-id="a3f81-737">Store complete data series in a single entity toominimize hello number of requests you make.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="a3f81-738">Contexto e problema</span><span class="sxs-lookup"><span data-stu-id="a3f81-738">Context and problem</span></span>
<span data-ttu-id="a3f81-739">Um cenário comum é para um aplicativo toostore uma série de dados que normalmente precisa tooretrieve todos de uma vez.</span><span class="sxs-lookup"><span data-stu-id="a3f81-739">A common scenario is for an application toostore a series of data that it typically needs tooretrieve all at once.</span></span> <span data-ttu-id="a3f81-740">Por exemplo, seu aplicativo pode registrar quantas mensagens Instantâneas cada funcionário envia a cada hora e, em seguida, use este tooplot informações quantas mensagens cada usuário enviado pela Olá 24 horas anteriores.</span><span class="sxs-lookup"><span data-stu-id="a3f81-740">For example, your application might record how many IM messages each employee sends every hour, and then use this information tooplot how many messages each user sent over hello preceding 24 hours.</span></span> <span data-ttu-id="a3f81-741">Um projeto pode ser entidades de 24 toostore para cada funcionário:</span><span class="sxs-lookup"><span data-stu-id="a3f81-741">One design might be toostore 24 entities for each employee:</span></span>  

![][22]

<span data-ttu-id="a3f81-742">Com esse design, você pode facilmente localizar e atualizar Olá entidade tooupdate para cada funcionário sempre que o aplicativo hello precisa tooupdate valor de contagem de mensagem de saudação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-742">With this design, you can easily locate and update hello entity tooupdate for each employee whenever hello application needs tooupdate hello message count value.</span></span> <span data-ttu-id="a3f81-743">No entanto, tooretrieve Olá informações tooplot um gráfico da atividade Olá Olá anterior 24 horas, você deve recuperar 24 entidades.</span><span class="sxs-lookup"><span data-stu-id="a3f81-743">However, tooretrieve hello information tooplot a chart of hello activity for hello preceding 24 hours, you must retrieve 24 entities.</span></span>  

#### <a name="solution"></a><span data-ttu-id="a3f81-744">Solução</span><span class="sxs-lookup"><span data-stu-id="a3f81-744">Solution</span></span>
<span data-ttu-id="a3f81-745">Use Olá design com uma contagem de mensagem propriedade separada toostore Olá a seguir para cada hora:</span><span class="sxs-lookup"><span data-stu-id="a3f81-745">Use hello following design with a separate property toostore hello message count for each hour:</span></span>  

![][23]

<span data-ttu-id="a3f81-746">Com esse design, você pode usar uma contagem de mensagem mesclagem operação tooupdate Olá para um funcionário para uma hora específica.</span><span class="sxs-lookup"><span data-stu-id="a3f81-746">With this design, you can use a merge operation tooupdate hello message count for an employee for a specific hour.</span></span> <span data-ttu-id="a3f81-747">Agora, você pode recuperar todas as informações de Olá, é necessário que o gráfico de saudação tooplot usando uma solicitação para uma única entidade.</span><span class="sxs-lookup"><span data-stu-id="a3f81-747">Now, you can retrieve all hello information you need tooplot hello chart using a request for a single entity.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="a3f81-748">Problemas e considerações</span><span class="sxs-lookup"><span data-stu-id="a3f81-748">Issues and considerations</span></span>
<span data-ttu-id="a3f81-749">Considere Olá pontos a seguir ao decidir como tooimplement esse padrão:</span><span class="sxs-lookup"><span data-stu-id="a3f81-749">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="a3f81-750">Se a série de dados completa não couber em uma única entidade (uma entidade pode ter propriedades too252), use um repositório de dados alternativos, como um blob.</span><span class="sxs-lookup"><span data-stu-id="a3f81-750">If your complete data series does not fit into a single entity (an entity can have up too252 properties), use an alternative data store such as a blob.</span></span>  
* <span data-ttu-id="a3f81-751">Se você tiver vários clientes simultaneamente uma entidade de atualização, você precisará Olá toouse **ETag** tooimplement a simultaneidade otimista.</span><span class="sxs-lookup"><span data-stu-id="a3f81-751">If you have multiple clients updating an entity simultaneously, you will need toouse hello **ETag** tooimplement optimistic concurrency.</span></span> <span data-ttu-id="a3f81-752">Se você tiver muitos clientes, poderá enfrentar alta contenção.</span><span class="sxs-lookup"><span data-stu-id="a3f81-752">If you have many clients, you may experience high contention.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="a3f81-753">Quando toouse esse padrão</span><span class="sxs-lookup"><span data-stu-id="a3f81-753">When toouse this pattern</span></span>
<span data-ttu-id="a3f81-754">Use esse padrão quando você precisar tooupdate e recuperar uma série de dados associada a uma entidade individual.</span><span class="sxs-lookup"><span data-stu-id="a3f81-754">Use this pattern when you need tooupdate and retrieve a data series associated with an individual entity.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="a3f81-755">Diretrizes e padrões relacionados</span><span class="sxs-lookup"><span data-stu-id="a3f81-755">Related patterns and guidance</span></span>
<span data-ttu-id="a3f81-756">Olá padrões e diretrizes a seguir também podem ser relevantes ao implementar esse padrão:</span><span class="sxs-lookup"><span data-stu-id="a3f81-756">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="a3f81-757">Padrão de grandes entidades</span><span class="sxs-lookup"><span data-stu-id="a3f81-757">Large entities pattern</span></span>](#large-entities-pattern)  
* [<span data-ttu-id="a3f81-758">Mesclar ou substituir</span><span class="sxs-lookup"><span data-stu-id="a3f81-758">Merge or replace</span></span>](#merge-or-replace)  
* <span data-ttu-id="a3f81-759">[Padrão de transações finalmente consistente](#eventually-consistent-transactions-pattern) (se você estiver armazenando série de dados de saudação em um blob)</span><span class="sxs-lookup"><span data-stu-id="a3f81-759">[Eventually consistent transactions pattern](#eventually-consistent-transactions-pattern) (if you are storing hello data series in a blob)</span></span>  

### <a name="wide-entities-pattern"></a><span data-ttu-id="a3f81-760">Padrão de entidades longas</span><span class="sxs-lookup"><span data-stu-id="a3f81-760">Wide entities pattern</span></span>
<span data-ttu-id="a3f81-761">Use várias entidades lógicas toostore de entidades físicas com mais de 252 propriedades.</span><span class="sxs-lookup"><span data-stu-id="a3f81-761">Use multiple physical entities toostore logical entities with more than 252 properties.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="a3f81-762">Contexto e problema</span><span class="sxs-lookup"><span data-stu-id="a3f81-762">Context and problem</span></span>
<span data-ttu-id="a3f81-763">Uma entidade individual pode ter não mais do que 252 propriedades (excluindo as propriedades de sistema obrigatória Olá) e não é possível armazenar mais de 1 MB de dados no total.</span><span class="sxs-lookup"><span data-stu-id="a3f81-763">An individual entity can have no more than 252 properties (excluding hello mandatory system properties) and cannot store more than 1 MB of data in total.</span></span> <span data-ttu-id="a3f81-764">Em um banco de dados relacional, você normalmente obteria round os limites de tamanho de saudação de uma linha, adicionando uma nova tabela e impor uma relação de 1 para 1 entre eles.</span><span class="sxs-lookup"><span data-stu-id="a3f81-764">In a relational database, you would typically get round any limits on hello size of a row by adding a new table and enforcing a 1-to-1 relationship between them.</span></span>  

#### <a name="solution"></a><span data-ttu-id="a3f81-765">Solução</span><span class="sxs-lookup"><span data-stu-id="a3f81-765">Solution</span></span>
<span data-ttu-id="a3f81-766">Usando o serviço de tabela hello, você pode armazenar um objeto único de grande porte com mais de 252 propriedades toorepresent de várias entidades.</span><span class="sxs-lookup"><span data-stu-id="a3f81-766">Using hello Table service, you can store multiple entities toorepresent a single large business object with more than 252 properties.</span></span> <span data-ttu-id="a3f81-767">Por exemplo, se você quiser toostore uma contagem do número de saudação de mensagens Instantâneas enviadas por cada funcionário para Olá últimos 365 dias, você pode usar Olá design que usa duas entidades com diferentes esquemas a seguir:</span><span class="sxs-lookup"><span data-stu-id="a3f81-767">For example, if you want toostore a count of hello number of IM messages sent by each employee for hello last 365 days, you could use hello following design that uses two entities with different schemas:</span></span>  

![][24]

<span data-ttu-id="a3f81-768">Se você precisar toomake uma alteração que requer a atualização de ambos os tookeep entidades-los sincronizados com o outro, você pode usar um EGT.</span><span class="sxs-lookup"><span data-stu-id="a3f81-768">If you need toomake a change that requires updating both entities tookeep them synchronized with each other you can use an EGT.</span></span> <span data-ttu-id="a3f81-769">Caso contrário, você pode usar uma contagem de mensagem mesclagem única operação tooupdate Olá para um dia específico.</span><span class="sxs-lookup"><span data-stu-id="a3f81-769">Otherwise, you can use a single merge operation tooupdate hello message count for a specific day.</span></span> <span data-ttu-id="a3f81-770">tooretrieve todos Olá dados para um funcionário individual, você deve recuperar as duas entidades, que pode ser feito com duas solicitações eficientes que usam um **PartitionKey** e um **RowKey** valor.</span><span class="sxs-lookup"><span data-stu-id="a3f81-770">tooretrieve all hello data for an individual employee you must retrieve both entities, which you can do with two efficient requests that use both a **PartitionKey** and a **RowKey** value.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="a3f81-771">Problemas e considerações</span><span class="sxs-lookup"><span data-stu-id="a3f81-771">Issues and considerations</span></span>
<span data-ttu-id="a3f81-772">Considere Olá pontos a seguir ao decidir como tooimplement esse padrão:</span><span class="sxs-lookup"><span data-stu-id="a3f81-772">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="a3f81-773">Recuperar uma entidade lógica completa envolve pelo menos duas transações de armazenamento: entidade física de um tooretrieve.</span><span class="sxs-lookup"><span data-stu-id="a3f81-773">Retrieving a complete logical entity involves at least two storage transactions: one tooretrieve each physical entity.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="a3f81-774">Quando toouse esse padrão</span><span class="sxs-lookup"><span data-stu-id="a3f81-774">When toouse this pattern</span></span>
<span data-ttu-id="a3f81-775">Use esse padrão quando o serviço de tabela de entidades de toostore necessidade cujo tamanho ou o número de propriedades excedem os limites de saudação para uma entidade individual no hello.</span><span class="sxs-lookup"><span data-stu-id="a3f81-775">Use this pattern when  need toostore entities whose size or number of properties exceeds hello limits for an individual entity in hello Table service.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="a3f81-776">Diretrizes e padrões relacionados</span><span class="sxs-lookup"><span data-stu-id="a3f81-776">Related patterns and guidance</span></span>
<span data-ttu-id="a3f81-777">Olá padrões e diretrizes a seguir também podem ser relevantes ao implementar esse padrão:</span><span class="sxs-lookup"><span data-stu-id="a3f81-777">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="a3f81-778">Transações do Grupo de Entidades</span><span class="sxs-lookup"><span data-stu-id="a3f81-778">Entity Group Transactions</span></span>](#entity-group-transactions)
* [<span data-ttu-id="a3f81-779">Mesclar ou substituir</span><span class="sxs-lookup"><span data-stu-id="a3f81-779">Merge or replace</span></span>](#merge-or-replace)

### <a name="large-entities-pattern"></a><span data-ttu-id="a3f81-780">Padrão de entidades grandes</span><span class="sxs-lookup"><span data-stu-id="a3f81-780">Large entities pattern</span></span>
<span data-ttu-id="a3f81-781">Use valores de propriedade grande de toostore de armazenamento de blob.</span><span class="sxs-lookup"><span data-stu-id="a3f81-781">Use blob storage toostore large property values.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="a3f81-782">Contexto e problema</span><span class="sxs-lookup"><span data-stu-id="a3f81-782">Context and problem</span></span>
<span data-ttu-id="a3f81-783">Uma entidade individual não pode armazenar mais de 1 MB de dados no total.</span><span class="sxs-lookup"><span data-stu-id="a3f81-783">An individual entity cannot store more than 1 MB of data in total.</span></span> <span data-ttu-id="a3f81-784">Se uma ou várias de suas propriedades armazenam valores que fazer com que o tamanho total de saudação de sua entidade tooexceed esse valor, você não pode armazenar entidade inteira Olá no hello serviço tabela.</span><span class="sxs-lookup"><span data-stu-id="a3f81-784">If one or several of your properties store values that cause hello total size of your entity tooexceed this value, you cannot store hello entire entity in hello Table service.</span></span>  

#### <a name="solution"></a><span data-ttu-id="a3f81-785">Solução</span><span class="sxs-lookup"><span data-stu-id="a3f81-785">Solution</span></span>
<span data-ttu-id="a3f81-786">Se a entidade exceder 1 MB em tamanho, porque uma ou mais propriedades contêm uma grande quantidade de dados, você pode armazenar dados no serviço Blob da saudação e, em seguida, armazenar o endereço de saudação do blob de saudação em uma propriedade na entidade hello.</span><span class="sxs-lookup"><span data-stu-id="a3f81-786">If your entity exceeds 1 MB in size because one or more properties contain a large amount of data, you can store data in hello Blob service and then store hello address of hello blob in a property in hello entity.</span></span> <span data-ttu-id="a3f81-787">Por exemplo, você pode armazenar fotos de saudação de um funcionário no armazenamento de blob e armazenar uma foto do link toohello em Olá **foto** propriedade da entidade funcionário:</span><span class="sxs-lookup"><span data-stu-id="a3f81-787">For example, you can store hello photo of an employee in blob storage and store a link toohello photo in hello **Photo** property of your employee entity:</span></span>  

![][25]

#### <a name="issues-and-considerations"></a><span data-ttu-id="a3f81-788">Problemas e considerações</span><span class="sxs-lookup"><span data-stu-id="a3f81-788">Issues and considerations</span></span>
<span data-ttu-id="a3f81-789">Considere Olá pontos a seguir ao decidir como tooimplement esse padrão:</span><span class="sxs-lookup"><span data-stu-id="a3f81-789">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="a3f81-790">a consistência eventual toomaintain entre entidade Olá Olá serviço tabela e dados Olá Olá serviço Blob, use Olá [padrão de transações finalmente consistente](#eventually-consistent-transactions-pattern) toomaintain suas entidades.</span><span class="sxs-lookup"><span data-stu-id="a3f81-790">toomaintain eventual consistency between hello entity in hello Table service and hello data in hello Blob service, use hello [Eventually consistent transactions pattern](#eventually-consistent-transactions-pattern) toomaintain your entities.</span></span>
* <span data-ttu-id="a3f81-791">Recuperar uma entidade completa envolve pelo menos duas transações de armazenamento: dados de blob de uma entidade de saudação tooretrieve e uma tooretrieve saudação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-791">Retrieving a complete entity involves at least two storage transactions: one tooretrieve hello entity and one tooretrieve hello blob data.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="a3f81-792">Quando toouse esse padrão</span><span class="sxs-lookup"><span data-stu-id="a3f81-792">When toouse this pattern</span></span>
<span data-ttu-id="a3f81-793">Use esse padrão quando você precisar entidades toostore cujo tamanho excede os limites de saudação para uma entidade individual no serviço de tabela de saudação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-793">Use this pattern when you need toostore entities whose size exceeds hello limits for an individual entity in hello Table service.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="a3f81-794">Diretrizes e padrões relacionados</span><span class="sxs-lookup"><span data-stu-id="a3f81-794">Related patterns and guidance</span></span>
<span data-ttu-id="a3f81-795">Olá padrões e diretrizes a seguir também podem ser relevantes ao implementar esse padrão:</span><span class="sxs-lookup"><span data-stu-id="a3f81-795">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="a3f81-796">Padrão de transações eventualmente consistentes</span><span class="sxs-lookup"><span data-stu-id="a3f81-796">Eventually consistent transactions pattern</span></span>](#eventually-consistent-transactions-pattern)  
* [<span data-ttu-id="a3f81-797">Padrão de entidades longas</span><span class="sxs-lookup"><span data-stu-id="a3f81-797">Wide entities pattern</span></span>](#wide-entities-pattern)

<a name="prepend-append-anti-pattern"></a>

### <a name="prependappend-anti-pattern"></a><span data-ttu-id="a3f81-798">Antipadrão prefixar/acrescentar</span><span class="sxs-lookup"><span data-stu-id="a3f81-798">Prepend/append anti-pattern</span></span>
<span data-ttu-id="a3f81-799">Aumentar a escalabilidade quando você tiver um volume alto de inserções distribuindo as inserções de saudação em várias partições.</span><span class="sxs-lookup"><span data-stu-id="a3f81-799">Increase scalability when you have a high volume of inserts by spreading hello inserts across multiple partitions.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="a3f81-800">Contexto e problema</span><span class="sxs-lookup"><span data-stu-id="a3f81-800">Context and problem</span></span>
<span data-ttu-id="a3f81-801">Acrescentando ou anexar entidades de tooyour armazenado entidades normalmente resulta em aplicativo hello adicionando novos toohello de entidades primeiro ou último partição de uma sequência de partições.</span><span class="sxs-lookup"><span data-stu-id="a3f81-801">Prepending or appending entities tooyour stored entities typically results in hello application adding new entities toohello first or last partition of a sequence of partitions.</span></span> <span data-ttu-id="a3f81-802">Nesse caso, todas Olá inserções em um determinado momento estão ocorrendo em Olá insere mesma partição, criando um ponto de acesso que impede que o serviço de tabela de saudação do balanceamento de carga em vários nós e possivelmente está causando a escalabilidade do aplicativo toohit Olá destinos para a partição.</span><span class="sxs-lookup"><span data-stu-id="a3f81-802">In this case, all of hello inserts at any given time are taking place in hello same partition, creating a hotspot that prevents hello table service from load balancing inserts across multiple nodes, and possibly causing your application toohit hello scalability targets for partition.</span></span> <span data-ttu-id="a3f81-803">Por exemplo, se você tiver um aplicativo que recursos e logs acesso à rede pelos funcionários, em seguida, uma estrutura de entidade, como mostrado a seguir pode resultar em Olá partição da hora atual se tornar um ponto de acesso se o volume de saudação de transações atingir meta de escalabilidade hello para uma partição individual:</span><span class="sxs-lookup"><span data-stu-id="a3f81-803">For example, if you have an application that logs network and resource access by employees, then an entity structure as shown below could result in hello current hour's partition becoming a hotspot if hello volume of transactions reaches hello scalability target for an individual partition:</span></span>  

![][26]

#### <a name="solution"></a><span data-ttu-id="a3f81-804">Solução</span><span class="sxs-lookup"><span data-stu-id="a3f81-804">Solution</span></span>
<span data-ttu-id="a3f81-805">Olá seguinte estrutura de entidade alternativo evita um ponto de acesso em qualquer partição específica como eventos de logs de aplicativo hello:</span><span class="sxs-lookup"><span data-stu-id="a3f81-805">hello following alternative entity structure avoids a hotspot on any particular partition as hello application logs events:</span></span>  

![][27]

<span data-ttu-id="a3f81-806">Observe neste exemplo como ambos Olá **PartitionKey** e **RowKey** são chaves compostas.</span><span class="sxs-lookup"><span data-stu-id="a3f81-806">Notice with this example how both hello **PartitionKey** and **RowKey** are compound keys.</span></span> <span data-ttu-id="a3f81-807">Olá **PartitionKey** usa departamento hello e registro em log do funcionário id toodistribute Olá por várias partições.</span><span class="sxs-lookup"><span data-stu-id="a3f81-807">hello **PartitionKey** uses both hello department and employee id toodistribute hello logging across multiple partitions.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="a3f81-808">Problemas e considerações</span><span class="sxs-lookup"><span data-stu-id="a3f81-808">Issues and considerations</span></span>
<span data-ttu-id="a3f81-809">Considere Olá pontos a seguir ao decidir como tooimplement esse padrão:</span><span class="sxs-lookup"><span data-stu-id="a3f81-809">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="a3f81-810">Faz Olá chave estrutura alternativa que evita a criação de partições ativas em inserções com eficiência oferecem suporte a consultas Olá seu aplicativo cliente faz?</span><span class="sxs-lookup"><span data-stu-id="a3f81-810">Does hello alternative key structure that avoids creating hot partitions on inserts efficiently support hello queries your client application makes?</span></span>  
* <span data-ttu-id="a3f81-811">O volume esperado de transações significa que são provavelmente tooreach alvos de escalabilidade de saudação para uma partição específica e ser monitoradas pelo serviço de armazenamento de saudação?</span><span class="sxs-lookup"><span data-stu-id="a3f81-811">Does your anticipated volume of transactions mean that you are likely tooreach hello scalability targets for an individual partition and be throttled by hello storage service?</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="a3f81-812">Quando toouse esse padrão</span><span class="sxs-lookup"><span data-stu-id="a3f81-812">When toouse this pattern</span></span>
<span data-ttu-id="a3f81-813">Evite o antipreceda padrão de / anexar hello quando o volume de transações é provavelmente tooresult na limitação pelo serviço de armazenamento hello quando você acessar uma partição ativa.</span><span class="sxs-lookup"><span data-stu-id="a3f81-813">Avoid hello prepend/append anti-pattern when your volume of transactions is likely tooresult in throttling by hello storage service when you access a hot partition.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="a3f81-814">Diretrizes e padrões relacionados</span><span class="sxs-lookup"><span data-stu-id="a3f81-814">Related patterns and guidance</span></span>
<span data-ttu-id="a3f81-815">Olá padrões e diretrizes a seguir também podem ser relevantes ao implementar esse padrão:</span><span class="sxs-lookup"><span data-stu-id="a3f81-815">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="a3f81-816">Padrão de chave composta</span><span class="sxs-lookup"><span data-stu-id="a3f81-816">Compound key pattern</span></span>](#compound-key-pattern)  
* [<span data-ttu-id="a3f81-817">Padrão de final do log</span><span class="sxs-lookup"><span data-stu-id="a3f81-817">Log tail pattern</span></span>](#log-tail-pattern)  
* [<span data-ttu-id="a3f81-818">Modificando entidades</span><span class="sxs-lookup"><span data-stu-id="a3f81-818">Modifying entities</span></span>](#modifying-entities)  

### <a name="log-data-anti-pattern"></a><span data-ttu-id="a3f81-819">Antipadrão de dados de log</span><span class="sxs-lookup"><span data-stu-id="a3f81-819">Log data anti-pattern</span></span>
<span data-ttu-id="a3f81-820">Normalmente, você deve usar o hello serviço Blob em vez da saudação dados de log de toostore de serviço de tabela.</span><span class="sxs-lookup"><span data-stu-id="a3f81-820">Typically, you should use hello Blob service instead of hello Table service toostore log data.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="a3f81-821">Contexto e problema</span><span class="sxs-lookup"><span data-stu-id="a3f81-821">Context and problem</span></span>
<span data-ttu-id="a3f81-822">Caso de uso de um comum para dados de log são tooretrieve uma seleção de entradas de log para um intervalo de data/hora específico: por exemplo, você deseja toofind Olá a todas as mensagens de erro e críticas que seu aplicativo conectado de 15:04 15:06 em uma data específica.</span><span class="sxs-lookup"><span data-stu-id="a3f81-822">A common use case for log data is tooretrieve a selection of log entries for a specific date/time range: for example, you want toofind all hello error and critical messages that your application logged between 15:04 and 15:06 on a specific date.</span></span> <span data-ttu-id="a3f81-823">Não deseja toouse Olá data e hora da partição Olá log mensagem toodetermine Olá Salvar log entidades: que resulta em uma partição ativa porque compartilham a qualquer momento, todas as entidades de log Olá Olá mesmo **PartitionKey** valor (consulte a seção Olá [coloque/anexar um padrão](#prepend-append-anti-pattern)).</span><span class="sxs-lookup"><span data-stu-id="a3f81-823">You do not want toouse hello date and time of hello log message toodetermine hello partition you save log entities to: that results in a hot partition because at any given time, all hello log entities will share hello same **PartitionKey** value (see hello section [Prepend/append anti-pattern](#prepend-append-anti-pattern)).</span></span> <span data-ttu-id="a3f81-824">Por exemplo, Olá esquema de entidade para uma mensagem de log a seguir resulta em uma partição ativa porque o aplicativo hello grava todas as mensagens de log toohello partição para Olá atual data e hora:</span><span class="sxs-lookup"><span data-stu-id="a3f81-824">For example, hello following entity schema for a log message results in a hot partition because hello application writes all log messages toohello partition for hello current date and hour:</span></span>  

![][28]

<span data-ttu-id="a3f81-825">Neste exemplo, Olá **RowKey** inclui date de hello e a hora da saudação tooensure de mensagem de log que as mensagens de log são armazenadas classificados em ordem de data/hora e uma id de mensagem no caso de várias mensagens de log compartilham Olá iguais à data e hora.</span><span class="sxs-lookup"><span data-stu-id="a3f81-825">In this example, hello **RowKey** includes hello date and time of hello log message tooensure that log messages are stored sorted in date/time order, and includes a message id in case multiple log messages share hello same date and time.</span></span>  

<span data-ttu-id="a3f81-826">Outra abordagem é toouse uma **PartitionKey** que garante que o aplicativo hello grava mensagens em um intervalo de partições.</span><span class="sxs-lookup"><span data-stu-id="a3f81-826">Another approach is toouse a **PartitionKey** that ensures that hello application writes messages across a range of partitions.</span></span> <span data-ttu-id="a3f81-827">Por exemplo, se a fonte de Olá Olá da mensagem de log fornece uma maneira toodistribute mensagens através de numerosas partições, você pode usar o hello esquema de entidade a seguir:</span><span class="sxs-lookup"><span data-stu-id="a3f81-827">For example, if hello source of hello log message provides a way toodistribute messages across many partitions, you could use hello following entity schema:</span></span>  

![][29]

<span data-ttu-id="a3f81-828">No entanto, o problema de saudação com esse esquema é que tooretrieve todos Olá mensagens de log para um período de tempo específico que você deve pesquisar cada partição na tabela de saudação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-828">However, hello problem with this schema is that tooretrieve all hello log messages for a specific time span you must search every partition in hello table.</span></span>

#### <a name="solution"></a><span data-ttu-id="a3f81-829">Solução</span><span class="sxs-lookup"><span data-stu-id="a3f81-829">Solution</span></span>
<span data-ttu-id="a3f81-830">Olá anterior seção Olá realçado problema de tentar toouse Olá entradas de log de toostore de serviço de tabela e sugerido dois insatisfatório, projeta.</span><span class="sxs-lookup"><span data-stu-id="a3f81-830">hello previous section highlighted hello problem of trying toouse hello Table service toostore log entries and suggested two, unsatisfactory, designs.</span></span> <span data-ttu-id="a3f81-831">Uma solução levou tooa hot partição com o risco de saudação do baixo desempenho de gravação de mensagens de log; Olá outra solução resultou em desempenho ruim de consulta devido a saudação requisito tooscan cada partição em mensagens de log de tooretrieve Olá tabela para um período de tempo específico.</span><span class="sxs-lookup"><span data-stu-id="a3f81-831">One solution led tooa hot partition with hello risk of poor performance writing log messages; hello other solution resulted in poor query performance because of hello requirement tooscan every partition in hello table tooretrieve log messages for a specific time span.</span></span> <span data-ttu-id="a3f81-832">Armazenamento de blob oferece uma solução melhor para esse tipo de cenário e isso é como o Azure Storage Analytics armazena Olá log dados coletados por ela.</span><span class="sxs-lookup"><span data-stu-id="a3f81-832">Blob storage offers a better solution for this type of scenario and this is how Azure Storage Analytics stores hello log data it collects.</span></span>  

<span data-ttu-id="a3f81-833">Esta seção descreve como análise de armazenamento armazena dados de log no armazenamento de blob como ilustração desses dados toostoring abordagem normalmente consultado por intervalo.</span><span class="sxs-lookup"><span data-stu-id="a3f81-833">This section outlines how Storage Analytics stores log data in blob storage as an illustration of this approach toostoring data that you typically query by range.</span></span>  

<span data-ttu-id="a3f81-834">O Storage Analytics armazena mensagens de log em um formato delimitado em vários blobs.</span><span class="sxs-lookup"><span data-stu-id="a3f81-834">Storage Analytics stores log messages in a delimited format in multiple blobs.</span></span> <span data-ttu-id="a3f81-835">formato delimitada Olá torna mais fácil para um cliente de dados do aplicativo tooparse saudação na mensagem de saudação do log.</span><span class="sxs-lookup"><span data-stu-id="a3f81-835">hello delimited format makes it easy for a client application tooparse hello data in hello log message.</span></span>  

<span data-ttu-id="a3f81-836">Análise de armazenamento usa uma convenção de nomenclatura para os blobs que permite que você toolocate Olá blob (ou blobs) que contêm mensagens de saudação do log que você está pesquisando.</span><span class="sxs-lookup"><span data-stu-id="a3f81-836">Storage Analytics uses a naming convention for blobs that enables you toolocate hello blob (or blobs) that contain hello log messages for which you are searching.</span></span> <span data-ttu-id="a3f81-837">Por exemplo, um blob denominado "queue/2014/07/31/1800/000001.log" contém mensagens de log relacionados do serviço de fila de toohello por hora Olá iniciando às 18:00 em 31 de julho de 2014.</span><span class="sxs-lookup"><span data-stu-id="a3f81-837">For example, a blob named "queue/2014/07/31/1800/000001.log" contains log messages that relate toohello queue service for hello hour starting at 18:00 on 31 July 2014.</span></span> <span data-ttu-id="a3f81-838">Olá "000001" indica que este é o primeiro arquivo de log Olá para esse período.</span><span class="sxs-lookup"><span data-stu-id="a3f81-838">hello "000001" indicates that this is hello first log file for this period.</span></span> <span data-ttu-id="a3f81-839">Análise de armazenamento também registra Olá carimbos de saudação primeiro e último log mensagens armazenadas no arquivo hello como parte dos metadados do blob hello.</span><span class="sxs-lookup"><span data-stu-id="a3f81-839">Storage Analytics also records hello timestamps of hello first and last log messages stored in hello file as part of hello blob's metadata.</span></span> <span data-ttu-id="a3f81-840">Olá API para permite armazenamento de blob localizar blobs em um contêiner com base em um prefixo de nome: toolocate dados de log de todos os blobs de saudação que contêm a fila por hora Olá iniciando às 18:00, você pode usar o hello prefixo "fila/2014/07/31/1800."</span><span class="sxs-lookup"><span data-stu-id="a3f81-840">hello API for blob storage enables you locate blobs in a container based on a name prefix: toolocate all hello blobs that contain queue log data for hello hour starting at 18:00, you can use hello prefix "queue/2014/07/31/1800."</span></span>  

<span data-ttu-id="a3f81-841">Análise de armazenamento armazena em buffer as mensagens de log internamente e atualiza periodicamente o blob apropriado hello ou cria um novo com o lote mais recente de saudação de entradas de log.</span><span class="sxs-lookup"><span data-stu-id="a3f81-841">Storage Analytics buffers log messages internally and then periodically updates hello appropriate blob or creates a new one with hello latest batch of log entries.</span></span> <span data-ttu-id="a3f81-842">Isso reduz o número de saudação de gravações, ela deve executar o serviço de blob toohello.</span><span class="sxs-lookup"><span data-stu-id="a3f81-842">This reduces hello number of writes it must perform toohello blob service.</span></span>  

<span data-ttu-id="a3f81-843">Se você estiver implementando uma solução semelhante em seu próprio aplicativo, você deve considerar como toomanage Olá compensação entre confiabilidade (gravando cada armazenamento de tooblob de entrada de log quando isso acontece) e o custo e a escalabilidade (buffer atualizações em seu aplicativo e gravá-los tooblob armazenamento em lotes).</span><span class="sxs-lookup"><span data-stu-id="a3f81-843">If you are implementing a similar solution in your own application, you must consider how toomanage hello trade-off between reliability (writing every log entry tooblob storage as it happens) and cost and scalability (buffering updates in your application and writing them tooblob storage in batches).</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="a3f81-844">Problemas e considerações</span><span class="sxs-lookup"><span data-stu-id="a3f81-844">Issues and considerations</span></span>
<span data-ttu-id="a3f81-845">Considere Olá pontos a seguir ao decidir como toostore dados de log:</span><span class="sxs-lookup"><span data-stu-id="a3f81-845">Consider hello following points when deciding how toostore log data:</span></span>  

* <span data-ttu-id="a3f81-846">Se você criar um design de tabela que evita potenciais partições ativas, verá que não pode acessar os dados do log com eficiência.</span><span class="sxs-lookup"><span data-stu-id="a3f81-846">If you create a table design that avoids potential hot partitions, you may find that you cannot access your log data efficiently.</span></span>  
* <span data-ttu-id="a3f81-847">dados de log tooprocess, um cliente geralmente precisa tooload muitos registros.</span><span class="sxs-lookup"><span data-stu-id="a3f81-847">tooprocess log data, a client often needs tooload many records.</span></span>  
* <span data-ttu-id="a3f81-848">Embora os dados de log sejam geralmente estruturados, o armazenamento de blobs pode ser uma solução melhor.</span><span class="sxs-lookup"><span data-stu-id="a3f81-848">Although log data is often structured, blob storage may be a better solution.</span></span>  

### <a name="implementation-considerations"></a><span data-ttu-id="a3f81-849">Considerações sobre a implementação</span><span class="sxs-lookup"><span data-stu-id="a3f81-849">Implementation considerations</span></span>
<span data-ttu-id="a3f81-850">Esta seção discute alguns Olá toobear de considerações em mente ao implementar padrões Olá descritos nas seções anteriores hello.</span><span class="sxs-lookup"><span data-stu-id="a3f81-850">This section discusses some of hello considerations toobear in mind when you implement hello patterns described in hello previous sections.</span></span> <span data-ttu-id="a3f81-851">Grande parte dessa seção usa exemplos escritos em c# que usam Olá biblioteca de cliente de armazenamento (versão 4.3.0 no momento de saudação de gravação).</span><span class="sxs-lookup"><span data-stu-id="a3f81-851">Most of this section uses examples written in C# that use hello Storage Client Library (version 4.3.0 at hello time of writing).</span></span>  

### <a name="retrieving-entities"></a><span data-ttu-id="a3f81-852">Recuperando entidades</span><span class="sxs-lookup"><span data-stu-id="a3f81-852">Retrieving entities</span></span>
<span data-ttu-id="a3f81-853">Como discutido na seção Olá [Design de consulta](#design-for-querying), consulta mais eficiente Olá é um ponto.</span><span class="sxs-lookup"><span data-stu-id="a3f81-853">As discussed in hello section [Design for querying](#design-for-querying), hello most efficient query is a point query.</span></span> <span data-ttu-id="a3f81-854">No entanto, em alguns cenários talvez seja necessário tooretrieve várias entidades.</span><span class="sxs-lookup"><span data-stu-id="a3f81-854">However, in some scenarios you may need tooretrieve multiple entities.</span></span> <span data-ttu-id="a3f81-855">Esta seção descreve algumas entidades de tooretrieving abordagens comuns usando Olá biblioteca de cliente de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="a3f81-855">This section describes some common approaches tooretrieving entities using hello Storage Client Library.</span></span>  

#### <a name="executing-a-point-query-using-hello-storage-client-library"></a><span data-ttu-id="a3f81-856">Executando uma consulta de ponto usando Olá biblioteca de cliente de armazenamento</span><span class="sxs-lookup"><span data-stu-id="a3f81-856">Executing a point query using hello Storage Client Library</span></span>
<span data-ttu-id="a3f81-857">tooexecute de maneira mais fácil de saudação uma consulta de ponto é Olá toouse **recuperar** operação de tabela, conforme mostrado no hello trecho de código c# a seguir recupera uma entidade com uma **PartitionKey** de valor "vendas" e um  **RowKey** de valor "212":</span><span class="sxs-lookup"><span data-stu-id="a3f81-857">hello easiest way tooexecute a point query is toouse hello **Retrieve** table operation as shown in hello following C# code snippet that retrieves an entity with a **PartitionKey** of value "Sales" and a **RowKey** of value "212":</span></span>  

```csharp
TableOperation retrieveOperation = TableOperation.Retrieve<EmployeeEntity>("Sales", "212");
var retrieveResult = employeeTable.Execute(retrieveOperation);
if (retrieveResult.Result != null)
{
    EmployeeEntity employee = (EmployeeEntity)retrieveResult.Result;
    ...
}  
```

<span data-ttu-id="a3f81-858">Observe como esse exemplo espera que a entidade Olá recupera toobe do tipo **EmployeeEntity**.</span><span class="sxs-lookup"><span data-stu-id="a3f81-858">Notice how this example expects hello entity it retrieves toobe of type **EmployeeEntity**.</span></span>  

#### <a name="retrieving-multiple-entities-using-linq"></a><span data-ttu-id="a3f81-859">Recuperando várias entidades usando LINQ</span><span class="sxs-lookup"><span data-stu-id="a3f81-859">Retrieving multiple entities using LINQ</span></span>
<span data-ttu-id="a3f81-860">Você pode recuperar várias entidades usando LINQ com a Biblioteca de cliente de armazenamento e especificando uma consulta com uma cláusula **where** .</span><span class="sxs-lookup"><span data-stu-id="a3f81-860">You can retrieve multiple entities by using LINQ with Storage Client Library and specifying a query with a **where** clause.</span></span> <span data-ttu-id="a3f81-861">tooavoid uma verificação de tabela, você sempre deve incluir Olá **PartitionKey** valor Olá onde cláusula e se possível Olá **RowKey** valor tooavoid verificações de tabela e de partição.</span><span class="sxs-lookup"><span data-stu-id="a3f81-861">tooavoid a table scan, you should always include hello **PartitionKey** value in hello where clause, and if possible hello **RowKey** value tooavoid table and partition scans.</span></span> <span data-ttu-id="a3f81-862">Olá serviço tabela oferece suporte a um conjunto limitado de toouse de (maior que, maior que ou igual, menor que, menor que ou igual, igual e não igual) de operadores de comparação em Olá onde cláusula.</span><span class="sxs-lookup"><span data-stu-id="a3f81-862">hello table service supports a limited set of comparison operators (greater than, greater than or equal, less than, less than or equal, equal, and not equal) toouse in hello where clause.</span></span> <span data-ttu-id="a3f81-863">Olá seguinte trecho de código c# localiza todos os funcionários Olá cujo sobrenome começa com "B" (supondo que Olá **RowKey** repositórios Olá sobrenome) no departamento de vendas de saudação (supondo que Olá **PartitionKey** armazena o nome do departamento de saudação):</span><span class="sxs-lookup"><span data-stu-id="a3f81-863">hello following C# code snippet finds all hello employees whose last name starts with "B" (assuming that hello **RowKey** stores hello last name) in hello sales department (assuming hello **PartitionKey** stores hello department name):</span></span>  

```csharp
TableQuery<EmployeeEntity> employeeQuery = employeeTable.CreateQuery<EmployeeEntity>();
var query = (from employee in employeeQuery
            where employee.PartitionKey == "Sales" &&
            employee.RowKey.CompareTo("B") >= 0 &&
            employee.RowKey.CompareTo("C") < 0
            select employee).AsTableQuery();
var employees = query.Execute();  
```

<span data-ttu-id="a3f81-864">Observe como a consulta de saudação especifica ambos um **RowKey** e um **PartitionKey** tooensure um melhor desempenho.</span><span class="sxs-lookup"><span data-stu-id="a3f81-864">Notice how hello query specifies both a **RowKey** and a **PartitionKey** tooensure better performance.</span></span>  

<span data-ttu-id="a3f81-865">Olá, exemplo de código a seguir mostra uma funcionalidade equivalente usando a API fluente hello (para obter mais informações sobre as APIs fluente em geral, consulte [práticas recomendadas para criar uma API fluente](http://visualstudiomagazine.com/articles/2013/12/01/best-practices-for-designing-a-fluent-api.aspx)):</span><span class="sxs-lookup"><span data-stu-id="a3f81-865">hello following code sample shows equivalent functionality using hello fluent API (for more information about fluent APIs in general, see [Best Practices for Designing a Fluent API](http://visualstudiomagazine.com/articles/2013/12/01/best-practices-for-designing-a-fluent-api.aspx)):</span></span>  

```csharp
TableQuery<EmployeeEntity> employeeQuery = new TableQuery<EmployeeEntity>().Where(
    TableQuery.CombineFilters(
    TableQuery.CombineFilters(
        TableQuery.GenerateFilterCondition(
    "PartitionKey", QueryComparisons.Equal, "Sales"),
    TableOperators.And,
    TableQuery.GenerateFilterCondition(
    "RowKey", QueryComparisons.GreaterThanOrEqual, "B")
),
TableOperators.And,
TableQuery.GenerateFilterCondition("RowKey", QueryComparisons.LessThan, "C")
    )
);
var employees = employeeTable.ExecuteQuery(employeeQuery);  
```

> [!NOTE]
> <span data-ttu-id="a3f81-866">exemplo Hello aninha vários **CombineFilters** tooinclude métodos Olá três condições de filtro.</span><span class="sxs-lookup"><span data-stu-id="a3f81-866">hello sample nests multiple **CombineFilters** methods tooinclude hello three filter conditions.</span></span>  
> 
> 

#### <a name="retrieving-large-numbers-of-entities-from-a-query"></a><span data-ttu-id="a3f81-867">Recuperando grande número de entidades de uma consulta</span><span class="sxs-lookup"><span data-stu-id="a3f81-867">Retrieving large numbers of entities from a query</span></span>
<span data-ttu-id="a3f81-868">Uma consulta ideal retorna uma entidade individual com base em um valor de **PartitionKey** e um valor de **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="a3f81-868">An optimal query returns an individual entity based on a **PartitionKey** value and a **RowKey** value.</span></span> <span data-ttu-id="a3f81-869">No entanto, em alguns cenários você pode ter um requisito tooreturn muitas entidades de saudação mesma partição ou até mesmo de várias partições.</span><span class="sxs-lookup"><span data-stu-id="a3f81-869">However, in some scenarios you may have a requirement tooreturn many entities from hello same partition or even from many partitions.</span></span>  

<span data-ttu-id="a3f81-870">Você sempre totalmente deve testar o desempenho de saudação do seu aplicativo nesses cenários.</span><span class="sxs-lookup"><span data-stu-id="a3f81-870">You should always fully test hello performance of your application in such scenarios.</span></span>  

<span data-ttu-id="a3f81-871">Uma consulta no serviço de tabela Olá pode retornar um máximo de 1.000 entidades simultaneamente e pode ser executada por um máximo de cinco segundos.</span><span class="sxs-lookup"><span data-stu-id="a3f81-871">A query against hello table service may return a maximum of 1,000 entities at one time and may execute for a maximum of five seconds.</span></span> <span data-ttu-id="a3f81-872">Se hello, conjunto de resultados contiver mais de 1.000 entidades, se a consulta Olá não foi concluída dentro de cinco segundos ou se a consulta de Olá ultrapassar o limite da partição Olá, Olá serviço tabela retorna um tooenable de token de continuação Olá Olá de toorequest do aplicativo cliente próximo conjunto de entidades.</span><span class="sxs-lookup"><span data-stu-id="a3f81-872">If hello result set contains more than 1,000 entities, if hello query did not complete within five seconds, or if hello query crosses hello partition boundary, hello Table service returns a continuation token tooenable hello client application toorequest hello next set of entities.</span></span> <span data-ttu-id="a3f81-873">Para saber mais sobre como funcionam os tokens de continuação, confira [Tempo limite e paginação de consulta](http://msdn.microsoft.com/library/azure/dd135718.aspx).</span><span class="sxs-lookup"><span data-stu-id="a3f81-873">For more information about how continuation tokens work, see [Query Timeout and Pagination](http://msdn.microsoft.com/library/azure/dd135718.aspx).</span></span>  

<span data-ttu-id="a3f81-874">Se você estiver usando Olá biblioteca de cliente de armazenamento, ele pode manipular automaticamente tokens de acompanhamento para você como ela retorna entidades de saudação serviço tabela.</span><span class="sxs-lookup"><span data-stu-id="a3f81-874">If you are using hello Storage Client Library, it can automatically handle continuation tokens for you as it returns entities from hello Table service.</span></span> <span data-ttu-id="a3f81-875">Olá c# exemplo de código seguinte usando Olá biblioteca de cliente de armazenamento automaticamente manipula os tokens de continuação se o serviço de tabela Olá retorna em uma resposta:</span><span class="sxs-lookup"><span data-stu-id="a3f81-875">hello following C# code sample using hello Storage Client Library automatically handles continuation tokens if hello table service returns them in a response:</span></span>  

```csharp
string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, "Sales");
TableQuery<EmployeeEntity> employeeQuery =
        new TableQuery<EmployeeEntity>().Where(filter);

var employees = employeeTable.ExecuteQuery(employeeQuery);
foreach (var emp in employees)
{
        ...
}  
```

<span data-ttu-id="a3f81-876">Olá código c# a seguir controla os tokens de continuação explicitamente:</span><span class="sxs-lookup"><span data-stu-id="a3f81-876">hello following C# code handles continuation tokens explicitly:</span></span>  

```csharp
string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, "Sales");
TableQuery<EmployeeEntity> employeeQuery =
        new TableQuery<EmployeeEntity>().Where(filter);

TableContinuationToken continuationToken = null;

do
{
        var employees = employeeTable.ExecuteQuerySegmented(
        employeeQuery, continuationToken);
    foreach (var emp in employees)
    {
    ...
    }
    continuationToken = employees.ContinuationToken;
} while (continuationToken != null);  
```

<span data-ttu-id="a3f81-877">Usando tokens de continuação explicitamente, você pode controlar quando o aplicativo recupera o próximo segmento de dados de saudação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-877">By using continuation tokens explicitly, you can control when your application retrieves hello next segment of data.</span></span> <span data-ttu-id="a3f81-878">Por exemplo, se seu aplicativo cliente permite que os usuários toopage em entidades de saudação armazenados em uma tabela, um usuário pode decidir não toopage em todas as entidades de saudação recuperados pela consulta de saudação para que seu aplicativo só usaria uma saudação tooretrieve token de continuação lado segmento quando o usuário Olá foi concluída a paginação em todas as entidades de saudação no segmento atual hello.</span><span class="sxs-lookup"><span data-stu-id="a3f81-878">For example, if your client application enables users toopage through hello entities stored in a table, a user may decide not toopage through all hello entities retrieved by hello query so your application would only use a continuation token tooretrieve hello next segment when hello user had finished paging through all hello entities in hello current segment.</span></span> <span data-ttu-id="a3f81-879">Essa abordagem tem vários benefícios:</span><span class="sxs-lookup"><span data-stu-id="a3f81-879">This approach has several benefits:</span></span>  

* <span data-ttu-id="a3f81-880">Ele permite a quantidade de saudação de toolimit de dados tooretrieve de saudação serviço tabela e que você mova pela rede hello.</span><span class="sxs-lookup"><span data-stu-id="a3f81-880">It enables you toolimit hello amount of data tooretrieve from hello Table service and that you move over hello network.</span></span>  
* <span data-ttu-id="a3f81-881">Ele permite que você tooperform e/s assíncrona em .NET.</span><span class="sxs-lookup"><span data-stu-id="a3f81-881">It enables you tooperform asynchronous IO in .NET.</span></span>  
* <span data-ttu-id="a3f81-882">Ele permite armazenamento de toopersistent token de continuação tooserialize Olá para que você pode continuar em caso de saudação de uma falha do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a3f81-882">It enables you tooserialize hello continuation token toopersistent storage so you can continue in hello event of an application crash.</span></span>  

> [!NOTE]
> <span data-ttu-id="a3f81-883">Um token de continuação normalmente retorna um segmento que contém 1.000 entidades, embora possa ser menos.</span><span class="sxs-lookup"><span data-stu-id="a3f81-883">A continuation token typically returns a segment containing 1,000 entities, although it may be fewer.</span></span> <span data-ttu-id="a3f81-884">Esse também é o caso de Olá, se você limitar o número de saudação de entradas de uma consulta retorna usando **levar** tooreturn Olá primeiro n entidades que correspondem aos critérios de pesquisa: serviço de tabela Olá pode retornar um segmento que contém menos de entidades n ao longo com um tooenable de token de continuação você tooretrieve Olá entidades restantes.</span><span class="sxs-lookup"><span data-stu-id="a3f81-884">This is also hello case if you limit hello number of entries a query returns by using **Take** tooreturn hello first n entities that match your lookup criteria: hello table service may return a segment containing fewer than n entities along with a continuation token tooenable you tooretrieve hello remaining entities.</span></span>  
> 
> 

<span data-ttu-id="a3f81-885">Olá c# código a seguir mostra como o número de saudação de toomodify de entidades retornadas dentro de um segmento de:</span><span class="sxs-lookup"><span data-stu-id="a3f81-885">hello following C# code shows how toomodify hello number of entities returned inside a segment:</span></span>  

```csharp
employeeQuery.TakeCount = 50;  
```

#### <a name="server-side-projection"></a><span data-ttu-id="a3f81-886">Projeção do lado do servidor</span><span class="sxs-lookup"><span data-stu-id="a3f81-886">Server-side projection</span></span>
<span data-ttu-id="a3f81-887">Uma única entidade pode ter propriedades too255 e ser too1 MB de tamanho.</span><span class="sxs-lookup"><span data-stu-id="a3f81-887">A single entity can have up too255 properties and be up too1 MB in size.</span></span> <span data-ttu-id="a3f81-888">Consulta de tabela hello e recuperar entidades, você talvez não precise de todas as propriedades de saudação e pode evitar a transferência de dados desnecessariamente (toohelp reduzir a latência e custo).</span><span class="sxs-lookup"><span data-stu-id="a3f81-888">When you query hello table and retrieve entities, you may not need all hello properties and can avoid transferring data unnecessarily (toohelp reduce latency and cost).</span></span> <span data-ttu-id="a3f81-889">Você pode usar propriedades de saudação apenas tootransfer de projeção do lado do servidor que é necessário.</span><span class="sxs-lookup"><span data-stu-id="a3f81-889">You can use server-side projection tootransfer just hello properties you need.</span></span> <span data-ttu-id="a3f81-890">Olá é um exemplo recupera apenas Olá **Email** propriedade (juntamente com **PartitionKey**, **RowKey**, **Timestamp**e  **ETag**) de entidades de saudação selecionadas pela consulta hello.</span><span class="sxs-lookup"><span data-stu-id="a3f81-890">hello following example is retrieves just hello **Email** property (along with **PartitionKey**, **RowKey**, **Timestamp**, and **ETag**) from hello entities selected by hello query.</span></span>  

```csharp
string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, "Sales");
List<string> columns = new List<string>() { "Email" };
TableQuery<EmployeeEntity> employeeQuery =
        new TableQuery<EmployeeEntity>().Where(filter).Select(columns);

var entities = employeeTable.ExecuteQuery(employeeQuery);
foreach (var e in entities)
{
        Console.WriteLine("RowKey: {0}, EmployeeEmail: {1}", e.RowKey, e.Email);
}  
```

<span data-ttu-id="a3f81-891">Observe como Olá **RowKey** valor estará disponível mesmo que ele não foi incluído na lista de saudação de tooretrieve de propriedades.</span><span class="sxs-lookup"><span data-stu-id="a3f81-891">Notice how hello **RowKey** value is available even though it was not included in hello list of properties tooretrieve.</span></span>  

### <a name="modifying-entities"></a><span data-ttu-id="a3f81-892">Modificando entidades</span><span class="sxs-lookup"><span data-stu-id="a3f81-892">Modifying entities</span></span>
<span data-ttu-id="a3f81-893">Olá biblioteca de cliente de armazenamento permite que você toomodify suas entidades armazenadas no serviço de tabela hello, inserção, exclusão e atualização de entidades.</span><span class="sxs-lookup"><span data-stu-id="a3f81-893">hello Storage Client Library enables you toomodify your entities stored in hello table service by inserting, deleting, and updating entities.</span></span> <span data-ttu-id="a3f81-894">Você pode usar EGTs toobatch várias operações de inserção, atualização e exclusão tooreduce juntos número de saudação de viagens de ida e necessários e melhorar o desempenho de saudação de sua solução.</span><span class="sxs-lookup"><span data-stu-id="a3f81-894">You can use EGTs toobatch multiple insert, update, and delete operations together tooreduce hello number of round trips required and improve hello performance of your solution.</span></span>  

<span data-ttu-id="a3f81-895">Observe que exceções geradas quando Olá biblioteca de cliente de armazenamento é executada uma EGT normalmente incluem índice de saudação da entidade de saudação que causou a saudação lote toofail.</span><span class="sxs-lookup"><span data-stu-id="a3f81-895">Note that exceptions thrown when hello Storage Client Library executes an EGT typically include hello index of hello entity that caused hello batch toofail.</span></span> <span data-ttu-id="a3f81-896">Isso é útil quando você está depurando código que usa EGTs.</span><span class="sxs-lookup"><span data-stu-id="a3f81-896">This is helpful when you are debugging code that uses EGTs.</span></span>  

<span data-ttu-id="a3f81-897">Você também deve considerar como seu design afeta a forma de tratamento, por parte do cliente, das operações de simultaneidade e atualização.</span><span class="sxs-lookup"><span data-stu-id="a3f81-897">You should also consider how your design affects how your client application handles concurrency and update operations.</span></span>  

#### <a name="managing-concurrency"></a><span data-ttu-id="a3f81-898">Gerenciando simultaneidade</span><span class="sxs-lookup"><span data-stu-id="a3f81-898">Managing concurrency</span></span>
<span data-ttu-id="a3f81-899">Por padrão, o serviço de tabela Olá implementa simultaneidade otimista no nível de saudação de entidades individuais para **inserir**, **mesclar**, e **excluir** operações, Embora seja possível para uma saudação do cliente tooforce essas verificações de toobypass do serviço de tabela.</span><span class="sxs-lookup"><span data-stu-id="a3f81-899">By default, hello table service implements optimistic concurrency checks at hello level of individual entities for **Insert**, **Merge**, and **Delete** operations, although it is possible for a client tooforce hello table service toobypass these checks.</span></span> <span data-ttu-id="a3f81-900">Para obter mais informações sobre como o serviço de tabela Olá gerencia simultaneidade, consulte [gerenciamento de simultaneidade no armazenamento do Microsoft Azure](../storage/common/storage-concurrency.md).</span><span class="sxs-lookup"><span data-stu-id="a3f81-900">For more information about how hello table service manages concurrency, see  [Managing Concurrency in Microsoft Azure Storage](../storage/common/storage-concurrency.md).</span></span>  

#### <a name="merge-or-replace"></a><span data-ttu-id="a3f81-901">Mesclar ou substituir</span><span class="sxs-lookup"><span data-stu-id="a3f81-901">Merge or replace</span></span>
<span data-ttu-id="a3f81-902">Olá **substituir** método hello **TableOperation** classe sempre substitui a entidade completa Olá Olá serviço tabela.</span><span class="sxs-lookup"><span data-stu-id="a3f81-902">hello **Replace** method of hello **TableOperation** class always replaces hello complete entity in hello Table service.</span></span> <span data-ttu-id="a3f81-903">Se você não incluir uma propriedade na solicitação de saudação quando essa propriedade não existe na entidade Olá armazenado, a solicitação de Olá remove a propriedade da saudação armazenados entidade.</span><span class="sxs-lookup"><span data-stu-id="a3f81-903">If you do not include a property in hello request when that property exists in hello stored entity, hello request removes that property from hello stored entity.</span></span> <span data-ttu-id="a3f81-904">A menos que você deseje tooremove uma propriedade explicitamente de uma entidade armazenada, você deve incluir todas as propriedades na solicitação de saudação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-904">Unless you want tooremove a property explicitly from a stored entity, you must include every property in hello request.</span></span>  

<span data-ttu-id="a3f81-905">Você pode usar o hello **mesclar** método hello **TableOperation** classe tooreduce Olá total que você envie toohello serviço de tabela quando você desejar tooupdate uma entidade de dados.</span><span class="sxs-lookup"><span data-stu-id="a3f81-905">You can use hello **Merge** method of hello **TableOperation** class tooreduce hello amount of data that you send toohello Table service when you want tooupdate an entity.</span></span> <span data-ttu-id="a3f81-906">Olá **mesclar** método substitui as propriedades na entidade Olá armazenado com valores de propriedade da entidade Olá incluído na solicitação hello, mas deixa intacta de propriedades na Olá armazenados entidade que não estão incluídos na solicitação de saudação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-906">hello **Merge** method replaces any properties in hello stored entity with property values from hello entity included in hello request, but leaves intact any properties in hello stored entity that are not included in hello request.</span></span> <span data-ttu-id="a3f81-907">Isso é útil se você tiver grandes entidades e só precisa tooupdate um pequeno número de propriedades em uma solicitação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-907">This is useful if you have large entities and only need tooupdate a small number of properties in a request.</span></span>  

> [!NOTE]
> <span data-ttu-id="a3f81-908">Olá **substituir** e **mesclar** métodos falharem se Olá entidade não existe.</span><span class="sxs-lookup"><span data-stu-id="a3f81-908">hello **Replace** and **Merge** methods fail if hello entity does not exist.</span></span> <span data-ttu-id="a3f81-909">Como alternativa, você pode usar o hello **InsertOrReplace** e **InsertOrMerge** métodos que criar uma nova entidade se ele não existir.</span><span class="sxs-lookup"><span data-stu-id="a3f81-909">As an alternative, you can use hello **InsertOrReplace** and **InsertOrMerge** methods that create a new entity if it doesn't exist.</span></span>  
> 
> 

### <a name="working-with-heterogeneous-entity-types"></a><span data-ttu-id="a3f81-910">Trabalhando com tipos de entidade heterogênea</span><span class="sxs-lookup"><span data-stu-id="a3f81-910">Working with heterogeneous entity types</span></span>
<span data-ttu-id="a3f81-911">Olá serviço tabela é uma *sem esquema* armazenamento de tabela que significa que uma única tabela pode armazenar entidades de vários tipos fornecendo grande flexibilidade no design.</span><span class="sxs-lookup"><span data-stu-id="a3f81-911">hello Table service is a *schema-less* table store that means that a single table can store entities of multiple types providing great flexibility in your design.</span></span> <span data-ttu-id="a3f81-912">Olá, exemplo a seguir ilustra uma tabela que armazena o funcionário e entidades de departamento:</span><span class="sxs-lookup"><span data-stu-id="a3f81-912">hello following example illustrates a table storing both employee and department entities:</span></span>  

<table>
<tr>
<th><span data-ttu-id="a3f81-913">PartitionKey</span><span class="sxs-lookup"><span data-stu-id="a3f81-913">PartitionKey</span></span></th>
<th><span data-ttu-id="a3f81-914">RowKey</span><span class="sxs-lookup"><span data-stu-id="a3f81-914">RowKey</span></span></th>
<th><span data-ttu-id="a3f81-915">Timestamp</span><span class="sxs-lookup"><span data-stu-id="a3f81-915">Timestamp</span></span></th>
<th></th>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="a3f81-916">Nome</span><span class="sxs-lookup"><span data-stu-id="a3f81-916">FirstName</span></span></th>
<th><span data-ttu-id="a3f81-917">Sobrenome</span><span class="sxs-lookup"><span data-stu-id="a3f81-917">LastName</span></span></th>
<th><span data-ttu-id="a3f81-918">Idade</span><span class="sxs-lookup"><span data-stu-id="a3f81-918">Age</span></span></th>
<th><span data-ttu-id="a3f81-919">Email</span><span class="sxs-lookup"><span data-stu-id="a3f81-919">Email</span></span></th>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="a3f81-920">Nome</span><span class="sxs-lookup"><span data-stu-id="a3f81-920">FirstName</span></span></th>
<th><span data-ttu-id="a3f81-921">Sobrenome</span><span class="sxs-lookup"><span data-stu-id="a3f81-921">LastName</span></span></th>
<th><span data-ttu-id="a3f81-922">Idade</span><span class="sxs-lookup"><span data-stu-id="a3f81-922">Age</span></span></th>
<th><span data-ttu-id="a3f81-923">Email</span><span class="sxs-lookup"><span data-stu-id="a3f81-923">Email</span></span></th>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="a3f81-924">DepartmentName</span><span class="sxs-lookup"><span data-stu-id="a3f81-924">DepartmentName</span></span></th>
<th><span data-ttu-id="a3f81-925">EmployeeCount</span><span class="sxs-lookup"><span data-stu-id="a3f81-925">EmployeeCount</span></span></th>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</table>
</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="a3f81-926">Nome</span><span class="sxs-lookup"><span data-stu-id="a3f81-926">FirstName</span></span></th>
<th><span data-ttu-id="a3f81-927">Sobrenome</span><span class="sxs-lookup"><span data-stu-id="a3f81-927">LastName</span></span></th>
<th><span data-ttu-id="a3f81-928">Idade</span><span class="sxs-lookup"><span data-stu-id="a3f81-928">Age</span></span></th>
<th><span data-ttu-id="a3f81-929">Email</span><span class="sxs-lookup"><span data-stu-id="a3f81-929">Email</span></span></th>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</td>
</tr>
</table>

<span data-ttu-id="a3f81-930">Observe que cada entidade deve ter ainda os valores de **PartitionKey**, **RowKey** e **Timestamp**, mas pode ter qualquer conjunto de propriedades.</span><span class="sxs-lookup"><span data-stu-id="a3f81-930">Note that each entity must still have **PartitionKey**, **RowKey**, and **Timestamp** values, but may have any set of properties.</span></span> <span data-ttu-id="a3f81-931">Além disso, não há nada Olá tooindicate tipo de uma entidade, a menos que você escolha toostore essas informações em algum lugar.</span><span class="sxs-lookup"><span data-stu-id="a3f81-931">Furthermore, there is nothing tooindicate hello type of an entity unless you choose toostore that information somewhere.</span></span> <span data-ttu-id="a3f81-932">Há duas opções para identificar o tipo de entidade hello:</span><span class="sxs-lookup"><span data-stu-id="a3f81-932">There are two options for identifying hello entity type:</span></span>  

* <span data-ttu-id="a3f81-933">Preceda toohello de tipo de entidade Olá **RowKey** (ou possivelmente Olá **PartitionKey**).</span><span class="sxs-lookup"><span data-stu-id="a3f81-933">Prepend hello entity type toohello **RowKey** (or possibly hello **PartitionKey**).</span></span> <span data-ttu-id="a3f81-934">Por exemplo, **EMPLOYEE_000123** ou **DEPARTMENT_SALES** como valores de **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="a3f81-934">For example, **EMPLOYEE_000123** or **DEPARTMENT_SALES** as **RowKey** values.</span></span>  
* <span data-ttu-id="a3f81-935">Use um tipo de entidade do propriedade separada toorecord Olá conforme mostrado na tabela de saudação abaixo.</span><span class="sxs-lookup"><span data-stu-id="a3f81-935">Use a separate property toorecord hello entity type as shown in hello table below.</span></span>  

<table>
<tr>
<th><span data-ttu-id="a3f81-936">PartitionKey</span><span class="sxs-lookup"><span data-stu-id="a3f81-936">PartitionKey</span></span></th>
<th><span data-ttu-id="a3f81-937">RowKey</span><span class="sxs-lookup"><span data-stu-id="a3f81-937">RowKey</span></span></th>
<th><span data-ttu-id="a3f81-938">Timestamp</span><span class="sxs-lookup"><span data-stu-id="a3f81-938">Timestamp</span></span></th>
<th></th>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="a3f81-939">EntityType</span><span class="sxs-lookup"><span data-stu-id="a3f81-939">EntityType</span></span></th>
<th><span data-ttu-id="a3f81-940">Nome</span><span class="sxs-lookup"><span data-stu-id="a3f81-940">FirstName</span></span></th>
<th><span data-ttu-id="a3f81-941">Sobrenome</span><span class="sxs-lookup"><span data-stu-id="a3f81-941">LastName</span></span></th>
<th><span data-ttu-id="a3f81-942">Idade</span><span class="sxs-lookup"><span data-stu-id="a3f81-942">Age</span></span></th>
<th><span data-ttu-id="a3f81-943">Email</span><span class="sxs-lookup"><span data-stu-id="a3f81-943">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="a3f81-944">Funcionário</span><span class="sxs-lookup"><span data-stu-id="a3f81-944">Employee</span></span></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="a3f81-945">EntityType</span><span class="sxs-lookup"><span data-stu-id="a3f81-945">EntityType</span></span></th>
<th><span data-ttu-id="a3f81-946">Nome</span><span class="sxs-lookup"><span data-stu-id="a3f81-946">FirstName</span></span></th>
<th><span data-ttu-id="a3f81-947">Sobrenome</span><span class="sxs-lookup"><span data-stu-id="a3f81-947">LastName</span></span></th>
<th><span data-ttu-id="a3f81-948">Idade</span><span class="sxs-lookup"><span data-stu-id="a3f81-948">Age</span></span></th>
<th><span data-ttu-id="a3f81-949">Email</span><span class="sxs-lookup"><span data-stu-id="a3f81-949">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="a3f81-950">Funcionário</span><span class="sxs-lookup"><span data-stu-id="a3f81-950">Employee</span></span></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="a3f81-951">EntityType</span><span class="sxs-lookup"><span data-stu-id="a3f81-951">EntityType</span></span></th>
<th><span data-ttu-id="a3f81-952">DepartmentName</span><span class="sxs-lookup"><span data-stu-id="a3f81-952">DepartmentName</span></span></th>
<th><span data-ttu-id="a3f81-953">EmployeeCount</span><span class="sxs-lookup"><span data-stu-id="a3f81-953">EmployeeCount</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="a3f81-954">department</span><span class="sxs-lookup"><span data-stu-id="a3f81-954">Department</span></span></td>
<td></td>
<td></td>
</tr>
</table>
</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="a3f81-955">EntityType</span><span class="sxs-lookup"><span data-stu-id="a3f81-955">EntityType</span></span></th>
<th><span data-ttu-id="a3f81-956">Nome</span><span class="sxs-lookup"><span data-stu-id="a3f81-956">FirstName</span></span></th>
<th><span data-ttu-id="a3f81-957">Sobrenome</span><span class="sxs-lookup"><span data-stu-id="a3f81-957">LastName</span></span></th>
<th><span data-ttu-id="a3f81-958">Idade</span><span class="sxs-lookup"><span data-stu-id="a3f81-958">Age</span></span></th>
<th><span data-ttu-id="a3f81-959">Email</span><span class="sxs-lookup"><span data-stu-id="a3f81-959">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="a3f81-960">Funcionário</span><span class="sxs-lookup"><span data-stu-id="a3f81-960">Employee</span></span></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</td>
</tr>
</table>

<span data-ttu-id="a3f81-961">primeira opção Hello, acrescentando toohello de tipo de entidade Olá **RowKey**, é útil se houver uma possibilidade de que duas entidades de tipos diferentes podem ter Olá mesmo valor de chave.</span><span class="sxs-lookup"><span data-stu-id="a3f81-961">hello first option, prepending hello entity type toohello **RowKey**, is useful if there is a possibility that two entities of different types might have hello same key value.</span></span> <span data-ttu-id="a3f81-962">Ele também agrupa entidades de mesmo tipo juntas na partição de saudação do hello.</span><span class="sxs-lookup"><span data-stu-id="a3f81-962">It also groups entities of hello same type together in hello partition.</span></span>  

<span data-ttu-id="a3f81-963">Olá, técnicas discutidas nesta seção são especialmente relevante toohello discussão [relacionamentos de herança](#inheritance-relationships) anteriormente neste guia, na seção de saudação [modelagem relações](#modelling-relationships).</span><span class="sxs-lookup"><span data-stu-id="a3f81-963">hello techniques discussed in this section are especially relevant toohello discussion [Inheritance relationships](#inheritance-relationships) earlier in this guide in hello section [Modelling relationships](#modelling-relationships).</span></span>  

> [!NOTE]
> <span data-ttu-id="a3f81-964">Você deve considerar incluir um número de versão no hello entidade valor tooenable cliente aplicativos tooevolve POCO objetos de tipo e funcionam com versões diferentes.</span><span class="sxs-lookup"><span data-stu-id="a3f81-964">You should consider including a version number in hello entity type value tooenable client applications tooevolve POCO objects and work with different versions.</span></span>  
> 
> 

<span data-ttu-id="a3f81-965">Olá restante desta seção descreve alguns dos recursos de saudação do hello biblioteca de cliente de armazenamento que facilitam a trabalhar com vários tipos de entidade Olá mesmo tabela.</span><span class="sxs-lookup"><span data-stu-id="a3f81-965">hello remainder of this section describes some of hello features in hello Storage Client Library that facilitate working with multiple entity types in hello same table.</span></span>  

#### <a name="retrieving-heterogeneous-entity-types"></a><span data-ttu-id="a3f81-966">Recuperando tipos de entidade heterogênea</span><span class="sxs-lookup"><span data-stu-id="a3f81-966">Retrieving heterogeneous entity types</span></span>
<span data-ttu-id="a3f81-967">Se você estiver usando Olá biblioteca de cliente de armazenamento, você tem três opções para trabalhar com vários tipos de entidade.</span><span class="sxs-lookup"><span data-stu-id="a3f81-967">If you are using hello Storage Client Library, you have three options for working with multiple entity types.</span></span>  

<span data-ttu-id="a3f81-968">Se você souber o tipo de saudação da entidade Olá armazenado com um determinado **RowKey** e **PartitionKey** valores, em seguida, você pode especificar o tipo de entidade hello quando você recupera entidade Olá conforme mostrado nos exemplos de saudação dois anterior que recuperar entidades do tipo **EmployeeEntity**: [executando uma consulta de ponto usando Olá biblioteca de cliente de armazenamento](#executing-a-point-query-using-the-storage-client-library) e [recuperar várias entidades usando o LINQ](#retrieving-multiple-entities-using-linq).</span><span class="sxs-lookup"><span data-stu-id="a3f81-968">If you know hello type of hello entity stored with a specific **RowKey** and **PartitionKey** values, then you can specify hello entity type when you retrieve hello entity as shown in hello previous two examples that retrieve entities of type **EmployeeEntity**: [Executing a point query using hello Storage Client Library](#executing-a-point-query-using-the-storage-client-library) and [Retrieving multiple entities using LINQ](#retrieving-multiple-entities-using-linq).</span></span>  

<span data-ttu-id="a3f81-969">Olá segunda opção é Olá toouse **DynamicTableEntity** tipo (um recipiente de propriedades) em vez de um tipo de entidade POCO concreto (essa opção pode também melhorar o desempenho porque não há nenhuma necessidade tooserialize e desserializar entidade Olá muito. Tipos de rede).</span><span class="sxs-lookup"><span data-stu-id="a3f81-969">hello second option is toouse hello **DynamicTableEntity** type (a property bag) instead of a concrete POCO entity type (this option may also improve performance because there is no need tooserialize and deserialize hello entity too.NET types).</span></span> <span data-ttu-id="a3f81-970">Olá código c# a seguir potencialmente recupera várias entidades de diferentes tipos de tabela Olá, mas retorna todas as entidades como **DynamicTableEntity** instâncias.</span><span class="sxs-lookup"><span data-stu-id="a3f81-970">hello following C# code potentially retrieves multiple entities of different types from hello table, but returns all entities as **DynamicTableEntity** instances.</span></span> <span data-ttu-id="a3f81-971">Ele então usa Olá **EntityType** propriedade toodetermine Olá tipo de cada entidade:</span><span class="sxs-lookup"><span data-stu-id="a3f81-971">It then uses hello **EntityType** property toodetermine hello type of each entity:</span></span>  

```csharp
string filter = TableQuery.CombineFilters(
    TableQuery.GenerateFilterCondition("PartitionKey",
    QueryComparisons.Equal, "Sales"),
    TableOperators.And,
    TableQuery.CombineFilters(
    TableQuery.GenerateFilterCondition("RowKey",
                    QueryComparisons.GreaterThanOrEqual, "B"),
        TableOperators.And,
        TableQuery.GenerateFilterCondition("RowKey",
        QueryComparisons.LessThan, "F")
    )
);
TableQuery<DynamicTableEntity> entityQuery =
    new TableQuery<DynamicTableEntity>().Where(filter);
var employees = employeeTable.ExecuteQuery(entityQuery);

IEnumerable<DynamicTableEntity> entities = employeeTable.ExecuteQuery(entityQuery);
foreach (var e in entities)
{
EntityProperty entityTypeProperty;
if (e.Properties.TryGetValue("EntityType", out entityTypeProperty))
{
    if (entityTypeProperty.StringValue == "Employee")
    {
        // Use entityTypeProperty, RowKey, PartitionKey, Etag, and Timestamp
        }
    }
}  
```

<span data-ttu-id="a3f81-972">Observe que tooretrieve outras propriedades, você deve usar o hello **TryGetValue** método hello **propriedades** propriedade Olá **DynamicTableEntity** classe.</span><span class="sxs-lookup"><span data-stu-id="a3f81-972">Note that tooretrieve other properties you must use hello **TryGetValue** method on hello **Properties** property of hello **DynamicTableEntity** class.</span></span>  

<span data-ttu-id="a3f81-973">Uma terceira opção é toocombine usando Olá **DynamicTableEntity** tipo e uma **EntityResolver** instância.</span><span class="sxs-lookup"><span data-stu-id="a3f81-973">A third option is toocombine using hello **DynamicTableEntity** type and an **EntityResolver** instance.</span></span> <span data-ttu-id="a3f81-974">Isso permite tooresolve toomultiple POCO tipos em Olá mesma consulta.</span><span class="sxs-lookup"><span data-stu-id="a3f81-974">This enables you tooresolve toomultiple POCO types in hello same query.</span></span> <span data-ttu-id="a3f81-975">Neste exemplo, Olá **EntityResolver** representante está usando Olá **EntityType** toodistinguish de propriedade entre tipos de saudação dois da entidade que Olá consulta retornará.</span><span class="sxs-lookup"><span data-stu-id="a3f81-975">In this example, hello **EntityResolver** delegate is using hello **EntityType** property toodistinguish between hello two types of entity that hello query returns.</span></span> <span data-ttu-id="a3f81-976">Olá **resolver** usa o método hello **resolvedor** delegar tooresolve **DynamicTableEntity** instâncias muito**TableEntity** instâncias.</span><span class="sxs-lookup"><span data-stu-id="a3f81-976">hello **Resolve** method uses hello **resolver** delegate tooresolve **DynamicTableEntity** instances too**TableEntity** instances.</span></span>  

```csharp
EntityResolver<TableEntity> resolver = (pk, rk, ts, props, etag) =>
{

        TableEntity resolvedEntity = null;
        if (props["EntityType"].StringValue == "Department")
        {
        resolvedEntity = new DepartmentEntity();
        }
        else if (props["EntityType"].StringValue == "Employee")
        {
        resolvedEntity = new EmployeeEntity();
        }
        else throw new ArgumentException("Unrecognized entity", "props");

        resolvedEntity.PartitionKey = pk;
        resolvedEntity.RowKey = rk;
        resolvedEntity.Timestamp = ts;
        resolvedEntity.ETag = etag;
        resolvedEntity.ReadEntity(props, null);
        return resolvedEntity;
};

string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, "Sales");
TableQuery<DynamicTableEntity> entityQuery =
        new TableQuery<DynamicTableEntity>().Where(filter);

var entities = employeeTable.ExecuteQuery(entityQuery, resolver);
foreach (var e in entities)
{
        if (e is DepartmentEntity)
        {
    ...
        }
        if (e is EmployeeEntity)
        {
    ...
        }
}  
```

#### <a name="modifying-heterogeneous-entity-types"></a><span data-ttu-id="a3f81-977">Modificando tipos de entidade heterogênea</span><span class="sxs-lookup"><span data-stu-id="a3f81-977">Modifying heterogeneous entity types</span></span>
<span data-ttu-id="a3f81-978">Tipo de saudação do tooknow de toodelete uma entidade não é necessário-e você sempre saiba tipo hello de uma entidade ao inseri-lo.</span><span class="sxs-lookup"><span data-stu-id="a3f81-978">You do not need tooknow hello type of an entity toodelete it, and you always know hello type of an entity when you insert it.</span></span> <span data-ttu-id="a3f81-979">No entanto, você pode usar **DynamicTableEntity** tooupdate uma entidade de tipo sem saber o tipo e sem usar uma classe de entidade POCO.</span><span class="sxs-lookup"><span data-stu-id="a3f81-979">However, you can use **DynamicTableEntity** type tooupdate an entity without knowing its type and without using a POCO entity class.</span></span> <span data-ttu-id="a3f81-980">Olá exemplo de código a seguir recupera uma entidade única e verifica Olá **EmployeeCount** propriedade existe antes da atualização.</span><span class="sxs-lookup"><span data-stu-id="a3f81-980">hello following code sample retrieves a single entity, and checks hello **EmployeeCount** property exists before updating it.</span></span>  

```csharp
TableResult result =
        employeeTable.Execute(TableOperation.Retrieve(partitionKey, rowKey));
DynamicTableEntity department = (DynamicTableEntity)result.Result;

EntityProperty countProperty;

if (!department.Properties.TryGetValue("EmployeeCount", out countProperty))
{
        throw new
        InvalidOperationException("Invalid entity, EmployeeCount property not found.");
}
countProperty.Int32Value += 1;
employeeTable.Execute(TableOperation.Merge(department));  
```

### <a name="controlling-access-with-shared-access-signatures"></a><span data-ttu-id="a3f81-981">Controlando o acesso com assinaturas de acesso compartilhado</span><span class="sxs-lookup"><span data-stu-id="a3f81-981">Controlling access with Shared Access Signatures</span></span>
<span data-ttu-id="a3f81-982">Você pode usar a assinatura de acesso compartilhado (SAS) tokens tooenable cliente aplicativos toomodify (e consultar) entidades de tabela diretamente sem Olá necessidade tooauthenticate diretamente com o serviço de tabela de saudação.</span><span class="sxs-lookup"><span data-stu-id="a3f81-982">You can use Shared Access Signature (SAS) tokens tooenable client applications toomodify (and query) table entities directly without hello need tooauthenticate directly with hello table service.</span></span> <span data-ttu-id="a3f81-983">Normalmente, há três principais vantagens toousing SAS em seu aplicativo:</span><span class="sxs-lookup"><span data-stu-id="a3f81-983">Typically, there are three main benefits toousing SAS in your application:</span></span>  

* <span data-ttu-id="a3f81-984">Você não precisa toodistribute seu armazenamento de conta tooan chave de plataforma inseguro (como um dispositivo móvel) em ordem tooallow tooaccess esse dispositivo e modificar entidades Olá serviço tabela.</span><span class="sxs-lookup"><span data-stu-id="a3f81-984">You do not need toodistribute your storage account key tooan insecure platform (such as a mobile device) in order tooallow that device tooaccess and modify entities in hello Table service.</span></span>  
* <span data-ttu-id="a3f81-985">Você pode descarregar a parte do trabalho de Olá web e executam funções de trabalho no gerenciamento de seus dispositivos de tooclient de entidades, como computadores de usuários finais e dispositivos móveis.</span><span class="sxs-lookup"><span data-stu-id="a3f81-985">You can offload some of hello work that web and worker roles perform in managing your entities tooclient devices such as end-user computers and mobile devices.</span></span>  
* <span data-ttu-id="a3f81-986">Você pode atribuir um restrita e tempo conjunto limitado de cliente de tooa de permissões (como permitir o acesso somente leitura toospecific recursos).</span><span class="sxs-lookup"><span data-stu-id="a3f81-986">You can assign a constrained and time limited set of permissions tooa client (such as allowing read-only access toospecific resources).</span></span>  

<span data-ttu-id="a3f81-987">Para obter mais informações sobre como usar tokens SAS com hello serviço tabela, consulte [usando assinaturas (SAS de acesso compartilhado)](../storage/common/storage-dotnet-shared-access-signature-part-1.md).</span><span class="sxs-lookup"><span data-stu-id="a3f81-987">For more information about using SAS tokens with hello Table service, see [Using Shared Access Signatures (SAS)](../storage/common/storage-dotnet-shared-access-signature-part-1.md).</span></span>  

<span data-ttu-id="a3f81-988">No entanto, você ainda deve gerar tokens SAS Olá que conceda um cliente entidades de toohello do aplicativo no serviço de tabela Olá: você deve fazer isso em um ambiente que tem acesso seguro tooyour chaves de conta de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="a3f81-988">However, you must still generate hello SAS tokens that grant a client application toohello entities in hello table service: you should do this in an environment that has secure access tooyour storage account keys.</span></span> <span data-ttu-id="a3f81-989">Normalmente, você pode usar uma web ou trabalho função toogenerate Olá SAS tokens e enviá-las toohello aplicativos de cliente que precisam acessar tooyour entidades.</span><span class="sxs-lookup"><span data-stu-id="a3f81-989">Typically, you use a web or worker role toogenerate hello SAS tokens and deliver them toohello client applications that need access tooyour entities.</span></span> <span data-ttu-id="a3f81-990">Porque ainda há uma sobrecarga envolvida na geração e entrega tooclients de tokens SAS, você deve considerar a melhor maneira de tooreduce essa sobrecarga, especialmente em cenários de alto volume.</span><span class="sxs-lookup"><span data-stu-id="a3f81-990">Because there is still an overhead involved in generating and delivering SAS tokens tooclients, you should consider how best tooreduce this overhead, especially in high-volume scenarios.</span></span>  

<span data-ttu-id="a3f81-991">É possível toogenerate um token SAS que concede acesso tooa subconjunto de entidades de saudação em uma tabela.</span><span class="sxs-lookup"><span data-stu-id="a3f81-991">It is possible toogenerate a SAS token that grants access tooa subset of hello entities in a table.</span></span> <span data-ttu-id="a3f81-992">Por padrão, você cria um token SAS para uma tabela inteira, mas também é possível toospecify tooeither de acesso de token grant que Olá SAS uma variedade de **PartitionKey** valores ou um intervalo de **PartitionKey** e  **RowKey** valores.</span><span class="sxs-lookup"><span data-stu-id="a3f81-992">By default, you create a SAS token for an entire table, but it is also possible toospecify that hello SAS token grant access tooeither a range of **PartitionKey** values, or a range of **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="a3f81-993">Você pode escolher toogenerate tokens SAS para usuários individuais do sistema, de modo que o token SAS de cada usuário só permite a eles acesso tootheir próprias entidades Olá serviço de tabela.</span><span class="sxs-lookup"><span data-stu-id="a3f81-993">You might choose toogenerate SAS tokens for individual users of your system such that each user's SAS token only allows them access tootheir own entities in hello table service.</span></span>  

### <a name="asynchronous-and-parallel-operations"></a><span data-ttu-id="a3f81-994">Operações paralelas e assíncronas</span><span class="sxs-lookup"><span data-stu-id="a3f81-994">Asynchronous and parallel operations</span></span>
<span data-ttu-id="a3f81-995">Desde que você esteja distribuindo suas solicitações por várias partições, pode melhorar a capacidade de resposta do cliente e a taxa de transferência usando consultas assíncronas ou paralelas.</span><span class="sxs-lookup"><span data-stu-id="a3f81-995">Provided you are spreading your requests across multiple partitions, you can improve throughput and client responsiveness by using asynchronous or parallel queries.</span></span>
<span data-ttu-id="a3f81-996">Por exemplo, você pode ter duas ou mais instâncias de função de trabalho acessando suas tabelas em paralelo.</span><span class="sxs-lookup"><span data-stu-id="a3f81-996">For example, you might have two or more worker role instances accessing your tables in parallel.</span></span> <span data-ttu-id="a3f81-997">Você pode ter funções de trabalho individuais responsáveis por determinados conjuntos de partições, ou simplesmente ter várias instâncias de função de trabalho, cada tooaccess capaz de todos os Olá partições em uma tabela.</span><span class="sxs-lookup"><span data-stu-id="a3f81-997">You could have individual worker roles responsible for particular sets of partitions, or simply have multiple worker role instances, each able tooaccess all hello partitions in a table.</span></span>  

<span data-ttu-id="a3f81-998">Dentro de uma instância do cliente, você pode melhorar o desempenho executando operações de armazenamento de forma assíncrona.</span><span class="sxs-lookup"><span data-stu-id="a3f81-998">Within a client instance, you can improve throughput by executing storage operations asynchronously.</span></span> <span data-ttu-id="a3f81-999">Olá biblioteca de cliente de armazenamento torna modificações e consultas assíncronas toowrite fácil.</span><span class="sxs-lookup"><span data-stu-id="a3f81-999">hello Storage Client Library makes it easy toowrite asynchronous queries and modifications.</span></span> <span data-ttu-id="a3f81-1000">Por exemplo, você pode iniciar com o método síncrono de saudação que recupera todas as entidades de saudação em uma partição, conforme mostrado no hello código c# a seguir:</span><span class="sxs-lookup"><span data-stu-id="a3f81-1000">For example, you might start with hello synchronous method that retrieves all hello entities in a partition as shown in hello following C# code:</span></span>  

```csharp
private static void ManyEntitiesQuery(CloudTable employeeTable, string department)
{
        string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, department);
        TableQuery<EmployeeEntity> employeeQuery =
        new TableQuery<EmployeeEntity>().Where(filter);

        TableContinuationToken continuationToken = null;

        do
        {
        var employees = employeeTable.ExecuteQuerySegmented(
                employeeQuery, continuationToken);
        foreach (var emp in employees)
    {
        ...
    }
        continuationToken = employees.ContinuationToken;
        } while (continuationToken != null);
}  
```

<span data-ttu-id="a3f81-1001">Você pode modificar este código facilmente para que essa consulta Olá executa de modo assíncrono da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="a3f81-1001">You can easily modify this code so that hello query runs asynchronously as follows:</span></span>  

```csharp
private static async Task ManyEntitiesQueryAsync(CloudTable employeeTable, string department)
{
        string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, department);
        TableQuery<EmployeeEntity> employeeQuery =
        new TableQuery<EmployeeEntity>().Where(filter);
        TableContinuationToken continuationToken = null;

        do
        {
        var employees = await employeeTable.ExecuteQuerySegmentedAsync(
                employeeQuery, continuationToken);
        foreach (var emp in employees)
        {
            ...
        }
        continuationToken = employees.ContinuationToken;
            } while (continuationToken != null);
}  
```

<span data-ttu-id="a3f81-1002">Neste exemplo assíncrona, você pode ver o seguinte Olá muda de versão síncrona hello:</span><span class="sxs-lookup"><span data-stu-id="a3f81-1002">In this asynchronous example, you can see hello following changes from hello synchronous version:</span></span>  

* <span data-ttu-id="a3f81-1003">a assinatura do método Hello agora inclui Olá **async** modificador e retorna um **tarefa** instância.</span><span class="sxs-lookup"><span data-stu-id="a3f81-1003">hello method signature now includes hello **async** modifier and returns a **Task** instance.</span></span>  
* <span data-ttu-id="a3f81-1004">Em vez de chamar hello **ExecuteSegmented** resultados do método tooretrieve, Olá método agora chamadas Olá **ExecuteSegmentedAsync** Olá método e usa **await** modificador tooretrieve resultados de forma assíncrona.</span><span class="sxs-lookup"><span data-stu-id="a3f81-1004">Instead of calling hello **ExecuteSegmented** method tooretrieve results, hello method now calls hello **ExecuteSegmentedAsync** method and uses hello **await** modifier tooretrieve results asynchronously.</span></span>  

<span data-ttu-id="a3f81-1005">aplicativo de cliente Hello pode chamar esse método várias vezes (com valores diferentes para Olá **departamento** parâmetro), e cada consulta será executada em um thread separado.</span><span class="sxs-lookup"><span data-stu-id="a3f81-1005">hello client application can call this method multiple times (with different values for hello **department** parameter), and each query will run on a separate thread.</span></span>  

<span data-ttu-id="a3f81-1006">Observe que não há nenhuma versão assíncrona do hello **Execute** método hello **TableQuery** classe porque Olá **IEnumerable** interface não dá suporte assíncrono enumeração.</span><span class="sxs-lookup"><span data-stu-id="a3f81-1006">Note that there is no asynchronous version of hello **Execute** method in hello **TableQuery** class because hello **IEnumerable** interface does not support asynchronous enumeration.</span></span>  

<span data-ttu-id="a3f81-1007">Você também pode inserir, atualizar e excluir entidades de forma assíncrona.</span><span class="sxs-lookup"><span data-stu-id="a3f81-1007">You can also insert, update, and delete entities asynchronously.</span></span> <span data-ttu-id="a3f81-1008">Olá c# de exemplo a seguir mostra um método simples e síncrona tooinsert ou substituir uma entidade funcionário:</span><span class="sxs-lookup"><span data-stu-id="a3f81-1008">hello following C# example shows a simple, synchronous method tooinsert or replace an employee entity:</span></span>  

```csharp
private static void SimpleEmployeeUpsert(CloudTable employeeTable,
        EmployeeEntity employee)
{
        TableResult result = employeeTable
        .Execute(TableOperation.InsertOrReplace(employee));
        Console.WriteLine("HTTP Status: {0}", result.HttpStatusCode);
}  
```

<span data-ttu-id="a3f81-1009">Facilmente, você pode modificar este código para que a atualização de saudação executa de modo assíncrono da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="a3f81-1009">You can easily modify this code so that hello update runs asynchronously as follows:</span></span>  

```csharp
private static async Task SimpleEmployeeUpsertAsync(CloudTable employeeTable,
        EmployeeEntity employee)
{
        TableResult result = await employeeTable
        .ExecuteAsync(TableOperation.InsertOrReplace(employee));
        Console.WriteLine("HTTP Status: {0}", result.HttpStatusCode);
}  
```

<span data-ttu-id="a3f81-1010">Neste exemplo assíncrona, você pode ver o seguinte Olá muda de versão síncrona hello:</span><span class="sxs-lookup"><span data-stu-id="a3f81-1010">In this asynchronous example, you can see hello following changes from hello synchronous version:</span></span>  

* <span data-ttu-id="a3f81-1011">a assinatura do método Hello agora inclui Olá **async** modificador e retorna um **tarefa** instância.</span><span class="sxs-lookup"><span data-stu-id="a3f81-1011">hello method signature now includes hello **async** modifier and returns a **Task** instance.</span></span>  
* <span data-ttu-id="a3f81-1012">Em vez de chamar hello **Execute** entidade do método tooupdate hello, Olá método agora chamadas Olá **ExecuteAsync** Olá método e usa **await** tooretrieve de modificador resultados de forma assíncrona.</span><span class="sxs-lookup"><span data-stu-id="a3f81-1012">Instead of calling hello **Execute** method tooupdate hello entity, hello method now calls hello **ExecuteAsync** method and uses hello **await** modifier tooretrieve results asynchronously.</span></span>  

<span data-ttu-id="a3f81-1013">aplicativo de cliente Hello pode chamar vários métodos assíncronos como esse, e cada invocação do método será executado em um thread separado.</span><span class="sxs-lookup"><span data-stu-id="a3f81-1013">hello client application can call multiple asynchronous methods like this one, and each method invocation will run on a separate thread.</span></span>  

### <a name="credits"></a><span data-ttu-id="a3f81-1014">Credits</span><span class="sxs-lookup"><span data-stu-id="a3f81-1014">Credits</span></span>
<span data-ttu-id="a3f81-1015">Gostaríamos Olá toothank membros da equipe do Azure para suas contribuições de saudação a seguir: Dominic Betts, Jason Hogg, Jean Ghanem, Jai Haridas, Jeff Irwin, Vamshidhar Kommineni, Vinay Shah e Serdar Ozler, bem como Tom Hollander da Microsoft DX.</span><span class="sxs-lookup"><span data-stu-id="a3f81-1015">We would like toothank hello following members of hello Azure team for their contributions: Dominic Betts, Jason Hogg, Jean Ghanem, Jai Haridas, Jeff Irwin, Vamshidhar Kommineni, Vinay Shah and Serdar Ozler as well as  Tom Hollander from Microsoft DX.</span></span> 

<span data-ttu-id="a3f81-1016">Também gostaríamos toothank saudação MVP da Microsoft a seguir para seus valiosos comentários durante ciclos de revisão: Igor Papirov e Edward Bakker.</span><span class="sxs-lookup"><span data-stu-id="a3f81-1016">We would also like toothank hello following Microsoft MVP's for their valuable feedback during review cycles: Igor Papirov and Edward Bakker.</span></span>

[1]: ./media/storage-table-design-guide/storage-table-design-IMAGE01.png
[2]: ./media/storage-table-design-guide/storage-table-design-IMAGE02.png
[3]: ./media/storage-table-design-guide/storage-table-design-IMAGE03.png
[4]: ./media/storage-table-design-guide/storage-table-design-IMAGE04.png
[5]: ./media/storage-table-design-guide/storage-table-design-IMAGE05.png
[6]: ./media/storage-table-design-guide/storage-table-design-IMAGE06.png
[7]: ./media/storage-table-design-guide/storage-table-design-IMAGE07.png
[8]: ./media/storage-table-design-guide/storage-table-design-IMAGE08.png
[9]: ./media/storage-table-design-guide/storage-table-design-IMAGE09.png
[10]: ./media/storage-table-design-guide/storage-table-design-IMAGE10.png
[11]: ./media/storage-table-design-guide/storage-table-design-IMAGE11.png
[12]: ./media/storage-table-design-guide/storage-table-design-IMAGE12.png
[13]: ./media/storage-table-design-guide/storage-table-design-IMAGE13.png
[14]: ./media/storage-table-design-guide/storage-table-design-IMAGE14.png
[15]: ./media/storage-table-design-guide/storage-table-design-IMAGE15.png
[16]: ./media/storage-table-design-guide/storage-table-design-IMAGE16.png
[17]: ./media/storage-table-design-guide/storage-table-design-IMAGE17.png
[18]: ./media/storage-table-design-guide/storage-table-design-IMAGE18.png
[19]: ./media/storage-table-design-guide/storage-table-design-IMAGE19.png
[20]: ./media/storage-table-design-guide/storage-table-design-IMAGE20.png
[21]: ./media/storage-table-design-guide/storage-table-design-IMAGE21.png
[22]: ./media/storage-table-design-guide/storage-table-design-IMAGE22.png
[23]: ./media/storage-table-design-guide/storage-table-design-IMAGE23.png
[24]: ./media/storage-table-design-guide/storage-table-design-IMAGE24.png
[25]: ./media/storage-table-design-guide/storage-table-design-IMAGE25.png
[26]: ./media/storage-table-design-guide/storage-table-design-IMAGE26.png
[27]: ./media/storage-table-design-guide/storage-table-design-IMAGE27.png
[28]: ./media/storage-table-design-guide/storage-table-design-IMAGE28.png
[29]: ./media/storage-table-design-guide/storage-table-design-IMAGE29.png

