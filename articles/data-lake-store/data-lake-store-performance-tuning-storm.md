---
title: "diretrizes de ajuste de desempenho de Data Lake repositório profusão de aaaAzure | Microsoft Docs"
description: Diretrizes de ajuste de desempenho para Storm do Azure Data Lake Store
services: data-lake-store
documentationcenter: 
author: stewu
manager: amitkul
editor: stewu
ms.assetid: ebde7b9f-2e51-4d43-b7ab-566417221335
ms.service: data-lake-store
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 12/19/2016
ms.author: stewu
ms.openlocfilehash: 5412fd46cf2373f5877030913df4fe1fc6f5473a
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2017
---
# <a name="performance-tuning-guidance-for-storm-on-hdinsight-and-azure-data-lake-store"></a><span data-ttu-id="1ec94-103">Diretrizes de ajuste do desempenho para Storm no HDInsight e Azure Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="1ec94-103">Performance tuning guidance for Storm on HDInsight and Azure Data Lake Store</span></span>

<span data-ttu-id="1ec94-104">Entenda os fatores de saudação que devem ser considerados ao ajustar o desempenho de saudação de uma topologia de profusão do Azure.</span><span class="sxs-lookup"><span data-stu-id="1ec94-104">Understand hello factors that should be considered when you tune hello performance of an Azure Storm topology.</span></span> <span data-ttu-id="1ec94-105">Por exemplo, é importante toounderstand características de saudação do trabalho Olá Olá spouts e parafusos hello (se o trabalho de saudação é intensivo de memória ou e/s).</span><span class="sxs-lookup"><span data-stu-id="1ec94-105">For example, it's important toounderstand hello characteristics of hello work done by hello spouts and hello bolts (whether hello work is I/O or memory intensive).</span></span> <span data-ttu-id="1ec94-106">Este artigo abrange uma gama de diretrizes de ajuste de desempenho, incluindo a solução de problemas comuns.</span><span class="sxs-lookup"><span data-stu-id="1ec94-106">This article covers a range of performance tuning guidelines, including troubleshooting common issues.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="1ec94-107">Pré-requisitos</span><span class="sxs-lookup"><span data-stu-id="1ec94-107">Prerequisites</span></span>

* <span data-ttu-id="1ec94-108">**Uma assinatura do Azure**.</span><span class="sxs-lookup"><span data-stu-id="1ec94-108">**An Azure subscription**.</span></span> <span data-ttu-id="1ec94-109">Consulte [Obter avaliação gratuita do Azure](https://azure.microsoft.com/pricing/free-trial/).</span><span class="sxs-lookup"><span data-stu-id="1ec94-109">See [Get Azure free trial](https://azure.microsoft.com/pricing/free-trial/).</span></span>
* <span data-ttu-id="1ec94-110">**Uma conta do repositório Azure Data Lake**.</span><span class="sxs-lookup"><span data-stu-id="1ec94-110">**An Azure Data Lake Store account**.</span></span> <span data-ttu-id="1ec94-111">Para obter instruções sobre como um, ver toocreate [Introdução ao repositório Azure Data Lake](data-lake-store-get-started-portal.md).</span><span class="sxs-lookup"><span data-stu-id="1ec94-111">For instructions on how toocreate one, see [Get started with Azure Data Lake Store](data-lake-store-get-started-portal.md).</span></span>
* <span data-ttu-id="1ec94-112">**Um cluster Azure HDInsight** com acesso tooa conta do repositório Data Lake.</span><span class="sxs-lookup"><span data-stu-id="1ec94-112">**An Azure HDInsight cluster** with access tooa Data Lake Store account.</span></span> <span data-ttu-id="1ec94-113">Confira [Criar um cluster HDInsight com o Data Lake Store](data-lake-store-hdinsight-hadoop-use-portal.md).</span><span class="sxs-lookup"><span data-stu-id="1ec94-113">See [Create an HDInsight cluster with Data Lake Store](data-lake-store-hdinsight-hadoop-use-portal.md).</span></span> <span data-ttu-id="1ec94-114">Verifique se que você habilitar a área de trabalho remota para o cluster de saudação.</span><span class="sxs-lookup"><span data-stu-id="1ec94-114">Make sure you enable Remote Desktop for hello cluster.</span></span>
* <span data-ttu-id="1ec94-115">**Executando um cluster Storm no Data Lake Store**.</span><span class="sxs-lookup"><span data-stu-id="1ec94-115">**Running a Storm cluster on Data Lake Store**.</span></span> <span data-ttu-id="1ec94-116">Para obter mais informações, consulte [Storm no HDInsight](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-storm-overview).</span><span class="sxs-lookup"><span data-stu-id="1ec94-116">For more information, see [Storm on HDInsight](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-storm-overview).</span></span>
* <span data-ttu-id="1ec94-117">**Diretrizes de ajuste de desempenho do Data Lake Store**.</span><span class="sxs-lookup"><span data-stu-id="1ec94-117">**Performance tuning guidelines on Data Lake Store**.</span></span>  <span data-ttu-id="1ec94-118">Para ver conceitos gerais de desempenho, consulte [Diretrizes de ajuste de desempenho do Data Lake Store](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance).</span><span class="sxs-lookup"><span data-stu-id="1ec94-118">For general performance concepts, see [Data Lake Store Performance Tuning Guidance](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance).</span></span>  

## <a name="tune-hello-parallelism-of-hello-topology"></a><span data-ttu-id="1ec94-119">Ajustar o paralelismo de saudação da topologia de saudação</span><span class="sxs-lookup"><span data-stu-id="1ec94-119">Tune hello parallelism of hello topology</span></span>

<span data-ttu-id="1ec94-120">Você pode ser capaz de tooimprove desempenho por cada vez maior simultaneidade de saudação de tooand de e/s de saudação do repositório Data Lake.</span><span class="sxs-lookup"><span data-stu-id="1ec94-120">You might be able tooimprove performance by increasing hello concurrency of hello I/O tooand from Data Lake Store.</span></span> <span data-ttu-id="1ec94-121">Uma topologia Storm tem um conjunto de configurações que determinam o paralelismo hello:</span><span class="sxs-lookup"><span data-stu-id="1ec94-121">A Storm topology has a set of configurations that determine hello parallelism:</span></span>
* <span data-ttu-id="1ec94-122">Número de processos do operador (trabalhadores Olá são distribuídos uniformemente por Olá VMs).</span><span class="sxs-lookup"><span data-stu-id="1ec94-122">Number of worker processes (hello workers are evenly distributed across hello VMs).</span></span>
* <span data-ttu-id="1ec94-123">Número de instâncias de executor de spout.</span><span class="sxs-lookup"><span data-stu-id="1ec94-123">Number of spout executor instances.</span></span>
* <span data-ttu-id="1ec94-124">Número de instâncias de bolt executor.</span><span class="sxs-lookup"><span data-stu-id="1ec94-124">Number of bolt executor instances.</span></span>
* <span data-ttu-id="1ec94-125">Número de tarefas de spout.</span><span class="sxs-lookup"><span data-stu-id="1ec94-125">Number of spout tasks.</span></span>
* <span data-ttu-id="1ec94-126">Número de tarefas de bolt.</span><span class="sxs-lookup"><span data-stu-id="1ec94-126">Number of bolt tasks.</span></span>

<span data-ttu-id="1ec94-127">Por exemplo, em um cluster com 4 VMs e 4 processos de trabalho, 32 spout executores e 32 spout tarefas e 256 executores de raio e tarefas de raio 512, considere o seguinte de saudação:</span><span class="sxs-lookup"><span data-stu-id="1ec94-127">For example, on a cluster with 4 VMs and 4 worker processes, 32 spout executors and 32 spout tasks, and 256 bolt executors and 512 bolt tasks, consider hello following:</span></span>

<span data-ttu-id="1ec94-128">Cada supervisor, que é um nó de trabalho, tem um único processo de trabalho de máquina virtual Java (JVM).</span><span class="sxs-lookup"><span data-stu-id="1ec94-128">Each supervisor, which is a worker node, has a single worker Java virtual machine (JVM) process.</span></span> <span data-ttu-id="1ec94-129">Esse processo JVM gerencia 4 threads de spout e 64 threads de bolt.</span><span class="sxs-lookup"><span data-stu-id="1ec94-129">This JVM process manages 4 spout threads and 64 bolt threads.</span></span> <span data-ttu-id="1ec94-130">Em cada thread, as tarefas são executadas sequencialmente.</span><span class="sxs-lookup"><span data-stu-id="1ec94-130">Within each thread, tasks are run sequentially.</span></span> <span data-ttu-id="1ec94-131">Com hello anterior de configuração, cada thread spout tem 1 tarefa e cada thread de raio tem 2 tarefas.</span><span class="sxs-lookup"><span data-stu-id="1ec94-131">With hello preceding configuration, each spout thread has 1 task, and each bolt thread has 2 tasks.</span></span>

<span data-ttu-id="1ec94-132">No Storm, aqui está Olá vários componentes envolvidos e como eles afetam o nível de saudação de paralelismo, que você tem:</span><span class="sxs-lookup"><span data-stu-id="1ec94-132">In Storm, here are hello various components involved, and how they affect hello level of parallelism you have:</span></span>
* <span data-ttu-id="1ec94-133">nó principal da saudação (chamado Nimbus no Storm) é usado toosubmit e gerenciar trabalhos.</span><span class="sxs-lookup"><span data-stu-id="1ec94-133">hello head node (called Nimbus in Storm) is used toosubmit and manage jobs.</span></span> <span data-ttu-id="1ec94-134">Esses nós não têm impacto sobre o grau de paralelismo hello.</span><span class="sxs-lookup"><span data-stu-id="1ec94-134">These nodes have no impact on hello degree of parallelism.</span></span>
* <span data-ttu-id="1ec94-135">nós de supervisor Hello.</span><span class="sxs-lookup"><span data-stu-id="1ec94-135">hello supervisor nodes.</span></span> <span data-ttu-id="1ec94-136">Em HDInsight, isso corresponde nó de trabalho tooa VM do Azure.</span><span class="sxs-lookup"><span data-stu-id="1ec94-136">In HDInsight, this corresponds tooa worker node Azure VM.</span></span>
* <span data-ttu-id="1ec94-137">tarefas do trabalhador Olá são processos de Storm Olá VMs que executam.</span><span class="sxs-lookup"><span data-stu-id="1ec94-137">hello worker tasks are Storm processes running in hello VMs.</span></span> <span data-ttu-id="1ec94-138">Cada tarefa de trabalho corresponde a instância do tooa da JVM.</span><span class="sxs-lookup"><span data-stu-id="1ec94-138">Each worker task corresponds tooa JVM instance.</span></span> <span data-ttu-id="1ec94-139">Tempestade distribui o número de saudação de processos de trabalho você especificar nós de trabalho toohello maneira mais uniforme possível.</span><span class="sxs-lookup"><span data-stu-id="1ec94-139">Storm distributes hello number of worker processes you specify toohello worker nodes as evenly as possible.</span></span>
* <span data-ttu-id="1ec94-140">Instâncias de executores de bolt e spout.</span><span class="sxs-lookup"><span data-stu-id="1ec94-140">Spout and bolt executor instances.</span></span> <span data-ttu-id="1ec94-141">Cada instância do executor corresponde tooa thread em execução dentro de trabalhadores hello (JVMs).</span><span class="sxs-lookup"><span data-stu-id="1ec94-141">Each executor instance corresponds tooa thread running within hello workers (JVMs).</span></span>
* <span data-ttu-id="1ec94-142">Tarefas do Storm.</span><span class="sxs-lookup"><span data-stu-id="1ec94-142">Storm tasks.</span></span> <span data-ttu-id="1ec94-143">Essas são tarefas lógicas que cada um desses threads executa.</span><span class="sxs-lookup"><span data-stu-id="1ec94-143">These are logical tasks that each of these threads run.</span></span> <span data-ttu-id="1ec94-144">Isso não altera o nível de saudação de paralelismo, portanto você deve avaliar se precisar de várias tarefas por executor ou não.</span><span class="sxs-lookup"><span data-stu-id="1ec94-144">This does not change hello level of parallelism, so you should evaluate if you need multiple tasks per executor or not.</span></span>

### <a name="get-hello-best-performance-from-data-lake-store"></a><span data-ttu-id="1ec94-145">Obter um melhor desempenho de saudação do repositório Data Lake</span><span class="sxs-lookup"><span data-stu-id="1ec94-145">Get hello best performance from Data Lake Store</span></span>

<span data-ttu-id="1ec94-146">Ao trabalhar com o repositório Data Lake, você obter Olá melhor desempenho se você Olá a seguir:</span><span class="sxs-lookup"><span data-stu-id="1ec94-146">When working with Data Lake Store, you get hello best performance if you do hello following:</span></span>
* <span data-ttu-id="1ec94-147">Una seus pequenos acréscimos em tamanhos maiores (o ideal é 4 MB).</span><span class="sxs-lookup"><span data-stu-id="1ec94-147">Coalesce your small appends into larger sizes (ideally 4 MB).</span></span>
* <span data-ttu-id="1ec94-148">Faça o máximo possível de solicitações simultâneas.</span><span class="sxs-lookup"><span data-stu-id="1ec94-148">Do as many concurrent requests as you can.</span></span> <span data-ttu-id="1ec94-149">Como cada thread de raio está fazendo o bloqueio de leituras, convém toohave em algum lugar no intervalo de saudação de 8 a 12 threads por núcleo.</span><span class="sxs-lookup"><span data-stu-id="1ec94-149">Because each bolt thread is doing blocking reads, you want toohave somewhere in hello range of 8-12 threads per core.</span></span> <span data-ttu-id="1ec94-150">Isso mantém a CPU NIC e Olá Olá utilizada.</span><span class="sxs-lookup"><span data-stu-id="1ec94-150">This keeps hello NIC and hello CPU well utilized.</span></span> <span data-ttu-id="1ec94-151">Uma VM maior permite mais solicitações simultâneas.</span><span class="sxs-lookup"><span data-stu-id="1ec94-151">A larger VM enables more concurrent requests.</span></span>  

### <a name="example-topology"></a><span data-ttu-id="1ec94-152">Exemplo de topologia</span><span class="sxs-lookup"><span data-stu-id="1ec94-152">Example topology</span></span>

<span data-ttu-id="1ec94-153">Suponhamos que você tenha um cluster de 8 nós de trabalho com a VM D13v2 do Azure.</span><span class="sxs-lookup"><span data-stu-id="1ec94-153">Let’s assume you have an 8 worker node cluster with a D13v2 Azure VM.</span></span> <span data-ttu-id="1ec94-154">Essa VM tenha 8 núcleos, portanto entre Olá 8 nós de trabalho, você tem 64 núcleos total.</span><span class="sxs-lookup"><span data-stu-id="1ec94-154">This VM has 8 cores, so among hello 8 worker nodes, you have 64 total cores.</span></span>

<span data-ttu-id="1ec94-155">Digamos que façamos oito threads de bolt por núcleo.</span><span class="sxs-lookup"><span data-stu-id="1ec94-155">Let’s say we do 8 bolt threads per core.</span></span> <span data-ttu-id="1ec94-156">Dados 64 núcleos, isso significa que desejamos um total de 512 instâncias de executor de bolt (ou seja, threads).</span><span class="sxs-lookup"><span data-stu-id="1ec94-156">Given 64 cores, that means we want 512 total bolt executor instances (that is, threads).</span></span> <span data-ttu-id="1ec94-157">Nesse caso, digamos que podemos começar com uma JVM por VM e use principalmente a simultaneidade de thread hello dentro de simultaneidade de tooachieve JVM hello.</span><span class="sxs-lookup"><span data-stu-id="1ec94-157">In this case, let’s say we start with one JVM per VM, and mainly use hello thread concurrency within hello JVM tooachieve concurrency.</span></span> <span data-ttu-id="1ec94-158">Isso significa que precisamos de oito tarefas de trabalho (uma por VM do Azure) e 512 executores de bolt.</span><span class="sxs-lookup"><span data-stu-id="1ec94-158">That means we need 8 worker tasks (one per Azure VM), and 512 bolt executors.</span></span> <span data-ttu-id="1ec94-159">Dada essa configuração, tempestade tenta trabalhadores de saudação toodistribute uniformemente entre nós de trabalho (também conhecidos como nós de supervisor), dando a cada nó de trabalho 1 JVM.</span><span class="sxs-lookup"><span data-stu-id="1ec94-159">Given this configuration, Storm tries toodistribute hello workers evenly across worker nodes (also known as supervisor nodes), giving each worker node 1 JVM.</span></span> <span data-ttu-id="1ec94-160">Agora dentro de supervisores hello, tempestade tenta toodistribute executores de saudação uniformemente entre os supervisores, dando a cada supervisor (ou seja, JVM) 8 threads de cada.</span><span class="sxs-lookup"><span data-stu-id="1ec94-160">Now within hello supervisors, Storm tries toodistribute hello executors evenly between supervisors, giving each supervisor (that is, JVM) 8 threads each.</span></span>

## <a name="tune-additional-parameters"></a><span data-ttu-id="1ec94-161">Ajuste de parâmetros adicionais</span><span class="sxs-lookup"><span data-stu-id="1ec94-161">Tune additional parameters</span></span>
<span data-ttu-id="1ec94-162">Depois de ter topologia básica hello, você pode considerar se deseja tootweak qualquer um dos parâmetros de saudação:</span><span class="sxs-lookup"><span data-stu-id="1ec94-162">After you have hello basic topology, you can consider whether you want tootweak any of hello parameters:</span></span>
* <span data-ttu-id="1ec94-163">**Número de JVMs por nó de trabalho.**</span><span class="sxs-lookup"><span data-stu-id="1ec94-163">**Number of JVMs per worker node.**</span></span> <span data-ttu-id="1ec94-164">Se você tiver uma grande estrutura de dados (por exemplo, uma tabela de pesquisa) hospedada na memória, cada JVM vai precisar de uma cópia separada.</span><span class="sxs-lookup"><span data-stu-id="1ec94-164">If you have a large data structure (for example, a lookup table) that you host in memory, each JVM requires a separate copy.</span></span> <span data-ttu-id="1ec94-165">Como alternativa, você pode usar estrutura de dados de saudação entre vários threads se você tiver menos JVMs.</span><span class="sxs-lookup"><span data-stu-id="1ec94-165">Alternatively, you can use hello data structure across many threads if you have fewer JVMs.</span></span> <span data-ttu-id="1ec94-166">Para e/s do raio hello, Olá número de JVMs não faz muito de uma diferença como número de saudação de threads adicionado entre esses JVMs.</span><span class="sxs-lookup"><span data-stu-id="1ec94-166">For hello bolt’s I/O, hello number of JVMs does not make as much of a difference as hello number of threads added across those JVMs.</span></span> <span data-ttu-id="1ec94-167">Para simplificar, é toohave uma boa ideia uma JVM por trabalho.</span><span class="sxs-lookup"><span data-stu-id="1ec94-167">For simplicity, it's a good idea toohave one JVM per worker.</span></span> <span data-ttu-id="1ec94-168">Dependendo de qual aplicativo de processamento ou de que está fazendo o raio requer, no entanto, talvez seja necessário toochange esse número.</span><span class="sxs-lookup"><span data-stu-id="1ec94-168">Depending on what your bolt is doing or what application processing you require, though, you may need toochange this number.</span></span>
* <span data-ttu-id="1ec94-169">**Número de executores de spout.**</span><span class="sxs-lookup"><span data-stu-id="1ec94-169">**Number of spout executors.**</span></span> <span data-ttu-id="1ec94-170">Como hello exemplo anterior usa parafusos para gravar o repositório de Lake tooData, número de saudação de spouts não é desempenho de raio toohello diretamente relevantes.</span><span class="sxs-lookup"><span data-stu-id="1ec94-170">Because hello preceding example uses bolts for writing tooData Lake Store, hello number of spouts is not directly relevant toohello bolt performance.</span></span> <span data-ttu-id="1ec94-171">No entanto, dependendo da quantidade de saudação de processamento ou e/s ocorrendo no spout Olá, é uma boa ideia Olá tootune spouts para melhor desempenho.</span><span class="sxs-lookup"><span data-stu-id="1ec94-171">However, depending on hello amount of processing or I/O happening in hello spout, it's a good idea tootune hello spouts for best performance.</span></span> <span data-ttu-id="1ec94-172">Certifique-se de que você tem suficiente spouts toobe tookeep capaz de saudação parafusos ocupado.</span><span class="sxs-lookup"><span data-stu-id="1ec94-172">Ensure that you have enough spouts toobe able tookeep hello bolts busy.</span></span> <span data-ttu-id="1ec94-173">Olá taxas de saída de hello spouts devem corresponder a taxa de transferência de saudação do hello parafusos.</span><span class="sxs-lookup"><span data-stu-id="1ec94-173">hello output rates of hello spouts should match hello throughput of hello bolts.</span></span> <span data-ttu-id="1ec94-174">configuração real Olá depende spout hello.</span><span class="sxs-lookup"><span data-stu-id="1ec94-174">hello actual configuration depends on hello spout.</span></span>
* <span data-ttu-id="1ec94-175">**Número de tarefas.**</span><span class="sxs-lookup"><span data-stu-id="1ec94-175">**Number of tasks.**</span></span> <span data-ttu-id="1ec94-176">Cada bolt é executado como um único thread.</span><span class="sxs-lookup"><span data-stu-id="1ec94-176">Each bolt runs as a single thread.</span></span> <span data-ttu-id="1ec94-177">Tarefas adicionais por bolt não fornecem simultaneidade adicional.</span><span class="sxs-lookup"><span data-stu-id="1ec94-177">Additional tasks per bolt don't provide any additional concurrency.</span></span> <span data-ttu-id="1ec94-178">Olá único momento em que eles sejam do benefício é se o processo de confirmar Olá tupla terá uma grande proporção de seu tempo de execução de raio.</span><span class="sxs-lookup"><span data-stu-id="1ec94-178">hello only time they are of benefit is if your process of acknowledging hello tuple takes a large proportion of your bolt execution time.</span></span> <span data-ttu-id="1ec94-179">É um toogroup boa ideia que muitos tuplas em um maior acrescentar antes de enviar uma confirmação de rolo hello.</span><span class="sxs-lookup"><span data-stu-id="1ec94-179">It's a good idea toogroup many tuples into a larger append before you send an acknowledgement from hello bolt.</span></span> <span data-ttu-id="1ec94-180">Portanto, na maioria dos casos, várias tarefas não oferecem qualquer benefício adicional.</span><span class="sxs-lookup"><span data-stu-id="1ec94-180">So, in most cases, multiple tasks provide no additional benefit.</span></span>
* <span data-ttu-id="1ec94-181">**Agrupamento local ou aleatório.**</span><span class="sxs-lookup"><span data-stu-id="1ec94-181">**Local or shuffle grouping.**</span></span> <span data-ttu-id="1ec94-182">Quando essa configuração é habilitada, tuplas são enviadas toobolts dentro Olá mesmo processo de trabalho.</span><span class="sxs-lookup"><span data-stu-id="1ec94-182">When this setting is enabled, tuples are sent toobolts within hello same worker process.</span></span> <span data-ttu-id="1ec94-183">Isso reduz as chamadas de rede e comunicação entre processos.</span><span class="sxs-lookup"><span data-stu-id="1ec94-183">This reduces inter-process communication and network calls.</span></span> <span data-ttu-id="1ec94-184">Isso é recomendado para a maioria das topologias.</span><span class="sxs-lookup"><span data-stu-id="1ec94-184">This is recommended for most topologies.</span></span>

<span data-ttu-id="1ec94-185">Esse cenário básico é um bom ponto de partida.</span><span class="sxs-lookup"><span data-stu-id="1ec94-185">This basic scenario is a good starting point.</span></span> <span data-ttu-id="1ec94-186">Teste com seu próprios Olá de tootweak dados precede o desempenho ideal de tooachieve de parâmetros.</span><span class="sxs-lookup"><span data-stu-id="1ec94-186">Test with your own data tootweak hello preceding parameters tooachieve optimal performance.</span></span>

## <a name="tune-hello-spout"></a><span data-ttu-id="1ec94-187">Ajustar spout Olá</span><span class="sxs-lookup"><span data-stu-id="1ec94-187">Tune hello spout</span></span>

<span data-ttu-id="1ec94-188">Você pode modificar Olá configurações tootune Olá spout a seguir.</span><span class="sxs-lookup"><span data-stu-id="1ec94-188">You can modify hello following settings tootune hello spout.</span></span>

- <span data-ttu-id="1ec94-189">**Tempo limite de tupla: topology.message.timeout.secs**.</span><span class="sxs-lookup"><span data-stu-id="1ec94-189">**Tuple timeout: topology.message.timeout.secs**.</span></span> <span data-ttu-id="1ec94-190">Essa configuração determina a quantidade de saudação de tempo uma mensagem toocomplete e receber a confirmação, antes que ela seja considerada falha.</span><span class="sxs-lookup"><span data-stu-id="1ec94-190">This setting determines hello amount of time a message takes toocomplete, and receive acknowledgement, before it is considered failed.</span></span>

- <span data-ttu-id="1ec94-191">**Memória máxima por processo de trabalho: worker.childopts**.</span><span class="sxs-lookup"><span data-stu-id="1ec94-191">**Max memory per worker process: worker.childopts**.</span></span> <span data-ttu-id="1ec94-192">Essa configuração permite que você especifique trabalhadores de Java toohello parâmetros de linha de comando adicionais.</span><span class="sxs-lookup"><span data-stu-id="1ec94-192">This setting lets you specify additional command-line parameters toohello Java workers.</span></span> <span data-ttu-id="1ec94-193">Olá usado mais comumente configuração aqui é XmX, que determina o heap da JVM do tooa Olá máximo da memória alocada.</span><span class="sxs-lookup"><span data-stu-id="1ec94-193">hello most commonly used setting here is XmX, which determines hello maximum memory allocated tooa JVM’s heap.</span></span>

- <span data-ttu-id="1ec94-194">**Máx. de spouts pendentes: topology.max.spout.pending**.</span><span class="sxs-lookup"><span data-stu-id="1ec94-194">**Max spout pending: topology.max.spout.pending**.</span></span> <span data-ttu-id="1ec94-195">Essa configuração determina o número de saudação de tuplas no podem ser voo (ainda não confirmado em todos os nós na topologia Olá) por thread spout a qualquer momento.</span><span class="sxs-lookup"><span data-stu-id="1ec94-195">This setting determines hello number of tuples that can in be flight (not yet acknowledged at all nodes in hello topology) per spout thread at any time.</span></span>

 <span data-ttu-id="1ec94-196">Toodo um cálculo BOM é o tamanho de saudação do tooestimate de cada um dos seus tuplas.</span><span class="sxs-lookup"><span data-stu-id="1ec94-196">A good calculation toodo is tooestimate hello size of each of your tuples.</span></span> <span data-ttu-id="1ec94-197">Em seguida, calcule quanta memória um thread de spout tem.</span><span class="sxs-lookup"><span data-stu-id="1ec94-197">Then figure out how much memory one spout thread has.</span></span> <span data-ttu-id="1ec94-198">Olá memória total alocada tooa thread, dividido por esse valor, deverá lhe fornecer Olá limite superior spout máximo de saudação pendentes parâmetro.</span><span class="sxs-lookup"><span data-stu-id="1ec94-198">hello total memory allocated tooa thread, divided by this value, should give you hello upper bound for hello max spout pending parameter.</span></span>

## <a name="tune-hello-bolt"></a><span data-ttu-id="1ec94-199">Ajustar a isoladas Olá</span><span class="sxs-lookup"><span data-stu-id="1ec94-199">Tune hello bolt</span></span>
<span data-ttu-id="1ec94-200">Quando você está escrevendo o repositório de Lake tooData, definir uma política de sincronização de tamanho (buffer no lado do cliente Olá) too4 MB.</span><span class="sxs-lookup"><span data-stu-id="1ec94-200">When you're writing tooData Lake Store, set a size sync policy (buffer on hello client side) too4 MB.</span></span> <span data-ttu-id="1ec94-201">Uma liberação ou hsync() é executada somente quando o tamanho do buffer de saudação é hello nesse valor.</span><span class="sxs-lookup"><span data-stu-id="1ec94-201">A flushing or hsync() is then performed only when hello buffer size is hello at this value.</span></span> <span data-ttu-id="1ec94-202">driver de repositório Data Lake Olá Worker Olá VM automaticamente faz esse buffer, a menos que você executa uma hsync() explicitamente.</span><span class="sxs-lookup"><span data-stu-id="1ec94-202">hello Data Lake Store driver on hello worker VM automatically does this buffering, unless you explicitly perform an hsync().</span></span>

<span data-ttu-id="1ec94-203">parafuso de profusão de repositório do Data Lake saudação padrão tem um parâmetro de política do sincronização tamanho (fileBufferSize) pode ser usado tootune esse parâmetro.</span><span class="sxs-lookup"><span data-stu-id="1ec94-203">hello default Data Lake Store Storm bolt has a size sync policy parameter (fileBufferSize) that can be used tootune this parameter.</span></span>

<span data-ttu-id="1ec94-204">Em topologias com alto e/S, é uma boa ideia toohave cada thread de raio gravar arquivo próprio tooits e tooset uma política de rotação de arquivo (fileRotationSize).</span><span class="sxs-lookup"><span data-stu-id="1ec94-204">In I/O-intensive topologies, it's a good idea toohave each bolt thread write tooits own file, and tooset a file rotation policy (fileRotationSize).</span></span> <span data-ttu-id="1ec94-205">Quando o arquivo hello atinge um determinado tamanho, fluxo Olá automaticamente é liberado e um novo arquivo é gravado.</span><span class="sxs-lookup"><span data-stu-id="1ec94-205">When hello file reaches a certain size, hello stream is automatically flushed and a new file is written to.</span></span> <span data-ttu-id="1ec94-206">Olá tamanho de arquivo para rotação recomendado é de 1 GB.</span><span class="sxs-lookup"><span data-stu-id="1ec94-206">hello recommended file size for rotation is 1 GB.</span></span>

### <a name="handle-tuple-data"></a><span data-ttu-id="1ec94-207">Manipulação de dados de tupla</span><span class="sxs-lookup"><span data-stu-id="1ec94-207">Handle tuple data</span></span>

<span data-ttu-id="1ec94-208">No Storm, um spout mantém na tupla tooa até que ele seja confirmado explicitamente pelo raio hello.</span><span class="sxs-lookup"><span data-stu-id="1ec94-208">In Storm, a spout holds on tooa tuple until it is explicitly acknowledged by hello bolt.</span></span> <span data-ttu-id="1ec94-209">Se uma tupla foi lida pelo raio hello, mas ainda não foram confirmada, spout Olá pode não ter persistido no back-end do repositório Data Lake.</span><span class="sxs-lookup"><span data-stu-id="1ec94-209">If a tuple has been read by hello bolt but has not been acknowledged yet, hello spout might not have persisted into Data Lake Store back end.</span></span> <span data-ttu-id="1ec94-210">Depois de uma tupla é confirmada, spout Olá pode ser garantida persistência pelo raio hello e pode excluir dados de origem de saudação de qualquer fonte que ela está lendo de.</span><span class="sxs-lookup"><span data-stu-id="1ec94-210">After a tuple is acknowledged, hello spout can be guaranteed persistence by hello bolt, and can then delete hello source data from whatever source it is reading from.</span></span>  

<span data-ttu-id="1ec94-211">Para melhor desempenho em repositório Data Lake, ter raio de saudação de buffer de dados de tupla de 4 MB.</span><span class="sxs-lookup"><span data-stu-id="1ec94-211">For best performance on Data Lake Store, have hello bolt buffer 4 MB of tuple data.</span></span> <span data-ttu-id="1ec94-212">Em seguida, escreva toohello repositório Data Lake volta terminar como uma gravação de 4 MB.</span><span class="sxs-lookup"><span data-stu-id="1ec94-212">Then write toohello Data Lake Store back end as one 4-MB write.</span></span> <span data-ttu-id="1ec94-213">Depois que dados saudação foi gravado com êxito toohello repositório (por chamada hflush()), raio Olá pode confirmar Olá dados toohello back spout.</span><span class="sxs-lookup"><span data-stu-id="1ec94-213">After hello data has been successfully written toohello store (by calling hflush()), hello bolt can acknowledge hello data back toohello spout.</span></span> <span data-ttu-id="1ec94-214">Este é o exemplo hello parafuso fornecido não aqui.</span><span class="sxs-lookup"><span data-stu-id="1ec94-214">This is what hello example bolt supplied here does.</span></span> <span data-ttu-id="1ec94-215">Também é aceitável toohold um número maior de tuplas antes Olá hflush() chamada é feita e hello tuplas confirmadas.</span><span class="sxs-lookup"><span data-stu-id="1ec94-215">It is also acceptable toohold a larger number of tuples before hello hflush() call is made and hello tuples acknowledged.</span></span> <span data-ttu-id="1ec94-216">No entanto, isso aumenta o número de saudação de tuplas em trânsito que spout Olá precisa toohold e, portanto, aumenta Olá a quantidade de memória exigida por JVM.</span><span class="sxs-lookup"><span data-stu-id="1ec94-216">However, this increases hello number of tuples in flight that hello spout needs toohold, and therefore increases hello amount of memory required per JVM.</span></span>

> [!NOTE]
<span data-ttu-id="1ec94-217">Aplicativos podem ter uma tuplas de tooacknowledge requisito com mais frequência (em tamanhos de dados menor que 4 MB) por outros motivos de desempenho não.</span><span class="sxs-lookup"><span data-stu-id="1ec94-217">Applications might have a requirement tooacknowledge tuples more frequently (at data sizes less than 4 MB) for other non-performance reasons.</span></span> <span data-ttu-id="1ec94-218">No entanto, que pode afetar hello e/s taxa de transferência toohello armazenamento back-end.</span><span class="sxs-lookup"><span data-stu-id="1ec94-218">However, that might affect hello I/O throughput toohello storage back end.</span></span> <span data-ttu-id="1ec94-219">Avalie cuidadosamente essa compensação em relação ao desempenho de e/s do raio da saudação.</span><span class="sxs-lookup"><span data-stu-id="1ec94-219">Carefully weigh this tradeoff against hello bolt’s I/O performance.</span></span>

<span data-ttu-id="1ec94-220">Se taxa de entrada hello de tuplas for não alta, para que o buffer de 4 MB de saudação leva um tempo longo toofill, considere reduzir isso por:</span><span class="sxs-lookup"><span data-stu-id="1ec94-220">If hello incoming rate of tuples is not high, so hello 4-MB buffer takes a long time toofill, consider mitigating this by:</span></span>
* <span data-ttu-id="1ec94-221">Reduzindo o número de saudação de parafusos, portanto, há menos toofill de buffers.</span><span class="sxs-lookup"><span data-stu-id="1ec94-221">Reducing hello number of bolts, so there are fewer buffers toofill.</span></span>
* <span data-ttu-id="1ec94-222">Ter uma política com base em contagem ou tempo, onde um hflush() é disparado cada x liberações ou cada milissegundos y e tuplas Olá acumuladas até o momento reconhecidas novamente.</span><span class="sxs-lookup"><span data-stu-id="1ec94-222">Having a time-based or count-based policy, where an hflush() is triggered every x flushes or every y milliseconds, and hello tuples accumulated so far are acknowledged back.</span></span>

<span data-ttu-id="1ec94-223">Observe que a taxa de transferência Olá nesse caso é menor, mas com uma taxa baixa de eventos, taxa de transferência máxima não é objetivo maior Olá mesmo assim.</span><span class="sxs-lookup"><span data-stu-id="1ec94-223">Note that hello throughput in this case is lower, but with a slow rate of events, maximum throughput is not hello biggest objective anyway.</span></span> <span data-ttu-id="1ec94-224">Essas reduções ajudar a reduzir o tempo total de saudação que leva para um tooflow tupla toohello armazenam.</span><span class="sxs-lookup"><span data-stu-id="1ec94-224">These mitigations help you reduce hello total time that it takes for a tuple tooflow through toohello store.</span></span> <span data-ttu-id="1ec94-225">Isso pode ser relevante se você quiser um pipeline em tempo real, mesmo com uma taxa baixa de evento.</span><span class="sxs-lookup"><span data-stu-id="1ec94-225">This might matter if you want a real-time pipeline even with a low event rate.</span></span> <span data-ttu-id="1ec94-226">Observe também que se a taxa de entrada de tupla for baixa, você deve ajustar parâmetro topology.message.timeout_secs Olá para Olá tuplas não atingir o tempo limite enquanto eles estão obtendo em buffer ou processado.</span><span class="sxs-lookup"><span data-stu-id="1ec94-226">Also note that if your incoming tuple rate is low, you should adjust hello topology.message.timeout_secs parameter, so hello tuples don’t time out while they are getting buffered or processed.</span></span>

## <a name="monitor-your-topology-in-storm"></a><span data-ttu-id="1ec94-227">Monitorar a topologia no Storm</span><span class="sxs-lookup"><span data-stu-id="1ec94-227">Monitor your topology in Storm</span></span>  
<span data-ttu-id="1ec94-228">Durante a execução de sua topologia, você pode monitorá-lo na interface do usuário Storm hello.</span><span class="sxs-lookup"><span data-stu-id="1ec94-228">While your topology is running, you can monitor it in hello Storm user interface.</span></span> <span data-ttu-id="1ec94-229">Aqui estão Olá parâmetros principais toolook em:</span><span class="sxs-lookup"><span data-stu-id="1ec94-229">Here are hello main parameters toolook at:</span></span>

* <span data-ttu-id="1ec94-230">**Latência total de execução do processo.**</span><span class="sxs-lookup"><span data-stu-id="1ec94-230">**Total process execution latency.**</span></span> <span data-ttu-id="1ec94-231">Este é o tempo médio de saudação uma tupla leva toobe emitidos pelo spout hello, processados pelo raio hello e confirmado.</span><span class="sxs-lookup"><span data-stu-id="1ec94-231">This is hello average time one tuple takes toobe emitted by hello spout, processed by hello bolt, and acknowledged.</span></span>

* <span data-ttu-id="1ec94-232">**Latência total de processo do bolt.**</span><span class="sxs-lookup"><span data-stu-id="1ec94-232">**Total bolt process latency.**</span></span> <span data-ttu-id="1ec94-233">Este é o tempo médio de saudação gasto pela tupla Olá a isoladas Olá até receber uma confirmação.</span><span class="sxs-lookup"><span data-stu-id="1ec94-233">This is hello average time spent by hello tuple at hello bolt until it receives an acknowledgement.</span></span>

* <span data-ttu-id="1ec94-234">**Latência total de execute do bolt.**</span><span class="sxs-lookup"><span data-stu-id="1ec94-234">**Total bolt execute latency.**</span></span> <span data-ttu-id="1ec94-235">Isso é a média de saudação tempo gasto pelo raio Olá no hello executar o método.</span><span class="sxs-lookup"><span data-stu-id="1ec94-235">This is hello average time spent by hello bolt in hello execute method.</span></span>

* <span data-ttu-id="1ec94-236">**Número de falhas.**</span><span class="sxs-lookup"><span data-stu-id="1ec94-236">**Number of failures.**</span></span> <span data-ttu-id="1ec94-237">Isso se refere a toohello número de tuplas que toobe totalmente processado antes que eles atingiu o tempo limite de falha.</span><span class="sxs-lookup"><span data-stu-id="1ec94-237">This refers toohello number of tuples that failed toobe fully processed before they timed out.</span></span>

* <span data-ttu-id="1ec94-238">**Capacidade.**</span><span class="sxs-lookup"><span data-stu-id="1ec94-238">**Capacity.**</span></span> <span data-ttu-id="1ec94-239">Medida da ocupação do sistema.</span><span class="sxs-lookup"><span data-stu-id="1ec94-239">This is a measure of how busy your system is.</span></span> <span data-ttu-id="1ec94-240">Se esse número é 1, os bolts estão trabalhando tão rápido quanto possível.</span><span class="sxs-lookup"><span data-stu-id="1ec94-240">If this number is 1, your bolts are working as fast as they can.</span></span> <span data-ttu-id="1ec94-241">Se for menor que 1, aumente o paralelismo de saudação.</span><span class="sxs-lookup"><span data-stu-id="1ec94-241">If it is less than 1, increase hello parallelism.</span></span> <span data-ttu-id="1ec94-242">Se for maior que 1, reduza o paralelismo de saudação.</span><span class="sxs-lookup"><span data-stu-id="1ec94-242">If it is greater than 1, reduce hello parallelism.</span></span>

## <a name="troubleshoot-common-problems"></a><span data-ttu-id="1ec94-243">Solução de problemas comuns</span><span class="sxs-lookup"><span data-stu-id="1ec94-243">Troubleshoot common problems</span></span>
<span data-ttu-id="1ec94-244">Eis alguns cenários comuns de solução de problemas.</span><span class="sxs-lookup"><span data-stu-id="1ec94-244">Here are a few common troubleshooting scenarios.</span></span>
* <span data-ttu-id="1ec94-245">**Grande número de tuplas atingindo o tempo limite.** Pesquisar em cada nó na Olá topologia toodetermine onde é o afunilamento hello.</span><span class="sxs-lookup"><span data-stu-id="1ec94-245">**Many tuples are timing out.** Look at each node in hello topology toodetermine where hello bottleneck is.</span></span> <span data-ttu-id="1ec94-246">Olá mais comuns motivo para isso é que Olá parafusos não tookeep capaz de backup com spouts hello.</span><span class="sxs-lookup"><span data-stu-id="1ec94-246">hello most common reason for this is that hello bolts are not able tookeep up with hello spouts.</span></span> <span data-ttu-id="1ec94-247">Isso leva tootuples sobrecarregando os buffers internos de saudação enquanto espera toobe processados.</span><span class="sxs-lookup"><span data-stu-id="1ec94-247">This leads tootuples clogging hello internal buffers while waiting toobe processed.</span></span> <span data-ttu-id="1ec94-248">Considere aumentar o valor de tempo limite de saudação ou diminuindo spout máximo de saudação pendente.</span><span class="sxs-lookup"><span data-stu-id="1ec94-248">Consider increasing hello timeout value or decreasing hello max spout pending.</span></span>

* <span data-ttu-id="1ec94-249">**Há uma latência alta de execução do processo total, mas uma latência baixa de processo do bolt.**</span><span class="sxs-lookup"><span data-stu-id="1ec94-249">**There is a high total process execution latency, but a low bolt process latency.**</span></span> <span data-ttu-id="1ec94-250">Nesse caso, é possível que Olá tuplas não são sejam confirmadas rápido o suficiente.</span><span class="sxs-lookup"><span data-stu-id="1ec94-250">In this case, it is possible that hello tuples are not being acknowledged fast enough.</span></span> <span data-ttu-id="1ec94-251">Verifique se há um número suficiente de confirmadores.</span><span class="sxs-lookup"><span data-stu-id="1ec94-251">Check that there are a sufficient number of acknowledgers.</span></span> <span data-ttu-id="1ec94-252">Outra possibilidade é que estão aguardando na fila de saudação por muito tempo antes de saudação bolts início processá-las.</span><span class="sxs-lookup"><span data-stu-id="1ec94-252">Another possibility is that they are waiting in hello queue for too long before hello bolts start processing them.</span></span> <span data-ttu-id="1ec94-253">Diminua spout máximo de saudação pendente.</span><span class="sxs-lookup"><span data-stu-id="1ec94-253">Decrease hello max spout pending.</span></span>

* <span data-ttu-id="1ec94-254">**Latência de execute do bolt elevada.**</span><span class="sxs-lookup"><span data-stu-id="1ec94-254">**There is a high bolt execute latency.**</span></span> <span data-ttu-id="1ec94-255">Isso significa que o método Execute () Olá a isoladas está demorando muito.</span><span class="sxs-lookup"><span data-stu-id="1ec94-255">This means that hello execute() method of your bolt is taking too long.</span></span> <span data-ttu-id="1ec94-256">Otimizar código hello, ou examinar os tamanhos de gravação e comportamento de liberação.</span><span class="sxs-lookup"><span data-stu-id="1ec94-256">Optimize hello code, or look at write sizes and flush behavior.</span></span>

### <a name="data-lake-store-throttling"></a><span data-ttu-id="1ec94-257">Limitação do Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="1ec94-257">Data Lake Store throttling</span></span>
<span data-ttu-id="1ec94-258">Se você atingir os limites de largura de banda fornecida pelo repositório Data Lake hello, você poderá ver falhas de tarefas.</span><span class="sxs-lookup"><span data-stu-id="1ec94-258">If you hit hello limits of bandwidth provided by Data Lake Store, you might see task failures.</span></span> <span data-ttu-id="1ec94-259">Verifique os logs de tarefa para erros de limitação.</span><span class="sxs-lookup"><span data-stu-id="1ec94-259">Check task logs for throttling errors.</span></span> <span data-ttu-id="1ec94-260">Você pode diminuir o paralelismo Olá aumentando o tamanho do contêiner.</span><span class="sxs-lookup"><span data-stu-id="1ec94-260">You can decrease hello parallelism by increasing container size.</span></span>    

<span data-ttu-id="1ec94-261">toocheck se você estiver obtendo limitada, habilitar Olá log de depuração no lado do cliente hello:</span><span class="sxs-lookup"><span data-stu-id="1ec94-261">toocheck if you are getting throttled, enable hello debug logging on hello client side:</span></span>

1. <span data-ttu-id="1ec94-262">Em **Ambari** > **Storm** > **Config** > **avançado profusão de trabalhador de log4j**, alterar  **&lt;raiz nível = "info"&gt;**  muito**&lt;raiz nível = "depuração"&gt;**.</span><span class="sxs-lookup"><span data-stu-id="1ec94-262">In **Ambari** > **Storm** > **Config** > **Advanced storm-worker-log4j**, change **&lt;root level="info"&gt;** too**&lt;root level=”debug”&gt;**.</span></span> <span data-ttu-id="1ec94-263">Reinicie todos os nós/serviço Olá para efeito de tootake configuração hello.</span><span class="sxs-lookup"><span data-stu-id="1ec94-263">Restart all hello nodes/service for hello configuration tootake effect.</span></span>
2. <span data-ttu-id="1ec94-264">Topologia de profusão de saudação do Monitor registra em nós de trabalho (em /var/log/storm/worker-artifacts /&lt;TopologyName&gt;/&lt;porta&gt;/worker.log) para o repositório Data Lake exceções de limitação.</span><span class="sxs-lookup"><span data-stu-id="1ec94-264">Monitor hello Storm topology logs on worker nodes (under /var/log/storm/worker-artifacts/&lt;TopologyName&gt;/&lt;port&gt;/worker.log) for Data Lake Store throttling exceptions.</span></span>

## <a name="next-steps"></a><span data-ttu-id="1ec94-265">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="1ec94-265">Next steps</span></span>
<span data-ttu-id="1ec94-266">Ajuste de desempenho adicional para o Storm pode ser referenciado [neste blog](https://blogs.msdn.microsoft.com/shanyu/2015/05/14/performance-tuning-for-hdinsight-storm-and-microsoft-azure-eventhubs/).</span><span class="sxs-lookup"><span data-stu-id="1ec94-266">Additional performance tuning for Storm can be referenced in [this blog](https://blogs.msdn.microsoft.com/shanyu/2015/05/14/performance-tuning-for-hdinsight-storm-and-microsoft-azure-eventhubs/).</span></span>

<span data-ttu-id="1ec94-267">Para um toorun exemplo adicionais, consulte [la no GitHub](https://github.com/hdinsight/storm-performance-automation).</span><span class="sxs-lookup"><span data-stu-id="1ec94-267">For an additional example toorun, see [this one on GitHub](https://github.com/hdinsight/storm-performance-automation).</span></span>
