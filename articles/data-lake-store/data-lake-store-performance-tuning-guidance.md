---
title: Diretrizes de ajuste de desempenho do Azure Data Lake Store | Microsoft Docs
description: Diretrizes de ajuste de desempenho do Azure Data Lake Store
services: data-lake-store
documentationcenter: 
author: stewu
manager: amitkul
editor: cgronlun
ms.assetid: ebde7b9f-2e51-4d43-b7ab-566417221335
ms.service: data-lake-store
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 06/30/2017
ms.author: stewu
ms.openlocfilehash: e7ea83465328bd4c7479dec4093cd94700463854
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 07/11/2017
---
# <a name="tuning-azure-data-lake-store-for-performance"></a><span data-ttu-id="2c473-103">Ajustando o desempenho do Azure Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="2c473-103">Tuning Azure Data Lake Store for performance</span></span>

<span data-ttu-id="2c473-104">O Data Lake Store dá suporte a alta taxa de transferência para análise de uso intensivo de E/S e movimentação de dados.</span><span class="sxs-lookup"><span data-stu-id="2c473-104">Data Lake Store supports high-throughput for I/O intensive analytics and data movement.</span></span>  <span data-ttu-id="2c473-105">No Azure Data Lake Store, usar toda a taxa de transferência disponível – a quantidade de dados que podem ser lidos ou gravados por segundo – é importante para obter o melhor desempenho.</span><span class="sxs-lookup"><span data-stu-id="2c473-105">In Azure Data Lake Store, using all available throughput – the amount of data that can be read or written per second – is important to get the best performance.</span></span>  <span data-ttu-id="2c473-106">Isso é obtido executando o maior número possível de leituras e gravações em paralelo.</span><span class="sxs-lookup"><span data-stu-id="2c473-106">This is achieved by performing as many reads and writes in parallel as possible.</span></span>

![Desempenho do Data Lake Store](./media/data-lake-store-performance-tuning-guidance/throughput.png)

<span data-ttu-id="2c473-108">O Azure Data Lake Store pode escalonar para fornecer a taxa de transferência necessária para todo cenário de análise.</span><span class="sxs-lookup"><span data-stu-id="2c473-108">Azure Data Lake Store can scale to provide the necessary throughput for all analytics scenario.</span></span> <span data-ttu-id="2c473-109">Por padrão, uma conta do Azure Data Lake Store fornece automaticamente taxa de transferência suficiente para atender às necessidades de uma categoria ampla de casos de uso.</span><span class="sxs-lookup"><span data-stu-id="2c473-109">By default, an Azure Data Lake Store account provides automatically enough throughput to meet the needs of a broad category of use cases.</span></span> <span data-ttu-id="2c473-110">Para os casos em que os clientes encontram o limite padrão, a conta do ADLS pode ser configurada para fornecer mais taxa de transferência entrando em contato com o Suporte da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="2c473-110">For the cases where customers run into the default limit, the ADLS account can be configured to provide more throughput by contacting Microsoft support.</span></span>

## <a name="data-ingestion"></a><span data-ttu-id="2c473-111">Ingestão de dados</span><span class="sxs-lookup"><span data-stu-id="2c473-111">Data ingestion</span></span>

<span data-ttu-id="2c473-112">Ao ingerir dados de um sistema de origem para ADLS, é importante considerar que o hardware de origem, o hardware de rede de origem e a conectividade de rede para o ADLS podem ser o gargalo.</span><span class="sxs-lookup"><span data-stu-id="2c473-112">When ingesting data from a source system to ADLS, it is important to consider that the source hardware, source network hardware, and network connectivity to ADLS can be the bottleneck.</span></span>  

![Desempenho do Data Lake Store](./media/data-lake-store-performance-tuning-guidance/bottleneck.png)

<span data-ttu-id="2c473-114">É importante garantir que a movimentação de dados não seja afetada por esses fatores.</span><span class="sxs-lookup"><span data-stu-id="2c473-114">It is important to ensure that the data movement is not affected by these factors.</span></span>

### <a name="source-hardware"></a><span data-ttu-id="2c473-115">Hardware de Origem</span><span class="sxs-lookup"><span data-stu-id="2c473-115">Source Hardware</span></span>

<span data-ttu-id="2c473-116">Se você estiver usando computadores locais ou VMs no Azure, você deverá selecionar cuidadosamente o hardware apropriado.</span><span class="sxs-lookup"><span data-stu-id="2c473-116">Whether you are using on-premises machines or VMs in Azure, you should carefully select the appropriate hardware.</span></span> <span data-ttu-id="2c473-117">Para Hardware de Disco de Origem, prefira SSDs a HDDs e escolha o hardware de disco com eixos mais rápidos.</span><span class="sxs-lookup"><span data-stu-id="2c473-117">For Source Disk Hardware, prefer SSDs to HDDs and pick disk hardware with faster spindles.</span></span> <span data-ttu-id="2c473-118">Para Hardware de Rede de Origem, use as NICs mais rápidas que puder.</span><span class="sxs-lookup"><span data-stu-id="2c473-118">For Source Network Hardware, use the fastest NICs possible.</span></span>  <span data-ttu-id="2c473-119">No Azure, recomendamos VMs Azure D14, que têm o hardware de rede e de disco adequadamente avançado.</span><span class="sxs-lookup"><span data-stu-id="2c473-119">On Azure, we recommend Azure D14 VMs which have the appropriately powerful disk and networking hardware.</span></span>

### <a name="network-connectivity-to-azure-data-lake-store"></a><span data-ttu-id="2c473-120">Conectividade de Rede ao Azure Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="2c473-120">Network Connectivity to Azure Data Lake Store</span></span>

<span data-ttu-id="2c473-121">A conectividade de rede entre seus dados de origem e o Azure Data Lake Store, às vezes, pode ser o gargalo.</span><span class="sxs-lookup"><span data-stu-id="2c473-121">The network connectivity between your source data and Azure Data Lake store can sometimes be the bottleneck.</span></span> <span data-ttu-id="2c473-122">Quando os dados de origem forem locais, considere o uso de uma conexão dedicada com o [Azure ExpressRoute](https://azure.microsoft.com/en-us/services/expressroute/).</span><span class="sxs-lookup"><span data-stu-id="2c473-122">When your source data is On-Premises, consider using a dedicated link with [Azure ExpressRoute](https://azure.microsoft.com/en-us/services/expressroute/) .</span></span> <span data-ttu-id="2c473-123">Se os dados de origem estiverem no Azure, o desempenho será melhor quando os dados estiverem na mesma região do Azure que o Data Lake Store.</span><span class="sxs-lookup"><span data-stu-id="2c473-123">If your source data is in Azure, the performance will be best when the data is in the same Azure region as the Data Lake Store.</span></span>

### <a name="configure-data-ingestion-tools-for-maximum-parallelization"></a><span data-ttu-id="2c473-124">Configurar as ferramentas de ingestão de dados para paralelização máxima</span><span class="sxs-lookup"><span data-stu-id="2c473-124">Configure Data Ingestion tools for maximum parallelization</span></span>

<span data-ttu-id="2c473-125">Depois que você tiver resolvido os gargalos de hardware de origem e conectividade de rede acima, você estará pronto para configurar as ferramentas de ingestão.</span><span class="sxs-lookup"><span data-stu-id="2c473-125">Once you have addressed the source hardware and network connectivity bottlenecks above, you are ready to configure your ingestion tools.</span></span> <span data-ttu-id="2c473-126">A tabela a seguir resume as configurações de chave para diversas ferramentas de ingestão populares e fornece artigos detalhados de ajuste de desempenho para eles.</span><span class="sxs-lookup"><span data-stu-id="2c473-126">The following table summarizes the key settings for several popular ingestion tools and provides in-depth performance tuning articles for them.</span></span>  <span data-ttu-id="2c473-127">Para saber mais sobre qual ferramenta usar para seu cenário, visite este [artigo](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-data-scenarios).</span><span class="sxs-lookup"><span data-stu-id="2c473-127">To learn more about which tool to use for your scenario, visit this [article](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-data-scenarios).</span></span>

| <span data-ttu-id="2c473-128">Ferramenta</span><span class="sxs-lookup"><span data-stu-id="2c473-128">Tool</span></span>               | <span data-ttu-id="2c473-129">Configurações</span><span class="sxs-lookup"><span data-stu-id="2c473-129">Settings</span></span>     | <span data-ttu-id="2c473-130">Mais detalhes</span><span class="sxs-lookup"><span data-stu-id="2c473-130">More Details</span></span>                                                                 |
|--------------------|------------------------------------------------------|------------------------------|
| <span data-ttu-id="2c473-131">Powershell</span><span class="sxs-lookup"><span data-stu-id="2c473-131">Powershell</span></span>       | <span data-ttu-id="2c473-132">PerFileThreadCount, ConcurrentFileCount</span><span class="sxs-lookup"><span data-stu-id="2c473-132">PerFileThreadCount, ConcurrentFileCount</span></span> |  [<span data-ttu-id="2c473-133">Link</span><span class="sxs-lookup"><span data-stu-id="2c473-133">Link</span></span>](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-get-started-powershell#performance-guidance-while-using-powershell)   |
| <span data-ttu-id="2c473-134">AdlCopy</span><span class="sxs-lookup"><span data-stu-id="2c473-134">AdlCopy</span></span>    | <span data-ttu-id="2c473-135">Unidades do Azure Data Lake Analytics</span><span class="sxs-lookup"><span data-stu-id="2c473-135">Azure Data Lake Analytics units</span></span>  |   [<span data-ttu-id="2c473-136">Link</span><span class="sxs-lookup"><span data-stu-id="2c473-136">Link</span></span>](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-copy-data-azure-storage-blob#performance-considerations-for-using-adlcopy)         |
| <span data-ttu-id="2c473-137">DistCp</span><span class="sxs-lookup"><span data-stu-id="2c473-137">DistCp</span></span>            | <span data-ttu-id="2c473-138">-m (mapper)</span><span class="sxs-lookup"><span data-stu-id="2c473-138">-m (mapper)</span></span>   | [<span data-ttu-id="2c473-139">Link</span><span class="sxs-lookup"><span data-stu-id="2c473-139">Link</span></span>](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-copy-data-wasb-distcp#performance-considerations-while-using-distcp)                             |
| <span data-ttu-id="2c473-140">Fábrica de dados do Azure</span><span class="sxs-lookup"><span data-stu-id="2c473-140">Azure Data Factory</span></span>| <span data-ttu-id="2c473-141">parallelCopies</span><span class="sxs-lookup"><span data-stu-id="2c473-141">parallelCopies</span></span>    | [<span data-ttu-id="2c473-142">Link</span><span class="sxs-lookup"><span data-stu-id="2c473-142">Link</span></span>](../data-factory/data-factory-copy-activity-performance.md)                          |
| <span data-ttu-id="2c473-143">Sqoop</span><span class="sxs-lookup"><span data-stu-id="2c473-143">Sqoop</span></span>           | <span data-ttu-id="2c473-144">fs.azure.block.size, -m (mapper)</span><span class="sxs-lookup"><span data-stu-id="2c473-144">fs.azure.block.size, -m (mapper)</span></span>    |   [<span data-ttu-id="2c473-145">Link</span><span class="sxs-lookup"><span data-stu-id="2c473-145">Link</span></span>](https://blogs.msdn.microsoft.com/bigdatasupport/2015/02/17/sqoop-job-performance-tuning-in-hdinsight-hadoop/)        |

## <a name="structure-your-data-set"></a><span data-ttu-id="2c473-146">Estruturar seu conjunto de dados</span><span class="sxs-lookup"><span data-stu-id="2c473-146">Structure your data set</span></span>

<span data-ttu-id="2c473-147">Quando dados são armazenados no Data Lake Store, o tamanho do arquivo, o número de arquivos e a estrutura de pasta têm um impacto no desempenho.</span><span class="sxs-lookup"><span data-stu-id="2c473-147">When data is stored in Data Lake Store, the file size, number of files, and folder structure have an impact on performance.</span></span>  <span data-ttu-id="2c473-148">A seção a seguir descreve as práticas recomendadas nessas áreas.</span><span class="sxs-lookup"><span data-stu-id="2c473-148">The following section describes best practices in these areas.</span></span>  

### <a name="file-size"></a><span data-ttu-id="2c473-149">Tamanho do arquivo</span><span class="sxs-lookup"><span data-stu-id="2c473-149">File size</span></span>

<span data-ttu-id="2c473-150">Normalmente os mecanismos de análise, tais como HDInsight e Azure Data Lake Analytics, têm uma sobrecarga por arquivo.</span><span class="sxs-lookup"><span data-stu-id="2c473-150">Typically, analytics engines such as HDInsight and Azure Data Lake Analytics have a per-file overhead.</span></span>  <span data-ttu-id="2c473-151">Se você armazenar os dados como vários arquivos pequenos, isso poderá afetar negativamente o desempenho.</span><span class="sxs-lookup"><span data-stu-id="2c473-151">If you store your data as many small files, this can negatively affect performance.</span></span>  

<span data-ttu-id="2c473-152">Em geral, organize seus dados em arquivos de tamanhos maior para melhorar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="2c473-152">In general, organize your data into larger sized files for better performance.</span></span>  <span data-ttu-id="2c473-153">Como regra geral, organize conjuntos de dados em arquivos de 256 MB ou maiores.</span><span class="sxs-lookup"><span data-stu-id="2c473-153">As a rule of thumb, organize data sets in files of 256MB or larger.</span></span> <span data-ttu-id="2c473-154">Em alguns casos, como imagens e dados binários, não é possível processá-los em paralelo.</span><span class="sxs-lookup"><span data-stu-id="2c473-154">In some cases such as images and binary data, it is not possible to process them in parallel.</span></span>  <span data-ttu-id="2c473-155">Nesses casos, é recomendável manter arquivos individuais abaixo de 2 GB.</span><span class="sxs-lookup"><span data-stu-id="2c473-155">In these cases, it is recommended to keep individual files under 2GB.</span></span>

<span data-ttu-id="2c473-156">Às vezes, os pipelines de dados têm controle limitado sobre os dados brutos, que têm muitos arquivos pequenos.</span><span class="sxs-lookup"><span data-stu-id="2c473-156">Sometimes, data pipelines have limited control over the raw data which has lots of small files.</span></span>  <span data-ttu-id="2c473-157">É recomendável ter um processo de "cozinhar" que gera arquivos maiores para uso por aplicativos downstream.</span><span class="sxs-lookup"><span data-stu-id="2c473-157">It is recommended to have a “cooking” process that generates larger files to use for downstream applications.</span></span>  

### <a name="organizing-time-series-data-in-folders"></a><span data-ttu-id="2c473-158">Organizar os dados de série temporal em pastas</span><span class="sxs-lookup"><span data-stu-id="2c473-158">Organizing Time Series data in folders</span></span>

<span data-ttu-id="2c473-159">Para cargas de trabalho de Hive e ADLA, a remoção de partições de dados de série temporal pode ajudar algumas consultas a ler apenas um subconjunto dos dados, o que melhora o desempenho.</span><span class="sxs-lookup"><span data-stu-id="2c473-159">For Hive and ADLA workloads, partition pruning of time-series data can help some queries read only a subset of the data which improves performance.</span></span>    

<span data-ttu-id="2c473-160">Esses pipelines que ingerem dados de série temporal muitas vezes colocam seus arquivos com uma nomenclatura muito estruturada para arquivos e pastas.</span><span class="sxs-lookup"><span data-stu-id="2c473-160">Those pipelines that ingest time-series data, often place their files with a very structured naming for files and folders.</span></span> <span data-ttu-id="2c473-161">Abaixo está um exemplo muito comum para dados estruturados por data:</span><span class="sxs-lookup"><span data-stu-id="2c473-161">Below is a very common example we see for data that is structured by date:</span></span>

    \DataSet\YYYY\MM\DD\datafile_YYYY_MM_DD.tsv

<span data-ttu-id="2c473-162">Observe que as informações de data e hora são exibidas tanto como pastas quanto no nome de arquivo.</span><span class="sxs-lookup"><span data-stu-id="2c473-162">Notice that the datetime information appears both as folders and in the filename.</span></span>

<span data-ttu-id="2c473-163">Para data e hora, o padrão a seguir é comum</span><span class="sxs-lookup"><span data-stu-id="2c473-163">For date and time, the following is a common pattern</span></span>

    \DataSet\YYYY\MM\DD\HH\mm\datafile_YYYY_MM_DD_HH_mm.tsv

<span data-ttu-id="2c473-164">Novamente, a escolha que você fizer com a pasta e organização do arquivo deverá otimizar para os maiores tamanhos de arquivo e um número razoável de arquivos em cada pasta.</span><span class="sxs-lookup"><span data-stu-id="2c473-164">Again, the choice you make with the folder and file organization should optimize for the larger file sizes and a reasonable number of files in each folder.</span></span>

## <a name="optimizing-io-intensive-jobs-on-hadoop-and-spark-workloads-on-hdinsight"></a><span data-ttu-id="2c473-165">Otimizar os trabalhos com uso intensivo de E/S em cargas de trabalho do Hadoop e Spark no HDInsight</span><span class="sxs-lookup"><span data-stu-id="2c473-165">Optimizing I/O intensive jobs on Hadoop and Spark workloads on HDInsight</span></span>

<span data-ttu-id="2c473-166">Trabalhos se enquadram em uma destas três categorias:</span><span class="sxs-lookup"><span data-stu-id="2c473-166">Jobs fall into one of the following three categories:</span></span>

* <span data-ttu-id="2c473-167">**Com uso intensivo de CPU.**</span><span class="sxs-lookup"><span data-stu-id="2c473-167">**CPU intensive.**</span></span>  <span data-ttu-id="2c473-168">Esses trabalhos têm tempos de computação longos com tempos de E/S mínimos.</span><span class="sxs-lookup"><span data-stu-id="2c473-168">These jobs have long computation times with minimal I/O times.</span></span>  <span data-ttu-id="2c473-169">Exemplos incluem aprendizado de máquina e trabalhos de processamento de linguagem natural.</span><span class="sxs-lookup"><span data-stu-id="2c473-169">Examples include machine learning and natural language processing jobs.</span></span>  
* <span data-ttu-id="2c473-170">**Com uso intensivo de memória.**</span><span class="sxs-lookup"><span data-stu-id="2c473-170">**Memory intensive.**</span></span>  <span data-ttu-id="2c473-171">Estes trabalhos usam muita memória.</span><span class="sxs-lookup"><span data-stu-id="2c473-171">These jobs use lots of memory.</span></span>  <span data-ttu-id="2c473-172">Exemplos incluem PageRank e trabalhos de análise em tempo real.</span><span class="sxs-lookup"><span data-stu-id="2c473-172">Examples include PageRank and real-time analytics jobs.</span></span>  
* <span data-ttu-id="2c473-173">**Com uso intensivo de E/S.**</span><span class="sxs-lookup"><span data-stu-id="2c473-173">**I/O intensive.**</span></span>  <span data-ttu-id="2c473-174">Esses trabalhos passam a maior parte do tempo fazendo E/S.</span><span class="sxs-lookup"><span data-stu-id="2c473-174">These jobs spend most of their time doing I/O.</span></span>  <span data-ttu-id="2c473-175">Um exemplo comum é um trabalho de cópia que realiza somente operações de leitura e gravação.</span><span class="sxs-lookup"><span data-stu-id="2c473-175">A common example is a copy job which does only read and write operations.</span></span>  <span data-ttu-id="2c473-176">Outros exemplos incluem trabalhos de preparação de dados que leem muitos dados, executam alguma transformação de dados e, em seguida, gravam os dados de volta para o repositório.</span><span class="sxs-lookup"><span data-stu-id="2c473-176">Other examples include data preparation jobs that read a lot of data, performs some data transformation, and then writes the data back to the store.</span></span>  

<span data-ttu-id="2c473-177">As diretrizes a seguir são aplicáveis somente a trabalhos com uso intensivo de E/S.</span><span class="sxs-lookup"><span data-stu-id="2c473-177">The following guidance is only applicable to I/O intensive jobs.</span></span>

### <a name="general-considerations-for-an-hdinsight-cluster"></a><span data-ttu-id="2c473-178">Considerações gerais para um cluster HDInsight</span><span class="sxs-lookup"><span data-stu-id="2c473-178">General Considerations for an HDInsight cluster</span></span>

* <span data-ttu-id="2c473-179">**Versões do HDInsight.**</span><span class="sxs-lookup"><span data-stu-id="2c473-179">**HDInsight versions.**</span></span> <span data-ttu-id="2c473-180">Para melhor desempenho, use a versão mais recente do HDInsight.</span><span class="sxs-lookup"><span data-stu-id="2c473-180">For best performance, use the latest release of HDInsight.</span></span>
* <span data-ttu-id="2c473-181">**Regiões.**</span><span class="sxs-lookup"><span data-stu-id="2c473-181">**Regions.**</span></span> <span data-ttu-id="2c473-182">Coloque o Data Lake Store na mesma região que o cluster HDInsight.</span><span class="sxs-lookup"><span data-stu-id="2c473-182">Place the Data Lake Store in the same region as the HDInsight cluster.</span></span>  

<span data-ttu-id="2c473-183">Um cluster HDInsight é composto de dois nós principais e alguns nós de trabalho.</span><span class="sxs-lookup"><span data-stu-id="2c473-183">An HDInsight cluster is composed of two head nodes and some worker nodes.</span></span> <span data-ttu-id="2c473-184">Cada nó de trabalho fornece um número específico de núcleos e memória, o que é determinado pelo tipo de VM.</span><span class="sxs-lookup"><span data-stu-id="2c473-184">Each worker node provides a specific number of cores and memory, which is determined by the VM-type.</span></span>  <span data-ttu-id="2c473-185">Ao executar um trabalho, o YARN é o negociador de recursos que aloca a memória disponível e núcleos para criar contêineres.</span><span class="sxs-lookup"><span data-stu-id="2c473-185">When running a job, YARN is the resource negotiator that allocates the available memory and cores to create containers.</span></span>  <span data-ttu-id="2c473-186">Cada contêiner executa as tarefas necessárias para concluir o trabalho.</span><span class="sxs-lookup"><span data-stu-id="2c473-186">Each container runs the tasks needed to complete the job.</span></span>  <span data-ttu-id="2c473-187">Contêineres são executados em paralelo para processar tarefas rapidamente.</span><span class="sxs-lookup"><span data-stu-id="2c473-187">Containers run in parallel to process tasks quickly.</span></span> <span data-ttu-id="2c473-188">Portanto, o desempenho é aprimorado executando o máximo possível de contêineres paralelos.</span><span class="sxs-lookup"><span data-stu-id="2c473-188">Therefore, performance is improved by running as many parallel containers as possible.</span></span>

<span data-ttu-id="2c473-189">Há três camadas em um cluster HDInsight que podem ser ajustadas para aumentar o número de contêineres e usar toda a taxa de transferência disponível.</span><span class="sxs-lookup"><span data-stu-id="2c473-189">There are three layers within an HDInsight cluster that can be tuned to increase the number of containers and use all available throughput.</span></span>  

* <span data-ttu-id="2c473-190">**Camada física**</span><span class="sxs-lookup"><span data-stu-id="2c473-190">**Physical layer**</span></span>
* <span data-ttu-id="2c473-191">**Camada YARN**</span><span class="sxs-lookup"><span data-stu-id="2c473-191">**YARN layer**</span></span>
* <span data-ttu-id="2c473-192">**Camada de carga de trabalho**</span><span class="sxs-lookup"><span data-stu-id="2c473-192">**Workload layer**</span></span>

### <a name="physical-layer"></a><span data-ttu-id="2c473-193">Camada física</span><span class="sxs-lookup"><span data-stu-id="2c473-193">Physical Layer</span></span>

<span data-ttu-id="2c473-194">**Execute o cluster com mais nós e/ou VMs de tamanhos maior.**</span><span class="sxs-lookup"><span data-stu-id="2c473-194">**Run cluster with more nodes and/or larger sized VMs.**</span></span>  <span data-ttu-id="2c473-195">Um cluster maior permite executar mais contêineres YARN, conforme mostrado na figura abaixo.</span><span class="sxs-lookup"><span data-stu-id="2c473-195">A larger cluster will enable you to run more YARN containers as shown in the picture below.</span></span>

![Desempenho do Data Lake Store](./media/data-lake-store-performance-tuning-guidance/VM.png)

<span data-ttu-id="2c473-197">**Use VMs com mais largura de banda de rede.**</span><span class="sxs-lookup"><span data-stu-id="2c473-197">**Use VMs with more network bandwidth.**</span></span>  <span data-ttu-id="2c473-198">A quantidade de largura de banda de rede poderá ser um gargalo se houver menos largura de banda de rede que a taxa de transferência do Data Lake Store.</span><span class="sxs-lookup"><span data-stu-id="2c473-198">The amount of network bandwidth can be a bottleneck if there is less network bandwidth than Data Lake Store throughput.</span></span>  <span data-ttu-id="2c473-199">Diferentes VMs terão diversos tamanhos de largura de banda de rede.</span><span class="sxs-lookup"><span data-stu-id="2c473-199">Different VMs will have varying network bandwidth sizes.</span></span>  <span data-ttu-id="2c473-200">Escolha um tipo de VM com a maior largura de banda de rede possível.</span><span class="sxs-lookup"><span data-stu-id="2c473-200">Choose a VM-type that has the largest possible network bandwidth.</span></span>

### <a name="yarn-layer"></a><span data-ttu-id="2c473-201">Camada YARN</span><span class="sxs-lookup"><span data-stu-id="2c473-201">YARN Layer</span></span>

<span data-ttu-id="2c473-202">**Use contêineres YARN menores.**</span><span class="sxs-lookup"><span data-stu-id="2c473-202">**Use smaller YARN containers.**</span></span>  <span data-ttu-id="2c473-203">Reduza o tamanho de cada contêiner YARN para criar mais contêineres com a mesma quantidade de recursos.</span><span class="sxs-lookup"><span data-stu-id="2c473-203">Reduce the size of each YARN container to create more containers with the same amount of resources.</span></span>

![Desempenho do Data Lake Store](./media/data-lake-store-performance-tuning-guidance/small-containers.png)

<span data-ttu-id="2c473-205">Dependendo de sua carga de trabalho, sempre haverá um tamanho de contêiner YARN mínimo necessário.</span><span class="sxs-lookup"><span data-stu-id="2c473-205">Depending on your workload, there will always be a minimum YARN container size that is needed.</span></span> <span data-ttu-id="2c473-206">Se você selecionar um contêiner muito pequeno, os trabalhos encontrarão problemas de falta de memória.</span><span class="sxs-lookup"><span data-stu-id="2c473-206">If you pick too small a container, your jobs will run into out-of-memory issues.</span></span> <span data-ttu-id="2c473-207">Normalmente, contêineres YARN não devem ser menores que 1 GB.</span><span class="sxs-lookup"><span data-stu-id="2c473-207">Typically YARN containers should be no smaller than 1GB.</span></span> <span data-ttu-id="2c473-208">É comum ver contêineres YARN de 3 GB.</span><span class="sxs-lookup"><span data-stu-id="2c473-208">It’s common to see 3GB YARN containers.</span></span> <span data-ttu-id="2c473-209">Para algumas cargas de trabalho, talvez contêineres YARN maiores sejam necessários.</span><span class="sxs-lookup"><span data-stu-id="2c473-209">For some workloads, you may need larger YARN containers.</span></span>  

<span data-ttu-id="2c473-210">**Aumente os núcleos por contêiner YARN.**</span><span class="sxs-lookup"><span data-stu-id="2c473-210">**Increase cores per YARN container.**</span></span>  <span data-ttu-id="2c473-211">Aumente o número de núcleos alocados para cada contêiner para aumentar o número de tarefas paralelas que são executadas em cada contêiner.</span><span class="sxs-lookup"><span data-stu-id="2c473-211">Increase the number of cores allocated to each container to increase the number of parallel tasks that run in each container.</span></span>  <span data-ttu-id="2c473-212">Isso funciona para aplicativos como Spark, que executam várias tarefas por contêiner.</span><span class="sxs-lookup"><span data-stu-id="2c473-212">This works for applications like Spark which run multiple tasks per container.</span></span>  <span data-ttu-id="2c473-213">Para aplicativos como o Hive, que executam um único thread de cada contêiner, é melhor ter mais contêineres em vez de mais núcleos por contêiner.</span><span class="sxs-lookup"><span data-stu-id="2c473-213">For applications like Hive which run a single thread in each container, it is better to have more containers rather than more cores per container.</span></span>   

### <a name="workload-layer"></a><span data-ttu-id="2c473-214">Camada de carga de trabalho</span><span class="sxs-lookup"><span data-stu-id="2c473-214">Workload Layer</span></span>

<span data-ttu-id="2c473-215">**Use todos os contêineres disponíveis.**</span><span class="sxs-lookup"><span data-stu-id="2c473-215">**Use all available containers.**</span></span>  <span data-ttu-id="2c473-216">Defina o número de tarefas para que seja igual ou maior que o número de contêineres disponíveis de modo que todos os recursos sejam utilizados.</span><span class="sxs-lookup"><span data-stu-id="2c473-216">Set the number of tasks to be equal or larger than the number of available containers so that all resources are utilized.</span></span>

![Desempenho do Data Lake Store](./media/data-lake-store-performance-tuning-guidance/use-containers.png)

<span data-ttu-id="2c473-218">**Tarefas com falha têm alto custo.**</span><span class="sxs-lookup"><span data-stu-id="2c473-218">**Failed tasks are costly.**</span></span> <span data-ttu-id="2c473-219">Se cada tarefa tem uma grande quantidade de dados a serem processados, a falha de uma tarefa resulta em uma repetição cara.</span><span class="sxs-lookup"><span data-stu-id="2c473-219">If each task has a large amount of data to process, then failure of a task results in an expensive retry.</span></span>  <span data-ttu-id="2c473-220">Portanto, é melhor criar mais tarefas, já que cada uma delas processa uma pequena quantidade de dados.</span><span class="sxs-lookup"><span data-stu-id="2c473-220">Therefore, it is better to create more tasks, each of which processes a small amount of data.</span></span>

<span data-ttu-id="2c473-221">Além das diretrizes gerais acima, cada aplicativo tem diferentes parâmetros disponíveis para ajustar para esse aplicativo específico.</span><span class="sxs-lookup"><span data-stu-id="2c473-221">In addition to the general guidelines above, each application has different parameters available to tune for that specific application.</span></span> <span data-ttu-id="2c473-222">A tabela a seguir lista alguns dos parâmetros e links para começar com o ajuste de desempenho para cada aplicativo.</span><span class="sxs-lookup"><span data-stu-id="2c473-222">The table below lists some of the parameters and links to get started with performance tuning for each application.</span></span>

| <span data-ttu-id="2c473-223">Carga de trabalho</span><span class="sxs-lookup"><span data-stu-id="2c473-223">Workload</span></span>               | <span data-ttu-id="2c473-224">Parâmetro para definir tarefas</span><span class="sxs-lookup"><span data-stu-id="2c473-224">Parameter to set tasks</span></span>                                                         |
|--------------------|-------------------------------------------------------------------------------------|
| [<span data-ttu-id="2c473-225">Spark no HDInisight</span><span class="sxs-lookup"><span data-stu-id="2c473-225">Spark on HDInisight</span></span>](data-lake-store-performance-tuning-spark.md)       | <ul><li><span data-ttu-id="2c473-226">Num-executors</span><span class="sxs-lookup"><span data-stu-id="2c473-226">Num-executors</span></span></li><li><span data-ttu-id="2c473-227">Executor-memory</span><span class="sxs-lookup"><span data-stu-id="2c473-227">Executor-memory</span></span></li><li><span data-ttu-id="2c473-228">Executor-cores</span><span class="sxs-lookup"><span data-stu-id="2c473-228">Executor-cores</span></span></li></ul> |
| [<span data-ttu-id="2c473-229">Hive no HDInsight</span><span class="sxs-lookup"><span data-stu-id="2c473-229">Hive on HDInsight</span></span>](data-lake-store-performance-tuning-hive.md)    | <ul><li><span data-ttu-id="2c473-230">hive.tez.container.size</span><span class="sxs-lookup"><span data-stu-id="2c473-230">hive.tez.container.size</span></span></li></ul>         |
| [<span data-ttu-id="2c473-231">MapReduce no HDInsight</span><span class="sxs-lookup"><span data-stu-id="2c473-231">MapReduce on HDInsight</span></span>](data-lake-store-performance-tuning-mapreduce.md)            | <ul><li><span data-ttu-id="2c473-232">Mapreduce.map.memory</span><span class="sxs-lookup"><span data-stu-id="2c473-232">Mapreduce.map.memory</span></span></li><li><span data-ttu-id="2c473-233">Mapreduce.job.maps</span><span class="sxs-lookup"><span data-stu-id="2c473-233">Mapreduce.job.maps</span></span></li><li><span data-ttu-id="2c473-234">Mapreduce.reduce.memory</span><span class="sxs-lookup"><span data-stu-id="2c473-234">Mapreduce.reduce.memory</span></span></li><li><span data-ttu-id="2c473-235">Mapreduce.job.reduces</span><span class="sxs-lookup"><span data-stu-id="2c473-235">Mapreduce.job.reduces</span></span></li></ul> |
| [<span data-ttu-id="2c473-236">Storm no HDInsight</span><span class="sxs-lookup"><span data-stu-id="2c473-236">Storm on HDInsight</span></span>](data-lake-store-performance-tuning-storm.md)| <ul><li><span data-ttu-id="2c473-237">Número de processos de trabalho</span><span class="sxs-lookup"><span data-stu-id="2c473-237">Number of worker processes</span></span></li><li><span data-ttu-id="2c473-238">Número de instâncias de spout executor</span><span class="sxs-lookup"><span data-stu-id="2c473-238">Number of spout executor instances</span></span></li><li><span data-ttu-id="2c473-239">Número de instâncias de bolt executor</span><span class="sxs-lookup"><span data-stu-id="2c473-239">Number of bolt executor instances</span></span> </li><li><span data-ttu-id="2c473-240">Número de tarefas de spout</span><span class="sxs-lookup"><span data-stu-id="2c473-240">Number of spout tasks</span></span></li><li><span data-ttu-id="2c473-241">Número de tarefas de bolt</span><span class="sxs-lookup"><span data-stu-id="2c473-241">Number of bolt tasks</span></span></li></ul>|

## <a name="see-also"></a><span data-ttu-id="2c473-242">Consulte também</span><span class="sxs-lookup"><span data-stu-id="2c473-242">See also</span></span>
* [<span data-ttu-id="2c473-243">Visão geral do Repositório Azure Data Lake</span><span class="sxs-lookup"><span data-stu-id="2c473-243">Overview of Azure Data Lake Store</span></span>](data-lake-store-overview.md)
* [<span data-ttu-id="2c473-244">Introdução à Análise Data Lake do Azure</span><span class="sxs-lookup"><span data-stu-id="2c473-244">Get Started with Azure Data Lake Analytics</span></span>](../data-lake-analytics/data-lake-analytics-get-started-portal.md)
