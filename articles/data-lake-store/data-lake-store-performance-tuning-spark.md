---
title: Diretrizes de ajuste de desempenho para Spark do Azure Data Lake Store | Microsoft Docs
description: Diretrizes de ajuste de desempenho para Spark do Azure Data Lake Store
services: data-lake-store
documentationcenter: 
author: stewu
manager: amitkul
editor: stewu
ms.assetid: ebde7b9f-2e51-4d43-b7ab-566417221335
ms.service: data-lake-store
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 12/19/2016
ms.author: stewu
ms.openlocfilehash: 2109744fb7ffdfafb7a86bbea355e119718af099
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 07/11/2017
---
# <a name="performance-tuning-guidance-for-spark-on-hdinsight-and-azure-data-lake-store"></a><span data-ttu-id="a6410-103">Diretrizes de ajuste do desempenho para o Spark no HDInsight e Azure Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="a6410-103">Performance tuning guidance for Spark on HDInsight and Azure Data Lake Store</span></span>

<span data-ttu-id="a6410-104">Ao realizar o ajuste de desempenho no Spark, você deve considerar o número de aplicativos estarão em execução no cluster.</span><span class="sxs-lookup"><span data-stu-id="a6410-104">When tuning performance on Spark, you need to consider the number of apps that will be running on your cluster.</span></span>  <span data-ttu-id="a6410-105">Por padrão, você pode executar 4 aplicativos simultaneamente no cluster HDI (observação: a configuração padrão está sujeita a alterações).</span><span class="sxs-lookup"><span data-stu-id="a6410-105">By default, you can run 4 apps concurrently on your HDI cluster (Note: the default setting is subject to change).</span></span>  <span data-ttu-id="a6410-106">Você pode decidir usar menos aplicativos, de modo que você possa substituir as configurações padrão e usar mais do cluster para esses aplicativos.</span><span class="sxs-lookup"><span data-stu-id="a6410-106">You may decide to use fewer apps so you can override the default settings and use more of the cluster for those apps.</span></span>  

## <a name="prerequisites"></a><span data-ttu-id="a6410-107">Pré-requisitos</span><span class="sxs-lookup"><span data-stu-id="a6410-107">Prerequisites</span></span>

* <span data-ttu-id="a6410-108">**Uma assinatura do Azure**.</span><span class="sxs-lookup"><span data-stu-id="a6410-108">**An Azure subscription**.</span></span> <span data-ttu-id="a6410-109">Consulte [Obter avaliação gratuita do Azure](https://azure.microsoft.com/pricing/free-trial/).</span><span class="sxs-lookup"><span data-stu-id="a6410-109">See [Get Azure free trial](https://azure.microsoft.com/pricing/free-trial/).</span></span>
* <span data-ttu-id="a6410-110">**Uma conta do repositório Azure Data Lake**.</span><span class="sxs-lookup"><span data-stu-id="a6410-110">**An Azure Data Lake Store account**.</span></span> <span data-ttu-id="a6410-111">Para obter instruções sobre como criar uma, consulte [Introdução ao repositório Azure Data Lake](data-lake-store-get-started-portal.md)</span><span class="sxs-lookup"><span data-stu-id="a6410-111">For instructions on how to create one, see [Get started with Azure Data Lake Store](data-lake-store-get-started-portal.md)</span></span>
* <span data-ttu-id="a6410-112">**Cluster HDInsight do Azure** com acesso a uma conta do Repositório Data Lake.</span><span class="sxs-lookup"><span data-stu-id="a6410-112">**Azure HDInsight cluster** with access to a Data Lake Store account.</span></span> <span data-ttu-id="a6410-113">Confira [Criar um cluster HDInsight com o Data Lake Store](data-lake-store-hdinsight-hadoop-use-portal.md).</span><span class="sxs-lookup"><span data-stu-id="a6410-113">See [Create an HDInsight cluster with Data Lake Store](data-lake-store-hdinsight-hadoop-use-portal.md).</span></span> <span data-ttu-id="a6410-114">Certifique-se de habilitar a área de trabalho remota para o cluster.</span><span class="sxs-lookup"><span data-stu-id="a6410-114">Make sure you enable Remote Desktop for the cluster.</span></span>
* <span data-ttu-id="a6410-115">**Executando o cluster Spark no Azure Data Lake Store**.</span><span class="sxs-lookup"><span data-stu-id="a6410-115">**Running Spark cluster on Azure Data Lake Store**.</span></span>  <span data-ttu-id="a6410-116">Para obter mais informações, veja [Use HDInsight Spark cluster to analyze data in Data Lake Store](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-apache-spark-use-with-data-lake-store) (Usar cluster HDInsight Spark para analisar dados no Data Lake Store)</span><span class="sxs-lookup"><span data-stu-id="a6410-116">For more information, see [Use HDInsight Spark cluster to analyze data in Data Lake Store](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-apache-spark-use-with-data-lake-store)</span></span>
* <span data-ttu-id="a6410-117">**Diretrizes de ajuste de desempenho no ADLS**.</span><span class="sxs-lookup"><span data-stu-id="a6410-117">**Performance tuning guidelines on ADLS**.</span></span>  <span data-ttu-id="a6410-118">Para ver os conceitos gerais de desempenho, confira [Diretrizes de ajuste de desempenho do Data Lake Store](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance)</span><span class="sxs-lookup"><span data-stu-id="a6410-118">For general performance concepts, see [Data Lake Store Performance Tuning Guidance](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance)</span></span> 

## <a name="parameters"></a><span data-ttu-id="a6410-119">parâmetros</span><span class="sxs-lookup"><span data-stu-id="a6410-119">Parameters</span></span>

<span data-ttu-id="a6410-120">Ao executar trabalhos do Spark, aqui estão as configurações mais importantes que podem ser ajustadas para aumentar o desempenho no ADLS:</span><span class="sxs-lookup"><span data-stu-id="a6410-120">When running Spark jobs, here are the most important settings that can be tuned to increase performance on ADLS:</span></span>

* <span data-ttu-id="a6410-121">**Num-executors** – O número de tarefas simultâneas que podem ser executadas.</span><span class="sxs-lookup"><span data-stu-id="a6410-121">**Num-executors** - The number of concurrent tasks that can be executed.</span></span>

* <span data-ttu-id="a6410-122">**Executor-memory** – A quantidade de memória alocada para cada executor.</span><span class="sxs-lookup"><span data-stu-id="a6410-122">**Executor-memory** - The amount of memory allocated to each executor.</span></span>

* <span data-ttu-id="a6410-123">**Executor-cores** – O número de núcleos alocados para cada executor.</span><span class="sxs-lookup"><span data-stu-id="a6410-123">**Executor-cores** - The number of cores allocated to each executor.</span></span>                     

<span data-ttu-id="a6410-124">**Num-executors** – Num-executors definirá o número máximo de tarefas que podem ser executadas em paralelo.</span><span class="sxs-lookup"><span data-stu-id="a6410-124">**Num-executors** Num-executors will set the maximum number of tasks that can run in parallel.</span></span>  <span data-ttu-id="a6410-125">O número real de tarefas que podem ser executadas em paralelo é limitado pela memória e recursos de CPU disponíveis no cluster.</span><span class="sxs-lookup"><span data-stu-id="a6410-125">The actual number of tasks that can run in parallel is bounded by the memory and CPU resources available in your cluster.</span></span>

<span data-ttu-id="a6410-126">**Executor-memory** – Esta é a quantidade de memória sendo alocada para cada executor.</span><span class="sxs-lookup"><span data-stu-id="a6410-126">**Executor-memory** This is the amount of memory that is being allocated to each executor.</span></span>  <span data-ttu-id="a6410-127">A memória necessária para cada executor depende do trabalho.</span><span class="sxs-lookup"><span data-stu-id="a6410-127">The memory needed for each executor is dependent on the job.</span></span>  <span data-ttu-id="a6410-128">Para operações complexas, a memória deve ser maior.</span><span class="sxs-lookup"><span data-stu-id="a6410-128">For complex operations, the memory needs to be higher.</span></span>  <span data-ttu-id="a6410-129">Para operações simples como leitura e gravação, os requisitos de memória serão menores.</span><span class="sxs-lookup"><span data-stu-id="a6410-129">For simple operations like read and write, memory requirements will be lower.</span></span>  <span data-ttu-id="a6410-130">A quantidade de memória para cada executor pode ser exibida no Ambari.</span><span class="sxs-lookup"><span data-stu-id="a6410-130">The amount of memory for each executor can be viewed in Ambari.</span></span>  <span data-ttu-id="a6410-131">No Ambari, navegue até o Spark e exiba a guia Configurações.</span><span class="sxs-lookup"><span data-stu-id="a6410-131">In Ambari, navigate to Spark and view the Configs tab.</span></span>  

<span data-ttu-id="a6410-132">**Executor-cores** – Isso define a quantidade de núcleos usados por executor, o que determina o número de threads paralelos que podem ser executados por executor.</span><span class="sxs-lookup"><span data-stu-id="a6410-132">**Executor-cores** This sets the amount of cores used per executor, which determines the number of parallel threads that can be run per executor.</span></span>  <span data-ttu-id="a6410-133">Por exemplo, se executor-cores = 2, então cada executor pode executar duas tarefas paralelas no executor.</span><span class="sxs-lookup"><span data-stu-id="a6410-133">For example, if executor-cores = 2, then each executor can run 2 parallel tasks in the executor.</span></span>  <span data-ttu-id="a6410-134">O valor de executor-cores necessário dependerá do trabalho.</span><span class="sxs-lookup"><span data-stu-id="a6410-134">The executor-cores needed will be dependent on the job.</span></span>  <span data-ttu-id="a6410-135">Trabalhos com uso intensivo de E/S não exigem uma grande quantidade de memória por tarefa para que cada executor possa manipular mais tarefas paralelas.</span><span class="sxs-lookup"><span data-stu-id="a6410-135">I/O heavy jobs do not require a large amount of memory per task so each executor can handle more parallel tasks.</span></span>

<span data-ttu-id="a6410-136">Por padrão, dois núcleos YARN virtuais são definidos para cada núcleo físico ao executar o Spark no HDInsight.</span><span class="sxs-lookup"><span data-stu-id="a6410-136">By default, two virtual YARN cores are defined for each physical core when running Spark on HDInsight.</span></span>  <span data-ttu-id="a6410-137">Esse número fornece um bom equilíbrio entre a simultaneidade e a quantidade de mudanças de contexto de vários threads.</span><span class="sxs-lookup"><span data-stu-id="a6410-137">This number provides a good balance of concurrecy and amount of context switching from multiple threads.</span></span>  

## <a name="guidance"></a><span data-ttu-id="a6410-138">Diretrizes</span><span class="sxs-lookup"><span data-stu-id="a6410-138">Guidance</span></span>

<span data-ttu-id="a6410-139">Ao executar cargas de trabalho analíticas do Spark para trabalhar com os dados no Data Lake Store, é recomendável que você use as versões mais recentes do HDInsight para obter o melhor desempenho com o Data Lake Store.</span><span class="sxs-lookup"><span data-stu-id="a6410-139">While running Spark analytic workloads to work with data in Data Lake Store, we recommend that you use the most recent HDInsight version to get the best performance with Data Lake Store.</span></span> <span data-ttu-id="a6410-140">Quando o trabalho faz uso mais intensivo de E/S, determinados parâmetros podem ser configurados para melhorar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="a6410-140">When your job is more I/O intensive, then certain parameters can be configured to improve performance.</span></span>  <span data-ttu-id="a6410-141">O Azure Data Lake Store é uma plataforma de armazenamento altamente escalonável que pode lidar com uma alta taxa de transferência.</span><span class="sxs-lookup"><span data-stu-id="a6410-141">Azure Data Lake Store is a highly scalable storage platform that can handle high throughput.</span></span>  <span data-ttu-id="a6410-142">Se o trabalho consiste principalmente em leitura ou gravação, aumentar a simultaneidade de E/S para e o Azure Data Lake Store pode aumentar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="a6410-142">If the job mainly consists of read or writes, then increasing concurrency for I/O to and from Azure Data Lake Store could increase performance.</span></span>

<span data-ttu-id="a6410-143">Existem algumas maneiras gerais de aumentar a simultaneidade para os trabalhos com uso intensivo de E/S.</span><span class="sxs-lookup"><span data-stu-id="a6410-143">There are a few general ways to increase concurrency for I/O intensive jobs.</span></span>

<span data-ttu-id="a6410-144">**Etapa 1: determinar quantos aplicativos estão em execução no cluster** – você deve saber quantos aplicativos estão em execução no cluster, incluindo o atual.</span><span class="sxs-lookup"><span data-stu-id="a6410-144">**Step 1: Determine how many apps are running on your cluster** – You should know how many apps are running on the cluster including the current one.</span></span>  <span data-ttu-id="a6410-145">Os valores padrão para cada configuração do Spark assume que há quatro aplicativos em execução simultaneamente.</span><span class="sxs-lookup"><span data-stu-id="a6410-145">The default values for each Spark setting assumes that there are 4 apps running concurrently.</span></span>  <span data-ttu-id="a6410-146">Portanto, você terá apenas 25% do cluster disponível para cada aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a6410-146">Therefore, you will only have 25% of the cluster available for each app.</span></span>  <span data-ttu-id="a6410-147">Para obter um melhor desempenho, você pode substituir os padrões por meio da alteração do número de executores.</span><span class="sxs-lookup"><span data-stu-id="a6410-147">To get better performance, you can override the defaults by changing the number of executors.</span></span>  

<span data-ttu-id="a6410-148">**Etapa 2: configurar executor-memory** – a primeira coisa a definir é o executor-memory.</span><span class="sxs-lookup"><span data-stu-id="a6410-148">**Step 2: Set executor-memory** – the first thing to set is the executor-memory.</span></span>  <span data-ttu-id="a6410-149">A memória dependerá do trabalho que você pretende executar.</span><span class="sxs-lookup"><span data-stu-id="a6410-149">The memory will be dependent on the job that you are going to run.</span></span>  <span data-ttu-id="a6410-150">Você pode aumentar a simultaneidade ao alocar menos memória por executor.</span><span class="sxs-lookup"><span data-stu-id="a6410-150">You can increase concurrency by allocating less memory per executor.</span></span>  <span data-ttu-id="a6410-151">Se você vir exceções de memória insuficiente quando executar o trabalho, você deverá aumentar o valor desse parâmetro.</span><span class="sxs-lookup"><span data-stu-id="a6410-151">If you see out of memory exceptions when you run your job, then you should increase the value for this parameter.</span></span>  <span data-ttu-id="a6410-152">Uma alternativa é de obter mais memória pelo uso de um cluster com maiores quantidades de memória ou pelo aumento do tamanho do cluster.</span><span class="sxs-lookup"><span data-stu-id="a6410-152">One alternative is to get more memory by using a cluster that has higher amounts of memory or increasing the size of your cluster.</span></span>  <span data-ttu-id="a6410-153">Mais memória permitirá o uso de mais executores, o que significa mais simultaneidade.</span><span class="sxs-lookup"><span data-stu-id="a6410-153">More memory will enable more executors to be used, which means more concurrency.</span></span>

<span data-ttu-id="a6410-154">**Etapa 3: definir executor-cores** – para cargas de trabalho com uso intensivo de E/S que não têm operações complexas, é recomendável iniciar com um número alto de núcleos de executor para aumentar o número de tarefas paralelas por executor.</span><span class="sxs-lookup"><span data-stu-id="a6410-154">**Step 3: Set executor-cores** – For I/O intensive workloads that do not have complex operations, it’s good to start with a high number of executor-cores to increase the number of parallel tasks per executor.</span></span>  <span data-ttu-id="a6410-155">Configurar executor-cores para 4 é um bom começo.</span><span class="sxs-lookup"><span data-stu-id="a6410-155">Setting executor-cores to 4 is a good start.</span></span>   

    executor-cores = 4
<span data-ttu-id="a6410-156">Aumentar o número de núcleos de executor lhe dará mais paralelismo para que você pode experimentar com diferentes núcleos de executor.</span><span class="sxs-lookup"><span data-stu-id="a6410-156">Increasing the number of executor-cores will give you more parallelism so you can experiment with different executor-cores.</span></span>  <span data-ttu-id="a6410-157">Para trabalhos que têm operações mais complexas, você deve reduzir o número de núcleos por executor.</span><span class="sxs-lookup"><span data-stu-id="a6410-157">For jobs that have more complex operations, you should reduce the number of cores per executor.</span></span>  <span data-ttu-id="a6410-158">Se executor-cores for definido para um valor maior que 4, a coleta de lixo poderá tornar-se ineficiente e prejudicar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="a6410-158">If executor-cores is set higher than 4, then garbage collection may become inefficient and degrade performance.</span></span>

<span data-ttu-id="a6410-159">**Etapa 4: determinar a quantidade de memória YARN no cluster** – essas informações estão disponíveis no Ambari.</span><span class="sxs-lookup"><span data-stu-id="a6410-159">**Step 4: Determine amount of YARN memory in cluster** – This information is available in Ambari.</span></span>  <span data-ttu-id="a6410-160">Navegue até YARN e exiba a guia Configurações.</span><span class="sxs-lookup"><span data-stu-id="a6410-160">Navigate to YARN and view the Configs tab.</span></span>  <span data-ttu-id="a6410-161">A memória YARN é exibida nessa janela.</span><span class="sxs-lookup"><span data-stu-id="a6410-161">The YARN memory is displayed in this window.</span></span>  
<span data-ttu-id="a6410-162">Observação: enquanto estiver na janela, você também poderá ver o tamanho do contêiner YARN padrão.</span><span class="sxs-lookup"><span data-stu-id="a6410-162">Note: while you are in the window, you can also see the default YARN container size.</span></span>  <span data-ttu-id="a6410-163">O tamanho do contêiner YARN é o mesmo que o do parâmetro de memória por executor.</span><span class="sxs-lookup"><span data-stu-id="a6410-163">The YARN container size is the same as memory per executor paramter.</span></span>

    Total YARN memory = nodes * YARN memory per node
<span data-ttu-id="a6410-164">**Etapa 5: calcular num-executors**</span><span class="sxs-lookup"><span data-stu-id="a6410-164">**Step 5: Calculate num-executors**</span></span>

<span data-ttu-id="a6410-165">**Calcular a restrição de memória** – o parâmetro num-executors é restrito por memória ou por CPU.</span><span class="sxs-lookup"><span data-stu-id="a6410-165">**Calculate memory constraint** - The num-executors parameter is constrained either by memory or by CPU.</span></span>  <span data-ttu-id="a6410-166">A restrição de memória é determinada pela quantidade de memória YARN disponível para seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a6410-166">The memory constraint is determined by the amount of available YARN memory for your application.</span></span>  <span data-ttu-id="a6410-167">Você deve pegar a memória YARN total e dividi-la por executor-memory.</span><span class="sxs-lookup"><span data-stu-id="a6410-167">You should take total YARN memory and divide that by executor-memory.</span></span>  <span data-ttu-id="a6410-168">O ajuste de escala da restrição precisa ser realizado de acordo com número de aplicativos, então realizamos a divisão pelo número de aplicativos.</span><span class="sxs-lookup"><span data-stu-id="a6410-168">The constraint needs to be de-scaled for the number of apps so we divide by the number of apps.</span></span>

    Memory constraint = (total YARN memory / executor memory) / # of apps   
<span data-ttu-id="a6410-169">**Calcular a restrição de CPU** – a restrição de CPU é calculada como o total de núcleos virtuais dividido pelo número de núcleos por executor.</span><span class="sxs-lookup"><span data-stu-id="a6410-169">**Calculate CPU constraint** - The CPU constraint is calculated as the total virtual cores divided by the number of cores per executor.</span></span>  <span data-ttu-id="a6410-170">Há dois núcleos virtuais para cada núcleo físico.</span><span class="sxs-lookup"><span data-stu-id="a6410-170">There are 2 virtual cores for each physical core.</span></span>  <span data-ttu-id="a6410-171">Semelhante ao que ocorre na restrição de memória, realizamos a divisão pelo número de aplicativos.</span><span class="sxs-lookup"><span data-stu-id="a6410-171">Similar to the memory constraint, we have divide by the number of apps.</span></span>

    virtual cores = (nodes in cluster * # of physical cores in node * 2)
    CPU constraint = (total virtual cores / # of cores per executor) / # of apps
<span data-ttu-id="a6410-172">**Definir num-executors** – o parâmetro num-executors será determinado utilizando o mínimo da restrição de memória e da restrição de CPU.</span><span class="sxs-lookup"><span data-stu-id="a6410-172">**Set num-executors** – The num-executors parameter is determined by taking the minimum of the memory constraint and the CPU constraint.</span></span> 

    num-executors = Min (total virtual Cores / # of cores per executor, available YARN memory / executor-memory)   
<span data-ttu-id="a6410-173">Configurar um número maior de num-executors não implica necessariamente em aumento de desempenho.</span><span class="sxs-lookup"><span data-stu-id="a6410-173">Setting a higher number of num-executors does not necessarily increase performance.</span></span>  <span data-ttu-id="a6410-174">Considere que adicionar mais executores adicionará sobrecarga extra para cada executor adicional, o que pode degradar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="a6410-174">You should consider that adding more executors will add extra overhead for each additional executor, which can potentially degrade performance.</span></span>  <span data-ttu-id="a6410-175">Num-executors é limitado pelos recursos de cluster.</span><span class="sxs-lookup"><span data-stu-id="a6410-175">Num-executors is bounded by the cluster resources.</span></span>    

## <a name="example-calculation"></a><span data-ttu-id="a6410-176">Exemplo de cálculo</span><span class="sxs-lookup"><span data-stu-id="a6410-176">Example Calculation</span></span>

<span data-ttu-id="a6410-177">Digamos que você tem atualmente um cluster composto de oito nós D4v2 e que está executando dois aplicativos, incluindo aquele que você pretende executar.</span><span class="sxs-lookup"><span data-stu-id="a6410-177">Let’s say you currently have a cluster composed of 8 D4v2 nodes that is running 2 apps including the one you are going to run.</span></span>  

<span data-ttu-id="a6410-178">**Etapa 1: determinar quantos aplicativos estão em execução no cluster** – você sabe que tem dois aplicativos no cluster, incluindo aquele que você pretende executar.</span><span class="sxs-lookup"><span data-stu-id="a6410-178">**Step 1: Determine how many apps are running on your cluster** – you know that you have 2 apps on your cluster, including the one you are going to run.</span></span>  

<span data-ttu-id="a6410-179">**Etapa 2: definir executor-memory** – neste exemplo, determinamos que 6 GB de executor-memory será suficiente para trabalho com uso intensivo de E/S.</span><span class="sxs-lookup"><span data-stu-id="a6410-179">**Step 2: Set executor-memory** – for this example, we determine that 6GB of executor-memory will be sufficient for I/O intensive job.</span></span>  

    executor-memory = 6GB
<span data-ttu-id="a6410-180">**Etapa 3: definir executor-cores** – como esse é um trabalho com uso intensivo de E/S, podemos definir o número de núcleos para cada executor como quatro.</span><span class="sxs-lookup"><span data-stu-id="a6410-180">**Step 3: Set executor-cores** – Since this is an I/O intensive job, we can set the number of cores for each executor to 4.</span></span>  <span data-ttu-id="a6410-181">Configurar o número de núcleos por executor para um valor maior do que quatro pode causar problemas na coleta de lixo.</span><span class="sxs-lookup"><span data-stu-id="a6410-181">Setting cores per executor to larger than 4 may cause garbage collection problems.</span></span>  

    executor-cores = 4
<span data-ttu-id="a6410-182">**Etapa 4: determinar a quantidade de memória YARN no cluster** – navegamos até o Ambari para descobrir que cada D4v2 tem 25 GB de memória YARN.</span><span class="sxs-lookup"><span data-stu-id="a6410-182">**Step 4: Determine amount of YARN memory in cluster** – We navigate to Ambari to find out that each D4v2 has 25GB of YARN memory.</span></span>  <span data-ttu-id="a6410-183">Como há oito nós, a memória YARN disponível é multiplicada por oito.</span><span class="sxs-lookup"><span data-stu-id="a6410-183">Since there are 8 nodes, the available YARN memory is multiplied by 8.</span></span>

    Total YARN memory = nodes * YARN memory* per node
    Total YARN memory = 8 nodes * 25GB = 200GB
<span data-ttu-id="a6410-184">**Etapa 5: calcular num-executors** – o parâmetro num-executors será determinado utilizando o mínimo da restrição de memória e da restrição de CPU divididos pelo número de aplicativos em execução no Spark.</span><span class="sxs-lookup"><span data-stu-id="a6410-184">**Step 5: Calculate num-executors** – The num-executors parameter is determined by taking the minimum of the memory constraint and the CPU constraint divided by the # of apps running on Spark.</span></span>    

<span data-ttu-id="a6410-185">**Calcular a restrição de memória** – a restrição de memória é calculada como a memória YARN total dividida pela memória por executor.</span><span class="sxs-lookup"><span data-stu-id="a6410-185">**Calculate memory constraint** – The memory constraint is calculated as the total YARN memory divided by the memory per executor.</span></span>

    Memory constraint = (total YARN memory / executor memory) / # of apps   
    Memory constraint = (200GB / 6GB) / 2   
    Memory constraint = 16 (rounded)
<span data-ttu-id="a6410-186">**Calcular a restrição de CPU** – a restrição de CPU é calculada como o total de núcleos YARN dividido pelo número de núcleos por executor.</span><span class="sxs-lookup"><span data-stu-id="a6410-186">**Calculate CPU constraint** - The CPU constraint is calculated as the total yarn cores divided by the number of cores per executor.</span></span>
    
    YARN cores = nodes in cluster * # of cores per node * 2   
    YARN cores = 8 nodes * 8 cores per D14 * 2 = 128
    CPU constraint = (total YARN cores / # of cores per executor) / # of apps
    CPU constraint = (128 / 4) / 2
    CPU constraint = 16
<span data-ttu-id="a6410-187">**Definir num-executors**</span><span class="sxs-lookup"><span data-stu-id="a6410-187">**Set num-executors**</span></span>

    num-executors = Min (memory constraint, CPU constraint)
    num-executors = Min (16, 16)
    num-executors = 16    

