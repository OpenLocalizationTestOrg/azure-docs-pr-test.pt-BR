---
title: Regras de firewall do Banco de Dados do Azure para servidor PostgreSQL | Microsoft Docs
description: Descreve as regras de firewall para seu Banco de Dados do Azure para servidor PostgreSQL.
services: postgresql
author: jasonwhowell
ms.author: jasonh
manager: jhubbard
editor: jasonwhowell
ms.service: postgresql
ms.topic: article
ms.date: 05/10/2017
ms.openlocfilehash: 150c4f53c5ab6a6425b6af7d286d4c1518b006f8
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/29/2017
---
# <a name="azure-database-for-postgresql-server-firewall-rules"></a><span data-ttu-id="d40e4-103">Regras de firewall do Banco de Dados do Azure para servidor PostgreSQL</span><span class="sxs-lookup"><span data-stu-id="d40e4-103">Azure Database for PostgreSQL Server firewall rules</span></span>
<span data-ttu-id="d40e4-104">Os firewalls impedem todo acesso ao seu servidor de banco de dados até que você especifique quais computadores têm permissão.</span><span class="sxs-lookup"><span data-stu-id="d40e4-104">Firewalls prevent all access to your database server until you specify which computers have permission.</span></span> <span data-ttu-id="d40e4-105">O firewall concede acesso ao servidor com base no endereço IP de origem de cada solicitação.</span><span class="sxs-lookup"><span data-stu-id="d40e4-105">The firewall grants access to the server based on the originating IP address of each request.</span></span>
<span data-ttu-id="d40e4-106">Para configurar seu firewall, você deve criar regras de firewall que especifiquem intervalos de endereços IP aceitáveis.</span><span class="sxs-lookup"><span data-stu-id="d40e4-106">To configure your firewall, you create firewall rules that specify ranges of acceptable IP addresses.</span></span> <span data-ttu-id="d40e4-107">Você pode criar regras de firewall no nível de servidor.</span><span class="sxs-lookup"><span data-stu-id="d40e4-107">You can create firewall rules at the server level.</span></span>

<span data-ttu-id="d40e4-108">**Regras de firewall:** essas regras permitem que os clientes acessem todo o Banco de Dados do Azure para servidor PostgreSQL, ou seja, todos os bancos dentro do mesmo servidor lógico.</span><span class="sxs-lookup"><span data-stu-id="d40e4-108">**Firewall rules:** These rules enable clients to access your entire Azure Database for PostgreSQL Server, that is, all the databases within the same logical server.</span></span> <span data-ttu-id="d40e4-109">As regras de firewall no nível de servidor podem ser configuradas por meio do Portal do Azure ou usando comandos da CLI do Azure.</span><span class="sxs-lookup"><span data-stu-id="d40e4-109">Server-level firewall rules can be configured by using the Azure portal or using Azure CLI commands.</span></span> <span data-ttu-id="d40e4-110">Para criar regras de firewall no nível de servidor, você deve ser o proprietário da assinatura ou um colaborador da assinatura.</span><span class="sxs-lookup"><span data-stu-id="d40e4-110">To create server-level firewall rules, you must be the subscription owner or a subscription contributor.</span></span>

## <a name="firewall-overview"></a><span data-ttu-id="d40e4-111">Visão geral do firewall</span><span class="sxs-lookup"><span data-stu-id="d40e4-111">Firewall overview</span></span>
<span data-ttu-id="d40e4-112">Todo acesso de banco de dados ao seu Banco de Dados do Azure para servidor PostgreSQL é bloqueado por padrão pelo firewall.</span><span class="sxs-lookup"><span data-stu-id="d40e4-112">All database access to your Azure Database for PostgreSQL server is blocked by the firewall by default.</span></span> <span data-ttu-id="d40e4-113">Para começar a usar o servidor de outro computador, especifique uma ou mais regras de firewall no nível do servidor para permitir o acesso ao seu servidor.</span><span class="sxs-lookup"><span data-stu-id="d40e4-113">To begin using your server from another computer, you need to specify one or more server-level firewall rules to enable access to your server.</span></span> <span data-ttu-id="d40e4-114">Use as regras de firewall para especificar quais intervalos de endereços IP da Internet permitir.</span><span class="sxs-lookup"><span data-stu-id="d40e4-114">Use the firewall rules to specify which IP address ranges from the Internet to allow.</span></span> <span data-ttu-id="d40e4-115">O acesso em si ao site do Portal do Azure não é afetado pelas regras de firewall.</span><span class="sxs-lookup"><span data-stu-id="d40e4-115">Access to the Azure portal website itself is not impacted by the firewall rules.</span></span>
<span data-ttu-id="d40e4-116">As tentativas de conexão da Internet e do Azure devem passar primeiramente pelo firewall antes de poderem acessar seu Banco de Dados PostgreSQL, conforme exibido no diagrama a seguir:</span><span class="sxs-lookup"><span data-stu-id="d40e4-116">Connection attempts from the Internet and Azure must first pass through the firewall before they can reach your PostgreSQL Database, as shown in the following diagram:</span></span>

![Fluxo de exemplo de como funciona o firewall](media/concepts-firewall-rules/1-firewall-concept.png)

## <a name="connecting-from-the-internet"></a><span data-ttu-id="d40e4-118">Conectando pela Internet</span><span class="sxs-lookup"><span data-stu-id="d40e4-118">Connecting from the Internet</span></span>
<span data-ttu-id="d40e4-119">Regras de firewall de nível de servidor se aplicam a todos os bancos de dados no Banco de Dados do Azure para servidor PostgreSQL.</span><span class="sxs-lookup"><span data-stu-id="d40e4-119">Server-level firewall rules apply to all databases on the Azure Database for PostgreSQL server.</span></span> <span data-ttu-id="d40e4-120">Se o endereço IP da solicitação estiver dentro de um dos intervalos especificados nas regras de firewall no nível do servidor, a conexão será concedida.</span><span class="sxs-lookup"><span data-stu-id="d40e4-120">If the IP address of the request is within one of the ranges specified in the server-level firewall rules, the connection is granted.</span></span>
<span data-ttu-id="d40e4-121">Se o endereço IP da solicitação não estiver dentro dos intervalos especificados em uma das regras de firewall no nível de banco de dados ou de servidor, a solicitação de conexão falhará.</span><span class="sxs-lookup"><span data-stu-id="d40e4-121">If the IP address of the request is not within the ranges specified in any of the database-level or server-level firewall rules, the connection request fails.</span></span>
<span data-ttu-id="d40e4-122">Por exemplo, se o seu aplicativo se conectar ao driver JDBC para PostgreSQL, você poderá encontrar esse erro ao tentar se conectar quando o firewall estiver bloqueando a conexão.</span><span class="sxs-lookup"><span data-stu-id="d40e4-122">For example, if your application connects with JDBC driver for PostgreSQL, you may encounter this error attempting to connect when the firewall is blocking the connection.</span></span>
> <span data-ttu-id="d40e4-123">java.util.concurrent.ExecutionException: java.lang.RuntimeException: org.postgresql.util.PSQLException: FATAL: no pg\_hba.conf entry for host "123.45.67.890", user "adminuser", database "postgresql", SSL</span><span class="sxs-lookup"><span data-stu-id="d40e4-123">java.util.concurrent.ExecutionException: java.lang.RuntimeException: org.postgresql.util.PSQLException: FATAL: no pg\_hba.conf entry for host "123.45.67.890", user "adminuser", database "postgresql", SSL</span></span>

## <a name="programmatically-managing-firewall-rules"></a><span data-ttu-id="d40e4-124">Gerenciando programaticamente as regras de firewall</span><span class="sxs-lookup"><span data-stu-id="d40e4-124">Programmatically managing firewall rules</span></span>
<span data-ttu-id="d40e4-125">Além do Portal do Azure, as regras de firewall podem ser gerenciadas por meio de programação usando a CLI do Azure.</span><span class="sxs-lookup"><span data-stu-id="d40e4-125">In addition to the Azure portal, firewall rules can be managed programmatically using Azure CLI.</span></span>
<span data-ttu-id="d40e4-126">Confira também [Criar e gerenciar regras de firewall do Banco de Dados do Azure para PostgreSQL usando a CLI do Azure](howto-manage-firewall-using-cli.md)</span><span class="sxs-lookup"><span data-stu-id="d40e4-126">See also [Create and manage Azure Database for PostgreSQL firewall rules using Azure CLI](howto-manage-firewall-using-cli.md)</span></span>

## <a name="troubleshooting-the-database-firewall"></a><span data-ttu-id="d40e4-127">Solucionando problemas do firewall de banco de dados</span><span class="sxs-lookup"><span data-stu-id="d40e4-127">Troubleshooting the database firewall</span></span>
<span data-ttu-id="d40e4-128">Considere os seguintes pontos quando o acesso ao Banco de Dados do Microsoft Azure para o serviço de servidor PostgreSQL não se comportar conforme o esperado:</span><span class="sxs-lookup"><span data-stu-id="d40e4-128">Consider the following points when access to the Microsoft Azure Database for PostgreSQL Server service does not behave as you expect:</span></span>

* <span data-ttu-id="d40e4-129">**As alterações à lista de permissões ainda não entraram em vigor:** pode ocorrer um atraso de cinco minutos para que as alterações na configuração do firewall do Banco de Dados do Azure para servidor PostgreSQL entrem em vigor.</span><span class="sxs-lookup"><span data-stu-id="d40e4-129">**Changes to the allow list have not taken effect yet:** There may be as much as a five-minute delay for changes to the Azure Database for PostgreSQL Server firewall configuration to take effect.</span></span>

* <span data-ttu-id="d40e4-130">**O logon não está autorizado ou uma senha incorreta foi usada:** se um logon não tiver permissões no servidor do Banco de Dados do Azure para servidor PostgreSQL, ou se a senha usada estiver incorreta, a conexão com o Banco de Dados do Azure para servidor PostgreSQL será negada.</span><span class="sxs-lookup"><span data-stu-id="d40e4-130">**The login is not authorized or an incorrect password was used:** If a login does not have permissions on the Azure Database for PostgreSQL server or the password used is incorrect, the connection to the Azure Database for PostgreSQL server is denied.</span></span> <span data-ttu-id="d40e4-131">Criar uma configuração de firewall apenas oferece aos clientes uma oportunidade de tentar se conectar ao servidor; cada cliente deve fornecer as credenciais de segurança necessárias.</span><span class="sxs-lookup"><span data-stu-id="d40e4-131">Creating a firewall setting only provides clients with an opportunity to attempt connecting to your server; each client must provide the necessary security credentials.</span></span>

<span data-ttu-id="d40e4-132">Por exemplo, usando um cliente JDBC, o seguinte erro pode aparecer.</span><span class="sxs-lookup"><span data-stu-id="d40e4-132">For example, using a JDBC client, the following error may appear.</span></span>
> <span data-ttu-id="d40e4-133">java.util.concurrent.ExecutionException: java.lang.RuntimeException: org.postgresql.util.PSQLException: FATAL: falha na autenticação da senha para o usuário "seunomedeusuário"</span><span class="sxs-lookup"><span data-stu-id="d40e4-133">java.util.concurrent.ExecutionException: java.lang.RuntimeException: org.postgresql.util.PSQLException: FATAL: password authentication failed for user "yourusername"</span></span>

* <span data-ttu-id="d40e4-134">**Endereço IP dinâmico:** se você tiver uma conexão com a Internet com endereçamento IP dinâmico e estiver com dificuldades para atravessar o firewall, tente uma das seguintes soluções:</span><span class="sxs-lookup"><span data-stu-id="d40e4-134">**Dynamic IP address:** If you have an Internet connection with dynamic IP addressing and you are having trouble getting through the firewall, you could try one of the following solutions:</span></span>

* <span data-ttu-id="d40e4-135">Peça ao seu Provedor de serviços de Internet (ISP) o intervalo de endereços IP atribuído aos computadores clientes que acessarão o servidor de Banco de Dados do Azure para servidor PostgreSQL e, em seguida, adicione o intervalo de endereços IP como uma regra de firewall.</span><span class="sxs-lookup"><span data-stu-id="d40e4-135">Ask your Internet Service Provider (ISP) for the IP address range assigned to your client computers that access the Azure Database for PostgreSQL Server, and then add the IP address range as a firewall rule.</span></span>

* <span data-ttu-id="d40e4-136">Obtenha o endereçamento IP estático para os computadores cliente e, em seguida, adicione os endereços IP como regras de firewall.</span><span class="sxs-lookup"><span data-stu-id="d40e4-136">Get static IP addressing instead for your client computers, and then add the IP addresses as firewall rules.</span></span>

## <a name="next-steps"></a><span data-ttu-id="d40e4-137">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="d40e4-137">Next steps</span></span>
<span data-ttu-id="d40e4-138">Para ver artigos sobre como criar regras de firewall no nível de servidor e de banco de dados, consulte:</span><span class="sxs-lookup"><span data-stu-id="d40e4-138">For articles on creating server-level and database-level firewall rules, see:</span></span>
* [<span data-ttu-id="d40e4-139">Criar e gerenciar regras de firewall do Banco de Dados do Azure para PostgreSQL usando o Portal do Azure</span><span class="sxs-lookup"><span data-stu-id="d40e4-139">Create and manage Azure Database for PostgreSQL firewall rules using the Azure portal</span></span>](howto-manage-firewall-using-portal.md)
* [<span data-ttu-id="d40e4-140">Criar e gerenciar regras de firewall do Banco de Dados do Azure para PostgreSQL usando a CLI do Azure</span><span class="sxs-lookup"><span data-stu-id="d40e4-140">Create and manage Azure Database for PostgreSQL firewall rules using Azure CLI</span></span>](howto-manage-firewall-using-cli.md)