# <a name="secure-your-iot-deployment"></a><span data-ttu-id="c9bf4-101">Proteger sua implantação de IoT</span><span class="sxs-lookup"><span data-stu-id="c9bf4-101">Secure your IoT deployment</span></span>
<span data-ttu-id="c9bf4-102">Este artigo fornece detalhes avançados para proteger sua a infraestrutura IoT (Internet das Coisas) baseada em Azure IoT.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-102">This article provides the next level of detail for securing the Azure IoT-based Internet of Things (IoT) infrastructure.</span></span> <span data-ttu-id="c9bf4-103">Ele vincula detalhes de nível de implementação para configurar e implantar cada componente.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-103">It links to implementation level details for configuring and deploying each component.</span></span> <span data-ttu-id="c9bf4-104">Além disso, ele fornece comparações e opções entre vários métodos de concorrentes.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-104">It also provides comparisons and choices between various competing methods.</span></span>

<span data-ttu-id="c9bf4-105">A proteção da implantação do Azure IoT pode ser dividida nas seguintes áreas de três segurança:</span><span class="sxs-lookup"><span data-stu-id="c9bf4-105">Securing the Azure IoT deployment can be divided into the following three security areas:</span></span>

* <span data-ttu-id="c9bf4-106">**Segurança de Dispositivo**: Protegendo o dispositivo IoT enquanto ele é implantado em uso.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-106">**Device Security**: Securing the IoT device while it is deployed in the wild.</span></span>
* <span data-ttu-id="c9bf4-107">**Segurança da Conexão**: garantir que todos os dados transmitidos entre o dispositivo IoT e o Hub IoT sejam confidenciais e à prova de adulteração.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-107">**Connection Security**: Ensuring all data transmitted between the IoT device and IoT Hub is confidential and tamper-proof.</span></span>
* <span data-ttu-id="c9bf4-108">**Segurança na Nuvem**: fornecendo meios para proteger os dados enquanto eles são movidos pela nuvem e armazenados nela.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-108">**Cloud Security**: Providing a means to secure data while it moves through, and is stored in the cloud.</span></span>

![Três áreas de segurança][img-overview]

## <a name="secure-device-provisioning-and-authentication"></a><span data-ttu-id="c9bf4-110">Provisionamento e autenticação com segurança dos dispositivos</span><span class="sxs-lookup"><span data-stu-id="c9bf4-110">Secure device provisioning and authentication</span></span>
<span data-ttu-id="c9bf4-111">O Azure IoT Suite protege dispositivos IoT por meio dos dois métodos a seguir:</span><span class="sxs-lookup"><span data-stu-id="c9bf4-111">The Azure IoT Suite secures IoT devices by the following two methods:</span></span>

* <span data-ttu-id="c9bf4-112">Fornecendo uma chave de identidade exclusiva (tokens de segurança) para cada dispositivo, o que pode ser usado pelo dispositivo para se comunicar com o Hub IoT.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-112">By providing a unique identity key (security tokens) for each device, which can be used by the device to communicate with the IoT Hub.</span></span>
* <span data-ttu-id="c9bf4-113">Usando um [certificado X.509][lnk-x509] no dispositivo e uma chave privada como meio de autenticar o dispositivo para o Hub IoT.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-113">By using an on-device [X.509 certificate][lnk-x509] and private key as a means to authenticate the device to the IoT Hub.</span></span> <span data-ttu-id="c9bf4-114">Esse método de autenticação garante que a chave privada no dispositivo não seja conhecida for do dispositivo em momento algum, o que fornece um nível mais alto de segurança.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-114">This authentication method ensures that the private key on the device is not known outside the device at any time, providing a higher level of security.</span></span>

<span data-ttu-id="c9bf4-115">O método de token de segurança fornece autenticação para cada chamada feita pelo dispositivo para Hub IoT ao associar a chave simétrica a cada chamada.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-115">The security token method provides authentication for each call made by the device to IoT Hub by associating the symmetric key to each call.</span></span> <span data-ttu-id="c9bf4-116">A autenticação com base em x.509 permite a autenticação de um dispositivo IoT na camada física como parte do estabelecimento de conexão TLS.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-116">X.509-based authentication allows authentication of an IoT device at the physical layer as part of the TLS connection establishment.</span></span> <span data-ttu-id="c9bf4-117">O método baseado em token de segurança pode ser usado sem a autenticação x.509, que é um padrão menos seguro.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-117">The security-token-based method can be used without the X.509 authentication which is a less secure pattern.</span></span> <span data-ttu-id="c9bf4-118">A escolha entre os dois métodos é determinada principalmente pelo nível de segurança que a autenticação do dispositivo precisa ter e a disponibilidade do armazenamento de segurança no dispositivo (para armazenar com segurança a chave privada).</span><span class="sxs-lookup"><span data-stu-id="c9bf4-118">The choice between the two methods is primarily dictated by how secure the device authentication needs to be, and availability of secure storage on the device (to store the private key securely).</span></span>

## <a name="iot-hub-security-tokens"></a><span data-ttu-id="c9bf4-119">Tokens de segurança do Hub IoT</span><span class="sxs-lookup"><span data-stu-id="c9bf4-119">IoT Hub security tokens</span></span>
<span data-ttu-id="c9bf4-120">O Hub IoT usa tokens de segurança para autenticar dispositivos e serviços a fim de evitar o envio de chaves na rede.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-120">IoT Hub uses security tokens to authenticate devices and services to avoid sending keys on the network.</span></span> <span data-ttu-id="c9bf4-121">Além disso, os tokens de segurança têm limite de escopo e de prazo de validade.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-121">Additionally, security tokens are limited in time validity and scope.</span></span> <span data-ttu-id="c9bf4-122">Os SDKs do IoT do Azure geram automaticamente tokens sem precisar de configuração especial.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-122">Azure IoT SDKs automatically generate tokens without requiring any special configuration.</span></span> <span data-ttu-id="c9bf4-123">No entanto, alguns cenários exigem que o usuário gere e use tokens de segurança diretamente.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-123">Some scenarios, however, require the user to generate and use security tokens directly.</span></span> <span data-ttu-id="c9bf4-124">Entre esses cenários estão o uso direto de superfícies MQTT, AMQP ou HTTP, ou a implementação do padrão de serviço de token.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-124">These include the direct use of the MQTT, AMQP, or HTTP surfaces, or the implementation of the token service pattern.</span></span>

<span data-ttu-id="c9bf4-125">Mais detalhes sobre a estrutura do token de segurança e seu uso podem ser encontradas nos seguintes artigos:</span><span class="sxs-lookup"><span data-stu-id="c9bf4-125">More details on the structure of the security token and its usage can be found in the following articles:</span></span>

* <span data-ttu-id="c9bf4-126">[Estrutura do token de segurança][lnk-security-tokens]</span><span class="sxs-lookup"><span data-stu-id="c9bf4-126">[Security token structure][lnk-security-tokens]</span></span>
* <span data-ttu-id="c9bf4-127">[Como usar tokens SAS como um dispositivo][lnk-sas-tokens]</span><span class="sxs-lookup"><span data-stu-id="c9bf4-127">[Using SAS tokens as a device][lnk-sas-tokens]</span></span>

<span data-ttu-id="c9bf4-128">Cada Hub IoT tem um [Registro de identidade][lnk-identity-registry] que você pode usar para criar recursos de acordo com o dispositivo no serviço, como uma fila contendo mensagens em andamento da nuvem para o dispositivo e para permitir acesso aos pontos de extremidade voltados para o dispositivo.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-128">Each IoT Hub has an [identity registry][lnk-identity-registry] that can be used to create per-device resources in the service, such as a queue that contains in-flight cloud-to-device messages, and to allow access to the device-facing endpoints.</span></span> <span data-ttu-id="c9bf4-129">O registro de identidade do Hub IoT fornece armazenamento seguro de identidades de dispositivo e chaves de segurança para uma solução.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-129">The IoT Hub identity registry provides secure storage of device identities and security keys for a solution.</span></span> <span data-ttu-id="c9bf4-130">As identidades de dispositivos individuais ou em grupo podem ser adicionadas a uma lista de permissões ou a uma lista de contatos bloqueados, permitindo o controle completo sobre o acesso ao dispositivo.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-130">Individual or groups of device identities can be added to an allow list, or a block list, enabling complete control over device access.</span></span> <span data-ttu-id="c9bf4-131">Os artigos a seguir fornecem mais detalhes sobre a estrutura do Registro de identidade e operações com suporte.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-131">The following articles provide more details on the structure of the identity registry and supported operations.</span></span>

<span data-ttu-id="c9bf4-132">[O Hub IoT dá suporte a protocolos como HTTP, AMQP e MQTT][lnk-protocols].</span><span class="sxs-lookup"><span data-stu-id="c9bf4-132">[IoT Hub supports protocols such as MQTT, AMQP, and HTTP][lnk-protocols].</span></span> <span data-ttu-id="c9bf4-133">Cada um desses protocolos usa tokens de segurança do dispositivo para o Hub IoT de maneiras diferentes:</span><span class="sxs-lookup"><span data-stu-id="c9bf4-133">Each of these protocols use security tokens from the IoT device to IoT Hub differently:</span></span>

* <span data-ttu-id="c9bf4-134">AMQP: segurança baseada em declarações SASL PLAIN e AMQP ({policyName}@sas.root.{iothubName} no caso de tokens no nível do Hub IoT; {deviceId} no caso de tokens no escopo do dispositivo).</span><span class="sxs-lookup"><span data-stu-id="c9bf4-134">AMQP: SASL PLAIN and AMQP Claims-based security ({policyName}@sas.root.{iothubName} in the case of IoT hub-level tokens; {deviceId} in case of device-scoped tokens).</span></span>
* <span data-ttu-id="c9bf4-135">MQTT: o pacote CONNECT usa {deviceId} como {ClientId}, {IoThubhostname}/{deviceId} no campo **Nome de usuário** e um token SAS no campo **Senha**.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-135">MQTT: CONNECT packet uses {deviceId} as the {ClientId}, {IoThubhostname}/{deviceId} in the **Username** field and a SAS token in the **Password** field.</span></span>
* <span data-ttu-id="c9bf4-136">HTTP: o token válido está no cabeçalho da solicitação de autorização.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-136">HTTP: Valid token is in the authorization request header.</span></span>

<span data-ttu-id="c9bf4-137">O Registro de identidade do Hub IoT pode ser usado para configurar credenciais de segurança e controle de acesso por dispositivo.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-137">IoT Hub identity registry can be used to configure per-device security credentials and access control.</span></span> <span data-ttu-id="c9bf4-138">No entanto, se uma solução IoT já tiver um investimento considerável em um [Registro de identidade de dispositivo personalizado e/ou em um esquema de autenticação][lnk-custom-auth], ela poderá ser integrada a uma infraestrutura existente com o Hub IoT por meio da criação de um serviço de token.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-138">However, if an IoT solution already has a significant investment in a [custom device identity registry and/or authentication scheme][lnk-custom-auth], it can be integrated into an existing infrastructure with IoT Hub by creating a token service.</span></span>

### <a name="x509-certificate-based-device-authentication"></a><span data-ttu-id="c9bf4-139">Autenticação de dispositivo com base no certificado x.509</span><span class="sxs-lookup"><span data-stu-id="c9bf4-139">X.509 certificate-based device authentication</span></span>
<span data-ttu-id="c9bf4-140">O uso de um [certificado X.509 baseado em dispositivo][lnk-use-x509] e seu par de chaves públicas e privadas associadas permite autenticação adicional na camada física.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-140">The use of a [device-based X.509 certificate][lnk-use-x509] and its associated private and public key pair allows additional authentication at the physical layer.</span></span> <span data-ttu-id="c9bf4-141">A chave privada é armazenada com segurança no dispositivo e não é localizável fora do dispositivo.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-141">The private key is stored securely in the device and is not discoverable outside the device.</span></span> <span data-ttu-id="c9bf4-142">O certificado x.509 contém informações sobre o dispositivo, como ID do dispositivo e outros detalhes organizacionais.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-142">The X.509 certificate contains information about the device, such as device ID, and other organizational details.</span></span> <span data-ttu-id="c9bf4-143">Uma assinatura do certificado é gerada usando a chave privada.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-143">A signature of the certificate is generated by using the private key.</span></span>

<span data-ttu-id="c9bf4-144">Fluxo de provisionamento do dispositivo de alto nível:</span><span class="sxs-lookup"><span data-stu-id="c9bf4-144">High-level device provisioning flow:</span></span>

* <span data-ttu-id="c9bf4-145">Associe um identificador a um dispositivo físico – identidade do dispositivo e/ou certificado x.509 associado ao dispositivo durante fabricação ou preparação de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-145">Associate an identifier to a physical device – device identity and/or X.509 certificate associated to the device during device manufacturing or commissioning.</span></span>
* <span data-ttu-id="c9bf4-146">Crie uma entrada de identidade correspondente no Hub IoT – informações de dispositivo associado e identidade do dispositivo no Registro de identidade do Hub IoT.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-146">Create a corresponding identity entry in IoT Hub – device identity and associated device information in the IoT Hub identity registry.</span></span>
* <span data-ttu-id="c9bf4-147">Armazene com segurança a impressão digital do certificado x.509 no Registro de identidade do Hub IoT.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-147">Securely store X.509 certificate thumbprint in IoT Hub identity registry.</span></span>

### <a name="root-certificate-on-device"></a><span data-ttu-id="c9bf4-148">Certificado raiz no dispositivo</span><span class="sxs-lookup"><span data-stu-id="c9bf4-148">Root certificate on device</span></span>
<span data-ttu-id="c9bf4-149">Ao estabelecer uma conexão TLS segura com o IoT Hub, o dispositivo IoT autentica o Hub IoT usando um certificado raiz que é parte do SDK do dispositivo.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-149">While establishing a secure TLS connection with IoT Hub, the IoT device authenticates IoT Hub using a root certificate which is part of the device SDK.</span></span> <span data-ttu-id="c9bf4-150">Para o SDK do cliente C, o certificado está localizado na pasta "\\c\\certs" sob a raiz do repositório.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-150">For the C client SDK the certificate is located under the folder "\\c\\certs" under the root of the repo.</span></span> <span data-ttu-id="c9bf4-151">Embora esses certificados raiz são de vida longa, eles ainda podem expirar ou ser revogados.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-151">Though these root certificates are long-lived, they still may expire or be revoked.</span></span> <span data-ttu-id="c9bf4-152">Se não houver nenhuma maneira de atualizar o certificado no dispositivo, o dispositivo poderá não se conectar subsequentemente ao Hub IoT (ou a qualquer outro serviço de nuvem).</span><span class="sxs-lookup"><span data-stu-id="c9bf4-152">If there is no way of updating the certificate on the device, the device may not be able to subsequently connect to the IoT Hub (or any other cloud service).</span></span> <span data-ttu-id="c9bf4-153">Ter um meio para atualizar o certificado raiz quando o dispositivo IoT é implantado reduzirá efetivamente o risco.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-153">Having a means to update the root certificate once the IoT device is deployed will effectively mitigate this risk.</span></span>

## <a name="securing-the-connection"></a><span data-ttu-id="c9bf4-154">Protegendo a conexão</span><span class="sxs-lookup"><span data-stu-id="c9bf4-154">Securing the connection</span></span>
<span data-ttu-id="c9bf4-155">A conexão com a Internet entre o dispositivo IoT e o Hub IoT é protegida usando o padrão de TLS (protocolo TLS).</span><span class="sxs-lookup"><span data-stu-id="c9bf4-155">Internet connection between the IoT device and IoT Hub is secured using the Transport Layer Security (TLS) standard.</span></span> <span data-ttu-id="c9bf4-156">O Azure IoT dá suporte a [TLS 1.2][lnk-tls12], TLS 1.1 e TLS 1.0, nessa ordem.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-156">Azure IoT supports [TLS 1.2][lnk-tls12], TLS 1.1 and TLS 1.0, in this order.</span></span> <span data-ttu-id="c9bf4-157">O suporte para TLS 1.0 é fornecido somente para fins de compatibilidade com versões anteriores.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-157">Support for TLS 1.0 is provided for backward compatibility only.</span></span> <span data-ttu-id="c9bf4-158">É recomendável usar TLS 1.2, pois ele fornece segurança máxima.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-158">It is recommended to use TLS 1.2 since it provides the most security.</span></span>

<span data-ttu-id="c9bf4-159">O Azure IoT Suite dá suporte ao seguintes Pacotes de Criptografia, nessa ordem.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-159">Azure IoT Suite supports the following Cipher Suites, in this order.</span></span>

| <span data-ttu-id="c9bf4-160">Pacote de criptografia</span><span class="sxs-lookup"><span data-stu-id="c9bf4-160">Cipher Suite</span></span> | <span data-ttu-id="c9bf4-161">Comprimento</span><span class="sxs-lookup"><span data-stu-id="c9bf4-161">Length</span></span> |
| --- | --- |
| <span data-ttu-id="c9bf4-162">TLS\_ECDHE\_RSA\_WITH\_AES\_256\_CBC\_SHA384 (0xc028) ECDH secp384r1 (eq.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-162">TLS\_ECDHE\_RSA\_WITH\_AES\_256\_CBC\_SHA384 (0xc028) ECDH secp384r1 (eq.</span></span> <span data-ttu-id="c9bf4-163">RSA de 7680 bits) FS</span><span class="sxs-lookup"><span data-stu-id="c9bf4-163">7680 bits RSA) FS</span></span> |<span data-ttu-id="c9bf4-164">256</span><span class="sxs-lookup"><span data-stu-id="c9bf4-164">256</span></span> |
| <span data-ttu-id="c9bf4-165">TLS\_ECDHE\_RSA\_WITH\_AES\_128\_CBC\_SHA256 (0xc027) ECDH secp256r1 (eq.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-165">TLS\_ECDHE\_RSA\_WITH\_AES\_128\_CBC\_SHA256 (0xc027) ECDH secp256r1 (eq.</span></span> <span data-ttu-id="c9bf4-166">RSA de 3072 bits) FS</span><span class="sxs-lookup"><span data-stu-id="c9bf4-166">3072 bits RSA) FS</span></span> |<span data-ttu-id="c9bf4-167">128</span><span class="sxs-lookup"><span data-stu-id="c9bf4-167">128</span></span> |
| <span data-ttu-id="c9bf4-168">TLS\_ECDHE\_RSA\_WITH\_AES\_256\_CBC\_SHA (0xc014) ECDH secp384r1 (eq.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-168">TLS\_ECDHE\_RSA\_WITH\_AES\_256\_CBC\_SHA (0xc014) ECDH secp384r1 (eq.</span></span> <span data-ttu-id="c9bf4-169">RSA de 7680 bits) FS</span><span class="sxs-lookup"><span data-stu-id="c9bf4-169">7680 bits RSA) FS</span></span> |<span data-ttu-id="c9bf4-170">256</span><span class="sxs-lookup"><span data-stu-id="c9bf4-170">256</span></span> |
| <span data-ttu-id="c9bf4-171">TLS\_ECDHE\_RSA\_WITH\_AES\_128\_CBC\_SHA (0xc013) ECDH secp256r1 (eq.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-171">TLS\_ECDHE\_RSA\_WITH\_AES\_128\_CBC\_SHA (0xc013) ECDH secp256r1 (eq.</span></span> <span data-ttu-id="c9bf4-172">RSA de 3072 bits) FS</span><span class="sxs-lookup"><span data-stu-id="c9bf4-172">3072 bits RSA) FS</span></span> |<span data-ttu-id="c9bf4-173">128</span><span class="sxs-lookup"><span data-stu-id="c9bf4-173">128</span></span> |
| <span data-ttu-id="c9bf4-174">TLS\_RSA\_WITH\_AES\_256\_GCM\_SHA384 (0x9d)</span><span class="sxs-lookup"><span data-stu-id="c9bf4-174">TLS\_RSA\_WITH\_AES\_256\_GCM\_SHA384 (0x9d)</span></span> |<span data-ttu-id="c9bf4-175">256</span><span class="sxs-lookup"><span data-stu-id="c9bf4-175">256</span></span> |
| <span data-ttu-id="c9bf4-176">TLS\_RSA\_WITH\_AES\_128\_GCM\_SHA256 (0x9c)</span><span class="sxs-lookup"><span data-stu-id="c9bf4-176">TLS\_RSA\_WITH\_AES\_128\_GCM\_SHA256 (0x9c)</span></span> |<span data-ttu-id="c9bf4-177">128</span><span class="sxs-lookup"><span data-stu-id="c9bf4-177">128</span></span> |
| <span data-ttu-id="c9bf4-178">TLS\_RSA\_WITH\_AES\_256\_CBC\_SHA256 (0x3d)</span><span class="sxs-lookup"><span data-stu-id="c9bf4-178">TLS\_RSA\_WITH\_AES\_256\_CBC\_SHA256 (0x3d)</span></span> |<span data-ttu-id="c9bf4-179">256</span><span class="sxs-lookup"><span data-stu-id="c9bf4-179">256</span></span> |
| <span data-ttu-id="c9bf4-180">TLS\_RSA\_WITH\_AES\_128\_CBC\_SHA256 (0x3c)</span><span class="sxs-lookup"><span data-stu-id="c9bf4-180">TLS\_RSA\_WITH\_AES\_128\_CBC\_SHA256 (0x3c)</span></span> |<span data-ttu-id="c9bf4-181">128</span><span class="sxs-lookup"><span data-stu-id="c9bf4-181">128</span></span> |
| <span data-ttu-id="c9bf4-182">TLS\_RSA\_WITH\_AES\_256\_CBC\_SHA (0x35)</span><span class="sxs-lookup"><span data-stu-id="c9bf4-182">TLS\_RSA\_WITH\_AES\_256\_CBC\_SHA (0x35)</span></span> |<span data-ttu-id="c9bf4-183">256</span><span class="sxs-lookup"><span data-stu-id="c9bf4-183">256</span></span> |
| <span data-ttu-id="c9bf4-184">TLS\_RSA\_WITH\_AES\_128\_CBC\_SHA (0x2f)</span><span class="sxs-lookup"><span data-stu-id="c9bf4-184">TLS\_RSA\_WITH\_AES\_128\_CBC\_SHA (0x2f)</span></span> |<span data-ttu-id="c9bf4-185">128</span><span class="sxs-lookup"><span data-stu-id="c9bf4-185">128</span></span> |
| <span data-ttu-id="c9bf4-186">TLS\_RSA\_WITH\_3DES\_EDE\_CBC\_SHA (0xa)</span><span class="sxs-lookup"><span data-stu-id="c9bf4-186">TLS\_RSA\_WITH\_3DES\_EDE\_CBC\_SHA (0xa)</span></span> |<span data-ttu-id="c9bf4-187">112</span><span class="sxs-lookup"><span data-stu-id="c9bf4-187">112</span></span> |

## <a name="securing-the-cloud"></a><span data-ttu-id="c9bf4-188">Proteger a nuvem</span><span class="sxs-lookup"><span data-stu-id="c9bf4-188">Securing the cloud</span></span>
<span data-ttu-id="c9bf4-189">O Hub IoT do Azure permite a definição de [políticas de controle de acesso][lnk-protocols] para cada chave de segurança.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-189">Azure IoT Hub allows definition of [access control policies][lnk-protocols] for each security key.</span></span> <span data-ttu-id="c9bf4-190">Ele usa o conjunto de permissões a seguir para conceder acesso aos pontos de extremidades de cada Hub IoT.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-190">It uses the following set of permissions to grant access to each of IoT Hub's endpoints.</span></span> <span data-ttu-id="c9bf4-191">As permissões limitam o acesso a um Hub IoT com base na funcionalidade.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-191">Permissions limit the access to an IoT Hub based on functionality.</span></span>

* <span data-ttu-id="c9bf4-192">**RegistryRead**.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-192">**RegistryRead**.</span></span> <span data-ttu-id="c9bf4-193">Concede acesso de leitura ao Registro de identidade.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-193">Grants read access to the identity registry.</span></span> <span data-ttu-id="c9bf4-194">Para saber mais, consulte [Registro de identidade][lnk-identity-registry].</span><span class="sxs-lookup"><span data-stu-id="c9bf4-194">For more information, see [identity registry][lnk-identity-registry].</span></span>
* <span data-ttu-id="c9bf4-195">**RegistryReadWrite**.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-195">**RegistryReadWrite**.</span></span> <span data-ttu-id="c9bf4-196">Concede acesso de leitura e gravação ao Registro de identidade.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-196">Grants read and write access to the identity registry.</span></span> <span data-ttu-id="c9bf4-197">Para saber mais, consulte [Registro de identidade][lnk-identity-registry].</span><span class="sxs-lookup"><span data-stu-id="c9bf4-197">For more information, see [identity registry][lnk-identity-registry].</span></span>
* <span data-ttu-id="c9bf4-198">**ServiceConnect**.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-198">**ServiceConnect**.</span></span> <span data-ttu-id="c9bf4-199">Concede acesso aos pontos de extremidade de comunicação e de monitoramento voltados para o serviço de nuvem.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-199">Grants access to cloud service-facing communication and monitoring endpoints.</span></span> <span data-ttu-id="c9bf4-200">Por exemplo, ela concede permissão para que os serviços de nuvem de back-end recebam mensagens do dispositivo para a nuvem, enviem mensagens da nuvem para o dispositivo e obtenham as confirmações de entrega correspondentes.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-200">For example, it grants permission to back-end cloud services to receive device-to-cloud messages, send cloud-to-device messages, and retrieve the corresponding delivery acknowledgments.</span></span>
* <span data-ttu-id="c9bf4-201">**DeviceConnect**.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-201">**DeviceConnect**.</span></span> <span data-ttu-id="c9bf4-202">Concede acesso aos pontos de extremidade de comunicação voltados para o dispositivo.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-202">Grants access to device-facing endpoints.</span></span> <span data-ttu-id="c9bf4-203">Por exemplo, ela concede permissão de envio de mensagens do dispositivo para a nuvem e de recebimento de mensagens da nuvem para o dispositivo.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-203">For example, it grants permission to send device-to-cloud messages and receive cloud-to-device messages.</span></span> <span data-ttu-id="c9bf4-204">Essa permissão é usada por dispositivos.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-204">This permission is used by devices.</span></span>

<span data-ttu-id="c9bf4-205">Há duas maneiras de obter as permissões **DeviceConnect** com o Hub IoT com [tokens de segurança][lnk-sas-tokens]: usando uma chave de identidade do dispositivo ou uma tecla de acesso compartilhada.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-205">There are two ways to obtain **DeviceConnect** permissions with IoT Hub with [security tokens][lnk-sas-tokens]: using a device identity key, or a shared access key.</span></span> <span data-ttu-id="c9bf4-206">Além disso, é importante observar que qualquer funcionalidade acessível por meio de dispositivos fica exposta por padrão em pontos de extremidade com o prefixo `/devices/{deviceId}`.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-206">Moreover, it is important to note that all functionality accessible from devices is exposed by design on endpoints with prefix `/devices/{deviceId}`.</span></span>

<span data-ttu-id="c9bf4-207">[Os componentes de serviço só podem gerar tokens de segurança][lnk-service-tokens] usando políticas de acesso compartilhado que concedem as permissões apropriadas.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-207">[Service components can only generate security tokens][lnk-service-tokens] using shared access policies granting the appropriate permissions.</span></span>

<span data-ttu-id="c9bf4-208">O Hub IoT do Azure e outros serviços que podem ser parte da solução permitem o gerenciamento de usuários usando o Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-208">Azure IoT Hub and other services which may be part of the solution allow management of users using the Azure Active Directory.</span></span>

<span data-ttu-id="c9bf4-209">Dados ingeridos pelo Hub IoT do Azure podem ser consumidos por diversos serviços, como Stream Analytics do Azure e armazenamento de blobs do Azure.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-209">Data ingested by Azure IoT Hub can be consumed by a variety of services such as Azure Stream Analytics and Azure blob storage.</span></span> <span data-ttu-id="c9bf4-210">Esses serviços permitem o acesso de gerenciamento.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-210">These services allow management access.</span></span> <span data-ttu-id="c9bf4-211">Leia mais sobre esses serviços e opções disponíveis abaixo:</span><span class="sxs-lookup"><span data-stu-id="c9bf4-211">Read more about these services and available options below:</span></span>

* <span data-ttu-id="c9bf4-212">[Azure DocumentDB][lnk-docdb]: um serviço de banco de dados escalonável e totalmente indexado para dados semiestruturados, que gerenciam os metadados para os dispositivos que você provisiona, como atributos, configuração e propriedades de segurança.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-212">[Azure DocumentDB][lnk-docdb]: A scalable, fully-indexed database service for semi-structured data that manages metadata for the devices you provision, such as attributes, configuration, and security properties.</span></span> <span data-ttu-id="c9bf4-213">O Banco de Dados de Documentos oferece processamento de alto desempenho e alta taxa de transferência, indexação independente do esquema de dados e uma interface de consulta SQL avançada.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-213">DocumentDB offers high-performance and high-throughput processing, schema-agnostic indexing of data, and a rich SQL query interface.</span></span>
* <span data-ttu-id="c9bf4-214">[Stream Analytics do Azure][lnk-asa]: processamento de transmissão em tempo real na nuvem, que permite que você desenvolva e implante com rapidez uma solução de análise econômica a fim de descobrir insights em tempo real de dispositivos, sensores, infraestrutura e aplicativos.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-214">[Azure Stream Analytics][lnk-asa]: Real-time stream processing in the cloud that enables you to rapidly develop and deploy a low-cost analytics solution to uncover real-time insights from devices, sensors, infrastructure, and applications.</span></span> <span data-ttu-id="c9bf4-215">Os dados desse serviço totalmente gerenciado podem ser dimensionados para qualquer volume enquanto ainda atingem alta taxa de transferência, baixa latência e resiliência.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-215">The data from this fully-managed service can scale to any volume while still achieving high throughput, low latency, and resiliency.</span></span>
* <span data-ttu-id="c9bf4-216">[Serviços de Aplicativos do Azure][lnk-appservices]: uma plataforma de nuvem para compilar aplicativos Web e móveis avançados que se conectam aos dados em qualquer lugar, na nuvem ou local.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-216">[Azure App Services][lnk-appservices]: A cloud platform to build powerful web and mobile apps that connect to data anywhere; in the cloud or on-premises.</span></span> <span data-ttu-id="c9bf4-217">Compile aplicativos móveis atraentes para iOS, Android e Windows.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-217">Build engaging mobile apps for iOS, Android, and Windows.</span></span> <span data-ttu-id="c9bf4-218">Integre-se com seu SaaS (software como serviço) e com aplicativos empresariais com conectividade integrada para dezenas de serviços baseados em nuvem e aplicativos empresariais.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-218">Integrate with your Software as a Service (SaaS) and enterprise applications with out-of-the-box connectivity to dozens of cloud-based services and enterprise applications.</span></span> <span data-ttu-id="c9bf4-219">Codifique na sua linguagem e IDE favoritos (.NET, Node.js, PHP, Python ou Java) para compilar aplicativos Web e APIs com mais rapidez do que nunca.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-219">Code in your favorite language and IDE (.NET, Node.js, PHP, Python, or Java) to build web apps and APIs faster than ever.</span></span>
* <span data-ttu-id="c9bf4-220">[Aplicativos lógicos][lnk-logicapps]: o recurso Aplicativos Lógicos do Serviço de Aplicativo do Azure ajuda a integrar sua solução de IoT para sua linha de sistemas de negócios existentes e a automatizar processos de fluxo de trabalho.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-220">[Logic Apps][lnk-logicapps]: The Logic Apps feature of Azure App Service helps integrate your IoT solution to your existing line-of-business systems and automate workflow processes.</span></span> <span data-ttu-id="c9bf4-221">Os Aplicativos Lógicos permitem que os desenvolvedores projetem fluxos de trabalho iniciados de um gatilho e, em seguida, executem uma série de etapas — regras e ações que usam conectores poderosos para integrar seus processos de negócios.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-221">Logic Apps enables developers to design workflows that start from a trigger and then execute a series of steps—rules and actions that use powerful connectors to integrate with your business processes.</span></span> <span data-ttu-id="c9bf4-222">Os Aplicativos Lógicos oferecem conectividade pronta para uso para um vasto ecossistema de aplicativos de SaaS, baseados em nuvem e locais.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-222">Logic Apps offers out-of-the-box connectivity to a vast ecosystem of SaaS, cloud-based, and on-premises applications.</span></span>
* <span data-ttu-id="c9bf4-223">[Armazenamento de Blobs do Azure][lnk-blob]: armazenamento em nuvem confiável e econômico para os dados que os dispositivos enviam para a nuvem.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-223">[Azure blob storage][lnk-blob]: Reliable, economical cloud storage for the data that your devices send to the cloud.</span></span>

## <a name="conclusion"></a><span data-ttu-id="c9bf4-224">Conclusão</span><span class="sxs-lookup"><span data-stu-id="c9bf4-224">Conclusion</span></span>
<span data-ttu-id="c9bf4-225">Este artigo fornece uma visão geral dos detalhes de nível de implantação para projetar e implantar uma infraestrutura de IoT usando o Azure IoT.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-225">This article provides overview of implementation level details for designing and deploying an IoT infrastructure using Azure IoT.</span></span> <span data-ttu-id="c9bf4-226">Configurar cada componente para ser seguro é a chave na proteção da infraestrutura geral de IoT.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-226">Configuring each component to be secure is key in securing the overall IoT infrastructure.</span></span> <span data-ttu-id="c9bf4-227">As opções de design disponíveis no Azure IoT oferecem algum nível de flexibilidade e opções; no entanto, cada opção pode ter implicações de segurança.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-227">The design choices available in Azure IoT provide some level of flexibility and choice; however, each choice may have security implications.</span></span> <span data-ttu-id="c9bf4-228">É recomendável que cada uma dessas opções seja avaliada por meio de uma avaliação de risco e custo.</span><span class="sxs-lookup"><span data-stu-id="c9bf4-228">It is recommended that each of these choices be evaluated through a risk/cost assessment.</span></span>

[img-overview]: media/iot-secure-your-deployment/overview.png

[lnk-security-tokens]: ../articles/iot-hub/iot-hub-devguide-security.md#security-token-structure
[lnk-sas-tokens]: ../articles/iot-hub/iot-hub-devguide-security.md#use-sas-tokens-in-a-device-app
[lnk-identity-registry]: ../articles/iot-hub/iot-hub-devguide-identity-registry.md
[lnk-protocols]: ../articles/iot-hub/iot-hub-devguide-security.md
[lnk-custom-auth]: ../articles/iot-hub/iot-hub-devguide-security.md#custom-device-authentication
[lnk-x509]: http://www.itu.int/rec/T-REC-X.509-201210-I/en
[lnk-use-x509]: ../articles/iot-hub/iot-hub-devguide-security.md
[lnk-tls12]: https://tools.ietf.org/html/rfc5246
[lnk-service-tokens]: ../articles/iot-hub/iot-hub-devguide-security.md#use-security-tokens-from-service-components
[lnk-docdb]: https://azure.microsoft.com/services/documentdb/
[lnk-asa]: https://azure.microsoft.com/services/stream-analytics/
[lnk-appservices]: https://azure.microsoft.com/services/app-service/
[lnk-logicapps]: https://azure.microsoft.com/services/app-service/logic/
[lnk-blob]: https://azure.microsoft.com/services/storage/
