<span data-ttu-id="c4c6a-101">O Azure realiza atualizações periodicamente para aumentar a confiabilidade, o desempenho e a segurança da infraestrutura de host para máquinas virtuais.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-101">Azure periodically performs updates to improve the reliability, performance, and security of the host infrastructure for virtual machines.</span></span> <span data-ttu-id="c4c6a-102">Essas atualizações vão desde a aplicação de patch de componentes de software no ambiente de hospedagem (como sistema operacional, hipervisor e vários agentes implantados no host), a atualização de componentes de rede até o encerramento de hardware.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-102">These updates range from patching software components in the hosting environment (like operating system, hypervisor, and various agents deployed on the host), upgrading networking components, to hardware decommissioning.</span></span> <span data-ttu-id="c4c6a-103">A maioria dessas atualizações é realizada sem nenhum impacto nas máquinas virtuais hospedadas.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-103">The majority of these updates are performed without any impact to the hosted virtual machines.</span></span> <span data-ttu-id="c4c6a-104">No entanto, há casos em que as atualizações possuem um impacto:</span><span class="sxs-lookup"><span data-stu-id="c4c6a-104">However, there are cases where updates do have an impact:</span></span>

- <span data-ttu-id="c4c6a-105">Se a manutenção não exigir uma reinicialização, o Azure usa migração in-loco para pausar a máquina virtual enquanto o host está atualizado.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-105">If the maintenance does not require a reboot, Azure uses in-place migration to pause the VM while the host is updated.</span></span>

- <span data-ttu-id="c4c6a-106">Se a manutenção requer uma reinicialização, você receberá um aviso informando para quando a manutenção está planejada.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-106">If maintenance requires a reboot, you get a notice of when the maintenance is planned.</span></span> <span data-ttu-id="c4c6a-107">Nesses casos, você também terá uma janela de tempo, onde você pode iniciar a manutenção, em um momento que mais oportuno para você.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-107">In these cases, you'll also be given a time window where you can start the maintenance yourself, at a time that works for you.</span></span>

<span data-ttu-id="c4c6a-108">Esta página descreve como o Microsoft Azure executa os dois tipos de manutenção.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-108">This page describes how Microsoft Azure performs both types of maintenance.</span></span> <span data-ttu-id="c4c6a-109">Para obter mais informações sobre eventos não planejados (interrupções), consulte Gerenciar a disponibilidade das máquinas virtuais para [Windows] (../articles/virtual-machines/windows/manage-availability.md) ou [Linux](../articles/virtual-machines/linux/manage-availability.md).</span><span class="sxs-lookup"><span data-stu-id="c4c6a-109">For more information about unplanned events (outages), see Manage the availability of virtual machines for [Windows] (../articles/virtual-machines/windows/manage-availability.md) or [Linux](../articles/virtual-machines/linux/manage-availability.md).</span></span>

<span data-ttu-id="c4c6a-110">Aplicativos em execução em uma máquina virtual podem coletar informações sobre atualizações futuras por meio do Serviço de Metadados do Azure para [Windows](../articles/virtual-machines/windows/instance-metadata-service.md) ou [Linux] (... / articles/virtual-machines/linux/instance-metadata-service.md).</span><span class="sxs-lookup"><span data-stu-id="c4c6a-110">Applications running in a virtual machine can gather information about upcoming updates by using the Azure Metadata Service for [Windows](../articles/virtual-machines/windows/instance-metadata-service.md) or [Linux] (../articles/virtual-machines/linux/instance-metadata-service.md).</span></span>

## <a name="in-place-vm-migration"></a><span data-ttu-id="c4c6a-111">Migração de VM local</span><span class="sxs-lookup"><span data-stu-id="c4c6a-111">In-place VM migration</span></span>

<span data-ttu-id="c4c6a-112">Quando as atualizações não exigem uma reinicialização completa, uma migração ao vivo local é usada.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-112">When updates don't require a full reboot, an in-place live migration is used.</span></span> <span data-ttu-id="c4c6a-113">Durante a atualização a máquina virtual será pausada por aproximadamente 30 segundos, preservando a memória RAM, enquanto o ambiente de hospedagem aplica os patches e as atualizações necessárias.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-113">During the update the virtual machine is paused for about 30 seconds, preserving the memory in RAM, while the hosting environment applies the necessary updates and patches.</span></span> <span data-ttu-id="c4c6a-114">A máquina virtual é reiniciada e o relógio da máquina virtual é sincronizado automaticamente.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-114">The virtual machine is then resumed and the clock of the virtual machine is automatically synchronized.</span></span>

<span data-ttu-id="c4c6a-115">Para VMs em conjuntos de disponibilidade, os domínios de atualização são atualizados um de cada vez.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-115">For VMs in availability sets, update domains are updated one at a time.</span></span> <span data-ttu-id="c4c6a-116">Todas as VMs em um domínio de atualização (UD) são pausadas, atualizadas e, em seguida, reiniciadas antes da manutenção planejada passar para o próximo UD.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-116">All VMs in one update domain (UD) are paused, updated and then resumed before planned maintenance moves on to the next UD.</span></span>

<span data-ttu-id="c4c6a-117">Alguns aplicativos podem ser afetados por esses tipos de atualizações.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-117">Some applications may be impacted by these types of updates.</span></span> <span data-ttu-id="c4c6a-118">Os aplicativos que executam processamento de eventos em tempo real, transmissão de mídia ou transcodificação, ou cenários de rede de alta produtividade, podem não ser projetados para tolerar uma pausa de 30 segundos.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-118">Applications that perform real-time event processing, like media streaming or transcoding, or high throughput networking scenarios, may not be designed to tolerate a 30 second pause.</span></span> <!-- sooooo, what should they do? --> 


## <a name="maintenance-requiring-a-reboot"></a><span data-ttu-id="c4c6a-119">Manutenção que exige uma reinicialização</span><span class="sxs-lookup"><span data-stu-id="c4c6a-119">Maintenance requiring a reboot</span></span>

<span data-ttu-id="c4c6a-120">Quando as VMs precisam ser reinicializadas para manutenção planejada, você será notificado com antecedência.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-120">When VMs need to be rebooted for planned maintenance, you are notified in advance.</span></span> <span data-ttu-id="c4c6a-121">A manutenção planejada tem duas fases: uma janela de autoatendimento e uma janela de manutenção agendada.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-121">Planned maintenance has two phases: the self-service window and a scheduled maintenance window.</span></span>

<span data-ttu-id="c4c6a-122">A **janela de autoatendimento** permite que você inicie a manutenção em suas VMs.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-122">The **self-service window** lets you initiate the maintenance on your VMs.</span></span> <span data-ttu-id="c4c6a-123">Durante esse tempo, você pode consultar cada VM para ver seu status e verificar o resultado de sua última solicitação de manutenção.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-123">During this time, you can query each VM to see their status and check the result of your last maintenance request.</span></span>

<span data-ttu-id="c4c6a-124">Quando você inicia a manutenção de autoatendimento, a VM é movida para um nó que já tenha sido atualizado e liga-o novamente.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-124">When you start self-service maintenance, your VM is moved to a node that has already been updated and then powers it back on.</span></span> <span data-ttu-id="c4c6a-125">Como a VM é reiniciada, o disco temporário é perdido e os endereços IP dinâmicos associados ao adaptador de rede virtual são atualizados.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-125">Because the VM reboots, the temporary disk is lost and dynamic IP addresses associated with virtual network interface are updated.</span></span>

<span data-ttu-id="c4c6a-126">Se você iniciar a manutenção de autoatendimento e ocorrer um erro durante o processo, a operação é interrompida, a VM não é atualizada e ela também é removida da iteração da manutenção planejada.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-126">If you start self-service maintenance and there is an error during the process, the operation is stopped, the VM is not updated and it is also removed from the planned maintenance iteration.</span></span> <span data-ttu-id="c4c6a-127">Você será contatado em um momento posterior com um novo agendamento e receberá uma nova oportunidade para realizar a manutenção de autoatendimento.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-127">You will be contacted in a later time with a new schedule and offered a new opportunity to do self-service maintenance.</span></span> 

<span data-ttu-id="c4c6a-128">Quando a janela de autoatendimento tiver passado, a **janela de manutenção agendada** começa.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-128">When the self-service window has passed, the **scheduled maintenance window** begins.</span></span> <span data-ttu-id="c4c6a-129">Durante essa janela de tempo você ainda pode consultar a janela de manutenção, mas não será mais possível iniciar a manutenção por conta própria.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-129">During this time window, you can still query for the maintenance window, but no longer be able to start the maintenance yourself.</span></span>

## <a name="availability-considerations-during-planned-maintenance"></a><span data-ttu-id="c4c6a-130">Considerações sobre disponibilidade durante a manutenção planejada</span><span class="sxs-lookup"><span data-stu-id="c4c6a-130">Availability Considerations during Planned Maintenance</span></span> 

<span data-ttu-id="c4c6a-131">Se você decidir aguardar até a janela de manutenção planejada, há algumas coisas a serem consideradas para manter a disponibilidade mais alta de suas VMs.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-131">If you decide to wait until the planned maintenance window, there are a few things to consider for maintaining the highest availabilty of your VMs.</span></span> 

### <a name="paired-regions"></a><span data-ttu-id="c4c6a-132">Regiões emparelhadas</span><span class="sxs-lookup"><span data-stu-id="c4c6a-132">Paired Regions</span></span>

<span data-ttu-id="c4c6a-133">Cada região do Azure é emparelhada com outra região na mesma área geográfica, formando juntas um par regional.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-133">Each Azure region is paired with another region within the same geography, together they make a regional pair.</span></span> <span data-ttu-id="c4c6a-134">Durante a manutenção planejada, o Azure atualizará somente as VMs em uma única região de um par de regiões.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-134">During planned maintenance, Azure will only update the VMs in a single region of a region pair.</span></span> <span data-ttu-id="c4c6a-135">Por exemplo, ao atualizar as Máquinas Virtuais no Centro-Norte dos EUA, o Azure não atualizará qualquer Máquina Virtual no Centro-Sul dos EUA ao mesmo tempo.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-135">For example, when updating the Virtual Machines in North Central US, Azure will not update any Virtual Machines in South Central US at the same time.</span></span> <span data-ttu-id="c4c6a-136">No entanto, outras regiões, como o Norte da Europa, podem estar em manutenção simultaneamente com Leste dos EUA.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-136">However, other regions such as North Europe can be under maintenance at the same time as East US.</span></span> <span data-ttu-id="c4c6a-137">Noções básicas sobre como funcionam os pares de região podem ajudá-lo a melhor distribuir suas VMs entre regiões.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-137">Understanding how region pairs work can help you better distribute your VMs across regions.</span></span> <span data-ttu-id="c4c6a-138">Para obter mais informações, consulte [pares de regiões do Azure](https://docs.microsoft.com/azure/best-practices-availability-paired-regions).</span><span class="sxs-lookup"><span data-stu-id="c4c6a-138">For more information, see [Azure region pairs](https://docs.microsoft.com/azure/best-practices-availability-paired-regions).</span></span>

### <a name="availability-sets-and-scale-sets"></a><span data-ttu-id="c4c6a-139">Conjuntos de disponibilidade e conjuntos de dimensionamento</span><span class="sxs-lookup"><span data-stu-id="c4c6a-139">Availability sets and scale sets</span></span>

<span data-ttu-id="c4c6a-140">Ao implantar uma carga de trabalho usando VMs do Azure, é possível criar as VMs em um conjunto de disponibilidade para fornecer alta disponibilidade para o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-140">When deploying a workload on Azure VMs, you can create the VMs within an availability set to provide high availability to your application.</span></span> <span data-ttu-id="c4c6a-141">Isso garante que, durante uma interrupção ou eventos de manutenção, pelo menos uma máquina virtual estará disponível.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-141">This ensures that during either an outage or maintenance events, at least one virtual machine is available.</span></span>

<span data-ttu-id="c4c6a-142">Em um conjunto de disponibilidade, VMs individuais são distribuídas em até 20 domínios de atualização (UDs).</span><span class="sxs-lookup"><span data-stu-id="c4c6a-142">Within an availability set, individual VMs are spread across up to 20 update domains (UDs).</span></span> <span data-ttu-id="c4c6a-143">Durante a manutenção planejada, somente um único domínio de atualização é afetado em um período específico.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-143">During planned maintenance, only a single update domain is impacted at any given time.</span></span> <span data-ttu-id="c4c6a-144">Lembre-se de que a ordem dos domínios de atualização que são afetados não necessariamente acontece de forma sequencial.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-144">Be aware that the order of update domains being impacted does not necessarily happen sequentially.</span></span> 

<span data-ttu-id="c4c6a-145">Os conjuntos de dimensionamento de máquinas virtuais são um recurso de computação do Azure que permite implantar e gerenciar um conjunto de VMs idênticas como um único recurso.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-145">Virtual machine scale sets are an Azure compute resource that enables you to deploy and manage a set of identical VMs as a single resource.</span></span> <span data-ttu-id="c4c6a-146">O conjunto de dimensionamento é implantado automaticamente nos domínios de atualização, como VMs em um conjunto de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-146">The scale set is automatically deployed across update domains, like VMs in an availability set.</span></span> <span data-ttu-id="c4c6a-147">Assim como com conjuntos de disponibilidade, com conjuntos de dimensionamento somente um domínio de atualização é afetado em um determinado momento.</span><span class="sxs-lookup"><span data-stu-id="c4c6a-147">Just like with availability sets, with scale sets only a single update domain is impacted at any given time.</span></span>

<span data-ttu-id="c4c6a-148">Para saber mais sobre como configurar as máquinas virtuais para alta disponibilidade, consulte Gerenciar a disponibilidade de máquinas virtuais para Windows (../articles/virtual-machines/windows/manage-availability.md) ou [Linux](../articles/virtual-machines/linux/manage-availability.md).</span><span class="sxs-lookup"><span data-stu-id="c4c6a-148">For more information about configuring your virtual machines for high availability, see Manage the availability of your virtual machines for Windows (../articles/virtual-machines/windows/manage-availability.md) or [Linux](../articles/virtual-machines/linux/manage-availability.md).</span></span>