<span data-ttu-id="197c6-101">A abordagem para pontos de extremidade do Azure funciona um pouco diferente entre os modelos de implantação Clássico e do Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="197c6-101">The approach to Azure endpoints works a little differently between the Classic and Resource Manager deployment models.</span></span> <span data-ttu-id="197c6-102">No modelo de implantação do Gerenciador de Recursos, agora você tem a flexibilidade de criar filtros de rede que controlam o fluxo de tráfego dentro e fora de suas VMs.</span><span class="sxs-lookup"><span data-stu-id="197c6-102">In the Resource Manager deployment model, you now have the flexibility to create network filters that control the flow of traffic in and out of your VMs.</span></span> <span data-ttu-id="197c6-103">Esses filtros permitem que você crie ambientes de rede complexos, além de um ponto de extremidade simples como o modelo de implantação Clássico.</span><span class="sxs-lookup"><span data-stu-id="197c6-103">These filters allow you to create complex networking environments beyond a simple endpoint as in the Classic deployment model.</span></span> <span data-ttu-id="197c6-104">Este artigo fornece uma visão geral dos Grupos de Segurança de Rede e como eles são diferentes da utilização de pontos de extremidade Clássicos, criando regras de filtragem e exemplos de cenários de implantação.</span><span class="sxs-lookup"><span data-stu-id="197c6-104">This article provides an overview of Network Security Groups and how they differ from using Classic endpoints, creating these filtering rules, and sample deployment scenarios.</span></span>

## <a name="overview-of-resource-manager-deployments"></a><span data-ttu-id="197c6-105">Visão geral das implantações do Resource Manager</span><span class="sxs-lookup"><span data-stu-id="197c6-105">Overview of Resource Manager deployments</span></span>
<span data-ttu-id="197c6-106">Os pontos de extremidade no modelo de implantação Clássico são substituídos por Grupos de Segurança de Rede e regras de ACL (lista de controle de acesso).</span><span class="sxs-lookup"><span data-stu-id="197c6-106">Endpoints in the Classic deployment model are replaced by Network Security Groups and access control list (ACL) rules.</span></span> <span data-ttu-id="197c6-107">As etapas rápidas para implementação de regras de ACL de Grupo de Segurança de Rede são:</span><span class="sxs-lookup"><span data-stu-id="197c6-107">Quick steps for implementing Network Security Group ACL rules are:</span></span>

* <span data-ttu-id="197c6-108">Criará um Grupo de Segurança de Rede.</span><span class="sxs-lookup"><span data-stu-id="197c6-108">Create a Network Security Group.</span></span>
* <span data-ttu-id="197c6-109">Para permitir ou negar o tráfego, defina suas regras de ACL de Grupo de Segurança de Rede.</span><span class="sxs-lookup"><span data-stu-id="197c6-109">To allow or deny traffic, define your Network Security Group ACL rules.</span></span>
* <span data-ttu-id="197c6-110">Atribuir o Grupo de Segurança de Rede a uma interface de rede ou sub-rede da rede virtual.</span><span class="sxs-lookup"><span data-stu-id="197c6-110">Assign your Network Security Group to a network interface or virtual network subnet.</span></span>

<span data-ttu-id="197c6-111">Se você também quiser executar o encaminhamento de porta, será necessário colocar um balanceador de carga na frente de sua VM e usar regras de NAT.</span><span class="sxs-lookup"><span data-stu-id="197c6-111">If you are wanting to also perform port-forwarding, you need to place a load balancer in front of your VM and use NAT rules.</span></span> <span data-ttu-id="197c6-112">As etapas rápidas para implementar regras de NAT e um balanceador de carga seriam as seguintes:</span><span class="sxs-lookup"><span data-stu-id="197c6-112">Quick steps for implementing a load balancer and NAT rules would be as follows:</span></span>

* <span data-ttu-id="197c6-113">Criar um balanceador de carga.</span><span class="sxs-lookup"><span data-stu-id="197c6-113">Create a load balancer.</span></span>
* <span data-ttu-id="197c6-114">Criar um pool de back-end e adicionar suas VMs ao pool.</span><span class="sxs-lookup"><span data-stu-id="197c6-114">Create a backend pool and add your VMs to the pool.</span></span>
* <span data-ttu-id="197c6-115">Definir regras de NAT para o encaminhamento de porta necessário.</span><span class="sxs-lookup"><span data-stu-id="197c6-115">Define your NAT rules for the required port forwarding.</span></span>
* <span data-ttu-id="197c6-116">Atribuir as regras NAT às suas VMs.</span><span class="sxs-lookup"><span data-stu-id="197c6-116">Assign your NAT rules to your VMs.</span></span>

## <a name="network-security-group-overview"></a><span data-ttu-id="197c6-117">Visão geral do Grupo de Segurança de Rede</span><span class="sxs-lookup"><span data-stu-id="197c6-117">Network Security Group overview</span></span>
<span data-ttu-id="197c6-118">Grupos de Segurança de Rede fornecem uma camada de segurança para habilitar portas específicas e sub-redes a acessarem suas VMs.</span><span class="sxs-lookup"><span data-stu-id="197c6-118">Network Security Groups provide a layer of security for you to allow specific ports and subnets to access your VMs.</span></span> <span data-ttu-id="197c6-119">Normalmente, sempre há um Grupo de Segurança de Rede fornecendo essa camada de segurança entre suas VMs e o mundo externo.</span><span class="sxs-lookup"><span data-stu-id="197c6-119">You typically always have a Network Security Group providing this layer of security between your VMs and the outside world.</span></span> <span data-ttu-id="197c6-120">O Grupos de Segurança de Rede podem ser aplicados a uma sub-rede de rede virtual ou interface de rede específica para uma VM.</span><span class="sxs-lookup"><span data-stu-id="197c6-120">Network Security Groups can be applied to a virtual network subnet or a specific network interface for a VM.</span></span> <span data-ttu-id="197c6-121">Em vez de criar regras de ACL do ponto de extremidade, agora é possível criar regras de ACL de Grupo de Segurança de Rede.</span><span class="sxs-lookup"><span data-stu-id="197c6-121">Rather than creating endpoint ACL rules, you now create Network Security Group ACL rules.</span></span> <span data-ttu-id="197c6-122">Essas regras de ACL fornecem um controle muito maior do que simplesmente criar um ponto de extremidade para encaminhar uma determinada porta.</span><span class="sxs-lookup"><span data-stu-id="197c6-122">These ACL rules provide much greater control than simply creating an endpoint to forward a given port.</span></span> <span data-ttu-id="197c6-123">Para obter mais informações, confira [O que é um Grupo de Segurança de Rede?](../articles/virtual-network/virtual-networks-nsg.md)</span><span class="sxs-lookup"><span data-stu-id="197c6-123">For more information, see [What is a Network Security Group?](../articles/virtual-network/virtual-networks-nsg.md)</span></span>

> [!TIP]
> <span data-ttu-id="197c6-124">É possível atribuir Grupos de Segurança de Rede a várias sub-redes ou interfaces de rede.</span><span class="sxs-lookup"><span data-stu-id="197c6-124">You can assign Network Security Groups to multiple subnets or network interfaces.</span></span> <span data-ttu-id="197c6-125">Não há mapeamento 1:1.</span><span class="sxs-lookup"><span data-stu-id="197c6-125">There is no 1:1 mapping.</span></span> <span data-ttu-id="197c6-126">Você pode criar um Grupo de Segurança de Rede com um conjunto comum de regras de ACL e aplicá-lo a várias sub-redes ou interfaces de rede.</span><span class="sxs-lookup"><span data-stu-id="197c6-126">You can create a Network Security Group with a common set of ACL rules and apply to multiple subnets or network interfaces.</span></span> <span data-ttu-id="197c6-127">Além disso, o Grupo de Segurança de Rede pode ser aplicado a recursos em sua assinatura (com base em [Controles de Acesso Baseados em Função](../articles/active-directory/role-based-access-control-what-is.md).</span><span class="sxs-lookup"><span data-stu-id="197c6-127">Further, Network Security Group can be applied to resources across your subscription (based on [Role Based Access Controls](../articles/active-directory/role-based-access-control-what-is.md).</span></span>

## <a name="load-balancers-overview"></a><span data-ttu-id="197c6-128">Visão geral do balanceador de carga</span><span class="sxs-lookup"><span data-stu-id="197c6-128">Load Balancers overview</span></span>
<span data-ttu-id="197c6-129">No modelo de implantação Clássico, o Azure executa para você toda NAT (Conversão de endereço de rede) e encaminhamento de porta em um Serviço de Nuvem.</span><span class="sxs-lookup"><span data-stu-id="197c6-129">In the Classic deployment model, Azure would perform all the Network Address Translation (NAT) and port forwarding on a Cloud Service for you.</span></span> <span data-ttu-id="197c6-130">Ao criar um ponto de extremidade, você especificaria a porta externa a ser exposta, juntamente com a porta interna para a qual direcionar o tráfego.</span><span class="sxs-lookup"><span data-stu-id="197c6-130">When creating an endpoint, you would specify the external port to expose along with the internal port to direct traffic to.</span></span> <span data-ttu-id="197c6-131">Os Grupos de Segurança de Rede por si só não executam essa mesma NAT e o encaminhamento de porta.</span><span class="sxs-lookup"><span data-stu-id="197c6-131">Network Security Groups by themselves do not perform this same NAT and port forwarding.</span></span> 

<span data-ttu-id="197c6-132">Para que você possa criar regras NAT para tal encaminhamento de porta, crie um Azure Load Balancer no seu grupo de recursos.</span><span class="sxs-lookup"><span data-stu-id="197c6-132">To allow you to create NAT rules for such port forwarding, create an Azure load balancer in your resource group.</span></span> <span data-ttu-id="197c6-133">Novamente, o balanceador de carga é suficientemente granular para ser aplicado apenas a VMs específicas, se for necessário.</span><span class="sxs-lookup"><span data-stu-id="197c6-133">Again, the load balancer is granular enough to only apply to specific VMs if needed.</span></span> <span data-ttu-id="197c6-134">As regras de NAT do Azure Load Balancer trabalham em conjunto com as regras de ACL de Grupo de Segurança de Rede para fornecer mais flexibilidade e controle do que pode ser obtido com os pontos de extremidade do Serviço de Nuvem.</span><span class="sxs-lookup"><span data-stu-id="197c6-134">The Azure load balancer NAT rules work alongside Network Security Group ACL rules to provide much more flexibility and control than was achievable using Cloud Service endpoints.</span></span> <span data-ttu-id="197c6-135">Para obter mais informações, confira [visão geral do balanceador de carga](../articles/load-balancer/load-balancer-overview.md).</span><span class="sxs-lookup"><span data-stu-id="197c6-135">For more information, see the [load balancer overview](../articles/load-balancer/load-balancer-overview.md).</span></span>

## <a name="network-security-group-acl-rules"></a><span data-ttu-id="197c6-136">Regras de ACL de Grupo de Segurança de Rede</span><span class="sxs-lookup"><span data-stu-id="197c6-136">Network Security Group ACL rules</span></span>
<span data-ttu-id="197c6-137">As regras de ACL permitem que você defina o tráfego que pode fluir dentro e fora de sua VM com base em protocolos, intervalos de porta ou portas específicas.</span><span class="sxs-lookup"><span data-stu-id="197c6-137">ACL rules let you define what traffic can flow in and out of your VM based on specific ports, port ranges, or protocols.</span></span> <span data-ttu-id="197c6-138">As regras são atribuídas às VMs individuais ou a uma sub-rede.</span><span class="sxs-lookup"><span data-stu-id="197c6-138">Rules are assigned to individual VMs or to a subnet.</span></span> <span data-ttu-id="197c6-139">A captura de tela a seguir mostra um exemplo de regras de ACL para um servidor Web comum:</span><span class="sxs-lookup"><span data-stu-id="197c6-139">The following screenshot is an example of ACL rules for a common webserver:</span></span>

![Lista de regras de ACL de Grupo de Segurança de Rede](./media/virtual-machines-common-endpoints-in-resource-manager/example-acl-rules.png)

<span data-ttu-id="197c6-141">As regras de ACL são aplicadas com base em uma métrica de prioridade especificada por você. Quanto maior o valor, menor a prioridade.</span><span class="sxs-lookup"><span data-stu-id="197c6-141">ACL rules are applied based on a priority metric that you specify - the higher the value, the lower the priority.</span></span> <span data-ttu-id="197c6-142">Cada Grupo de Segurança de Rede tem três regras padrão projetadas para lidar com o fluxo do tráfego de rede do Azure, com uma `DenyAllInbound` explícita como a regra final.</span><span class="sxs-lookup"><span data-stu-id="197c6-142">Every Network Security Group has three default rules that are designed to handle the flow of Azure networking traffic, with an explicit `DenyAllInbound` as the final rule.</span></span> <span data-ttu-id="197c6-143">As regras de ACL padrão recebem uma prioridade baixa para não interferir com as regras criadas.</span><span class="sxs-lookup"><span data-stu-id="197c6-143">Default ACL rules are given a low priority to not interfere with rules you create.</span></span>

## <a name="assigning-network-security-groups"></a><span data-ttu-id="197c6-144">Atribuição dos Grupos de Segurança de Rede</span><span class="sxs-lookup"><span data-stu-id="197c6-144">Assigning Network Security Groups</span></span>
<span data-ttu-id="197c6-145">Você pode atribuir um Grupo de Segurança de Rede a uma sub-rede ou a uma interface de rede.</span><span class="sxs-lookup"><span data-stu-id="197c6-145">You assign a Network Security Group to a subnet or a network interface.</span></span> <span data-ttu-id="197c6-146">Essa abordagem permite que o detalhamento necessário ao aplicar as regras de ACL a apenas uma VM específica, ou garante que um conjunto comum de regras de ACL seja aplicado a todas as VMs que fazem parte de uma sub-rede:</span><span class="sxs-lookup"><span data-stu-id="197c6-146">This approach allows you to be as granular as needed when applying your ACL rules to only a specific VM, or ensure a common set of ACL rules are applied to all VMs part of a subnet:</span></span>

![Aplicar NSGs a sub-redes ou interfaces de rede](./media/virtual-machines-common-endpoints-in-resource-manager/apply-nsg-to-resources.png)

<span data-ttu-id="197c6-148">O comportamento do Grupo de Segurança de Rede não muda se estiver sendo atribuído a uma sub-rede ou a uma interface de rede.</span><span class="sxs-lookup"><span data-stu-id="197c6-148">The behavior of the Network Security Group doesn't change depending on being assigned to a subnet or a network interface.</span></span> <span data-ttu-id="197c6-149">Um cenário de implantação comum tem o Grupo de Segurança de Rede atribuído a uma sub-rede a fim de garantir a conformidade de todas as VMs conectadas à sub-rede.</span><span class="sxs-lookup"><span data-stu-id="197c6-149">A common deployment scenario has the Network Security Group assigned to a subnet to ensure compliance of all VMs attached to that subnet.</span></span> <span data-ttu-id="197c6-150">Para obter mais informações, confira [aplicar grupos de Segurança de Rede a recursos](../articles/virtual-network/virtual-networks-nsg.md#associating-nsgs).</span><span class="sxs-lookup"><span data-stu-id="197c6-150">For more information, see [applying Network Security groups to resources](../articles/virtual-network/virtual-networks-nsg.md#associating-nsgs).</span></span>

## <a name="default-behavior-of-network-security-groups"></a><span data-ttu-id="197c6-151">Comportamento padrão dos Grupos de Segurança de Rede</span><span class="sxs-lookup"><span data-stu-id="197c6-151">Default behavior of Network Security Groups</span></span>
<span data-ttu-id="197c6-152">Dependendo de como e quando você cria o Grupo de Segurança de Rede, as regras padrão podem ser criadas para VMs do Windows a fim de permitir o acesso RDP na porta TCP 3389.</span><span class="sxs-lookup"><span data-stu-id="197c6-152">Depending on how and when you create your Network Security Group, default rules may be created for Windows VMs to permit RDP access on TCP port 3389.</span></span> <span data-ttu-id="197c6-153">Regras padrão para as VMs do Linux permitem o acesso SSH na porta TCP 22.</span><span class="sxs-lookup"><span data-stu-id="197c6-153">Default rules for Linux VMs permit SSH access on TCP port 22.</span></span> <span data-ttu-id="197c6-154">Essas regras de ACL automáticas são criadas sob as seguintes condições:</span><span class="sxs-lookup"><span data-stu-id="197c6-154">These automatic ACL rules are created under the following conditions:</span></span>

* <span data-ttu-id="197c6-155">Se você criar uma VM do Windows por meio do portal e aceitar a ação padrão para criar um Grupo de Segurança de Rede, uma regra de ACL para permitir a porta TCP 3389 (RDP) será criada.</span><span class="sxs-lookup"><span data-stu-id="197c6-155">If you create a Windows VM through the portal and accept the default action to create a Network Security Group, an ACL rule to allow TCP port 3389 (RDP) is created.</span></span>
* <span data-ttu-id="197c6-156">Se você criar uma VM do Linux por meio do portal e aceitar a ação padrão para criar um Grupo de Segurança de Rede, uma regra de ACL para permitir a porta TCP 22 (SSH) será criada.</span><span class="sxs-lookup"><span data-stu-id="197c6-156">If you create a Linux VM through the portal and accept the default action to create a Network Security Group, an ACL rule to allow TCP port 22 (SSH) is created.</span></span>

<span data-ttu-id="197c6-157">Em todas as outras condições, essas regras ACL padrão não são criadas.</span><span class="sxs-lookup"><span data-stu-id="197c6-157">Under all other conditions, these default ACL rules are not created.</span></span> <span data-ttu-id="197c6-158">Você não pode se conectar à sua VM sem criar as regras de ACL apropriadas.</span><span class="sxs-lookup"><span data-stu-id="197c6-158">You cannot connect to your VM without creating the appropriate ACL rules.</span></span> <span data-ttu-id="197c6-159">Essas condições incluem as seguintes ações comuns:</span><span class="sxs-lookup"><span data-stu-id="197c6-159">These conditions include the following common actions:</span></span>

* <span data-ttu-id="197c6-160">Criação de um Grupo de Segurança de Rede por meio do portal como uma ação separada para criar a VM.</span><span class="sxs-lookup"><span data-stu-id="197c6-160">Creating a Network Security Group through the portal as a separate action to creating the VM.</span></span>
* <span data-ttu-id="197c6-161">Criação de um Grupo de Segurança de Rede por meio de programação no PowerShell, na CLI do Azure, APIs Rest etc.</span><span class="sxs-lookup"><span data-stu-id="197c6-161">Creating a Network Security Group programmatically through PowerShell, Azure CLI, Rest APIs, etc.</span></span>
* <span data-ttu-id="197c6-162">Criação e atribuição de uma VM a um Grupo de Segurança de Rede existente que ainda não tem a regra de ACL apropriada definida.</span><span class="sxs-lookup"><span data-stu-id="197c6-162">Creating a VM and assigning it to an existing Network Security Group that does not already have the appropriate ACL rule defined.</span></span>

<span data-ttu-id="197c6-163">Em todos os casos acima, você precisa criar regras de ACL para sua VM a fim de permitir as conexões de gerenciamento remoto apropriadas.</span><span class="sxs-lookup"><span data-stu-id="197c6-163">In all the preceding cases, you need to create ACL rules for your VM to allow the appropriate remote management connections.</span></span>

## <a name="default-behavior-of-a-vm-without-a-network-security-group"></a><span data-ttu-id="197c6-164">Comportamento padrão de uma VM sem um Grupo de Segurança de Rede</span><span class="sxs-lookup"><span data-stu-id="197c6-164">Default behavior of a VM without a Network Security Group</span></span>
<span data-ttu-id="197c6-165">Você pode criar uma VM sem criar um Grupo de Segurança de Rede.</span><span class="sxs-lookup"><span data-stu-id="197c6-165">You can create a VM without creating a Network Security Group.</span></span> <span data-ttu-id="197c6-166">Nessas situações, você pode se conectar à sua VM usando o RDP ou SSH sem criar regras de ACL.</span><span class="sxs-lookup"><span data-stu-id="197c6-166">In these situations, you can connect to your VM using RDP or SSH without creating any ACL rules.</span></span> <span data-ttu-id="197c6-167">Da mesma forma, se você instalou um serviço Web na porta 80, esse serviço pode ser acessado automaticamente remotamente.</span><span class="sxs-lookup"><span data-stu-id="197c6-167">Similarly, if you installed a web service on port 80, that service is automatically accessible remotely.</span></span> <span data-ttu-id="197c6-168">A VM tem todas as portas abertas.</span><span class="sxs-lookup"><span data-stu-id="197c6-168">The VM has all ports open.</span></span>

> [!NOTE]
> <span data-ttu-id="197c6-169">Você ainda precisa ter um endereço IP público atribuído a uma VM para qualquer conexão remota.</span><span class="sxs-lookup"><span data-stu-id="197c6-169">You still need to have a public IP address assigned to a VM in order for any remote connections.</span></span> <span data-ttu-id="197c6-170">Não ter um Grupo de Segurança de Rede para a interface de rede ou sub-rede não expõe a VM a qualquer tráfego externo.</span><span class="sxs-lookup"><span data-stu-id="197c6-170">Not having a Network Security Group for the subnet or network interface doesn't expose the VM to any external traffic.</span></span> <span data-ttu-id="197c6-171">A ação padrão ao criar uma VM por meio do portal é criar um novo IP público.</span><span class="sxs-lookup"><span data-stu-id="197c6-171">The default action when creating a VM through the portal is to create a new public IP.</span></span> <span data-ttu-id="197c6-172">Para todas as outras formas de criação de uma VM, como o PowerShell, CLI do Azure ou o modelo do Resource Manager, um IP público não será criado automaticamente se não tiver sido solicitado explicitamente.</span><span class="sxs-lookup"><span data-stu-id="197c6-172">For all other forms of creating a VM such as PowerShell, Azure CLI, or Resource Manager template, a public IP is not automatically created unless explicitly requested.</span></span> <span data-ttu-id="197c6-173">A ação padrão por meio do portal também é criar um Grupo de Segurança de Rede.</span><span class="sxs-lookup"><span data-stu-id="197c6-173">The default action through the portal is also to create a Network Security Group.</span></span> <span data-ttu-id="197c6-174">Essa ação padrão significa que você não deve terminar em uma situação com uma VM exposta sem uma rede de filtragem em vigor.</span><span class="sxs-lookup"><span data-stu-id="197c6-174">This default action means you shouldn't end up in a situation with an exposed VM that has no network filtering in place.</span></span>

## <a name="understanding-load-balancers-and-nat-rules"></a><span data-ttu-id="197c6-175">Noções básicas sobre regras de NAT e balanceadores de carga</span><span class="sxs-lookup"><span data-stu-id="197c6-175">Understanding Load Balancers and NAT rules</span></span>
<span data-ttu-id="197c6-176">No modelo de implantação Clássico, você pode criar pontos de extremidade que também realizam o encaminhamento de porta.</span><span class="sxs-lookup"><span data-stu-id="197c6-176">In the Classic deployment model, you could create endpoints that also performed port forwarding.</span></span> <span data-ttu-id="197c6-177">Quando você cria uma máquina virtual no modelo de implantação clássico, as regras ACL para RDP ou SSH são criadas automaticamente.</span><span class="sxs-lookup"><span data-stu-id="197c6-177">When you create a VM in the Classic deployment model, ACL rules for RDP or SSH would be automatically created.</span></span> <span data-ttu-id="197c6-178">Essas regras não expõem a porta TCP 3389 ou a porta TCP 22, respectivamente, para o mundo exterior.</span><span class="sxs-lookup"><span data-stu-id="197c6-178">These rules would not expose TCP port 3389 or TCP port 22 respectively to the outside world.</span></span> <span data-ttu-id="197c6-179">Em vez disso, uma porta TCP de alto valor seria exposta, mapeando para a porta interna apropriada.</span><span class="sxs-lookup"><span data-stu-id="197c6-179">Instead, a high-value TCP port would be exposed that maps to the appropriate internal port.</span></span> <span data-ttu-id="197c6-180">Você também pode criar suas próprias regras de ACL de uma maneira semelhante, por exemplo, expondo um servidor Web na porta TCP 4280 para o mundo exterior.</span><span class="sxs-lookup"><span data-stu-id="197c6-180">You could also create your own ACL rules in a similar manner, such as expose a webserver on TCP port 4280 to the outside world.</span></span> <span data-ttu-id="197c6-181">Você pode ver essas regras de ACL e os mapeamentos de porta na seguinte captura de tela do Portal Clássico:</span><span class="sxs-lookup"><span data-stu-id="197c6-181">You can see these ACL rules and port mappings in the following screenshot from the Classic portal:</span></span>

![Encaminhamento de porta com pontos de extremidade Clássicos](./media/virtual-machines-common-endpoints-in-resource-manager/classic-endpoints-port-forwarding.png)

<span data-ttu-id="197c6-183">Com os Grupos de Segurança de Rede, essa função de encaminhamento de porta é tratada por um balanceador de carga.</span><span class="sxs-lookup"><span data-stu-id="197c6-183">With Network Security Groups, that port-forwarding function is handled by a load balancer.</span></span> <span data-ttu-id="197c6-184">Para obter mais informações, confira [balanceadores de carga no Azure](../articles/load-balancer/load-balancer-overview.md).</span><span class="sxs-lookup"><span data-stu-id="197c6-184">For more information, see [load balancers in Azure](../articles/load-balancer/load-balancer-overview.md).</span></span> <span data-ttu-id="197c6-185">O exemplo a seguir mostra um balanceador de carga com uma regra de NAT para executar o encaminhamento de porta da porta TCP 4222 à porta TCP 22 interna de uma VM:</span><span class="sxs-lookup"><span data-stu-id="197c6-185">The following example shows a load balancer with a NAT rule to perform port-forwarding TCP port 4222 to the internal TCP port 22 a VM:</span></span>

![Regras NAT do Balanceador de carga para encaminhamento de porta](./media/virtual-machines-common-endpoints-in-resource-manager/load-balancer-nat-rules.png)

> [!NOTE]
> <span data-ttu-id="197c6-187">Quando você implementa um balanceador de carga, normalmente não atribui à própria VM um endereço IP público.</span><span class="sxs-lookup"><span data-stu-id="197c6-187">When you implement a load balancer, you typically don't assign the VM itself a public IP address.</span></span> <span data-ttu-id="197c6-188">Em vez disso, o balanceador de carga tem um endereço IP público atribuído a ele.</span><span class="sxs-lookup"><span data-stu-id="197c6-188">Instead, the load balancer has a public IP address assigned to it.</span></span> <span data-ttu-id="197c6-189">Você ainda precisa criar o Grupo de Segurança de Rede e a regra de ACL para definir o fluxo de tráfego que entra e sai de sua VM.</span><span class="sxs-lookup"><span data-stu-id="197c6-189">You still need to create your Network Security Group and ACL rules to define the flow of traffic in and out of your VM.</span></span> <span data-ttu-id="197c6-190">As regras de NAT do balanceador de carga são basicamente para definir quais portas têm permissão no balanceador de carga e como elas são distribuídas entre as VMs de back-end.</span><span class="sxs-lookup"><span data-stu-id="197c6-190">The load balancer NAT rules are simply to define what ports are allowed through the load balancer and how they get distributed across the backend VMs.</span></span> <span data-ttu-id="197c6-191">Assim, você precisa criar uma regra NAT para o tráfego por meio do balanceador de carga.</span><span class="sxs-lookup"><span data-stu-id="197c6-191">As such, you need to create a NAT rule for traffic to flow through the load balancer.</span></span> <span data-ttu-id="197c6-192">Para permitir que o tráfego chegue à VM, crie uma regra de ACL de Grupo de Segurança de Rede.</span><span class="sxs-lookup"><span data-stu-id="197c6-192">To allow the traffic to reach the VM, create a Network Security Group ACL rule.</span></span>
